// JScript File
///////////////////////////////////////////////////////////////////
var tot_row_count = 0;
var online_flag = false;
var nprint_flag = false;
var fixed_booking = "N";
var vat_app = 0;
var bill_comp_amt = "";
var roundoff = "";
var drppack = "";
var COMMASALLOWINBOOKING = "";
var cioprevgst="";
var AREACALCULATION = "";
var pformname = "Classified_Booking"
var hiddisctype;
var TVURL = "";
var VISIBLEAGREEDRATE = "";
var ALLOWBOOKINGGST="";
var ALLOWGSTROUND="";
var clientfromconfig1 = "";
var boxstatus = "";
var paivar = "";
var gfollodate = "";
var fmgInsert = "";
var fmgsize = "";
var fmgcolor = "";
var fmgreasons = "";
var multiselect = "";
var multicode = "";
var sharepub = "";
var rostatusmain = "";
var spdisc = 0;
var spdiscper = 0;
var flooramount = 0;
var clientfromconfig = "";
var retexeboth = ""
var tradefoc = "";
var hidcopy = "";
var activeD = "";
var chkbtnStatus = "";
var schemeid = "";
var arrEdition_Item = '';
var BILL_STATUS = '';
var id_var_array;
var filterins = "";
var executequery;
var rownumEx;
var activeid = "";
var adR = 0;
var danbool = false;
var danfont = "";
var gb_ins = "";
var Make_Row;
var noissueflag = false;
var make_td;
var enLink = "0";
var modifydtcount = 1;
var modifyMatter = "0";
var gbcontract_rate = ""
var maxWidth = 100;
var hdntranschgon="";
// height to resize large images to
var maxHeight = 100;
// valid file types
var fileTypes = ["bmp", "gif", "png", "jpg", "jpeg"];
// the id of the preview image tag
var outImage = "previewField";
// what to display when the image is not valid
var defaultPic = "spacer.gif";
var totor = 0;
/////////////////////////////////////////////////////////////////////
var glob_area = "";
var cyop_code = "";
var cyop_desc = "";
var flag_line = "";
var tempins;
var pkgcode;
var ds_adon;
var ds_sch;
var che_flag = 0;
var check_or = "0";
var txtbillarea = "";
var flagrate;
var idfocus = "";
var globfromline = "";
var globtoline = "";
var globextrarate = "";
////////////////
var suboradd;
var noofinsert = "";
var noofinsertlo = "";
var rowwhenupdate = "";
var fillinsert = "";
var insertval = "";
var subtractrow;
var objadscat;
var globalgross;
var globalbill;
var boxpercen = "";
var boxgamt;
var boxbill;
var glspedisc = "0";
var glspadisc = "0";
var glspeccharge = "0";
var glpre = "0";
var savtotid;
var getid = "";
var countgridloop = "";
var schemediscount = "";
var gbdataset;
var globalschemedisc = "";
var globalschemefrom = "";
var gldisctyp = "";
var insdatetemp;
var perbox = "";
var perboxtype = "";
////////////////////////this is to chk that when the grid is visibile and if we cjange that effect the rate at that time 
////////////////////////flagins is set to 0 means we have to get the rate into the grid and if 1 than insert the data into the tabke
var flagins = "";
var retrows = "";

var browser = navigator.appName;
var browserversion = msieversion();
var xmlDoc = null;
var xmlObj = null;

var req = null;
var insert;

var agreedrate_active = 0;
var agreedamt_active = 0;
function blankAmount() {
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtbillamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
}
function msieversion() {
    var ua = window.navigator.userAgent
    var msie = ua.indexOf("MSIE ")

    if (msie > 0)      // If Internet Explorer, return version number
        return parseInt(ua.substring(msie + 5, ua.indexOf(".", msie)))
    else                 // If another browser, return 0
        return 0

}
//**************************************
function notchar2(event) {
    if (document.activeElement.id == "txtpospremdisc" && (document.getElementById('drppageposition').value == "0" || document.getElementById('drppageposition').value == "")) {
        return false;
    }
    if (document.activeElement.id == "txttranslationdisc" && (document.getElementById('drptranslation').value == "0" || document.getElementById('drptranslation').value == "")) {
        return false;
    }
    insert = document.getElementById('txtinsertion').value;
    if (browser != "Microsoft Internet Explorer") {
        if ((event.which >= 48 && event.which <= 57) || (event.which == 127) || (event.which == 8) || (event.which == 9) || (event.which == 46) || (event.which == 0)) {
            if (document.activeElement.id == 'txtinsertion' && event.keyCode == 46)
                return false;
            else
                return true;
        }
        else {
            return false;
        }
    }
    else {
        if ((event.keyCode >= 48 && event.keyCode <= 57) || (event.keyCode == 127) || (event.keyCode == 8) || (event.keyCode == 9) || (event.keyCode == 46)) {
            if (document.activeElement.id == 'txtinsertion' && event.keyCode == 46)
                return false;
            else
                return true;
        }
        else {
            return false;
        }
    }
}
function notchar2Area() {
    if (document.getElementById('hiddenuomdesc').value == "ROL" && event.keyCode == 46)
        return false;
    insert = document.getElementById('txtinsertion').value;
    if ((event.keyCode >= 48 && event.keyCode <= 57) || (event.keyCode == 127) || (event.keyCode == 8) || (event.keyCode == 9) || (event.keyCode == 46)) {
        return true;
    }
    else {
        return false;
    }
}
function loadXML(xmlFile) {
    var httpRequest = null;

    if (browser != "Microsoft Internet Explorer") {

        req = new XMLHttpRequest();
        //alert(req);
        req.onreadystatechange = getMessage;
        req.open("GET", xmlFile, true);
        req.send('');

    }
    else {
        xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
        xmlDoc.async = "false";
        xmlDoc.onreadystatechange = verify;
        xmlDoc.load(xmlFile);
        xmlObj = xmlDoc.documentElement;
        // alert(xmlObj.childNodes(0).childNodes(0).text);
    }

}

function getMessage() {
    var response = "";
    if (req.readyState == 4) {
        if (req.status == 200) {
            response = req.responseText;
            //alert(response);
        }
    }

    var parser = new DOMParser();
    xmlDoc = parser.parseFromString(response, "text/xml");
    xmlObj = xmlDoc.documentElement;
}

loadXML('xml/billcycle.xml');

function verify() {
    // 0 Object is not initialized 
    // 1 Loading object is loading data 
    // 2 Loaded object has loaded data 
    // 3 Data from object can be worked with 
    // 4 Object completely initialized 
    if (xmlDoc.readyState != 4) {
        return false;
    }
}

var idnew = 0;
var previnsertion = "0";
var repeatdate = "0";

function checkdateInsert() {
    if (document.getElementById('txtdummydate').value == "") {
        alert("Please Select Publish date first");
        if (document.getElementById('txtdummydate').disabled == false)
            document.getElementById('txtdummydate').focus();
        return false;
    }
    //  rateenter(event);  
}




function onInsertionChange(actid) {
    document.getElementById('tempinsert').value = document.getElementById('txtinsertion').value;
    if (document.getElementById('txtinsertion').value == "0" || document.getElementById('txtinsertion').value == "") {
        alert("Insertion can't be 0 OR blank");
        return false;
    }
    if (document.getElementById('txtinsertion').value != "" && document.getElementById('bookdiv') != null && document.getElementById('txtinsertion').value != "0") {
        if (actid == "txtinsertion")
            subtractrow = "show";
        if (document.getElementById('hiddensavemod').value == "01") {
            if (parseInt(document.getElementById('hiddenmodifyinsert').value) > parseInt(document.getElementById('txtinsertion').value)) {
                alert('You Cannot Decrease insertions(Please Cancel Booking..)!');
                return false;
            }
        }

        if (previnsertion == '') {
            previnsertion = document.getElementById('txtinsertion').value;
        }
        document.getElementById('txtgrossamt').value = '';
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        if (document.getElementById('txtinsertion').value != "") {
            insert = document.getElementById('txtinsertion').value;
        }
        var adcat3 = document.getElementById('drpadcat3').value;
        var adcat4 = document.getElementById('drpadcat4').value;
        var adcat5 = document.getElementById('drpadcat5').value;
        var clientname = document.getElementById('txtclient').value;
        var client_split;
        if (clientname.indexOf("(") >= 0) {
            clientname = clientname.split("(");
            client_split = clientname[1];
            client_split = client_split.replace(")", "");
            clientname = client_split;
        }
        //////////////this code is to split the code as well as ites description
        var ins = parseInt(document.getElementById('txtinsertion').value, 10);
        document.getElementById('txtinsertion').value = ins;
        ///////this is to get the value into paid ins. text b0x
        if (document.getElementById('txtpaid').value != "" && document.getElementById('txtinsertion').value != "") {
            var paidno = document.getElementById('txtpaid').value;
            var valinsert = document.getElementById('txtinsertion').value;
            document.getElementById('txtpaid').value = (parseInt(valinsert, 10) - parseInt(paidno, 10)) + parseInt(paidno, 10);
        }
        var count1 = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
        for (var j1 = 0; j1 < count1; j1++) {
            var paid = document.getElementById("pai" + j1);
            if (paid != null) {
                paid.value = 'Y';
            }
        }
        var objpack = document.getElementById('drppackagecopy');
        var temp = "";
        var tempcode = "";
        var tempval = "";
        var tempvalcode = "";
        var desc = "";
        var code = "";
        var i = objpack.options.length;
        var j;

        for (j = 0; j < i; j++) {
            if (parseInt(i) > 0) {
                tempval = objpack[j].value;
                //tempvalcode=objpack[j].value;
                if (temp != "") {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    code = tempvalcode + "," + code;
                    desc = tempcode + "," + desc;
                }
                else {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    code = tempvalcode;
                    desc = tempcode;
                }
            }
        }


        //////////////////////////////////////////////////////////////////

        document.getElementById('drpscheme').value = "";
        if (document.getElementById('txtrepeatingdate').value != "") {
            var insertval = document.getElementById('txtinsertion').value
            if (parseInt(document.getElementById('txtinsertion').value) == 1) {
                //alert("In case of Insertion 1Repeating Day can't be greater than 1")
                if (document.getElementById('drppackagecopy').options.length > 0) {
                    for (var insertCou = 0; insertCou < document.getElementById('drppackagecopy').options.length; insertCou++) {
                        if (document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') >= 0) {
                            var tinsert = document.getElementById('drppackagecopy').options[insertCou].value.substring(document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') + 1, document.getElementById('drppackagecopy').options[insertCou].value.indexOf(')'));
                            if (tinsert > 1)
                                break;
                        }
                    }
                }
                if (tinsert <= 1) {
                    document.getElementById('txtrepeatingdate').value = "";
                    // return false;   //***
                }
            }

            repeatdate = "1";
            suboradd = "1";
        }
        else {
            repeatdate = "0";
            suboradd = "1";
        }


        var insert = desc.substring(desc.indexOf('(') + 1, desc.indexOf(')'));
        insert = parseInt(insert, 10) * parseInt(document.getElementById('txtinsertion').value, 10);
        if (parseInt(insert, 10) > parseInt(previnsertion, 10)) {
            suboradd = "1";
        }
        if (parseInt(previnsertion) > parseInt(insert, 10)) {
            repeatdate = "1";
            suboradd = "0";
        }
        if (repeatdate == "1") {
            //document.getElementById('tblinsert').innerHTML="";
            subtractrow = "";
        }
        var insert = document.getElementById('hiddeninserts').value;
        var class_insert = document.getElementById('txtinsertion').value;
        var lines_to;
        if (document.getElementById('txtadsize1').disabled == false) {
            lines_to = "";
        }
        else {
            lines_to = document.getElementById('txttotalarea').value;
        }
        //if(document.getElementById('tblinsert').innerHTML=="")
        noissueflag = true;
        if (subtractrow == "") {

            //Classified_Booking.getData(document.getElementById('drppackage').value,document.getElementById('txtinsertion').value,document.getElementById('txtrepeatingdate').value,document.getElementById('txtdummydate').value,document.getElementById('hiddendateformat').value,document.getElementById('hiddencompcode').value,insertLinedrop_callback);    
            if (suboradd == "1") {
                if (parseInt(document.getElementById('txtinsertion').value, 10) > parseInt(previnsertion, 10) && chkbtnStatus != "new") {
                    var repeatdate_vari = "";
                    if (document.getElementById('txtrepeatingdate').value == "" && parseInt(document.getElementById('txtinsertion').value, 10) > 1)
                        repeatdate_vari = "1";
                    else
                        repeatdate_vari = document.getElementById('txtrepeatingdate').value;
                    var ds_linedrop = Classified_Booking.getData(desc, document.getElementById('txtinsertion').value, repeatdate_vari, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, "CL0", document.getElementById('drpcurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname);
                    insertLine_callback_1(ds_linedrop);
                }
                else {
                    if (document.getElementById('chktfn').checked == false) {
                        document.getElementById('tblinsert').innerHTML == ""
                        if (che_flag == 1) {
                            desc = document.getElementById('hidval').value;
                        }
                        // previnsertion=document.getElementById('txtinsertion').value;
                        var repeatdate_vari = "";
                        if (document.getElementById('txtrepeatingdate').value == "" && parseInt(document.getElementById('txtinsertion').value, 10) > 1)
                            repeatdate_vari = "1";
                        else
                            repeatdate_vari = document.getElementById('txtrepeatingdate').value;
                        var ds_drop = Classified_Booking.getData(desc, document.getElementById('txtinsertion').value, repeatdate_vari, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, "CL0", document.getElementById('drpcurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname);
                        insertLinedrop_callback(ds_drop);
                    }
                    else {
                        document.getElementById('tblinsert').innerHTML == ""
                        if (che_flag == 1) {
                            desc = document.getElementById('hidval').value;
                        }
                        // previnsertion=document.getElementById('txtinsertion').value;
                        var repeatdate_vari = "";
                        if (document.getElementById('txtrepeatingdate').value == "" && parseInt(document.getElementById('txtinsertion').value, 10) > 1)
                            repeatdate_vari = "1";
                        else
                            repeatdate_vari = document.getElementById('txtrepeatingdate').value;
                        var ds_drop = Classified_Booking.getData(desc, document.getElementById('txtinsertion').value, repeatdate_vari, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, "CL0", document.getElementById('drpcurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname);
                        insertLinedrop_callback(ds_drop);
                    }
                }
            }
            else {
                if (che_flag == 1) {
                    desc = document.getElementById('hidval').value;
                }
                // Classified_Booking.getData(desc,document.getElementById('txtinsertion').value,document.getElementById('txtrepeatingdate').value,document.getElementById('txtdummydate').value,document.getElementById('hiddendateformat').value,document.getElementById('hiddencompcode').value,document.getElementById('drpadcategory').value,document.getElementById('drpadsubcategory').value,document.getElementById('drpcolor').value,"CL0",document.getElementById('drpcurrency').value,document.getElementById('txtratecode').value,document.getElementById('hiddenclickdate').value,insert,code,document.getElementById('txtcardrate').value,document.getElementById('drpuom').value,document.getElementById('txtdealrate').value,check_or,class_insert,lines_to,adcat3,adcat4,adcat5,clientname,insertLinesubtract_callback);
                insertLinesubtract_callback("", 'main');
            }
        }
        else {
            //Classified_Booking.getData(document.getElementById('drppackage').value,parseInt(document.getElementById('txtinsertion').value),document.getElementById('txtrepeatingdate').value,document.getElementById('txtdummydate').value,document.getElementById('hiddendateformat').value,document.getElementById('hiddencompcode').value,insertLine_callback);
            if (che_flag == 1) {
                desc = document.getElementById('hidval').value;
            }
            ////////        if(chkbtnStatus=="new")
            ////////        {
            ////////             document.getElementById('tblinsert').innerHTML="";
            ////////              
            ////////                // previnsertion=document.getElementById('txtinsertion').value;
            ////////                  var repeatdate_vari="";
            ////////                if(document.getElementById('txtrepeatingdate').value=="" && parseInt(document.getElementById('txtinsertion').value,10)>1)
            ////////                    repeatdate_vari="1";
            ////////                else
            ////////                    repeatdate_vari=document.getElementById('txtrepeatingdate').value;   
            ////////                var ds_drop=Classified_Booking.getData(desc,document.getElementById('txtinsertion').value,repeatdate_vari,document.getElementById('txtdummydate').value,document.getElementById('hiddendateformat').value,document.getElementById('hiddencompcode').value,document.getElementById('drpadcategory').value,document.getElementById('drpadsubcategory').value,document.getElementById('drpcolor').value,"CL0",document.getElementById('drpcurrency').value,document.getElementById('txtratecode').value,document.getElementById('hiddenclickdate').value,insert,code,document.getElementById('txtcardrate').value,document.getElementById('drpuom').value,document.getElementById('txtdealrate').value,check_or,class_insert,lines_to,adcat3,adcat4,adcat5,clientname);
            ////////                insertLinedrop_callback(ds_drop);
            ////////        }
            ////////        else{
            //  previnsertion=document.getElementById('txtinsertion').value;
            var repeatdate_vari = "";
            if (document.getElementById('txtrepeatingdate').value == "" && parseInt(document.getElementById('txtinsertion').value, 10) > 1)
                repeatdate_vari = "1";
            else
                repeatdate_vari = document.getElementById('txtrepeatingdate').value;
            var ds_linedrop = Classified_Booking.getData(desc, document.getElementById('txtinsertion').value, repeatdate_vari, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, "CL0", document.getElementById('drpcurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname);
            insertLine_callback_1(ds_linedrop);
            ///////}
        }
    }
}


function insertLine() {
    //////////////this code is to split the code as well as ites description 

    var objpack = document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var code = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (temp != "") {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode + "," + code;
                desc = tempcode + "," + desc;
            }
            else {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode;
                desc = tempcode;
            }
        }

    }

    ////////////////////////////////////////////////////////////////

    var insert = document.getElementById('hiddeninserts').value;
    var class_insert = document.getElementById('txtinsertion').value;
    var lines_to;
    if (document.getElementById('txtadsize1').disabled == false) {
        lines_to = "";
    }
    else {
        lines_to = document.getElementById('txttotalarea').value;
    }

    if (checkflag == 1) {
        document.getElementById('txtinsertion').value = parseInt(document.getElementById('txtinsertion').value) + 1;
        document.getElementById('txtpaid').value = document.getElementById('txtinsertion').value;
    }
    //Classified_Booking.getData(document.getElementById('drppackage').value,document.getElementById('txtinsertion').value,document.getElementById('txtrepeatingdate').value,document.getElementById('txtdummydate').value,document.getElementById('hiddendateformat').value,document.getElementById('hiddencompcode').value,insertLine_callback);
    if (che_flag == 1) {
        desc = document.getElementById('hidval').value;
    }
    var adcat3 = document.getElementById('drpadcat3').value;
    var adcat4 = document.getElementById('drpadcat4').value;
    var adcat5 = document.getElementById('drpadcat5').value;
    var clientname = document.getElementById('txtclient').value;
    var client_split;
    if (clientname.indexOf("(") >= 0) {
        clientname = clientname.split("(");
        client_split = clientname[1];
        client_split = client_split.replace(")", "");
        clientname = client_split;
    }

    var ds_linedrop = Classified_Booking.getData(desc, document.getElementById('txtinsertion').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, "CL0", document.getElementById('drpcurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname);
    insertLine_callback_1(ds_linedrop);


}


function insertLinedrop() {
    caldate = null;
    caldate = new Array();
    caldatemonth = null;
    caldatemonth = new Array();
    caldateyear = null;
    caldateyear = new Array();
    if (document.getElementById('hiddensavemod').value != "1")// && document.getElementById('drppackage').value!="0")
    {
        if (document.getElementById('txtinsertion').value == "")
            document.getElementById('txtinsertion').value = "1";
        document.getElementById('txtpaid').value = "1";
        //document.getElementById('txtratecode').value="0";
        document.getElementById('txtcardrate').value = "";
        document.getElementById('txtcardamt').value = "";
        document.getElementById('txtagreedrate').value = "";
        document.getElementById('txtagreedamt').value = "";
        document.getElementById('txtdiscount').value = "";
        document.getElementById('txtdiscpre').value = "";
        //document.getElementById('txtspedisc').value="";
        //document.getElementById('txtspediscper').value="";
        document.getElementById('txtspacedisc').value = "";
        document.getElementById('txtspadiscper').value = "";
        document.getElementById('txtextracharges').value = "";
        document.getElementById('txtspedisc').value = "";
        document.getElementById('txtspediscper').value = "";
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtbillamt').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        document.getElementById('txtdealrate').value = "";
        document.getElementById('txtdeviation').value = "";
        if (document.getElementById('drppackagecopy').options.length == 0) {
            document.getElementById('txtdummydate').value = "";
        }

        //////////////this funtion is to open the deal type on package change when prefeerrence is set to yes
        //////////////////////////////////////////////////////////////////////////////////////////////////////

        var objpack = document.getElementById('drppackagecopy');
        var temp = "";
        var tempcode = "";
        var tempval = "";
        var tempvalcode = "";
        var desc = "";
        var code = "";
        var i = objpack.options.length;
        var j;

        for (j = 0; j < i; j++) {
            if (parseInt(i) > 0) {
                tempval = objpack[j].value;
                //tempvalcode=objpack[j].value;
                if (temp != "") {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    cyop_code = tempvalcode + "^" + cyop_code;
                    cyop_desc = tempcode + "^" + cyop_desc;
                    code = tempvalcode + "," + code;
                    desc = tempcode + "," + desc;
                }
                else {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    code = tempvalcode;
                    desc = tempcode;
                    cyop_code = tempvalcode;
                    cyop_desc = tempcode;
                }
            }

        }

        document.getElementById('hiddenpackage').value = code;
        var insert = document.getElementById('hiddeninserts').value;

        if (che_flag == 1) {
            desc = document.getElementById('hidval').value;
        }
        var class_insert = document.getElementById('txtinsertion').value;
        var lines_to;
        if (document.getElementById('txtadsize1').disabled == false) {
            lines_to = "";
        }
        else {
            lines_to = document.getElementById('txttotalarea').value;
        }


        var adcat3 = document.getElementById('drpadcat3').value;
        var adcat4 = document.getElementById('drpadcat4').value;
        var adcat5 = document.getElementById('drpadcat5').value;

        var clientname = document.getElementById('txtclient').value;
        var client_split;
        if (clientname.indexOf("(") >= 0) {
            clientname = clientname.split("(");
            client_split = clientname[1];
            client_split = client_split.replace(")", "");
            clientname = client_split;

        }
        if (document.getElementById('txtinsertion').value == null || document.getElementById('txtinsertion').value == "null") {
            document.getElementById('txtinsertion').value = "1";
        }
        if (document.getElementById('tempinsert').value == null || document.getElementById('tempinsert').value == "null") {
            document.getElementById('tempinsert').value = "1";
        }
        // class_insert = document.getElementById('tempinsert').value;
        var ds_drop = Classified_Booking.getData(desc, document.getElementById('tempinsert').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, "CL0", document.getElementById('drpcurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname);
        insertLinedrop_callback(ds_drop);

        return;
    }
    return;
}

///////////this call back function is when there is alert do you want to insert more lines then this function executes


function insertLinedrop_callback(response) {
    caldate = null;
    caldate = new Array();
    caldatemonth = null;
    caldatemonth = new Array();
    caldateyear = null;
    caldateyear = new Array();
    var ds = response.value;
    document.getElementById('txtrepeatingdate').value = "";
    document.getElementById('drpedition').options.length = 1;

    if (ds == null) {
        alert("There is Some Network Error. Please Do the Booking Again");
        return false;
    }
    if (spdiscper == 1) {
        document.getElementById('txtspedisc').value = "";
    }
    else if (spdisc == 1) {
        document.getElementById('txtspediscper').value = "";
    }
    var adsubcat_vari = document.getElementById('drpadsubcategory');
    var color_vari = document.getElementById('drpcolor');
    var uom_vari = document.getElementById('drpuom');
    var hiddenuom_vari = document.getElementById('hiddenuomdesc');
    var column_vari = document.getElementById('txtcolum');
    var totalarea_vari = document.getElementById('txttotalarea');
    var adsize1_vari = document.getElementById('txtadsize1');
    var adsize2_vari = document.getElementById('txtadsize2');
    var matsta_vari = document.getElementById('drpmatstat');
    var drppagepos_vari = document.getElementById('drppageposition');
    var adcat_vari = document.getElementById('drpadcategory');
    var pkgcopy_vari = document.getElementById('drppackagecopy');
    var gridtab_vari = document.getElementById('gridtab');
    //var caption_per = document.getElementById('txtcaption');
    var remarks_per = document.getElementById('txtprintremark');
    noofinsert = ds.Tables[0].Rows.length;
    noofinsertlo = ds.Tables[0].Rows.length;
    gridItemCount = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value);
    fillinsert = ds.Tables[0].Rows.length;

    var getinsval = document.getElementById('txtinsertion').value;
    var totval = parseInt(noofinsert) / parseInt(getinsval);

    var dat = "mm+" / "+" / "+dd+" / "+yyyy";
    var i = 0;
    var j = 0;
    var k = 0;
    var l = 0;
    var m = 0;
    var n = 0;
    var o = 0;
    var p = 0;
    var str = "";
    var premid;
    var premper;
    var colid;
    var height;
    var width;
    var size;
    var late;
    var uomid;
    var adtypid;
    var cardid;
    var editid;
    var solorate;
    var premper1;
    var prem1id;
    var namecode;
    var inserts;
    var pagepost;
    var preall;
    var adcat;
    var adsubcat;
    var matsta;
    var filename;
    var discrate;
    var insertsta;
    var billstat;
    var repeat;
    var picfield;
    var colid;
    var paid;
    var agrred;
    var solo;
    var gross;
    var pageno_inserts;
    var caption_inserts;
    var remark_inserts;
    var page;
    var pageprem;
    var noofcol;
    var billamt;
    var billrate;
    var agnamnt;
    var adlagn;
    var spldisc;
    var cashdisc;
    var roundoffval;
    var pheival;
    var pagstr = "";

    var dcat1 = "";
    var dcol = "";
    var dinsert = "";
    var dstatus = "";
    var dposition = "";
    var dprem1 = "";
    var dpre = "";
    var dmcat = "";
    var dbill = "";
    var dadcat3 = "";
    var dadcat4 = "";
    var dadcat5 = "";
    var dpaid = "";
    var dcou = "";

    //str = "<div id=\"bookdiv\" runat=\"server\" style=\"OVERFLOW: auto; WIDTH: 896px; HEIGHT: 160px; \"><table cellpadding=\"1\" cellspacing=\"1\" id=\"gridtab\" width=\"1000px\" border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\"><td align=\"center\" valign=\"top\" >No.</td><td align=\"center\" valign=\"top\" >Edition</td><td valign=\"top\" align=\"center\">Date</td><td align=\"center\" valign=\"top\">Ad Sub Cat.</td><td align=\"center\" valign=\"top\">Color</td><td align=\"center\" valign=\"top\">Height</td><td align=\"center\" valign=\"top\">Width</td><td align=\"center\" valign=\"top\">Col.</td><td align=\"center\" valign=\"top\" id=\"siz\">Size</td><td align=\"center\" valign=\"top\" id=\"bol\">Bold</td><td valign=\"top\">Status Material</td><td align=\"center\" valign=\"top\">Insertion Sta.</td>";
    str = "<div id=\"bookdiv\" runat=\"server\" style=\"OVERFLOW: auto; WIDTH: 1200px; HEIGHT: 360px; \"><table cellpadding=\"1\" cellspacing=\"1\" id=\"gridtab\" width=\"1000px\" border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\"><td align=\"center\" valign=\"top\" >No.</td><td align=\"center\" valign=\"top\" >Edition</td><td valign=\"top\" align=\"center\">Date</td><td align=\"center\" valign=\"top\">File Name</td><td valign=\"top\" id='uploadA' style=\"cursor:pointer;color:red;\" >Upload</td><td align=\"center\" valign=\"top\">Ad Sub Cat.</td><td align=\"center\" valign=\"top\">Color</td><td align=\"center\" valign=\"top\">Height</td><td align=\"center\" valign=\"top\">Width</td><td align=\"center\" valign=\"top\">Col.</td><td align=\"center\" valign=\"top\" id=\"siz\">Size</td><td align=\"center\" valign=\"top\" id=\"bol\">Bold</td><td valign=\"top\">Status Material</td><td align=\"center\" valign=\"top\">Insertion Sta.</td>";
    if (browser != "Microsoft Internet Explorer") {
        if (xmlObj.childNodes[23].childNodes[79].childNodes[0].nodeValue == "enable") {
            str = str + "<td align=\"center\" valign=\"top\">Order Type</td>";
        }
        if (xmlObj.childNodes[23].childNodes[77].childNodes[0].nodeValue == "enable") {
            str = str + "<td align=\"center\" valign=\"top\">Chart Type</td>";
        }

    }
    else {
        if (xmlObj.childNodes(11).childNodes(39).text == "enable") {
            str = str + "<td align=\"center\" valign=\"top\">Order Type</td>";
        }
        if (xmlObj.childNodes(11).childNodes(38).text == "enable") {
            str = str + "<td align=\"center\" valign=\"top\">Chart Type</td>";
        }

    }
    str = str + "<td align=\"center\" valign=\"top\">Card Rate</td><td valign=\"top\" align=\"center\">Disc. Rate</td><td valign=\"top\" align=\"center\">Agreed Amt</td>";

    if (browser != "Microsoft Internet Explorer") {
        if (xmlObj.childNodes[25].childNodes[1].childNodes[0].nodeValue != "hide") {
            str = str + "<td align=\"center\" valign=\"top\">Latest By</td>";
        }
        if (xmlObj.childNodes[25].childNodes[3].childNodes[0].nodeValue != "hide") {
            str = str + "<td align=\"center\" valign=\"top\">Repeating</td>";
        }
        str = str + "<td align=\"center\" valign=\"top\">Premium 1</td><td align=\"center\" valign=\"top\">Pre(%)</td>";
        if (xmlObj.childNodes[25].childNodes[5].childNodes[0].nodeValue != "hide") {
            str = str + "<td align=\"center\" valign=\"top\">Pre Allowed</td>";
        }
        str = str + "<td align=\"center\" valign=\"top\">Adv Cat.</td>";
        if (xmlObj.childNodes[25].childNodes[7].childNodes[0].nodeValue != "hide") {
            str = str + "<td align=\"center\"  valign=\"top\">Bill Status</td>";
        }
        if (xmlObj.childNodes[25].childNodes[13].childNodes[0].nodeValue != "hide") {
            str = str + "<td align=\"center\"  valign=\"top\">Discount</td>";
        }
        str = str + "<td valign=\"top\">Paid Ins.</td><td valign=\"top\" >Solo Rate</td><td valign=\"top\" >Local Gross Amt</td><td valign=\"top\" >Page No.</td><td valign=\"top\" >Caption</td><td valign=\"top\" >Remarks</td><td valign=\"top\" >Local Bill Amt</td><td valign=\"top\" >Gross Amt</td><td valign=\"top\" >Bill Amt</td>";
        if (xmlObj.childNodes[25].childNodes[9].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >Bill Rate</td>";
        }
        if (xmlObj.childNodes[25].childNodes[15].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >Agn Amt</td>";
        }
        if (xmlObj.childNodes[25].childNodes[17].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >AdlAgn Amt</td>";
        }
        if (xmlObj.childNodes[25].childNodes[19].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >Spldisc</td>";
        }
        if (xmlObj.childNodes[25].childNodes[21].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >CashDisc</td>";
        }
        if (xmlObj.childNodes[25].childNodes[23].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >Round off</td>";
        }
        if (xmlObj.childNodes[25].childNodes[25].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >PDF H</td>";
        }
    }
    else {
        if (xmlObj.childNodes[12].childNodes[0].childNodes[0].nodeValue != "hide") {
            str = str + "<td align=\"center\" valign=\"top\">Latest By</td>";
        }
        if (xmlObj.childNodes[12].childNodes[1].childNodes[0].nodeValue != "hide") {
            str = str + "<td align=\"center\" valign=\"top\">Repeating</td>";
        }
        str = str + "<td align=\"center\" valign=\"top\">Premium 1</td><td align=\"center\" valign=\"top\">Pre(%)</td>";
        if (xmlObj.childNodes[12].childNodes[2].childNodes[0].nodeValue != "hide") {
            str = str + "<td align=\"center\" valign=\"top\">Pre Allowed</td>";
        }
        str = str + "<td align=\"center\" valign=\"top\">Adv Cat.</td>";
        if (xmlObj.childNodes[12].childNodes[3].childNodes[0].nodeValue != "hide") {
            str = str + "<td align=\"center\"  valign=\"top\">Bill Status</td>";
        }
        if (xmlObj.childNodes[12].childNodes[6].childNodes[0].nodeValue != "hide") {
            str = str + "<td align=\"center\"  valign=\"top\">Discount</td>";
        }
        str = str + "<td valign=\"top\">Paid Ins.</td><td valign=\"top\" >Solo Rate</td><td valign=\"top\" >Local Gross Amt</td><td valign=\"top\" >Page No.</td><td valign=\"top\" >Caption</td><td valign=\"top\" >Remarks</td><td valign=\"top\" >Local Bill Amt</td><td valign=\"top\" >Gross Amt</td><td valign=\"top\" >Bill Amt</td>";
        if (xmlObj.childNodes[12].childNodes[4].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >Bill Rate</td>";
        }
        if (xmlObj.childNodes[12].childNodes[7].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >Agn Amt</td>";
        }
        if (xmlObj.childNodes[12].childNodes[8].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >AdlAgn Amt</td>";
        }
        if (xmlObj.childNodes[12].childNodes[9].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >Spldisc</td>";
        }
        if (xmlObj.childNodes[12].childNodes[10].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >CashDisc</td>";
        }
        if (xmlObj.childNodes[12].childNodes[11].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >Round off</td>";
        }
        if (xmlObj.childNodes[12].childNodes[12].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >PDF H</td>";
        }
    }
    str = str + "<td></td><td></td><td  align=\"center\" valign=\"top\" >VTS</td>";

    if (browser != "Microsoft Internet Explorer") {
        if (xmlObj.childNodes[25].childNodes[11].childNodes[0].nodeValue != "hide") {
            str = str + "<td align=\"center\" valign=\"top\">Logo H</td><td align=\"center\" valign=\"top\">Logo W</td><td align=\"center\" valign=\"top\">Logo Name</td>";
        }

    }
    else {
        if (xmlObj.childNodes[12].childNodes[5].childNodes[0].nodeValue != "hide") {
            str = str + "<td align=\"center\" valign=\"top\">Logo H</td><td align=\"center\" valign=\"top\">Logo W</td><td align=\"center\" valign=\"top\">Logo Name</td>";
        }

    }
    str = str + "</tr></table></div>";
    document.getElementById('tblinsert').innerHTML = str;
    gridtab_vari = document.getElementById('gridtab');
    document.getElementById('hiddenrowcount').value = ds.Tables[0].Rows.length;
    countGridElement = ds.Tables[0].Rows.length;
    retrows = ds.Tables[0].Rows.length;
    //   for ( i = 0; i < ds.Tables[0].Rows.length; i++)
    //   {
    //   
    //   var id="Text" + i;
    //    str=str + "<tr ><td class=\"dtGrid\">"+ds.Tables[0].Rows[i].Edition_Name+"</td><td><input class=\"btextforbook\" type=\"text\" id="+id+" value="+ds.Tables[0].Rows[i].Date+"></td><td><select id=\"Select1\" class=\"dropdownforbook\"><option></option></select></td><td><input class=\"btextforbook\" type=\"text\" id="+id+" value=\"\"></td><td><select id=\"Select1\" class=\"dropdownforbook\"><option></option></select></td><td><select id=\"Select1\" class=\"dropdownforbook\"><option></option></select></td><td><input class=\"btextforbook\" type=\"text\" id="+id+" value=\"\"></td><td><select id=\"Select1\" class=\"dropdownforbook\"><option></option></select></td><td><input class=\"btextforbook\" type=\"text\" id="+id+" value=\"\"></td><td><input class=\"btextforbook\" type=\"text\" id="+id+" value=\"\"></td><td><input class=\"btextforbook\" type=\"text\" id="+id+" value=\"\"></td><td><input class=\"btextforbook\" type=\"text\" id="+id+" value=\"\"></td></tr>";
    //    
    //   }
    insertval = 1;
    colid = "col" + i;
    var insC = document.getElementById('txtinsertion').value;
    if (insC == "") {
        insC = "1";
    }
    retrows = parseInt(ds.Tables[0].Rows.length) / parseInt(insC);
    dcou = 0;
    var inew = 0;
    var insprev = 0;
    for (inew = 0; inew < ds.Tables[0].Rows.length; inew++) {
        var dCheck = true;
        var dCheck = checkValidEdition(ds.Tables[0].Rows[inew].Edition_Name, ds.Tables[0].Rows[inew].EDITION_CODE);
        if (dCheck == false)
            countGridElement = parseInt(countGridElement, 10) - 1;
        if (dCheck == true) {
            uomid = "uom" + i;
            var id = "Text" + i;
            editid = "edit" + i;

            inserts = "ins" + i;
            colid = "col" + i;
            agrred = "agr" + i;
            noofcol = "nocol" + i;

            if (i % noofinsert == 0 || i % totval == 0) {
                insertval = parseInt(ds.Tables[0].Rows[inew].IDNUM) + 1;
                //str=str+"<tr ><td align=\"center\" id="+inserts+" class=\"TextField\" >"+insertval+"</td><td class=\"dtGrid\" ><input class=\"btextforgrid\" type=\"text\" disabled id="+editid+" value="+ds.Tables[0].Rows[i].Edition_Name+"></td>";
                Make_Row = document.createElement("tr");
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.setAttribute("class", "TextField");
                make_td.innerHTML = insertval;
                make_td.id = inserts;
                if (insprev != insertval) {
                    insprev = insertval;
                    make_td.title = "Edit Insert";
                }
                Make_Row.appendChild(make_td);
                // EDITION
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.setAttribute("class", "dtGrid");
                str = "<input class=\"btextforgrid7\" type=\"text\"  title='" + ds.Tables[0].Rows[inew].SHTNAME + "' disabled id=" + editid + " value='" + ds.Tables[0].Rows[inew].Edition_Name + "'>";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
            else {
                insertval = parseInt(ds.Tables[0].Rows[inew].IDNUM) + 1;
                // str=str+"<tr ><td align=\"center\" id="+inserts+" class=\"TextField\" >"+insertval+"</td><td class=\"dtGrid\" ><input class=\"btextforgrid\" type=\"text\" disabled id="+editid+" value="+ds.Tables[0].Rows[i].Edition_Name+"></td>";

                Make_Row = document.createElement("tr");
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.setAttribute("class", "TextField");
                make_td.innerHTML = insertval;
                make_td.id = inserts;
                if (insprev != insertval) {
                    insprev = insertval;
                    make_td.title = "Edit Insert";
                }
                Make_Row.appendChild(make_td);
                // EDITION
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.setAttribute("class", "dtGrid");
                str = "<input class=\"btextforgrid7\" type=\"text\" title='" + ds.Tables[0].Rows[inew].SHTNAME + "'  disabled id=" + editid + " value='" + ds.Tables[0].Rows[inew].Edition_Name + "'>";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
            if (ds.Tables[0].Rows[inew].Date == null) {
                ds.Tables[0].Rows[inew].Date = "";
            }
            //str=str + "<td><input class=\"btextforgrid\" type=\"text\" id="+id+"  value="+ds.Tables[0].Rows[i].Date+" ><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1."+id+", Form1."+id+", "+dat+");\" height=\"14\" width=\"14\" /></td>";
            make_td = document.createElement("td");
            make_td.align = "center";
            //str="<input class=\"btextforgrid\" type=\"text\" id="+id+"  value='"+ds.Tables[0].Rows[inew].Date+"'  >";
            str = "<input class=\"btextforgriddate\" type=\"text\" id=" + id + "  value='" + ds.Tables[0].Rows[inew].Date + "'  >";

            //str="<input class=\"btextforgrid\" type=\"text\" id="+id+" value="+nDate+" ><img src=\"Images/cal1.gif\" height=\"14\" width=\"14\" />";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);


            filename = "fil" + i;

            //    str=str+"</select></td><td><input class=\"btextforgrid\" type=\"text\" id="+filename+" disabled  value=\"\"></td><td>";
            make_td = document.createElement("td");
            make_td.align = "center";
            str = "<input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled  value=\"\">";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);

            var upl = "upload" + i;
            //str=str+"<td width=\"50px\"><input  class=\"button1\" type=\"button\" Value=\"Attachment\" onclick=\"uploadimage('"+picfield+"','"+insertval+"','"+editid+"','"+filename+"','"+i+"')\">";
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input  class=\"button1\" type=\"button\" id=" + upl + " Value=\"Attachment\" >";
            Make_Row.appendChild(make_td);


            ////this is to bind the Ad sub cat drop down

            adsubcat = "ads" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.setAttribute("class", "dtGrid");
            if (adsubcat_vari.value != '0') {
                if (i == 0) {
                    str = "<input class=\"btextforgrid\" type=\"text\"  id=" + adsubcat + " value=" + adsubcat_vari.value + "><div id='agdiv' Width=100px Height=50px style='position:absolute;display: none;'><select name='aglist'  id='aglist' CssClass='btextlist' size=8 Width=120px Height=100px></select></div>";
                }
                else {
                    str = "<input class=\"btextforgrid\" type=\"text\"  id=" + adsubcat + " value=" + adsubcat_vari.value + ">";
                }
            }
            else {
                if (i == 0) {
                    str = "<input class=\"btextforgrid\" type=\"text\"  id=" + adsubcat + " value=''><div id='agdiv' style='position:absolute;display: none;' Width=100px Height=50px><select name='aglist' id='aglist'  class='btextlist' size=8 Width=120px Height=100px></select></div>";
                }
                else {
                    str = "<input class=\"btextforgrid\" type=\"text\"  id=" + adsubcat + " value=''>";
                }
            }

            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);

            //this is to bind the color drop down
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.setAttribute("class", "dropdownforgrid");
            if (color_vari.value != '0') {
                str = "<input class=\"btextforgrid\" type=\"text\"  id=" + colid + " value=" + color_vari.value + ">";
            }
            else {
                str = "<input class=\"btextforgrid\" type=\"text\"  id=" + colid + " value=''>";
            }

            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);

            premid = "prem" + i;
            prem1id = "premone" + i;
            height = "hei" + i;
            width = "wid" + i;
            size = "siz" + i;
            pagepost = "pgpre" + i;  //"pagpos"+i;
            //////// on change function is there to calculate the size 
            //str=str+"</select></td><td><input class=\"btextforbook\" id="+height+" type=\"text\"  value=\"\"></td><td><input class=\"btextforbook\" id="+width+" onchange=\"return gettotalsize("+height+","+width+","+i+");\" type=\"text\"  value=\"\"></td><td><input class=\"btextforbook\" disabled id="+size+" type=\"text\"  value=\"\"></td><td><select id="+premid+" class=\"dropdownforbook\" onchange=\"return getpercenprem("+premid+","+i+");\"  >";
            //str=str+"</select></td><td><input class=\"btextsmallsize\" id="+height+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+");\" onkeypress=\"javascript:return rateenter(event);\" type=\"text\"  value="+document.getElementById('txtadsize1').value+"></td><td><input class=\"btextsmallsize\" id="+width+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+");\" onkeypress=\"javascript:return rateenter(event);\" type=\"text\"  value="+document.getElementById('txtadsize2').value+"></td><td><input class=\"btextsmallsize\" disabled id="+size+" type=\"text\"  value="+document.getElementById('txttotalarea').value+"></td>";

            if (uom_vari.value != "0" && hiddenuom_vari.value != "CD") {
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\" btextsmallsizeH\" style=\"background-color: Gray;\" disabled id=" + height + "  type=\"text\"  value=" + adsize1_vari.value + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);

                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextsmallsizeH\" style=\"background-color: Gray;\" disabled id=" + width + "   type=\"text\"  value=" + adsize2_vari.value + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);

                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextsmallsizeH\"   disabled id=" + noofcol + "   type=\"text\"  value=" + column_vari.value + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);

                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextsmallsize\"   id=" + size + " type=\"text\"  value=" + totalarea_vari.value + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);

                // for bold charcter count
                var splboldsize = "splboldsize" + i;
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input  class=\"btextsmallsize\"  type=\"text\" id=" + splboldsize + " Value=\"\" >";
                Make_Row.appendChild(make_td);

                //str=str+"</select></td><td><input class=\" btextsmallsize\" style=\"background-color: Gray;\" disabled id="+height+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(event);\" type=\"text\"  value="+document.getElementById('txtadsize1').value+"></td><td><input class=\"btextsmallsize\" style=\"background-color: Gray;\" disabled id="+width+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(event);\" type=\"text\"  value="+document.getElementById('txtadsize2').value+"></td><td><input class=\"btextsmallsize\" disabled id="+noofcol+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(event);\" type=\"text\"  value="+document.getElementById('txtcolum').value+"></td><td><input class=\"btextsmallsize\" disabled id="+size+" type=\"text\" onchange=\"return getsoloextrarate("+adsubcat+","+colid+","+editid+","+size+","+adcat+","+gross+","+i+");\" value="+document.getElementById('txttotalarea').value+"></td>";
            }
            else {
                if (column_vari.disabled == true) {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input class=\"btextsmallsizeH\" style=\" background-color: White;\" id=" + height + "   type=\"text\"  value=" + adsize1_vari.value + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input class=\"btextsmallsizeH\" id=" + width + " style=\"background-color:White;\"   type=\"text\"  value=" + adsize2_vari.value + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input class=\"btextsmallsizeH\" disabled id=" + noofcol + "  type=\"text\"  value=" + column_vari.value + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  value=" + totalarea_vari.value + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    var splboldsize = "splboldsize" + i;
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + splboldsize + " Value=\"\" >";
                    Make_Row.appendChild(make_td);

                }
                else {
                    if (document.getElementById('hdnprefcomngrd').value == 'Y') {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextsmallsizeH\" style=\" background-color: White;\" id=" + height + "   type=\"text\"  value=" + adsize1_vari.value + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);

                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextsmallsizeH\"  id=" + width + " style=\"background-color:White;\"   type=\"text\"  value=" + adsize2_vari.value + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);

                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextsmallsizeH\"  id=" + noofcol + "   type=\"text\"  value=" + column_vari.value + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);

                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  value=" + totalarea_vari.value + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);

                        var splboldsize = "splboldsize" + i;
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + splboldsize + " Value=\"\" >";
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextsmallsizeH\" style=\" background-color: White;\" disabled id=" + height + "   type=\"text\"  value=" + adsize1_vari.value + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);

                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextsmallsizeH\" disabled id=" + width + " style=\"background-color:White;\"   type=\"text\"  value=" + adsize2_vari.value + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);

                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextsmallsizeH\" disabled id=" + noofcol + "   type=\"text\"  value=" + column_vari.value + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);

                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  value=" + totalarea_vari.value + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);

                        var splboldsize = "splboldsize" + i;
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + splboldsize + " Value=\"\" >";
                        Make_Row.appendChild(make_td);

                    }

                }
            }


            /////////////this is to bind the status material drop down
            matsta = "mat" + i;

            //material status   
            matsta = "mat" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (matsta_vari.value != "0") {
                str = "<input class=\"btextforgrid\"  id=" + matsta + " type=\"text\"  value=" + matsta_vari.value + ">";
            }
            else {
                str = "<input class=\"btextforgrid\"  id=" + matsta + " type=\"text\">";
            }
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);

            cardid = "card" + i;

            //this is the function cretaed to get the solo edition rate break up with referrence  to the package selected 
            /////////////////////////////////////////////////////////////////////////////////////////////////////////////
            //
            /////////////////////////////////////////////////////////////////////////////////////////////////////////////
            /////////////////////////////////////////////////////////////////////////////////////////////////////////////
            //insert status
            insertsta = "inssta" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\" disabled  type=\"text\" id=" + insertsta + "  value='booked'>";
            Make_Row.appendChild(make_td);

            // for resource no

            var resourceno = "resno" + i;
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[79].childNodes[0].nodeValue == "enable") {

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\"  type=\"text\" id=" + resourceno + "  value=''>";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(39).text == "enable") {

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\"  type=\"text\" id=" + resourceno + "  value=''>";
                    Make_Row.appendChild(make_td);

                }
            }
            // for sectioncode

            var sectioncode = "seccode" + i;
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[77].childNodes[0].nodeValue == "enable") {

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\"  type=\"text\" id=" + sectioncode + "  value=''>";
                    Make_Row.appendChild(make_td);
                }
                else {
                    //                        make_td=document.createElement("td");
                    //                         make_td.align="center";
                    //                         make_td.innerHTML="";
                    //                         Make_Row.appendChild(make_td);
                    // str=str+"<td ></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(38).text == "enable") {

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\"  type=\"text\" id=" + sectioncode + "  value=''>";
                    Make_Row.appendChild(make_td);

                }
                else {
                    //	                     make_td=document.createElement("td");
                    //                         make_td.align="center";
                    //                         make_td.innerHTML="";
                    //                         Make_Row.appendChild(make_td);
                }
            }


            var cs = 0;
            for (cs = 0; cs <= ds.Tables[8].Rows.length - 1; cs++) {
                if (ds.Tables[0].Rows[i].Edition_Name != undefined) {
                    if (ds.Tables[0].Rows[i].Edition_Name == ds.Tables[8].Rows[cs].Edition_Name) {
                        //str=str+"<input class=\"btextforgrid\" disabled type=\"text\" id="+cardid+" value="+ds.Tables[8].Rows[cs].weekrate+">";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\"  id=" + cardid + " value=" + ds.Tables[8].Rows[cs].weekrate + ">";
                        Make_Row.appendChild(make_td);
                    }
                }

            }
            ///////////////////////

            if (ds.Tables[8].Rows.length == 0) {
                //str=str+"<input class=\"btextforgrid\" disabled type=\"text\" id="+cardid+" value=\"\">";
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\"  id=" + cardid + " value=\"\">";
                Make_Row.appendChild(make_td);
            }
            ///////////////////////
            discrate = "disrat" + i;
            insertsta = "inssta" + i;
            billstat = "bill" + i;
            discrate = "disrat" + i;
            insertsta = "inssta" + i;
            billstat = "bill" + i;
            // str=str+"</td><td><input class=\"btextforgrid\" disabled type=\"text\" id="+discrate+"  value=\"\"></td>";
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\" type=\"text\" id=" + discrate + "  value=\"\">";
            Make_Row.appendChild(make_td);

            // str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+agrred+"  value=\"\"></td>";
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agrred + "  value=\"\">";
            Make_Row.appendChild(make_td);

            


            ////////////this is to for larest date

            late = "lat" + i;

            repeat = "rep" + i;
            var dat = "mm+" / "+" / "+dd+" / "+yyyy";
            //str=str+"</select></td><td><input class=\"btextforgrid\" type=\"text\" id="+late+"  value=\"\" onchange=\"javascript:return checkdate(Form1."+late+");\" onkeypress=\"return dateenter();\"><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1."+late+", Form1."+late+", "+dat+");\" height=\"14\" width=\"14\" /> </td><td><input class=\"btextforgrid\" type=\"text\" id="+repeat+"  value=\"\" onchange=\"javascript:return checkdate(Form1."+repeat+");\" onkeypress=\"return dateenter();\"><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1."+repeat+", Form1."+repeat+", "+dat+");\" height=\"14\" width=\"14\" /></td>";
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[1].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + late + "   value=\"\" >";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + late + "   value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
                if (xmlObj.childNodes[25].childNodes[3].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + repeat + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + repeat + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }

            }
            else {
                if (xmlObj.childNodes[12].childNodes[0].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + late + "   value=\"\" >";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + late + "   value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
                if (xmlObj.childNodes[12].childNodes[1].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + repeat + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + repeat + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }

            }

            namecode = "one";


            premper = "premper" + i;
            premper1 = "premperone" + i;
            adtypid = "adtyp" + i;
            namecode = "two";
            preall = "preall" + i;
            adcat = "adcat" + i;
            page = "pgpre" + i;
            pageprem = "pagper" + i;
            var h;



            ///this is to bind the page prem 2 drp down
            pagstr = "sec"
            make_td = document.createElement("td");
            make_td.align = "center";
            if (drppagepos_vari.value == '0') {
                make_td.innerHTML = "<input class=\"btextsmallsizeH\" type=\"text\" id=" + page + "   value=\"\">";
            }
            else {
                make_td.innerHTML = "<input class=\"btextsmallsizeH\" type=\"text\" id=" + page + "   value='" + drppagepos_vari.value + "'>";
            }

            Make_Row.appendChild(make_td);

            ////this is to bind the per for page premium

            // str=str+"</select></td><td><input disabled class=\"btextsmallsize\" type=\"text\" id="+pageprem+" value=\"\"></td>"
            make_td = document.createElement("td");
            make_td.align = "center";
            //   str="</select></td><td><input disabled class=\"btextsmallsize\" type=\"text\" id="+pageprem+" value=\"\"></td>"
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id=" + pageprem + " value=\"\">";
            Make_Row.appendChild(make_td);

            ///////////////////////////////////////////////

            // str=str+"<td><select id="+preall+" class=\"dropdownforgrid\">";
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[5].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<select id=" + preall + " disabled class=\"dropdownforgrid\">";
                    str = str + "<option value=\"0\">Select</option>";
                    str = str + "<option value=\"1\">Yes</option>";
                    str = str + "<option value=\"2\">No</option>";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<select id=" + preall + "  class=\"dropdownforgrid\">";
                    str = str + "<option value=\"0\">Select</option>";
                    str = str + "<option value=\"1\">Yes</option>";
                    str = str + "<option value=\"2\">No</option>";
                    make_td.innerHTML = str;
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            } else {
                if (xmlObj.childNodes[12].childNodes[2].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<select id=" + preall + " disabled class=\"dropdownforgrid\">";
                    str = str + "<option value=\"0\">Select</option>";
                    str = str + "<option value=\"1\">Yes</option>";
                    str = str + "<option value=\"2\">No</option>";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<select id=" + preall + "  class=\"dropdownforgrid\">";
                    str = str + "<option value=\"0\">Select</option>";
                    str = str + "<option value=\"1\">Yes</option>";
                    str = str + "<option value=\"2\">No</option>";
                    make_td.innerHTML = str;
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            //////////////this is to bind the drop down for accepting the premium


            make_td = document.createElement("td");
            make_td.align = "center";
            if (adcat_vari.value != '0') {
                make_td.innerHTML = "<input  class=\"dropdownforgrid\" type=\"text\" id=" + adcat + " value='" + adcat_vari.value + "'>";
            }
            else {
                make_td.innerHTML = "<input  class=\"dropdownforgrid\" type=\"text\" id=" + adcat + " >";
            }
            Make_Row.appendChild(make_td);

            str = str + "<td><select id=" + billstat + " class=\"dropdownforgrid\">";

            /////////////this function is to bind the bill status dropdown

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[7].childNodes[0].nodeValue != "hide") {
                    if (dbill == "") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        dbill = dbill + "<select id=" + billstat + " class=\"dropdownforgrid\">";

                        /////////////this function is to bind the bill status dropdown

                        var c = 0;
                        BILL_STATUS = '';
                        for (c = 1; c <= xmlObj.childNodes[3].childNodes.length - 1; c = c + 4) {
                            dbill = dbill + "<option value=" + xmlObj.childNodes[3].childNodes[c + 2].childNodes[0].nodeValue + ">" + xmlObj.childNodes[3].childNodes[c].childNodes[0].nodeValue + "</option>";
                            BILL_STATUS = BILL_STATUS + "<option value=" + xmlObj.childNodes[3].childNodes[c + 2].childNodes[0].nodeValue + ">" + xmlObj.childNodes[3].childNodes[c].childNodes[0].nodeValue + "</option>";
                        }
                        dbill = dbill + "</select>";
                        make_td.innerHTML = dbill;
                        Make_Row.appendChild(make_td);
                        //str=str+dbill;
                    }
                    else {
                        // str=str+dbill.replace("bill"+dcou,billstat);          
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = dbill.replace("bill" + dcou, billstat);
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                }
                else {
                    if (dbill == "") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        dbill = dbill + "<select id=" + billstat + " class=\"dropdownforgrid\">";

                        /////////////this function is to bind the bill status dropdown

                        var c = 0;
                        BILL_STATUS = '';
                        for (c = 1; c <= xmlObj.childNodes[3].childNodes.length - 1; c = c + 4) {
                            dbill = dbill + "<option value=" + xmlObj.childNodes[3].childNodes[c + 2].childNodes[0].nodeValue + ">" + xmlObj.childNodes[3].childNodes[c].childNodes[0].nodeValue + "</option>";
                            BILL_STATUS = BILL_STATUS + "<option value=" + xmlObj.childNodes[3].childNodes[c + 2].childNodes[0].nodeValue + ">" + xmlObj.childNodes[3].childNodes[c].childNodes[0].nodeValue + "</option>";
                        }
                        dbill = dbill + "</select>";
                        make_td.innerHTML = dbill;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                        //str=str+dbill;
                    }
                    else {
                        // str=str+dbill.replace("bill"+dcou,billstat);          
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = dbill.replace("bill" + dcou, billstat);
                        make_td.innerHTML = str;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }
            }

            else {
                if (xmlObj.childNodes[12].childNodes[2].childNodes[0].nodeValue != "hide") {
                    if (dbill == "") {
                        if (xmlObj.childNodes(1) == null) {
                            loadXML('xml/billcycle.xml');
                        }
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        dbill = dbill + "<select id=" + billstat + " class=\"dropdownforgrid\">";
                        var c = 0;
                        for (c = 0; c <= xmlObj.childNodes(1).childNodes.length - 1; c++) {
                            dbill = dbill + "<option value=" + xmlObj.childNodes(1).childNodes(c + 1).text + ">" + xmlObj.childNodes(1).childNodes(c).text + "</option>";
                            c = c + 1;
                        }

                        dbill = dbill + "</select>";
                        //str=str+dbill;   
                        make_td.innerHTML = dbill;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        // str=str+dbill.replace("bill"+dcou,billstat);             
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = dbill.replace("bill" + dcou, billstat);
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                }
                else {
                    if (dbill == "") {
                        if (xmlObj.childNodes(1) == null) {
                            loadXML('xml/billcycle.xml');
                        }
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        dbill = dbill + "<select id=" + billstat + " class=\"dropdownforgrid\">";
                        var c = 0;
                        for (c = 0; c <= xmlObj.childNodes(1).childNodes.length - 1; c++) {
                            dbill = dbill + "<option value=" + xmlObj.childNodes(1).childNodes(c + 1).text + ">" + xmlObj.childNodes(1).childNodes(c).text + "</option>";
                            c = c + 1;
                        }

                        dbill = dbill + "</select>";
                        //str=str+dbill;
                        make_td.innerHTML = dbill;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        // str=str+dbill.replace("bill"+dcou,billstat);             
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = dbill.replace("bill" + dcou, billstat);
                        make_td.innerHTML = str;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }

            }

            paid = "pai" + i;
            solo = "sol" + i;
            gross = "gro" + i;
            var discount_ = "disc_" + i;
            ///////////////this is to bind the drop down for paid/free insertion

            if (ds.Tables[9].Rows[0].Paid_permission == "0") {
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[25].childNodes[13].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        if (document.getElementById('hiddisceditgrid').value == "Y")
                            make_td.innerHTML = "<input class=\"btextsmallsizeH\" type=\"text\" id=" + discount_ + "   value=\"\" >";
                        else
                            make_td.innerHTML = "<input class=\"btextsmallsizeH\" disabled type=\"text\" id=" + discount_ + "   value=\"\" >";
                        Make_Row.appendChild(make_td);
                    }
                    if (dpaid == "") {
                        //23sep  dpaid=dpaid+"<td><select id="+paid+" class=\"dropdownforgridsmall\" disabled onchange=\"putpaidintoinsert("+paid+","+inserts+","+insertval+");\">";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        dpaid = dpaid + "<select id=" + paid + " class=\"dropdownforgridsmall\" disabled>";
                        dpaid = dpaid + "<option value=\"Y\">Yes</option>";
                        dpaid = dpaid + "<option value=\"N\">No</option>";
                        dpaid = dpaid + "<option value=\"P\">Paid</option>";
                        dpaid = dpaid + "</select>";
                        // str=str+dpaid; 
                        make_td.innerHTML = dpaid;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = dpaid.replace("pai" + dcou, paid);
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);

                    }

                }
                else {
                    if (xmlObj.childNodes[12].childNodes[6].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        if (document.getElementById('hiddisceditgrid').value == "Y")
                            make_td.innerHTML = "<input class=\"btextsmallsizeH\" type=\"text\" id=" + discount_ + "   value=\"\" >";
                        else
                            make_td.innerHTML = "<input class=\"btextsmallsizeH\" disabled type=\"text\" id=" + discount_ + "   value=\"\" >";
                        Make_Row.appendChild(make_td);
                    }
                    if (dpaid == "") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        dpaid = dpaid + "<select id=" + paid + " class=\"dropdownforgridsmall\" disabled >";
                        dpaid = dpaid + "<option value=\"Y\">Yes</option>";
                        dpaid = dpaid + "<option value=\"N\">No</option>";
                        dpaid = dpaid + "<option value=\"P\">Paid</option>";
                        dpaid = dpaid + "</select>";
                        // str=str+dpaid; 
                        make_td.innerHTML = dpaid;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        // str=str+dpaid.replace("pai"+dcou,paid);  
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = dpaid.replace("pai" + dcou, paid);
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }

                }
            }
            else {
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[25].childNodes[13].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        if (document.getElementById('hiddisceditgrid').value == "Y")
                            make_td.innerHTML = "<input class=\"btextsmallsizeH\" type=\"text\" id=" + discount_ + "   value=\"\" >";
                        else
                            make_td.innerHTML = "<input class=\"btextsmallsizeH\" disabled type=\"text\" id=" + discount_ + "   value=\"\" >";
                        Make_Row.appendChild(make_td);
                    }
                    if (xmlObj.childNodes[23].childNodes[37].childNodes[0].nodeValue == "enable") {
                        if (dpaid == "") {
                            //23sep   dpaid=dpaid+"<td><select id="+paid+" class=\"dropdownforgridsmall\" onchange=\"putpaidintoinsert("+paid+","+inserts+","+insertval+");\">";
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dpaid = dpaid + "<select id=" + paid + " class=\"dropdownforgridsmall\">";
                            dpaid = dpaid + "<option value=\"Y\">Yes</option>";
                            dpaid = dpaid + "<option value=\"N\">No</option>";
                            dpaid = dpaid + "<option value=\"P\">Paid</option>";
                            dpaid = dpaid + "</select>";
                            //  str=str+dpaid;  
                            make_td.innerHTML = dpaid;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            //  str=str+dpaid.replace("pai"+dcou,paid);   
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dpaid.replace("pai" + dcou, paid);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                        }
                    }
                    else {
                        if (dpaid == "") {
                            //23sep   dpaid=dpaid+"<td><select id="+paid+" class=\"dropdownforgridsmall\" onchange=\"putpaidintoinsert("+paid+","+inserts+","+insertval+");\">";
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dpaid = dpaid + "<select id=" + paid + " class=\"dropdownforgridsmall\" disabled >";
                            dpaid = dpaid + "<option value=\"Y\">Yes</option>";
                            dpaid = dpaid + "<option value=\"N\">No</option>";
                            dpaid = dpaid + "<option value=\"P\">Paid</option>";
                            dpaid = dpaid + "</select>";
                            //  str=str+dpaid;  
                            make_td.innerHTML = dpaid;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            //  str=str+dpaid.replace("pai"+dcou,paid);   
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dpaid.replace("pai" + dcou, paid);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                        }
                    }
                }
                else {
                    if (xmlObj.childNodes[12].childNodes[6].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        if (document.getElementById('hiddisceditgrid').value == "Y")
                            make_td.innerHTML = "<input class=\"btextsmallsizeH\" type=\"text\" id=" + discount_ + "   value=\"\" >";
                        else
                            make_td.innerHTML = "<input class=\"btextsmallsizeH\" disabled type=\"text\" id=" + discount_ + "   value=\"\" >";
                        Make_Row.appendChild(make_td);
                    }
                    if (xmlObj.childNodes[11].childNodes[18].childNodes[0].nodeValue == "enable") {
                        if (dpaid == "") {
                            //23sep  dpaid=dpaid+"<td><select id="+paid+" class=\"dropdownforgridsmall\" onchange=\"putpaidintoinsert("+paid+","+inserts+","+insertval+");\">";
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dpaid = dpaid + "<select id=" + paid + " class=\"dropdownforgridsmall\" >";
                            dpaid = dpaid + "<option value=\"Y\">Yes</option>";
                            dpaid = dpaid + "<option value=\"N\">No</option>";
                            dpaid = dpaid + "<option value=\"P\">Paid</option>";
                            dpaid = dpaid + "</select>";
                            //  str=str+dpaid;   
                            make_td.innerHTML = dpaid;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            // str=str+dpaid.replace("pai"+dcou,paid);                    
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dpaid.replace("pai" + dcou, paid);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                        }
                    } else {
                        if (dpaid == "") {
                            //23sep  dpaid=dpaid+"<td><select id="+paid+" class=\"dropdownforgridsmall\" onchange=\"putpaidintoinsert("+paid+","+inserts+","+insertval+");\">";
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dpaid = dpaid + "<select id=" + paid + " class=\"dropdownforgridsmall\" disabled>";
                            dpaid = dpaid + "<option value=\"Y\">Yes</option>";
                            dpaid = dpaid + "<option value=\"N\">No</option>";
                            dpaid = dpaid + "<option value=\"P\">Paid</option>";
                            dpaid = dpaid + "</select>";
                            //  str=str+dpaid;   
                            make_td.innerHTML = dpaid;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            // str=str+dpaid.replace("pai"+dcou,paid);                    
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dpaid.replace("pai" + dcou, paid);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                        }
                    }

                }
            }

            //this is to upload the image

            picfield = "pic" + i;
            pageno_inserts = "pagno" + i; ;
            remark_inserts = "rem" + i;
            caption_inserts = "cap" + i;
            billamt = "ba" + i;
            billrate = "br" + i;
            agnamnt = "agmn" + i;
            adlagn = "adlag" + i;
            spldisc = "spld" + i;
            cashdisc = "cashd" + i;
            roundoffval = "roundoffval" + i;
            pheival = "pheival" + i;
            
            str = str + "</select></td>";

            //str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+solo+"  value=\"\"></td>";
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + solo + "  value=\"\">";
            Make_Row.appendChild(make_td);

            //str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+gross+"  value=\"\"></td>";
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + gross + "  value=\"\">";
            Make_Row.appendChild(make_td);

            // str=str+"<td><input class=\"btextforinsertright\"  onkeypress=\"javascript:return rateenter(event);\"  type=\"text\" id="+pageno_inserts+"  value=\"\"></td>";
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input  class=\"btextforinsertright\" onkeypress=\"javascript:return rateenter(event);\"   type=\"text\" id=" + pageno_inserts + "  value=\"\">";
            Make_Row.appendChild(make_td);

            //  str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+remark_inserts+"  value=\"\"></td>";

            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input  class=\"btextforgrid\"    type=\"text\" id=" + caption_inserts + "  value=\"\">";
            Make_Row.appendChild(make_td);

            make_td = document.createElement("td");
            make_td.align = "center";
            if (remarks_per.value != '') {
                make_td.innerHTML = "<input  class=\"btextforgrid\" type=\"text\" id=" + remark_inserts + " value='" + remarks_per.value + "'>";
            }
            else {
                make_td.innerHTML = "<input  class=\"btextforgrid\"    type=\"text\" id=" + remark_inserts + "  value=\"\">";
            }
            Make_Row.appendChild(make_td);
            // str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billamt+"  value=\"\"></td>";
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforinsertright\" disabled type=\"text\" title='" + "Insert No:" + insertval + ",Edition:" + ds.Tables[0].Rows[inew].Edition_Name + ",Date:" + ds.Tables[0].Rows[inew].Date + "' id=" + billamt + "  value=\"\">";
            Make_Row.appendChild(make_td);

            // new field for local gross and local bill amount
            var grosslocal = "grolocal" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + grosslocal + "  value=\"\">";
            Make_Row.appendChild(make_td);

            // str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billamt+"  value=\"\"></td>";
            var billamtlocal = "balocal" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + billamtlocal + "  value=\"\">";
            Make_Row.appendChild(make_td);


            //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[9].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + billrate + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + billrate + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[4].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + billrate + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + billrate + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[15].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agnamnt + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agnamnt + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[7].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agnamnt + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agnamnt + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[17].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + adlagn + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + adlagn + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[8].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + adlagn + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + adlagn + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[19].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + spldisc + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + spldisc + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[9].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + spldisc + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + spldisc + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[21].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cashdisc + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cashdisc + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[10].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cashdisc + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cashdisc + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[23].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + roundoffval + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + roundoffval + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[11].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + roundoffval + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + roundoffval + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[25].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + pheival + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + pheival + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[12].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + pheival + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + pheival + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            //     make_td=document.createElement("td");
            //     make_td.align="center";
            //     make_td.innerHTML="<input  type=\"hidden\" id="+vtsid+">";
            //     Make_Row.appendChild(make_td);


            


            // for split button

            var splt = "splt" + i;
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[73].childNodes[0].nodeValue == "enable" && document.getElementById('hiddenuomdesc').value == "CD" && ds.Tables[0].Rows[i].PRIORITY != '1' && ds.Tables[0].Rows[i].PRIORITY != null && ds.Tables[0].Rows[i].SPLIT == 'Y')// ds.Tables[0].Rows[i].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                {

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input   class=\"buttonsplit\" type=\"button\" id=" + splt + " Value=\"Split\" >";
                    Make_Row.appendChild(make_td);
                    // str=str+"<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" id="+splt+" Value=\"Split\" ></td>";

                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(36).text == "enable" && document.getElementById('hiddenuomdesc').value == "CD" && ds.Tables[0].Rows[i].PRIORITY != '1' && ds.Tables[0].Rows[i].PRIORITY != null && ds.Tables[0].Rows[i].SPLIT == 'Y')// ds.Tables[0].Rows[i].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                {

                    // str=str+"<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" id="+splt+" Value=\"Split\" ></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input   class=\"buttonsplit\" type=\"button\" id=" + splt + " Value=\"Split\" >";
                    Make_Row.appendChild(make_td);

                }
                else {
                    //  str=str+"<td ></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "";
                    Make_Row.appendChild(make_td);
                }
            }
            // for sub edition detail button

            var subedi = "subedi" + i;
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[75].childNodes[0].nodeValue == "enable")// ds.Tables[0].Rows[i].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                {

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input   class=\"buttonsplit\" type=\"button\" id=" + subedi + " Value=\"Detail\">";
                    Make_Row.appendChild(make_td);
                    //str=str+"<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" id="+subedi+" Value=\"Detail\"></td>";

                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "";
                    Make_Row.appendChild(make_td);
                    // str=str+"<td ></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(37).text == "enable")// ds.Tables[0].Rows[i].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                {

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input   class=\"buttonsplit\" type=\"button\" id=" + subedi + " Value=\"Detail\">";
                    Make_Row.appendChild(make_td);
                    //str=str+"<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" id="+subedi+" Value=\"Detail\" ></td>";

                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "";
                    Make_Row.appendChild(make_td);
                }
            }


            // for VTS Button
            var vtsbtnid = "vtsbtn" + i;
            var vtsid = "vts" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input  class=\"button1\" type=\"button\" id=" + vtsbtnid + " Value=\"VTS\"><input  type=\"hidden\" id=" + vtsid + ">";
            Make_Row.appendChild(make_td);
            //   showid="sho"+i;
            //                    make_td=document.createElement("td");
            //                    make_td.align="center";
            //                    str="<input class=\"btextforgrid\" style=\"display:none;\" type=\"text\" id="+showid+"  value='0'>";
            //                    make_td.innerHTML=str;
            //                    Make_Row.appendChild(make_td);

            // for logo
            var logohei = "logohei" + i;
            var logowid = "logowid" + i;
            var logonam = "logonam" + i;

            ///bhanu
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[11].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logohei + " Value=\"\" >";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logowid + " Value=\"\" >";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"dropdownforgrid\" disabled type=\"text\" id=" + logonam + " Value=\"\" >";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"btextsmallsize\"  type=\"text\" id=" + logohei + " Value=\"\" >";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"btextsmallsize\" type=\"text\" id=" + logowid + " Value=\"\" >";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"dropdownforgrid\" type=\"text\" id=" + logonam + " Value=\"\" >";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[5].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logohei + " Value=\"\" >";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logowid + " Value=\"\" >";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"dropdownforgrid\" disabled type=\"text\" id=" + logonam + " Value=\"\" >";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"btextsmallsize\"  type=\"text\" id=" + logohei + " Value=\"\" >";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"btextsmallsize\"  type=\"text\" id=" + logowid + " Value=\"\" >";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"dropdownforgrid\" type=\"text\" id=" + logonam + " Value=\"\" >";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }





            // for logo
            //22SEP09
            pkgcodegrid = 'hiddenpckcode' + i;
            //str=str+"<td><input disabled class=\"btextsmallsize\" type=\"text\" id='"+pkgcodegrid+"' value="+ds.Tables[0].Rows[i].EDITION_CODE+"></td>";
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkgcodegrid + "' value='" + ds.Tables[0].Rows[inew].EDITION_CODE + "'>";
            Make_Row.appendChild(make_td);
            var pubcode = 'pubcode' + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pubcode + "' value='" + ds.Tables[0].Rows[inew].PUBCODE + "'>";
            Make_Row.appendChild(make_td);

            // for binding edition for preview   

            if (document.getElementById('drpedition').options.length >= 1) {
                //                          objedition.options.length = 0; 
                //                          objedition.options[0]=new Option("-Select-","0");
                if (ds.Tables[0].Rows[i].Edition_Name != undefined) {
                    document.getElementById('drpedition').options[document.getElementById('drpedition').options.length] = new Option(ds.Tables[0].Rows[i].Edition_Name, ds.Tables[0].Rows[i].Edition_Name);
                    document.getElementById('drpedition').options.length;
                }
            }
            // for binding edition for preview   
            //This below code for  puting the number of uccorance of packages into grid
            var pkg_ins = 'pkg_ins' + i;
            for (var countpkg = 0; countpkg < pkgcopy_vari.length; countpkg++) {
                var pkgcopy = pkgcopy_vari.options[countpkg].value;
                var arrpkgcopy = pkgcopy.split('@')
                var pkgcopycode = arrpkgcopy[0];
                var arr_pkg_ins_value = arrpkgcopy[1].split('(');
                var pkg_ins_value = arr_pkg_ins_value[1].replace(')', '');
                if (pkgcopycode == ds.Tables[0].Rows[inew].EDITION_CODE) {
                    // str=str+"<td><input disabled class=\"btextsmallsize\" type=\"text\" id='"+pkg_ins+"' value="+pkg_ins_value+"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_ins + "' value='" + pkg_ins_value + "'>";
                    Make_Row.appendChild(make_td);
                    countpkg = pkgcopy_vari.length;
                }
                /* else {
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_ins + "' value='" + pkg_ins_value + "'>";
                Make_Row.appendChild(make_td);
                countpkg = pkgcopy_vari.length;
                }*/
            }

            pkg_alias = 'pkg_alias' + i;
            //str=str+"<td><input disabled class=\"btextsmallsize\" type=\"text\" id='"+pkg_alias+"' value='"+ds.Tables[0].Rows[i].PKGNAME+"'></td>";
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_alias + "' value='" + ds.Tables[0].Rows[inew].PKGNAME + "'>";
            Make_Row.appendChild(make_td);


            var spltdata = "spltdata" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + spltdata + "' value=\"\">";
            Make_Row.appendChild(make_td);


            var subedidata = "subedidata" + i; make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + subedidata + "' value=\"\">";
            Make_Row.appendChild(make_td);

            var vat = "vat" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + vat + "' value=\"\">";
            Make_Row.appendChild(make_td);

            var boxc = "boxc" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + boxc + "' value=\"\">";
            Make_Row.appendChild(make_td);

            var vat_inc = "vat_inc" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + vat_inc + "' value=\"\">";
            Make_Row.appendChild(make_td);

            var coupan = "coupan" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + coupan + "' value=\"\">";
            Make_Row.appendChild(make_td);

            var clicatamt = "clicatamt" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + clicatamt + "' value=\"\">";
            Make_Row.appendChild(make_td);

            var flatfreqamt = "flatfreqamt" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + flatfreqamt + "' value=\"\">";
            Make_Row.appendChild(make_td);

            var catamt = "catamt" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + catamt + "' value=\"\">";
            Make_Row.appendChild(make_td);
            
            var GSTAMT = "GSTAMT" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + GSTAMT + "' value=\"\">";
            Make_Row.appendChild(make_td);
            
            var GSTGD  = "GSTGD" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + GSTGD  + "' value=\"\">";
            Make_Row.appendChild(make_td);

            if (online_flag == false && ds.Tables[0].Rows[inew].PUBTYPE == "IN0")// FOR INTERNET BOOKING
            {
                online_flag = true;
            }
            gridtab_vari.getElementsByTagName("tbody")[0].appendChild(Make_Row);
            /* if(ds.Tables[0].Rows[inew].Date!=null && ds.Tables[0].Rows[inew].Date!="")
            {
            dropDateCheck(ds.Tables[0].Rows[inew].Date,document.getElementById(id),ds.Tables[0].Rows[inew].EDITION_CODE,ds.Tables[0].Rows[inew].PKGNAME,ds.Tables[0].Rows[inew].Edition_Name);
            }    */
            //Date sew prob.
            i = parseInt(i, 10) + 1;
        }

    }

    //str= str + "</table></div>";
    //alert(str);
    if (online_flag == true) {
        online_flag = false;
        document.getElementById('chkonline').disabled = false;
    }
    else {
        document.getElementById('chkonline').disabled = true;
    }
    var dateformat_vari = document.getElementById('hiddendateformat');
    var compcode_vari = document.getElementById('hiddencompcode');
    var center_vari = document.getElementById('hiddencenter');
    var adtype_vari = document.getElementById('hiddenadtype');
    var chkall_vari = document.getElementById('chkall');
    var temp = idnew;
    idnew = ds.Tables[0].Rows.length;
    //  document.getElementById('tblinsert').innerHTML=str;
    // subtractrow="show";
    previnsertion = document.getElementById('txtinsertion').value;
    if (browserversion > 6) {
        $(".dropdownforgridsmall").change(function () {
            if (document.activeElement.id.indexOf("pai") >= 0) {
                blankGross();
            }
        });
        $(".btextsmallsizeH").change(function () {
            if (document.activeElement.id.indexOf("pgpre") >= 0 || document.activeElement.id.indexOf("nocol") >= 0 || document.activeElement.id.indexOf("hei") >= 0 || document.activeElement.id.indexOf("wid") >= 0 || document.activeElement.id.indexOf("ins") >= 0) {
                var i;
                if (document.activeElement.id.indexOf("disc_") >= 0) {
                    blankGross();
                }
                if (document.activeElement.id.indexOf("pgpre") >= 0) {
                    i = document.activeElement.id.substring(5, document.activeElement.id.length + 1);
                    var page = "pgpre" + i;
                    var pagstr = "sec";
                    var f = getpageprem(page, i, pagstr);
                    if (f == false)
                        return false;
                }
                else {
                    if (document.activeElement.id.indexOf("nocol") >= 0) {
                        i = document.activeElement.id.substring(5, document.activeElement.id.length + 1);

                    }
                    else {
                        i = document.activeElement.id.substring(3, document.activeElement.id.length + 1);

                    }
                    var height = "hei" + i;
                    var width = "wid" + i;
                    var inserts = "ins" + i;
                    var insertval = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(i, 10) + 1].cells[0].innerHTML;
                    var noofcol = "nocol" + i;
                    var f = gettotalsize(height, width, i, inserts, insertval, noofcol);
                    if (f == false)
                        return false;
                }
            }
        });
        $(".btextforgriddate").change(function () {
            if (document.activeElement.id.indexOf("Text") >= 0) {
                document.getElementById('txtgrossamt').value = "";
                document.getElementById('txtbillamt').value = "";
                document.getElementById('txtgrossamtlocal').value = "";
                document.getElementById('txtbillamtlocal').value = "";
                var f = chkDateforGrid(this);
                if (f == false)
                    return false;
            }
            else if (document.activeElement.id.indexOf("rep") >= 0 || document.activeElement.id.indexOf("lat") >= 0) {
                checkdate(document.getElementById(document.activeElement.id));
            }
        });
        for (i = 0; i < gridtab_vari.getElementsByTagName("tbody")[0].rows.length - 1; i++) {
            if (repeatdate == "0" || repeatdate == "1") {
                var id = "Text" + i;
                if (caldatemonth.length >= i) {
                    //   if(caldatemonth[i]!=undefined)
                    //    {
                    //var mmM=caldatemonth[i].toString();
                    //}
                    //else{
                    var mmM = parseInt(monthSelected, 10) + 1;
                    mmM = mmM.toString();
                    if (dateSelected.toString().length == 1)
                        dateSelected = "0" + dateSelected.toString();
                    // }
                }
                else {
                    var mmM = parseInt(monthSelected, 10) + 1;
                    mmM = mmM.toString();
                    if (dateSelected.toString().length == 1)
                        dateSelected = "0" + dateSelected.toString();
                }
                if (mmM.toString().length == 1)
                    mmM = "0" + mmM.toString();

                if (dateformat_vari.value == "mm/dd/yyyy") {
                    vvalue = mmM + "/" + dateSelected + "/" + yearSelected;
                }
                else if (dateformat_vari.value == "dd/mm/yyyy") {
                    vvalue = dateSelected + "/" + mmM + "/" + yearSelected; ;
                }
                else if (dateformat_vari.value = "yyyy/mm/dd") {
                    vvalue = yearSelected + "/" + mmM + "/" + dateSelected; ;
                }
                vvalue = document.getElementById('Text' + i).value;
                if (dateSelected != undefined && dateSelected != "") {
                    if (browser != "Microsoft Internet Explorer") {
                        var pkgfullname = document.getElementById('pkg_alias' + i).value;
                        var pkgid = document.getElementById('hiddenpckcode' + i).value;
                        var pkgname = document.getElementById('pkg_alias' + i).value;
                        var compcode = compcode_vari.value;

                        dateday = vvalue;

                        document.getElementById('Text' + i).value = vvalue;
                    }
                    else {
                        var pkgfullname = document.getElementById('pkg_alias' + i).value;
                        var pkgid = document.getElementById('hiddenpckcode' + i).value;
                        var pkgname = document.getElementById('pkg_alias' + i).value;
                        var compcode = compcode_vari.value;
                        dateday = vvalue;

                        document.getElementById('Text' + i).value = vvalue;
                    }
                    if (browser != "Microsoft Internet Explorer") {
                        var httpRequest = null; ;
                        httpRequest = new XMLHttpRequest();
                        if (httpRequest.overrideMimeType) {
                            httpRequest.overrideMimeType('text/xml');
                        }

                        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };
                        var adcat = adcat_vari.value;
                        httpRequest.open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
                        httpRequest.send('');
                        //alert(httpRequest.readyState);
                        if (httpRequest.readyState == 4) {
                            //alert(httpRequest.status);
                            if (httpRequest.status == 200) {
                                strtext = httpRequest.responseText;
                            }
                            else {
                                alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                            }
                        }
                    }
                    else {
                        validuse = "";
                        var xml = new ActiveXObject("Microsoft.XMLHTTP");
                        var adcat = adcat_vari;
                        var center = '';
                        if (center_vari != null) {
                            center = center_vari.value;
                            if (chkall_vari != null) {
                                if (chkall_vari.checked == true) {
                                    center = '0';
                                }
                            }
                            else {
                                center = '0';
                            }
                        }
                        xml.Open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
                        xml.Send();
                        strtext = xml.responseText;
                    }
                    if (strtext == "NOT A VALID DATE") {
                        alert("NOT A VALID DATE");
                        document.getElementById(id).value = "";
                        return false;
                    }
                    if (strtext == "0") {
                        //alert("Day is not the publishing day");
                        document.getElementById(id).value = "";
                        return false;
                    }
                    else {
                        if (strtext == "1")
                            document.getElementById(id).value = vvalue;
                        else {
                            if (strtext != "") {
                                if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                                    var txt = strtext;
                                    var txt1 = txt.split("/");
                                    var dd = txt1[0];
                                    var mm1 = txt1[1];
                                    var mm = txt1[1]; //getMonthNo(mm1);
                                    var yy = txt1[2];
                                    caldate[cali] = dd;
                                    caldatemonth[cali] = mm;
                                    caldateyear[cali] = yy;
                                    cali = parseInt(cali, 10) + 1;
                                }
                                else if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                                    var txt = strtext;
                                    var txt1 = txt.split("/");
                                    var dd = txt1[1];
                                    var mm1 = txt1[0];
                                    var mm = txt1[0]; //getMonthNo(mm1);
                                    var yy = txt1[2];
                                    caldate[cali] = dd;
                                    caldatemonth[cali] = mm;
                                    caldateyear[cali] = yy;
                                    cali = parseInt(cali, 10) + 1;
                                }
                                else if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
                                    var txt = strtext;
                                    var txt1 = txt.split("/");
                                    var dd = txt1[2];
                                    var mm1 = txt1[1];
                                    var mm = txt1[1]; //getMonthNo(mm1);
                                    var yy = txt1[0];
                                    caldate[cali] = dd;
                                    caldatemonth[cali] = mm;
                                    caldateyear[cali] = yy;
                                    cali = parseInt(cali, 10) + 1;
                                }
                            }
                            document.getElementById(id).value = strtext;
                            if (vvalue != strtext) {
                                alert(vvalue + " Date is no issue date of edition " + pkgname);
                                document.getElementById(id).value = "";
                                cali = cali - 1;
                            }
                        }
                    }
                }
            }
            temp = parseInt(temp) + 1;
        }
    }
    else {
        for (i = 0; i < gridtab_vari.getElementsByTagName("tbody")[0].rows.length - 1; i++) {
            var id = "Text" + i;
            var noofcol = "nocol" + i;
            var height = "hei" + i;
            var width = "wid" + i;
            var late = "lat" + i;
            var repeat = "rep" + i;
            var latedate = "latdate" + i;
            var repeatdateI = "repdate" + i;
            var page = "pgpre" + i;
            var pagstr = "sec";
            var adcat = "adcat" + i;
            var adsubcat = "ads" + i;
            var height_var = document.getElementById(height);
            var par1 = (height_var.parentNode).parentNode;
            var inserts = "ins" + i;
            var paid = "pai" + i;
            var disc = "disc_" + i;
            var boldcount = "splboldsize" + i;
            var discrate1 = "disrat" + i;
            var insertval = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[i + 1].cells[0].innerHTML;
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById(height).onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                document.getElementById(width).onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                document.getElementById(noofcol).onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                document.getElementById(late).onchange = new Function("return checkdate(Form1." + late + ");");
                document.getElementById(repeat).onchange = new Function("return checkdate(Form1." + repeat + ");");
                document.getElementById(page).onchange = new Function("return getpageprem(" + page + "," + i + ",'" + pagstr + "');");
                document.getElementById(id).onchange = new Function("return chkDateforGrid(this);");
                if (document.getElementById(paid) != undefined && document.getElementById(paid) != "undefined" && document.getElementById(paid) != null)
                    document.getElementById(paid).onchange = new Function("return blankGross();");
                if (document.getElementById(boldcount) != undefined && document.getElementById(boldcount) != "undefined" && document.getElementById(boldcount) != null)
                    document.getElementById(boldcount).onchange = new Function("return boldcountingrid();");
                if (document.getElementById(disc) != undefined && document.getElementById(disc) != "undefined" && document.getElementById(disc) != null)
                    document.getElementById(disc).onchange = new Function("return blankGross();");
                if (document.getElementById(discrate1) != undefined && document.getElementById(discrate1) != "undefined" && document.getElementById(discrate1) != null)
                    document.getElementById(discrate1).onchange = new Function("return blankGross();");
            }
            else {
                par1.all[height].onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                par1.all[width].onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                par1.all[noofcol].onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                par1.all[late].onchange = new Function("return checkdate(Form1." + late + ");");
                par1.all[repeat].onchange = new Function("return checkdate(Form1." + repeat + ");");
                par1.all[page].onchange = new Function("return getpageprem(" + page + "," + i + ",'" + pagstr + "');");
                par1.all[id].onchange = new Function("return chkDateforGrid(this);");
                if (par1.all[paid] != undefined && par1.all[paid] != "undefined" && par1.all[paid] != null)
                    par1.all[paid].onchange = new Function("return blankGross();");
                if (par1.all[boldcount] != undefined && par1.all[boldcount] != "undefined" && par1.all[boldcount] != null)
                    par1.all[boldcount].onchange = new Function("return boldcountingrid();");
                if (par1.all[disc] != undefined && par1.all[disc] != "undefined" && par1.all[disc] != null)
                    par1.all[disc].onchange = new Function("return blankGross();");                
                if (par1.all[discrate1] != undefined && par1.all[discrate1] != "undefined" && par1.all[discrate1] != null)
                    par1.all[discrate1].onchange = new Function("return blankGross();"); 
            }
            if (repeatdate == "0" || repeatdate == "1") {
                var id = "Text" + i;
                //    if(caldatemonth.length>=i && caldatemonth[i]!=undefined)
                //  {
                // var mmM=caldatemonth[i].toString();
                //}
                //else{
                var mmM = parseInt(monthSelected, 10) + 1;
                mmM = mmM.toString();
                //}
                if (mmM.toString().length == 1)
                    mmM = "0" + mmM.toString();
                if (dateformat_vari.value == "mm/dd/yyyy") {
                    vvalue = mmM + "/" + dateSelected + "/" + yearSelected;
                }
                else if (dateformat_vari.value == "dd/mm/yyyy") {
                    vvalue = dateSelected + "/" + mmM + "/" + yearSelected; ;
                }
                else if (dateformat_vari.value = "yyyy/mm/dd") {
                    vvalue = yearSelected + "/" + mmM + "/" + dateSelected; ;
                }
                vvalue = document.getElementById('Text' + i).value;

                if (dateSelected != undefined && dateSelected != "") {
                    if (browser != "Microsoft Internet Explorer") {
                        var pkgfullname = document.getElementById('pkg_alias' + i).value;
                        var pkgid = document.getElementById('hiddenpckcode' + i).value;
                        var pkgname = document.getElementById('pkg_alias' + i).value;
                        var compcode = compcode_vari.value;

                        dateday = vvalue;

                        document.getElementById('Text' + i).value = vvalue;
                    }
                    else {
                        var pkgfullname = par1.all['pkg_alias' + i].value;
                        var pkgid = par1.all['hiddenpckcode' + i].value;
                        var pkgname = par1.all['pkg_alias' + i].value;
                        var compcode = compcode_vari.value;
                        dateday = vvalue;

                        par1.all['Text' + i].value = vvalue;
                    }
                    if (browser != "Microsoft Internet Explorer") {
                        var httpRequest = null; ;
                        httpRequest = new XMLHttpRequest();
                        if (httpRequest.overrideMimeType) {
                            httpRequest.overrideMimeType('text/xml');
                        }

                        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };
                        var adcat = adcat_vari.value;
                        httpRequest.open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
                        httpRequest.send('');
                        //alert(httpRequest.readyState);
                        if (httpRequest.readyState == 4) {
                            //alert(httpRequest.status);
                            if (httpRequest.status == 200) {
                                strtext = httpRequest.responseText;
                            }
                            else {
                                alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                            }
                        }
                    }
                    else {
                        validuse = "";
                        var xml = new ActiveXObject("Microsoft.XMLHTTP");
                        var adcat = adcat_vari;
                        var center = '';
                        if (center_vari != null) {
                            center = center_vari.value;
                            if (chkall_vari != null) {
                                if (chkall_vari.checked == true) {
                                    center = '0';
                                }
                            }
                            else {
                                center = '0';
                            }
                        }
                        xml.Open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
                        xml.Send();
                        strtext = xml.responseText;
                    }
                    if (strtext == "NOT A VALID DATE") {
                        alert("NOT A VALID DATE");
                        document.getElementById(id).value = "";
                        document.getElementById(id).focus();
                        return false;
                    }
                    if (strtext == "0") {
                        //alert("Day is not the publishing day");
                        document.getElementById(id).value = "";
                        return false;
                    }
                    else {
                        if (strtext == "1")
                            document.getElementById(id).value = vvalue;
                        else {
                            if (strtext != "") {
                                if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                                    var txt = strtext;
                                    var txt1 = txt.split("/");
                                    var dd = txt1[0];
                                    var mm1 = txt1[1];
                                    var mm = txt1[1]; //getMonthNo(mm1);
                                    var yy = txt1[2];
                                    caldate[cali] = dd;
                                    caldatemonth[cali] = mm;
                                    caldateyear[cali] = yy;
                                    cali = parseInt(cali, 10) + 1;
                                }
                                else if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                                    var txt = strtext;
                                    var txt1 = txt.split("/");
                                    var dd = txt1[1];
                                    var mm1 = txt1[0];
                                    var mm = txt1[0]; //getMonthNo(mm1);
                                    var yy = txt1[2];
                                    caldate[cali] = dd;
                                    caldatemonth[cali] = mm;
                                    caldateyear[cali] = yy;
                                    cali = parseInt(cali, 10) + 1;
                                }
                                else if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
                                    var txt = strtext;
                                    var txt1 = txt.split("/");
                                    var dd = txt1[2];
                                    var mm1 = txt1[1];
                                    var mm = txt1[1]; //getMonthNo(mm1);
                                    var yy = txt1[0];
                                    caldate[cali] = dd;
                                    caldatemonth[cali] = mm;
                                    caldateyear[cali] = yy;
                                    cali = parseInt(cali, 10) + 1;
                                }
                            }
                            document.getElementById(id).value = strtext;
                            if (vvalue != strtext) {
                                alert(vvalue + " Date is no issue date of edition " + pkgname);
                                document.getElementById(id).value = "";
                                cali = cali - 1;
                            }
                        }
                    }
                }
            }
            temp = parseInt(temp) + 1;
        }
    }
    noissueflag = false;
    return false;
}
function openattach1() {
    if (document.getElementById('LinkButton1').disabled == false)
        window.open('approvalAttachment.aspx?filename=' + document.getElementById('hidattach1').value, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=144,left=210,width=350px,height=300px');
    return false;
}
function openattach2() {
    if (document.getElementById('LinkButton1').disabled == false)
        window.open('approvalAttachment1.aspx?filename=' + document.getElementById('hidattach2').value, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=144,left=210,width=350px,height=300px');
    return false;
}
function checkValidation() {
    /*document.getElementById("divloader").style.display = "block";
    document.getElementById('divloader').style.top = "250px";
    document.getElementById('divloader').style.left = "250px";*/
    commaremove();
    //if(document.getElementById('drppaymenttype').value=="CA0" && document.getElementById('hiddensavemod').value=="01" && document.getElementById('txtbillamt').value!="" && document.getElementById('hiddenbillamt').value!="")
    //{
    //    if(parseFloat(document.getElementById('txtbillamt').value)<document.getElementById('hiddenbillamt').value)
    //    {
    //        alert("For Payment Type Cash, Billing Amount can't be less than previous Billing Amount");
    //        return false;
    //    }
    //}
    if (document.getElementById('hiddensupplimentflag').value != "") {
        var ressupplement1 = Classified_Booking.adbillsmodificationvalidate(document.getElementById('hiddencompcode').value, document.getElementById('txtciobookid').value, document.getElementById('hiddensupplementbilldate').value, document.getElementById('hiddensupplementbillno').value, document.getElementById('hiddenuserid').value, document.getElementById('hiddendateformat').value);
        if (ressupplement1.error != null) {
            alert(ressupplement1.error.description);
            return false;
        }
        if (ressupplement1.value.Tables[0].Rows[0].MESSAGE != null && ressupplement1.value.Tables[0].Rows[0].MESSAGE != "") {
            alert(ressupplement1.value.Tables[0].Rows[0].MESSAGE);
            return false;
        }

    }
    if (document.getElementById('drppaymenttype').value == "CA0" && document.getElementById('hiddensavemod').value == "01" && document.getElementById('txtbillamt').value != "" && document.getElementById('hiddenbillamt').value != "" && document.getElementById('drprostatus').value == "1") {
        if (parseFloat(document.getElementById('txtbillamt').value) < document.getElementById('hiddenbillamt').value && parseFloat(document.getElementById('txtbillamt').value) != 0) {
            alert("For Payment Type Cash, Billing Amount can't be less than previous Billing Amount");
            document.getElementById("divloader").style.display = "none";
            return false;
        }
    }
    if (sharepub == "" && document.getElementById('hidshareman').value == "Y") {
        var packagecode = '';
        var obj = document.getElementById('drppackagecopy');
        for (var x = 0; x < obj.options.length; x++) {

            var insertCount1 = 0;
            if (obj[x].value.indexOf('(') >= 0) {
                insertCount1 = obj[x].value.substring(obj[x].value.lastIndexOf('(') + 1, obj[x].value.length - 1);
                //  insertCount1=parseInt(insertCount1)-1;
            }
            for (x1 = 0; x1 < insertCount1; x1++) {
                if (packagecode == '')
                    packagecode = obj[x].value.substring(0, obj[x].value.lastIndexOf('@'));
                else
                    packagecode = packagecode + ',' + obj[x].value.substring(0, obj[x].value.lastIndexOf('@'));

            }


        }
        var respub = Classified_Booking.getpubcount(document.getElementById('hiddencompcode').value, document.getElementById('txtinsertion').value, packagecode, document.getElementById('txtciobookid').value);
        var dspub = "";
        if (respub.error == null) {
            dspub = respub.value;
        }
        if (dspub.Tables.length > 0) {
            if (dspub.Tables[0].Rows.length > 1) {
                alert("Sharing Precentage is mandatory ");
                document.getElementById("divloader").style.display = "none";
                return false;
            }
        }
    }
    var chmandat11 = "";
    if (ALLOWBOOKINGBRANCHMAIL == "Y" && document.getElementById('hiddenrateauditflag').value!="rateaudit") 
    {
            if (mailsendstr == "") {
                if (browser != "Microsoft Internet Explorer") {
                    chmandat11 = document.getElementById('btnmail').textContent;
                }
                else {
                    chmandat11 = document.getElementById('btnmail').innerText;
                }
              //  if (chmandat11.indexOf("*") >= 0) {
                alert("Please Select Mail Details.");
                document.getElementById("divloader").style.display = "none";
                    return false;
             //   }
            }
    }
    
    if (!confirm('Are you sure you want to Save Booking')) {
        return false;
    }
    var rescir = checkCirValidAgency();
    if (rescir == false)
        return false;
    var rescop = coupancheck();
    if (rescop == false)
        return false;
    //if (document.getElementById('hidattach1').value==""){
    //    alert("Please Upload attachment First");
    //    return false;
    //}
    var chmandat = "";
    var adsize1_vari = document.getElementById('txtadsize1');
    var adsize2_vari = document.getElementById('txtadsize2');
    ////////////////THIS IS THE XML CREATED TO MAKE THE MANDATORY FROM XML
    var drpag_vari = document.getElementById('drpagscode');
    var agency_vari = document.getElementById('txtagency');
    var rostatus_vari = document.getElementById('drprostatus');
    var rono_vari = document.getElementById('txtrono');
    var rodate_vari = document.getElementById('txtrodate')
    if (rostatusmain != "1" && document.getElementById('hiddensepcashier').value == "Y" && rostatus_vari.value == "1" && (document.getElementById('drppaymenttype').value == "CA0"||document.getElementById('drppaymenttype').value == "CR4")) {
        alert("In Case of Seperate Cashier, Cash Booking Can't be Confirmed from there.");
        document.getElementById("divloader").style.display = "none";
        return false;
    }
    if (browser != "Microsoft Internet Explorer") {
        // loadXML('xml/bookingmaster.xml');
        /////////////////////////////////////////////////////
        chmandat = document.getElementById('lbagency').textContent;



        if (chmandat.indexOf('*') >= 0) {
            if (agency_vari.value == "") {
                alert("Please Fill The Agency Name");
                document.getElementById("divloader").style.display = "none";
                agency_vari.focus();
                return false;
            }
        }

        chmandat = document.getElementById('lbagescode').textContent;
        if (chmandat.indexOf('*') >= 0) {
            if (drpag_vari.value == "" || drpag_vari.value == "0") {
                alert("Please Fill Agency Sub Code");
                document.getElementById("divloader").style.display = "none";
                drpag_vari.focus();
                return false;
            }
        }
        if (document.getElementById('txtagencypaymode').value == "0" || document.getElementById('txtagencypaymode').value == "") {
            alert("Please Enter Agency PayMode");
            document.getElementById("divloader").style.display = "none";
            return false;
        }
        chmandat = document.getElementById('lbclient').textContent;
        if (chmandat.indexOf('*') >= 0) {
            if (document.getElementById('txtclient').value == "" || document.getElementById('txtclient').value == "0") {
                alert("Please Enter Client");
                document.getElementById("divloader").style.display = "none";
                document.getElementById('txtclient').focus();
                return false;
            }
        }
        chmandat = document.getElementById('lbmobileno').textContent;
        if (chmandat.indexOf('*') >= 0) {
            if (document.getElementById('txtMobile').value == "") {
                alert("Please Fill Mobile No ");
                document.getElementById("divloader").style.display = "none";
                if (document.getElementById('txtMobile').disabled == false)
                    document.getElementById('txtMobile').focus();
                return false;
            }
        }
        if (document.getElementById('hiddenquotation').value == 'Q') {
            chmandat = document.getElementById('lblcontact').textContent;
            if (chmandat.indexOf('*') >= 0) {
                if (document.getElementById('txtcontactperson').value == "") {
                    alert("Please Fill Contact Person");
                    if (document.getElementById('txtcontactperson').disabled == false)
                        document.getElementById('txtcontactperson').focus();
                    return false;
                }
            }
            chmandat = document.getElementById('lbmobileno').textContent;
            if (chmandat.indexOf('*') >= 0) {
                if (document.getElementById('txtmailid').value == "") {
                    alert("Please Fill Email ID");
                    if (document.getElementById('txtmailid').disabled == false)
                        document.getElementById('txtmailid').focus();
                    return false;
                }
            }
        }
        chmandat = rostatus_vari.textContent;
        if (chmandat.indexOf('*') >= 0) {
            if (rostatus_vari.value == "0") {
                alert("Please Fill ro status");
                document.getElementById("divloader").style.display = "none";
                rostatus_vari.focus();
                return false;
            }
        }
        chmandat = rostatus_vari.innerText;
        if (rostatus_vari.value == "0") {
            if (document.getElementById('hiddenrostatus').value == "1")
                rostatus_vari.value = 2; //document.getElementById('hiddenrostatus').value;
            else
                rostatus_vari.value = 1;
        }

    }
    else {
        var xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
        // loadXML('xml/bookingmaster.xml');
        /////////////////////////////////////////////////////
        chmandat = document.getElementById('lbagency').innerText;
        if (chmandat.indexOf('*') >= 0) {
            if (agency_vari.value == "") {
                alert("Please Fill The Agency Name");
                document.getElementById("divloader").style.display = "none";
                agency_vari.focus();
                return false;
            }
        }
        chmandat = document.getElementById('lbagescode').innerText;
        if (chmandat.indexOf('*') >= 0) {
            if (drpag_vari.value == "" || drpag_vari.value == "0") {
                alert("Please Fill Agency Sub Name");
                document.getElementById("divloader").style.display = "none";
                drpag_vari.focus();
                return false;
            }
        }
        chmandat = document.getElementById('lbclient').innerText;
        if (chmandat.indexOf('*') >= 0) {
            if (document.getElementById('txtclient').value == "" || document.getElementById('txtclient').value == "0") {
                alert("Please Enter Client");
                document.getElementById("divloader").style.display = "none";
                document.getElementById('txtclient').focus();
                return false;
            }
        }
        chmandat = rostatus_vari.innerText;
        if (rostatus_vari.value == "0") {
            if (document.getElementById('hiddenrostatus').value == "1")
                rostatus_vari.value = 2; //document.getElementById('hiddenrostatus').value;
            else
                rostatus_vari.value = 1;
        }
        chmandat = document.getElementById('lbmobileno').innerText;
        if (chmandat.indexOf('*') >= 0) {
            if (document.getElementById('txtMobile').value == "") {
                alert("Please Fill Mobile No ");
                document.getElementById("divloader").style.display = "none";
                if (document.getElementById('txtMobile').disabled == false)
                    document.getElementById('txtMobile').focus();
                return false;
            }
        }
        if (document.getElementById('hiddenquotation').value == 'Q') {
            chmandat = document.getElementById('lblcontact').innerText;
            if (chmandat.indexOf('*') >= 0) {
                if (document.getElementById('txtcontactperson').value == "") {
                    alert("Please Fill Contact Person");
                    if (document.getElementById('txtcontactperson').disabled == false)
                        document.getElementById('txtcontactperson').focus();
                    return false;
                }
            }
            chmandat = document.getElementById('lbmobileno').innerText;
            if (chmandat.indexOf('*') >= 0) {
                if (document.getElementById('txtmailid').value == "") {
                    alert("Please Fill Email ID");
                    if (document.getElementById('txtmailid').disabled == false)
                        document.getElementById('txtmailid').focus();
                    return false;
                }
            }
        }
        if (chmandat.indexOf('*') >= 0) {
            if (rostatus_vari.value == "0") {
                alert("Please Fill ro status");
                document.getElementById("divloader").style.display = "none";
                rostatus_vari.focus();
                return false;
            }
        }
    }
    
     if (document.getElementById('drpvarient').value == "" || document.getElementById('drpvarient').value == "0") 
     {
             //document.getElementById('drpvarient').focus();
            alert("Please Fill Variant Package code First.");
            document.getElementById("divloader").style.display = "none";
            return false;
        }
        
    if (document.getElementById('hiddenrostatus').value == "0" && document.getElementById('drppaymenttype').value != "CA0") {
        rostatus_vari.value == "1";
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbrono').textContent;
    }
    else {
        chmandat = document.getElementById('lbrono').innerText;
    }
    if (chmandat.indexOf("*") >= 0 && rostatus_vari.value == "1" && rono_vari.value == "" && document.getElementById('drppaymenttype').value != "CA0") {
        alert("Please fill RO No");
        document.getElementById("divloader").style.display = "none";
        rono_vari.focus();
        return false;
    }
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbrodate').textContent;
    }
    else {
        chmandat = document.getElementById('lbrodate').innerText;
    }
    if (chmandat.indexOf("*") >= 0 && rostatus_vari.value == "1" && rodate_vari.value == "" && document.getElementById('drppaymenttype').value != "CA0") {
        alert("Please fill RO Date");
        document.getElementById("divloader").style.display = "none";
        rodate_vari.focus();
        return false;
    }
    if (rono_vari.value != "") {
        if (browser != "Microsoft Internet Explorer") {
            chmandat = document.getElementById('lbrodate').textContent;
        }
        else {
            chmandat = document.getElementById('lbrodate').innerText;
        }
        if (chmandat.indexOf("*") >= 0 && rodate_vari.value == "") {
            alert("Please fill RO date");
            document.getElementById("divloader").style.display = "none";
            rodate_vari.focus();
            return false;
        }
    }

    if (rodate_vari.value != "") {
        if (browser != "Microsoft Internet Explorer") {
            chmandat = document.getElementById('lbrono').textContent;
        }
        else {
            chmandat = document.getElementById('lbrono').innerText;
        }
        if (chmandat.indexOf("*") >= 0 && rono_vari.value == "") {
            alert("Please fill RO no");
            document.getElementById("divloader").style.display = "none";
            rono_vari.focus();
            return false;
        }
    }
    if ((document.getElementById('drppaymenttype').value == "CA0" || document.getElementById('drppaymenttype').value == "CR4") && document.getElementById('hiddensepcashier').value == "Y") { ///CR4 use for Credit_debit_card
        rostatus_vari.value = "2";
    }
    else if (document.getElementById('drppaymenttype').value == "CA0") {
        rostatus_vari.value = "1";
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbkey').textContent;
    }
    else {
        chmandat = document.getElementById('lbkey').innerText;
    }
    //    chmandat=document.getElementById('lbkey').innerText;
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtkeyno').value == "0" || document.getElementById('txtkeyno').value == "") {
            alert("Please Insert Key No.");
            document.getElementById("divloader").style.display = "none";
            document.getElementById('txtkeyno').focus();
            return false;
        }
    }
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbprintremark').textContent;
    }
    else {
        chmandat = document.getElementById('lbprintremark').innerText;
    }
    //       chmandat=document.getElementById('lbprintremark').innerText;
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtprintremark').value == "0" || document.getElementById('txtprintremark').value == "") {
            alert("Please Insert Print Remark");
            document.getElementById("divloader").style.display = "none";
            //document.getElementById('drpadsubcategory').focus();
            return false;
        }
    }
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbececname').textContent;
    }
    else {
        chmandat = document.getElementById('lbececname').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtexecname').value == "" && (document.getElementById('drpretainer').value == "0" || document.getElementById('drpretainer').value == "")) {
            var a = "Executive name";
            var b = "Retainer";
            if (browser != "Microsoft Internet Explorer") {
                a = document.getElementById('lbececname').textContent.replace("*[F2]", "");
                b = document.getElementById('lblretainer').textContent.replace("*[F2]", "");
            }
            else {
                a = document.getElementById('lbececname').innerText.replace("*[F2]", "");
                b = document.getElementById('lblretainer').innerText.replace("*[F2]", "");
            }
            alert('Please Enter ' + a + ' or Select ' + b);
            document.getElementById("divloader").style.display = "none";
            document.getElementById('txtexecname').focus();
            return false;
        }
    }
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbmobileno').textContent;
    }
    else {
        chmandat = document.getElementById('lbmobileno').innerText;
    }
    //chmandat=document.getElementById('lbmobileno').innerText;
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtMobile').value == "" || document.getElementById('txtMobile').value == "0") {
            alert("Please Enter Mobile Number");
            document.getElementById("divloader").style.display = "none";
            document.getElementById('txtMobile').focus();
            return false;
        }
    }
    if (document.getElementById('txtexecname').value != "") {
        if (browser != "Microsoft Internet Explorer") {
            chmandat = document.getElementById('lbexeczone').textContent;
        }
        else {
            chmandat = document.getElementById('lbexeczone').innerText;
        }
        if (chmandat.indexOf('*') >= 0) {
            if (document.getElementById('txtexeczone').value == "") {
                alert('Please Enter ' + (chmandat.replace('*', "")));
                document.getElementById("divloader").style.display = "none";
                document.getElementById('txtexeczone').focus();
                return false;
            }
        }
    }

    if (document.getElementById('drpbooktype').value == "0") {
        alert("Please Select Booking Type");
        document.getElementById("divloader").style.display = "none";
        return false;
    }
    if ((document.getElementById('drpbooktype').value == "2" || document.getElementById('drpbooktype').value == "6") && fmgInsert == "") {
        alert("Please Enter FMG Booking against which Booking");
        document.getElementById("divloader").style.display = "none";
        return false;
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbcolor').textContent;
    }
    else {
        chmandat = document.getElementById('lbcolor').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drpcolor').value == "0") {

            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            //  changediv();
            alert('Please Enter Color');
            document.getElementById("divloader").style.display = "none";
            // document.getElementById('drpcolor').focus();
            return false;
        }
    }
    if (document.getElementById('drpadcategory').value == "0") {
        alert("Please Select Ad Category");
        document.getElementById("divloader").style.display = "none";
        return false;
    }

    var adcategory = document.getElementById('drpadcategory').value;
    if (adcategory != "0") {
        var res = Classified_Booking.getRegClientCheck(adcategory);
        var dx = res.value;
        if (dx != null && dx.Tables[0] != null && dx.Tables[0] != undefined) {
            if (dx.Tables[0].Rows.length > 0) {
                if (dx.Tables[0].Rows[0].REGCLIENT == "Y") {
                    if (document.getElementById('txtclient').value.lastIndexOf('(') < 0) {
                        alert("For Category " + document.getElementById('drpadcategory').options[document.getElementById('drpadcategory').selectedIndex].text + ", You can take only Registered Client");
                        document.getElementById("divloader").style.display = "none";
                        document.getElementById('txtclient').focus();
                        return false;
                    }
                }
                if (dx.Tables[0].Rows[0].DISC_AMT != null && dx.Tables[0].Rows[0].DISC_AMT != "") {
                    document.getElementById('txtcatdisc').value = dx.Tables[0].Rows[0].DISC_AMT;
                    document.getElementById('hdncatdisctype').value = dx.Tables[0].Rows[0].DISC_TY;
                }
            }
        }
    }
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbadscat').textContent;
    }
    else {
        chmandat = document.getElementById('lbadscat').innerText;
    }
    //      chmandat=document.getElementById('lbadscat').innerText;
    if (chmandat.indexOf('*') >= 0) {
        if ((document.getElementById('drpadsubcategory').value == "0" || document.getElementById('drpadsubcategory').value == "") && document.getElementById('drpadsubcategory').options.length > 1) {
            alert("Please Select The Ad Sub Cat");
            document.getElementById("divloader").style.display = "none";
            //document.getElementById('drpadsubcategory').focus();
            return false;
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbmat').textContent;
    }
    else {
        chmandat = document.getElementById('lbmat').innerText;
    }
    //chmandat=document.getElementById('lbmat').innerText;
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drpmatstat').value == "0" || document.getElementById('drpadsubcategory').value == "") {
            alert("Please Select Material Status");
            document.getElementById("divloader").style.display = "none";
            //document.getElementById('drpadsubcategory').focus();
            return false;
        }
    }
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbproduct').textContent;
    }
    else {
        chmandat = document.getElementById('lbproduct').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtproduct').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            changediv();
            document.getElementById('txtproduct').focus();
            return false;
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbbrand').textContent;
    }
    else {
        chmandat = document.getElementById('lbbrand').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drpbrand').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            changediv();
            document.getElementById('drpbrand').focus();
            return false;
        }
    }
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbuom').textContent;
    }
    else {
        chmandat = document.getElementById('lbuom').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drpuom').value == "0") {
            alert('Please Enter Uom');
            document.getElementById("divloader").style.display = "none";
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";

            document.getElementById('drpuom').focus();
            return false;
        }

    }
    // for barter type in ad details tab
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblbartertype').textContent;
    }
    else {
        chmandat = document.getElementById('lblbartertype').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtbartertype').value == "" && document.getElementById('drpbooktype').value == "1") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changediv();
            document.getElementById('txtbartertype').focus();
            return false;
        }
    }
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbcurrency').textContent;
    }
    else {
        chmandat = document.getElementById('lbcurrency').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drpcurrency').value == "0" || document.getElementById('drpcurrency').value == "") {
            alert('Please Enter Currency');
            document.getElementById("divloader").style.display = "none";
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changepackage();
            document.getElementById('drpcurrency').focus();
            return false;
        }

    }
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbrptcurrency').textContent;
    }
    else {
        chmandat = document.getElementById('lbrptcurrency').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drprptcurrency').value == "0" || document.getElementById('drprptcurrency').value == "") {
            alert('Please Enter Receipt Currency');
            document.getElementById("divloader").style.display = "none";
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changepackage();
            document.getElementById('drprptcurrency').focus();
            return false;
        }

    }
    if (document.getElementById('chkadon').checked == true && document.getElementById('txtreference').value == "") {
        alert("Please Select Reference ID For Adon");
        document.getElementById("divloader").style.display = "none";
        return false;
    }
    if (document.getElementById('drppackagecopy').options.length == 0) {
        alert("Please Select Package");
        document.getElementById("divloader").style.display = "none";
        return false;
    }
    if (document.getElementById('txtdummydate').value == "") {
        alert("Please Enter Date");
        document.getElementById("divloader").style.display = "none";
        return false;
    }



    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbnoofins').textContent;
    }
    else {
        chmandat = document.getElementById('lbnoofins').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtinsertion').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changepackage();
            document.getElementById('txtinsertion').focus();
            return false;
        }

    }







    if (document.getElementById('hiddenuomdesc').value == "CD") {
        if (adsize1_vari.value == "") {
            alert('Please enter height');
            document.getElementById("divloader").style.display = "none";
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changediv1();
            adsize1_vari.focus();
            return false;
        }
        if (adsize1_vari.value != "") {
            if (adsize2_vari.value == "" && document.getElementById('txtcolum').value == "") {
                alert('Please enter width');
                document.getElementById("divloader").style.display = "none";
                document.getElementById('divpopup').style.display = "block";
                document.getElementById('hidehref').innerHTML = "Hide";
                changediv1();
                adsize1_vari.focus();
                return false;
            }
        }
    }
    else {
        if (document.getElementById('txttotalarea').value == "") {
            if (document.getElementById('drpuom').value != "RO0") {
                alert('Please Enter Number of lines');
                document.getElementById("divloader").style.display = "none";
            }
            else {
                alert('Please Enter Number of words');
                document.getElementById("divloader").style.display = "none";

            }
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changediv1();
            //document.getElementById('txtadsize1').focus();
            return false;
        }
    }


    if (document.getElementById('txtadsize1').disabled == true) {
        if (document.getElementById('txttotalarea').value == "") {
            alert('Please Enter Number of lines');
            document.getElementById("divloader").style.display = "none";
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changediv1();
            adsize1_vari.focus();
            return false;
        }
    }

    if (document.getElementById('drpbullet').value != "0" && document.getElementById('drpbullet').value != "") {
        if (document.getElementById('txtbullprem').value == "") {
            alert("In case of eyecatcher, Bullet Premium can't be blank");
            document.getElementById("divloader").style.display = "none";
            changediv1();
            return false;
        }
    }
    if (document.getElementById('txtbullprem').value != "") {
        if (document.getElementById('drpbullet').value == "0") {
            alert("In case of Bullet Premium, eyecatcher can't be blank");
            document.getElementById("divloader").style.display = "none";
            changediv1();
            return false;
        }
    }
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbscheme').textContent;
    }
    else {
        chmandat = document.getElementById('lbscheme').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drpscheme').value == "0") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changedivrate();
            document.getElementById('drpscheme').focus();
            return false;
        }

    }
    if (document.getElementById('txtratecode').value == "0") {
        changedivrate();
        alert("Please Enter Rate Code");
        document.getElementById("divloader").style.display = "none";
        document.getElementById('txtratecode').focus();
        return false;
    }
    if (document.getElementById('txtgrossamt').value == "" || document.getElementById('txtgrossamtlocal').value == "") {
        changedivrate();
        alert("Please Enter Gross Amount");
        document.getElementById("divloader").style.display = "none";
        //document.getElementById('txtgrossamt').focus();
        return false;
    }
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblcardamt').textContent;
    }
    else {
        chmandat = document.getElementById('lblcardamt').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtcardamt').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            //document.getElementById('drppackage').focus();
            return false;
        }

    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbagreed').textContent;
    }
    else {
        chmandat = document.getElementById('lbagreed').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtagreedrate').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changedivrate();
            document.getElementById('txtagreedrate').focus();
            return false;
        }

    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbagreamo').textContent;
    }
    else {
        chmandat = document.getElementById('lbagreamo').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtagreedamt').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changedivrate();
            document.getElementById('txtagreedamt').focus();
            return false;
        }

    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbldiscount').textContent;
    }
    else {
        chmandat = document.getElementById('lbldiscount').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtdiscount').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changedivrate();
            document.getElementById('txtdiscount').focus();
            return false;
        }

    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbldiscpre').textContent;
    }
    else {
        chmandat = document.getElementById('lbldiscpre').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtdiscpre').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changedivrate();
            document.getElementById('txtdiscpre').focus();
            return false;
        }

    }

    //        if(browser!="Microsoft Internet Explorer")
    //        {
    //            chmandat=document.getElementById('lbselectdate').textContent;
    //        }
    //        else
    //        {        
    //            chmandat=document.getElementById('lbselectdate').innerText;
    //        }
    //        if(chmandat.indexOf('*')>= 0)
    //        {
    //            if(document.getElementById('txtdummydate').value=="")
    //            {
    //                 alert('Please Enter Package Details');
    //                 document.getElementById('divpopup').style.display="block";
    //		         document.getElementById('hidehref').innerHTML="Hide";
    //                 changepackage();
    //	             document.getElementById('txtdummydate').focus();
    //	             return false;
    //            }  
    //    
    //        }



    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblbillcycle').textContent;
    }
    else {
        chmandat = document.getElementById('lblbillcycle').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drpbillcycle').value == "0") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changebilldiv();
            document.getElementById('drpbillcycle').focus();
            return false;
        }

    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblrevenuecenter').textContent;
    }
    else {
        chmandat = document.getElementById('lblrevenuecenter').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drprevenue').value == "0") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            changebilldiv();
            document.getElementById('drprevenue').focus();
            return false;
        }

    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblpaymenttype').textContent;
    }
    else {
        chmandat = document.getElementById('lblpaymenttype').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drppaymenttype').value == "0" || document.getElementById('drppaymenttype').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            changebilldiv();
            document.getElementById('drppaymenttype').focus();
            return false;
        }


    }
    if (document.getElementById('drpcashrecieved').value != "" && (parseFloat(document.getElementById('drpcashrecieved').value) > parseFloat(document.getElementById('txtbillamt').value))) {
        alert('Cash Received Amount cannot be greater than Bill Amount.');
        document.getElementById("divloader").style.display = "none";
        return false;
    }
    //check info
    if (document.getElementById('drppaymenttype').value == "CH0" || document.getElementById('drppaymenttype').value == "DD0" || document.getElementById('drppaymenttype').value == 'PO0' || document.getElementById('drppaymenttype').value == 'AD0') {
        if (document.getElementById('ttextchqno').value == "" || document.getElementById('ttextchqdate').value == "" || document.getElementById('ttextchqamt').value == "" || document.getElementById('ttextbankname').value == "") {
            alert('Please fill all fields of Cheque/DD.');
            document.getElementById("divloader").style.display = "none";
            document.getElementById('ttextchqno').focus;
            return false;
        }
    }
    else if (document.getElementById('drppaymenttype').value == "CR0") {
        if (document.getElementById('txtcardname').value == "" || document.getElementById('drptype').value == "0" || document.getElementById('drpmonth').value == "0" || document.getElementById('drpyear').value == "0" || document.getElementById('txtcardno').value == "") {
            alert('Please fill all fields of Credit Card.');
            document.getElementById("divloader").style.display = "none";
            document.getElementById('txtcardname').focus;
            return false;
        }
    }
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbbillstatus').textContent;
    }
    else {
        chmandat = document.getElementById('lbbillstatus').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drpbillstatus').value == "0") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changebilldiv();
            document.getElementById('drpbillstatus').focus();
            return false;
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblbillsize').textContent;
    }
    else {
        chmandat = document.getElementById('lblbillsize').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtbillwidth').value == "" || document.getElementById('txtbillheight').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            changebilldiv();
            document.getElementById('txtbillwidth').focus();
            return false;
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblbillto').textContent;
    }
    else {
        chmandat = document.getElementById('lblbillto').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drpbillto').value == "0") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changebilldiv();
            document.getElementById('drpbillto').focus();
            return false;
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblinvoice').textContent;
    }
    else {
        chmandat = document.getElementById('lblinvoice').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtinvoice').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changebilldiv();
            document.getElementById('txtinvoice').focus();
            return false;
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblvts').textContent;
    }
    else {
        chmandat = document.getElementById('lblvts').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtvts').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changebilldiv();
            document.getElementById('txtvts').focus();
            return false;
        }
    }
    // for circulation agency in VTS TAB
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblciragency').textContent;
    }
    else {
        chmandat = document.getElementById('lblciragency').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtciragency').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changebilldiv();
            document.getElementById('txtciragency').focus();
            return false;
        }
        if (document.getElementById('txtciragency').value != "" && (document.getElementById('txtciragency').value.indexOf('(') < 0 || document.getElementById('txtciragency').value.indexOf('+') < 0)) {
            alert('Please Enter Valid Cir. Agency');
            document.getElementById("divloader").style.display = "none";
            document.getElementById('txtciragency').value = "";
            return false;
        }
    }
    // for circulation Rate in VTS TAB
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblcirrate').textContent;
    }
    else {
        chmandat = document.getElementById('lblcirrate').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtcirrate').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changebilldiv();
            document.getElementById('txtcirrate').focus();
            return false;
        }
    }
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblbilladdress').textContent;
    }
    else {
        chmandat = document.getElementById('lblbilladdress').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtbilladdress').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            changebilldiv();
            document.getElementById('txtbilladdress').focus();
            return false;
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbltradedisc').textContent;
    }
    else {
        chmandat = document.getElementById('lbltradedisc').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txttradedisc').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changebilldiv();
            document.getElementById('txttradedisc').focus();
            return false;
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbbillamt').textContent;
    }
    else {
        chmandat = document.getElementById('lbbillamt').innerText;
    }
    // if(chmandat.indexOf('*')>= 0)
    // {
    if (document.getElementById('txtbillamt').value == "") {
        alert('Please Enter ' + (chmandat.replace('*', "")));
        document.getElementById("divloader").style.display = "none";
        changebilldiv();
        //document.getElementById('drppackage').focus();
        return false;
    }
    //  }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblagencyoutstand').textContent;
    }
    else {
        chmandat = document.getElementById('lblagencyoutstand').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtagencyoutstand').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changebilldiv();
            document.getElementById('txtagencyoutstand').focus();
            return false;
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbboxcode').textContent;
    }
    else {
        chmandat = document.getElementById('lbboxcode').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drpboxcode').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById("divloader").style.display = "none";
            openboxpopup();
            document.getElementById('drpboxcode').focus();
            return false;
        }

    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbboxno').textContent;
    }
    else {
        chmandat = document.getElementById('lbboxno').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtboxno').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            openboxpopup();
            document.getElementById('txtboxno').focus();
            return false;
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbboxadd').textContent;
    }
    else {
        chmandat = document.getElementById('lbboxadd').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtboxaddress').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            openboxpopup();
            document.getElementById('txtboxaddress').focus();
            return false;
        }
    }

    //        if(document.getElementById('drpbgcolor').value!="0")
    //        {
    //            if(document.getElementById('drppageposition').value=="0")
    //            {
    //                alert("Please select premium");
    //                return false;
    //            }
    //        
    //        }

    var res = chkmaincodeAgency("agency");
    if (res == false)
        return false;
    if (document.getElementById('drpretainer').value != "") {
        var res = chkmaincodeAgency("retainer");
        if (res == false)
            return false;
    }
    if (document.getElementById('txtexecname').value != "") {
        var res = chkmaincodeAgency("executive");
        if (res == false)
            return false;
    }
    var countnewrow = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
    for (var i = 0; i < countnewrow; i++) {
        var res = chkmaincodeAgency("seccode" + i);
        if (res == false)
            return false;
    }

    var countnewrowt = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
    for (var i = 0; i < countnewrowt; i++) {
        var res = chkmaincodeAgency("resno" + i);
        if (res == false)
            return false;
    }
    ////////////////////////////this is to chk that agency code,agency sub code and ro no should be unique if they are not
    ////////than dont allow booking hiddensavemod
    if (document.getElementById('txtrono').value != "" && document.getElementById('hiddensavemod').value != "01") {
        var rono = document.getElementById('txtrono').value;
        var cioid = document.getElementById('txtciobookid').value;
        var agencycode = document.getElementById('hiddenagency').value;
        if (agencycode == "" || agencycode == null)
            agencycode = document.getElementById('txtagency').value;
        if (agencycode.indexOf("(".toString()) > 0) {
            agencycode = agencycode.substring(agencycode.lastIndexOf('(') + 1, agencycode.lastIndexOf(')'));
            agencycode = agencycode.replace(")", "");
        }
        var agencyscode = document.getElementById('hiddensubcode').value;
        var savemod = document.getElementById('hiddensavemod').value
        var compcode = document.getElementById('hiddencompcode').value
        var keyno = document.getElementById('txtkeyno').value;
        var val1 = "";
        var rodate = document.getElementById('txtrodate').value;
        if (browser != "Microsoft Internet Explorer") {
            var httpRequest = null; ;
            httpRequest = new XMLHttpRequest();
            if (httpRequest.overrideMimeType) {
                httpRequest.overrideMimeType('text/xml');
            }

            httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

            httpRequest.open("GET", "chkuniqueforbook.aspx?keyno=" + keyno + "&rono=" + rono + "&cioid=" + cioid + "&agencycode=" + agencyscode + "&agencyscode=" + agencycode + "&savemod=" + savemod + "&compcode=" + compcode + "&rodate=" + rodate, false);
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) {
                    val1 = httpRequest.responseText;
                }
                else {
                    alert('Session TimeOut. Unable To Process Your Request. Please Logn Again');
                    return false;
                }
            }

        }
        else {
            var xml = new ActiveXObject("Microsoft.XMLHTTP");
            xml.Open("GET", "chkuniqueforbook.aspx?keyno=" + keyno + "&rono=" + rono + "&cioid=" + cioid + "&agencycode=" + agencyscode + "&agencyscode=" + agencycode + "&savemod=" + savemod + "&compcode=" + compcode + "&rodate=" + rodate, false);
            xml.Send();
            val1 = xml.responseText;
        }
        if (val1 == "0") {
            alert("The Agency Code,Agency Sub Code and Ro no. should be unique");
            return false;
        }
        if (val1 == "1") {
            alert("The Agency Code,Agency Sub Code and Key No. is not unique");
            //  return false;
        }
    }
    if (document.getElementById('drpcoutype').value != "0" && document.getElementById('drpcoutype').value != "" && document.getElementById('txtcouno').value == "") {
        alert("Please Enter CPN No.");
        document.getElementById('txtcouno').focus();
        return false;
    }
    if (document.getElementById('drpcoutype').value != "0" && document.getElementById('drpcoutype').value != "" && document.getElementById('txtcouno').value != "") {
        var rescou = Classified_Booking.chkCoupan(document.getElementById('hiddencompcode').value, document.getElementById('hiddencenter').value, document.getElementById('txtcouno').value);
        var dscou = rescou.value;
        if (dscou != null && dscou.Tables.length > 0 && dscou.Tables[0].Rows.length > 0 && chkbtnStatus == "new") {
            alert("Coupan Already Used With Reference No. " + dscou.Tables[0].Rows[0].CIO_BOOKING_ID);
            return false;
        }
    }
    if (document.getElementById('txtgrossamt').value == "" || document.getElementById('txtgrossamtlocal').value == "") {
        alert("Please get the original rate ");
        return false;
    }
    /////////////////////////this check is used to check from the main values that this pck exists or not


    var val = "";
    //////////////////////////////////////////////////////////////////////////////////////////////////////


    if (document.getElementById('tblinsert').innerHTML == "") {
        alert("Please Fill the grid");
        return false;
    }
    ////////////////this is to chk the mandatory field of grid whether they are selected or fill or not
    var len = "bookdiv";
    var id;
    var height;
    var width;
    var pagepost;
    var matsta;
    var insertsta;
    var editdate;
    var size;
    var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
    savtotid = totid
    var y;

    y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    var cardid;
    var editid;
    //var y=document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    var i;
    var k = 0;
    var i = 0;
    var adsize1_vari = document.getElementById('txtadsize1');
    var adsize2_vari = document.getElementById('txtadsize2');
    var d1 = "";
    var d2;
    d2 = document.getElementById('txtdatetime').value;
    var dateformat = document.getElementById('hiddendateformat').value;
    if (dateformat == "dd/mm/yyyy") {
        if (d2 != "") {

            var txt = d2;
            var txt1 = txt.split("/");
            var dd = txt1[0];
            var mm1 = txt1[1];
            var mm = txt1[1]; //getMonthNo(mm1);
            var yy = txt1[2];
            d2 = mm + '/' + dd + '/' + yy;

        }
        else {
            d2 = d2;
        }

    }

    if (dateformat == "yyyy/mm/dd") {
        if (d2 != "") {
            var txt = d2;
            var txt1 = txt.split("/");
            var yy = txt1[0];
            var mm = txt1[1];
            var dd = txt1[2];
            d2 = mm + '/' + dd + '/' + yy;
        }
        else {
            d2 = d2;
        }
    }
    for (k = 0; k < y - 1; k++) {

        id = document.getElementById("Text" + i);
        var par1 = (id.parentNode).parentNode;
        if (browser != "Microsoft Internet Explorer") {
            height = document.getElementById("hei" + i);
            width = document.getElementById("wid" + i);
            pagepost = document.getElementById("pgpre" + i); //"pagpos"+i;
            matsta = document.getElementById("mat" + i);
            insertsta = document.getElementById("inssta" + i);
            cardid = document.getElementById("card" + i);
            editid = document.getElementById("edit" + i);
            editdate = document.getElementById("Text" + i);
            size = document.getElementById("siz" + i);
            var adcat = document.getElementById("adcat" + i);
            var col = document.getElementById("col" + i);
            var vts = document.getElementById("vts" + i);
            var sectioncode = document.getElementById("seccode" + i);
            var resourceno = document.getElementById("resno" + i);
            var gridpageno=document.getElementById("pagno" + i);
        }
        else {
            height = par1.all["hei" + i];
            width = par1.all["wid" + i];
            pagepost = par1.all["pgpre" + i]; //"pagpos"+i;
            matsta = par1.all["mat" + i];
            insertsta = par1.all["inssta" + i];
            cardid = par1.all["card" + i];
            editid = par1.all["edit" + i];
            editdate = par1.all["Text" + i];
            size = par1.all["siz" + i];
            var adcat = par1.all["adcat" + i];
            var col = par1.all["col" + i];
            var vts = par1.all["vts" + i];
            var sectioncode = par1.all["seccode" + i];
            var resourceno = par1.all["resno" + i];
            var gridpageno = par1.all["pagno" + i];
            
        }
        if (id.value == "" && document.getElementById("hdnfollodate").value == "N") {
            alert("Please Fill the insertion date");
            id.focus();
            return false;
        }
        
        d1 = id.value;
        if (dateformat == "dd/mm/yyyy") {
            if (d1 != "") {

                var txt = d1;
                var txt1 = txt.split("/");
                var dd = txt1[0];
                var mm1 = txt1[1];
                var mm = txt1[1]; //getMonthNo(mm1);
                var yy = txt1[2];
                d1 = mm + '/' + dd + '/' + yy;

            }
            else {
                d1 = d1;
            }

        }

        if (dateformat == "yyyy/mm/dd") {
            if (d1 != "") {
                var txt = d1;
                var txt1 = txt.split("/");
                var yy = txt1[0];
                var mm = txt1[1];
                var dd = txt1[2];
                d1 = mm + '/' + dd + '/' + yy;
            }
            else {
                d1 = d1;
            }
        }
        if (d1 != "") {
            var days = days_between(d1, d2);
            if (days > parseInt(document.getElementById('hiddenmaxdays').value) && document.getElementById('hiddenmaxdays').value != "0") {
                alert("User can not take the publish date more than the " + document.getElementById('hiddenmaxdays').value + " days from booking date");
                return false;
            }
        }
        else if (cardid.value == "") {
            alert("Please get the card rate");

            return false;

        }
        else if (insertsta.value == "" || insertsta.value == "0") {
            alert("Please select insertion status");
            insertsta.focus();
            return false;

        }

        else if (col.value == "" || col.value == "0") {
            alert("Please Enter Color");
            col.focus();
            return false;
        }
        else if (adcat != null && (adcat.value == "" || adcat.value == "0")) {
            alert("Please select Ad Category");
            adcat.focus();

            return false;
        }
        else if (height.value == "") {
            if (adsize1_vari.disabled == false) {
                alert("Please fill height into grid");
                height.focus();
                return false;
            }

        }
        else if (width.value == "") {
            if (adsize2_vari.disabled == false) {
                alert("Please fill width into grid");
                width.focus();
                return false;
            }
        }
        else if (size.value == "") {
            if (adsize2_vari.disabled == true) {
                alert("Please fill size into grid");
                width.focus();
                return false;
            }
        }

        if ((document.getElementById('drpbooktype').value == "2" || document.getElementById('drpbooktype').value == "6")) {
            if (document.getElementById('hiddensavemod').value == "01") {
                if (fmgsize != size.value) {
                    alert("Booking size shoould be same as  FMG Booking");
                    //  return false;
                }
                if (fmgcolor != col.value) {
                    alert("Booking Color shoould be same as  FMG Booking");
                    //   return false;
                }
            }
        }
        else if (vts != null && vts.value != "" && document.getElementById('txtciragency').value == "") {
            alert("Please select Cir. Agency in VTS Tab");
            // document.getElementById('txtciragency').focus();

            return false;
        }
        if (sectioncode != null && (sectioncode.value == "" || sectioncode.value == "null")) {
            alert("Please Enter Chart Type in Grid");
            return false;
        }
        if (resourceno != null && (resourceno.value == "" || resourceno.value == "null")) {
            alert("Please Enter Order Type in Grid");
            return false;
        }
        i = i + 1;
    }
    if (document.getElementById('txtexecname').value != "") {
        var txtagencypaymode_vari12 = document.getElementById('txtagencypaymode').value;
        var execcode = document.getElementById('txtexecname').value.substring(document.getElementById('txtexecname').value.lastIndexOf('(') + 1, document.getElementById('txtexecname').value.lastIndexOf(')'));
        var execres = Classified_Booking.executivecraditlimit(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value, execcode, document.getElementById('txtciobookid').value, document.getElementById('txtgrossamt').value, document.getElementById('txtbillamt').value, txtagencypaymode_vari12);
        if (execres.error != null) {
            alert(execres.error.description);
            return false;
        }
        if (execres.value.Tables[0].Rows[0].Column1 == "N") {
            alert("Executive Credit Limit Exceed");
            return false;
        }
    }
    //*25Aug*
    if (document.getElementById('txtagencypaymode').value == "CA0" || document.getElementById('txtagencypaymode').value == "CH0" || (document.getElementById('txtagencypaymode').value == "CR1" && document.getElementById('creditreceipt_allow').value == "Y")) // for credit 
    {
        if (confirm("Do You Want To Print The Receipt")) {
            if (document.getElementById('txtclient').value == "") {
                alert("Please Fill the Client Name");
                document.getElementById('txtclient').focus();
                return false;
            }

            if (document.getElementById('txtagencypaymode').value == "") {
                alert("Please Agency pay mode.");
                return false;
            }
            document.getElementById('hiddenpaymode').value = document.getElementById('txtagencypaymode').options[document.getElementById('txtagencypaymode').selectedIndex].text;
            document.getElementById('hiddenprint_rec').value = "Y";
        }
        else {
            document.getElementById('hiddenprint_rec').value = "";
        }
    }
    if (document.getElementById('txtproduct').value != "" && document.getElementById('txtproduct').value.lastIndexOf('(') < 0) {
        alert("Please Select Product By F2");

        document.getElementById('txtproduct').value = "";
        return false;
    }
    document.getElementById('hiddenratecode').value = document.getElementById('txtratecode').value
    //***************
    var resn = checkBarterAmt();
    if (resn == false)
        return false;
    saveClick();

    setButtonImages();
    return false;
}



function disabledokit() {
    if (trim(document.getElementById('txtrono').value) != "") {
        document.getElementById('txtdockitno1').value = "";
        document.getElementById('drprostatus').value = "1";
        document.getElementById('txtdockitno1').disabled = true;
    }
    else {
        document.getElementById('txtdockitno1').disabled = false;
    }

}

function disablerono() {
    if (document.getElementById('txtdockitno1').value != "") {
        document.getElementById('txtrono').value = "";
        document.getElementById('txtrono').disabled = true;
    }
    else {
        document.getElementById('txtrono').disabled = false;
    }
}

function eventcalling(event) {
    if (event.keyCode == 97)
        event.keyCode = 65;
    if (event.keyCode == 98)
        event.keyCode = 66;
    if (event.keyCode == 99)
        event.keyCode = 67;
    if (event.keyCode == 100)
        event.keyCode = 68;
    if (event.keyCode == 101)
        event.keyCode = 69;
    if (event.keyCode == 102)
        event.keyCode = 70;
    if (event.keyCode == 103)
        event.keyCode = 71;
    if (event.keyCode == 104)
        event.keyCode = 72;
    if (event.keyCode == 105)
        event.keyCode = 73;
    if (event.keyCode == 106)
        event.keyCode = 74;
    if (event.keyCode == 107)
        event.keyCode = 75;
    if (event.keyCode == 108)
        event.keyCode = 76;
    if (event.keyCode == 109)
        event.keyCode = 77;
    if (event.keyCode == 110)
        event.keyCode = 78;
    if (event.keyCode == 111)
        event.keyCode = 79;
    if (event.keyCode == 112)
        event.keyCode = 80;
    if (event.keyCode == 113)
        event.keyCode = 81;
    if (event.keyCode == 114)
        event.keyCode = 82;
    if (event.keyCode == 115)
        event.keyCode = 83;
    if (event.keyCode == 116)
        event.keyCode = 84;
    if (event.keyCode == 117)
        event.keyCode = 85;
    if (event.keyCode == 118)
        event.keyCode = 86;
    if (event.keyCode == 119)
        event.keyCode = 87;
    if (event.keyCode == 120)
        event.keyCode = 88;
    if (event.keyCode == 121)
        event.keyCode = 89;
    if (event.keyCode == 122)
        event.keyCode = 90;

}

/////////////this function is to get the percentage when on selected change of premium dropdown

function getpercenprem(premid, id, name) {
    premid = premid.id;
    ///////////this page is created to get the value of selected premium
    var page = document.getElementById(premid).value;
    var val = "";
    if (browser != "Microsoft Internet Explorer") {
        var httpRequest = null; ;
        httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml');
        }

        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

        httpRequest.open("GET", "getpremium.aspx?page=" + page, false);
        httpRequest.send('');
        //alert(httpRequest.readyState);
        if (httpRequest.readyState == 4) {
            //alert(httpRequest.status);
            if (httpRequest.status == 200) {
                val = httpRequest.responseText;
            }
            else {
                alert('Session TimeOut. Unable To Process Your Request. Please Login Again');
            }
        }
    }
    else {
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        xml.Open("GET", "getpremium.aspx?page=" + page, false);
        xml.Send();
        val = xml.responseText;
    }
    val = val.split("^");
    val = val[0];
    var premper = "premper" + id;
    var premper1 = "premperone" + id;
    var cardid = "card" + id;
    var solo = "sol" + id;
    var agrred = "agr" + id;
    var discrate = "disrat" + i;
    if (document.getElementById(cardid).value == "") {
        alert("Please get the card rate");
        return false;
    }

    if (name == "one") {
        document.getElementById(premper).value = val;
        //when we change the premium than card effects automatically only when card rate and agreed are equal
        if (parseFloat(document.getElementById('txtcardrate').value) == parseFloat(document.getElementById('txtagreedrate').value)) {
            var soloins = document.getElementById(solo).value
            var totalvalue = parseFloat(soloins) + parseFloat(soloins) * (parseFloat(val)) / 100;
            document.getElementById(cardid).value = totalvalue.toFixed(2);
            document.getElementById(agrred).value = document.getElementById(cardid).value;
            document.getElementById(discrate).value = "0";
        }
        else {
            //document.getElementById(agrred).value=document.getElementById('txtagreedrate').value;        
        }

    }
    else {
        document.getElementById(premper1).value = val;
        var soloins = document.getElementById(solo).value
        var totalvalue = parseFloat(soloins) + parseFloat(soloins) * (parseFloat(val)) / 100;
        document.getElementById(cardid).value = totalvalue.toFixed(2);
        if (parseFloat(document.getElementById('txtcardrate').value) == parseFloat(document.getElementById('txtagreedrate').value)) {
            var soloins = document.getElementById(solo).value
            var totalvalue = parseFloat(soloins) + parseFloat(soloins) * (parseFloat(val)) / 100;
            document.getElementById(cardid).value = totalvalue.toFixed(2);
            document.getElementById(agrred).value = document.getElementById(cardid).value;
            document.getElementById(discrate).value = "0";
        }
        else {
            //document.getElementById(agrred).value=document.getElementById('txtagreedrate').value;        
        }

    }

}


//////this function is to get the total size on change of grids width textbox
function gettotalsize(h, w, id, ins, insval, c) {
    if (h != undefined && document.getElementById(h) != null && document.getElementById(w) != null) {
        var cardid = "card" + id;

        //    if(document.getElementById(cardid).value=="")
        //    {
        //        alert("Please get the card rate in the insertion grid");
        //        changedivrate();
        //        document.getElementById('btnshgrid').focus();
        //        return false;
        //    }

        //   h=h.id;

        if (document.getElementById(h).value == "") {
            alert("Please Enter the height");
            document.getElementById(h).focus();
            return false;
        }

        //  w=w.id;
        // c=c.id;

        var height = document.getElementById(h).value;
        var width = document.getElementById(w).value;
        var column = document.getElementById(c).value;
        var res = chkamountgrid(h);
        if (res == false)
            return false;
        if (width != "") {
            var res = chkamountgrid(w);
            if (res == false)
                return false;
        }
        if (column != "") {
            var res = chkamountgrid(c);
            if (res == false)
                return false;
        }
        var filename = "fil" + id;
        var size = "siz" + id;
        if (column == "" || column == "NaN") {
            document.getElementById(size).value = parseFloat(height) * parseFloat(width);
            document.getElementById(filename).value = "";
        }
        else {
            document.getElementById(size).value = parseFloat(height) * parseFloat(column);
            document.getElementById(filename).value = "";
        }
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
    }
    //getgrossamt(w,ins,insval);

    /*  agreed="agr"+id;
    gross="gro"+id;
    totarea="siz"+id;
    solo="sol"+id;
    if(document.getElementById('txtcardrate').value==document.getElementById('txtagreedrate').value)
    {
    var soagr=document.getElementById(solo).value;
    //document.getElementById(gross).value=(parseFloat(agr)*parseFloat(totsiz)).toFixed(2);
    var totareawithrate=parseFloat(soagr)*parseFloat(document.getElementById(totarea).value)
    var totamt=parseFloat(totareawithrate)+parseFloat(glpre)-parseFloat(glspedisc)-parseFloat(glspadisc)+parseFloat(glspeccharge)
    document.getElementById(gross).value=(parseFloat(totamt)).toFixed(2);
    }
    else
    {
    var totgross=parseFloat(document.getElementById(totarea).value)*parseFloat(document.getElementById(agreed).value)
    document.getElementById(gross).value=totgross.toFixed(2);
    }
    
    var y;
    var totid;
    if(noofinsert!="")
    {                 
    y=parseInt(noofinsert)   
    totid=parseInt(noofinsert)/parseInt(document.getElementById('txtinsertion').value)
    }
    else
    {
    y=rowwhenupdate;
    totid=parseInt(rowwhenupdate)/parseInt(document.getElementById('txtinsertion').value)
    }
                
    var k;
    var adgross
    var totgross;   
    var paid;
    var grossamt="";
    for(k=0;k<y;k++)
    {                         
    while(document.getElementById("card"+i)==null && i<y)
    {
    i=i+totid;
    }
                                
    if(i>=y)
    {
    break;
    }
                                
    adgross="gro"+i;
    paid="pai"+i;
                            
    totgross=document.getElementById(adgross).value 
    if(document.getElementById(paid).value=="Y") 
    {
    if(grossamt!="")
    {
    grossamt=parseFloat(totgross)+parseFloat(grossamt);
    }
    else
    {
    grossamt=parseFloat(totgross);
    }
    }
    i=parseInt(i)+1;   
    }
    if(grossamt!="")
    {
    document.getElementById('txtgrossamt').value=grossamt.toFixed(2);
    //if(document.getElementById('txtagreedrate').value!="")
    if(document.aciveElement.id=='txtagreedrate')
    {
    document.getElementById('txtagreedamt').value=(parseInt((document.getElementById('txtinsertion').value),10)*parseFloat(document.getElementById('txtagreedrate').value)).toFixed(2);   
    // document.getElementById('txtagreedamt').value = document.getElementById('txtgrossamt').value;  //*25Aug*
    }
    else
    {
    //if(document.getElementById('txtagreedamt').value!="")
    if(document.aciveElement.id=='txtagreedamt')
    {
    document.getElementById('txtagreedrate').value=(parseFloat(document.getElementById('txtagreedamt').value)/ parseInt((document.getElementById('txtinsertion').value),10)).toFixed(2);
    }  
    }
    var trdisc=document.getElementById('txttradedisc').value;
    var trdisc1=trdisc;
    var addcomm =0;
    if(document.getElementById('txtaddagencycommrate')!=null)
    {
    addcomm=document.getElementById('txtaddagencycommrate').value;
    }
    if(addcomm=="")
    {
    addcomm="0";
    }
    if(addcomm!="0")
    {
    trdisc1=parseInt(trdisc) + parseInt(addcomm);
    }
                    
    document.getElementById('txtbillamt').value=parseFloat(grossamt)-parseFloat(grossamt)*parseFloat(trdisc1)/100;
    }
    if(document.getElementById('txtgrossamt').value=="NaN")
    {
    document.getElementById('txtgrossamt').value="";
         
    }
    if(document.getElementById('txtbillamt').value=="NaN")
    {
    document.getElementById('txtbillamt').value="";         
    }
    */
}

function callcal(b, c) {

}


function chkheight() {
    if (document.getElementById('drppackagecopy').options.length == 0) {
        alert("Please select the package");
        document.getElementById('drppackage').focus();
        return false;
    }

    if (document.getElementById('drpuom').value == "0") {
        alert("Please select uom");
        document.getElementById('txtadsize1').value = ""
        document.getElementById('txtadsize2').value = ""
        //document.getElementById('drpuom').focus();
        return false;
    }
    var value = chkamount('txtadsize1');
    if (value == "f") {
        return false;
    }

    if (parseFloat(document.getElementById('txtadsize1').value) == 0) {
        alert("0 is not accepted");
        var idrem = document.activeElement.id;
        //document.getElementById(idrem).value="";        
        return false;
    }
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    var objpack = document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var code = "";
    var codesplit = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (temp != "") {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                desc = tempcode + "+" + desc;
            }
            else {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                desc = tempcode;
            }
        }

    }
    if (document.getElementById('txtcolum').value != "") {
        Classified_Booking.getwidthforcoll(desc, document.getElementById('txtcolum').value, document.getElementById('hiddencompcode').value, document.getElementById('drpuom').value, call_chkheight);
    }
    else {
        if (document.getElementById('txtadsize2').value != "" && document.getElementById('txtadsize1').value != "") {
            var height = parseFloat(document.getElementById('txtadsize1').value);
            var width = parseFloat(document.getElementById('txtadsize2').value);
            var totarval = 0;
            if (document.getElementById('txtcolum').value != '') {
                totarval = height * parseInt(document.getElementById('txtcolum').value);

            }
            else {
                totarval = height * width;
            }
            document.getElementById('txttotalarea').value = totarval.toFixed(2);
            document.getElementById('txtbillwidth').value = width;
            document.getElementById('txtbillheight').value = height;
        }
        else if (document.getElementById('txtadsize1').value != "" && document.getElementById('txttotalarea').value != "") {
            var h_ = document.getElementById('txtadsize1').value;
            var area_ = document.getElementById('txttotalarea').value;
            document.getElementById('txtadsize2').value = formatDecimal(parseFloat(area_) / parseFloat(h_), true, 2);
        }


        if (document.getElementById('tblinsert').innerHTML != "") {
            var hei = document.getElementById('txtadsize1').value
            var wid = document.getElementById('txtadsize2').value
            getpageareaintogrid(hei, wid);
        }
    }

}

function call_chkheight(res) {
    var ds = res.value;
    var ds = res.value;
    if (ds != null && ds.Tables[1].Rows.length > 0) {
        var height_ = document.getElementById('txtadsize1').value;
        var ds_height = ds.Tables[1].Rows[0].size_height;
        if (parseFloat(height_) > parseFloat(ds_height)) {
            alert("Height exceeds with edition total height");
            document.getElementById('txtadsize1').value = "";
            document.getElementById('txtadsize1').focus();
            return false;
        }

        if (ds != null && ds.Tables[1].Rows.length > 0) {
            glob_area = ds.Tables[1].Rows[0].edition_area;
        }

    }

    if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtadsize2').value != "") {
        var h_ = document.getElementById('txtadsize1').value;
        var w_ = document.getElementById('txtadsize2').value;
        if (document.getElementById('txtcolum').value != '') {
            document.getElementById('txttotalarea').value = formatDecimal(parseFloat(h_) * parseInt(document.getElementById('txtcolum').value), true, 2);
        }
        else {
            document.getElementById('txttotalarea').value = formatDecimal(parseFloat(h_) * parseFloat(w_), true, 2);
        }
        document.getElementById('txtbillwidth').value = w_;
        document.getElementById('txtbillheight').value = h_;
    }
    else if (document.getElementById('txtadsize1').value != "" && document.getElementById('txttotalarea').value != "") {
        var h_ = document.getElementById('txtadsize1').value;
        var area_ = document.getElementById('txttotalarea').value;
        document.getElementById('txtadsize2').value = formatDecimal(parseFloat(area_) / parseFloat(h_), true, 2);
        document.getElementById('txtbillwidth').value = w_;
        document.getElementById('txtbillheight').value = document.getElementById('txtadsize2').value;
    }

    //// 23sep   if(document.getElementById('txtgrossamt').value!="NaN" && document.getElementById('txtgrossamt').value!="")
    ////     {
    ////        getagrredamou();
    ////     }
    ///////when there is a change in page area when there is insertion grid than it also changes in insertion grid automatically

    if (document.getElementById('tblinsert').innerHTML != "") {
        var hei = document.getElementById('txtbillheight').value
        if (hei == "")
            hei = document.getElementById('txtadsize1').value;
        if (document.getElementById('txtbillheight').value == "NaN") {
            hei = "";
        }
        var wid = document.getElementById('txtbillwidth').value
        if (document.getElementById('txtbillwidth').value == "NaN") {
            wid = "";
        }
        getpageareaintogrid(hei, wid);
    }

}

function chkwidth() {
    if (document.getElementById('drppackagecopy').options.length == 0) {
        alert("Please select the package");
        //document.getElementById('drppackage').focus();
        return false;
    }
    if (document.getElementById('drpuom').value == "0") {
        alert("Please select uom");
        document.getElementById('txtadsize1').value = ""
        document.getElementById('txtadsize2').value = ""
        //document.getElementById('drpuom').focus();
        return false;
    }
    var value = chkamount('txtadsize2');
    if (value == "f") {
        return false;
    }

    if (parseFloat(document.getElementById('txtadsize2').value) == 0) {
        alert("0 is not accepted");
        var idrem = document.activeElement.id;
        //document.getElementById(idrem).value="";        
        return false;
    }
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    var objpack = document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var code = "";
    var codesplit = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (temp != "") {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                desc = tempcode + "+" + desc;
            }
            else {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                desc = tempcode;

            }
        }
    }
    if (document.getElementById('txtcolum').value != "") {
        Classified_Booking.getwidthforcoll(desc, document.getElementById('txtcolum').value, document.getElementById('hiddencompcode').value, document.getElementById('drpuom').value, call_chkwidth);
    }
    else {
        if (document.getElementById('txtadsize2').value != "" && document.getElementById('txtadsize1').value != "") {
            var height = parseFloat(document.getElementById('txtadsize1').value);
            var width = parseFloat(document.getElementById('txtadsize2').value);
            var totarval = 0;
            if (document.getElementById('txtcolum').value != '') {
                totarval = height * parseInt(document.getElementById('txtcolum').value);

            }
            else {
                totarval = height * width;
            }
            document.getElementById('txttotalarea').value = totarval.toFixed(2);
            document.getElementById('txtbillwidth').value = width;
            document.getElementById('txtbillheight').value = height;
        }
        else if (document.getElementById('txtadsize1').value != "" && document.getElementById('txttotalarea').value != "") {
            var h_ = document.getElementById('txtadsize1').value;
            var area_ = document.getElementById('txttotalarea').value;
            document.getElementById('txtadsize2').value = formatDecimal(parseFloat(area_) / parseFloat(h_), true, 2);
        }


        if (document.getElementById('tblinsert').innerHTML != "") {
            var hei = document.getElementById('txtadsize1').value
            var wid = document.getElementById('txtadsize2').value
            getpageareaintogrid(hei, wid);
        }
    }
}


function call_chkwidth(res) {
    var ds = res.value;
    if (ds != null && ds.Tables[1].Rows.length > 0) {
        var width_ = document.getElementById('txtadsize2').value;
        var ds_height = ds.Tables[1].Rows[0].size_width;
        if (parseFloat(width_) > parseFloat(ds_height)) {
            document.getElementById('txtadsize2').focus();
            alert("Width exceeds with edition total width");
            document.getElementById('txtadsize2').value = "";
            return false;
        }
        if (ds != null && ds.Tables[1].Rows.length > 0) {
            glob_area = ds.Tables[1].Rows[0].edition_area;
        }
    }

    if (document.getElementById('txtadsize2').value != "" && document.getElementById('txtadsize1').value != "") {
        var height = parseFloat(document.getElementById('txtadsize1').value);
        var width = parseFloat(document.getElementById('txtadsize2').value);
        document.getElementById('txtbillwidth').value = width;
        document.getElementById('txtbillheight').value = height;
        var totarval = height * width;
        document.getElementById('txttotalarea').value = totarval.toFixed(2);
        document.getElementById('txtcolum').value = "";
        document.getElementById('txtcolum').disabled = true;
        //document.getElementById('txtbillarea').value=document.getElementById('txttotalarea').value;
    }
    else {
        //document.getElementById('txttotalarea').value="";
        document.getElementById('txtcolum').value = "";
        document.getElementById('txtcolum').disabled = false;
    }

    if (document.getElementById('txtadsize2').value != "" && document.getElementById('txttotalarea').value != "") {
        var width = document.getElementById('txtadsize2').value;
        var area_ = document.getElementById('txttotalarea').value
        document.getElementById('txtadsize1').value = formatDecimal(parseFloat(area_) / parseFloat(width), true, 2);
        document.getElementById('txtbillwidth').value = document.getElementById('txtadsize2').value;
        document.getElementById('txtbillheight').value = height;
    }

    //// 23sep    if(document.getElementById('txtgrossamt').value!="NaN" && document.getElementById('txtgrossamt').value!="")
    ////     {
    ////          getagrredamou();
    ////     }
    ///////when there is a change in page area when there is insertion grid than it also changes in insertion grid automatically

    if (document.getElementById('tblinsert').innerHTML != "" && document.getElementById('txtadsize2').value != "") {
        var hei = document.getElementById('txtbillheight').value
        if (document.getElementById('txtbillheight').value == "NaN") {
            hei = "";
        }
        var wid = document.getElementById('txtbillwidth').value
        if (document.getElementById('txtbillwidth').value == "NaN") {
            wid = "";
        }
        getpageareaintogrid(hei, wid);
    }

}



///////////////////this is the function created to get the solo rate break up with referrence to the pacakage selected
function keySort(dropdownlist, caseSensitive) {
    // check the keypressBuffer attribute is defined on the dropdownlist 
    var undefined;
    if (dropdownlist.keypressBuffer == undefined) {
        dropdownlist.keypressBuffer = '';
    }
    // get the key that was pressed 
    var key = String.fromCharCode(window.event.keyCode);
    dropdownlist.keypressBuffer += key;
    if (!caseSensitive) {
        // convert buffer to lowercase
        dropdownlist.keypressBuffer = dropdownlist.keypressBuffer.toLowerCase();
    }
    // find if it is the start of any of the options 
    var optionsLength = dropdownlist.options.length;
    for (var n = 0; n < optionsLength; n++) {
        var optionText = dropdownlist.options[n].text;
        if (!caseSensitive) {
            optionText = optionText.toLowerCase();
        }
        if (optionText.indexOf(dropdownlist.keypressBuffer, 0) == 0) {
            dropdownlist.selectedIndex = n;
            if (document.activeElement.id == "drpadcategory")
                filladsubcatmain();
            else if (document.activeElement.id == "drpadsubcategory")
                bindadscat3();
            else if (document.activeElement.id == "drpadcat3")
                bindadscat4();
            else if (document.activeElement.id == "drpadcat4")
                bindadcat5();
            return false; // cancel the default behavior since 
            // we have selected our own value 
        }
    }
    // reset initial key to be inline with default behavior 
    dropdownlist.keypressBuffer = key;

    return true; // give default behavior 
}

///this function is to chk or unchk the cliend and agency address chk box in the box details tab
function agencychk() {
    if (document.getElementById('chkage').checked == true) {
        document.getElementById('chkclie').checked = false;
        document.getElementById('txtboxaddress').value = "";
        document.getElementById('txtboxaddress').value = document.getElementById('txtagencyaddress').value;
        //document.getElementById('txtboxaddress').disabled=true;
    }
    if (document.getElementById('chkage').checked == false) {
        document.getElementById('txtboxaddress').value = "";
        //document.getElementById('txtboxaddress').disabled=false;
    }
}

function clientchk() {
    if (document.getElementById('chkclie').checked == true) {
        document.getElementById('chkage').checked = false;
        document.getElementById('txtboxaddress').value = "";
        document.getElementById('txtboxaddress').value = document.getElementById('txtclientadd').value;
        //document.getElementById('txtboxaddress').disabled=true;    
    }
    if (document.getElementById('chkclie').checked == false) {
        document.getElementById('txtboxaddress').value = "";
        //document.getElementById('txtboxaddress').disabled=false;    
    }

}
///////////////////////////////////////this is the call back function to bind the grid when we subtract the insertion date


function insertLinesubtract_callback(packagename, check) {
    // get No of Insertion
    var rowCount = parseInt(document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length);
    var finsert = 1;
    var insertion = document.getElementById('txtinsertion').value;
    var gridtab_vari = document.getElementById('gridtab');
    var pkgcopy_vari = document.getElementById('drppackagecopy');
    var bookdiv_vari = document.getElementById('bookdiv');
    if (spdiscper == 1) {
        document.getElementById('txtspedisc').value = "";
    }
    else if (spdisc == 1) {
        document.getElementById('txtspediscper').value = "";
    }
    if (check == 'main') {
        if (pkgcopy_vari.options.length > 0) {
            for (var insertCou = 0; insertCou < pkgcopy_vari.options.length; insertCou++) {
                rowCount = parseInt(bookdiv_vari.getElementsByTagName('table')[0].rows.length);
                if (pkgcopy_vari.options[insertCou].value.indexOf('(') >= 0) {
                    tinsert = pkgcopy_vari.options[insertCou].value.substring(pkgcopy_vari.options[insertCou].value.indexOf('(') + 1, pkgcopy_vari.options[insertCou].value.indexOf(')'));
                }

                var dInsert = (parseInt(previnsertion, 10) * parseInt(tinsert, 10)) - (parseInt(insertion, 10) * parseInt(tinsert, 10));
                var insid = "";
                for (var d = parseInt(rowCount) - 2; d >= 0; d--) {
                    var id = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[d + 1].cells[0].id.substr(3, document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[d + 1].cells[0].id.length - 3);
                    insid = document.getElementById("ins" + id).innerHTML
                    if (parseInt(insid) > parseInt(document.getElementById('txtinsertion').value)) {
                        document.getElementById('gridtab').deleteRow(d + 1);
                        try {
                            delete caldate[d];
                            delete caldatemonth[d];
                            delete caldateyear[d];
                            cali = parseInt(cali, 10) - 1;
                        }
                        catch (er) { }
                    }
                    /*var id=gridtab_vari.getElementsByTagName("tbody")[0].rows[d+1].cells[0].id.substr(3,gridtab_vari.getElementsByTagName("tbody")[0].rows[d+1].cells[0].id.length-3);
                    var ins_vari=document.getElementById("ins"+id);
                    var par1=(ins_vari.parentNode).parentNode;
                    if(insid!="")
                    {
                    if(insid!=ins_vari.innerHTML)
                    {
                    dInsert=parseInt(dInsert)-1;
                    }
                    }   
                    if(dInsert==0)
                    break;
                    var strid = pkgcopy_vari.options[insertCou].value;
                    var strid1=strid.split('@');
                    var pkgid=strid1[0];
                    if(browser!="Microsoft Internet Explorer")
                    {
                    var pkgcodegrid=document.getElementById("hiddenpckcode"+id).value;
                    }
                    else
                    {
                    var pkgcodegrid=par1.all["hiddenpckcode"+id].value;
                    }
                    if(pkgcodegrid == pkgid)
                    {
                    insid=ins_vari.innerHTML;
                    gridtab_vari.deleteRow(d+1);
                    try
                    {
                    delete caldate[d];
                    delete caldatemonth[d];
                    delete caldateyear[d];
                    }
                    catch(er){}
                    }*/
                }
            }
        }

    }
    else {
        if (pkgcopy_vari.options.length > 0) {
            for (var insertCou = 0; insertCou < pkgcopy_vari.options.length; insertCou++) {
                rowCount = parseInt(bookdiv_vari.getElementsByTagName('table')[0].rows.length);
                if (pkgcopy_vari.options[insertCou].value.indexOf('(') >= 0) {
                    tinsert = pkgcopy_vari.options[insertCou].value.substring(pkgcopy_vari.options[insertCou].value.indexOf('(') + 1, pkgcopy_vari.options[insertCou].value.indexOf(')'));
                }
                if (packagename == pkgcopy_vari.options[insertCou].value) {
                    var prevtinsert = parseInt(tinsert) + 1;
                    var insid = "";
                    var dInsert = (parseInt(previnsertion, 10) * parseInt(prevtinsert, 10)) - (parseInt(insertion, 10) * parseInt(tinsert, 10));
                    for (n = 0; n < dInsert; n++) {
                        for (var d = parseInt(rowCount) - 2; d >= 0; d--) {
                            var ins_vari = document.getElementById("ins" + id);
                            var par1 = (ins_vari.parentNode).parentNode;
                            var strid = pkgcopy_vari.options[insertCou].value;
                            var strid1 = strid.split('@');
                            var pkgid = strid1[0];
                            var id = gridtab_vari.getElementsByTagName("tbody")[0].rows[d + 1].cells[0].id.substr(3, gridtab_vari.getElementsByTagName("tbody")[0].rows[d + 1].cells[0].id.length - 3);
                            if (browser != "Microsoft Internet Explorer") {
                                var pkgcodegrid = document.getElementById("hiddenpckcode" + id).value;
                            }
                            else {
                                var pkgcodegrid = par1.all["hiddenpckcode" + id].value;
                            }
                            if (insid != "") {

                                if (insid != ins_vari.innerHTML && n == dInsert - 1) {
                                    return false;
                                }
                            }
                            if (pkgcodegrid == pkgid) {
                                if (insid != "") {
                                    if (insid != ins_vari.innerHTML) {
                                        n = parseInt(n, 10) + 1;
                                    }
                                }
                                insid = ins_vari.innerHTML;
                                gridtab_vari.deleteRow(d + 1);
                                try {
                                    delete caldate[d];
                                    delete caldatemonth[d];
                                    delete caldateyear[d];
                                }
                                catch (er) { }
                            }
                        }
                    }
                }

            }
        }
    }
    previnsertion = document.getElementById('txtinsertion').value;
    document.getElementById('hiddenrowcount').value = parseInt(document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length) - 1;
    return false;

}


//this is to save the insertion lines into the database

function saveinsertion() {
    var len = "bookdiv";
    var insertno;
    var premid;
    var premper;
    var colid;
    var heightid;
    var widthid;
    var size;
    var late;
    //var uomid;
    //var adtypid;
    var cardid;
    var editid;
    var solorate;
    var premper1;
    var prem1id;
    var namecode;
    var inserts;
    var pagepost;
    var preall;
    var adcat;
    var adsubcat;
    var matsta;
    var filename;
    var discrate;
    var insertsta;
    var billstat;
    var id;
    var repeat;
    var i = 0;
    var paid;
    var agrred;
    var solo;
    var gross;
    var insert = "0";
    var pageno_inserts;
    var remark_inserts;
    var caption_inserts;
    var page;
    var pageprem;
    var noofcol;
    var billamt;
    var billrate;
    var agnamnt;
    var adlgn;
    var spldisc;
    var cashdisc;
    var roundoffval;
    var pheival;
    var sectioncode_val = "";
    var resourceno_val = "";
    var cpn_amt;
    var clicatamtval;
    var flatfreqamtval;
    var catamtval;
    var GSTAMT ;
    var GSTGD;
    var compcode = document.getElementById('hiddencompcode').value;
    var userid = document.getElementById('hiddenuserid').value;
    var cioid = document.getElementById('txtciobookid').value;
    //var y=document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
    //var y=parseInt(noofinsert)   
    var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
    Classified_Booking.insertionCount(cioid, y);
    var k;
    var dat_for = document.getElementById('hiddendateformat').value
    for (k = 0; k < y; k++) {

        editid = "edit" + i;
        colid = "col" + i;
        var spltdata = "spltdata" + i;
        var subedi = "subedidata" + i;
        pagepost = "pgpre" + i;  //"pagpos"+i;
        namecode = "one";
        namecode = "two";
        preall = "preall" + i;
        adcat = "adcat" + i;
        late = "lat" + i;
        matsta = "mat" + i;
        cardid = "card" + i;
        filename = "fil" + i;
        discrate = "disrat" + i;
        insertsta = "inssta" + i;
        billstat = "bill" + i;
        adsubcat = "ads" + i;
        repeat = "rep" + i;
        insertno = "ins" + i;
        paid = "pai" + i
        agrred = "agr" + i;
        solo = "sol" + i;
        gross = "gro" + i;
        pageno_inserts = "pagno" + i; ;
        remark_inserts = "rem" + i;
        caption_inserts = "cap" + i;
        page = "pgpre" + i;
        pageprem = "pagper" + i;
        noofcol = "nocol" + i;
        billamt = "ba" + i;
        billrate = "br" + i;
        agnamnt = "agmn" + i;
        adlgn = "adlag" + i;
        spldisc = "spld" + i;
        cashdisc = "cashd" + i;
        roundoffval = "roundoffval" + i;
        pheival = "pheival" + i;
        cpn_amt = "coupan" + i;
        clicatamtval = "clicatamt" + i;
        flatfreqamtval = "flatfreqamt" + i;
        catamtval = "catamt" + i;
        GSTAMT = "GSTAMT" + i;
        GSTGD = "GSTGD" + i;
        var splboldsize = "splboldsize" + i;
        var sectioncode = "seccode" + i;
        var resourceno = "resno" + i;
        var splboldsizevalue = "";
        var splitdata = "";
        var subedidata = "";
        var gstamount="";
        var gstgrid="";
        id = document.getElementById("Text" + i);
        var par1 = (id.parentNode).parentNode;
        if (browser != "Microsoft Internet Explorer") {
            if (document.getElementById(spltdata) != null) {
                splitdata = document.getElementById(spltdata).value;
            }
            if (document.getElementById(subedi) != null) {
                subedidata = document.getElementById(subedi).value;
            }
            if (document.getElementById(sectioncode) != null) {
                sectioncode_val = document.getElementById(sectioncode).value;
            }
            if (document.getElementById(resourceno) != null) {
                resourceno_val = document.getElementById(resourceno).value;
            }
            var insernum = document.getElementById(insertno).innerHTML;
            heightid = document.getElementById("hei" + i);
            widthid = document.getElementById("wid" + i);
            size = document.getElementById("siz" + i);


            var insertdate = id.value;
            var edition = document.getElementById(editid).value;
            splboldsizevalue = document.getElementById(splboldsize).value;
            var premium1 = "0"//document.getElementById(premid).value;
            var premium2 = "0"//document.getElementById(prem1id).value;
            var height = heightid.value;
            var width = widthid.value;
            var totalsize = size.value;
            // var pagepost=0;
            if (document.getElementById(pagepost) != null) {
                pagepost = document.getElementById(pagepost).value;
            }
            var color = document.getElementById(colid).value;
            var premper11 = "0"//document.getElementById(premper).value;
            var premper2 = "0"//document.getElementById(premper1).value;
            var premallow = document.getElementById(preall).value;
            var adcategory = document.getElementById(adcat).value;
            var latestdate = document.getElementById(late).value;
            var material = document.getElementById(matsta).value;
            var cardrate = document.getElementById(cardid).value;
            var filename = document.getElementById(filename).value;
            var discrate = document.getElementById(discrate).value;
            var insertstatus = document.getElementById(insertsta).value;
            var billstatus = document.getElementById(billstat).value;
            var adsubcat = document.getElementById(adsubcat).value;
            var repdate = document.getElementById(repeat).value;
            var paidins = document.getElementById(paid).value;
            var insagreedrate = document.getElementById(agrred).value;
            var inssolo = document.getElementById(solo).value;
            var grossrate = document.getElementById(gross).value;
            var insert_pageno = document.getElementById(pageno_inserts).value;
            var insert_remark = document.getElementById(remark_inserts).value;
            var insert_caption = document.getElementById(caption_inserts).value;
            var page_code = document.getElementById(page).value;
            var page_per = document.getElementById(pageprem).value;
            var no_ofcol = document.getElementById(noofcol).value;
            var bill_amt = document.getElementById(billamt).value;
            var bill_rate = document.getElementById(billrate).value;
            var agncommant = document.getElementById(agnamnt).value;
            var adlgamnt = document.getElementById(adlgn).value;
            var splcomamt = document.getElementById(spldisc).value;
            var cashammt = document.getElementById(cashdisc).value;
            var roundoffamt = document.getElementById(roundoffval).value;
            var pdfheightval = document.getElementById(pheival).value;
            var cpnamt = document.getElementById(cpn_amt).value;
            var clicatamt = document.getElementById(clicatamtval).value;
            var flatfreqamt = document.getElementById(flatfreqamtval).value;
            var catamt = document.getElementById(catamtval).value;
            var pkgcodegrid_value = "";
            var pkginsgrid_value = "";
            var pkg_alias_value = "";
            var pkgcodegrid = "hiddenpckcode" + i;

            var pkg_ins = "pkg_ins" + i;

            var pkg_alias = "pkg_alias" + i;
            if (document.getElementById(pkgcodegrid) != null) {
                pkgcodegrid_value = document.getElementById(pkgcodegrid).value;
            }

            if (document.getElementById(pkg_ins) != null) {
                pkginsgrid_value = document.getElementById(pkg_ins).value;
            }

            if (document.getElementById(pkg_alias) != null) {
                pkg_alias_value = document.getElementById(pkg_alias).value;
            }
            if (document.getElementById(GSTAMT) != null) {
                gstamount = document.getElementById(GSTAMT).value;
            }
            if (document.getElementById(GSTGD) != null) {
                gstgrid = document.getElementById(GSTGD).value;
            }
        }
        else {
            var insernum = par1.all[insertno].innerHTML;
            heightid = par1.all["hei" + i];
            widthid = par1.all["wid" + i];
            size = par1.all["siz" + i];
            if (par1.all[spltdata] != null) {
                splitdata = par1.all[spltdata].value;
            }
            if (par1.all[subedi] != null) {
                subedidata = par1.all[subedi].value;
            }
            if (par1.all[sectioncode] != null) {
                sectioncode_val = par1.all[sectioncode].value;
            }
            if (par1.all[resourceno] != null) {
                resourceno_val = par1.all[resourceno].value;
            }
            var insertdate = id.value;
            var edition = par1.all[editid].value;
            splboldsizevalue = par1.all[splboldsize].value;
            var premium1 = "0"//document.getElementById(premid).value;
            var premium2 = "0"//document.getElementById(prem1id).value;
            var height = heightid.value;
            var width = widthid.value;
            var totalsize = size.value;
            // var pagepost=0;
            if (par1.all[pagepost] != null) {
                pagepost = par1.all[pagepost].value;
            }
            var color = par1.all[colid].value;
            var premper11 = "0"//document.getElementById(premper).value;
            var premper2 = "0"//document.getElementById(premper1).value;
            var premallow = par1.all[preall].value;
            var adcategory = par1.all[adcat].value;
            var latestdate = par1.all[late].value;
            var material = par1.all[matsta].value;
            var cardrate = par1.all[cardid].value;
            var filename = par1.all[filename].value;
            var discrate = par1.all[discrate].value;
            var insertstatus = par1.all[insertsta].value;
            var billstatus = par1.all[billstat].value;
            var adsubcat = par1.all[adsubcat].value;
            var repdate = par1.all[repeat].value;
            var paidins = par1.all[paid].value;
            var insagreedrate = par1.all[agrred].value;
            var inssolo = par1.all[solo].value;
            var grossrate = par1.all[gross].value;
            var insert_pageno = par1.all[pageno_inserts].value;
            var insert_remark = par1.all[remark_inserts].value;
            var insert_caption = par1.all[caption_inserts].value;
            var page_code = par1.all[page].value;
            var page_per = par1.all[pageprem].value;
            var no_ofcol = par1.all[noofcol].value;
            var bill_amt = par1.all[billamt].value;
            var bill_rate = par1.all[billrate].value;
            var agncommant = par1.all[agnamnt].value;
            var adlgamnt = par1.all[adlgn].value;
            var splcomamt = par1.all[spldisc].value;
            var cashammt = par1.all[cashdisc].value;
            var roundoffamt = par1.all[roundoffval].value;
            var pdfheightval = par1.all[pheival].value;
            var cpnamt = par1.all[cpn_amt].value;
            var clicatamt = par1.all[clicatamtval].value;
            var flatfreqamt = par1.all[flatfreqamtval].value;
            var catamt = par1.all[catamtval].value;
            var pkgcodegrid_value = "";
            var pkginsgrid_value = "";
            var pkg_alias_value = "";
            var pkgcodegrid = "hiddenpckcode" + i;

            var pkg_ins = "pkg_ins" + i;

            var pkg_alias = "pkg_alias" + i;
            if (par1.all[pkgcodegrid] != null) {
                pkgcodegrid_value = par1.all[pkgcodegrid].value;
            }

            if (par1.all[pkg_ins] != null) {
                pkginsgrid_value = par1.all[pkg_ins].value;
            }

            if (par1.all[pkg_alias] != null) {
                pkg_alias_value = par1.all[pkg_alias].value;
            }
            if (par1.all[GSTAMT] != null) {
                gstamount = par1.all[GSTAMT].value;
            }
            if (par1.all[GSTGD] != null) {
                gstgrid = par1.all[GSTGD].value;
            }
        }
        // vTS popup
        var vtsvalue = document.getElementById('vts' + i).value;
        var cirvts = '';
        var cirpub = '';
        var ciredi = '';
        var cirrate = '';
        var cirdate = '';
        var ciragency = document.getElementById('txtciragency').value;
        var ciragencysubcode = '';
        if (ciragency != "") {
            var myarrayex = ciragency.split('(');
            var agecirname = myarrayex[1].replace(")", "").split('+')[0];
            ciragency = trim(agecirname);
            ciragencysubcode = trim(myarrayex[1].replace(")", "").split('+')[1]);
        }
        if (vtsvalue != "") {
            cirvts = vtsvalue.split('ÿ')[0];
            cirpub = vtsvalue.split('ÿ')[1];
            ciredi = vtsvalue.split('ÿ')[2];
            cirrate = vtsvalue.split('ÿ')[3];
            cirdate = vtsvalue.split('ÿ')[4];
        }
        // for logo
        var logohei = document.getElementById('logohei' + i).value;
        var logowid = document.getElementById('logowid' + i).value;
        var logonam = document.getElementById('logonam' + i).value;
        if (cioid == "") {
            alert("Booking Id can't be blank");
            return false;
        }
        var boxcharge = document.getElementById('boxc' + i).value;
        var vat_inc = document.getElementById('vat_inc' + i).value;
        var grosslocal = document.getElementById("grolocal" + i).value;
        var billamtlocal = document.getElementById("balocal" + i).value;
        var discountmain = "";
        if (document.getElementById("disc_" + i) != null)
            discountmain = document.getElementById("disc_" + i).value;
        var premamtval = '';
        var subcat3 = document.getElementById("drpadcat3").value;
        var subcat4 = document.getElementById("drpadcat4").value;
        var subcat5 = document.getElementById("drpadcat5").value;
        if(cioprevgst!="")
        {
        gstgrid= gstgrid.split(cioprevgst);
        gstgrid= gstgrid.join(cioid);
        }
        
        if(insert_pageno == "" || insert_pageno == "0" || insert_pageno==null)
        {
            insert_pageno="4";
        }
        //alert(insert_pageno);
        var res = Classified_Booking.insertinsertion(insertdate, edition, premium1, premium2, premallow, adcategory, latestdate, material, cardrate, filename, discrate, insertstatus, billstatus, adsubcat, compcode, userid, cioid, height, width, totalsize, pagepost, premper11, premper2, color, repdate, insernum, paidins, insagreedrate, inssolo, grossrate, insert, insert_pageno, insert_remark, page_code, page_per, no_ofcol, bill_amt, bill_rate, dat_for, pkgcodegrid_value, pkginsgrid_value, pkg_alias_value, logohei, logowid, logonam, cirvts, cirpub, ciredi, cirrate, cirdate, ciragency, ciragencysubcode, document.getElementById('hiddencenter').value, document.getElementById('txtbranch').value, document.getElementById('hiddenserverip').value, splboldsizevalue, splitdata, subedidata, document.getElementById('vat' + i).value, boxcharge, vat_inc, grosslocal, billamtlocal, sectioncode_val, resourceno_val, insert_caption, discountmain, agncommant, adlgamnt, splcomamt, cashammt, roundoffamt, pdfheightval, cpnamt, clicatamt, flatfreqamt, catamt, premamtval,subcat3,subcat4,subcat5,gstamount,gstgrid);
        if (res.error != null) {
            alert(res.error.description);
            Classified_Booking.rollback(cioid);
            return false;
        }
        if (res.value != "") {
            alert(res.value.toString());
            Classified_Booking.rollback(cioid);
            return false;
        }
        i = parseInt(i, 10) + 1;
    }
    var emailbranch="";
    if(document.getElementById('hiddenrateauditflag').value!="rateaudit")
    {
        if (ALLOWBOOKINGBRANCHMAIL == "Y" && mailsavestr!="" ) 
        {
            //mailsavestr = "NBN~~~~N10~~~~bhanu@4cplus.com^^^^^NBN~~~~N11~~~~bhanu@4cplus.com^^^^^NBN~~~~N12~~~~bhanu@4cplus.com^^^^^NBN~~~~N13~~~~bhanu@4cplus.com^^^^^NBN~~~~N14~~~~bhanu@4cplus.com^^^^^NBN~~~~NB5~~~~bhanu@4cplus.com^^^^^NBN~~~~NB6~~~~bhanu@4cplus.com^^^^^NBN~~~~NB7~~~~bhanu@4cplus.com^^^^^NBN~~~~NB8~~~~bhanu@4cplus.com^^^^^NBN~~~~NB9~~~~bhanu@4cplus.com^^^^^NBN~~~~NBN~~~~bhanu@4cplus.com";
            var arr_split = mailsavestr.split('^^^^^');
            var narr_split = "";
            var mailcenter = "";
            var mailbranch = "";
            var mailid = "";
            for (var i = 0; i < arr_split.length; i++) {
                var narr_split = trim(arr_split[i]).split('~~~~');
                mailcenter = narr_split[0];
                if (emailbranch==""){
                emailbranch=narr_split[2];
                }
                else{
                emailbranch=emailbranch+','+narr_split[2];
                }
                mailbranch = narr_split[1];
                mailid = narr_split[2];
                var mailres = Classified_Booking.mailsave(cioid, compcode, mailcenter, mailbranch, mailid, userid, "", "", "", "", "");
                if (mailres.error != null) {
                    alert(mailres.error.description);
                    return false;
                }
            }
        }  
    }
    var sta = "";
    var pcentname = document.getElementById('hiddencenter').value;
    pcentname = pcentname.substring(0, 3);
    var idformat = document.getElementById('hiddencioidformat').value;
    var quotation = document.getElementById('hiddenquotation').value;
    //var ressta = Classified_Booking.commit(y, cioid, compcode, pcentname, userid, idformat, quotation);
    var clientcode = document.getElementById('configclient').value;
    var ressta = Classified_Booking.commit(y, cioid, compcode, pcentname, userid, idformat, quotation, clientcode);

    if (ressta.error != null) {
        alert(ressta.error.description);
        //Classified_Booking.rollback(cioid);
        return false;
    }
    sta = ressta.value.split('$~$')[0];
    mainbookingid = ressta.value.split('$~$')[1];
    if (sta.value == "N") {
        alert("There is some problem while saving the total records " + y.toString() + "   grid Details. Please contact with 4cplus  for further information");
        return false;
    }
    Classified_Booking.savelogin_dj(mainbookingid);
    
    //***************************Call page for saving the Matter*****************************************

    if (browser != "Microsoft Internet Explorer") {
        var httpRequest = null; ;
        httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml');
        }

        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

        httpRequest.open("GET", "insertMatter.aspx?receipt=" + mainbookingid + "&tempbkid=" + cioid + "&modify=0&boxno=" + document.getElementById('txtboxno').value + "&oldboxno=" + document.getElementById('oldboxno').value + "&currcioid=", false);
        httpRequest.send('');
        //alert(httpRequest.readyState);
        if (httpRequest.readyState == 4) {
            //alert(httpRequest.status);
            if (httpRequest.status == 200) {
                //strtext=httpRequest.responseText;
            }
            else {
                alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
            }
        }
    }
    else {
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        xml.Open("GET", "insertMatter.aspx?receipt=" + mainbookingid + "&tempbkid=" + cioid + "&modify=0&boxno=" + document.getElementById('txtboxno').value + "&oldboxno=" + document.getElementById('oldboxno').value + "&currcioid=", false);
        xml.Send();
    }
    if(document.getElementById('hiddenrateauditflag').value!="rateaudit")
    {
        if (ALLOWBOOKINGBRANCHMAIL == "Y" && mailsavestr!="") 
        {
            // var mailres1 = Classified_Booking.mailfinalsave(mainbookingid,emailbranch, "", "", "", "", "");
            //var mailres1 = Classified_Booking.mailfinalsave(document.getElementById('hiddencompcode').value, mainbookingid, emailbranch, document.getElementById('hidattach1').value, "", "", "", "");
            
            //final
            if (hidcopy == "copy")
            {
                var mailres1 = Classified_Booking.mailfinalsave(document.getElementById('hiddencompcode').value, mainbookingid, emailbranch, document.getElementById('hidattach1').value, "", "", "", "");
            }
            else
            {
                var mailres1 = Classified_Booking.mailfinalsave(document.getElementById('hiddencompcode').value, mainbookingid, emailbranch, document.getElementById('hidattach1').value, chkbtnStatus, "", "", "");
            }
            // var mailres1 = Classified_Booking.mailfinalsave(document.getElementById('hiddencompcode').value, mainbookingid, emailbranch, document.getElementById('hidattach1').value, material, "", "", "");
                if (mailres1.error != null) {
                    alert(mailres1.error.description);
                    return false;
                }
        }
    }
    document.getElementById('tblinsert').innerHTML = "";

    document.getElementById('tblrate').style.display = "none";
    document.getElementById('tblbill').style.display = "none";
    //document.getElementById('tblsize').style.display="none";
    document.getElementById('addetails').style.display = "none";
    document.getElementById('pagedetail').style.display = "none";
    document.getElementById('tblpackage').style.display = "none";
    document.getElementById('tbbox').style.display = "none";
    //document.getElementById('txtciobookid').value="";
    document.getElementById('txtciobookid').value = mainbookingid;
    document.getElementById('LinkButton1').disabled = true;
    document.getElementById('LinkButton2').disabled = true;
    document.getElementById('LinkButton3').disabled = true;
    document.getElementById('LinkButton4').disabled = true;
    document.getElementById('LinkButton5').disabled = true;
    document.getElementById('LinkButton6').disabled = true;
    document.getElementById('LinkButton7').disabled = true;
    var flagrate;
    ////////////////

    noofinsert = "";
    noofinsertlo = "";
    rowwhenupdate = "";
    fillinsert = "";
    insertval = "";
    boxpercen = "";
    boxgamt;
    boxbill;
    glspedisc = "0";
    glspadisc = "0";
    glspeccharge = "0";
    glpre = "0";
    savtotid;
    getid = "";
    countgridloop = "";
    schemediscount = "";
    subtractrow = "0";
    
    // mater save before
    
    
    if (quotation == 'Q') {
        Classified_Booking.btnSavecall(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value, mainbookingid, quotation);
    }
    //   return false;
}


//function for uploading the images

function preview(what) {
    var id = document.getElementById(what);
    var source = document.getElementById(what).value;
    var ext = source.substring(source.lastIndexOf(".") + 1, source.length).toLowerCase();
    for (var i = 0; i < fileTypes.length; i++) if (fileTypes[i] == ext) break;
    globalPic = new Image();
    if (i < fileTypes.length) globalPic.src = source;
    else {
        globalPic.src = defaultPic;
        alert("THAT IS NOT A VALID IMAGE\nPlease load an image with an extention of one of the following:\n\n" + fileTypes.join(", "));
    }
    Classified_Booking.saveimage(id);
    var val = "";

    if (browser != "Microsoft Internet Explorer") {
        var httpRequest = null; ;
        httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml');
        }

        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

        httpRequest.open("GET", "saveimage.aspx?source=" + source, false);
        httpRequest.send('');
        //alert(httpRequest.readyState);
        if (httpRequest.readyState == 4) {
            if (httpRequest.status == 200) {
                val = httpRequest.responseText;
            }
            else {
                alert('Session TimeOut. Unable To Process Your Request. Please Login Again');
            }
        }
    }
    else {
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        xml.Open("GET", "saveimage.aspx?source=" + source, false);
        xml.Send();
        val = xml.responseText;
    }
    alert(val);
}

var globalPic;
function applyChanges() {
    var field = document.getElementById(outImage);
    var x = parseInt(globalPic.width);
    var y = parseInt(globalPic.height);
    if (x > maxWidth) {
        y *= maxWidth / x;
        x = maxWidth;
    }
    if (y > maxHeight) {
        x *= maxHeight / y;
        y = maxHeight;
    }
    //field.style.display=(x<1 || y<1)?"none":"";
    field.src = globalPic.src;
    field.width = x;
    field.height = y;
}

////this is when we open the matter item line wise

function uploadimage(id, ins, edition, fileid, ival) {
    var insertid = ival;
    if (document.getElementById('txtdummydate').value == "") {
        alert("Please Fill the Publish date");
        return false;
    }
    if (document.getElementById('drpuom').value != "0") {
        var hei = document.getElementById('txtadsize1').value;
        var wid = document.getElementById('txtadsize2').value;
        var hei = document.getElementById('txtadsize1').value;
        var wid = document.getElementById('txtadsize2').value;
        var eyecatch = document.getElementById('drpbullet').value;
        var bgcolor = document.getElementById('drpbgcolor').value;
        //  var eyecatchlength=document.getElementById('txtbullprem').value;
        var width = document.getElementById('txtadsize2').value;
        var insertNo = document.getElementById('ins' + ival).innerHTML;
        var adheight = document.getElementById('hei' + ival).value;
        var adwidth = document.getElementById('wid' + ival).value;
        var uom_desc_ = document.getElementById('hiddenuomdesc').value;
        var filename = document.getElementById('fil' + ival).value;

        var packagepckcode = document.getElementById('hiddenpckcode' + ival).value;

        var matstatus = 'mat' + ival;

        var datefield = "";
        if (document.getElementById('Text' + ival).value != "")
            datefield = document.getElementById('Text' + ival).value;
        else
            datefield = document.getElementById(txtdummydate).value;
        // width = "3.8";
        var objpack = document.getElementById('drppackagecopy');
        var temp = "";
        var tempcode = "";
        var tempval = "";
        var tempvalcode = "";
        var desc = "";
        var code = "";
        var i = objpack.options.length;
        var j;

        for (j = 0; j < i; j++) {
            if (parseInt(i) > 0) {
                tempval = objpack[j].value;
                //tempvalcode=objpack[j].value;
                if (temp != "") {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    code = tempvalcode + "+" + code;
                    desc = tempcode + "+" + desc;
                }
                else {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    code = tempvalcode;
                    desc = tempcode;
                }
            }
        }
        width = desc.replace("+", "^");
        var uom = document.getElementById('drpuom').value;
        var insertid = ival;
        var eyecatchlength = 2;
        var coltype = document.getElementById('drpcolor').value;
        if (eyecatchlength == "") {
            eyecatchlength = "0";
        }
        if (bgcolor == "0") {
            bgcolor = "White";
        }
        
        var insertid = ival;
        var insertNo = document.getElementById('txtinsertion').value;
         var receiptno = document.getElementById('txtreceipt').value;
         var packagecode = document.getElementById('hiddenpackage').value;
        //if(document.getElementById('drpuom').value=="RO0" || document.getElementById('drpuom').value=="RO1" || document.getElementById('drpuom').value=="RO3")
        if (document.getElementById('hiddenuomdesc').value == "ROC" || document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROW" || document.getElementById('hiddenuomdesc').value == "ROD" || document.getElementById('hiddenuomdesc').value == "ROH") {
            //*25Aug* window.open('matter.aspx?modify='+modifyMatter+'&coltype='+coltype+'&filename='+document.getElementById('fil'+ival).value+'&srno='+ival+'&edition='+edition+'&insertNo='+insertNo+'&cioid='+document.getElementById('txtciobookid').value+'&eyecatch='+eyecatch+'&bgcolor='+bgcolor+'&eyecatchlength='+eyecatchlength+'&width='+width+'&uom='+uom+'&insertid='+insertid+'&uom_desc_='+uom_desc_,'','width='+screen.availWidth+',height='+screen.availHeight+',resizable=1,left=0,top=0,scrollbars=yes');
            var agency_vari = document.getElementById('txtagency');
            if (agency_vari.value != "") {
                agencycode = agency_vari.value.substring(agency_vari.value.lastIndexOf("(") + 1, agency_vari.value.lastIndexOf(")"));
            }
            var prevcioid = document.getElementById('hiddendummycioid').value;
            if (clientfromconfig == "SP" || clientfromconfig == "RP") {
                window.open('Editor_new.aspx?prevcioid=' + prevcioid + '&agencycode=' + agencycode + '&logo=' + document.getElementById('hiddenlogocode').value + '&modify=' + modifyMatter + '&coltype=' + coltype + '&filename=' + document.getElementById('fil' + ival).value + '&logoname=' + document.getElementById('logonam' + ival).value + '&srno=' + ival + '&edition=' + edition + '&insertNo=' + insertNo + '&cioid=' + document.getElementById('txtciobookid').value + '&eyecatch=' + eyecatch + '&bgcolor=' + bgcolor + '&eyecatchlength=' + eyecatchlength + '&width=' + width + '&uom=' + uom + '&insertid=' + insertid + '&insertsta=' + document.getElementById('inssta' + 0).value + '&uom_desc_=' + uom_desc_, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0,scrollbars=yes');
            }
            else
                window.open('Editor.aspx?keyboardtype=' + document.getElementById('hdnkeyboardtype').value + '&keyboard=' + document.getElementById('hiddefaultkey').value + '&prevcioid=' + prevcioid + '&agencycode=' + agencycode + '&logo=' + document.getElementById('hiddenlogocode').value + '&modify=' + modifyMatter + '&coltype=' + coltype + '&filename=' + document.getElementById('fil' + ival).value + '&logoname=' + document.getElementById('logonam' + ival).value + '&srno=' + ival + '&edition=' + edition + '&insertNo=' + insertNo + '&cioid=' + document.getElementById('txtciobookid').value + '&eyecatch=' + eyecatch + '&bgcolor=' + bgcolor + '&eyecatchlength=' + eyecatchlength + '&width=' + width + '&uom=' + uom + '&insertid=' + insertid + '&uom_desc_=' + uom_desc_ + '&receiptno=' + receiptno + '&packagecode=' + packagecode, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0,scrollbars=yes');
        }
        else {
            if (document.getElementById('chkattach').checked == false) {
                var ciobookid = document.getElementById('txtciobookid').value;
                var fileid = "bookdiv";
                var edit = ins;
                window.open('adtaker.aspx?filename=bookdiv&hei=' + hei + '&wid=' + wid + '&ins=' + ins + '&edition=' + edit + '&ciobookid=' + ciobookid + '&fileid=' + fileid + '&id=' + ival, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0');
                //window.open('adtaker.aspx?hei='+hei+'&wid='+wid,'','width='+screen.availWidth+',height='+screen.availHeight+',resizable=1,left=0,top=0');
            }
            else {
                if (adheight == '') {
                    alert("Please enter Ad Height");
                    // document.getElementById('hei'+ival).focus();
                    return false;
                }
                else if (adwidth == '') {
                    alert("Please enter Ad Width");
                    //document.getElementById('wid'+ival).focus();
                    return false;
                }
                var edit = document.getElementById(edition).value;
                var ciobookid = document.getElementById('txtciobookid').value;
                window.open('default3.aspx?filename=' + filename + '&adheight=' + adheight + '&no=' + insertid + '&adwidth=' + adwidth + '&ins=' + ins + '&edition=' + edit + '&ciobookid=' + ciobookid + '&fileid=' + fileid + '&color=' + document.getElementById('drpcolor').value + '&edition1=' + document.getElementById(edition).value + '&datefield=' + datefield + '&matstatus=' + matstatus + '&packagepckcode=' + packagepckcode + '&adtype=DI0', 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=244,left=210,width=650px,height=600px');

            }
        }
    }
    else {
        alert("Please select uom");

    }
    return false;


}
//this is the function to open the upload pop up when the image is uploaded for all
//this is the function to open the upload pop up when the image is uploaded for all
function uploadimageall() {
    //    if(document.getElementById('tblinsert').innerHTML=="")
    //    {
    //    alert("please fill insertion grid");
    //    return false;
    //    }
    //var ins="0";
    //var edit="All";
    //var ciobookid=document.getElementById('txtciobookid').value;
    //var fileid="bookdiv";
    //window.open('default3.aspx?ins='+ins+'&edition='+edit+'&ciobookid='+ciobookid+'&fileid='+fileid,'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=244,left=210,width=350px,height=95px');
    //return false;
    if (document.getElementById('txtdummydate').value == "") {
        alert("Please Fill the Publish date");
        return false;
    }
    if (document.getElementById('drpuom').value != "0") {

        var hei = document.getElementById('txtadsize1').value;
        var wid = document.getElementById('txtadsize2').value;
        var eyecatch = document.getElementById('drpbullet').value;
        var bgcolor = document.getElementById('drpbgcolor').value;
        //var eyecatchlength=document.getElementById('txtbullprem').value;
        var datefield = document.getElementById('txtdummydate').value;
        var width = document.getElementById('txtadsize2').value;
       //width = "3.8";
        var objpack = document.getElementById('drppackagecopy');
        var temp = "";
        var tempcode = "";
        var tempval = "";
        var tempvalcode = "";
        var desc = "";
        var code = "";
        var i = objpack.options.length;
        var j;

        for (j = 0; j < i; j++) {
            if (parseInt(i) > 0) {
                tempval = objpack[j].value;
                //tempvalcode=objpack[j].value;
                if (temp != "") {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    /*new change ankur for agency*/
                    code = tempvalcode + "+" + code;
                    desc = tempcode + "+" + desc;


                }
                else {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    code = tempvalcode;
                    desc = tempcode;
                }
            }

        }
        width = desc.replace("+", "^");
        var uom = document.getElementById('drpuom').value;
        var uom_desc_ = document.getElementById('hiddenuomdesc').value;
        var coltype = document.getElementById('drpcolor').value;  //ad by rinki
        var eyecatchlength = 2;
        var fil0value = "";
         var fil0value = "";
        //////////////////////////add by anuja
        var fil0value22 = "";
        var fil0value221 = "";
        var getfilename = parseInt(document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1);
        var insg = "";
        for (var a = 0; a < getfilename; a++) {
            if (browser != "Microsoft Internet Explorer") {
                insg = document.getElementById('ins' + a).textContent;
            }
            else {
                insg = document.getElementById('ins' + a).innerText;
            }
            fil0value22 = document.getElementById('fil' + a).value;
            if (insg == "1" && (fil0value.indexOf(fil0value22) == -1 || fil0value22 == "")) {
                if (fil0value == "") {
                    fil0value = fil0value22;
                    fil0value221 = fil0value22;
                }
                else {
                    fil0value = fil0value + "," + fil0value22;

                }
            }
        }
        /*if (document.getElementById('fil0').value != "") {
            fil0value = document.getElementById('fil0').value;
        }*/
        if (eyecatchlength == "") {
            eyecatchlength = "0";
        }
        if (bgcolor == "0") {
            bgcolor = "White";
        }
        var insertid = "no";
         var receiptno = document.getElementById('txtreceipt').value;
         var packagecode = document.getElementById('hiddenpackage').value;
        //if(document.getElementById('drpuom').value=="RO0" || document.getElementById('drpuom').value=="RO1" || document.getElementById('drpuom').value=="RO3")
        if (document.getElementById('hiddenuomdesc').value == "ROC" || document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROW" || document.getElementById('hiddenuomdesc').value == "ROD" || document.getElementById('hiddenuomdesc').value == "ROH") {
            //*25Aug* window.open('matter.aspx?modify='+modifyMatter+'&filename='+fil0value+'&insertNo=0&srno=All&edition=All&eyecatch='+eyecatch+'&cioid='+document.getElementById('txtciobookid').value+'&bgcolor='+bgcolor+'&eyecatchlength='+eyecatchlength+'&width='+width+'&uom='+uom+'&coltype='+coltype+'&insertid='+insertid+'&uom_desc_='+uom_desc_,'','width='+screen.availWidth+',height='+screen.availHeight+',resizable=1,left=0,top=0,scrollbars=yes');
            var agency_vari = document.getElementById('txtagency');
            if (agency_vari.value != "") {
                agencycode = agency_vari.value.substring(agency_vari.value.lastIndexOf("(") + 1, agency_vari.value.lastIndexOf(")"));
            }
            var prevcioid = document.getElementById('hiddendummycioid').value;
            if (width.length > 1024)
                width = "";
            if (clientfromconfig == "SP" || clientfromconfig == "RP") {
                window.open('Editor_new.aspx?prevcioid=' + prevcioid + '&agencycode=' + agencycode + '&logo=' + document.getElementById('hiddenlogocode').value + '&logoname=' + document.getElementById('logonam0').value + '&modify=' + modifyMatter + '&filename=' + fil0value + '&insertNo=0&srno=All&edition=All&eyecatch=' + eyecatch + '&cioid=' + document.getElementById('txtciobookid').value + '&bgcolor=' + bgcolor + '&eyecatchlength=' + eyecatchlength + '&width=' + width + '&uom=' + uom + '&coltype=' + coltype + '&insertid=' + insertid + '&insertsta=' + document.getElementById('inssta' + 0).value + '&uom_desc_=' + uom_desc_, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0,scrollbars=yes');
            }
            else
                window.open('Editor.aspx?keyboardtype=' + document.getElementById('hdnkeyboardtype').value + '&keyboard=' + document.getElementById('hiddefaultkey').value + '&prevcioid=' + prevcioid + '&agencycode=' + agencycode + '&logo=' + document.getElementById('hiddenlogocode').value + '&logoname=' + document.getElementById('logonam0').value + '&modify=' + modifyMatter + '&filename=' + fil0value + '&insertNo=0&srno=All&edition=All&eyecatch=' + eyecatch + '&cioid=' + document.getElementById('txtciobookid').value + '&bgcolor=' + bgcolor + '&eyecatchlength=' + eyecatchlength + '&width=' + width + '&uom=' + uom + '&coltype=' + coltype + '&insertid=' + insertid + '&uom_desc_=' + uom_desc_ + '&receiptno=' + receiptno + '&packagecode=' + packagecode, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0,scrollbars=yes');
        }
        else {
            if (document.getElementById('chkattach').checked == false) {
                var ins = "0";
                var edit = "All";
                var ciobookid = document.getElementById('txtciobookid').value;
                var fileid = "bookdiv";
                window.open('adtaker.aspx?hei=' + hei + '&wid=' + wid + '&ins=' + ins + '&edition=' + edit + '&ciobookid=' + ciobookid + '&fileid=' + fileid, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0');
            }
            else {
                if (document.getElementById('txtadsize1').value == '') {
                    alert("Please enter Ad Height");
                    //  document.getElementById('txtadsize1').focus();
                    return false;
                }
                else if (document.getElementById('txtadsize2').value == '') {
                    alert("Please enter Ad Width");
                    //  document.getElementById('txtadsize2').focus();
                    return false;
                }


                var ins = "0";
                var edit = "All";
                var ciobookid = document.getElementById('txtciobookid').value;
                var fileid = "bookdiv";
                var filename = "";
                var col1 = document.getElementById('txtcolum').value;
                if (col1=="")
                    col1=null;
                    edition1=null;
                    var matstatus = 'mat';
                window.open('default3.aspx?filename=bookdiv&adheight=' + document.getElementById('txtadsize1').value + '&adwidth=' + document.getElementById('txtadsize2').value + '&ins=' + ins + '&edition=' + edit + '&ciobookid=' + ciobookid + '&fileid=' + fileid + '&color=' + document.getElementById('drpcolor').value + '&edition1=' + edition1 + '&col1=' + col1 + '&datefield=' + datefield + '&adtype=CL0', 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=244,left=210,width=650px,height=600px');
            }
        }
    }
    else {
        alert("Please select uom");

    }
    return false;
}




///////////////this the function created to return whether the pckg exist 

function chkratefromgrid(id) {
    flagrate = id;
    var dategrid = id.value;
    var insert = document.getElementById('hiddeninserts').value;
    var val = "";
    if (che_flag == 1) {
        val = document.getElementById('hidval').value;
    }
    var adcat3 = document.getElementById('drpadcat3').value;
    var adcat4 = document.getElementById('drpadcat4').value;
    var adcat5 = document.getElementById('drpadcat5').value;

    var clientname = document.getElementById('txtclient').value;
    var client_split;
    if (clientname.indexOf("(") >= 0) {
        clientname = clientname.split("(");
        client_split = clientname[1];
        client_split = client_split.replace(")", "");
        clientname = client_split;

    }
    Classified_Booking.getData(val, document.getElementById('txtinsertion').value, document.getElementById('txtrepeatingdate').value, dategrid, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, "CL0", document.getElementById('drpcurrency').value, document.getElementById('txtratecode').value, document.getElementById('drpuom').value, dategrid, check_or, adcat3, adcat4, adcat5, insert, call_gridrate);
}


function call_gridrate(res) {
    var ds = res.value;
    if (ds.Tables[8].Rows.length > 0) {

    }
    else {
        alert("package does not exists");
        flagrate.value = "";
        return false;
    }
}



///////////////this is the function created to chk that insert date should be greater than current date and
/////////////./when late by data is selected than it should be grater 
///////////////than select date

function chkdateforbook(id, val12) {
    if (id == undefined) {
        return false;
    }
    if (document.getElementById('tblinsert').innerHTML != "") {

        var idval = id.value;
        if (id.id.indexOf("Text") >= 0) {
            var bookingdate = document.getElementById('txtdatetime').value;
            var rodate = id.value;
            var dateformat = document.getElementById('hiddendateformat').value;
            //
            if (dateformat == "dd/mm/yyyy") {
                if (bookingdate != "") {
                    if (bookingdate.indexOf('-') >= 0) {
                        var txt = bookingdate;
                        var txt1 = txt.split("-");
                        var dd = txt1[0];
                        var mm1 = txt1[1];
                        var mm = getMonthNo(mm1);
                        var yy = txt1[2];
                        bookingdate = mm + '/' + dd + '/' + yy;
                    }
                    else {
                        var txt = bookingdate;
                        var txt1 = txt.split("/");
                        var dd = txt1[0];
                        var mm1 = txt1[1];
                        var mm = txt1[1]; //getMonthNo(mm1);
                        var yy = txt1[2];
                        bookingdate = mm + '/' + dd + '/' + yy;
                    }
                }
                else {
                    bookingdate = bookingdate;
                }

            }

            if (dateformat == "yyyy/mm/dd") {
                if (bookingdate != "") {
                    var txt = bookingdate;
                    var txt1 = txt.split("/");
                    var yy = txt1[0];
                    var mm = txt1[1];
                    var dd = txt1[2];
                    bookingdate = mm + '/' + dd + '/' + yy;
                }
                else {
                    bookingdate = bookingdate;
                }
            }

            if (dateformat == "mm/dd/yyyy") {
                bookingdate = bookingdate;
            }


            if (dateformat == "dd/mm/yyyy") {
                if (rodate != "") {
                    if (rodate.indexOf('-') >= 0) {
                        var txt = rodate;
                        var txt1 = txt.split("-");
                        var dd = txt1[0];
                        var mm1 = txt1[1];
                        var mm = getMonthNo(mm1);
                        var yy = txt1[2];
                        rodate = mm + '/' + dd + '/' + yy;
                    }
                    else {
                        var txt = rodate;
                        var txt1 = txt.split("/");
                        var dd = txt1[0];
                        var mm1 = txt1[1];
                        var mm = txt1[1]; //getMonthNo(mm1);
                        var yy = txt1[2];
                        rodate = mm + '/' + dd + '/' + yy;
                    }
                }
                else {
                    rodate = rodate;
                }

            }

            if (dateformat == "yyyy/mm/dd") {
                if (rodate != "") {
                    var txt = rodate;
                    var txt1 = txt.split("/");
                    var yy = txt1[0];
                    var mm = txt1[1];
                    var dd = txt1[2];
                    rodate = mm + '/' + dd + '/' + yy;
                }
                else {
                    rodate = rodate;
                }
            }

            if (dateformat == "mm/dd/yyyy") {
                rodate = rodate;
            }
            //
            var bookdate = new Date(bookingdate);
            var rdate = new Date(rodate);

            if (rdate < bookdate && (document.getElementById('hiddenbackdatebook').value == "0" || document.getElementById('hiddenbackdatebook').value == "N")) {
                alert("Insertion date should be greater than Publish date");
                id.value = val12;
                id.focus();
                return false;
            }

        }
        else if (id.id.indexOf("lat") >= 0) {
            var editid = id.id.replace("lat", "Text");
            var editdate = document.getElementById(editid).value;
            var latdate = idval;
            var ldate = new Date(latdate);
            var edate = new Date(editdate);
            if (latdate != "") {
                if (ldate > edate)
                { }
                else {
                    alert("Latest Date Should Be Greater Than Edition Date");
                    //document.getElementById(late).value="";
                    id.value = val12;
                    return false;
                }
            }

        }

    }

}

///this is the function created to fill the value in file name when we click on attachment button

function givefilename(ins, edi, cioid, filid) {
    var val = cioid + "-" + ins + "-" + edi;
    //opener.document.getElementById(filid).value=val; 
    return false;
}
///////////this is the function to check whether the ro date is greater than bookind date if it than give alert

function chkratedate() {
    var bookingdate = document.getElementById('txtdatetime').value;
    var rodate = document.getElementById('txtrodate').value;
    var dateformat = document.getElementById('hiddendateformat').value;
    if (dateformat == "yyyy/mm/dd") {
        var yearfield = bookingdate.split("/")[0]
        var monthfield = bookingdate.split("/")[1]
        var dayfield = bookingdate.split("/")[2]
        var bookdate = new Date(yearfield, monthfield - 1, dayfield)
    }
    if (dateformat == "mm/dd/yyyy") {
        var yearfield = bookingdate.split("/")[2]
        var monthfield = bookingdate.split("/")[0]
        var dayfield = bookingdate.split("/")[1]
        //var dayobj = new Date(monthfield-1, dayfield, yearfield)
        var bookdate = new Date(yearfield, monthfield - 1, dayfield)

    }
    if (dateformat == "dd/mm/yyyy") {
        var yearfield = bookingdate.split("/")[2]
        var monthfield = bookingdate.split("/")[1]
        var dayfield = bookingdate.split("/")[0]
        //var dayobj = new Date(dayfield, monthfield-1, yearfield)
        var bookdate = new Date(yearfield, monthfield - 1, dayfield)
    }

    if (dateformat == "yyyy/mm/dd") {
        var yearfield = rodate.split("/")[0]
        var monthfield = rodate.split("/")[1]
        var dayfield = rodate.split("/")[2]
        var rdate = new Date(yearfield, monthfield - 1, dayfield)
    }
    if (dateformat == "mm/dd/yyyy") {
        var yearfield = rodate.split("/")[2]
        var monthfield = rodate.split("/")[0]
        var dayfield = rodate.split("/")[1]
        //var dayobj = new Date(monthfield-1, dayfield, yearfield)
        var rdate = new Date(yearfield, monthfield - 1, dayfield)

    }
    if (dateformat == "dd/mm/yyyy") {
        var yearfield = rodate.split("/")[2]
        var monthfield = rodate.split("/")[1]
        var dayfield = rodate.split("/")[0]
        //var dayobj = new Date(dayfield, monthfield-1, yearfield)
        var rdate = new Date(yearfield, monthfield - 1, dayfield)
    }

    // var bookdate=new Date(bookingdate);
    //  var rdate=new Date(rodate);

    if (rdate > bookdate) {
        alert("RO date should be lesser or equal to Booking date");
        document.getElementById('txtrodate').value = "";
        return false;
    }

}


function getsubcode() {
    document.getElementById('hiddensubcode').value = document.getElementById('drpagscode').value
    return false;
}


function getbrand() {
    document.getElementById('hiddenbrand').value = document.getElementById('drpbrand').value;
    return false;
}

function getzone() {
    document.getElementById('hiddenzone').value = document.getElementById('txtexeczone').value;
    return false;
}

//this is the function to show the grid during execution mode

function showgridexecute() {
    var msg = checkSession();
    if (msg == false) {
        window.location.href = "login.aspx";
        return false;
    }
    var cioid = document.getElementById('txtciobookid').value;
    var compcode = document.getElementById('hiddencompcode').value;
    //Classified_Booking.showgridforexe(cioid,compcode,call_showgrid);
    //var res = Classified_Booking.showgridforexe(cioid, compcode, document.getElementById('hiddensupplimentflag').value);
    var res = Classified_Booking.showgridforexe(cioid, compcode, document.getElementById('hiddensupplimentflag').value, document.getElementById('hiddenquotation').value);
    call_showgrid(res);
    return false;
}

function call_showgrid(res) {
    arrEdition_Item = "";
    var Make_Row = '';
    var make_td = '';
    var ds = res.value;
    var dbill = "";
    var str = "";
    var editid;
    var inserts;
    var adsubcat;
    var dat = "mm+" / "+dd+" / "+yyyy";
    var l;
    var j;
    var colid;
    var premid;
    var prem1id;
    var height;
    var width;
    var size;
    var pagepost;
    var p;
    var cardid;
    var matsta;
    var filename;
    var discrate;
    var insertsta;
    var billstat;
    var late;
    var repeat;
    var premid;
    var premper;
    var premper1;
    var adtypid;
    var namecode;
    var preall;
    var adcat;
    var picfield;
    var agrred;
    var paid;
    var solo;
    var gross;
    var showid;
    var pageno_inserts;
    var remark_inserts;
    var caption_inserts;
    var page;
    var pageprem;
    var billamt;
    var dateformat = document.getElementById('hiddendateformat').value;
    var billrate;
    var agnamnt;
    var adlgn;
    var spldisc;
    var cashdisc;
    var roundoffval;
    var pheival;
    var pagstr = "";
    var dcou = "";
    var showordisable = document.getElementById('hiddensavemod').value;
    var noinsertgrid = document.getElementById('txtinsertion').value;
    var hiddenuomdesc_vari = document.getElementById('hiddenuomdesc');
    var column_vari = document.getElementById('txtcolum');
    var gridtab_vari;
    var dateformat_vari = document.getElementById('hiddendateformat');
    noofinsertlo = parseInt(ds.Tables[0].Rows.length) / parseInt(noinsertgrid)
    rowwhenupdate = ds.Tables[0].Rows.length
    var insprev = 0;

    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {
        //this is the for loop we are implementing so that the rows appear the same as the rows in tbl_booking_insert table
        var count = ds.Tables[0].Rows.length - 1;
        countgridloop = ds.Tables[0].Rows.length;
        retrows = ds.Tables[0].Rows.length - 1;
        var i = 0;

        //23sep str="<div id=\"bookdiv\" runat=\"server\" style=\"OVERFLOW: auto; WIDTH: 896px; HEIGHT: 160px; \"><table cellpadding=\"1\" cellspacing=\"1\" id=\"gridtab\" width=\"1000px\" border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\"><td align=\"center\" valign=\"top\" >No.</td><td align=\"center\" valign=\"top\" >Edition</td><td valign=\"top\" align=\"center\">Date</td><td align=\"center\" valign=\"top\">Ad Sub Cat.</td><td align=\"center\" valign=\"top\">Color</td><td align=\"center\" valign=\"top\">Height</td><td align=\"center\" valign=\"top\">Width</td><td align=\"center\" valign=\"top\">Col.</td><td align=\"center\" valign=\"top\">Size</td><td align=\"center\" valign=\"top\">Page Position</td><td valign=\"top\">Status Material</td><td align=\"center\" valign=\"top\">File Name</td><td align=\"center\" valign=\"top\">Card Rate</td><td valign=\"top\" align=\"center\">Disc. Rate</td><td valign=\"top\" align=\"center\">Agreed Rate</td><td align=\"center\" valign=\"top\"  onclick=\"filterinsert()\">Insertion Sta.</td><td align=\"center\" valign=\"top\">Latest By</td><td align=\"center\" valign=\"top\">Repeating</td><td align=\"center\" valign=\"top\">Premium 2</td><td align=\"center\" valign=\"top\">Pre(%)</td><td align=\"center\" valign=\"top\">Pre Allowed</td><td align=\"center\" valign=\"top\">Adv Cat.</td><td valign=\"top\">Bill Status</td><td valign=\"top\">Paid Ins.</td><td valign=\"top\" >Solo Rate</td><td valign=\"top\" >Gross Amt</td><td valign=\"top\" >Page No.</td><td valign=\"top\" >Remarks</td><td valign=\"top\" >Bill Amt</td><td valign=\"top\" >Bill Rate</td>";
        //str = "<div id=\"bookdiv\" runat=\"server\" style=\"OVERFLOW: auto; WIDTH: 896px; HEIGHT: 160px; \"><table cellpadding=\"1\" cellspacing=\"1\" id=\"gridtab\" width=\"1000px\" border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\"><td align=\"center\" valign=\"top\" >No.</td><td align=\"center\" valign=\"top\" >Edition</td><td valign=\"top\" align=\"center\">Date</td><td align=\"center\" valign=\"top\">Ad Sub Cat.</td><td align=\"center\" valign=\"top\">Color</td><td align=\"center\" valign=\"top\">Height</td><td align=\"center\" valign=\"top\">Width</td><td align=\"center\" valign=\"top\">Col.</td><td align=\"center\" valign=\"top\">Size</td><td align=\"center\" valign=\"top\">Bold</td><td valign=\"top\">Status Material</td><td align=\"center\" valign=\"top\">Insertion Sta.</td>";
        //str = "<div id=\"bookdiv\" runat=\"server\" style=\"OVERFLOW: auto; WIDTH: 1200px; HEIGHT: 360px; \"><table cellpadding=\"1\" cellspacing=\"1\" id=\"gridtab\" width=\"1000px\" border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\"><td align=\"center\" valign=\"top\" >No.</td><td align=\"center\" valign=\"top\" >Edition</td><td valign=\"top\" align=\"center\">Date</td><td align=\"center\" valign=\"top\">Ad Sub Cat.</td><td align=\"center\" valign=\"top\">Color</td><td align=\"center\" valign=\"top\">Height</td><td align=\"center\" valign=\"top\">Width</td><td align=\"center\" valign=\"top\">Col.</td><td align=\"center\" valign=\"top\">Size</td><td align=\"center\" valign=\"top\">Bold</td><td valign=\"top\">Status Material</td><td align=\"center\" valign=\"top\">Insertion Sta.</td>";
        str = "<div id=\"bookdiv\" runat=\"server\" style=\"OVERFLOW: auto; WIDTH: 1200px; HEIGHT: 360px; \"><table cellpadding=\"1\" cellspacing=\"1\" id=\"gridtab\" width=\"1000px\" border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\"><td align=\"center\" valign=\"top\" >No.</td><td align=\"center\" valign=\"top\" >Edition</td><td valign=\"top\" align=\"center\">Date</td><td align=\"center\" valign=\"top\">File Name</td>";
        if (showordisable == "1") 
        {
            str = str + "<td valign=\"top\" id='uploadA' disabled >Upload</td>";
        }
        else {
            str = str + "<td valign=\"top\" style=\"cursor:pointer;color:red;\" id='uploadA' >Upload</td>";
        }
        
        str = str + "<td align=\"center\" valign=\"top\">Ad Sub Cat.</td><td align=\"center\" valign=\"top\">Color</td><td align=\"center\" valign=\"top\">Height</td><td align=\"center\" valign=\"top\">Width</td><td align=\"center\" valign=\"top\">Col.</td><td align=\"center\" valign=\"top\">Size</td><td align=\"center\" valign=\"top\">Bold</td><td valign=\"top\">Status Material</td><td align=\"center\" valign=\"top\">Insertion Sta.</td>";
        
        if (hidcopy != "copy") {
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[83].childNodes[0].nodeValue == "enable") {
                    str = str + "<td align=\"center\" valign=\"top\">Act. Insertion Sta.</td>";
                }

            }
            else {
                if (xmlObj.childNodes(11).childNodes(41).text == "enable") {
                    str = str + "<td align=\"center\" valign=\"top\">Act. Insertion Sta.</td>";
                }


            }
        }
        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[79].childNodes[0].nodeValue == "enable") {
                str = str + "<td align=\"center\" valign=\"top\">Order Type</td>";
            }
            if (xmlObj.childNodes[23].childNodes[77].childNodes[0].nodeValue == "enable") {
                str = str + "<td align=\"center\" valign=\"top\">Chart Type</td>";
            }

        }
        else {
            if (xmlObj.childNodes(11).childNodes(39).text == "enable") {
                str = str + "<td align=\"center\" valign=\"top\">Order Type</td>";
            }
            if (xmlObj.childNodes(11).childNodes(38).text == "enable") {
                str = str + "<td align=\"center\" valign=\"top\">Chart Type</td>";
            }

        }
        //str = str + "<td align=\"center\" valign=\"top\">Card Rate</td><td valign=\"top\" align=\"center\">Disc. Rate</td><td valign=\"top\" align=\"center\">Agreed Amt</td><td align=\"center\" valign=\"top\">File Name</td>";
        str = str + "<td align=\"center\" valign=\"top\">Card Rate</td><td valign=\"top\" align=\"center\">Disc. Rate</td><td valign=\"top\" align=\"center\">Agreed Amt</td>";

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[25].childNodes[1].childNodes[0].nodeValue != "hide") {
                str = str + "<td align=\"center\" valign=\"top\">Latest By</td>";
            }
            if (xmlObj.childNodes[25].childNodes[3].childNodes[0].nodeValue != "hide") {
                str = str + "<td align=\"center\" valign=\"top\">Repeating</td>";
            }
            str = str + "<td align=\"center\" valign=\"top\">Premium 1</td><td align=\"center\" valign=\"top\">Pre(%)</td>";
            if (xmlObj.childNodes[25].childNodes[5].childNodes[0].nodeValue != "hide") {
                str = str + "<td align=\"center\" valign=\"top\">Pre Allowed</td>";
            }
            str = str + "<td align=\"center\" valign=\"top\">Adv Cat.</td>";
            if (xmlObj.childNodes[25].childNodes[7].childNodes[0].nodeValue != "hide") {
                str = str + "<td align=\"center\"  valign=\"top\">Bill Status</td>";
            }
            if (xmlObj.childNodes[25].childNodes[13].childNodes[0].nodeValue != "hide") {
                str = str + "<td align=\"center\"  valign=\"top\">Discount</td>";
            }
            str = str + "<td valign=\"top\">Paid Ins.</td><td valign=\"top\" >Solo Rate</td><td valign=\"top\" >Local Gross Amt</td><td valign=\"top\" >Page No.</td><td valign=\"top\" >Caption</td><td valign=\"top\" >Remarks</td><td valign=\"top\" >Local Bill Amt</td><td valign=\"top\" >Gross Amt</td><td valign=\"top\" >Bill Amt</td>";
            if (xmlObj.childNodes[25].childNodes[9].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >Bill Rate</td>";
            }
            if (xmlObj.childNodes[25].childNodes[15].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >Agn Amt</td>";
            }
            if (xmlObj.childNodes[25].childNodes[17].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >AdlAgn Amt</td>";
            }
            if (xmlObj.childNodes[25].childNodes[19].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >Spldisc</td>";
            }
            if (xmlObj.childNodes[25].childNodes[21].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >CashDisc</td>";
            }
            if (xmlObj.childNodes[25].childNodes[23].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >Round off</td>";
            }
            if (xmlObj.childNodes[25].childNodes[25].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >PDF H</td>";
            }
        }
        else {
            if (xmlObj.childNodes[12].childNodes[0].childNodes[0].nodeValue != "hide") {
                str = str + "<td align=\"center\" valign=\"top\">Latest By</td>";
            }
            if (xmlObj.childNodes[12].childNodes[1].childNodes[0].nodeValue != "hide") {
                str = str + "<td align=\"center\" valign=\"top\">Repeating</td>";
            }
            str = str + "<td align=\"center\" valign=\"top\">Premium 1</td><td align=\"center\" valign=\"top\">Pre(%)</td>";
            if (xmlObj.childNodes[12].childNodes[2].childNodes[0].nodeValue != "hide") {
                str = str + "<td align=\"center\" valign=\"top\">Pre Allowed</td>";
            }
            str = str + "<td align=\"center\" valign=\"top\">Adv Cat.</td>";
            if (xmlObj.childNodes[12].childNodes[3].childNodes[0].nodeValue != "hide") {
                str = str + "<td align=\"center\"  valign=\"top\">Bill Status</td>";
            }
            if (xmlObj.childNodes[12].childNodes[6].childNodes[0].nodeValue != "hide") {
                str = str + "<td align=\"center\"  valign=\"top\">Discount</td>";
            }
            str = str + "<td valign=\"top\">Paid Ins.</td><td valign=\"top\" >Solo Rate</td><td valign=\"top\" >Local Gross Amt</td><td valign=\"top\" >Page No.</td><td valign=\"top\" >Caption</td><td valign=\"top\" >Remarks</td><td valign=\"top\" >Local Bill Amt</td><td valign=\"top\" >Gross Amt</td><td valign=\"top\" >Bill Amt</td>";
            if (xmlObj.childNodes[12].childNodes[4].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >Bill Rate</td>";
            }
            if (xmlObj.childNodes[12].childNodes[7].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >Agn Amt</td>";
            }
            if (xmlObj.childNodes[12].childNodes[8].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >AdlAgn Amt</td>";
            }
            if (xmlObj.childNodes[12].childNodes[9].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >Spldisc</td>";
            }
            if (xmlObj.childNodes[12].childNodes[10].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >CashDisc</td>";
            }
            if (xmlObj.childNodes[12].childNodes[11].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >Round off</td>";
            }
            if (xmlObj.childNodes[12].childNodes[12].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >PDF H</td>";
            }
        }


        if (showordisable == "1") {
            //str = str + "<td valign=\"top\" id='uploadA' disabled >Upload</td><td></td><td></td><td valign=\"top\" >VTS</td>";
            str = str + "<td></td><td></td><td valign=\"top\" >VTS</td>";
        }
        else {
            //str = str + "<td valign=\"top\" style=\"cursor:pointer;color:red;\" id='uploadA' >Upload</td><td></td><td valign=\"top\" >VTS</td>";
            str = str + "<td></td><td valign=\"top\" >VTS</td>";
        }
        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[25].childNodes[11].childNodes[0].nodeValue != "hide") {
                str = str + "<td align=\"center\" valign=\"top\">Logo H</td><td align=\"center\" valign=\"top\">Logo W</td><td align=\"center\" valign=\"top\">Logo Name</td>";
            }


        }
        else {
            if (xmlObj.childNodes[12].childNodes[5].childNodes[0].nodeValue != "hide") {
                str = str + "<td align=\"center\" valign=\"top\">Logo H</td><td align=\"center\" valign=\"top\">Logo W</td><td align=\"center\" valign=\"top\">Logo Name</td>";
            }


        }
        str = str + "</table></div>";
        document.getElementById('tblinsert').innerHTML = str;
        gridtab_vari = document.getElementById('gridtab');
        for (i = 0; i <= count; i++) {
            if (showordisable != "1" && ds.Tables[0].Rows[i].Insert_status != "billed" && (ds.Tables[0].Rows[i].Insert_status != "publish" && document.getElementById('hiddenrateauditflag').value != "rateaudit" && document.getElementById('hiddenrateauditpreferrence').value != "Y"))
                document.getElementById('btnshgrid').disabled = false;

            dcou = 0;
            var id = "Text" + i;
            editid = "edit" + i;
            inserts = "ins" + i;
            //////this is to bind the no of inserts and edition
            ///////////////////////// when we chk i.e. ds.Tables[0].Rows[i].Insert_status=="billed" it means that whoes inser
            ////////////////// status is booking only that insertion line we can change
            // new change 31 dec 09
            if (ds.Tables[0].Rows[i].no_insert == "1") {
                if (arrEdition_Item == "")
                    arrEdition_Item = ds.Tables[0].Rows[i].Edition + "~" + ds.Tables[0].Rows[i].PACKAGE_CODE;
                else
                    arrEdition_Item = arrEdition_Item + "," + ds.Tables[0].Rows[i].Edition + "~" + ds.Tables[0].Rows[i].PACKAGE_CODE;
            }
            Make_Row = document.createElement("tr");
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.setAttribute("class", "TextField");
            make_td.innerHTML = ds.Tables[0].Rows[i].no_insert;
            make_td.id = inserts;
            if (insprev != ds.Tables[0].Rows[i].no_insert) {
                insprev = ds.Tables[0].Rows[i].no_insert;
                make_td.title = "Edit Insert";
            }
            Make_Row.appendChild(make_td);
            // EDITION
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.setAttribute("class", "dtGrid");
            str = "<input class=\"btextforgrid7\" type=\"text\" title='" + ds.Tables[0].Rows[i].SHTNAME + "'  disabled id=" + editid + " value='" + ds.Tables[0].Rows[i].Edition + "'>";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);

            //str=str+"<tr ><td align=\"center\" id="+inserts+" class=\"TextField\" >"+ds.Tables[0].Rows[i].no_insert+"</td><td class=\"dtGrid\" ><input class=\"btextforgrid\" type=\"text\" disabled id="+editid+" value="+ds.Tables[0].Rows[i].Edition+"></td>";            

            //////this is to bind the insertion date   publish
            var mode = "1";
            var insdat = ds.Tables[0].Rows[i].Insert_date
            if (insdat == "" || insdat == null || insdat == "null")
                var getdateforexe = "";
            else
                var getdateforexe = savedateinto(ds.Tables[0].Rows[i].Insert_date, mode);
            var billdate = ds.Tables[0].Rows[i].BILL_DATE;
            if (billdate == "" || billdate == null || billdate == "null")
                billdate = "";
            else
                billdate = savedateinto(billdate, mode);
            if (showordisable == "1" || (((ds.Tables[0].Rows[i].Insert_status == "cancel" || (ds.Tables[0].Rows[i].Insert_status == "billed" && getdateforexe != "") || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y") && getdateforexe != "") && hidcopy != "copy")) && document.getElementById('hiddensupplimentflag').value == "")) {
                make_td = document.createElement("td");
                make_td.align = "center";
                if (ds.Tables[0].Rows[i].Insert_status != "cancel" && showordisable == "01") {
                    var t_res = compareDatewithBilledDate(dateformat, getdateforexe, billdate, ds.Tables[0].Rows[i].INSERT_STATUS_PUB, ds.Tables[0].Rows[i].Insert_status);
                    if (t_res == true)
                        str = "<input class=\"btextforgriddate\" type=\"text\"  id=" + id + "  value=" + getdateforexe + " >";
                    else
                        str = "<input class=\"btextforgriddate\" type=\"text\" disabled id=" + id + "  value=" + getdateforexe + " >";
                }
                else
                    str = "<input class=\"btextforgriddate\" type=\"text\" disabled id=" + id + "  value=" + getdateforexe + " >";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
            else {
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextforgriddate\" type=\"text\" id=" + id + "    value=" + getdateforexe + " >";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
            
            // new change for file name and upload button
            
             filename = "fil" + i;
                if (ds.Tables[0].Rows[i].File_name == null) {
                    ds.Tables[0].Rows[i].File_name = "";
                }

            if (hidcopy == "copy" && showordisable == "0") {
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextforgrid\" type=\"text\" disabled id=" + filename + " disabled  value='" + "" + "'>";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
            else {
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextforgrid\" type=\"text\" disabled id=" + filename + " disabled  value='" + ds.Tables[0].Rows[i].File_name + "'>";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);

            }
            
            var upl = "upload" + i;

            if (showordisable == "1" || (((ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) && hidcopy != "copy") && document.getElementById('hiddensupplimentflag').value == "")) {
                //str=str+"<td width=\"50px\"><input disabled  class=\"button1\" type=\"button\" Value=\"Attachment\" onclick=\"uploadimage('"+picfield+"','"+ds.Tables[0].Rows[i].no_insert+"','"+editid+"','"+filename+"','"+i+"')\">";
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input disabled  class=\"button1\" type=\"button\" id=" + upl + " Value=\"Attachment\" >";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
            else {
                //str=str+"<td width=\"50px\"><input  class=\"button1\" type=\"button\" Value=\"Attachment\" onclick=\"uploadimage('"+picfield+"','"+ds.Tables[0].Rows[i].no_insert+"','"+editid+"','"+filename+"','"+i+"')\">";
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input  class=\"button1\" type=\"button\" id=" + upl + " Value=\"Attachment\" >";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
            
            ////this is to bind the Ad sub cat drop down

            adsubcat = "ads" + i;
            var adsubcatval = '';
            if (ds.Tables[0].Rows[i].Ad_sub_cat != null)
                adsubcatval = ds.Tables[0].Rows[i].Ad_sub_cat;
            if (showordisable == "1" || (((ds.Tables[0].Rows[i].Insert_status == "cancel" || (ds.Tables[0].Rows[i].Insert_status == "billed" && getdateforexe != "") || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y")) && hidcopy != "copy")) && document.getElementById('hiddensupplimentflag').value == "")) {
                //  str=str+"<td><select disabled id="+adsubcat+" class=\"dropdownforgrid\" >";
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.setAttribute("class", "dtGrid");
                if (i == 0) {
                    str = "<input class=\"btextforgrid\" disabled type=\"text\"  id=" + adsubcat + " value=" + adsubcatval + "><div id='agdiv' Width=100px Height=50px style='position:absolute;display: none;'><select name='aglist' id='aglist' CssClass='btextlist' size=8 Width=120px Height=100px></select></div>";
                }
                else {
                    str = "<input class=\"btextforgrid\" disabled type=\"text\"  id=" + adsubcat + " value=" + adsubcatval + ">";
                }
            }
            else {
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.setAttribute("class", "dtGrid");
                //str=str+"<td><select id="+adsubcat+" class=\"dropdownforgrid\" onchange=\"getvalueintoinserts("+adsubcat+","+inserts+","+ds.Tables[0].Rows[i].no_insert+");\">";
                if (i == 0) {
                    str = "<input class=\"btextforgrid\"   type=\"text\"  id=" + adsubcat + " value=" + adsubcatval + "><div id='agdiv' Width=100px Height=50px style='position:absolute;display: none;'><select name='aglist'   id='aglist' CssClass='btextlist' size=8 Width=120px Height=100px></select></div>";
                }
                else {
                    str = "<input class=\"btextforgrid\"   type=\"text\"  id=" + adsubcat + " value=" + adsubcatval + ">";
                }
            }
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);
            // this is to bind adv sub cat drop down  
            //////                  if(ds.Tables[0].Rows[i].Ad_sub_cat=="0")
            //////                  {  
            //////                    str=str+"<option value=\"0\" selected=\"true\">select</option>";
            //////                  }
            //////                  else
            //////                  {
            //////                    str=str+"<option value=\"0\" >select</option>";
            //////                  }
            //////                   
            //////                        for(l=0;l<=ds.Tables[3].Rows.length-1;l++)
            //////                        {
            //////                            if(ds.Tables[3].Rows[l].Adv_Subcat_Code==ds.Tables[0].Rows[i].Ad_sub_cat && ds.Tables[0].Rows[i].Ad_sub_cat!="0")
            //////                            {
            //////                            str=str+"<option value="+ds.Tables[3].Rows[l].Adv_Subcat_Code+" selected="+ds.Tables[0].Rows[i].Ad_sub_cat+">"+ds.Tables[3].Rows[l].Adv_Subcat_Name+"</option>";
            //////                            }
            //////                            else 
            //////                            {
            //////                            str=str+"<option value="+ds.Tables[3].Rows[l].Adv_Subcat_Code+">"+ds.Tables[3].Rows[l].Adv_Subcat_Name+"</option>";
            //////                            }
            //////                            
            //////                        }

            colid = "col" + i;
            noofcol = "nocol" + i;
            if (showordisable == "1" || (((ds.Tables[0].Rows[i].Insert_status == "cancel" || (ds.Tables[0].Rows[i].Insert_status == "billed" && getdateforexe != "") || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y")) && hidcopy != "copy")) && document.getElementById('hiddensupplimentflag').value == "")) {
                //  str=str+"</select></td><td><select disabled id="+colid+" class=\"dropdownforgrid\" >";
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.setAttribute("class", "dropdownforgrid");

                str = "<input class=\"btextforgrid\" disabled type=\"text\"  id=" + colid + " value=" + ds.Tables[0].Rows[i].Col_code + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
            else {
                // str=str+"</select></td><td><select id="+colid+" class=\"dropdownforgrid\" onchange=\"getvalueintoinsertsforcolor("+colid+","+inserts+","+ds.Tables[0].Rows[i].no_insert+")\";>";
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.setAttribute("class", "dropdownforgrid");

                str = "<input class=\"btextforgrid\"   type=\"text\"  id=" + colid + " value=" + ds.Tables[0].Rows[i].Col_code + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);

            }
            //this is to bind the color drop down
            //////                    str=str+"<option value=\"0\" selected=\"true\">select</option>";
            //////                    for(j=0;j<=ds.Tables[1].Rows.length-1;j++)
            //////                    {
            //////                        
            //////                        if(ds.Tables[1].Rows[j].col_Code==ds.Tables[0].Rows[i].Col_code && ds.Tables[0].Rows[i].Col_code!="0")
            //////                        {
            //////                            str=str + "<option value="+ds.Tables[1].Rows[j].col_Code+" selected="+ds.Tables[0].Rows[i].Col_code+">"+ds.Tables[1].Rows[j].col_Name+"</option>";    
            //////                        }
            //////                        else
            //////                        {
            //////                            str=str + "<option value="+ds.Tables[1].Rows[j].col_Code+">"+ds.Tables[1].Rows[j].col_Name+"</option>";    
            //////                        }
            //////                    }

            premid = "prem" + i;
            prem1id = "premone" + i;
            height = "hei" + i;
            width = "wid" + i;
            size = "siz" + i;
            pagepost = "pgpre" + i;  //"pagpos"+i;
            var class_hei = ds.Tables[0].Rows[i].Height;
            var class_wid = ds.Tables[0].Rows[i].Width;
            var class_noofcol;
            if (ds.Tables[0].Rows[i].Height == null) {
                class_hei = "";
            }
            if (ds.Tables[0].Rows[i].Width == null) {
                class_wid = "";
            }
            if (ds.Tables[0].Rows[i].No_ofcolumn == null) {
                class_noofcol = "";
            }
            else {
                class_noofcol = ds.Tables[0].Rows[i].No_ofcolumn
            }
            //////// on change function is there to calculate the size 
            //str=str+"</select></td><td><input class=\"btextforbook\" id="+height+" type=\"text\"  value=\"\"></td><td><input class=\"btextforbook\" id="+width+" onchange=\"return gettotalsize("+height+","+width+","+i+");\" type=\"text\"  value=\"\"></td><td><input class=\"btextforbook\" disabled id="+size+" type=\"text\"  value=\"\"></td><td><select id="+premid+" class=\"dropdownforbook\" onchange=\"return getpercenprem("+premid+","+i+");\"  >";

            if (showordisable == "1" || (((ds.Tables[0].Rows[i].Insert_status == "cancel" || (ds.Tables[0].Rows[i].Insert_status == "billed" && getdateforexe != "") || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y")) && hidcopy != "copy")) && document.getElementById('hiddensupplimentflag').value == "")) {
                //str=str+"</select></td><td><input class=\"btextsmallsize\" disabled id="+height+" type=\"text\"  value="+class_hei+"></td><td><input class=\"btextsmallsize\" disabled id="+width+"  type=\"text\"  value="+class_wid+"></td><td><input class=\"btextsmallsize\" disabled id="+noofcol+" type=\"text\"  value="+class_noofcol+"></td><td><input class=\"btextsmallsize\" disabled id="+size+" type=\"text\"  value="+ds.Tables[0].Rows[i].Size_book+"></td>";
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextsmallsizeH\" disabled id=" + height + " type=\"text\"  value=" + class_hei + "> ";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);

                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextsmallsizeH\" disabled id=" + width + "  type=\"text\"  value=" + class_wid + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);

                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextsmallsizeH\" disabled id=" + noofcol + " type=\"text\"  value=" + class_noofcol + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);

                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Size_book + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);

                // for bold charcter count

                var splboldsize = "splboldsize" + i;
                make_td = document.createElement("td");
                make_td.align = "center";
                if (ds.Tables[0].Rows[i].SPECIAL_SIZE1 != null)
                    make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + splboldsize + " Value=" + ds.Tables[0].Rows[i].SPECIAL_SIZE1 + ">";
                else
                    make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + splboldsize + " Value=\"\" >";
                Make_Row.appendChild(make_td);

            }
            else {
                if (hiddenuomdesc_vari.value == "CD" && column_vari.value == "") {
                    //str=str+"</select></td><td></td><td></td><td></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input class=\"btextsmallsizeH\" style=\"background-color: White;\" id=" + height + "   type=\"text\"  value=" + class_hei + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input class=\"btextsmallsizeH\" style=\"background-color: White;\" id=" + width + "   type=\"text\"  value=" + class_wid + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input class=\"btextsmallsizeH\" disabled style=\"background-color: Gray;\" id=" + noofcol + " type=\"text\"  value=" + class_noofcol + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Size_book + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    // for bold charcter count

                    var splboldsize = "splboldsize" + i;
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (ds.Tables[0].Rows[i].SPECIAL_SIZE1 != null)
                        make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + splboldsize + " Value=" + ds.Tables[0].Rows[i].SPECIAL_SIZE1 + ">";
                    else
                        make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + splboldsize + " Value=\"\" >";
                    Make_Row.appendChild(make_td);
                }
                else if (hiddenuomdesc_vari.value == "CD" && column_vari.value != "") {
                    //str=str+"</select></td><td></td>";

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input class=\"btextsmallsizeH\" disabled style=\"background-color: White;\" id=" + height + "  type=\"text\"  value=" + class_hei + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input class=\"btextsmallsizeH\" disabled style=\"background-color: Gray;\" id=" + width + "  type=\"text\"  value=" + class_wid + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input class=\"btextsmallsizeH\" disabled style=\"background-color: White;\"  id=" + noofcol + " type=\"text\"  value=" + class_noofcol + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Size_book + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    // for bold charcter count

                    var splboldsize = "splboldsize" + i;
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (ds.Tables[0].Rows[i].SPECIAL_SIZE1 != null)
                        make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + splboldsize + " Value=" + ds.Tables[0].Rows[i].SPECIAL_SIZE1 + ">";
                    else
                        make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + splboldsize + " Value=\"\" >";
                    Make_Row.appendChild(make_td);
                }
                else {
                    //str=str+"</select></td></td>";

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input class=\"btextsmallsizeH\" disabled style=\"background-color: Gray;\" id=" + height + " type=\"text\"  value=" + class_hei + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input class=\"btextsmallsizeH\" disabled style=\"background-color: Gray;\" disabled id=" + width + "   type=\"text\"  value=" + class_wid + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input class=\"btextsmallsizeH\" disabled style=\"background-color: Gray;\" id=" + noofcol + " type=\"text\"  value=" + class_noofcol + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input class=\"btextsmallsize\"   id=" + size + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Size_book + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    // for bold charcter count

                    var splboldsize = "splboldsize" + i;
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (ds.Tables[0].Rows[i].SPECIAL_SIZE1 != null)
                        make_td.innerHTML = "<input  class=\"btextsmallsize\"  type=\"text\" id=" + splboldsize + " Value=" + ds.Tables[0].Rows[i].SPECIAL_SIZE1 + ">";
                    else
                        make_td.innerHTML = "<input  class=\"btextsmallsize\"  type=\"text\" id=" + splboldsize + " Value=\"\" >";
                    Make_Row.appendChild(make_td);

                }

            }

            ////this loop is to bind the page position
            /* 23 sep                                
            if(showordisable=="1"  || ds.Tables[0].Rows[i].Insert_status=="billed" || ds.Tables[0].Rows[i].Insert_status=="publish")
            {                               
            str=str+"<td><select disabled id="+pagepost+" class=\"dropdownforgrid\">";
            }
            else
            {
            pagstr="fir"
            str=str+"<td><select id="+pagepost+" class=\"dropdownforgrid\" onchange=\"return getpageprem("+pagepost+","+i+",'"+pagstr+"');\">";
            }
                     
            str=str+"<option value=\"0\" selected=\"true\">select</option>";
            for(p=0;p<=ds.Tables[7].Rows.length-1;p++)
            {
            if(ds.Tables[7].Rows[p].pos_type_code==ds.Tables[0].Rows[i].Page_post && ds.Tables[0].Rows[i].Page_post!="0")
            {
            str=str+"<option value="+ds.Tables[7].Rows[p].pos_type_code+" selected="+ds.Tables[0].Rows[i].Page_post+">"+ds.Tables[7].Rows[p].pos_type+"</option>";
            }
            else
            {
            str=str+"<option value="+ds.Tables[7].Rows[p].pos_type_code+">"+ds.Tables[7].Rows[p].pos_type+"</option>";
            }
            }   
    
            str=str+"</select></td>";
            */

            /////////////this is to bind the status material drop down
            matsta = "mat" + i;

            if (showordisable == "1" || (((ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) && hidcopy != "copy") && document.getElementById('hiddensupplimentflag').value == "")) {
                make_td = document.createElement("td");
                make_td.align = "center";
                if (ds.Tables[0].Rows[i].Status_material != null) {
                    str = "<input class=\"btextforgrid\" DISABLED  id=" + matsta + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Status_material + ">";
                }
                else {
                    str = "<input class=\"btextforgrid\" DISABLED  id=" + matsta + " type=\"text\"  value=''>";
                }
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
                //str=str+"<td><select disabled id="+matsta+" class=\"dropdownforgrid\" >";
            }
            else {
                //str=str+"<td><select id="+matsta+" class=\"dropdownforgrid\">";
                make_td = document.createElement("td");
                make_td.align = "center";
                if (ds.Tables[0].Rows[i].Status_material == null) {
                    str = "<input class=\"btextforgrid\"   id=" + matsta + " type=\"text\"  value=''>";
                }
                else {
                    str = "<input class=\"btextforgrid\"    id=" + matsta + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Status_material + ">";
                }
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }

            /////this is to bind the status material dropdown
            //                        if(ds.Tables[0].Rows[i].Status_material=="0")
            //                        {
            //                            str=str+"<option value=\"0\" selected="+ds.Tables[0].Rows[i].Status_material+">Select</option>";
            //                        }
            //                        else
            //                        {
            //                             str=str+"<option value=\"0\">Select</option>";
            //                        }
            //                        if(ds.Tables[0].Rows[i].Status_material=="hardcopy")
            //                        {
            //                            str=str+"<option value=\"hardcopy\" selected="+ds.Tables[0].Rows[i].Status_material+">Hard Copy</option>";
            //                        }
            //                        else
            //                        {
            //                            str=str+"<option value=\"hardcopy\">Hard Copy</option>";
            //                        }
            //                        if(ds.Tables[0].Rows[i].Status_material=="softcopy")
            //                        {
            //                            str=str+"<option value=\"softcopy\" selected="+ds.Tables[0].Rows[i].Status_material+">Soft Copy</option>";
            //                        }
            //                        else
            //                        {
            //                            str=str+"<option value=\"softcopy\">Soft Copy</option>";
            //                        }
            //                        if(ds.Tables[0].Rows[i].Status_material=="cd")
            //                        {
            //                            str=str+"<option value=\"cd\" selected="+ds.Tables[0].Rows[i].Status_material+">CD</option>";
            //                        }
            //                        else
            //                        {
            //                             str=str+"<option value=\"cd\">CD</option>";
            //                        }
            //                        if(ds.Tables[0].Rows[i].Status_material=="other")
            //                        {
            //                            str=str+"<option value=\"other\" selected="+ds.Tables[0].Rows[i].Status_material+">Others</option>";
            //                        }
            //                        else
            //                        {
            //                            str=str+"<option value=\"other\">Others</option>";
            //                        }

            cardid = "card" + i;
            //////////// for file name
            insertsta = "inssta" + i;
            if (hidcopy == "copy" && showordisable == "0") {
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input class=\"btextforgrid\" disabled  type=\"text\" id=" + insertsta + "  value='" + "booked" + "'>";
                Make_Row.appendChild(make_td);
            }
            else if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) {
                //str=str+"<td><select disabled id="+insertsta+" class=\"dropdownforgrid\">";
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input class=\"btextforgrid\" disabled  type=\"text\" id=" + insertsta + "  value='" + ds.Tables[0].Rows[i].Insert_status + "'>";
                Make_Row.appendChild(make_td);
            }
            else {
                //str=str+"<td><select id="+insertsta+" class=\"dropdownforgrid\" onchange=\"javascript:return chkpublishdate('"+insertsta+"','"+id+"')\">";
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input class=\"btextforgrid\"  disabled  type=\"text\" id=" + insertsta + "  value='" + ds.Tables[0].Rows[i].Insert_status + "'>";
                Make_Row.appendChild(make_td);
            }
            if (hidcopy != "copy") {
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input class=\"btextforgrid\" id='insstapub" + i + "' disabled  type=\"text\" value='" + ds.Tables[0].Rows[i].INSERT_STATUS_PUB + "'>";
                Make_Row.appendChild(make_td);
            }
            // for resource no

            var resourceno = "resno" + i;
            if (ds.Tables[0].Rows[i].RESOURCE_NO == "null" || ds.Tables[0].Rows[i].RESOURCE_NO == null)
                ds.Tables[0].Rows[i].RESOURCE_NO = "";
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[79].childNodes[0].nodeValue == "enable") {

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (showordisable == "1" || (((ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) && hidcopy != "copy") && document.getElementById('hiddensupplimentflag').value == "")) {
                        make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + resourceno + "  value=" + ds.Tables[0].Rows[i].RESOURCE_NO + ">";
                    }
                    else {
                        make_td.innerHTML = "<input class=\"btextforgrid\"  type=\"text\" id=" + resourceno + "  value=" + ds.Tables[0].Rows[i].RESOURCE_NO + ">";
                    }
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(39).text == "enable") {

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (showordisable == "1" || (((ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) && hidcopy != "copy") && document.getElementById('hiddensupplimentflag').value == "")) {
                        make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + resourceno + "  value=" + ds.Tables[0].Rows[i].RESOURCE_NO + ">";
                    }
                    else {
                        make_td.innerHTML = "<input class=\"btextforgrid\"  type=\"text\" id=" + resourceno + "  value=" + ds.Tables[0].Rows[i].RESOURCE_NO + ">";
                    }
                    Make_Row.appendChild(make_td);

                }
            }
            // for sectioncode

            var sectioncode = "seccode" + i;
            if (ds.Tables[0].Rows[i].SECTIONCODE == "null" || ds.Tables[0].Rows[i].SECTIONCODE == null)
                ds.Tables[0].Rows[i].SECTIONCODE = "";
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[77].childNodes[0].nodeValue == "enable") {

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (showordisable == "1" || (((ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) && hidcopy != "copy") && document.getElementById('hiddensupplimentflag').value == "")) {
                        make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + sectioncode + "  value=" + ds.Tables[0].Rows[i].SECTIONCODE + ">";
                    }
                    else {
                        make_td.innerHTML = "<input class=\"btextforgrid\"  type=\"text\" id=" + sectioncode + "  value=" + ds.Tables[0].Rows[i].SECTIONCODE + ">";
                    }
                    Make_Row.appendChild(make_td);
                }
                else {
                    //                        make_td=document.createElement("td");
                    //                         make_td.align="center";
                    //                         make_td.innerHTML="";
                    //                         Make_Row.appendChild(make_td);
                    // str=str+"<td ></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(38).text == "enable") {

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (showordisable == "1" || (((ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) && hidcopy != "copy") && document.getElementById('hiddensupplimentflag').value == "")) {
                        make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + sectioncode + "  value=" + ds.Tables[0].Rows[i].SECTIONCODE + ">";
                    }
                    else {
                        make_td.innerHTML = "<input class=\"btextforgrid\"  type=\"text\" id=" + sectioncode + "  value=" + ds.Tables[0].Rows[i].SECTIONCODE + ">";
                    }
                    Make_Row.appendChild(make_td);

                }
                else {
                    //	                     make_td=document.createElement("td");
                    //                         make_td.align="center";
                    //                         make_td.innerHTML="";
                    //                         Make_Row.appendChild(make_td);
                }
            }
            //this is to fill card rate

            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cardid + " value=" + ds.Tables[0].Rows[i].Card_rate + ">";
            Make_Row.appendChild(make_td);
            //                       if(showordisable=="1" || ds.Tables[0].Rows[i].Insert_status=="billed" || ds.Tables[0].Rows[i].Insert_status=="publish")
            //                       {
            //                            str=str+"<input class=\"btextforgrid\" disabled type=\"text\" disabled id="+cardid+" value="+ds.Tables[0].Rows[i].Card_rate+">";
            //                       }
            //                       else
            //                       {
            //                            str=str+"<input class=\"btextforgrid\" disabled type=\"text\" id="+cardid+" value="+ds.Tables[0].Rows[i].Card_rate+">";
            //                       }
            //// this is for the discount rate

            if (showordisable == "01" && hidcopy == "copy") {
                ds.Tables[0].Rows[i].Solo_rate = "";
                ds.Tables[0].Rows[i].Gross_rate = "";
                ds.Tables[0].Rows[i].LOCALGROSSAMT = "";
                ds.Tables[0].Rows[i].LOCALBILLAMT = "";
                ds.Tables[0].Rows[i].Bill_Amt = "";
                ds.Tables[0].Rows[i].Bill_rate = "";
                ds.Tables[0].Rows[i].Disc_rate = "";
                ds.Tables[0].Rows[i].Agreed_rate = "";
            }
            discrate = "disrat" + i;

            billstat = "bill" + i;
            agrred = "agr" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].Disc_rate != null){
            if (VISIBLEAGREEDRATE == "Y"){
               if (showordisable == "1" || (((ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) && hidcopy != "copy") && document.getElementById('hiddensupplimentflag').value == "")) {
                    make_td.innerHTML = "<input class=\"btextforgrid\" type=\"text\" disabled id=" + discrate + "  value=" + ds.Tables[0].Rows[i].Disc_rate + ">";
                }
                else{
                    make_td.innerHTML = "<input class=\"btextforgrid\" type=\"text\"  id=" + discrate + "  value=" + ds.Tables[0].Rows[i].Disc_rate + ">";
                }
                }
                else{
                    make_td.innerHTML = "<input class=\"btextforgrid\" type=\"text\" disabled  id=" + discrate + "  value=" + ds.Tables[0].Rows[i].Disc_rate + ">";
                }
            }
            else{
                if (VISIBLEAGREEDRATE == "Y"){
                    if (showordisable == "1" || (((ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) && hidcopy != "copy") && document.getElementById('hiddensupplimentflag').value == "")) {
                        make_td.innerHTML = "<input class=\"btextforgrid\" type=\"text\" disabled id=" + discrate + ">";
                        }
                        else{
                            make_td.innerHTML = "<input class=\"btextforgrid\" type=\"text\"  id=" + discrate + ">";
                        }
                    }
                    else{
                        make_td.innerHTML = "<input class=\"btextforgrid\" type=\"text\" disabled  id=" + discrate + ">";
                    }
                }
            Make_Row.appendChild(make_td);
            //                       if(showordisable=="1" || ds.Tables[0].Rows[i].Insert_status=="billed" || ds.Tables[0].Rows[i].Insert_status=="publish")
            //                       {
            //                            str=str+"</td><td><input class=\"btextforgrid\" type=\"text\" disabled id="+discrate+"  value="+ds.Tables[0].Rows[i].Disc_rate+"></td>";
            //                       }
            //                       else
            //                       {
            //                            str=str+"</td><td><input class=\"btextforgrid\" type=\"text\" disabled id="+discrate+"  value="+ds.Tables[0].Rows[i].Disc_rate+"></td>";                       
            //                       }  
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].Agreed_rate != null)
                make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agrred + "  value=" + ds.Tables[0].Rows[i].Agreed_rate + ">";
            else
                make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agrred + " >";
            Make_Row.appendChild(make_td);
            //                       if(showordisable=="1" || ds.Tables[0].Rows[i].Insert_status=="billed" || ds.Tables[0].Rows[i].Insert_status=="publish")
            //                       {   
            //                            str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" disabled id="+agrred+"  value="+ds.Tables[0].Rows[i].Agreed_rate+"></td>";
            //                       }
            //                       else
            //                       {
            //                            str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+agrred+"  value="+ds.Tables[0].Rows[i].Agreed_rate+"></td>";
            //                       }   
//            filename = "fil" + i;
//            if (ds.Tables[0].Rows[i].File_name == null) {
//                ds.Tables[0].Rows[i].File_name = "";
//            }

//            if (hidcopy == "copy" && showordisable == "0") {
//                make_td = document.createElement("td");
//                make_td.align = "center";
//                str = "<input class=\"btextforgrid\" type=\"text\" disabled id=" + filename + " disabled  value='" + "" + "'>";
//                make_td.innerHTML = str;
//                Make_Row.appendChild(make_td);
//            }
//            else {
//                make_td = document.createElement("td");
//                make_td.align = "center";
//                str = "<input class=\"btextforgrid\" type=\"text\" disabled id=" + filename + " disabled  value='" + ds.Tables[0].Rows[i].File_name + "'>";
//                make_td.innerHTML = str;
//                Make_Row.appendChild(make_td);

//            }

            ////////this is to bind the status of insertion drop down

            //                            if(browser!="Microsoft Internet Explorer")
            //                            {
            //                                //var xmlDoc = new ActiveXObject("Microsoft.XMLDOM"); 
            //                                //loadXML('xml/billcycle.xml');
            //                                //alert("Delay");
            //                                var b=0;
            //                                //setTimeout("Func1()", 3000);
            //                                //alert(xmlObj);
            //                                for(b=1;b<=xmlObj.childNodes[19].childNodes.length-1;)
            //                                {//xmlObj.childNodes[19].childNodes[1].childNodes[0].nodeValue
            //                                    if(xmlObj.childNodes[19].childNodes[b].childNodes[0].nodeValue==ds.Tables[0].Rows[i].Insert_status)
            //                                    {
            //                                        str=str+"<option value="+xmlObj.childNodes[19].childNodes[b+2].childNodes[0].nodeValue+" selected="+ds.Tables[0].Rows[i].Insert_status+">"+xmlObj.childNodes[19].childNodes[b].childNodes[0].nodeValue+"</option>";
            //                                    }
            //                                    else
            //                                    {
            //                                        str=str+"<option value="+xmlObj.childNodes[19].childNodes[b+2].childNodes[0].nodeValue+">"+xmlObj.childNodes[19].childNodes[b].childNodes[0].nodeValue+"</option>";                                
            //                                    }                                    
            //                                        b=b+4;
            //                                } 
            //                            }
            //                            else
            //                            {

            //                                var xmlDoc = new ActiveXObject("Microsoft.XMLDOM"); 

            //                                loadXML('xml/billcycle.xml');

            //                                var b=0;

            //                                for(b=0;b<=xmlObj.childNodes(9).childNodes.length-1;b++)
            //                                {
            //                                    if(xmlObj.childNodes(9).childNodes(b+1).text==ds.Tables[0].Rows[i].Insert_status)
            //                                    {
            //                                        str=str+"<option value="+xmlObj.childNodes(9).childNodes(b+1).text+" selected="+ds.Tables[0].Rows[i].Insert_status+">"+xmlObj.childNodes(9).childNodes(b).text+"</option>";
            //                                    }
            //                                    else
            //                                    {
            //                                        str=str+"<option value="+xmlObj.childNodes(9).childNodes(b+1).text+">"+xmlObj.childNodes(9).childNodes(b).text+"</option>";                                
            //                                    }                                    
            //                                        b=b+1;
            //                                }    
            //                            }
            /////this for the latest date
            ////////////this is to for larest date
            late = "lat" + i;
            repeat = "rep" + i;
            var latdate;
            var repeatdat;
            if (ds.Tables[0].Rows[i].Latest_by == null) {
                latdate = "";
            }
            else {
                latdate = ds.Tables[0].Rows[i].Latest_by;
            }
            if (ds.Tables[0].Rows[i].Repeating_date == null) {
                repeatdat = ""
            }
            else {
                repeatdat = ds.Tables[0].Rows[i].Repeating_date
            }
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[1].childNodes[0].nodeValue != "hide") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) {
                        var latedate = "latdate" + i;
                        var repeatdate = "repdate" + i;
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" disabled id=" + late + "  value=" + latdate + ">";
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        var latedate = "latdate" + i;
                        var repeatdate = "repdate" + i;
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\"  id=" + late + "  value=" + latdate + ">";
                        Make_Row.appendChild(make_td);
                    }
                }
                else {
                    var latedate = "latdate" + i;
                    var repeatdate = "repdate" + i;
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\"  id=" + late + "  value=" + latdate + ">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
                if (xmlObj.childNodes[25].childNodes[3].childNodes[0].nodeValue != "hide") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" disabled id=" + repeat + "  value=" + repeatdat + ">";
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\"  id=" + repeat + "  value=" + repeatdat + ">";
                        Make_Row.appendChild(make_td);
                    }
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\"  id=" + repeat + "  value=" + repeatdat + ">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }

            }
            else {
                if (xmlObj.childNodes[12].childNodes[0].childNodes[0].nodeValue != "hide") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) {
                        var latedate = "latdate" + i;
                        var repeatdate = "repdate" + i;
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" disabled id=" + late + "  value=" + latdate + ">";
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        var latedate = "latdate" + i;
                        var repeatdate = "repdate" + i;
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\"  id=" + late + "  value=" + latdate + ">";
                        Make_Row.appendChild(make_td);
                    }
                }
                else {
                    var latedate = "latdate" + i;
                    var repeatdate = "repdate" + i;
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\"  id=" + late + "  value=" + latdate + ">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
                if (xmlObj.childNodes[12].childNodes[1].childNodes[0].nodeValue != "hide") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" disabled id=" + repeat + "  value=" + repeatdat + ">";
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\"  id=" + repeat + "  value=" + repeatdat + ">";
                        Make_Row.appendChild(make_td);
                    }
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\"  id=" + repeat + "  value=" + repeatdat + ">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }

            }
            namecode = "one";

            premper = "premper" + i;
            premper1 = "premperone" + i;
            adtypid = "adtyp" + i;
            namecode = "two";
            preall = "preall" + i;
            adcat = "adcat" + i;
            paid = "pai" + i;
            page = "pgpre" + i;
            pageprem = "pagper" + i;
            var discount_ = "disc_" + i;

            var h;

            if (showordisable == "1" || (((ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) && hidcopy != "copy") && document.getElementById('hiddensupplimentflag').value == "")) {
                //str=str+"</select></td><td><input class=\"btextsmallsize\" type=\"text\" disabled id="+premper1+" value="+prempercentage2+"></td>"
                //                            str=str+"<td><select id="+page+" class=\"dropdownforgrid\" disabled  >";
                //                            /////this is to bind the premium 2 drop down
                //                            str=str+"  <option value=\"0\" selected=\"true\">Select</option>";
                //                             for(h=0;h<=ds.Tables[7].Rows.length-1;h++)
                //                              {
                //                                ////////on click function is there to get the prem % on premium drop down change
                //                                    if(ds.Tables[7].Rows[h].pos_type_code==ds.Tables[0].Rows[i].Page_prem && ds.Tables[0].Rows[i].Page_prem!="0")
                //                                    {
                //                                        str=str+"  <option value="+ds.Tables[7].Rows[h].pos_type_code+" selected="+ds.Tables[0].Rows[i].Page_prem+">"+ds.Tables[7].Rows[h].pos_type+"</option>"
                //                                    }
                //                                    else
                //                                    {
                //                                        str=str+"  <option value="+ds.Tables[7].Rows[h].pos_type_code+">"+ds.Tables[7].Rows[h].pos_type+"</option>"
                //                                    }
                //                                }
                make_td = document.createElement("td");
                make_td.align = "center";
                if (ds.Tables[0].Rows[i].Page_prem != null) {
                    make_td.innerHTML = "<input class=\"btextsmallsizeH\" disabled type=\"text\" id=" + page + "  value=" + ds.Tables[0].Rows[i].Page_prem + ">";
                }
                else {
                    make_td.innerHTML = "<input class=\"btextsmallsizeH\" disabled type=\"text\" id=" + page + " >";
                }
                Make_Row.appendChild(make_td);


                ////this is to bind the per for page premium

                //str=str+"</select></td><td><input disabled class=\"btextsmallsize\" type=\"text\" id="+pageprem+" value="+ds.Tables[0].Rows[i].page_per+"></td>"
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id=" + pageprem + " value=" + ds.Tables[0].Rows[i].page_per + ">";
                Make_Row.appendChild(make_td);

                // str=str+"<td><select disabled id="+preall+" class=\"dropdownforgrid\">";
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[25].childNodes[5].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<select id=" + preall + " disabled class=\"dropdownforgrid\">";
                        str = str + "<option value=\"0\">Select</option>";
                        str = str + "<option value=\"1\">Yes</option>";
                        str = str + "<option value=\"2\">No</option>";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<select id=" + preall + "  class=\"dropdownforgrid\">";
                        str = str + "<option value=\"0\">Select</option>";
                        str = str + "<option value=\"1\">Yes</option>";
                        str = str + "<option value=\"2\">No</option>";
                        make_td.innerHTML = str;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);

                    }
                }
                else {
                    if (xmlObj.childNodes[12].childNodes[2].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<select id=" + preall + " disabled class=\"dropdownforgrid\">";
                        str = str + "<option value=\"0\">Select</option>";
                        str = str + "<option value=\"1\">Yes</option>";
                        str = str + "<option value=\"2\">No</option>";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<select id=" + preall + "  class=\"dropdownforgrid\">";
                        str = str + "<option value=\"0\">Select</option>";
                        str = str + "<option value=\"1\">Yes</option>";
                        str = str + "<option value=\"2\">No</option>";
                        make_td.innerHTML = str;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }
            }
            else {
                pagstr = "sec"
                //str=str+"</select></td><td><input class=\"btextsmallsize\" type=\"text\" id="+premper1+" value="+prempercentage2+"></td>"
                //                            str=str+"<td><select id="+page+" class=\"dropdownforgrid\" onchange=\"return getpageprem("+page+","+i+",'"+pagstr+"');\"  >";
                //                            /////this is to bind the premium 2 drop down
                //                            str=str+"  <option value=\"0\" selected=\"true\">Select</option>";
                //                            for(h=0;h<=ds.Tables[7].Rows.length-1;h++)
                //                            {
                //                                ////////on click function is there to get the prem % on premium drop down change
                //                                if(ds.Tables[7].Rows[h].pos_type_code==ds.Tables[0].Rows[i].Page_prem && ds.Tables[0].Rows[i].Page_prem!="0")
                //                                {
                //                                    str=str+"  <option value="+ds.Tables[7].Rows[h].pos_type_code+" selected="+ds.Tables[0].Rows[i].Page_prem+">"+ds.Tables[7].Rows[h].pos_type+"</option>"
                //                                }
                //                                else
                //                                {
                //                                    str=str+"  <option value="+ds.Tables[7].Rows[h].pos_type_code+">"+ds.Tables[7].Rows[h].pos_type+"</option>"
                //                                }
                //                            }
                //                                ////this is to bind the per for page premium

                //                            str=str+"</select></td><td><input disabled class=\"btextsmallsize\" type=\"text\" id="+pageprem+" value="+ds.Tables[0].Rows[i].page_per+"></td>"

                //                            ///////////////////////////////////////////////    
                //                            str=str+"<td><select id="+preall+" class=\"dropdownforgrid\">";
                make_td = document.createElement("td");
                make_td.align = "center";
                if (ds.Tables[0].Rows[i].Page_prem != null) {
                    make_td.innerHTML = "<input class=\"btextsmallsize\"   type=\"text\" id=" + page + "  value=" + ds.Tables[0].Rows[i].Page_prem + ">";
                }
                else {
                    make_td.innerHTML = "<input class=\"btextsmallsize\"   type=\"text\" id=" + page + ">";
                }
                Make_Row.appendChild(make_td);

                ////this is to bind the per for page premium

                //str=str+"</select></td><td><input disabled class=\"btextsmallsize\" type=\"text\" id="+pageprem+" value="+ds.Tables[0].Rows[i].page_per+"></td>"
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input  class=\"btextsmallsize\" type=\"text\" id=" + pageprem + " value=" + ds.Tables[0].Rows[i].page_per + ">";
                Make_Row.appendChild(make_td);

                // str=str+"<td><select disabled id="+preall+" class=\"dropdownforgrid\">";
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[25].childNodes[5].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<select id=" + preall + " disabled class=\"dropdownforgrid\">";
                        str = str + "<option value=\"0\">Select</option>";
                        str = str + "<option value=\"1\">Yes</option>";
                        str = str + "<option value=\"2\">No</option>";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<select id=" + preall + "  class=\"dropdownforgrid\">";
                        str = str + "<option value=\"0\">Select</option>";
                        str = str + "<option value=\"1\">Yes</option>";
                        str = str + "<option value=\"2\">No</option>";
                        make_td.innerHTML = str;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);

                    }
                }
                else {
                    if (xmlObj.childNodes[12].childNodes[2].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<select id=" + preall + " disabled class=\"dropdownforgrid\">";
                        str = str + "<option value=\"0\">Select</option>";
                        str = str + "<option value=\"1\">Yes</option>";
                        str = str + "<option value=\"2\">No</option>";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<select id=" + preall + "  class=\"dropdownforgrid\">";
                        str = str + "<option value=\"0\">Select</option>";
                        str = str + "<option value=\"1\">Yes</option>";
                        str = str + "<option value=\"2\">No</option>";
                        make_td.innerHTML = str;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }
            }


            //////////////this is to bind the drop down for accepting the premium

            //                            str=str+"<option value=\"0\">Select</option>";
            //                            str=str+"<option value=\"1\">Yes</option>";
            //                            str=str+"<option value=\"2\">No</option>";

            if (showordisable == "1" || (((ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) && hidcopy != "copy") && document.getElementById('hiddensupplimentflag').value == "")) {
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input disabled class=\"dropdownforgrid\" type=\"text\" id=" + adcat + " value='" + ds.Tables[0].Rows[i].Ad_cat + "'>";
                Make_Row.appendChild(make_td);
                // str=str+"</td></select><td><select disabled id="+adcat+" class=\"dropdownforgrid\">";
            }
            else {
                // str=str+"</td></select><td><select id="+adcat+" class=\"dropdownforgrid\">";    
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input  class=\"dropdownforgrid\"  type=\"text\" id=" + adcat + " value='" + ds.Tables[0].Rows[i].Ad_cat + "'>";
                Make_Row.appendChild(make_td);
            }
            var o;
            ///this loop is to bind the ad category
            //                            str=str+"<option value=\"0\" selected=\"true\">select</option>";
            //                             for(o=0;o<=ds.Tables[6].Rows.length-1;o++)
            //                                {
            //                                    if(ds.Tables[6].Rows[o].adv_cat_code==ds.Tables[0].Rows[i].Ad_cat && ds.Tables[0].Rows[i].Ad_cat!="0")
            //                                    {
            //                                    str=str+"<option value="+ds.Tables[6].Rows[o].adv_cat_code+" selected="+ds.Tables[0].Rows[i].Ad_cat+">"+ds.Tables[6].Rows[o].adv_cat_name+"</option>";
            //                                    }
            //                                    else
            //                                    {
            //                                    str=str+"<option value="+ds.Tables[6].Rows[o].adv_cat_code+">"+ds.Tables[6].Rows[o].adv_cat_name+"</option>";
            //                                    }
            //                                }

            //                                str=str+"</select></td>";

            //                           if(showordisable=="1" || ds.Tables[0].Rows[i].Insert_status=="billed" || ds.Tables[0].Rows[i].Insert_status=="publish")
            //                           {     
            //                                      make_td=document.createElement("td");
            //                                    make_td.align="center";
            //                                str="<select disabled id="+billstat+" class=\"dropdownforgrid\">";
            //                                
            //                           }
            //                           else
            //                           {
            //                                   make_td=document.createElement("td");
            //                                    make_td.align="center";
            //                                str="<select id="+billstat+" disabled class=\"dropdownforgrid\">";
            //                           }
            //                                    /////////////this function is to bind the bill status dropdown
            //                                    
            //                                    
            //                                    if(browser!="Microsoft Internet Explorer")
            //                                    {
            //                                        //loadXML('xml/billcycle.xml');

            //                                            var c=0;
            //                                            //setTimeout("Func2()", 3000);
            //                                           // alert("Delay");
            //                                            //debugger;
            //                                            for(c=1;c<=xmlObj.childNodes[3].childNodes.length-1;c=c+4)
            //                                            {
            //                                                        str=str+"<option value="+xmlObj.childNodes[3].childNodes[c+2].childNodes[0].nodeValue+">"+xmlObj.childNodes[3].childNodes[c].childNodes[0].nodeValue+"</option>";
            //                                                        //c=c+2;
            //                                                          if(xmlObj.childNodes[3].childNodes[c+2].childNodes[0].nodeValue==ds.Tables[0].Rows[i].Bill_status)
            //                                                          {
            //                                                                str=str+"<option value="+xmlObj.childNodes[3].childNodes[c+2].childNodes[0].nodeValue+" selected="+ds.Tables[0].Rows[i].Bill_status+">"+xmlObj.childNodes[3].childNodes[c].childNodes[0].nodeValue+"</option>";
            //                                                                
            //                                                          }
            //                                                          else
            //                                                          {
            //                                                                str=str+"<option value="+xmlObj.childNodes[3].childNodes[c+2].childNodes[0].nodeValue+">"+xmlObj.childNodes[3].childNodes[c].childNodes[0].nodeValue+"</option>";
            //                                                                
            //                                                          }
            //                                                          //c=c+1;
            //                                            }
            //                                    }
            //                                    else
            //                                    {          
            //                                        if(xmlObj.childNodes(1)==null)
            //                                        {                          
            //                                            var xmlDoc = new ActiveXObject("Microsoft.XMLDOM"); 
            //                                            loadXML('xml/billcycle.xml');
            //                                        }    

            //                                        var c=0;

            //                                        for(c=0;c<=xmlObj.childNodes(1).childNodes.length-1;c++)
            //                                        {
            //                                            if(xmlObj.childNodes(1).childNodes(c+1).text==ds.Tables[0].Rows[i].Bill_status)
            //                                              {
            //                                                    str=str+"<option value="+xmlObj.childNodes(1).childNodes(c+1).text+" selected="+ds.Tables[0].Rows[i].Bill_status+">"+xmlObj.childNodes(1).childNodes(c).text+"</option>";
            //                                                    
            //                                              }
            //                                              else
            //                                              {
            //                                                    str=str+"<option value="+xmlObj.childNodes(1).childNodes(c+1).text+">"+xmlObj.childNodes(1).childNodes(c).text+"</option>";
            //                                                    
            //                                              }
            //                                              c=c+1;
            //                                        } 
            //                                    }
            //                                    str=str+"</select>";
            //                                      make_td.innerHTML=str;
            //                                        Make_Row.appendChild(make_td); 



            if (browser != "Microsoft Internet Explorer") {

                if (dbill == "") {
                    make_td = document.createElement("td");
                    make_td.align = "center";


                    if (showordisable == "1" || (((ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) && hidcopy != "copy") && document.getElementById('hiddensupplimentflag').value == ""))
                        dbill = dbill + "<select id=" + billstat + " disabled class=\"dropdownforgrid\">";
                    else
                        dbill = dbill + "<select id=" + billstat + "  class=\"dropdownforgrid\">";

                    /////////////this function is to bind the bill status dropdown

                    // document.getElementById('txtciobookid').value=xmlObj.childNodes(3);

                    //                    alert("load");
                    //                  loadXML('xml/billcycle.xml');


                    var c = 0;
                    BILL_STATUS = '';
                    //   for(c=1;c<=xmlObj.childNodes[3].childNodes.length-1;c=c+4)
                    // {   
                    //                     dbill=dbill+"<option value="+xmlObj.childNodes[3].childNodes[c+2].childNodes[0].nodeValue+">"+xmlObj.childNodes[3].childNodes[c].childNodes[0].nodeValue+"</option>";
                    //                     BILL_STATUS = BILL_STATUS + "<option value="+xmlObj.childNodes[3].childNodes[c+2].childNodes[0].nodeValue+">"+xmlObj.childNodes[3].childNodes[c].childNodes[0].nodeValue+"</option>";
                    if (ds.Tables[0].Rows[i].Bill_status == "1")
                        dbill = dbill + "<option value='1' selected='1'>Daily</option>";
                    else
                        dbill = dbill + "<option value='1'>Daily</option>";
                    if (ds.Tables[0].Rows[i].Bill_status == "2")
                        dbill = dbill + "<option value='2' selected='2'>Weekly</option>";
                    else
                        dbill = dbill + "<option value='2'>Weekly</option>";
                    if (ds.Tables[0].Rows[i].Bill_status == "3")
                        dbill = dbill + "<option value='3' selected='3'>Fortnight</option>";
                    else
                        dbill = dbill + "<option value='3'>Fortnight</option>";
                    if (ds.Tables[0].Rows[i].Bill_status == "4")
                        dbill = dbill + "<option value='4' selected='4'>Monthly</option>";
                    else
                        dbill = dbill + "<option value='4'>Monthly</option>";

                    BILL_STATUS = BILL_STATUS + "<option value=1>Daily</option>";
                    BILL_STATUS = BILL_STATUS + "<option value=2>Weekly</option>";
                    BILL_STATUS = BILL_STATUS + "<option value=3>Fortnight</option>";
                    BILL_STATUS = BILL_STATUS + "<option value=4>Monthly</option>";
                    // }
                    dbill = dbill + "</select>";
                    if (xmlObj.childNodes[25].childNodes[7].childNodes[0].nodeValue != "hide") {
                        make_td.innerHTML = dbill;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td.innerHTML = dbill;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                    //str=str+dbill;
                }
                else {
                    // str=str+dbill.replace("bill"+dcou,billstat);          
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = dbill.replace("bill" + dcou, billstat);
                    make_td.innerHTML = str;
                    if (xmlObj.childNodes[25].childNodes[7].childNodes[0].nodeValue != "hide") {

                        Make_Row.appendChild(make_td);
                    }
                    else {

                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }
            }

            else {
                if (dbill == "") {
                    if (xmlObj.childNodes(1) == null) {
                        loadXML('xml/billcycle.xml');
                    }
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (showordisable == "1" || (((ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) && hidcopy != "copy") && document.getElementById('hiddensupplimentflag').value == ""))
                        dbill = dbill + "<select id=" + billstat + " disabled class=\"dropdownforgrid\">";
                    else
                        dbill = dbill + "<select id=" + billstat + "  class=\"dropdownforgrid\">";
                    var c = 0;
                    for (c = 0; c <= xmlObj.childNodes(1).childNodes.length - 1; c++) {
                        dbill = dbill + "<option value=" + xmlObj.childNodes(1).childNodes(c + 1).text + ">" + xmlObj.childNodes(1).childNodes(c).text + "</option>";
                        c = c + 1;
                    }

                    dbill = dbill + "</select>";
                    //str=str+dbill;   
                    if (xmlObj.childNodes[12].childNodes[3].childNodes[0].nodeValue != "hide") {
                        make_td.innerHTML = dbill;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td.innerHTML = dbill;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }
                else {
                    // str=str+dbill.replace("bill"+dcou,billstat);             
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = dbill.replace("bill" + dcou, billstat);
                    make_td.innerHTML = str;
                    if (xmlObj.childNodes[12].childNodes[3].childNodes[0].nodeValue != "hide") {

                        Make_Row.appendChild(make_td);
                    }
                    else {

                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }

            }



            str = "";
            if (ds.Tables[0].Rows[i].DISCOUNT == null)
                ds.Tables[0].Rows[i].DISCOUNT = "";
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[13].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[8].Rows[0].Paid_permission == "0" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) {
                        make_td.innerHTML = "<input class=\"btextsmallsizeH\" disabled type=\"text\" id=" + discount_ + "   value='" + ds.Tables[0].Rows[i].DISCOUNT + "' >";
                    }
                    else if (document.getElementById('hiddisceditgrid').value == "Y")
                        make_td.innerHTML = "<input class=\"btextsmallsizeH\"  type=\"text\" id=" + discount_ + "  value='" + ds.Tables[0].Rows[i].DISCOUNT + "'  >";
                    else
                        make_td.innerHTML = "<input class=\"btextsmallsizeH\" disabled type=\"text\" id=" + discount_ + "  value='" + ds.Tables[0].Rows[i].DISCOUNT + "'  >";

                    Make_Row.appendChild(make_td);
                }
                if (xmlObj.childNodes[23].childNodes[37].childNodes[0].nodeValue != "enable") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<select disabled id=" + paid + " class=\"dropdownforgridsmall\" >";
                }
                else {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[8].Rows[0].Paid_permission == "0" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<select disabled id=" + paid + " class=\"dropdownforgridsmall\" >";

                    }
                    else {
                        if (ds.Tables[8].Rows[0].Paid_permission == "0") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = "<select id=" + paid + "  class=\"dropdownforgridsmall\">";  //23sep onchange=\"putpaidintoinsert("+paid+","+inserts+","+ds.Tables[0].Rows[i].no_insert+");\">";
                        }
                        else {
                            str = "<select id=" + paid + "  class=\"dropdownforgridsmall\">";  //  onchange=\"putpaidintoinsert("+paid+","+inserts+","+ds.Tables[0].Rows[i].no_insert+");\">";                                    
                        }
                    }
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[6].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[8].Rows[0].Paid_permission == "0" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) {
                        make_td.innerHTML = "<input class=\"btextsmallsizeH\" disabled type=\"text\" id=" + discount_ + "   value='" + ds.Tables[0].Rows[i].DISCOUNT + "' >";
                    }
                    else if (document.getElementById('hiddisceditgrid').value == "Y")
                        make_td.innerHTML = "<input class=\"btextsmallsizeH\"  type=\"text\" id=" + discount_ + "  value='" + ds.Tables[0].Rows[i].DISCOUNT + "'  >";
                    else
                        make_td.innerHTML = "<input class=\"btextsmallsizeH\" disabled type=\"text\" id=" + discount_ + "   value='" + ds.Tables[0].Rows[i].DISCOUNT + "'  >";

                    Make_Row.appendChild(make_td);
                }
                if (xmlObj.childNodes[11].childNodes[18].childNodes[0].nodeValue != "enable") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<select disabled id=" + paid + " class=\"dropdownforgridsmall\" >";
                } else {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[8].Rows[0].Paid_permission == "0" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<select disabled id=" + paid + " class=\"dropdownforgridsmall\" >";

                    }
                    else {
                        if (ds.Tables[8].Rows[0].Paid_permission == "0") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = "<select id=" + paid + "  class=\"dropdownforgridsmall\">";  //23sep onchange=\"putpaidintoinsert("+paid+","+inserts+","+ds.Tables[0].Rows[i].no_insert+");\">";
                        }
                        else {
                            str = "<select id=" + paid + "  class=\"dropdownforgridsmall\">";  //  onchange=\"putpaidintoinsert("+paid+","+inserts+","+ds.Tables[0].Rows[i].no_insert+");\">";                                    
                        }
                    }
                }
            }

            if (ds.Tables[0].Rows[i].Pai_free_ins == "Y") {
                str = str + "<option value=\"Y\" selected=" + ds.Tables[0].Rows[i].Pai_free_ins + ">Yes</option>";
            }
            else {
                str = str + "<option value=\"Y\" >Yes</option>";
            }
            if (ds.Tables[0].Rows[i].Pai_free_ins == "N") {
                str = str + "<option value=\"N\" selected=" + ds.Tables[0].Rows[i].Pai_free_ins + ">No</option>";
            }
            else {
                str = str + "<option value=\"N\">No</option>";
            }
            if (ds.Tables[0].Rows[i].Pai_free_ins == "P") {
                str = str + "<option value=\"P\" selected=" + ds.Tables[0].Rows[i].Pai_free_ins + ">Paid</option>";
            }
            else {
                str = str + "<option value=\"P\">Paid</option>";
            }
            str = str + "</select>";
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);

            //this is to upload the image

            picfield = "pic" + i;
            str = str + "</select></td>";

            solo = "sol" + i;
            gross = "gro" + i;

            if (showordisable == "1" || (((ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) && hidcopy != "copy") && document.getElementById('hiddensupplimentflag').value == "")) {
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextforgrid\" disabled type=\"text\" disabled id=" + solo + "  value=" + ds.Tables[0].Rows[i].Solo_rate + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);

                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextforgrid\" disabled type=\"text\" disabled id=" + gross + "  value=" + ds.Tables[0].Rows[i].Gross_rate + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
            else {
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextforgrid\" disabled type=\"text\" disabled id=" + solo + "  value=" + ds.Tables[0].Rows[i].Solo_rate + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);

                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextforgrid\" disabled type=\"text\" disabled id=" + gross + "  value=" + ds.Tables[0].Rows[i].Gross_rate + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
                //                                str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+solo+"  value="+ds.Tables[0].Rows[i].Solo_rate+"></td>";

                //                                str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+gross+"  value="+ds.Tables[0].Rows[i].Gross_rate+"></td>";
            }

            pageno_inserts = "pagno" + i; ;
            remark_inserts = "rem" + i;
            billamt = "ba" + i;

            if (showordisable == "1" || (((ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) && hidcopy != "copy") && document.getElementById('hiddensupplimentflag').value == "")) {
                //  str=str+"<td><input class=\"btextforgrid\" disabled class=\"btextsmallsize\" onkeypress=\"javascript:return rateenter(event);\"   type=\"text\" id="+pageno_inserts+"  value="+ds.Tables[0].Rows[i].Page_no+"></td>";
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextforgrid\" disabled class=\"btextsmallsize\"   type=\"text\" id=" + pageno_inserts + "  value=" + ds.Tables[0].Rows[i].Page_no + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);

            }
            else {
                // str=str+"<td><input class=\"btextforgrid\" class=\"btextsmallsize\" onkeypress=\"javascript:return rateenter(event);\"   type=\"text\" id="+pageno_inserts+"  value="+ds.Tables[0].Rows[i].Page_no+"></td>";
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextforgrid\"  class=\"btextsmallsize\"   type=\"text\" id=" + pageno_inserts + "  value=" + ds.Tables[0].Rows[i].Page_no + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
            caption_inserts = "cap" + i;
            if (ds.Tables[0].Rows[i].CAPTION == null) {
                ds.Tables[0].Rows[i].CAPTION = "";
            }
            if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) {
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input  class=\"btextforgrid\"  disabled  type=\"text\" id=" + caption_inserts + " title='" + ds.Tables[0].Rows[i].CAPTION + "'  value='" + ds.Tables[0].Rows[i].CAPTION + "'>";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
            else {
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input  class=\"btextforgrid\"   type=\"text\" id=" + caption_inserts + "  title='" + ds.Tables[0].Rows[i].CAPTION + "' value='" + ds.Tables[0].Rows[i].CAPTION + "'>";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }

            if (ds.Tables[0].Rows[i].Remarks == null) {
                ds.Tables[0].Rows[i].Remarks = "";
            }

            if (showordisable == "1" || (((ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) && hidcopy != "copy") && document.getElementById('hiddensupplimentflag').value == "")) {
                // str=str+"<td><input class=\"btextforinsertright\" disabled class=\"btextsmallsize\" onkeypress=\"javascript:return rateenter(event);\"  type=\"text\" id="+remark_inserts+"  value="+ds.Tables[0].Rows[i].Remarks+"></td>";
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input  class=\"btextforgrid\"  disabled  type=\"text\" id=" + remark_inserts + " title='" + ds.Tables[0].Rows[i].Remarks + "'   value='" + ds.Tables[0].Rows[i].Remarks + "'>";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
            else {
                //str=str+"<td><input  class=\"btextforgrid\"   type=\"text\" id="+remark_inserts+"  value="+ds.Tables[0].Rows[i].Remarks+"></td>";
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input  class=\"btextforgrid\"    type=\"text\" id=" + remark_inserts + " title='" + ds.Tables[0].Rows[i].Remarks + "' value='" + ds.Tables[0].Rows[i].Remarks + "'>";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
            billrate = "br" + i;
            agnamnt = "agmn" + i;
            adlgn = "adlag" + i;
            spldisc = "spld" + i;
            cashdisc = "cashd" + i;
            roundoffval = "roundoffval" + i;
            pheival = "pheival" + i;
            var grid_billamt = ds.Tables[0].Rows[i].Bill_Amt
            var grid_billrate = ds.Tables[0].Rows[i].Bill_rate
            var grid_agnamnt = ds.Tables[0].Rows[i].agncyamnt;
            var grid_adlagn = ds.Tables[0].Rows[i].adlgncyamt;
            var grid_splamt = ds.Tables[0].Rows[i].spldisamt;
            var grid_cashamt = ds.Tables[0].Rows[i].cashdisamt;
            var grid_roundamt = ds.Tables[0].Rows[i].ROUND_VALUE;
            var grid_pheival = ds.Tables[0].Rows[i].PDF_HEIGHT;
            if (grid_billamt == null) {
                grid_billamt = "";
            }
            if (grid_billrate == null) {
                grid_billrate = "";
            }
            // str=str+"<td><input class=\"btextforinsertright\" disabled class=\"btextsmallsize\" onkeypress=\"javascript:return rateenter(event);\"  type=\"text\" id="+billamt+"  value="+grid_billamt+"></td>";
            make_td = document.createElement("td");
            make_td.align = "center";
            str = "<input class=\"btextforinsertright\" disabled class=\"btextsmallsize\" type=\"text\" id=" + billamt + " title='" + "Insert No:" + ds.Tables[0].Rows[i].no_insert + ",Edition:" + ds.Tables[0].Rows[i].Edition + ",Date:" + getdateforexe + "'  value=" + grid_billamt + ">";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);

            // new field for local gross and local bill amount
            var grosslocal = "grolocal" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].LOCALGROSSAMT != null)
                make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + grosslocal + "  value='" + ds.Tables[0].Rows[i].LOCALGROSSAMT + "'>";
            else
                make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + grosslocal + "  value=''>";
            Make_Row.appendChild(make_td);

            // str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billamt+"  value=\"\"></td>";
            var billamtlocal = "balocal" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].LOCALBILLAMT != null)
                make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + billamtlocal + "  value='" + ds.Tables[0].Rows[i].LOCALBILLAMT + "'>";
            else
                make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + billamtlocal + "  value=\"\">";
            Make_Row.appendChild(make_td);
            //-----

            //str=str+"<td><input class=\"btextforinsertright\" disabled class=\"btextsmallsize\" onkeypress=\"javascript:return rateenter(event);\"  type=\"text\" id="+billrate+"  value="+grid_billrate+"></td>";
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[9].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + billrate + "  value=" + grid_billrate + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + billrate + "  value=" + grid_billrate + ">";
                    make_td.innerHTML = str;
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[4].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + billrate + "  value=" + grid_billrate + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + billrate + "  value=" + grid_billrate + ">";
                    make_td.innerHTML = str;
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[15].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + agnamnt + "  value=" + grid_agnamnt + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + agnamnt + "  value=" + grid_agnamnt + ">";
                    make_td.innerHTML = str;
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[7].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + agnamnt + "  value=" + grid_agnamnt + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + agnamnt + "  value=" + grid_agnamnt + ">";
                    make_td.innerHTML = str;
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[17].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + adlgn + "  value=" + grid_adlagn + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + adlgn + "  value=" + grid_adlagn + ">";
                    make_td.innerHTML = str;
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[8].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + adlgn + "  value=" + grid_adlagn + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + adlgn + "  value=" + grid_adlagn + ">";
                    make_td.innerHTML = str;
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[19].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + spldisc + "  value=" + grid_splamt + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + spldisc + "  value=" + grid_splamt + ">";
                    make_td.innerHTML = str;
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[9].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + spldisc + "  value=" + grid_splamt + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + spldisc + "  value=" + grid_splamt + ">";
                    make_td.innerHTML = str;
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[21].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + cashdisc + "  value=" + grid_cashamt + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + cashdisc + "  value=" + grid_cashamt + ">";
                    make_td.innerHTML = str;
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[10].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + cashdisc + "  value=" + grid_cashamt + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + cashdisc + "  value=" + grid_cashamt + ">";
                    make_td.innerHTML = str;
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[23].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + roundoffval + "  value=" + grid_roundamt + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + roundoffval + "  value=" + grid_roundamt + ">";
                    make_td.innerHTML = str;
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[11].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + roundoffval + "  value=" + grid_roundamt + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + roundoffval + "  value=" + grid_roundamt + ">";
                    make_td.innerHTML = str;
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[23].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + pheival + "  value=" + grid_pheival + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + pheival + "  value=" + grid_pheival + ">";
                    make_td.innerHTML = str;
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[11].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + pheival + "  value=" + grid_pheival + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + pheival + "  value=" + grid_pheival + ">";
                    make_td.innerHTML = str;
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            picfield = "pic" + i;
//            var upl = "upload" + i;

//            if (showordisable == "1" || (((ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) && hidcopy != "copy") && document.getElementById('hiddensupplimentflag').value == "")) {
//                //str=str+"<td width=\"50px\"><input disabled  class=\"button1\" type=\"button\" Value=\"Attachment\" onclick=\"uploadimage('"+picfield+"','"+ds.Tables[0].Rows[i].no_insert+"','"+editid+"','"+filename+"','"+i+"')\">";
//                make_td = document.createElement("td");
//                make_td.align = "center";
//                str = "<input disabled  class=\"button1\" type=\"button\" id=" + upl + " Value=\"Attachment\" >";
//                make_td.innerHTML = str;
//                Make_Row.appendChild(make_td);
//            }
//            else {
//                //str=str+"<td width=\"50px\"><input  class=\"button1\" type=\"button\" Value=\"Attachment\" onclick=\"uploadimage('"+picfield+"','"+ds.Tables[0].Rows[i].no_insert+"','"+editid+"','"+filename+"','"+i+"')\">";
//                make_td = document.createElement("td");
//                make_td.align = "center";
//                str = "<input  class=\"button1\" type=\"button\" id=" + upl + " Value=\"Attachment\" >";
//                make_td.innerHTML = str;
//                Make_Row.appendChild(make_td);
//            }

            // for split button

            var splt = "splt" + i;
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[73].childNodes[0].nodeValue == "enable" && document.getElementById('hiddenuomdesc').value == "CD" && ds.Tables[0].Rows[i].PRIORITY != '1' && ds.Tables[0].Rows[i].PRIORITY != null && ds.Tables[0].Rows[i].SPLIT == 'Y')// ds.Tables[0].Rows[i].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || (ds.Tables[0].Rows[i].Insert_status == "publish" && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input   class=\"buttonsplit\" type=\"button\" id=" + splt + " Value=\"Split\" >";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);

                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input  class=\"buttonsplit\" type=\"button\" id=" + splt + " Value=\"Split\" >";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);

                    }
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(36).text == "enable" && document.getElementById('hiddenuomdesc').value == "CD" && ds.Tables[0].Rows[i].PRIORITY != '1' && ds.Tables[0].Rows[i].PRIORITY != null && ds.Tables[0].Rows[i].SPLIT == 'Y')// ds.Tables[0].Rows[i].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) {
                        // str=str+"<td width=\"50px\"><input   class=\"buttonsplit\" type=\"button\" id="+splt+" Value=\"Split\"  ></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input   class=\"buttonsplit\" type=\"button\" id=" + splt + " Value=\"Split\"  >";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input  class=\"buttonsplit\" type=\"button\" id=" + splt + " Value=\"Split\" >";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                        // str=str+"<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" id="+splt+" Value=\"Split\" ></td>";
                    }
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
            }
            // for sub edition detail button

            var subedi = "subedi" + i;
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[75].childNodes[0].nodeValue == "enable")// ds.Tables[0].Rows[i].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input   class=\"buttonsplit\" type=\"button\" id=" + subedi + " Value=\"Detail\">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                        //str=str+"<td width=\"50px\"><input   class=\"buttonsplit\" type=\"button\" id="+subedi+" Value=\"Detail\"></td>";
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input  class=\"buttonsplit\" type=\"button\" id=" + subedi + " Value=\"Detail\">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                        // str=str+"<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" id="+subedi+" Value=\"Detail\"></td>";
                    }
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(37).text == "enable")// ds.Tables[0].Rows[i].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input   class=\"buttonsplit\" type=\"button\" id=" + subedi + " Value=\"Detail\">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                        // str=str+"<td width=\"50px\"><input   class=\"buttonsplit\" type=\"button\" id="+subedi+" Value=\"Detail\"></td>";
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input  class=\"buttonsplit\" type=\"button\" id=" + subedi + " Value=\"Detail\" >";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                        // str=str+"<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" id="+subedi+" Value=\"Detail\" ></td>";
                    }
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
            }
            // for VTS popup

            if (showordisable == "1" || (((ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) && hidcopy != "copy") && document.getElementById('hiddensupplimentflag').value == "")) {
                var vtsid = "vts" + i;
                var vtsval = "";
                if (ds.Tables[0].Rows[i].VTS != null && ds.Tables[0].Rows[i].CIRPUBLICATION != null)
                    vtsval = ds.Tables[0].Rows[i].VTS + "ÿ" + ds.Tables[0].Rows[i].CIRPUBLICATION + "ÿ" + ds.Tables[0].Rows[i].CIREDITION + "ÿ" + ds.Tables[0].Rows[i].CIRRATE + "ÿ" + ds.Tables[0].Rows[i].CIRPUBLISHDATE + "ÿ" + ds.Tables[0].Rows[i].CIREDITIONNAME;
                var vtsbtnid = "vtsbtn" + i;
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input  class=\"button1\" disabled type=\"button\" id=" + vtsbtnid + " Value=\"VTS\"><input  type=\"hidden\" id=" + vtsid + " value='" + vtsval + "'>";
                Make_Row.appendChild(make_td);

                //                         make_td=document.createElement("td");
                //                         make_td.align="center";
                //                         make_td.innerHTML="<input  type=\"hidden\" id="+vtsid+" value='"+vtsval+"'>";
                //                         Make_Row.appendChild(make_td);
            }
            else {
                var vtsbtnid = "vtsbtn" + i;
                var vtsid = "vts" + i;
                var vtsval = "";
                if (ds.Tables[0].Rows[i].VTS != null && ds.Tables[0].Rows[i].CIRPUBLICATION != null)
                    vtsval = ds.Tables[0].Rows[i].VTS + "ÿ" + ds.Tables[0].Rows[i].CIRPUBLICATION + "ÿ" + ds.Tables[0].Rows[i].CIREDITION + "ÿ" + ds.Tables[0].Rows[i].CIRRATE + "ÿ" + ds.Tables[0].Rows[i].CIRPUBLISHDATE + "ÿ" + ds.Tables[0].Rows[i].CIREDITIONNAME;
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input  class=\"button1\" type=\"button\" id=" + vtsbtnid + " Value=\"VTS\"><input  type=\"hidden\" id=" + vtsid + " value='" + vtsval + "'>";
                Make_Row.appendChild(make_td);

                //                         make_td=document.createElement("td");
                //                         make_td.align="center";
                //                         make_td.innerHTML="<input  type=\"hidden\" id="+vtsid+" value='"+vtsval+"'>";
                //                         Make_Row.appendChild(make_td);
            }
            //this is to upload the image








            // for logo
            var logohei = "logohei" + i;
            var logowid = "logowid" + i;
            var logonam = "logonam" + i;
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[11].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (ds.Tables[0].Rows[i].Logo_H != null)
                        make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logohei + " Value=" + ds.Tables[0].Rows[i].Logo_H + " >";
                    else
                        make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logohei + " Value=\"\" >";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (ds.Tables[0].Rows[i].Logo_W != null)
                        make_td.innerHTML = "<input  class=\"btextsmallsize\"  disabled type=\"text\" id=" + logowid + " Value=" + ds.Tables[0].Rows[i].Logo_W + " >";
                    else
                        make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logowid + " Value=\"\" >";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (ds.Tables[0].Rows[i].Logo_name != null)
                        make_td.innerHTML = "<input  class=\"dropdownforgrid\" disabled type=\"text\" id=" + logonam + " Value=" + ds.Tables[0].Rows[i].Logo_name + " >";
                    else
                        make_td.innerHTML = "<input  class=\"dropdownforgrid\" disabled type=\"text\" id=" + logonam + " Value=\"\" >";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (ds.Tables[0].Rows[i].Logo_H != null)
                        make_td.innerHTML = "<input  class=\"btextsmallsize\" type=\"text\" id=" + logohei + " Value=" + ds.Tables[0].Rows[i].Logo_H + " >";
                    else
                        make_td.innerHTML = "<input  class=\"btextsmallsize\"  type=\"text\" id=" + logohei + " Value=\"\" >";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (ds.Tables[0].Rows[i].Logo_W != null)
                        make_td.innerHTML = "<input  class=\"btextsmallsize\"  type=\"text\" id=" + logowid + " Value=" + ds.Tables[0].Rows[i].Logo_W + " >";
                    else
                        make_td.innerHTML = "<input  class=\"btextsmallsize\"  type=\"text\" id=" + logowid + " Value=\"\" >";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (ds.Tables[0].Rows[i].Logo_name != null)
                        make_td.innerHTML = "<input  class=\"dropdownforgrid\" type=\"text\" id=" + logonam + " Value=" + ds.Tables[0].Rows[i].Logo_name + " >";
                    else
                        make_td.innerHTML = "<input  class=\"dropdownforgrid\" type=\"text\" id=" + logonam + " Value=\"\" >";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[5].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (ds.Tables[0].Rows[i].Logo_H != null)
                        make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logohei + " Value=" + ds.Tables[0].Rows[i].Logo_H + " >";
                    else
                        make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logohei + " Value=\"\" >";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (ds.Tables[0].Rows[i].Logo_W != null)
                        make_td.innerHTML = "<input  class=\"btextsmallsize\"  disabled type=\"text\" id=" + logowid + " Value=" + ds.Tables[0].Rows[i].Logo_W + " >";
                    else
                        make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logowid + " Value=\"\" >";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (ds.Tables[0].Rows[i].Logo_name != null)
                        make_td.innerHTML = "<input  class=\"dropdownforgrid\" disabled type=\"text\" id=" + logonam + " Value=" + ds.Tables[0].Rows[i].Logo_name + " >";
                    else
                        make_td.innerHTML = "<input  class=\"dropdownforgrid\" disabled type=\"text\" id=" + logonam + " Value=\"\" >";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (ds.Tables[0].Rows[i].Logo_H != null)
                        make_td.innerHTML = "<input  class=\"btextsmallsize\"  type=\"text\" id=" + logohei + " Value=" + ds.Tables[0].Rows[i].Logo_H + " >";
                    else
                        make_td.innerHTML = "<input  class=\"btextsmallsize\"  type=\"text\" id=" + logohei + " Value=\"\" >";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (ds.Tables[0].Rows[i].Logo_W != null)
                        make_td.innerHTML = "<input  class=\"btextsmallsize\"   type=\"text\" id=" + logowid + " Value=" + ds.Tables[0].Rows[i].Logo_W + " >";
                    else
                        make_td.innerHTML = "<input  class=\"btextsmallsize\"  type=\"text\" id=" + logowid + " Value=\"\" >";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (ds.Tables[0].Rows[i].Logo_name != null)
                        make_td.innerHTML = "<input  class=\"dropdownforgrid\"  type=\"text\" id=" + logonam + " Value=" + ds.Tables[0].Rows[i].Logo_name + " >";
                    else
                        make_td.innerHTML = "<input  class=\"dropdownforgrid\"  type=\"text\" id=" + logonam + " Value=\"\" >";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }


            // for logo




            ////////                              showid="sho"+i; 
            ////////                             // str=str+"<td><input class=\"btextforgrid\" style=\"display:none;\" type=\"text\" id="+showid+"  value="+ds.Tables[0].Rows[i].insert_id+"></td>";
            ////////                              make_td=document.createElement("td");
            ////////                                    make_td.align="center";
            ////////                                    str="<input class=\"btextforgrid\"  disabled style=\"display:none;\" type=\"text\" id="+showid+"  value="+ds.Tables[0].Rows[i].insert_id+">";
            ////////                                     make_td.innerHTML=str;
            ////////                                     Make_Row.appendChild(make_td);
            var showid = "sho" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            str = "<input class=\"btextforgrid\" style=\"display:none;\" type=\"text\" id=" + showid + "  value='" + ds.Tables[0].Rows[i].insert_id + "'>";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);
            pkgcodegrid = 'hiddenpckcode' + i;
            //This is a hidden field in the insertion grid which holds the Package Code for internal processing only
            //str=str+"<td><input disabled class=\"btextsmallsize\" type=\"text\" id='"+pkgcodegrid+"' value="+ds.Tables[0].Rows[i].PACKAGE_CODE+"></td>";
            make_td = document.createElement("td");
            make_td.align = "center";
            str = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkgcodegrid + "' value='" + ds.Tables[0].Rows[i].PACKAGE_CODE + "'>";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);
            var pubcode = 'pubcode' + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pubcode + "' value='" + ds.Tables[0].Rows[i].PUBCODE + "'>";
            Make_Row.appendChild(make_td);

            var pkg_ins = 'pkg_ins' + i;
            //  str=str+"<td><input disabled class=\"btextsmallsize\" type=\"text\" id='"+pkg_ins+"' value="+ds.Tables[0].Rows[i].INSERTS+"></td>";
            make_td = document.createElement("td");
            make_td.align = "center";
            str = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_ins + "' value='" + ds.Tables[0].Rows[i].INSERTS + "'>";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);

            pkg_alias = 'pkg_alias' + i;
            // str=str+"<td><input disabled class=\"btextsmallsize\" type=\"text\" id='"+pkg_alias+"' value='"+ds.Tables[0].Rows[i].PKG_ALIAS+"'></td>";
            make_td = document.createElement("td");
            make_td.align = "center";
            str = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_alias + "' value='" + ds.Tables[0].Rows[i].PKG_ALIAS + "'>";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);
            // fro subediton and split
            var spltdata = "spltdata" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            str = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + spltdata + "' value=\"\">";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);


            var subedidata = "subedidata" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            str = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + subedidata + "' value=\"\">";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);

            var vat = "vat" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + vat + "' value='" + ds.Tables[0].Rows[i].VATAMT + "'>";
            Make_Row.appendChild(make_td);

            var boxc = "boxc" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].BOXCHARGE != "null" && ds.Tables[0].Rows[i].BOXCHARGE != null)
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + boxc + "' value='" + ds.Tables[0].Rows[i].BOXCHARGE + "'>";
            else
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + boxc + "' value=''>";
            Make_Row.appendChild(make_td);

            var vat_inc = "vat_inc" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].VAT_INC != "null" && ds.Tables[0].Rows[i].VAT_INC != null)
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + vat_inc + "' value='" + ds.Tables[0].Rows[i].VAT_INC + "'>";
            else
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + vat_inc + "' value=''>";
            Make_Row.appendChild(make_td);

            var coupan = "coupan" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].COUPON_AMOUNT != "null" && ds.Tables[0].Rows[i].COUPON_AMOUNT != null)
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + coupan + "' value='" + ds.Tables[0].Rows[i].COUPON_AMOUNT + "'>";
            else
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + coupan + "' value=''>";
            Make_Row.appendChild(make_td);

            var clicatamt = "clicatamt" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].CLIENT_CAT_D_AMT != "null" && ds.Tables[0].Rows[i].CLIENT_CAT_D_AMT != null)
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + clicatamt + "' value='" + ds.Tables[0].Rows[i].CLIENT_CAT_D_AMT + "'>";
            else
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + clicatamt + "' value=''>";
            Make_Row.appendChild(make_td);

            var flatfreqamt = "flatfreqamt" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].FLAT_FEQ_D_AMT != "null" && ds.Tables[0].Rows[i].FLAT_FEQ_D_AMT != null)
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + flatfreqamt + "' value='" + ds.Tables[0].Rows[i].FLAT_FEQ_D_AMT + "'>";
            else
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + flatfreqamt + "' value=''>";
            Make_Row.appendChild(make_td);

            var catamt = "catamt" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].CAT_D_AMT != "null" && ds.Tables[0].Rows[i].CAT_D_AMT != null)
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + catamt + "' value='" + ds.Tables[0].Rows[i].CAT_D_AMT + "'>";
            else
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + catamt + "' value=''>";
            Make_Row.appendChild(make_td);
            
            var GSTAMT = "GSTAMT" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].GSTAMT != "null" && ds.Tables[0].Rows[i].GSTAMT != null)
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + GSTAMT + "' value='" + ds.Tables[0].Rows[i].GSTAMT + "'>";
            else
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + GSTAMT + "' value=''>";
            Make_Row.appendChild(make_td);
            
            var GSTGD = "GSTGD" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].GSTGD != "null" && ds.Tables[0].Rows[i].GSTGD != null)
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + GSTGD + "' value='" + ds.Tables[0].Rows[i].GSTGD + "'>";
            else
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + GSTGD + "' value=''>";
            Make_Row.appendChild(make_td);
            
            // for binding edition for preview                                     
            if (document.getElementById('drpedition').options.length >= 1) {
                //                          objedition.options.length = 0; 
                //                          objedition.options[0]=new Option("-Select-","0");
                if (ds.Tables[0].Rows[i].Edition != undefined) {
                    document.getElementById('drpedition').options[document.getElementById('drpedition').options.length] = new Option(ds.Tables[0].Rows[i].Edition, ds.Tables[0].Rows[i].Edition);
                    document.getElementById('drpedition').options.length;
                }
            }
            if (ds.Tables[0].Rows[i].PUBTYPE == "IN0" && online_flag == false)
            { online_flag = true; }
            // for binding edition for preview      
            gridtab_vari.getElementsByTagName("tbody")[0].appendChild(Make_Row);
            //  str=str+"</td></tr>";

        }
        if (online_flag == true) {
            //   online_flag = false;
            document.getElementById('chkonline').disabled = false;
        }
        else {
            document.getElementById('chkonline').disabled = true;
        }
        //  str= str + "</table></div>";
        //  document.getElementById('tblinsert').innerHTML=str;
        commaenable();
        if (browserversion > 6) {
            $(".dropdownforgridsmall").change(function () {
                if (document.activeElement.id.indexOf("pai") >= 0) {
                    blankGross();
                }
            });
            $(".btextsmallsizeH").change(function () {
                if (document.activeElement.id.indexOf("prem") >= 0 || document.activeElement.id.indexOf("pgpre") >= 0 || document.activeElement.id.indexOf("nocol") >= 0 || document.activeElement.id.indexOf("hei") >= 0 || document.activeElement.id.indexOf("wid") >= 0 || document.activeElement.id.indexOf("ins") >= 0) {
                    var i;
                    if (document.activeElement.id.indexOf("disc_") >= 0) {
                        blankGross();
                    }
                    if (document.activeElement.id.indexOf("pgpre") >= 0) {
                        i = document.activeElement.id.substring(5, document.activeElement.id.length + 1);
                        var page = "pgpre" + i;
                        var pagstr = "sec";
                        var f = getpageprem(page, i, pagstr);
                        if (f == false)
                            return false;
                    }
                    else {
                        if (document.activeElement.id.indexOf("nocol") >= 0) {
                            i = document.activeElement.id.substring(5, document.activeElement.id.length + 1);

                        }
                        else {
                            i = document.activeElement.id.substring(3, document.activeElement.id.length + 1);

                        }
                        var height = "hei" + i;
                        var width = "wid" + i;
                        var inserts = "ins" + i;
                        var insertval = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(i, 10) + 1].cells[0].innerHTML;
                        var noofcol = "nocol" + i;
                        var f = gettotalsize(height, width, i, inserts, insertval, noofcol);
                        if (f == false)
                            return false;
                    }
                }
            });
            $(".btextforgriddate").change(function () {
                if (document.activeElement.id.indexOf("Text") >= 0) {
                    document.getElementById('txtgrossamt').value = "";
                    document.getElementById('txtbillamt').value = "";
                    document.getElementById('txtgrossamtlocal').value = "";
                    document.getElementById('txtbillamtlocal').value = "";
                    var f = chkDateforGrid(this);
                    if (f == false)
                        return false;
                }
                else if (document.activeElement.id.indexOf("rep") >= 0 || document.activeElement.id.indexOf("lat") >= 0) {
                    checkdate(document.getElementById(document.activeElement.id));
                }
            });
        }
        else {
            for (i = 0; i <= count; i++) {
                var id = "Text" + i;
                var noofcol = "nocol" + i;
                var height = "hei" + i;
                var width = "wid" + i;
                var late = "lat" + i;
                var repeat = "rep" + i;
                var latedate = "latdate" + i;
                var repeatdateI = "repdate" + i;
                var page = "pgpre" + i;
                var pagstr = "sec";
                var adcat = "adcat" + i;
                var adsubcat = "ads" + i;
                var height_var = document.getElementById(height);
                var par1 = (height_var.parentNode).parentNode;
                var inserts = "ins" + i;
                var paid = "pai" + i;
                var disc = "disc_" + i;
                var boldcount = "splboldsize" + i;
                var discrate1 = "disrat" + i;
                var insertval = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[i + 1].cells[0].innerHTML;
                if (browser != "Microsoft Internet Explorer") {
                    document.getElementById(height).onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                    document.getElementById(width).onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                    document.getElementById(noofcol).onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                    document.getElementById(late).onchange = new Function("return checkdate(Form1." + late + ");");
                    document.getElementById(repeat).onchange = new Function("return checkdate(Form1." + repeat + ");");
                    document.getElementById(page).onchange = new Function("return getpageprem(" + page + "," + i + ",'" + pagstr + "');");
                    document.getElementById(id).onchange = new Function("return chkDateforGrid(this);");
                    if (document.getElementById(paid) != undefined && document.getElementById(paid) != "undefined" && document.getElementById(paid) != null)
                        document.getElementById(paid).onchange = new Function("return blankGross();");
                    if (document.getElementById(boldcount) != undefined && document.getElementById(boldcount) != "undefined" && document.getElementById(boldcount) != null)
                        document.getElementById(boldcount).onchange = new Function("return boldcountingrid();");
                    if (document.getElementById(disc) != undefined && document.getElementById(disc) != "undefined" && document.getElementById(disc) != null)
                        document.getElementById(disc).onchange = new Function("return blankGross();");
                    if (document.getElementById(discrate1) != undefined && document.getElementById(discrate1) != "undefined" && document.getElementById(discrate1) != null)
                    document.getElementById(discrate1).onchange = new Function("return blankGross();");
                }
                else {
                    par1.all[height].onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                    par1.all[width].onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                    par1.all[noofcol].onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                    par1.all[late].onchange = new Function("return checkdate(Form1." + late + ");");
                    par1.all[repeat].onchange = new Function("return checkdate(Form1." + repeat + ");");
                    par1.all[page].onchange = new Function("return getpageprem(" + page + "," + i + ",'" + pagstr + "');");
                    par1.all[id].onchange = new Function("return chkDateforGrid(this);");
                    if (par1.all[paid] != undefined && par1.all[paid] != "undefined" && par1.all[paid] != null)
                        par1.all[paid].onchange = new Function("return blankGross();");
                    if (par1.all[boldcount] != undefined && par1.all[boldcount] != "undefined" && par1.all[boldcount] != null)
                        par1.all[boldcount].onchange = new Function("return boldcountingrid();");
                    if (par1.all[disc] != undefined && par1.all[disc] != "undefined" && par1.all[disc] != null)
                        par1.all[disc].onchange = new Function("return blankGross();");
                    if (par1.all[discrate1] != undefined && par1.all[discrate1] != "undefined" && par1.all[discrate1] != null)
                    par1.all[discrate1].onchange = new Function("return blankGross();"); 
                }

            }
        }

        arrangeArrayItems();


    }
    if (activeD == "btnDelete" && document.getElementById('tblinsert').innerHTML != "") {
        activeD = "";
        var y = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length;

        for (var i = 0; i < y - 1; i++) {
            if (document.getElementById("inssta" + i) != null && document.getElementById("inssta" + i).value == "booked") {
                document.getElementById("inssta" + i).value = "cancel";
                document.getElementById("txtgrossamt").value = "";
                document.getElementById('txtgrossamtlocal').value = "";
                document.getElementById('txtbillamtlocal').value = "";
            }
        }
    }
    tooltipadsubcat();

}



//////////////this is the function for dateformat as the dateformat likewise the date will be shown if id==1and if it is 0 than will return the 
///////date in mm/dd/yyyy format

function savedateinto(dat, id) {
    var sadate = dat;
    var setdate;
    var dateformat = document.getElementById('hiddendateformat').value;
    if (id == "0") {
        if (sadate != "") {
            if (dateformat == "mm/dd/yyyy") {
                return setdate = sadate;
            }
            if (dateformat == "dd/mm/yyyy") {
                var txt1 = sadate;
                var txt2 = txt1.split("/");
                var dd = txt2[0];
                var mm = txt2[1];
                var yy = txt2[2];
                return setdate = mm + '/' + dd + '/' + yy;
            }
            if (dateformat == "yyyy/mm/dd") {
                var txt1 = sadate;
                var txt2 = txt1.split("/");
                var yy = txt2[0];
                var mm = txt2[1];
                var dd = txt2[2];
                return setdate = mm + '/' + dd + '/' + yy;

            }
        }
    }
    if (id == "1") {
        var currdate = new Date(sadate);


        var dd = currdate.getDate();
        var mm = currdate.getMonth() + 1;
        var yyyy = currdate.getFullYear();
        if (mm.toString().length == 1)
            mm = "0" + mm;
        if (dd.toString().length == 1)
            dd = "0" + dd;
        var currdate1 = mm + '/' + dd + '/' + yyyy;
        var currda = dd + '/' + mm + '/' + yyyy;
        var curryear = yyyy + '/' + mm + '/' + dd;

        if (dateformat == "mm/dd/yyyy") {
            return currdate1;

        }
        else if (dateformat == "dd/mm/yyyy") {
            return currda;

        }
        if (dateformat == "yyyy/mm/dd") {
            return curryear;

        }



    }


}

///////////////////////////////////////////////////////////////////////////////////////////
//this function is called to fill the ad s cat for grid on change of ad cat

function filladsubgrid(adcat, adsubcat) {
    var len = "bookdiv";
    var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    var i;
    var compcode = document.getElementById('hiddencompcode').value;
    var adcategory = adcat.value;
    if (adcategory == "0") {
        //  alert("Please select the value");
        return false;
    }
    objadscat = adsubcat;
    Classified_Booking.getadsubcat(compcode, adcategory, call_filladscat)
}

function call_filladscat(res) {
    var ds = res.value;
    objadscat.options.length = 0;
    objadscat.options[0] = new Option("-Select-", "0");
    //alert(pkgitem.options.length);
    objadscat.options.length = 1;
    for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
        objadscat.options[objadscat.options.length] = new Option(ds.Tables[0].Rows[i].Adv_Subcat_Name, ds.Tables[0].Rows[i].Adv_Subcat_Code);

        objadscat.options.length;
    }
    document.getElementById('drpadcat3').options.length = 0;
    document.getElementById('drpadcat4').options.length = 0;
    document.getElementById('drpadcat5').options.length = 0;
    //////////////////this is to bind the ad s cat  of grid on change of ad category
    /*  if(document.getElementById('tblinsert').innerHTML!="")
    {
    var len="bookdiv";
    var y=document.getElementById(len).getElementsByTagName('table')[0].rows.length;  
    var k;
    var adsubcat;
    var i=0;
 
    for(k=0;k<y-1;k++)
    {
    while(document.getElementById("card"+i)==null)
    {
    i=i+savtotid;
    }
    adsubcat="ads"+i;
    var gridadscat=document.getElementById(adsubcat)
    //alert(gridadscat.options.length);
    gridadscat.options.length = 0; 
    gridadscat.options[0]=new Option("-Select-","0");
    
    gridadscat.options.length = 1; 
                        
    for (var z = 0  ; z < ds.Tables[0].Rows.length; ++z)
    {
    gridadscat.options[gridadscat.options.length] = new Option(ds.Tables[0].Rows[z].Adv_Subcat_Name,ds.Tables[0].Rows[z].Adv_Subcat_Code);
        
    gridadscat.options.length;
       
    }
    i=parseInt(i)+1;
                 
    }             
        
    } */

}
////////////////////this is the function to bind the ad s cat on change of ad cat from main form


function filladsubcatmain() {
    var compcode = document.getElementById('hiddencompcode').value;
    var adcategory = document.getElementById('drpadcategory').value;
    if (adcategory == "0") {
        //  alert("Please select the value");
        document.getElementById('drpadsubcategory').options.length = 0;
        document.getElementById('drpadcat3').options.length = 0;
        document.getElementById('drpadcat4').options.length = 0;
        document.getElementById('drpadcat5').options.length = 0;
        return false;
    }
    var res = Classified_Booking.getRegClientCheck(adcategory);
    var dx = res.value;
    if (dx != null && dx.Tables[0] != null && dx.Tables[0] != undefined) {
        if (dx.Tables[0].Rows.length > 0) {
            if (dx.Tables[0].Rows[0].REGCLIENT == "Y") {
                if (document.getElementById('txtclient').value.lastIndexOf('(') < 0) {
                    alert("For Category " + document.getElementById('drpadcategory').options[document.getElementById('drpadcategory').selectedIndex].text + ", You can take only Registered Client");
                    document.getElementById('txtclient').focus();
                    return false;
                }
            }
            if (dx.Tables[0].Rows[0].DISC_AMT != null && dx.Tables[0].Rows[0].DISC_AMT != "") {
                document.getElementById('txtcatdisc').value = dx.Tables[0].Rows[0].DISC_AMT;
                document.getElementById('hdncatdisctype').value = dx.Tables[0].Rows[0].DISC_TY;
            }
        }
    }
    objadscat = document.getElementById('drpadsubcategory');
    Classified_Booking.getadsubcat(compcode, adcategory, call_filladscat);
    //////this is to chk that whether grid is visible than on change of ad cat from main it effects into the grid also
    var adcatval = document.getElementById('drpadcategory').value;
    if (document.getElementById('tblinsert').innerHTML != "") {
        var len = "bookdiv";
        var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
        var k;
        var adcat;
        var i = 0;

        for (k = 0; k < y - 1; k++) {

            adcat = "adcat" + i;
            var adcat_vari = document.getElementById(adcat);
            var par1 = (adcat_vari.parentNode).parentNode;
            adcat_vari.value = adcatval;
            adsubcat = "ads" + i;
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById(adsubcat).value = "";
            }
            else {
                par1.all[adsubcat].value = "";
            }
            i = parseInt(i) + 1;
        }
    }

    bindrategroupvode(adcategory);

    return false;
}
////change by bhanu for revise ratecode///
function bindrategroupcodeforreviserate() {
    var bookingdate = document.getElementById('txtdatetime').value;
    var rodate = document.getElementById('txtrevisedate').value;
    var dateformat = document.getElementById('hiddendateformat').value;
    if (dateformat == "mm/dd/yyyy") {
        var validformat = /^\d{2}\/\d{2}\/\d{4}$/ //Basic check for format validity

    }
    if (dateformat == "yyyy/mm/dd") {
        var validformat = /^\d{4}\/\d{2}\/\d{2}$/ //Basic check for format validity
    }
    if (dateformat == "dd/mm/yyyy") {
        var validformat = /^\d{2}\/\d{2}\/\d{4}$/ //Basic check for format validity
    }

    if (!validformat.test(document.getElementById('txtrevisedate').value)) {
        if (document.getElementById('txtrevisedate').value == "") {
            return true;
        }
        setTimeout(settime12, 15);
        daid = document.getElementById('txtrevisedate');
        return;
    }


    if (dateformat == "yyyy/mm/dd") {
        var yearfield = bookingdate.split("/")[0]
        var monthfield = bookingdate.split("/")[1]
        var dayfield = bookingdate.split("/")[2]
        var bookdate = new Date(yearfield, monthfield - 1, dayfield)
    }
    if (dateformat == "mm/dd/yyyy") {
        var yearfield = bookingdate.split("/")[2]
        var monthfield = bookingdate.split("/")[0]
        var dayfield = bookingdate.split("/")[1]
        //var dayobj = new Date(monthfield-1, dayfield, yearfield)
        var bookdate = new Date(yearfield, monthfield - 1, dayfield)

    }
    if (dateformat == "dd/mm/yyyy") {
        var yearfield = bookingdate.split("/")[2]
        var monthfield = bookingdate.split("/")[1]
        var dayfield = bookingdate.split("/")[0]
        //var dayobj = new Date(dayfield, monthfield-1, yearfield)
        var bookdate = new Date(yearfield, monthfield - 1, dayfield)
    }

    if (dateformat == "yyyy/mm/dd") {
        var yearfield = rodate.split("/")[0]
        var monthfield = rodate.split("/")[1]
        var dayfield = rodate.split("/")[2]
        var rdate = new Date(yearfield, monthfield - 1, dayfield)
    }
    if (dateformat == "mm/dd/yyyy") {
        var yearfield = rodate.split("/")[2]
        var monthfield = rodate.split("/")[0]
        var dayfield = rodate.split("/")[1]
        //var dayobj = new Date(monthfield-1, dayfield, yearfield)
        var rdate = new Date(yearfield, monthfield - 1, dayfield)

    }
    if (dateformat == "dd/mm/yyyy") {
        var yearfield = rodate.split("/")[2]
        var monthfield = rodate.split("/")[1]
        var dayfield = rodate.split("/")[0]
        //var dayobj = new Date(dayfield, monthfield-1, yearfield)
        var rdate = new Date(yearfield, monthfield - 1, dayfield)
    }

    var abcd = rdate.getMonth() + 1;

    var date1 = rdate.getDate();
    var year1 = rdate.getFullYear();
    if ((abcd != monthfield) || (date1 != dayfield) || (year1 != yearfield)) {
        alert(" Please Fill The Date In " + dateformat + " Format");
        input.value = "";
        return false;
    }

    if (rdate > bookdate) {
        alert("Revise date should be lesser or equal to Booking date");
        document.getElementById('txtrevisedate').value = "";
        return false;
    }
    if (document.getElementById('drpadcategory').value == "0") {
        alert("Please Select Ad Category");
        return false;
    }
    var dateformat = document.getElementById('hiddendateformat').value;
    var revisedate = "";
    if (document.getElementById('txtrevisedate').value != "") {
        if (dateformat == "mm/dd/yyyy") {
            revisedate = document.getElementById('txtrevisedate').value;
        }
        if (dateformat == "dd/mm/yyyy") {
            var txt1 = document.getElementById('txtrevisedate').value;
            var txt2 = txt1.split("/");
            var dd = txt2[0];
            var mm = txt2[1];
            var yy = txt2[2];
            revisedate = mm + '/' + dd + '/' + yy;
        }
        if (dateformat == "yyyy/mm/dd") {
            var txt1 = document.getElementById('txtrevisedate').value;
            var txt2 = txt1.split("/");
            var yy = txt2[0];
            var mm = txt2[1];
            var dd = txt2[2];
            revisedate = mm + '/' + dd + '/' + yy;

        }
    }
    Classified_Booking.bindratecodeforreviserate(document.getElementById('drpadcategory').value, document.getElementById('hiddencompcode').value, revisedate, call_bindrategroupvode);
    return false;
}
///end by bhanu
/////////this is to bind the rate code drp down

function bindrategroupvode(adcat) {
    if (document.getElementById('configclient').value == "SP") {
        Classified_Booking.bindratecode(adcat, document.getElementById('hiddencompcode').value, call_bindrategroupvode);
    }
    else {
        Classified_Booking.bindratecodecenterwise(adcat, document.getElementById('hiddencompcode').value, document.getElementById('txtbranch').value, document.getElementById('txtdatetime').value, document.getElementById('hiddendateformat').value, document.getElementById('drpuom').value, call_bindrategroupvode);
    }
    return false;
}

function call_bindrategroupvode(response) {
    var ds = response.value;
    var pkgitem = document.getElementById("txtratecode");
    pkgitem.options.length = 0;
    pkgitem.options[0] = new Option("-Select", "0");
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {
        pkgitem.options.length = 1;
        for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].rate_mast_code, ds.Tables[0].Rows[i].rate_mast_code);

            pkgitem.options.length;
        }

    }
    var ds = response.value;
    var pkgitem = document.getElementById("drpbullet");
    pkgitem.options.length = 0;
    pkgitem.options[0] = new Option("-Select", "0");
    if (ds != null && typeof (ds) == "object" && ds.Tables[1].Rows.length > 0) {
        pkgitem.options.length = 1;
        for (var i = 0; i < ds.Tables[1].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[1].Rows[i].Bullet_Desc, ds.Tables[1].Rows[i].Bullet_Code);

            pkgitem.options.length;
        }

    }
    document.getElementById('txtbullprem').value = "";
    if (document.getElementById("txtratecode").options.length == 2)
        document.getElementById("txtratecode").options[1].selected = true;
    document.getElementById('hiddenratecode').value = document.getElementById("txtratecode").value;

}


/////this function is to chk the duplicacy of agency 

function chkagency() {
    if (document.getElementById('txtproduct').value == "")
        document.getElementById('drpbrand').value = "";
    var agency = "0";
    var product = "0";
    var execname = "0";
    var retainer = "0";
    var compcode = document.getElementById('hiddencompcode').value;
    if (document.activeElement.id == "txtagency") {
        agency = document.getElementById('txtagency').value;
        if (agency != "") {
            var res = Classified_Booking.chkagencycode(agency, compcode, product, execname, retainer);
            var ds = res.value;
            if (ds == null)
                return false;
            if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0)
            { }
            else {
                alert('This name doesnt exists');
                document.getElementById('txtagency').value = "";
                document.getElementById('txtagency').focus();
                return false;
            }

        }
    }
    if (document.activeElement.id == "drpproductcat") {
        product = document.getElementById('drpproductcat').value;
        if (product != "") {
            var res = Classified_Booking.chkagencycode(agency, compcode, product, execname, retainer);
            var ds = res.value;
            if (ds == null)
                return false;
            if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0)
            { }
            else {
                alert('This name doesnt exists');
                document.getElementById('drpproductcat').value = "";
                document.getElementById('drpproductcat').focus();
                return false;
            }

        }
    }
    if (document.activeElement.id == "txtexecname") {
        execname = document.getElementById('txtexecname').value;
        if (execname != "") {
            var res = Classified_Booking.chkagencycode(agency, compcode, product, execname, retainer);
            var ds = res.value;
            if (ds == null)
                return false;
            if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0)
            { }
            else {
                alert('This name doesnt exists');
                document.getElementById('txtexecname').value = "";
                document.getElementById('txtexecname').focus();
                return false;
            }

        }
    }
    if (document.activeElement.id == "drpretainer") {
        retainer = document.getElementById('drpretainer').value;
        if (retainer != "") {
            var res = Classified_Booking.chkagencycode(agency, compcode, product, execname, retainer);
            var ds = res.value;
            if (ds == null)
                return false;
            if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0)
            { }
            else {
                alert('This name doesnt exists');
                document.getElementById('drpretainer').value = "";
                document.getElementById('drpretainer').focus();
                return false;
            }

        }
    }


    //return false;   
}

function call_chkagency(res) {
    var ds = res.value;
    if (ds == null)
        return false;
    if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0)
    { }
    else {
        alert('This name doesnt exists');
        var idrem = document.activeElement.id;
        document.getElementById(idrem).value = "";
        document.getElementById(idrem).focus();
        return false;
    }
}

function disbledinsertion() {
    if (document.getElementById('chktfn').checked == true) {
        if (document.getElementById('drppackagecopy').options.length == 0) {
            alert("Please fill package");
            document.getElementById('drppackage').focus();
            return false;
        }
        else if (document.getElementById('txtrepeatingdate').value == "") {
            alert("Please fill repeating day");
            if (document.getElementById('txtrepeatingdate').disabled == false) {

                document.getElementById('txtrepeatingdate').focus();
            }
            return false;

        }
        document.getElementById('txtinsertion').disabled = true;
        var tfnval = document.getElementById('hiddentfn').value;
        var repdate = document.getElementById('txtrepeatingdate').value;

        if (parseInt(repdate) > parseInt(tfnval)) {
            alert("Repeating days cannot be greater than TFN");
            return false;
        }

        var totval = parseInt(tfnval) / parseInt(repdate)
        document.getElementById('txtinsertion').value = parseInt(totval);
        onInsertionChange('');

    }
    else {
        document.getElementById('txtinsertion').disabled = false;
    }

}


function getpageamt() {
    document.getElementById('txtpospremdisc').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    if (document.getElementById('drppackagecopy').options.length == 0) {
        alert("Please fill package");
        return false;
    }
    var pagename = document.getElementById('drppageposition').value;
    var compcode = document.getElementById('hiddencompcode').value;
    var bookdate = document.getElementById('txtdatetime').value;
    if (pagename == "0") {
        document.getElementById('txtpageamt').value = "";
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
    }
    var res = Classified_Booking.getpageamount(pagename, compcode, bookdate, document.getElementById('hiddendateformat').value);
    call_getpageamt(res);


}

function call_getpageamt(res) {
    var ds = res.value;
    document.getElementById('txtpageamt').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    if (ds.Tables[0].Rows.length > 0) {
        document.getElementById('txtpageamt').value = ds.Tables[0].Rows[0].Amount
        var len = "bookdiv";
        var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
        var i = 0;
        var k;
        var page;
        var pagstr = "sec";
        var pagename = document.getElementById('drppageposition').value;
        for (k = 0; i < y - 1; k++) {

            page = document.getElementById("pgpre" + i);
            if (document.getElementById("pgpre" + i) != null)
                page.value = pagename; //document.getElementById('drppageposition').options[document.getElementById('drppageposition').selectedIndex].value;            
            if (document.getElementById("pagper" + i) != null)
                document.getElementById("pagper" + i).value = document.getElementById('txtpageamt').value;
            i++;
        }
    }
    else {
        var len = "bookdiv";
        var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
        var i = 0;
        var k;
        for (k = 0; i < y - 1; k++) {
            var pagename = document.getElementById('drppageposition').value;
            if (pagename == 0)
                pagename = "";
            var page = document.getElementById("pgpre" + i);
            if (document.getElementById("pgpre" + i) != null)
                page.value = pagename;
            if (document.getElementById("pagper" + i) != null)
                document.getElementById("pagper" + i).value = "";
            i++;
        }
    }
    if (document.getElementById('tblinsert').innerHTML != "") {
        flagins = "0";
    }

}

////this is the function cretaed when we select the ad sub cat from the iserts line than it will effect on its item lines
/////and also chk tahat whether taht package is cretaed 

function getvalueintoinserts(id, insval, no) {
    var idval = id.value;
    var getint = id.id.split("ads");
    var z = getint[1];
    var adsubcat;
    var inserts;
    var tot = parseInt(fillinsert) / parseInt(document.getElementById('txtinsertion').value);
    var i = z;
    var k;
    var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)

    if (z % noofinsertlo == 0) {
        var x = parseInt(z) + parseInt(noofinsertlo);
        i = z;
        for (k = 0; k < noofinsertlo; k++) {
            while (document.getElementById("card" + i) == null) {
                i = parseInt(i) + parseInt(totid);
            }
            adsubcat = "ads" + i;
            document.getElementById(adsubcat).value = idval;
            i = parseInt(i) + 1;
        }
    }
    else if (z >= noofinsertlo) {
        var x = parseInt(z) + parseInt(noofinsertlo);
        var modval = z % noofinsertlo;
        var totmod = parseInt(z) - parseInt(modval);
        i = totmod;
        for (k = 0; k < noofinsertlo; k++) {
            while (document.getElementById("card" + i) == null) {
                i = parseInt(i) + parseInt(totid);
            }

            adsubcat = "ads" + i;
            document.getElementById(adsubcat).value = idval;
            i = parseInt(i) + 1;
        }
    }
    else if (z < noofinsertlo) {
        var modval = noofinsertlo % z;
        var totmod = parseInt(z) - parseInt(modval);
        i = totmod;
        for (k = 0; k < noofinsertlo; k++) {
            while (document.getElementById("card" + i) == null) {
                i = parseInt(i) + parseInt(totid);
            }

            adsubcat = "ads" + i;
            document.getElementById(adsubcat).value = idval;
            i = parseInt(i) + 1;
        }
    }
}

///this is to get the gross amount as the user fill thw width
function getgrossamt(id, insval, no) {
    var idval = id.value;
    var gross;
    var agreed;
    var totarea;
    var getint = id.split("wid");
    var z = getint[1];
    var paid;
    var inserts;
    var tot = parseInt(fillinsert) / parseInt(document.getElementById('txtinsertion').value);
    var i;
    var i = z;
    var k;
    var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
    if (z % noofinsert == 0) {
        var x = parseInt(z) + parseInt(noofinsert);
        for (k = z; k < x; k++) {
            while (document.getElementById("card" + i) == null && i < x) {
                i = parseInt(i) + parseInt(totid);
            }
            if (i >= x) {
                break;
            }
            agreed = "agr" + i;
            gross = "gro" + i;
            totarea = "siz" + i;
            var totgross = parseFloat(document.getElementById(totarea).value) * parseFloat(document.getElementById(agreed).value)
            document.getElementById(gross).value = totgross.toFixed(2);
            i = parseInt(i) + 1;
        }
    }
    else if (z >= noofinsert) {
        var x = parseInt(z) + parseInt(noofinsert);
        var modval = z % noofinsert;
        var totmod = parseInt(z) - parseInt(modval);
        i = totmod;
        var tomax = parseInt(totmod) + parseInt(noofinsert);
        for (k = totmod; k < tomax; k++) {
            while (document.getElementById("card" + i) == null && i < tomax) {
                i = parseInt(i) + parseInt(totid);

            }

            if (i >= tomax) {
                break;
            }


            agreed = "agr" + i;
            gross = "gro" + i;
            totarea = "siz" + i;
            var totgross = parseFloat(document.getElementById(totarea).value) * parseFloat(document.getElementById(agreed).value)
            document.getElementById(gross).value = totgross.toFixed(2);
            i = parseInt(i) + 1;
        }

    }
    else if (z < noofinsert) {
        i = 0;
        for (k = 0; k < noofinsert; k++) {
            while (document.getElementById("card" + i) == null && i < noofinsert) {
                i = parseInt(i) + parseInt(totid);
            }

            if (i >= noofinsert) {
                break;
            }

            agreed = "agr" + i;
            gross = "gro" + i;
            totarea = "siz" + i;
            var totgross = parseFloat(document.getElementById(totarea).value) * parseFloat(document.getElementById(agreed).value)
            document.getElementById(gross).value = totgross.toFixed(2);
            i = parseInt(i) + 1;
        }

    }
}


///// this is to fill the color into the inserts line

function getvalueintoinsertsforcolor(id, insval, no) {
    var idval = id.value;
    var colid;
    var getint = id.id.split("col");
    var z = getint[1];
    var adsubcat;
    var inserts;
    var tot = parseInt(fillinsert) / parseInt(document.getElementById('txtinsertion').value);
    var i = 0;
    var k;
    var i = z;
    var k;
    var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
    if (z % noofinsertlo == 0) {
        var x = parseInt(z) + parseInt(noofinsertlo);
        i = z;
        for (k = 0; k < noofinsertlo; k++) {
            while (document.getElementById("card" + i) == null) {
                i = parseInt(i) + parseInt(totid);
            }
            colid = "col" + i;
            document.getElementById(colid).value = idval;
            i = parseInt(i) + 1;
        }
    }
    else if (z >= noofinsertlo) {
        var x = parseInt(z) + parseInt(noofinsertlo);
        var modval = z % noofinsertlo;
        var totmod = parseInt(z) - parseInt(modval);
        i = totmod;
        for (k = 0; k < noofinsertlo; k++) {
            while (document.getElementById("card" + i) == null) {
                i = parseInt(i) + parseInt(totid);
            }
            colid = "col" + i;
            document.getElementById(colid).value = idval;
            i = parseInt(i) + 1;
        }

    }
    else if (z < noofinsertlo) {
        var modval = noofinsertlo % z;
        var totmod = parseInt(z) - parseInt(modval);
        i = totmod;
        for (k = 0; k < noofinsertlo; k++) {
            while (document.getElementById("card" + i) == null) {
                i = parseInt(i) + parseInt(totid);
            }
            colid = "col" + i;
            document.getElementById(colid).value = idval;
            i = parseInt(i) + 1;
        }
    }

}

///this is to chk whether the value selected in the grid has a valid package or not

function checkadsubcat(val) {
    var adtype = "CL0";
    var color = document.getElementById('drpcolor').value;
    var adcat = document.getElementById('drpadcategory').value;
    var adsucat = document.getElementById(val).value;
    var currency = document.getElementById('drpcurrency').value;
    var ratecode = document.getElementById('txtratecode').value;
    var package1 = document.getElementById('drppackage').value;
    var dateformat = document.getElementById('hiddendateformat').value;
    var selecdate;


    if (document.getElementById('txtdummydate').value != "") {
        if (dateformat == "mm/dd/yyyy") {
            selecdate = document.getElementById('txtdummydate').value;
        }
        if (dateformat == "dd/mm/yyyy") {
            var txt1 = document.getElementById('txtdummydate').value;
            var txt2 = txt1.split("/");
            var dd = txt2[0];
            var mm = txt2[1];
            var yy = txt2[2];
            selecdate = mm + '/' + dd + '/' + yy;
        }
        if (dateformat == "yyyy/mm/dd") {
            var txt1 = document.getElementById('txtdummydate').value;
            var txt2 = txt1.split("/");
            var yy = txt2[0];
            var mm = txt2[1];
            var dd = txt2[2];
            selecdate = mm + '/' + dd + '/' + yy;

        }
    }
    else {
        selecdate = "";
    }

    Classified_Booking.getratevalue(adtype, color, adcat, adsucat, currency, ratecode, package1, selecdate, document.getElementById('hiddencompcode').value, document.getElementById('drpuom').value, call_checkadsubcat);

}

function call_checkadsubcat(res) {
    var ds = res.value;
    var flagrate;
    if (ds.Tables[0].Rows.length > 0) {
        flagrate = "1";
        return flagrate;
    }
    else {
        flagrate = "0";
        return flagrate;
    }

}
////////////////this function is called when we open the list box of agency than on mouse click it get the agency

function insertagency() {
    if (document.activeElement.id == "lstbarter") {
        if (document.getElementById('lstbarter').value == "0") {
            alert("Please select Barter Type");
            document.getElementById('txtbartertype').value = "";
            document.getElementById('hiddenbarteramt').value = "";
            document.getElementById('hiddenstopbarterbooking').value = "";

            return false;
        }
        document.getElementById("divbarter").style.display = "none";

        var bartervalue = document.getElementById('lstbarter').value;
        if (bartervalue != "") {
            document.getElementById('hiddenbarteramt').value = bartervalue.split('û')[1];
            document.getElementById('hiddenstopbarterbooking').value = bartervalue.split('û')[2];
            var bame = document.getElementById('lstbarter').options[document.getElementById('lstbarter').selectedIndex].text + '(' + bartervalue.split('û')[0] + ')';
            document.getElementById('txtbartertype').value = bame;
        }
        document.getElementById('txtbartertype').focus();

        return false;
    }
    else if (document.activeElement.id == "lstrevenuecenternew") {
        if (document.getElementById('lstrevenuecenternew').value == "0") {
            alert("Please select Revenue Center");
            document.getElementById('txtrevenuecenternew').value = "";
            document.getElementById('hdnrevenuecenternew').value = "";
           // document.getElementById('txtbranch').value = "";
            return false;
        }
        document.getElementById("divrevenuecenternew").style.display = "none";

        var bartervalue = document.getElementById('lstrevenuecenternew').value;
        if (bartervalue != "") {
            document.getElementById('hdnrevenuecentcd').value = bartervalue.split('~')[1];
            document.getElementById('txtrevenuecenternew').value = bartervalue.split('~')[0];
          //  document.getElementById('txtbranch').value = bartervalue.split('~')[2];
        }
        document.getElementById('txtagency').focus();

        return false;
    }
    else if (document.activeElement.id == "lstreference") {
        if (document.getElementById('lstreference').value == "0") {
            alert("Please Select Reference ID");
            document.getElementById('txtreference').value = "";
            return false;
        }
        document.getElementById("divreference").style.display = "none";
        var refvalue = document.getElementById('lstreference').value;
        if (refvalue != "") {
            var bame = document.getElementById('lstreference').options[document.getElementById('lstreference').selectedIndex].text;
            document.getElementById('txtreference').value = bame;
        }
        document.getElementById('txtreference').focus();
        return false;
    }
    else if (document.activeElement.id == "lstbrand") {
            if (document.getElementById('lstbrand').value == "0") {
                alert("Please Select Brand");
                document.getElementById('drpbrand').value = "";
                return false;
            }
            document.getElementById("divbrand").style.display = "none";
            var refvalue = document.getElementById('lstbrand').value;
            if (refvalue != "") {
                var bame = document.getElementById('lstbrand').options[document.getElementById('lstbrand').selectedIndex].text+ '(' + refvalue + ')';
                document.getElementById('drpbrand').value = bame;
                document.getElementById('hiddenbrand').value =bame;
            }
          //            var ext1 = "";
//            var ext2 = "";
//            var ext3 = "";
//            var ext4 = "";
//            var ext5 = "";
//            var resc = Classified_Booking.bindbrandproduct(document.getElementById('hiddencompcode').value, refvalue , ext1,ext2,ext3,ext4,ext5);
//            if (resc.value == null){
//                alert(resc.error.description);
//                return false;
//            }
//                if (resc.value.Tables[0].Rows.length > 0) {
//                    document.getElementById('txtproduct').value=resc.value.Tables[0].Rows[0].PRODUCTCODE;
            //                }           
            bindvarient();             
            document.getElementById('drpbrand').focus();
            return false;
        }
         /////////////////////////////////anuja///////////////////
        else if (document.activeElement.id == "lstprosubcat") {
            //            if (document.getElementById('lstprosubcat').value == "0") {
            //                alert("Please Select Product Subcat");
            //                document.getElementById('txtproduct').value = "";
            //                return false;
            //            }
            document.getElementById("divprosucat").style.display = "none";
            var refvalue = document.getElementById('lstprosubcat').value;
            if (refvalue != "") {
                var bame = document.getElementById('lstprosubcat').options[document.getElementById('lstprosubcat').selectedIndex].text + '(' + refvalue + ')';
                document.getElementById('txtproduct').value = bame;
                document.getElementById('hdnprosubcat').value = bame;
            }

            document.getElementById('txtproduct').focus();
            return false;
        }
        else if (document.activeElement.id == "lstindus") {
            if (document.getElementById('lstindus').value == "0") {
                alert("Please Select Industry");
                document.getElementById('txtindustry').value = "";
                return false;
            }
            document.getElementById("divindus").style.display = "none";
            var refvalue = document.getElementById('lstindus').value;
            if (refvalue != "") {
                var bame = document.getElementById('lstindus').options[document.getElementById('lstindus').selectedIndex].text + '(' + refvalue + ')';
                document.getElementById('txtindustry').value = bame;
                document.getElementById('hdnindus').value = refvalue;
            }


            bindprodcat();
            document.getElementById('txtindustry').focus();
            return false;
        }
        //////////////////////////////////////////////////////////
    else if (document.activeElement.id == "lstcirrate") {
        if (document.getElementById('lstcirrate').value == "0") {
            alert("Please select the Cir. Rate");
            return false;
        }
        document.getElementById("divcirrate").style.display = "none";

        var page = document.getElementById('lstcirrate').value;
        document.getElementById('hiddencirpub').value = trim(page.toString().split('+')[0]);
        //   document.getElementById('hiddenciredi').value=trim(page.toString().split('+')[1].split('(')[0]);
        var pagename = document.getElementById('lstcirrate').options[document.getElementById('lstcirrate').selectedIndex].text.split('+');

        //   document.getElementById('txtciredition').value=trim(pagename[1].toString()).split('(')[0];
        //   document.getElementById('txtcirrate').value=trim(pagename[1].toString()).split('(')[1].replace(')','');
        if (pagename[1].toString().lastIndexOf("(") >= 0) {
            document.getElementById('txtcirrate').value = pagename[1].toString().substring(pagename[1].toString().lastIndexOf("(") + 1, pagename[1].toString().length - 1);
            document.getElementById('txtciredition').value = pagename[1].toString().substring(0, pagename[1].toString().lastIndexOf("(") - 1);
            document.getElementById('hiddenciredi').value = document.getElementById('txtciredition').value;
        }
        document.getElementById('txtcirrate').focus();

        return false;
    }
    else if (document.activeElement.id == "lstcolexec") {
        if (document.getElementById('lstcolexec').value == "0") {
            alert("Please select the Collection Executive");
            return false;
        }
        document.getElementById("divcolexec").style.display = "none";
        var page1 = document.getElementById('lstcolexec').options[document.getElementById('lstcolexec').selectedIndex].text + '(' + document.getElementById('lstcolexec').value + ')';
        document.getElementById('txtcolexec').value = page1;
        document.getElementById('txtcolexec').focus();
        return false;
    }
    else if (document.activeElement.id == "lstciragency") {
        if (document.getElementById('lstciragency').value == "0") {
            alert("Please select the Cir. Agency");
            return false;
        }
        document.getElementById("divciragency").style.display = "none";

        var page = document.getElementById('lstciragency').value;





        document.getElementById('txtciragency').value = page;

        document.getElementById('txtciragency').focus();

        return false;
    }
    else if (document.activeElement.id == "lstclient") {
        if (document.getElementById('lstclient').value == "0") {
            alert("Please select the client");
            return false;
        }
        document.getElementById("divclient").style.display = "none";
        var datetime = document.getElementById('txtdatetime').value;
        //alert(document.getElementById('lstagency').value);
        /*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        this is the page which is designed to get the name as well as the add ress of client if 0 than client name and 
        address and if 0 than agency name and address
        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@22222*/

        var page = document.getElementById('lstclient').value;

        var id = "";

        if (browser != "Microsoft Internet Explorer") {
            var httpRequest = null; ;
            httpRequest = new XMLHttpRequest();
            if (httpRequest.overrideMimeType) {
                httpRequest.overrideMimeType('text/xml');
            }

            httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

            httpRequest.open("GET", "clientName.aspx?page=" + page + "&adtype=" + "CL0" + "&datetime=" + datetime + "&value=1", false);
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) {
                    id = httpRequest.responseText;
                }
                else {
                    alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                    return false;
                }
            }
            else {
                alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                return false;
            }
        }
        else {
            var xml = new ActiveXObject("Microsoft.XMLHTTP");
            xml.Open("GET", "clientName.aspx?page=" + page + "&adtype=" + "CL0" + "&datetime=" + datetime + "&value=1", false);
            xml.Send();
            id = xml.responseText;
        }
        if (id == "yes") {
            alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
            return false;
        }
        var split = id.split("+");
        var namecode = split[0];
        var add = split[1];
        if (document.getElementById("div4").style.display == "block")
            document.getElementById("div4").style.display = "none";

        document.getElementById('txtclient').value = namecode;
        if (document.getElementById('hiddensavemod').value == "0" || document.getElementById('hiddensavemod').value == "01") {
            document.getElementById('txtclientadd').value = add;

            document.getElementById('txtclientadd').focus();
        }
        bind_agen_bill();
        disbledroandcredit();

        return false;
    }
    else if (document.activeElement.id == "lstagency") {
        if (document.getElementById('lstagency').value == "0") {
            alert("Please select the agency sub code");
            return false;
        }
        document.getElementById("div1").style.display = "none";
        var datetime = document.getElementById('txtdatetime').value;
        //alert(document.getElementById('lstagency').value);

        //alert(document.getElementById('lstagency').value);
        /*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        this is the page which is designed to get the name as well as the add ress of client if 0 than client name and 
        address and if 0 than agency name and address
        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@22222*/

        var page = document.getElementById('lstagency').value;
        agencycodeglo = page;

        var id = "";

        if (browser != "Microsoft Internet Explorer") {
            var httpRequest = null; ;
            httpRequest = new XMLHttpRequest();
            if (httpRequest.overrideMimeType) {
                httpRequest.overrideMimeType('text/xml');
            }

            httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

            httpRequest.open("GET", "clientName.aspx?page=" + page + "&adtype=" + "CL0" + "&datetime=" + datetime + "&value=0", false);
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) {
                    id = httpRequest.responseText;
                }
                else {
                    alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                    return false;
                }
            }
        }
        else {
            var xml = new ActiveXObject("Microsoft.XMLHTTP");
            xml.Open("GET", "clientName.aspx?page=" + page + "&adtype=" + "CL0" + "&datetime=" + datetime + "&value=0", false);
            xml.Send();
            id = xml.responseText;
        }
        if (id == "yes") {
            alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
            return false;
        }
        var split = id.split("+");
        var nameagen = split[0];
        var agenadd = split[1];



        document.getElementById('txtagency').value = nameagen;
        document.getElementById('hiddenagency').value = document.getElementById('lstagency').value;
        if (document.getElementById('hiddensavemod').value == "0" || document.getElementById('hiddensavemod').value == "01") {
            document.getElementById('txtagencyaddress').value = agenadd;
            if (clientfromconfig == "UD")
                document.getElementById('drpregular').focus();
            else
                document.getElementById('txtclient').focus();
            if (document.getElementById("div2").style.display == "block")
                document.getElementById("div2").style.display = "none";
            Classified_Booking.bindagencusub(page, document.getElementById('hiddencompcode').value, call_bindagsub);
        }
        return false;
    }
    ///////////////for product

    else if (document.activeElement.id == "lstproduct") {
        if (document.getElementById('lstproduct').value == "0") {
            alert("Please select the product");
            return false;
        }
        document.getElementById("divproduct").style.display = "none";
        var datetime = document.getElementById('txtdatetime').value;
        //alert(document.getElementById('lstagency').value);

        //alert(document.getElementById('lstagency').value);
        /*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        this is the page which is designed to get the name as well as the add ress of client if 0 than client name and 
        address and if 0 than agency name and address and if 2 than its for product
        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@22222*/

        var page = document.getElementById('lstproduct').value;
        //agencycodeglo=page;
        var id = "";
        if (browser != "Microsoft Internet Explorer") {
            var httpRequest = null; ;
            httpRequest = new XMLHttpRequest();
            if (httpRequest.overrideMimeType) {
                httpRequest.overrideMimeType('text/xml');
            }

            httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

            httpRequest.open("GET", "clientName.aspx?page=" + page + "&adtype=" + "CL0" + "&datetime=" + datetime + "&value=2", false);
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) {
                    id = httpRequest.responseText;
                }
                else {
                    alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                    return false;
                }
            }
        }
        else {
            var xml = new ActiveXObject("Microsoft.XMLHTTP");
            xml.Open("GET", "clientName.aspx?page=" + page + "&adtype=" + "CL0" + "&datetime=" + datetime + "&value=2", false);
            xml.Send();
            id = xml.responseText;
        }

        if (id == "yes") {
            alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
            return false;
        }

        document.getElementById('txtproduct').value = id;

        document.getElementById('drpbrand').value = "";
        document.getElementById('drpbrand').focus();
        //Classified_Booking.getbrand(page, document.getElementById('hiddencompcode').value, call_bindproduct);
        return false;
    }
    ///this is for exec name
    else if (document.activeElement.id == "lstexec") {
        if (document.getElementById('lstexec').value == "0") {
            var a = "Executive name";
            if (browser != "Microsoft Internet Explorer") {
                a = document.getElementById('lbececname').textContent.replace("*[F2]", "");
            }
            else {
                a = document.getElementById('lbececname').innerText.replace("*[F2]", "");
            }
            alert("Please select the " + a);
            return false;
        }
        document.getElementById("divexec").style.display = "none";
        var datetime = document.getElementById('txtdatetime').value;
        //alert(document.getElementById('lstagency').value);

        //alert(document.getElementById('lstagency').value);
        /*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        this is the page which is designed to get the name as well as the add ress of client if 0 than client name and 
        address and if 0 than agency name and address and if 2 than its for product and 3 for exec
        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@22222*/

        var page = document.getElementById('lstexec').value;
        //agencycodeglo=page;
        var id = "";
        if (browser != "Microsoft Internet Explorer") {
            var httpRequest = null; ;
            httpRequest = new XMLHttpRequest();
            if (httpRequest.overrideMimeType) {
                httpRequest.overrideMimeType('text/xml');
            }

            httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

            httpRequest.open("GET", "clientName.aspx?page=" + page + "&adtype=" + "CL0" + "&datetime=" + datetime + "&value=3", false);
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) {
                    id = httpRequest.responseText;
                }
                else {
                    alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                    return false;
                }
            }
        }
        else {
            var xml = new ActiveXObject("Microsoft.XMLHTTP");
            xml.Open("GET", "clientName.aspx?page=" + page + "&adtype=" + "CL0" + "&datetime=" + datetime + "&value=3", false);
            xml.Send();
            id = xml.responseText;
        }


        if (id == "yes") {
            alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
            return false;
        }

        document.getElementById('txtexecname').value = id;

        var teamcode=id.substring(id.lastIndexOf('~') + 1,id.lastIndexOf('('));
        var teamname=id.substring(id.lastIndexOf('?') + 1,id.lastIndexOf('~'));
        document.getElementById('lblteamname').innerHTML =teamname;
        teamcode=page+'~'+teamcode;
        document.getElementById('txtexeczone').focus();
        document.getElementById('hdnteamcode').value=id.substring(id.lastIndexOf('~') + 1,id.lastIndexOf('('));
        var agencycodesubcode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.lastIndexOf(')')); /*bhanu*/
        Classified_Booking.getexeczone(teamcode, document.getElementById('hiddencompcode').value, agencycodesubcode, call_bindexeczone);
        return false;
    }

}

///////this function is to get the auto generated code 
function getboxno() {
    boxpercen = "";
    var branchname = document.getElementById('hiddenbranch').value;
    branchname = branchname.substring(0, 2)
    var branch = document.getElementById('drpboxcode').value;
    document.getElementById('hiddenboxno').value = "";
    if (branch == "0") {
        document.getElementById('txtboxno').value = "";
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        // getagrredamou();
    }

    if (branch != "0") {
        Classified_Booking.getboxnovalue(document.getElementById('hiddencompcode').value, branchname, branch, "A", call_getvalbox);
    }
    return false;

}

function call_getvalbox(res) {
    var ds = res.value;
    if (ds == null) {
        alert(res.error.description)
        return false;
    }
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    var count = "0";
    var branchname = document.getElementById('hiddenbranch').value;
    branchname = branchname.substring(0, 2)
    if (ds.Tables[0].Rows.length > 0 && ds.Tables[0].Rows[0].boxno != null && ds.Tables[0].Rows[0].boxno != "") {
        var boxval = ds.Tables[0].Rows[0].boxno;
        var cou = boxval;
        //  cou++;
        document.getElementById('txtboxno').value = cou;
        document.getElementById('hiddenboxno').value = cou;
    }
    else {
        document.getElementById('txtboxno').value = branchname + count;
        document.getElementById('hiddenboxno').value = branchname + cou;
    }
    /* 23sep
    var amtgross=document.getElementById('txtgrossamt').value
    var amtbill=document.getElementById('txtbillamt').value
    var per=ds.Tables[1].Rows[0].Box_Charges_Native;
    perbox=ds.Tables[1].Rows[0].Box_Charges_Native;
    perboxtype=ds.Tables[1].Rows[0].Box_Charges_Type;
    fillrateintogrid();
    if(document.getElementById('txtgrossamt').value=="NaN")
    {
    document.getElementById('txtgrossamt').value="";
    }
    if(document.getElementById('txtbillamt').value=="NaN")
    {
    document.getElementById('txtbillamt').value="";
    }*/

    boxpercen = ds.Tables[1].Rows[0].Box_Charges_Native;
    document.getElementById('hiddenboxchrgtype').value = ds.Tables[1].Rows[0].Box_Charges_Type;
}


function chkrodate() {
    if (document.getElementById('txtrono').value != "") {
        if (document.getElementById('txtrodate').value == "") {
            alert("Please fill ro date");
            document.getElementById('txtrodate').focus();
            return false;

        }

    }

}

////this is the function to get the billable area on change of bill height

function getbiilablearea() {
    if (document.getElementById('txtbillwidth').value == "") {
        alert("Please fill bill width");
        document.getElementById('txtbillwidth').focus();
        return false;

    }
    else if (document.getElementById('txtgrossamt').value == "") {
        //alert("Please get gross amount");
        // return false;

    }
    else if (document.getElementById('txtbillwidth').value == "" || document.getElementById('txtbillheight').value == "") {
        document.getElementById('txtbillwidth').value = document.getElementById('txtadsize1').value
        document.getElementById('txtbillheight').value = document.getElementById('txtadsize2').value


    }
    else if (parseFloat(document.getElementById('txtbillwidth').value) == 0 || parseFloat(document.getElementById('txtbillheight').value) == 0) {
        alert("0 is not accepted");
        var idrem = document.activeElement.id;
        //document.getElementById(idrem).value="";

        return false;

    }
    var value = chkamount('txtbillwidth');
    if (value == "f") {
        return false;
    }
    var value = chkamount('txtbillheight');
    if (value == "f") {
        return false;
    }


    var billwidth = document.getElementById('txtbillwidth').value;
    var billhei = document.getElementById('txtbillheight').value;
    var totbill = parseFloat(billwidth) * parseFloat(billhei);
    txtbillarea = totbill;

    ///////////this is to fill the disc ,disc per,

    var totarea = parseFloat(document.getElementById('txtbillwidth').value) * parseFloat(document.getElementById('txtbillheight').value); ;
    var toadarea = parseFloat(document.getElementById('txttotalarea').value);
    //  var agrrrate=parseFloat(document.getElementById('txtagreedrate').value);

    // document.getElementById('txtagreedamt').value=(totarea*agrrrate).toFixed(2);



    // var agreeamou=parseFloat(document.getElementById('txtagreedamt').value);
    // var cardrate=parseFloat(document.getElementById('txtcardrate').value);

    //   document.getElementById('txtagreedrate').value=(agreeamou/totarea).toFixed(2);
    //  var agrrate=parseFloat(document.getElementById('txtagreedrate').value);
    //  var disrate=document.getElementById('txtdiscount').value=(cardrate-agrrate).toFixed(2);

    // var tot=(disrate/cardrate)*100;
    //  document.getElementById('txtdiscpre').value=tot.toFixed(2);

    //  getagrredamou();

    if (document.getElementById('tblinsert').innerHTML != "") {
        var hei = document.getElementById('txtbillheight').value
        var wid = document.getElementById('txtbillwidth').value
        getpageareaintogrid(hei, wid);
    }
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
}

///this function is to get the special disc and per and at change get the gross amount


///////////////this function is to get the space chjarges

function getspacecharge() {
    if (document.getElementById('txtcardrate').value == "") {
        alert("Please enter the card rate");
        return false;

    }
    // getagrredamou();

}

//////////////this function is to get space disc



function chkpckforcurr() {
    if (document.getElementById('hiddensavemod').value == "0") {
        if (document.getElementById('drppackage').value == "0" && document.getElementById('txtratecode').value != "0") {
            alert("Please select the package");
            document.getElementById('txtratecode').value = "0"
            return false;

        }
        if (document.getElementById('txtadsize1').value == "" && document.getElementById('txtratecode').value != "0") {
            alert("Please select the Height");
            document.getElementById('txtratecode').value = "0"
            return false;

        }
        if (document.getElementById('txtadsize2').value == "" && document.getElementById('txtratecode').value != "0") {
            alert("Please select the width ");
            document.getElementById('txtratecode').value = "0"
            return false;

        }
        if (document.getElementById('drppageprem').value == "0" && document.getElementById('txtratecode').value != "0") {
            alert("Please select the page Premium");
            document.getElementById('txtratecode').value = "0"
            return false;

        }
        if (document.getElementById('drppageposition').value == "0" && document.getElementById('txtratecode').value != "0") {
            alert("Please select the Position premium ");
            document.getElementById('txtratecode').value = "0"
            return false;

        }
        if (document.getElementById('txtratecode').value == "0") {
            alert("Please select rate code");
            document.getElementById('drpcurrency').value = document.getElementById('hiddencurrency').value;
            return false;

        }

        //////////////this code is to split the code as well as ites description 

        var objpack = document.getElementById('drppackagecopy');
        var temp = "";
        var tempcode = "";
        var tempval = "";
        var tempvalcode = "";
        var desc = "";
        var codepck = "";
        var i = objpack.options.length;
        var j;

        for (j = 0; j < i; j++) {
            if (parseInt(i) > 0) {
                tempval = objpack[j].value;
                //tempvalcode=objpack[j].value;
                if (temp != "") {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    codepck = tempvalcode + "," + codepck;
                    desc = tempcode + "," + desc;


                }
                else {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    codepck = tempvalcode;
                    desc = tempcode;
                }
            }

        }

        //////////////////////////////////////////////////////////////////


        var adtype = "CL0";
        var color = document.getElementById('drpcolor').value;
        var adcat = document.getElementById('drpadcategory').value;
        var adsucat = document.getElementById('drpadsubcategory').value;
        var currency = document.getElementById('drpcurrency').value;
        var ratecode = document.getElementById('txtratecode').value;
        var package1 = codepck;
        var dateformat = document.getElementById('hiddendateformat').value;
        var selecdate;
        if (document.getElementById('txtdummydate').value != "") {
            if (dateformat == "mm/dd/yyyy") {
                selecdate = document.getElementById('txtdummydate').value;
            }
            if (dateformat == "dd/mm/yyyy") {
                var txt1 = document.getElementById('txtdummydate').value;
                var txt2 = txt1.split("/");
                var dd = txt2[0];
                var mm = txt2[1];
                var yy = txt2[2];
                selecdate = mm + '/' + dd + '/' + yy;
            }
            if (dateformat == "yyyy/mm/dd") {
                var txt1 = document.getElementById('txtdummydate').value;
                var txt2 = txt1.split("/");
                var yy = txt2[0];
                var mm = txt2[1];
                var dd = txt2[2];
                selecdate = mm + '/' + dd + '/' + yy;

            }
        }
        else {
            selecdate = "";
        }

        Classified_Booking.getratevalue(adtype, color, adcat, adsucat, currency, ratecode, package1, selecdate, document.getElementById('hiddencompcode').value, document.getElementById('drpuom').value, call_chkpckforcurr);
    }


}

function call_chkpckforcurr(res) {
    var ds = res.value;
    if (ds.Tables[0] == undefined) {
        alert("Package is not valid");
        rateRefresh();
        /* 25*Aug*
        document.getElementById('txtratecode').value="0";
        document.getElementById('txtcardrate').value="";
        document.getElementById('txtcardamt').value=""; */
        return false;
    }
    if (ds.Tables[0].Rows.length > 0)
    { }
    else {
        alert("Package is not valid");
        rateRefresh();
        /*  *25Aug*
        document.getElementById('txtratecode').value="0";
        document.getElementById('txtcardrate').value="";
        document.getElementById('txtcardamt').value=""; */
        return false;
    }
}

function LTrim(value) {

    var re = /\s*((\S+\s*)*)/;
    return value.replace(re, "$1");

}

// Removes ending whitespaces
function RTrim(value) {

    var re = /((\s*\S+)*)\s*/;
    return value.replace(re, "$1");

}

// Removes leading and ending whitespaces
function trim(value) {

    return LTrim(RTrim(value));

}

function chkamount(e) {
    var flag = "";
    //return allamount121(e);
    e = document.getElementById(e); //.value;
    //alert(e);
    //alert(e.value);
    //var fld=e.value;
    var fld = e.value;
    if (fld != "") {
        //var expression= ^-{0,1}\d*\.{0,1}\d+$;
        if (fld.match(/^\d+(\.\d{1,2})?$/i)) {
            //return true;
            //checkpackagerate();
            flag = "t";
            return flag;
        }
        else {
            alert("Input Error")
            //alert(e.id);
            var str = e.id;
            e.value = "";
            document.getElementById(str).focus();
            flag = "f";
            //e.id.focus();
            return flag;
        }
    }

}

function chkamountgrid(e) {
    //return allamount121(e);
    e = document.getElementById(e); //.value;
    //alert(e);
    //alert(e.value);
    //var fld=e.value;
    var fld = e.value;
    if (fld != "") {
        //var expression= ^-{0,1}\d*\.{0,1}\d+$;
        if (fld.match(/^\d+(\.\d{1,2})?$/i)) {
            return true;
            //checkpackagerate();
        }
        else {
            alert("Input Error")
            //alert(e.id);
            var str = e.id;
            e.value = "";
            document.getElementById(str).focus();
            //e.id.focus();
            return false;
        }
    }

}


function getbillzero() {
    if (document.getElementById('drpbooktype').value == "2" || document.getElementById('drpbooktype').value == "6")
        document.getElementById('btnfmg').disabled = false;
    else
        document.getElementById('btnfmg').disabled = true;

    if (document.getElementById('drpbooktype').value == "1") {
        document.getElementById('txtbartertype').disabled = false;
        //  document.getElementById('txtbartertype').value="";
        // document.getElementById('hiddenbarteramt').value="";
        //  document.getElementById('hiddenstopbarterbooking').value="";
    }
    else {
        document.getElementById('txtbartertype').disabled = true;
        document.getElementById('txtbartertype').value = "";
        document.getElementById('hiddenbarteramt').value = "";
        document.getElementById('hiddenstopbarterbooking').value = "";
    }
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtbillamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    if (document.getElementById('txtbillamt').value != "") {
        if (document.getElementById('drpbooktype').value == "2" || document.getElementById('drpbooktype').value == "6" || document.getElementById('drpbooktype').value == "4" || document.getElementById('drpbooktype').value == "5") {
            document.getElementById('txtbillamt').value = "0";
            return false;
        }
    }
}
/////////////update into booking child table

function modifyinsertion() {

    var len = "bookdiv";
    var insertno;
    var premid;
    var premper;
    var colid;
    var height;
    var width;
    var size;
    var late;
    //var uomid;
    //var adtypid;
    var cardid;
    var editid;
    var solorate;
    var premper1;
    var prem1id;
    var namecode;
    var inserts;
    var pagepost;
    var preall;
    var adcat;
    var adsubcat;
    var matsta;
    var filename;
    var discrate;
    var insertsta;
    var billstat;
    var id;
    var repeat;
    var i = 0;
    var paid;
    var agrred;
    var solo;
    var gross;
    var showid;
    var billamt;
    var billrate;
    var compcode = document.getElementById('hiddencompcode').value;
    var userid = document.getElementById('hiddenuserid').value;
    var cioid = document.getElementById('txtciobookid').value;
    //var y=document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
    var y = parseInt(noofinsert)
    var k;

    for (k = 0; k < y; k++) {

        while (document.getElementById("card" + i) == null) {
            i = i + savtotid;

        }

        showid = "sho" + i;
        id = "Text" + i;
        editid = "edit" + i;
        //premid="prem"+i;
        //prem1id="premone"+i;
        colid = "col" + i;
        height = "hei" + i;
        width = "wid" + i;
        size = "siz" + i;
        pagepost = "pgpre" + i;  //"pagpos"+i;
        namecode = "one";
        // premper="premper"+i;
        // premper1="premperone"+i;
        //adtypid="adtyp"+i;
        namecode = "two";
        preall = "preall" + i;
        adcat = "adcat" + i;
        late = "lat" + i;
        matsta = "mat" + i;
        cardid = "card" + i;
        filename = "fil" + i;
        discrate = "disrat" + i;
        insertsta = "inssta" + i;
        billstat = "bill" + i;
        adsubcat = "ads" + i;
        repeat = "rep" + i;
        insertno = "ins" + i;
        paid = "pai" + i
        agrred = "agr" + i;
        solo = "sol" + i;
        gross = "gro" + i;
        billamt = "ba" + i;
        billrate = "br" + i;
        var splboldsize = "splboldsize" + i;
        var splboldsizevalue = "";
        splboldsizevalue = document.getElementById(splboldsize).value;
        var insernum = document.getElementById(insertno).innerHTML;
        var insertdate = document.getElementById(id).value;
        var edition = document.getElementById(editid).value;
        var premium1 = "0"//document.getElementById(premid).value;
        var premium2 = "0"//document.getElementById(prem1id).value;
        var height = document.getElementById(height).value;
        var width = document.getElementById(width).value;
        var totalsize = document.getElementById(size).value;
        var pagepost = document.getElementById(pagepost).value;
        var color = document.getElementById(colid).value;
        var premper11 = "0"//document.getElementById(premper).value;
        var premper2 = "0"//document.getElementById(premper1).value;
        var premallow = document.getElementById(preall).value;
        var adcategory = document.getElementById(adcat).value;
        var latestdate = document.getElementById(late).value;
        var material = document.getElementById(matsta).value;
        var cardrate = document.getElementById(cardid).value;
        var filename = document.getElementById(filename).value;
        var discrate = document.getElementById(discrate).value;
        var insertstatus = document.getElementById(insertsta).value;
        var billstatus = document.getElementById(billstat).value;
        var adsubcat = document.getElementById(adsubcat).value;
        var repdate = document.getElementById(repeat).value;
        var paidins = document.getElementById(paid).value;
        var insagreedrate = document.getElementById(agrred).value;
        var inssolo = document.getElementById(solo).value;
        var grossrate = document.getElementById(gross).value;
        var bill_amt = document.getElementById(billamt).value
        var bill_rate = document.getElementById(billrate).value
        var adcat3 = document.getElementById('drpadcat3').value;
        var adcat4 = document.getElementById('drpadcat4').value;
        var adcat5 = document.getElementById('drpadcat5').value;
        //Classified_Booking.modifygridinsert(insertdate,edition,premium1,premium2,premallow,adcategory,latestdate,material,cardrate,filename,discrate,insertstatus,billstatus,adsubcat,compcode,userid,cioid,height,width,totalsize,pagepost,premper11,premper2,color,repdate,insernum,paidins,insagreedrate,inssolo,grossrate,modid);
        var boxcharge = document.getElementById('boxc' + i).value;
        var vat_inc = document.getElementById('vat_inc' + i).value;
        var grosslocal = document.getElementById("grolocal" + i).value;
        var billamtlocal = document.getElementById("balocal" + i).value;
        Classified_Booking.modifygridinsert(insertdate, edition, premium1, premium2, premallow, adcategory, latestdate, material, cardrate, filename, discrate, insertstatus, billstatus, adsubcat, compcode, userid, cioid, height, width, totalsize, pagepost, premper11, premper2, color, repdate, insernum, paidins, insagreedrate, inssolo, grossrate, bill_amt, bill_rate, "0", "0", "0", document.getElementById('hiddendateformat').value, document.getElementById('hiddenserverip').value, splboldsizevalue, boxcharge, vat_inc, grosslocal, billamtlocal,adcat3,adcat4,adcat5);
        i = i + 1;
    }

    if (document.getElementById('hiddensavemod').value == "0") {
        document.getElementById('tblinsert').innerHTML = ""
        document.getElementById('tblrate').style.display = "none";
        document.getElementById('tblbill').style.display = "none";
        //document.getElementById('tblsize').style.display="none";
        document.getElementById('addetails').style.display = "none";
        document.getElementById('pagedetail').style.display = "none";
        document.getElementById('tblpackage').style.display = "none";
        document.getElementById('tbbox').style.display = "none";
        document.getElementById('tbvts').style.display = 'none';
        document.getElementById('txtciobookid').value = "";
        document.getElementById('LinkButton1').disabled = true;
        document.getElementById('LinkButton2').disabled = true;
        document.getElementById('LinkButton3').disabled = true;
        document.getElementById('LinkButton4').disabled = true;
        document.getElementById('LinkButton5').disabled = true;
        document.getElementById('LinkButton6').disabled = true;
    }

    return false;


}

////////////////this is the function to open the div for deal div

function showdealvalue() {

    if (document.getElementById('drpscheme').value != "" && document.getElementById('drpscheme').value != "0") {
        alert("Scheme or contract can be choosen");
        return false;


    }
    var dealtype = document.getElementById('hiddentype').value
    var agency = document.getElementById('txtagency').value
    var agencysplit = "";
    if (agency != "") {
        var agencyarr = agency.split("(");
        agencysplit = agencyarr[1];
        agencysplit = agencysplit.replace(")", "");
    }
    var subagency = document.getElementById('drpagscode').value;
    var client = document.getElementById('txtclient').value;
    var clientsplit = "";
    if (client != "") {
        var clientarr = client.split("(");
        clientsplit = clientarr[1];
        if (clientsplit != undefined) {
            clientsplit = clientsplit.replace(")", "");
        }
        else {
            clientsplit = "0";
        }
    }
    var bookingdate = document.getElementById('txtdummydate').value;
    var color = document.getElementById('drpcolor').value;
    var curr = document.getElementById('drpcurrency').value;
    var adcat = document.getElementById('drpadcategory').value;
    var compcode = document.getElementById('hiddencompcode').value

    //var prod="qbc";
    var prod = document.getElementById('drpproductcat').value;
    //var clientarr = product.split("(");
   // var prod = clientarr[1];
    if (prod != undefined) {
        prod = document.getElementById('drpproductcat').value;
    }
    else {
        prod = "0";
    }
    var col = document.getElementById('drpcolor').value
    var adtype = "CL0";
    //var pkg_code=document.getElementById('drpcolor').value

    var objpack = document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var code = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (temp != "") {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode + "," + code;
                desc = tempcode + "," + desc;


            }
            else {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode;
                desc = tempcode;
            }
        }

    }
    var rate_cod = "0";

    //alert(document.getElementById('drpcurrency').style.visibility);
    document.getElementById('divdeal').innerHTML = "";
    aTag = eval(document.getElementById("drppackage"))
    var btag;
    var leftpos = 0;
    var toppos = 0;
    do {
        aTag = eval(aTag.offsetParent);
        leftpos += aTag.offsetLeft;
        toppos += aTag.offsetTop;
        btag = eval(aTag)
    } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
    document.getElementById('divdeal').style.left = document.getElementById("drppackage").offsetLeft + (leftpos + 186) + "px";
    document.getElementById('divdeal').style.top = document.getElementById("drppackage").offsetTop + toppos + "px";
    //document.getElementById('divdeal').style.left=document.getElementById("drppackage").offsetLeft + leftpos+"px";
    //when value is 0 than we bind the list box and when it is 1 than we calculate the discount
    var bartertype = "";
    var totalarea = document.getElementById('txttotalarea').value;
    if (document.getElementById('txtbartertype').value != "" && document.getElementById('txtbartertype').value.indexOf('(') >= 0 && document.getElementById('txtbartertype').value.indexOf(')') >= 0)
        bartertype = document.getElementById('txtbartertype').value.substring(document.getElementById('txtbartertype').value.indexOf('(') + 1, document.getElementById('txtbartertype').value.indexOf(')'));
    Classified_Booking.binddealtype(compcode, agencysplit, subagency, bookingdate, color, curr, adcat, clientsplit, prod, col, code, rate_cod, adtype, document.getElementById('hiddendateformat').value, totalarea, bartertype, call_binddealtype);

    return false;

}
function call_binddealtype(res) {
    var ds = res.value;
    var dealstr;
    var str;

    if (ds.Tables[0] != undefined && ds != null && ds.Tables[0].Rows.length > 0) {
        //////////////////////////////////
        document.getElementById("divdeal").style.display = "block";
        //document.getElementById('lbcoupan').style.visibility="hidden";
        // document.getElementById('chkcoupan').style.visibility="hidden";
        /*document.getElementById('drppackage').style.visibility="hidden";
        document.getElementById('lbpackage').style.visibility="hidden";
        document.getElementById('drppackage').style.visibility="hidden";
        document.getElementById('drppackagecopy').style.visibility="hidden";
        document.getElementById('btncopy').style.visibility="hidden";
        document.getElementById('btndel').style.visibility="hidden";
        document.getElementById('Img3').style.visibility="hidden";
        ///document.getElementById('dealdivscroll').style.display="none"; 
        document.getElementById('lbselectdate').style.visibility="hidden";
        document.getElementById('txtdummydate').style.visibility="hidden";
        document.getElementById('lbad').style.visibility="hidden";
        document.getElementById('chktfn').style.visibility="hidden";
        document.getElementById('lbcurrency').style.visibility="hidden";
        document.getElementById('drpcurrency').style.visibility="hidden";
        document.getElementById('lbrptcurrency').style.visibility="hidden";
        document.getElementById('drprptcurrency').style.visibility="hidden";
        document.getElementById('drppackage').style.visibility="hidden";
        document.getElementById('drppackagecopy').style.visibility="hidden";
        document.getElementById('drpcurrency').style.visibility="hidden";
        document.getElementById('lbladon').style.visibility="hidden";
        document.getElementById('chkadon').style.visibility="hidden";*/
        ///////////////////////////////////////////////////////////////////
        var srcimg = "Images\\close.gif";
        dealstr = "<table cellpadding=\"1\" cellspacing=\"1\" id=\"griddeal\" width=\"440px\" border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\"><td align=\"center\" valign=\"top\" ><img id=\"close\" src=" + srcimg + " style=\"cursor:pointer;\" onclick=\"javascript:return closedeal();\"/></td><td align=\"center\" valign=\"top\" >Code</td><td valign=\"top\" align=\"center\" width=\"100px\">Contract Code</td><td align=\"center\" valign=\"top\" width=\"100px\">Deal Rate</td><td align=\"center\" valign=\"top\" width=\"100px\">Deal Name</td><td align=\"center\" valign=\"top\" width=\"100px\">Contract Name</td><td align=\"center\" valign=\"top\">Valid Till</td></tr>";
        for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
            str = "chk" + i;
            dealstr = dealstr + "<tr><td id=" + ds.Tables[0].Rows[i].code + " class=\"TextField\"><input type='checkbox' style=\"top:0px\" width='5px' id=" + str + "  onclick=\"javascript:return getdealrate(" + ds.Tables[0].Rows[i].code + ",'" + ds.Tables[0].Rows[i].dealname + "','" + ds.Tables[0].Rows[i].contractname + "');\"  /></td><td class=\"TextField\">" + ds.Tables[0].Rows[i].code + "</td><td class=\"TextField\">" + ds.Tables[0].Rows[i].contractcode + "</td><td class=\"TextField\">" + ds.Tables[0].Rows[i].deal_rate + "</td>";
            dealstr = dealstr + "<td class=\"TextField\">" + ds.Tables[0].Rows[i].dealname + "</td><td class=\"TextField\">" + ds.Tables[0].Rows[i].contractname + "</td><td class=\"TextField\">" + ds.Tables[0].Rows[i].todate + "</td>";

        }

        dealstr = dealstr + "</tr></table>";
        document.getElementById('divdeal').innerHTML = dealstr;





    }
    else {
        alert("On this Contract Rate doesnot exists");
        document.getElementById("divdeal").style.display = "none";
        //   document.getElementById('lbcoupan').style.visibility="visible";
        //  document.getElementById('chkcoupan').style.visibility="visible";
        document.getElementById('drppackage').style.visibility = "visible";
        document.getElementById('lbpackage').style.visibility = "visible";
        document.getElementById('drppackage').style.visibility = "visible";
        document.getElementById('drppackagecopy').style.visibility = "visible";
        document.getElementById('btncopy').style.visibility = "visible";
        document.getElementById('btndel').style.visibility = "visible";
        document.getElementById('Img3').style.visibility = "visible";
        //  document.getElementById('dealdivscroll').style.display="block";
        document.getElementById('lbselectdate').style.visibility = "visible";
        document.getElementById('txtdummydate').style.visibility = "visible";
        document.getElementById('lbad').style.visibility = "visible";
        document.getElementById('chktfn').style.visibility = "visible";
        document.getElementById('lbcurrency').style.visibility = "visible";
        document.getElementById('drpcurrency').style.visibility = "visible";
        document.getElementById('lbrptcurrency').style.visibility = "visible";
        document.getElementById('drprptcurrency').style.visibility = "visible";
        document.getElementById('lbladon').style.visibility = "visible";
        document.getElementById('chkadon').style.visibility = "visible";
        //document.getElementById('tblpackage').style.display="block";
        return false;

    }



}
function closedeal() {
    document.getElementById("divdeal").style.display = "none";
    //     document.getElementById('lbcoupan').style.visibility="visible";
    //   document.getElementById('chkcoupan').style.visibility="visible";
    document.getElementById('drppackage').style.visibility = "visible";
    document.getElementById('lbpackage').style.visibility = "visible";
    document.getElementById('drppackage').style.visibility = "visible";
    document.getElementById('drppackagecopy').style.visibility = "visible";
    document.getElementById('btncopy').style.visibility = "visible";
    document.getElementById('btndel').style.visibility = "visible";
    document.getElementById('Img3').style.visibility = "visible";
    //    document.getElementById('dealdivscroll').style.display="block";
    document.getElementById('lbselectdate').style.visibility = "visible";
    document.getElementById('txtdummydate').style.visibility = "visible";
    document.getElementById('lbad').style.visibility = "visible";
    document.getElementById('chktfn').style.visibility = "visible";
    document.getElementById('lbcurrency').style.visibility = "visible";
    document.getElementById('drpcurrency').style.visibility = "visible";
    document.getElementById('lbrptcurrency').style.visibility = "visible";
    document.getElementById('drprptcurrency').style.visibility = "visible";
    document.getElementById('lbladon').style.visibility = "visible";
    document.getElementById('chkadon').style.visibility = "visible";
    //document.getElementById('tblpackage').style.display="block";
    return false;
}

function getdealrate(val, detyp, conneme) {
    //document.getElementById('txtdealrate').value=document.getElementById('lstdealtype').value;
    document.getElementById('txtcontracttype').value = detyp;
    document.getElementById('txtcontractname').value = conneme;
    document.getElementById("divdeal").style.display = "none";
    //  document.getElementById('lbcoupan').style.visibility="visible";
    //    document.getElementById('chkcoupan').style.visibility="visible";
    document.getElementById('drppackage').style.visibility = "visible";
    document.getElementById('lbpackage').style.visibility = "visible";
    document.getElementById('drppackage').style.visibility = "visible";
    document.getElementById('drppackagecopy').style.visibility = "visible";
    document.getElementById('btncopy').style.visibility = "visible";
    document.getElementById('btndel').style.visibility = "visible";
    document.getElementById('Img3').style.visibility = "visible";
    //    document.getElementById('dealdivscroll').style.display="block";
    document.getElementById('lbselectdate').style.visibility = "visible";
    document.getElementById('txtdummydate').style.visibility = "visible";
    document.getElementById('lbad').style.visibility = "visible";
    document.getElementById('chktfn').style.visibility = "visible";
    document.getElementById('lbcurrency').style.visibility = "visible";
    document.getElementById('drpcurrency').style.visibility = "visible";
    document.getElementById('lbrptcurrency').style.visibility = "visible";
    document.getElementById('drprptcurrency').style.visibility = "visible";
    var agency = document.getElementById('txtagency').value
    var agencyarr = agency.split("(");
    var agencysplit = agencyarr[1];
    agencysplit = agencysplit.replace(")", "");
    var subagency = document.getElementById('drpagscode').value;
    var compcode = document.getElementById('hiddencompcode').value
    var dealcode = val;
    /////
    var client = document.getElementById('txtclient').value;
    var clientarr = client.split("(");
    var clientsplit = clientarr[1];
    if (clientsplit != undefined) {
        clientsplit = clientsplit.replace(")", "");
    }
    else {
        clientsplit = "0";
    }
    ///////

    Classified_Booking.allowdisc(dealcode, compcode, agencysplit, subagency, clientsplit, call_allowdisc);

    return false;

}
function call_allowdisc(res) {
    var ds = res.value;
    //
    if (ds.Tables[0].Rows.length > 0) {
        if (ds.Tables[0].Rows[i].resul != "0") {
            document.getElementById('txtdealrate').value = ds.Tables[0].Rows[i].resul
            document.getElementById('chkcontract').checked = true
            if (document.getElementById('txtcardrate').value != "") {
                document.getElementById('txtdeviation').value = parseFloat(document.getElementById('txtcardrate').value) - parseFloat(document.getElementById('txtdealrate').value);
            }
            if (document.getElementById('txtgrossamt').value != "") {
                //   getagrredamou();
            }
            if (document.getElementById('tblinsert').innerHTML != "") {
                flagins = "0";
            }
        }
        else {
            document.getElementById('txtdealrate').value = ds.Tables[0].Rows[i].dealarte
            document.getElementById('txtdeviation').value = parseFloat(document.getElementById('txtcardrate').value) - parseFloat(document.getElementById('txtdealrate').value);
            if (document.getElementById('txtgrossamt').value != "") {
                //  getagrredamou();
            }
            if (document.getElementById('tblinsert').innerHTML != "") {
                flagins = "0";
            }
        }
    }
    else {
        alert("On this Contract Rate doesnot exists");
        document.getElementById("divdeal").style.display = "none";
        return false;


    }


}


/////this function is made when on change of scheme drop down we get the scheme 

function schemedisc() {

    if (document.getElementById('drpscheme').value != "0") {
        var schemcode = document.getElementById('drpscheme').value;
        var compcode = document.getElementById('hiddencompcode').value;
        var noofinsert = document.getElementById('txtinsertion').value;
        Classified_Booking.getschemedisc(schemcode, compcode, noofinsert, call_getschemedisc);

    }
    else {
        schemediscount = "";
        //  getagrredamou();
    }

    return false;

}
function call_getschemedisc(res) {
    var ds = res.value;

    if (ds.Tables[0].Rows.length > 0) {
        schemediscount = ds.Tables[0].Rows[0].discount
    }
    else {
        schemediscount = "";
    }
    if (document.getElementById('txtgrossamt').value != "") {
        //  getagrredamou();
    }
}

///////////this is the function which fills into grid on change of ad s cat when grid is visibile
function filladscatingrid() {
    if (document.getElementById('tblinsert').innerHTML != "") {
        var len = "bookdiv";
        var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
        var k;
        var adsubcat;
        var i = 0;
        var adsubcatval = document.getElementById('drpadsubcategory').value;
        for (k = 0; k < y - 1; k++) {

            adsubcat = "ads" + i;
            document.getElementById(adsubcat).value = adsubcatval;


            i = parseInt(i) + 1;

        }


    }
    //filladscatingrid();

}
///////////this is the function which fills into grid on change of color when grid is visibile

function fillcoloringrid() {
    //alert(noofinsertlo)
    var len = "bookdiv";
    var colorval = document.getElementById('drpcolor').value;
    //	if(colorval=="B")
    //{
    //  document.getElementById('drpbgcolor').value="0";
    //  document.getElementById('drpbgcolor').disabled=true;
    //	}
    //else{
    // document.getElementById('drpbgcolor').disabled=false;
    //}
    if (document.getElementById('tblinsert').innerHTML != "") {
        //var y=parseInt(noofinsertlo)   
        var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
        var k;
        var colid;
        var i = 0;

        for (k = 0; k < y - 1; k++) {

            colid = "col" + i;
            document.getElementById(colid).value = colorval;


            i = parseInt(i) + 1;

        }


    }

}

function getmodifygrid() {

    var len = "bookdiv";
    var insertno;
    var premid;
    var premper;
    var colid;
    var heightid;
    var widthid;
    var size;
    var late;
    //var uomid;
    //var adtypid;
    var cardid;
    var editid;
    var solorate;
    var premper1;
    var prem1id;
    var namecode;
    var inserts;
    var pagepost;
    var preall;
    var adcat;
    var adsubcat;
    var matsta;
    var filename;
    var discrate;
    var insertsta;
    var billstat;
    var id;
    var repeat;
    var i = 0;
    var paid;
    var agrred;
    var solo;
    var gross;
    var showid;
    var pageno_inserts;
    var remark_inserts;
    var caption_inserts;
    var page;
    var pageprem;
    var noofcol;
    var billamt;
    var billrate;
    var agnamnt;
    var adlgn;
    var spldisc;
    var cashdisc;
    var roundoffval;
    var pheival;
    var cpn_amt;
    var clicatamtval;
    var flatfreqamtval;
    var catamtval;
    var GSTAMT;
    var GSTGD;
    var compcode = document.getElementById('hiddencompcode').value;
    var userid = document.getElementById('hiddenuserid').value;
    var cioid = document.getElementById('txtciobookid').value;
    var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
    //var y=parseInt(noofinsert)   
    var k;
    var sectioncode_val = "";
    var resourceno_val = "";
    var dateformat = document.getElementById('hiddendateformat').value;
    for (k = 0; k < y - 1; k++) {



        showid = "sho" + i;
        id = "Text" + i;
        editid = "edit" + i;
        // premid="prem"+i;
        // prem1id="premone"+i;
        colid = "col" + i;
        heightid = "hei" + i;
        widthid = "wid" + i;
        size = "siz" + i;
        pagepost = "pgpre" + i;  //"pagpos"+i;
        namecode = "one";
        // premper="premper"+i;
        //  premper1="premperone"+i;
        //adtypid="adtyp"+i;
        namecode = "two";
        preall = "preall" + i;
        adcat = "adcat" + i;
        late = "lat" + i;
        matsta = "mat" + i;
        cardid = "card" + i;
        filename = "fil" + i;
        discrate = "disrat" + i;
        insertsta = "inssta" + i;
        billstat = "bill" + i;
        adsubcat = "ads" + i;
        repeat = "rep" + i;
        insertno = "ins" + i;
        paid = "pai" + i
        agrred = "agr" + i;
        solo = "sol" + i;
        gross = "gro" + i;
        pageno_inserts = "pagno" + i; ;
        remark_inserts = "rem" + i;
        caption_inserts = "cap" + i;
        page = "pgpre" + i;
        pageprem = "pagper" + i;
        noofcol = "nocol" + i;
        billamt = "ba" + i;
        billrate = "br" + i;
        agnamnt = "agmn" + i;
        adlgn = "adlag" + i;
        spldisc = "spld" + i;
        cashdisc = "cashd" + i;
        roundoffval = "roundoffval" + i;
        pheival = "pheival" + i;
        cpn_amt = "coupan" + i;
        clicatamtval = "clicatamt" + i;
        flatfreqamtval = "flatfreqamt" + i;
        catamtval = "catamt" + i;
        GSTAMT = "GSTAMT" + i;
        GSTGD = "GSTGD" + i;
        var splboldsize = "splboldsize" + i;
        var sectioncode = "seccode" + i;
        var resourceno = "resno" + i;
        var splboldsizevalue = "";
        var gstamount="";
        var gstgrid="";
        if (document.getElementById(splboldsize) != null)
            splboldsizevalue = document.getElementById(splboldsize).value;
        var editid_var = document.getElementById(editid);
        var par1 = (editid_var.parentNode).parentNode;
        //To update subedition detail table
        var subedi = "subedidata" + i;
        var subedidata = "";

        if (browser != "Microsoft Internet Explorer") {
            var insernum = document.getElementById(insertno).innerHTML;
            var insertdate = document.getElementById(id).value;
            var edition = document.getElementById(editid).value;
            var premium1 = "0"//document.getElementById(premid).value;
            var premium2 = "0"//document.getElementById(prem1id).value;
            var height = document.getElementById(heightid).value;
            var width = document.getElementById(widthid).value;
            var totalsize = document.getElementById(size).value;
            if (document.getElementById(pagepost) != null)
                var pagepost = document.getElementById(pagepost).value;
            var color = document.getElementById(colid).value;
            var premper11 = "0"//document.getElementById(premper).value;
            var premper2 = "0"//document.getElementById(premper1).value;
            var premallow = document.getElementById(preall).value;
            var adcategory = document.getElementById(adcat).value;
            var latestdate = document.getElementById(late).value;
            var material = document.getElementById(matsta).value;
            var cardrate = document.getElementById(cardid).value;
            var filename = document.getElementById(filename).value;
            var discrate = document.getElementById(discrate).value;
            var insertstatus = document.getElementById(insertsta).value;
            var billstatus = document.getElementById(billstat).value;
            var adsubcat = document.getElementById(adsubcat).value;
            var repdate = document.getElementById(repeat).value;
            var paidins = document.getElementById(paid).value;
            var insagreedrate = document.getElementById(agrred).value;
            var inssolo = document.getElementById(solo).value;
            var grossrate = document.getElementById(gross).value;
            var insert_pageno = document.getElementById(pageno_inserts).value;
            var insert_remark = document.getElementById(remark_inserts).value;
            var insert_caption = document.getElementById(caption_inserts).value;
            var page_code = document.getElementById(page).value;
            var page_per = document.getElementById(pageprem).value;
            var no_ofcol = document.getElementById(noofcol).value;
            var bill_amt = document.getElementById(billamt).value
            var bill_rate = document.getElementById(billrate).value
            var biil_agnamnt = document.getElementById(agnamnt).value;
            var bill_adagnamnt = document.getElementById(adlgn).value;
            var biil_splamt = document.getElementById(spldisc).value;
            var bill_cashamt = document.getElementById(cashdisc).value;
            var bill_roundamt = document.getElementById(roundoffval).value;
            var bill_pdfheightval = document.getElementById(pheival).value;
            var pkgcodegrid_value = "";
            var pkginsgrid_value = "";
            var pkg_alias_value = "";
            var pkgcodegrid = "hiddenpckcode" + i;
            var cpnamt = document.getElementById(cpn_amt).value;
            var clicatamt = document.getElementById(clicatamtval).value;
            var flatfreqamt = document.getElementById(flatfreqamtval).value;
            var catamt = document.getElementById(catamtval).value;
            var pkg_ins = "pkg_ins" + i;

            var pkg_alias = "pkg_alias" + i;
            if (document.getElementById(pkgcodegrid) != null) {
                pkgcodegrid_value = document.getElementById(pkgcodegrid).value;
            }

            if (document.getElementById(pkg_ins) != null) {
                pkginsgrid_value = document.getElementById(pkg_ins).value;
            }

            if (document.getElementById(pkg_alias) != null) {
                pkg_alias_value = document.getElementById(pkg_alias).value;
            }
            if (document.getElementById(sectioncode) != null) {
                sectioncode_val = document.getElementById(sectioncode).value;
            }
            if (document.getElementById(resourceno) != null) {
                resourceno_val = document.getElementById(resourceno).value;
            }
            if (document.getElementById(subedi) != null) {
                subedidata = document.getElementById(subedi).value;
            }
            if (document.getElementById(GSTAMT) != null) {
                gstamount = document.getElementById(GSTAMT).value;
            }
            if (document.getElementById(GSTGD) != null) {
                gstgrid = document.getElementById(GSTGD).value;
            }
        }
        else {
            var insernum = par1.all[insertno].innerHTML;
            var insertdate = par1.all[id].value;
            var edition = par1.all[editid].value;
            var premium1 = "0"//document.getElementById(premid).value;
            var premium2 = "0"//document.getElementById(prem1id).value;
            var height = par1.all[heightid].value;
            var width = par1.all[widthid].value;
            var totalsize = par1.all[size].value;
            if (par1.all[pagepost] != null)
                var pagepost = par1.all[pagepost].value;
            var color = par1.all[colid].value;
            var premper11 = "0"//document.getElementById(premper).value;
            var premper2 = "0"//document.getElementById(premper1).value;
            var premallow = par1.all[preall].value;
            var adcategory = par1.all[adcat].value;
            var latestdate = par1.all[late].value;
            var material = par1.all[matsta].value;
            var cardrate = par1.all[cardid].value;
            var filename = par1.all[filename].value;
            var discrate = par1.all[discrate].value;
            var insertstatus = par1.all[insertsta].value;
            var billstatus = par1.all[billstat].value;
            var adsubcat = par1.all[adsubcat].value;
            var repdate = par1.all[repeat].value;
            var paidins = par1.all[paid].value;
            var insagreedrate = par1.all[agrred].value;
            var inssolo = par1.all[solo].value;
            var grossrate = par1.all[gross].value;
            var insert_pageno = par1.all[pageno_inserts].value;
            var insert_remark = par1.all[remark_inserts].value;
            var insert_caption = par1.all[caption_inserts].value;
            var page_code = par1.all[page].value;
            var page_per = par1.all[pageprem].value;
            var no_ofcol = par1.all[noofcol].value;
            var bill_amt = par1.all[billamt].value
            var bill_rate = par1.all[billrate].value
            var biil_agnamnt = par1.all[agnamnt].value;
            var bill_adagnamnt = par1.all[adlgn].value;
            var biil_splamt = par1.all[spldisc].value;
            var bill_cashamt = par1.all[cashdisc].value;
            var bill_roundamt = par1.all[roundoffval].value;
            var bill_pdfheightval = par1.all[pheival].value;
            var pkgcodegrid_value = "";
            var pkginsgrid_value = "";
            var pkg_alias_value = "";
            var pkgcodegrid = "hiddenpckcode" + i;
            var cpnamt = par1.all[cpn_amt].value;
            var clicatamt = par1.all[clicatamtval].value;
            var flatfreqamt = par1.all[flatfreqamtval].value;
            var catamt = par1.all[catamtval].value;
            var pkg_ins = "pkg_ins" + i;

            var pkg_alias = "pkg_alias" + i;
            if (par1.all[pkgcodegrid] != null) {
                pkgcodegrid_value = par1.all[pkgcodegrid].value;
            }

            if (par1.all[pkg_ins] != null) {
                pkginsgrid_value = par1.all[pkg_ins].value;
            }

            if (par1.all[pkg_alias] != null) {
                pkg_alias_value = par1.all[pkg_alias].value;
            }
            if (par1.all[sectioncode] != null) {
                sectioncode_val = par1.all[sectioncode].value;
            }
            if (par1.all[resourceno] != null) {
                resourceno_val = par1.all[resourceno].value;
            }
            if (par1.all[subedi] != null) {
                subedidata = par1.all[subedi].value;
            }
            if (par1.all[GSTAMT] != null) {
                gstamount = par1.all[GSTAMT].value;
            }
            if (par1.all[GSTGD] != null) {
                gstgrid = par1.all[GSTGD].value;
            }
        }

        // for logo
        var logohei = document.getElementById('logohei' + i).value;
        var logowid = document.getElementById('logowid' + i).value;
        var logonam = document.getElementById('logonam' + i).value;

        var insertid = '0';
        var insert_id = "sho" + i;
        if (document.getElementById(insert_id) != null)
            insertid = document.getElementById(insert_id).value;
        //Classified_Booking.modifygridinsert(insertdate,edition,premium1,premium2,premallow,adcategory,latestdate,material,cardrate,filename,discrate,insertstatus,billstatus,adsubcat,compcode,userid,cioid,height,width,totalsize,pagepost,premper11,premper2,color,repdate,insernum,paidins,insagreedrate,inssolo,grossrate,modid);
        //Classified_Booking.modifygridinsert(insertdate,edition,premium1,premium2,premallow,adcategory,latestdate,material,cardrate,filename,discrate,insertstatus,billstatus,adsubcat,compcode,userid,cioid,height,width,totalsize,pagepost,premper11,premper2,color,repdate,insernum,paidins,insagreedrate,inssolo,grossrate,insert_pageno,insert_remark,page_code,page_per,no_ofcol,bill_amt,bill_rate);
        //  string insertdate, string edition, string premium1, string premium2, string premallow, string adcategory, string latestdate, string material, string cardrate, string filename, string discrate, string insertstatus, string billstatus, string adsubcat, string compcode, string userid, string cioid, string height, string width, string totalsize, string pagepost, string premper1, string premper2, string colid, string repeat, string insertno, string paid, string insertinsertion, string solorate, string grossrate,string insert_pageno, string insert_remarks, string page_code, string page_per, string noofcol, string billamt, string billrate, string dateformat
        var vtsvalue = document.getElementById('vts' + i).value;
        var cirvts = '';
        var cirpub = '';
        var ciredi = '';
        var cirrate = '';
        var cirdate = '';
        var ciragency = document.getElementById('txtciragency').value;
        var ciragencysubcode = '';
        if (ciragency != "") {
            var myarrayex = ciragency.split('(');
            var agecirname = myarrayex[1].replace(")", "").split('+')[0];
            ciragency = trim(agecirname);
            ciragencysubcode = trim(myarrayex[1].replace(")", "").split('+')[1]);
        }
        if (vtsvalue != "") {
            cirvts = vtsvalue.split('ÿ')[0];
            cirpub = vtsvalue.split('ÿ')[1];
            ciredi = vtsvalue.split('ÿ')[2];
            cirrate = vtsvalue.split('ÿ')[3];
            cirdate = vtsvalue.split('ÿ')[4];
        }
        var boxcharge = document.getElementById('boxc' + i).value;
        var vat_inc = document.getElementById('vat_inc' + i).value;
        var grosslocal = document.getElementById("grolocal" + i).value;
        var billamtlocal = document.getElementById("balocal" + i).value;
        var discountmain = "";
        if (document.getElementById("disc_" + i) != null)
            discountmain = document.getElementById("disc_" + i).value;
        var premamtval = '';
        var adcat3 = document.getElementById('drpadcat3').value;
        var adcat4 = document.getElementById('drpadcat4').value;
        var adcat5 = document.getElementById('drpadcat5').value;
        if (insert_pageno == "" || insert_pageno == "0" || insert_pageno == null)
        {
            insert_pageno = "4";
        }
        Classified_Booking.modifygridinsert(insertdate, edition, premium1, premium2, premallow, adcategory, latestdate, material, cardrate, filename, discrate, insertstatus, billstatus, adsubcat, compcode, userid, cioid, height, width, totalsize, pagepost, premper11, premper2, color, repdate, insernum, paidins, insagreedrate, inssolo, grossrate, insert_pageno, insert_remark, page_code, page_per, no_ofcol, bill_amt, bill_rate, logohei, logowid, logonam, dateformat, pkgcodegrid_value, pkginsgrid_value, pkg_alias_value, insertid, cirvts, cirpub, ciredi, cirrate, cirdate, ciragency, ciragencysubcode, document.getElementById('hiddencenter').value, document.getElementById('txtbranch').value, document.getElementById('hiddenserverip').value, splboldsizevalue, document.getElementById('vat' + i).value, boxcharge, vat_inc, grosslocal, billamtlocal, sectioncode_val, resourceno_val, insert_caption, subedidata, discountmain, biil_agnamnt, bill_adagnamnt, biil_splamt, bill_cashamt, bill_roundamt, bill_pdfheightval, cpnamt, clicatamt, flatfreqamt, catamt, document.getElementById('hiddensupplimentflag').value, premamtval, adcat3, adcat4, adcat5,gstamount,gstgrid); 
        i = i + 1;
    }

    if (document.getElementById('hiddensavemod').value == "0") {
        document.getElementById('tblinsert').innerHTML = ""
        document.getElementById('tblrate').style.display = "none";
        document.getElementById('tblbill').style.display = "none";
        //document.getElementById('tblsize').style.display="none";
        document.getElementById('addetails').style.display = "none";
        document.getElementById('pagedetail').style.display = "none";
        document.getElementById('tblpackage').style.display = "none";
        document.getElementById('tbbox').style.display = "none";
        document.getElementById('tbvts').style.display = 'none';
        document.getElementById('txtciobookid').value = "";
        document.getElementById('LinkButton1').disabled = true;
        document.getElementById('LinkButton2').disabled = true;
        document.getElementById('LinkButton3').disabled = true;
        document.getElementById('LinkButton4').disabled = true;
        document.getElementById('LinkButton5').disabled = true;
        document.getElementById('LinkButton6').disabled = true;
        document.getElementById('LinkButton7').disabled = true;
    }
    //**************By Manish Verma***************************************************
    if (browser != "Microsoft Internet Explorer") {
        var httpRequest = null; ;
        httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml');
        }

        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

        httpRequest.open("GET", "insertMatter.aspx?receipt=" + cioid + "&modify=" + modifyMatter, false);
        httpRequest.send('');
        //alert(httpRequest.readyState);
        if (httpRequest.readyState == 4) {
            //alert(httpRequest.status);
            if (httpRequest.status == 200) {
                //id=httpRequest.responseText;
            }
            else {
                alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
            }
        }
    }
    else {
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        xml.Open("GET", "insertMatter.aspx?receipt=" + cioid + "&modify=" + modifyMatter, false);
        xml.Send();
    }
    //********************************************************************************

    //    return false;                          


}


function getvarval() {

    document.getElementById('hiddenvar').value = document.getElementById('drpvarient').value
}

//one time client for classified *14Aug*
///bhanu start
function clientblank() {
    document.getElementById("txtclient").focus();
    document.getElementById('txtclient').value = "";
    return false;
}
//one time client for classified *14Aug*
function chkcasualclient() {
    if (clientfromconfig == "UD") {
        if (document.getElementById('txtclient').value != "") {
            if (document.getElementById('drpregular').value == "RC") {
                if (document.getElementById('txtclient').value.lastIndexOf(")") < 0 || (document.getElementById("lstclient").style.visibility != "hidden" && document.getElementById("lstclient").style.visibility != "")) {

                    if (document.activeElement.id == "lstclient") {
                        document.getElementById("lstclient").focus();
                        return false;
                    }
                    alert("you are not authorized to select client without F2 key ");
                    document.getElementById("txtclient").focus();
                    document.getElementById('txtclient').value = "";
                    return false;
                }

            }
            if (document.getElementById('drpregular').value == "0") {
                alert("Please select Client Type");
                document.getElementById('txtclient').value = "";
                document.getElementById('drpregular').focus();
                return false;
            }
        }

    }
    //////bhanu end

    if (document.getElementById('txtclient').value != "") {
        var client = document.getElementById('txtclient').value;
        if (client.indexOf("(".toString()) > 0) {
            client = client.split('(')[0];
        }
        var compcode = document.getElementById('hiddencompcode').value;
        Classified_Booking.chkcasualcli(client, compcode, call_chkcasualcli);
        return false;
    }
}

/* *14Aug*  function call_chkcasualcli(res)
{
var ds=res.value;
if(ds.Tables[0]!=undefined)		        
{
document.getElementById('txtclient').value=ds.Tables[0].Rows[0].custname;
document.getElementById('txtclientadd').value=ds.Tables[0].Rows[0].add1;
		        
}
else
{		           
if(confirm('Do you want to register this client?'))
{
var frombooking="1";
var clientname=document.getElementById('txtclient').value;
window.open('ClientMaster.aspx?frombooking='+frombooking+'&clientname='+clientname,'','width='+screen.availWidth+',height='+screen.availHeight+',resizable=1,left=0,top=0,scrollbars=yes');
    		            
}
else
{
////////////if the client is casual than gray out credit period ,rono,rodate,rostatus,dockitno
		            
disbledroandcredit();
}		            
}
}*/

function call_chkcasualcli(res) {

    if (document.getElementById('txtclient').value.lastIndexOf(")") < 0) {
        var ds = res.value;
        if (ds.Tables[0] != undefined && ds.Tables[0].Rows[0].custname != undefined && document.getElementById('txtclient').value.lastIndexOf(")") < 0) {
            /* if(ds.Tables[0].Rows.length>0 && ds.Tables[0].Rows[0].custname!="0")
            {
            document.getElementById('txtclient').value=ds.Tables[0].Rows[0].custname;
            if(ds.Tables[0].Rows[0].add1!=null)
            {
            document.getElementById('txtclientadd').value=ds.Tables[0].Rows[0].add1;
            }
    		        
            }*/
            //else
            //{
            if (document.getElementById('hiddenregClient').value != "no" && document.activeElement.id != "lstclient") {
                if (confirm('Do you want to register this client?')) {
                    var frombooking = "1";
                    var clientname = document.getElementById('txtclient').value;
                    clientname = clientname.replace("&", "!");
                    window.open('ClientMaster.aspx?frombooking=' + frombooking + '&clientname=' + clientname, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0,scrollbars=yes');
                }
                else {
                    // new change for check registered client
                    var adcategory = document.getElementById('drpadcategory').value;
                    if (adcategory != "0") {
                        var res = Classified_Booking.getRegClientCheck(adcategory);
                        var dx = res.value;
                        if (dx != null && dx.Tables[0] != null && dx.Tables[0] != undefined) {
                            if (dx.Tables[0].Rows.length > 0) {
                                if (dx.Tables[0].Rows[0].REGCLIENT == "Y") {
                                    if (document.getElementById('txtclient').value.lastIndexOf('(') < 0) {
                                        alert("For Category " + document.getElementById('drpadcategory').options[document.getElementById('drpadcategory').selectedIndex].text + ", You can take only Registered Client");
                                        document.getElementById('txtclient').focus();
                                        return false;
                                    }
                                }
                                if (dx.Tables[0].Rows[0].DISC_AMT != null && dx.Tables[0].Rows[0].DISC_AMT != "") {
                                    document.getElementById('txtcatdisc').value = dx.Tables[0].Rows[0].DISC_AMT;
                                    document.getElementById('hdncatdisctype').value = dx.Tables[0].Rows[0].DISC_TY;
                                }
                            }
                        }
                    }
                }
            }
            //}
        }
        else {
            if (document.getElementById('hiddenregClient').value != "no" && document.activeElement.id != "lstclient") {
                if (confirm('Do you want to register this client?')) {
                    var frombooking = "1";
                    var clientname = document.getElementById('txtclient').value;
                    clientname = clientname.replace("&", "!");
                    window.open('ClientMaster.aspx?frombooking=' + frombooking + '&clientname=' + clientname, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0,scrollbars=yes');
                }
                else {
                    // new change for check registered client
                    var adcategory = document.getElementById('drpadcategory').value;
                    if (adcategory != "0") {
                        var res = Classified_Booking.getRegClientCheck(adcategory);
                        var dx = res.value;
                        if (dx != null && dx.Tables[0] != null && dx.Tables[0] != undefined) {
                            if (dx.Tables[0].Rows.length > 0) {
                                if (dx.Tables[0].Rows[0].REGCLIENT == "Y") {
                                    if (document.getElementById('txtclient').value.lastIndexOf('(') < 0) {
                                        alert("For Category " + document.getElementById('drpadcategory').options[document.getElementById('drpadcategory').selectedIndex].text + ", You can take only Registered Client");
                                        document.getElementById('txtclient').focus();
                                        return false;
                                    }
                                }
                                if (dx.Tables[0].Rows[0].DISC_AMT != null && dx.Tables[0].Rows[0].DISC_AMT != "") {
                                    document.getElementById('txtcatdisc').value = dx.Tables[0].Rows[0].DISC_AMT;
                                    document.getElementById('hdncatdisctype').value = dx.Tables[0].Rows[0].DISC_TY;
                                }
                            }
                        }
                    }
                }
            }
        }
        bind_agen_bill();
    }
}

//*14Aug* Get retainer name
function showretainervalue() {
    if (document.getElementById('lstretainer').value == "0") {
        var b = "Retainer";
        if (browser != "Microsoft Internet Explorer") {

            b = document.getElementById('lblretainer').textContent.replace("*[F2]", "");
        }
        else {

            b = document.getElementById('lblretainer').innerText.replace("*[F2]", "");
        }
        alert("Please Select " + b);
        return false;
    }


    document.getElementById('drpretainer').value = document.getElementById('lstretainer').options[document.getElementById('lstretainer').selectedIndex].text + "(" + document.getElementById('lstretainer').value + ")";
    document.getElementById('lstretainer').options.length = 0;
    document.getElementById("divretainer").style.display = "none";
    if (document.getElementById('drpretainer').value != "" && document.getElementById('drpretainer').value != "0") {
        document.getElementById('txtRetainercomm').value = "";
        var retain_name = document.getElementById('drpretainer').value.split('(');
        var retain_code = retain_name[1].replace(')', '');
          //////////add retainer anuja
                var agencycodesubcode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.lastIndexOf(')')); /*bhanu*/
                var res = Classified_Booking.getretaineragencycheck(retain_code, document.getElementById('hiddencompcode').value, agencycodesubcode);
                ds = res.value;
                if (ds != null) {
                    if (ds.Tables.length > 1 && ds.Tables[1].Rows[0].Column1 == "N") {
                        alert("Retainer have no premission of this Agency");
                        document.getElementById('drpretainer').value = "";
                        return false;
                    }
                }
                //////////////////////////////////////
        var ds_ret = Classified_Booking.getRetainerComm(retain_code, document.getElementById('hiddencompcode').value);

        if (ds_ret.value == null)
            return false;

        if (ds_ret.value.Tables[0].Rows.length > 0) {
            document.getElementById('retcommtype').value = ds_ret.value.Tables[0].Rows[0].Discount;
            document.getElementById('txtRetainercomm').value = ds_ret.value.Tables[0].Rows[0].retainercomm;
            document.getElementById('retcomm').value = ds_ret.value.Tables[0].Rows[0].retainercomm;
            if (document.getElementById('retcommtype').value == "Gross" && document.getElementById('txtgrossamt').value != "" && document.getElementById('txtRetainercomm').value != "" && document.getElementById('txtRetainercomm').value != null) {
                document.getElementById('txtRetainercommamt').value = (parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(document.getElementById('txtRetainercomm').value) / 100).toFixed(2);
            }
            else if (document.getElementById('retcommtype').value == "Net" && document.getElementById('txtbillamt').value != "" && document.getElementById('txtRetainercomm').value != "" && document.getElementById('txtRetainercomm').value != null) {
                document.getElementById('txtRetainercommamt').value = (parseFloat(document.getElementById('txtbillamt').value) * parseFloat(document.getElementById('txtRetainercomm').value) / 100).toFixed(2);
            }
        }
        var agencycodesubcode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.lastIndexOf(')')); /*bhanu*/
        var ds_ret_b = Classified_Booking.adretain_billbase_outstanding(document.getElementById('hiddencompcode').value, agencycodesubcode, retain_code, document.getElementById('txtdatetime').value, document.getElementById('hiddendateformat').value, document.getElementById('txtagencytype').value);
        if (ds_ret_b.value == null) {
            alert(ds_ret_b.error.description);
            return false;
        }
        if (ds_ret_b.value.Tables[0].Rows.length > 0) {
            if (ds_ret_b.value.Tables[0].Rows[0].REC_COUNT != null && ds_ret_b.value.Tables[0].Rows[0].OUT_AMT != null) {
                alert("This Retainer have " + ds_ret_b.value.Tables[0].Rows[0].REC_COUNT + " Pending Bill and Outstanding is " + ds_ret_b.value.Tables[0].Rows[0].OUT_AMT);
            }
        }

    }
    changediv();

    //return false;

}
//////////////



function getinsertscheme() {
    if (document.getElementById('drppackage').value == "0") {
        alert("Please select the package");
        globalschemedisc = "";
        globalschemefrom = "";
        gldisctyp = "";
        return false;
    }

    if (document.getElementById('drpschemepck').value != "0") {
        var schemecode = document.getElementById('drpschemepck').value;
        var compcode = document.getElementById('hiddencompcode').value;
        document.getElementById('drpscheme').value = document.getElementById('drpschemepck').value
        globalschemedisc = "";
        Classified_Booking.getinsertionscheme(schemecode, compcode, call_getinsertionscheme);

    }
    globalschemedisc = "";
    globalschemefrom = "";
    gldisctyp = "";
    return false;
}

function call_getinsertionscheme(response) {
    var ds = response.value;
    ds_sch = response.value;
    if (ds.Tables[0].Rows.length > 0) {
        document.getElementById('txtinsertion').value = ds.Tables[0].Rows[0].to_insertion_no
        globalschemedisc = ds.Tables[0].Rows[0].discount
        globalschemefrom = ds.Tables[0].Rows[0].From_Insertion_No
        gldisctyp = ds.Tables[0].Rows[0].discount_type
        onInsertionChange('');
    }
}



//new change bind package name
function addpkgname() {
    document.getElementById('txtcardrate').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    if (document.getElementById('drpadcategory').value == "0") {
        alert("Please select the category");
        document.getElementById('drpadcategory').focus();
        return false;
    }
    //    if(document.getElementById('drppackage').value=="0" || document.getElementById('drppackage').value=="")
    //    {
    //        alert("Please select the package");
    //        document.getElementById('drppackage').focus();
    //        return false;
    //    }
    var obj = document.getElementById('drppackagecopy');
    var cF = 0;
    for (var x = 0; x < obj.options.length; x++) {
        //if(document.getElementById('drppackage').value==obj[x].value.substring(0,obj[x].value.lastIndexOf('(')))
        if (drppack == obj[x].value.substring(0, obj[x].value.lastIndexOf('('))) {
            cF = 1;
        }
    }
    var dCheck = true;
    if (cF == 0)
        dCheck = openSelectionEdiionDiv();
    if (dCheck == false)
        return false;

    subtractrow = "";
    if (chkbtnStatus != "modify" && hidcopy == "") {
        for (var x = 0; x < obj.options.length; x++) {
            //if(document.getElementById('drppackage').value==obj[x].value.substring(0,obj[x].value.lastIndexOf('(')))
            if (drppack == obj[x].value.substring(0, obj[x].value.lastIndexOf('('))) {
                // alert("This package is already shifted");
                var insertCount = 1;
                if (obj[x].value.indexOf('(') >= 0) {
                    insertCount = obj[x].value.substring(obj[x].value.lastIndexOf('(') + 1, obj[x].value.length - 1);
                }
                var _val = getInsert(obj[x].value.substring(0, obj[x].value.lastIndexOf('@')));
                if (_val != "" && _val != null && _val != "0")
                    insertCount = parseInt(insertCount) + parseInt(_val);
                else
                    insertCount = parseInt(insertCount) + 1;
                obj[x].value = obj[x].value.substring(0, obj[x].value.lastIndexOf('(')) + '(' + insertCount + ')';
                obj[x].text = obj[x].text.substring(0, obj[x].text.lastIndexOf('(')) + '(' + insertCount + ')';
                onInsertionChange('');
                return false;
            }
        }
    }
    if (document.getElementById('hidmultisel').value == "N" && obj.options.length == 1) {
        alert("You can't take Muliple Package");
        return false;
    }
    // var strid = document.getElementById('drppackage').value;
    var strid = drppack;
    var compcode = document.getElementById('hiddencompcode').value;
    var strid1 = strid.split('@');
    var pkgid = strid1[0];
    var pkgname = strid1[1];
    glpkgname = pkgname;
    var value = "0";
    var dateday = "";
    var strtext = "";
    var code = "";
    var desc = "";
    if (pkgname.length > 500) {
        pkgname1 = "";
    }
    else {
        pkgname1 = pkgname;
    }

    if (browser != "Microsoft Internet Explorer") {
        var httpRequest = null;
        httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml');
        }

        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };
        var adcat = document.getElementById('drpadcategory').value;
        httpRequest.open("GET", "packagename.aspx?adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + value + "&pkgname=" + pkgname1 + "&dateday=" + dateday, false);
        httpRequest.send('');

        if (httpRequest.readyState == 4) {
            if (httpRequest.status == 200) {
                strtext = httpRequest.responseText;
            }
            else {
                alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
            }
        }
    }
    else {
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        var adcat = document.getElementById('drpadcategory').value;
        xml.Open("GET", "packagename.aspx?adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + value + "&pkgname=" + pkgname1 + "&dateday=" + dateday, false);
        xml.Send();
        strtext = xml.responseText;
    }
    if (strtext == "NOT A VALID DATE") {
        alert("NOT A VALID DATE");
        return false;
    }
    document.getElementById('pkgname').value = strtext;
    if (document.getElementById('drppackagecopy').options.length == 0) {
        che_flag = 0;
    }
    if (che_flag == 1) {
        alert("Can't select multiple Package");
        return false;
    }
    else if ((document.getElementById('drppackagecopy').options.length > 0) && (pkgname.indexOf(" or ") >= 0)) {
        alert("Can't select this Package");
        return false;
    }
    else {
        if (pkgname.indexOf(" or ") >= 0) {
            che_flag = 1;
            Classified_Booking.bindTable(pkgname, bindTable_callback);
            check_or = "1";
        }
        var val_ = "";
        var agencytype = "CL0"; // document.getElementById('drpadtype').value;
        if (browser != "Microsoft Internet Explorer") {
            var httpRequest = null; ;
            httpRequest = new XMLHttpRequest();
            if (httpRequest.overrideMimeType) {
                httpRequest.overrideMimeType('text/xml');
            }

            httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

            httpRequest.open("GET", "gettheinsertionfromcombin.aspx?desc=" + '' + "&code=" + pkgid + "&agencytype=" + agencytype, false);
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) {
                    val_ = httpRequest.responseText;
                }
                else {
                    alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                }
            }
        }
        else {
            var xml = new ActiveXObject("Microsoft.XMLHTTP");
            xml.Open("GET", "gettheinsertionfromcombin.aspx?desc=" + '' + "&code=" + pkgid + "&agencytype=" + agencytype, false);
            xml.Send();
            val_ = xml.responseText;
        }

        var insertO = document.getElementById('txtinsertion').value;
        document.getElementById('tempinsert').value = document.getElementById('txtinsertion').value;
        if (document.getElementById('tempinsert').value == "")
            document.getElementById('tempinsert').value = 1;
        if (insertO == "")
            insertO = 1;
        if (val_ != "" && val_ != "0" && val_ != null) {
            document.getElementById('txtinsertion').value = val_


        }
        if (che_flag == 0) {
            if (strtext != "0") {
                if (chkbtnStatus != "new" && hidcopy == "") {
                    document.getElementById('txtinsertion').disabled = true;
                    var code11 = pkgid
                    var clientname = document.getElementById('txtclient').value;
                    var client_split;
                    if (clientname.indexOf("(") >= 0) {
                        clientname = clientname.split("(");
                        client_split = clientname[1];
                        client_split = client_split.replace(")", "");
                        clientname = client_split;
                    }
                    var adcat3 = document.getElementById('drpadcat3').value;
                    var adcat4 = document.getElementById('drpadcat4').value;
                    var adcat5 = document.getElementById('drpadcat5').value;
                    var insert = document.getElementById('hiddeninserts').value;
                    var class_insert = document.getElementById('txtinsertion').value;
                    var lines_to;
                    if (document.getElementById('txtadsize1').disabled == false) {
                        lines_to = "";
                    }
                    else {
                        lines_to = document.getElementById('txttotalarea').value;
                    }
                    var curdt = dateincrease(document.getElementById('currdate').value, "1", modifydtcount);
                    modifyAddItem(document.getElementById('drppackagecopy'), strtext, strid);

                    var ds_linedrop = Classified_Booking.getData(glpkgname + "(1)", 1, document.getElementById('txtrepeatingdate').value, curdt, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, "CL0", document.getElementById('drpcurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code11, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname);

                    modifyLine_callback(ds_linedrop);
                    modifydtcount = parseInt(modifydtcount) + 1;
                }
                else {
                    AddItem(document.getElementById('drppackagecopy'), strtext, strid, val_);
                }  
            }
            if (document.getElementById('txtdummydate').disabled == false)
                document.getElementById('txtdummydate').focus();
        }
        //document.getElementById('txtinsertion').value = insertO;
    }

    // document.getElementById('drpuom').focus();
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    return false;
}


function AddItem(objListBox, strText, strId, val_) {
    suboradd = "1";
    previnsertion = "0";
    noissueflag = true;
    getid = "";
    if (strText.indexOf('(') < 0) {
        strText = strText + '(1)';
        strId = strId + '(1)';
    }
    //objListBox.options[objListBox.options.length] = new Option(strText,strId);
    //  objListBox.options.length;

    //     
    //==For package in sequence..
    if (objListBox.length > 0) {

        var arr = new Array();
        var arr1 = new Array();
        for (j = 0; j <= objListBox.length - 1; j++) {
            //arr[j] = objListBox.options(j).text;
            arr[j] = objListBox.options[j].text;
            arr1[j] = objListBox.options[j].value;
        }

        for (k = objListBox.length - 1; k >= 0; k--)
        { objListBox.remove(k); }

        var opt = document.createElement("OPTION");
        opt.text = strText;
        opt.value = strId;
        objListBox.options.add(opt);

        var x = 0;
        for (x in arr) {
            if (x != "remove") {
                var option = document.createElement("OPTION");
                option.text = arr[x];
                option.value = arr1[x];
                objListBox.options.add(option);
            }
        }

    }
    else {
        //alert("bhanu");
        var opt = document.createElement("OPTION");
        opt.text = strText;
        opt.value = strId;
        objListBox.options.add(opt);


    }
    if (val_ != "" && val_ != "0" && val_ != null) {
        var obj = document.getElementById('drppackagecopy');
        for (var x = 0; x < obj.options.length; x++) {
            if (document.getElementById('drppackage').value == obj[x].value.substring(0, obj[x].value.lastIndexOf('('))) {
                // alert("This package is already shifted");
                var insertCount = val_;
                var insertCount1 = 0;
                if (obj[x].value.indexOf('(') >= 0) {
                    insertCount1 = obj[x].value.substring(obj[x].value.lastIndexOf('(') + 1, obj[x].value.length - 1);
                    insertCount1 = parseInt(insertCount1) - 1;
                }
                insertCount = parseInt(insertCount) + parseInt(insertCount1);
                obj[x].value = obj[x].value.substring(0, obj[x].value.lastIndexOf('(')) + '(' + insertCount + ')';
                obj[x].text = obj[x].text.substring(0, obj[x].text.lastIndexOf('(')) + '(' + insertCount + ')';
                x = obj.options.length;
            }
        }
    }
    //====//
    document.getElementById('hiddencalendar').value = "0";
    document.getElementById('txtrepeatingdate').value = "";
    insertLinedrop();
    /*new change ankur 15 feb */
    /////this is to bind the fontcolor drpdown,bgcolordrpdown and bullet  dropdown

    // bindbgandfont()
    //sbinduomonedition();
    //////////////////

    /*new change ankur 27 feb*/
    /////this is to bind the uom drop down  on the behalf of edition selected and if pkg than on the edition perirority




}
function removepkgname() {

    if (document.getElementById('drppackagecopy').options.length == 0) {
        alert("There is no item to delete");
        cali = 0;
        agreedrate_active = 0;
        agreedamt_active = 0;
        arrEdition_Item = '';
        return false;

    }

    else if (document.getElementById('drppackagecopy').value == "") {
        alert("Please select the package for delete");
        document.getElementById('chktfn').focus();
        return false;
    }
    var strId = document.getElementById('drppackagecopy').value;

    // insertLinesubtract_callback(strId,'child');
    RemoveItem(document.getElementById('drppackagecopy'), strId);
    if (document.getElementById('drppackagecopy').options.length != 0) {
        document.getElementById('hiddencalendar').value = "0";
        insertLinedrop();
    }
    else {
        document.getElementById('tblinsert').innerHTML = "";
        document.getElementById('hiddencalendar').value = "0";
        //document.getElementById('drpscheme').value="0";
        document.getElementById('drpscheme').value = "0";
        globalschemedisc = "";
        check_or = "0";
        document.getElementById('tempinsert').value = "";
    }
    if (document.getElementById('drppackagecopy').options.length == 0) {
        agreedrate_active = 0;
        agreedamt_active = 0;
        cali = 0;
        sharepub = "";
        dummydate = "";
        arrEdition_Item = '';
        document.getElementById('txtdummydate').value = "";
        document.getElementById('tempinsert').value = "";
        caldate = null;
        caldate = new Array();
        caldatemonth = null;
        caldatemonth = new Array();
        caldateyear = null;
        caldateyear = new Array();
        document.getElementById('drpdiscountprem').value = "0";
        document.getElementById('drppageposition').value = "0";
    }
    return false;
}
function RemoveItem(objListBox, strId) {
    var intIndex = GetItemIndex(objListBox, strId);
    if (strId.indexOf('(') >= 0) {
        var no = strId.substring(strId.lastIndexOf('(') + 1, strId.lastIndexOf(')'));
        var pkgcode = strId.substring(0, strId.lastIndexOf('@'));
        if (parseInt(no) != 1) {
            var _val = getInsert(pkgcode);
            if (_val != "" && _val != "0" && _val != null) {
                no = parseInt(no) - parseInt(_val);
            }
            else {
                no = parseInt(no) - 1;
            }
            if (no == 0) {
                if (intIndex != -1) {
                    objListBox.remove(intIndex);

                }
            }
            else {
                objListBox.options[intIndex].value = objListBox.options[intIndex].value.substring(0, objListBox.options[intIndex].value.lastIndexOf('(')) + '(' + no + ')';
                objListBox.options[intIndex].text = objListBox.options[intIndex].text.substring(0, objListBox.options[intIndex].text.lastIndexOf('(')) + '(' + no + ')';

            }
        }
        else {
            if (intIndex != -1)
                objListBox.remove(intIndex);
        }
    }
    else {
        if (intIndex != -1)
            objListBox.remove(intIndex);
    }
}
function GetItemIndex(objListBox, strId) {
    for (var i = 0; i < objListBox.children.length; i++) {
        var strCurrentValueId = objListBox.children[i].value;
        if (strId == strCurrentValueId) {
            return i;
        }
    }
    return -1;
}

///this is the function which changes the background color on focus
function changebackcolor(e) {
    var idfoc = e.id;
    if (idfocus != "") {
        document.getElementById(idfocus).style.backgroundColor = "";
    }
    document.getElementById(idfoc).style.backgroundColor = "#FFFF80";

    idfocus = e.id;

}

function chkpublishdate(idval, iddat) {
    var pub = document.getElementById(idval).value;
    if (pub == "publish") {
        var pubdate = new Date(document.getElementById(iddat).value);
        var currdate = new Date();
        if (currdate < pubdate) {
            alert("For publication current date should be less");
            document.getElementById(idval).value = "booked";



        }
    }
    return false;
    //

}

////////////////////////when we select the credit from the dropdown than on change credit detail div opens 
function showcreditdetail() {
    if (document.getElementById('drppaymenttype').value == "CA0") {
        if (!confirm("Are you sure want to take paymode Cash")) {
            document.getElementById('drppaymenttype').value = 0;
        }
    }
    var ag = Classified_Booking.GETCASH_PAY(document.getElementById('hiddencompcode').value, document.getElementById('drppaymenttype').value);
    var ds_n = ag.value;
    var cashdiscount = 'N';
    if (ds_n != null && ds_n.Tables[0].Rows.length > 0) {
        cashdiscount = ds_n.Tables[0].Rows[0].CASHDISCOUNT;
    }
    document.getElementById('txtbillamt').value = "";
    document.getElementById('txtagencypaymode').value = document.getElementById('drppaymenttype').value;
    if (document.getElementById('txtagencypaymode').value != "")
        document.getElementById('hiddenpaymode').value = document.getElementById('txtagencypaymode').options[document.getElementById('txtagencypaymode').selectedIndex].text;
    if (document.getElementById('drppaymenttype').value == "CR0")  //CR0 is Credit Card code
    {
        document.getElementById('tdcarname').style.display = "";
        document.getElementById('tdtxtcarname').style.display = "";
        document.getElementById('tdtype').style.display = "";
        document.getElementById('tddrptyp').style.display = "";
        document.getElementById('tdexdat').style.display = "";

        document.getElementById('tdtxtexdat').style.display = "";
        document.getElementById('tdcardno').style.display = "";
        document.getElementById('tdtxtcarno').style.display = "";
        document.getElementById('hiddenbillpay').value = document.getElementById('drppaymenttype').value;

        document.getElementById('txtcardname').disabled = false;
        document.getElementById('drptype').disabled = false;
        document.getElementById('drpmonth').disabled = false;
        document.getElementById('drpyear').disabled = false;
        document.getElementById('txtcardno').disabled = false;

        document.getElementById('tdrec').style.display = "none";
        document.getElementById('receipt').style.display = "none";
        document.getElementById('print').style.display = "none";

        document.getElementById('tdchqno').style.display = "none";
        document.getElementById('tdourbank').style.display = "none";
        document.getElementById('tdchqdate').style.display = "none";
        document.getElementById('tdchqamt').style.display = "none";
        document.getElementById('tdbankname').style.display = "none";
        document.getElementById('tdourbank').style.display = "none";


        document.getElementById('tdtextchqno').style.display = "none";
        document.getElementById('tdtextchqdate').style.display = "none";
        document.getElementById('tdtextchqamt').style.display = "none";
        document.getElementById('tdtextbankname').style.display = "none";
        document.getElementById('tdtextourbank').style.display = "none";
        document.getElementById("txtreceipt").value = "";
        document.getElementById('cashrecvd').style.display = "none";
        //  document.getElementById('tdcashrecvd').style.display="none";
        document.getElementById('drpcashrecieved').disabled = true;
        document.getElementById('txtcashdiscount').disabled = true;
    }
    else if (document.getElementById('drppaymenttype').value == "CH0" || document.getElementById('drppaymenttype').value == "DD0" || document.getElementById('drppaymenttype').value == 'PO0' || document.getElementById('drppaymenttype').value == 'AD0')  //CR0 is Credit Card code and DD0 is demand draft
    {
        document.getElementById('ttextchqno').disabled = false;
        document.getElementById('ttextchqdate').disabled = false;
        document.getElementById('ttextchqamt').disabled = false;
        document.getElementById('ttextbankname').disabled = false;
        document.getElementById('drpourbank').disabled = false;

        document.getElementById('tdchqno').style.display = "";
        document.getElementById('tdourbank').style.display = "";
        document.getElementById('tdchqdate').style.display = "";
        document.getElementById('tdchqamt').style.display = "";
        document.getElementById('tdbankname').style.display = "";

        document.getElementById('tdtextchqno').style.display = "";
        document.getElementById('tdtextourbank').style.display = "";
        document.getElementById('tdtextchqdate').style.display = "";
        document.getElementById('tdtextchqamt').style.display = "";
        document.getElementById('tdtextbankname').style.display = "";
        document.getElementById('hiddenbillpay').value = document.getElementById('drppaymenttype').value;

        document.getElementById('tdrec').style.display = "none";
        document.getElementById('receipt').style.display = "none";
        document.getElementById('print').style.display = "none";
        document.getElementById('tdcarname').style.display = "none";
        document.getElementById('tdtxtcarname').style.display = "none";
        document.getElementById('tdtype').style.display = "none";
        document.getElementById('tddrptyp').style.display = "none";
        document.getElementById('tdexdat').style.display = "none";

        document.getElementById('tdtxtexdat').style.display = "none";
        document.getElementById('tdcardno').style.display = "none";
        document.getElementById('tdtxtcarno').style.display = "none";

        document.getElementById("txtreceipt").value = "";
        document.getElementById('cashrecvd').style.display = "none";
        // document.getElementById('tdcashrecvd').style.display="none";
        document.getElementById('drpcashrecieved').disabled = true;
        document.getElementById('txtcashdiscount').disabled = true;
    }
    else if (document.getElementById('drppaymenttype').value == "CA0") {
        document.getElementById('tdcarname').style.display = "none";
        document.getElementById('tdtxtcarname').style.display = "none";
        document.getElementById('tdtype').style.display = "none";
        document.getElementById('tddrptyp').style.display = "none";
        document.getElementById('tdexdat').style.display = "none";

        document.getElementById('tdtxtexdat').style.display = "none";
        document.getElementById('tdcardno').style.display = "none";
        document.getElementById('tdtxtcarno').style.display = "none";

        document.getElementById('txtcardname').value = "";
        document.getElementById('drptype').value = "0";
        document.getElementById('drpmonth').value = "0";
        document.getElementById('drpyear').value = "0";
        document.getElementById('txtcardno').value = "";
        document.getElementById("txtreceipt").value = "";

        document.getElementById('tdchqno').style.display = "none";
        document.getElementById('tdourbank').style.display = "none";
        document.getElementById('tdchqdate').style.display = "none";
        document.getElementById('tdchqamt').style.display = "none";
        document.getElementById('tdbankname').style.display = "none";

        document.getElementById('tdtextchqno').style.display = "none";
        document.getElementById('tdtextourbank').style.display = "none";
        document.getElementById('tdtextchqdate').style.display = "none";
        document.getElementById('tdtextchqamt').style.display = "none";
        document.getElementById('tdtextbankname').style.display = "none";

        document.getElementById('ttextchqno').value = "";
        document.getElementById('ttextchqdate').value = "";
        document.getElementById('ttextchqamt').value = "";
        document.getElementById('ttextbankname').value = "";
        document.getElementById('drpourbank').value = "0";
        document.getElementById('cashrecvd').style.display = "";
        //document.getElementById('tdcashrecvd').style.display="";
        document.getElementById('drpcashrecieved').disabled = false;
        document.getElementById('txtcashdiscount').disabled = false;
        document.getElementById('hiddenbillpay').value = document.getElementById('drppaymenttype').value;

    }
    else {
        document.getElementById('cashrecvd').style.display = "none";
        // document.getElementById('tdcashrecvd').style.display="none";
        document.getElementById('drpcashrecieved').disabled = true;
        document.getElementById('txtcashdiscount').disabled = true;
        document.getElementById('tdcarname').style.display = "none";
        document.getElementById('tdtxtcarname').style.display = "none";
        document.getElementById('tdtype').style.display = "none";
        document.getElementById('tddrptyp').style.display = "none";
        document.getElementById('tdexdat').style.display = "none";

        document.getElementById('tdtxtexdat').style.display = "none";
        document.getElementById('tdcardno').style.display = "none";
        document.getElementById('tdtxtcarno').style.display = "none";

        document.getElementById('txtcardname').value = "";
        document.getElementById('drptype').value = "0";
        document.getElementById('drpmonth').value = "0";
        document.getElementById('drpyear').value = "0";
        document.getElementById('txtcardno').value = "";
        document.getElementById("txtreceipt").value = "";

        document.getElementById('tdchqno').style.display = "none";
        document.getElementById('tdourbank').style.display = "none";
        document.getElementById('tdchqdate').style.display = "none";
        document.getElementById('tdchqamt').style.display = "none";
        document.getElementById('tdbankname').style.display = "none";

        document.getElementById('tdtextchqno').style.display = "none";
        document.getElementById('tdtextourbank').style.display = "none";
        document.getElementById('tdtextchqdate').style.display = "none";
        document.getElementById('tdtextchqamt').style.display = "none";
        document.getElementById('tdtextbankname').style.display = "none";

        document.getElementById('ttextchqno').value = "";
        document.getElementById('ttextchqdate').value = "";
        document.getElementById('ttextchqamt').value = "";
        document.getElementById('ttextbankname').value = "";
        document.getElementById('drpourbank').value = "0";
        document.getElementById('hiddenbillpay').value = document.getElementById('drppaymenttype').value;
    }
    if (cashdiscount == 'N') {
        document.getElementById('cashrecvd').style.display = "none";
        document.getElementById('drpcashrecieved').disabled = true;
        document.getElementById('txtcashdiscount').disabled = true;
    }
    else {
        document.getElementById('cashrecvd').style.display = "";
        document.getElementById('drpcashrecieved').disabled = false;
        document.getElementById('txtcashdiscount').disabled = false;
    }
    return false;
}
function call_receipt(res) {
    var ds = res.value;
    var center = "";
    var preferreceipt = document.getElementById('hiddenprereceipt').value;

    var zeros = "";

    if (document.getElementById('receipt').style.display == "block") {
        var pre = document.getElementById("hiddenprefix").value
        var suf = document.getElementById("hiddensufix").value
        if (ds != null) {
            if (ds.Tables[0].Rows.length > 0 && ds.Tables[0].Rows[0].recno != null) {
                var val = ds.Tables[0].Rows[0].recno;
                var vallen = val.toString().length;
                // val=parseInt(val)+1;
                if (preferreceipt == "1") {
                    center = document.getElementById('txtbranch').value.substring(0, 3);
                }
                else if (preferreceipt == "2") {
                    center = document.getElementById('txtagency').value.substring(0, 3);
                }
                if (vallen == 0) {
                    zero = "000000";
                }
                else if (vallen == 1) {
                    zero = "00000" + val;
                }
                else if (vallen == 2) {
                    zero = "0000" + val;
                }
                else if (vallen == 3) {
                    zero = "000" + val;
                }
                else if (vallen == 4) {
                    zero = "000" + val;
                }
                else if (vallen == 5) {
                    zero = "00" + val;
                }
                else if (vallen == 6) {
                    zero = "0" + val;
                }
                document.getElementById("txtreceipt").value = center + zero;
                if (preferreceipt == "3") {
                    document.getElementById("txtreceipt").value = "";
                    document.getElementById("txtreceipt").value = pre + val + suf;
                }
            }
            else {
                document.getElementById("txtreceipt").value = pre + 0000 + suf;
            }
        }
        else {
            document.getElementById("txtreceipt").value = pre + 0000 + suf;
        }
        document.getElementById('hiddenreceiptno').value = document.getElementById("txtreceipt").value

    }


}


//////if on query it is to show that if in the database the value is credit card than show the card no,name and other inf.
function showcardinfo(caval) {
    if (caval == "CR0") {
        document.getElementById('tdcarname').style.display = "";
        document.getElementById('tdtxtcarname').style.display = "";
        document.getElementById('tdtype').style.display = "";
        document.getElementById('tddrptyp').style.display = "";
        document.getElementById('tdexdat').style.display = "";
        document.getElementById('tdtxtexdat').style.display = "";
        document.getElementById('tdcardno').style.display = "";
        document.getElementById('tdtxtcarno').style.display = "";

        return false;
    }
    else {
        document.getElementById('tdcarname').style.display = "none";
        document.getElementById('tdtxtcarname').style.display = "none";
        document.getElementById('tdtype').style.display = "none";
        document.getElementById('tddrptyp').style.display = "none";
        document.getElementById('tdexdat').style.display = "none";

        document.getElementById('tdtxtexdat').style.display = "none";
        document.getElementById('tdcardno').style.display = "none";
        document.getElementById('tdtxtcarno').style.display = "none";

        return false;

    }
}
function getvalueintohidden() {
    document.getElementById('hiddenbillto').value = document.getElementById('drpbillto').value
    return false;

}

function exitbook() {
    if (confirm("Do You Want To Skip This Page")) {
        window.close();
    }
    return false;

}

function disablelistbox() {

    document.getElementById("div1").style.display = "none"
    document.getElementById("divclient").style.display = "none"
    document.getElementById("divproduct").style.display = "none"
    document.getElementById("divexec").style.display = "none"



}

function getintohidden() {
    document.getElementById('hiddenpay').value = document.getElementById('txtagencypaymode').value;
    return false;

}
function chkmonth() {
    var curdat = document.getElementById('txtdatetime').value;
    var txt = curdat.split("/");
    if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
        curdat = txt[0] + "/" + txt[1] + "/" + txt[2];
    }
    else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
        curdat = txt[1] + "/" + txt[0] + "/" + txt[2]; ;
    }
    else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
        curdat = txt[1] + "/" + txt[2] + "/" + txt[0]; ;
    }

    var chkcurrdate = new Date(curdat);
    var month = chkcurrdate.getMonth() + 1;
    var year = chkcurrdate.getFullYear();

    if (parseInt(document.getElementById('drpmonth').value) < parseInt(month)) {
        alert("Month should be greater than current month");
        document.getElementById('drpmonth').value = "0";
        document.getElementById('drpmonth').focus();
        return false;


    }

}

function chkyear() {
    var curdat = document.getElementById('txtdatetime').value;
    var txt = curdat.split("/");
    if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
        curdat = txt[0] + "/" + txt[1] + "/" + txt[2];
    }
    else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
        curdat = txt[1] + "/" + txt[0] + "/" + txt[2]; ;
    }
    else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
        curdat = txt[1] + "/" + txt[2] + "/" + txt[0]; ;
    }
    var chkcurrdate = new Date(curdat);
    var month = chkcurrdate.getMonth() + 1;
    var year = chkcurrdate.getFullYear();

    if (parseInt(document.getElementById('drpyear').value) < parseInt(year)) {
        alert("Year should be greater than or equal to current Year");
        document.getElementById('drpyear').value = "0";
        document.getElementById('drpyear').focus();
        return false;


    }
    if (parseInt(document.getElementById('drpyear').value) == parseInt(year) && parseInt(document.getElementById('drpmonth').value, 10) < parseInt(month, 10)) {
        alert("Month should be greater than current month");
        document.getElementById('drpmonth').value = "0";
        document.getElementById('drpmonth').focus();
        return false;
    }
}

/*  *25Aug*
function printreceipt()
{
var billamt=document.getElementById('txtbillamt').value
var cli=document.getElementById('txtclient').value;
var curr=document.getElementById('drpcurrency').value;
var packagedetail=document.getElementById('drpcurrency').value;
var objpack=document.getElementById('drppackagecopy');
var temp="";
var tempcode="";
var tempval="";
var tempvalcode="";
var desc="";
var code="";
var i=objpack.options.length;
var j;

for(j=0;j<i;j++)
{
if(parseInt(i)>0)
{
tempval=objpack[j].value;
//tempvalcode=objpack[j].value;
if(temp!="")
{
temp=tempval.split("@");
tempvalcode=temp[0];
tempcode=temp[1];
code=tempvalcode+","+code;
desc=tempcode+","+desc;
                                            
                                            
}
else
{
temp=tempval.split("@");
tempvalcode=temp[0];
tempcode=temp[1];
code=tempvalcode;
desc=tempcode;
}
}
                                
}
///////////////this is to call the print page to print the receipt no
if(billamt!="")
{
window.open('printreceipt.aspx?billamt='+billamt+'&cli='+cli+'&curr='+curr+'&desc='+desc,'','width=500px,height=500px,resizable=1,left=0,top=0,scrollbars=yes');
}    
else
{
alert("Please get the bill amount");
}
return false;    
} */

//**************

//function printreceipt()
//{   
//    var billamt=document.getElementById('txtgrossamt').value
//    var cli=document.getElementById('txtclient').value;
//    var curr=document.getElementById('hiddencurrency').value;
//    var packagedetail=document.getElementById('hiddencurrency').value;
//    var objpack=document.getElementById('drppackagecopy');
//    var temp="";
//    var tempcode="";
//    var tempval="";
//    var tempvalcode="";
//    var desc="";
//    var code="";
//    var i=objpack.options.length;
//    var j;

//    for(j=0;j<i;j++)
//    {
//        if(parseInt(i)>0)
//        {
//            tempval=objpack[j].value;
//                                        
//            if(temp!="")
//            {
//                temp=tempval.split("@");
//                tempvalcode=temp[0];
//                tempcode=temp[1];
//                code=tempvalcode+","+code;
//                desc=tempcode+","+desc;     
//             }
//             else
//             {
//                 temp=tempval.split("@");
//                 tempvalcode=temp[0];
//                 tempcode=temp[1];
//                 code=tempvalcode;
//                 desc=tempcode;
//             }
//          }
//                                
//      }
//                                ///////////////this is to call the print page to print the receipt no
//      //  if(document.getElementById('txtclient').value=="")
//       // {
//           // alert("Please Fill the Client Name");
//          //  return false;
//       // }
//      //  if(billamt!="")
//       // {
//            //window.open('printreceipt.aspx?billamt='+billamt+'&cli='+cli+'&curr='+curr+'&desc='+desc,'','width=500px,height=500px,resizable=1,left=0,top=0,scrollbars=yes');
//            
//            var cioid=document.getElementById('txtciobookid').value;  //document.getElementById('hiddencioid').value;
//            
//            
//            var client="";
//            if(document.getElementById('hiddenclientname').value=="")
//            {
//                client=document.getElementById('txtclient').value;
//            }
//            else
//            {
//                client=document.getElementById('hiddenclientname').value;
//            }    
//            var clientadd="";
//            if(document.getElementById('hiddenclientaddress').value=="")
//            {
//                document.getElementById('hiddenclientaddress').value=document.getElementById('txtclientadd').value;
//            }
//            clientadd=document.getElementById('hiddenclientaddress').value;
//            var receiptno=document.getElementById('hiddenreceiptno').value;
//            if(document.getElementById('txtreceipt').value!="")
//            {
//                document.getElementById('hiddenreceiptno').value=receiptno=document.getElementById('txtreceipt').value;
//                receiptno=document.getElementById('hiddenreceiptno').value;
//            }
//            window.open("ClassifiedReceipt.aspx?cioid="+cioid+"&clientname="+client+"&clientadd="+clientadd+"&receiptno="+receiptno);//,'','width=1000px,height=550px,resizable=1,left=0,top=0,scrollbars=yes');      
//    }


//*************************


function printwindow() {
    document.getElementById('Button1').style.display = "none";
    window.print();
    document.getElementById('Button1').style.display = "block";

}

function getpageareaintogrid(h, w) {
    var len = "bookdiv";
    var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    var i = 0;
    var k;
    var height;
    var width;
    var coll;
    var size;
    var file_nam;
    var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
    for (k = 0; i < y - 1; k++) {
        while (document.getElementById("card" + i) == null && k < y - 1) {
            i = i + totid;

        }
        if (k >= y - 1) {
            break;
        }


        height = "hei" + i;
        width = "wid" + i;
        size = "siz" + i;
        coll = "nocol" + i;
        file_nam = "fil" + i;
        document.getElementById(height).value = h;
        document.getElementById(width).value = w;
        document.getElementById(coll).value//=document.getElementById('txtcolum').value
        if (document.getElementById(coll).value != "") {
            document.getElementById(size).value = parseFloat(h) * parseFloat(document.getElementById(coll).value);
            document.getElementById(file_nam).value = "";
        }
        else if (w != "") {
            document.getElementById(size).value = parseFloat(h) * parseFloat(w);
            document.getElementById(file_nam).value = "";
        }
        else if (w == "" && document.getElementById(coll).value != "") {
            document.getElementById(size).value = parseFloat(h) * parseFloat(document.getElementById(coll).value);
            document.getElementById(file_nam).value = "";
        }
        if (document.getElementById(size).value == "NaN") {
            document.getElementById(size).value = "";
            document.getElementById(file_nam).value = "";
        }

        i++;

    }

} // JScript File Classified_Booking

function disbledroandcredit() {
    ///////////////////this is to chk that the client is casual or not

    var clientcode = document.getElementById('txtclient').value;
    if (clientcode.indexOf("(") > 0) {
        var clientsplit = clientcode.split("(");
        var compcode = document.getElementById('hiddencompcode').value;
        clientsplit = clientsplit[1];
        clientsplit = clientsplit.replace(")", "");
        Classified_Booking.chkcasualclient(clientsplit, compcode, call_chkcasual);
        return false;
    }
    else {
        document.getElementById('txtrono').disabled = true;
        document.getElementById('txtrono').style.backgroundColor = "Gray";
        document.getElementById('txtrodate').disabled = true;
        document.getElementById('txtrodate').style.backgroundColor = "Gray";
        //document.getElementById('drprostatus').value="0";
        document.getElementById('drprostatus').disabled = true;
        document.getElementById('txtkeyno').value = "";
        document.getElementById('txtkeyno').disabled = true;
        document.getElementById('txtkeyno').style.backgroundColor = "Gray";
        document.getElementById('drprostatus').style.backgroundColor = "Gray";
        document.getElementById('txtcreditperiod').style.backgroundColor = "Gray";
        document.getElementById('txtdockitno1').style.backgroundColor = "Gray";
    }

}

function call_chkcasual(res) {
    var ds = res.value;
    document.getElementById('hndalert1').value = "";
    if (ds !== null && ds.Tables[0] != null && ds.Tables[0] != undefined) {
        if (ds.Tables[0].Rows.length > 0) {
            document.getElementById('txtrono').disabled = false;
            document.getElementById('txtrono').style.backgroundColor = "White";
            document.getElementById('txtrodate').disabled = false;
            document.getElementById('txtrodate').style.backgroundColor = "White";
            document.getElementById('drprostatus').value = "0";
            document.getElementById('drprostatus').disabled = false;
            document.getElementById('txtkeyno').value = "";
            document.getElementById('txtkeyno').disabled = false;
            document.getElementById('txtkeyno').style.backgroundColor = "White";
            document.getElementById('drprostatus').style.backgroundColor = "White";
            document.getElementById('txtcreditperiod').style.backgroundColor = "White";
            document.getElementById('txtdockitno1').style.backgroundColor = "White";
            if (ds.Tables[0].Rows[0].Remarks != null && ds.Tables[0].Rows[0].Remarks != "") {
                document.getElementById('hndalert1').value = ds.Tables[0].Rows[0].Remarks;
                alert(ds.Tables[0].Rows[0].Remarks);
            }
            if (ds.Tables[0].Rows[0].DISC_AMT != null && ds.Tables[0].Rows[0].DISC_AMT != "") {
                document.getElementById('txtclientcatdisc').value = ds.Tables[0].Rows[0].DISC_AMT;
                document.getElementById('hdnclientcatdistype').value = ds.Tables[0].Rows[0].DISC_TY;
            }
            if (ds.Tables[0].Rows[0].F_FREQ_DISC_AMT != null && ds.Tables[0].Rows[0].F_FREQ_DISC_AMT != "") {
                document.getElementById('txtflatfreqdisc').value = ds.Tables[0].Rows[0].F_FREQ_DISC_AMT;
                document.getElementById('hdnflatfreqdisctype').value = ds.Tables[0].Rows[0].F_FREQ_DISC_TY;
            }
        }
        else {
            document.getElementById('txtrono').disabled = true;
            document.getElementById('txtrono').style.backgroundColor = "Gray";
            document.getElementById('txtrodate').disabled = true;
            document.getElementById('txtrodate').style.backgroundColor = "Gray";
            document.getElementById('drprostatus').value = "0";
            document.getElementById('drprostatus').disabled = true;
            document.getElementById('txtkeyno').value = "";
            document.getElementById('txtkeyno').disabled = true;
            document.getElementById('txtkeyno').style.backgroundColor = "Gray";
            document.getElementById('drprostatus').style.backgroundColor = "Gray";
            document.getElementById('txtcreditperiod').style.backgroundColor = "Gray";
            document.getElementById('txtdockitno1').style.backgroundColor = "Gray";

        }

    }

}

/////////this is to bind the ad s cat3 drpdown on change of ad sub cat drop down

function bindadscat3() {
    lostfocusPackagecat(document.getElementById('drpadsubcategory'));
    var adscat = document.getElementById('drpadsubcategory').value;
    var compcode = document.getElementById('hiddencompcode').value;
    ///if 0 than it is to bind ad cat3 drp down
    Classified_Booking.bindadcat3(adscat, compcode, "0", call_bindadcat3);
    return false;


}

function call_bindadcat3(res) {
    var ds = res.value;
    var pkgitem = document.getElementById("drpadcat3");
    pkgitem.options.length = 0;
    document.getElementById('drpadcat4').options.length = 0;
    document.getElementById('drpadcat5').options.length = 0
    pkgitem.options[0] = new Option("-Select ad s cat-", "0");
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {

        pkgitem.options.length = 1;
        for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].catname, ds.Tables[0].Rows[i].catcode);

            pkgitem.options.length;

        }

    }
    //BIND SUBCATEGORY IN GRID
    if (document.getElementById('bookdiv') != null) {
        var len = "bookdiv";
        var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
        var k;
        var adsubcat;
        var i = 0;
        var adsubcategoryval = document.getElementById('drpadsubcategory').value;
        for (k = 0; k < y - 1; k++) {

            adsubcat = "ads" + i;
            document.getElementById(adsubcat).value = adsubcategoryval;


            i = parseInt(i) + 1;

        }
        document.getElementById('hiddenadscat3').value = document.getElementById("drpadcat3").value;
    }
    tooltipadsubcat();
}

function bindadscat4() {
    lostfocusPackagecat(document.getElementById('drpadcat3'));
    var adscat = document.getElementById('drpadcat3').value;
    document.getElementById('hiddenadscat3').value = document.getElementById("drpadcat3").value;
    var compcode = document.getElementById('hiddencompcode').value;
    ///if 1 than it is to bind ad cat4 drp down
    Classified_Booking.bindadcat3(adscat, compcode, "1", call_bindadcat4);
    return false;


}
function call_bindadcat4(res) {
    var ds = res.value;
    var pkgitem = document.getElementById("drpadcat4");
    pkgitem.options.length = 0;
    document.getElementById('drpadcat5').options.length = 0
    pkgitem.options[0] = new Option("-Select ad s cat-", "0");
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {

        pkgitem.options.length = 1;
        for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].Cat_Name, ds.Tables[0].Rows[i].Cat_Code);

            pkgitem.options.length;

        }

    }
    document.getElementById('hiddenadscat4').value = document.getElementById("drpadcat4").value;

}

//////////////////this functrion is to get the selected bullet premium

function getbullpremium() {
    var bulletcode = document.getElementById('drpbullet').value;
    var compcode = document.getElementById('hiddencompcode').value;
    var date = document.getElementById('txtdatetime').value;
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    if (bulletcode != "0") {
        var res = Classified_Booking.getbullprem(compcode, bulletcode, date, document.getElementById('txtbranch').value); //,call_getbullprem);
        var ds = res.value;
        if (ds.Tables[0].Rows.length > 0) {
            document.getElementById('txtbullprem').value = ds.Tables[0].Rows[0].bullet_charges
            document.getElementById('hiddenbullprem').value = ds.Tables[0].Rows[0].bullet_charges
            document.getElementById('hiddenbulletpremtype').value = ds.Tables[0].Rows[0].Bullet_Charges_Type
            if (document.getElementById('txtgrossamt').value != "") {
                // getagrredamou();
            }

        }
    }
    else {
        document.getElementById('txtbullprem').value = "";
        document.getElementById('hiddenbullprem').value = "";
        if (document.getElementById('txtgrossamt').value != "") {
            //  getagrredamou();
        }
    }

    return false;



}
function call_getbullprem(res) {
    var ds = res.value;
    if (ds.Tables[0].Rows.length > 0) {
        document.getElementById('txtbullprem').value = ds.Tables[0].Rows[0].bullet_charges
        document.getElementById('hiddenbullprem').value = ds.Tables[0].Rows[0].bullet_charges
        document.getElementById('hiddenbulletpremtype').value = ds.Tables[0].Rows[0].Bullet_Charges_Type
        if (document.getElementById('txtgrossamt').value != "") {
            // getagrredamou();
        }

    }

}

function bindadcat5() {
    var adscat = document.getElementById('drpadcat4').value;
    document.getElementById('hiddenadscat4').value = document.getElementById("drpadcat4").value;
    var compcode = document.getElementById('hiddencompcode').value;
    ///if 2 than it is to bind ad cat5 drp down 
    Classified_Booking.bindadcat3(adscat, compcode, "2", call_bindadcat5);
    return false;

}

function call_bindadcat5(res) {
    var ds = res.value;
    var pkgitem = document.getElementById("drpadcat5");
    pkgitem.options.length = 0;
    pkgitem.options[0] = new Option("-Select ad s cat-", "0");
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {

        pkgitem.options.length = 1;
        for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].Cat_Name, ds.Tables[0].Rows[i].Cat_Code);

            pkgitem.options.length;

        }

    }
    document.getElementById('hiddenadscat5').value = document.getElementById("drpadcat5").value;
}

function getcat5val() {
    //  document.getElementById('hiddenadscat5').value=document.getElementById("drpadcat5").value;
    //  var adcat=document.getElementById('drpadcategory').value;
    //                var adscat=document.getElementById('drpadsubcategory').value;
    //                var uomchk=document.getElementById('drpuom').value;
    //                var linesword=document.getElementById('txttotalarea').value;
    //                var curr=document.getElementById('drpcurrency').value;
    //                var ratecode=document.getElementById('txtratecode').value;
    //                var insertsno=document.getElementById('txtinsertion').value;
    //                //////////////this code is to split the code as well as ites description 
    //    
    //               var objpack=document.getElementById('drppackagecopy');


    //                  if(objpack.options.length>0 && adcat!="0" && adscat!="0" && uomchk!="0" && linesword!="" && curr!="0" && ratecode!="0" && insertsno!="")
    //                  {
    //                    gettherate();
    //                  
    //                  }
    return false;

}

///////////////



/******************************************************font_name***************************/
function fontName1() {
    editordiv.style.fontFamily = document.getElementById('fnt_fntname').value;
    //prediv.style.fontFamily=document.getElementById('fnt_fntname').value;
    return false;
}





/***********************************************font_toolbar***********************************************/
function disabled() {
    document.getElementById('italic').disabled = true;
    document.getElementById('italic').src = "Images/italic_d.jpg";

    document.getElementById('bold').disabled = true;
    document.getElementById('bold').src = "Images/bold_d.jpg";

    document.getElementById('underline').disabled = true;
    document.getElementById('underline').src = "Images/underline_d.jpg";

}



/*****************************************/


//fontoolbar//
function getid(obj) {
    currentid = obj.id; document.getElementById('current_id').value = currentid;
}
function roll_over(img_name, img_src) { document[img_name].src = img_src; }


//////////////////////get the size

function getsize() {
    var size = document.getElementById('fnt_fntsize').value
    document.execCommand("FontSize", 0, size);
    return false;

}



/*************************************count_charactor******************************/

function countchar() {
    var tempvar = "";
    if (browser != "Microsoft Internet Explorer") {
        tempvar = document.getElementById('editordiv').textContent;
    }
    else {
        tempvar = document.getElementById('editordiv').innerText;
    }


    document.getElementById('txtbox1').value = tempvar.length;

}

/*******************************line_spacing***********************/

function linespacing() {
    var temp = document.getElementById('fnt_txtline').value;
    document.getElementById('editordiv').style.lineHeight = temp;
}


/*****************************************************************Engfonts*************************/

function getFonts() {
    //alert("hi");
    var nFontLen = dlgHelper.fonts.count;
    var rgFonts = new Array();

    for (var i = 1; i < nFontLen + 1; i++) {
        rgFonts[i] = dlgHelper.fonts(i);
    }
    rgFonts.sort();
    //alert(document.getElementById('fonttoolbar_fntname'))
    var objfont = document.getElementById('fnt_fntname');
    objfont.options.length = 0;
    // var obj2font=document.getElementById('fnt_fntname');
    //objfont.options.length=0;
    // for ( var j = 0; j < nFontLen; j++ )
    //{
    //objfont.options[0] = new Option("Bhaskar","Bhaskar");
    // obj2font.options[j] = new Option(rgFonts[j],rgFonts[j]);
    //}
    if (document.getElementById('fnt_alignment').value == "Hindi") {
        document.getElementById('KM').style.display = "block";
        objfont.options[0] = new Option("Bhaskar", "Bhaskar");
    }
    else {
        document.getElementById('KM').style.display = "none";
        for (var j = 0; j < nFontLen; j++) {
            objfont.options[j] = new Option(rgFonts[j], rgFonts[j]);
            //obj2font.options[j] = new Option(rgFonts[j],rgFonts[j]);
        }
    }
}



/*****************************************preview*************************************/

function privewchar() {
    //  if(document.getElementById('editordiv').
    var tempvar = document.getElementById('editordiv').innerHTML;
    //   var tempvar= tempvar.replace("size=7","size=1");
    //   var tempvar= tempvar.replace("size=6","size=1");
    //   var tempvar= tempvar.replace("size=5","size=1");
    //   var tempvar= tempvar.replace("size=4","size=1");
    //   var tempvar= tempvar.replace("size=3","size=1");
    //   var tempvar= tempvar.replace("size=2","size=1");
    //   document.getElementById('prediv').innerHTML=tempvar;
    //   //prehight();
}

/*******************************************decreaseFontSize***************/


function decreaseFontSize() {
    var tempab = document.getElementById('editordiv').innerHTML;
    //   var tempab= tempab.replace("size=7","size=1");
    //   var tempab= tempab.replace("size=6","size=1");
    //   var tempab= tempab.replace("size=5","size=1");
    //   var tempab= tempab.replace("size=4","size=1");
    //   var tempab= tempab.replace("size=3","size=1");
    //   var tempab= tempab.replace("size=2","size=1");
}

/////////////////this function is used to open the matter form
function openmatterpopup() {
    //window.open('matter.aspx');
     var receiptno = document.getElementById('txtreceipt').value;
         var packagecode = document.getElementById('hiddenpackage').value;
    if (document.getElementById('drpuom').value != "0") {
        var hei = document.getElementById('txtadsize1').value;
        var wid = document.getElementById('txtadsize2').value;
        var eyecatch = document.getElementById('drpbullet').value;
        var coltype = document.getElementById('drpcolor').value;
        var uom_desc_ = document.getElementById('hiddenuomdesc').value;
        if (document.getElementById('hiddenuomdesc').value == "ROC" || document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROW" || document.getElementById('hiddenuomdesc').value == "CD" || document.getElementById('hiddenuomdesc').value == "ROD") {
            //*25Aug*  window.open('matter.aspx?modify='+modifyMatter+'&srno=All&edition=All&eyecatch='+eyecatch+'&coltype='+coltype+'&cioid='+document.getElementById('txtciobookid').value+'&bgcolor='+bgcolor+'&eyecatchlength='+eyecatchlength+'&width='+width+'&uom='+uom+'&insertid='+insertid+'&uom_desc_='+uom_desc_,'','width='+screen.availWidth+',height='+screen.availHeight+',resizable=1,left=0,top=0,scrollbars=yes');
            var agency_vari = document.getElementById('txtagency');
            if (agency_vari.value != "") {
                agencycode = agency_vari.value.substring(agency_vari.value.lastIndexOf("(") + 1, agency_vari.value.lastIndexOf(")"));
            }
            var prevcioid = document.getElementById('hiddendummycioid').value;
            if (width.length > 1024)
                width = "";
            window.open('Editor.aspx?keyboardtype=' + document.getElementById('hdnkeyboardtype').value + '&keyboard=' + document.getElementById('hiddefaultkey').value + '&prevcioid=' + prevcioid + '&agencycode=' + agencycode + '&logo=' + document.getElementById('hiddenlogocode').value + '&modify=' + modifyMatter + '&srno=All&edition=All&eyecatch=' + eyecatch + '&coltype=' + coltype + '&cioid=' + document.getElementById('txtciobookid').value + '&bgcolor=' + bgcolor + '&eyecatchlength=' + eyecatchlength + '&width=' + width + '&uom=' + uom + '&insertid=' + insertid + '&uom_desc_=' + uom_desc_ + '&receiptno=' + receiptno + '&packagecode=' + packagecode, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0,scrollbars=yes');
        }
        else {
            window.open('adtaker.aspx?hei=' + hei + '&wid=' + wid, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0');
        }
    }
    else {
        alert("Please select uom");

    }
    return false;



}

/////////////////this is to get the page premium

function getpageprem(premid, id, str) {

    premid = premid;

    ///////////this page is created to get the value of selected premium
    var page = document.getElementById(premid).value;

    var val = "";
    if (browser != "Microsoft Internet Explorer") {
        var httpRequest = null; ;
        httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml');
        }

        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

        httpRequest.open("GET", "getpremium.aspx?page=" + page, false);
        httpRequest.send('');
        //alert(httpRequest.readyState);
        if (httpRequest.readyState == 4) {
            //alert(httpRequest.status);
            if (httpRequest.status == 200) {
                val = httpRequest.responseText;
            }
            else {
                alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
            }
        }
    }
    else {
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        xml.Open("GET", "getpremium.aspx?page=" + page, false);
        xml.Send();
        val = xml.responseText;
    }
    val = val.split("^");
    val = val[1];
    var premper = "pagper" + id;
    var cardid = "card" + id;
    var solo = "sol" + id;
    var agrred = "agr" + id;
    var discrate = "disrat" + i;
    var gross = "gro" + id;
    if (document.getElementById(cardid).value == "") {
        alert("Please get the card rate");
        return false;

    }
    if (str != "fir") {
        if (val == null || val == "null") {
            document.getElementById(premper).value = "0";
            val = "0";
        }
        else {
            document.getElementById(premper).value = val;
        }
    }
    if (val == null || val == "null") {
        val = "0";
    }

    //when we change the premium than card effects automatically only when card rate and agreed are equal
    if (parseFloat(document.getElementById('txtcardrate').value) == parseFloat(document.getElementById('txtagreedrate').value)) {
        //                     
        var soloins = document.getElementById(solo).value
        var totalvalue = parseFloat(soloins) + parseFloat(soloins) * (parseFloat(val)) / 100;
        document.getElementById(gross).value = totalvalue.toFixed(2);
        // document.getElementById(agrred).value=document.getElementById(cardid).value;
        //  document.getElementById(discrate).value="0";



    }


    var len = "bookdiv";
    var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1


    var d;
    for (k = 0; k < y; k++) {

        while (document.getElementById("card" + i) == null) {
            i = i + totid;

        }
        var gross1 = "gro" + i;
        totor = parseFloat(totor) + parseFloat(document.getElementById(gross1).value);




        i = i + 1;
    }

    var grossamt;

    if (document.getElementById('hiddenvat').value == "grossamount") {
        var strtext = "";
        if (browser != "Microsoft Internet Explorer") {
            var httpRequest = null; ;
            httpRequest = new XMLHttpRequest();
            if (httpRequest.overrideMimeType) {
                httpRequest.overrideMimeType('text/xml');
            }

            httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

            httpRequest.open("GET", "getvatrate.aspx?grossamt=" + totor, false);
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) {
                    strtext = httpRequest.responseText;
                }
                else {
                    alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                }
            }
        }
        else {
            var xml = new ActiveXObject("Microsoft.XMLHTTP");

            xml.Open("GET", "getvatrate.aspx?grossamt=" + totor, false);
            xml.Send();
            strtext = xml.responseText;
        }
        document.getElementById('txtgrossamt').value = formatDecimal(parseFloat(strtext), true, 2)
        var trdisc = document.getElementById('txttradedisc').value
        if (document.getElementById('chktrade').checked == false)
            trdisc = 0;
        if (trdisc == "")
            trdisc = 0;
        var trdisc1 = trdisc;
        addcomm = 0;
        if (document.getElementById('txtaddagencycommrate') != null) {
            if (document.getElementById('hiddenagcommflag').value != "1")
                addcomm = document.getElementById('txtaddagencycommrate').value;
        }
        if (addcomm == "") {
            addcomm = "0";
        }
        if (addcomm != "0") {
            trdisc1 = parseFloat(trdisc) + parseFloat(addcomm);
        }
        var billval = 0;
        if (document.getElementById('agncomm_seq_com').value != "S")
            billval = parseFloat(document.getElementById('txtgrossamt').value) - (parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(trdisc1) / 100);
        else {
            billval = parseFloat(document.getElementById('txtgrossamt').value) - (parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(trdisc) / 100);
            if (addcomm != "0" && addcomm != "") {
                billval = parseFloat(billval) - (parseFloat(billval) * parseFloat(addcomm) / 100);
            }
        }
        document.getElementById('txtbillamt').value = formatDecimal(billval, true, 2);
        totor = 0;
    }
    else if (document.getElementById('hiddenvat').value == "netamount") {


        document.getElementById('txtgrossamt').value = formatDecimal(parseFloat(totor), true, 2)
        if (trdisc == "")
            trdisc = 0;
        var trdisc1 = trdisc;
        addcomm = 0;
        if (document.getElementById('txtaddagencycommrate') != null) {
            addcomm = document.getElementById('txtaddagencycommrate').value;
        }
        if (addcomm == "") {
            addcomm = "0";
        }
        if (addcomm != "0") {
            trdisc1 = parseInt(trdisc) + parseInt(addcomm);
        }
        var billval = 0;
        if (document.getElementById('agncomm_seq_com').value != "S")
            billval = parseFloat(document.getElementById('txtgrossamt').value) - (parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(trdisc1) / 100);
        else {
            billval = parseFloat(document.getElementById('txtgrossamt').value) - (parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(trdisc) / 100);
            if (addcomm != "0" && addcomm != "") {
                billval = parseFloat(billval) - (parseFloat(billval) * parseFloat(addcomm) / 100);
            }
        }
        var strtext = "";
        if (browser != "Microsoft Internet Explorer") {
            var httpRequest = null; ;
            httpRequest = new XMLHttpRequest();
            if (httpRequest.overrideMimeType) {
                httpRequest.overrideMimeType('text/xml');
            }

            httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

            httpRequest.open("GET", "getvatrate.aspx?grossamt=" + billval, false);
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) {
                    strtext = httpRequest.responseText;
                }
                else {
                    alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                }
            }
        }
        else {
            var xml = new ActiveXObject("Microsoft.XMLHTTP");

            xml.Open("GET", "getvatrate.aspx?grossamt=" + billval, false);
            xml.Send();
            strtext = xml.responseText;
        }

        document.getElementById('txtbillamt').value = formatDecimal(strtext, true, 2);
        totor = 0;

    }
    else if (document.getElementById('hiddenvat').value == "no") {
        document.getElementById('txtgrossamt').value = formatDecimal(parseFloat(totor), true, 2)
        if (trdisc == "")
            trdisc = 0;
        var trdisc1 = trdisc;
        addcomm = 0;
        if (document.getElementById('txtaddagencycommrate') != null) {
            addcomm = document.getElementById('txtaddagencycommrate').value;
        }
        if (addcomm == "") {
            addcomm = "0";
        }
        if (addcomm != "0") {
            trdisc1 = parseInt(trdisc) + parseInt(addcomm);
        }
        var billval = 0;
        if (document.getElementById('agncomm_seq_com').value != "S")
            billval = parseFloat(document.getElementById('txtgrossamt').value) - (parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(trdisc1) / 100);
        else {
            billval = parseFloat(document.getElementById('txtgrossamt').value) - (parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(trdisc) / 100);
            if (addcomm != "0" && addcomm != "") {
                billval = parseFloat(billval) - (parseFloat(billval) * parseFloat(addcomm) / 100);
            }
        }
        document.getElementById('txtbillamt').value = formatDecimal(totor, true, 2);
        totor = 0;

    }
    if (document.getElementById('txtagreedrate').value != "") {
        document.getElementById('txtagreedamt').value = document.getElementById('txtgrossamt').value;
    }
}

function changesizetoline(res) {

    var ds = res.value;
    document.getElementById('hiddenuomdesc').value = ds.Tables[0].Rows[0].uom_desc
    document.getElementById('hiddenlogocode').value = ds.Tables[0].Rows[0].Logo;
    document.getElementById('hiddenuomstylesheet').value = ds.Tables[0].Rows[0].stylesheetname

    //        if(document.getElementById('drpadtype').value=="0")
    //        {
    //            alert("Please select the Ad type");
    //            //document.getElementById('drpadtype').focus();
    //            return false;
    //        }

    document.getElementById('hiddenuomcode').value = document.getElementById('drpuom').value

    var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
    //To disable width on basis of uom


    /////////if uom is rol or row than disable ad size hei and width and no of collumns also gray out
    //RO0-- ROL
    //RO1-- ROw
    //RO2--ROD
    //RO3-- CD
    if (document.getElementById('hiddenuomdesc').value == "CD") {
        document.getElementById('txtspadiscper').disabled = false;
    }
    else {
        document.getElementById('txtspadiscper').disabled = true;
    }
    if (document.getElementById('hiddenuomdesc').value == "ROC" || document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROW" || document.getElementById('hiddenuomdesc').value == "ROD") {
        document.getElementById('txtbillwidth').value = ""
        document.getElementById('txtbillwidth').disabled = true;
        document.getElementById('txtbillwidth').style.backgroundColor = "Gray";
        document.getElementById('txtbillheight').value = ""
        document.getElementById('txtbillheight').disabled = true;
        document.getElementById('txtbillheight').style.backgroundColor = "Gray";

        document.getElementById('txtadsize1').value = ""
        document.getElementById('txtadsize1').disabled = true;
        document.getElementById('txtadsize1').style.backgroundColor = "Gray";
        document.getElementById('txtadsize2').value = ""
        document.getElementById('txtadsize2').disabled = true;
        document.getElementById('txtadsize2').style.backgroundColor = "Gray";
        document.getElementById('txtcolum').value = ""
        document.getElementById('txtcolum').disabled = true;
        document.getElementById('chkattach').disabled = true;
        //document.getElementById('chkattach').checked=false;
        document.getElementById('txtcolum').style.backgroundColor = "Gray";
        document.getElementById('txttotalarea').value = "";
        document.getElementById('drpbullet').disabled = false;
        document.getElementById('drpdiscountprem').disabled = false;
        if (document.getElementById('txttotalarea').value == "") {
            document.getElementById('txttotalarea').value = "";
        }
        if (document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "CD") {
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById('Label1').textContent = "No. Of Lines";
            }
            else {
                document.getElementById('Label1').innerText = "No. Of Lines";
            }
        }
        else if (document.getElementById('hiddenuomdesc').value == "ROW") {
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById('Label1').textContent = "No. Of Words";
            }
            else {
                document.getElementById('Label1').innerText = "No. Of Words";
            }
        }
        else if (document.getElementById('hiddenuomdesc').value == "ROC") {
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById('Label1').textContent = "No. Of Char";
            }
            else {
                document.getElementById('Label1').innerText = "No. Of Char";
            }
        }
    }
    else if (document.getElementById('hiddenuomdesc').value == "CD" || document.getElementById('hiddenuomdesc').value != "ROL" || document.getElementById('hiddenuomdesc').value != "ROW" || document.getElementById('hiddenuomdesc').value != "ROD" || document.getElementById('hiddenuomdesc').value != "ROC") {
        document.getElementById('drpbullet').disabled = true;
        document.getElementById('txtbillwidth').value = ""
        document.getElementById('txtbillwidth').disabled = false;
        document.getElementById('txtbillwidth').style.backgroundColor = "White";
        document.getElementById('txtbillheight').value = ""
        document.getElementById('txtbillheight').disabled = false;
        document.getElementById('txtbillheight').style.backgroundColor = "White";

        document.getElementById('txtadsize1').value = ""
        document.getElementById('txtadsize1').disabled = false;
        document.getElementById('txtadsize1').style.backgroundColor = "White";
        document.getElementById('txtadsize2').value = ""
        document.getElementById('txtadsize2').disabled = false;
        document.getElementById('txtadsize2').style.backgroundColor = "White";
        document.getElementById('txtcolum').value = ""
        document.getElementById('txtcolum').disabled = false;
        document.getElementById('chkattach').disabled = false;

        // document.getElementById('chkattach').checked=true;


        //                 if(document.getElementById('hiddentypedatabase').value=="mysql")
        //                 {
        //                    document.getElementById('chkattach').checked=true;
        //                    document.getElementById('chkattach').disabled=true;
        //                 }

        document.getElementById('txtcolum').style.backgroundColor = "White";
        if (browser != "Microsoft Internet Explorer") {
            document.getElementById('Label1').textContent = "Total Area";
        }
        else {
            document.getElementById('Label1').innerText = "Total Area";
        }
        document.getElementById('txttotalarea').value = ""
        if (document.getElementById('txttotalarea').value == "") {
            document.getElementById('txttotalarea').value = "";
        }
    }
    //In case of CC uom width is disabled..
    if (ds.Tables[0].Rows[0].FLAG == "C")// && ds.Tables[0].Rows[0].Uom_Name=="CC")
    {
        document.getElementById('txtadsize2').disabled = true;
    }

    /////if there is insertion grid than on ROL change size to line and gray out height and width
    if (document.getElementById('tblinsert').innerHTML != "") {
        if (document.getElementById('hiddenuomdesc').value == "ROC" || document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROW" || document.getElementById('hiddenuomdesc').value == "ROD") {

            if (document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROD" && (document.getElementById('siz') != null)) {
                if (browser != "Microsoft Internet Explorer") {
                    document.getElementById('siz').textContent = "Lines";
                }
                else {

                    document.getElementById('siz').innerText = "Lines";
                }
            }
            else if (document.getElementById('hiddenuomdesc').value == "ROW" && document.getElementById('siz') != null) {
                if (browser != "Microsoft Internet Explorer") {
                    document.getElementById('siz').textContent = "Words";
                }
                else {
                    document.getElementById('siz').innerText = "Words";
                }
            }
            else if (document.getElementById('hiddenuomdesc').value == "ROC" && document.getElementById('siz') != null) {
                if (browser != "Microsoft Internet Explorer") {
                    document.getElementById('siz').textContent = "Char";
                }
                else {
                    document.getElementById('siz').innerText = "Char";
                }
            }
            ////////////////////////////this is to gray out the height and width of insertion grid on rol and row
            var len = "bookdiv";
            var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
            var i = 0;
            var k;
            var height;
            var width;
            var size;
            for (k = 0; i < y - 1; k++) {
                while (document.getElementById("card" + i) == null && k < y - 1) {
                    i = i + totid;
                }
                if (k >= y - 1) {
                    break;
                }
                height = "hei" + i;
                width = "wid" + i;
                size = "siz" + i;
                var nocol = "nocol" + i;
                var splboldsize = "splboldsize" + i;
                document.getElementById(height).style.backgroundColor = "Gray";
                //document.getElementById(height).style.color="white";
                document.getElementById(height).disabled = true;
                document.getElementById(height).value = "";
                document.getElementById(width).style.backgroundColor = "Gray";
                //document.getElementById(width).style.color="white";
                document.getElementById(width).disabled = true;
                document.getElementById(width).value = "";
                document.getElementById(size).disabled = false;
                document.getElementById(splboldsize).disabled = false;
                document.getElementById(nocol).disabled = true;
                i++;
            }
        }
        else if (document.getElementById('hiddenuomdesc').value == "CD" || document.getElementById('hiddenuomdesc').value != "ROC" || document.getElementById('hiddenuomdesc').value != "ROL" || document.getElementById('hiddenuomdesc').value != "ROW" || document.getElementById('drpuom').value == "0" || document.getElementById('hiddenuomdesc').value == "ROD" || document.getElementById('hiddenuomdesc').value == "CD") {
            if (browser != "Microsoft Internet Explorer") {
                if (document.getElementById('siz') != null)
                    document.getElementById('siz').textContent = "Size";
            }
            else {
                if (document.getElementById('siz') != null)
                    document.getElementById('siz').innerText = "Size";
            }
            ////////////////////////////this is to White out the height and width of insertion grid on rol and row
            var len = "bookdiv";
            if (document.getElementById(len) != null) {
                var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
                var i = 0;
                var k;
                var height;
                var width;
                var size;
                for (k = 0; i < y - 1; k++) {
                    while (document.getElementById("card" + i) == null && k < y - 1) {
                        i = i + totid;
                    }
                    if (k >= y - 1) {
                        break;
                    }


                    height = "hei" + i;
                    width = "wid" + i;
                    size = "siz" + i;
                    var splboldsize = "splboldsize" + i;
                    document.getElementById(height).style.backgroundColor = "white";
                    // document.getElementById(height).style.color="white";
                    document.getElementById(height).disabled = false;
                    document.getElementById(width).style.backgroundColor = "white";
                    //document.getElementById(width).style.color="white";
                    document.getElementById(width).disabled = false;
                    document.getElementById(size).disabled = true;
                    if (document.getElementById(splboldsize) != null) {
                        document.getElementById(splboldsize).disabled = true;
                        document.getElementById(splboldsize).value = "";
                    }
                    i++;
                }
            }
        }
    }
    /*new change ankur 22 feb*/
    /*this to fill the logo uom fields*/
    gblogowithmatter = ds.Tables[0].Rows[0].Logo;


    rateRefresh();
    return false;


}
/*function changesizetoline()
{
  
/////////if uom is rol or row than disable ad size hei and width and no of collumns also gray out
        
if(document.getElementById('drpuom').value=="RO0" || document.getElementById('drpuom').value=="RO1" || document.getElementById('drpuom').value=="RO3")
{
document.getElementById('txtadsize1').value=""
document.getElementById('txtadsize1').disabled=true;
document.getElementById('txtadsize1').style.backgroundColor="Gray";    
document.getElementById('txtadsize2').value=""
document.getElementById('txtadsize2').disabled=true;
document.getElementById('txtadsize2').style.backgroundColor="Gray";    
document.getElementById('txtcolum').value=""
document.getElementById('txtcolum').disabled=true;
document.getElementById('txtcolum').style.backgroundColor="Gray"; 
document.getElementById('chkattach').disabled=true;
            
if(document.getElementById('txttotalarea').value=="")
{
document.getElementById('txttotalarea').value="";  
}
if(document.getElementById('drpuom').value=="RO0" || document.getElementById('drpuom').value=="RO2")
{
if(browser!="Microsoft Internet Explorer")
{
document.getElementById('Label1').textContent="No. Of Lines";
}
else
{        
document.getElementById('Label1').innerText="No. Of Lines";
}
                
}
else if(document.getElementById('drpuom').value=="RO1")
{
if(browser!="Microsoft Internet Explorer")
{
document.getElementById('Label1').textContent="No. Of Words";
}
else
{        
document.getElementById('Label1').innerText="No. Of Words";
}
                
}
             
        
        
        
}
else if(document.getElementById('drpuom').value=="CD0" || document.getElementById('drpuom').value!="RO0")
{
document.getElementById('txtadsize1').value=""
document.getElementById('txtadsize1').disabled=false;
document.getElementById('txtadsize1').style.backgroundColor="White";    
document.getElementById('txtadsize2').value=""
document.getElementById('txtadsize2').disabled=false;
document.getElementById('txtadsize2').style.backgroundColor="White";    
document.getElementById('txtcolum').value=""
document.getElementById('txtcolum').disabled=false;
document.getElementById('txtcolum').style.backgroundColor="White";
if(browser!="Microsoft Internet Explorer")
{
document.getElementById('Label1').textContent="Total Area";
}
else
{        
document.getElementById('Label1').innerText="Total Area";
}  
            
document.getElementById('chkattach').disabled=false;
document.getElementById('chkattach').checked=false;
if(document.getElementById('txttotalarea').value=="")
{
document.getElementById('txttotalarea').value="";
}
}
        
/////if there is insertion grid than on ROL change size to line and gray out height and width 
if(document.getElementById('tblinsert').innerHTML!="" )
{
if(document.getElementById('drpuom').value=="RO0" || document.getElementById('drpuom').value=="RO1" )
{
document.getElementById('chkattach').disabled=true;
document.getElementById('chkattach').checked=false;
if(document.getElementById('drpuom').value=="RO0")
{
if(browser!="Microsoft Internet Explorer")
{
document.getElementById('siz').textContent="Lines";
}
else
{        
document.getElementById('siz').innerText="Lines";
}
}
else if(document.getElementById('drpuom').value=="RO1" || document.getElementById('drpuom').value=="RO3")
{
if(browser!="Microsoft Internet Explorer")
{
document.getElementById('siz').textContent="Words";
}
else
{        
document.getElementById('siz').innerText="Words";
}
                        
}
////////////////////////////this is to gray out the height and width of insertion grid on rol and row
var len="bookdiv";
var y=document.getElementById(len).getElementsByTagName('table')[0].rows.length;
var i=0;
var k;
var height;
var width;
var size;
for(k=0;i<y-1;k++)
{
while(document.getElementById("card"+i)==null && k<y-1)
{
i=i+totid;
                               
}
if(k>=y-1)
{
break;
}
                             
                                
height="hei"+i;
width="wid"+i;
size="siz"+i;
document.getElementById(height).style.backgroundColor="Gray";
document.getElementById(height).disabled=true;
document.getElementById(height).value="";
document.getElementById(width).style.backgroundColor="Gray";
document.getElementById(width).disabled=true;
document.getElementById(width).value="";
document.getElementById(size).disabled=false;
i++;
                        
} 
}
else if(document.getElementById('drpuom').value=="RO3" || document.getElementById('drpuom').value!="RO0" || document.getElementById('drpuom').value!="RO1" || document.getElementById('drpuom').value=="0")
{
if(browser!="Microsoft Internet Explorer")
{
document.getElementById('siz').textContent="Size";
}
else
{        
document.getElementById('siz').innerText="Size";
}
                 
////////////////////////////this is to White out the height and width of insertion grid on rol and row
var len="bookdiv";
var y=document.getElementById(len).getElementsByTagName('table')[0].rows.length;
var i=0;
var k;
var height;
var width;
var size;
for(k=0;i<y-1;k++)
{
while(document.getElementById("card"+i)==null && k<y-1)
{
i=i+totid;
                               
}
if(k>=y-1)
{
break;
}
                             
                                
height="hei"+i;
width="wid"+i;
size="siz"+i;
document.getElementById(height).style.backgroundColor="White";
document.getElementById(height).disabled=false;
document.getElementById(width).style.backgroundColor="White";
document.getElementById(width).disabled=false;
document.getElementById(size).disabled=true;
                                
i++;
                        
} 
}
            
        
        
        
}
        
if(document.getElementById('drpuom').value=="CD0" )
{
document.getElementById('chkattach').disabled=false;
document.getElementById('chkattach').checked=false;
}
else
{
document.getElementById('chkattach').disabled=true;
document.getElementById('chkattach').checked=false;
}
document.getElementById('txtcardamt').value="";
document.getElementById('txtcardrate').value="";
document.getElementById('txtagreedrate').value="";
document.getElementById('txtagreedamt').value="";
document.getElementById('txtdiscount').value="";
document.getElementById('txtdiscpre').value="";
document.getElementById('txtextracharges').value="";
document.getElementById('txtgrossamt').value="";
document.getElementById('txtbillamt').value="";        
return false;
  
  
}
*/
/*******************code for cut************/
function CutToClipboard() {
    document.execCommand("Cut");
    document.getElementById('editordiv').focus;
    //      document.getElementById('pasteT').disabled=false;
    //      document.getElementById('paste').disabled=false;
    //      document.getElementById('rightpaste').disabled=false;
    //      document.getElementById('paste').src="icons/paste.jpg"; 


}
function CopyToClipboard() {
    document.execCommand("Copy");
    document.getElementById('editordiv').focus;
    //    /*opener.*/document.getElementById('pasteT').disabled=false;
    //    document.getElementById('paste').disabled=false;
    //    document.getElementById('rightpaste').disabled=false;
    //    document.getElementById('paste').src="icons/paste.jpg"; 

}

function PasteFromClipboard() {
    try {

        document.getElementById('editordiv').focus();
        document.execCommand("Paste");

        var ab = document.getElementById('editordiv').innerHTML;
        var ab1 = ab.split("<DIV");
        for (var i = 2; i < ab1.length; i++) {
            var ab2 = ab1[i].split("id=");
            var ab3 = ab2[1].split(" ");
            document.getElementById(ab3[0]).id = i;
        }
        document.getElementById('ctrval').value = i + 1;
        document.getElementById('editordiv').focus();
    }
    catch (er) { }
}
//////////////this is the case for the package which contains the oring 
function bindTable_callback(response) {
    //alert(response.value);
    var ds = response.value;
    var output = "";
    output = "<table cellpadding=0 cellspacing=0 border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\"><td align=center>Select</td><td align=center width=\"100px\">Edition</td></tr>";
    for (var i = 0; i < ds.Tables[0].Rows.length; i++) {
        output = output + "<tr><td class=\"dtGrid\" align=center><input type=checkbox onclick=\"checkCount('chk" + i + "','" + ds.Tables[0].Rows[i].flag + "');\" value='" + ds.Tables[0].Rows[i].flag + "' id=chk" + i + " /></td><td align=center class=\"dtGrid\" width=\"100px\" id=td" + i + ">" + ds.Tables[0].Rows[i].Edition_Name + "</td></tr>";
    }
    output = output + "<tr><td></td><td align=right><input type='button' class=\"buttonsmall\" value='Ok' onClick=\"okClick();\"><input type='button' class=\"buttonsmall\" value='Cancel' onClick=\"cancelClick();\"></td></tr>";
    output = output + "</table>";
    document.getElementById('divpkg').innerHTML = output;
    document.getElementById('divpkg').style.display = "block";
    document.getElementById('divpkg').style.top = parseInt(document.getElementById('txtpaid').offsetTop) + parseInt(document.getElementById('tdpck').offsetTop) + parseInt(document.getElementById('OuterTable').offsetTop) + 328;
    document.getElementById('divpkg').style.left = parseInt(document.getElementById('txtpaid').offsetLeft) + parseInt(document.getElementById('tdpck').offsetLeft) + 200;
}
function okClick() {
    //   alert("Ok");
    var temp = "";
    temp = document.getElementById('hidval').value.split(",");
    //alert(temp.length);
    if (temp.length < parseInt(document.getElementById('hidcount').value)) {
        alert("Please select " + document.getElementById('hidcount').value + " Edition in this Package");
        return false;
    }
    document.getElementById('divpkg').style.display = "none";
    var strid = document.getElementById('drppackage').value;
    AddItem(document.getElementById('drppackagecopy'), document.getElementById('pkgname').value, strid, "0");
}

function cancelClick() {
    document.getElementById('divpkg').style.display = "none";

}

function checkCount(id, count) {
    //  alert(count);
    //alert(document.getElementById('tdtable').getElementsByTagName('table')[0].rows.length-1); 


    document.getElementById('hidcount').value = count;
    var i = 0;
    var tot = 0;
    document.getElementById('hidval').value = "";
    for (i = 0; i < document.getElementById('divpkg').getElementsByTagName('table')[0].rows.length - 2; i++) {
        if (document.getElementById('chk' + i).checked == true) {
            tot = tot + 1;
            if (tot > count) {
                alert("Can't select more Edition");
                document.getElementById(id).checked = false;
                return false;
            }
            else {
                if (document.getElementById('hidval').value == "") {
                    if (browser != "Microsoft Internet Explorer") {
                        document.getElementById('hidval').value = document.getElementById('td' + i).textContent;
                    }
                    else {
                        document.getElementById('hidval').value = document.getElementById('td' + i).innerText;
                    }

                }
                else {
                    if (browser != "Microsoft Internet Explorer") {
                        document.getElementById('hidval').value = document.getElementById('hidval').value + "," + document.getElementById('td' + i).textContent;
                    }
                    else {
                        document.getElementById('hidval').value = document.getElementById('hidval').value + "," + document.getElementById('td' + i).innerText;
                    }

                }
            }
        }
    }
}

/////this is to fill the rol or row into the insertion grid if it is visibile
function fillnooflineintogrid() {

    if (document.getElementById('drppackagecopy').options.length == 0) {
        alert("Please select the package");
        return false;

    }

    if (document.getElementById('drpuom').value == "0") {
        alert("Please select uom");
        document.getElementById('txttotalarea').value = "";
        // document.getElementById('drpuom').focus();
        return false;

    }
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    //  document.getElementById('txtspedisc').value="";
    // document.getElementById('txtspediscper').value="";
    if (document.getElementById('hiddenuomdesc').value == "CD") {

        if (glob_area != "") {
            if (parseFloat(document.getElementById('txttotalarea').value) > parseFloat(glob_area)) {
                alert("Total area exceeds with edition area");
                return false;
            }
        }
        if (document.getElementById('txtcolum').value != "") {
            var totare = document.getElementById('txttotalarea').value
            var wid = document.getElementById('txtadsize2').value
            document.getElementById('txtadsize1').value = formatDecimal(parseFloat(totare) / parseFloat(wid), true, 2);
            document.getElementById('txtbillwidth').value = document.getElementById('txtadsize1').value;
            document.getElementById('txtbillheight').value = document.getElementById('txtadsize2').value;
        }
        else if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtadsize2').value == "") {
            var totare = document.getElementById('txttotalarea').value
            var h_ = document.getElementById('txtadsize1').value
            document.getElementById('txtadsize1').value = formatDecimal(parseFloat(totare) / parseFloat(h_), true, 2);
            document.getElementById('txtbillwidth').value = document.getElementById('txtadsize1').value;
            document.getElementById('txtbillheight').value = document.getElementById('txtadsize2').value;

        }
        else if (document.getElementById('txtadsize2').value != "" && document.getElementById('txtadsize1').value == "") {
            var totare = document.getElementById('txttotalarea').value
            var wid = document.getElementById('txtadsize2').value
            document.getElementById('txtadsize1').value = formatDecimal(parseFloat(totare) / parseFloat(wid), true, 2);
            document.getElementById('txtbillwidth').value = document.getElementById('txtadsize1').value;
            document.getElementById('txtbillheight').value = document.getElementById('txtadsize2').value;


        }

    }


    var len = "bookdiv";
    var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
    var k;
    var i = 0;
    var width;
    var noofcol;
    var height;
    var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
    var totalarea = document.getElementById('txttotalarea').value;
    var txtadsize2 = document.getElementById('txtadsize2').value;
    var txtadsize1 = document.getElementById('txtadsize1').value;
    var txtcolum = document.getElementById('txtcolum').value;
    if (document.getElementById('tblinsert').innerHTML != "") {
        for (k = 0; k < y; k++) {

            size = "siz" + i;
            width = "wid" + i;
            noofcol = "nocol" + i;
            height = "hei" + i;
            var par1;
            var s = document.getElementById(size);
            par1 = (s.parentNode).parentNode;
            if (browser != "Microsoft Internet Explorer") {
                var w = document.getElementById(width);
                var h = document.getElementById(height);
                var n = document.getElementById(noofcol);
            }
            else {
                var w = par1.all[width];
                var h = par1.all[height];
                var n = par1.all[noofcol];
            }

            //                                     var w=document.getElementById(width);
            //                                     var h=document.getElementById(height);
            //                                     var n=document.getElementById(noofcol);
            // if(s.value=="")
            s.value = totalarea;
            //  if(w.value=="")   
            w.value = txtadsize2;
            //  if(h.value=="")
            h.value = txtadsize1;
            //  if(n.value=="")   
            n.value = txtcolum;
            i++;

        }


    }
    changedivrate();
}
//function disabledwidth()
//{


//        var value=chkamount('txtadsize2');
//        if(value=="f")
//        {
//        return false;
//        }
//        var value=chkamount('txtadsize1');
//        if(value=="f")
//        {
//        return false;
//        }
//         var value=chkamount('txtcolum');
//            if(value=="f")
//            {
//            return false;
//            }
//        if(parseFloat(document.getElementById('txtadsize1').value)==0 || parseFloat(document.getElementById('txtadsize2').value)==0 || parseFloat(document.getElementById('txtcolum').value)==0)
//        {
//            alert("0 is not accepted");
//            var idrem=document.activeElement.id;
//            //document.getElementById(idrem).value="";
//            
//            return false;


//        }

//    if(document.getElementById('txtadsize1').value=="")
//    {
//        alert("Please enter height");
//        document.getElementById('txtcolum').value="";
//        document.getElementById('txtadsize1').focus();
//        return false;
//    }

//    if(document.getElementById('txtcolum').value!="" )
//    {
//        document.getElementById('txtadsize2').value="";
//        document.getElementById('txtadsize2').disabled=true
//        if(document.getElementById('txtadsize1').value!="")
//        {
//            var hei=document.getElementById('txtadsize1').value;
//            var col=document.getElementById('txtcolum').value;
//            document.getElementById('txttotalarea').value=(parseFloat(hei)*parseFloat(col)).toFixed(2);
//             document.getElementById('txtadsize2').value="";
//        }
//    }
//    else
//    {
//    document.getElementById('txtadsize2').disabled=false
//    document.getElementById('txttotalarea').value="";
//    }
//    
//    if(document.getElementById('txtadsize2').value!="")
//     {
//        var height=parseFloat(document.getElementById('txtadsize1').value);
//        var width=parseFloat(document.getElementById('txtadsize2').value);
//        document.getElementById('txtbillwidth').value=height;
//        document.getElementById('txtbillheight').value=width;
//        var totarval=height*width;
//        document.getElementById('txttotalarea').value=totarval.toFixed(2);
//        document.getElementById('txtcolum').value="";
//        document.getElementById('txtcolum').disabled=true;
//        //document.getElementById('txtbillarea').value=document.getElementById('txttotalarea').value;
//     }
//        if(document.getElementById('txtcolum').value!="")
//     {
//            var height=parseFloat(document.getElementById('txtadsize1').value);
//            var width=parseFloat(document.getElementById('txtcolum').value);
//            document.getElementById('txtbillwidth').value=height;
//            document.getElementById('txtbillheight').value=width;
//            var totarval=height*width;
//            document.getElementById('txttotalarea').value=totarval.toFixed(2);
//            document.getElementById('txtadsize2').value="";
//            document.getElementById('txtadsize2').disabled=true;
//        //document.getElementById('txtbillarea').value=document.getElementById('txttotalarea').value;
//     }
//    
//        if(document.getElementById('txtgrossamt').value!="NaN" && document.getElementById('txtgrossamt').value!="")
//         {
//            getagrredamou();
//         }
//         ///////when there is a change in page area when there is insertion grid than it also changes in insertion grid automatically
//    var wid;
//    if( document.getElementById('tblinsert').innerHTML!="")
//    {    
//    var hei=document.getElementById('txtadsize1').value
//    if(document.getElementById('txtcolum').value=="")
//    {
//    document.getElementById('txtbillwidth').value=""; 
//    wid="";
//    }
//    else
//    {
//    wid=document.getElementById('txtadsize2').value     
//     }    ///getpageareaintogrid(hei,wid);
//     var nocoll=document.getElementById('txtcolum').value   
//         
//             var len="bookdiv";
//        var y=document.getElementById(len).getElementsByTagName('table')[0].rows.length;
//        var i=0;
//        var k;
//        var height2;
//        var width2;
//        var size;
//        for(k=0;i<y-1;k++)
//        {
//             while(document.getElementById("card"+i)==null && k<y-1)
//                    {
//                        i=i+totid;
//               
//                    }
//                    if(k>=y-1)
//                    {
//                    break;
//                    }
//             
//                
//                height2="hei"+i;
//                width2="nocol"+i;
//                
//                size="siz"+i;
//                document.getElementById(height2).value=hei;
//                document.getElementById(width2).value=nocoll;
//                if(nocoll!="")
//                {
//                document.getElementById(size).value=parseFloat(hei)*parseFloat(nocoll);
//                }
//                else
//                {
//                document.getElementById(size).value=""
//                }
//                if(nocoll=="")
//                {
//                     document.getElementById(size).value=""
//                }
//                
//                i++;
//        
//        } 
//         
//    }    
//    
//    return false;

//}

//////////////////////this is for davp ad where user enter height and collumn and width comes automatically from 
//////lay out x table and from that total area comes
function getwidth() {
    if (parseInt(document.getElementById('txtcolum').value) == 0) {
        alert("No. of Columns can't be 0");
        return false;
    }

    //        if(parseInt(document.getElementById('txtcolum').value)>8)
    //        {
    //            document.getElementById('txtadsize2').disabled=true;
    //        }


    document.getElementById('txtgrossamt').value = ""
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    if (document.getElementById('txtcolum').value != "") {
        document.getElementById('txtadsize2').disabled = true;
    }
    else {
        document.getElementById('txtadsize2').value = "";
        document.getElementById('txttotalarea').value = "";
        //    document.getElementById('txtadsize2').disabled=false;


        if (document.getElementById('tblinsert').innerHTML != "") {
            var size;
            var len = "bookdiv";
            var width;
            var noofcol;
            var i = 0;
            var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
            var y_ = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
            for (k_ = 0; k_ < y_; k_++) {
                size = "siz" + i;
                width = "wid" + i;
                noofcol = "nocol" + i;
                var size_vari = document.getElementById(size);
                var par1 = (size_vari.parentNode).parentNode;
                size_vari.value = "";
                if (browser != "Microsoft Internet Explorer") {
                    document.getElementById(width).value = "";
                    document.getElementById(noofcol).value = "";
                }
                else {
                    par1.all[width].value = "";
                    par1.all[noofcol].value = "";
                }

                i++;

            }


        }


    }

    var objpack = document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var code = "";
    var codesplit = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (temp != "") {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                desc = tempcode.substr(0, tempcode.lastIndexOf("(")) + "+" + desc;

            }
            else {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                desc = tempcode.substr(0, tempcode.lastIndexOf("("));

            }
        }

    }
    if (document.getElementById('drppageposition') != null) {
        if (document.getElementById('drppageposition').disabled == false) {
            document.getElementById('drppageposition').focus();
        }
    }
    Classified_Booking.getwidthforcoll(desc, document.getElementById('txtcolum').value, document.getElementById('hiddencompcode').value, document.getElementById('drpuom').value, call_getwidthforcoll);



}
function call_getwidthforcoll(res) {

    var ds = res.value

    if (ds != null) {
        if (ds.Tables[0].Rows.length > 0) {

            if (ds.Tables[0].Rows[0].col_cc == undefined)
                return false;
            if (ds.Tables[0].Rows[0].col_cc != null)
                document.getElementById('txtadsize2').value = ds.Tables[0].Rows[0].col_cc
            if (document.getElementById('txtadsize1').value != "") {
                if (document.getElementById('txtcolum').value != '' && AREACALCULATION != 'ROD') {
                    document.getElementById('txttotalarea').value = parseFloat(document.getElementById('txtadsize1').value) * parseFloat(document.getElementById('txtcolum').value);
                }
                else if (document.getElementById('txtadsize2').value != '' && document.getElementById('txtadsize2').value != null && document.getElementById('txtadsize2').value != "null") {
                    document.getElementById('txttotalarea').value = parseFloat(document.getElementById('txtadsize1').value) * parseFloat(document.getElementById('txtadsize2').value);
                }
            }
            if (ds.Tables[1].Rows.length > 0) {
                glob_area = ds.Tables[1].Rows[0].edition_area;
            }


        }
        else {
            alert("Booking not be possible");
            return false;

        }

        if (document.getElementById('tblinsert').innerHTML != "") {
            var size;
            var len = "bookdiv";
            var width;
            var noofcol;
            var i = 0;
            var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
            y = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
            var totalarea_vari = document.getElementById('txttotalarea').value;
            var adsize2_vari = document.getElementById('txtadsize2');
            var col_vari = document.getElementById('txtcolum');
            for (k = 0; k < y; k++) {
                size = "siz" + i;
                width = "wid" + i;
                noofcol = "nocol" + i;
                var size_vari = document.getElementById(size);
                var par1 = (size_vari.parentNode).parentNode;
                size_vari.value = totalarea_vari;
                if (browser != "Microsoft Internet Explorer") {
                    document.getElementById(width).value = adsize2_vari.value;
                    document.getElementById(noofcol).value = col_vari.value;
                }
                else {
                    par1.all[width].value = adsize2_vari.value;
                    par1.all[noofcol].value = col_vari.value;
                }

                i++;

            }


        }
    }
    return false;

}

function formatDecimal(argvalue, addzero, decimaln) {
    var numOfDecimal = (decimaln == null) ? 2 : decimaln;
    var number = 1;

    number = Math.pow(10, numOfDecimal);

    argvalue = Math.round(parseFloat(argvalue) * number) / number;
    // If you're using IE3.x, you will get error with the following line.
    // argvalue = argvalue.toString();
    // It works fine in IE4.
    argvalue = "" + argvalue;

    if (argvalue.indexOf(".") == 0)
        argvalue = "0" + argvalue;

    if (addzero == true) {
        if (argvalue.indexOf(".") == -1)
            argvalue = argvalue + ".";

        while ((argvalue.indexOf(".") + 1) > (argvalue.length - numOfDecimal))
            argvalue = argvalue + "0";
    }

    return argvalue;
}

function getrateonchangecurr() {
    if (document.getElementById('drprptcurrency').value == "0" || document.getElementById('drprptcurrency').value == "")
        document.getElementById('drprptcurrency').value = document.getElementById('drpcurrency').value;
    //                var adcat=document.getElementById('drpadcategory').value;
    //                var adscat=document.getElementById('drpadsubcategory').value;
    //                var uomchk=document.getElementById('drpuom').value;
    //                var linesword=document.getElementById('txttotalarea').value;
    //                var curr=document.getElementById('drpcurrency').value;
    //                var ratecode=document.getElementById('txtratecode').value;
    //                var insertsno=document.getElementById('txtinsertion').value;
    //                //////////////this code is to split the code as well as ites description 
    //    
    //               var objpack=document.getElementById('drppackagecopy');


    //                  if(objpack.options.length>0 && adcat!="0" && adscat!="0" && uomchk!="0" && linesword!="" && curr!="0" && ratecode!="0" && insertsno!="")
    //                  {
    //                    gettherate();
    //                  
    //                  }


}

function setmatstatus() {
    var len = "bookdiv";
    if (document.getElementById('tblinsert').innerHTML != "") {
        //var y=parseInt(noofinsertlo)   
        var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
        var k;
        var colid;
        var i = 0;
        var matstaval = document.getElementById('drpmatstat').value;
        for (k = 0; k < y - 1; k++) {

            matsta = "mat" + i;
            document.getElementById(matsta).value = matstaval;


            i = parseInt(i) + 1;

        }


    }

}




/***********************this is code for font size******************/

function fontsize1() {
    if (document.getElementById('editordiv').innerHTML != null) {
        //    mysize=document.getElementById('fonttoolbar_fntsize').value;
        mysize = document.getElementById('fnt_fntsize').value;
        document.getElementById('editordiv').style.fontSize = mysize;
        if (mysize > 18 && mysize < 30) {
            document.getElementById('editordiv').style.lineHeight = 30 + "px";
            // up();
        }
        if (mysize > 29 && mysize < 60) {
            document.getElementById('editordiv').style.lineHeight = 50 + "px";
            // up();
        }
        if (mysize > 59) {
            document.getElementById('editordiv').style.lineHeight = 70 + "px";
            //up();
        }
        //document.getElementById('textboxprop_fntsize').value = mysize;
        return false;
    } else { alert('no item selected'); }
}


////////this is the function which is to calculate the solo extra line rate for the per insertion line		
function getsoloextrarateforqbc(adscat, color, edit, size, adcat1, grid_gross, gridid) {
    ////this is the page which we call to chk whether the no. of lines or words falls in the to inserts and from 
    /////than package rate is to be taken and if it exceeds than extra rate of solo  is to be added ih the break up gross amt  

    if (document.getElementById('hiddenuomdesc').value == "ROC" || document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROW" || document.getElementById('hiddenuomdesc').value == "CD" || document.getElementById('hiddenuomdesc').value == "ROD") {
        var gridfromline;
        var gridtoline;
        var gridextrarate
        if (ds_sch.Tables[1].Rows.length > 0) {
            gridfromline = ds_sch.Tables[1].Rows[0].Size_from;
            gridtoline = ds_sch.Tables[1].Rows[0].Size_to;
            gridextrarate = ds_sch.Tables[1].Rows[0].extrarate;
            var rol = size
            var totcardrate = document.getElementById('txtcardrate').value

            if (parseInt(rol) > parseInt(gridtoline)) {
                var totline = parseInt(rol) - parseInt(gridtoline)
                var totrate = parseFloat(gridextrarate) * parseInt(totline);
                var tot_rat = parseFloat(document.getElementById("gro" + gridid).value) + parseFloat(totrate);
                document.getElementById("gro" + gridid).value = formatDecimal(tot_rat, true, 2);

                var len = "bookdiv";
                var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
                var i = 0;
                var k;
                var gross;
                var tot_gross = 0;
                for (k = 0; i < y - 1; k++) {
                    while (document.getElementById("card" + i) == null && k < y - 1) {
                        i = i + totid;

                    }
                    if (k >= y - 1) {
                        break;
                    }
                    gross = "gro" + i;
                    tot_gross = parseFloat(document.getElementById(gross).value) + tot_gross;

                    i++;

                }
                document.getElementById('txtgrossamt').value = formatDecimal(parseFloat(tot_gross), true, 2);

            }




        }
    }



}

function buttonprev() {
    document.getElementById('btnok').disabled = true;
    if (document.getElementById('btnprintf') != null)
        document.getElementById('btnprintf').disabled = true;
    if (document.getElementById('tdlogo') != null && document.getElementById('txtlogoupload') != null && document.getElementById('txtlogoupload').value == "") {
        alert("Please Upload Logo");
        return false;
    }
    if (browser != "Microsoft Internet Explorer") {
        //document.getElementById('editordiv').value=trim(document.getElementById('editordiv').value);

        if (document.getElementById('editordiv').innerHTML == "") {
            alert("Please type the matter");
            document.getElementById('editordiv').focus();
            return false;
        }
    }
    else {
        //document.getElementById('editordiv').innerText=trim(document.getElementById('editordiv').innerText);
        if (document.getElementById('editordiv').innerText == "") {
            alert("Please type the matter");
            document.getElementById('editordiv').focus();
            return false;
        }
    }



    /*new change ankur sharma*/
    var temp = "@";
    var orignal_text = "@";
    var matter_textstring = "";
    if (document.getElementById('hiddenuom_desc').value == "ROL") {
        if (browser != "Microsoft Internet Explorer") {
            matter_textstring = document.getElementById('editordiv').innerHTML;

        }
        else {
            matter_textstring = document.getElementById('editordiv').innerText;
        }

    }

    if (browser != "Microsoft Internet Explorer") {
        if (document.getElementById('editordiv').innerHTML == "") {
            alert("Please Enter Matter");
            document.getElementById('editordiv').disabled = false;
            return false;
        }
    }
    else {
        if (document.getElementById('editordiv').innerText == "") {
            alert("Please Enter Matter");
            document.getElementById('editordiv').disabled = false;
            return false;
        }
    }
    //************************************************************************************************

    var hiddenwidth = document.getElementById('hiddenwidth').value;
    var hiddenuom = document.getElementById('hiddenuom').value;


    var matterText = ""

    if (browser != "Microsoft Internet Explorer") {
        // matterText=document.getElementById('editordiv').innerHTML;
        matterText = document.getElementById('editordiv').textContent;
    }
    else {
        matterText = document.getElementById('editordiv').innerText;
    }

    ////////this function use for patrika(BHANU)//
    if (clientfromconfig == "SP" || clientfromconfig == "RP") {
        var chk = editor_new.bindbannedword(matterText);
        var sta1 = chk.value.split('$~$')[0];  //
        if (sta1 == "false") {
            alert(chk.value.split('$~$')[1] + " is Banned Word in Matter Composing. Please remove this word for getting Preview");                       //      
            return false;                     //
        }
    }
    //////////////(BHANU END)/////////////////////

    /*new change ankur for prev*/
    //    if(matter_textstring!="")
    //    {
    //             matterText=matter_textstring;
    //    }
    var str = document.getElementById('editordiv').innerHTML;
    //var str=matterText;
    //matterText=matterText.replace("&","^");
    //////////////////

    var hiddeninsert = document.getElementById('hiddeninsert').value;
    str = str.replace("#", "^");
    //str=str.replace("&","?");

    /*new change ankur 9 feb*/
    var coltype = document.getElementById('hiddencoltype').value;
    /*new change ankur for matter*/
    var logo_name = document.getElementById('hiddenlogoname').value;
    var modify_logo = document.getElementById('hiddenmodify').value;
    ///////////////
    /*new chagne this to save the matter in session using ajax*/

    //window.open('matterpreview.aspx?insertNo='+document.getElementById('hiddenInsertNo').value+'&srno='+document.getElementById('hiddensrno').value+'&edition='+document.getElementById('hiddenedition').value+'&cioid='+document.getElementById('cioid').value+'&hiddeninsert='+hiddeninsert+'&hiddenuom='+hiddenuom+'&hiddenwidth='+hiddenwidth+'&eyecatchlen='+document.getElementById('hiddeneyecatchlength').value+'&fontsize='+document.getElementById('fnt_fntsize').value+'&fontname='+document.getElementById('fnt_fntname').value+'&eyecatch='+document.getElementById('hiddeneyecatcher').value+'&bgcolor='+document.getElementById('hiddenbgcolor').value+'&matter='+str+'&matterText='+matterText+'&coltype='+coltype+'&logo_name='+logo_name+'&modify_logo='+modify_logo,'Preview','width=250px,height=300,resizable=0,left=200,top=0,scrollbars=yes');
    /*change for oracle*/

    ////////////////
    // matter.savethematterinsession(str,matterText,call_openmatterpreview);
    if (clientfromconfig == "SP" || clientfromconfig == "RP") {
        var resp = editor_new.savethematterinsession(str, matterText);
    }
    else
        var resp = Editor.savethematterinsession(str, matterText);

    call_openmatterpreview(resp);

    return false;
}

function call_openmatterpreview(res) {
    var hiddeninsert = document.getElementById('hiddeninsert').value;
    var hiddenwidth = document.getElementById('hiddenwidth').value;
    var hiddenuom = document.getElementById('hiddenuom').value;
    var coltype = document.getElementById('hiddencoltype').value;
    /*new change ankur for matter*/
    var logo_name = document.getElementById('hiddenlogoname').value;
    if (document.getElementById('txtlogoupload') != null)
        logo_name = document.getElementById('txtlogoupload').value;
    var logo_name1 = "";
    if (document.getElementById('txtlogoupload1') != null)
        logo_name1 = document.getElementById('txtlogoupload1').value;
    var modify_logo = document.getElementById('hiddenmodify').value;

    var logohei = document.getElementById('hiddenlogohei').value;
    if (document.getElementById('txtlogohei') != null)
        logohei = document.getElementById('txtlogohei').value;
    var logowid = document.getElementById('hiddenlogowid').value;
    if (document.getElementById('txtlogowid') != null)
        logowid = document.getElementById('txtlogowid').value;
    var logohei1 = "";
    if (document.getElementById('txtlogohei1') != null)
        logohei1 = document.getElementById('txtlogohei1').value;
    var logowid1 = "";
    if (document.getElementById('txtlogowid1') != null)
        logowid1 = document.getElementById('txtlogowid1').value;
    /*mysql*/
    var previd = document.getElementById('hiddenpreviousid').value;
    var index = window.opener.document.getElementById('drpcolor').selectedIndex;
    var textcolor;
    if (index != -1)
        textcolor = window.opener.document.getElementById('drpcolor').options[index].text;
    var language = '';
    var fntname = '';



    if (document.getElementById('fnt_fntname') != null) {
        language = document.getElementById('fnt_fntname').value
        //fntname=document.getElementById('KEYBORD').value
    }
    var boxcode = "0";

    if (window.opener.document.getElementById('drpboxcode') != null) {
        boxcode = window.opener.document.getElementById('drpboxcode').value;
    }
    if (window.opener.document.getElementById('drpboxcodenew') != null) {
        boxcode = window.opener.document.getElementById('drpboxcodenew').value;
    }
    var boxno = window.opener.document.getElementById('txtboxno').value;   //*14sep
    if (window.opener.document.getElementById('txtboxnonew') != null)
        boxno = window.opener.document.getElementById('txtboxnonew').value;
    //  alert(boxno);  
    //    var boxno=window.opener.document.getElementById('txtreceipt').value  
    var eyecatchtype = document.getElementById('hiddeneyecatchval').value;
    var bPrem = document.getElementById('hiddenbPrem').value;
    if (document.activeElement.id == "btncalline") {
        // for calculation line without Preview    
        if (browser != "Microsoft Internet Explorer") {
            var httpRequest = null;
            httpRequest = new XMLHttpRequest();
            if (httpRequest.overrideMimeType) {
                httpRequest.overrideMimeType('text/xml');
            }

            httpRequest.onreadystatechange = function () { alertContents(httpRequest) };
            httpRequest.open("GET", 'matterprevLine.aspx?bPrem=' + bPrem + '&eyecatchtype=' + eyecatchtype + '&insertNo=' + document.getElementById('hiddenInsertNo').value + '&srno=' + document.getElementById('hiddensrno').value + '&edition=' + document.getElementById('hiddenedition').value + '&cioid=' + document.getElementById('cioid').value + '&hiddeninsert=' + hiddeninsert + '&hiddenuom=' + hiddenuom + '&hiddenwidth=' + hiddenwidth + '&eyecatchlen=' + document.getElementById('hiddeneyecatchlength').value + '&eyecatch=' + document.getElementById('hiddeneyecatcher').value + '&bgcolor=' + document.getElementById('hiddenbgcolor').value + '&coltype=' + coltype + '&logo_name=' + logo_name + '&modify_logo=' + modify_logo + '&logohei=' + logohei + '&logowid=' + logowid + '&previd=' + previd + '&txtcolor=' + textcolor + '&language=' + language + '&fntname=' + fntname + '&boxcode=' + boxcode + '&boxno=' + boxno, false);
            httpRequest.send('');
            if (httpRequest.readyState == 4) {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) {
                    strtext = httpRequest.responseText;
                    if (strtext != "") {
                        var arr = strtext.split("æ");
                        document.getElementById('hiddenFileName').value = arr[0];
                        document.getElementById('txtnoofline').value = arr[1];
                        document.getElementById('hiddenLineCount').value = arr[1];
                    }

                    parentid_QBC(hiddeninsert);
                }
                else {
                    alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                }
            }
        }
        else {
            var xml = new ActiveXObject("Microsoft.XMLHTTP");
            xml.Open("GET", 'matterprevLine.aspx?bPrem=' + bPrem + '&eyecatchtype=' + eyecatchtype + '&insertNo=' + document.getElementById('hiddenInsertNo').value + '&srno=' + document.getElementById('hiddensrno').value + '&edition=' + document.getElementById('hiddenedition').value + '&cioid=' + document.getElementById('cioid').value + '&hiddeninsert=' + hiddeninsert + '&hiddenuom=' + hiddenuom + '&hiddenwidth=' + hiddenwidth + '&eyecatchlen=' + document.getElementById('hiddeneyecatchlength').value + '&eyecatch=' + document.getElementById('hiddeneyecatcher').value + '&bgcolor=' + document.getElementById('hiddenbgcolor').value + '&coltype=' + coltype + '&logo_name=' + logo_name + '&modify_logo=' + modify_logo + '&logohei=' + logohei + '&logowid=' + logowid + '&previd=' + previd + '&txtcolor=' + textcolor + '&language=' + language + '&fntname=' + fntname + '&boxcode=' + boxcode + '&boxno=' + boxno, false);
            xml.Send();
            strtext = xml.responseText;
            //alert(strtext);
            if (strtext != "") {
                var arr = strtext.split("æ");
                document.getElementById('hiddenFileName').value = arr[0];
                document.getElementById('txtnoofline').value = arr[1];
                document.getElementById('hiddenLineCount').value = arr[1];
            }
            parentid_QBC(hiddeninsert);

        }
    }
    else {
        if (clientfromconfig == "SP") {
            if (logo_name == "" || logo_name == "All") {
                var rono1 = window.opener.document.getElementById('txtrono').value;
                if (window.opener.document.getElementById('txtagencytype') != null)
                    var agtype1 = window.opener.document.getElementById('txtagencytype').value;
                else
                    var agtype1 = "";
                var agencycode1 = window.opener.document.getElementById('txtagency').value.substring(window.opener.document.getElementById('txtagency').value.lastIndexOf('(') + 1, window.opener.document.getElementById('txtagency').value.length + window.opener.document.getElementById('txtagency').value.lastIndexOf('('));
                agencycode1 = agencycode1.replace(")", "");
                window.open('matterprev.aspx?bPrem=' + bPrem + '&eyecatchtype=' + eyecatchtype + '&insertNo=' + document.getElementById('hiddenInsertNo').value + '&srno=' + document.getElementById('hiddensrno').value + '&edition=' + document.getElementById('hiddenedition').value + '&cioid=' + document.getElementById('cioid').value + '&hiddeninsert=' + hiddeninsert + '&hiddenuom=' + hiddenuom + '&hiddenwidth=' + hiddenwidth + '&eyecatchlen=' + document.getElementById('hiddeneyecatchlength').value + '&eyecatch=' + document.getElementById('hiddeneyecatcher').value + '&bgcolor=' + document.getElementById('hiddenbgcolor').value + '&coltype=' + coltype + '&logo_name=' + logo_name + '&modify_logo=' + modify_logo + '&logohei=' + logohei + '&logowid=' + logowid + '&previd=' + previd + '&txtcolor=' + textcolor + '&language=' + language + '&fntname=' + fntname + '&boxcode=' + boxcode + '&boxno=' + boxno + '&rono1=' + rono1 + '&agtype1=' + agtype1 + '&agencycode1=' + agencycode1 + '&logoprem=' + document.getElementById('hiddenlogoprem').value + '&pucode=' + document.getElementById('hinpubselect').value, 'Preview', 'width=9000px,height=900,resizable=0,left=200,top=0,scrollbars=yes');

            }
            else {

                window.open('matterprev.aspx?bPrem=' + bPrem + '&eyecatchtype=' + eyecatchtype + '&insertNo=' + document.getElementById('hiddenInsertNo').value + '&srno=' + document.getElementById('hiddensrno').value + '&edition=' + document.getElementById('hiddenedition').value + '&cioid=' + document.getElementById('cioid').value + '&hiddeninsert=' + hiddeninsert + '&hiddenuom=' + hiddenuom + '&hiddenwidth=' + hiddenwidth + '&eyecatchlen=' + document.getElementById('hiddeneyecatchlength').value + '&eyecatch=' + document.getElementById('hiddeneyecatcher').value + '&bgcolor=' + document.getElementById('hiddenbgcolor').value + '&coltype=' + coltype + '&logo_name=' + logo_name + '&modify_logo=' + modify_logo + '&logohei=' + logohei + '&logowid=' + logowid + '&previd=' + previd + '&txtcolor=' + textcolor + '&language=' + language + '&fntname=' + fntname + '&boxcode=' + boxcode + '&boxno=' + boxno + '&rono1=' + rono1 + '&agtype1=' + agtype1 + '&agencycode1=' + agencycode1 + '&logoprem=' + document.getElementById('hiddenlogoprem').value + '&pucode=' + document.getElementById('hinpubselect').value, 'Preview', 'width=900px,height=900,resizable=0,left=200,top=0,scrollbars=yes');

                //  window.open('matterprev_new.aspx?bPrem=' + bPrem + '&eyecatchtype=' + eyecatchtype + '&insertNo=' + document.getElementById('hiddenInsertNo').value + '&srno=' + document.getElementById('hiddensrno').value + '&edition=' + document.getElementById('hiddenedition').value + '&cioid=' + document.getElementById('cioid').value + '&hiddeninsert=' + hiddeninsert + '&hiddenuom=' + hiddenuom + '&hiddenwidth=' + hiddenwidth + '&eyecatchlen=' + document.getElementById('hiddeneyecatchlength').value + '&eyecatch=' + document.getElementById('hiddeneyecatcher').value + '&bgcolor=' + document.getElementById('hiddenbgcolor').value + '&coltype=' + coltype + '&logo_name=' + logo_name + '&modify_logo=' + modify_logo + '&logohei=' + logohei + '&logowid=' + logowid + '&previd=' + previd + '&txtcolor=' + textcolor + '&language=' + language + '&fntname=' + fntname + '&boxcode=' + boxcode + '&boxno=' + boxno, 'Preview', 'width=400px,height=300px,resizable=0,left=200,top=0,scrollbars=yes');
            }
        }
        else {
            if (clientfromconfig == "DJ") {
                if (window.opener.document.getElementById('txtrono').value == "") {
                    alert("Please Enter the RO. Number")
                    return false;
                }
            }
            var rono1 = window.opener.document.getElementById('txtrono').value;
            if (window.opener.document.getElementById('txtagencytype') != null)
                var agtype1 = window.opener.document.getElementById('txtagencytype').value;
            else
                var agtype1 = "";
            var agencycode1 = window.opener.document.getElementById('txtagency').value.substring(window.opener.document.getElementById('txtagency').value.lastIndexOf('(') + 1, window.opener.document.getElementById('txtagency').value.length + window.opener.document.getElementById('txtagency').value.lastIndexOf('('));
            agencycode1 = agencycode1.replace(")", "");
            var rcp = "";
            if (document.getElementById('hidreceipt') != null)
                rcp = document.getElementById('hidreceipt').value;
            var formname = "";
            if (document.getElementById('hidformname') != null)
                formname = document.getElementById('hidformname').value;
            window.open('matterprev.aspx?receiptno=' + rcp + '&formname=' + formname + '&bPrem=' + bPrem + '&eyecatchtype=' + eyecatchtype + '&insertNo=' + document.getElementById('hiddenInsertNo').value + '&srno=' + document.getElementById('hiddensrno').value + '&edition=' + document.getElementById('hiddenedition').value + '&cioid=' + document.getElementById('cioid').value + '&hiddeninsert=' + hiddeninsert + '&hiddenuom=' + hiddenuom + '&hiddenwidth=' + hiddenwidth + '&eyecatchlen=' + document.getElementById('hiddeneyecatchlength').value + '&eyecatch=' + document.getElementById('hiddeneyecatcher').value + '&bgcolor=' + document.getElementById('hiddenbgcolor').value + '&coltype=' + coltype + '&logo_name=' + logo_name + '&modify_logo=' + modify_logo + '&logohei=' + logohei + '&logowid=' + logowid + '&previd=' + previd + '&txtcolor=' + textcolor + '&language=' + language + '&fntname=' + fntname + '&boxcode=' + boxcode + '&boxno=' + boxno + '&rono1=' + rono1 + '&agtype1=' + agtype1 + '&agencycode1=' + agencycode1 + '&logo_name1=' + logo_name1 + '&logohei1=' + logohei1 + '&logowid1=' + logowid1 + '&pucode=' + document.getElementById('hinpubselect').value + '&logoprem=', 'Preview', 'width=900px,height=900,resizable=0,left=200,top=0,scrollbars=yes');
        }
    }
    // window.open('matterprev.aspx?insertNo='+document.getElementById('hiddenInsertNo').value+'&srno='+document.getElementById('hiddensrno').value+'&edition='+document.getElementById('hiddenedition').value+'&cioid='+document.getElementById('cioid').value+'&hiddeninsert='+hiddeninsert+'&hiddenuom='+hiddenuom+'&hiddenwidth='+hiddenwidth+'&eyecatchlen='+document.getElementById('hiddeneyecatchlength').value+'&eyecatch='+document.getElementById('hiddeneyecatcher').value+'&bgcolor='+document.getElementById('hiddenbgcolor').value+'&coltype='+coltype+'&logo_name='+logo_name+'&modify_logo='+modify_logo+'&logohei='+logohei+'&logowid='+logowid+'&previd='+previd+'&txtcolor='+textcolor+'&language='+language+'&fntname='+fntname,'Preview','width=250px,height=300,resizable=0,left=200,top=0,scrollbars=yes');

    // window.open('matterprev.aspx?insertNo='+document.getElementById('hiddenInsertNo').value+'&srno='+document.getElementById('hiddensrno').value+'&edition='+document.getElementById('hiddenedition').value+'&cioid='+document.getElementById('cioid').value+'&hiddeninsert='+hiddeninsert+'&hiddenuom='+hiddenuom+'&hiddenwidth='+hiddenwidth+'&eyecatchlen='+document.getElementById('hiddeneyecatchlength').value+'&eyecatch='+document.getElementById('hiddeneyecatcher').value+'&bgcolor='+document.getElementById('hiddenbgcolor').value+'&coltype='+coltype+'&logo_name='+logo_name+'&modify_logo='+modify_logo+'&logohei='+logohei+'&logowid='+logowid+'&previd='+previd+'&txtcolor='+textcolor,'Preview','width=250px,height=300,resizable=0,left=200,top=0,scrollbars=yes');

    return false;
}

function goOk() {
    window.opener.document.getElementById('txtnoofline').value = document.getElementById('hiddennooflines').value;
}

//function fontajay(b) {
//    //if (oDiv.isContentEditable==true) document.execCommand("FontName",false,"fntname");
//    //editordiv.style.fontFamily=document.getElementById('fnt_fntname').value;
//    document.execCommand("FontName", false, b)
//    return false;
//}

function prev1() {

    var fontTags = new Array();

    var fontTags = document.getElementsByTagName('font');

    for (n = 0; n < fontTags.length; n++) {

        //document.write(fontTags[n].innerHTML + "<br>");
    }
    return false;
}


/////////////////////////////////this is the function which sets the no of lines into the text box of main form and also into the grid
////////////////but
function parentid(ins) {

    gb_ins = ins;

    /*this is to chk whether the lines is not graeater than max lines if yes than don't allow booking*/
    var adtype = "";
    if (window.opener.opener.document.getElementById('drpadtype') != null) {
        adtype = window.opener.opener.document.getElementById('drpadtype').value
    }
    var adcat = window.opener.opener.document.getElementById('drpadcategory').value;
    var adscat = window.opener.opener.document.getElementById('drpadsubcategory').value;
    var adscat1 = window.opener.opener.document.getElementById('drpadcat3').value;
    var adscat2 = window.opener.opener.document.getElementById('drpadcat4').value;
    var adscat3 = window.opener.opener.document.getElementById('drpadcat5').value;
    var color = window.opener.opener.document.getElementById('drpcolor').value;
    var uom = window.opener.opener.document.getElementById('drpuom').value;
    var uomdesc = window.opener.opener.document.getElementById('hiddenuomdesc').value;
    var dateformat = window.opener.opener.document.getElementById('hiddendateformat').value;
    var currency = window.opener.opener.document.getElementById('hiddencurrency').value;
    var compcode = window.opener.opener.document.getElementById('hiddencompcode').value;
    var dateselect = window.opener.opener.document.getElementById('txtdummydate').value;
    var noofinserts = window.opener.opener.document.getElementById('txtinsertion').value;
    var ratecode = "qbc";
    var lines = ""

    lines = window.opener.document.getElementById('txtnoofline').value
    if (window.opener.document.getElementById('hiddenLineCount').value == "" || window.opener.document.getElementById('hiddenLineCount').value == "0") {
        window.opener.document.getElementById('hiddenLineCount').value = lines;
    }
    window.opener.opener.document.getElementById('hiddenLineCount').value = window.opener.document.getElementById('hiddenLineCount').value;


    //////////////this code is to split the code as well as ites description

    var objpack = window.opener.opener.document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var codepck = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (temp != "") {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                codepck = tempvalcode + "," + codepck;
                desc = tempcode + "," + desc;


            }
            else {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                codepck = tempvalcode;
                desc = tempcode;
            }
        }

    }




    var package1 = codepck;

    /*mysql*/
    /* if(window.opener.opener.document.getElementById('hiddenagencyrate').value=="yes" && window.opener.opener.document.getElementById('hiddentypedatabase').value=="mysql")
    {
    matterprev.getthemaxlines_agency(adtype,color,adcat,adscat,currency,ratecode,package1,dateselect,compcode,uom,noofinserts,lines,adscat1,adscat2,adscat3,"",lines,dateformat,uomdesc,window.opener.opener.document.getElementById('hiddenagencycodeforrate').value,call_getmaxlines)
    }
    else
    {
    matterprev.getthemaxlines(adtype,color,adcat,adscat,currency,ratecode,package1,dateselect,compcode,uom,noofinserts,lines,adscat1,adscat2,adscat3,"",lines,dateformat,uomdesc,call_getmaxlines)
    }  */
    if (window.opener.document.getElementById('hiddeninsertstatus') != null && window.opener.document.getElementById('hiddeninsertstatus').value != "billed") {

        window.opener.document.getElementById('btnok').disabled = false;
    }
    else if (window.opener.document.getElementById('hiddeninsertstatus') != null && window.opener.document.getElementById('hiddeninsertstatus').value == "billed") {
        alert("This Booking Id Is Billed Matter Can Not Be Changed");
        window.opener.document.getElementById('btnok').disabled = true;
    }
    else {
        window.opener.document.getElementById('btnok').disabled = false;
    }
    if (window.opener.document.getElementById('btnprintf') != null)
        window.opener.document.getElementById('btnprintf').disabled = false;
    return false;



    ////  

    return false;

}


function call_getmaxlines(res) {
    var ds = res.value

    //if(ds.Tables[0]!=null && ds.Tables[0]!=undefined && ds.Tables[0].Rows[0].Max_Area!="" && ds.Tables[0].Rows[0].Max_Area!='0' && ds.Tables[0].Rows.length>0)
    if (ds != undefined && eval(ds) != undefined && ds != null && ds.Tables[0] != null && ds.Tables[0] != undefined && ds.Tables[0].Rows.length > 0 && ds.Tables[0].Rows[0].Max_Area != null && ds.Tables[0].Rows[0].Max_Area != undefined && ds.Tables[0].Rows[0].Max_Area != "" && ds.Tables[0].Rows[0].Max_Area != '0') {
        var maxlines = parseInt(ds.Tables[0].Rows[0].Max_Area)
        var curr_line = parseInt(window.opener.document.getElementById('txtnoofline').value)

        if (curr_line > maxlines) {
            alert("You can compose upto " + ds.Tables[0].Rows[0].Max_Area + " lines of ad");
            window.opener.opener.document.getElementById('txttotalarea').value = "";
            window.opener.opener.document.getElementById('txtcardrate').value = "";
            window.opener.opener.document.getElementById('txtgrossamt').value = "";
            window.opener.document.getElementById('txtnoofline').value = "";
            window.close();
            return false;
        }

    }
    else {
        if (ds != undefined && eval(ds) != undefined && ds != null && ds.Tables[0].Rows.length > 0) {
            if (ds.Tables[0].Rows[0].Max_Area != null && ds.Tables[0].Rows[0].Max_Area != '' && ds.Tables[0].Rows[0].Max_Area != "0") {
                alert("The package is not valid or the max lines are not define");
                window.opener.opener.document.getElementById('txttotalarea').value = "";
                window.opener.opener.document.getElementById('txtcardrate').value = "";
                window.opener.opener.document.getElementById('txtgrossamt').value = "";
                window.close();
            }
        }
        return false;


    }


    var len = "bookdiv";
    if (gb_ins == "no") {
        var no_of_line = window.opener.opener.document.getElementById('txttotalarea').value = window.opener.document.getElementById('txtnoofline').value
        window.opener.opener.document.getElementById('txtcardrate').value = "";
        window.opener.opener.document.getElementById('txtgrossamt').value = "";
    }
    else {
        var size1 = "siz" + gb_ins
        // window.opener.opener.document.getElementById('txttotalarea').value=window.opener.document.getElementById('txtnoofline').value;
        var no_of_line = window.opener.opener.document.getElementById(size1).value = window.opener.document.getElementById('txtnoofline').value
        var adscat1 = "ads" + gb_ins;
        var edit1 = "edit" + gb_ins;
        var color1 = "col" + gb_ins;
        var grid_gross1 = "gro" + gb_ins;
        var adcat11 = "adcat" + gb_ins;



        var size = window.opener.opener.document.getElementById(size1).value;
        var adscat = window.opener.opener.document.getElementById(adscat1).value;
        var color = window.opener.opener.document.getElementById(color1).value;
        var grid_gross = window.opener.opener.document.getElementById(grid_gross1).value;
        var adcat1 = window.opener.opener.document.getElementById(adcat11).value;
        var edit = window.opener.opener.document.getElementById(edit1).value;

        window.opener.opener.getsoloextrarateforqbc(adscat, color, edit, size, adcat1, grid_gross, gb_ins);

    }


}






function contractapply() {
    if (document.getElementById('chkcontract').checked == false) {
        document.getElementById('txtcontractname').value = ""
        document.getElementById('txtcontracttype').value = ""
        document.getElementById('txtdealrate').value = "";
        document.getElementById('txtdeviation').value = "";
        if (document.getElementById('txtgrossamt').value != "") {
            fillrateintogrid();
        }

    }
    return;

}
////////////////////////////////add by anuja
function okClick_matter12() {
 //alert("terebefor1");
    var ins_lines = document.getElementById('hiddeninsert').value;

    //    if (ins_lines == "no") {
    //        window.opener.document.getElementById('txttotalarea').value = document.getElementById('txtnoofline').value;
    //    }
    //    else {
    //        var size1 = "siz" + ins_lines;

    //        var no_of_line = window.opener.document.getElementById(size1).value = document.getElementById('txtnoofline').value;
    //    }
    var srno = document.getElementById('hiddensrno').value;
    var size = "";
    var item = parseInt(window.opener.document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1);
    var totalarea_vari = opener.document.getElementById('txttotalarea');
    var hiddenfilename_vari = document.getElementById('hiddenFileName');
    var packagecode = document.getElementById('hiddenpublicode').value;
    var file_vari = "";
    var res = Editor.findpub(packagecode);
    var ds = res.value;
    var lincountt = "";
    if (ds.Tables[0].Rows.length > 0) {
        var datalengt = ds.Tables[0].Rows[0].PUBLS.split(',');
        for (var m = 0; m < datalengt.length; m++) {
            if (lincountt == "")
                lincountt = document.getElementById('linecount_' + m).value;
            else
                lincountt = lincountt + "," + document.getElementById('linecount_' + m).value;

        }
    }
    var line_arr = lincountt.split(',').sort()
    var maxVal = line_arr[line_arr.length - 1]
    var maxline = maxVal;


    if (ins_lines == "no") {
        window.opener.document.getElementById('txttotalarea').value = maxline; // document.getElementById('txtnoofline').value;
    }
    else {
        var size1 = "siz" + ins_lines;

        var no_of_line = window.opener.document.getElementById(size1).value = maxline; //  document.getElementById('txtnoofline').value;
    }
    if (srno == "All") {
        if (ds.Tables[0].Rows.length > 0) {
            var datalengt = ds.Tables[0].Rows[0].PUBLS.split(',');
            for (var i = 0; i < item; i++) {
                size = "siz" + i;
                var previd_vari = document.getElementById('hiddenpreviousid');
                var editioncode = opener.document.getElementById('edit' + i).value;
                var comcode = document.getElementById('hidencomcode').value;
                var res = Editor.pucodforedition(comcode, editioncode);
                var ds11 = res.value;
                for (var j = 0; j < datalengt.length; j++) {
                    var matchpub = datalengt[j].replace(" ", "").replace(" ", "");
                    if (matchpub == ds11.Tables[0].Rows[0].PUB_CODE) {
                        if (document.getElementById('filename_' + j).value != "" || document.getElementById('filename_' + j).value != null) {
                            file_vari = document.getElementById('filename_' + j).value;
                            opener.document.getElementById('fil' + i).value = file_vari;
                        }
                    }
                }
                // var file44 = opener.document.getElementById('fil' + i).value;
                if (opener.document.getElementById('splboldsize' + i) != null && document.getElementById('hiddenboldchar') != null)
                    opener.document.getElementById('splboldsize' + i).value = document.getElementById('hiddenboldchar').value;
                if (document.getElementById('tdlogo') != null && document.getElementById('tdlogo').style.visibility == "") {
                    if (document.getElementById('txtlogoupload').value == "") {
                        opener.document.getElementById('logohei' + i).value = document.getElementById('txtlogohei').value;
                        opener.document.getElementById('logowid' + i).value = document.getElementById('txtlogowid').value;
                        opener.document.getElementById('logonam' + i).value = document.getElementById('txtlogoupload').value;
                    }
                    else {
                        opener.document.getElementById('logohei' + i).value = document.getElementById('txtlogohei').value;
                        opener.document.getElementById('logowid' + i).value = document.getElementById('txtlogowid').value;
                        opener.document.getElementById('logonam' + i).value = document.getElementById('txtlogoupload').value;
                    }

                }
                if (totalarea_vari.value == "") {
                    totalarea_vari.value = file_vari.value; // hiddenfilename_vari.value;
                }

                // file_vari.value = file_vari;// hiddenfilename_vari.value;
                if (totalarea_vari.value != '') {

                    opener.document.getElementById(size).value = totalarea_vari.value;
                }
                if (clientfromconfig1 == "SP") {
                    if (document.getElementById('tdlogo') != null && document.getElementById('tdlogo').style.visibility == "") {
                        file_vari.value = document.getElementById('txtlogoupload').value;
                    }

                }

                //}
            }
        }
    }
    else {
        var packagecode = document.getElementById('hiddenpublicode').value;
        var file_vari = "";
        var res = Editor.findpub(packagecode);
        var ds = res.value;

        opener.document.getElementById('fil' + srno).value = hiddenfilename_vari.value;
        var editionName = opener.document.getElementById('edit' + srno).value;
        var line = opener.document.getElementById('siz' + srno).value;
        var item = parseInt(window.opener.document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1);
       // alert("terebefor2");
        if (confirm("Do You Want To Copy the Material in all Editions")) {
            if (ds.Tables[0].Rows.length > 0) {
                var datalengt = ds.Tables[0].Rows[0].PUBLS.split(',');
                for (var i = 0; i < item; i++) {
                    var editioncode = opener.document.getElementById('edit' + i).value;
                    var comcode = document.getElementById('hidencomcode').value;
                    var res = Editor.pucodforedition(comcode, editioncode);
                    var ds11 = res.value;
                    //var file_vari = opener.document.getElementById('fil' + i);
                    for (var j = 0; j < datalengt.length; j++) {
                        var matchpub = datalengt[j].replace(" ", "").replace(" ", "");
                        if (matchpub == ds11.Tables[0].Rows[0].PUB_CODE) {
                            if (opener.document.getElementById('filename_' + j) != "") {
                                file_vari = opener.document.getElementById('filename_' + j);
                                opener.document.getElementById('fil' + i).value = hiddenfilename_vari.value;//file_vari;
                                opener.document.getElementById('siz' + i).value = line;
                            }
                        }
                    }
                    if (editionName == opener.document.getElementById('edit' + i).value) {

                        if (opener.document.getElementById('inssta' + i).value == "booked" || opener.document.getElementById('inssta' + i).value == "hold") {
                            opener.document.getElementById('fil' + i).value = /*file_vari.value; //*/ hiddenfilename_vari.value;
                            opener.document.getElementById('siz' + i).value = line;
                        }

                    }
                    //}
                }
            }

        }
        if (document.getElementById('tdlogo') != null && document.getElementById('tdlogo').style.visibility == "") {
            opener.document.getElementById('logohei' + srno).value = document.getElementById('txtlogohei').value;
            opener.document.getElementById('logowid' + srno).value = document.getElementById('txtlogowid').value;
            opener.document.getElementById('logonam' + srno).value = document.getElementById('txtlogoupload').value;
        }
        //if (totalarea_vari.value == "") {
            totalarea_vari.value = maxline; // document.getElementById('txtnoofline').value;
        //}
    }
    opener.document.getElementById('txtgrossamt').value = '';
    window.close();
    if (opener.document.getElementById('tbvts') != null) {
        opener.document.getElementById('tbvts').style.display = "none";
        opener.document.getElementById('tblrate').style.display = "none";
        opener.document.getElementById('tblbill').style.display = "none";
        opener.document.getElementById('addetails').style.display = "none";

        opener.document.getElementById('tblpackage').style.display = "none";
        opener.document.getElementById('tbbox').style.display = "none";
    }
    if (opener.document.getElementById('pagedetail') != null)
        opener.document.getElementById('pagedetail').style.display = "block";
    if (opener.document.getElementById('drppageposition').disabled == false) {
        opener.document.getElementById('drppageposition').focus();
    }
    return false;
}
///////////////////////////////////////////

//***************************************************************************
function okClick_matter() {
    //alert(document.getElementById('hiddenFileName').value);
    var ins_lines = document.getElementById('hiddeninsert').value;

    if (ins_lines == "no") {
        window.opener.document.getElementById('txttotalarea').value = document.getElementById('txtnoofline').value;
    }
    else {
        var size1 = "siz" + ins_lines;

        var no_of_line = window.opener.document.getElementById(size1).value = document.getElementById('txtnoofline').value;
    }
    //window.opener.document.getElementById('splboldsize').value=document.getElementById('hiddenboldchar').value;
    var srno = document.getElementById('hiddensrno').value;
    var size = "";
    var item = parseInt(window.opener.document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1);
    var totalarea_vari = opener.document.getElementById('txttotalarea');
    var hiddenfilename_vari = document.getElementById('hiddenFileName');
    if (srno == "All") {

        for (var i = 0; i < item; i++) {
            size = "siz" + i;
            var previd_vari = document.getElementById('hiddenpreviousid');
            var file_vari = opener.document.getElementById('fil' + i);
            if (opener.document.getElementById('splboldsize' + i) != null && document.getElementById('hiddenboldchar') != null)
                opener.document.getElementById('splboldsize' + i).value = document.getElementById('hiddenboldchar').value;
            if (document.getElementById('tdlogo') != null && document.getElementById('tdlogo').style.visibility == "") {
                if (document.getElementById('txtlogoupload').value == "") {
                    opener.document.getElementById('logohei' + i).value = document.getElementById('txtlogohei').value;
                    opener.document.getElementById('logowid' + i).value = document.getElementById('txtlogowid').value;
                    opener.document.getElementById('logonam' + i).value = document.getElementById('txtlogoupload').value;
                }
                else {
                    opener.document.getElementById('logohei' + i).value = document.getElementById('txtlogohei').value;
                    opener.document.getElementById('logowid' + i).value = document.getElementById('txtlogowid').value;
                    opener.document.getElementById('logonam' + i).value = document.getElementById('txtlogoupload').value;
                }

            }
            if (totalarea_vari.value == "") {
                totalarea_vari.value = hiddenfilename_vari.value;
            }
            //////            if(file_vari.value=="" || file_vari.value==hiddenfilename_vari.value)
            //////            {
            //////                file_vari.value=hiddenfilename_vari.value;
            //////            }
            //////            //hiddenpreviousid.Value
            //////            else if((previd_vari.value!="") && (file_vari.value !="" || file_vari.value==hiddenfilename_vari.value))
            //////            {
            file_vari.value = hiddenfilename_vari.value;

            ////// }
            //            if(opener.document.getElementById(size).value=="")
            //            {
            if (totalarea_vari.value != '') {

                opener.document.getElementById(size).value = totalarea_vari.value;
                //  }
            }
            if (clientfromconfig1 == "SP") {
                if (document.getElementById('tdlogo') != null && document.getElementById('tdlogo').style.visibility == "") {
                    file_vari.value = document.getElementById('txtlogoupload').value;
                }

            }

        }
    }
    else {
        opener.document.getElementById('fil' + srno).value = hiddenfilename_vari.value;
        var editionName = opener.document.getElementById('edit' + srno).value;
        var line = opener.document.getElementById('siz' + srno).value;
        var item = parseInt(window.opener.document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1);
        if (confirm("Do You Want To Copy the Material in all Editions")) {
            for (var i = 0; i < item; i++) {
                if (editionName == opener.document.getElementById('edit' + i).value) {

                    if (opener.document.getElementById('inssta' + i).value == "booked" || opener.document.getElementById('inssta' + i).value == "hold") {
                        opener.document.getElementById('fil' + i).value = hiddenfilename_vari.value;
                        opener.document.getElementById('siz' + i).value = line;
                    }

                }
            }

        }
        if (document.getElementById('tdlogo') != null && document.getElementById('tdlogo').style.visibility == "") {
            opener.document.getElementById('logohei' + srno).value = document.getElementById('txtlogohei').value;
            opener.document.getElementById('logowid' + srno).value = document.getElementById('txtlogowid').value;
            opener.document.getElementById('logonam' + srno).value = document.getElementById('txtlogoupload').value;
        }
        if (totalarea_vari.value == "") {
            totalarea_vari.value = document.getElementById('txtnoofline').value;
        }
    }
    opener.document.getElementById('txtgrossamt').value = '';
    window.close();
    if (opener.document.getElementById('tbvts') != null) {
        opener.document.getElementById('tbvts').style.display = "none";
        opener.document.getElementById('tblrate').style.display = "none";
        opener.document.getElementById('tblbill').style.display = "none";
        opener.document.getElementById('addetails').style.display = "none";

        opener.document.getElementById('tblpackage').style.display = "none";
        opener.document.getElementById('tbbox').style.display = "none";
    }
    if (opener.document.getElementById('pagedetail') != null)
        opener.document.getElementById('pagedetail').style.display = "block";
    if (opener.document.getElementById('drppageposition').disabled == false) {
        opener.document.getElementById('drppageposition').focus();
    }
    return false;
}

/*function buttonprev()
{
debugger;
alert("HI");
if(browser!="Microsoft Internet Explorer")
{
if(document.getElementById('editordiv').textContent=="")
{
alert("Please Enter Matter");
document.getElementById('editordiv').disabled=false;
return false;
}
}
else
{
if(document.getElementById('editordiv').innerText=="")
{
alert("Please Enter Matter");
document.getElementById('editordiv').disabled=false;
return false;
}
}
return false;
}*/

//function enblPrev(event)
//{
//    if(document.getElementById('editordiv').innerText=="")
//    {
//        document.getElementById('btnprev').disabled=true;
//    }
//    else
//    {
//        document.getElementById('btnprev').disabled=false;
//    }
//}
//***********************************************************************************************

function changediv() {
    //*25Aug* check for retainer or Executive
    if (document.getElementById('LinkButton1').disabled == true)
        return false;
    if (document.getElementById('drpretainer').disabled == false) {
        if (document.getElementById('drpretainer').value == "" && document.getElementById('txtexecname').value == "") {
            var a = "Executive name";
            var b = "Retainer";
            if (browser != "Microsoft Internet Explorer") {
                a = document.getElementById('lbececname').textContent.replace("*[F2]", "");
                b = document.getElementById('lblretainer').textContent.replace("*[F2]", "");
            }
            else {
                a = document.getElementById('lbececname').innerText.replace("*[F2]", "");
                b = document.getElementById('lblretainer').innerText.replace("*[F2]", "");
            }
            alert('Please fill ' + a + ' or ' + b + '.');

            document.getElementById('drpretainer').focus();
            return false;
        }
    }
    //

    if (enLink == "1") {
        document.getElementById('LinkButton1').disabled = false;
        document.getElementById('LinkButton2').disabled = false;
        document.getElementById('LinkButton3').disabled = false;
        document.getElementById('LinkButton4').disabled = false;
        document.getElementById('LinkButton5').disabled = false;
        document.getElementById('LinkButton6').disabled = false;
        document.getElementById('LinkButton7').disabled = false;
    }
    if (document.getElementById('LinkButton1').disabled == false) {
        if (document.getElementById('txtagency').value == "") {
            alert("Please fill the agency name");
            document.getElementById('txtagency').focus();
            return false;
        }
        else if (document.getElementById('drpagscode').value == "" || document.getElementById('drpagscode').value == "0") {
            alert("Please select the agency sub code");
            document.getElementById('drpagscode').focus();
            return false;

        }
        if (document.getElementById('txtrono').value != "" && document.getElementById('txtrono').disabled == false) {
            if (document.getElementById('txtrodate').value == "") {
                alert("Please fill ro date");
                document.getElementById('txtrodate').focus();
                return false;

            }

        }

        document.getElementById('LinkButton1').style.fontWeight = "bold";
        document.getElementById('LinkButton1').style.color = "#FFFF80";
        document.getElementById('LinkButton3').style.fontWeight = "normal";
        document.getElementById('LinkButton3').style.color = "White";
        document.getElementById('LinkButton2').style.fontWeight = "normal";
        document.getElementById('LinkButton2').style.color = "White";
        document.getElementById('LinkButton5').style.fontWeight = "normal";
        document.getElementById('LinkButton5').style.color = "White";
        document.getElementById('LinkButton4').style.fontWeight = "normal";
        document.getElementById('LinkButton4').style.color = "White";
        document.getElementById('LinkButton6').style.fontWeight = "normal";
        document.getElementById('LinkButton6').style.color = "White";
        document.getElementById('LinkButton7').style.fontWeight = "normal";
        document.getElementById('LinkButton7').style.color = "White";
        document.getElementById('tbvts').style.display = "none";
        document.getElementById('tblrate').style.display = "none";
        document.getElementById('tblbill').style.display = "none";
        //alert(document.getElementById('LinkButton1').click);
        document.getElementById('addetails').style.display = "block";
        if (document.getElementById('drpbooktype').disabled == false) {
            showstrip();
            document.getElementById('drpbooktype').focus();
        }
        document.getElementById('pagedetail').style.display = "none";
        //document.getElementById('tblsize').style.display="none";
        document.getElementById('tblpackage').style.display = "none";
        document.getElementById('tbbox').style.display = "none";
        return false;
    }
}






function gettheuomdesc() {
    //*25Aug*document.getElementById('txtcardrate').value="";
    //*25Aug*document.getElementById('txtgrossamt').value="";
    bindrategroupvode(document.getElementById('drpadcategory').value)
    rateRefresh();

    //                 if(document.getElementById('hiddentypedatabase').value=="mysql")
    //                 {
    //                    document.getElementById('chkattach').checked=true;
    //                    document.getElementById('chkattach').disabled=true;
    //                 }
    //		
    //                if(document.getElementById('tblinsert').innerHTML=="")
    //                {
    //                    alert("Please select the package");
    //                    document.getElementById('drpuom').value="0";
    //                    return false;
    //                }
    //////////////
    var uom_cod = document.getElementById('drpuom').value;
    var compcode = document.getElementById('hiddencompcode').value
    if (uom_cod != "0") {
        Classified_Booking.gettheuom_desc(compcode, uom_cod, changesizetoline);
    }
    if (document.getElementById("configclient").value == "RP") {
        if (uom_cod == "RO0") {
            document.getElementById("drpbillcycle").value = "6";

        }
        else {
            document.getElementById("drpbillcycle").value = "1";

        }
    }
    if (uom_cod == "CL0") {
        document.getElementById('txttotalarea').disabled = true;
    }
    else {
        if (document.getElementById('hidlineedit').value == "y")
            document.getElementById('txttotalarea').disabled = false;
    }
}

function addagencycomm() {
    if (document.getElementById('txtgrossamt').value == '') {
        document.getElementById('txtaddagencycommrate').value = "";
        document.getElementById('txtaddagencycommrateamt').value = "";
    }
    if (document.getElementById('txtaddagencycommrate') != null && document.getElementById('txtaddagencycommrate').value == "" || document.getElementById('txtaddagencycommrate').value == "0") {
        document.getElementById('btnshgrid').focus();
        document.getElementById('txtgrossamt').value = '';
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        return false;
    }
    if (document.getElementById('txtaddagencycommrate').value != "" && document.getElementById('txtgrossamt').value != "") {
        //        var agcommamt=parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(document.getElementById('txtaddagencycommrate').value) /100;
        //        document.getElementById('txtaddagencycommrateamt').value=agcommamt.toFixed(2);
        var trdisc = document.getElementById('txttradedisc').value
        if (document.getElementById('chktrade').checked == false)
            trdisc = "0";
        if (trdisc == "")
            trdisc = 0;
        var trdisc1 = trdisc;
        var addcomm1 = 0;
        if (document.getElementById('txtaddagencycommrate') != null) {
            if (document.getElementById('hiddenagcommflag').value != "1")
                addcomm1 = document.getElementById('txtaddagencycommrate').value;
        }
        if (addcomm1 == "") {
            addcomm1 = "0";
        }
        if (addcomm1 != "0") {
            trdisc1 = parseFloat(trdisc) + parseFloat(addcomm1);
        }
        var agcommamt = 0;
        var agcommamt1 = 0;
        if (document.getElementById('agncomm_seq_com').value != "S") {
            agcommamt = (parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(trdisc1) / 100);
            if (addcomm1 != "0" && addcomm1 != "") {
                agcommamt = (parseFloat(agcommamt) * parseFloat(addcomm1) / 100);
            }
        }
        else {
            agcommamt = parseFloat(document.getElementById('txtgrossamt').value) - (parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(trdisc) / 100);
            agcommamt1 = (parseFloat(agcommamt) * parseFloat(addcomm1) / 100);
            agcommamt = agcommamt1;

        }
        // var agcommamt=parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(document.getElementById('txtaddagencycommrate').value) /100;
        if (document.getElementById('txtaddagencycommrateamt') != null)
            document.getElementById('txtaddagencycommrateamt').value = agcommamt.toFixed(2);
    }
    if (document.getElementById('hiddenafency_retainer').value == "Y") {
        if (document.getElementById('drpretainer').value == "") {
            document.getElementById('btnshgrid').focus();
            document.getElementById('txtgrossamt').value = '';
            document.getElementById('txtgrossamtlocal').value = "";
            document.getElementById('txtbillamtlocal').value = "";
            return false;
        }
        else {
            //get retainer code *6Aug*
            if (document.getElementById('drpretainer').value == null || document.getElementById('drpretainer').value == "" || document.getElementById('drpretainer').value == "0") {
                document.getElementById('btnshgrid').focus();  //*25Aug*
                document.getElementById('txtgrossamt').value = '';
                document.getElementById('txtgrossamtlocal').value = "";
                document.getElementById('txtbillamtlocal').value = "";
                return false;
            }
            else {
                var retain_name = document.getElementById('drpretainer').value.split('(');
                var retain_code = retain_name[1].replace(')', '');
            }
            //*6Aug*  var response = Classified_Booking.getRetainerComm(document.getElementById('drpretainer').value,document.getElementById('hiddencompcode').value);
            var response = Classified_Booking.getRetainerComm(retain_code, document.getElementById('hiddencompcode').value);
            if (response != null) {
                var ds = response.value;
                if (ds == null) {
                    document.getElementById('txtgrossamt').value = '';
                    document.getElementById('txtgrossamtlocal').value = "";
                    document.getElementById('txtbillamtlocal').value = "";
                    return false;
                }
                if (ds.Tables[0].Rows.length > 0) {
                    if (ds.Tables[0].Rows[0].retainercomm == null) {
                        var retainercomm = 0;
                    }
                    else {
                        retainercomm = ds.Tables[0].Rows[0].retainercomm;
                    }
                    if (retainercomm != "0") {
                        if (parseInt(document.getElementById('txtaddagencycommrate').value) > parseInt(retainercomm)) {
                            alert("Agency Commission can't be greater than Retainer Commission.");
                            document.getElementById('txtaddagencycommrateamt').value = "";
                            document.getElementById('txtaddagencycommrate').value = "";
                            document.getElementById('txtaddagencycommrate').focus();
                            return false;
                        }
                    }
                }
            }
        }
    }
    else {
        document.getElementById('btnshgrid').focus();
        return false;
    }

    document.getElementById('txtgrossamt').value = '';
    document.getElementById('txtbillamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    // return false;
}

function checkro() {
    if (document.getElementById('txtrono').value == "" && document.getElementById('hiddockit').value == 'y') {
        if (confirm('Are you sure you want to create Dokit Booking?')) {
            document.getElementById('drprostatus').value = "2";
        }
        else {
            document.getElementById('txtrono').focus();
        }

    }
    if (document.getElementById('txtrono').value != "" && document.getElementById('hiddensavemod').value != "01") {
        var rodate = document.getElementById('txtrodate').value;
        var rono = document.getElementById('txtrono').value;
        var cioid = document.getElementById('txtciobookid').value;
        var agencycode = document.getElementById('hiddenagency').value;
        if (agencycode == "" || agencycode == null)
            agencycode = document.getElementById('txtagency').value;
        if (agencycode.indexOf("(".toString()) > 0) {
            agencycode = agencycode.substring(agencycode.lastIndexOf('(') + 1, agencycode.lastIndexOf(')'));
            agencycode = agencycode.replace(")", "");
        }
        var agencyscode = document.getElementById('hiddensubcode').value;
        var savemod = document.getElementById('hiddensavemod').value
        var compcode = document.getElementById('hiddencompcode').value
        var keyno = document.getElementById('txtkeyno').value;
        var val1 = "";
        if (browser != "Microsoft Internet Explorer") {
            var httpRequest = null; ;
            httpRequest = new XMLHttpRequest();
            if (httpRequest.overrideMimeType) {
                httpRequest.overrideMimeType('text/xml');
            }

            httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

            httpRequest.open("GET", "chkuniqueforbook.aspx?keyno=" + keyno + "&rono=" + rono + "&cioid=" + cioid + "&agencycode=" + agencyscode + "&agencyscode=" + agencycode + "&savemod=" + savemod + "&compcode=" + compcode + "&rodate=" + rodate, false);
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) {
                    val1 = httpRequest.responseText;
                }
                else {
                    alert('Session TimeOut. Unable To Process Your Request. Please Logn Again');
                    return false;
                }
            }

        }
        else {
            var xml = new ActiveXObject("Microsoft.XMLHTTP");
            xml.Open("GET", "chkuniqueforbook.aspx?keyno=" + keyno + "&rono=" + rono + "&cioid=" + cioid + "&agencycode=" + agencyscode + "&agencyscode=" + agencycode + "&savemod=" + savemod + "&compcode=" + compcode + "&rodate=" + rodate, false);
            xml.Send();
            val1 = xml.responseText;
        }
        if (document.getElementById('hiddenroduplicacycheck').value = "Y") {



            if (val1 == "0") {
                alert("The Agency Code,Agency Sub Code and Ro no. should be unique");
                return false;
            }
            if (val1 == "1") {
                alert("The Agency Code,Agency Sub Code and Key No. is not unique");
                //  return false;
            }

        }
        else {
            if (val1 == "0") {
                alert("The Agency Code,Agency Sub Code and Ro no.(" + document.getElementById('txtrono').value + ") should be unique");
                document.getElementById('txtrono').value = "";
                document.getElementById('txtrono').focus();
                return false;
            }
            if (val1 == "1") {
                alert("The Agency Code,Agency Sub Code and Key No. is not unique");
                //  return false;
            }
        }
    }
}

function chkRetainer() {
    if (retexeboth != "both") {
        if (document.getElementById('txtexecname').value != '') {
            if (document.getElementById('drpretainer').value != "0" && document.getElementById('drpretainer').value != "") {
                var a = "Executive name";
                var b = "Retainer";
                if (browser != "Microsoft Internet Explorer") {
                    a = document.getElementById('lbececname').textContent.replace("*[F2]", "");
                }
                else {
                    a = document.getElementById('lbececname').innerText.replace("*[F2]", "");
                }
                if (confirm('Are you sure you want to Take ' + a)) {
                    document.getElementById('drpretainer').value = "";
                    document.getElementById('txtRetainercomm').value = "";
                }
                else {
                    document.getElementById('txtexecname').value = "";
                    document.getElementById('drpretainer').focus();
                }
            }
        }
        return false;
    }
}

function chkExecutive() {
    //*6Aug*

    //    if(document.getElementById('drpretainer').value!="" && document.getElementById('drpretainer').value!='0')
    //    {
    //        if(document.getElementById('txtexecname').value!="")
    //        {
    //               if(confirm('Are you sure you want to Take Retainer'))
    //                {
    //                   document.getElementById('txtexecname').value="";
    //                   document.getElementById('txtexeczone').value="";
    //                   document.getElementById("divretainer").style.display="block";
    //                   
    //                }
    //            else
    //            {
    //                document.getElementById('drpretainer').value="";
    //                 document.getElementById("divretainer").style.display="none";
    //              
    //            }
    //        }
    //    }
    //    try{
    //    document.getElementById('drpbooktype').focus();
    //    }
    //     catch(er){}
    //    return false;
}

function rateRefresh() {
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    document.getElementById('txtagreedamt').value = "";
    document.getElementById('txtdiscount').value = "";
    document.getElementById('txtdiscpre').value = "";
    document.getElementById('txtcardrate').value = "";
    document.getElementById('txtagreedrate').value = "";
    document.getElementById('txtcardamt').value = "";
    document.getElementById('drpscheme').value = "";
    document.getElementById('txtspacedisc').value = "";
    document.getElementById('txtspadiscper').value = "";
    agreedrate_active = 0;
    agreedamt_active = 0;
    ResetPaidInsertion();
    return false;
}
function rateRefreshNan() {
    if (document.getElementById('txtgrossamt').value == 'NaN') {
        document.getElementById('txtgrossamt').value = "";
    }
    if (document.getElementById('txtagreedamt').value == 'NaN') {
        document.getElementById('txtagreedamt').value = "";
    }
    if (document.getElementById('txtdiscount').value == 'NaN') {
        document.getElementById('txtdiscount').value = "";
    }
    if (document.getElementById('txtdiscpre').value == 'NaN') {
        document.getElementById('txtdiscpre').value = "";
    }
    if (document.getElementById('txtcardrate').value == 'NaN') {
        document.getElementById('txtcardrate').value = "";
    }
    if (document.getElementById('txtagreedrate').value == 'NaN') {
        document.getElementById('txtagreedrate').value = "";
    }
    if (document.getElementById('txtcardamt').value == 'NaN') {
        document.getElementById('txtcardamt').value = "";
    }

}

function ResetPaidInsertion() {
    var agreedrate_vari = document.getElementById('txtagreedrate');
    var agreedamt_vari = document.getElementById('txtagreedamt');
    var drppackagecopy_vari = document.getElementById('drppackagecopy');
    var len = "bookdiv";
    if (document.getElementById(len) != null && document.getElementById(len) != "null") {
        //    if ((agreedrate_vari.value != "" && agreedrate_vari.value != "0") || (agreedamt_vari.value != "" && agreedamt_vari.value != "0") || document.getElementById('txtratecode').value == "0") {

        var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
        for (var s = 0; s < count; s++) {
            var pai_vari = document.getElementById('pai' + s);
            if (pai_vari != null && pai_vari.value != "P") {
                pai_vari.value = 'Y';
            }
        }
        // get paid Insertion
        var paidCount = document.getElementById('txtinsertion').value;
        var finsert = 1;
        var tinsert = 0;
        if (drppackagecopy_vari.options.length > 0) {
            for (var insertCou = 0; insertCou < drppackagecopy_vari.options.length; insertCou++) {
                if (drppackagecopy_vari.options[insertCou].value.indexOf('(') >= 0) {
                    tinsert = drppackagecopy_vari.options[insertCou].value.substring(drppackagecopy_vari.options[insertCou].value.indexOf('(') + 1, drppackagecopy_vari.options[insertCou].value.indexOf(')'));
                    if (parseInt(tinsert) > parseInt(finsert)) {
                        finsert = tinsert;
                    }
                    paidCount = parseInt(paidCount) * parseInt(tinsert);
                }
            }
        }
        document.getElementById('txtpaid').value = paidCount;
    }
    // }
}

function checkGridDate_Validation() {
    commaremove();
    if (document.getElementById('drppackagecopy').options.length == 0) {
        alert("Please fill package");
        return false;
    }

    var rowcount = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
    var len = "bookdiv";
    var id;
    var height;
    var width;
    var pagepost;
    var matsta;
    var insertsta;
    var editdate;
    var size;
    var inserts;
    var idNum = 0;
    var adsize1_var = document.getElementById('txtadsize1');
    var adsize2_var = document.getElementById('txtadsize2');
    var gross_var = document.getElementById('txtgrossamt');
    var ratecode_var = document.getElementById("txtratecode");

    if (document.getElementById('txttotalarea').value == "" && document.getElementById("hidlineedit").value == "y") {
        alert("Please Enter Size/Lines/Words");
        return false;
    }
    gfollodate = "";
    for (var itemCount = 0; itemCount < parseInt(rowcount); itemCount++) {
        id = "Text" + idNum;
        height = "hei" + idNum;
        width = "wid" + idNum;
        pagepost = "pagpos" + idNum;
        matsta = "mat" + idNum;
        insertsta = "inssta" + idNum;
        cardid = "card" + idNum;
        editid = "edit" + idNum;
        editdate = "Text" + idNum;
        size = "siz" + idNum;
        inserts = "ins" + idNum;
        var file_nam = "fil" + idNum;
        var noofcol = "nocol" + idNum;
        var alertLine = parseInt(itemCount) + 1;
        var id_var;
        var height_var;
        var width_var;
        var noofcol_var;
        var size_var;
        var insertsta_var;
        var par1;
        id_var = document.getElementById(id);
        par1 = (id_var.parentNode).parentNode;
        if (document.getElementById(id).value != "")
            gfollodate = document.getElementById(id).value;

        if (browser != "Microsoft Internet Explorer") {
            height_var = document.getElementById(height);

            width_var = document.getElementById(width);

            noofcol_var = document.getElementById(noofcol);

            size_var = document.getElementById(size);

            insertsta_var = document.getElementById(insertsta);
        }
        else {
            //height_var=document.getElementById(height);
            height_var = par1.all[height];



            //width_var=document.getElementById(width);
            width_var = par1.all[width];


            //noofcol_var=document.getElementById(noofcol);
            noofcol_var = par1.all[noofcol];


            //size_var=document.getElementById(size);
            size_var = par1.all[size];


            //insertsta_var=document.getElementById(insertsta);
            insertsta_var = par1.all[insertsta];

        }

        if (id_var.value == "" && document.getElementById("hdnfollodate").value == "N") {
            alert("Please Fill the insertion date for Item Line " + alertLine);
            id_var.focus();
            gross_var.value = '';
            return false;
        }
        else if (height_var.value == "" && adsize1_var.disabled == false) {
            alert("Please fill height for Item Line " + alertLine);
            if (ratecode_var.value == "0") {
                alert("Please Select RateCode");
                return false;
            }
        }
        else if (insertsta_var.value == "" || insertsta_var.value == "0") {
            alert("Please select insertion status for  Item Line " + alertLine);
            insertsta_var.focus();
            return false;

        }
        else if ((width_var.value == "" && noofcol_var.value == "") && adsize2_var.disabled == false) {
            alert("Please fill width or Columns for Item Line " + alertLine);
            gross_var.value = '';
            return false;
        }
        else if (size_var.value == "" && adsize2_var.disabled == true) {
            alert("Please fill size for Item Line " + alertLine);
            gross_var.value = '';
            return false;
        }
        if (document.getElementById('hiddenuomdesc').value != "CD" && document.getElementById('txtspacedisc').value != '') {
            if (size_var.value != "") {
                if (parseInt(document.getElementById('txtspacedisc').value, 10) > parseInt(size_var.value, 10)) {
                    alert("Space Discount can't be greater than Total Lines for Item Line " + alertLine);
                    return false;
                }
            }
        }
        idNum = idNum + 1;
    }
    if (document.getElementById('txtratecode').value == 0) {
        alert("Please Enter RateCode");
        return false;
    }
    if (document.getElementById('allowpaidchangeper').value != "N")
    //ResetPaidInsertion(); 
        if (document.getElementById('configclient').value == "BHASKAR") {
            var res = checkContiniuity();
            if (res == false)
                return false;
        }
    if (document.getElementById('drpcoutype').value != "0" && document.getElementById('drpcoutype').value != "" && document.getElementById('txtcouno').value == "") {
        alert("Please Enter CPN No.");
        document.getElementById('txtcouno').focus();
        return false;
    }
    if (document.getElementById('drpcoutype').value != "0" && document.getElementById('drpcoutype').value != "" && document.getElementById('txtcouno').value != "") {
        var rescou = Classified_Booking.chkCoupan(document.getElementById('hiddencompcode').value, document.getElementById('hiddencenter').value, document.getElementById('txtcouno').value);
        var dscou = rescou.value;
        if (dscou != null && dscou.Tables.length > 0 && dscou.Tables[0].Rows.length > 0 && chkbtnStatus == "new") {
            alert("Coupan Already Used With Reference No. " + dscou.Tables[0].Rows[0].CIO_BOOKING_ID);
            return false;
        }
    }
    flooramount = 0;
    var resn = bindFinalRate();

    if (resn == false)
        return false;
    if (parseInt(document.getElementById('txtgrossamt').value) == 0)
        document.getElementById('txtbillamt').value = 0;
    tcharges();
    if (hiddisctype != "S") {
        getspecialdisc('');  //special discount   
    }
    if (document.getElementById('hiddenuomdesc').value == "CD") {
        getspacedisc(''); // space discount
    }

    getsplcharge();  //special charges
    getexteradisc()
    getRetainerCommAmt();

    if (document.getElementById('configclient').value != "PUNE" && document.getElementById('configclient').value != "RP" && vat_app == "1") {
        bindVtsRate();
    }
    addagencycommRate();
    if (document.getElementById('drpcoutype').value != "0" && document.getElementById('drpcoutype').value != "") {
        deductCoupan(rowcount);
    }
    // Calculation for Translation Charge..
    if ((document.getElementById('hiddentranalpremtype') != null && (document.getElementById('txttranslationcharges') != null && document.getElementById('txttranslationcharges').value != "" && document.getElementById('txttranslationcharges').value != "0") || (document.getElementById('drptranslation').value != "" && document.getElementById('drptranslation').value != "0")) && hdntranschgon=="G") //for on translation charges
    {
        var tranlationcharge = 0;
        var Insertgrossamt = 0;
        var count1 = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
        //  for (var i = 0; i < count1; i++) {
        if (document.getElementById("ins0").innerHTML == 1) {
            // if (document.getElementById('gro' + i).value != "" && document.getElementById('gro' + i).value != null)
            if (document.getElementById('txtagreedamt').value != "" && document.getElementById('txtagreedamt').value != null) {
                var paidCount = document.getElementById('txtinsertion').value;
                var finsert = 1;
                var tinsert = 0;
                if (document.getElementById('drppackagecopy').options.length > 0) {
                    for (var insertCou = 0; insertCou < document.getElementById('drppackagecopy').options.length; insertCou++) {
                        if (document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') >= 0) {
                            tinsert = document.getElementById('drppackagecopy').options[insertCou].value.substring(document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') + 1, document.getElementById('drppackagecopy').options[insertCou].value.indexOf(')'));
                            if (parseInt(tinsert) > parseInt(finsert)) {
                                finsert = tinsert;
                            }
                            paidCount = parseInt(paidCount) * parseInt(tinsert);
                        }
                    }
                }
                Insertgrossamt = parseFloat(Insertgrossamt) + (parseFloat(document.getElementById('txtagreedamt').value) / parseFloat(paidCount));
            }
            else if (document.getElementById('txtcardamt').value != "" && document.getElementById('txtcardamt').value != null)
                Insertgrossamt = parseFloat(Insertgrossamt) + parseFloat(document.getElementById('txtcardamt').value);

        }
        //   else {
        // break;
        // }
        // }

        if (document.getElementById('txttranslationcharges') != null)
            var tranlationch = document.getElementById('txttranslationcharges').value;
        if (tranlationch != "" && document.getElementById('txttranslationdisc').value != "")
            tranlationch = parseFloat(tranlationch) - parseFloat(document.getElementById('txttranslationdisc').value);
        if (tranlationch != null && tranlationch != "" && tranlationch != "0") {
            tranlationcharge = parseInt(tranlationch);
        }
        if (document.getElementById('hiddentranalpremtype').value == 'P') {
            //tranlationcharge = (parseFloat(document.getElementById('txtbillamt').value) * parseFloat(tranlationcharge)) / 100;
            tranlationcharge = ((Insertgrossamt) * parseFloat(tranlationcharge)) / 100;
        }
        document.getElementById('txtbillamt').value = parseFloat(document.getElementById('txtbillamt').value) + parseFloat(tranlationcharge);
        if (document.getElementById("ba0") != null && document.getElementById("ba0").value != "") {
            document.getElementById("ba0").value = parseFloat(document.getElementById("ba0").value) + parseFloat(tranlationcharge);

        }
    }
    if (document.getElementById('hiddenboxchrgtype') != null && (document.getElementById('txtboxchrg') != null && document.getElementById('txtboxchrg').value != "" && document.getElementById('txtboxchrg').value != "0" && boxstatus != "billed") || (document.getElementById('drpboxcode').value != "" && document.getElementById('drpboxcode').value != "0" && boxstatus != "billed")) //for on gross box charges
    {
        if (document.getElementById('hiddeninsertwise').value == 'no') {
            var boxcharge = 0;

            if (document.getElementById('txtboxchrg') != null)
                boxpercen = document.getElementById('txtboxchrg').value;
            if (boxpercen != null && boxpercen != "" && boxpercen != "0") {
                boxcharge = parseInt(boxpercen);
            }
            if (document.getElementById('hiddenboxchrgtype').value == '2') {
                boxcharge = (parseFloat(document.getElementById('txtbillamt').value) * parseFloat(boxcharge)) / 100;
            }
            document.getElementById('txtbillamt').value = parseFloat(document.getElementById('txtbillamt').value) + parseFloat(boxcharge);
            if (document.getElementById("ba0") != null && document.getElementById("ba0").value != "") {
                document.getElementById("ba0").value = parseFloat(document.getElementById("ba0").value) + parseFloat(boxcharge);
                document.getElementById("boxc0").value = boxcharge;
            }
        }
    }
    if (parseFloat(flooramount) != 0 && parseFloat(flooramount) > parseFloat(document.getElementById('txtgrossamt').value)) {
        alert("Booking Amount can't be less than " + flooramount);
        document.getElementById('txtbillamt').value = "";
        return false;
    } var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
    // for NPRINT
    if (nprint_flag == true) {
        var centercode = document.getElementById('hiddencenter').value;
        var tCount = 0;
        var counterT = 0;
        var i = 0;
        var f_total = 0;
        var f_totallocal = 0;
        for (var i1 = 0; i1 < count; i1++) {
            i = i + 1;
            var ins_vari = document.getElementById('ins' + i1);
            if (ins_vari != null) {
                tCount = 0;
                while (parseInt(ins_vari.innerHTML) == parseInt(i)) {
                    tCount = parseInt(tCount) + 1;
                    counterT = parseInt(counterT) + 1;
                    ins_vari = document.getElementById('ins' + counterT);
                    if (ins_vari == null)
                        break;
                }
            }
            gridItemCount = tCount;  //get gridcount
            var BAL_AMT = 0;
            var BAL_AMT_BILL = 0;
            var grossindex;
            var grossindexN;
            for (var n = 0; n < gridItemCount; n++) {
                if (document.getElementById("pai" + i1) != null && document.getElementById("pai" + i1).value == "NP") {
                    BAL_AMT = parseFloat(BAL_AMT) + parseFloat(document.getElementById("ba" + i1).value);
                    BAL_AMT_BILL = parseFloat(BAL_AMT_BILL) + parseFloat(document.getElementById("gro" + i1).value);
                    document.getElementById("gro" + i1).value = 0;
                    document.getElementById("grolocal" + i1).value = 0;
                    document.getElementById("ba" + i1).value = 0;
                    document.getElementById("balocal" + i1).value = 0;
                }
                var res_center = Classified_Booking.getCenterCode(document.getElementById('edit' + i1).value);
                if (res_center.value != null && res_center.value == centercode && document.getElementById('inssta' + i1).value == "booked") {
                    grossindex = i1;
                }
                if (document.getElementById('inssta' + i1).value == "booked") {
                    grossindexN = i1;
                }
            }
            if (BAL_AMT != 0 && grossindex != "") {
                document.getElementById("gro" + grossindex).value = parseFloat(document.getElementById("gro" + grossindex).value) + parseFloat(BAL_AMT);
                document.getElementById("grolocal" + grossindex).value = document.getElementById("gro" + grossindex).value;
                document.getElementById("ba" + grossindex).value = parseFloat(document.getElementById("ba" + grossindex).value) + parseFloat(BAL_AMT_BILL);
                document.getElementById("balocal" + grossindex).value = document.getElementById("ba" + grossindex).value;
            }
            else if (BAL_AMT != 0 && grossindexN != "") {
                document.getElementById("gro" + grossindexN).value = parseFloat(document.getElementById("gro" + grossindexN).value) + parseFloat(BAL_AMT);
                document.getElementById("grolocal" + grossindexN).value = document.getElementById("gro" + grossindexN).value;
                document.getElementById("ba" + grossindexN).value = parseFloat(document.getElementById("ba" + grossindexN).value) + parseFloat(BAL_AMT_BILL);
                document.getElementById("balocal" + grossindexN).value = document.getElementById("ba" + grossindexN).value;
            }
        }
    }
    //
    if (ALLOWBOOKINGGST=='Y'){
        var SGSTAMT=0;
        var CGSTAMT=0;
        var IGSTAMT=0;
        var CESSAMT=0; 
        var tCountgst = 0;
        var counterTgst = 0;
        var igst = 0;
        var f_totalgst = 0;
        var f_totallocalgst = 0;
        
        var countgst = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
        var finalbillamt=0;
        var finallcbillamt=0;
        document.getElementById('txtdatetime').value = chkdate(document.getElementById('hiddendateformat').value, document.getElementById('txtdatetime').value);
        var agencycodesubcode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.lastIndexOf(')'));
        var client = document.getElementById('txtclient').value.substring(document.getElementById('txtclient').value.lastIndexOf('(') + 1, document.getElementById('txtclient').value.lastIndexOf(')'));
        var res_gst = Classified_Booking.getgstcode(document.getElementById('hiddencompcode').value,agencycodesubcode,client,document.getElementById('drpuom').value,document.getElementById('drprevenue').value,document.getElementById('drpadcategory').value,document.getElementById('txtdatetime').value,"","","","","");
        var ds_GST = res_gst.value;
        if (ds_GST == null) {
            alert(res_gst.error.description);
            blankGross();
            return false;
        }       
        var gststr="";        
        if (ds_GST.Tables.length > 0 && ds_GST.Tables[0].Rows.length > 0) {
             var SAC_CODE="" 
             var SUB_SAC_CODE="";
             var RATEDETCODE="";
             var GST_DESC_CODE="";
             var RATE="";
             var ON_AMOUNT="";
             var GST_STATE_CODE="";  
             var gsttaxtotper=0; 
             var gstcesstotper=0;           
            if (ds_GST.Tables[0].Rows[0].MSG!="" && ds_GST.Tables[0].Rows[0].MSG!="NULL"  && ds_GST.Tables[0].Rows[0].MSG!=null && ds_GST.Tables[0].Rows[0].MSG!="null"){
                alert(ds_GST.Tables[0].Rows[0].MSG);
                return false;
            }
            else{
                /*if ( agreedamt_active == "1" && document.getElementById('chkgstinc').checked== true){
                    for (var n2 = 0; n2 < ds_GST.Tables[0].Rows.length; n2++) {
                        if (ds_GST.Tables[0].Rows[n2].ON_AMOUNT=='CH'){
                            gstcesstotper=parseFloat(gstcesstotper)+parseFloat(ds_GST.Tables[0].Rows[n2].RATE);
                        }
                        else{
                            gsttaxtotper=parseFloat(gsttaxtotper)+parseFloat(ds_GST.Tables[0].Rows[n2].RATE);
                        }
                    }                            
                 }   */              
                for (var n = 0; n < countgst; n++) {
                    var gstamt=0;
                    var gstamt1=0;
                    var gstgd1="";
                    var onamt=0;
                    var revvalue=0;
                    f_totalgst = 0;
                    f_totallocalgst = 0;
                    SGSTAMT=0;
                    CGSTAMT=0;
                    IGSTAMT=0;
                    CESSAMT=0; 
                    if(document.getElementById('drpbillcycle').value=="1" && ALLOWGSTROUND=='Y'){   //Daily
                        igst = igst + 1;
                        var ins_vari = document.getElementById('ins' + n);
                        if (ins_vari != null) {
                            tCountgst = 0;
                            while (parseInt(ins_vari.innerHTML) == parseInt(igst)) {
                                tCountgst = parseInt(tCountgst) + 1;
                                counterTgst = parseInt(counterTgst) + 1;
                                ins_vari = document.getElementById('ins' + counterTgst);
                                if (ins_vari == null)
                                    break;
                            }
                        }
                        gridItemCount = tCountgst;
                        for (var i2 = parseInt(gridItemCount,10)-1; i2 >= 0; i2--) {
                            var paidvar = document.getElementById('pai' + (parseInt(n)+parseInt(i2))).value;
                            var insertsta = document.getElementById('inssta' + (parseInt(n)+parseInt(i2))).value;
                                if (insertsta != null && insertsta != 'cancel' && insertsta != 'billed' && paidvar != null && paidvar != 'N') {
                                    revvalue=(parseInt(n)+parseInt(i2));
                                    break;
                                }
                        }
                        for (var ni = 0; ni < gridItemCount; ni++) {
                            var gstamt=0;
                            var gstamt1=0;
                            var gstgd1="";
                            var onamt=0;
                            var billid = document.getElementById('ba' + n);
                            var billidlocal = document.getElementById('balocal' + n);
                            var GSTAMT = document.getElementById('GSTAMT' + n);
                            var GSTGD = document.getElementById('GSTGD' + n);
                            var insertsta=document.getElementById('inssta' + n);
                            if ((insertsta.value != 'billed' || document.getElementById('hiddensupplimentflag').value != "")){
                                 /*if ( agreedamt_active == "1" && document.getElementById('chkgstinc').checked== true){
                                    if (parseFloat(gsttaxtotper)>0 && parseFloat(gstcesstotper)>0){ 
                                        billid.value= ((parseFloat(billid.value)*10000)/(10000+(parseFloat(gsttaxtotper)*100)+(parseFloat(gsttaxtotper)*parseFloat(gstcesstotper)))).toFixed(4);
                                        billidlocal.value= ((parseFloat(billidlocal.value)*10000)/(10000+(parseFloat(gsttaxtotper)*100)+(parseFloat(gsttaxtotper)*parseFloat(gstcesstotper)))).toFixed(4);
                                        //billid.value=((parseFloat(billid.value)/(1+(parseFloat(gsttaxtotper)/100))) - ((parseFloat(billid.value)-(parseFloat(billid.value)/(1+(parseFloat(gsttaxtotper)/100))))*gstcesstotper/100)).toFixed(8);
                                        //billidlocal.value=((parseFloat(billidlocal.value)/(1+(parseFloat(gsttaxtotper)/100))) - ((parseFloat(billidlocal.value)-(parseFloat(billidlocal.value)/(1+(parseFloat(gsttaxtotper)/100))))*gstcesstotper/100)).toFixed(8);
                                    }
                                    else if(parseFloat(gsttaxtotper)>0){
                                            billid.value=(parseFloat(billid.value)/(1+(parseFloat(gsttaxtotper)/100)))
                                            billidlocal.value=(parseFloat(billidlocal.value)/(1+(parseFloat(gsttaxtotper)/100)))
                                    }
                                 }     */                   
                                 for (var n1 = 0; n1 < ds_GST.Tables[0].Rows.length; n1++) {
                                    if (ds_GST.Tables[0].Rows[n1].ON_AMOUNT=='CH')
                                    {
                                        onamt=parseFloat(gstamt);
                                        gstamt1=((parseFloat(gstamt) * parseFloat(ds_GST.Tables[0].Rows[n1].RATE)) / 100).toFixed(2);
                                        gstamt =(parseFloat(gstamt)+parseFloat(gstamt1)).toFixed(2);
                                    }
                                    else{
                                        onamt=parseFloat(billid.value);
                                        gstamt1=((parseFloat(billid.value) * parseFloat(ds_GST.Tables[0].Rows[n1].RATE)) / 100).toFixed(2);
                                        gstamt =(parseFloat(gstamt)+parseFloat(gstamt1)).toFixed(2);                       
                                    }
                                    if(ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE=='SGST'){
                                        SGSTAMT=SGSTAMT+parseFloat(gstamt1);
                                    }
                                    else if(ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE=='CGST'){
                                        CGSTAMT=CGSTAMT+parseFloat(gstamt1);
                                    }
                                    else if(ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE=='IGST'){
                                        IGSTAMT=IGSTAMT+parseFloat(gstamt1);
                                    }
                                    else{
                                        CESSAMT=CESSAMT+parseFloat(gstamt1);
                                    }                                    
                                    if (parseInt(revvalue)==parseInt(n)){
                                        var diffgst=0;                                        
                                        if(ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE=='SGST'){
                                            diffgst=parseFloat(Math.round((parseFloat(SGSTAMT)+.01))-parseFloat(SGSTAMT)).toFixed(2);
                                            gstamt1=parseFloat(gstamt1)+parseFloat(diffgst)
                                            gstamt=parseFloat(gstamt)+parseFloat(diffgst)
                                        }
                                        else if(ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE=='CGST'){
                                            diffgst=parseFloat(Math.round((parseFloat(CGSTAMT)+.01))-parseFloat(CGSTAMT)).toFixed(2);
                                            gstamt1=parseFloat(gstamt1)+parseFloat(diffgst)
                                            gstamt=parseFloat(gstamt)+parseFloat(diffgst)
                                        }
                                        else if(ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE=='IGST'){
                                            diffgst=parseFloat(Math.round((parseFloat(IGSTAMT)+.01))-parseFloat(IGSTAMT)).toFixed(2);
                                            gstamt1=parseFloat(gstamt1)+parseFloat(diffgst)
                                            gstamt=parseFloat(gstamt)+parseFloat(diffgst)
                                        }
                                        else{
                                            diffgst=parseFloat(Math.round((parseFloat(CESSAMT)+.01))-parseFloat(CESSAMT)).toFixed(2);
                                            gstamt1=parseFloat(gstamt1)+parseFloat(diffgst)
                                            gstamt=parseFloat(gstamt)+parseFloat(diffgst)
                                        } 
                                        if (gstgd1==""){ 
                                            gstgd1=document.getElementById('txtciobookid').value+'~'+"I"+'~'+ds_GST.Tables[0].Rows[n1].SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].SUB_SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATEDETCODE+'~'+ds_GST.Tables[0].Rows[n1].GST_DESC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATE+'~'+onamt+'~'+gstamt1+'~'+ds_GST.Tables[0].Rows[n1].GST_STATE_CODE+'~'+ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE+'~'+diffgst ;
                                        }
                                        else{
                                            gstgd1=gstgd1+'$'+document.getElementById('txtciobookid').value+'~'+"I"+'~'+ds_GST.Tables[0].Rows[n1].SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].SUB_SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATEDETCODE+'~'+ds_GST.Tables[0].Rows[n1].GST_DESC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATE+'~'+onamt+'~'+gstamt1+'~'+ds_GST.Tables[0].Rows[n1].GST_STATE_CODE+'~'+ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE+'~'+diffgst;
                                        }
                                        }
                                        else{
                                        if (gstgd1==""){ 
                                            gstgd1=document.getElementById('txtciobookid').value+'~'+"I"+'~'+ds_GST.Tables[0].Rows[n1].SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].SUB_SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATEDETCODE+'~'+ds_GST.Tables[0].Rows[n1].GST_DESC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATE+'~'+onamt+'~'+gstamt1+'~'+ds_GST.Tables[0].Rows[n1].GST_STATE_CODE+'~'+ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE+'~0' ;
                                        }
                                        else{
                                            gstgd1=gstgd1+'$'+document.getElementById('txtciobookid').value+'~'+"I"+'~'+ds_GST.Tables[0].Rows[n1].SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].SUB_SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATEDETCODE+'~'+ds_GST.Tables[0].Rows[n1].GST_DESC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATE+'~'+onamt+'~'+gstamt1+'~'+ds_GST.Tables[0].Rows[n1].GST_STATE_CODE+'~'+ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE+'~0';
                                        }
                                    }
                                                            
                                 }
                                 billid.value= parseFloat(billid.value)+parseFloat(gstamt);
                                 billidlocal.value= parseFloat(billidlocal.value)+parseFloat(gstamt);
                                 GSTAMT.value = parseFloat(gstamt);
                                 GSTGD.value=gstgd1;
                                 finalbillamt=parseFloat(finalbillamt)+parseFloat(billid.value);
                                 finallcbillamt=parseFloat(finallcbillamt)+parseFloat(billidlocal.value);
                            }
                            else {
                                finalbillamt = parseFloat(finalbillamt) + parseFloat(billid.value);
                                finallcbillamt = parseFloat(finallcbillamt) + parseFloat(billidlocal.value);
                            }
                            n = n + 1;
                        }
                        n = n - 1;        
                    }
                    else if(document.getElementById('drpbillcycle').value=="6" && ALLOWGSTROUND=='Y'){   //Combined
                        gridItemCount = countgst;
                        for (var i2 = parseInt(gridItemCount,10)-1; i2 >= 0; i2--) {
                            var paidvar = document.getElementById('pai' + (parseInt(n)+parseInt(i2))).value;
                            var insertsta = document.getElementById('inssta' + (parseInt(n)+parseInt(i2))).value;
                                if (insertsta != null && insertsta != 'cancel' && insertsta != 'billed' && paidvar != null && paidvar != 'N') {
                                    revvalue=(parseInt(n)+parseInt(i2));
                                    break;
                                }
                        }
                        for (var ni = 0; ni < gridItemCount; ni++) {
                            var gstamt=0;
                            var gstamt1=0;
                            var gstgd1="";
                            var onamt=0;
                            var billid = document.getElementById('ba' + n);
                            var billidlocal = document.getElementById('balocal' + n);
                            var GSTAMT = document.getElementById('GSTAMT' + n);
                            var GSTGD = document.getElementById('GSTGD' + n);
                            var insertsta=document.getElementById('inssta' + n);
                            if ((insertsta.value != 'billed' || document.getElementById('hiddensupplimentflag').value != "")){
                                 /*if ( agreedamt_active == "1" && document.getElementById('chkgstinc').checked== true){
                                    if (parseFloat(gsttaxtotper)>0 && parseFloat(gstcesstotper)>0){ 
                                        billid.value= ((parseFloat(billid.value)*10000)/(10000+(parseFloat(gsttaxtotper)*100)+(parseFloat(gsttaxtotper)*parseFloat(gstcesstotper)))).toFixed(4);
                                        billidlocal.value= ((parseFloat(billidlocal.value)*10000)/(10000+(parseFloat(gsttaxtotper)*100)+(parseFloat(gsttaxtotper)*parseFloat(gstcesstotper)))).toFixed(4);
                                        //billid.value=((parseFloat(billid.value)/(1+(parseFloat(gsttaxtotper)/100))) - ((parseFloat(billid.value)-(parseFloat(billid.value)/(1+(parseFloat(gsttaxtotper)/100))))*gstcesstotper/100)).toFixed(8);
                                        //billidlocal.value=((parseFloat(billidlocal.value)/(1+(parseFloat(gsttaxtotper)/100))) - ((parseFloat(billidlocal.value)-(parseFloat(billidlocal.value)/(1+(parseFloat(gsttaxtotper)/100))))*gstcesstotper/100)).toFixed(8);
                                    }
                                    else if(parseFloat(gsttaxtotper)>0){
                                            billid.value=(parseFloat(billid.value)/(1+(parseFloat(gsttaxtotper)/100)))
                                            billidlocal.value=(parseFloat(billidlocal.value)/(1+(parseFloat(gsttaxtotper)/100)))
                                    }
                                 }     */                   
                                 for (var n1 = 0; n1 < ds_GST.Tables[0].Rows.length; n1++) {
                                    if (ds_GST.Tables[0].Rows[n1].ON_AMOUNT=='CH')
                                    {
                                        onamt=parseFloat(gstamt);
                                        gstamt1=((parseFloat(gstamt) * parseFloat(ds_GST.Tables[0].Rows[n1].RATE)) / 100).toFixed(2);
                                        gstamt =(parseFloat(gstamt)+parseFloat(gstamt1)).toFixed(2);
                                    }
                                    else{
                                        onamt=parseFloat(billid.value);
                                        gstamt1=((parseFloat(billid.value) * parseFloat(ds_GST.Tables[0].Rows[n1].RATE)) / 100).toFixed(2);
                                        gstamt =(parseFloat(gstamt)+parseFloat(gstamt1)).toFixed(2);                       
                                    }
                                    if(ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE=='SGST'){
                                        SGSTAMT=SGSTAMT+parseFloat(gstamt1);
                                    }
                                    else if(ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE=='CGST'){
                                        CGSTAMT=CGSTAMT+parseFloat(gstamt1);
                                    }
                                    else if(ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE=='IGST'){
                                        IGSTAMT=IGSTAMT+parseFloat(gstamt1);
                                    }
                                    else{
                                        CESSAMT=CESSAMT+parseFloat(gstamt1);
                                    }                                    
                                    if (parseInt(revvalue)==parseInt(n)){
                                        var diffgst=0;                                        
                                        if(ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE=='SGST'){
                                            diffgst=parseFloat(Math.round((parseFloat(SGSTAMT)+.01))-parseFloat(SGSTAMT)).toFixed(2);
                                            gstamt1=parseFloat(gstamt1)+parseFloat(diffgst)
                                            gstamt=parseFloat(gstamt)+parseFloat(diffgst)
                                        }
                                        else if(ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE=='CGST'){
                                            diffgst=parseFloat(Math.round((parseFloat(CGSTAMT)+.01))-parseFloat(CGSTAMT)).toFixed(2);
                                            gstamt1=parseFloat(gstamt1)+parseFloat(diffgst)
                                            gstamt=parseFloat(gstamt)+parseFloat(diffgst)
                                        }
                                        else if(ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE=='IGST'){
                                            diffgst=parseFloat(Math.round((parseFloat(IGSTAMT)+.01))-parseFloat(IGSTAMT)).toFixed(2);
                                            gstamt1=parseFloat(gstamt1)+parseFloat(diffgst)
                                            gstamt=parseFloat(gstamt)+parseFloat(diffgst)
                                        }
                                        else{
                                            diffgst=parseFloat(Math.round((parseFloat(CESSAMT)+.01))-parseFloat(CESSAMT)).toFixed(2);
                                            gstamt1=parseFloat(gstamt1)+parseFloat(diffgst)
                                            gstamt=parseFloat(gstamt)+parseFloat(diffgst)
                                        } 
                                        if (gstgd1==""){ 
                                            gstgd1=document.getElementById('txtciobookid').value+'~'+"I"+'~'+ds_GST.Tables[0].Rows[n1].SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].SUB_SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATEDETCODE+'~'+ds_GST.Tables[0].Rows[n1].GST_DESC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATE+'~'+onamt+'~'+gstamt1+'~'+ds_GST.Tables[0].Rows[n1].GST_STATE_CODE+'~'+ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE+'~'+diffgst ;
                                        }
                                        else{
                                            gstgd1=gstgd1+'$'+document.getElementById('txtciobookid').value+'~'+"I"+'~'+ds_GST.Tables[0].Rows[n1].SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].SUB_SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATEDETCODE+'~'+ds_GST.Tables[0].Rows[n1].GST_DESC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATE+'~'+onamt+'~'+gstamt1+'~'+ds_GST.Tables[0].Rows[n1].GST_STATE_CODE+'~'+ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE+'~'+diffgst;
                                        }
                                        }
                                        else{
                                        if (gstgd1==""){ 
                                            gstgd1=document.getElementById('txtciobookid').value+'~'+"I"+'~'+ds_GST.Tables[0].Rows[n1].SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].SUB_SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATEDETCODE+'~'+ds_GST.Tables[0].Rows[n1].GST_DESC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATE+'~'+onamt+'~'+gstamt1+'~'+ds_GST.Tables[0].Rows[n1].GST_STATE_CODE+'~'+ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE+'~0' ;
                                        }
                                        else{
                                            gstgd1=gstgd1+'$'+document.getElementById('txtciobookid').value+'~'+"I"+'~'+ds_GST.Tables[0].Rows[n1].SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].SUB_SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATEDETCODE+'~'+ds_GST.Tables[0].Rows[n1].GST_DESC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATE+'~'+onamt+'~'+gstamt1+'~'+ds_GST.Tables[0].Rows[n1].GST_STATE_CODE+'~'+ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE+'~0';
                                        }
                                    }
                                                            
                                 }
                                 billid.value= parseFloat(billid.value)+parseFloat(gstamt);
                                 billidlocal.value= parseFloat(billidlocal.value)+parseFloat(gstamt);
                                 GSTAMT.value = parseFloat(gstamt);
                                 GSTGD.value=gstgd1;
                                 finalbillamt=parseFloat(finalbillamt)+parseFloat(billid.value);
                                 finallcbillamt=parseFloat(finallcbillamt)+parseFloat(billidlocal.value);
                            }
                            else {
                                finalbillamt = parseFloat(finalbillamt) + parseFloat(billid.value);
                                finallcbillamt = parseFloat(finallcbillamt) + parseFloat(billidlocal.value);
                            }
                            n = n + 1;
                        }
                        n = n - 1;        
                    }
                    else if(document.getElementById('drpbillcycle').value=="5" && ALLOWGSTROUND=='Y'){   //Edition Wise
                        gridItemCount = countgst;
                        revvalue=parseInt(n);
                        for (var ni = 0; ni < gridItemCount; ni++) {
                            var gstamt=0;
                            var gstamt1=0;
                            var gstgd1="";
                            var onamt=0;
                            var billid = document.getElementById('ba' + n);
                            var billidlocal = document.getElementById('balocal' + n);
                            var GSTAMT = document.getElementById('GSTAMT' + n);
                            var GSTGD = document.getElementById('GSTGD' + n);
                            var insertsta=document.getElementById('inssta' + n);
                            if ((insertsta.value != 'billed' || document.getElementById('hiddensupplimentflag').value != "")){
                                 /*if ( agreedamt_active == "1" && document.getElementById('chkgstinc').checked== true){
                                    if (parseFloat(gsttaxtotper)>0 && parseFloat(gstcesstotper)>0){ 
                                        billid.value= ((parseFloat(billid.value)*10000)/(10000+(parseFloat(gsttaxtotper)*100)+(parseFloat(gsttaxtotper)*parseFloat(gstcesstotper)))).toFixed(4);
                                        billidlocal.value= ((parseFloat(billidlocal.value)*10000)/(10000+(parseFloat(gsttaxtotper)*100)+(parseFloat(gsttaxtotper)*parseFloat(gstcesstotper)))).toFixed(4);
                                        //billid.value=((parseFloat(billid.value)/(1+(parseFloat(gsttaxtotper)/100))) - ((parseFloat(billid.value)-(parseFloat(billid.value)/(1+(parseFloat(gsttaxtotper)/100))))*gstcesstotper/100)).toFixed(8);
                                        //billidlocal.value=((parseFloat(billidlocal.value)/(1+(parseFloat(gsttaxtotper)/100))) - ((parseFloat(billidlocal.value)-(parseFloat(billidlocal.value)/(1+(parseFloat(gsttaxtotper)/100))))*gstcesstotper/100)).toFixed(8);
                                    }
                                    else if(parseFloat(gsttaxtotper)>0){
                                            billid.value=(parseFloat(billid.value)/(1+(parseFloat(gsttaxtotper)/100)))
                                            billidlocal.value=(parseFloat(billidlocal.value)/(1+(parseFloat(gsttaxtotper)/100)))
                                    }
                                 }         */               
                                 for (var n1 = 0; n1 < ds_GST.Tables[0].Rows.length; n1++) {
                                    if (ds_GST.Tables[0].Rows[n1].ON_AMOUNT=='CH')
                                    {
                                        onamt=parseFloat(gstamt);
                                        gstamt1=((parseFloat(gstamt) * parseFloat(ds_GST.Tables[0].Rows[n1].RATE)) / 100).toFixed(2);
                                        gstamt =(parseFloat(gstamt)+parseFloat(gstamt1)).toFixed(2);
                                    }
                                    else{
                                        onamt=parseFloat(billid.value);
                                        gstamt1=((parseFloat(billid.value) * parseFloat(ds_GST.Tables[0].Rows[n1].RATE)) / 100).toFixed(2);
                                        gstamt =(parseFloat(gstamt)+parseFloat(gstamt1)).toFixed(2);                       
                                    }
                                    if(ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE=='SGST'){
                                        SGSTAMT=SGSTAMT+parseFloat(gstamt1);
                                    }
                                    else if(ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE=='CGST'){
                                        CGSTAMT=CGSTAMT+parseFloat(gstamt1);
                                    }
                                    else if(ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE=='IGST'){
                                        IGSTAMT=IGSTAMT+parseFloat(gstamt1);
                                    }
                                    else{
                                        CESSAMT=CESSAMT+parseFloat(gstamt1);
                                    }                                    
                                    if (parseInt(revvalue)==parseInt(n)){
                                        var diffgst=0;                                        
                                        if(ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE=='SGST'){
                                            diffgst=parseFloat(Math.round((parseFloat(SGSTAMT)+.01))-parseFloat(SGSTAMT)).toFixed(2);
                                            gstamt1=parseFloat(gstamt1)+parseFloat(diffgst)
                                            gstamt=parseFloat(gstamt)+parseFloat(diffgst)
                                        }
                                        else if(ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE=='CGST'){
                                            diffgst=parseFloat(Math.round((parseFloat(CGSTAMT)+.01))-parseFloat(CGSTAMT)).toFixed(2);
                                            gstamt1=parseFloat(gstamt1)+parseFloat(diffgst)
                                            gstamt=parseFloat(gstamt)+parseFloat(diffgst)
                                        }
                                        else if(ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE=='IGST'){
                                            diffgst=parseFloat(Math.round((parseFloat(IGSTAMT)+.01))-parseFloat(IGSTAMT)).toFixed(2);
                                            gstamt1=parseFloat(gstamt1)+parseFloat(diffgst)
                                            gstamt=parseFloat(gstamt)+parseFloat(diffgst)
                                        }
                                        else{
                                            diffgst=parseFloat(Math.round((parseFloat(CESSAMT)+.01))-parseFloat(CESSAMT)).toFixed(2);
                                            gstamt1=parseFloat(gstamt1)+parseFloat(diffgst)
                                            gstamt=parseFloat(gstamt)+parseFloat(diffgst)
                                        } 
                                        if (gstgd1==""){ 
                                            gstgd1=document.getElementById('txtciobookid').value+'~'+"I"+'~'+ds_GST.Tables[0].Rows[n1].SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].SUB_SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATEDETCODE+'~'+ds_GST.Tables[0].Rows[n1].GST_DESC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATE+'~'+onamt+'~'+gstamt1+'~'+ds_GST.Tables[0].Rows[n1].GST_STATE_CODE+'~'+ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE+'~'+diffgst ;
                                        }
                                        else{
                                            gstgd1=gstgd1+'$'+document.getElementById('txtciobookid').value+'~'+"I"+'~'+ds_GST.Tables[0].Rows[n1].SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].SUB_SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATEDETCODE+'~'+ds_GST.Tables[0].Rows[n1].GST_DESC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATE+'~'+onamt+'~'+gstamt1+'~'+ds_GST.Tables[0].Rows[n1].GST_STATE_CODE+'~'+ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE+'~'+diffgst;
                                        }
                                        }
                                        else{
                                        if (gstgd1==""){ 
                                            gstgd1=document.getElementById('txtciobookid').value+'~'+"I"+'~'+ds_GST.Tables[0].Rows[n1].SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].SUB_SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATEDETCODE+'~'+ds_GST.Tables[0].Rows[n1].GST_DESC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATE+'~'+onamt+'~'+gstamt1+'~'+ds_GST.Tables[0].Rows[n1].GST_STATE_CODE+'~'+ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE+'~0' ;
                                        }
                                        else{
                                            gstgd1=gstgd1+'$'+document.getElementById('txtciobookid').value+'~'+"I"+'~'+ds_GST.Tables[0].Rows[n1].SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].SUB_SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATEDETCODE+'~'+ds_GST.Tables[0].Rows[n1].GST_DESC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATE+'~'+onamt+'~'+gstamt1+'~'+ds_GST.Tables[0].Rows[n1].GST_STATE_CODE+'~'+ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE+'~0';
                                        }
                                    }
                                                            
                                 }
                                 billid.value= parseFloat(billid.value)+parseFloat(gstamt);
                                 billidlocal.value= parseFloat(billidlocal.value)+parseFloat(gstamt);
                                 GSTAMT.value = parseFloat(gstamt);
                                 GSTGD.value=gstgd1;
                                 finalbillamt=parseFloat(finalbillamt)+parseFloat(billid.value);
                                 finallcbillamt=parseFloat(finallcbillamt)+parseFloat(billidlocal.value);
                            }
                            else {
                                finalbillamt = parseFloat(finalbillamt) + parseFloat(billid.value);
                                finallcbillamt = parseFloat(finallcbillamt) + parseFloat(billidlocal.value);
                            }
                            n = n + 1;
                        }
                        n = n - 1;        
                    }
                    else{                
                        var billid = document.getElementById('ba' + n);
                        var billidlocal = document.getElementById('balocal' + n);
                        var GSTAMT = document.getElementById('GSTAMT' + n);
                        var GSTGD = document.getElementById('GSTGD' + n);
                        var insertsta=document.getElementById('inssta' + n);
                        if ((insertsta.value != 'billed' || document.getElementById('hiddensupplimentflag').value != "")){
                             /*if ( agreedamt_active == "1" && document.getElementById('chkgstinc').checked== true){
                                if (parseFloat(gsttaxtotper)>0 && parseFloat(gstcesstotper)>0){ 
                                    billid.value= ((parseFloat(billid.value)*10000)/(10000+(parseFloat(gsttaxtotper)*100)+(parseFloat(gsttaxtotper)*parseFloat(gstcesstotper)))).toFixed(4);
                                    billidlocal.value= ((parseFloat(billidlocal.value)*10000)/(10000+(parseFloat(gsttaxtotper)*100)+(parseFloat(gsttaxtotper)*parseFloat(gstcesstotper)))).toFixed(4);
                                    //billid.value=((parseFloat(billid.value)/(1+(parseFloat(gsttaxtotper)/100))) - ((parseFloat(billid.value)-(parseFloat(billid.value)/(1+(parseFloat(gsttaxtotper)/100))))*gstcesstotper/100)).toFixed(8);
                                    //billidlocal.value=((parseFloat(billidlocal.value)/(1+(parseFloat(gsttaxtotper)/100))) - ((parseFloat(billidlocal.value)-(parseFloat(billidlocal.value)/(1+(parseFloat(gsttaxtotper)/100))))*gstcesstotper/100)).toFixed(8);
                                }
                                else if(parseFloat(gsttaxtotper)>0){
                                        billid.value=(parseFloat(billid.value)/(1+(parseFloat(gsttaxtotper)/100)))
                                        billidlocal.value=(parseFloat(billidlocal.value)/(1+(parseFloat(gsttaxtotper)/100)))
                                }
                             }       */                 
                             for (var n1 = 0; n1 < ds_GST.Tables[0].Rows.length; n1++) {
                                if (ds_GST.Tables[0].Rows[n1].ON_AMOUNT=='CH')
                                {
                                    onamt=parseFloat(gstamt);
                                    gstamt1=((parseFloat(gstamt) * parseFloat(ds_GST.Tables[0].Rows[n1].RATE)) / 100).toFixed(2);
                                    gstamt =(parseFloat(gstamt)+parseFloat(gstamt1)).toFixed(2);
                                }
                                else{
                                    onamt=parseFloat(billid.value);
                                    gstamt1=((parseFloat(billid.value) * parseFloat(ds_GST.Tables[0].Rows[n1].RATE)) / 100).toFixed(2);
                                    gstamt =(parseFloat(gstamt)+parseFloat(gstamt1)).toFixed(2);                       
                                }                         
                                if (gstgd1==""){
                                    gstgd1=document.getElementById('txtciobookid').value+'~'+"I"+'~'+ds_GST.Tables[0].Rows[n1].SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].SUB_SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATEDETCODE+'~'+ds_GST.Tables[0].Rows[n1].GST_DESC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATE+'~'+onamt+'~'+gstamt1+'~'+ds_GST.Tables[0].Rows[n1].GST_STATE_CODE+'~'+ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE+'~0';
                                }
                                else{
                                    gstgd1=gstgd1+'$'+document.getElementById('txtciobookid').value+'~'+"I"+'~'+ds_GST.Tables[0].Rows[n1].SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].SUB_SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATEDETCODE+'~'+ds_GST.Tables[0].Rows[n1].GST_DESC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATE+'~'+onamt+'~'+gstamt1+'~'+ds_GST.Tables[0].Rows[n1].GST_STATE_CODE+'~'+ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE+'~0';
                                }                        
                             }
                             billid.value= parseFloat(billid.value)+parseFloat(gstamt);
                             billidlocal.value= parseFloat(billidlocal.value)+parseFloat(gstamt);
                             GSTAMT.value = parseFloat(gstamt);
                             GSTGD.value=gstgd1;
                             finalbillamt=parseFloat(finalbillamt)+parseFloat(billid.value);
                             finallcbillamt=parseFloat(finallcbillamt)+parseFloat(billidlocal.value);
                        }
                        else {
                                finalbillamt = parseFloat(finalbillamt) + parseFloat(billid.value);
                                finallcbillamt = parseFloat(finallcbillamt) + parseFloat(billidlocal.value);
                        }
                    }
                }
            }
        }
        if(finalbillamt!=0){
        document.getElementById('txtbillamt').value = finalbillamt;
        document.getElementById('txtbillamtlocal').value = finallcbillamt;
        }
    }
    billamtA = 0;
    var f = false;
    if (document.getElementById('drpbillcycle').value == "6" && roundoff != "editionwise" && roundoff != "off")
        roundoff = "rowise";
    else {
        if (roundoff != "editionwise" && roundoff != "off" && roundoff != "rowise")
            roundoff = "insertionwise";
    }
    roundoff = "rowise";
    // for round off
    if (roundoff == "editionwise") {
        var billLo = 0;
        var billMa = 0;
        for (var n = 0; n < count; n++) {
            billid = document.getElementById('ba' + n);
            billidlocal = document.getElementById('balocal' + n);
            roundamt = document.getElementById('roundoffval' + n);
            if (document.getElementById('ba' + n).value != 0 && document.getElementById('inssta' + n).value == "booked") {

                var billAmtC = document.getElementById('ba' + n).value;
                var billamt = billAmtC;
                var billamtA = parseFloat(billAmtC) + .01;
                billamtA = Math.round(billamtA);
                var diff = parseFloat(billamtA) - parseFloat(billamt);
                if (billid != null) {
                    billid.value = parseFloat(billid.value) + parseFloat(diff);
                    billid.value = parseFloat(billid.value).toFixed(2);
                    roundamt.value = parseFloat(diff).toFixed(2);
                }

                billAmtC = document.getElementById('balocal' + n).value;
                billamt = billAmtC;
                billamtA = parseFloat(billAmtC) + .01;
                billamtA = Math.round(billamtA);
                diff = parseFloat(billamtA) - parseFloat(billamt);
                if (billidlocal != null) {
                    billidlocal.value = parseFloat(billidlocal.value) + parseFloat(diff);
                    billidlocal.value = parseFloat(billidlocal.value).toFixed(2)
                }

            }
            billMa = parseFloat(billMa) + parseFloat(billid.value);
            billLo = parseFloat(billLo) + parseFloat(billidlocal.value);
        }
        document.getElementById('txtbillamt').value = billMa;
        document.getElementById('txtbillamtlocal').value = billLo;
    }
    if (roundoff == "rowise")
    {
        if (document.getElementById('txtbillamt').value == "")
        {
            var billamtA = "0";
            var billamt = "0";
        }
        else
        {
            var billamt = document.getElementById('txtbillamt').value;
            var billamtA = parseFloat(document.getElementById('txtbillamt').value) + .01;
        }
        billamtA = Math.round(billamtA);
        var diff = parseFloat(billamtA) - parseFloat(billamt);
        document.getElementById('roundoffval0').value = parseFloat(diff).toFixed(4);
        document.getElementById('txtbillamt').value = billamtA;
    }

    for (var i1 = 0; i1 < count; i1++) {

        if (document.getElementById('ba' + i1).value != 0 && document.getElementById('inssta' + i1).value == "booked" && f == false && roundoff == "rowise") {
            document.getElementById('ba' + i1).value = parseFloat(document.getElementById('ba' + i1).value) + parseFloat(diff);
            //  i1=count;
            f = true;
            if (document.getElementById('hiddenboxchrgtype') != null && document.getElementById('txtboxchrg') != null && document.getElementById('txtboxchrg').value != "" && document.getElementById('txtboxchrg').value != "0") //for on gross box charges
            {
                f = true;
            }
            //   else{
            //       i1=parseInt(count,10)-1;
            // }
        }
        if (document.getElementById('hiddenboxchrgtype') != null) //for on gross box charges
        {
            if (document.getElementById('hiddeninsertwise').value == 'yes') {
                var boxcharge = 0;

                if (document.getElementById('txtboxchrg') != null)
                    boxpercen = document.getElementById('txtboxchrg').value;

                if (boxpercen != null && boxpercen != "" && boxpercen != "0") {
                    boxcharge = parseInt(boxpercen);
                }
                if (document.getElementById('pai' + i1).value == "N" || document.getElementById('inssta' + i1).value == "cancel") {
                    boxcharge = 0;
                }
                if (document.getElementById('hiddenboxchrgtype').value == '2') {
                    boxcharge = (parseFloat(document.getElementById('gro' + i1).value) * parseFloat(boxcharge)) / 100;
                }
                if (document.getElementById('inssta' + i1).value == "booked") {
                    document.getElementById('ba' + i1).value = parseFloat(document.getElementById('ba' + i1).value) + parseFloat(boxcharge);

                    document.getElementById("boxc" + i1).value = boxcharge;
                }
            }
        }
        document.getElementById('ba' + i1).value = parseFloat(document.getElementById('ba' + i1).value).toFixed(2);
        billamtA = parseFloat(billamtA) + parseFloat(document.getElementById('ba' + i1).value);
        document.getElementById("grolocal" + i1).value = document.getElementById("gro" + i1).value;
        document.getElementById("balocal" + i1).value = document.getElementById("ba" + i1).value;
    }
    if (document.getElementById('hiddenboxchrgtype') != null && document.getElementById('txtboxchrg') != null && document.getElementById('txtboxchrg').value != "" && document.getElementById('txtboxchrg').value != "0") //for on gross box charges
        document.getElementById('txtbillamt').value = parseFloat(billamtA).toFixed(2);
    else
        document.getElementById('txtbillamt').value = parseFloat(document.getElementById('txtbillamt').value);
    document.getElementById('txtbillamt').value = parseFloat(document.getElementById('txtbillamt').value).toFixed(2);
    checkBarterAmt();
    document.getElementById('txtgrossamtlocal').value = document.getElementById('txtgrossamt').value;
    document.getElementById('txtbillamtlocal').value = document.getElementById('txtbillamt').value;
    if (document.getElementById('drpcurrency').value != document.getElementById('hidcurr').value || document.getElementById('drpcurrency').value != document.getElementById('drprptcurrency').value)
        getAmount_Currency();
    // roundoff insertionwise
    if (roundoff == "insertionwise") {
        var tCount = 0;
        var counterT = 0;
        var i = 0;
        var f_total = 0;
        var f_totallocal = 0;
        for (var i1 = 0; i1 < count; ) {
            i = i + 1;
            var ins_vari = document.getElementById('ins' + i1);
            if (ins_vari != null) {
                tCount = 0;
                while (parseInt(ins_vari.innerHTML) == parseInt(i)) {
                    tCount = parseInt(tCount) + 1;
                    counterT = parseInt(counterT) + 1;
                    ins_vari = document.getElementById('ins' + counterT);
                    if (ins_vari == null)
                        break;
                }
            }
            gridItemCount = tCount;  //get gridcount
            var billid;
            var billidlocal;
            var billAmtC = 0;
            var billAmtClocal = 0;

            for (var n = 0; n < gridItemCount; n++) {
                if (document.getElementById('ba' + i1).value != 0 && document.getElementById('inssta' + i1).value != "billed" && document.getElementById('inssta' + i1).value != "cancel") {
                    billid = document.getElementById('ba' + i1);
                    billidlocal = document.getElementById('balocal' + i1);
                    roundamt = document.getElementById('roundoffval' + i1);
                }
                billAmtC = parseFloat(billAmtC) + parseFloat(document.getElementById('ba' + i1).value);
                billAmtClocal = parseFloat(billAmtClocal) + parseFloat(document.getElementById('balocal' + i1).value);
                f_total = parseFloat(f_total) + parseFloat(document.getElementById('ba' + i1).value);
                f_totallocal = parseFloat(f_totallocal) + parseFloat(document.getElementById('balocal' + i1).value);
                i1 = i1 + 1;
            }
            var billamt = billAmtC;
            var billamtA = parseFloat(billAmtC) + .01;
            billamtA = Math.round(billamtA);
            var diff = parseFloat(billamtA) - parseFloat(billamt);
            if (billid != null) {
                billid.value = parseFloat(billid.value) + parseFloat(diff);
                billid.value = parseFloat(billid.value).toFixed(2);
                roundamt.value = parseFloat(diff).toFixed(2);
                f_total = parseFloat(f_total) + parseFloat(diff);
                f_total = parseFloat(f_total).toFixed(2)
            }
            billamt = billAmtClocal;
            billamtA = parseFloat(billAmtClocal) + .01;
            billamtA = Math.round(billamtA);
            var diff = parseFloat(billamtA) - parseFloat(billamt);
            if (billidlocal != null) {
                billidlocal.value = parseFloat(billidlocal.value) + parseFloat(diff);
                billidlocal.value = parseFloat(billidlocal.value).toFixed(2)
                f_totallocal = parseFloat(f_totallocal) + parseFloat(diff);
                f_totallocal = parseFloat(f_totallocal).toFixed(2)
            }
        }
        document.getElementById('txtbillamt').value = f_total;
        document.getElementById('txtbillamtlocal').value = f_totallocal;
    }
    if (chkbtnStatus == "modify" && globfromline != document.getElementById('txttotalarea').value && document.getElementById('drppaymenttype').value == "CA0" && parseFloat(document.getElementById('txtbillamt').value) > parseFloat(document.getElementById('hiddenbillamt').value)) {
        alert("Amount Changed, so you can't change matter in Cash Booking");
        document.getElementById('txtbillamt').value = "";
        return false;
    }
    commaenable();
    return false;
}
function getAmount_Currency() {

    if (document.getElementById('drpcurrency').value == document.getElementById('hidcurr').value && document.getElementById('drpcurrency').value == document.getElementById('drprptcurrency').value) {
        document.getElementById('txtgrossamtlocal').value = document.getElementById('txtgrossamt').value;
        document.getElementById('txtbillamtlocal').value = document.getElementById('txtbillamt').value;
        var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
        for (var i = 0; i < count; i++) {
            document.getElementById("grolocal" + i).value = document.getElementById("gro" + i).value;
            document.getElementById("balocal" + i).value = document.getElementById("ba" + i).value;
        }
    }
    else if (document.getElementById('drpcurrency').value == document.getElementById('hidcurr').value && document.getElementById('drpcurrency').value != document.getElementById('drprptcurrency').value) {
        document.getElementById('txtgrossamtlocal').value = document.getElementById('txtgrossamt').value;
        document.getElementById('txtbillamtlocal').value = document.getElementById('txtbillamt').value;
        var datep = document.getElementById('txtdatetime').value;
        var compcode = document.getElementById('hiddencompcode').value;
        var dateformat = document.getElementById('hiddendateformat').value;
        var res = Classified_Booking.CONVERTTOLOCAL_CURRENCY(compcode, document.getElementById('drpcurrency').value, document.getElementById('txtgrossamtlocal').value, document.getElementById('txtbillamtlocal').value, datep, dateformat, document.getElementById('drprptcurrency').value);
        var ds = res.value;
        if (ds == null) {
            alert(res.error.description);
            return false;
        }
        if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0) {
            if (ds.Tables[0].Rows[0].STATUS != null && ds.Tables[0].Rows[0].STATUS == "OK") {
                document.getElementById('txtgrossamtlocal').value = ds.Tables[0].Rows[0].GROSS;
                document.getElementById('txtbillamtlocal').value = ds.Tables[0].Rows[0].BILL;
                document.getElementById('hidcurrency_convrate').value = ds.Tables[0].Rows[0].CONV_RATE;
            }
        }
        var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
        for (var i = 0; i < count; i++) {
            document.getElementById("grolocal" + i).value = document.getElementById("gro" + i).value;
            document.getElementById("balocal" + i).value = document.getElementById("ba" + i).value;
            var gross = document.getElementById('grolocal' + i).value;
            var bill = document.getElementById('balocal' + i).value;
            var res = Classified_Booking.CONVERTTOLOCAL_CURRENCY(compcode, document.getElementById('drpcurrency').value, gross, bill, datep, dateformat, document.getElementById('drprptcurrency').value);
            var ds = res.value;
            if (ds == null) {
                alert(res.error.description);
                return false;
            }
            if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0) {
                if (ds.Tables[0].Rows[0].STATUS != null && ds.Tables[0].Rows[0].STATUS == "OK") {
                    document.getElementById("grolocal" + i).value = ds.Tables[0].Rows[0].GROSS;
                    document.getElementById("balocal" + i).value = ds.Tables[0].Rows[0].BILL;
                }
            }
        }
    }
    else if (document.getElementById('drpcurrency').value != document.getElementById('hidcurr').value && document.getElementById('drpcurrency').value != document.getElementById('drprptcurrency').value) {
        document.getElementById('txtgrossamtlocal').value = document.getElementById('txtgrossamt').value;
        document.getElementById('txtbillamtlocal').value = document.getElementById('txtbillamt').value;
        var datep = document.getElementById('txtdatetime').value;
        var compcode = document.getElementById('hiddencompcode').value;
        var dateformat = document.getElementById('hiddendateformat').value;
        var res = Classified_Booking.CONVERTTOLOCAL_CURRENCY(compcode, document.getElementById('drpcurrency').value, document.getElementById('txtgrossamtlocal').value, document.getElementById('txtbillamtlocal').value, datep, dateformat, document.getElementById('hidcurr').value);
        var ds = res.value;
        if (ds == null) {
            alert(res.error.description);
            return false;
        }
        if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0) {
            if (ds.Tables[0].Rows[0].STATUS != null && ds.Tables[0].Rows[0].STATUS == "OK") {
                document.getElementById('txtgrossamt').value = ds.Tables[0].Rows[0].GROSS;
                document.getElementById('txtbillamt').value = ds.Tables[0].Rows[0].BILL;
                document.getElementById('hidcurrency_convrate').value = ds.Tables[0].Rows[0].CONV_RATE;
            }
        }
        var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
        for (var i = 0; i < count; i++) {
            document.getElementById("grolocal" + i).value = document.getElementById("gro" + i).value;
            document.getElementById("balocal" + i).value = document.getElementById("ba" + i).value;
            var gross = document.getElementById('grolocal' + i).value;
            var bill = document.getElementById('balocal' + i).value;
            var res = Classified_Booking.CONVERTTOLOCAL_CURRENCY(compcode, document.getElementById('drpcurrency').value, gross, bill, datep, dateformat, document.getElementById('hidcurr').value);
            var ds = res.value;
            if (ds == null) {
                alert(res.error.description);
                return false;
            }
            if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0) {
                if (ds.Tables[0].Rows[0].STATUS != null && ds.Tables[0].Rows[0].STATUS == "OK") {
                    document.getElementById("gro" + i).value = ds.Tables[0].Rows[0].GROSS;
                    document.getElementById("ba" + i).value = ds.Tables[0].Rows[0].BILL;
                }
            }
        }
        // again converting rate into receipt currencyfrom local
        if (document.getElementById('hidcurr').value != document.getElementById('drprptcurrency').value) {
            document.getElementById('txtgrossamtlocal').value = document.getElementById('txtgrossamt').value;
            document.getElementById('txtbillamtlocal').value = document.getElementById('txtbillamt').value;
            var datep = document.getElementById('txtdatetime').value;
            var compcode = document.getElementById('hiddencompcode').value;
            var dateformat = document.getElementById('hiddendateformat').value;
            var res = Classified_Booking.CONVERTTOLOCAL_CURRENCY(compcode, document.getElementById('drpcurrency').value, document.getElementById('txtgrossamtlocal').value, document.getElementById('txtbillamtlocal').value, datep, dateformat, document.getElementById('drprptcurrency').value);
            var ds = res.value;
            if (ds == null) {
                alert(res.error.description);
                return false;
            }
            if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0) {
                if (ds.Tables[0].Rows[0].STATUS != null && ds.Tables[0].Rows[0].STATUS == "OK") {
                    document.getElementById('txtgrossamtlocal').value = ds.Tables[0].Rows[0].GROSS;
                    document.getElementById('txtbillamtlocal').value = ds.Tables[0].Rows[0].BILL;
                    document.getElementById('hidcurrency_convrate').value = ds.Tables[0].Rows[0].CONV_RATE;
                }
            }
            var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
            for (var i = 0; i < count; i++) {
                document.getElementById("grolocal" + i).value = document.getElementById("gro" + i).value;
                document.getElementById("balocal" + i).value = document.getElementById("ba" + i).value;
                var gross = document.getElementById('grolocal' + i).value;
                var bill = document.getElementById('balocal' + i).value;
                var res = Classified_Booking.CONVERTTOLOCAL_CURRENCY(compcode, document.getElementById('drpcurrency').value, gross, bill, datep, dateformat, document.getElementById('drprptcurrency').value);
                var ds = res.value;
                if (ds == null) {
                    alert(res.error.description);
                    return false;
                }
                if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0) {
                    if (ds.Tables[0].Rows[0].STATUS != null && ds.Tables[0].Rows[0].STATUS == "OK") {
                        document.getElementById("grolocal" + i).value = ds.Tables[0].Rows[0].GROSS;
                        document.getElementById("balocal" + i).value = ds.Tables[0].Rows[0].BILL;
                    }
                }
            }
        }
    }
    else if (document.getElementById('drpcurrency').value != document.getElementById('hidcurr').value && document.getElementById('drpcurrency').value == document.getElementById('drprptcurrency').value) {
        document.getElementById('txtgrossamtlocal').value = document.getElementById('txtgrossamt').value;
        document.getElementById('txtbillamtlocal').value = document.getElementById('txtbillamt').value;
        var datep = document.getElementById('txtdatetime').value;
        var compcode = document.getElementById('hiddencompcode').value;
        var dateformat = document.getElementById('hiddendateformat').value;
        var res = Classified_Booking.CONVERTTOLOCAL_CURRENCY(compcode, document.getElementById('drpcurrency').value, document.getElementById('txtgrossamtlocal').value, document.getElementById('txtbillamtlocal').value, datep, dateformat, document.getElementById('hidcurr').value);
        var ds = res.value;
        if (ds == null) {
            alert(res.error.description);
            return false;
        }
        if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0) {
            if (ds.Tables[0].Rows[0].STATUS != null && ds.Tables[0].Rows[0].STATUS == "OK") {
                document.getElementById('txtgrossamt').value = ds.Tables[0].Rows[0].GROSS;
                document.getElementById('txtbillamt').value = ds.Tables[0].Rows[0].BILL;
                document.getElementById('hidcurrency_convrate').value = ds.Tables[0].Rows[0].CONV_RATE;
            }
        }
        var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
        for (var i = 0; i < count; i++) {
            document.getElementById("grolocal" + i).value = document.getElementById("gro" + i).value;
            document.getElementById("balocal" + i).value = document.getElementById("ba" + i).value;
            var gross = document.getElementById('grolocal' + i).value;
            var bill = document.getElementById('balocal' + i).value;
            var res = Classified_Booking.CONVERTTOLOCAL_CURRENCY(compcode, document.getElementById('drpcurrency').value, gross, bill, datep, dateformat, document.getElementById('hidcurr').value);
            var ds = res.value;
            if (ds == null) {
                alert(res.error.description);
                return false;
            }
            if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0) {
                if (ds.Tables[0].Rows[0].STATUS != null && ds.Tables[0].Rows[0].STATUS == "OK") {
                    document.getElementById("gro" + i).value = ds.Tables[0].Rows[0].GROSS;
                    document.getElementById("ba" + i).value = ds.Tables[0].Rows[0].BILL;
                }
            }
        }
    }
}
function bindVtsRate() {

    var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
    var billamttot = 0;
    var gridgrosstot = 0;
    var arrshare;
    var dspub;
    if (sharepub != "") {
        arrshare = sharepub.split("$");
        var packagecode = '';
        var obj = document.getElementById('drppackagecopy');
        for (var x = 0; x < obj.options.length; x++) {

            var insertCount1 = 0;
            if (obj[x].value.indexOf('(') >= 0) {
                insertCount1 = obj[x].value.substring(obj[x].value.lastIndexOf('(') + 1, obj[x].value.length - 1);
                //  insertCount1=parseInt(insertCount1)-1;
            }
            for (x1 = 0; x1 < insertCount1; x1++) {
                if (packagecode == '')
                    packagecode = obj[x].value.substring(0, obj[x].value.lastIndexOf('@'));
                else
                    packagecode = packagecode + ',' + obj[x].value.substring(0, obj[x].value.lastIndexOf('@'));

            }


        }
        var respub = Classified_Booking.getpubcount(document.getElementById('hiddencompcode').value, document.getElementById('txtinsertion').value, packagecode, document.getElementById('txtciobookid').value);
        if (respub.error == null) {
            dspub = respub.value;
        }
    }
    var maingross = document.getElementById('txtgrossamt').value;
    var drpbooktype_vari = document.getElementById('drpbooktype').value;
    for (var i = 0; i < count; i++) {
        var vtsvalue = document.getElementById('vts' + i).value;
        var cirvts = "";
        var cirpub = "";
        var ciredi = "";
        var cirrate = "";
        var cirdate = "";
        if (vtsvalue != "") {
            cirvts = vtsvalue.split('ÿ')[0];
            cirpub = vtsvalue.split('ÿ')[1];
            ciredi = vtsvalue.split('ÿ')[2];
            cirrate = vtsvalue.split('ÿ')[3];
            cirdate = vtsvalue.split('ÿ')[4];
        }
        var billrate = document.getElementById("ba" + i);
        var billrate = document.getElementById("ba" + i);
        var grossrate = document.getElementById("gro" + i);
        var pubcode = document.getElementById("pubcode" + i);
        var inssta = document.getElementById("inssta" + i);
        var edition = document.getElementById("edit" + i);
        var vat = document.getElementById("vat" + i);
        var pai_var = document.getElementById("pai" + i);
        var vat_inc = document.getElementById("vat_inc" + i);
        var paicashd = document.getElementById("cashd" + i)
        // FOR SHARING PUBLICATION WISE
        if (arrshare != undefined && arrshare.length > 0) {
            var tCount = 0;
            var counterT = 0;
            var ins_vari = document.getElementById('ins' + counterT);
            if (ins_vari != null) {
                while (parseInt(ins_vari.innerHTML) == "1") {
                    tCount = parseInt(tCount) + 1;
                    counterT = parseInt(counterT) + 1;
                    ins_vari = document.getElementById('ins' + counterT);
                    if (ins_vari == null)
                        break;
                }
            }
            var gridItemCount = tCount;
            for (var ishare = 0; ishare < arrshare.length; ishare++) {
                var strSp = arrshare[ishare].split("~");

                if (strSp[0] == pubcode.value && strSp[1] != "") {
                    ishare = arrshare.length;
                    var div = 1;
                    if (dspub != undefined && dspub != null && dspub.Tables[0].Rows.length > 0) {
                        for (var in1 = 0; in1 < dspub.Tables[0].Rows.length; in1++) {
                            if (dspub.Tables[0].Rows[in1].PUBLICATION == pubcode.value) {
                                div = dspub.Tables[0].Rows[in1].COUNTPUB;
                                if (dspub.Tables[0].Rows.length == 1 && div != "" && document.getElementById('txtpaid').value != "" && parseInt(div) > (parseInt(document.getElementById('txtpaid').value) * parseInt(gridItemCount))) {
                                    var d = parseInt(div) - parseInt(document.getElementById('txtpaid').value);
                                    div = parseInt(div) - parseInt(d);
                                }
                            }
                        }
                    }
                    if (((inssta.value != 'cancel' && inssta.value != 'billed' && inssta.value != 'publish') || document.getElementById('hiddensupplimentflag').value != "") && pai_var.value != "N") {
                        if (strSp[2] == "F") {
                            grossrate.value = parseFloat(strSp[1]) / parseFloat(div);
                        }
                        else {
                            grossrate.value = ((parseFloat(maingross) * parseFloat(strSp[1]) / 100)) / parseFloat(div);
                        }
                        //calculate trade discount
                        var tradisc = document.getElementById('txttradedisc').value;
                        if (document.getElementById('chktrade').checked == false)
                            tradisc = 0;
                        if (tradisc == "")
                            tradisc = 0;
                        var trdisc1 = tradisc;
                        var addcomm = 0;
                        if (document.getElementById('txtaddagencycommrate') != null) {
                            if (document.getElementById('hiddenagcommflag').value != "1")
                                addcomm = document.getElementById('txtaddagencycommrate').value;
                        }
                        if (addcomm == "") {
                            addcomm = "0";
                        }
                        if (addcomm != "0") {
                            trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                        }

                        var billamount = 0;
                        billamount = parseFloat(grossrate.value) - (parseFloat(grossrate.value) * trdisc1 / 100);
                        billrate.value = billamount;
                    }
                }
            }
        }

        var insertsta = document.getElementById("inssta" + i);
        // END    
        var ag = Classified_Booking.GETCASH_PAY(document.getElementById('hiddencompcode').value, document.getElementById('drppaymenttype').value);
        var ds_n = ag.value;
        var cashdiscount = 'N';
        if (ds_n != null && ds_n.Tables[0].Rows.length > 0) {
            cashdiscount = ds_n.Tables[0].Rows[0].CASHDISCOUNT;
        }
        if (cirrate != "" && cirvts != "") {

            if (document.getElementById('txtcashdiscount').value != "" && cashdiscount == "Y" && document.getElementById('hiddenagcommflag').value != "1" && parseFloat(parseFloat(document.getElementById('txtagencyoutstand').value) + parseFloat(document.getElementById('txtbillamt').value)) < 0) {
                if (document.getElementById('hiddencashdiscper').value == "F") {
                    billrate.value = parseFloat(billrate.value) - parseFloat(document.getElementById('txtcashdiscount').value);
                    paicashd.value = document.getElementById('txtcashdiscount').value;
                }
                else {
                    paicashd.value = ((parseFloat(billrate.value) * parseFloat(document.getElementById('txtcashdiscount').value)) / 100);
                    billrate.value = parseFloat(billrate.value) - ((parseFloat(billrate.value) * parseFloat(document.getElementById('txtcashdiscount').value)) / 100);
                }
            }
            var paidno = document.getElementById("pai" + i);
            //var insertsta = document.getElementById("inssta" + i);

            if (paidno.value != 'N' && insertsta.value != 'cancel') {
                var total = parseFloat(cirrate) * parseFloat(cirvts);
                if (billrate.value != "") {
                    billrate.value = (parseFloat(billrate.value) + parseFloat(total)).toFixed(2);
                    ///  billamttot = parseFloat(billamttot) + parseFloat(billrate.value);
                }
            }
            else {
                //  billamttot = parseFloat(billamttot) + parseFloat(billrate.value);
            }
        }
        else {
            if (document.getElementById('txtcashdiscount').value != "" && cashdiscount == "Y" && document.getElementById('hiddenagcommflag').value != "1" && parseFloat(parseFloat(document.getElementById('txtagencyoutstand').value) + parseFloat(document.getElementById('txtbillamt').value)) < 0) {
                if (document.getElementById('hiddencashdiscper').value == "F") {
                    paicashd.value = document.getElementById('txtcashdiscount').value;
                    billrate.value = parseFloat(billrate.value) - parseFloat(document.getElementById('txtcashdiscount').value);
                }
                else {
                    paicashd.value = ((parseFloat(billrate.value) * parseFloat(document.getElementById('txtcashdiscount').value)) / 100);
                    billrate.value = parseFloat(billrate.value) - ((parseFloat(billrate.value) * parseFloat(document.getElementById('txtcashdiscount').value)) / 100);

                }
            }
            //   billamttot = parseFloat(billamttot) + parseFloat(billrate.value);
        }
        // For Calculating VAT Rate
        var vatprec = 0;
        if (vat != null && (vat.value == "" || vat.value == null || vat.value == "null")) {
            var resvat = Classified_Booking.getVTSRate(pubcode.value, edition.value, document.getElementById('hiddencompcode').value);
            if (resvat.error != null) {
                alert(resvat.error.description);
                return false;
            }
            var dsvat = resvat.value;
            if (dsvat != null && dsvat.Tables.length > 0 && dsvat.Tables[0].Rows.length > 0) {
                if (dsvat.Tables[0].Rows[0].VATPREC != null) {
                    vatprec = dsvat.Tables[0].Rows[0].VATPREC;
                    vat.value = vatprec;
                    document.getElementById('hdnvts').value = dsvat.Tables[0].Rows[0].VAT_CODE

                }
            }
        }
        else if (vat != null && vat.value != "" && vat.value != null && vat.value != "null") {
            vatprec = vat.value;
            //document.getElementById('hdnvts').value = vat.value
        }
        if (vatprec != "" && vatprec != 0 && vat_inc.value != "1") {
            if (clientfromconfig != "TH" && insertsta.value != 'billed' && insertsta.value != 'cancel')
                billrate.value = parseFloat(billrate.value) + ((parseFloat(billrate.value) * parseFloat(vatprec)) / 100);
            else {
                var grossamt_V = grossrate.value;
                if (dsvat != null && dsvat.Tables.length > 0 && dsvat.Tables[0].Rows.length > 0) {
                    var finalBR = 0;
                    var addcomm = 0;
                    var vatamt_l = (parseFloat(grossamt_V) * parseFloat(vatprec) / 100);
                    finalBR = parseFloat(grossamt_V) - (parseFloat(grossamt_V) * parseFloat(vatprec) / 100);
                    var tradisc = document.getElementById('txttradedisc').value;
                    if (document.getElementById('chktrade').checked == false)
                        tradisc = 0;
                    if (tradisc == "")
                        tradisc = 0;
                    var trdisc1 = tradisc;
                    finalBR = parseFloat(finalBR) - (parseFloat(finalBR) * parseFloat(trdisc1) / 100);
                    if (document.getElementById('txtaddagencycommrate') != null) {
                        if (document.getElementById('hiddenagcommflag').value != "1")
                            addcomm = document.getElementById('txtaddagencycommrate').value;
                    }
                    if (addcomm == "") {
                        addcomm = "0";
                    }
                    finalBR = parseFloat(finalBR) - (parseFloat(finalBR) * parseFloat(addcomm) / 100);
                    if ((insertsta.value != 'billed' || document.getElementById('hiddensupplimentflag').value != "") && insertsta.value != 'cancel')
                        billrate.value = parseFloat(finalBR) + parseFloat(vatamt_l);


                }
            }

        }
        else if (vatprec != "" && vatprec != 0 && vat_inc.value == "1") {
            if (clientfromconfig != "TH" && insertsta.value != 'billed' && insertsta.value != 'cancel') {
                var cal = ((parseFloat(billrate.value) * 100)) / (100 + parseFloat(vatprec));
                var tradisc = document.getElementById('txttradedisc').value;
                if (document.getElementById('chktrade').checked == false)
                    tradisc = 0;
                if (tradisc == "")
                    tradisc = 0;
                var trdisc1 = tradisc;
                var addcomm = 0;
                if (document.getElementById('txtaddagencycommrate') != null) {
                    if (document.getElementById('hiddenagcommflag').value != "1")
                        addcomm = document.getElementById('txtaddagencycommrate').value;
                }
                if (addcomm == "") {
                    addcomm = "0";
                }
                if (addcomm != "0") {
                    trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                }
                // cal=parseFloat(cal) + (parseFloat(cal) * parseFloat(trdisc1)/100);
                grossrate.value = (parseFloat(cal)).toFixed(2);
            }
            else {
                var grossamt_V = grossrate.value;

                if (dsvat != null && dsvat.Tables.length > 0 && dsvat.Tables[0].Rows.length > 0) {
                    var finalBR = 0;
                    var addcomm = 0;
                    var vatamt_l = (parseFloat(grossamt_V) * parseFloat(vatprec) / 100);
                    if ((insertsta.value != 'billed' || document.getElementById('hiddensupplimentflag').value != "") && insertsta.value != 'cancel')
                        grossrate.value = parseFloat(grossrate.value) + parseFloat(vatamt_l);
                    grossamt_V = grossrate.value;
                    var vatamt_2 = (parseFloat(grossamt_V) * parseFloat(vatprec) / 100);
                    finalBR = parseFloat(grossamt_V) - (parseFloat(grossamt_V) * parseFloat(vatprec) / 100);
                    var tradisc = document.getElementById('txttradedisc').value;
                    if (document.getElementById('chktrade').checked == false)
                        tradisc = 0;
                    if (tradisc == "")
                        tradisc = 0;
                    var trdisc1 = tradisc;
                    finalBR = parseFloat(finalBR) - (parseFloat(finalBR) * parseFloat(trdisc1) / 100);
                    if (document.getElementById('txtaddagencycommrate') != null) {
                        if (document.getElementById('hiddenagcommflag').value != "1")
                            addcomm = document.getElementById('txtaddagencycommrate').value;
                    }
                    if (addcomm == "") {
                        addcomm = "0";
                    }
                    finalBR = parseFloat(finalBR) - (parseFloat(finalBR) * parseFloat(addcomm) / 100);
                    if ((insertsta.value != 'billed' || document.getElementById('hiddensupplimentflag').value != "") && insertsta.value != 'cancel')
                        billrate.value = parseFloat(finalBR) + parseFloat(vatamt_2);


                }
            }
        }
        if (drpbooktype_vari == "2" || drpbooktype_vari == "4" || drpbooktype_vari == "5" || drpbooktype_vari == "6") {
            if (inssta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                billrate.value = 0;
        }
        billamttot = parseFloat(billamttot) + parseFloat(billrate.value);
        gridgrosstot = parseFloat(gridgrosstot) + parseFloat(grossrate.value);
    }
    document.getElementById('txtbillamt').value = (parseFloat(billamttot)).toFixed(2);
    document.getElementById('txtgrossamt').value = (parseFloat(gridgrosstot)).toFixed(2);
}
function bindFinalRate() {
    var premper_vari = "";
    //alert("raju");
    var discprem = document.getElementById('drpdiscountprem').value;
    var spediscper = document.getElementById('txtspediscper').value;
    var chkadon_var = "";
    if (document.getElementById('chkadon').checked == true) {
        chkadon_var = "Y";
    }
    else {
        chkadon_var = "N";
    }
    if (document.getElementById('txtagreedamt').value == "" && document.getElementById('txtagreedrate').value != "" && document.getElementById('txtagreedrate').value != "0" && document.getElementById('txtagreedrate').value != "0.00")
        agreedrate_active = "1";
    else if (document.getElementById('txtagreedrate').value == "" && document.getElementById('txtagreedamt').value != "" && document.getElementById('txtagreedamt').value != "0" && document.getElementById('txtagreedamt').value != "0.00")
        agreedamt_active = "1";
    getagreedamt_Rate();
    //calculate trade discount
    var tradisc = document.getElementById('txttradedisc').value;
    if (document.getElementById('chktrade').checked == false)
        tradisc = 0;
    if (tradisc == "")
        tradisc = 0;
    var trdisc1 = tradisc;
    var addcomm = 0;
    if (document.getElementById('txtaddagencycommrate') != null) {
        if (document.getElementById('hiddenagcommflag').value != "1")
            addcomm = document.getElementById('txtaddagencycommrate').value;
    }
    if (addcomm == "") {
        addcomm = "0";
    }
    if (addcomm != "0") {
        trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
    }
    var billamount = 0;
    var agncomm_seq_com_vari = document.getElementById('agncomm_seq_com').value;
    var drpbooktype_vari = document.getElementById('drpbooktype').value;
    var grossamt_vari = document.getElementById('txtgrossamt');
    var billamt_vari = document.getElementById('txtbillamt');
    var spacedisc_vari = document.getElementById('txtspacedisc').value;
    var hiddenratecheckdate_vari = document.getElementById('hiddenratecheckdate').value;
    var datetime_vari = document.getElementById('txtdatetime').value;
    var schemetype_vari = document.getElementById('hiddenschemetype').value;
    var hidschememin_vari = document.getElementById('hidschememin').value;
    var bullet_var = document.getElementById('drpbullet');
    var scheme_var = ""; //document.getElementById('drpscheme');
    var scheme_var_id = document.getElementById('drpscheme');
    var noofinsertion = document.getElementById('txtinsertion').value;
    var compcode = document.getElementById('hiddencompcode').value;
    var uom = document.getElementById('drpuom').value;
    var adtype = "CL0";
    var currency = document.getElementById('drpcurrency').value;
    var ratecode = document.getElementById('txtratecode').value;
    var clientcode = document.getElementById('txtclient').value;  //getclientcode();
    var client;
    if (clientcode.indexOf("(".toString()) > 0) {
        var myarray1 = clientcode.split('(');
        client = myarray1[1];
        client = client.replace(")", '');
        clientcode = client;
    }
    var uomdesc = document.getElementById('hiddenuomdesc').value;
    var agencycode = document.getElementById('hiddenagency').value;
    var agency_vari = document.getElementById('txtagency');
    var drppackage_vari = document.getElementById('drppackagecopy');
    if (agency_vari.value != "") {
        agencycode = agency_vari.value.substring(agency_vari.value.lastIndexOf("(") + 1, agency_vari.value.lastIndexOf(")"));
    }
    //====Changes for Rate Revise===//
    if (document.getElementById('hdnrevise').value != "" && document.getElementById('txtrevisedate').value != "") {
        var resagchk = Classified_Booking.chkagencyforraterevise(compcode, agencycode);
        if (resagchk.value == null) {
            alert(resagchk.error.description);
            return false;
        }
        if (resagchk.value.Tables[0].Rows.length > 0) {
            if (resagchk.value.Tables[0].Rows[0].RATE_REVISE != '1') {
                alert("You Can't select Revise Date for This Agency");
                return false;
            }
        }
    }
    if (document.getElementById('hdnfollodate').value == "Y" && gfollodate == "") {
        alert("Please Fill the insertion date");
        return false;
    }
    //==****************===//
    //  var center = document.getElementById('hiddencenter').value; //"0"
    /// for fetching rate booking  branch wise not login branch wise
    var center = document.getElementById('txtbranch').value; //"0"
    var ratepremtype = document.getElementById('hiddenratepremtype').value;
    var dateformat = document.getElementById('hiddendateformat').value;
    var eyecatchtype = '';
    if (document.getElementById('hiddenbulletpremtype') != null)
        eyecatchtype = document.getElementById('hiddenbulletpremtype').value;
    var bPrem = '';
    if (document.getElementById('hiddenbullprem') != null)
        bPrem = document.getElementById('hiddenbullprem').value;
    var boxchargeInsertionwise = document.getElementById('hiddeninsertwise').value;
    var boxcharge = 0;
    if (document.getElementById('txtboxchrg') != null)
        boxpercen = document.getElementById('txtboxchrg').value;
    if (boxpercen != null && boxpercen != "" && boxpercen != "0") {
        boxcharge = parseInt(boxpercen);
    }
    flagins = "1";
    var grossamtfinal = 0;
    var cardamt = 0;
    var grossamtfinalAgreed = 0;
    var newcode = "";
    nprint_flag = false;
    schemeid = "";
    var agreedcancelAmt = 0;
    var res = null;
    len = "bookdiv";
    var query = '';
    var rowcount = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
    tot_row_count = rowcount;
    var editionname = '';
    var pkgcode = '';
    var color = '';
    var cat1 = '';
    var cat2 = '';
    var cat3 = '';
    var cat4 = '';
    var cat5 = '';
    var line = '';
    var insert_date = '';
    var ratecheck_date = '';
    var cardrateSum = 0;
    var k = 0;
    var canclecharge = 0;
    var cntrfill = 0;
    var counter = 0;
    var counterT = 0;
    var cardrate = 0;
    var finsert = 1;
    var tinsert = 0;
    var pkg_insertion = '';
    var ad_width = '';
    var pkg_alias = '';
    var pagepost = '';
    var premiumno = '';
    //  var paidCount=document.getElementById('txtinsertion').value;
    var paidCount = 0;
    var finsertF = 0;
    finsertF = 0;
    if (drppackage_vari.options.length > 0) {
        for (var insertCou = 0; insertCou < drppackage_vari.options.length; insertCou++) {
            if (drppackage_vari.options[insertCou].value.indexOf('(') >= 0) {
                tinsert = drppackage_vari.options[insertCou].value.substring(drppackage_vari.options[insertCou].value.lastIndexOf('(') + 1, drppackage_vari.options[insertCou].value.lastIndexOf(')'));
                if (parseInt(tinsert) > parseInt(finsert)) {
                    finsert = tinsert;
                }
                finsertF = parseInt(finsertF) + parseInt(tinsert);
                // paidCount = parseInt(paidCount) * parseInt(tinsert);
                paidCount = parseInt(paidCount) + (parseInt(tinsert) * parseInt(document.getElementById('txtinsertion').value));
            }
        }
    }
    document.getElementById('txtpaid').value = paidCount;
    // finsert = parseInt(finsertF) * parseInt(document.getElementById('txtinsertion').value);
    if (document.getElementById('configclient').value == "BHASKAR") {
        finsert = parseInt(finsertF) * parseInt(document.getElementById('txtinsertion').value);
    }
    else {
        finsert = parseInt(finsert) * parseInt(document.getElementById('txtinsertion').value);
    }
    var gridItemCount = parseInt(rowcount) / parseInt(finsertF);
    var freeIns = "N";
    var flag_agreed = 0;
    var paid_var = document.getElementById('txtpaid');
    var color_vari = document.getElementById('drpcolor');
    var drpadcat_vari = document.getElementById('drpadcategory');
    var drpadsubcat_vari = document.getElementById('drpadsubcategory');
    var drpadcat3_vari = document.getElementById('drpadcat3');
    var drpadcat4_vari = document.getElementById('drpadcat4');
    var drpadcat5_vari = document.getElementById('drpadcat5');
    var totalarea_vari = document.getElementById('txttotalarea');
    var agreedrate_vari = document.getElementById('txtagreedrate');
    var agreedamt_vari = document.getElementById('txtagreedamt');
    var hiddenbox_vari = document.getElementById('hiddenboxchrgtype');
    var pospremdisc = document.getElementById('txtpospremdisc').value;
    if (pospremdisc == "")
        pospremdisc = "0";
    // for consumption period
    var fDate = '';
    var lDate = '';
    var schemecountNumber = 0;
    var splboldspecialsize1 = "";
    if (rowcount > 0) {
        if (document.getElementById('Text0').value == "")
            fDate = date_frmt_orcl(dateformat, gfollodate);
        else
            fDate = date_frmt_orcl(dateformat, document.getElementById('Text0').value);
        if (document.getElementById('Text' + (rowcount - 1)).value == "")
            lDate = date_frmt_orcl(dateformat, gfollodate);
        else
            lDate = date_frmt_orcl(dateformat, document.getElementById('Text' + (rowcount - 1)).value);
    }
    var sPaid = 0; //paid_var.value;
    var freeIns_S = "N";
    for (var i = 0; i < parseInt(finsert); i++) {
        //  if(freeIns_S=="Y")
        //  {
        //  sPaid=parseInt(sPaid,10)+1;
        //}
        if (freeIns == "Y") {
            if (schemecountNumber != "" && schemecountNumber != "0")
                paid_var.value = parseInt(paid_var.value) - parseInt(schemecountNumber, 10);
            else
                paid_var.value = parseInt(paid_var.value) - 1;
        }
        freeIns = "N";
        freeIns_S = "N";
        counterT = counter;
        editionname = '';
        splboldspecialsize1 = "";
        pkgcode = '';
        color = '';
        cat1 = '';
        cat2 = '';
        cat3 = '';
        cat4 = '';
        cat5 = '';
        pkg_insertion = '';
        ad_width = '';
        line = '';
        insert_date = '';
        splboldspecialsize1 = '';
        ratecheck_date = '';

        pkg_alias = '';
        ad_width = '';
        pagepost = '';
        premiumno = '';
        var tCount = 0;
        var insval;
        var ins_vari = document.getElementById('ins' + counterT);
        if (ins_vari != null) {
            while (parseInt(ins_vari.innerHTML) == parseInt(i) + 1) {
                tCount = parseInt(tCount) + 1;
                counterT = parseInt(counterT) + 1;
                ins_vari = document.getElementById('ins' + counterT);
                if (ins_vari == null)
                    break;
            }
        }
        gridItemCount = tCount;  //get gridcount
        var pfdate;
        var pldate;
        var pkgcode_p;
        var cancelcount = 0;
        for (var j = 0; j < parseInt(gridItemCount); j++) {
            var par1;
            var edit_vari = document.getElementById('edit' + k);
            par1 = (edit_vari.parentNode).parentNode;
            //var col_vari=document.getElementById('col'+k);
            if (document.getElementById('inssta' + k).value == 'cancel') {
                tot_row_count = parseInt(tot_row_count, 10) - 1;
            }
            if (browser != "Microsoft Internet Explorer") {
                var splboldsize = document.getElementById("splboldsize" + k);
                var col_vari = document.getElementById('col' + k);
                var adcat_vari = document.getElementById('adcat' + k);
                var cat2_vari = document.getElementById('ads' + k);
                var cat3_vari = document.getElementById('adscat3' + k);
                var cat4_vari = document.getElementById('adscat4' + k);
                var cat5_vari = document.getElementById('adscat5' + k);
                var preall_vari = document.getElementById('preall' + k);
                //            var adcat_vari=document.getElementById('adcat'+k);
                //            var cat2_vari=document.getElementById('ads'+k);
                //            var cat3_vari=document.getElementById('adscat3'+k);
                //            var cat4_vari=document.getElementById('adscat4'+k);
                //            var cat5_vari=document.getElementById('adscat5'+k);
                var siz_vari;
                siz_vari = document.getElementById('siz' + k);

                var text_vari;
                text_vari = document.getElementById('Text' + k);
                if (text_vari.value == "")
                    var pmdate = gfollodate;
                else
                    var pmdate = text_vari.value;
                if (j != 0) {
                    pfdate = getBigDate(pfdate, pmdate, dateformat, "min");
                    pldate = getBigDate(pldate, pmdate, dateformat, "max");
                }
                if (j == 0) {
                    pfdate = pmdate; //text_vari.value;
                    pldate = pmdate; //text_vari.value;
                }
                //  var pkgins_vari=document.getElementById('pkg_ins'+k);
                var pkgins_vari = document.getElementById('pkg_ins' + k);
                var wid_vari;
                wid_vari = document.getElementById('wid' + k);

                var pkgalias_vari = document.getElementById('pkg_alias' + k);
                var pgpre_vari = document.getElementById('pgpre' + k);
                var prem_vari = document.getElementById('prem' + k);
                var hiddenpck_vari = document.getElementById('hiddenpckcode' + k);
                //alert("bhanu");
            }
            else {
                var splboldsize = par1.all["splboldsize" + k];
                var col_vari = par1.all['col' + k];
                var adcat_vari = par1.all['adcat' + k];
                var cat2_vari = par1.all['ads' + k];
                var cat3_vari = par1.all['adscat3' + k];
                var cat4_vari = par1.all['adscat4' + k];
                var cat5_vari = par1.all['adscat5' + k];
                //            var adcat_vari=document.getElementById('adcat'+k);
                //            var cat2_vari=document.getElementById('ads'+k);
                //            var cat3_vari=document.getElementById('adscat3'+k);
                //            var cat4_vari=document.getElementById('adscat4'+k);
                //            var cat5_vari=document.getElementById('adscat5'+k);
                var siz_vari;
                siz_vari = par1.all['siz' + k];

                var text_vari;
                text_vari = par1.all['Text' + k];
                if (text_vari.value == "")
                    var pmdate = gfollodate;
                else
                    var pmdate = text_vari.value;
                if (j != 0) {
                    pfdate = getBigDate(pfdate, pmdate, dateformat, "min");
                    pldate = getBigDate(pldate, pmdate, dateformat, "max");
                }
                if (j == 0) {
                    pfdate = pmdate; //text_vari.value;
                    pldate = pmdate; //text_vari.value;
                }
                //  var pkgins_vari=document.getElementById('pkg_ins'+k);
                var pkgins_vari = par1.all['pkg_ins' + k];
                var wid_vari;
                wid_vari = par1.all['wid' + k];

                var pkgalias_vari = par1.all['pkg_alias' + k];
                var pgpre_vari = par1.all['pgpre' + k];
                var prem_vari = par1.all['prem' + k];
                var preall_vari = par1.all['preall' + k];
                var hiddenpck_vari = par1.all['hiddenpckcode' + k];
            }

            //            var pkgalias_vari=document.getElementById('pkg_alias'+k);
            //            var pgpre_vari=document.getElementById('pgpre'+k);
            //            var prem_vari=document.getElementById('prem'+k);
            //            var hiddenpck_vari=document.getElementById('hiddenpckcode'+k);
            //  pldate=text_vari.value;
            var t = document.getElementById('allowprem_card_disc_rate').value;
            pkgcode_p = hiddenpck_vari.value;
            if (edit_vari != null) {
                if (editionname == '') {
                    editionname = edit_vari.value;
                }
                else {
                    editionname = editionname + ',' + edit_vari.value;
                }

                if (pkgcode == '') {
                    pkgcode = hiddenpck_vari.value;
                }
                else {
                    pkgcode = pkgcode + ',' + hiddenpck_vari.value;
                }

                if (color == '') {
                    if (col_vari != null) {
                        if (col_vari.value != "")
                            color = col_vari.value;
                        else
                            color = "0";
                    }
                    else
                        color = color_vari.value;
                }
                else {
                    if (col_vari != null) {
                        if (col_vari.value != "")
                            color = color + ',' + col_vari.value;
                        else
                            color = color + ',' + "0";
                    }
                    else
                        color = color + ',' + col_vari.value;
                }

                if (cat1 == '') {
                    if (adcat_vari != null) {
                        if (adcat_vari.value != "")
                            cat1 = adcat_vari.value;
                        else
                            cat1 = "0";
                    }
                    else
                        cat1 = drpadcat_vari.value;
                }
                else {
                    if (adcat_vari != null) {
                        if (adcat_vari.value != "")
                            cat1 = cat1 + ',' + adcat_vari.value;
                        else
                            cat1 = cat1 + ',' + "0";
                    }
                    else
                        cat1 = cat1 + ',' + drpadcat_vari.value;
                }

                if (cat2 == '') {
                    if (cat2_vari != null) {
                        if (cat2_vari.value != '') {
                            cat2 = cat2_vari.value;
                        }
                        else {
                            cat2 = "0";
                        }
                    }
                    else {
                        if (drpadsubcat_vari.value == "") {
                            cat2 = "0";
                        }
                        else {
                            cat2 = drpadsubcat_vari.value;
                        }
                    }
                }
                else {
                    if (cat2_vari != null) {
                        if (cat2_vari.value != '') {
                            cat2 = cat2 + ',' + cat2_vari.value;
                        }
                        else {
                            cat2 = cat2 + ',' + "0";
                        }

                    }
                    else {
                        if (drpadsubcat_vari.value == "") {
                            cat2 = cat2 + ',' + "0";
                        }
                        else {
                            cat2 = cat2 + ',' + drpadsubcat_vari.value;
                        }
                    }
                }

                if (cat3 == '') {
                    if (cat3_vari != null) {
                        if (cat3_vari.value == '') {
                            cat3 = "0";
                        }
                        else {
                            cat3 = cat3_vari.value;
                        }
                    }
                    else {
                        if (drpadcat3_vari.value == "") {
                            cat3 = "0";
                        }
                        else {
                            cat3 = drpadcat3_vari.value;
                        }
                    }
                }
                else {
                    if (cat3_vari != null) {
                        if (cat3_vari.value == '') {
                            cat3 = cat3 + ',' + "0";
                        }
                        else {
                            cat3 = cat3 + ',' + cat3_vari.value;
                        }
                    }

                    else {
                        if (drpadcat3_vari.value == "") {
                            cat3 = cat3 + ',' + "0";
                        }
                        else {
                            cat3 = cat3 + ',' + drpadcat3_vari.value;
                        }
                    }
                }

                if (cat4 == '') {
                    if (cat4_vari != null) {
                        if (cat4_vari.value == "") {
                            cat4 = "0";
                        }
                        else {
                            cat4 = cat4_vari.value;
                        }
                    }

                    else {
                        if (drpadcat4_vari.value == "") {
                            cat4 = "0";
                        }
                        else {
                            cat4 = drpadcat4_vari.value;
                        }
                    }
                }
                else {
                    if (cat4_vari != null) {
                        if (cat4_vari.value == "") {
                            cat4 = cat4 + ',' + "0";
                        }
                        else {
                            cat4 = cat4 + ',' + cat4_vari.value;
                        }

                    }
                    else {
                        if (drpadcat4_vari.value == "") {
                            cat4 = cat4 + ',' + "0";
                        }
                        else {
                            cat4 = cat4 + ',' + drpadcat4_vari.value;
                        }
                    }
                }

                if (cat5 == '') {
                    if (cat5_vari != null) {
                        if (cat5_vari.value == "") {
                            cat5 = "0";
                        }
                        else {
                            cat5 = cat5_vari.value;
                        }
                    }

                    else {
                        if (drpadcat5_vari.value == "") {
                            cat5 = "0";
                        }
                        else {
                            cat5 = drpadcat5_vari.value;
                        }
                    }
                }
                else {
                    if (cat5_vari != null) {
                        if (cat5_vari.value == "") {
                            cat5 = cat5 + ',' + "0";
                        }
                        else {
                            cat5 = cat5 + ',' + cat5_vari.value;
                        }
                    }

                    else {
                        if (drpadcat5_vari.value == "") {
                            cat5 = cat5 + ',' + "0";
                        }
                        else {
                            cat5 = cat5 + ',' + drpadcat5_vari.value;
                        }
                    }
                }
                var mline;
                if (siz_vari != null)
                    mline = siz_vari.value;
                else
                    mline = totalarea_vari.value;
                if (uomdesc != "CD" && spacedisc_vari != '') {
                    mline = parseInt(mline, 10) - parseInt(spacedisc_vari, 10);
                }
                if (line == '') {
                    line = mline;
                }
                else {
                    line = line + ',' + mline;
                }

                //                if(line=='')
                //                {
                //                    if(siz_vari!=null)
                //                        line=siz_vari.value;
                //                    else
                //                        line=totalarea_vari.value;
                //                }
                //                else
                //                {
                //                    if(siz_vari!=null)
                //                        line=line + ',' + siz_vari.value;
                //                    else
                //                        line=line + ',' + totalarea_vari.value;
                //                }
                //===============Change for folloup dates============//
                var ratedate = "";
                if (text_vari.value == "" && document.getElementById('hdnfollodate').value == "Y")
                    ratedate = gfollodate;
                else
                    ratedate = text_vari.value;
                //***************//
                if (insert_date == '') {
                    insert_date = date_frmt_orcl(dateformat, ratedate); //text_vari.value);

                }
                else {
                    var datestr = date_frmt_orcl(dateformat, ratedate); //text_vari.value);
                    insert_date = insert_date + ',' + datestr;
                }
                //====Changes for Rate Revise===//
                if (document.getElementById('hdnrevise').value != "" && document.getElementById('txtrevisedate').value != "") {
                    if (ratecheck_date == '') {
                        ratecheck_date = date_frmt_orcl(dateformat, document.getElementById('txtrevisedate').value);
                    }
                    else {
                        var datestr = date_frmt_orcl(dateformat, document.getElementById('txtrevisedate').value);
                        ratecheck_date = ratecheck_date + ',' + datestr;

                    }
                }
                else {
                    if (hiddenratecheckdate_vari == 'i') {
                        if (ratecheck_date == '') {
                            ratecheck_date = date_frmt_orcl(dateformat, ratedate);
                        }
                        else {
                            var datestr = date_frmt_orcl(dateformat, ratedate);
                            ratecheck_date = ratecheck_date + ',' + datestr;

                        }
                    }
                    else {
                        if (ratecheck_date == '') {
                            ratecheck_date = date_frmt_orcl(dateformat, datetime_vari);
                            // ratecheck_date=mySqlDate(document.getElementById('txtdatetime').value);
                        }
                        else {
                            //var datestr=mySqlDate(document.getElementById('txtdatetime').value);
                            var datestr = date_frmt_orcl(dateformat, datetime_vari);
                            ratecheck_date = ratecheck_date + ',' + datestr;

                        }
                    }
                }
                if (pkg_insertion == '') {
                    if (pkgins_vari.value == "") {
                        pkg_insertion = "1";
                    }
                    else {
                        pkg_insertion = pkgins_vari.value;
                    }
                }
                else {
                    if (pkgins_vari.value == "") {
                        pkg_insertion = pkg_insertion + ',' + "0";
                    }
                    else {
                        pkg_insertion = pkg_insertion + ',' + pkgins_vari.value;
                    }
                }
                if (ad_width == '') {
                    if (wid_vari.value == '') {
                        ad_width = '0';
                    }
                    else {
                        ad_width = wid_vari.value;
                    }
                }
                else {
                    if (wid_vari.value == '') {
                        ad_width = ad_width + ',' + '0';
                    }
                    else {
                        ad_width = ad_width + ',' + wid_vari.value;
                    }
                }
                if (pkg_alias == '') {
                    pkg_alias = pkgalias_vari.value;
                }
                else {
                    pkg_alias = pkg_alias + ',' + pkgalias_vari.value;
                }

                if (pagepost == '') {
                    if (preall_vari != null && preall_vari.value == "2") {
                        pagepost = '0';
                    }
                    else {
                        if (pgpre_vari != null && pgpre_vari.value != '') {
                            pagepost = pgpre_vari.value;

                        }
                        else {
                            pagepost = '0';
                        }
                    }
                }
                else {
                    if (preall_vari != null && preall_vari.value == "2") {
                        pagepost = pagepost + ',' + '0';
                    }
                    else {
                        if (pgpre_vari != null && pgpre_vari.value != '') {
                            pagepost = pagepost + ',' + pgpre_vari.value;
                        }
                        else {
                            pagepost = pagepost + ',' + '0';
                        }
                    }
                }
                //for premium if any
                if (premiumno == '') {
                    if (prem_vari != null && prem_vari.value != '') {
                        premiumno = prem_vari.value;
                    }
                    else {
                        premiumno = '0';
                    }
                }
                else {
                    if (prem_vari != null && prem_vari.value != '') {
                        premiumno = premiumno + ',' + prem_vari.value;
                    }
                    else {
                        premiumno = premiumno + ',' + '0';
                    }
                }
                // for bold character
                if (splboldspecialsize1 == '') {
                    if (splboldsize != null) {
                        if (splboldsize.value != "")
                            splboldspecialsize1 = splboldsize.value;
                        else
                            splboldspecialsize1 = "0";
                    }
                    else
                        splboldspecialsize1 = "0";
                }
                else {
                    if (splboldsize != null) {
                        if (splboldsize.value != "")
                            splboldspecialsize1 = splboldspecialsize1 + ',' + splboldsize.value;
                        else
                            splboldspecialsize1 = splboldspecialsize1 + ',' + "0";
                    }
                    else
                        splboldspecialsize1 = splboldspecialsize1 + ',' + "0";
                }
            }
            if (document.getElementById("inssta" + k).value == 'cancel')
                cancelcount = cancelcount + 1;
            k++;
        } // end of first loop
        var resT = Classified_Booking.getPackageConsumption(pkgcode_p, pfdate, pldate, dateformat);
        if (resT.value == null) {
            alert(resT.error.description);
            return false;
        }
        if (resT.value.Tables[0].Rows.length > 0) {
            if (resT.value.Tables[0].Rows[0].MSG != 'A') {
                alert(resT.value.Tables[0].Rows[0].MSG);
                return false;
            }
        }
        newcode = editionname + "$" + pkgcode + "$" + color + "$" + cat1 + "$" + cat2 + "$" + cat3 + "$" + cat4 + "$" + cat5 + "$" + line + "$" + insert_date + "$" + ratecheck_date + "$" + pkg_insertion + "$" + ad_width + "$" + pkg_alias + "$" + pagepost + "$" + premiumno + "$" + splboldspecialsize1;
        //alert(newcode);
        cardamt = 0;
        res = Classified_Booking.get_rate(noofinsertion, dateformat, compcode, uom, adtype, currency, ratecode, clientcode, uomdesc, agencycode, newcode, center, ratepremtype, '0', schemetype_vari, fDate, lDate, parseInt(i) + 1, chkadon_var, discprem, spediscper, pospremdisc);
        cntrfill = 0;

        var ds = res.value;
        if (ds == null) {
            alert(res.error.description);
            return false;
        }
        if (ds.Tables[3].Rows.length > 0) {
            if (ds.Tables[3].Rows[0].FLOORAMT != null)
                flooramount = ds.Tables[3].Rows[0].FLOORAMT;
            if (ds.Tables[3].Rows[0].FIXED_BOOKING != null)
                fixed_booking = ds.Tables[3].Rows[0].FIXED_BOOKING;
            // new change
            document.getElementById('txttradedisc').value = ds.Tables[3].Rows[0].COMM_RATE;
            document.getElementById('txttd').value = ds.Tables[3].Rows[0].COMM_RATE;
            if (ds.Tables[3].Rows[0].Addl_Comm_Rate != null && document.getElementById('txtaddagencycommrate') != null)
                document.getElementById('txtaddagencycommrate').value = ds.Tables[3].Rows[0].Addl_Comm_Rate;
            document.getElementById('hiddentradedisc').value = document.getElementById('txttradedisc').value;


            if (ds.Tables[3].Rows[0].CASH_DISCOUNT != null)
                document.getElementById('txtcashdiscount').value = ds.Tables[3].Rows[0].CASH_DISCOUNT;


            if (ds.Tables[3].Rows[0].CASH_DISCOUNTTYPE != null)
                document.getElementById('hiddencashdiscper').value = ds.Tables[3].Rows[0].CASH_DISCOUNTTYPE;

            document.getElementById('hiddenagcommflag').value = ds.Tables[3].Rows[0].FLAG;
            // end       
        }
        if (ds.Tables[1].Rows.length > 0) {
            if (ds.Tables[1].Rows[0].CANCELLATION_CHARGES != null)
                canclecharge = ds.Tables[1].Rows[0].CANCELLATION_CHARGES;
        }
        var scpkg = "";
        schemecountNumber = 0;
        if (cancelcount == gridItemCount)
            freeIns = "Y";
        for (var t1 = 0; t1 < ds.Tables[2].Rows.length; t1++) {

            if (ds.Tables[2].Rows[t1].PKG_CODE != scpkg && freeIns != "Y") {
                scpkg = ds.Tables[2].Rows[t1].PKG_CODE;
                schemecountNumber = parseInt(schemecountNumber, 10) + 1;
            }
        }
        var schemeCount = 0;

        var chkscheme_Type = 0;
        var gridItemTotal = 0;
        for (; cntrfill < parseInt(gridItemCount); cntrfill++) {

            var pkgcode = document.getElementById("hiddenpckcode" + counter);
            if (pkgcode == null)
                break;

            var msg = "";
            if (ds.Tables[0].Rows.length > 0) {
                msg = ds.Tables[0].Rows[0].MESSAGE;
            }
            if (msg.indexOf('Consumption') >= 0)
                alert(msg);
            if (ds.Tables[0].Rows.length <= 0 || (ds.Tables[0].Rows.length > 0 && msg.indexOf('Consumption') >= 0)) {
                var par1;
                cardid = document.getElementById("card" + counter);
                par1 = (cardid.parentNode).parentNode;
                if (browser != "Microsoft Internet Explorer") {
                    solo = document.getElementById("sol" + counter);
                    gross = document.getElementById("gro" + counter);
                    var billrate = document.getElementById("ba" + counter);
                    var paidno = document.getElementById("pai" + counter);
                    var agrred = document.getElementById("agr" + counter);
                    var insertsta = document.getElementById("inssta" + counter); //"inssta"+counter;    
                    var eyecatchRate = 0;
                    var pkgalias = document.getElementById("pkg_alias" + counter);
                    var editioncomp = document.getElementById("edit" + counter);
                    var boxc = document.getElementById("boxc" + counter);
                    var vat_inc = document.getElementById("vat_inc" + counter);
                }
                else {
                    solo = par1.all["sol" + counter];
                    gross = par1.all["gro" + counter];
                    var paidno = par1.all["pai" + counter];
                    var billrate = par1.all["ba" + counter];
                    var agrred = par1.all["agr" + counter];
                    var insertsta = par1.all["inssta" + counter]; //"inssta"+counter;    
                    var eyecatchRate = 0;
                    var pkgalias = par1.all["pkg_alias" + counter];
                    var editioncomp = par1.all["edit" + counter];
                    var boxc = par1.all["boxc" + counter];
                    var vat_inc = par1.all["vat_inc" + counter];
                }
                if (paidno != null && paidno.value == "NP") {
                    nprint_flag = true;
                }
                if (document.getElementById('txtratecode').disabled == false)
                    document.getElementById('coupan' + counter).value = "";
                // NEW CHANGE 19 NOV 09
                schemeCount = 0;
                bill_comp_amt = "";
                if (insertsta.value == "billed" && document.getElementById('hiddensupplimentflag').value == "")
                    bill_comp_amt = cardid.value;
                if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                    vat_inc.value = ds.Tables[1].Rows[cntrfill].VAT_INC;
                    agrred.value = "";
                }
                if (ds.Tables[2].Rows.length > 0 && agreedamt_vari.value != '' && agreedamt_vari.value != '0' && document.getElementById('txtflatfreqdisc').value == "" && agreedamt_active != " 1" && agreedrate_active != "1") {
                    for (var t = 0; t < ds.Tables[2].Rows.length; t++) {
                        if (ds.Tables[2].Rows[t].PKG_CODE == ds.Tables[1].Rows[cntrfill].PCODE) {
                            schemeCount = parseInt(schemeCount) + parseInt(ds.Tables[2].Rows[t].TO_INS) - parseInt(ds.Tables[2].Rows[t].FROM_INSERT) + 1;
                            scheme_var = ds.Tables[2].Rows[t].SCHEMENAME;
                            schemeid = ds.Tables[2].Rows[t].SCHEMEID;
                        }
                    }
                }
                if (pkgcode.value == ds.Tables[1].Rows[cntrfill].PCODE && LTrim(RTrim(pkgalias.value)) == LTrim(RTrim(ds.Tables[1].Rows[cntrfill].PKG_ALIAS))) {
                    var scheme = "";
                    var edicount = cntrfill;
                    //  if((agreedrate_vari.value== '' || agreedrate_vari.value== '0') && (agreedamt_vari.value=='' || agreedamt_vari.value=='0') && chkscheme_Type==0)
                    // {        //----3-----------
                    chkscheme_Type = 1;
                    if (document.getElementById('txtflatfreqdisc').value == "" && agreedamt_active != " 1" && agreedrate_active != "1") {
                        for (var scicount = 0; scicount < ds.Tables[2].Rows.length; scicount++) {       //----4-----------
                            var edipac = '';
                            if (ds.Tables[2].Rows[scicount].VAL == 'P')
                                edipac = pkgcode.value;
                            else
                                edipac = editioncomp.value;
                            if (edipac == ds.Tables[2].Rows[scicount].PKG_CODE && (parseInt(i) + 1 >= ds.Tables[2].Rows[scicount].FROM_INSERT && parseInt(i) + 1 <= ds.Tables[2].Rows[scicount].TO_INS) && paidno.value != "P") {           //----5-----------
                                chkscheme_Type = 0;
                                if (uomdesc == 'CD') {
                                    if (document.getElementById('hiddensavemod').value == "01" && (agreedrate_active == "1" || agreedamt_active == "1") && document.getElementById('drpbillcycle').disabled == false)
                                        cardid.value = cardid.value;
                                    else
                                        cardid.value = ds.Tables[1].Rows[edicount].EXTRARATE;
                                    solo.value = ds.Tables[1].Rows[edicount].SOLORATE;
                                }
                                else {
                                    if (document.getElementById('hiddensavemod').value == "01" && (agreedrate_active == "1" || agreedamt_active == "1") && document.getElementById('drpbillcycle').disabled == false)
                                        cardid.value = cardid.value;
                                    else
                                        cardid.value = ds.Tables[1].Rows[edicount].CARDRATE;
                                    solo.value = ds.Tables[1].Rows[edicount].SOLORATE;
                                }
                                if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                                    agrred.value = "";
                                var gridgross = "";
                                if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                                    gross.value = ds.Tables[1].Rows[edicount].FCARDRATE;
                                gridgross = gross.value;
                                // cardamt=parseFloat(cardamt) + parseFloat(ds.Tables[1].Rows[edicount].FCARDRATE);
                                cardamt = parseFloat(cardamt) + parseFloat(ds.Tables[1].Rows[edicount].FEXTRARATE) + parseFloat(ds.Tables[1].Rows[edicount].CARDRATE);
                                if ((cardid.value == "0" || cardid.value == "") && cardamt != "" && uomdesc == 'CD') {
                                    if (document.getElementById('hiddensavemod').value == "01" && (agreedrate_active == "1" || agreedamt_active == "1") && document.getElementById('drpbillcycle').disabled == false)
                                        cardid.value = cardid.value;
                                    else
                                        cardid.value = parseFloat(cardamt) / parseFloat(totalarea_vari.value);
                                    if (document.getElementById('hiddensavemod').value == "01" && (agreedrate_active == "1" || agreedamt_active == "1") && document.getElementById('drpbillcycle').disabled == false)
                                        cardid.value = cardid.value;
                                    else
                                        cardid.value = parseFloat(cardid.value).toFixed(2);
                                }


                                // for insertion wise box charges
                                //                                        if(boxchargeInsertionwise=='yes')
                                //                                        {
                                //                                            if(hiddenbox_vari.value=='2')
                                //                                            {
                                //                                                boxcharge=(parseFloat(gridgross) * parseFloat(boxcharge))/100;
                                //                                            }
                                //                                            grossamtfinal=parseFloat(grossamtfinal) + parseFloat(boxcharge);
                                //                                            if(insertsta.value!="billed")
                                //                                            {
                                //                                                gross.value = parseFloat(gross.value) + parseFloat(boxcharge);
                                //                                                boxc.value=boxcharge;
                                //                                             }   
                                //                                        }
                                gridgross = gross.value;
                                var dname = getdayFromDate(dateformat, document.getElementById("Text" + counter).value);
                                var chkb = "Y";
                                if (dname == "Sunday" && ds.Tables[2].Rows[scicount].sun != null)
                                    chkb = ds.Tables[2].Rows[scicount].sun;
                                else if (dname == "Monday" && ds.Tables[2].Rows[scicount].mon != null)
                                    chkb = ds.Tables[2].Rows[scicount].mon;
                                else if (dname == "Tuesday" && ds.Tables[2].Rows[scicount].tue != null)
                                    chkb = ds.Tables[2].Rows[scicount].tue;
                                else if (dname == "Wednesday" && ds.Tables[2].Rows[scicount].wed != null)
                                    chkb = ds.Tables[2].Rows[scicount].wed;
                                else if (dname == "Thursday" && ds.Tables[2].Rows[scicount].thu != null)
                                    chkb = ds.Tables[2].Rows[scicount].thu;
                                else if (dname == "Friday" && ds.Tables[2].Rows[scicount].fri != null)
                                    chkb = ds.Tables[2].Rows[scicount].fri;
                                else if (dname == "Saturday" && ds.Tables[2].Rows[scicount].sat != null)
                                    chkb = ds.Tables[2].Rows[scicount].sat;
                                if (chkb == "Y") {
                                    if (ds.Tables[2].Rows[scicount].TYPE == "per") {
                                        if (hidschememin_vari == "Y" && ds.Tables[1].Rows[edicount].MINWORD != null && parseInt(document.getElementById('siz' + counter).value) > parseInt(ds.Tables[1].Rows[edicount].MINWORD)) {
                                            var exrate = ds.Tables[1].Rows[edicount].FEXTRARATE;
                                            gridgross = parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) - (parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) * parseFloat(ds.Tables[2].Rows[scicount].AMT) / 100);
                                            gridgross = parseFloat(gridgross) + parseFloat(exrate);
                                        }
                                        else {
                                            gridgross = parseFloat(gridgross) - (parseFloat(gridgross) * parseFloat(ds.Tables[2].Rows[scicount].AMT) / 100);
                                        }
                                        if (parseInt(gridgross) == 0) {
                                            freeIns = "Y";
                                            freeIns_S = "Y";
                                        }
                                        grossamtfinal = parseFloat(grossamtfinal) + parseFloat(gridgross); //+gridgross;
                                        //agreed rate
                                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                                            gross.value = gridgross.toFixed(4);
                                    }
                                    else if (ds.Tables[2].Rows[scicount].TYPE == "fixed") {
                                        var schratio = 0;
                                        if (gridItemTotal == 0) {
                                            for (var f = 0; f < ds.Tables[1].Rows.length; f++) {
                                                gridItemTotal = gridItemTotal + ds.Tables[1].Rows[f].FCARDRATE;
                                            }

                                        }
                                        schratio = (parseFloat(ds.Tables[2].Rows[scicount].AMT) / parseFloat(gridItemTotal)) * parseFloat(ds.Tables[1].Rows[edicount].FCARDRATE);
                                        if (insertsta.value == 'cancel' || paidno.value == "N") {
                                            schratio = 0;
                                        }
                                        // grossamtfinal = parseFloat(grossamtfinal) + (parseFloat(gridgross) - (parseFloat(ds.Tables[2].Rows[scicount].AMT) / parseInt(gridItemCount)));
                                        grossamtfinal = parseFloat(grossamtfinal) + (parseFloat(gridgross) - (parseFloat(schratio)));
                                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {

                                            if (t == "D") {
                                                if (ds.Tables[1].Rows[edicount].PREM1 == null)
                                                    ds.Tables[1].Rows[edicount].PREM1 = "0";
                                                if (ds.Tables[1].Rows[edicount].PREM2 == null)
                                                    ds.Tables[1].Rows[edicount].PREM2 = "0";
                                                if (hidschememin_vari == "Y" && ds.Tables[1].Rows[edicount].MINWORD != null && parseInt(document.getElementById('siz' + counter).value) > parseInt(ds.Tables[1].Rows[edicount].MINWORD)) {
                                                    var exrate = ds.Tables[1].Rows[edicount].FEXTRARATE;
                                                    //  gross.value = parseFloat(gridgross) - (parseFloat(ds.Tables[2].Rows[scicount].AMT) / parseInt(gridItemCount));
                                                    // gridgross=parseFloat(gridgross) + parseFloat(exrate);
                                                    //
                                                    gridgross = parseFloat(gridgross) + parseFloat(exrate);
                                                    var newrate = parseFloat(gridgross) - (parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) * parseFloat(ds.Tables[1].Rows[edicount].PREM1) / 100);
                                                    newrate = parseFloat(newrate) - (parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                                    gross.value = parseFloat(newrate) - (parseFloat(schratio));
                                                    gross.value = parseFloat(gross.value) + (parseFloat(gross.value) * parseFloat(ds.Tables[1].Rows[edicount].PREM1) / 100) + (parseFloat(gross.value) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);

                                                }
                                                else {
                                                    // gross.value = parseFloat(gridgross) - (parseFloat(ds.Tables[2].Rows[scicount].AMT) / parseInt(gridItemCount));
                                                    var tr = parseFloat(ds.Tables[1].Rows[edicount].CARDRATE);
                                                    if (ds.Tables[1].Rows[edicount].FEXTRARATE != null && ds.Tables[1].Rows[edicount].FEXTRARATE != "null") {
                                                        tr = parseFloat(tr) + parseFloat(ds.Tables[1].Rows[edicount].FEXTRARATE);
                                                    }
                                                    var newrate = parseFloat(gridgross) - (parseFloat(tr) * parseFloat(ds.Tables[1].Rows[edicount].PREM1) / 100);
                                                    newrate = parseFloat(newrate) - (parseFloat(tr) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                                    gross.value = parseFloat(newrate) - (parseFloat(schratio));
                                                    gross.value = parseFloat(gross.value) + (parseFloat(gross.value) * parseFloat(ds.Tables[1].Rows[edicount].PREM1) / 100) + (parseFloat(gross.value) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                                }
                                            }
                                            else {
                                                if (hidschememin_vari == "Y" && ds.Tables[1].Rows[edicount].MINWORD != null && parseInt(document.getElementById('siz' + counter).value) > parseInt(ds.Tables[1].Rows[edicount].MINWORD)) {
                                                    var exrate = ds.Tables[1].Rows[edicount].FEXTRARATE;
                                                    gross.value = parseFloat(gridgross) - (parseFloat(schratio));
                                                    gridgross = parseFloat(gridgross) + parseFloat(exrate);
                                                }
                                                else {
                                                    gross.value = parseFloat(gridgross) - (parseFloat(schratio));
                                                }
                                            }
                                        }
                                    }
                                    else {
                                        gross.value = ds.Tables[2].Rows[scicount].AMT;
                                        grossamtfinal = parseFloat(grossamtfinal) + parseFloat(gross.value);
                                    }
                                    if (paidno != null && ds.Tables[2].Rows[scicount].TYPE == "per" && ds.Tables[2].Rows[scicount].AMT == "100") {
                                        if (paidno.value != "P")
                                            paidno.value = 'N';
                                    }
                                    else if (paidno != null) {
                                        paidno.value = 'Y';
                                    }
                                    scheme_var_id.value = ds.Tables[2].Rows[scicount].SCHEMENAME;
                                    schemeid = ds.Tables[2].Rows[scicount].SCHEMEID;
                                    scheme = 'Y';
                                    edicount = gridItemCount;
                                }
                                if (bullet_var != null && bullet_var.value != '0') {
                                    if (eyecatchtype != 'S') {
                                        if (eyecatchtype == 'P') {
                                            if (bPrem.indexOf('%') > 0)
                                                bPrem = bPrem.split('%')[0];
                                            eyecatchRate = (parseFloat(gridgross) * parseFloat(bPrem)) / 100;
                                            if (t == "D") {
                                                if (ds.Tables[1].Rows[edicount].PREM1 == null)
                                                    ds.Tables[1].Rows[edicount].PREM1 = "0";
                                                if (ds.Tables[1].Rows[edicount].PREM2 == null)
                                                    ds.Tables[1].Rows[edicount].PREM2 = "0";
                                                var x = (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM1)) / 100;
                                                x = parseFloat(x) + (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                                eyecatchRate = parseFloat(eyecatchRate) + parseFloat(x);

                                            }

                                            if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                                                gross.value = parseFloat(gross.value) + parseFloat(eyecatchRate);
                                                grossamtfinal = parseFloat(grossamtfinal) + parseFloat(eyecatchRate);
                                            }
                                        }
                                        else if (eyecatchtype == 'F') {
                                            if (bPrem.indexOf('%') > 0)
                                                bPrem = bPrem.split('%')[0];
                                            eyecatchRate = parseFloat(bPrem); //parseFloat(grossamtfinal) + parseFloat(bPrem);
                                            if (t == "D") {
                                                if (ds.Tables[1].Rows[edicount].PREM1 == null)
                                                    ds.Tables[1].Rows[edicount].PREM1 = "0";
                                                if (ds.Tables[1].Rows[edicount].PREM2 == null)
                                                    ds.Tables[1].Rows[edicount].PREM2 = "0";
                                                var x = (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM1)) / 100;
                                                x = parseFloat(x) + (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM2)) / 100;
                                                eyecatchRate = parseFloat(eyecatchRate) + parseFloat(x);

                                            }

                                            if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                                                gross.value = parseFloat(gross.value) + (parseFloat(eyecatchRate) / parseInt(gridItemCount));
                                                grossamtfinal = parseFloat(grossamtfinal) + (parseFloat(eyecatchRate) / parseInt(gridItemCount));
                                            }
                                        }
                                    }
                                }
                                //                            scheme_var_id.value = ds.Tables[2].Rows[scicount].SCHEMENAME;
                                //                            schemeid = ds.Tables[2].Rows[scicount].SCHEMEID;
                                //                            if (paidno != null && ds.Tables[2].Rows[scicount].TYPE == "per" && ds.Tables[2].Rows[scicount].AMT == "100") {
                                //                                if (paidno.value != "P")
                                //                                    paidno.value = 'N';
                                //                            }
                                //                            else if (paidno != null) {
                                //                                paidno.value = 'Y';
                                //                            }
                                //                            scheme = 'Y';
                                //                            edicount = gridItemCount;
                                if (i == 0) {
                                    if (uomdesc == 'CD') {
                                        //  cardrate=parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].EXTRARATE);
                                        if (ds.Tables[1].Rows[cntrfill].EXTRARATE != "0" && ds.Tables[1].Rows[cntrfill].EXTRARATE != "")
                                            cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].EXTRARATE);
                                        else
                                            cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].CARDRATE) / parseFloat(totalarea_vari.value);
                                    }
                                    else {
                                        cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].CARDRATE);
                                    }
                                }
                                break;
                            }  //----5-----------

                        }    //----4-----------   
                    }  // }     //----3-----------  
                    if (scheme == '') {
                        if (uomdesc == 'CD') {
                            if (document.getElementById('hiddensavemod').value == "01" && (agreedrate_active == "1" || agreedamt_active == "1") && document.getElementById('drpbillcycle').disabled == false)
                                cardid.value = cardid.value;
                            if (cardid.value == "" || cardid.value == "null") {
                                cardid.value = ds.Tables[1].Rows[cntrfill].EXTRARATE;
                            }
                            else
                                cardid.value = ds.Tables[1].Rows[cntrfill].EXTRARATE;
                            solo.value = ds.Tables[1].Rows[cntrfill].SOLORATE;
                        }
                        else {
                            if (document.getElementById('hiddensavemod').value == "01" && (agreedrate_active == "1" || agreedamt_active == "1") && document.getElementById('drpbillcycle').disabled == false)
                                cardid.value = cardid.value;
                                if (cardid.value == "" || cardid.value == "null") {
                                    cardid.value = ds.Tables[1].Rows[cntrfill].CARDRATE;
                                }
                            else
                                cardid.value = ds.Tables[1].Rows[cntrfill].CARDRATE;
                            solo.value = ds.Tables[1].Rows[cntrfill].SOLORATE;
                        }
                        var gridgross = 0;
                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                            gross.value = ds.Tables[1].Rows[edicount].FCARDRATE;
                        gridgross = gross.value;
                        // cardamt=parseFloat(cardamt) + parseFloat(ds.Tables[1].Rows[cntrfill].FCARDRATE);
                        cardamt = parseFloat(cardamt) + parseFloat(ds.Tables[1].Rows[cntrfill].FEXTRARATE) + parseFloat(ds.Tables[1].Rows[cntrfill].CARDRATE);
                        if ((cardid.value == "0" || cardid.value == "") && cardamt != "" && uomdesc == 'CD') {
                            if (document.getElementById('hiddensavemod').value == "01" && (agreedrate_active == "1" || agreedamt_active == "1") && document.getElementById('drpbillcycle').disabled == false)
                                cardid.value = cardid.value;
                            else
                                cardid.value = parseFloat(cardamt) / parseFloat(totalarea_vari.value);
                            if (document.getElementById('hiddensavemod').value == "01" && (agreedrate_active == "1" || agreedamt_active == "1") && document.getElementById('drpbillcycle').disabled == false)
                                cardid.value = cardid.value;
                            else
                                cardid.value = parseFloat(cardid.value).toFixed(2);
                        }
                        if ((agreedrate_vari.value != '' && agreedrate_vari.value != '0') && (agreedamt_vari.value != '' && agreedamt_vari.value != '0')) {
                            if (agreedrate_active == 0 && agreedamt_active == 0) {
                                agreedamt_active = 1;
                                flag_agreed = 2;
                            }
                        }
                        if (agreedrate_active == 1 || agreedamt_active == 1) {
                            var rowcountNum = rowcount;
                            if (schemeCount > 0) {
                                rowcountNum = parseInt(rowcount) - (parseInt(schemeCount) * parseInt(gridItemCount));
                                if (flag_agreed != 2)
                                    flag_agreed = 1;
                            }
                            //////                                    if(flag_agreed==1) 
                            //////                                    {
                            //////                                        var num=(parseFloat(parseFloat(agreedamt_vari.value) / parseInt(finsert))).toFixed(2);
                            //////                                        agreedamt_vari.value=parseFloat(agreedamt_vari.value) - (parseFloat(num) * parseFloat(schemeCount));
                            //////                                        flag_agreed=2;
                            //////                                    }
                            if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                                agrred.value = (parseFloat(parseFloat(agreedamt_vari.value) / parseInt(rowcountNum))).toFixed(2);
                            /*   if(counter==parseInt(rowcount) - 1)
                            {
                            if(insertsta.value!="billed")
                            agrred.value = (parseFloat(agreedamt_vari.value) - parseFloat(grossamtfinalAgreed)).toFixed(2) ;
                            }*/
                            // for applying scheme in Agreed Amount
                            // 25 june 2010
                            //////                                   if(schemeCount>0)
                            //////                                   {
                            //////                                        // if(pkgcode.value==ds.Tables[2].Rows[0].PKG_CODE && (parseInt(i)+1>=ds.Tables[2].Rows[0].FROM_INSERT && parseInt(i)+1<=ds.Tables[2].Rows[0].TO_INS))
                            //////                                        var diffcount=parseInt(finsert) - parseInt(schemeCount);
                            //////                                      //   if(pkgcode.value==ds.Tables[2].Rows[0].PKG_CODE && (parseInt(i)+1>parseInt(diffcount)))
                            //////                                        if((parseInt(i)+1>parseInt(diffcount)))
                            //////                                        { 
                            //////                                                 freeIns="Y";
                            //////                                                 gross.value =0;
                            //////                                                 paidno.value='N';
                            //////                                                 //  scheme_var.value=ds.Tables[2].Rows[0].SCHEMENAME;
                            //////                                        }   
                            //////                                        else
                            //////                                        {
                            //////                                             gross.value = (parseFloat(agrred.value)).toFixed(2);
                            //////                                        }     
                            //////                                   }
                            //////                                   else
                            //////                                   {
                            //////                                    gross.value = (parseFloat(agrred.value)).toFixed(2);
                            //////                                   } 
                            if (insertsta.value == 'cancel' || paidno.value == "N") {
                                agreedcancelAmt = parseFloat(agreedcancelAmt) + parseFloat(agrred.value);
                                // freeIns="Y";
                                if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                                    gross.value = 0;
                                paidno.value = 'N';
                                grossamtfinalAgreed = parseFloat(grossamtfinalAgreed) + parseFloat(agrred.value);
                            }


                            if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                                gross.value = parseFloat(gross.value).toFixed(4);
                            gridgross = gross.value;

                            //////  END

                            edicount = gridItemCount;  //by nand on 2 oct
                            if (i == 0) {
                                if (uomdesc == 'CD') {
                                    //  cardrate=parseFloat(cardrate) + ds.Tables[1].Rows[cntrfill].EXTRARATE;
                                    if (ds.Tables[1].Rows[cntrfill].EXTRARATE != "0" && ds.Tables[1].Rows[cntrfill].EXTRARATE != "")
                                        cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].EXTRARATE);
                                    else
                                        cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].CARDRATE) / parseFloat(totalarea_vari.value);
                                }
                                else {
                                    cardrate = parseFloat(cardrate) + ds.Tables[1].Rows[cntrfill].CARDRATE;
                                }
                            }
                            var grossValue = parseFloat(gross.value);
                            grossamtfinal = parseFloat(grossamtfinal) + parseFloat(gridgross);
                            grossamtfinalAgreed = parseFloat(grossamtfinalAgreed) + parseFloat(gridgross);
                            // for box charges in agreed amount
                            if (paidno.value == "N" || insertsta.value == 'cancel')
                                boxcharge = "0";
                            //                                      if(boxchargeInsertionwise=='yes' && paidno.value!='N')
                            //                                    {
                            //                                        var tboxcharge=0;
                            //                                           tboxcharge=boxcharge;
                            //                                        if(hiddenbox_vari.value=='2')
                            //                                        {
                            //                                             tboxcharge=(parseFloat(gridgross) * parseFloat(boxcharge))/100;
                            //                                        }  
                            //                                         tboxcharge=parseFloat(tboxcharge) / parseFloat(gridItemCount);
                            //                                          boxc.value=tboxcharge;
                            //                                        grossamtfinal=parseFloat(grossamtfinal) + parseFloat(tboxcharge);
                            //                                        if(insertsta.value!="billed")
                            //                                        gross.value = parseFloat(gross.value) + parseFloat(tboxcharge);
                            //                                    }
                            //                                    else{
                            //                                    boxc.value="";
                            //                                    }
                        }
                        else {
                            if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                                gross.value = ds.Tables[1].Rows[cntrfill].FCARDRATE;
                            gridgross = gross.value;
                            grossamtfinal = parseFloat(grossamtfinal) + parseFloat(gridgross);
                            if (bullet_var != null && bullet_var.value != '0') {
                                if (eyecatchtype != 'S') {
                                    if (eyecatchtype == 'P') {
                                        if (bPrem.indexOf('%') > 0)
                                            bPrem = bPrem.split('%')[0];
                                        eyecatchRate = (parseFloat(gridgross) * parseFloat(bPrem)) / 100;
                                        if (t == "D") {
                                            if (ds.Tables[1].Rows[edicount].PREM1 == null)
                                                ds.Tables[1].Rows[edicount].PREM1 = "0";
                                            if (ds.Tables[1].Rows[edicount].PREM2 == null)
                                                ds.Tables[1].Rows[edicount].PREM2 = "0";
                                            var x = (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM1)) / 100;
                                            x = parseFloat(x) + (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                            eyecatchRate = parseFloat(eyecatchRate) + parseFloat(x);

                                        }

                                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                                            gross.value = parseFloat(gross.value) + parseFloat(eyecatchRate);
                                            grossamtfinal = parseFloat(grossamtfinal) + parseFloat(eyecatchRate);
                                        }
                                    }
                                    else if (eyecatchtype == 'F') {
                                        if (bPrem.indexOf('%') > 0)
                                            bPrem = bPrem.split('%')[0];
                                        eyecatchRate = parseFloat(bPrem); //parseFloat(grossamtfinal) + parseFloat(bPrem);
                                        if (t == "D") {
                                            if (ds.Tables[1].Rows[edicount].PREM1 == null)
                                                ds.Tables[1].Rows[edicount].PREM1 = "0";
                                            if (ds.Tables[1].Rows[edicount].PREM2 == null)
                                                ds.Tables[1].Rows[edicount].PREM2 = "0";
                                            var x = (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM1)) / 100;
                                            x = parseFloat(x) + (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM2)) / 100;
                                            eyecatchRate = parseFloat(eyecatchRate) + parseFloat(x);

                                        }

                                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                                            gross.value = parseFloat(gross.value) + (parseFloat(eyecatchRate) / parseInt(gridItemCount));
                                            grossamtfinal = parseFloat(grossamtfinal) + (parseFloat(eyecatchRate) / parseInt(gridItemCount));
                                        }
                                    }
                                }
                            }
                            // for insertion wise Box Charges 
                            //                                    if(boxchargeInsertionwise=='yes')
                            //                                    {
                            //                                        var tboxcharge=0;
                            //                                           tboxcharge=boxcharge;
                            //                                        if(hiddenbox_vari.value=='2')
                            //                                        {
                            //                                             tboxcharge=(parseFloat(gridgross) * parseFloat(boxcharge))/100;
                            //                                        }  
                            //                                         tboxcharge=parseFloat(tboxcharge) / parseFloat(gridItemCount);
                            //                                          boxc.value=tboxcharge;
                            //                                        grossamtfinal=parseFloat(grossamtfinal) + parseFloat(tboxcharge);
                            //                                        if(insertsta.value!="billed")
                            //                                        gross.value = parseFloat(gross.value) + parseFloat(tboxcharge);
                            //                                    }

                            edicount = gridItemCount;
                            if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                                agrred.value = "";
                            if (i == 0) {
                                if (uomdesc == 'CD') {
                                    // cardrate=parseFloat(cardrate) + ds.Tables[1].Rows[cntrfill].EXTRARATE;
                                    if (ds.Tables[1].Rows[cntrfill].EXTRARATE != "0" && ds.Tables[1].Rows[cntrfill].EXTRARATE != "")
                                        cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].EXTRARATE);
                                    else
                                        cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].CARDRATE) / parseFloat(totalarea_vari.value);
                                }
                                else {
                                    cardrate = parseFloat(cardrate) + ds.Tables[1].Rows[cntrfill].CARDRATE;
                                }
                            }
                            var grossValue = parseFloat(gross.value);
                            if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                                gross.value = grossValue.toFixed(4);
                            // break;
                        }
                    }
                    if (insertsta.value == 'cancel' || paidno.value == "N") {
                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                            if (hidschememin_vari != "Y" || insertsta.value == 'cancel') {
                                if (ds.Tables[1].Rows[cntrfill].CANCELLATION_CHARGES != null && ds.Tables[1].Rows[cntrfill].CANCELLATION_CHARGES != "0" && document.getElementById('chkcanclecharges').checked == true) {
                                    gross.value = parseFloat(gross.value) * parseFloat(ds.Tables[1].Rows[cntrfill].CANCELLATION_CHARGES) / 100;
                                }
                                else {
                                    gross.value = 0;
                                }
                            }
                        }
                        //freeIns="Y";
                        if (boxchargeInsertionwise == 'yes') {
                            grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(gridgross) + parseFloat(eyecatchRate) + parseFloat(boxcharge));
                        }
                        else {
                            grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(gridgross) + parseFloat(eyecatchRate));
                        }
                        // var paidno= "pai"+counter;
                        if (paidno != null) {
                            paidno.value = 'N';
                        }
                    }
                    else if (paidno != null) {
                        if (paidno.value == 'N') {
                            gross.value = 0;
                            if (boxchargeInsertionwise == 'yes') {
                                grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(gridgross) + parseFloat(eyecatchRate) + parseFloat(boxcharge));
                            }
                            else {
                                grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(gridgross) + parseFloat(eyecatchRate));
                            }
                        }
                    }
                    // 25 june10
                    if (paidno.value != 'N')
                        cardrateSum = parseFloat(cardrateSum) + parseFloat(cardid.value);
                    else if (insertsta.value == 'cancel')
                        cardrateSum = parseFloat(cardrateSum) + parseFloat(cardid.value);

                    if (billrate != null) {
                        //                                    var tradisc=document.getElementById('txttradedisc').value;
                        //                                    if(document.getElementById('chktrade').checked==false)
                        //                                        tradisc=0;
                        //                                    if(tradisc=="")
                        //                                        tradisc=0;
                        //                                    var trdisc1=tradisc;
                        //                                    var addcomm =0;
                        //                                    if(document.getElementById('txtaddagencycommrate')!=null)
                        //                                    {
                        //                                        if(document.getElementById('hiddenagcommflag').value!="1")
                        //                                            addcomm=document.getElementById('txtaddagencycommrate').value;
                        //                                    }
                        //                                    if(addcomm=="")
                        //                                    {
                        //                                        addcomm="0";
                        //                                    }
                        //                                    if(addcomm!="0")
                        //                                    {
                        //                                        trdisc1=parseFloat(tradisc) + parseFloat(addcomm);
                        //                                    }
                        var billamt = 0;
                        if (agncomm_seq_com_vari != "S")
                            billamt = parseFloat(gross.value) - (parseFloat(gross.value) * parseFloat(trdisc1) / 100);
                        else {
                            billamt = parseFloat(gross.value) - parseFloat(gross.value) * parseFloat(tradisc) / 100;
                            if (addcomm != "0" && addcomm != "") {
                                billamt = parseFloat(billamt) - parseFloat(billamt) * parseFloat(addcomm) / 100;
                            }
                        }
                        //   var billamt=parseFloat(gross.value) - (parseFloat(gross.value) * parseFloat(trdisc1)/100);
                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                            billrate.value = billamt.toFixed(2);
                        if (billrate.value != "" && counter != parseInt(rowcount) - 1) {
                            billamount = parseFloat(billamount) + parseFloat(billrate.value);
                        }
                        if (drpbooktype_vari == "2" || drpbooktype_vari == "6" || drpbooktype_vari == "4" || drpbooktype_vari == "5") {
                            if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                                billrate.value = 0;
                        }
                    }
                    if (bill_comp_amt != "" && parseFloat(cardid.value) != parseFloat(bill_comp_amt)) {
                        alert("Amount Not Match");
                        if (document.getElementById('hiddensavemod').value == "01" && (agreedrate_active == "1" || agreedamt_active == "1") && document.getElementById('drpbillcycle').disabled == false)
                            cardid.value = cardid.value;
                        else
                            cardid.value = bill_comp_amt;
                        return false;
                    }
                    counter++;

                }
                else {
                    for (var edicount = 0; edicount < parseInt(gridItemCount); edicount++) {               //----1-----------

                        if (pkgcode.value == ds.Tables[1].Rows[edicount].PCODE && LTrim(RTrim(pkgalias.value)) == LTrim(RTrim(ds.Tables[1].Rows[edicount].PKG_ALIAS))) {           //----2-----------
                            var scheme = "";
                            //  if((agreedrate_vari.value== '' || agreedrate_vari.value== '0') && (agreedamt_vari.value=='' || agreedamt_vari.value=='0'))
                            //  {        //----3-----------
                            if (document.getElementById('txtflatfreqdisc').value == "" && agreedamt_active != " 1" && agreedrate_active != "1") {
                                for (var scicount = 0; scicount < ds.Tables[2].Rows.length; scicount++) {       //----4-----------
                                    var edipac = '';
                                    if (ds.Tables[2].Rows[scicount].VAL == 'P')
                                        edipac = pkgcode.value;
                                    else
                                        edipac = editioncomp.value;
                                    if (edipac == ds.Tables[2].Rows[scicount].PKG_CODE && (parseInt(i) + 1 >= ds.Tables[2].Rows[scicount].FROM_INSERT && parseInt(i) + 1 <= ds.Tables[2].Rows[scicount].TO_INS) && paidno.value != "P") {           //----5-----------
                                        if (uomdesc == 'CD') {
                                            if (document.getElementById('hiddensavemod').value == "01" && (agreedrate_active == "1" || agreedamt_active == "1") && document.getElementById('drpbillcycle').disabled == false)
                                                cardid.value = cardid.value;
                                            else
                                                cardid.value = ds.Tables[1].Rows[edicount].EXTRARATE;
                                            solo.value = ds.Tables[1].Rows[edicount].SOLORATE;
                                        }
                                        else {
                                            if (document.getElementById('hiddensavemod').value == "01" && (agreedrate_active == "1" || agreedamt_active == "1") && document.getElementById('drpbillcycle').disabled == false)
                                                cardid.value = cardid.value;
                                            else
                                                cardid.value = ds.Tables[1].Rows[edicount].CARDRATE;
                                            solo.value = ds.Tables[1].Rows[edicount].SOLORATE;
                                        }
                                        var gridgross = "";
                                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                                            agrred.value = "";
                                            gross.value = ds.Tables[1].Rows[edicount].FCARDRATE;
                                        }
                                        gridgross = gross.value;
                                        // cardamt=parseFloat(cardamt) + parseFloat(ds.Tables[1].Rows[edicount].FCARDRATE);
                                        cardamt = parseFloat(cardamt) + parseFloat(ds.Tables[1].Rows[edicount].FEXTRARATE) + parseFloat(ds.Tables[1].Rows[edicount].CARDRATE);
                                        if ((cardid.value == "0" || cardid.value == "") && cardamt != "" && uomdesc == 'CD') {
                                            if (document.getElementById('hiddensavemod').value == "01" && (agreedrate_active == "1" || agreedamt_active == "1") && document.getElementById('drpbillcycle').disabled == false)
                                                cardid.value = cardid.value;
                                            else
                                                cardid.value = parseFloat(cardamt) / parseFloat(totalarea_vari.value);
                                            if (document.getElementById('hiddensavemod').value == "01" && (agreedrate_active == "1" || agreedamt_active == "1") && document.getElementById('drpbillcycle').disabled == false)
                                                cardid.value = cardid.value;
                                            else
                                                cardid.value = parseFloat(cardid.value).toFixed(2);
                                        }


                                        // for insertion wise box charges

                                        //                                        if(boxchargeInsertionwise=='yes')
                                        //                                        {
                                        //                                            var tboxcharge=0;
                                        //                                            tboxcharge=boxcharge;
                                        //                                            if(hiddenbox_vari.value=='2')
                                        //                                            {
                                        //                                                tboxcharge=(parseFloat(gridgross) * parseFloat(boxcharge))/100;
                                        //                                            }
                                        //                                             tboxcharge=parseFloat(tboxcharge) / parseFloat(gridItemCount);
                                        //                                              boxc.value=tboxcharge;
                                        //                                            grossamtfinal=parseFloat(grossamtfinal) + parseFloat(tboxcharge);
                                        //                                            if(insertsta.value!="billed")
                                        //                                            gross.value = parseFloat(gross.value) + parseFloat(tboxcharge);
                                        //                                        }
                                        gridgross = gross.value;
                                        var dname = getdayFromDate(dateformat, document.getElementById("Text" + counter).value);
                                        var chkb = "Y";
                                        if (dname == "Sunday" && ds.Tables[2].Rows[scicount].sun != null)
                                            chkb = ds.Tables[2].Rows[scicount].sun;
                                        else if (dname == "Monday" && ds.Tables[2].Rows[scicount].mon != null)
                                            chkb = ds.Tables[2].Rows[scicount].mon;
                                        else if (dname == "Tuesday" && ds.Tables[2].Rows[scicount].tue != null)
                                            chkb = ds.Tables[2].Rows[scicount].tue;
                                        else if (dname == "Wednesday" && ds.Tables[2].Rows[scicount].wed != null)
                                            chkb = ds.Tables[2].Rows[scicount].wed;
                                        else if (dname == "Thursday" && ds.Tables[2].Rows[scicount].thu != null)
                                            chkb = ds.Tables[2].Rows[scicount].thu;
                                        else if (dname == "Friday" && ds.Tables[2].Rows[scicount].fri != null)
                                            chkb = ds.Tables[2].Rows[scicount].fri;
                                        else if (dname == "Saturday" && ds.Tables[2].Rows[scicount].sat != null)
                                            chkb = ds.Tables[2].Rows[scicount].sat;
                                        if (chkb == "Y") {
                                            if (ds.Tables[2].Rows[scicount].TYPE == "per") {
                                                if (hidschememin_vari == "Y" && ds.Tables[1].Rows[edicount].MINWORD != null && parseInt(document.getElementById('siz' + counter).value) > parseInt(ds.Tables[1].Rows[edicount].MINWORD)) {
                                                    var exrate = ds.Tables[1].Rows[edicount].FEXTRARATE;
                                                    gridgross = parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) - (parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) * parseFloat(ds.Tables[2].Rows[scicount].AMT) / 100);
                                                    gridgross = parseFloat(gridgross) + parseFloat(exrate);
                                                }
                                                else {
                                                    gridgross = parseFloat(gridgross) - (parseFloat(gridgross) * parseFloat(ds.Tables[2].Rows[scicount].AMT) / 100);
                                                }
                                                if (parseInt(gridgross) == 0) {
                                                    freeIns = "Y";
                                                    freeIns_S = "Y";
                                                }
                                                grossamtfinal = parseFloat(grossamtfinal) + parseFloat(gridgross); //+gridgross;
                                                //agreed rate
                                                if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                                                    gross.value = gridgross.toFixed(4);
                                            }
                                            else if (ds.Tables[2].Rows[scicount].TYPE == "fixed") {
                                                var schratio = 0;
                                                if (gridItemTotal == 0) {
                                                    for (var f = 0; f < ds.Tables[1].Rows.length; f++) {
                                                        gridItemTotal = gridItemTotal + ds.Tables[1].Rows[f].FCARDRATE;
                                                    }

                                                }
                                                schratio = (parseFloat(ds.Tables[2].Rows[scicount].AMT) / parseFloat(gridItemTotal)) * parseFloat(ds.Tables[1].Rows[edicount].FCARDRATE);
                                                if (insertsta.value == 'cancel' || paidno.value == "N") {
                                                    schratio = 0;
                                                }
                                                // grossamtfinal = parseFloat(grossamtfinal) + (parseFloat(gridgross) - (parseFloat(ds.Tables[2].Rows[scicount].AMT) / parseInt(gridItemCount)));
                                                grossamtfinal = parseFloat(grossamtfinal) + (parseFloat(gridgross) - (parseFloat(schratio)));
                                                if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {

                                                    if (t == "D") {
                                                        if (ds.Tables[1].Rows[edicount].PREM1 == null)
                                                            ds.Tables[1].Rows[edicount].PREM1 = "0";
                                                        if (ds.Tables[1].Rows[edicount].PREM2 == null)
                                                            ds.Tables[1].Rows[edicount].PREM2 = "0";
                                                        if (hidschememin_vari == "Y" && ds.Tables[1].Rows[edicount].MINWORD != null && parseInt(document.getElementById('siz' + counter).value) > parseInt(ds.Tables[1].Rows[edicount].MINWORD)) {
                                                            var exrate = ds.Tables[1].Rows[edicount].FEXTRARATE;
                                                            //  gross.value = parseFloat(gridgross) - (parseFloat(ds.Tables[2].Rows[scicount].AMT) / parseInt(gridItemCount));
                                                            // gridgross=parseFloat(gridgross) + parseFloat(exrate);
                                                            //
                                                            gridgross = parseFloat(gridgross) + parseFloat(exrate);
                                                            var newrate = parseFloat(gridgross) - (parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) * parseFloat(ds.Tables[1].Rows[edicount].PREM1) / 100);
                                                            newrate = parseFloat(newrate) - (parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                                            gross.value = parseFloat(newrate) - (parseFloat(schratio));
                                                            gross.value = parseFloat(gross.value) + (parseFloat(gross.value) * parseFloat(ds.Tables[1].Rows[edicount].PREM1) / 100) + (parseFloat(gross.value) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);

                                                        }
                                                        else {
                                                            // gross.value = parseFloat(gridgross) - (parseFloat(ds.Tables[2].Rows[scicount].AMT) / parseInt(gridItemCount));
                                                            var tr = parseFloat(ds.Tables[1].Rows[edicount].CARDRATE);
                                                            if (ds.Tables[1].Rows[edicount].FEXTRARATE != null && ds.Tables[1].Rows[edicount].FEXTRARATE != "null") {
                                                                tr = parseFloat(tr) + parseFloat(ds.Tables[1].Rows[edicount].FEXTRARATE);
                                                            }
                                                            var newrate = parseFloat(gridgross) - (parseFloat(tr) * parseFloat(ds.Tables[1].Rows[edicount].PREM1) / 100);
                                                            newrate = parseFloat(newrate) - (parseFloat(tr) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                                            gross.value = parseFloat(newrate) - (parseFloat(schratio));
                                                            gross.value = parseFloat(gross.value) + (parseFloat(gross.value) * parseFloat(ds.Tables[1].Rows[edicount].PREM1) / 100) + (parseFloat(gross.value) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                                        }
                                                    }
                                                    else {
                                                        if (hidschememin_vari == "Y" && ds.Tables[1].Rows[edicount].MINWORD != null && parseInt(document.getElementById('siz' + counter).value) > parseInt(ds.Tables[1].Rows[edicount].MINWORD)) {
                                                            var exrate = ds.Tables[1].Rows[edicount].FEXTRARATE;
                                                            gross.value = parseFloat(gridgross) - (parseFloat(schratio));
                                                            gridgross = parseFloat(gridgross) + parseFloat(exrate);
                                                        }
                                                        else {
                                                            gross.value = parseFloat(gridgross) - (parseFloat(schratio));
                                                        }
                                                    }
                                                }
                                            }
                                            else {
                                                gross.value = ds.Tables[2].Rows[scicount].AMT;
                                                grossamtfinal = parseFloat(grossamtfinal) + parseFloat(gross.value);
                                            }
                                            scheme_var_id.value = ds.Tables[2].Rows[scicount].SCHEMENAME;
                                            schemeid = ds.Tables[2].Rows[scicount].SCHEMEID;
                                            if (paidno != null && ds.Tables[2].Rows[scicount].TYPE == "per" && ds.Tables[2].Rows[scicount].AMT == "100") {
                                                if (paidno.value != "P")
                                                    paidno.value = 'N';
                                            }
                                            else if (paidno != null) {
                                                paidno.value = 'Y';
                                            }
                                            scheme = 'Y';
                                            edicount = gridItemCount;
                                        }
                                        if (bullet_var.value != '0') {
                                            if (eyecatchtype != 'S') {
                                                if (eyecatchtype == 'P') {
                                                    if (bPrem.indexOf('%') > 0)
                                                        bPrem = bPrem.split('%')[0];
                                                    eyecatchRate = (parseFloat(gridgross) * parseFloat(bPrem)) / 100;
                                                    if (t == "D") {
                                                        if (ds.Tables[1].Rows[edicount].PREM1 == null)
                                                            ds.Tables[1].Rows[edicount].PREM1 = "0";
                                                        if (ds.Tables[1].Rows[edicount].PREM2 == null)
                                                            ds.Tables[1].Rows[edicount].PREM2 = "0";
                                                        var x = (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM1)) / 100;
                                                        x = parseFloat(x) + (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                                        eyecatchRate = parseFloat(eyecatchRate) + parseFloat(x);

                                                    }

                                                    if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                                                        gross.value = parseFloat(gross.value) + parseFloat(eyecatchRate);
                                                        grossamtfinal = parseFloat(grossamtfinal) + parseFloat(eyecatchRate);
                                                    }
                                                }
                                                else if (eyecatchtype == 'F') {
                                                    if (bPrem.indexOf('%') > 0)
                                                        bPrem = bPrem.split('%')[0];
                                                    eyecatchRate = parseFloat(bPrem); //parseFloat(grossamtfinal) + parseFloat(bPrem);
                                                    if (t == "D") {
                                                        if (ds.Tables[1].Rows[edicount].PREM1 == null)
                                                            ds.Tables[1].Rows[edicount].PREM1 = "0";
                                                        if (ds.Tables[1].Rows[edicount].PREM2 == null)
                                                            ds.Tables[1].Rows[edicount].PREM2 = "0";
                                                        var x = (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM1) / 100);
                                                        x = parseFloat(x) + (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                                        eyecatchRate = parseFloat(eyecatchRate) + parseFloat(x);

                                                    }

                                                    if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                                                        gross.value = parseFloat(gross.value) + (parseFloat(eyecatchRate) / parseInt(gridItemCount));
                                                        grossamtfinal = parseFloat(grossamtfinal) + (parseFloat(eyecatchRate) / parseInt(gridItemCount));
                                                    }
                                                }
                                            }
                                        }
                                        //                                    scheme_var_id.value = ds.Tables[2].Rows[scicount].SCHEMENAME;
                                        //                                    schemeid = ds.Tables[2].Rows[scicount].SCHEMEID;
                                        //                                    if (paidno != null && ds.Tables[2].Rows[scicount].TYPE == "per" && ds.Tables[2].Rows[scicount].AMT == "100") {
                                        //                                        if (paidno.value != "P")
                                        //                                            paidno.value = 'N';
                                        //                                    }
                                        //                                    else if (paidno != null) {
                                        //                                        paidno.value = 'Y';
                                        //                                    }
                                        //                                    scheme = 'Y';

                                        if (i == 0) {
                                            if (uomdesc == 'CD') {
                                                // cardrate=parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[edicount].EXTRARATE);
                                                if (ds.Tables[1].Rows[edicount].EXTRARATE != "0" && ds.Tables[1].Rows[edicount].EXTRARATE != "")
                                                    cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[edicount].EXTRARATE);
                                                else
                                                    cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) / parseFloat(totalarea_vari.value);
                                            }
                                            else {
                                                cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[edicount].CARDRATE);
                                            }
                                        }
                                        //  edicount = gridItemCount;
                                        break;
                                    }  //----5-----------

                                }    //----4-----------   
                            } // }     //----3-----------  
                            if (scheme == '') {
                                if (uomdesc == 'CD') {
                                    if (document.getElementById('hiddensavemod').value == "01" && (agreedrate_active == "1" || agreedamt_active == "1") && document.getElementById('drpbillcycle').disabled == false)
                                        cardid.value = cardid.value;
                                    else
                                        cardid.value = ds.Tables[1].Rows[edicount].EXTRARATE;
                                    solo.value = ds.Tables[1].Rows[edicount].SOLORATE;
                                }
                                else {
                                    if (document.getElementById('hiddensavemod').value == "01" && (agreedrate_active == "1" || agreedamt_active == "1") && document.getElementById('drpbillcycle').disabled == false)
                                        cardid.value = cardid.value;
                                    else
                                        cardid.value = ds.Tables[1].Rows[edicount].CARDRATE;
                                    solo.value = ds.Tables[1].Rows[edicount].SOLORATE;
                                }
                                 cardamt=parseFloat(cardamt) + parseFloat(ds.Tables[1].Rows[edicount].FCARDRATE);
                                //cardamt = parseFloat(cardamt) + parseFloat(ds.Tables[1].Rows[edicount].FEXTRARATE) + parseFloat(ds.Tables[1].Rows[edicount].CARDRATE);
                                if ((cardid.value == "0" || cardid.value == "") && cardamt != "" && uomdesc == 'CD') {
                                    if (document.getElementById('hiddensavemod').value == "01" && (agreedrate_active == "1" || agreedamt_active == "1") && document.getElementById('drpbillcycle').disabled == false)
                                        cardid.value = cardid.value;
                                    else
                                        cardid.value = parseFloat(cardamt) / parseFloat(totalarea_vari.value);
                                    if (document.getElementById('hiddensavemod').value == "01" && (agreedrate_active == "1" || agreedamt_active == "1") && document.getElementById('drpbillcycle').disabled == false)
                                        cardid.value = cardid.value;
                                    else
                                        cardid.value = parseFloat(cardid.value).toFixed(2);
                                }
                                var gridgross = 0;
                                if ((agreedrate_vari.value != '' && agreedrate_vari.value != '0') && (agreedamt_vari.value != '' && agreedamt_vari.value != '0')) {
                                    if (agreedrate_active == 0 && agreedamt_active == 0) {
                                        agreedamt_active = 1;
                                        flag_agreed = 2;
                                    }
                                }
                                if (agreedrate_active == 1 || agreedamt_active == 1) {
                                    var rowcountNum = rowcount;
                                    if (schemeCount > 0) {
                                        rowcountNum = parseInt(rowcount) - (parseInt(schemeCount) * parseInt(gridItemCount));
                                        if (flag_agreed != 2)
                                            flag_agreed = 1;
                                    }
                                    //////                                    if(flag_agreed==1)
                                    //////                                    {
                                    //////                                        var num=(parseFloat(parseFloat(agreedamt_vari.value) / parseInt(finsert))).toFixed(2);
                                    //////                                        agreedamt_vari.value=parseFloat(agreedamt_vari.value) - (parseFloat(num) * parseFloat(schemeCount));
                                    //////                                        flag_agreed=2;
                                    //////                                    }
                                    if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                                        agrred.value = (parseFloat(parseFloat(agreedamt_vari.value) / parseInt(rowcountNum))).toFixed(2);
                                    /* if(counter==parseInt(rowcount) - 1)
                                    {
                                    if(insertsta.value!="billed")
                                    agrred.value = (parseFloat(agreedamt_vari.value) - parseFloat(grossamtfinalAgreed)).toFixed(2) ;
                                    }*/
                                    // for applying scheme in Agreed Amount
                                    // 25 june 2010
                                    //////                                   if(schemeCount>0)
                                    //////                                   {
                                    //////                                   var diffcount=parseInt(finsert) - parseInt(schemeCount);
                                    //////                                      //   if(pkgcode.value==ds.Tables[2].Rows[0].PKG_CODE && parseInt(i)+1>diffcount)
                                    //////                                        if((parseInt(i)+1>parseInt(diffcount)))
                                    //////                                        { 
                                    //////                                                 freeIns="Y";
                                    //////                                                 gross.value =0;
                                    //////                                                  paidno.value='N';
                                    //////                                                  // scheme_var.value=ds.Tables[2].Rows[0].SCHEMENAME;
                                    //////                                        }   
                                    //////                                        else
                                    //////                                        {
                                    //////                                             gross.value = (parseFloat(agrred.value)).toFixed(2);
                                    //////                                        }     
                                    //////                                   }
                                    //////                                   else
                                    //////                                   {
                                    //////                                    gross.value = (parseFloat(agrred.value)).toFixed(2);
                                    //////                                   } 
                                    if (insertsta.value == 'cancel' || paidno.value == "N") {
                                        agreedcancelAmt = parseFloat(agreedcancelAmt) + parseFloat(agrred.value);
                                        //freeIns="Y";
                                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                                            gross.value = 0;
                                        paidno.value = 'N';
                                        grossamtfinalAgreed = parseFloat(grossamtfinalAgreed) + parseFloat(agrred.value);
                                    }
                                    gridgross = gross.value = parseFloat(gross.value).toFixed(4);

                                    //////  END
                                    edicount = gridItemCount;  //by nand on 2 oct
                                    if (i == 0) {
                                        if (uomdesc == 'CD') {
                                            //  cardrate=parseFloat(cardrate) + ds.Tables[1].Rows[cntrfill].EXTRARATE;
                                            if (ds.Tables[1].Rows[cntrfill].EXTRARATE != "0" && ds.Tables[1].Rows[cntrfill].EXTRARATE != "")
                                                cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].EXTRARATE);
                                            else
                                                cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].CARDRATE) / parseFloat(totalarea_vari.value);
                                        }
                                        else {
                                            cardrate = parseFloat(cardrate) + ds.Tables[1].Rows[cntrfill].CARDRATE;
                                        }
                                    }
                                    var grossValue = parseFloat(gross.value);
                                    grossamtfinal = parseFloat(grossamtfinal) + parseFloat(gridgross);
                                    grossamtfinalAgreed = parseFloat(grossamtfinalAgreed) + parseFloat(gridgross);
                                    // for box charges in agreed amount
                                    if (paidno.value == "N")
                                        boxcharge = "0";
                                    //                                      if(boxchargeInsertionwise=='yes' && paidno.value!='N')
                                    //                                    {
                                    //                                        var tboxcharge=0;
                                    //                                           tboxcharge=boxcharge;
                                    //                                        if(hiddenbox_vari.value=='2')
                                    //                                        {
                                    //                                             tboxcharge=(parseFloat(gridgross) * parseFloat(boxcharge))/100;
                                    //                                        }  
                                    //                                         tboxcharge=parseFloat(tboxcharge) / parseFloat(gridItemCount);
                                    //                                          boxc.value=tboxcharge;
                                    //                                        grossamtfinal=parseFloat(grossamtfinal) + parseFloat(tboxcharge);
                                    //                                        if(insertsta.value!="billed")
                                    //                                        gross.value = parseFloat(gross.value) + parseFloat(tboxcharge);
                                    //                                    }
                                    //                                    else{
                                    //                                         boxc.value="";
                                    //                                    }
                                }
                                else {
                                    if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                                        agrred.value = "";
                                        gridgross = gross.value = ds.Tables[1].Rows[edicount].FCARDRATE;
                                    }
                                    grossamtfinal = parseFloat(grossamtfinal) + parseFloat(gridgross);
                                    if (bullet_var != null && bullet_var.value != '0') {
                                        if (eyecatchtype != 'S') {
                                            if (eyecatchtype == 'P') {
                                                if (bPrem.indexOf('%') > 0)
                                                    bPrem = bPrem.split('%')[0];
                                                eyecatchRate = (parseFloat(gridgross) * parseFloat(bPrem)) / 100;
                                                if (t == "D") {
                                                    if (ds.Tables[1].Rows[edicount].PREM1 == null)
                                                        ds.Tables[1].Rows[edicount].PREM1 = "0";
                                                    if (ds.Tables[1].Rows[edicount].PREM2 == null)
                                                        ds.Tables[1].Rows[edicount].PREM2 = "0";
                                                    var x = (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM1)) / 100;
                                                    x = parseFloat(x) + (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                                    eyecatchRate = parseFloat(eyecatchRate) + parseFloat(x);

                                                }

                                                if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                                                    gross.value = parseFloat(gross.value) + parseFloat(eyecatchRate);
                                                    grossamtfinal = parseFloat(grossamtfinal) + parseFloat(eyecatchRate);
                                                }
                                            }
                                            else if (eyecatchtype == 'F') {
                                                if (bPrem.indexOf('%') > 0)
                                                    bPrem = bPrem.split('%')[0];
                                                eyecatchRate = parseFloat(bPrem); //parseFloat(grossamtfinal) + parseFloat(bPrem);
                                                if (t == "D") {
                                                    if (ds.Tables[1].Rows[edicount].PREM1 == null)
                                                        ds.Tables[1].Rows[edicount].PREM1 = "0";
                                                    if (ds.Tables[1].Rows[edicount].PREM2 == null)
                                                        ds.Tables[1].Rows[edicount].PREM2 = "0";
                                                    var x = (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM1)) / 100;
                                                    x = parseFloat(x) + (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM2)) / 100;
                                                    eyecatchRate = parseFloat(eyecatchRate) + parseFloat(x);

                                                }

                                                if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                                                    gross.value = parseFloat(gross.value) + (parseFloat(eyecatchRate) / parseInt(gridItemCount));
                                                    grossamtfinal = parseFloat(grossamtfinal) + (parseFloat(eyecatchRate) / parseInt(gridItemCount));
                                                }
                                            }
                                        }
                                    }
                                    // for insertion wise Box Charges 
                                    //                                    if(boxchargeInsertionwise=='yes')
                                    //                                    {
                                    //                                        var tboxcharge=0;
                                    //                                        tboxcharge=boxcharge;
                                    //                                        if(hiddenbox_vari.value=='2')
                                    //                                        {
                                    //                                             tboxcharge=(parseFloat(gridgross) * parseFloat(boxcharge))/100;
                                    //                                        }  
                                    //                                         tboxcharge=parseFloat(tboxcharge) / parseFloat(gridItemCount);
                                    //                                          boxc.value=tboxcharge;
                                    //                                        grossamtfinal=parseFloat(grossamtfinal) + parseFloat(tboxcharge);
                                    //                                        if(insertsta.value!="billed")
                                    //                                        gross.value = parseFloat(gross.value) + parseFloat(tboxcharge);
                                    //                                    }

                                    edicount = gridItemCount;
                                    if (i == 0) {
                                        if (uomdesc == 'CD') {
                                            //                                            cardrate=parseFloat(cardrate) + ds.Tables[1].Rows[cntrfill].EXTRARATE;
                                            if (ds.Tables[1].Rows[cntrfill].EXTRARATE != "0" && ds.Tables[1].Rows[cntrfill].EXTRARATE != "")
                                                cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].EXTRARATE);
                                            else
                                                cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].CARDRATE) / parseFloat(totalarea_vari.value);
                                        }
                                        else {
                                            cardrate = parseFloat(cardrate) + ds.Tables[1].Rows[cntrfill].CARDRATE;
                                        }
                                    }
                                    var grossValue = parseFloat(gross.value);
                                    gross.value = grossValue.toFixed(4);
                                    // break;
                                }
                            }
                            if (insertsta.value == 'cancel' || paidno.value == "N") {
                                if (hidschememin_vari != "Y" || insertsta.value == 'cancel')
                                    gross.value = 0;
                                boxc.value = "";
                                //freeIns="Y";
                                if (boxchargeInsertionwise == 'yes') {
                                    grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(gridgross) + parseFloat(eyecatchRate) + parseFloat(boxcharge));
                                }
                                else {
                                    grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(gridgross) + parseFloat(eyecatchRate));
                                }
                                // var paidno= "pai"+counter;
                                if (paidno != null) {
                                    paidno.value = 'N';
                                }
                            }
                            else if (paidno != null) {
                                if (paidno.value == 'N') {
                                    gross.value = 0;
                                    boxc.value = "";
                                    if (boxchargeInsertionwise == 'yes') {
                                        grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(gridgross) + parseFloat(eyecatchRate) + parseFloat(boxcharge));
                                    }
                                    else {
                                        grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(gridgross) + parseFloat(eyecatchRate));
                                    }
                                }
                            }
                            if (paidno.value != 'N')
                                cardrateSum = parseFloat(cardrateSum) + parseFloat(cardid.value);
                            else if (insertsta.value == 'cancel')
                                cardrateSum = parseFloat(cardrateSum) + parseFloat(cardid.value);
                            if (billrate != null) {
                                //                                  var tradisc=document.getElementById('txttradedisc').value;
                                //                                  if(document.getElementById('chktrade').checked==false)
                                //                                 tradisc=0;
                                //                                    if(tradisc=="")
                                //                                        tradisc=0;
                                //                                    var trdisc1=tradisc;
                                //                                    var addcomm =0;
                                //                                    if(document.getElementById('txtaddagencycommrate')!=null)
                                //                                    {
                                //                                    if(document.getElementById('hiddenagcommflag').value!="1")
                                //                                        addcomm=document.getElementById('txtaddagencycommrate').value;
                                //                                    }
                                //                                    if(addcomm=="")
                                //                                    {
                                //                                        addcomm="0";
                                //                                    }
                                //                                    if(addcomm!="0")
                                //                                    {
                                //                                        trdisc1=parseFloat(tradisc) + parseFloat(addcomm);
                                //                                    }
                                var billamt = 0;
                                if (agncomm_seq_com_vari != "S")
                                    billamt = parseFloat(gross.value) - (parseFloat(gross.value) * parseFloat(trdisc1) / 100);
                                else {
                                    billamt = parseFloat(gross.value) - parseFloat(gross.value) * parseFloat(tradisc) / 100;
                                    if (addcomm != "0" && addcomm != "") {
                                        billamt = parseFloat(billamt) - parseFloat(billamt) * parseFloat(addcomm) / 100;
                                    }
                                }
                                if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                                    billrate.value = billamt.toFixed(2);
                                if (billrate.value != "" && counter != parseInt(rowcount) - 1) {
                                    billamount = parseFloat(billamount) + parseFloat(billrate.value);
                                }
                                if (drpbooktype_vari == "2" || drpbooktype_vari == "6" || drpbooktype_vari == "4" || drpbooktype_vari == "5") {
                                    if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                                        billrate.value = 0;
                                }
                            }
                            if (bill_comp_amt != "" && parseFloat(cardid.value) != parseFloat(bill_comp_amt)) {
                                alert("Amount Not Match");
                                if (document.getElementById('hiddensavemod').value == "01" && (agreedrate_active == "1" || agreedamt_active == "1") && document.getElementById('drpbillcycle').disabled == false)
                                    cardid.value = cardid.value;
                                else
                                    cardid.value = bill_comp_amt;
                                return false;
                            }
                            counter++;
                        }

                    }
                }
                // END


            }
            else {
                alert(ds.Tables[0].Rows[0].MESSAGE);
                return false;
            }

        }

    }
    // for grossa mount
    if (scheme_var != "[object]" && scheme_var_id.value == "") {
        scheme_var_id.value = scheme_var;
    }
    if (freeIns == "Y") {
        if (schemecountNumber != "" && schemecountNumber != "0")
            paid_var.value = parseInt(paid_var.value) - parseInt(schemecountNumber, 10);
        else
            paid_var.value = parseInt(paid_var.value) - 1;
    }
    //    if(freeIns_S=="Y")  
    // {
    // sPaid=parseInt(sPaid,10)+1;
    // }
    /* if(hiddenbox_vari!=null)
    {
    if(boxchargeInsertionwise=='no')
    {
    if(hiddenbox_vari.value=='2')
    {
    boxcharge=(parseFloat(grossamtfinal) * parseFloat(boxcharge))/100;
    }
    grossamtfinal=parseFloat(grossamtfinal) + parseFloat(boxcharge);   
    }  
    }   */
    if (agreedrate_active == 1 || agreedamt_active == 1) {
        if (hiddenbox_vari != null) {
            if (boxchargeInsertionwise == 'yes') {
                if (hiddenbox_vari.value == '2') {
                    boxcharge = (parseFloat(agreedamt_vari.value) * parseFloat(boxcharge)) / 100;
                }
                else {
                    boxcharge = parseFloat(boxcharge) * parseFloat(document.getElementById('txtinsertion').value)
                }
                //grossamtfinal=parseFloat(grossamtfinal) + parseFloat(boxcharge);   
            }
        }
        grossamt_vari.value = parseFloat(agreedamt_vari.value) + parseFloat(boxcharge);
        grossamt_vari.value = parseFloat(grossamt_vari.value) - parseFloat(agreedcancelAmt);
    }
    else
        grossamt_vari.value = grossamtfinal.toFixed(2);
    document.getElementById('txtcardrate').value = cardrate.toFixed(2);
    grossamt_vari.value = parseFloat(grossamt_vari.value).toFixed(2);
    //document.getElementById('txtcardamt').value=grossamtfinal.toFixed(2);
    /* if( document.getElementById('txtpageamt').value!="")
    {
    var posprem=document.getElementById('txtpageamt').value;
    if(document.getElementById('txtpospremdisc').value!="")
    posprem=parseFloat(posprem)-parseFloat(document.getElementById('txtpospremdisc').value);
       
    cardamt=parseFloat(cardamt)  - parseFloat(document.getElementById('txtcardrate').value) * parseFloat(document.getElementById('txttotalarea').value) * parseFloat(posprem) / 100;
    }*/
    document.getElementById('txtcardamt').value = cardamt.toFixed(2);
    cardamt = 0;
    // Bill Calculation
    if (document.getElementById('configclient').value == "BHASKAR")
        roundTotal();
    if (document.getElementById('txtcardamt').value != "")//&& document.getElementById('txttradedisc').value!="")
    {
        var caramt = grossamt_vari.value;
        //            var tradisc=document.getElementById('txttradedisc').value;
        //            if(document.getElementById('chktrade').checked==false)
        //                    tradisc=0;
        //            if(tradisc=="")
        //                tradisc = 0;
        //            var trdisc1=tradisc;
        //            var addcomm =0;
        //            if(document.getElementById('txtaddagencycommrate')!=null)
        //            {
        //            if(document.getElementById('hiddenagcommflag').value!="1")
        //                addcomm=document.getElementById('txtaddagencycommrate').value;
        //            }
        //            if(addcomm=="")
        //            {
        //                addcomm="0";
        //            }
        //            if(addcomm!="0")
        //            {
        //                trdisc1=parseFloat(tradisc) + parseFloat(addcomm);
        //            }
        var tot = 0;
        if (agncomm_seq_com_vari != "S")
            tot = parseFloat(caramt) - parseFloat(caramt) * parseFloat(trdisc1) / 100;
        else {
            tot = parseFloat(caramt) - parseFloat(caramt) * parseFloat(tradisc) / 100;
            if (addcomm != "0" && addcomm != "") {
                tot = parseFloat(tot) - parseFloat(tot) * parseFloat(addcomm) / 100;
            }
        }
        billamt_vari.value = tot.toFixed(2);
    }
    else {
        billamt_vari.value = grossamt_vari.value;
    }
    // for agreed amounr ration in grid
    if (agreedamt_active == "1")//&& sPaid!="0")
    {
        if (document.getElementById('txtpaid').value == "0")
            document.getElementById('txtpaid').value = "1";
        agreedrate_vari.value = (parseFloat(agreedamt_vari.value) / (parseInt((paid_var.value), 10) * parseFloat(totalarea_vari.value))).toFixed(3);
        agreedrate_vari.value = parseFloat(agreedrate_vari.value) * parseInt(drppackage_vari.options.length, 10);
    }
    if ((agreedrate_vari.value != '' && agreedrate_vari.value != '0') && (agreedamt_vari.value != '' && agreedamt_vari.value != '0')) {
        var grossTot = 0;
        var grossTotAgreed = 0;
        var grossTotFinal = 0;
        billamount = 0;
        var cancelAmount = 0;
        var cancelBillAmount = 0;
        var d_data_gross;
        var d_data_Agreed;
        var d_data_bill;
        var totarea_m = totalarea_vari.value;
        var totarea_g = totalarea_vari.value;
        var crrate = document.getElementById('txtcardrate').value;
        var agrate_m = parseFloat(agreedrate_vari.value); // * parseInt(document.getElementById('txtpaid').value,10);
        for (k1 = 0; k1 < rowcount; k1++) {
            var cardid = "card" + k1;
            var insertsta = document.getElementById("inssta" + k1);
            var paidno = document.getElementById("pai" + k1);
            var insertsta = document.getElementById("inssta" + k1);
            var billrate = document.getElementById("ba" + k1);
            if (agreedamt_active != 1)
                totarea_g = document.getElementById("siz" + k1).value;
            var discrate = document.getElementById("disrat" + k1);
            if (document.getElementById("agr" + k1).value == "")
                document.getElementById("agr" + k1).value = 0;
            if (paidno.value != 'N' && insertsta.value != 'cancel') {
                var disc_rate = (parseFloat(document.getElementById(cardid).value) / parseFloat(crrate)) * parseFloat(agrate_m);
                if (agreedrate_active == "1" && discrate.value != "" && document.getElementById('hiddensavemod').value != "0")
                    disc_rate = discrate.value;
                if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                    discrate.value = disc_rate;
                var gross = parseFloat(totarea_g) * parseFloat(discrate.value);
                // var gross=(parseFloat(document.getElementById(cardid).value) / parseFloat(cardrateSum)) * parseFloat(agreedamt_vari.value);
                var diff = (parseFloat(agreedamt_vari.value) - parseFloat(cancelAmount)) - (parseFloat(grossTot) + parseFloat(gross));
                diff = (parseFloat(diff)).toFixed(2);
                if (parseFloat(diff) < 1 && parseFloat(diff) >= 0) {
                    if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                        if (VISIBLEAGREEDRATE == "Y"){
                            document.getElementById("gro" + k1).value = parseFloat(totarea_g) * parseFloat(discrate.value);
                        }
                        else{
                            document.getElementById("gro" + k1).value = ((parseFloat(agreedamt_vari.value) - parseFloat(cancelAmount)) - parseFloat(grossTot)).toFixed(4);
                        }
                    grossTot = parseFloat(grossTot) + parseFloat(document.getElementById("gro" + k1).value);
                    grossTotAgreed = parseFloat(grossTotAgreed) + parseFloat(document.getElementById("agr" + k1).value);
                }
                else if (k1 == parseInt(rowcount) - 1) {
                    if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != ""){                        
                        if (VISIBLEAGREEDRATE == "Y"){
                            document.getElementById("gro" + k1).value = parseFloat(totarea_g) * parseFloat(discrate.value);
                        }
                        else{
                            document.getElementById("gro" + k1).value = ((parseFloat(agreedamt_vari.value) - parseFloat(cancelAmount)) - parseFloat(grossTot)).toFixed(4);
                        }
                    }
                    grossTot = parseFloat(grossTot) + parseFloat(document.getElementById("gro" + k1).value);
                    grossTotAgreed = parseFloat(grossTotAgreed) + parseFloat(document.getElementById("agr" + k1).value);
                }
                else {
                    if (document.getElementById(cardid) != null) {
                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                            document.getElementById("gro" + k1).value = (gross).toFixed(4);
                        grossTot = parseFloat(grossTot) + parseFloat(document.getElementById("gro" + k1).value);
                        grossTotAgreed = parseFloat(grossTotAgreed) + parseFloat(document.getElementById("agr" + k1).value);
                    }
                }
                grossTotFinal = grossTot;
                if ((insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") && insertsta.value != "cancel") {
                    if (parseFloat(totarea_g) > parseFloat(totarea_m)) {
                        var diffg = parseFloat(totarea_g) - parseFloat(totarea_m);
                        var t = (parseFloat(document.getElementById("sol" + k1).value) * parseFloat(diffg));
                        document.getElementById("gro" + k1).value = parseFloat(document.getElementById("gro" + k1).value) + parseFloat(t);
                        grossTotFinal = parseFloat(grossTotFinal) + parseFloat(t);
                    }
                    d_data_gross = document.getElementById("gro" + k1);
                    d_data_bill = document.getElementById("ba" + k1);
                    d_data_Agreed = document.getElementById("agr" + k1);
                }
                // for billing calculation
                //                  var tradisc=document.getElementById('txttradedisc').value;
                //                  if(document.getElementById('chktrade').checked==false)
                //                    tradisc=0;
                //                                    if(tradisc=="")
                //                                        tradisc=0;
                //                                    var trdisc1=tradisc;
                //                                    var addcomm =0;
                //                                    if(document.getElementById('txtaddagencycommrate')!=null)
                //                                    {
                //                                    if(document.getElementById('hiddenagcommflag').value!="1")
                //                                        addcomm=document.getElementById('txtaddagencycommrate').value;
                //                                    }
                //                                    if(addcomm=="")
                //                                    {
                //                                        addcomm="0";
                //                                    }
                //                                    if(addcomm!="0")
                //                                    {
                //                                        trdisc1=parseFloat(tradisc) + parseFloat(addcomm);
                //                                    }
                var billamt = 0;
                if (agncomm_seq_com_vari != "S")
                    billamt = parseFloat(document.getElementById("gro" + k1).value) - (parseFloat(document.getElementById("gro" + k1).value) * parseFloat(trdisc1) / 100);
                else {
                    billamt = parseFloat(document.getElementById("gro" + k1).value) - parseFloat(document.getElementById("gro" + k1).value) * parseFloat(tradisc) / 100;
                    if (addcomm != "0" && addcomm != "") {
                        billamt = parseFloat(billamt) - parseFloat(billamt) * parseFloat(addcomm) / 100;
                    }
                }
                //   var billamt=parseFloat(gross.value) - (parseFloat(gross.value) * parseFloat(trdisc1)/100);
                //   var diffBill= parseFloat(document.getElementById('txtbillamt').value) -  (parseFloat(billamount) + parseFloat(billamt));
                // diffBill = (parseFloat(diffBill)).toFixed(2);
                //  if(parseFloat(diffBill)<1 && parseFloat(diffBill)>=0)
                // {
                // billrate.value=(parseFloat(document.getElementById('txtbillamt').value) - parseFloat(billamount)).toFixed(2);
                // }
                //  else
                //  {
                if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                    billrate.value = billamt.toFixed(2);
                //  }   
                if (billrate.value != "" && counter != parseInt(rowcount) - 1) {
                    billamount = parseFloat(billamount) + parseFloat(billrate.value);
                }
                if (drpbooktype_vari == "2" || drpbooktype_vari == "6" || drpbooktype_vari == "4" || drpbooktype_vari == "5") {
                    if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                        billrate.value = 0;
                }
            }
            else {
                if (insertsta.value == 'cancel') {
                    //cancelAmount =parseFloat(cancelAmount) +  ((parseFloat(document.getElementById(cardid).value) / parseFloat(cardrateSum)) * parseFloat(agreedamt_vari.value));
                }
                if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {

                    var disc_rate = (parseFloat(document.getElementById(cardid).value) / parseFloat(crrate)) * parseFloat(agrate_m);
                    if (agreedrate_active == "1" && discrate.value != "")
                        disc_rate = discrate.value;
                    if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                        discrate.value = disc_rate;
                    if (agreedamt_active == "1")
                        var gross = (parseFloat(document.getElementById(cardid).value) / parseFloat(cardrateSum)) * parseFloat(agreedamt_vari.value);
                    else
                        var gross = parseFloat(totarea_g) * parseFloat(discrate.value); //(parseFloat(document.getElementById(cardid).value) / parseFloat(cardrateSum)) * parseFloat(agreedamt_vari.value);
                    var diff = (parseFloat(agreedamt_vari.value) - parseFloat(cancelAmount)) - (parseFloat(grossTot) + parseFloat(gross));
                    diff = (parseFloat(diff)).toFixed(2);
                    if (parseFloat(diff) < 1 && parseFloat(diff) >= 0) {
                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                            if (agreedamt_active == "1")
                                document.getElementById("gro" + k1).value = ((parseFloat(agreedamt_vari.value) - parseFloat(cancelAmount)) - parseFloat(grossTot)).toFixed(4);
                            else
                                document.getElementById("gro" + k1).value = parseFloat(totarea_g) * parseFloat(discrate.value);
                            // document.getElementById("gro"+k1).value =  ((parseFloat(agreedamt_vari.value) - parseFloat(cancelAmount)) - parseFloat(grossTot)).toFixed(2);
                            if (agreedrate_active == 1 && premper_vari != "" && premper_vari != "0") {
                                document.getElementById("gro" + k1).value = parseFloat(document.getElementById("gro" + k1).value) + (parseFloat(gross) * parseFloat(premper_vari) / 100);
                            }
                        }
                        if (canclecharge != null && canclecharge != "0" && document.getElementById('chkcanclecharges').checked == true) {
                            document.getElementById("gro" + k1).value = parseFloat(document.getElementById("gro" + k1).value) * parseFloat(canclecharge) / 100;
                        }
                        else {
                            document.getElementById("gro" + k1).value = 0;
                            document.getElementById("agr" + k1).value = 0;
                            document.getElementById("disrat" + k1).value = 0;
                        }
                        grossTot = parseFloat(grossTot) + parseFloat(document.getElementById("gro" + k1).value);
                        grossTotAgreed = parseFloat(grossTotAgreed) + parseFloat(document.getElementById("agr" + k1).value);
                    }
                    else if (k1 == parseInt(rowcount) - 1) {
                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                            document.getElementById("gro" + k1).value = parseFloat(totarea_g) * parseFloat(discrate.value);
                            //  document.getElementById("gro"+k1).value =  ((parseFloat(agreedamt_vari.value) - parseFloat(cancelAmount)) - parseFloat(grossTot)).toFixed(2);
                            if (agreedrate_active == 1 && premper_vari != "" && premper_vari != "0") {
                                document.getElementById("gro" + k1).value = parseFloat(document.getElementById("gro" + k1).value) + (parseFloat(gross) * parseFloat(premper_vari) / 100);
                            }
                        }
                        if (canclecharge != null && canclecharge != "0" && document.getElementById('chkcanclecharges').checked == true) {
                            document.getElementById("gro" + k1).value = parseFloat(document.getElementById("gro" + k1).value) * parseFloat(canclecharge) / 100;
                        }
                        else {
                            document.getElementById("gro" + k1).value = 0;
                            document.getElementById("agr" + k1).value = 0;
                            document.getElementById("disrat" + k1).value = 0;
                        }
                        grossTot = parseFloat(grossTot) + parseFloat(document.getElementById("gro" + k1).value);
                        grossTotAgreed = parseFloat(grossTotAgreed) + parseFloat(document.getElementById("agr" + k1).value);
                    }
                    else {
                        if (document.getElementById(cardid) != null) {
                            if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                                document.getElementById("gro" + k1).value = (gross).toFixed(4);
                                if (agreedrate_active == 1 && premper_vari != "" && premper_vari != "0") {
                                    document.getElementById("gro" + k1).value = parseFloat(document.getElementById("gro" + k1).value) + (parseFloat(gross) * parseFloat(premper_vari) / 100);
                                }
                            }
                            if (canclecharge != null && canclecharge != "0" && document.getElementById('chkcanclecharges').checked == true) {
                                document.getElementById("gro" + k1).value = parseFloat(document.getElementById("gro" + k1).value) * parseFloat(canclecharge) / 100;
                            }
                            else {
                                document.getElementById("gro" + k1).value = 0;
                                document.getElementById("agr" + k1).value = 0;
                                document.getElementById("disrat" + k1).value = 0;
                            }
                            grossTot = parseFloat(grossTot) + parseFloat(document.getElementById("gro" + k1).value);
                            grossTotAgreed = parseFloat(grossTotAgreed) + parseFloat(document.getElementById("agr" + k1).value);
                        }
                    }
                    grossTotFinal = grossTot;
                    if ((insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") && insertsta.value != "cancel") {
                        d_data_gross = document.getElementById("gro" + k1);
                        d_data_bill = document.getElementById("ba" + k1);
                        d_data_Agreed = document.getElementById("agr" + k1);
                    }

                    var billamt = 0;
                    if (agncomm_seq_com_vari != "S")
                        billamt = parseFloat(document.getElementById("gro" + k1).value) - (parseFloat(document.getElementById("gro" + k1).value) * parseFloat(trdisc1) / 100);
                    else {
                        billamt = parseFloat(document.getElementById("gro" + k1).value) - parseFloat(document.getElementById("gro" + k1).value) * parseFloat(tradisc) / 100;
                        if (addcomm != "0" && addcomm != "") {
                            billamt = parseFloat(billamt) - parseFloat(billamt) * parseFloat(addcomm) / 100;
                        }
                    }

                    if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                        billrate.value = billamt.toFixed(2);

                    if (billrate.value != "" && counter != parseInt(rowcount) - 1) {
                        billamount = parseFloat(billamount) + parseFloat(billrate.value);
                    }
                    if (drpbooktype_vari == "2" || drpbooktype_vari == "4" || drpbooktype_vari == "5" || drpbooktype_vari == "6" || parseFloat(totalarea_vari.value) == 0) {
                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                            billrate.value = 0;
                    }
                }
            }
        }
        if (agreedamt_active == 1)
            agreedrate_vari.value = parseFloat(agreedrate_vari.value).toFixed(2);
        var diffagg = parseFloat(agreedamt_vari.value) - parseFloat(grossTot); // + parseFloat(cancelAmount));
        diffagg = (diffagg).toFixed(2);
        var diffagg_rate = parseFloat(agreedamt_vari.value) - (parseFloat(grossTotAgreed));
        diffagg_rate = (diffagg_rate).toFixed(2);
        if (agreedrate_active == 1) {
            diffagg = 0;
            diffagg_rate = 0;
        }
        if (d_data_gross != undefined) {
            if (d_data_Agreed != undefined && parseInt(diffagg_rate, 10) != 0) {
                var nid = d_data_Agreed.id.replace("agr", "disrat");
                var nsid = d_data_Agreed.id.replace("agr", "siz");
                d_data_Agreed.value = parseFloat(d_data_Agreed.value) + parseFloat(diffagg_rate);
                document.getElementById(nid).value = parseFloat(d_data_Agreed.value) / parseFloat(document.getElementById(nsid).value);
            }
            d_data_gross.value = parseFloat(d_data_gross.value) + parseFloat(diffagg);
            grossTot = parseFloat(grossTot) + parseFloat(diffagg);
            grossTotFinal = parseFloat(grossTotFinal) + parseFloat(diffagg);
            //         var tradisc=document.getElementById('txttradedisc').value;
            //                   if(document.getElementById('chktrade').checked==false)
            //                    tradisc=0;
            //                                    if(tradisc=="")
            //                                        tradisc=0;
            //                                    var trdisc1=tradisc;
            //                                    var addcomm =0;
            //                                    if(document.getElementById('txtaddagencycommrate')!=null)
            //                                    {
            //                                    if(document.getElementById('hiddenagcommflag').value!="1")
            //                                        addcomm=document.getElementById('txtaddagencycommrate').value;
            //                                    }
            //                                    if(addcomm=="")
            //                                    {
            //                                        addcomm="0";
            //                                    }
            //                                    if(addcomm!="0")
            //                                    {
            //                                        trdisc1=parseFloat(tradisc) + parseFloat(addcomm);
            //                                    }
            var diffaggB = parseFloat(diffagg) - (parseFloat(diffagg) * parseFloat(trdisc1) / 100);
            d_data_bill.value = parseFloat(d_data_bill.value) + parseFloat(diffaggB);
            billamount = parseFloat(billamount) + parseFloat(diffaggB);
        }
        grossamt_vari.value = parseFloat(grossTotFinal).toFixed(2);
        billamt_vari.value = parseFloat(billamount).toFixed(2);
    }


    //        if(boxchargeInsertionwise=='yes')
    //        {
    //            var lastItem="ba"+ (parseInt(counter)-1).toString();
    //              var paidno= "pai"+(parseInt(counter)-1).toString();
    //            var fAmt= parseFloat(document.getElementById('txtbillamt').value)-parseFloat(billamount);
    //            if(document.getElementById(lastItem)!=null && document.getElementById(paidno)!=null && document.getElementById(paidno).value!="N")
    //            {
    //                document.getElementById(lastItem).value=fAmt.toFixed(2);
    //                if(fAmt<0)
    //                {
    //                    if(document.getElementById("ba0")!=null && document.getElementById("ba0").value!="")
    //                    {
    //                        document.getElementById("ba0").value=(parseFloat(document.getElementById("ba0").value) + parseFloat(fAmt)).toFixed(2);
    //                    }
    //                    document.getElementById(lastItem).value=0;
    //                }
    //             }   
    //        }
    if (drpbooktype_vari == "2" || drpbooktype_vari == "6" || drpbooktype_vari == "4" || drpbooktype_vari == "5") {
        var lastItem = "ba" + (parseInt(counter) - 1).toString();
        var insertsta = document.getElementById("inssta" + (parseInt(counter) - 1).toString());
        if (document.getElementById(lastItem) != null) {
            if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                document.getElementById(lastItem).value = 0;
        }
        billamt_vari.value = 0;
    }
    ///  return false;
}
function date_frmt_orcl_no(dateformat, value1) {
    var dd = "";
    var mm = "";
    var yy = "";
    var newdate = "";
    if (dateformat == "dd/mm/yyyy") {
        var arrvalue1 = value1.split('/');
        dd = arrvalue1[0];
        mm = arrvalue1[1];
        yy = arrvalue1[2];
    }
    else if (dateformat == "mm/dd/yyyy") {
        var arrvalue1 = value1.split('/');
        dd = arrvalue1[1];
        mm = arrvalue1[0];
        yy = arrvalue1[2];
    }
    else if (dateformat == "yyyy/mm/dd") {
        var arrvalue1 = value1.split('/');
        dd = arrvalue1[2];
        mm = arrvalue1[1];
        yy = arrvalue1[0];
    }
    //mm=getmonthstr(mm);

    newdate = dd + "/" + mm + "/" + yy;

    return newdate;

}
function date_frmt_orcl(dateformat, value1) {
    var dd = "";
    var mm = "";
    var yy = "";
    var newdate = "";
    if (dateformat == "dd/mm/yyyy") {
        var arrvalue1 = value1.split('/');
        dd = arrvalue1[0];
        mm = arrvalue1[1];
        yy = arrvalue1[2];
    }
    else if (dateformat == "mm/dd/yyyy") {
        var arrvalue1 = value1.split('/');
        dd = arrvalue1[1];
        mm = arrvalue1[0];
        yy = arrvalue1[2];
    }
    else if (dateformat == "yyyy/mm/dd") {
        var arrvalue1 = value1.split('/');
        dd = arrvalue1[2];
        mm = arrvalue1[1];
        yy = arrvalue1[0];
    }

    if (document.getElementById('hiddenconnect').value == "orcl") {
        mm = getmonthstr(mm);
        newdate = dd + "-" + mm + "-" + yy;
    }
    else {
        newdate = yy + "-" + mm + "-" + dd;
    }
    return newdate;

}
function getmonthstr(m_value) {
    var month = "";
    switch (m_value) {
        case "1":
            month = "JAN";
            break;

        case "2":
            month = "FEB";
            break;

        case "3":
            month = "MAR";
            break;

        case "4":
            month = "APR";
            break;

        case "5":
            month = "MAY";
            break;

        case "6":
            month = "JUN";
            break;

        case "7":
            month = "JUL";
            break;

        case "8":
            month = "AUG";
            break;

        case "9":
            month = "SEP";
            break;

        case "10":
            month = "OCT";
            break;

        case "11":
            month = "NOV";
            break;

        case "12":
            month = "DEC";
            break;

        ////////////////   

        case "01":
            month = "JAN";
            break;

        case "02":
            month = "FEB";
            break;

        case "03":
            month = "MAR";
            break;

        case "04":
            month = "APR";
            break;

        case "05":
            month = "MAY";
            break;

        case "06":
            month = "JUN";
            break;

        case "07":
            month = "JUL";
            break;

        case "08":
            month = "AUG";
            break;

        case "09":
            month = "SEP";
            break;
    }

    return month;
}

//on Agreed rate and Agreed amount 24 sep
function getagreedamt() {
    commaremove();
    //*********
    if (document.getElementById('txtcardamt').value == "") {
        alert("Please Firstly click on GetRate Button");
        document.getElementById('txtagreedamt').value = "";
        document.getElementById('txtagreedrate').value = "";
        document.getElementById('btnshgrid').focus();
        return false;
    }
    if (document.getElementById('txtagreedamt').value != "") {
        if (parseInt(document.getElementById('txtagreedamt').value) == "0") {
            document.getElementById('txtagreedamt').value = "";
            document.getElementById('txtagreedrate').value = "";
            agreedrate_active = 0;
            agreedamt_active = 0;
        }
        ////        if(parseInt(document.getElementById('txtagreedrate').value)=="0")
        ////        {
        ////            document.getElementById('txtagreedrate').value="";
        ////            document.getElementById('txtagreedamt').value="";
        ////            agreedrate_active=0;
        ////            agreedamt_active=0;
        ////        }
    }

    ////    if(document.getElementById('txtagreedrate').value!="")
    ////    {
    ////        if(parseInt(document.getElementById('txtagreedamt').value)=="0")
    ////        {
    ////            document.getElementById('txtagreedamt').value="";
    ////            document.getElementById('txtagreedrate').value="";
    ////            agreedrate_active=0;
    ////            agreedamt_active=0;
    ////        }
    ////        if(parseInt(document.getElementById('txtagreedrate').value)=="0")
    ////        {
    ////            document.getElementById('txtagreedrate').value="";
    ////            document.getElementById('txtagreedamt').value="";
    ////            agreedrate_active=0;
    ////            agreedamt_active=0;
    ////        }
    ////    }
    //***********
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    document.getElementById('drpscheme').value = "";
    document.getElementById('txtdiscount').value = "";
    document.getElementById('txtdiscpre').value = "";
    var paidCount = document.getElementById('txtinsertion').value;
    var finsert = 1;
    var tinsert = 0;
    if (document.getElementById('drppackagecopy').options.length > 0) {
        for (var insertCou = 0; insertCou < document.getElementById('drppackagecopy').options.length; insertCou++) {
            if (document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') >= 0) {
                tinsert = document.getElementById('drppackagecopy').options[insertCou].value.substring(document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') + 1, document.getElementById('drppackagecopy').options[insertCou].value.indexOf(')'));
                if (parseInt(tinsert) > parseInt(finsert)) {
                    finsert = tinsert;
                }
                paidCount = parseInt(paidCount) * parseInt(tinsert);
            }
        }
    }
    if ((agreedrate_active == 1 || document.activeElement.id == 'txtagreedrate') && document.getElementById('txtagreedrate').value != "" && document.getElementById('txtagreedrate').value != "0") {
        agreedrate_active = 1;
        agreedamt_active = 0;
        if (document.getElementById('txttotalarea').value != "" && document.getElementById('txttotalarea').value != "NaN") {
            document.getElementById('txtagreedamt').value = (parseInt((paidCount), 10) * parseFloat(document.getElementById('txtagreedrate').value) * parseFloat(document.getElementById('txttotalarea').value)).toFixed(2);
            if (document.getElementById('txtcardrate').value != "") {
                document.getElementById('txtdiscount').value = (parseFloat(document.getElementById('txtcardrate').value) - parseFloat(document.getElementById('txtagreedrate').value)).toFixed(2);
                document.getElementById('txtdiscpre').value = (parseFloat(document.getElementById('txtdiscount').value) * 100 / parseFloat(document.getElementById('txtcardrate').value)).toFixed(2);
            }
        }

    }
    if ((agreedamt_active == 1 || document.activeElement.id == 'txtagreedamt') && document.getElementById('txtagreedamt').value != "" && document.getElementById('txtagreedamt').value != "0") {
        agreedrate_active = 0;
        agreedamt_active = 1;
        if (document.getElementById('txttotalarea').value != "" && document.getElementById('txttotalarea').value != "NaN") {
            document.getElementById('txtagreedrate').value = (parseFloat(document.getElementById('txtagreedamt').value) / (parseInt((paidCount), 10) * parseFloat(document.getElementById('txttotalarea').value))).toFixed(2);
            if (document.getElementById('txtcardrate').value != "") {
                document.getElementById('txtdiscount').value = (parseFloat(document.getElementById('txtcardrate').value) - parseFloat(document.getElementById('txtagreedrate').value)).toFixed(2);
                document.getElementById('txtdiscpre').value = (parseFloat(document.getElementById('txtdiscount').value) * 100 / parseFloat(document.getElementById('txtcardrate').value)).toFixed(2);
            }
        }
    }
    else if (document.activeElement.id == 'txtagreedamt' && document.getElementById('txtagreedamt').value == "" && document.getElementById('txtagreedamt').value != "0") {
        document.getElementById('txtagreedrate').value = "";
    }
    else if (document.activeElement.id == 'txtagreedrate' && document.getElementById('txtagreedrate').value == "" && document.getElementById('txtagreedrate').value != "0") {
        document.getElementById('txtagreedamt').value = "";
    }
    if ((document.getElementById('txtagreedrate').value == "" || document.getElementById('txtagreedrate').value == "NaN") && (document.getElementById('txtagreedamt').value == "" || document.getElementById('txtagreedamt').value == "NaN")) {
        agreedrate_active = 0;
        agreedamt_active = 0;
    }
    if (document.getElementById('hiddenuomdesc').value == "CD" && document.getElementById('hiddenuserdisc').value != "" && document.getElementById('hiddenuserdisc').value != "0" && document.getElementById('txtdiscpre').value != "" && document.getElementById('txtdiscpre').value != "0") {
        if (parseFloat(document.getElementById('txtdiscpre').value) > parseFloat(document.getElementById('hiddenuserdisc').value)) {
            alert("User Allowed Commission can't be greater than " + document.getElementById('hiddenuserdisc').value);
            document.getElementById('txtagreedrate').value = "";
            document.getElementById('txtagreedamt').value = "";
            document.getElementById('txtdiscpre').value = "";
            document.getElementById('txtdiscount').value = "";
            agreedrate_active = 0;
            agreedamt_active = 0;
            document.getElementById('txtagreedrate').focus();
            return false;
        }
    }
}
//*******************************************
function getagreedamt_Rate() {
    var totalarea = document.getElementById('txttotalarea').value;
    if (document.getElementById("txtbillwidth").value != "" && document.getElementById("txtbillheight").value != "") {
        if (document.getElementById('txtcolum').value != "")
            totalarea = parseFloat(document.getElementById("txtbillwidth").value) * parseFloat(document.getElementById("txtcolum").value);
        else
            totalarea = parseFloat(document.getElementById("txtbillwidth").value) * parseFloat(document.getElementById("txtbillheight").value);
    }
    var agreedrate_vari = document.getElementById('txtagreedrate');
    var agreedamt_vari = document.getElementById('txtagreedamt');
    if (agreedrate_vari.value != "") {
        if (parseFloat(agreedrate_vari.value) == "0" || parseFloat(agreedrate_vari.value) == "0.00") {
            agreedamt_vari.value = "";
            agreedrate_vari.value = "";
            agreedrate_active = 0;
            agreedamt_active = 0;
        }
    }
    else if (agreedamt_vari.value != "") {
        if (parseFloat(agreedamt_vari.value) == "0" || parseFloat(agreedamt_vari.value) == "0.00") {
            agreedamt_vari.value = "";
            agreedrate_vari.value = "";
            agreedrate_active = 0;
            agreedamt_active = 0;
        }
    }

    var paidCount = document.getElementById('txtinsertion').value;
    var finsert = 1;
    var tinsert = 0;
    document.getElementById('txtgrossamt').value = "";
    var drppackage_vari = document.getElementById('drppackagecopy');
    var totalarea_vari = document.getElementById('txttotalarea');
    var cardrate_vari = document.getElementById('txtcardrate');
    var dis_vari = document.getElementById('txtdiscount');
    var discpre_vari = document.getElementById('txtdiscpre');
    if (drppackage_vari.options.length > 0) {
        for (var insertCou = 0; insertCou < drppackage_vari.options.length; insertCou++) {
            if (drppackage_vari.options[insertCou].value.indexOf('(') >= 0) {
                tinsert = drppackage_vari.options[insertCou].value.substring(drppackage_vari.options[insertCou].value.indexOf('(') + 1, drppackage_vari.options[insertCou].value.indexOf(')'));
                if (parseInt(tinsert) > parseInt(finsert)) {
                    finsert = tinsert;
                }
                paidCount = parseInt(paidCount) * parseInt(tinsert);
            }
        }
    }
    if (agreedrate_active == 1) {
        agreedrate_active = 1;
        agreedamt_active = 0;
        if (totalarea_vari.value != "" && totalarea_vari.value != "NaN" && agreedrate_vari.value != "" && agreedrate_vari.value != "0") {
            agreedamt_vari.value = (parseInt((paidCount), 10) * parseFloat(agreedrate_vari.value) * parseFloat(totalarea)).toFixed(2);
            if (cardrate_vari.value != "") {
                dis_vari.value = (parseFloat(cardrate_vari.value) - parseFloat(agreedrate_vari.value)).toFixed(2);
                discpre_vari.value = (parseFloat(dis_vari.value) * 100 / parseFloat(cardrate_vari.value)).toFixed(2);
            }
        }

    }
    if (agreedamt_active == 1) {
        agreedrate_active = 0;
        agreedamt_active = 1;
        if (totalarea_vari.value != "" && totalarea_vari.value != "NaN" && agreedamt_vari.value != "" && agreedamt_vari.value != "0") {
            agreedrate_vari.value = (parseFloat(agreedamt_vari.value) / (parseInt((paidCount), 10) * parseFloat(totalarea))); //.toFixed(2);
            if (cardrate_vari.value != "") {
                dis_vari.value = (parseFloat(cardrate_vari.value) - parseFloat(agreedrate_vari.value)).toFixed(2);
                discpre_vari.value = (parseFloat(dis_vari.value) * 100 / parseFloat(cardrate_vari.value)).toFixed(2);
            }
        }

    }

}



function getsplcharge() {
    if (document.getElementById('txtextracharges').value != "") {
        var billamt = 0;
        var grossamtTotal = 0;
        var grossamt_var = document.getElementById('txtgrossamt');
        var br_spcharge = 0;
        var splcharges = document.getElementById('txtextracharges').value;
        var grossAmt = grossamt_var.value;
        var len = "bookdiv";
        var ratio = 0;
        var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
        for (var s = 0; s < count; s++) {
            var gross_var = document.getElementById('gro' + s);
            var bill_var = document.getElementById('ba' + s);
            var insertsta = document.getElementById("inssta" + s);
            if (gross_var != null) {
                if (s == count - 1) {

                    if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                        gross_var.value = (parseFloat(gross_var.value) + (parseFloat(splcharges) - parseFloat(br_spcharge))).toFixed(4);
                    // bill_var.value = (parseFloat(bill_var.value) + (parseFloat(splcharges)-parseFloat(br_spcharge))).toFixed(2);
                    // trade disc
                    var tradisc = document.getElementById('txttradedisc').value;
                    if (document.getElementById('chktrade').checked == false)
                        tradisc = 0;
                    if (tradisc == "")
                        tradisc = 0;
                    var trdisc1 = tradisc;
                    var addcomm = 0;
                    if (document.getElementById('txtaddagencycommrate') != null) {
                        if (document.getElementById('hiddenagcommflag').value != "1")
                            addcomm = document.getElementById('txtaddagencycommrate').value;
                    }
                    if (addcomm == "") {
                        addcomm = "0";
                    }
                    if (addcomm != "0") {
                        trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                    }

                    if ((insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") && document.getElementById('hidspltd').value == "Y")
                        bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);
                    else {
                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                            bill_var.value = (parseFloat(bill_var.value) + (parseFloat(splcharges) - parseFloat(br_spcharge))).toFixed(2);
                        }
                    }
                    if (parseFloat(gross_var.value) < 0) {
                        if (document.getElementById('gro0') != null && document.getElementById('gro0').value != "") {
                            if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                                document.getElementById('gro0').value = (parseFloat(document.getElementById('gro0').value) + parseFloat(gross_var.value)).toFixed(4); ;
                        }
                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                            gross_var.value = 0;
                    }
                    if (document.getElementById('inssta' + s).value == "cancel" || document.getElementById('pai' + s).value == "N") {
                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                            gross_var.value = 0;
                    }
                    if (parseFloat(bill_var.value) < 0) {
                        if (document.getElementById('ba0') != null && document.getElementById('ba0').value != "") {
                            if (document.getElementById('inssta0').value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                                document.getElementById('ba0').value = (parseFloat(document.getElementById('ba0').value) + parseFloat(bill_var.value)).toFixed(2);
                        }
                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                            bill_var.value = 0;
                    }

                    if (document.getElementById('drpbooktype').value == "2" || document.getElementById('drpbooktype').value == "6" || document.getElementById('drpbooktype').value == "4" || document.getElementById('drpbooktype').value == "5" || document.getElementById('inssta' + s).value == "cancel" || document.getElementById('pai' + s).value == "N") {
                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                            bill_var.value = 0;
                    }
                    billamt = parseFloat(billamt) + parseFloat(bill_var.value);
                    billamt = parseFloat(billamt).toFixed(2)
                    grossamtTotal = parseFloat(grossamtTotal) + parseFloat(gross_var.value);
                    grossamtTotal = parseFloat(grossamtTotal).toFixed(2)
                }
                else {
                    ratio = (parseFloat(gross_var.value) * parseFloat(splcharges)) / parseFloat(grossAmt)
                    if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                        gross_var.value = (parseFloat(gross_var.value) + parseFloat(ratio)).toFixed(4);
                    //  bill_var.value = (parseFloat(bill_var.value) + parseFloat(ratio)).toFixed(2);
                    // trade disc
                    var tradisc = document.getElementById('txttradedisc').value;
                    if (document.getElementById('chktrade').checked == false)
                        tradisc = 0;
                    if (tradisc == "")
                        tradisc = 0;
                    var trdisc1 = tradisc;
                    var addcomm = 0;
                    if (document.getElementById('txtaddagencycommrate') != null) {
                        if (document.getElementById('hiddenagcommflag').value != "1")
                            addcomm = document.getElementById('txtaddagencycommrate').value;
                    }
                    if (addcomm == "") {
                        addcomm = "0";
                    }
                    if (addcomm != "0") {
                        trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                    }
                    if ((insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") && document.getElementById('hidspltd').value == "Y")
                        bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);
                    else {
                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                            bill_var.value = (parseFloat(bill_var.value) + (parseFloat(ratio))).toFixed(2);
                        }
                    }
                    if (document.getElementById('inssta' + s).value == "cancel" || document.getElementById('pai' + s).value == "N") {
                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                            gross_var.value = 0;
                            bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);
                        }
                    }
                    if (document.getElementById('drpbooktype').value == "2" || document.getElementById('drpbooktype').value == "6" || document.getElementById('drpbooktype').value == "4" || document.getElementById('drpbooktype').value == "5" || document.getElementById('inssta' + s).value == "cancel" || document.getElementById('pai' + s).value == "N") {
                        if (document.getElementById('inssta0').value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                            bill_var.value = 0;
                    }
                    billamt = parseFloat(billamt) + parseFloat(bill_var.value);
                    billamt = parseFloat(billamt).toFixed(2);
                    grossamtTotal = parseFloat(grossamtTotal) + parseFloat(gross_var.value);
                    grossamtTotal = parseFloat(grossamtTotal).toFixed(2)
                    br_spcharge = (parseFloat(br_spcharge) + parseFloat(ratio)).toFixed(2);
                    //                if(splcharges!="" && splcharges!="0" && document.getElementById('inssta'+s).value=="cancel" && br_spcharge==0)
                    //               {
                    //                   var br_spcharge1 = parseFloat(splcharges)/parseFloat(count);
                    //                   splcharges=parseFloat(splcharges) - parseFloat(br_spcharge1);
                    //                }
                }
            }
        }
        grossamt_var.value = (parseFloat(grossamt_var.value) + parseFloat(splcharges)).toFixed(2);
        if (billamt != "" && billamt != "0")
            document.getElementById('txtbillamt').value = parseFloat(billamt).toFixed(2);
        if (grossamtTotal != "" && grossamtTotal != "0")
            document.getElementById('txtgrossamt').value = parseFloat(grossamtTotal).toFixed(2);
    }

}

function insertLine_callback_1(response) {
    var ds = response.value;
    if (ds == null) {
        alert("There is Some Network Error. Please Do the Booking Again");
        return false;
    }

    var adsubcat_vari = document.getElementById('drpadsubcategory');
    var color_vari = document.getElementById('drpcolor');
    var uom_vari = document.getElementById('drpuom');
    var hiddenuom_vari = document.getElementById('hiddenuomdesc');
    var matsta_vari = document.getElementById('drpmatstat');
    var drppagepos_vari = document.getElementById('drppageposition');
    var adcat_vari = document.getElementById('drpadcategory');
    var pkgcopy_vari = document.getElementById('drppackagecopy');
    var dateformat_vari = document.getElementById('hiddendateformat');
    var compcode_vari = document.getElementById('hiddencompcode');
    var center_vari = document.getElementById('hiddencenter');
    var chkall_vari = document.getElementById('chkall');
    var adtype_vari = document.getElementById('hiddenadtype');
    fillinsert = ds.Tables[0].Rows.length;
    var gridtab_vari = document.getElementById('gridtab');
    var remarks_per = document.getElementById('txtprintremark');
    var i = 0;
    var str = "";


    var dat = "mm+" / "+" / "+dd+" / "+yyyy";
    var j = 0;
    var k = 0;
    var l = 0;
    var m = 0;
    var n = 0;
    var o = 0;
    var p = 0;
    var premid;
    var premper;
    var colid;
    var height;
    var width;
    var size;
    var late;
    var adtypid;
    var uomid;
    var cardid;
    var premper1;
    var prem1id;
    var name;
    var inserts;
    var pagepost;
    var preall;
    var adcat;
    var adsubcat;
    var matsta;
    var filename;
    var discrate;
    var insertsta;
    var billstat;
    var editid;
    var repeat;
    var picfieldl;
    var colid;
    var paid;
    var agrred;
    var solo;
    var gross;
    var s;
    var count;
    var len = "bookdiv";
    var pageno_inserts;
    var remark_inserts;
    var caption_inserts;
    var page;
    var pageprem;
    var noofcol;
    var billamt;
    var billrate;
    var agnamnt;
    var adlgn;
    var spldisc;
    var cashdisc;
    var roundoffval;
    var pheival;
    var pagstr = "";
    //new change for bind grid line
    var dcat1 = "";
    var dcol = "";
    var dinsert = "";
    var dstatus = "";
    var dposition = "";
    var dprem1 = "";
    var dpre = "";
    var dmcat = "";
    var dbill = "";
    var dadcat3 = "";
    var dadcat4 = "";
    var dadcat5 = "";
    var dpaid = "";
    var dcou = "";
    //***************************

    //str="<table width=\"300px\" border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\"><td>Edition</td><td>Date</td></tr>";
    // 
    if (document.getElementById('hiddensavemod').value != "0") {
        count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
        idnew = parseInt(count);
        document.getElementById('hiddenrowcount').value = count;
        //insertval=count;
        if (document.getElementById('hiddeninsertion').value != "") {
            gridItemCount = parseInt(count) / parseInt(document.getElementById('hiddeninsertion').value);
            insertval = document.getElementById('hiddeninsertion').value;
            tempins = document.getElementById('hiddeninsertion').value;
            count = parseInt(ds.Tables[0].Rows.length, 10) / parseInt(document.getElementById('txtinsertion').value, 10);
            count = parseInt(count) * parseInt(document.getElementById('hiddeninsertion').value);
            document.getElementById('hiddeninsertion').value = ""
        }


    }
    else {
        count = document.getElementById('hiddenrowcount').value;
        document.getElementById('hiddenrowcount').value = ds.Tables[0].Rows.length;
    }

    /*if(document.getElementById('txtrepeatingdate').value!="")
    {
    count=0;
    }*/
    //    var idnew=document.getElementById('hiddenrowcount').value - parseInt(document.getElementById('txtinsertion').value);
    var temp = idnew;
    i = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
    var adsize1val = document.getElementById('txtadsize1').value;
    var adsize2val = document.getElementById('txtadsize2').value;
    var colval = document.getElementById('txtcolum').value;
    var areaval = document.getElementById('txttotalarea').value;
    var agreedamt1=document.getElementById('txtagreedrate').value;
    dcou = i;
    if (spdiscper == 1) {
        document.getElementById('txtspedisc').value = "";
    }
    else if (spdisc == 1) {
        document.getElementById('txtspediscper').value = "";
    }
    var insprev = 0;
    var ins_vari_m = document.getElementById('ins0');
    var data_arr = new Array();
    if (ins_vari_m != null) {
        var tsec = parseInt(count, 10) - 1;
        var insidM = "1";
        if (ds.Tables[0].Rows.length > 0 && ds.Tables[0].Rows[count] != null)
            insidM = ds.Tables[0].Rows[count].IDNUM;
        var sd = 0;
        while (parseInt(ins_vari_m.innerHTML) == insidM) {
            var strN = document.getElementById('edit' + tsec).value + "~" + document.getElementById('Text' + tsec).value;
            strN = strN + "~" + document.getElementById('hei' + tsec).value + "~" + document.getElementById('wid' + tsec).value;
            strN = strN + "~" + document.getElementById('siz' + tsec).value + "~" + document.getElementById('nocol' + tsec).value;
            data_arr[tsec] = strN;
            tsec = tsec - 1;
            sd = sd + 1;
            ins_vari_m = document.getElementById('ins' + tsec);
            if (ins_vari_m == null)
                break;
        }
    }
    for (s = count; s < ds.Tables[0].Rows.length; s++) {

        if (getid != "" && parseInt(i) < parseInt(getid)) {
            i = getid;
            //  i=parseInt(i)+1;
        }

        var vvalue = "";
        if (checkflag == 1) {
            caldate[cali] = dateSelected;
            caldatemonth[cali] = parseInt(monthSelected) + 1;
            caldateyear[cali] = yearSelected;
            // cali=cali+1;
        }
        var dCheck = checkValidEdition(ds.Tables[0].Rows[s].Edition_Name, ds.Tables[0].Rows[s].EDITION_CODE);
        // var dCheck=true;
        if (dCheck == true) {
            var id = "Text" + i;
            uomid = "uom" + i;
            inserts = "ins" + i;
            editid = "edit" + i;
            colid = "col" + i;
            agrred = "agr" + i;
            //str=str + "<tr ><td class=\"dtGrid\">"+ds.Tables[0].Rows[i].Edition_Name+"</td><td><input class=\"Textbox1\" type=\"text\" value='"+ds.Tables[0].Rows[i].Date+"' id="+id+"></td></tr>";

            //str=str + "<tr ><td class=\"dtGrid\">"+ds.Tables[0].Rows[i].Edition_Name+"</td><td><input class=\"btextforbook\" type=\"text\" id="+id+" value="+ds.Tables[0].Rows[i].Date+"><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1."+id+", Form1."+id+", "+dat+");\" height=\"14\" width=\"14\" /></td><td><select id="+colid+" class=\"dropdownforbook\">";
            //str=str+"<table id=\"gridtab\" width=\"300px\" border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\"><td align=\"center\">Edition</td><td align=\"center\">Date</td><td align=\"center\">Color</td><td align=\"center\">UOM</td><td align=\"center\">Height</td><td align=\"center\">Width</td><td align=\"center\">Size</td><td align=\"center\">Premium</td><td align=\"center\">Premium(%)</td><td align=\"center\">Ad Sub Cat.</td><td align=\"center\">Latest By</td><td align=\"center\">Repeating</td><td>Status Material</td><td align=\"center\">File Name</td><td align=\"center\">Card Rate</td><td align=\"center\">Disc. Rate</td><td align=\"center\">Status Of Insertion</td><td>Bill Status</td></tr>";
            //    if(s == count)
            //    {
            //        insertval=parseInt(ds.Tables[0].Rows[s].IDNUM)+1;//parseInt(insertval)+1;
            //        //str=str+"<tr ><td align=\"center\" id="+inserts+"  class=\"TextField\">"+insertval+"</td>";
            //         Make_Row=document.createElement("tr");
            //         make_td=document.createElement("td");
            //         make_td.align="center";
            //         make_td.setAttribute("class","TextField");
            //         make_td.innerHTML=insertval;
            //         make_td.id=inserts;
            //         Make_Row.appendChild(make_td);
            //    }
            //               //else if(i%noofinsert==0)
            //    else if(i%gridItemCount==0)
            //    {
            //        insertval=parseInt(ds.Tables[0].Rows[s].IDNUM)+1;
            //       // str=str+"<tr ><td align=\"center\" id="+inserts+" class=\"TextField\">"+insertval+"</td>";
            //        Make_Row=document.createElement("tr");
            //         make_td=document.createElement("td");
            //         make_td.align="center";
            //         make_td.setAttribute("class","TextField");
            //         make_td.innerHTML=insertval;
            //         make_td.id=inserts;
            //         Make_Row.appendChild(make_td);
            //    }
            //    else
            //    {
            insertval = parseInt(ds.Tables[0].Rows[s].IDNUM) + 1;
            //str=str+"<tr ><td align=\"center\" id="+inserts+" class=\"TextField\">"+insertval+"</td>";
            Make_Row = document.createElement("tr");
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.setAttribute("class", "TextField");

            make_td.innerHTML = insertval;
            make_td.id = inserts;
            if (insprev != insertval) {
                insprev = insertval;
                make_td.title = "Edit Insert";
            }
            Make_Row.appendChild(make_td);
            //}

            var nDate = "";
            if (ds.Tables[0].Rows[s].Date != null) {
                nDate = ds.Tables[0].Rows[s].Date;
            }
            for (var e = 0; e < data_arr.length; e++) {
                var d_ = data_arr[e].split("~")[1];
                var E_ = data_arr[e].split("~")[0];
                if (ds.Tables[0].Rows[s].Edition_Name == E_.toString()) {
                    if (noissueflag == true) {
                        nDate = d_;
                        if (nDate != "") {
                            nDate = getRepeat(nDate, document.getElementById('txtrepeatingdate').value, dateformat_vari.value);
                        }
                    }
                    adsize1val = data_arr[e].split("~")[2];
                    adsize2val = data_arr[e].split("~")[3];
                    areaval = data_arr[e].split("~")[4];
                    colval = data_arr[e].split("~")[5];
                    data_arr[e] = E_ + "~" + nDate + "~" + adsize1val + "~" + adsize2val + "~" + areaval + "~" + colval;
                    e = data_arr.length;
                }
            }
            // edition
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.setAttribute("class", "dtGrid");
            str = "<input class=\"btextforgrid7\" type=\"text\" title='" + ds.Tables[0].Rows[s].SHTNAME + "' disabled id=" + editid + " value='" + ds.Tables[0].Rows[s].Edition_Name + "'>";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);

            //date
            make_td = document.createElement("td");
            make_td.align = "center";
            str = "<input class=\"btextforgriddate\" type=\"text\" id=" + id + "    value=" + nDate + ">";

            //str="<input class=\"btextforgrid\" type=\"text\" id="+id+" value="+nDate+" ><img src=\"Images/cal1.gif\" height=\"14\" width=\"14\" />";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);
            // str=str + "<td class=\"dtGrid\" ><input class=\"btextforgrid\" type=\"text\" disabled id="+editid+" value="+ds.Tables[0].Rows[s].Edition_Name+"></td><td><input class=\"btextforgrid\" type=\"text\" id="+id+" value="+nDate+" ><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1."+id+", Form1."+id+", "+dat+");\" height=\"14\" width=\"14\" /></td>";

            // new change
            filename = "fil" + i;

            // str=str+"</select></td><td><input class=\"btextforgrid\" type=\"text\" id="+filename+" disabled  value=\"\"></td><td>";
            make_td = document.createElement("td");
            make_td.align = "center";
            str = "<input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled  value=\"\">";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);
            //  str=str+"<td><select id="+insertsta+" class=\"dropdownforgrid\" onchange=\"javascript:return chkpublishdate('"+insertsta+"','"+id+"')\">";

            var upl = "upload" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input  class=\"button1\" type=\"button\" id=" + upl + " Value=\"Attachment\" >";
            Make_Row.appendChild(make_td);


            ////this is to bind the Ad sub cat drop down




            //new change
            // Ad Sub Cat
            adsubcat = "ads" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.setAttribute("class", "dtGrid");
            if (adsubcat_vari.value != '0') {
                str = "<input class=\"btextforgrid\" type=\"text\"  id=" + adsubcat + " value=" + adsubcat_vari.value + ">";
            }
            else {
                str = "<input class=\"btextforgrid\" type=\"text\"  id=" + adsubcat + " value=''>";
            }

            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);

            //color
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.setAttribute("class", "dropdownforgrid");
            if (color_vari.value != '0') {
                str = "<input class=\"btextforgrid\" type=\"text\"  id=" + colid + " value=" + color_vari.value + ">";
            }
            else {
                str = "<input class=\"btextforgrid\" type=\"text\"  id=" + colid + " value=''>";
            }

            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);

            premid = "prem" + i;
            prem1id = "premone" + i;
            height = "hei" + i;
            width = "wid" + i;
            size = "siz" + i;
            pagepost = "pgpre" + i; //"pagpos"+i;
            noofcol = "nocol" + i;
            //*************bind siz and col

            if (uom_vari.value != "0" && hiddenuom_vari.value != "CD") {
                make_td = document.createElement("td");
                make_td.align = "center";
                // str="<input class=\" btextsmallsize\" style=\"background-color: Gray;\" disabled id="+height+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\"  type=\"text\"  value="+adsize1val+">";
                str = "<input class=\"btextsmallsizeH\" style=\"background-color: Gray;\" disabled type=\"text\"  id=" + height + " value=" + adsize1val + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);




                make_td = document.createElement("td");
                make_td.align = "center";
                //str="<input class=\"btextsmallsize\" style=\"background-color: Gray;\" disabled id="+width+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\"  type=\"text\"  value="+adsize2val+">";
                str = "<input class=\"btextsmallsizeH\" style=\"background-color: Gray;\" disabled type=\"text\"  id=" + width + " value=" + adsize2val + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);



                make_td = document.createElement("td");
                make_td.align = "center";
                // str="<input class=\"btextsmallsize\"   disabled id="+noofcol+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\"  type=\"text\"  value="+colval+">";
                str = "<input class=\"btextsmallsizeH\" disabled type=\"text\"  id=" + noofcol + " value=" + colval + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);



                make_td = document.createElement("td");
                make_td.align = "center";
                //str="<input class=\"btextsmallsize\"  disabled id="+size+" type=\"text\" value="+areaval+">";
                str = "<input class=\"btextsmallsize\"  type=\"text\"  id=" + size + "  value=" + areaval + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);

                // for bold charcter count
                var splboldsize = "splboldsize" + i;
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input  class=\"btextsmallsize\"  type=\"text\" id=" + splboldsize + " Value=\"\" >";
                Make_Row.appendChild(make_td);
                //str=str+"</select></td><td><input class=\" btextsmallsize\" style=\"background-color: Gray;\" disabled id="+height+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\"   value="+document.getElementById('txtadsize1').value+"></td><td><input class=\"btextsmallsize\" style=\"background-color: Gray;\" disabled id="+width+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(event);\" type=\"text\"  value="+document.getElementById('txtadsize2').value+"></td><td><input class=\"btextsmallsize\" disabled id="+noofcol+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(event);\" type=\"text\"  value="+document.getElementById('txtcolum').value+"></td><td><input class=\"btextsmallsize\" disabled id="+size+" type=\"text\" onchange=\"return getsoloextrarate("+adsubcat+","+colid+","+editid+","+size+","+adcat+","+gross+","+i+");\" value="+document.getElementById('txttotalarea').value+"></td>";
            }
            else {
                if (document.getElementById('txtcolum').disabled == true) {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input class=\"btextsmallsizeH\" style=\" background-color: White;\" id=" + height + "   type=\"text\"  value=" + adsize1val + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input class=\"btextsmallsizeH\" id=" + width + " style=\"background-color:White;\"   type=\"text\"  value=" + adsize2val + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input class=\"btextsmallsizeH\" disabled id=" + noofcol + "   type=\"text\"  value=" + colval + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  value=" + areaval + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    // for bold charcter count
                    var splboldsize = "splboldsize" + i;
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + splboldsize + " Value=\"\" >";
                    Make_Row.appendChild(make_td);

                }
                else {
                    if (document.getElementById('hdnprefcomngrd').value == 'Y') {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextsmallsizeH\" style=\" background-color: White;\"  id=" + height + "   type=\"text\"  value=" + adsize1val + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);

                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextsmallsizeH\"  id=" + width + " style=\"background-color:White;\"   type=\"text\"  value=" + adsize2val + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);

                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextsmallsizeH\"  id=" + noofcol + "   type=\"text\"  value=" + colval + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);

                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  value=" + areaval + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);

                        // for bold charcter count
                        var splboldsize = "splboldsize" + i;
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + splboldsize + " Value=\"\" >";
                        Make_Row.appendChild(make_td);

                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextsmallsizeH\" style=\" background-color: White;\" disabled id=" + height + "   type=\"text\"  value=" + adsize1val + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);

                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextsmallsizeH\" disabled id=" + width + " style=\"background-color:White;\"   type=\"text\"  value=" + adsize2val + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);

                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextsmallsizeH\" disabled  id=" + noofcol + "   type=\"text\"  value=" + colval + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);

                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  value=" + areaval + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);

                        // for bold charcter count
                        var splboldsize = "splboldsize" + i;
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + splboldsize + " Value=\"\" >";
                        Make_Row.appendChild(make_td);

                    }
                }
            }



            /////////////this is to bind the status material drop down
            matsta = "mat" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (matsta_vari.value != "0") {
                str = "<input class=\"btextforgrid\"  id=" + matsta + " type=\"text\"  value=" + matsta_vari.value + ">";
            }
            else {
                str = "<input class=\"btextforgrid\"  id=" + matsta + " type=\"text\">";
            }
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);

            cardid = "card" + i;

            //this is the function cretaed to get the solo edition rate break up with referrence  to the package selected 
            ////////////////////////////////////////////////////////////////////////////////////////////////////////
            //new change for bind booking status
            insertsta = "inssta" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\" disabled  type=\"text\" id=" + insertsta + "  value='booked'>";
            Make_Row.appendChild(make_td);

            if (chkbtnStatus == "modify") {
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input class=\"btextforgrid\" id='insstapub" + i + "' disabled  type=\"text\" value='booked''>";
                Make_Row.appendChild(make_td);
            }
            // for resource no

            var resourceno = "resno" + i;
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[79].childNodes[0].nodeValue == "enable") {

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\"  type=\"text\" id=" + resourceno + "  value=''>";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(39).text == "enable") {

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\"  type=\"text\" id=" + resourceno + "  value=''>";
                    Make_Row.appendChild(make_td);

                }
            }
            // for sectioncode

            var sectioncode = "seccode" + i;
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[77].childNodes[0].nodeValue == "enable") {

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\"  type=\"text\" id=" + sectioncode + "  value=''>";
                    Make_Row.appendChild(make_td);
                }
                else {
                    //                        make_td=document.createElement("td");
                    //                         make_td.align="center";
                    //                         make_td.innerHTML="";
                    //                         Make_Row.appendChild(make_td);
                    // str=str+"<td ></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(38).text == "enable") {

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\"  type=\"text\" id=" + sectioncode + "  value=''>";
                    Make_Row.appendChild(make_td);

                }
                else {
                    //	                     make_td=document.createElement("td");
                    //                         make_td.align="center";
                    //                         make_td.innerHTML="";
                    //                         Make_Row.appendChild(make_td);
                }
            }
            //    var cs=0;
            //    for(cs=0;cs<=ds.Tables[8].Rows.length-1;cs++)
            //    {
            //        if(ds.Tables[0].Rows[i].Edition_Name!=undefined )
            //        {
            //            if(ds.Tables[0].Rows[i].Edition_Name==ds.Tables[8].Rows[cs].Edition_Name)
            //            {
            //                //str=str+"<input class=\"btextforgrid\" disabled type=\"text\" id="+cardid+" value="+ds.Tables[8].Rows[cs].weekrate+">";
            //             make_td=document.createElement("td");
            //             make_td.align="center";
            //             make_td.innerHTML="<input class=\"btextforgrid\" disabled type=\"text\" id="+cardid+" value="+ds.Tables[8].Rows[cs].weekrate+">";
            //             Make_Row.appendChild(make_td); 
            //            }
            //        }
            //    
            //    }

            //    if(ds.Tables[8].Rows.length == 0)
            //    {
            //str=str+"<input class=\"btextforgrid\" disabled type=\"text\" id="+cardid+" value=\"\">";
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cardid + " value=\"\">";
            Make_Row.appendChild(make_td);
            //    }
            ///////////////////////
            discrate = "disrat" + i;

            billstat = "bill" + i;
            // str=str+"</td><td><input class=\"btextforgrid\" disabled type=\"text\" id="+discrate+"  value=\"\"></td>";
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\"  type=\"text\" id=" + discrate + "  value=" + agreedamt1 + ">";
            Make_Row.appendChild(make_td);

            // str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+agrred+"  value=\"\"></td>";
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agrred + "  value=\"\">";
            Make_Row.appendChild(make_td);

            

            ////////////this is to for larest date

            late = "lat" + i;
            repeat = "rep" + i;
            var dat = "mm+" / "+" / "+dd+" / "+yyyy";
            var latdate = "latdate" + i;
            var repeatdateI = "repdate" + i;

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[1].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + late + "   value=\"\" >";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + late + "   value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
                if (xmlObj.childNodes[25].childNodes[3].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + repeat + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + repeat + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }

            }
            else {
                if (xmlObj.childNodes[12].childNodes[0].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + late + "   value=\"\" >";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + late + "   value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
                if (xmlObj.childNodes[12].childNodes[1].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + repeat + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + repeat + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }

            }
            Make_Row.appendChild(make_td);

            namecode = "one";
            premper = "premper" + i;
            premper1 = "premperone" + i;
            adtypid = "adtyp" + i;
            namecode = "two";
            preall = "preall" + i;
            adcat = "adcat" + i;
            page = "pgpre" + i;
            pageprem = "pagper" + i;
            pagstr = "sec";

            //New change bind premium 2 bind drop down
            make_td = document.createElement("td");
            make_td.align = "center";
            if (drppagepos_vari.value == '0') {
                make_td.innerHTML = "<input class=\"btextsmallsizeH\" type=\"text\" id=" + page + "  value=\"\">";
            }
            else {
                make_td.innerHTML = "<input class=\"btextsmallsizeH\" type=\"text\" id=" + page + "  value='" + drppagepos_vari.value + "'>";
            }

            Make_Row.appendChild(make_td);

            ////this is to bind the per for page premium
            make_td = document.createElement("td");
            make_td.align = "center";
            if (document.getElementById('txtpageamt').value == "")
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id=" + pageprem + " value=\"\">";
            else
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id=" + pageprem + " value='" + document.getElementById('txtpageamt').value + "'>";
            Make_Row.appendChild(make_td);


            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[5].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<select id=" + preall + " disabled class=\"dropdownforgrid\">";
                    str = str + "<option value=\"0\">Select</option>";
                    str = str + "<option value=\"1\">Yes</option>";
                    str = str + "<option value=\"2\">No</option>";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<select id=" + preall + "  class=\"dropdownforgrid\">";
                    str = str + "<option value=\"0\">Select</option>";
                    str = str + "<option value=\"1\">Yes</option>";
                    str = str + "<option value=\"2\">No</option>";
                    make_td.innerHTML = str;
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            } else {
                if (xmlObj.childNodes[12].childNodes[2].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<select id=" + preall + " disabled class=\"dropdownforgrid\">";
                    str = str + "<option value=\"0\">Select</option>";
                    str = str + "<option value=\"1\">Yes</option>";
                    str = str + "<option value=\"2\">No</option>";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<select id=" + preall + "  class=\"dropdownforgrid\">";
                    str = str + "<option value=\"0\">Select</option>";
                    str = str + "<option value=\"1\">Yes</option>";
                    str = str + "<option value=\"2\">No</option>";
                    make_td.innerHTML = str;
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }

            ///new change bind the ad category
            make_td = document.createElement("td");
            make_td.align = "center";
            if (adcat_vari.value != '0') {
                make_td.innerHTML = "<input  class=\"dropdownforgrid\" type=\"text\" id=" + adcat + " value='" + adcat_vari.value + "'>";
            }
            else {
                make_td.innerHTML = "<input  class=\"dropdownforgrid\" type=\"text\" id=" + adcat + " >";
            }
            Make_Row.appendChild(make_td);

            //new change bind bill
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[7].childNodes[0].nodeValue != "hide") {
                    if (dbill == "") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        dbill = dbill + "<select id=" + billstat + " class=\"dropdownforgrid\">";

                        /////////////this function is to bind the bill status dropdown

                        var c = 0;
                        BILL_STATUS = '';
                        for (c = 1; c <= xmlObj.childNodes[3].childNodes.length - 1; c = c + 4) {
                            dbill = dbill + "<option value=" + xmlObj.childNodes[3].childNodes[c + 2].childNodes[0].nodeValue + ">" + xmlObj.childNodes[3].childNodes[c].childNodes[0].nodeValue + "</option>";
                            BILL_STATUS = BILL_STATUS + "<option value=" + xmlObj.childNodes[3].childNodes[c + 2].childNodes[0].nodeValue + ">" + xmlObj.childNodes[3].childNodes[c].childNodes[0].nodeValue + "</option>";
                        }
                        dbill = dbill + "</select>";
                        make_td.innerHTML = dbill;
                        Make_Row.appendChild(make_td);
                        //str=str+dbill;
                    }
                    else {
                        // str=str+dbill.replace("bill"+dcou,billstat);          
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = dbill.replace("bill" + dcou, billstat);
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                }
                else {
                    if (dbill == "") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        dbill = dbill + "<select id=" + billstat + " class=\"dropdownforgrid\">";

                        /////////////this function is to bind the bill status dropdown

                        var c = 0;
                        BILL_STATUS = '';
                        for (c = 1; c <= xmlObj.childNodes[3].childNodes.length - 1; c = c + 4) {
                            dbill = dbill + "<option value=" + xmlObj.childNodes[3].childNodes[c + 2].childNodes[0].nodeValue + ">" + xmlObj.childNodes[3].childNodes[c].childNodes[0].nodeValue + "</option>";
                            BILL_STATUS = BILL_STATUS + "<option value=" + xmlObj.childNodes[3].childNodes[c + 2].childNodes[0].nodeValue + ">" + xmlObj.childNodes[3].childNodes[c].childNodes[0].nodeValue + "</option>";
                        }
                        dbill = dbill + "</select>";
                        make_td.innerHTML = dbill;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                        //str=str+dbill;
                    }
                    else {
                        // str=str+dbill.replace("bill"+dcou,billstat);          
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = dbill.replace("bill" + dcou, billstat);
                        make_td.innerHTML = str;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }
            }

            else {
                if (xmlObj.childNodes[12].childNodes[3].childNodes[0].nodeValue != "hide") {
                    if (dbill == "") {
                        if (xmlObj.childNodes(1) == null) {
                            loadXML('xml/billcycle.xml');
                        }
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        dbill = dbill + "<select id=" + billstat + " class=\"dropdownforgrid\">";
                        var c = 0;
                        for (c = 0; c <= xmlObj.childNodes(1).childNodes.length - 1; c++) {
                            dbill = dbill + "<option value=" + xmlObj.childNodes(1).childNodes(c + 1).text + ">" + xmlObj.childNodes(1).childNodes(c).text + "</option>";
                            c = c + 1;
                        }

                        dbill = dbill + "</select>";
                        //str=str+dbill;   
                        make_td.innerHTML = dbill;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        // str=str+dbill.replace("bill"+dcou,billstat);             
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = dbill.replace("bill" + dcou, billstat);
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                }
                else {
                    if (dbill == "") {
                        if (xmlObj.childNodes(1) == null) {
                            loadXML('xml/billcycle.xml');
                        }
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        dbill = dbill + "<select id=" + billstat + " class=\"dropdownforgrid\">";
                        var c = 0;
                        for (c = 0; c <= xmlObj.childNodes(1).childNodes.length - 1; c++) {
                            dbill = dbill + "<option value=" + xmlObj.childNodes(1).childNodes(c + 1).text + ">" + xmlObj.childNodes(1).childNodes(c).text + "</option>";
                            c = c + 1;
                        }

                        dbill = dbill + "</select>";
                        //str=str+dbill;
                        make_td.innerHTML = dbill;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        // str=str+dbill.replace("bill"+dcou,billstat);             
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = dbill.replace("bill" + dcou, billstat);
                        make_td.innerHTML = str;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }

            }



            paid = "pai" + i;
            solo = "sol" + i;
            gross = "gro" + i;
            var discount_ = "disc_" + i;
            //new change bind the drop down for paid/free insertion
            if (ds.Tables[9].Rows[0].Paid_permission == "0") {
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[25].childNodes[13].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        if (document.getElementById('hiddisceditgrid').value == "Y")
                            make_td.innerHTML = "<input class=\"btextsmallsizeH\" type=\"text\" id=" + discount_ + "   value=\"\" >";
                        else
                            make_td.innerHTML = "<input class=\"btextsmallsizeH\" disabled type=\"text\" id=" + discount_ + "   value=\"\" >";
                        Make_Row.appendChild(make_td);
                    }
                    if (dpaid == "") {
                        //23sep  dpaid=dpaid+"<td><select id="+paid+" class=\"dropdownforgridsmall\" disabled onchange=\"putpaidintoinsert("+paid+","+inserts+","+insertval+");\">";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        dpaid = dpaid + "<select id=" + paid + " class=\"dropdownforgridsmall\" disabled>";
                        dpaid = dpaid + "<option value=\"Y\">Yes</option>";
                        dpaid = dpaid + "<option value=\"N\">No</option>";
                        dpaid = dpaid + "<option value=\"P\">Paid</option>";
                        dpaid = dpaid + "</select>";
                        // str=str+dpaid; 
                        make_td.innerHTML = dpaid;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = dpaid.replace("pai" + dcou, paid);
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);

                    }

                }
                else {
                    if (xmlObj.childNodes[12].childNodes[6].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        if (document.getElementById('hiddisceditgrid').value == "Y")
                            make_td.innerHTML = "<input class=\"btextsmallsizeH\" type=\"text\" id=" + discount_ + "   value=\"\" >";
                        else
                            make_td.innerHTML = "<input class=\"btextsmallsizeH\" disabled type=\"text\" id=" + discount_ + "   value=\"\" >";
                        Make_Row.appendChild(make_td);
                    }
                    if (dpaid == "") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        dpaid = dpaid + "<select id=" + paid + " class=\"dropdownforgridsmall\" disabled >";
                        dpaid = dpaid + "<option value=\"Y\">Yes</option>";
                        dpaid = dpaid + "<option value=\"N\">No</option>";
                        dpaid = dpaid + "<option value=\"P\">Paid</option>";
                        dpaid = dpaid + "</select>";
                        // str=str+dpaid; 
                        make_td.innerHTML = dpaid;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        // str=str+dpaid.replace("pai"+dcou,paid);  
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = dpaid.replace("pai" + dcou, paid);
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }

                }
            }
            else {
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[25].childNodes[13].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        if (document.getElementById('hiddisceditgrid').value == "Y")
                            make_td.innerHTML = "<input class=\"btextsmallsizeH\" type=\"text\" id=" + discount_ + "   value=\"\" >";
                        else
                            make_td.innerHTML = "<input class=\"btextsmallsizeH\" disabled type=\"text\" id=" + discount_ + "   value=\"\" >";
                        Make_Row.appendChild(make_td);
                    }
                    if (xmlObj.childNodes[23].childNodes[37].childNodes[0].nodeValue == "enable") {
                        if (dpaid == "") {
                            //23sep   dpaid=dpaid+"<td><select id="+paid+" class=\"dropdownforgridsmall\" onchange=\"putpaidintoinsert("+paid+","+inserts+","+insertval+");\">";
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dpaid = dpaid + "<select id=" + paid + " class=\"dropdownforgridsmall\">";
                            dpaid = dpaid + "<option value=\"Y\">Yes</option>";
                            dpaid = dpaid + "<option value=\"N\">No</option>";
                            dpaid = dpaid + "<option value=\"P\">Paid</option>";
                            dpaid = dpaid + "</select>";
                            //  str=str+dpaid;  
                            make_td.innerHTML = dpaid;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            //  str=str+dpaid.replace("pai"+dcou,paid);   
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dpaid.replace("pai" + dcou, paid);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                        }
                    }
                    else {
                        if (dpaid == "") {
                            //23sep   dpaid=dpaid+"<td><select id="+paid+" class=\"dropdownforgridsmall\" onchange=\"putpaidintoinsert("+paid+","+inserts+","+insertval+");\">";
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dpaid = dpaid + "<select id=" + paid + " class=\"dropdownforgridsmall\" disabled >";
                            dpaid = dpaid + "<option value=\"Y\">Yes</option>";
                            dpaid = dpaid + "<option value=\"N\">No</option>";
                            dpaid = dpaid + "<option value=\"P\">Paid</option>";
                            dpaid = dpaid + "</select>";
                            //  str=str+dpaid;  
                            make_td.innerHTML = dpaid;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            //  str=str+dpaid.replace("pai"+dcou,paid);   
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dpaid.replace("pai" + dcou, paid);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                        }
                    }
                }
                else {
                    if (xmlObj.childNodes[12].childNodes[6].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        if (document.getElementById('hiddisceditgrid').value == "Y")
                            make_td.innerHTML = "<input class=\"btextsmallsizeH\" type=\"text\" id=" + discount_ + "   value=\"\" >";
                        else
                            make_td.innerHTML = "<input class=\"btextsmallsizeH\" disabled type=\"text\" id=" + discount_ + "   value=\"\" >";
                        Make_Row.appendChild(make_td);
                    }
                    if (xmlObj.childNodes[11].childNodes[18].childNodes[0].nodeValue == "enable") {
                        if (dpaid == "") {
                            //23sep  dpaid=dpaid+"<td><select id="+paid+" class=\"dropdownforgridsmall\" onchange=\"putpaidintoinsert("+paid+","+inserts+","+insertval+");\">";
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dpaid = dpaid + "<select id=" + paid + " class=\"dropdownforgridsmall\" >";
                            dpaid = dpaid + "<option value=\"Y\">Yes</option>";
                            dpaid = dpaid + "<option value=\"N\">No</option>";
                            dpaid = dpaid + "<option value=\"P\">Paid</option>";
                            dpaid = dpaid + "</select>";
                            //  str=str+dpaid;   
                            make_td.innerHTML = dpaid;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            // str=str+dpaid.replace("pai"+dcou,paid);                    
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dpaid.replace("pai" + dcou, paid);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                        }
                    } else {
                        if (dpaid == "") {
                            //23sep  dpaid=dpaid+"<td><select id="+paid+" class=\"dropdownforgridsmall\" onchange=\"putpaidintoinsert("+paid+","+inserts+","+insertval+");\">";
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dpaid = dpaid + "<select id=" + paid + " class=\"dropdownforgridsmall\" disabled>";
                            dpaid = dpaid + "<option value=\"Y\">Yes</option>";
                            dpaid = dpaid + "<option value=\"N\">No</option>";
                            dpaid = dpaid + "<option value=\"P\">Paid</option>";
                            dpaid = dpaid + "</select>";
                            //  str=str+dpaid;   
                            make_td.innerHTML = dpaid;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            // str=str+dpaid.replace("pai"+dcou,paid);                    
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dpaid.replace("pai" + dcou, paid);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                        }
                    }

                }
            }


            //New change upload the image

            picfield = "pic" + i;
            
            str = str + "</select></td>";
            billamt = "ba" + i;
            // str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+solo+"  value=\"\"></td>";
            make_td = document.createElement("td");
            make_td.align = "center";

            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + solo + "  value=\"\">";
            Make_Row.appendChild(make_td);

            make_td = document.createElement("td");
            make_td.align = "center";

            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + gross + "  value=\"\">";
            Make_Row.appendChild(make_td);

            // str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+gross+"  value=\"\"></td>";

            pageno_inserts = "pagno" + i; ;
            remark_inserts = "rem" + i;
            caption_inserts = "cap" + i;
            billrate = "br" + i;
            agnamnt = "agmn" + i;
            adlgn = "adlag" + i;
            spldisc = "spld" + i;
            cashdisc = "cashd" + i;
            roundoffval = "roundoffval" + i;
            pheival = "pheival" + i;
            var upl = "upload" + i;

            //  str=str+"<td><input  class=\"btextforinsertright\" onkeypress=\"javascript:return rateenter(event);\"   type=\"text\" id="+pageno_inserts+"  value=\"\"></td>";
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input  class=\"btextforinsertright\"    type=\"text\" id=" + pageno_inserts + "  value=\"\">";
            Make_Row.appendChild(make_td);

            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input  class=\"btextforgrid\"    type=\"text\" id=" + caption_inserts + "  value=\"\">";
            Make_Row.appendChild(make_td);

            //str=str+"<td><input  class=\"btextforgrid\"    type=\"text\" id="+remark_inserts+"  value=\"\"></td>";
            make_td = document.createElement("td");
            make_td.align = "center";
            if (remarks_per.value != '') {
                make_td.innerHTML = "<input  class=\"btextforgrid\" type=\"text\" id=" + remark_inserts + " value='" + remarks_per.value + "'>";
            }
            else {
                make_td.innerHTML = "<input  class=\"btextforgrid\"    type=\"text\" id=" + remark_inserts + "  value=\"\">";
            }
            Make_Row.appendChild(make_td);

            //str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+billamt+"  value=\"\"></td>";
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforinsertright\" disabled type=\"text\" title='" + "Insert No:" + insertval + ",Edition:" + ds.Tables[0].Rows[s].Edition_Name + ",Date:" + nDate + "' id=" + billamt + "  value=\"\">";
            Make_Row.appendChild(make_td);

            // new field for local gross and local bill amount
            var grosslocal = "grolocal" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + grosslocal + "  value=\"\">";
            Make_Row.appendChild(make_td);

            // str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billamt+"  value=\"\"></td>";
            var billamtlocal = "balocal" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + billamtlocal + "  value=\"\">";
            Make_Row.appendChild(make_td);

            //str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+billrate+"  value=\"\"></td>";
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[9].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + billrate + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + billrate + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[4].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + billrate + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + billrate + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[15].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agnamnt + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agnamnt + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[7].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agnamnt + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agnamnt + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[17].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + adlgn + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + adlgn + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[8].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + adlgn + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + adlgn + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[19].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + spldisc + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + spldisc + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[9].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + spldisc + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + spldisc + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[21].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cashdisc + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cashdisc + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[10].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cashdisc + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cashdisc + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[23].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + roundoffval + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + roundoffval + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[11].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + roundoffval + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + roundoffval + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[25].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + pheival + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + pheival + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[12].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + pheival + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + pheival + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }

            //             make_td=document.createElement("td");
            //             make_td.align="center";
            //             make_td.innerHTML="<input  type=\"hidden\" id="+vtsid+">";
            //             Make_Row.appendChild(make_td);

            //str=str+"<td width=\"50px\"><input  class=\"button1\" type=\"button\" Value=\"Attachment\" onclick=\"uploadimage('"+picfield+"','"+insertval+"','"+editid+"','"+filename+"','"+i+"')\">";

           

            //// split Button
            var splt = "splt" + i;

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[75].childNodes[0].nodeValue == "enable" && document.getElementById('hiddenuomdesc').value == "CD" && ds.Tables[0].Rows[s].PRIORITY != '1' && ds.Tables[0].Rows[s].SPLIT == 'Y')//ds.Tables[0].Rows[s].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"buttonsplit\" type=\"button\" Value=\"Split\" id=" + splt + " >";
                    Make_Row.appendChild(make_td);
                    //str=str+"<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" Value=\"Split\" id="+splt+" ></td>";//onclick=\"return opensplitedition('"+ds.Tables[0].Rows[s].Edition_Name+"','"+i+"');\" 
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(37).text == "enable" && document.getElementById('hiddenuomdesc').value == "CD" && ds.Tables[0].Rows[s].PRIORITY != '1' && ds.Tables[0].Rows[s].SPLIT == 'Y')//ds.Tables[0].Rows[s].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"buttonsplit\" type=\"button\" Value=\"Split\" id=" + splt + " >";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "";
                    Make_Row.appendChild(make_td);
                }
            }
            //// sub edition detail Button
            var subedi = "subedi" + i;

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[73].childNodes[0].nodeValue == "enable")//ds.Tables[0].Rows[s].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"buttonsplit\" type=\"button\" Value=\"Detail\" id=" + subedi + ">";
                    Make_Row.appendChild(make_td);
                    //str=str+"<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" Value=\"Detail\" id="+subedi+"></td>";
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(36).text == "enable")//ds.Tables[0].Rows[s].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"buttonsplit\" type=\"button\" Value=\"Detail\" id=" + subedi + " >";
                    Make_Row.appendChild(make_td);
                    //  str=str+"<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" Value=\"Detail\" id="+subedi+" ></td>";
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "";
                    Make_Row.appendChild(make_td);
                }
            }

            // for VTS Button
            var vtsbtnid = "vtsbtn" + i;
            var vtsid = "vts" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input  class=\"button1\" id=" + vtsbtnid + " type=\"button\" Value=\"VTS\"><input  type=\"hidden\" id=" + vtsid + ">";
            Make_Row.appendChild(make_td);
            //   showid="sho"+i;
            //                    make_td=document.createElement("td");
            //                    make_td.align="center";
            //                    str="<input class=\"btextforgrid\" style=\"display:none;\" type=\"text\" id="+showid+"  value='0'>";
            //                    make_td.innerHTML=str;
            //                    Make_Row.appendChild(make_td);
            // for logo
            var logohei = "logohei" + i;
            var logowid = "logowid" + i;
            var logonam = "logonam" + i;
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[11].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logohei + " Value=\"\" >";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logowid + " Value=\"\" >";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"dropdownforgrid\" disabled type=\"text\" id=" + logonam + " Value=\"\" >";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"btextsmallsize\"  type=\"text\" id=" + logohei + " Value=\"\" >";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"btextsmallsize\" type=\"text\" id=" + logowid + " Value=\"\" >";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"dropdownforgrid\" type=\"text\" id=" + logonam + " Value=\"\" >";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[5].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logohei + " Value=\"\" >";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logowid + " Value=\"\" >";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"dropdownforgrid\" disabled type=\"text\" id=" + logonam + " Value=\"\" >";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"btextsmallsize\"  type=\"text\" id=" + logohei + " Value=\"\" >";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"btextsmallsize\"  type=\"text\" id=" + logowid + " Value=\"\" >";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"dropdownforgrid\" type=\"text\" id=" + logonam + " Value=\"\" >";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }

            // for logo


//            var showid = "sho" + i;
//            make_td = document.createElement("td");
//            make_td.align = "center";
//            str = "<input class=\"btextforgrid\" style=\"display:none;\" type=\"text\" id=" + showid + "  value='" + ds.Tables[0].Rows[i].insert_id + "'>";
//            make_td.innerHTML = str;
//            Make_Row.appendChild(make_td);


            // str=str+"</td>";
            var pkgcodegrid = 'hiddenpckcode' + i;
            //This is a hidden field in the insertion grid which holds the Package Code for internal processing only
            //str=str+"<td><input disabled class=\"btextsmallsize\" type=\"text\" id='"+pkgcodegrid+"' value="+ds.Tables[0].Rows[i].EDITION_CODE+"></td>";

            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkgcodegrid + "' value='" + ds.Tables[0].Rows[i].EDITION_CODE + "'>";
            Make_Row.appendChild(make_td);
            var pubcode = 'pubcode' + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pubcode + "' value='" + ds.Tables[0].Rows[i].PUBCODE + "'>";
            Make_Row.appendChild(make_td);

            ////////////////////////////////////////////////// 03 July ///////////////////////////

            var pkg_ins = 'pkg_ins' + i;
            make_td = document.createElement("td");
            make_td.align = "center";

            for (var countpkg = 0; countpkg < pkgcopy_vari.length; countpkg++) {
                var pkgcopy = pkgcopy_vari.options[countpkg].value;
                var arrpkgcopy = pkgcopy.split('@')
                var pkgcopycode = arrpkgcopy[0];
                var arr_pkg_ins_value = arrpkgcopy[1].split('(');
                var pkg_ins_value = arr_pkg_ins_value[1].replace(')', '');
                if (pkgcopycode == ds.Tables[0].Rows[i].EDITION_CODE) {
                    //str=str+"<td><input disabled class=\"btextsmallsize\" type=\"text\" id='"+pkg_ins+"' value="+pkg_ins_value+"></td>";
                    make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_ins + "' value='" + pkg_ins_value + "'>";
                    //pkginsdata="<input disabled class=\"btextsmallsize\" type=\"text\" id='"+pkg_ins+"' value='"+pkg_ins_value+"'>";
                }
            }

            //str=str+"<td><input disabled class=\"btextsmallsize\" type=\"text\" id='"+pkg_ins+"' value=''></td>";


            Make_Row.appendChild(make_td);


            pkg_alias = 'pkg_alias' + i;
            // str=str+"<td><input disabled class=\"btextsmallsize\" type=\"text\" id='"+pkg_alias+"' value='"+ds.Tables[0].Rows[i].PKGNAME+"'></td>";
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_alias + "' value='" + ds.Tables[0].Rows[i].PKGNAME + "'>";
            Make_Row.appendChild(make_td);

            var spltdata = "spltdata" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + spltdata + "' value=\"\">";
            Make_Row.appendChild(make_td);
            //   str=str+"<td><input disabled class=\"btextsmallsize\" type=\"text\" id='"+spltdata+"' value=\"\"></td>";

            var subedidata = "subedidata" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + subedidata + "' value=\"\">";
            Make_Row.appendChild(make_td);

            var vat = "vat" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + vat + "' value=\"\">";
            Make_Row.appendChild(make_td);

            var boxc = "boxc" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + boxc + "' value=\"\">";
            Make_Row.appendChild(make_td);

            var vat_inc = "vat_inc" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + vat_inc + "' value=\"\">";
            Make_Row.appendChild(make_td);

            var coupan = "coupan" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + coupan + "' value=\"\">";
            Make_Row.appendChild(make_td);

            var clicatamt = "clicatamt" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + clicatamt + "' value=\"\">";
            Make_Row.appendChild(make_td);

            var flatfreqamt = "flatfreqamt" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + flatfreqamt + "' value=\"\">";
            Make_Row.appendChild(make_td);

            var catamt = "catamt" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + catamt + "' value=\"\">";
            Make_Row.appendChild(make_td);
            
            var GSTAMT = "GSTAMT" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + GSTAMT + "' value=\"\">";
            Make_Row.appendChild(make_td);
            
            var GSTGD = "GSTGD" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + GSTGD + "' value=\"\">";
            Make_Row.appendChild(make_td);
            
            //  str=str+"<td><input disabled class=\"btextsmallsize\" type=\"text\" id='"+subedidata+"' value=\"\"></td>";
            //str=str+"</td></tr>"; 

            //document.getElementById('tblinsert').innerHTML=str;
            if (online_flag == false && ds.Tables[0].Rows[i].PUBTYPE == "IN0") {
                online_flag = true;
            }
            gridtab_vari.getElementsByTagName("tbody")[0].appendChild(Make_Row);
            if (ds.Tables[0].Rows[s].Date != null && ds.Tables[0].Rows[s].Date != "", nDate != "") {
                var date_res = dropDateCheck(nDate, document.getElementById(id), ds.Tables[0].Rows[s].EDITION_CODE, ds.Tables[0].Rows[s].PKGNAME, ds.Tables[0].Rows[s].Edition_Name);
                if (date_res == false) {
                    alert(document.getElementById(id).value + " Date is no issue date of edition " + ds.Tables[0].Rows[s].PKGNAME);
                    document.getElementById(id).value = "";

                }
            }
            idnew = parseInt(idnew) + 1;

            i = parseInt(i, 10) + 1;
        }
    }
    if (online_flag == true) {
        online_flag = false;
        document.getElementById('chkonline').disabled = false;
    }
    else {
        document.getElementById('chkonline').disabled = true;
    }
    if (browserversion > 6) {
        $(".dropdownforgridsmall").change(function () {
            if (document.activeElement.id.indexOf("pai") >= 0) {
                blankGross();
            }
        });
        $(".btextsmallsizeH").change(function () {
            if (document.activeElement.id.indexOf("pgpre") >= 0 || document.activeElement.id.indexOf("nocol") >= 0 || document.activeElement.id.indexOf("hei") >= 0 || document.activeElement.id.indexOf("wid") >= 0 || document.activeElement.id.indexOf("ins") >= 0) {
                var i;
                if (document.activeElement.id.indexOf("disc_") >= 0) {
                    blankGross();
                }
                if (document.activeElement.id.indexOf("pgpre") >= 0) {
                    i = document.activeElement.id.substring(5, document.activeElement.id.length + 1);
                    var page = "pgpre" + i;
                    var pagstr = "sec";
                    var f = getpageprem(page, i, pagstr);
                    if (f == false)
                        return false;
                }
                else {
                    if (document.activeElement.id.indexOf("nocol") >= 0) {
                        i = document.activeElement.id.substring(5, document.activeElement.id.length + 1);

                    }
                    else {
                        i = document.activeElement.id.substring(3, document.activeElement.id.length + 1);

                    }
                    var height = "hei" + i;
                    var width = "wid" + i;
                    var inserts = "ins" + i;
                    var insertval = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(i, 10) + 1].cells[0].innerHTML;
                    var noofcol = "nocol" + i;
                    var f = gettotalsize(height, width, i, inserts, insertval, noofcol);
                    if (f == false)
                        return false;
                }
            }
        });
        $(".btextforgriddate").change(function () {
            if (document.activeElement.id.indexOf("Text") >= 0) {
                document.getElementById('txtgrossamt').value = "";
                document.getElementById('txtbillamt').value = "";
                document.getElementById('txtgrossamtlocal').value = "";
                document.getElementById('txtbillamtlocal').value = "";
                var f = chkDateforGrid(this);
                if (f == false)
                    return false;
            }
            else if (document.activeElement.id.indexOf("rep") >= 0 || document.activeElement.id.indexOf("lat") >= 0) {
                checkdate(document.getElementById(document.activeElement.id));
            }
        });
        for (i = count; i < gridtab_vari.getElementsByTagName("tbody")[0].rows.length - 1; i++) {
            if (repeatdate == "0" || repeatdate == "1") {
                var id = "Text" + i;
                if (caldatemonth.length >= i) {
                    //   if(caldatemonth[i]!=undefined)
                    //    {
                    //var mmM=caldatemonth[i].toString();
                    //}
                    //else{
                    var mmM = parseInt(monthSelected, 10) + 1;
                    mmM = mmM.toString();
                    // }
                }
                else {
                    var mmM = parseInt(monthSelected, 10) + 1;
                    mmM = mmM.toString();
                }
                if (mmM.toString().length == 1)
                    mmM = "0" + mmM.toString();

                if (dateformat_vari.value == "mm/dd/yyyy") {
                    vvalue = mmM + "/" + dateSelected + "/" + yearSelected;
                }
                else if (dateformat_vari.value == "dd/mm/yyyy") {
                    vvalue = dateSelected + "/" + mmM + "/" + yearSelected; ;
                }
                else if (dateformat_vari.value = "yyyy/mm/dd") {
                    vvalue = yearSelected + "/" + mmM + "/" + dateSelected; ;
                }

                if (dateSelected != undefined && checkflag == 1) {
                    if (browser != "Microsoft Internet Explorer") {
                        var pkgfullname = document.getElementById('pkg_alias' + i).value;
                        var pkgid = document.getElementById('hiddenpckcode' + i).value;
                        var pkgname = document.getElementById('pkg_alias' + i).value;
                        var compcode = compcode_vari.value;

                        dateday = vvalue;

                        document.getElementById('Text' + i).value = vvalue;
                    }
                    else {
                        var pkgfullname = document.getElementById('pkg_alias' + i).value;
                        var pkgid = document.getElementById('hiddenpckcode' + i).value;
                        var pkgname = document.getElementById('pkg_alias' + i).value;
                        var compcode = compcode_vari.value;
                        dateday = vvalue;

                        document.getElementById('Text' + i).value = vvalue;
                    }
                    if (browser != "Microsoft Internet Explorer") {
                        var httpRequest = null; ;
                        httpRequest = new XMLHttpRequest();
                        if (httpRequest.overrideMimeType) {
                            httpRequest.overrideMimeType('text/xml');
                        }

                        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };
                        var adcat = adcat_vari.value;
                        httpRequest.open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
                        httpRequest.send('');
                        //alert(httpRequest.readyState);
                        if (httpRequest.readyState == 4) {
                            //alert(httpRequest.status);
                            if (httpRequest.status == 200) {
                                strtext = httpRequest.responseText;
                            }
                            else {
                                alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                            }
                        }
                    }
                    else {
                        validuse = "";
                        var xml = new ActiveXObject("Microsoft.XMLHTTP");
                        var adcat = adcat_vari;
                        var center = '';
                        if (center_vari != null) {
                            center = center_vari.value;
                            if (chkall_vari != null) {
                                if (chkall_vari.checked == true) {
                                    center = '0';
                                }
                            }
                            else {
                                center = '0';
                            }
                        }
                        xml.Open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
                        xml.Send();
                        strtext = xml.responseText;
                    }
                    if (strtext == "NOT A VALID DATE") {
                        alert("NOT A VALID DATE");
                        document.getElementById(id).value = "";
                        return false;
                    }
                    if (strtext == "0") {
                        alert("Day is not the publishing day");
                        document.getElementById(id).value = "";
                        return false;
                    }
                    else {
                        if (strtext == "1")
                            document.getElementById(id).value = vvalue;
                        else {
                            if (strtext != "") {
                                if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                                    var txt = strtext;
                                    var txt1 = txt.split("/");
                                    var dd = txt1[0];
                                    var mm1 = txt1[1];
                                    var mm = txt1[1]; //getMonthNo(mm1);
                                    var yy = txt1[2];
                                    caldate[cali] = dd;
                                    caldatemonth[cali] = mm;
                                    caldateyear[cali] = yy;
                                    cali = parseInt(cali, 10) + 1;
                                }
                                else if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                                    var txt = strtext;
                                    var txt1 = txt.split("/");
                                    var dd = txt1[1];
                                    var mm1 = txt1[0];
                                    var mm = txt1[0]; //getMonthNo(mm1);
                                    var yy = txt1[2];
                                    caldate[cali] = dd;
                                    caldatemonth[cali] = mm;
                                    caldateyear[cali] = yy;
                                    cali = parseInt(cali, 10) + 1;
                                }
                                else if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
                                    var txt = strtext;
                                    var txt1 = txt.split("/");
                                    var dd = txt1[2];
                                    var mm1 = txt1[1];
                                    var mm = txt1[1]; //getMonthNo(mm1);
                                    var yy = txt1[0];
                                    caldate[cali] = dd;
                                    caldatemonth[cali] = mm;
                                    caldateyear[cali] = yy;
                                    cali = parseInt(cali, 10) + 1;
                                }
                            }
                            document.getElementById(id).value = strtext;
                            if (vvalue != strtext) {
                                alert(vvalue + " Date is no issue date of edition " + pkgname);
                                document.getElementById(id).value = "";
                                cali = cali - 1;
                            }
                        }
                    }
                }
            }
            temp = parseInt(temp) + 1;
        }
    }
    else {
        for (i = count; i < gridtab_vari.getElementsByTagName("tbody")[0].rows.length - 1; i++) {
            var id = "Text" + i;
            var noofcol = "nocol" + i;
            var height = "hei" + i;
            var width = "wid" + i;
            var late = "lat" + i;
            var repeat = "rep" + i;
            var latedate = "latdate" + i;
            var repeatdateI = "repdate" + i;
            var page = "pgpre" + i;
            var pagstr = "sec";
            var adcat = "adcat" + i;
            var adsubcat = "ads" + i;
            var height_var = document.getElementById(height);
            var par1 = (height_var.parentNode).parentNode;
            var inserts = "ins" + i;
            var paid = "pai" + i;
            var disc = "disc_" + i;
            var boldcount = "splboldsize" + i;
            var discrate1 = "disrat" + i;
            var insertval = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(i, 10) + 1].cells[0].innerHTML;
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById(height).onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                document.getElementById(width).onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                document.getElementById(noofcol).onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                document.getElementById(late).onchange = new Function("return checkdate(Form1." + late + ");");
                document.getElementById(repeat).onchange = new Function("return checkdate(Form1." + repeat + ");");
                document.getElementById(page).onchange = new Function("return getpageprem(" + page + "," + i + ",'" + pagstr + "');");
                document.getElementById(id).onchange = new Function("return chkDateforGrid(this);");
                if (document.getElementById(paid) != undefined && document.getElementById(paid) != "undefined" && document.getElementById(paid) != null)
                    document.getElementById(paid).onchange = new Function("return blankGross();");
                if (document.getElementById(boldcount) != undefined && document.getElementById(boldcount) != "undefined" && document.getElementById(boldcount) != null)
                    document.getElementById(boldcount).onchange = new Function("return boldcountingrid();");
                if (document.getElementById(disc) != undefined && document.getElementById(disc) != "undefined" && document.getElementById(disc) != null)
                    document.getElementById(disc).onchange = new Function("return blankGross();");
                if (document.getElementById(discrate1) != undefined && document.getElementById(discrate1) != "undefined" && document.getElementById(discrate1) != null)
                    document.getElementById(discrate1).onchange = new Function("return blankGross();");
            }
            else {
                par1.all[height].onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                par1.all[width].onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                par1.all[noofcol].onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                par1.all[late].onchange = new Function("return checkdate(Form1." + late + ");");
                par1.all[repeat].onchange = new Function("return checkdate(Form1." + repeat + ");");
                par1.all[page].onchange = new Function("return getpageprem(" + page + "," + i + ",'" + pagstr + "');");
                par1.all[id].onchange = new Function("return chkDateforGrid(this);");
                if (par1.all[paid] != undefined && par1.all[paid] != "undefined" && par1.all[paid] != null)
                    par1.all[paid].onchange = new Function("return blankGross();");
                if (par1.all[boldcount] != undefined && par1.all[boldcount] != "undefined" && par1.all[boldcount] != null)
                    par1.all[boldcount].onchange = new Function("return boldcountingrid();");
                if (par1.all[disc] != undefined && par1.all[disc] != "undefined" && par1.all[disc] != null)
                    par1.all[disc].onchange = new Function("return blankGross();");
                if (par1.all[discrate1] != undefined && par1.all[discrate1] != "undefined" && par1.all[discrate1] != null)
                    par1.all[discrate1].onchange = new Function("return blankGross();");    
            }



            if (repeatdate == "0" || repeatdate == "1") {
                var id = "Text" + i;
                //    if(caldatemonth.length>=i && caldatemonth[i]!=undefined)
                //  {
                // var mmM=caldatemonth[i].toString();
                //}
                //else{
                var mmM = parseInt(monthSelected, 10) + 1;
                mmM = mmM.toString();
                //}
                if (mmM.toString().length == 1)
                    mmM = "0" + mmM.toString();
                if (dateformat_vari.value == "mm/dd/yyyy") {
                    vvalue = mmM + "/" + dateSelected + "/" + yearSelected;
                }
                else if (dateformat_vari.value == "dd/mm/yyyy") {
                    vvalue = dateSelected + "/" + mmM + "/" + yearSelected; ;
                }
                else if (dateformat_vari.value = "yyyy/mm/dd") {
                    vvalue = yearSelected + "/" + mmM + "/" + dateSelected; ;
                }


                if (dateSelected != undefined && checkflag == 1) {
                    if (browser != "Microsoft Internet Explorer") {
                        var pkgfullname = document.getElementById('pkg_alias' + i).value;
                        var pkgid = document.getElementById('hiddenpckcode' + i).value;
                        var pkgname = document.getElementById('pkg_alias' + i).value;
                        var compcode = compcode_vari.value;

                        dateday = vvalue;

                        document.getElementById('Text' + i).value = vvalue;
                    }
                    else {
                        var pkgfullname = par1.all['pkg_alias' + i].value;
                        var pkgid = par1.all['hiddenpckcode' + i].value;
                        var pkgname = par1.all['pkg_alias' + i].value;
                        var compcode = compcode_vari.value;
                        dateday = vvalue;

                        par1.all['Text' + i].value = vvalue;
                    }
                    if (browser != "Microsoft Internet Explorer") {
                        var httpRequest = null; ;
                        httpRequest = new XMLHttpRequest();
                        if (httpRequest.overrideMimeType) {
                            httpRequest.overrideMimeType('text/xml');
                        }

                        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };
                        var adcat = adcat_vari.value;
                        httpRequest.open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
                        httpRequest.send('');
                        //alert(httpRequest.readyState);
                        if (httpRequest.readyState == 4) {
                            //alert(httpRequest.status);
                            if (httpRequest.status == 200) {
                                strtext = httpRequest.responseText;
                            }
                            else {
                                alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                            }
                        }
                    }
                    else {
                        validuse = "";
                        var xml = new ActiveXObject("Microsoft.XMLHTTP");
                        var adcat = adcat_vari;
                        var center = '';
                        if (center_vari != null) {
                            center = center_vari.value;
                            if (chkall_vari != null) {
                                if (chkall_vari.checked == true) {
                                    center = '0';
                                }
                            }
                            else {
                                center = '0';
                            }
                        }
                        xml.Open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
                        xml.Send();
                        strtext = xml.responseText;
                    }
                    if (strtext == "NOT A VALID DATE") {
                        alert("NOT A VALID DATE");
                        document.getElementById(id).value = "";
                        document.getElementById(id).focus();
                        return false;
                    }
                    if (strtext == "0") {
                        alert("Day is not the publishing day");
                        document.getElementById(id).value = "";
                        return false;
                    }
                    else {
                        if (strtext == "1")
                            document.getElementById(id).value = vvalue;
                        else {
                            if (strtext != "") {
                                if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                                    var txt = strtext;
                                    var txt1 = txt.split("/");
                                    var dd = txt1[0];
                                    var mm1 = txt1[1];
                                    var mm = txt1[1]; //getMonthNo(mm1);
                                    var yy = txt1[2];
                                    caldate[cali] = dd;
                                    caldatemonth[cali] = mm;
                                    caldateyear[cali] = yy;
                                    cali = parseInt(cali, 10) + 1;
                                }
                                else if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                                    var txt = strtext;
                                    var txt1 = txt.split("/");
                                    var dd = txt1[1];
                                    var mm1 = txt1[0];
                                    var mm = txt1[0]; //getMonthNo(mm1);
                                    var yy = txt1[2];
                                    caldate[cali] = dd;
                                    caldatemonth[cali] = mm;
                                    caldateyear[cali] = yy;
                                    cali = parseInt(cali, 10) + 1;
                                }
                                else if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
                                    var txt = strtext;
                                    var txt1 = txt.split("/");
                                    var dd = txt1[2];
                                    var mm1 = txt1[1];
                                    var mm = txt1[1]; //getMonthNo(mm1);
                                    var yy = txt1[0];
                                    caldate[cali] = dd;
                                    caldatemonth[cali] = mm;
                                    caldateyear[cali] = yy;
                                    cali = parseInt(cali, 10) + 1;
                                }
                            }
                            document.getElementById(id).value = strtext;
                            if (vvalue != strtext) {
                                alert(vvalue + " Date is no issue date of edition " + pkgname);
                                document.getElementById(id).value = "";
                                cali = cali - 1;
                            }
                        }
                    }
                }
            }
            temp = parseInt(temp) + 1;
        }
    }

    // str= str + "</table></div>";
    checkflag = "0";
    previnsertion = document.getElementById('txtinsertion').value;
    fillcopyfilename();
    constructCalendar();
    noissueflag = false;
    return false;
}

function onRepeatingDate() {
    if (document.getElementById('txtrepeatingdate').value != '') {
        if (document.getElementById('txtinsertion').value == "0") {
            alert("Insertion can't be 0");
            return false;
        }
        if (document.getElementById('txtdummydate').value == "") {
            alert("Please enter Date");
            document.getElementById('txtdummydate').focus();
            return false;
        }
        document.getElementById('txtgrossamt').value = '';
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        var adcat3 = document.getElementById('drpadcat3').value;
        var adcat4 = document.getElementById('drpadcat4').value;
        var adcat5 = document.getElementById('drpadcat5').value;
        var clientname = document.getElementById('txtclient').value;
        var client_split;
        if (clientname.indexOf("(") >= 0) {
            clientname = clientname.split("(");
            client_split = clientname[1];
            client_split = client_split.replace(")", "");
            clientname = client_split;

        }
        //////////////this code is to split the code as well as ites description 

        ///////this is to get the value into paid ins. text b0x
        if (document.getElementById('txtpaid').value != "") {
            var paidno = document.getElementById('txtpaid').value;
            var valinsert = document.getElementById('txtinsertion').value;
            document.getElementById('txtpaid').value = (parseInt(valinsert) - parseInt(paidno)) + parseInt(paidno);
        }

        var objpack = document.getElementById('drppackagecopy');
        var temp = "";
        var tempcode = "";
        var tempval = "";
        var tempvalcode = "";
        var desc = "";
        var code = "";
        var i = objpack.options.length;
        var j;

        for (j = 0; j < i; j++) {
            if (parseInt(i) > 0) {
                tempval = objpack[j].value;

                //tempvalcode=objpack[j].value;
                if (temp != "") {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    code = tempvalcode + "," + code;
                    desc = tempcode + "," + desc;


                }
                else {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    code = tempvalcode;
                    desc = tempcode;
                }
            }

        }



        if (document.getElementById('txtrepeatingdate').value != "") {
            var insertval = document.getElementById('txtinsertion').value
            if (parseInt(document.getElementById('txtinsertion').value) == 1) {
                //alert("In case of Insertion 1Repeating Day can't be greater than 1")
                if (document.getElementById('drppackagecopy').options.length > 0) {
                    for (var insertCou = 0; insertCou < document.getElementById('drppackagecopy').options.length; insertCou++) {
                        if (document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') >= 0) {
                            var tinsert = document.getElementById('drppackagecopy').options[insertCou].value.substring(document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') + 1, document.getElementById('drppackagecopy').options[insertCou].value.indexOf(')'));
                            if (tinsert > 1)
                                break;
                        }
                    }
                }
                if (tinsert <= 1) {
                    document.getElementById('txtrepeatingdate').value = "";
                    return false;
                }
            }

            repeatdate = "1";
            suboradd = "1";
        }
        else {
            repeatdate = "0";
            suboradd = "1";
        }
        if (parseInt(previnsertion) > parseInt(document.getElementById('txtinsertion').value)) {
            repeatdate = "1";
            suboradd = "0";
        }
        if (repeatdate == "1") {
            //document.getElementById('tblinsert').innerHTML="";
            subtractrow = "";
        }
        if (parseInt(document.getElementById('txtinsertion').value) > parseInt(previnsertion)) {
            suboradd = "1";
        }

        var insert = document.getElementById('hiddeninserts').value;
        var class_insert = document.getElementById('txtinsertion').value;

        var center = "0";

        var lines_to;
        if (document.getElementById('txtadsize1').disabled == false) {
            lines_to = "";
        }
        else {
            lines_to = document.getElementById('txttotalarea').value;
        }
        //if(document.getElementById('tblinsert').innerHTML=="")


        //QBC.getData_fill(desc,document.getElementById('txtinsertion').value,document.getElementById('txtrepeatingdate').value,document.getElementById('txtdummydate').value,document.getElementById('hiddendateformat').value,document.getElementById('hiddencompcode').value,document.getElementById('drpadcategory').value,document.getElementById('drpadsubcategory').value,document.getElementById('drpcolor').value,document.getElementById('drpadtype').value,document.getElementById('hiddencurrency').value,document.getElementById('txtratecode').value,document.getElementById('hiddenclickdate').value,insert,code,document.getElementById('txtcardrate').value,document.getElementById('drpuom').value,document.getElementById('txtdealrate').value,check_or,class_insert,lines_to,adcat3,adcat4,adcat5,clientname,document.getElementById('hiddenuserid').value,center,callback_repeatingdan);
        Classified_Booking.getData(desc, document.getElementById('txtinsertion').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, "CL0", document.getElementById('drpcurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname, callback_repeatingdan);
    }

}

function callback_repeatingdan(res) {
    var ds = res.value;
    var i = 0;
    if (ds == null) {
        return false;
    }
    var dateformat_vari = document.getElementById("hiddendateformat");
    var compcode_vari = document.getElementById('hiddencompcode');
    var adcat = document.getElementById('drpadcategory').value;
    var inew = 0;
    for (inew = 0; inew < ds.Tables[0].Rows.length; inew++) {
        var dCheck = checkValidEdition(ds.Tables[0].Rows[inew].Edition_Name, ds.Tables[0].Rows[inew].EDITION_CODE);
        // var dCheck=true;
        if (dCheck == true) {
            var val_ue = "1";
            var pkg_id = "0";
            var strtext = "";
            pkg_id = document.getElementById('hiddenpckcode' + i);
            var pkgalias = document.getElementById('pkg_alias' + i);
            var pkgname = document.getElementById("edit" + i).value;
            pkgname = pkgname.replace("+", "^");
            if (browser != "Microsoft Internet Explorer") {
                var httpRequest = null; ;
                httpRequest = new XMLHttpRequest();
                if (httpRequest.overrideMimeType) {
                    httpRequest.overrideMimeType('text/xml');
                }

                httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

                httpRequest.open("GET", "packagename.aspx?pkgalias=" + pkgalias.value + "&adcat=" + adcat + "&pkgid=" + pkg_id.value + "&compcode=" + compcode_vari.value + "&value=" + val_ue + "&dateday=" + ds.Tables[0].Rows[inew].Date + "&pkgname=" + ds.Tables[0].Rows[inew].Edition_Name, false);
                httpRequest.send('');
                //alert(httpRequest.readyState);
                if (httpRequest.readyState == 4) {
                    //alert(httpRequest.status);
                    if (httpRequest.status == 200) {
                        strtext = httpRequest.responseText;
                    }
                    else {
                        alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                    }
                }
            }
            else {
                validuse = "";
                var xml = new ActiveXObject("Microsoft.XMLHTTP");
                var adcat = document.getElementById('drpadcategory').value;
                xml.Open("GET", "packagename.aspx?pkgalias=" + pkgalias.value + "&adcat=" + adcat + "&pkgid=" + pkg_id.value + "&compcode=" + compcode_vari.value + "&value=" + val_ue + "&dateday=" + ds.Tables[0].Rows[inew].Date + "&pkgname=" + ds.Tables[0].Rows[inew].Edition_Name, false);
                xml.Send();
                strtext = xml.responseText;
            }

            var text_var = document.getElementById("Text" + i);
            if (strtext != "" && strtext != "1" && strtext != "0" && strtext != null && strtext != "NOT A VALID DATE") {

                if (text_var != null) {

                    if (ds.Tables[0].Rows[inew].Date != strtext) {
                        alert(ds.Tables[0].Rows[inew].Date + " Date is no issue date of edition " + pkgname);
                        document.getElementById("Text" + i).value = "";
                        cali = cali - 1;
                    }
                    else
                        text_var.value = strtext;
                }
                //28-sep-2011 (in case of uganda testing )
                //               for(y=i+1;y<ds.Tables[0].Rows.length;y++)
                //               {
                //                    if(ds.Tables[0].Rows[y].Edition_Name==ds.Tables[0].Rows[inew].Edition_Name)
                //                    {
                //                        var mm,dd,yy;
                //                        if (dateformat_vari.value == "dd/mm/yyyy")
                //                        {
                //                             var dk1=ds.Tables[0].Rows[y].Date.split("/")
                //                             dt=new Date(dk1[1] + '/' + dk1[0] + '/' + dk1[2]);
                //                             dt.setDate(dt.getDate() + 1);
                //                             if(dt.getDate().toString().length==1)
                //                                dd="0" + dt.getDate().toString();
                //                             else
                //                                 dd=dt.getDate().toString();
                //                                 
                //                              if((dt.getMonth()+1).toString().length==1)
                //                                mm="0" + (dt.getMonth()+1).toString();
                //                             else
                //                                 mm=(dt.getMonth()+1).toString();
                //                                 
                //                                yy=dt.getFullYear().toString();
                //                             ds.Tables[0].Rows[y].Date=dd + '/' + mm + '/' + yy;
                //                        }
                //                        if (dateformat_vari.value == "mm/dd/yyyy")
                //                        {
                //                              dt=new Date(ds.Tables[0].Rows[y].Date);
                //                              dt.setDate(dt.getDate() + 1);
                //                              if(dt.getDate().toString().length==1)
                //                                dd="0" + dt.getDate().toString();
                //                             else
                //                                 dd=dt.getDate().toString();
                //                                 
                //                              if((dt.getMonth()+1).toString().length==1)
                //                                mm="0" + (dt.getMonth()+1).toString();
                //                             else
                //                                 mm=(dt.getMonth()+1).toString();
                //                                 
                //                                yy=dt.getFullYear().toString();
                //                                
                //                              ds.Tables[0].Rows[y].Date=mm + '/' + dd + '/' + yy;
                //                        }
                //                        if (dateformat_vari.value == "yyyy/mm/dd")
                //                        {
                //                             // var dk1=ds.Tables[0].Rows[y].Date.split("/")
                //                              dt=new Date(ds.Tables[0].Rows[y].Date);
                //                              //dt=new Date(dk1[2] + '/' + dk1[1] + '/' + dk1[0]   );
                //                              dt.setDate(dt.getDate() + 1);
                //                              if(dt.getDate().toString().length==1)
                //                                dd="0" + dt.getDate().toString();
                //                             else
                //                                 dd=dt.getDate().toString();
                //                                 
                //                              if((dt.getMonth()+1).toString().length==1)
                //                                mm="0" + (dt.getMonth()+1).toString();
                //                             else
                //                                 mm=(dt.getMonth()+1).toString();
                //                                 
                //                                yy=dt.getFullYear().toString();
                //                                
                //                              ds.Tables[0].Rows[y].Date=yy + '/' + mm + '/' + dd ;
                //                        }
                //       
                //       
                //                    }
                //               }

            }
            else {
                if (text_var != null)
                    text_var.value = ds.Tables[0].Rows[inew].Date;
            }
            i = parseInt(i, 10) + 1;
        }
    }
}


function changebilldiv() {
    if (document.getElementById('LinkButton3').disabled == true)
        return false;
    if (enLink == "1") {
        document.getElementById('LinkButton1').disabled = false;
        document.getElementById('LinkButton2').disabled = false;
        document.getElementById('LinkButton3').disabled = false;
        document.getElementById('LinkButton4').disabled = false;
        document.getElementById('LinkButton5').disabled = false;
        document.getElementById('LinkButton6').disabled = false;
        document.getElementById('LinkButton7').disabled = false;
    }
    if (document.getElementById('LinkButton3').disabled == false) {
        if (document.getElementById('txtagency').value == "") {
            alert("Please fill the agency name");
            document.getElementById('txtagency').focus();
            return false;
        }
        else if (document.getElementById('drpagscode').value == "" || document.getElementById('drpagscode').value == "0") {
            alert("Please select the agency sub code");
            document.getElementById('drpagscode').focus();
            return false;
        }
        if (document.getElementById('txtrono').value != "" && document.getElementById('txtrono').disabled == false) {
            if (document.getElementById('txtrodate').value == "") {
                alert("Please fill ro date");
                document.getElementById('txtrodate').focus();
                return false;
            }

        }
        if (document.getElementById('LinkButton1').disabled == false) {
            if (document.getElementById('drpretainer').disabled == false) {
                if (document.getElementById('drpretainer').value == "" && document.getElementById('txtexecname').value == "") {
                    var a = "Executive name";
                    var b = "Retainer";
                    if (browser != "Microsoft Internet Explorer") {
                        a = document.getElementById('lbececname').textContent.replace("*[F2]", "");
                        b = document.getElementById('lblretainer').textContent.replace("*[F2]", "");
                    }
                    else {
                        a = document.getElementById('lbececname').innerText.replace("*[F2]", "");
                        b = document.getElementById('lblretainer').innerText.replace("*[F2]", "");
                    }
                    alert('Please fill ' + a + ' or ' + b + '.');

                    document.getElementById('drpretainer').focus();
                    return false;
                }
            }
        }
        if (document.getElementById('drpbooktype').value == "0") {
            alert("Please Select Booking Type");
            return false;
        }
        if (document.getElementById('drpcolor').value == "0") {
            alert("Please Select Color");
            return false;
        }
        if (document.getElementById('drpadcategory').value == "0") {
            alert("Please Select Ad Category");
            return false;
        }
        if (browser != "Microsoft Internet Explorer") {
            chmandat = document.getElementById('lbadscat').textContent;
        }
        else {
            chmandat = document.getElementById('lbadscat').innerText;
        }
        if (chmandat.indexOf('*') >= 0) {
            if (document.getElementById('drpadsubcategory').value == "0") {
                alert("Please Select Ad Sub Category");
                document.getElementById('drpadsubcategory').focus();
                return false;
            }
        }
        if (document.getElementById('drpuom').value == "0") {
            alert("Please Select UOM");
            return false;
        }
        if (document.getElementById('drppackagecopy').options.length == 0) {
            alert("Please Select Package");
            return false;
        }
        if (document.getElementById('txtdummydate').value == "") {
            alert("Please Enter Date");
            return false;
        }
        if (document.getElementById('drpcurrency').value == "0" || document.getElementById('drpcurrency').value == "") {
            alert("Please Select Currency");
            return false;
        }
        if (document.getElementById('drprptcurrency').value == "0" || document.getElementById('drprptcurrency').value == "") {
            alert("Please Select Receipt Currency");
            return false;
        }
        if (document.getElementById('txttotalarea').value == "" && document.getElementById('hidlineedit').value == "y") {
            alert("Please Enter Size/Lines/Words");
            return false;
        }
        if (document.getElementById('txtratecode').value == "0") {
            alert("Please Select Rate Code");
            return false;
        }
        document.getElementById('LinkButton3').style.fontWeight = "bold";
        document.getElementById('LinkButton3').style.color = "#FFFF80";
        document.getElementById('LinkButton1').style.fontWeight = "normal";
        document.getElementById('LinkButton1').style.color = "White";
        document.getElementById('LinkButton2').style.fontWeight = "normal";
        document.getElementById('LinkButton2').style.color = "White";
        document.getElementById('LinkButton5').style.fontWeight = "normal";
        document.getElementById('LinkButton5').style.color = "White";
        document.getElementById('LinkButton4').style.fontWeight = "normal";
        document.getElementById('LinkButton4').style.color = "White";
        document.getElementById('LinkButton6').style.fontWeight = "normal";
        document.getElementById('LinkButton6').style.color = "White";
        document.getElementById('LinkButton7').style.fontWeight = "normal";
        document.getElementById('LinkButton7').style.color = "White";
        document.getElementById('tbvts').style.display = "none";
        //alert(document.getElementById('LinkButton1').click);
        document.getElementById('tblrate').style.display = "none";
        //document.getElementById('tblbill').style.display="none";
        document.getElementById('tblbill').style.display = "block";
        if (document.getElementById('drpbillcycle').disabled == false) {
            document.getElementById('drpbillcycle').focus();
        }
        document.getElementById('addetails').style.display = "none";
        document.getElementById('pagedetail').style.display = "none";
        document.getElementById('tblpackage').style.display = "none";
        document.getElementById('tbbox').style.display = "none";
        document.getElementById('tbvts').style.display = 'none';
        //this  is to calculate the bill amount 
        /*   if(document.getElementById('txtagreedamt').value!="")
        {
        var agamt=document.getElementById('txtgrossamt').value;
        var tradisc=document.getElementById('txttradedisc').value;
        if(tradisc=="")
        tradisc=0;
        var trdisc1=tradisc;
        var addcomm =0;
        if(document.getElementById('txtaddagencycommrate')!=null)
        {
        addcomm=document.getElementById('txtaddagencycommrate').value;
        }
        if(addcomm=="")
        {
        addcomm="0";
        }
        if(addcomm!="0")
        {
        trdisc1=parseInt(tradisc) + parseInt(addcomm);
        }
        var tot1=0;
        var tot=0;
        var tota=0;
        if(document.getElementById('agncomm_seq_com').value!="S")
        {
        tot1=(parseFloat(trdisc1))/100;
        tot=parseFloat(agamt)*parseFloat(tot1);
        tota=parseFloat(agamt)-parseFloat(tot);
        }
        else
        {
        tot1=(parseFloat(tradisc))/100;
        tot=parseFloat(agamt)*parseFloat(tot1);
        tota=parseFloat(agamt)-parseFloat(tot);
        if(addcomm!="0" && addcomm!="")
        {
        tot1=(parseFloat(addcomm))/100;
        tot=parseFloat(tota)*parseFloat(tot1);
        tota=parseFloat(tota)-parseFloat(tot);
        } 
		            
        }
        document.getElementById('txtbillamt').value=tota.toFixed(2);
        }
        else 
        {
        if(document.getElementById('txtcardamt').value!="" && document.getElementById('txttradedisc').value!="")
        {
        var caramt=document.getElementById('txtgrossamt').value;
        var tradisc=document.getElementById('txttradedisc').value;
        if(tradisc=="")
        tradisc=0;
        var trdisc1=tradisc;
        var addcomm =0;
        if(document.getElementById('txtaddagencycommrate')!=null)
        {
        addcomm=document.getElementById('txtaddagencycommrate').value;
        }
        if(addcomm=="")
        {
        addcomm="0";
        }
        if(addcomm!="0")
        {
        trdisc1=parseInt(tradisc) + parseFloat(addcomm);
        }
        var tot=0;
        if(document.getElementById('agncomm_seq_com').value!="S")
        tot=parseFloat(caramt)-parseFloat(caramt)*parseFloat(trdisc1)/100;
        else
        {
        tot=parseFloat(caramt)-parseFloat(caramt)*parseFloat(tradisc)/100;
        if(addcomm!="0")
        tot=parseFloat(tot)-parseFloat(tot)*parseFloat(addcomm)/100;
        }
		                
		                
        document.getElementById('txtbillamt').value=tot.toFixed(2);
        }		        
        }*/
        //////		        if(document.getElementById('drpbooktype').value=="2" || document.getElementById('drpbooktype').value=="4" || document.getElementById('drpbooktype').value=="5")  
        //////		        {
        //////		            document.getElementById('txtbillamt').value="0";		
        //////		        }
        //////		        if(document.getElementById('txtbillamt').value=="NaN")
        //////                {
        //////                    document.getElementById('txtbillamt').value="";
        //////                }
        //                if(document.getElementById('txtagencypaymode').value!="")
        //		            document.getElementById('drppaymenttype').value=document.getElementById('txtagencypaymode').value;

        document.getElementById('tdrec').style.display = "none";
        //bind paymenttype of bill details div
        //               if(document.getElementById('txtagencypaymode').value!="")
        //                   document.getElementById('drppaymenttype').value=document.getElementById('txtagencypaymode').value;
        if (document.getElementById('hiddensavemod').value == "1") {
            if (document.getElementById('txtagencypaymode').value == "CR1" && document.getElementById('creditreceipt_allow').value == "N") {
                document.getElementById('tdrec').style.display = "none";
                document.getElementById('receipt').style.display = "none";
                document.getElementById('print').style.display = "none";
            }
            else {
                document.getElementById('tdrec').style.display = "";
                document.getElementById('receipt').style.display = "";
                document.getElementById('print').style.display = "";
            }
        }
        else {
            document.getElementById('tdrec').style.display = "none";
            document.getElementById('receipt').style.display = "none";
            document.getElementById('print').style.display = "none";
        }
        //booking type is for FMG then bill amount =0
        //////		         if(browser!="Microsoft Internet Explorer")
        //////            {
        //////               if((document.getElementById('drpbooktype').options[document.getElementById('drpbooktype').selectedIndex].textContent).toUpperCase()=="FMG")
        //////                  document.getElementById('txtbillamt').value="0";
        //////             }
        //////             else
        //////             {
        //////                   if((document.getElementById('drpbooktype').options[document.getElementById('drpbooktype').selectedIndex].innerHTML).toUpperCase()=="FMG")
        //////                  document.getElementById('txtbillamt').value="0";
        //////             }     
        ////////////////////////////////////////
        //if()
        return false;
    }
}

function FillSubCatinGrid() {

    if (activeid.indexOf("pai") == 0) {
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtbillamt').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
    }
    else if (activeid.indexOf("inssta") == 0) {
        document.getElementById(activeid).value = document.getElementById('aglist').value;
        if (document.getElementById(activeid) != null) {
            if (document.getElementById(activeid).value == "hold" && document.getElementById('aglist').value == "booked") {
                document.getElementById('txtgrossamt').value = document.getElementById('txtgrossamt').value;
                document.getElementById('txtbillamt').value = document.getElementById('txtbillamt').value;
            }
            else if (document.getElementById(activeid).value == "booked" && document.getElementById('aglist').value == "hold") {
                document.getElementById('txtgrossamt').value = document.getElementById('txtgrossamt').value;
                document.getElementById('txtbillamt').value = document.getElementById('txtbillamt').value;
            }
            else {
                document.getElementById('txtgrossamt').value = "";
                document.getElementById('txtbillamt').value = "";
                document.getElementById('txtgrossamtlocal').value = "";
                document.getElementById('txtbillamtlocal').value = "";
            }
            // if(document.getElementById(activeid).value!="hold")
            // {
            // document.getElementById('txtgrossamt').value="";
            // document.getElementById('txtbillamt').value="";
            //}
            // document.getElementById(document.activeElement.id).value="Y";
        }
        if (document.getElementById('aglist').value != "")
            document.getElementById(activeid).value = document.getElementById('aglist').value;
        document.getElementById(activeid).style.backgroundColor = "#FFFFFF";
        document.getElementById('agdiv').style.display = "none";
        var id = activeid.replace("inssta", "pai");
        if (document.getElementById(id) != null) {
            //	                document.getElementById(id).value="Y";
        }
        if (activeid.indexOf("inssta") == 0) {
            var idcode = activeid;
            idcode = idcode.replace("inssta", "");
            var id = activeid.replace("inssta", "ins");

            var d_ = document.getElementById(id).innerHTML;
            id = activeid.replace("inssta", "hiddenpckcode");
            var pkgcode = document.getElementById(id).value;
            var y = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length;
            var i = 0;
            var t_flag = true;
            for (i = 0; i < y - 1; i++) {

                if (idcode != i && document.getElementById("ins" + i).innerHTML == d_ && document.getElementById("hiddenpckcode" + i).value == pkgcode && (document.getElementById('aglist').value == "cancel" || document.getElementById('aglist').value == "booked")) {
                    if (document.getElementById("inssta" + i).disabled == false && (document.getElementById("inssta" + i).value == "hold" || document.getElementById("inssta" + i).value == "booked" || document.getElementById("inssta" + i).value == "cancel"))
                        document.getElementById("inssta" + i).value = document.getElementById('aglist').value;
                    else {

                        t_flag = false;
                        while (document.getElementById("ins" + i).innerHTML == d_ && document.getElementById("hiddenpckcode" + i).value == pkgcode && document.getElementById("inssta" + i).value == "cancel") {
                            document.getElementById("inssta" + i).value == document.getElementById('aglist').value;
                            i--;
                            if (i < 0)
                                break;
                        }
                        i = y;
                    }
                }
                if (document.getElementById("ins" + i) != null && parseInt(document.getElementById("ins" + i).innerHTML, 10) > d_)
                    i = y;
            }
        }
    }
    else {
        if (activeid.indexOf("inssta") == 0) {
            var id = activeid.replace("inssta", "pai");
            if (document.getElementById(id) != null) {
                document.getElementById(id).value = "Y";
            }
        }
        if (activeid.indexOf("adcat") == 0) {
            var id = activeid.replace("adcat", "ads");
            document.getElementById(id).value = "";
        }
        else if (activeid.indexOf("pgpre") == 0) {
            var res = Classified_Booking.getpageamount(document.getElementById(activeid).value, document.getElementById('hiddencompcode').value);
            if (res.value != null) {
                var ds = res.value;
                var id = activeid.replace("pgpre", "pagper");
                if (ds.Tables[0].Rows.length > 0) {
                    if (document.getElementById("pagper" + i) != null)
                        document.getElementById(id).value = ds.Tables[0].Rows[0].Amount;
                }
                else {
                    if (document.getElementById("pagper" + i) != null)
                        document.getElementById(id).value = "";
                }
            }
        }
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtbillamt').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        document.getElementById(activeid).style.backgroundColor = "#FFFFFF";
        if (activeid.indexOf("adsdiv") == 0 || activeid.indexOf("coldiv") == 0 || activeid.indexOf("divinssta") == 0 || activeid.indexOf("adcatdiv") == 0) {
            document.getElementById(activeid).value = document.getElementById('aglistpop').value;
            document.getElementById('agdivpop').style.display = "none";
        }
        else {
            document.getElementById(activeid).value = document.getElementById('aglist').value;
            document.getElementById('agdiv').style.display = "none";
            //	       if (activeid.indexOf("col") == 0) {
            //	           var id = activeid.replace("col", "ins");
            //	           var d_ = document.getElementById(id).innerHTML;
            //	           id = activeid.replace("col", "hiddenpckcode");
            //	           var pkgcode = document.getElementById(id).value;
            //	           var y = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length;
            //	           var i = 0;
            //	           for (i = 0; i < y - 1; i++) {

            //	               if (document.getElementById("ins" + i).innerHTML == d_ && document.getElementById("hiddenpckcode" + i).value == pkgcode) {
            //	                   document.getElementById("col" + i).value = document.getElementById('aglist').value;
            //	               }
            //	               if (parseInt(document.getElementById("ins" + i).innerHTML, 10) > d_)
            //	                   i = y;
            //	           }
            //	       }
            //	       else if (activeid.indexOf("ads") == 0) {
            //	           var id = activeid.replace("ads", "ins");
            //	           var d_ = document.getElementById(id).innerHTML;
            //	           id = activeid.replace("ads", "hiddenpckcode");
            //	           var pkgcode = document.getElementById(id).value;
            //	           var y = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length;
            //	           var i = 0;
            //	           for (i = 0; i < y - 1; i++) {

            //	               if (document.getElementById("ins" + i).innerHTML == d_ && document.getElementById("hiddenpckcode" + i).value == pkgcode) {
            //	                   document.getElementById("ads" + i).value = document.getElementById('aglist').value;
            //	               }
            //	               if (parseInt(document.getElementById("ins" + i).innerHTML, 10) > d_)
            //	                   i = y;
            //	           }
            //	       }
            if (activeid.indexOf("inssta") == 0) {
                var idcode = activeid;
                idcode = idcode.replace("inssta", "");
                var id = activeid.replace("inssta", "ins");

                var d_ = document.getElementById(id).innerHTML;
                id = activeid.replace("inssta", "hiddenpckcode");
                var pkgcode = document.getElementById(id).value;
                var y = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length;
                var i = 0;
                var t_flag = true;
                for (i = 0; i < y - 1; i++) {

                    if (idcode != i && document.getElementById("ins" + i).innerHTML == d_ && document.getElementById("hiddenpckcode" + i).value == pkgcode && (document.getElementById('aglist').value == "cancel" || document.getElementById('aglist').value == "booked")) {
                        if (document.getElementById("ins" + i).disabled == false && (document.getElementById("inssta" + i).value == "hold" || document.getElementById("inssta" + i).value == "booked" || document.getElementById("inssta" + i).value == "cancel"))
                            document.getElementById("inssta" + i).value = document.getElementById('aglist').value;
                        else {

                            t_flag = false;
                            while (document.getElementById("ins" + i).innerHTML == d_ && document.getElementById("hiddenpckcode" + i).value == pkgcode && document.getElementById("inssta" + i).value == "cancel") {
                                document.getElementById("inssta" + i).value == document.getElementById('aglist').value;
                                i--;
                                if (i < 0)
                                    break;
                            }
                            i = y;
                        }
                    }
                    if (document.getElementById("ins" + i) != null && parseInt(document.getElementById("ins" + i).innerHTML, 10) > d_)
                        i = y;
                }
            }
            //	       else if (activeid.indexOf("adcat") == 0) {
            //	           var id = activeid.replace("adcat", "ins");
            //	           var d_ = document.getElementById(id).innerHTML;
            //	           id = activeid.replace("adcat", "hiddenpckcode");
            //	           var pkgcode = document.getElementById(id).value;
            //	           var y = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length;
            //	           var i = 0;
            //	           for (i = 0; i < y - 1; i++) {

            //	               if (document.getElementById("ins" + i).innerHTML == d_ && document.getElementById("hiddenpckcode" + i).value == pkgcode) {
            //	                   document.getElementById("adcat" + i).value = document.getElementById('aglist').value;
            //	               }
            //	               if (parseInt(document.getElementById("ins" + i).innerHTML, 10) > d_)
            //	                   i = y;
            //	           }
            //	       }
            ////bhanu start
            if (document.getElementById("resno0") != null && document.getElementById("seccode0") != null && (document.getElementById("resno0").value != "" || document.getElementById("seccode0").value)) {
                if (confirm("Do You want to copy in same Edition"))/* {
                    count = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
                    itemlinecnt = parseInt(count) / parseInt(document.getElementById('txtinsertion').value);
                    count = count - itemlinecnt;
                    filid = itemlinecnt;
                    var filemidid = 2;
                    //var filelastid=parseInt(itemlinecnt)+1;
                    var tCount = 0;
                    var counterT = 0;
                    var ins_vari = document.getElementById('ins' + counterT);
                    if (ins_vari != null) {
                        while (parseInt(ins_vari.innerHTML) == "1") {
                            tCount = parseInt(tCount) + 1;
                            counterT = parseInt(counterT) + 1;
                            ins_vari = document.getElementById('ins' + counterT);
                            if (ins_vari == null)
                                break;
                        }
                    }
                    for (var i = 1; i <= count; i = i + itemlinecnt) {
                        for (var j = 0; j < itemlinecnt; j++) {
                            if (document.getElementById("resno" + filid).value == "") {
                                document.getElementById("resno" + filid).value = document.getElementById("resno" + j).value;
                            }
                            if (document.getElementById("seccode" + filid).value == "") {
                                document.getElementById("seccode" + filid).value = document.getElementById("seccode" + j).value;
                            }
                            filid = filid + 1;
                        }
                        filemidid = filemidid + 1;
                    }
                }*/
                     {
                        // count = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
                        count = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length;
                        itemlinecnt = (parseInt(count) / (parseInt(document.getElementById('txtinsertion').value))) - 1;
                        count = count - itemlinecnt;
                        filid = itemlinecnt;
                        var filemidid = 2;
                        var filelastid = parseInt(itemlinecnt) + 1;
                        var tCount = 0;
                        var counterT = 0;
                        var ins_vari = document.getElementById('ins' + counterT);
                        if (ins_vari != null) {
                            while (parseInt(ins_vari.innerHTML) == "1") {
                                tCount = parseInt(tCount) + 1;
                                counterT = parseInt(counterT) + 1;
                                ins_vari = document.getElementById('ins' + counterT);
                                if (ins_vari == null)
                                    break;
                            }
                        }
                        for (var i = 1; i < filid; i++) {
                            // for (var j = 0; j < itemlinecnt; j++) {
                            if (document.getElementById("resno" + i).value == "") {
                                document.getElementById("resno" + i).value = document.getElementById("resno" + 0).value;
                            }
                            if (document.getElementById("seccode" + i).value == "") {
                                document.getElementById("seccode" + i).value = document.getElementById("seccode" + 0).value;
                                //  }
                                // filid = filid + 1;
                            }
                            filemidid = filemidid + 1;
                        }
                    }
            }
            ///bhanu end
        }

    }
}

function enableGridItems() {

    var count1 = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
    document.getElementById('uploadA').style.color = "red";
    document.getElementById('uploadA').style.cursor = "pointer";
    document.getElementById('uploadA').disabled = false;
    var uom_vari = document.getElementById('drpuom');
    var hiddenuomdesc_vari = document.getElementById('hiddenuomdesc');
    var column_vari = document.getElementById('txtcolum');
    for (var i = 0; i < count1; i++) {
        var noofcol = "nocol" + i;
        var height = "hei" + i;
        var width = "wid" + i;
        var late = "lat" + i;
        var repeat = "rep" + i;
        var paid = "pai" + i;
        var page = "pgpre" + i;
        var pagstr = "sec";
        var adcat = "adcat" + i;
        var adsubcat = "ads" + i;
        var matsta = "mat" + i;
        var insertsta = "inssta" + i;
        var colid = "col" + i;
        var textid = "Text" + i;
        var upl = "upload" + i;
        var textid_vari = document.getElementById(textid);
        var par1 = (textid_vari.parentNode).parentNode;
        //   textid_vari.disabled=false;
        if (browser != "Microsoft Internet Explorer") {
            document.getElementById(colid).disabled = false;
        }
        else {
            par1.all[colid].disabled = false;
        }
        //            par1.all[upl].disabled=false;
        //           par1.all[adcat].disabled=false;
        //           par1.all[adsubcat].disabled=false;
        //            par1.all[late].disabled=false;
        //            par1.all[repeat].disabled=false;
        //            par1.all[matsta].disabled=false;
        //             par1.all[insertsta].disabled=false;
        //              par1.all[page].disabled=false;
        //              par1.all[paid].disabled=false;
        //            if(uom_vari.value!="0" && hiddenuomdesc_vari.value!="CD")
        //            {
        //                par1.all[height].disabled=true;
        //                par1.all[width].disabled=true;
        //                par1.all[noofcol].disabled=true;
        //                
        //            }
        //               else
        //               {
        //                    if(column_vari.disabled==true)
        //                    {
        //                        par1.all[height].disabled=false;
        //                        par1.all[width].disabled=false;
        //                        par1.all[noofcol].disabled=true;
        //                    }
        //                    else
        //                    {
        //                       par1.all[height].disabled=false;
        //                       par1.all[width].disabled=false;
        //                       par1.all[noofcol].disabled=false;
        //                    }
        //                }
    }
}
function clearClick() {
    document.getElementById('txtquotationno').value = "";
    document.getElementById('txtquotationno').disabled = true;
    document.getElementById('multibilling_div').innerHTML = "";
    document.getElementById('multibilling_div').style.display = "none";
    document.getElementById('showteamdiv').innerHTML = "";
    online_flag = false;
    vat_app = 0;
    cioprevgst="";
    globfromline = "";
    bill_comp_amt = "";
    hdntranschgon="";
    fixed_booking = "N";
    if (roundoff == "editionwise")
        roundoff = "insertionwise";
    rostatusmain = "";
    agreedrate_active = 0;
    agreedamt_active = 0;
    hiddisctype = "";
    modifydtcount = 1;
    sharepub = "";
    noissueflag = false;
    document.getElementById('chkonline').disabled = true;
    document.getElementById('chkonline').checked = false;
    document.getElementById('hidcurrency_convrate').value = "";
    document.getElementById('hiddenbillamt').value = "";
    document.getElementById('hiddenrateauditflag').value = "";
    document.getElementById('txtagreedrate').className = ' btextforbookrightsmall';
    document.getElementById('txtagreedamt').className = ' btextforbookrightsmall';
    document.getElementById('btnfmg').disabled = true;
    document.getElementById('hiddenagcommflag').value = "";
    document.getElementById('hidattach1').value = "";
    document.getElementById('attachment1').src = "Images/index.jpeg"
    document.getElementById('hidattach2').value = "";
    document.getElementById('attachment2').src = "Images/index.jpeg"
    document.getElementById('txtcashdiscount').value = "";
    document.getElementById('txtcontactperson').disabled = true;
    document.getElementById('txtcontactperson').value = "";
    document.getElementById('hiddencashrecieved').value = "";
    activeD = "";
    paivar = "";
    hidcopy = "";
    boxpercen = "";
    dateSelected = "";
    monthSelected = "";
    yearSelected = "";
    arrEdition_Item = '';
    schemeid = "";
    chkbtnStatus = "";
    multiselect = "";
    multicode = "";
    filterins = "";
    hideCalendar();
    caldate = null;
    caldate = new Array();
    caldatemonth = null;
    caldatemonth = new Array();
    caldateyear = null;
    caldateyear = new Array();
    if (document.getElementById('regclient').style.display != 'none')
        document.getElementById('regclient').style.display = 'none';

    document.getElementById('lbreference').style.display = "none";
    document.getElementById('tdref').style.display = "none";
    document.getElementById("div2").style.display = "none";
    document.getElementById('txtagaddf2').value = "";
    document.getElementById("div4").style.display = "none";
    document.getElementById('txtcliaddf2').value = "";	
    document.getElementById('txtcolexec').value = "";
    //  document.getElementById('btnrefid').style.display="none";
    document.getElementById('lblcreationdatetime').innerHTML = ""
    document.getElementById('drpregular').value = "0";
    document.getElementById('drpregular').disabled = true;
    document.getElementById('drptranslation').value = "0";
    document.getElementById('txttranslationcharges').value = "";
    document.getElementById('txttranslationdisc').value = "";
    document.getElementById('txttranslationdisc').disabled = true;
    document.getElementById('txtpospremdisc').value = "";
    document.getElementById('txtpospremdisc').disabled = true;
    document.getElementById('chkadon').disabled = true;
    document.getElementById('btnrefid').disabled = true;
    document.getElementById('txtreference').disabled = true;
    document.getElementById('txtreference').value = "";
    document.getElementById('chkcanclecharges').disabled = true;
    document.getElementById('txtaudit').value = "";
    document.getElementById('txtappby').value = "";
    document.getElementById('chkadon').checked = false;
    document.getElementById('btnsharing').disabled = true;
    document.getElementById('Button1').disabled = false;
    document.getElementById('hiddendummycioid').value = "";
    if (document.getElementById("divbarter") != null)
        document.getElementById("divbarter").style.display = "none";
    document.getElementById('divcopyinsertion').style.display = "none";
    document.getElementById('hiddenbarteramt').value = '';
    document.getElementById('hiddenstopbarterbooking').value = "";
    document.getElementById('txtbartertype').value = "";
    document.getElementById('drpedition').options.length = 1;
    document.getElementById('TextBox1').value = "";
    document.getElementById("divretainer").style.display = "none";
    document.getElementById('hiddenadscat3').value = "";
    document.getElementById('hiddenadscat4').value = "";
    document.getElementById('hiddenadscat5').value = "";
    document.getElementById('hiddenprevamt').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    document.getElementById('hiddenprint_rec').value = "";
    document.getElementById('hiddenreceiptno').value = "";
    document.getElementById('txtdatetime').value = document.getElementById('currdate').value;
    document.getElementById('txtRetainercomm').disabled = true;
    document.getElementById('txtRetainercommamt').disabled = true;
    document.getElementById('btnShow').disabled = true;
    document.getElementById('txtdatetime').disabled = true;
    document.getElementById('txtMobile').value = "";
    document.getElementById('txtMobile').disabled = true;
    document.getElementById('txtspacedisc').value = "";
    document.getElementById('txtspadiscper').value = "";
    document.getElementById('hiddentradedisc').value = "";
    document.getElementById('retcommtype').value = "";
    document.getElementById('retcomm').value = "";
    document.getElementById('txtbillwidth').value = "";
    document.getElementById('txtbillheight').value = "";
    document.getElementById('showselectedition').style.display = 'none'
    document.getElementById('txtRetainercomm').value = "";
    document.getElementById('txtRetainercommamt').value = "";
    document.getElementById('txtbullprem').value = "";
    document.getElementById('ttextchqno').value = "";
    document.getElementById('ttextchqdate').value = "";
    document.getElementById('ttextchqamt').value = "";
    document.getElementById('ttextbankname').value = "";
    document.getElementById('drpourbank').value = "0";
    document.getElementById('txtcardname').value = "";
    document.getElementById('drptype').value = 0;
    document.getElementById('drpmonth').value = 0;
    document.getElementById('drpyear').value = 0;
    document.getElementById('txtcardno').value = "";
    document.getElementById('hiddenboxchrgtype').value = "";
    document.getElementById('hiddencalendar').value = "0";
    document.getElementById('hiddensavemod').value = "0";
    document.getElementById('LinkButton1').disabled = true;
    document.getElementById('LinkButton2').disabled = true;
    document.getElementById('LinkButton3').disabled = true;
    document.getElementById('LinkButton4').disabled = true;
    document.getElementById('LinkButton5').disabled = true;
    document.getElementById('LinkButton6').disabled = true;
    document.getElementById('LinkButton7').disabled = true;
    document.getElementById('drpretainer').value = "";
    document.getElementById('drpretainer').disabled = true;
    document.getElementById('btnshgrid').disabled = true;
    document.getElementById('txtbillwidth').disabled = true;
    document.getElementById('txtbillheight').disabled = true;
    document.getElementById('drpagscode').options.length = 0;
    // btnupload.Enabled = false;
    document.getElementById('txtbartertype').disabled = true;
    document.getElementById('txtciobookid').disabled = true;
    // txtappby.Enabled = false;
    // txtaudit.Enabled = false;
    document.getElementById('txtrono').disabled = true;
    document.getElementById('txtrodate').disabled = true;
    document.getElementById('chkholdbill').disabled = true;
    document.getElementById('chkholdbill').checked = false;
    document.getElementById('tdchqno').style.display = "none";
    document.getElementById('tdourbank').style.display = "none";
    document.getElementById('tdchqdate').style.display = "none";
    document.getElementById('tdchqamt').style.display = "none";
    document.getElementById('tdbankname').style.display = "none";

    document.getElementById('tdtextchqno').style.display = "none";
    document.getElementById('tdtextourbank').style.display = "none";
    document.getElementById('tdtextchqdate').style.display = "none";
    document.getElementById('tdtextchqamt').style.display = "none";
    document.getElementById('tdtextbankname').style.display = "none";

    document.getElementById('tdcarname').style.display = "none";
    document.getElementById('tdtxtcarname').style.display = "none";
    document.getElementById('tdtype').style.display = "none";
    document.getElementById('tddrptyp').style.display = "none";
    document.getElementById('tdexdat').style.display = "none";

    document.getElementById('tdtxtexdat').style.display = "none";
    document.getElementById('tdcardno').style.display = "none";
    document.getElementById('tdtxtcarno').style.display = "none";
    document.getElementById('txtcardname').value = "";
    document.getElementById('drptype').value = 0;
    document.getElementById('drpmonth').value = 0;
    document.getElementById('drpyear').value = 0;
    document.getElementById('txtcardno').value = "";
    document.getElementById('drpcoutype').disabled = true;
    document.getElementById('txtcouno').disabled = true;
    document.getElementById('txtcouno').value = "";
    document.getElementById('drpcoutype').value = "0";
    document.getElementById('drpbillstatus').disabled = true;
    document.getElementById('drprostatus').disabled = true;
    document.getElementById('txtagency').disabled = true;
    document.getElementById('txtclient').disabled = true;
    document.getElementById('txtagencyaddress').disabled = true;
    document.getElementById('txtclientadd').disabled = true;
    document.getElementById('drpagscode').disabled = true;
    document.getElementById('txtdockitno1').disabled = true;
    document.getElementById('txtexecname').disabled = true;
    document.getElementById('txtexeczone').disabled = true;
    document.getElementById('txtproduct').disabled = false;
    document.getElementById('drpbrand').disabled = true;
    document.getElementById('txtkeyno').disabled = true;
    document.getElementById('txtbillremark').disabled = true;
    document.getElementById('txtprintremark').disabled = true;
    document.getElementById('drppackage').disabled = true;
    document.getElementById('txtinsertion').disabled = true;
    document.getElementById('txtdummydate').disabled = true;
    document.getElementById('txtrevisedate').disabled = true;
    document.getElementById('txtrepeatingdate').disabled = true;
    document.getElementById('drpbooktype').disabled = true;
    document.getElementById('drpadcategory').disabled = true;
    document.getElementById('drpadsubcategory').disabled = true;
    document.getElementById('drpcolor').disabled = true;
    document.getElementById('drpuom').disabled = true;
    document.getElementById('drppageposition').disabled = true;

    // txtadsizetypeheight.Enabled = false;
    //txtadsizetypewidth.Enabled = false;
    document.getElementById('txtratecode').disabled = true;
    document.getElementById('drpscheme').disabled = true;
    //       drpschemepck.Enabled = false;
    document.getElementById('drpcurrency').disabled = true;
    document.getElementById('drprptcurrency').disabled = true;
    document.getElementById('txtagreedrate').disabled = true;
    document.getElementById('txtagreedamt').disabled = true;

    document.getElementById('txtextracharges').disabled = true;
    document.getElementById('txtspedisc').disabled = true;
    document.getElementById('txtspediscper').disabled = true;

    document.getElementById('txtdatetime').disabled = true;
    document.getElementById('txtrepeatingdate').disabled = true;


    document.getElementById('txtadsize1').disabled = true;
    document.getElementById('txtadsize2').disabled = true;
    document.getElementById('txttotalarea').disabled = true;
    document.getElementById('txtcardrate').disabled = true;
    document.getElementById('txtcardamt').disabled = true;
    document.getElementById('txtdiscount').disabled = true;
    document.getElementById('txtdiscpre').disabled = true;
    document.getElementById('txtrepeatingdate').disabled = true;
    document.getElementById('drpbillcycle').disabled = true;
    document.getElementById('drprevenue').disabled = true;
    document.getElementById('drppaymenttype').disabled = true;
    document.getElementById('txtbillheight').disabled = true;
    document.getElementById('txtbillwidth').disabled = true;
    document.getElementById('drpbillto').disabled = true;
    document.getElementById('txtinvoice').disabled = true;
    document.getElementById('txtvts').disabled = true;
    document.getElementById('txtcirrate').disabled = true;
    document.getElementById('txtciragency').disabled = true;
    document.getElementById('txtciredition').disabled = true;
    document.getElementById('txtbilladdress').disabled = true;
    document.getElementById('txttradedisc').disabled = true;
    document.getElementById('chktrade').disabled = true;
    document.getElementById('txtagencyoutstand').disabled = true;


    document.getElementById('drpboxcode').disabled = true;
    document.getElementById('chkage').disabled = true;
    document.getElementById('chkclie').disabled = true;
    document.getElementById('chktfn').disabled = true;

    document.getElementById('txtboxaddress').disabled = true;
    document.getElementById('txtinsertion').disabled = true;

    document.getElementById('txtcolum').disabled = true;


    document.getElementById('txtclientcatdisc').value = "";
    document.getElementById('txtclientcatam').value = "";
    document.getElementById('txtflatfreqdisc').value = "";
    document.getElementById('txtflatfreqamt').value = "";
    document.getElementById('txtcatdisc').value = "";
    document.getElementById('txtcatamt').value = "";
    document.getElementById('hdnclientcatdistype').value = "";
    document.getElementById('hdnflatfreqdisctype').value = "";
    document.getElementById('hdncatdisctype').value = "";
    ///////////////////////
    document.getElementById('txtcontractname').disabled = true;
    document.getElementById('txtcontracttype').disabled = true;
    document.getElementById('txtcardname').disabled = true;
    document.getElementById('drptype').disabled = true;
    document.getElementById('drpmonth').disabled = true;
    document.getElementById('drpyear').disabled = true;
    document.getElementById('txtcardno').disabled = true;
    document.getElementById('btncopy').disabled = true;
    document.getElementById('btndel').disabled = true;

    document.getElementById('drpadcat3').disabled = true;
    document.getElementById('drpadcat4').disabled = true;
    document.getElementById('drpadcat3').options.length = 0;
    document.getElementById('drpadcat4').options.length = 0;

    document.getElementById('drpbgcolor').disabled = true;
    document.getElementById('drpadcat5').disabled = true;

    document.getElementById('drpretainer').disabled = true;

    if (document.getElementById('txtaddagencycommrate') != null) {
        document.getElementById('txtaddagencycommrate').disabled = true;
        document.getElementById('txtaddagencycommrate').value = "";
        document.getElementById('txtaddagencycommrateamt').disabled = true;
        document.getElementById('txtaddagencycommrateamt').value = "";
    }
    document.getElementById('drpadcat5').options.length = 0;
    document.getElementById('drpbgcolor').value = "0";

    document.getElementById('drpbullet').disabled = true;
    document.getElementById('drpbullet').value = "0";
    document.getElementById('drpdiscountprem').disabled = true;
    document.getElementById('drpdiscountprem').value = "0";
    document.getElementById('drpmatstat').disabled = true;
    document.getElementById('drpmatstat').value = "0";

    document.getElementById('txtcontractname').value = "";
    document.getElementById('txtcontracttype').value = "";
    document.getElementById('txtcardname').value = "";
    document.getElementById('drptype').value = "0";
    document.getElementById('drpmonth').value = "0";
    document.getElementById('drpyear').value = "0";
    document.getElementById('txtcardno').value = "";
    //////////////////////////////

    document.getElementById('txtcolum').value = "";

    //*14Aug* drpretainer.SelectedValue = "0";
    document.getElementById('txtciobookid').value = "";
    document.getElementById('txtcreditperiod').value = "";
    // txtappby.Text = "";
    // txtaudit.Text = "";
    document.getElementById('txtrono').value = "";
    document.getElementById('txtrodate').value = "";

    document.getElementById('drpbillstatus').value = "0";
    //  document.getElementById('drprostatus').value = "0";
    document.getElementById('txtagency').value = "";
    document.getElementById('txtclient').value = "";
    document.getElementById('txtagencyaddress').value = "";
    document.getElementById('txtclientadd').value = "";
    document.getElementById('drpagscode').value = "0";
    document.getElementById('txtdockitno1').value = "";
    document.getElementById('txtexecname').value = "";
    document.getElementById('txtexeczone').value = "";
    document.getElementById('txtproduct').value = "";
    document.getElementById('drpbrand').value = "";
    document.getElementById('txtkeyno').value = "";
    document.getElementById('txtbillremark').value = "";
    document.getElementById('txtprintremark').value = "";
    //drppackage.SelectedValue = "0";
    //drppackage.Items.Clear();
    ///////////on the click of clear button bind the grid again to uncheck
    document.getElementById('txtinsertion').value = "";
    document.getElementById('txtdummydate').value = "";
    document.getElementById('txtrevisedate').value = "";
    document.getElementById('txtrepeatingdate').value = "";
    document.getElementById('drpbooktype').value = "0";
    document.getElementById('drpadcategory').value = "0";
    document.getElementById('drpadsubcategory').value = "0";
    document.getElementById('drpcolor').value = "0";
    document.getElementById('drpuom').value = "0";
    document.getElementById('drppageposition').value = "0";

    document.getElementById('txtratecode').value = "0";
    document.getElementById('drpscheme').value = "";
    //   drpschemepck.SelectedValue = "0";
    document.getElementById('drpcurrency').value = "0";
    document.getElementById('drprptcurrency').value = "0";
    document.getElementById('txtagreedrate').value = "";
    document.getElementById('txtagreedamt').value = "";

    document.getElementById('txtextracharges').value = "";
    document.getElementById('txtspedisc').value = "";
    document.getElementById('txtspediscper').value = "";
    document.getElementById('txtagencytype').value = "";
    document.getElementById('txtagencystatus').value = "";
    //txtagencypaymode.Items.Clear();
    document.getElementById('txtagencypaymode').options.length = 0;
    document.getElementById('txtadsize1').value = "";
    document.getElementById('txtadsize2').value = "";
    document.getElementById('txttotalarea').value = "";
    document.getElementById('txtcardrate').value = "";
    document.getElementById('txtcardamt').value = "";
    document.getElementById('txtdiscount').value = "";
    document.getElementById('txtdiscpre').value = "";
    document.getElementById('txtrepeatingdate').value = "";
    document.getElementById('drpbillcycle').value = "0";
    // document.getElementById('drprevenue').value = "0";
    document.getElementById('drppaymenttype').options.length = 0;
    document.getElementById('drpcashrecieved').value = "";
    document.getElementById('txtbillheight').value = "";
    document.getElementById('txtbillwidth').value = "";
    //drpbillto.SelectedValue = "0";
    document.getElementById('drpbillto').options.length = 0;
    document.getElementById('txtinvoice').value = "";
    document.getElementById('txtvts').value = "";
    document.getElementById('txtcirrate').value = "";
    document.getElementById('txtciragency').value = "";
    document.getElementById('txtciredition').value = "";
    document.getElementById('txtbilladdress').value = "";
    document.getElementById('txttradedisc').value = "";
    document.getElementById('txttd').value = "";
    document.getElementById('txtdesignation').value = "";
    document.getElementById('chktrade').checked = true;
    document.getElementById('hiddentradedisc').value = "";
    document.getElementById('txtagencyoutstand').value = "";

    document.getElementById('txtpageamt').value = "";


    document.getElementById('drpboxcode').value = "0";
    document.getElementById('chkage').checked = false;
    document.getElementById('chkclie').checked = false;
    document.getElementById('chktfn').checked = false;

    document.getElementById('txtboxaddress').value = "";
    document.getElementById('txtinsertion').value = "";

    //*14Aug* drpretainer.SelectedValue = "0";

    document.getElementById('drppackage').value = "0";
    document.getElementById('drppackagecopy').options.length = 0;
    document.getElementById('btndel').disabled = true;
    document.getElementById('tblinsert').innerHTML = ''
    document.getElementById('tblrate').style.display = 'none';
    document.getElementById('tblbill').style.display = 'none';
    document.getElementById('addetails').style.display = 'none';
    document.getElementById('pagedetail').style.display = 'none';
    document.getElementById('tblpackage').style.display = 'none';
    document.getElementById('tbbox').style.display = 'none';
    document.getElementById('tbvts').style.display = 'none';
    if (document.getElementById('hiddenrostatus').value == "1") {
        document.getElementById('drprostatus').value = "2";
    }
    else {
        document.getElementById('drprostatus').value = "1";
    }
    disablelistbox();


    // document.getElementById('hiddensavemod').value = "01";

    getbuttoncheck(document.getElementById('hiddenbuttonidcheck').value);
    if (document.getElementById('btnNew').disabled == false) {
        document.getElementById('btnNew').focus();
    }
    var res = Classified_Booking.getPrevBookId();
    if (res.value != null) {
        if (res.value.Tables[0].Rows.length > 0) {
            document.getElementById('txtprevbook').value = res.value.Tables[0].Rows[0].cio_booking_id;
        }
    }
    var res = null;
    res = Classified_Booking.getRev();
    if (res.value != null) {
        document.getElementById('drprevenue').value = res.value;
        document.getElementById('txtbranch').value = res.value;
        document.getElementById('txtbranch_name').value = document.getElementById('hdnbranch_name').value;
        document.getElementById('txtbookedby').value = document.getElementById('hiddenusername').value;
        // document.getElementById('txtbranch').value=document.getElementById('drprevenue').options[document.getElementById('drprevenue').selectedIndex].text;
    }
    res = Classified_Booking.getCen();
    if (res.value != null) {
        document.getElementById('hiddencenter').value = res.value;
    }

    document.getElementById('multibilling_div').innerHTML = "";

    setButtonImages();
    return false;
}
function getbuttoncheck(id) {
    if (id == "0" || id == "8") {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnQuery").disabled = true;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnCancel").disabled = true;
        document.getElementById("btnExit").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnModify").disabled = true;

        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnModify").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

    }
    if (id == "1" || id == "9") {
        document.getElementById("btnNew").disabled = false;
        document.getElementById("btnQuery").disabled = false;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnExit").disabled = false;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnExecute").disabled = true;

        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnModify").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

    }
    if (id == "2" || id == "10") {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnQuery").disabled = false;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnExit").disabled = false;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnModify").disabled = false;

        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnfirst").disabled = false;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;
        document.getElementById("btnExit").disabled = false;
    }
    if (id == "3" || id == "11") {
        document.getElementById("btnNew").disabled = false;
        document.getElementById("btnQuery").disabled = false;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnModify").disabled = true;
        document.getElementById("btnCancel").disabled = true;
        document.getElementById("btnExit").disabled = true;
        document.getElementById("btnDelete").disabled = true;


        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

    }
    if (id == "4" || id == "12") {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnQuery").disabled = false;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnExit").disabled = false;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;
        document.getElementById("btnExecute").disabled = true;

        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnExit").disabled = false;


        document.getElementById("btnModify").disabled = true;

        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

    }
    if (id == "5" || id == "13") {
        document.getElementById("btnNew").disabled = false;
        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnQuery").disabled = false;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnExit").disabled = false;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnModify").disabled = true;

    }
    if (id == "6" || id == "14") {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnQuery").disabled = false;
        document.getElementById("btnModify").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnExit").disabled = false;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;
        document.getElementById("btnExecute").disabled = true;
    }
    if (id == "7" || id == "15") {
        document.getElementById("btnNew").disabled = false;
        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnQuery").disabled = false;
        document.getElementById("btnModify").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnExit").disabled = false;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;
        document.getElementById("btnExecute").disabled = true;
    }
}
function chkstatus(FlagStatus) {
    if (FlagStatus == 0 || FlagStatus == 8) {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnQuery").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnCancel").disabled = true;
        document.getElementById("btnModify").disabled = true;

        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;
        document.getElementById("btnExit").disabled = true;



    }
    if (FlagStatus == 1 || FlagStatus == 9) {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnQuery").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnSave").disabled = false;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnModify").disabled = true;

        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;
        document.getElementById("btnExit").disabled = false;

    }
    if (FlagStatus == 2 || FlagStatus == 10) {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnQuery").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnModify").disabled = true;

        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

        document.getElementById("btnExit").disabled = false;

    }

    if (FlagStatus == 3 || FlagStatus == 11) {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnQuery").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnSave").disabled = false;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnModify").disabled = true;

        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

        document.getElementById("btnExit").disabled = false;
    }

    if (FlagStatus == 4 || FlagStatus == 12) {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnQuery").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnModify").disabled = true;

        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

        document.getElementById("btnExit").disabled = false;
    }
    if (FlagStatus == 5 || FlagStatus == 13) {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnQuery").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnModify").disabled = true;

        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

        document.getElementById("btnExit").disabled = false;
    }
    if (FlagStatus == 6 || FlagStatus == 14) {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnQuery").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnModify").disabled = true;

        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

        document.getElementById("btnExit").disabled = false;
    }
    if (FlagStatus == 7 || FlagStatus == 15) {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnQuery").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnSave").disabled = false;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnModify").disabled = true;

        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

        document.getElementById("btnExit").disabled = false;
    }


}
function newclick() {
    var msg = checkSession();
    if (msg == false) {
        window.location.href = "login.aspx";
        return false;
    }
    clearClick();
    enLink = "1";
    cali = 0;
    schemeid = "";
    chkbtnStatus = "new";
    boxstatus = "";
    if (ALLOWBOOKINGBRANCHMAIL == "Y") {
      //  document.getElementById('btnmail').style.display = "block";
        document.getElementById('btnmail').disabled = false;
    }
    else {
        //document.getElementById('btnmail').style.display = "none";
        document.getElementById('btnmail').disabled = true;
    }
    if (document.getElementById('hidonline').value == "Y")
        document.getElementById('chkonline').disabled = false;
    else
        document.getElementById('chkonline').disabled = true;
    document.getElementById('btnfmg').disabled = true;
    document.getElementById('Button1').disabled = false;
    // document.getElementById('Button1').disabled=true;
    document.getElementById('btnsharing').disabled = false;
    document.getElementById('drpregular').disabled = false;
    document.getElementById('drptranslation').disabled = false;
    document.getElementById('txttranslationdisc').disabled = false;
    document.getElementById('txtpospremdisc').disabled = false;
    document.getElementById('hiddendummycioid').value = "";
    document.getElementById('btnShow').disabled = false;
    document.getElementById('hiddenprevamt').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    document.getElementById('txtMobile').disabled = false;
    document.getElementById('txtMobile').value = "";
    document.getElementById('hiddenprint_rec').value = "";
    document.getElementById('hiddenreceiptno').value = "";
    document.getElementById('chkgstinc').disabled = false;
    document.getElementById('txtcontactperson').disabled = false;
    document.getElementById('txtcontactperson').value = "";
    modifyMatter = 0;
    document.getElementById('chkholdbill').disabled = false;
    document.getElementById('chkholdbill').checked = false;
    if (document.getElementById('hiddencutofftime').value == "y") {
        var res = Classified_Booking.getCurTime(document.getElementById('hiddencompcode').value);
        var ds = res.value;
        if (ds == null) {
            alert(res.error.description);
            return false;
        }
        if (ds.Tables[0].Rows.length > 0) {
            if (ds.Tables[0].Rows[0].T == "Y") {
                var curdate = document.getElementById('currdate').value;
                var fromdate = "";
                if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                    fromdate = curdate.split('/')[1] + '/' + curdate.split('/')[0] + '/' + curdate.split('/')[2];
                    var fdate = new Date(fromdate);
                    fdate.setDate(fdate.getDate() + 1);
                    document.getElementById('txtdatetime').value = (parseInt(fdate.getDate(), 10)) + '/' + (parseInt(fdate.getMonth(), 10) + 1) + '/' + fdate.getYear();
                }
                else if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                    fromdate = curdate;
                    var fdate = new Date(fromdate);
                    fdate.setDate(fdate.getDate() + 1);
                    document.getElementById('txtdatetime').value = (parseInt(fdate.getMonth(), 10) + 1) + '/' + (parseInt(fdate.getDate(), 10)) + '/' + fdate.getYear();
                }
                else if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
                    fromdate = curdate.split('/')[1] + '/' + curdate.split('/')[2] + '/' + curdate.split('/')[0];
                    var fdate = new Date(fromdate);
                    fdate.setDate(fdate.getDate() + 1);
                    document.getElementById('txtdatetime').value = fdate.getYear() + '/' + (parseInt(fdate.getMonth(), 10) + 1) + '/' + (parseInt(fdate.getDate(), 10));
                }
            }
            else {
                document.getElementById('txtdatetime').value = document.getElementById('currdate').value;
            }
        }
    }
    else {
        document.getElementById('txtdatetime').value = document.getElementById('currdate').value;
    }
    document.getElementById('hiddensavemod').value = "0";

    //bindretainer();
    document.getElementById('chkadon').disabled = false;
    document.getElementById('btnrefid').disabled = false;
    document.getElementById('txtreference').disabled = false;
    document.getElementById('txtRetainercomm').disabled = false;
    document.getElementById('tdchqno').style.display = "none";
    document.getElementById('tdourbank').style.display = "none";
    document.getElementById('tdchqdate').style.display = "none";
    document.getElementById('tdchqamt').style.display = "none";
    document.getElementById('tdbankname').style.display = "none";

    document.getElementById('tdtextchqno').style.display = "none";
    document.getElementById('tdtextourbank').style.display = "none";
    document.getElementById('tdtextchqdate').style.display = "none";
    document.getElementById('tdtextchqamt').style.display = "none";
    document.getElementById('tdtextbankname').style.display = "none";

    document.getElementById('tdcarname').style.display = "none";
    document.getElementById('tdtxtcarname').style.display = "none";
    document.getElementById('tdtype').style.display = "none";
    document.getElementById('tddrptyp').style.display = "none";
    document.getElementById('tdexdat').style.display = "none";

    document.getElementById('tdtxtexdat').style.display = "none";
    document.getElementById('tdcardno').style.display = "none";
    document.getElementById('tdtxtcarno').style.display = "none";

    document.getElementById('txtcardname').value = "";
    document.getElementById('drptype').value = 0;
    document.getElementById('drpmonth').value = 0;
    document.getElementById('drpyear').value = 0;
    document.getElementById('txtcardno').value = "";
    document.getElementById('drpcoutype').disabled = false;
    document.getElementById('txtcouno').disabled = false;
    document.getElementById('txtcouno').value = "";
    document.getElementById('drpcoutype').value = "0";
    document.getElementById('LinkButton1').disabled = false;
    document.getElementById('LinkButton2').disabled = false;
    document.getElementById('LinkButton3').disabled = false;
    document.getElementById('LinkButton4').disabled = false;
    document.getElementById('LinkButton5').disabled = false;
    document.getElementById('LinkButton6').disabled = false;
    document.getElementById('LinkButton7').disabled = false;
    document.getElementById('btnshgrid').disabled = false;
    // btnupload.Enabled = true;
    document.getElementById('drpbooktype').disabled = false;
    document.getElementById('txtciobookid').disabled = true;
    document.getElementById('txtrono').disabled = false;
    document.getElementById('txtrodate').disabled = false;
    document.getElementById('drpbillstatus').disabled = false;
    document.getElementById('drprostatus').disabled = false;
    document.getElementById('txtagency').disabled = false;
    document.getElementById('txtclient').disabled = false;
    document.getElementById('txtclientadd').disabled = false;
    document.getElementById('drpagscode').disabled = false;
    document.getElementById('txtdockitno1').disabled = true;
    document.getElementById('txtexecname').disabled = false;
    document.getElementById('txtexeczone').disabled = false;
    document.getElementById('txtproduct').disabled = false;
    document.getElementById('drpbrand').disabled = false;
    document.getElementById('txtkeyno').disabled = false;
    document.getElementById('txtbillremark').disabled = false;
    document.getElementById('txtprintremark').disabled = false;
    document.getElementById('drppackage').disabled = false;
    document.getElementById('txtinsertion').disabled = false;
    document.getElementById('txtdummydate').disabled = false;
    document.getElementById('txtrevisedate').disabled = false;
    document.getElementById('txtrepeatingdate').disabled = false;
    document.getElementById('drpbooktype').disabled = false;
    document.getElementById('drpadcategory').disabled = false;
    document.getElementById('drpadsubcategory').disabled = false;
    document.getElementById('drpcolor').disabled = false;
    document.getElementById('drpuom').disabled = false;
    document.getElementById('drppageposition').disabled = false;
    document.getElementById('txtratecode').disabled = false;
    document.getElementById('drpscheme').disabled = true;
    document.getElementById('drpcurrency').disabled = false;
    document.getElementById('drprptcurrency').disabled = false;
    document.getElementById('txtagreedrate').disabled = false;
    document.getElementById('txtagreedamt').disabled = false;
    document.getElementById('txtextracharges').disabled = false;
    if (document.getElementById('hidspldisedit').value == "Y") {
        document.getElementById('txtspediscper').disabled = false;
        document.getElementById('txtspedisc').disabled = false;

    }
    else {
        document.getElementById('txtspediscper').disabled = true;
        document.getElementById('txtspedisc').disabled = true;
    }

    if (document.getElementById('hidbackdatereceipt').value == "y")
        document.getElementById('txtdatetime').disabled = false;
    else
        document.getElementById('txtdatetime').disabled = true;
    document.getElementById('txtspacedisc').disabled = false;
    if (document.getElementById('hiddenuomdesc').value == "CD") {
        document.getElementById('txtspadiscper').disabled = false;
    }
    else {
        document.getElementById('txtspadiscper').disabled = true;
    }
    document.getElementById('txtspadiscper').value = "";
    document.getElementById('txtspacedisc').value = "";
    document.getElementById('txtrepeatingdate').disabled = false;
    document.getElementById('drpbillcycle').disabled = false;
    document.getElementById('drprevenue').disabled = false;
    document.getElementById('drpbillstatus').disabled = false;
    document.getElementById('drppaymenttype').disabled = false;
    document.getElementById('txtinvoice').disabled = false;
    document.getElementById('txtvts').disabled = false;
    document.getElementById('txtcirrate').disabled = false;
    document.getElementById('txtciragency').disabled = false;
    document.getElementById('txtciredition').disabled = true;
    document.getElementById('txtbillwidth').disabled = false;
    document.getElementById('txtbillheight').disabled = false;
    document.getElementById('drpbillto').disabled = false;
    if (document.getElementById('hiddeneiitagcomm').value == "N") {
        document.getElementById('txttradedisc').disabled = true;
        document.getElementById('chktrade').disabled = true;
        if (document.getElementById('txtaddagencycommrate') != null) {
            document.getElementById('txtaddagencycommrate').disabled = true;
            document.getElementById('txtaddagencycommrate').value = "";
            document.getElementById('txtaddagencycommrateamt').disabled = true;
            document.getElementById('txtaddagencycommrateamt').value = "";
        }
    }
    else if (document.getElementById('hiddeneiitagcomm').value == "T") {
        document.getElementById('txttradedisc').disabled = false;
        document.getElementById('chktrade').disabled = false;
        if (document.getElementById('txtaddagencycommrate') != null) {
            document.getElementById('txtaddagencycommrate').disabled = true;
            document.getElementById('txtaddagencycommrate').value = "";
            document.getElementById('txtaddagencycommrateamt').disabled = true;
            document.getElementById('txtaddagencycommrateamt').value = "";
        }
    }
    else if (document.getElementById('hiddeneiitagcomm').value == "A") {
        document.getElementById('txttradedisc').disabled = true;
        document.getElementById('chktrade').disabled = true;
        if (document.getElementById('txtaddagencycommrate') != null) {
            document.getElementById('txtaddagencycommrate').disabled = false;
            document.getElementById('txtaddagencycommrate').value = "";
            document.getElementById('txtaddagencycommrateamt').disabled = false;
            document.getElementById('txtaddagencycommrateamt').value = "";
        }
    }
    else {
        document.getElementById('txttradedisc').disabled = false;
        document.getElementById('chktrade').disabled = false;
        if (document.getElementById('txtaddagencycommrate') != null) {
            document.getElementById('txtaddagencycommrate').disabled = false;
            document.getElementById('txtaddagencycommrate').value = "";
            document.getElementById('txtaddagencycommrateamt').disabled = false;
            document.getElementById('txtaddagencycommrateamt').value = "";
        }
    }

    if (document.getElementById('hiddencancelcharge').value == "Y") {
        document.getElementById('chkcanclecharges').disabled = false;
        document.getElementById('chkcanclecharges').checked = false;
    }
    else {
        document.getElementById('chkcanclecharges').disabled = true;
        document.getElementById('chkcanclecharges').checked = false;
    }
    document.getElementById('txtagencyoutstand').disabled = true;
    document.getElementById('txtcardrate').disabled = true;
    document.getElementById('txtcardamt').disabled = true;
    document.getElementById('txtdiscount').disabled = true;
    document.getElementById('txtdiscpre').disabled = true;
    document.getElementById('txtadsize2').disabled = false;
    document.getElementById('txtadsize1').disabled = false;
    if (document.getElementById('hidlineedit').value == "y")
        document.getElementById('txttotalarea').disabled = false;
    document.getElementById('txtbilladdress').disabled = false;
    document.getElementById('drpboxcode').disabled = false;
    document.getElementById('txtboxaddress').disabled = false;
    document.getElementById('txtbillamt').disabled = true;
    document.getElementById('txtgrossamt').disabled = true;
    document.getElementById('drpboxcode').disabled = false;
    document.getElementById('chkage').disabled = false;
    document.getElementById('chkclie').disabled = false;
    document.getElementById('chktfn').disabled = false;
    document.getElementById('txtboxaddress').disabled = false;
    document.getElementById('txtinsertion').disabled = false;
    document.getElementById('txtcolum').disabled = false;
    document.getElementById('txtcardname').disabled = false;
    document.getElementById('drptype').disabled = false;
    document.getElementById('drpmonth').disabled = false;
    document.getElementById('drpyear').disabled = false;
    document.getElementById('txtcardno').disabled = false;
    document.getElementById('txtagencypaymode').disabled = true;
    document.getElementById('btncopy').disabled = false;
    document.getElementById('btnshgrid').disabled = false;
    document.getElementById('btndeal').disabled = false;
    document.getElementById('drpadcat3').disabled = false;
    document.getElementById('drpadcat4').disabled = false;
    document.getElementById('drpadcat3').options.length = 0;
    document.getElementById('drpadcat4').options.length = 0;
    document.getElementById('drpbgcolor').disabled = false;
    document.getElementById('drpadcat5').disabled = false;
    document.getElementById('drpadcat5').options.length = 0;
    document.getElementById('drpbgcolor').value = "0";
    document.getElementById('drpbullet').disabled = false;
    // txtagreedamt.Enabled = false;
    //   txtagreedrate.Enabled = false;
    document.getElementById('drpbullet').value = "0";
    document.getElementById('drpdiscountprem').disabled = false;
    document.getElementById('drpdiscountprem').value = "0";
    //btndel.Enabled = true;
    
    document.getElementById('drpmatstat').value = "0";
    document.getElementById('drpmatstat').disabled = true;

    document.getElementById('drpretainer').disabled = false;

    document.getElementById('drpmatstat').value = "0";

    document.getElementById('txtcontractname').value = "";
    document.getElementById('txtcontracttype').value = "";
    document.getElementById('txtcardname').value = "";
    document.getElementById('drptype').value = "0";
    document.getElementById('drpmonth').value = "0";
    document.getElementById('drpyear').value = "0";
    document.getElementById('txtcardno').Text = "";
    //////////////////////////////


    //     drpschemepck.SelectedValue = "0";


    //*14Aug* drpretainer.SelectedValue = "0";

    document.getElementById('txtcolum').value = "";

    document.getElementById('txtbillamt').value = "";

    document.getElementById('txtrono').value = "";
    document.getElementById('txtbilladdress').value = "";
    document.getElementById('txtrodate').value = "";
    document.getElementById('txtcreditperiod').value = "";
    document.getElementById('drpbillstatus').value = "0";
    // document.getElementById('drprostatus').value = "0";
    document.getElementById('txtagency').value = "";
    document.getElementById('txtclient').value = "";
    document.getElementById('txtagencyaddress').value = "";
    document.getElementById('txtclientadd').value = "";
    document.getElementById('drpagscode').value = "0";
    document.getElementById('txtdockitno1').value = "";
    document.getElementById('txtexecname').value = "";
    document.getElementById('txtexeczone').value = "";
    document.getElementById('txtproduct').value = "";
    document.getElementById('drpbrand').value = "";
    document.getElementById('txtkeyno').value = "";
    document.getElementById('txtbillremark').value = "";
    document.getElementById('txtprintremark').value = "";
    //  drppackage.SelectedValue = "0";
    document.getElementById('txtinsertion').value = "";
    document.getElementById('txtdummydate').value = "";
    document.getElementById('txtrevisedate').value = "";
    document.getElementById('txtrepeatingdate').value = "";

    document.getElementById('drpadcategory').value = "0";
    document.getElementById('drpadsubcategory').value = "0";
    // document.getElementById('drpcolor').value = "0";
    document.getElementById('drpcolor').selectedIndex = 1;
    if (document.getElementById('drpuom').options.length > 2) {
        document.getElementById('drpuom').selectedIndex = 0;
        gettheuomdesc();
    }
    else
        document.getElementById('drpuom').value = "0";
    document.getElementById('drppageposition').value = "0";


    //txtadsizetypeheight.Text = "";
    //txtadsizetypewidth.Text = "";
    //txtratecode.SelectedValue = "0";
    document.getElementById('txtratecode').value = "0";
    document.getElementById('drpscheme').value = "";
    //   drpschemepck.SelectedValue = "0";
    document.getElementById('drpcurrency').value = "0";
    document.getElementById('drprptcurrency').value = "0";
    document.getElementById('txtagreedrate').value = "";
    document.getElementById('txtagreedamt').value = "";

    document.getElementById('txtextracharges').value = "";
    document.getElementById('txtspedisc').value = "";
    document.getElementById('txtspediscper').value = "";
    //document.getElementById('drpbillcycle').value = "0";
    if (document.getElementById("configclient").value == "RP") {
        if (document.getElementById('drpuom').value == "RO0") {
            document.getElementById('drpbillcycle').value = "6";
        }
        else if (document.getElementById('drpbillcycle').options.length > 1)
            document.getElementById('drpbillcycle').selectedIndex = 1;
        else
            document.getElementById('drpbillcycle').value = "0";
    }
    else {
        if (document.getElementById('drpbillcycle').options.length > 1) {
            document.getElementById('drpbillcycle').selectedIndex = 1;
            document.getElementById('drpbillcycle').value = "1";
        }
        else {
            document.getElementById('drpbillcycle').value = "0";
        }

    }
    // document.getElementById('drprevenue').value = "0";
    //drpbilltype.SelectedValue = "0";
    document.getElementById('drpbillstatus').value = "0";
    //drpbillcurrency.SelectedValue = "0";
    document.getElementById('txtagencypaymode').options.length = 0;
    document.getElementById('drppaymenttype').options.length = 0;
    document.getElementById('txtinvoice').value = "";
    document.getElementById('txtvts').value = "";
    document.getElementById('txtcirrate').value = "";
    document.getElementById('txtciragency').value = "";
    document.getElementById('txtciredition').value = "";
    document.getElementById('txtbillwidth').value = "";
    document.getElementById('txtbillheight').value = "";
    //drpbillto.SelectedValue = "0";
    document.getElementById('drpbillto').options.length = 0;
    document.getElementById('txttradedisc').value = "";
    document.getElementById('txttd').value = "";
    document.getElementById('txtdesignation').value = "";
    document.getElementById('chktrade').checked = true;
    document.getElementById('hiddentradedisc').value = "";
    document.getElementById('txtagencyoutstand').value = "";
    document.getElementById('txtcardrate').value = "";
    document.getElementById('txtcardamt').value = "";
    document.getElementById('txtdiscount').value = "";
    document.getElementById('txtdiscpre').value = "";
    document.getElementById('txtadsize2').value = "";
    document.getElementById('txtadsize1').value = "";
    document.getElementById('txttotalarea').value = "";
    document.getElementById('drpboxcode').value = "0";
    document.getElementById('txtboxno').value = "";
    document.getElementById('txtboxaddress').value = "";
    document.getElementById('chkage').checked = false;
    document.getElementById('chkclie').checked = false;

    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    document.getElementById('drppackage').value = "0";
    document.getElementById('drppackagecopy').options.length = 0;


    document.getElementById('drpboxcode').value = "0";
    document.getElementById('chkage').checked = false;
    document.getElementById('chkclie').checked = false;
    document.getElementById('chktfn').checked = false;

    document.getElementById('txtboxaddress').value = "";
    document.getElementById('txtinsertion').value = "";
    //        document.getElementById('drpbooktype').value = "3";

    document.getElementById('hiddensavemod').value = "0";
    document.getElementById('drpretainer').value = "";
    document.getElementById('ttextchqno').value = "";
    document.getElementById('ttextchqdate').value = "";
    document.getElementById('ttextchqamt').value = "";
    document.getElementById('ttextbankname').value = "";
    document.getElementById('drpourbank').value = "0";
    document.getElementById('ttextchqno').disabled = false;
    document.getElementById('ttextchqdate').disabled = false;
    document.getElementById('ttextchqamt').disabled = false;
    document.getElementById('ttextbankname').disabled = false;
    document.getElementById('drpourbank').disabled = false;
    /////////if 0 than autogenerate the cio booking id and if 1 than autogenerate dockit no.
    //autogenerated("0");
    autogeneratedtempid() // to generate temp booking id

    rownumEx = 0;


    //bindpackage();


    chkstatus(document.getElementById('hiddenbuttonidcheck').value);
    document.getElementById('btnSave').disabled = false;
    document.getElementById('btnNew').disabled = true;
    document.getElementById('btnQuery').disabled = true;

    //drpuom.SelectedValue = Session["uom"].ToString();
    document.getElementById('drpcurrency').value = document.getElementById('hiddencurrency').value;
    document.getElementById('drprptcurrency').value = document.getElementById('hiddencurrency').value;
    // lbmeasure.Text = drpuom.SelectedItem.Text.ToString();
    if (document.getElementById('drpuom').value != '') {
        document.getElementById('lbbilluom').value = document.getElementById('drpuom').options[document.getElementById('drpuom').selectedIndex].text
    }
    if (document.getElementById('lbbilluom').value == "CD") {
        document.getElementById('lbmeasure').value = "CM";
        document.getElementById('lbmeasuretotal').value = "Sq" + "&nbsp;" + "CM";
    }
    else {
        document.getElementById('lbmeasuretotal').value = "";
        document.getElementById('lbmeasure').value = "";
    }
    if (document.getElementById('drprevenue').selectedIndex != "-1") {
        document.getElementById('hiddenbranch').value = document.getElementById('drprevenue').options[document.getElementById('drprevenue').selectedIndex].text; //drprevenue.SelectedItem.Text.ToString();
    }
    document.getElementById('btndel').disabled = false;
    document.getElementById('tblinsert').innerHTML = '';
    document.getElementById('txtagency').focus();
    bindBookType_Agency();
    if (document.getElementById('hdndepo').value == "depo") {


        agencycodeglo = document.getElementById('hdnagencyname').value.substring(document.getElementById('hdnagencyname').value.lastIndexOf('(') + 1, document.getElementById('hdnagencyname').value.lastIndexOf(')'));
        document.getElementById('txtagency').value = document.getElementById('hdnagencyname').value;
        document.getElementById('txtagencyaddress').value = document.getElementById('hdnagencyaddress').value;
        Classified_Booking.bindagencusub(agencycodeglo, document.getElementById('hiddencompcode').value, call_bindagsub);
        document.getElementById('txtagency').disabled = true;
        document.getElementById('txtagencyaddress').disabled = true;
    }
    document.getElementById('drpbooktype').value = "3";
    setButtonImages();
    var obj = document.getElementById('drpbooktype');
    /*  var resType=Classified_Booking.bindAdTypeAgencyWiseXML();
           
    obj.options.length = 0; 
    if(resType!=null && resType.value!="")
    {
            
    var arr=resType.value.split(",");
    obj.options[0]=new Option("Select Booking Type","0");
    for(var i=0;i<arr.length;i++)
    {
    obj.options[obj.options.length] = new Option(arr[i].toString(),arr[parseFloat(i,10)+1].toString());
    i++;
    }
    obj.options[1].selected=true;
    }*/
    if (document.getElementById('hdntxttranslationdisc').value == "show") {
        document.getElementById('txttranslationdisc').disabled = false;
    }
    else {
        document.getElementById('txttranslationdisc').disabled = true;
    }
    if (document.getElementById('hdntxtpospremdisc').value == "show") {
        document.getElementById('txtpospremdisc').disabled = false;
    }
    else {
        document.getElementById('txtpospremdisc').disabled = true;
    }
    if (document.getElementById('hdntxtspediscper').value == "show") {
        document.getElementById('txtspediscper').disabled = false;
    }
    else {
        document.getElementById('txtspediscper').disabled = true;
    }
    if (document.getElementById('hdntxtspacedisc').value == "show") {
        document.getElementById('txtspacedisc').disabled = false;
    }
    else {
        document.getElementById('txtspacedisc').disabled = true;
    }
    if (document.getElementById('hdntxtaddagencycommrate').value == "show") {
        document.getElementById('txtaddagencycommrate').disabled = false;
        document.getElementById('txtaddagencycommrateamt').disabled = false;
       

    }
    else {
        document.getElementById('txtaddagencycommrate').disabled = true;
        document.getElementById('txtaddagencycommrateamt').disabled = true;
    }
    if (document.getElementById('hdntxtRetainercomm').value == "show") {
        document.getElementById('txtRetainercomm').disabled = false;
    }
    else {
        document.getElementById('txtRetainercomm').disabled = true;
    }
    if (document.getElementById('hdntxtextracharges').value == "show") {
        document.getElementById('txtextracharges').disabled = false;
    }
    else {
        document.getElementById('txtextracharges').disabled = true;
    }
    if (document.getElementById('hdntxtspedisc').value == "show") {
        document.getElementById('txtspedisc').disabled = false;
    }
    else {
        document.getElementById('txtspedisc').disabled = true;
    }
    if (document.getElementById('hdntxtspadiscper').value == "show") {
        document.getElementById('txtspadiscper').disabled = false;
    }
    else {
        document.getElementById('txtspadiscper').disabled = true;
    }
    if (document.getElementById('hdnbranchf2req').value == "Y") {
        document.getElementById('txtrevenuecenternew').disabled = false;
        document.getElementById('txtrevenuecenternew').focus();
    }
    else {
        document.getElementById('txtbranch_name').disabled = true;
        document.getElementById('txtagency').focus();
    }
    document.getElementById('txtbranch_name').value = document.getElementById('hdnbbrnch').value;
    return false;
}
function autogenerated(no) {
    if (no == "0") {
        var dt = new Date()
        var auto = "";
        var cen = document.getElementById('hiddencenter').value;
        cen = cen.substring(0, 3);

        var year = dt.getFullYear();
        var zeros = "";
        ////this to chk from the preferrences if from the preferrences it is  1 than generate id as center + year + 8 digit no.
        ////and if it is 2 than center + yrar + uid + 8 digit no.
        if (document.getElementById('hiddencioidformat').value == "1") {
            auto = cen + year;
        }
        else if (document.getElementById('hiddencioidformat').value == "2") {
            auto = cen + year + document.getElementById('hiddenuserid').value;
        }
        else if (document.getElementById('hiddencioidformat').value == "3") {
            auto = "";
        }
        else if (document.getElementById('hiddencioidformat').value == "4") {
            auto = "CL";
        }
        var autogen = auto + "0";
        var res = Classified_Booking.getBookingIdNo(document.getElementById('hiddencompcode').value, auto, no, document.getElementById('txtciobookid').value);
        var da = res.value;
        if (da == null) {
            alert(res.error.description);
            return false;
        }
        if (da.Tables[0].Rows.length > 0 && da.Tables[0].Rows[0].ID != "") {
            var ab = da.Tables[0].Rows[0].ID;
            var cou1 = parseInt(ab, 10);
            year = da.Tables[0].Rows[0].YEAR1;
            if (document.getElementById('hiddencioidformat').value == "1") {
                auto = cen + year;
            }
            else if (document.getElementById('hiddencioidformat').value == "2") {
                auto = cen + year + document.getElementById('hiddenuserid').value;
            }
            else if (document.getElementById('hiddencioidformat').value == "3") {
                auto = "";
            }
            else if (document.getElementById('hiddencioidformat').value == "4") {
                auto = "CL";
            }
            //cou1++;
            var countlen = cou1.toString().length;
            if (countlen == 1) {
                zeros = "0000000" + cou1;

            }
            else if (countlen == 2) {
                zeros = "000000" + cou1;

            }
            else if (countlen == 3) {
                zeros = "00000" + cou1;
            }
            else if (countlen == 4) {
                zeros = "0000" + cou1;
            }
            else if (countlen == 5) {
                zeros = "000" + cou1;
            }
            else if (countlen == 6) {
                zeros = "00" + cou1;
            }
            else if (countlen == 7) {
                zeros = "0" + cou1;
            }
            else if (countlen == 8) {
                zeros = "0" + cou1;
            }


            document.getElementById('txtciobookid').value = auto + zeros;
        }
        else {
            document.getElementById('txtciobookid').value = autogen;

        }
    }
    else if (no == "1") {
        var auto = "DN";
        var autogen = auto + "0";
        var res = Classified_Booking.getBookingIdNo(document.getElementById('hiddencompcode').value, auto, no, document.getElementById('txtciobookid').value);
        var da = res.value;
        if (da == null) {
            alert(res.error.description);
            return false;
        }
        if (da.Tables[0].Rows.length > 0 && da.Tables[0].Rows[0].ID != "") {
            var ab = da.Tables[0].Rows[0].ID;
            var cou1 = parseInt(ab, 10);
            //  cou1++;

            document.getElementById('txtdockitno1').value = auto + cou1;
        }
        else {
            document.getElementById('txtdockitno1').value = autogen;

        }


    }

    else if (no == "2") {
        var auto = "BN";
        var autogen = auto + "0";
        var res = Classified_Booking.getBookingIdNo(document.getElementById('hiddencompcode').value, auto, no, document.getElementById('txtciobookid').value);
        var da = res.value;
        if (da == null) {
            alert(res.error.description);
            return false;
        }
        if (da.Tables[0].Rows.length > 0 && da.Tables[0].Rows[0].boxno != "" && da.Tables[0].Rows[0].boxno != undefined) {
            var ab = da.Tables[0].Rows[0].boxno;
            var cou1 = parseInt(ab, 10);
            cou1++;

            document.getElementById('txtboxno').value = auto + cou1;
        }
        else {
            document.getElementById('txtboxno').value = autogen;

        }


    }

    //get max receipt number 
    else if (no == "3") {
        document.getElementById('txtreceipt').value = "";
        document.getElementById('hiddenreceiptno').value = "";
        var auto = '';
        var res = Classified_Booking.getBookingIdNo(document.getElementById('hiddencompcode').value, auto, no, document.getElementById('txtciobookid').value);
        var da = res.value;
        //***************************************
        if (da == null) {
            alert(res.error.description);
            return false;
        }
        var max_number = "0";
        if (da.Tables[0].Rows[0].recno.toString().length == 1)
            max_number = "000" + da.Tables[0].Rows[0].recno;
        else if (da.Tables[0].Rows[0].recno.toString().length == 2)
            max_number = "00" + da.Tables[0].Rows[0].recno;
        else if (da.Tables[0].Rows[0].recno.toString().length == 3)
            max_number = "0" + da.Tables[0].Rows[0].recno;
        else
            max_number = da.Tables[0].Rows[0].recno;
        //for sambad only
        if (document.getElementById('hiddenprereceipt').value == "6") {

            document.getElementById('txtreceipt').value = "C-BHU-" + max_number;
            document.getElementById('hiddenreceiptno').value = document.getElementById('txtreceipt').value;
        }
        else //for sambad only
        {
            if (document.getElementById('hiddenhidReceipt').value != "" && document.getElementById('txtbranch').value != "") {
                var arr = document.getElementById('txtbranch').value;
                var res = Classified_Booking.getBAlias(document.getElementById('txtbranch').value, document.getElementById('hiddencompcode').value);
                if (res.value != null && res.value.Tables[0].Rows.length > 0) {
                    var str = res.value.Tables[0].Rows[0].ALIAS;
                    var str1 = document.getElementById('hiddenhidReceipt').value.substring(0, document.getElementById('hiddenhidReceipt').value.indexOf("/"));
                    document.getElementById('hiddenhidReceipt').value = document.getElementById('hiddenhidReceipt').value.replace(str1, str);
                }

            }
            if (document.getElementById('hiddenpaymode').value == "CASH") {
                document.getElementById('txtreceipt').value = "R-" + document.getElementById('hiddenhidReceipt').value + max_number;
                document.getElementById('hiddenreceiptno').value = document.getElementById('txtreceipt').value;
            }
            else {
                document.getElementById('txtreceipt').value = document.getElementById('hiddenhidReceipt').value + max_number;
                document.getElementById('hiddenreceiptno').value = document.getElementById('txtreceipt').value;
            }
        }
    }



}
function queryClick() {
    clearClick();
    boxstatus = "";
    executequery = null;
    document.getElementById('txtRetainercomm').value = "";
    document.getElementById('hiddensavemod').value = "1";
    rownumEx = 0;
    document.getElementById('Button1').disabled = true;
    document.getElementById('chkgstinc').disabled = true;
    document.getElementById("div2").style.display = "none";
    document.getElementById('txtagaddf2').value = "";
    document.getElementById("div4").style.display = "none";
    document.getElementById('txtcliaddf2').value = "";	
    document.getElementById('btnshgrid').disabled = true;
    document.getElementById('btnsharing').disabled = true;
    document.getElementById('txtciobookid').value = "";
    document.getElementById('txtcreditperiod').value = "";
    document.getElementById('txtrono').value = "";
    document.getElementById('txtrodate').value = "";

    document.getElementById('drpbillstatus').value = "0";
    document.getElementById('drprostatus').value = "0";
    document.getElementById('txtagency').value = "";
    document.getElementById('txtclient').value = "";
    document.getElementById('txtagencyaddress').value = "";
    document.getElementById('txtclientadd').value = "";
    document.getElementById('drpagscode').value = "0";
    document.getElementById('txtdockitno1').value = "";
    document.getElementById('txtexecname').value = "";
    document.getElementById('txtexeczone').value = "";
    document.getElementById('txtproduct').value = "";
    document.getElementById('drpbrand').value = "";
    document.getElementById('txtkeyno').value = "";
    document.getElementById('txtbillremark').value = "";
    document.getElementById('txtprintremark').value = "";
    // drppackage.SelectedValue = "0";
    document.getElementById('txtinsertion').value = "";
    document.getElementById('txtdummydate').value = "";
    document.getElementById('txtrevisedate').value = "";
    document.getElementById('txtrepeatingdate').value = "";
    document.getElementById('drpbooktype').value = "0";
    document.getElementById('drpadcategory').value = "0";
    document.getElementById('drpadsubcategory').value = "0";
    document.getElementById('drpcolor').value = "0";
    document.getElementById('drpuom').value = "0";
    document.getElementById('drppageposition').value = "0";
    document.getElementById('txtMobile').value = "";
    document.getElementById('txtMobile').disabled = true;
    //txtadsizetypeheight.Text = "";
    //txtadsizetypewidth.Text = "";
    document.getElementById('txtratecode').value = "0";
    document.getElementById('drpscheme').value = "";
    //  drpschemepck.SelectedValue = "0";
    document.getElementById('drpcurrency').value = "0";
    document.getElementById('drprptcurrency').value = "0";
    document.getElementById('txtagreedrate').value = "";
    document.getElementById('txtagreedamt').value = "";

    document.getElementById('txtextracharges').value = "";
    document.getElementById('txtspedisc').value = "";
    document.getElementById('txtspediscper').value = "";
    document.getElementById('txtspacedisc').value = "";
    document.getElementById('txtspadiscper').value = "";
    document.getElementById('txtcolum').value = "";
    //txtbillcolumn.Text = "";
    ////txtbillarea.Text = "" = "";
    document.getElementById('drpmatstat').disabled = true;
    document.getElementById('drpmatstat').value = "0";

    //*14Aug* drpretainer.SelectedValue = "0";
    if (document.getElementById('txtaddagencycommrate') != null) {
        document.getElementById('txtaddagencycommrate').value = "";
        document.getElementById('txtaddagencycommrateamt').value = "";
    }
    document.getElementById('txtcontractname').value = "";
    document.getElementById('txtcontracttype').value = "";
    document.getElementById('txtcardname').value = "";
    document.getElementById('drptype').value = "0";
    document.getElementById('drpmonth').value = "0";
    document.getElementById('drpyear').value = "0";
    document.getElementById('txtcardno').value = "0";

    document.getElementById('drppackage').value = "0";
    document.getElementById('drppackagecopy').options.length = 0;
    document.getElementById('txtagencypaymode').options.length = 0;
    document.getElementById('drpadcat3').disabled = true
    document.getElementById('drpadcat4').disabled = true
    document.getElementById('drpadcat3').options.length = 0;
    document.getElementById('drpadcat4').options.length = 0;

    document.getElementById('drpbgcolor').disabled = true;
    document.getElementById('drpadcat5').disabled = true;
    document.getElementById('drpadcat5').options.length = 0;
    document.getElementById('drpbgcolor').value = "0";

    document.getElementById('drpbullet').disabled = true;
    document.getElementById('drpbullet').value = "0";
    document.getElementById('drpdiscountprem').disabled = true;
    document.getElementById('drpdiscountprem').value = "0";
    //////////////////////////////
    document.getElementById('txtdockitno1').disabled = false;
    document.getElementById('txtkeyno').disabled = false;
    document.getElementById('txtrono').disabled = false;
    document.getElementById('txtagency').disabled = false;
    document.getElementById('txtclient').disabled = false;

    document.getElementById('btnshgrid').disabled = true;
    //btnupload.Enabled = false;

    document.getElementById('txtciobookid').disabled = false;

    document.getElementById('hiddensavemod').value = "01";
    chkstatus(document.getElementById('hiddenbuttonidcheck').value);

    document.getElementById('btnQuery').disabled = true;
    document.getElementById('btnExecute').disabled = false;
    document.getElementById('btnSave').disabled = true;
    document.getElementById('tblinsert').innerHTML = '';
    if (document.getElementById('Hdnmodbook').value == "modify") {

        document.getElementById('txtciobookid').value = document.getElementById('Hdnmodbook').value;
        var dt = new Date()
        var auto = "";
        var cen = document.getElementById('hiddencenter').value;
        cen = cen.substring(0, 3);
        var year = dt.getFullYear();
        if (document.getElementById('hiddencioidformat').value == "1") {
            auto = cen + year;
        }
        else if (document.getElementById('hiddencioidformat').value == "2") {
            auto = cen + year + document.getElementById('hiddenuserid').value;
        }
        else if (document.getElementById('hiddencioidformat').value == "3") {
            auto = "";
        }
        else if (document.getElementById('hiddencioidformat').value == "4") {
            auto = "DI";
        }
        document.getElementById('txtciobookid').focus();
        document.getElementById('txtciobookid').value = document.getElementById('txtprevbook').value;

    }
    if (document.getElementById('hiddenquotation').value == "Q")
        document.getElementById('txtquotationno').disabled = true;
    else
        document.getElementById('txtquotationno').disabled = false;
    setButtonImages();
    return false;
}
function executeClick() {
    if (document.getElementById('txtciobookid').value == "" && document.getElementById('txtdockitno1').value == "" && document.getElementById('txtkeyno').value == "" && document.getElementById('txtrono').value == "" && document.getElementById('txtagency').value == "" && document.getElementById('txtclient').value == "") {
        alert("Please Select Booking Id or one another Filter")
        return false;
    }
    boxstatus = "";
    if (rownumEx == undefined || rownumEx == "undefined")
        rownumEx = 0;
    var msg = checkSession();
    if (msg == false) {
        window.location.href = "login.aspx";
        return false;
    }
    if (document.activeElement.id == "btnExecute") {
        if (document.getElementById('hiddencopybooking').value == "y" && document.getElementById('hdncopybookingpermission').value == 'Y') {
            //if (confirm("Do you want to copy the data ?")) {  hidcopy = "copy"; }
            //else { hidcopy = ""; }
            if (confirm("Do you want to Modify / Copy ?")) 
            {
                hidcopy = "";
            }
            else 
            {
                hidcopy = "copy";
            }
        }
    }
    //dan
    var strtextd = "";
    chkbtnStatus = "execute";
    var httpRequest = null;
    httpRequest = new XMLHttpRequest();
    if (httpRequest.overrideMimeType) {
        httpRequest.overrideMimeType('text/xml');
    }
    //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };

    httpRequest.open("GET", "checksessiondan.aspx", false);
    httpRequest.send('');
    //alert(httpRequest.readyState);
    if (httpRequest.readyState == 4) {
        //alert(httpRequest.status);
        if (httpRequest.status == 200) {
            strtextd = httpRequest.responseText;
        }
        else {
            //alert('There was a problem with the request.');
            if (browser != "Microsoft Internet Explorer") {
                //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
            }
        }
    }
    if (strtextd != "sess") {
        alert('session expired');
        window.location.href = "Default.aspx";
        return false;
    }

    document.getElementById('tblinsert').innerHTML = '';
    document.getElementById('hiddensavemod').value = "1";
    document.getElementById('LinkButton1').disabled = false;
    document.getElementById('LinkButton2').disabled = false;
    document.getElementById('LinkButton3').disabled = false;
    document.getElementById('LinkButton4').disabled = false;
    document.getElementById('LinkButton5').disabled = false;
    document.getElementById('LinkButton6').disabled = false;
    document.getElementById('LinkButton7').disabled = false;

    //////////////////////////////////////////////////////////////////////////
    document.getElementById('txttranslationdisc').disabled = true;
    document.getElementById('txtpospremdisc').disabled = true;
    document.getElementById('txtdatetime').disabled = true;
    document.getElementById('txtbillwidth').disabled = true;
    document.getElementById('txtbillheight').disabled = true;
    document.getElementById('btnshgrid').disabled = true;
    //btnupload.Enabled = false;
    document.getElementById('txtRetainercommamt').disabled = true;
    document.getElementById('txtRetainercomm').disabled = true;
    document.getElementById('drpbooktype').disabled = true;
    document.getElementById('txtciobookid').disabled = true;
    // txtappby.Enabled = true;
    //txtaudit.Enabled = true;
    document.getElementById('txtrevisedate').disabled = true;
    document.getElementById('txtrono').disabled = true;
    document.getElementById('txtrodate').disabled = true;
    document.getElementById('txtMobile').disabled = true;
    document.getElementById('drpbillstatus').disabled = true;
    document.getElementById('drprostatus').disabled = true;
    document.getElementById('txtagency').disabled = true;
    document.getElementById('txtclient').disabled = true;
    // txtagencyaddress.Enabled = true;
    document.getElementById('txtclientadd').disabled = true;
    document.getElementById('drpagscode').disabled = true;
    document.getElementById('txtdockitno1').disabled = true;
    document.getElementById('txtexecname').disabled = true;
    document.getElementById('txtexeczone').disabled = true;
    document.getElementById('txtproduct').disabled = true;
    document.getElementById('drpbrand').disabled = true;
    document.getElementById('txtkeyno').disabled = true;
    document.getElementById('txtbillremark').disabled = true;
    document.getElementById('txtprintremark').disabled = true;
    document.getElementById('drppackage').disabled = true;
    document.getElementById('txtinsertion').disabled = true;
    document.getElementById('txtdummydate').disabled = true;
    document.getElementById('txtrepeatingdate').disabled = true;
    document.getElementById('drpbooktype').disabled = true;
    document.getElementById('drpadcategory').disabled = true;
    document.getElementById('drpadsubcategory').disabled = true;
    document.getElementById('drpadcat3').disabled = true;
    document.getElementById('drpadcat4').disabled = true;
    document.getElementById('drpadcat5').disabled = true;
    document.getElementById('drpbgcolor').disabled = true;
    document.getElementById('drpcolor').disabled = true;
    document.getElementById('drpuom').disabled = true;
    document.getElementById('drppageposition').disabled = true;

    // txtadsizetypeheight.Enabled = true;
    //txtadsizetypewidth.Enabled = true;
    document.getElementById('txtratecode').disabled = true;
    document.getElementById('drpscheme').disabled = true;
    //  drpschemepck.Enabled = false;
    document.getElementById('drpcurrency').disabled = true;
    document.getElementById('drprptcurrency').disabled = true;
    document.getElementById('txtagreedrate').disabled = true;
    document.getElementById('txtagreedamt').disabled = true;

    document.getElementById('txtextracharges').disabled = true;
    document.getElementById('txtspedisc').disabled = true;
    document.getElementById('txtspediscper').disabled = true;
    document.getElementById('txtspacedisc').disabled = true;
    document.getElementById('txtspadiscper').disabled = true;
    document.getElementById('txtdatetime').disabled = true;
    document.getElementById('txtrepeatingdate').disabled = true;

    document.getElementById('drpbillcycle').disabled = true;
    document.getElementById('drprevenue').disabled = true;
    //drpbilltype.Enabled = true;
    document.getElementById('drpbillstatus').disabled = true;
    //drpbillcurrency.Enabled = true;
    document.getElementById('drppaymenttype').disabled = true;
    document.getElementById('txtinvoice').disabled = true;
    document.getElementById('txtvts').disabled = true;
    document.getElementById('txtcirrate').disabled = true;
    document.getElementById('txtciragency').disabled = true;
    document.getElementById('txtciredition').disabled = true;
    document.getElementById('txtbillwidth').disabled = true;
    document.getElementById('txtbillheight').disabled = true;
    document.getElementById('drpbillto').disabled = true;
    document.getElementById('txttradedisc').disabled = true;
    document.getElementById('chktrade').disabled = true;
    document.getElementById('txtagencyoutstand').disabled = true;
    document.getElementById('txtcardrate').disabled = true;
    document.getElementById('txtcardamt').disabled = true;
    document.getElementById('txtdiscount').disabled = true;
    document.getElementById('txtdiscpre').disabled = true;
    document.getElementById('txtadsize2').disabled = true;
    document.getElementById('txtadsize1').disabled = true;
    document.getElementById('txttotalarea').disabled = true;
    document.getElementById('txtbilladdress').disabled = true;

    document.getElementById('drpboxcode').disabled = true;
    //txtboxno.Enabled = true;
    document.getElementById('txtboxaddress').disabled = true;

    document.getElementById('txtbillamt').disabled = true;

    document.getElementById('txtgrossamt').disabled = true;
    //checkinfo
    document.getElementById('ttextchqno').disabled = true;
    document.getElementById('ttextchqdate').disabled = true;
    document.getElementById('ttextchqamt').disabled = true;
    document.getElementById('ttextbankname').disabled = true;
    document.getElementById('drpourbank').disabled = true;
    document.getElementById('drpboxcode').disabled = true;
    document.getElementById('chkage').disabled = true;
    document.getElementById('chkclie').disabled = true;
    document.getElementById('chktfn').disabled = true;

    document.getElementById('txtboxaddress').disabled = true;
    document.getElementById('txtinsertion').disabled = true;

    document.getElementById('txtcolum').disabled = true;

    document.getElementById('txtboxno').disabled = true;

    ///////////////////////
    document.getElementById('txtcontractname').disabled = true;
    document.getElementById('txtcontracttype').disabled = true;
    document.getElementById('txtcardname').disabled = true;
    document.getElementById('drptype').disabled = true;
    document.getElementById('drpmonth').disabled = true;
    document.getElementById('drpyear').disabled = true;
    document.getElementById('txtcardno').disabled = true;
    document.getElementById('txtagencypaymode').disabled = true;

    document.getElementById('btncopy').disabled = true;
    document.getElementById('btndel').disabled = true;
    document.getElementById('btnshgrid').disabled = true;
    document.getElementById('btndeal').disabled = true;
    document.getElementById('drpmatstat').disabled = true;
    document.getElementById('drpdiscountprem').disabled = true;
    document.getElementById('drpbullet').disabled = true;
    document.getElementById('drpretainer').disabled = true;
    if (document.getElementById('txtaddagencycommrate') != null) {
        document.getElementById('txtaddagencycommrate').disabled = true;
        document.getElementById('txtaddagencycommrateamt').disabled = true;
    }

    ///////////////////////////////////////////////////////////////////////////

    // document.getElementById('txtciobookidv').disabled = true;
    document.getElementById('Button1').disabled = true;
    var ciobookid = document.getElementById('txtciobookid').value;
    document.getElementById('hiddencioid').value = ciobookid;
    gciobookid = ciobookid;
    var docno = document.getElementById('txtdockitno1').value;
    gdockitno = docno;
    var keyno = document.getElementById('txtkeyno').value;
    gkeyno = keyno;
    var rono = document.getElementById('txtrono').value;
    grono = rono;

    var agencycod = document.getElementById('txtagency').value;
    var agencycode = "";
    //////////////this is to split the  and get the code
    if (agencycod != "") {
        //char[] splitter = { '(' };
        var myarray = agencycod.split('(');
        agencycode = myarray[1];
        agencycode = agencycode.replace(")", "");
        gagencyscode = agencycode;
    }
    ////for client

    ////////////////////////////////////


    var clientcode = document.getElementById('txtclient').value;
    var client = "";
    ///this is to split and get the client code

    if (clientcode.indexOf("(".toString()) > 0 && clientcode != "") {
        //clientcode.IndexOf(
        // char[] splitterclie = { '(' };
        var myarray1 = clientcode.split('(');
        client = myarray1[1];
        client = client.replace(")", '');

        /////this is to chk whether this code exixts in the database if exists than it is a register client else
        ///it is walkinn client
        ///
        var res = Classified_Booking.chkwalkinClient(client, document.getElementById('hiddencompcode').value);
        var dcl = res.value;
        if (dcl == null) {
            alert(res.error.description);
            return false;
        }
        if (dcl.Tables[0].Rows.length > 0) {

        }
        else {
            client = clientcode;
        }

    }
    else {
        client = clientcode;
    }
    gclient = client;


    var clientcode = ""; //document.getElementById('clinetcode_'+k1).value;
    var client_name = ""; //document.getElementById('clinetname_'+k1).value;
    var clinet_add = ""; //document.getElementById('clientadd_'+k1).value;
    var clinet_width = ""; //document.getElementById('width_'+k1).value;
    var client_height = ""; //document.getElementById('height_'+k1).value;
    var gros_amt = ""; //document.getElementById('grossamt_'+k1).value;
    var bill_amt1 = ""; //document.getElementById('billamt_'+k1).value;
    var comm = ""; //document.getElementById('commi_'+k1).value;
    var bill_no = ""; //document.getElementById('hiddencompcode').value;
    var bill_dt = ""; //document.getElementById('hiddencompcode').value;
    var flag = "E";
    var extra1 = ciobookid;
    var extra2 = "";
    var extra3 = "";
    var extra4 = "";
    var extra5 = "";
    var result = Classified_Booking.multi_billing(document.getElementById('hiddencompcode').value, clientcode, client_name, clinet_add, clinet_width, client_height, gros_amt, comm, bill_amt1, bill_no, bill_dt, document.getElementById('hiddenuserid').value, flag, extra1, extra2, extra3, extra4, extra5);
    if (result.value.Tables[0].Rows.length != 0)
        callback_execgrid(result);

    var quotation_no = document.getElementById('txtquotationno').value
    ////////////////////////////////////////////////////////////////////////////////////////
    //var res1 = Classified_Booking.executeBooking(document.getElementById('hiddencompcode').value, ciobookid, docno, keyno, rono, agencycode, client, "CL0", document.getElementById('hiddendateformat').value, document.getElementById('hiddenuserid').value, document.getElementById('hiddensupplimentflag').value);
    var res1 = Classified_Booking.executeBooking(document.getElementById('hiddencompcode').value, ciobookid, docno, keyno, rono, agencycode, client, "CL0", document.getElementById('hiddendateformat').value, document.getElementById('hiddenuserid').value, document.getElementById('hiddensupplimentflag').value, document.getElementById('hiddenquotation').value, quotation_no);
    executequery = res1.value;
    if (executequery == null) {
        alert(res1.error.description);
        return false;
    }
    // dateinsert getdatechk = new dateinsert();
    rownumEx = 0;
    fillDATA();
    setButtonImages();
    return false;
}
//     function updateStatus()
//    {
//        chkstatus(document.getElementById('hiddenbuttonidcheck').value);
//        if (document.getElementById('hiddenbuttonidcheck').value == 2 || document.getElementById('hiddenbuttonidcheck').value == 3)
//        {
//            document.getElementById('btnQuery').disabled = false;
//            document.getElementById('btnExecute').disabled = true;
//            document.getElementById('btnSave').disabled = true;
//            document.getElementById('btnModify').disabled = false;
//            document.getElementById('btnfirst').disabled = false;
//            document.getElementById('btnnext').disabled = false;
//            document.getElementById('btnprevious').disabled = false;
//            document.getElementById('btnlast').disabled = false;
//            document.getElementById('btnDelete').disabled = true;
//        }
//        if (document.getElementById('hiddenbuttonidcheck').value == 4)
//        {
//            document.getElementById('btnDelete').disabled = false;
//            document.getElementById('btnExecute').disabled = true;
//            document.getElementById('btnSave').disabled = true;
//            document.getElementById('btnQuery').disabled = false;
//            document.getElementById('btnModify').disabled = true;
//            document.getElementById('btnfirst').disabled = false;
//            document.getElementById('btnnext').disabled = false;
//            document.getElementById('btnprevious').disabled = false;
//            document.getElementById('btnlast').disabled = false;

//        }
//        if (document.getElementById('hiddenbuttonidcheck').value == 5)
//        {
//            document.getElementById('btnDelete').disabled = false;
//            document.getElementById('btnExecute').disabled = true;
//            document.getElementById('btnSave').disabled = true;
//            document.getElementById('btnQuery').disabled = false;
//            document.getElementById('btnModify').disabled = true;
//            document.getElementById('btnfirst').disabled = false;
//            document.getElementById('btnnext').disabled = false;
//            document.getElementById('btnprevious').disabled = false;
//            document.getElementById('btnlast').disabled = false;

//        }
//        if (document.getElementById('hiddenbuttonidcheck').value == 6 || document.getElementById('hiddenbuttonidcheck').value == 7 || document.getElementById('hiddenbuttonidcheck').value == 15)
//        {
//            document.getElementById('btnDelete').disabled = false;
//            document.getElementById('btnExecute').disabled = true;
//            document.getElementById('btnSave').disabled = true;
//            document.getElementById('btnQuery').disabled = false;
//            document.getElementById('btnModify').disabled = false;
//            document.getElementById('btnfirst').disabled = false;
//            document.getElementById('btnnext').disabled = false;
//            document.getElementById('btnprevious').disabled = false;
//            document.getElementById('btnlast').disabled = false;

//        }
//      
//    }
function firstClick() {
    clearClick();
    cali = 0;
    rownumEx = 0;
    fillDATA();
    document.getElementById('txtRetainercomm').value = "";
    document.getElementById('txtRetainercomm').disabled = true;
    document.getElementById('LinkButton1').disabled = false;
    document.getElementById('LinkButton2').disabled = false;
    document.getElementById('LinkButton3').disabled = false;
    document.getElementById('LinkButton4').disabled = false;
    document.getElementById('LinkButton5').disabled = false;
    document.getElementById('LinkButton6').disabled = false;
    document.getElementById('LinkButton7').disabled = false;
    document.getElementById('btnfirst').disabled = true;
    document.getElementById('btnprevious').disabled = true;
    setButtonImages();
    return false;
    //        document.getElementById('tblinsert').innerHTML='';
    //        clearClick();
    //        document.getElementById('LinkButton1').disabled = false;
    //        document.getElementById('LinkButton2').disabled = false;
    //        document.getElementById('LinkButton3').disabled = false;
    //        document.getElementById('LinkButton4').disabled = false;
    //        document.getElementById('LinkButton5').disabled = false;
    //        document.getElementById('LinkButton6').disabled = false;
    //        document.getElementById('LinkButton7').disabled = false;
    //        rownumEx=0;
    //        //////////////////////////////////////////////////////////////////////////

    //       
    //          if(executequery==null)
    //          {
    //            alert(res1.error.description);
    //            return false;
    //          }
    //           // dateinsert getdatechk = new dateinsert();
    //            if (executequery.Tables[0].Rows.length > 0)
    //            {
    //                if(executequery.Tables[0].Rows[0].branch!=null)
    //                {
    //                    document.getElementById('txtbranch').value = executequery.Tables[0].Rows[0].branch;
    //                }    
    //                if(executequery.Tables[0].Rows[0].booked_by!=null)
    //                {
    //                    document.getElementById('txtbookedby').value = executequery.Tables[0].Rows[0].booked_by;
    //                }
    //                if(executequery.Tables[0].Rows[0].prev_booking!=null)
    //                {    
    //                    document.getElementById('txtprevbook').value = executequery.Tables[0].Rows[0].prev_booking;
    //                }    
    //                var datetime = executequery.Tables[0].Rows[0].DATE_TIME;
    //                if(datetime!=null)
    //                {
    //                    document.getElementById('txtdatetime').value = datetime;//getdatechk.getDate(dateformat, datetime);
    //                 }   
    //                 if(executequery.Tables[0].Rows[0].cio_booking_id!=null)
    //                 {
    //                    document.getElementById('txtciobookid').value = executequery.Tables[0].Rows[0].cio_booking_id;
    //                 }  
    //                //txtappby.Text = executequery.Tables[0].Rows[0].ItemArray[5].ToString();
    //                // txtaudit.Text = executequery.Tables[0].Rows[0].ItemArray[6].ToString();
    //                if(executequery.Tables[0].Rows[0].RO_No!=null)
    //                {
    //                    document.getElementById('txtrono').value = executequery.Tables[0].Rows[0].RO_No;
    //                 }   
    //                var ro_date = executequery.Tables[0].Rows[0].RO_Date;
    //                if(ro_date!=null)
    //                {  
    //                    document.getElementById('txtrodate').value = ro_date;//getdatechk.getDate(dateformat, ro_date);
    //                }   
    //                if(executequery.Tables[0].Rows[0].bill_status!=null)
    //                {
    //                    document.getElementById('drpbillstatus').value = executequery.Tables[0].Rows[0].bill_status;
    //                }   
    //                if(executequery.Tables[0].Rows[0].ro_status!=null)
    //                {
    //                    document.getElementById('drprostatus').value = executequery.Tables[0].Rows[0].ro_status;
    //                }    
    //                if(executequery.Tables[0].Rows[0].AgencyName!=null)
    //                {
    //                    document.getElementById('txtagency').value = executequery.Tables[0].Rows[0].AgencyName;
    //                }    
    //                //drpagency_SelectedIndexChanged(sender, e);

    //                ///////////////this is to bind the subagency drop down
    //            
    //               var res2=Classified_Booking.bindsubagency(executequery.Tables[0].Rows[0].Agency_sub_code, document.getElementById('hiddencompcode').value);
    //                
    //                var dsbsa = res2.value;
    //                if(dsbsa==null)
    //                {
    //                    alert(res2.error.description);
    //                    return false;
    //                }
    //               

    //                document.getElementById('drpagscode').options.length=0;
    //                document.getElementById('drpagscode').options[0]=new Option("Select Agency","0");
    //                document.getElementById('drpagscode').options.length = 1; 
    //                for (var i = 0  ; i < dsbsa.Tables[0].Rows.length; ++i)
    //                {
    //                    document.getElementById('drpagscode').options[document.getElementById('drpagscode').options.length] = new Option(dsbsa.Tables[0].Rows[i].agency_name,dsbsa.Tables[0].Rows[i].Agency_Code);
    //                
    //                    document.getElementById('drpagscode').options.length;       
    //                }


    //            //////////////////////////////////////////////////////
    //            if(executequery.Tables[0].Rows[0].Client!=null)
    //            {
    //                document.getElementById('txtclient').value = executequery.Tables[0].Rows[0].Client;     //.ItemArray[14].ToString();
    //            }    
    //            if(executequery.Tables[0].Rows[0].Agency_address!=null)
    //            {
    //                document.getElementById('txtagencyaddress').value = executequery.Tables[0].Rows[0].Agency_address;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Client_address!=null)
    //            {
    //                document.getElementById('txtclientadd').value = executequery.Tables[0].Rows[0].Client_address;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Agency_code!=null)
    //            {
    //                document.getElementById('hiddensubcode').value = document.getElementById('drpagscode').value = executequery.Tables[0].Rows[0].Agency_code;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Dockit_no!=null)
    //            {
    //                document.getElementById('txtdockitno1').value = executequery.Tables[0].Rows[0].Dockit_no;
    //            }   
    //            if(executequery.Tables[0].Rows[0].execname!=null)
    //            { 
    //                document.getElementById('txtexecname').value = executequery.Tables[0].Rows[0].execname;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Executive_zone!=null)
    //            {
    //                document.getElementById('hiddenzone').value = document.getElementById('txtexeczone').value = executequery.Tables[0].Rows[0].Executive_zone;
    //            }    
    //            if(executequery.Tables[0].Rows[0].product!=null)
    //            {
    //                document.getElementById('txtproduct').value = executequery.Tables[0].Rows[0].product;
    //            }    
    //            //drpproduct_SelectedIndexChanged1(sender, e);
    //            //drpbrand.SelectedValue = executequery.Tables[0].Rows[0].ItemArray[21].ToString();
    //            /////////////////////////////////////////////this is to bind the brand drop down
    //            res2=null;
    //            if(executequery.Tables[0].Rows[0].Product_code!=null)
    //            {
    //            res2=Classified_Booking.brandbind(document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[0].Product_code);
    //            var dsbrand = res2.value;
    //            if(dsbrand==null)
    //            {
    //                alert(res2.error.description);
    //                return false;
    //            }
    //            
    //              document.getElementById('drpbrand').options.length=0;
    //              document.getElementById('drpbrand').options[0]=new Option("Select Brand","0");
    //              document.getElementById('drpbrand').options.length = 1; 
    //                for (var i = 0  ; i < dsbrand.Tables[0].Rows.length; ++i)
    //                {
    //                    document.getElementById('drpbrand').options[document.getElementById('drpbrand').options.length] = new Option(dsbrand.Tables[0].Rows[i].brand_name,dsbrand.Tables[0].Rows[i].brand_code);
    //                
    //                    document.getElementById('drpbrand').options.length;       
    //                }
    //                
    //           }
    //            //hiddenbrand.Value=drpbrand.SelectedValue = executequery.Tables[0].Rows[0].ItemArray[21].ToString();
    //            if (executequery.Tables[0].Rows[0].Brand_code==null || executequery.Tables[0].Rows[0].Brand_code.toString() == "")
    //            {
    //                document.getElementById('drpbrand').options.length=0;
    //                document.getElementById('hiddenbrand').value = "";
    //            }
    //            else
    //            {
    //                if(executequery.Tables[0].Rows[0].Brand_code!=null)
    //                {
    //                    document.getElementById('hiddenbrand').value = document.getElementById('drpbrand').value = executequery.Tables[0].Rows[0].Brand_code.toString();
    //                }    
    //            }
    //            ////////////////////this is to bind the varient dropdown

    //          
    //            ////////////////////////////////////////////////////////////////////////////////
    //            if(executequery.Tables[0].Rows[0].Key_no!=null)
    //            {
    //                document.getElementById('txtkeyno').value = executequery.Tables[0].Rows[0].Key_no;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Bill_remarks!=null)
    //            {
    //                document.getElementById('txtbillremark').value = executequery.Tables[0].Rows[0].Bill_remarks;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Print_remark!=null)
    //            {
    //                document.getElementById('txtprintremark').value = executequery.Tables[0].Rows[0].Print_remark;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Package_code!=null)
    //            {
    //                var listpck = executequery.Tables[0].Rows[0].Package_code;
    //            document.getElementById('hiddenpackage').value = listpck;
    //            //////////////////this is to bind the package grid on what the value is saved in the database


    //            res2=null;
    //            res2=Classified_Booking.bindpacforexe(document.getElementById('hiddencompcode').value, listpck);
    //            var dsexecut = res2.value;
    //            if(dsexecut==null)
    //            {
    //                alert(res2.error.description);
    //                return false;
    //            }
    //                 
    //           
    //            
    //            
    //            document.getElementById('drppackagecopy').options.length=0;
    //            for (i = 0; i <= dsexecut.Tables[0].Rows.length - 1; i++)
    //            {
    //                if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "")
    //                {
    //                    if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "0")
    //                    {
    //                        var arrfor_uom = dsexecut.Tables[0].Rows[i].pck_code.toString().split('@');
    //                        var res3=Classified_Booking.getPackageInsert(arrfor_uom[0].toString(), document.getElementById('txtciobookid').value);
    //                        var dsinsert = res3.value;
    //                        if(dsinsert==null)
    //                        {
    //                            alert(res3.error.description);
    //                            return false;
    //                        }
    //                        var T=dsexecut.Tables[0].Rows[i].Package_Name + "(" + dsinsert.Tables[0].Rows[0].inserts + ")";
    //                        var V=dsexecut.Tables[0].Rows[i].pck_code + "(" + dsinsert.Tables[0].Rows[0].inserts + ")";
    //                        document.getElementById('drppackagecopy').options[document.getElementById('drppackagecopy').options.length] = new Option(T,V);
    //                
    //                        document.getElementById('drppackagecopy').options.length;   
    //                    
    ////                        ListItem li;
    ////                        li = new ListItem();
    ////                        li.Text = dsexecut.Tables[0].Rows[i].ItemArray[1].ToString() + "(" + dsinsert.Tables[0].Rows[0].ItemArray[0].ToString() + ")";
    ////                        li.Value = dsexecut.Tables[0].Rows[i].ItemArray[2].ToString() + "(" + dsinsert.Tables[0].Rows[0].ItemArray[0].ToString() + ")"; ;
    ////                        //state = ds.Tables[0].Rows[i].ItemArray[2].ToString();
    ////                        drppackagecopy.Items.Add(li);

    //                    }
    //                }
    //            }

    //        }
    //                
    //            if(executequery.Tables[0].Rows[0].No_of_insertion!=null)
    //            {
    //                document.getElementById('txtinsertion').value = executequery.Tables[0].Rows[0].No_of_insertion;
    //                document.getElementById('hiddeninsertion').value = executequery.Tables[0].Rows[0].No_of_insertion;
    //            }   
    //            
    //            var start_date = executequery.Tables[0].Rows[0].Insertion_date;
    //            if(start_date!=null)
    //            {
    //                document.getElementById('txtdummydate').value = start_date;//getdatechk.getDate(dateformat, start_date);
    //            }    
    //            if(executequery.Tables[0].Rows[0].Repeating_day!=null)
    //            {
    //                document.getElementById('txtrepeatingdate').value = executequery.Tables[0].Rows[0].Repeating_day;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Booking_type!=null)
    //            {
    //                document.getElementById('drpbooktype').value = executequery.Tables[0].Rows[0].Booking_type;
    //            }   
    //            if(executequery.Tables[0].Rows[0].Ad_cat_code!=null)
    //            {
    //                document.getElementById('drpadcategory').value = executequery.Tables[0].Rows[0].Ad_cat_code;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Ad_sub_cat_code!=null)
    //            {
    //                document.getElementById('drpadsubcategory').value = executequery.Tables[0].Rows[0].Ad_sub_cat_code;
    //            }
    //            if(executequery.Tables[0].Rows[0].Color_code!=null)
    //            {
    //                document.getElementById('drpcolor').value = executequery.Tables[0].Rows[0].Color_code;
    //            }   
    //            if(executequery.Tables[0].Rows[0].Uom_code!=null)
    //            {
    //                document.getElementById('drpuom').value = executequery.Tables[0].Rows[0].Uom_code;
    //            }    
    //            //*25Aug* 
    //            res3=null;
    //            res3 = Classified_Booking.gettheuom_desc(document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[0].Uom_code);  
    //            var ds_uom_=res3.value;
    //            if(ds_uom_==null)
    //            {
    //                alert(res3.error.description);
    //                return false;
    //            }
    //            if(ds_uom_.Tables[0].Rows.length>0)
    //            {
    //                document.getElementById('hiddenuomdesc').value = ds_uom_.Tables[0].Rows[0].uom_desc;   
    //            }
    //                
    //                
    //                //*25Aug*
    //            if(executequery.Tables[0].Rows[0].Page_position_code!=null)
    //            {
    //                document.getElementById('drppageposition').value = executequery.Tables[0].Rows[0].Page_position_code;
    //             }   
    //       
    //            //string adtype=drpadstype.SelectedValue;
    //            if(executequery.Tables[0].Rows[0].Ad_size_height!=null)
    //            {
    //                document.getElementById('txtadsize1').value = executequery.Tables[0].Rows[0].Ad_size_height;
    //            }   
    //            if(executequery.Tables[0].Rows[0].Ad_size_width!=null)
    //            {
    //                document.getElementById('txtadsize2').value = executequery.Tables[0].Rows[0].Ad_size_width;
    //            }    
    //            ////this is to bind the ratecode drpdown
    //            res3=null
    //            if(executequery.Tables[0].Rows[0].Ad_cat_code!=null)
    //            {
    //            res3=Classified_Booking.ratebind(executequery.Tables[0].Rows[0].Ad_cat_code, document.getElementById('hiddencompcode').value);
    //            var dx = res3.value;
    //            if(dx==null)
    //            {   
    //                alert(dx.error.description);
    //                return false;
    //            }
    //             
    //            
    //            

    //              document.getElementById('txtratecode').options.length=0;
    //              document.getElementById('txtratecode').options[0]=new Option("-Select Rate Code-","0");
    //              document.getElementById('txtratecode').options.length = 1; 
    //            
    //             for (var i = 0  ; i < dx.Tables[0].Rows.length; ++i)
    //                {
    //                    document.getElementById('txtratecode').options[document.getElementById('txtratecode').options.length] = new Option(dx.Tables[0].Rows[i].rate_mast_code,dx.Tables[0].Rows[i].rate_mast_code);
    //                
    //                    document.getElementById('txtratecode').options.length;       
    //                }
    //                
    //           }
    //           if(executequery.Tables[0].Rows[0].Rate_code!=null)
    //           {
    //                document.getElementById('txtratecode').value = executequery.Tables[0].Rows[0].Rate_code;
    //           }    
    //            if(executequery.Tables[0].Rows[0].Scheme_type_code!=null)
    //            {
    //                document.getElementById('drpscheme').value = executequery.Tables[0].Rows[0].Scheme_type_code;
    //            }   
    //            if(executequery.Tables[0].Rows[0].Scheme_type_code!=null)
    //            { 
    //                document.getElementById('hiddenscheme').value = executequery.Tables[0].Rows[0].Scheme_type_code;
    //            }    
    //     //       drpschemepck.SelectedValue = executequery.Tables[0].Rows[0].ItemArray[41].ToString();
    //            if(executequery.Tables[0].Rows[0].Currency_code!=null)
    //            {
    //                document.getElementById('drpcurrency').value = executequery.Tables[0].Rows[0].Currency_code;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Agrred_rate!=null)
    //            {
    //                document.getElementById('txtagreedrate').value = executequery.Tables[0].Rows[0].Agrred_rate;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Agreed_amount!=null)
    //            {
    //                document.getElementById('txtagreedamt').value = executequery.Tables[0].Rows[0].Agreed_amount;
    //            }    
    //    
    //            if(executequery.Tables[0].Rows[0].Special_charges!=null)
    //            {
    //                document.getElementById('txtextracharges').value = executequery.Tables[0].Rows[0].Special_charges;
    //            }   
    //            if(executequery.Tables[0].Rows[0].Agency_status!=null)
    //            {
    //                document.getElementById('hiddenstatus').value = document.getElementById('txtagencystatus').value = executequery.Tables[0].Rows[0].Agency_status;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Agency_type!=null)
    //            {
    //                document.getElementById('txtagencytype').value = executequery.Tables[0].Rows[0].Agency_type;
    //            }    
    //            //this is To the bind the the agencypaymode dropdown on execution
    //            res3=null;
    //            if(executequery.Tables[0].Rows[0].Agency_sub_code!=null)
    //            {
    //            res3=Classified_Booking.getstatuspaymode(executequery.Tables[0].Rows[0].Agency_sub_code, executequery.Tables[0].Rows[0].Agency_code, document.getElementById('hiddencompcode').value, document.getElementById('txtdatetime').value,document.getElementById('hiddendateformat').value,"CL0");
    //            var dch = res3.value;
    //            if(dch==null)
    //            {
    //                alert(res3.error.description);
    //                return false;
    //            }
    //            
    //            

    //            document.getElementById('txtagencypaymode').options.length=0;
    //            if (dch.Tables[5].Rows.length > 0)
    //            {
    //                for (var i = 0; i < dch.Tables[5].Rows.length; i++)
    //                {
    //                    document.getElementById('txtagencypaymode').options[document.getElementById('txtagencypaymode').options.length] = new Option(dch.Tables[5].Rows[i].payment_mode_name,dch.Tables[5].Rows[i].pay_mode_code);
    //                
    //                    document.getElementById('txtagencypaymode').options.length; 
    //                   
    //                }

    //            }
    //           } 
    //            ///////////////////////////////////////////////////////////////////////////////////////////////////
    //            if(executequery.Tables[0].Rows[0].Agency_pay!=null)
    //            {
    //                document.getElementById('hiddenpay').value =  document.getElementById('txtagencypaymode').value = executequery.Tables[0].Rows[0].Agency_pay;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Agency_credit!=null)
    //            {
    //                document.getElementById('txtcreditperiod').value = executequery.Tables[0].Rows[0].Agency_credit;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Total_area!=null)
    //            {
    //                document.getElementById('txttotalarea').value = executequery.Tables[0].Rows[0].Total_area;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Card_rate!=null)
    //            {
    //                document.getElementById('txtcardrate').value = executequery.Tables[0].Rows[0].Card_rate;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Card_amount!=null)
    //            {
    //                document.getElementById('txtcardamt').value = executequery.Tables[0].Rows[0].Card_amount;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Discount!=null)
    //            {
    //                document.getElementById('txtdiscount').value = executequery.Tables[0].Rows[0].Discount;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Discount_per!=null)
    //            {
    //                document.getElementById('txtdiscpre').value = executequery.Tables[0].Rows[0].Discount_per;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Bill_cycle!=null)
    //            {
    //                document.getElementById('drpbillcycle').value = executequery.Tables[0].Rows[0].Bill_cycle;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Revenue_center!=null)
    //            {
    //                document.getElementById('drprevenue').value = executequery.Tables[0].Rows[0].Revenue_center;
    //            }    

    //            ////this is to bind the bill pay mode
    //            document.getElementById('drppaymenttype').options.length=0;
    //            if (dch.Tables[5].Rows.length > 0)
    //            {
    //                for (var i = 0;  i< dch.Tables[5].Rows.length; i++)
    //                {
    //                   document.getElementById('drppaymenttype').options[document.getElementById('drppaymenttype').options.length] = new Option(dch.Tables[5].Rows[i].payment_mode_name,dch.Tables[5].Rows[i].pay_mode_code);
    //                
    //                    document.getElementById('drppaymenttype').options.length; 
    //                }

    //            }
    //            if(executequery.Tables[0].Rows[0].Bill_pay!=null)
    //            {    
    //                document.getElementById('hiddenbillpay').value = document.getElementById('drppaymenttype').value = executequery.Tables[0].Rows[0].Bill_pay;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Bill_height!=null)
    //            {
    //                document.getElementById('txtbillheight').value = executequery.Tables[0].Rows[0].Bill_height;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Bill_width!=null)
    //            {
    //                document.getElementById('txtbillwidth').value = executequery.Tables[0].Rows[0].Bill_width;
    //            }    
    //            //////////////this is to bind the bill to 
    //            res3=null;
    //            if(executequery.Tables[0].Rows[0].Agency_sub_code!=null)
    //            {
    //            res3=Classified_Booking.getbillval(executequery.Tables[0].Rows[0].Agency_sub_code, document.getElementById('hiddencompcode').value);
    //            var dbt = res3.value;
    //            if(dbt==null)
    //            {
    //                alert(res3.error.description);
    //                return false;
    //            }
    //           
    //            
    //            ////////////////////////////////////////////////////
    //            document.getElementById('drpbillto').options.length=0;
    //            document.getElementById('drpbillto').options[0] = new Option("Client","client");
    //            
    //            for (var k = 0; k < dbt.Tables[0].Rows.length; k++)
    //            {
    //                 document.getElementById('drpbillto').options[document.getElementById('drpbillto').options.length] = new Option(dbt.Tables[0].Rows[k].agency_name,dbt.Tables[0].Rows[k].bill_to);
    //                
    //                 document.getElementById('drpbillto').options.length; 
    //            }
    //            }
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_to!=null)
    //            {
    //                document.getElementById('hiddenbillto').value = executequery.Tables[0].Rows[rownumEx].Bill_to;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Bill_to!=null)
    //            {
    //                document.getElementById('drpbillto').value = executequery.Tables[0].Rows[0].Bill_to;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Invoices!=null)
    //            {
    //                document.getElementById('txtinvoice').value = executequery.Tables[0].Rows[0].Invoices;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Vts!=null)
    //            {
    //                document.getElementById('txtvts').value = executequery.Tables[0].Rows[0].Vts;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Bill_add!=null)
    //            {
    //                document.getElementById('txtbilladdress').value = executequery.Tables[0].Rows[0].Bill_add;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Trade_disc!=null)
    //            {
    //                document.getElementById('txttradedisc').value = executequery.Tables[0].Rows[0].Trade_disc;
    //            }
    //            if(executequery.Tables[0].Rows[0].Agency_out!=null)
    //            {
    //                document.getElementById('txtagencyoutstand').value = executequery.Tables[0].Rows[0].Agency_out;
    //            }    
    //            
    //            if(executequery.Tables[0].Rows[0].Page_amount!=null)
    //            {
    //                document.getElementById('txtpageamt').value = executequery.Tables[0].Rows[0].Page_amount;
    //            }   
    //            if(executequery.Tables[0].Rows[0].Gross_amount!=null)
    //            {
    //                document.getElementById('txtgrossamt').value = executequery.Tables[0].Rows[0].Gross_amount;
    //            }    

    //            //Inserting in hidden field to compare new and  Previous amount 
    //            if(executequery.Tables[0].Rows[0].Gross_amount!=null)
    //            {
    //                document.getElementById('hiddenprevamt').value = executequery.Tables[0].Rows[0].Gross_amount;
    //            }   

    //            if(executequery.Tables[0].Rows[0].Bill_amount!=null)
    //            {
    //                document.getElementById('txtbillamt').value = executequery.Tables[0].Rows[0].Bill_amount;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Box_code!=null)
    //            {
    //                document.getElementById('drpboxcode').value = executequery.Tables[0].Rows[0].Box_code;
    //            }   
    //            if(executequery.Tables[0].Rows[0].Box_no!=null)
    //            {
    //                document.getElementById('txtboxno').value = executequery.Tables[0].Rows[0].Box_no;
    //            }    
    //            if (executequery.Tables[0].Rows[0].Box_agency.toString() == "1")
    //            {
    //                document.getElementById('chkage').checked = true;
    //            }
    //            else
    //            {
    //                document.getElementById('chkage').checked = false;
    //            }
    //            if (executequery.Tables[0].Rows[0].Box_client.toString() == "1")
    //            {
    //                document.getElementById('chkclie').checked = true;
    //            }
    //            else
    //            {
    //                document.getElementById('chkclie').checked = false;
    //            }
    //            if(executequery.Tables[0].Rows[0].Box_address!=null)
    //            {
    //                document.getElementById('txtboxaddress').value = executequery.Tables[0].Rows[0].Box_address;
    //            }    
    //            if (executequery.Tables[0].Rows[0].Tfn == "1")
    //            {
    //                document.getElementById('chktfn').value = true;
    //            }
    //            else
    //            {
    //                document.getElementById('chktfn').value= false;
    //            }
    //            if(executequery.Tables[0].Rows[0].Ad_size_column!=null)
    //            {
    //                document.getElementById('txtcolum').value = executequery.Tables[0].Rows[0].Ad_size_column;
    //            }   
    //            if(executequery.Tables[0].Rows[0].Paid_ins!=null)
    //            {          
    //                document.getElementById('txtpaid').value = executequery.Tables[0].Rows[0].Paid_ins;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Contract_rate!=null)
    //            {
    //                document.getElementById('txtdealrate').value = executequery.Tables[0].Rows[0].Contract_rate;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Deviation!=null)
    //            {
    //                document.getElementById('txtdeviation').value = executequery.Tables[0].Rows[0].Deviation;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Contract_name!=null)
    //            {          
    //                document.getElementById('txtcontractname').value = executequery.Tables[0].Rows[0].Contract_name;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Contract_type!=null)
    //            {
    //                document.getElementById('txtcontracttype').value = executequery.Tables[0].Rows[0].Contract_type;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Card_name!=null)
    //            {
    //                document.getElementById('txtcardname').value = executequery.Tables[0].Rows[0].Card_name;
    //             }   
    //             if(executequery.Tables[0].Rows[0].Card_type!=null)
    //             {
    //                document.getElementById('drptype').value = executequery.Tables[0].Rows[0].Card_type;
    //             }   
    //             if(executequery.Tables[0].Rows[0].Card_month!=null)
    //             {
    //                document.getElementById('drpmonth').value = executequery.Tables[0].Rows[0].Card_month;
    //             }   
    //             if(executequery.Tables[0].Rows[0].Card_year!=null)
    //             {
    //                document.getElementById('drpyear').value = executequery.Tables[0].Rows[0].Card_year;
    //             }   
    //             if(executequery.Tables[0].Rows[0].Card_number!=null)
    //             {
    //                document.getElementById('txtcardno').value = executequery.Tables[0].Rows[0].Card_number;
    //             }   
    //            if(executequery.Tables[0].Rows[0].Receipt_no!=null)
    //            { 
    //                document.getElementById('hiddenreceiptno').value =  document.getElementById('txtreceipt').value = executequery.Tables[0].Rows[0].Receipt_no;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Material_status!=null)
    //            {
    //                document.getElementById('drpmatstat').value = executequery.Tables[0].Rows[0].Material_status;
    //            }    

    //            ////this is to bind the adscat3 drpdown



    //            if (executequery.Tables[0].Rows[0].Ad_Subcat3!=null || executequery.Tables[0].Rows[0].Ad_Subcat3.toString() == "")
    //            {
    //                document.getElementById('drpadcat3').options.length=0;
    //                document.getElementById('hiddenadscat3').value = "";

    //            }
    //            else
    //            {
    //                res3=null;
    //                res3=Classified_Booking.getvalfromadcat3(executequery.Tables[0].Rows[0].Ad_sub_cat_code,document.getElementById('hiddencompcode').value,"0");
    //                var dacat = res3.value;
    //                if(dacat==null)
    //                {
    //                    alert(dacat.error.description);
    //                    return false;
    //                }

    //               
    //                ////////////////////////////////////////////////////////////////
    //               document.getElementById('drpadcat3').options.length=0;
    //               document.getElementById('drpadcat3').options[0]=new Option("Select","0");
    //                for (var k = 0; k < dacat.Tables[0].Rows.length; k++)
    //                {
    //                     document.getElementById('drpadcat3').options[document.getElementById('drpadcat3').options.length] = new Option(dacat.Tables[0].Rows[k].catname,dacat.Tables[0].Rows[k].catcode);
    //                    
    //                     document.getElementById('drpadcat3').options.length; 
    //                }


    //            }
    //           
    //                if(executequery.Tables[0].Rows[0].Ad_Subcat3!=null)
    //                {
    //                    document.getElementById('hiddenadscat3').value = document.getElementById('drpadcat3').value = executequery.Tables[0].Rows[0].Ad_Subcat3;
    //                }    
    //           
    //            ////////////////////this is to bind the adcat4 drp down
    //            if (executequery.Tables[0].Rows[0].Ad_Subcat4 == null || executequery.Tables[0].Rows[0].Ad_Subcat4.toString() == "")
    //            {
    //                document.getElementById('drpadcat4').options.length=0;
    //                document.getElementById('hiddenadscat4').value = "";

    //            }
    //            else
    //            {
    //                ////////////when 1 than bind the adscat4 drp down
    //                res3=null;
    //                res3=Classified_Booking.getvalfromadcat3(executequery.Tables[0].Rows[0].Ad_Subcat3,document.getElementById('hiddencompcode').value,"1");
    //                var dacat = res3.value;
    //                if(dacat==null)
    //                {
    //                    alert(dacat.error.description);
    //                    return false;
    //                }

    //               
    //                ////////////////////////////////////////////////////////////////
    //               document.getElementById('drpadcat4').options.length=0;
    //               document.getElementById('drpadcat4').options[0]=new Option("Select","0");
    //                for (var k = 0; k < dacat.Tables[0].Rows.length; k++)
    //                {
    //                     document.getElementById('drpadcat4').options[document.getElementById('drpadcat4').options.length] = new Option(dacat.Tables[0].Rows[k].Cat_Name,dacat.Tables[0].Rows[k].Cat_Code);
    //                    
    //                     document.getElementById('drpadcat4').options.length; 
    //                }

    //            }
    //          
    //                document.getElementById('hiddenadscat4').value = document.getElementById('drpadcat4').value = executequery.Tables[0].Rows[0].Ad_Subcat4;
    //          
    //            ///bind adcat5 drpdown
    //            if (executequery.Tables[0].Rows[0].Ad_subcat5==null || executequery.Tables[0].Rows[0].Ad_subcat5.toString() == "")
    //            {
    //                document.getElementById('drpadcat5').options.length=0;
    //                document.getElementById('hiddenadscat5').value = "";
    //            }
    //            else
    //            {
    //                ////////////when 1 than bind the adscat4 drp down

    //               res3=null;
    //                res3=Classified_Booking.getvalfromadcat3(executequery.Tables[0].Rows[0].Ad_Subcat4,document.getElementById('hiddencompcode').value,"2");
    //                var dacat = res3.value;
    //                if(dacat==null)
    //                {
    //                    alert(dacat.error.description);
    //                    return false;
    //                }

    //               
    //                ////////////////////////////////////////////////////////////////
    //               document.getElementById('drpadcat5').options.length=0;
    //               document.getElementById('drpadcat5').options[0]=new Option("Select","0");
    //                for (var k = 0; k < dacat.Tables[0].Rows.length; k++)
    //                {
    //                     document.getElementById('drpadcat5').options[document.getElementById('drpadcat5').options.length] = new Option(dacat.Tables[0].Rows[k].Cat_Name,dacat.Tables[0].Rows[k].Cat_Code);
    //                    
    //                     document.getElementById('drpadcat5').options.length; 
    //                }
    //            }
    //            document.getElementById('hiddenadscat5').value = document.getElementById('drpadcat5').value = executequery.Tables[0].Rows[0].Ad_subcat5;


    //            //////bind the bg color drp down 
    //            if(executequery.Tables[0].Rows[0].Bg_color!=null)
    //            {
    //                document.getElementById('drpbgcolor').value = executequery.Tables[0].Rows[0].Bg_color;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Bullet_code!=null)
    //            {
    //                document.getElementById('drpbullet').value = executequery.Tables[0].Rows[0].Bullet_code;
    //            }    
    //            if(executequery.Tables[0].Rows[0].Bullet_premium!=null)
    //            {
    //                document.getElementById('txtbullprem').value = executequery.Tables[0].Rows[0].Bullet_premium;
    //            }   
    //            /* *14Aug*
    //            if (drpretainer.Items.FindByValue(executequery.Tables[0].Rows[0].ItemArray[134].ToString()) != null)
    //            {
    //                drpretainer.SelectedValue = executequery.Tables[0].Rows[0].ItemArray[134].ToString();
    //            } */
    //            if(executequery.Tables[0].Rows[0].RETAINER1!=null)
    //            {
    //                document.getElementById('drpretainer').value = executequery.Tables[0].Rows[0].RETAINER1;
    //            }    
    //            if(executequery.Tables[0].Rows[0].ADD_AGENCY_COMM!=null)
    //            {
    //                 if(document.getElementById('txtaddagencycommrate')!=null)
    //                 {
    //                    document.getElementById('txtaddagencycommrate').value = executequery.Tables[0].Rows[0].ADD_AGENCY_COMM;
    //                  }  
    //             }   
    //          
    //            //grid
    //            updateStatus();
    //          document.getElementById('btnfirst').disabled=true;
    //        document.getElementById('btnprevious').disabled=true;
    //        showcardinfo(executequery.Tables[0].Rows[0].Bill_pay);
    //        showgridexecute();
    //        
    //        if (document.getElementById('hiddenuomdesc').value == "ROD")
    //        {
    //            if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtcolum').value != "")
    //            {
    //                document.getElementById('txtadsize2').disabled =true;
    //                document.getElementById('txtadsize1').style.backgroundColor="#FFFFFF";
    //                document.getElementById('txtadsize2').style.backgroundColor="#FFFFFF";
    //                document.getElementById('txtcolum').style.backgroundColor="#FFFFFF";

    //            }
    //            else if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtadsize2').value != "")
    //            {
    //                document.getElementById('txtcolum').disabled=true;
    //                document.getElementById('txtadsize1').style.backgroundColor="#FFFFFF";
    //                document.getElementById('txtadsize2').style.backgroundColor="#FFFFFF";
    //                document.getElementById('txtcolum').style.backgroundColor="#FFFFFF";

    //            }


    //        }
    //        else if (document.getElementById('hiddenuomdesc').value != "CD")
    //        {
    //            document.getElementById('txtadsize1').disabled=true;
    //            document.getElementById('txtadsize2').disabled = true;
    //            if (document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROD")
    //            {
    //                document.getElementById('Label1').innerHTML = "No. Of Lines";
    //                document.getElementById('txtadsize1').style.backgroundColor = "#999999";
    //                document.getElementById('txtadsize2').style.backgroundColor = "#999999";
    //                document.getElementById('txtcolum').style.backgroundColor = "#999999";


    //            }
    //            else if (drpuom.SelectedItem.Text == "ROW")
    //            {
    //                document.getElementById('Label1').innerHTML = "No. Of Words";
    //                document.getElementById('txtadsize1').style.backgroundColor = "#999999";
    //                document.getElementById('txtadsize2').style.backgroundColor = "#999999";
    //                document.getElementById('txtcolum').style.backgroundColor = "#999999";
    //            }

    //        }  
    //        }
    //       return false; 
}

function previousClick() {
    clearClick();
    rownumEx = parseInt(rownumEx) - 1;
    fillDATA();
    document.getElementById('LinkButton1').disabled = false;
    document.getElementById('LinkButton2').disabled = false;
    document.getElementById('LinkButton3').disabled = false;
    document.getElementById('LinkButton4').disabled = false;
    document.getElementById('LinkButton5').disabled = false;
    document.getElementById('LinkButton6').disabled = false;
    document.getElementById('LinkButton7').disabled = false;
    document.getElementById('btnnext').disabled = false;
    document.getElementById('btnlast').disabled = false;
    if (rownumEx == 0) {
        document.getElementById('btnfirst').disabled = true;
        document.getElementById('btnprevious').disabled = true;
    }
    else {
        document.getElementById('btnfirst').disabled = false;
        document.getElementById('btnprevious').disabled = false;
    }
    setButtonImages();
    return false;
    //        document.getElementById('tblinsert').innerHTML='';
    //        clearClick();
    //            document.getElementById('LinkButton1').disabled = false;
    //        document.getElementById('LinkButton2').disabled = false;
    //        document.getElementById('LinkButton3').disabled = false;
    //        document.getElementById('LinkButton4').disabled = false;
    //        document.getElementById('LinkButton5').disabled = false;
    //        document.getElementById('LinkButton6').disabled = false;
    //        document.getElementById('LinkButton7').disabled = false;
    //        rownumEx--;
    //        //////////////////////////////////////////////////////////////////////////

    //       
    //          if(executequery==null)
    //          {
    //            alert(res1.error.description);
    //            return false;
    //          }
    //            var count = executequery.Tables[0].Rows.length - 1;
    //           // dateinsert getdatechk = new dateinsert();
    //            if (rownumEx != -1)
    //            {
    //               if (rownumEx >= 0 || rownumEx <= count)
    //               {
    //                if(executequery.Tables[0].Rows[rownumEx].branch!=null)
    //                {
    //                    document.getElementById('txtbranch').value = executequery.Tables[0].Rows[rownumEx].branch;
    //                }    
    //                if(executequery.Tables[0].Rows[rownumEx].booked_by!=null)
    //                {
    //                    document.getElementById('txtbookedby').value = executequery.Tables[0].Rows[rownumEx].booked_by;
    //                }
    //                if(executequery.Tables[0].Rows[rownumEx].prev_booking!=null)
    //                {    
    //                    document.getElementById('txtprevbook').value = executequery.Tables[0].Rows[rownumEx].prev_booking;
    //                }    
    //                var datetime = executequery.Tables[0].Rows[rownumEx].DATE_TIME;
    //                if(datetime!=null)
    //                {
    //                    document.getElementById('txtdatetime').value = datetime;//getdatechk.getDate(dateformat, datetime);
    //                 }   
    //                 if(executequery.Tables[0].Rows[rownumEx].cio_booking_id!=null)
    //                 {
    //                    document.getElementById('txtciobookid').value = executequery.Tables[0].Rows[rownumEx].cio_booking_id;
    //                 }  
    //                //txtappby.Text = executequery.Tables[0].Rows[0].ItemArray[5].ToString();
    //                // txtaudit.Text = executequery.Tables[0].Rows[0].ItemArray[6].ToString();
    //                if(executequery.Tables[0].Rows[rownumEx].RO_No!=null)
    //                {
    //                    document.getElementById('txtrono').value = executequery.Tables[0].Rows[rownumEx].RO_No;
    //                 }   
    //                var ro_date = executequery.Tables[0].Rows[rownumEx].RO_Date;
    //                if(ro_date!=null)
    //                {  
    //                    document.getElementById('txtrodate').value = ro_date;//getdatechk.getDate(dateformat, ro_date);
    //                }   
    //                if(executequery.Tables[0].Rows[rownumEx].bill_status!=null)
    //                {
    //                    document.getElementById('drpbillstatus').value = executequery.Tables[0].Rows[rownumEx].bill_status;
    //                }   
    //                if(executequery.Tables[0].Rows[rownumEx].ro_status!=null)
    //                {
    //                    document.getElementById('drprostatus').value = executequery.Tables[0].Rows[rownumEx].ro_status;
    //                }    
    //                if(executequery.Tables[0].Rows[rownumEx].AgencyName!=null)
    //                {
    //                    document.getElementById('txtagency').value = executequery.Tables[0].Rows[rownumEx].AgencyName;
    //                }    
    //                //drpagency_SelectedIndexChanged(sender, e);

    //                ///////////////this is to bind the subagency drop down
    //            
    //               var res2=Classified_Booking.bindsubagency(executequery.Tables[0].Rows[rownumEx].Agency_sub_code, document.getElementById('hiddencompcode').value);
    //                
    //                var dsbsa = res2.value;
    //                if(dsbsa==null)
    //                {
    //                    alert(res2.error.description);
    //                    return false;
    //                }
    //               

    //                document.getElementById('drpagscode').options.length=0;
    //                document.getElementById('drpagscode').options[0]=new Option("Select Agency","0");
    //                document.getElementById('drpagscode').options.length = 1; 
    //                for (var i = 0  ; i < dsbsa.Tables[0].Rows.length; ++i)
    //                {
    //                    document.getElementById('drpagscode').options[document.getElementById('drpagscode').options.length] = new Option(dsbsa.Tables[0].Rows[i].agency_name,dsbsa.Tables[0].Rows[i].Agency_Code);
    //                
    //                    document.getElementById('drpagscode').options.length;       
    //                }


    //            //////////////////////////////////////////////////////
    //            if(executequery.Tables[0].Rows[rownumEx].Client!=null)
    //            {
    //                document.getElementById('txtclient').value = executequery.Tables[0].Rows[rownumEx].Client;     //.ItemArray[14].ToString();
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_address!=null)
    //            {
    //                document.getElementById('txtagencyaddress').value = executequery.Tables[0].Rows[rownumEx].Agency_address;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Client_address!=null)
    //            {
    //                document.getElementById('txtclientadd').value = executequery.Tables[0].Rows[rownumEx].Client_address;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_code!=null)
    //            {
    //                document.getElementById('hiddensubcode').value = document.getElementById('drpagscode').value = executequery.Tables[0].Rows[rownumEx].Agency_code;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Dockit_no!=null)
    //            {
    //                document.getElementById('txtdockitno1').value = executequery.Tables[0].Rows[rownumEx].Dockit_no;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].execname!=null)
    //            { 
    //                document.getElementById('txtexecname').value = executequery.Tables[0].Rows[rownumEx].execname;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Executive_zone!=null)
    //            {
    //                document.getElementById('hiddenzone').value = document.getElementById('txtexeczone').value = executequery.Tables[0].Rows[rownumEx].Executive_zone;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].product!=null)
    //            {
    //                document.getElementById('txtproduct').value = executequery.Tables[0].Rows[rownumEx].product;
    //            }    
    //            //drpproduct_SelectedIndexChanged1(sender, e);
    //            //drpbrand.SelectedValue = executequery.Tables[0].Rows[0].ItemArray[21].ToString();
    //            /////////////////////////////////////////////this is to bind the brand drop down
    //            res2=null;
    //            if(executequery.Tables[0].Rows[rownumEx].Product_code!=null)
    //            {
    //            res2=Classified_Booking.brandbind(document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[rownumEx].Product_code);
    //            var dsbrand = res2.value;
    //            if(dsbrand==null)
    //            {
    //                alert(res2.error.description);
    //                return false;
    //            }
    //            
    //              document.getElementById('drpbrand').options.length=0;
    //              document.getElementById('drpbrand').options[0]=new Option("Select Brand","0");
    //              document.getElementById('drpbrand').options.length = 1; 
    //                for (var i = 0  ; i < dsbrand.Tables[0].Rows.length; ++i)
    //                {
    //                    document.getElementById('drpbrand').options[document.getElementById('drpbrand').options.length] = new Option(dsbrand.Tables[0].Rows[i].brand_name,dsbrand.Tables[0].Rows[i].brand_code);
    //                
    //                    document.getElementById('drpbrand').options.length;       
    //                }
    //                
    //           }
    //            //hiddenbrand.Value=drpbrand.SelectedValue = executequery.Tables[0].Rows[0].ItemArray[21].ToString();
    //            if (executequery.Tables[0].Rows[rownumEx].Brand_code==null || executequery.Tables[0].Rows[rownumEx].Brand_code.toString() == "")
    //            {
    //                document.getElementById('drpbrand').options.length=0;
    //                document.getElementById('hiddenbrand').value = "";
    //            }
    //            else
    //            {
    //                if(executequery.Tables[0].Rows[rownumEx].Brand_code!=null)
    //                {
    //                    document.getElementById('hiddenbrand').value = document.getElementById('drpbrand').value = executequery.Tables[0].Rows[rownumEx].Brand_code.toString();
    //                }    
    //            }
    //            ////////////////////this is to bind the varient dropdown

    //          
    //            ////////////////////////////////////////////////////////////////////////////////
    //            if(executequery.Tables[0].Rows[rownumEx].Key_no!=null)
    //            {
    //                document.getElementById('txtkeyno').value = executequery.Tables[0].Rows[rownumEx].Key_no;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_remarks!=null)
    //            {
    //                document.getElementById('txtbillremark').value = executequery.Tables[0].Rows[rownumEx].Bill_remarks;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Print_remark!=null)
    //            {
    //                document.getElementById('txtprintremark').value = executequery.Tables[0].Rows[rownumEx].Print_remark;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Package_code!=null)
    //            {
    //                var listpck = executequery.Tables[0].Rows[rownumEx].Package_code;
    //            document.getElementById('hiddenpackage').value = listpck;
    //            //////////////////this is to bind the package grid on what the value is saved in the database


    //            res2=null;
    //            res2=Classified_Booking.bindpacforexe(document.getElementById('hiddencompcode').value, listpck);
    //            var dsexecut = res2.value;
    //            if(dsexecut==null)
    //            {
    //                alert(res2.error.description);
    //                return false;
    //            }
    //                 
    //           
    //            
    //            
    //            document.getElementById('drppackagecopy').options.length=0;
    //            for (i = 0; i <= dsexecut.Tables[0].Rows.length - 1; i++)
    //            {
    //                if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "")
    //                {
    //                    if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "0")
    //                    {
    //                        var arrfor_uom = dsexecut.Tables[0].Rows[i].pck_code.toString().split('@');
    //                        var res3=Classified_Booking.getPackageInsert(arrfor_uom[0].toString(), document.getElementById('txtciobookid').value);
    //                        var dsinsert = res3.value;
    //                        if(dsinsert==null)
    //                        {
    //                            alert(res3.error.description);
    //                            return false;
    //                        }
    //                        var T=dsexecut.Tables[0].Rows[i].Package_Name + "(" + dsinsert.Tables[0].Rows[0].inserts + ")";
    //                        var V=dsexecut.Tables[0].Rows[i].pck_code + "(" + dsinsert.Tables[0].Rows[0].inserts + ")";
    //                        document.getElementById('drppackagecopy').options[document.getElementById('drppackagecopy').options.length] = new Option(T,V);
    //                
    //                        document.getElementById('drppackagecopy').options.length;   
    //                    
    ////                        ListItem li;
    ////                        li = new ListItem();
    ////                        li.Text = dsexecut.Tables[0].Rows[i].ItemArray[1].ToString() + "(" + dsinsert.Tables[0].Rows[0].ItemArray[0].ToString() + ")";
    ////                        li.Value = dsexecut.Tables[0].Rows[i].ItemArray[2].ToString() + "(" + dsinsert.Tables[0].Rows[0].ItemArray[0].ToString() + ")"; ;
    ////                        //state = ds.Tables[0].Rows[i].ItemArray[2].ToString();
    ////                        drppackagecopy.Items.Add(li);

    //                    }
    //                }
    //            }

    //        }
    //                
    //            if(executequery.Tables[0].Rows[rownumEx].No_of_insertion!=null)
    //            {
    //                document.getElementById('txtinsertion').value = executequery.Tables[0].Rows[rownumEx].No_of_insertion;
    //                document.getElementById('hiddeninsertion').value = executequery.Tables[0].Rows[rownumEx].No_of_insertion;
    //            }   
    //            
    //            var start_date = executequery.Tables[0].Rows[rownumEx].Insertion_date;
    //            if(start_date!=null)
    //            {
    //                document.getElementById('txtdummydate').value = start_date;//getdatechk.getDate(dateformat, start_date);
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Repeating_day!=null)
    //            {
    //                document.getElementById('txtrepeatingdate').value = executequery.Tables[0].Rows[rownumEx].Repeating_day;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Booking_type!=null)
    //            {
    //                document.getElementById('drpbooktype').value = executequery.Tables[0].Rows[rownumEx].Booking_type;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Ad_cat_code!=null)
    //            {
    //                document.getElementById('drpadcategory').value = executequery.Tables[0].Rows[rownumEx].Ad_cat_code;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Ad_sub_cat_code!=null)
    //            {
    //                document.getElementById('drpadsubcategory').value = executequery.Tables[0].Rows[rownumEx].Ad_sub_cat_code;
    //            }
    //            if(executequery.Tables[0].Rows[rownumEx].Color_code!=null)
    //            {
    //                document.getElementById('drpcolor').value = executequery.Tables[0].Rows[rownumEx].Color_code;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Uom_code!=null)
    //            {
    //                document.getElementById('drpuom').value = executequery.Tables[0].Rows[rownumEx].Uom_code;
    //            }    
    //            //*25Aug* 
    //            res3=null;
    //            res3 = Classified_Booking.gettheuom_desc(document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[rownumEx].Uom_code);  
    //            var ds_uom_=res3.value;
    //            if(ds_uom_==null)
    //            {
    //                alert(res3.error.description);
    //                return false;
    //            }
    //            if(ds_uom_.Tables[0].Rows.length>0)
    //            {
    //                document.getElementById('hiddenuomdesc').value = ds_uom_.Tables[0].Rows[0].uom_desc;   
    //            }
    //                
    //                
    //                //*25Aug*
    //            if(executequery.Tables[0].Rows[rownumEx].Page_position_code!=null)
    //            {
    //                document.getElementById('drppageposition').value = executequery.Tables[0].Rows[rownumEx].Page_position_code;
    //             }   
    //       
    //            //string adtype=drpadstype.SelectedValue;
    //            if(executequery.Tables[0].Rows[rownumEx].Ad_size_height!=null)
    //            {
    //                document.getElementById('txtadsize1').value = executequery.Tables[0].Rows[rownumEx].Ad_size_height;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Ad_size_width!=null)
    //            {
    //                document.getElementById('txtadsize2').value = executequery.Tables[0].Rows[rownumEx].Ad_size_width;
    //            }    
    //            ////this is to bind the ratecode drpdown
    //            res3=null
    //            if(executequery.Tables[0].Rows[rownumEx].Ad_cat_code!=null)
    //            {
    //            res3=Classified_Booking.ratebind(executequery.Tables[0].Rows[rownumEx].Ad_cat_code, document.getElementById('hiddencompcode').value);
    //            var dx = res3.value;
    //            if(dx==null)
    //            {   
    //                alert(dx.error.description);
    //                return false;
    //            }
    //             
    //            
    //            

    //              document.getElementById('txtratecode').options.length=0;
    //              document.getElementById('txtratecode').options[0]=new Option("-Select Rate Code-","0");
    //              document.getElementById('txtratecode').options.length = 1; 
    //            
    //             for (var i = 0  ; i < dx.Tables[0].Rows.length; ++i)
    //                {
    //                    document.getElementById('txtratecode').options[document.getElementById('txtratecode').options.length] = new Option(dx.Tables[0].Rows[i].rate_mast_code,dx.Tables[0].Rows[i].rate_mast_code);
    //                
    //                    document.getElementById('txtratecode').options.length;       
    //                }
    //                
    //           }
    //           if(executequery.Tables[0].Rows[rownumEx].Rate_code!=null)
    //           {
    //                document.getElementById('txtratecode').value = executequery.Tables[0].Rows[rownumEx].Rate_code;
    //           }    
    //            if(executequery.Tables[0].Rows[rownumEx].Scheme_type_code!=null)
    //            {
    //                document.getElementById('drpscheme').value = executequery.Tables[0].Rows[rownumEx].Scheme_type_code;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Scheme_type_code!=null)
    //            { 
    //                document.getElementById('hiddenscheme').value = executequery.Tables[0].Rows[rownumEx].Scheme_type_code;
    //            }    
    //     //       drpschemepck.SelectedValue = executequery.Tables[0].Rows[0].ItemArray[41].ToString();
    //            if(executequery.Tables[0].Rows[rownumEx].Currency_code!=null)
    //            {
    //                document.getElementById('drpcurrency').value = executequery.Tables[0].Rows[rownumEx].Currency_code;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Agrred_rate!=null)
    //            {
    //                document.getElementById('txtagreedrate').value = executequery.Tables[0].Rows[rownumEx].Agrred_rate;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Agreed_amount!=null)
    //            {
    //                document.getElementById('txtagreedamt').value = executequery.Tables[0].Rows[rownumEx].Agreed_amount;
    //            }    
    //    
    //            if(executequery.Tables[0].Rows[rownumEx].Special_charges!=null)
    //            {
    //                document.getElementById('txtextracharges').value = executequery.Tables[0].Rows[rownumEx].Special_charges;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_status!=null)
    //            {
    //                document.getElementById('hiddenstatus').value = document.getElementById('txtagencystatus').value = executequery.Tables[0].Rows[rownumEx].Agency_status;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_type!=null)
    //            {
    //                document.getElementById('txtagencytype').value = executequery.Tables[0].Rows[rownumEx].Agency_type;
    //            }    
    //            //this is To the bind the the agencypaymode dropdown on execution
    //            res3=null;
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_sub_code!=null)
    //            {
    //            res3=Classified_Booking.getstatuspaymode(executequery.Tables[0].Rows[rownumEx].Agency_sub_code, executequery.Tables[0].Rows[rownumEx].Agency_code, document.getElementById('hiddencompcode').value, document.getElementById('txtdatetime').value,document.getElementById('hiddendateformat').value,"CL0");
    //            var dch = res3.value;
    //            if(dch==null)
    //            {
    //                alert(res3.error.description);
    //                return false;
    //            }
    //            
    //            

    //            document.getElementById('txtagencypaymode').options.length=0;
    //            if (dch.Tables[5].Rows.length > 0)
    //            {
    //                for (var i = 0; i < dch.Tables[5].Rows.length; i++)
    //                {
    //                    document.getElementById('txtagencypaymode').options[document.getElementById('txtagencypaymode').options.length] = new Option(dch.Tables[5].Rows[i].payment_mode_name,dch.Tables[5].Rows[i].pay_mode_code);
    //                
    //                    document.getElementById('txtagencypaymode').options.length; 
    //                   
    //                }

    //            }
    //           } 
    //            ///////////////////////////////////////////////////////////////////////////////////////////////////
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_pay!=null)
    //            {
    //                document.getElementById('hiddenpay').value =  document.getElementById('txtagencypaymode').value = executequery.Tables[0].Rows[rownumEx].Agency_pay;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_credit!=null)
    //            {
    //                document.getElementById('txtcreditperiod').value = executequery.Tables[0].Rows[rownumEx].Agency_credit;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Total_area!=null)
    //            {
    //                document.getElementById('txttotalarea').value = executequery.Tables[0].Rows[rownumEx].Total_area;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Card_rate!=null)
    //            {
    //                document.getElementById('txtcardrate').value = executequery.Tables[0].Rows[rownumEx].Card_rate;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Card_amount!=null)
    //            {
    //                document.getElementById('txtcardamt').value = executequery.Tables[0].Rows[rownumEx].Card_amount;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Discount!=null)
    //            {
    //                document.getElementById('txtdiscount').value = executequery.Tables[0].Rows[rownumEx].Discount;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Discount_per!=null)
    //            {
    //                document.getElementById('txtdiscpre').value = executequery.Tables[0].Rows[rownumEx].Discount_per;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_cycle!=null)
    //            {
    //                document.getElementById('drpbillcycle').value = executequery.Tables[0].Rows[rownumEx].Bill_cycle;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Revenue_center!=null)
    //            {
    //                document.getElementById('drprevenue').value = executequery.Tables[0].Rows[rownumEx].Revenue_center;
    //            }    

    //            ////this is to bind the bill pay mode
    //            document.getElementById('drppaymenttype').options.length=0;
    //            if (dch.Tables[5].Rows.length > 0)
    //            {
    //                for (var i = 0;  i< dch.Tables[5].Rows.length; i++)
    //                {
    //                   document.getElementById('drppaymenttype').options[document.getElementById('drppaymenttype').options.length] = new Option(dch.Tables[5].Rows[i].payment_mode_name,dch.Tables[5].Rows[i].pay_mode_code);
    //                
    //                    document.getElementById('drppaymenttype').options.length; 
    //                }

    //            }
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_pay!=null)
    //            {    
    //                document.getElementById('hiddenbillpay').value = document.getElementById('drppaymenttype').value = executequery.Tables[0].Rows[rownumEx].Bill_pay;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_height!=null)
    //            {
    //                document.getElementById('txtbillheight').value = executequery.Tables[0].Rows[rownumEx].Bill_height;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_width!=null)
    //            {
    //                document.getElementById('txtbillwidth').value = executequery.Tables[0].Rows[rownumEx].Bill_width;
    //            }    
    //            //////////////this is to bind the bill to 
    //            res3=null;
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_sub_code!=null)
    //            {
    //            res3=Classified_Booking.getbillval(executequery.Tables[0].Rows[rownumEx].Agency_sub_code, document.getElementById('hiddencompcode').value);
    //            var dbt = res3.value;
    //            if(dbt==null)
    //            {
    //                alert(res3.error.description);
    //                return false;
    //            }
    //           
    //            
    //            ////////////////////////////////////////////////////
    //            document.getElementById('drpbillto').options.length=0;
    //            document.getElementById('drpbillto').options[0] = new Option("Client","client");
    //            
    //            for (var k = 0; k < dbt.Tables[0].Rows.length; k++)
    //            {
    //                 document.getElementById('drpbillto').options[document.getElementById('drpbillto').options.length] = new Option(dbt.Tables[0].Rows[k].agency_name,dbt.Tables[0].Rows[k].bill_to);
    //                
    //                 document.getElementById('drpbillto').options.length; 
    //            }
    //            }
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_to!=null)
    //            {
    //                document.getElementById('hiddenbillto').value = executequery.Tables[0].Rows[rownumEx].Bill_to;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_to!=null)
    //            {
    //                document.getElementById('drpbillto').value = executequery.Tables[0].Rows[rownumEx].Bill_to;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Invoices!=null)
    //            {
    //                document.getElementById('txtinvoice').value = executequery.Tables[0].Rows[rownumEx].Invoices;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Vts!=null)
    //            {
    //                document.getElementById('txtvts').value = executequery.Tables[0].Rows[rownumEx].Vts;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_add!=null)
    //            {
    //                document.getElementById('txtbilladdress').value = executequery.Tables[0].Rows[rownumEx].Bill_add;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Trade_disc!=null)
    //            {
    //                document.getElementById('txttradedisc').value = executequery.Tables[0].Rows[rownumEx].Trade_disc;
    //            }
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_out!=null)
    //            {
    //                document.getElementById('txtagencyoutstand').value = executequery.Tables[0].Rows[rownumEx].Agency_out;
    //            }    
    //            
    //            if(executequery.Tables[0].Rows[rownumEx].Page_amount!=null)
    //            {
    //                document.getElementById('txtpageamt').value = executequery.Tables[0].Rows[rownumEx].Page_amount;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Gross_amount!=null)
    //            {
    //                document.getElementById('txtgrossamt').value = executequery.Tables[0].Rows[rownumEx].Gross_amount;
    //            }    

    //            //Inserting in hidden field to compare new and  Previous amount 
    //            if(executequery.Tables[0].Rows[rownumEx].Gross_amount!=null)
    //            {
    //                document.getElementById('hiddenprevamt').value = executequery.Tables[0].Rows[rownumEx].Gross_amount;
    //            }   

    //            if(executequery.Tables[0].Rows[rownumEx].Bill_amount!=null)
    //            {
    //                document.getElementById('txtbillamt').value = executequery.Tables[0].Rows[rownumEx].Bill_amount;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Box_code!=null)
    //            {
    //                document.getElementById('drpboxcode').value = executequery.Tables[0].Rows[rownumEx].Box_code;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Box_no!=null)
    //            {
    //                document.getElementById('txtboxno').value = executequery.Tables[0].Rows[rownumEx].Box_no;
    //            }    
    //            if (executequery.Tables[0].Rows[rownumEx].Box_agency.toString() == "1")
    //            {
    //                document.getElementById('chkage').checked = true;
    //            }
    //            else
    //            {
    //                document.getElementById('chkage').checked = false;
    //            }
    //            if (executequery.Tables[0].Rows[rownumEx].Box_client.toString() == "1")
    //            {
    //                document.getElementById('chkclie').checked = true;
    //            }
    //            else
    //            {
    //                document.getElementById('chkclie').checked = false;
    //            }
    //            if(executequery.Tables[0].Rows[rownumEx].Box_address!=null)
    //            {
    //                document.getElementById('txtboxaddress').value = executequery.Tables[0].Rows[rownumEx].Box_address;
    //            }    
    //            if (executequery.Tables[0].Rows[rownumEx].Tfn == "1")
    //            {
    //                document.getElementById('chktfn').value = true;
    //            }
    //            else
    //            {
    //                document.getElementById('chktfn').value= false;
    //            }
    //            if(executequery.Tables[0].Rows[rownumEx].Ad_size_column!=null)
    //            {
    //                document.getElementById('txtcolum').value = executequery.Tables[0].Rows[rownumEx].Ad_size_column;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Paid_ins!=null)
    //            {          
    //                document.getElementById('txtpaid').value = executequery.Tables[0].Rows[rownumEx].Paid_ins;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Contract_rate!=null)
    //            {
    //                document.getElementById('txtdealrate').value = executequery.Tables[0].Rows[rownumEx].Contract_rate;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Deviation!=null)
    //            {
    //                document.getElementById('txtdeviation').value = executequery.Tables[0].Rows[rownumEx].Deviation;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Contract_name!=null)
    //            {          
    //                document.getElementById('txtcontractname').value = executequery.Tables[0].Rows[rownumEx].Contract_name;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Contract_type!=null)
    //            {
    //                document.getElementById('txtcontracttype').value = executequery.Tables[0].Rows[rownumEx].Contract_type;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Card_name!=null)
    //            {
    //                document.getElementById('txtcardname').value = executequery.Tables[0].Rows[rownumEx].Card_name;
    //             }   
    //             if(executequery.Tables[0].Rows[rownumEx].Card_type!=null)
    //             {
    //                document.getElementById('drptype').value = executequery.Tables[0].Rows[rownumEx].Card_type;
    //             }   
    //             if(executequery.Tables[0].Rows[rownumEx].Card_month!=null)
    //             {
    //                document.getElementById('drpmonth').value = executequery.Tables[0].Rows[rownumEx].Card_month;
    //             }   
    //             if(executequery.Tables[0].Rows[rownumEx].Card_year!=null)
    //             {
    //                document.getElementById('drpyear').value = executequery.Tables[0].Rows[rownumEx].Card_year;
    //             }   
    //             if(executequery.Tables[0].Rows[rownumEx].Card_number!=null)
    //             {
    //                document.getElementById('txtcardno').value = executequery.Tables[0].Rows[rownumEx].Card_number;
    //             }   
    //            if(executequery.Tables[0].Rows[rownumEx].Receipt_no!=null)
    //            { 
    //                document.getElementById('hiddenreceiptno').value =  document.getElementById('txtreceipt').value = executequery.Tables[0].Rows[rownumEx].Receipt_no;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Material_status!=null)
    //            {
    //                document.getElementById('drpmatstat').value = executequery.Tables[0].Rows[rownumEx].Material_status;
    //            }    

    //            ////this is to bind the adscat3 drpdown



    //            if (executequery.Tables[0].Rows[rownumEx].Ad_Subcat3!=null || executequery.Tables[0].Rows[rownumEx].Ad_Subcat3.toString() == "")
    //            {
    //                document.getElementById('drpadcat3').options.length=0;
    //                document.getElementById('hiddenadscat3').value = "";

    //            }
    //            else
    //            {
    //                res3=null;
    //                res3=Classified_Booking.getvalfromadcat3(executequery.Tables[0].Rows[rownumEx].Ad_sub_cat_code,document.getElementById('hiddencompcode').value,"0");
    //                var dacat = res3.value;
    //                if(dacat==null)
    //                {
    //                    alert(dacat.error.description);
    //                    return false;
    //                }

    //               
    //                ////////////////////////////////////////////////////////////////
    //               document.getElementById('drpadcat3').options.length=0;
    //               document.getElementById('drpadcat3').options[0]=new Option("Select","0");
    //                for (var k = 0; k < dacat.Tables[0].Rows.length; k++)
    //                {
    //                     document.getElementById('drpadcat3').options[document.getElementById('drpadcat3').options.length] = new Option(dacat.Tables[0].Rows[k].catname,dacat.Tables[0].Rows[k].catcode);
    //                    
    //                     document.getElementById('drpadcat3').options.length; 
    //                }


    //            }
    //           
    //                if(executequery.Tables[0].Rows[0].Ad_Subcat3!=null)
    //                {
    //                    document.getElementById('hiddenadscat3').value = document.getElementById('drpadcat3').value = executequery.Tables[0].Rows[rownumEx].Ad_Subcat3;
    //                }    
    //           
    //            ////////////////////this is to bind the adcat4 drp down
    //            if (executequery.Tables[0].Rows[rownumEx].Ad_Subcat4 == null || executequery.Tables[0].Rows[rownumEx].Ad_Subcat4.toString() == "")
    //            {
    //                document.getElementById('drpadcat4').options.length=0;
    //                document.getElementById('hiddenadscat4').value = "";

    //            }
    //            else
    //            {
    //                ////////////when 1 than bind the adscat4 drp down
    //                res3=null;
    //                res3=Classified_Booking.getvalfromadcat3(executequery.Tables[0].Rows[rownumEx].Ad_Subcat3,document.getElementById('hiddencompcode').value,"1");
    //                var dacat = res3.value;
    //                if(dacat==null)
    //                {
    //                    alert(dacat.error.description);
    //                    return false;
    //                }

    //               
    //                ////////////////////////////////////////////////////////////////
    //               document.getElementById('drpadcat4').options.length=0;
    //               document.getElementById('drpadcat4').options[0]=new Option("Select","0");
    //                for (var k = 0; k < dacat.Tables[0].Rows.length; k++)
    //                {
    //                     document.getElementById('drpadcat4').options[document.getElementById('drpadcat4').options.length] = new Option(dacat.Tables[0].Rows[k].Cat_Name,dacat.Tables[0].Rows[k].Cat_Code);
    //                    
    //                     document.getElementById('drpadcat4').options.length; 
    //                }

    //            }
    //          
    //                document.getElementById('hiddenadscat4').value = document.getElementById('drpadcat4').value = executequery.Tables[0].Rows[rownumEx].Ad_Subcat4;
    //          
    //            ///bind adcat5 drpdown
    //            if (executequery.Tables[0].Rows[rownumEx].Ad_subcat5==null || executequery.Tables[0].Rows[rownumEx].Ad_subcat5.toString() == "")
    //            {
    //                document.getElementById('drpadcat5').options.length=0;
    //                document.getElementById('hiddenadscat5').value = "";
    //            }
    //            else
    //            {
    //                ////////////when 1 than bind the adscat4 drp down

    //               res3=null;
    //                res3=Classified_Booking.getvalfromadcat3(executequery.Tables[0].Rows[rownumEx].Ad_Subcat4,document.getElementById('hiddencompcode').value,"2");
    //                var dacat = res3.value;
    //                if(dacat==null)
    //                {
    //                    alert(dacat.error.description);
    //                    return false;
    //                }

    //               
    //                ////////////////////////////////////////////////////////////////
    //               document.getElementById('drpadcat5').options.length=0;
    //               document.getElementById('drpadcat5').options[0]=new Option("Select","0");
    //                for (var k = 0; k < dacat.Tables[0].Rows.length; k++)
    //                {
    //                     document.getElementById('drpadcat5').options[document.getElementById('drpadcat5').options.length] = new Option(dacat.Tables[0].Rows[k].Cat_Name,dacat.Tables[0].Rows[k].Cat_Code);
    //                    
    //                     document.getElementById('drpadcat5').options.length; 
    //                }
    //            }
    //            document.getElementById('hiddenadscat5').value = document.getElementById('drpadcat5').value = executequery.Tables[0].Rows[rownumEx].Ad_subcat5;


    //            //////bind the bg color drp down 
    //            if(executequery.Tables[0].Rows[rownumEx].Bg_color!=null)
    //            {
    //                document.getElementById('drpbgcolor').value = executequery.Tables[0].Rows[rownumEx].Bg_color;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bullet_code!=null)
    //            {
    //                document.getElementById('drpbullet').value = executequery.Tables[0].Rows[rownumEx].Bullet_code;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bullet_premium!=null)
    //            {
    //                document.getElementById('txtbullprem').value = executequery.Tables[0].Rows[rownumEx].Bullet_premium;
    //            }   
    //            /* *14Aug*
    //            if (drpretainer.Items.FindByValue(executequery.Tables[0].Rows[0].ItemArray[134].ToString()) != null)
    //            {
    //                drpretainer.SelectedValue = executequery.Tables[0].Rows[0].ItemArray[134].ToString();
    //            } */
    //            if(executequery.Tables[0].Rows[rownumEx].RETAINER1!=null)
    //            {
    //                document.getElementById('drpretainer').value = executequery.Tables[0].Rows[rownumEx].RETAINER1;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].ADD_AGENCY_COMM!=null)
    //            {
    //                 if(document.getElementById('txtaddagencycommrate')!=null)
    //                 {
    //                    document.getElementById('txtaddagencycommrate').value = executequery.Tables[0].Rows[rownumEx].ADD_AGENCY_COMM;
    //                  }  
    //            }   
    //          
    //            //grid
    //       
    //        showcardinfo(executequery.Tables[0].Rows[rownumEx].Bill_pay);
    //        showgridexecute();
    //        updateStatus();
    //        document.getElementById('btnfirst').disabled = false;
    //        document.getElementById('btnlast').disabled = false;
    //        document.getElementById('btnprevious').disabled = false;
    //        document.getElementById('btnnext').disabled = false;
    //        if (document.getElementById('hiddenuomdesc').value == "ROD")
    //        {
    //            if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtcolum').value != "")
    //            {
    //                document.getElementById('txtadsize2').disabled =true;
    //                document.getElementById('txtadsize1').style.backgroundColor="#FFFFFF";
    //                document.getElementById('txtadsize2').style.backgroundColor="#FFFFFF";
    //                document.getElementById('txtcolum').style.backgroundColor="#FFFFFF";

    //            }
    //            else if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtadsize2').value != "")
    //            {
    //                document.getElementById('txtcolum').disabled=true;
    //                document.getElementById('txtadsize1').style.backgroundColor="#FFFFFF";
    //                document.getElementById('txtadsize2').style.backgroundColor="#FFFFFF";
    //                document.getElementById('txtcolum').style.backgroundColor="#FFFFFF";

    //            }


    //        }
    //        else if (document.getElementById('hiddenuomdesc').value != "CD")
    //        {
    //            document.getElementById('txtadsize1').disabled=true;
    //            document.getElementById('txtadsize2').disabled = true;
    //            if (document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROD")
    //            {
    //                document.getElementById('Label1').innerHTML = "No. Of Lines";
    //                document.getElementById('txtadsize1').style.backgroundColor = "#999999";
    //                document.getElementById('txtadsize2').style.backgroundColor = "#999999";
    //                document.getElementById('txtcolum').style.backgroundColor = "#999999";


    //            }
    //            else if (drpuom.SelectedItem.Text == "ROW")
    //            {
    //                document.getElementById('Label1').innerHTML = "No. Of Words";
    //                document.getElementById('txtadsize1').style.backgroundColor = "#999999";
    //                document.getElementById('txtadsize2').style.backgroundColor = "#999999";
    //                document.getElementById('txtcolum').style.backgroundColor = "#999999";
    //            }

    //        }  
    //        }
    //        else
    //        {
    //                document.getElementById('btnnext').disabled = false;
    //                document.getElementById('btnlast').disabled = false;
    //                document.getElementById('btnfirst').disabled = true;
    //                document.getElementById('btnprevious').disabled = true;

    //        }
    //        }
    //        else
    //        {
    //             document.getElementById('btnnext').disabled = true;
    //                document.getElementById('btnlast').disabled = true;
    //                document.getElementById('btnfirst').disabled = false;
    //                document.getElementById('btnprevious').disabled = false;
    //        }
    //           if (rownumEx == 0)
    //        {
    //             document.getElementById('btnfirst').disabled = true;
    //             document.getElementById('btnprevious').disabled = true;
    //        }
    //      return false;  
}

function nextClick() {
    clearClick();
    rownumEx = parseInt(rownumEx) + 1;
    var count = executequery.Tables[0].Rows.length - 1;
    fillDATA();
    document.getElementById('LinkButton1').disabled = false;
    document.getElementById('LinkButton2').disabled = false;
    document.getElementById('LinkButton3').disabled = false;
    document.getElementById('LinkButton4').disabled = false;
    document.getElementById('LinkButton5').disabled = false;
    document.getElementById('LinkButton6').disabled = false;
    document.getElementById('LinkButton7').disabled = false;
    document.getElementById('btnprevious').disabled = false;
    document.getElementById('btnfirst').disabled = false;
    if (rownumEx == count) {
        document.getElementById('btnlast').disabled = true;
        document.getElementById('btnnext').disabled = true;
    }
    else {
        document.getElementById('btnlast').disabled = false;
        document.getElementById('btnnext').disabled = false;
    }
    setButtonImages();
    return false;
    //        document.getElementById('tblinsert').innerHTML='';
    //        clearClick();
    //        document.getElementById('LinkButton1').disabled = false;
    //        document.getElementById('LinkButton2').disabled = false;
    //        document.getElementById('LinkButton3').disabled = false;
    //        document.getElementById('LinkButton4').disabled = false;
    //        document.getElementById('LinkButton5').disabled = false;
    //        document.getElementById('LinkButton6').disabled = false;
    //        document.getElementById('LinkButton7').disabled = false;
    //        rownumEx++;
    //        //////////////////////////////////////////////////////////////////////////

    //       
    //          if(executequery==null)
    //          {
    //            alert("No Data Available");
    //            return false;
    //          }
    //            var count = executequery.Tables[0].Rows.length - 1;
    //           // dateinsert getdatechk = new dateinsert();
    //            if (rownumEx != -1 && rownumEx>=0)
    //            {
    //               if (rownumEx <= count)
    //               {
    //                if(executequery.Tables[0].Rows[rownumEx].branch!=null)
    //                {
    //                    document.getElementById('txtbranch').value = executequery.Tables[0].Rows[rownumEx].branch;
    //                }    
    //                if(executequery.Tables[0].Rows[rownumEx].booked_by!=null)
    //                {
    //                    document.getElementById('txtbookedby').value = executequery.Tables[0].Rows[rownumEx].booked_by;
    //                }
    //                if(executequery.Tables[0].Rows[rownumEx].prev_booking!=null)
    //                {    
    //                    document.getElementById('txtprevbook').value = executequery.Tables[0].Rows[rownumEx].prev_booking;
    //                }    
    //                var datetime = executequery.Tables[0].Rows[rownumEx].DATE_TIME;
    //                if(datetime!=null)
    //                {
    //                    document.getElementById('txtdatetime').value = datetime;//getdatechk.getDate(dateformat, datetime);
    //                 }   
    //                 if(executequery.Tables[0].Rows[rownumEx].cio_booking_id!=null)
    //                 {
    //                    document.getElementById('txtciobookid').value = executequery.Tables[0].Rows[rownumEx].cio_booking_id;
    //                 }  
    //                //txtappby.Text = executequery.Tables[0].Rows[0].ItemArray[5].ToString();
    //                // txtaudit.Text = executequery.Tables[0].Rows[0].ItemArray[6].ToString();
    //                if(executequery.Tables[0].Rows[rownumEx].RO_No!=null)
    //                {
    //                    document.getElementById('txtrono').value = executequery.Tables[0].Rows[rownumEx].RO_No;
    //                 }   
    //                var ro_date = executequery.Tables[0].Rows[rownumEx].RO_Date;
    //                if(ro_date!=null)
    //                {  
    //                    document.getElementById('txtrodate').value = ro_date;//getdatechk.getDate(dateformat, ro_date);
    //                }   
    //                if(executequery.Tables[0].Rows[rownumEx].bill_status!=null)
    //                {
    //                    document.getElementById('drpbillstatus').value = executequery.Tables[0].Rows[rownumEx].bill_status;
    //                }   
    //                if(executequery.Tables[0].Rows[rownumEx].ro_status!=null)
    //                {
    //                    document.getElementById('drprostatus').value = executequery.Tables[0].Rows[rownumEx].ro_status;
    //                }    
    //                if(executequery.Tables[0].Rows[rownumEx].AgencyName!=null)
    //                {
    //                    document.getElementById('txtagency').value = executequery.Tables[0].Rows[rownumEx].AgencyName;
    //                }    
    //                //drpagency_SelectedIndexChanged(sender, e);

    //                ///////////////this is to bind the subagency drop down
    //            
    //               var res2=Classified_Booking.bindsubagency(executequery.Tables[0].Rows[rownumEx].Agency_sub_code, document.getElementById('hiddencompcode').value);
    //                
    //                var dsbsa = res2.value;
    //                if(dsbsa==null)
    //                {
    //                    alert(res2.error.description);
    //                    return false;
    //                }
    //               

    //                document.getElementById('drpagscode').options.length=0;
    //                document.getElementById('drpagscode').options[0]=new Option("Select Agency","0");
    //                document.getElementById('drpagscode').options.length = 1; 
    //                for (var i = 0  ; i < dsbsa.Tables[0].Rows.length; ++i)
    //                {
    //                    document.getElementById('drpagscode').options[document.getElementById('drpagscode').options.length] = new Option(dsbsa.Tables[0].Rows[i].agency_name,dsbsa.Tables[0].Rows[i].Agency_Code);
    //                
    //                    document.getElementById('drpagscode').options.length;       
    //                }


    //            //////////////////////////////////////////////////////
    //            if(executequery.Tables[0].Rows[rownumEx].Client!=null)
    //            {
    //                document.getElementById('txtclient').value = executequery.Tables[0].Rows[rownumEx].Client;     //.ItemArray[14].ToString();
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_address!=null)
    //            {
    //                document.getElementById('txtagencyaddress').value = executequery.Tables[0].Rows[rownumEx].Agency_address;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Client_address!=null)
    //            {
    //                document.getElementById('txtclientadd').value = executequery.Tables[0].Rows[rownumEx].Client_address;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_code!=null)
    //            {
    //                document.getElementById('hiddensubcode').value = document.getElementById('drpagscode').value = executequery.Tables[0].Rows[rownumEx].Agency_code;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Dockit_no!=null)
    //            {
    //                document.getElementById('txtdockitno1').value = executequery.Tables[0].Rows[rownumEx].Dockit_no;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].execname!=null)
    //            { 
    //                document.getElementById('txtexecname').value = executequery.Tables[0].Rows[rownumEx].execname;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Executive_zone!=null)
    //            {
    //                document.getElementById('hiddenzone').value = document.getElementById('txtexeczone').value = executequery.Tables[0].Rows[rownumEx].Executive_zone;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].product!=null)
    //            {
    //                document.getElementById('txtproduct').value = executequery.Tables[0].Rows[rownumEx].product;
    //            }    
    //            //drpproduct_SelectedIndexChanged1(sender, e);
    //            //drpbrand.SelectedValue = executequery.Tables[0].Rows[0].ItemArray[21].ToString();
    //            /////////////////////////////////////////////this is to bind the brand drop down
    //            res2=null;
    //            if(executequery.Tables[0].Rows[rownumEx].Product_code!=null)
    //            {
    //            res2=Classified_Booking.brandbind(document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[rownumEx].Product_code);
    //            var dsbrand = res2.value;
    //            if(dsbrand==null)
    //            {
    //                alert(res2.error.description);
    //                return false;
    //            }
    //            
    //              document.getElementById('drpbrand').options.length=0;
    //              document.getElementById('drpbrand').options[0]=new Option("Select Brand","0");
    //              document.getElementById('drpbrand').options.length = 1; 
    //                for (var i = 0  ; i < dsbrand.Tables[0].Rows.length; ++i)
    //                {
    //                    document.getElementById('drpbrand').options[document.getElementById('drpbrand').options.length] = new Option(dsbrand.Tables[0].Rows[i].brand_name,dsbrand.Tables[0].Rows[i].brand_code);
    //                
    //                    document.getElementById('drpbrand').options.length;       
    //                }
    //                
    //           }
    //            //hiddenbrand.Value=drpbrand.SelectedValue = executequery.Tables[0].Rows[0].ItemArray[21].ToString();
    //            if (executequery.Tables[0].Rows[rownumEx].Brand_code==null || executequery.Tables[0].Rows[rownumEx].Brand_code.toString() == "")
    //            {
    //                document.getElementById('drpbrand').options.length=0;
    //                document.getElementById('hiddenbrand').value = "";
    //            }
    //            else
    //            {
    //                if(executequery.Tables[0].Rows[rownumEx].Brand_code!=null)
    //                {
    //                    document.getElementById('hiddenbrand').value = document.getElementById('drpbrand').value = executequery.Tables[0].Rows[rownumEx].Brand_code.toString();
    //                }    
    //            }
    //            ////////////////////this is to bind the varient dropdown

    //          
    //            ////////////////////////////////////////////////////////////////////////////////
    //            if(executequery.Tables[0].Rows[rownumEx].Key_no!=null)
    //            {
    //                document.getElementById('txtkeyno').value = executequery.Tables[0].Rows[rownumEx].Key_no;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_remarks!=null)
    //            {
    //                document.getElementById('txtbillremark').value = executequery.Tables[0].Rows[rownumEx].Bill_remarks;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Print_remark!=null)
    //            {
    //                document.getElementById('txtprintremark').value = executequery.Tables[0].Rows[rownumEx].Print_remark;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Package_code!=null)
    //            {
    //                var listpck = executequery.Tables[0].Rows[rownumEx].Package_code;
    //            document.getElementById('hiddenpackage').value = listpck;
    //            //////////////////this is to bind the package grid on what the value is saved in the database


    //            res2=null;
    //            res2=Classified_Booking.bindpacforexe(document.getElementById('hiddencompcode').value, listpck);
    //            var dsexecut = res2.value;
    //            if(dsexecut==null)
    //            {
    //                alert(res2.error.description);
    //                return false;
    //            }
    //                 
    //           
    //            
    //            
    //            document.getElementById('drppackagecopy').options.length=0;
    //            for (i = 0; i <= dsexecut.Tables[0].Rows.length - 1; i++)
    //            {
    //                if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "")
    //                {
    //                    if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "0")
    //                    {
    //                        var arrfor_uom = dsexecut.Tables[0].Rows[i].pck_code.toString().split('@');
    //                        var res3=Classified_Booking.getPackageInsert(arrfor_uom[0].toString(), document.getElementById('txtciobookid').value);
    //                        var dsinsert = res3.value;
    //                        if(dsinsert==null)
    //                        {
    //                            alert(res3.error.description);
    //                            return false;
    //                        }
    //                        var T=dsexecut.Tables[0].Rows[i].Package_Name + "(" + dsinsert.Tables[0].Rows[0].inserts + ")";
    //                        var V=dsexecut.Tables[0].Rows[i].pck_code + "(" + dsinsert.Tables[0].Rows[0].inserts + ")";
    //                        document.getElementById('drppackagecopy').options[document.getElementById('drppackagecopy').options.length] = new Option(T,V);
    //                
    //                        document.getElementById('drppackagecopy').options.length;   
    //                    
    ////                        ListItem li;
    ////                        li = new ListItem();
    ////                        li.Text = dsexecut.Tables[0].Rows[i].ItemArray[1].ToString() + "(" + dsinsert.Tables[0].Rows[0].ItemArray[0].ToString() + ")";
    ////                        li.Value = dsexecut.Tables[0].Rows[i].ItemArray[2].ToString() + "(" + dsinsert.Tables[0].Rows[0].ItemArray[0].ToString() + ")"; ;
    ////                        //state = ds.Tables[0].Rows[i].ItemArray[2].ToString();
    ////                        drppackagecopy.Items.Add(li);

    //                    }
    //                }
    //            }

    //        }
    //                
    //            if(executequery.Tables[0].Rows[rownumEx].No_of_insertion!=null)
    //            {
    //                document.getElementById('txtinsertion').value = executequery.Tables[0].Rows[rownumEx].No_of_insertion;
    //                document.getElementById('hiddeninsertion').value = executequery.Tables[0].Rows[rownumEx].No_of_insertion;
    //            }   
    //            
    //            var start_date = executequery.Tables[0].Rows[rownumEx].Insertion_date;
    //            if(start_date!=null)
    //            {
    //                document.getElementById('txtdummydate').value = start_date;//getdatechk.getDate(dateformat, start_date);
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Repeating_day!=null)
    //            {
    //                document.getElementById('txtrepeatingdate').value = executequery.Tables[0].Rows[rownumEx].Repeating_day;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Booking_type!=null)
    //            {
    //                document.getElementById('drpbooktype').value = executequery.Tables[0].Rows[rownumEx].Booking_type;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Ad_cat_code!=null)
    //            {
    //                document.getElementById('drpadcategory').value = executequery.Tables[0].Rows[rownumEx].Ad_cat_code;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Ad_sub_cat_code!=null)
    //            {
    //                document.getElementById('drpadsubcategory').value = executequery.Tables[0].Rows[rownumEx].Ad_sub_cat_code;
    //            }
    //            if(executequery.Tables[0].Rows[rownumEx].Color_code!=null)
    //            {
    //                document.getElementById('drpcolor').value = executequery.Tables[0].Rows[rownumEx].Color_code;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Uom_code!=null)
    //            {
    //                document.getElementById('drpuom').value = executequery.Tables[0].Rows[rownumEx].Uom_code;
    //            }    
    //            //*25Aug* 
    //            res3=null;
    //            res3 = Classified_Booking.gettheuom_desc(document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[rownumEx].Uom_code);  
    //            var ds_uom_=res3.value;
    //            if(ds_uom_==null)
    //            {
    //                alert(res3.error.description);
    //                return false;
    //            }
    //            if(ds_uom_.Tables[0].Rows.length>0)
    //            {
    //                document.getElementById('hiddenuomdesc').value = ds_uom_.Tables[0].Rows[0].uom_desc;   
    //            }
    //                
    //                
    //                //*25Aug*
    //            if(executequery.Tables[0].Rows[rownumEx].Page_position_code!=null)
    //            {
    //                document.getElementById('drppageposition').value = executequery.Tables[0].Rows[rownumEx].Page_position_code;
    //             }   
    //       
    //            //string adtype=drpadstype.SelectedValue;
    //            if(executequery.Tables[0].Rows[rownumEx].Ad_size_height!=null)
    //            {
    //                document.getElementById('txtadsize1').value = executequery.Tables[0].Rows[rownumEx].Ad_size_height;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Ad_size_width!=null)
    //            {
    //                document.getElementById('txtadsize2').value = executequery.Tables[0].Rows[rownumEx].Ad_size_width;
    //            }    
    //            ////this is to bind the ratecode drpdown
    //            res3=null
    //            if(executequery.Tables[0].Rows[rownumEx].Ad_cat_code!=null)
    //            {
    //            res3=Classified_Booking.ratebind(executequery.Tables[0].Rows[rownumEx].Ad_cat_code, document.getElementById('hiddencompcode').value);
    //            var dx = res3.value;
    //            if(dx==null)
    //            {   
    //                alert(dx.error.description);
    //                return false;
    //            }
    //             
    //            
    //            

    //              document.getElementById('txtratecode').options.length=0;
    //              document.getElementById('txtratecode').options[0]=new Option("-Select Rate Code-","0");
    //              document.getElementById('txtratecode').options.length = 1; 
    //            
    //             for (var i = 0  ; i < dx.Tables[0].Rows.length; ++i)
    //                {
    //                    document.getElementById('txtratecode').options[document.getElementById('txtratecode').options.length] = new Option(dx.Tables[0].Rows[i].rate_mast_code,dx.Tables[0].Rows[i].rate_mast_code);
    //                
    //                    document.getElementById('txtratecode').options.length;       
    //                }
    //                
    //           }
    //           if(executequery.Tables[0].Rows[rownumEx].Rate_code!=null)
    //           {
    //                document.getElementById('txtratecode').value = executequery.Tables[0].Rows[rownumEx].Rate_code;
    //           }    
    //            if(executequery.Tables[0].Rows[rownumEx].Scheme_type_code!=null)
    //            {
    //                document.getElementById('drpscheme').value = executequery.Tables[0].Rows[rownumEx].Scheme_type_code;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Scheme_type_code!=null)
    //            { 
    //                document.getElementById('hiddenscheme').value = executequery.Tables[0].Rows[rownumEx].Scheme_type_code;
    //            }    
    //     //       drpschemepck.SelectedValue = executequery.Tables[0].Rows[0].ItemArray[41].ToString();
    //            if(executequery.Tables[0].Rows[rownumEx].Currency_code!=null)
    //            {
    //                document.getElementById('drpcurrency').value = executequery.Tables[0].Rows[rownumEx].Currency_code;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Agrred_rate!=null)
    //            {
    //                document.getElementById('txtagreedrate').value = executequery.Tables[0].Rows[rownumEx].Agrred_rate;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Agreed_amount!=null)
    //            {
    //                document.getElementById('txtagreedamt').value = executequery.Tables[0].Rows[rownumEx].Agreed_amount;
    //            }    
    //    
    //            if(executequery.Tables[0].Rows[rownumEx].Special_charges!=null)
    //            {
    //                document.getElementById('txtextracharges').value = executequery.Tables[0].Rows[rownumEx].Special_charges;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_status!=null)
    //            {
    //                document.getElementById('hiddenstatus').value = document.getElementById('txtagencystatus').value = executequery.Tables[0].Rows[rownumEx].Agency_status;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_type!=null)
    //            {
    //                document.getElementById('txtagencytype').value = executequery.Tables[0].Rows[rownumEx].Agency_type;
    //            }    
    //            //this is To the bind the the agencypaymode dropdown on execution
    //            res3=null;
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_sub_code!=null)
    //            {
    //            res3=Classified_Booking.getstatuspaymode(executequery.Tables[0].Rows[rownumEx].Agency_sub_code, executequery.Tables[0].Rows[rownumEx].Agency_code, document.getElementById('hiddencompcode').value, document.getElementById('txtdatetime').value,document.getElementById('hiddendateformat').value,"CL0");
    //            var dch = res3.value;
    //            if(dch==null)
    //            {
    //                alert(res3.error.description);
    //                return false;
    //            }
    //            
    //            

    //            document.getElementById('txtagencypaymode').options.length=0;
    //            if (dch.Tables[5].Rows.length > 0)
    //            {
    //                for (var i = 0; i < dch.Tables[5].Rows.length; i++)
    //                {
    //                    document.getElementById('txtagencypaymode').options[document.getElementById('txtagencypaymode').options.length] = new Option(dch.Tables[5].Rows[i].payment_mode_name,dch.Tables[5].Rows[i].pay_mode_code);
    //                
    //                    document.getElementById('txtagencypaymode').options.length; 
    //                   
    //                }

    //            }
    //           } 
    //            ///////////////////////////////////////////////////////////////////////////////////////////////////
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_pay!=null)
    //            {
    //                document.getElementById('hiddenpay').value =  document.getElementById('txtagencypaymode').value = executequery.Tables[0].Rows[rownumEx].Agency_pay;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_credit!=null)
    //            {
    //                document.getElementById('txtcreditperiod').value = executequery.Tables[0].Rows[rownumEx].Agency_credit;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Total_area!=null)
    //            {
    //                document.getElementById('txttotalarea').value = executequery.Tables[0].Rows[rownumEx].Total_area;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Card_rate!=null)
    //            {
    //                document.getElementById('txtcardrate').value = executequery.Tables[0].Rows[rownumEx].Card_rate;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Card_amount!=null)
    //            {
    //                document.getElementById('txtcardamt').value = executequery.Tables[0].Rows[rownumEx].Card_amount;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Discount!=null)
    //            {
    //                document.getElementById('txtdiscount').value = executequery.Tables[0].Rows[rownumEx].Discount;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Discount_per!=null)
    //            {
    //                document.getElementById('txtdiscpre').value = executequery.Tables[0].Rows[rownumEx].Discount_per;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_cycle!=null)
    //            {
    //                document.getElementById('drpbillcycle').value = executequery.Tables[0].Rows[rownumEx].Bill_cycle;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Revenue_center!=null)
    //            {
    //                document.getElementById('drprevenue').value = executequery.Tables[0].Rows[rownumEx].Revenue_center;
    //            }    

    //            ////this is to bind the bill pay mode
    //            document.getElementById('drppaymenttype').options.length=0;
    //            if (dch.Tables[5].Rows.length > 0)
    //            {
    //                for (var i = 0;  i< dch.Tables[5].Rows.length; i++)
    //                {
    //                   document.getElementById('drppaymenttype').options[document.getElementById('drppaymenttype').options.length] = new Option(dch.Tables[5].Rows[i].payment_mode_name,dch.Tables[5].Rows[i].pay_mode_code);
    //                
    //                    document.getElementById('drppaymenttype').options.length; 
    //                }

    //            }
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_pay!=null)
    //            {    
    //                document.getElementById('hiddenbillpay').value = document.getElementById('drppaymenttype').value = executequery.Tables[0].Rows[rownumEx].Bill_pay;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_height!=null)
    //            {
    //                document.getElementById('txtbillheight').value = executequery.Tables[0].Rows[rownumEx].Bill_height;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_width!=null)
    //            {
    //                document.getElementById('txtbillwidth').value = executequery.Tables[0].Rows[rownumEx].Bill_width;
    //            }    
    //            //////////////this is to bind the bill to 
    //            res3=null;
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_sub_code!=null)
    //            {
    //            res3=Classified_Booking.getbillval(executequery.Tables[0].Rows[rownumEx].Agency_sub_code, document.getElementById('hiddencompcode').value);
    //            var dbt = res3.value;
    //            if(dbt==null)
    //            {
    //                alert(res3.error.description);
    //                return false;
    //            }
    //           
    //            
    //            ////////////////////////////////////////////////////
    //            document.getElementById('drpbillto').options.length=0;
    //            document.getElementById('drpbillto').options[0] = new Option("Client","client");
    //            
    //            for (var k = 0; k < dbt.Tables[0].Rows.length; k++)
    //            {
    //                 document.getElementById('drpbillto').options[document.getElementById('drpbillto').options.length] = new Option(dbt.Tables[0].Rows[k].agency_name,dbt.Tables[0].Rows[k].bill_to);
    //                
    //                 document.getElementById('drpbillto').options.length; 
    //            }
    //            }
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_to!=null)
    //            {
    //                document.getElementById('hiddenbillto').value = executequery.Tables[0].Rows[rownumEx].Bill_to;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_to!=null)
    //            {
    //                document.getElementById('drpbillto').value = executequery.Tables[0].Rows[rownumEx].Bill_to;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Invoices!=null)
    //            {
    //                document.getElementById('txtinvoice').value = executequery.Tables[0].Rows[rownumEx].Invoices;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Vts!=null)
    //            {
    //                document.getElementById('txtvts').value = executequery.Tables[0].Rows[rownumEx].Vts;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_add!=null)
    //            {
    //                document.getElementById('txtbilladdress').value = executequery.Tables[0].Rows[rownumEx].Bill_add;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Trade_disc!=null)
    //            {
    //                document.getElementById('txttradedisc').value = executequery.Tables[0].Rows[rownumEx].Trade_disc;
    //            }
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_out!=null)
    //            {
    //                document.getElementById('txtagencyoutstand').value = executequery.Tables[0].Rows[rownumEx].Agency_out;
    //            }    
    //            
    //            if(executequery.Tables[0].Rows[rownumEx].Page_amount!=null)
    //            {
    //                document.getElementById('txtpageamt').value = executequery.Tables[0].Rows[rownumEx].Page_amount;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Gross_amount!=null)
    //            {
    //                document.getElementById('txtgrossamt').value = executequery.Tables[0].Rows[rownumEx].Gross_amount;
    //            }    

    //            //Inserting in hidden field to compare new and  Previous amount 
    //            if(executequery.Tables[0].Rows[rownumEx].Gross_amount!=null)
    //            {
    //                document.getElementById('hiddenprevamt').value = executequery.Tables[0].Rows[rownumEx].Gross_amount;
    //            }   

    //            if(executequery.Tables[0].Rows[rownumEx].Bill_amount!=null)
    //            {
    //                document.getElementById('txtbillamt').value = executequery.Tables[0].Rows[rownumEx].Bill_amount;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Box_code!=null)
    //            {
    //                document.getElementById('drpboxcode').value = executequery.Tables[0].Rows[rownumEx].Box_code;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Box_no!=null)
    //            {
    //                document.getElementById('txtboxno').value = executequery.Tables[0].Rows[rownumEx].Box_no;
    //            }    
    //            if (executequery.Tables[0].Rows[rownumEx].Box_agency.toString() == "1")
    //            {
    //                document.getElementById('chkage').checked = true;
    //            }
    //            else
    //            {
    //                document.getElementById('chkage').checked = false;
    //            }
    //            if (executequery.Tables[0].Rows[rownumEx].Box_client.toString() == "1")
    //            {
    //                document.getElementById('chkclie').checked = true;
    //            }
    //            else
    //            {
    //                document.getElementById('chkclie').checked = false;
    //            }
    //            if(executequery.Tables[0].Rows[rownumEx].Box_address!=null)
    //            {
    //                document.getElementById('txtboxaddress').value = executequery.Tables[0].Rows[rownumEx].Box_address;
    //            }    
    //            if (executequery.Tables[0].Rows[rownumEx].Tfn == "1")
    //            {
    //                document.getElementById('chktfn').value = true;
    //            }
    //            else
    //            {
    //                document.getElementById('chktfn').value= false;
    //            }
    //            if(executequery.Tables[0].Rows[rownumEx].Ad_size_column!=null)
    //            {
    //                document.getElementById('txtcolum').value = executequery.Tables[0].Rows[rownumEx].Ad_size_column;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Paid_ins!=null)
    //            {          
    //                document.getElementById('txtpaid').value = executequery.Tables[0].Rows[rownumEx].Paid_ins;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Contract_rate!=null)
    //            {
    //                document.getElementById('txtdealrate').value = executequery.Tables[0].Rows[rownumEx].Contract_rate;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Deviation!=null)
    //            {
    //                document.getElementById('txtdeviation').value = executequery.Tables[0].Rows[rownumEx].Deviation;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Contract_name!=null)
    //            {          
    //                document.getElementById('txtcontractname').value = executequery.Tables[0].Rows[rownumEx].Contract_name;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Contract_type!=null)
    //            {
    //                document.getElementById('txtcontracttype').value = executequery.Tables[0].Rows[rownumEx].Contract_type;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Card_name!=null)
    //            {
    //                document.getElementById('txtcardname').value = executequery.Tables[0].Rows[rownumEx].Card_name;
    //             }   
    //             if(executequery.Tables[0].Rows[rownumEx].Card_type!=null)
    //             {
    //                document.getElementById('drptype').value = executequery.Tables[0].Rows[rownumEx].Card_type;
    //             }   
    //             if(executequery.Tables[0].Rows[rownumEx].Card_month!=null)
    //             {
    //                document.getElementById('drpmonth').value = executequery.Tables[0].Rows[rownumEx].Card_month;
    //             }   
    //             if(executequery.Tables[0].Rows[rownumEx].Card_year!=null)
    //             {
    //                document.getElementById('drpyear').value = executequery.Tables[0].Rows[rownumEx].Card_year;
    //             }   
    //             if(executequery.Tables[0].Rows[rownumEx].Card_number!=null)
    //             {
    //                document.getElementById('txtcardno').value = executequery.Tables[0].Rows[rownumEx].Card_number;
    //             }   
    //            if(executequery.Tables[0].Rows[rownumEx].Receipt_no!=null)
    //            { 
    //                document.getElementById('hiddenreceiptno').value =  document.getElementById('txtreceipt').value = executequery.Tables[0].Rows[rownumEx].Receipt_no;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Material_status!=null)
    //            {
    //                document.getElementById('drpmatstat').value = executequery.Tables[0].Rows[rownumEx].Material_status;
    //            }    

    //            ////this is to bind the adscat3 drpdown



    //            if (executequery.Tables[0].Rows[rownumEx].Ad_Subcat3==null || executequery.Tables[0].Rows[rownumEx].Ad_Subcat3.toString() == "")
    //            {
    //                document.getElementById('drpadcat3').options.length=0;
    //                document.getElementById('hiddenadscat3').value = "";

    //            }
    //            else
    //            {
    //                res3=null;
    //                res3=Classified_Booking.getvalfromadcat3(executequery.Tables[0].Rows[rownumEx].Ad_sub_cat_code,document.getElementById('hiddencompcode').value,"0");
    //                var dacat = res3.value;
    //                if(dacat==null)
    //                {
    //                    alert(dacat.error.description);
    //                    return false;
    //                }

    //               
    //                ////////////////////////////////////////////////////////////////
    //               document.getElementById('drpadcat3').options.length=0;
    //               document.getElementById('drpadcat3').options[0]=new Option("Select","0");
    //                for (var k = 0; k < dacat.Tables[0].Rows.length; k++)
    //                {
    //                     document.getElementById('drpadcat3').options[document.getElementById('drpadcat3').options.length] = new Option(dacat.Tables[0].Rows[k].catname,dacat.Tables[0].Rows[k].catcode);
    //                    
    //                     document.getElementById('drpadcat3').options.length; 
    //                }


    //            }
    //           
    //                if(executequery.Tables[0].Rows[0].Ad_Subcat3!=null)
    //                {
    //                    document.getElementById('hiddenadscat3').value = document.getElementById('drpadcat3').value = executequery.Tables[0].Rows[rownumEx].Ad_Subcat3;
    //                }    
    //           
    //            ////////////////////this is to bind the adcat4 drp down
    //            if (executequery.Tables[0].Rows[rownumEx].Ad_Subcat4 == null || executequery.Tables[0].Rows[rownumEx].Ad_Subcat4.toString() == "")
    //            {
    //                document.getElementById('drpadcat4').options.length=0;
    //                document.getElementById('hiddenadscat4').value = "";

    //            }
    //            else
    //            {
    //                ////////////when 1 than bind the adscat4 drp down
    //                res3=null;
    //                res3=Classified_Booking.getvalfromadcat3(executequery.Tables[0].Rows[rownumEx].Ad_Subcat3,document.getElementById('hiddencompcode').value,"1");
    //                var dacat = res3.value;
    //                if(dacat==null)
    //                {
    //                    alert(dacat.error.description);
    //                    return false;
    //                }

    //               
    //                ////////////////////////////////////////////////////////////////
    //               document.getElementById('drpadcat4').options.length=0;
    //               document.getElementById('drpadcat4').options[0]=new Option("Select","0");
    //                for (var k = 0; k < dacat.Tables[0].Rows.length; k++)
    //                {
    //                     document.getElementById('drpadcat4').options[document.getElementById('drpadcat4').options.length] = new Option(dacat.Tables[0].Rows[k].Cat_Name,dacat.Tables[0].Rows[k].Cat_Code);
    //                    
    //                     document.getElementById('drpadcat4').options.length; 
    //                }

    //            }
    //          
    //                document.getElementById('hiddenadscat4').value = document.getElementById('drpadcat4').value = executequery.Tables[0].Rows[rownumEx].Ad_Subcat4;
    //          
    //            ///bind adcat5 drpdown
    //            if (executequery.Tables[0].Rows[rownumEx].Ad_subcat5==null || executequery.Tables[0].Rows[rownumEx].Ad_subcat5.toString() == "")
    //            {
    //                document.getElementById('drpadcat5').options.length=0;
    //                document.getElementById('hiddenadscat5').value = "";
    //            }
    //            else
    //            {
    //                ////////////when 1 than bind the adscat4 drp down

    //               res3=null;
    //                res3=Classified_Booking.getvalfromadcat3(executequery.Tables[0].Rows[rownumEx].Ad_Subcat4,document.getElementById('hiddencompcode').value,"2");
    //                var dacat = res3.value;
    //                if(dacat==null)
    //                {
    //                    alert(dacat.error.description);
    //                    return false;
    //                }

    //               
    //                ////////////////////////////////////////////////////////////////
    //               document.getElementById('drpadcat5').options.length=0;
    //               document.getElementById('drpadcat5').options[0]=new Option("Select","0");
    //                for (var k = 0; k < dacat.Tables[0].Rows.length; k++)
    //                {
    //                     document.getElementById('drpadcat5').options[document.getElementById('drpadcat5').options.length] = new Option(dacat.Tables[0].Rows[k].Cat_Name,dacat.Tables[0].Rows[k].Cat_Code);
    //                    
    //                     document.getElementById('drpadcat5').options.length; 
    //                }
    //            }
    //            document.getElementById('hiddenadscat5').value = document.getElementById('drpadcat5').value = executequery.Tables[0].Rows[rownumEx].Ad_subcat5;


    //            //////bind the bg color drp down 
    //            if(executequery.Tables[0].Rows[rownumEx].Bg_color!=null)
    //            {
    //                document.getElementById('drpbgcolor').value = executequery.Tables[0].Rows[rownumEx].Bg_color;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bullet_code!=null)
    //            {
    //                document.getElementById('drpbullet').value = executequery.Tables[0].Rows[rownumEx].Bullet_code;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bullet_premium!=null)
    //            {
    //                document.getElementById('txtbullprem').value = executequery.Tables[0].Rows[rownumEx].Bullet_premium;
    //            }   
    //            /* *14Aug*
    //            if (drpretainer.Items.FindByValue(executequery.Tables[0].Rows[0].ItemArray[134].ToString()) != null)
    //            {
    //                drpretainer.SelectedValue = executequery.Tables[0].Rows[0].ItemArray[134].ToString();
    //            } */
    //            if(executequery.Tables[0].Rows[rownumEx].RETAINER1!=null)
    //            {
    //                document.getElementById('drpretainer').value = executequery.Tables[0].Rows[rownumEx].RETAINER1;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].ADD_AGENCY_COMM!=null)
    //            {
    //             if(document.getElementById('txtaddagencycommrate')!=null)
    //             {
    //                document.getElementById('txtaddagencycommrate').value = executequery.Tables[0].Rows[rownumEx].ADD_AGENCY_COMM;
    //             }  
    //            }   
    //          
    //            //grid
    //       
    //        showcardinfo(executequery.Tables[0].Rows[rownumEx].Bill_pay);
    //        showgridexecute();
    //        updateStatus();
    //        document.getElementById('btnfirst').disabled = false;
    //        document.getElementById('btnprevious').disabled = false;
    //        if (document.getElementById('hiddenuomdesc').value == "ROD")
    //        {
    //            if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtcolum').value != "")
    //            {
    //                document.getElementById('txtadsize2').disabled =true;
    //                document.getElementById('txtadsize1').style.backgroundColor="#FFFFFF";
    //                document.getElementById('txtadsize2').style.backgroundColor="#FFFFFF";
    //                document.getElementById('txtcolum').style.backgroundColor="#FFFFFF";

    //            }
    //            else if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtadsize2').value != "")
    //            {
    //                document.getElementById('txtcolum').disabled=true;
    //                document.getElementById('txtadsize1').style.backgroundColor="#FFFFFF";
    //                document.getElementById('txtadsize2').style.backgroundColor="#FFFFFF";
    //                document.getElementById('txtcolum').style.backgroundColor="#FFFFFF";

    //            }


    //        }
    //        else if (document.getElementById('hiddenuomdesc').value != "CD")
    //        {
    //            document.getElementById('txtadsize1').disabled=true;
    //            document.getElementById('txtadsize2').disabled = true;
    //            if (document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROD")
    //            {
    //                document.getElementById('Label1').innerHTML = "No. Of Lines";
    //                document.getElementById('txtadsize1').style.backgroundColor = "#999999";
    //                document.getElementById('txtadsize2').style.backgroundColor = "#999999";
    //                document.getElementById('txtcolum').style.backgroundColor = "#999999";


    //            }
    //            else if (drpuom.SelectedItem.Text == "ROW")
    //            {
    //                document.getElementById('Label1').innerHTML = "No. Of Words";
    //                document.getElementById('txtadsize1').style.backgroundColor = "#999999";
    //                document.getElementById('txtadsize2').style.backgroundColor = "#999999";
    //                document.getElementById('txtcolum').style.backgroundColor = "#999999";
    //            }

    //        }  
    //        }
    //        else
    //        {
    //                document.getElementById('btnnext').disabled = true;
    //                document.getElementById('btnlast').disabled = true;
    //                document.getElementById('btnfirst').disabled = false;
    //                document.getElementById('btnprevious').disabled = false;
    //        }
    //        }
    //        else
    //        {
    //                document.getElementById('btnnext').disabled = true;
    //                document.getElementById('btnlast').disabled = true;
    //                document.getElementById('btnfirst').disabled = false;
    //                document.getElementById('btnprevious').disabled = false;
    //        }
    //          
    //        return false;
}
function lastClick() {
    clearClick();
    var count = executequery.Tables[0].Rows.length - 1;
    rownumEx = count;
    fillDATA();
    document.getElementById('LinkButton1').disabled = false;
    document.getElementById('LinkButton2').disabled = false;
    document.getElementById('LinkButton3').disabled = false;
    document.getElementById('LinkButton4').disabled = false;
    document.getElementById('LinkButton5').disabled = false;
    document.getElementById('LinkButton6').disabled = false;
    document.getElementById('LinkButton7').disabled = false;
    document.getElementById('btnfirst').disabled = false;
    document.getElementById('btnprevious').disabled = false;
    document.getElementById('btnlast').disabled = true;
    document.getElementById('btnnext').disabled = true;
    setButtonImages();
    return false;
    //        document.getElementById('tblinsert').innerHTML='';
    //        clearClick();
    //        document.getElementById('LinkButton1').disabled = false;
    //        document.getElementById('LinkButton2').disabled = false;
    //        document.getElementById('LinkButton3').disabled = false;
    //        document.getElementById('LinkButton4').disabled = false;
    //        document.getElementById('LinkButton5').disabled = false;
    //        document.getElementById('LinkButton6').disabled = false;
    //        document.getElementById('LinkButton7').disabled = false;
    //       
    //        //////////////////////////////////////////////////////////////////////////

    //       
    //          if(executequery==null)
    //          {
    //            alert(res1.error.description);
    //            return false;
    //          }
    //            var count = executequery.Tables[0].Rows.length - 1;
    //             rownumEx = count;
    //           // dateinsert getdatechk = new dateinsert();
    //         
    //                if(executequery.Tables[0].Rows[rownumEx].branch!=null)
    //                {
    //                    document.getElementById('txtbranch').value = executequery.Tables[0].Rows[rownumEx].branch;
    //                }    
    //                if(executequery.Tables[0].Rows[rownumEx].booked_by!=null)
    //                {
    //                    document.getElementById('txtbookedby').value = executequery.Tables[0].Rows[rownumEx].booked_by;
    //                }
    //                if(executequery.Tables[0].Rows[rownumEx].prev_booking!=null)
    //                {    
    //                    document.getElementById('txtprevbook').value = executequery.Tables[0].Rows[rownumEx].prev_booking;
    //                }    
    //                var datetime = executequery.Tables[0].Rows[rownumEx].DATE_TIME;
    //                if(datetime!=null)
    //                {
    //                    document.getElementById('txtdatetime').value = datetime;//getdatechk.getDate(dateformat, datetime);
    //                 }   
    //                 if(executequery.Tables[0].Rows[rownumEx].cio_booking_id!=null)
    //                 {
    //                    document.getElementById('txtciobookid').value = executequery.Tables[0].Rows[rownumEx].cio_booking_id;
    //                 }  
    //                //txtappby.Text = executequery.Tables[0].Rows[0].ItemArray[5].ToString();
    //                // txtaudit.Text = executequery.Tables[0].Rows[0].ItemArray[6].ToString();
    //                if(executequery.Tables[0].Rows[rownumEx].RO_No!=null)
    //                {
    //                    document.getElementById('txtrono').value = executequery.Tables[0].Rows[rownumEx].RO_No;
    //                 }   
    //                var ro_date = executequery.Tables[0].Rows[rownumEx].RO_Date;
    //                if(ro_date!=null)
    //                {  
    //                    document.getElementById('txtrodate').value = ro_date;//getdatechk.getDate(dateformat, ro_date);
    //                }   
    //                if(executequery.Tables[0].Rows[rownumEx].bill_status!=null)
    //                {
    //                    document.getElementById('drpbillstatus').value = executequery.Tables[0].Rows[rownumEx].bill_status;
    //                }   
    //                if(executequery.Tables[0].Rows[rownumEx].ro_status!=null)
    //                {
    //                    document.getElementById('drprostatus').value = executequery.Tables[0].Rows[rownumEx].ro_status;
    //                }    
    //                if(executequery.Tables[0].Rows[rownumEx].AgencyName!=null)
    //                {
    //                    document.getElementById('txtagency').value = executequery.Tables[0].Rows[rownumEx].AgencyName;
    //                }    
    //                //drpagency_SelectedIndexChanged(sender, e);

    //                ///////////////this is to bind the subagency drop down
    //            
    //               var res2=Classified_Booking.bindsubagency(executequery.Tables[0].Rows[rownumEx].Agency_sub_code, document.getElementById('hiddencompcode').value);
    //                
    //                var dsbsa = res2.value;
    //                if(dsbsa==null)
    //                {
    //                    alert(res2.error.description);
    //                    return false;
    //                }
    //               

    //                document.getElementById('drpagscode').options.length=0;
    //                document.getElementById('drpagscode').options[0]=new Option("Select Agency","0");
    //                document.getElementById('drpagscode').options.length = 1; 
    //                for (var i = 0  ; i < dsbsa.Tables[0].Rows.length; ++i)
    //                {
    //                    document.getElementById('drpagscode').options[document.getElementById('drpagscode').options.length] = new Option(dsbsa.Tables[0].Rows[i].agency_name,dsbsa.Tables[0].Rows[i].Agency_Code);
    //                
    //                    document.getElementById('drpagscode').options.length;       
    //                }


    //            //////////////////////////////////////////////////////
    //            if(executequery.Tables[0].Rows[rownumEx].Client!=null)
    //            {
    //                document.getElementById('txtclient').value = executequery.Tables[0].Rows[rownumEx].Client;     //.ItemArray[14].ToString();
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_address!=null)
    //            {
    //                document.getElementById('txtagencyaddress').value = executequery.Tables[0].Rows[rownumEx].Agency_address;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Client_address!=null)
    //            {
    //                document.getElementById('txtclientadd').value = executequery.Tables[0].Rows[rownumEx].Client_address;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_code!=null)
    //            {
    //                document.getElementById('hiddensubcode').value = document.getElementById('drpagscode').value = executequery.Tables[0].Rows[rownumEx].Agency_code;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Dockit_no!=null)
    //            {
    //                document.getElementById('txtdockitno1').value = executequery.Tables[0].Rows[rownumEx].Dockit_no;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].execname!=null)
    //            { 
    //                document.getElementById('txtexecname').value = executequery.Tables[0].Rows[rownumEx].execname;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Executive_zone!=null)
    //            {
    //                document.getElementById('hiddenzone').value = document.getElementById('txtexeczone').value = executequery.Tables[0].Rows[rownumEx].Executive_zone;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].product!=null)
    //            {
    //                document.getElementById('txtproduct').value = executequery.Tables[0].Rows[rownumEx].product;
    //            }    
    //            //drpproduct_SelectedIndexChanged1(sender, e);
    //            //drpbrand.SelectedValue = executequery.Tables[0].Rows[0].ItemArray[21].ToString();
    //            /////////////////////////////////////////////this is to bind the brand drop down
    //            res2=null;
    //            if(executequery.Tables[0].Rows[rownumEx].Product_code!=null)
    //            {
    //            res2=Classified_Booking.brandbind(document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[rownumEx].Product_code);
    //            var dsbrand = res2.value;
    //            if(dsbrand==null)
    //            {
    //                alert(res2.error.description);
    //                return false;
    //            }
    //            
    //              document.getElementById('drpbrand').options.length=0;
    //              document.getElementById('drpbrand').options[0]=new Option("Select Brand","0");
    //              document.getElementById('drpbrand').options.length = 1; 
    //                for (var i = 0  ; i < dsbrand.Tables[0].Rows.length; ++i)
    //                {
    //                    document.getElementById('drpbrand').options[document.getElementById('drpbrand').options.length] = new Option(dsbrand.Tables[0].Rows[i].brand_name,dsbrand.Tables[0].Rows[i].brand_code);
    //                
    //                    document.getElementById('drpbrand').options.length;       
    //                }
    //                
    //           }
    //            //hiddenbrand.Value=drpbrand.SelectedValue = executequery.Tables[0].Rows[0].ItemArray[21].ToString();
    //            if (executequery.Tables[0].Rows[rownumEx].Brand_code==null || executequery.Tables[0].Rows[rownumEx].Brand_code.toString() == "")
    //            {
    //                document.getElementById('drpbrand').options.length=0;
    //                document.getElementById('hiddenbrand').value = "";
    //            }
    //            else
    //            {
    //                if(executequery.Tables[0].Rows[rownumEx].Brand_code!=null)
    //                {
    //                    document.getElementById('hiddenbrand').value = document.getElementById('drpbrand').value = executequery.Tables[0].Rows[rownumEx].Brand_code.toString();
    //                }    
    //            }
    //            ////////////////////this is to bind the varient dropdown

    //          
    //            ////////////////////////////////////////////////////////////////////////////////
    //            if(executequery.Tables[0].Rows[rownumEx].Key_no!=null)
    //            {
    //                document.getElementById('txtkeyno').value = executequery.Tables[0].Rows[rownumEx].Key_no;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_remarks!=null)
    //            {
    //                document.getElementById('txtbillremark').value = executequery.Tables[0].Rows[rownumEx].Bill_remarks;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Print_remark!=null)
    //            {
    //                document.getElementById('txtprintremark').value = executequery.Tables[0].Rows[rownumEx].Print_remark;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Package_code!=null)
    //            {
    //                var listpck = executequery.Tables[0].Rows[rownumEx].Package_code;
    //            document.getElementById('hiddenpackage').value = listpck;
    //            //////////////////this is to bind the package grid on what the value is saved in the database


    //            res2=null;
    //            res2=Classified_Booking.bindpacforexe(document.getElementById('hiddencompcode').value, listpck);
    //            var dsexecut = res2.value;
    //            if(dsexecut==null)
    //            {
    //                alert(res2.error.description);
    //                return false;
    //            }
    //                 
    //           
    //            
    //            
    //            document.getElementById('drppackagecopy').options.length=0;
    //            for (i = 0; i <= dsexecut.Tables[0].Rows.length - 1; i++)
    //            {
    //                if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "")
    //                {
    //                    if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "0")
    //                    {
    //                        var arrfor_uom = dsexecut.Tables[0].Rows[i].pck_code.toString().split('@');
    //                        var res3=Classified_Booking.getPackageInsert(arrfor_uom[0].toString(), document.getElementById('txtciobookid').value);
    //                        var dsinsert = res3.value;
    //                        if(dsinsert==null)
    //                        {
    //                            alert(res3.error.description);
    //                            return false;
    //                        }
    //                        var T=dsexecut.Tables[0].Rows[i].Package_Name + "(" + dsinsert.Tables[0].Rows[0].inserts + ")";
    //                        var V=dsexecut.Tables[0].Rows[i].pck_code + "(" + dsinsert.Tables[0].Rows[0].inserts + ")";
    //                        document.getElementById('drppackagecopy').options[document.getElementById('drppackagecopy').options.length] = new Option(T,V);
    //                
    //                        document.getElementById('drppackagecopy').options.length;   
    //                    
    ////                        ListItem li;
    ////                        li = new ListItem();
    ////                        li.Text = dsexecut.Tables[0].Rows[i].ItemArray[1].ToString() + "(" + dsinsert.Tables[0].Rows[0].ItemArray[0].ToString() + ")";
    ////                        li.Value = dsexecut.Tables[0].Rows[i].ItemArray[2].ToString() + "(" + dsinsert.Tables[0].Rows[0].ItemArray[0].ToString() + ")"; ;
    ////                        //state = ds.Tables[0].Rows[i].ItemArray[2].ToString();
    ////                        drppackagecopy.Items.Add(li);

    //                    }
    //                }
    //            }

    //        }
    //                
    //            if(executequery.Tables[0].Rows[rownumEx].No_of_insertion!=null)
    //            {
    //                document.getElementById('txtinsertion').value = executequery.Tables[0].Rows[rownumEx].No_of_insertion;
    //                document.getElementById('hiddeninsertion').value = executequery.Tables[0].Rows[rownumEx].No_of_insertion;
    //            }   
    //            
    //            var start_date = executequery.Tables[0].Rows[rownumEx].Insertion_date;
    //            if(start_date!=null)
    //            {
    //                document.getElementById('txtdummydate').value = start_date;//getdatechk.getDate(dateformat, start_date);
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Repeating_day!=null)
    //            {
    //                document.getElementById('txtrepeatingdate').value = executequery.Tables[0].Rows[rownumEx].Repeating_day;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Booking_type!=null)
    //            {
    //                document.getElementById('drpbooktype').value = executequery.Tables[0].Rows[rownumEx].Booking_type;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Ad_cat_code!=null)
    //            {
    //                document.getElementById('drpadcategory').value = executequery.Tables[0].Rows[rownumEx].Ad_cat_code;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Ad_sub_cat_code!=null)
    //            {
    //                document.getElementById('drpadsubcategory').value = executequery.Tables[0].Rows[rownumEx].Ad_sub_cat_code;
    //            }
    //            if(executequery.Tables[0].Rows[rownumEx].Color_code!=null)
    //            {
    //                document.getElementById('drpcolor').value = executequery.Tables[0].Rows[rownumEx].Color_code;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Uom_code!=null)
    //            {
    //                document.getElementById('drpuom').value = executequery.Tables[0].Rows[rownumEx].Uom_code;
    //            }    
    //            //*25Aug* 
    //            res3=null;
    //            res3 = Classified_Booking.gettheuom_desc(document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[rownumEx].Uom_code);  
    //            var ds_uom_=res3.value;
    //            if(ds_uom_==null)
    //            {
    //                alert(res3.error.description);
    //                return false;
    //            }
    //            if(ds_uom_.Tables[0].Rows.length>0)
    //            {
    //                document.getElementById('hiddenuomdesc').value = ds_uom_.Tables[0].Rows[0].uom_desc;   
    //            }
    //                
    //                
    //                //*25Aug*
    //            if(executequery.Tables[0].Rows[rownumEx].Page_position_code!=null)
    //            {
    //                document.getElementById('drppageposition').value = executequery.Tables[0].Rows[rownumEx].Page_position_code;
    //             }   
    //       
    //            //string adtype=drpadstype.SelectedValue;
    //            if(executequery.Tables[0].Rows[rownumEx].Ad_size_height!=null)
    //            {
    //                document.getElementById('txtadsize1').value = executequery.Tables[0].Rows[rownumEx].Ad_size_height;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Ad_size_width!=null)
    //            {
    //                document.getElementById('txtadsize2').value = executequery.Tables[0].Rows[rownumEx].Ad_size_width;
    //            }    
    //            ////this is to bind the ratecode drpdown
    //            res3=null
    //            if(executequery.Tables[0].Rows[rownumEx].Ad_cat_code!=null)
    //            {
    //            res3=Classified_Booking.ratebind(executequery.Tables[0].Rows[rownumEx].Ad_cat_code, document.getElementById('hiddencompcode').value);
    //            var dx = res3.value;
    //            if(dx==null)
    //            {   
    //                alert(dx.error.description);
    //                return false;
    //            }
    //             
    //            
    //            

    //              document.getElementById('txtratecode').options.length=0;
    //              document.getElementById('txtratecode').options[0]=new Option("-Select Rate Code-","0");
    //              document.getElementById('txtratecode').options.length = 1; 
    //            
    //             for (var i = 0  ; i < dx.Tables[0].Rows.length; ++i)
    //                {
    //                    document.getElementById('txtratecode').options[document.getElementById('txtratecode').options.length] = new Option(dx.Tables[0].Rows[i].rate_mast_code,dx.Tables[0].Rows[i].rate_mast_code);
    //                
    //                    document.getElementById('txtratecode').options.length;       
    //                }
    //                
    //           }
    //           if(executequery.Tables[0].Rows[rownumEx].Rate_code!=null)
    //           {
    //                document.getElementById('txtratecode').value = executequery.Tables[0].Rows[rownumEx].Rate_code;
    //           }    
    //            if(executequery.Tables[0].Rows[rownumEx].Scheme_type_code!=null)
    //            {
    //                document.getElementById('drpscheme').value = executequery.Tables[0].Rows[rownumEx].Scheme_type_code;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Scheme_type_code!=null)
    //            { 
    //                document.getElementById('hiddenscheme').value = executequery.Tables[0].Rows[rownumEx].Scheme_type_code;
    //            }    
    //     //       drpschemepck.SelectedValue = executequery.Tables[0].Rows[0].ItemArray[41].ToString();
    //            if(executequery.Tables[0].Rows[rownumEx].Currency_code!=null)
    //            {
    //                document.getElementById('drpcurrency').value = executequery.Tables[0].Rows[rownumEx].Currency_code;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Agrred_rate!=null)
    //            {
    //                document.getElementById('txtagreedrate').value = executequery.Tables[0].Rows[rownumEx].Agrred_rate;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Agreed_amount!=null)
    //            {
    //                document.getElementById('txtagreedamt').value = executequery.Tables[0].Rows[rownumEx].Agreed_amount;
    //            }    
    //    
    //            if(executequery.Tables[0].Rows[rownumEx].Special_charges!=null)
    //            {
    //                document.getElementById('txtextracharges').value = executequery.Tables[0].Rows[rownumEx].Special_charges;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_status!=null)
    //            {
    //                document.getElementById('hiddenstatus').value = document.getElementById('txtagencystatus').value = executequery.Tables[0].Rows[rownumEx].Agency_status;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_type!=null)
    //            {
    //                document.getElementById('txtagencytype').value = executequery.Tables[0].Rows[rownumEx].Agency_type;
    //            }    
    //            //this is To the bind the the agencypaymode dropdown on execution
    //            res3=null;
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_sub_code!=null)
    //            {
    //            res3=Classified_Booking.getstatuspaymode(executequery.Tables[0].Rows[rownumEx].Agency_sub_code, executequery.Tables[0].Rows[rownumEx].Agency_code, document.getElementById('hiddencompcode').value, document.getElementById('txtdatetime').value,document.getElementById('hiddendateformat').value,"CL0");
    //            var dch = res3.value;
    //            if(dch==null)
    //            {
    //                alert(res3.error.description);
    //                return false;
    //            }
    //            
    //            

    //            document.getElementById('txtagencypaymode').options.length=0;
    //            if (dch.Tables[5].Rows.length > 0)
    //            {
    //                for (var i = 0; i < dch.Tables[5].Rows.length; i++)
    //                {
    //                    document.getElementById('txtagencypaymode').options[document.getElementById('txtagencypaymode').options.length] = new Option(dch.Tables[5].Rows[i].payment_mode_name,dch.Tables[5].Rows[i].pay_mode_code);
    //                
    //                    document.getElementById('txtagencypaymode').options.length; 
    //                   
    //                }

    //            }
    //           } 
    //            ///////////////////////////////////////////////////////////////////////////////////////////////////
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_pay!=null)
    //            {
    //                document.getElementById('hiddenpay').value =  document.getElementById('txtagencypaymode').value = executequery.Tables[0].Rows[rownumEx].Agency_pay;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_credit!=null)
    //            {
    //                document.getElementById('txtcreditperiod').value = executequery.Tables[0].Rows[rownumEx].Agency_credit;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Total_area!=null)
    //            {
    //                document.getElementById('txttotalarea').value = executequery.Tables[0].Rows[rownumEx].Total_area;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Card_rate!=null)
    //            {
    //                document.getElementById('txtcardrate').value = executequery.Tables[0].Rows[rownumEx].Card_rate;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Card_amount!=null)
    //            {
    //                document.getElementById('txtcardamt').value = executequery.Tables[0].Rows[rownumEx].Card_amount;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Discount!=null)
    //            {
    //                document.getElementById('txtdiscount').value = executequery.Tables[0].Rows[rownumEx].Discount;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Discount_per!=null)
    //            {
    //                document.getElementById('txtdiscpre').value = executequery.Tables[0].Rows[rownumEx].Discount_per;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_cycle!=null)
    //            {
    //                document.getElementById('drpbillcycle').value = executequery.Tables[0].Rows[rownumEx].Bill_cycle;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Revenue_center!=null)
    //            {
    //                document.getElementById('drprevenue').value = executequery.Tables[0].Rows[rownumEx].Revenue_center;
    //            }    

    //            ////this is to bind the bill pay mode
    //            document.getElementById('drppaymenttype').options.length=0;
    //            if (dch.Tables[5].Rows.length > 0)
    //            {
    //                for (var i = 0;  i< dch.Tables[5].Rows.length; i++)
    //                {
    //                   document.getElementById('drppaymenttype').options[document.getElementById('drppaymenttype').options.length] = new Option(dch.Tables[5].Rows[i].payment_mode_name,dch.Tables[5].Rows[i].pay_mode_code);
    //                
    //                    document.getElementById('drppaymenttype').options.length; 
    //                }

    //            }
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_pay!=null)
    //            {    
    //                document.getElementById('hiddenbillpay').value = document.getElementById('drppaymenttype').value = executequery.Tables[0].Rows[rownumEx].Bill_pay;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_height!=null)
    //            {
    //                document.getElementById('txtbillheight').value = executequery.Tables[0].Rows[rownumEx].Bill_height;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_width!=null)
    //            {
    //                document.getElementById('txtbillwidth').value = executequery.Tables[0].Rows[rownumEx].Bill_width;
    //            }    
    //            //////////////this is to bind the bill to 
    //            res3=null;
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_sub_code!=null)
    //            {
    //            res3=Classified_Booking.getbillval(executequery.Tables[0].Rows[rownumEx].Agency_sub_code, document.getElementById('hiddencompcode').value);
    //            var dbt = res3.value;
    //            if(dbt==null)
    //            {
    //                alert(res3.error.description);
    //                return false;
    //            }
    //           
    //            
    //            ////////////////////////////////////////////////////
    //            document.getElementById('drpbillto').options.length=0;
    //            document.getElementById('drpbillto').options[0] = new Option("Client","client");
    //            
    //            for (var k = 0; k < dbt.Tables[0].Rows.length; k++)
    //            {
    //                 document.getElementById('drpbillto').options[document.getElementById('drpbillto').options.length] = new Option(dbt.Tables[0].Rows[k].agency_name,dbt.Tables[0].Rows[k].bill_to);
    //                
    //                 document.getElementById('drpbillto').options.length; 
    //            }
    //            }
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_to!=null)
    //            {
    //                document.getElementById('hiddenbillto').value = executequery.Tables[0].Rows[rownumEx].Bill_to;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_to!=null)
    //            {
    //                document.getElementById('drpbillto').value = executequery.Tables[0].Rows[rownumEx].Bill_to;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Invoices!=null)
    //            {
    //                document.getElementById('txtinvoice').value = executequery.Tables[0].Rows[rownumEx].Invoices;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Vts!=null)
    //            {
    //                document.getElementById('txtvts').value = executequery.Tables[0].Rows[rownumEx].Vts;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bill_add!=null)
    //            {
    //                document.getElementById('txtbilladdress').value = executequery.Tables[0].Rows[rownumEx].Bill_add;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Trade_disc!=null)
    //            {
    //                document.getElementById('txttradedisc').value = executequery.Tables[0].Rows[rownumEx].Trade_disc;
    //            }
    //            if(executequery.Tables[0].Rows[rownumEx].Agency_out!=null)
    //            {
    //                document.getElementById('txtagencyoutstand').value = executequery.Tables[0].Rows[rownumEx].Agency_out;
    //            }    
    //            
    //            if(executequery.Tables[0].Rows[rownumEx].Page_amount!=null)
    //            {
    //                document.getElementById('txtpageamt').value = executequery.Tables[0].Rows[rownumEx].Page_amount;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Gross_amount!=null)
    //            {
    //                document.getElementById('txtgrossamt').value = executequery.Tables[0].Rows[rownumEx].Gross_amount;
    //            }    

    //            //Inserting in hidden field to compare new and  Previous amount 
    //            if(executequery.Tables[0].Rows[rownumEx].Gross_amount!=null)
    //            {
    //                document.getElementById('hiddenprevamt').value = executequery.Tables[0].Rows[rownumEx].Gross_amount;
    //            }   

    //            if(executequery.Tables[0].Rows[rownumEx].Bill_amount!=null)
    //            {
    //                document.getElementById('txtbillamt').value = executequery.Tables[0].Rows[rownumEx].Bill_amount;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Box_code!=null)
    //            {
    //                document.getElementById('drpboxcode').value = executequery.Tables[0].Rows[rownumEx].Box_code;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Box_no!=null)
    //            {
    //                document.getElementById('txtboxno').value = executequery.Tables[0].Rows[rownumEx].Box_no;
    //            }    
    //            if (executequery.Tables[0].Rows[rownumEx].Box_agency.toString() == "1")
    //            {
    //                document.getElementById('chkage').checked = true;
    //            }
    //            else
    //            {
    //                document.getElementById('chkage').checked = false;
    //            }
    //            if (executequery.Tables[0].Rows[rownumEx].Box_client.toString() == "1")
    //            {
    //                document.getElementById('chkclie').checked = true;
    //            }
    //            else
    //            {
    //                document.getElementById('chkclie').checked = false;
    //            }
    //            if(executequery.Tables[0].Rows[rownumEx].Box_address!=null)
    //            {
    //                document.getElementById('txtboxaddress').value = executequery.Tables[0].Rows[rownumEx].Box_address;
    //            }    
    //            if (executequery.Tables[0].Rows[rownumEx].Tfn == "1")
    //            {
    //                document.getElementById('chktfn').value = true;
    //            }
    //            else
    //            {
    //                document.getElementById('chktfn').value= false;
    //            }
    //            if(executequery.Tables[0].Rows[rownumEx].Ad_size_column!=null)
    //            {
    //                document.getElementById('txtcolum').value = executequery.Tables[0].Rows[rownumEx].Ad_size_column;
    //            }   
    //            if(executequery.Tables[0].Rows[rownumEx].Paid_ins!=null)
    //            {          
    //                document.getElementById('txtpaid').value = executequery.Tables[0].Rows[rownumEx].Paid_ins;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Contract_rate!=null)
    //            {
    //                document.getElementById('txtdealrate').value = executequery.Tables[0].Rows[rownumEx].Contract_rate;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Deviation!=null)
    //            {
    //                document.getElementById('txtdeviation').value = executequery.Tables[0].Rows[rownumEx].Deviation;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Contract_name!=null)
    //            {          
    //                document.getElementById('txtcontractname').value = executequery.Tables[0].Rows[rownumEx].Contract_name;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Contract_type!=null)
    //            {
    //                document.getElementById('txtcontracttype').value = executequery.Tables[0].Rows[rownumEx].Contract_type;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Card_name!=null)
    //            {
    //                document.getElementById('txtcardname').value = executequery.Tables[0].Rows[rownumEx].Card_name;
    //             }   
    //             if(executequery.Tables[0].Rows[rownumEx].Card_type!=null)
    //             {
    //                document.getElementById('drptype').value = executequery.Tables[0].Rows[rownumEx].Card_type;
    //             }   
    //             if(executequery.Tables[0].Rows[rownumEx].Card_month!=null)
    //             {
    //                document.getElementById('drpmonth').value = executequery.Tables[0].Rows[rownumEx].Card_month;
    //             }   
    //             if(executequery.Tables[0].Rows[rownumEx].Card_year!=null)
    //             {
    //                document.getElementById('drpyear').value = executequery.Tables[0].Rows[rownumEx].Card_year;
    //             }   
    //             if(executequery.Tables[0].Rows[rownumEx].Card_number!=null)
    //             {
    //                document.getElementById('txtcardno').value = executequery.Tables[0].Rows[rownumEx].Card_number;
    //             }   
    //            if(executequery.Tables[0].Rows[rownumEx].Receipt_no!=null)
    //            { 
    //                document.getElementById('hiddenreceiptno').value =  document.getElementById('txtreceipt').value = executequery.Tables[0].Rows[rownumEx].Receipt_no;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Material_status!=null)
    //            {
    //                document.getElementById('drpmatstat').value = executequery.Tables[0].Rows[rownumEx].Material_status;
    //            }    

    //            ////this is to bind the adscat3 drpdown



    //            if (executequery.Tables[0].Rows[rownumEx].Ad_Subcat3!=null || executequery.Tables[0].Rows[rownumEx].Ad_Subcat3.toString() == "")
    //            {
    //                document.getElementById('drpadcat3').options.length=0;
    //                document.getElementById('hiddenadscat3').value = "";

    //            }
    //            else
    //            {
    //                res3=null;
    //                res3=Classified_Booking.getvalfromadcat3(executequery.Tables[0].Rows[rownumEx].Ad_sub_cat_code,document.getElementById('hiddencompcode').value,"0");
    //                var dacat = res3.value;
    //                if(dacat==null)
    //                {
    //                    alert(dacat.error.description);
    //                    return false;
    //                }

    //               
    //                ////////////////////////////////////////////////////////////////
    //               document.getElementById('drpadcat3').options.length=0;
    //               document.getElementById('drpadcat3').options[0]=new Option("Select","0");
    //                for (var k = 0; k < dacat.Tables[0].Rows.length; k++)
    //                {
    //                     document.getElementById('drpadcat3').options[document.getElementById('drpadcat3').options.length] = new Option(dacat.Tables[0].Rows[k].catname,dacat.Tables[0].Rows[k].catcode);
    //                    
    //                     document.getElementById('drpadcat3').options.length; 
    //                }


    //            }
    //           
    //                if(executequery.Tables[0].Rows[0].Ad_Subcat3!=null)
    //                {
    //                    document.getElementById('hiddenadscat3').value = document.getElementById('drpadcat3').value = executequery.Tables[0].Rows[rownumEx].Ad_Subcat3;
    //                }    
    //           
    //            ////////////////////this is to bind the adcat4 drp down
    //            if (executequery.Tables[0].Rows[rownumEx].Ad_Subcat4 == null || executequery.Tables[0].Rows[rownumEx].Ad_Subcat4.toString() == "")
    //            {
    //                document.getElementById('drpadcat4').options.length=0;
    //                document.getElementById('hiddenadscat4').value = "";

    //            }
    //            else
    //            {
    //                ////////////when 1 than bind the adscat4 drp down
    //                res3=null;
    //                res3=Classified_Booking.getvalfromadcat3(executequery.Tables[0].Rows[rownumEx].Ad_Subcat3,document.getElementById('hiddencompcode').value,"1");
    //                var dacat = res3.value;
    //                if(dacat==null)
    //                {
    //                    alert(dacat.error.description);
    //                    return false;
    //                }

    //               
    //                ////////////////////////////////////////////////////////////////
    //               document.getElementById('drpadcat4').options.length=0;
    //               document.getElementById('drpadcat4').options[0]=new Option("Select","0");
    //                for (var k = 0; k < dacat.Tables[0].Rows.length; k++)
    //                {
    //                     document.getElementById('drpadcat4').options[document.getElementById('drpadcat4').options.length] = new Option(dacat.Tables[0].Rows[k].Cat_Name,dacat.Tables[0].Rows[k].Cat_Code);
    //                    
    //                     document.getElementById('drpadcat4').options.length; 
    //                }

    //            }
    //          
    //                document.getElementById('hiddenadscat4').value = document.getElementById('drpadcat4').value = executequery.Tables[0].Rows[rownumEx].Ad_Subcat4;
    //          
    //            ///bind adcat5 drpdown
    //            if (executequery.Tables[0].Rows[rownumEx].Ad_subcat5==null || executequery.Tables[0].Rows[rownumEx].Ad_subcat5.toString() == "")
    //            {
    //                document.getElementById('drpadcat5').options.length=0;
    //                document.getElementById('hiddenadscat5').value = "";
    //            }
    //            else
    //            {
    //                ////////////when 1 than bind the adscat4 drp down

    //               res3=null;
    //                res3=Classified_Booking.getvalfromadcat3(executequery.Tables[0].Rows[rownumEx].Ad_Subcat4,document.getElementById('hiddencompcode').value,"2");
    //                var dacat = res3.value;
    //                if(dacat==null)
    //                {
    //                    alert(dacat.error.description);
    //                    return false;
    //                }

    //               
    //                ////////////////////////////////////////////////////////////////
    //               document.getElementById('drpadcat5').options.length=0;
    //               document.getElementById('drpadcat5').options[0]=new Option("Select","0");
    //                for (var k = 0; k < dacat.Tables[0].Rows.length; k++)
    //                {
    //                     document.getElementById('drpadcat5').options[document.getElementById('drpadcat5').options.length] = new Option(dacat.Tables[0].Rows[k].Cat_Name,dacat.Tables[0].Rows[k].Cat_Code);
    //                    
    //                     document.getElementById('drpadcat5').options.length; 
    //                }
    //            }
    //            document.getElementById('hiddenadscat5').value = document.getElementById('drpadcat5').value = executequery.Tables[0].Rows[rownumEx].Ad_subcat5;


    //            //////bind the bg color drp down 
    //            if(executequery.Tables[0].Rows[rownumEx].Bg_color!=null)
    //            {
    //                document.getElementById('drpbgcolor').value = executequery.Tables[0].Rows[rownumEx].Bg_color;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bullet_code!=null)
    //            {
    //                document.getElementById('drpbullet').value = executequery.Tables[0].Rows[rownumEx].Bullet_code;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].Bullet_premium!=null)
    //            {
    //                document.getElementById('txtbullprem').value = executequery.Tables[0].Rows[rownumEx].Bullet_premium;
    //            }   
    //            /* *14Aug*
    //            if (drpretainer.Items.FindByValue(executequery.Tables[0].Rows[0].ItemArray[134].ToString()) != null)
    //            {
    //                drpretainer.SelectedValue = executequery.Tables[0].Rows[0].ItemArray[134].ToString();
    //            } */
    //            if(executequery.Tables[0].Rows[rownumEx].RETAINER1!=null)
    //            {
    //                document.getElementById('drpretainer').value = executequery.Tables[0].Rows[rownumEx].RETAINER1;
    //            }    
    //            if(executequery.Tables[0].Rows[rownumEx].ADD_AGENCY_COMM!=null)
    //            {
    //             if(document.getElementById('txtaddagencycommrate')!=null)
    //             {
    //                document.getElementById('txtaddagencycommrate').value = executequery.Tables[0].Rows[rownumEx].ADD_AGENCY_COMM;
    //             }   
    //            }   
    //          
    //            //grid
    //       
    //        showcardinfo(executequery.Tables[0].Rows[rownumEx].Bill_pay);
    //        showgridexecute();
    //        updateStatus();
    //        document.getElementById('btnfirst').disabled = false;
    //        document.getElementById('btnprevious').disabled = false;
    //        document.getElementById('btnlast').disabled = true;
    //        document.getElementById('btnnext').disabled = true;
    //        if (document.getElementById('hiddenuomdesc').value == "ROD")
    //        {
    //            if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtcolum').value != "")
    //            {
    //                document.getElementById('txtadsize2').disabled =true;
    //                document.getElementById('txtadsize1').style.backgroundColor="#FFFFFF";
    //                document.getElementById('txtadsize2').style.backgroundColor="#FFFFFF";
    //                document.getElementById('txtcolum').style.backgroundColor="#FFFFFF";

    //            }
    //            else if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtadsize2').value != "")
    //            {
    //                document.getElementById('txtcolum').disabled=true;
    //                document.getElementById('txtadsize1').style.backgroundColor="#FFFFFF";
    //                document.getElementById('txtadsize2').style.backgroundColor="#FFFFFF";
    //                document.getElementById('txtcolum').style.backgroundColor="#FFFFFF";

    //            }


    //        }
    //        else if (document.getElementById('hiddenuomdesc').value != "CD")
    //        {
    //            document.getElementById('txtadsize1').disabled=true;
    //            document.getElementById('txtadsize2').disabled = true;
    //            if (document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROD")
    //            {
    //                document.getElementById('Label1').innerHTML = "No. Of Lines";
    //                document.getElementById('txtadsize1').style.backgroundColor = "#999999";
    //                document.getElementById('txtadsize2').style.backgroundColor = "#999999";
    //                document.getElementById('txtcolum').style.backgroundColor = "#999999";


    //            }
    //            else if (drpuom.SelectedItem.Text == "ROW")
    //            {
    //                document.getElementById('Label1').innerHTML = "No. Of Words";
    //                document.getElementById('txtadsize1').style.backgroundColor = "#999999";
    //                document.getElementById('txtadsize2').style.backgroundColor = "#999999";
    //                document.getElementById('txtcolum').style.backgroundColor = "#999999";
    //            }

    //        }  
    //       
    //       
    //          
    //        return false;
}
function saveClick() {
document.getElementById("divloader").style.display = "block";
    document.getElementById('divloader').style.top = "250px";
    document.getElementById('divloader').style.left = "250px";
    
    var msg = checkSession();
    if (msg == false) {
        window.location.href = "login.aspx";
        return false;
    }
    var doctype = "";
    if (document.getElementById('hiddenorigbranch').value != document.getElementById('txtbranch').value) {
        alert("Booking Modification can't be done by diffrent branch");
        //return false;
    }
    if (document.getElementById('drppaymenttype').value == 'CA0' || document.getElementById('drppaymenttype').value == 'CH0' || document.getElementById('drppaymenttype').value == "CR4")
        doctype = "RCP";
    else if (document.getElementById('drppaymenttype').value == 'PO0')
        doctype = "PDC";
    else if (document.getElementById('drppaymenttype').value == 'AD0')
        doctype = "ACR";
    //dan
    var strtextd = "";
    var httpRequest = null;
    httpRequest = new XMLHttpRequest();
    if (httpRequest.overrideMimeType) {
        httpRequest.overrideMimeType('text/xml');
    }
    //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };

    httpRequest.open("GET", "checksessiondan.aspx", false);
    httpRequest.send('');
    //alert(httpRequest.readyState);
    if (httpRequest.readyState == 4) {
        //alert(httpRequest.status);
        if (httpRequest.status == 200) {
            strtextd = httpRequest.responseText;
        }
        else {
            //alert('There was a problem with the request.');
            if (browser != "Microsoft Internet Explorer") {
                //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
            }
        }
    }
    if (strtextd != "sess") {
        alert('session expired');
        window.location.href = "Default.aspx";
        return false;
    }
    if (document.getElementById('txtbillamt').value != "") {

        var cioid212 = "";
        var modflg212 = "";
        if (document.getElementById('hiddensavemod').value == "01") {
            cioid212 = document.getElementById('txtciobookid').value;
            modflg212 = "M";
        }
        else {
            cioid212 = "";
            modflg212 = "N";
        }
    }
    if (document.getElementById('txtagencyoutstand').value != "" && document.getElementById('txtagencyoutstand').value != "0" && document.getElementById('txtbillamt').value != "" && document.getElementById('hiddenbillamt').value != "") {
        var datetimecredit = document.getElementById('txtdatetime').value;
        var dateformat = document.getElementById('hiddendateformat').value
        var agcodeforcreadit = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.lastIndexOf(')'));
        var credit = Classified_Booking.CHECKBOOKINGCREDITLIMIT(document.getElementById('hiddencompcode').value, agcodeforcreadit, document.getElementById('txtagencyoutstand').value, document.getElementById('txtbillamt').value, datetimecredit, dateformat, cioid212, modflg212);
        var creditda = credit.value;
        if (creditda == null) {
            alert(credit.error.description);
            return false;
        }
        if (creditda.Tables[0].Rows[0].Message1 == "FALSE") {
            alert("Creadit Limit Exceeded");
            return false;
        }
        //alert for showing how much amount used
        else if (creditda.Tables[0].Rows[0].Message1 == "TRUE") {
            if (creditda.Tables[0].Rows[0].Message2 != null) {
                alert(creditda.Tables[0].Rows[0].Message2)
            }
        }



    }
    var prev_cioid = "";
    var prev_receipt = "";
    var prev_ga = 0;
    var srtcancel = "0";
    var auditstatus = "";
    document.getElementById('hiddenclientname').value = document.getElementById('txtclient').value;
    // autogenerated("3");
    if ((document.getElementById('txtagencypaymode').value == "CA0" || document.getElementById('txtagencypaymode').value == "DD0" || document.getElementById('txtagencypaymode').value == "CH0") && document.getElementById('drprostatus').value == "1") {
        if (document.getElementById('hiddenprevamt').value != "" && document.getElementById('hiddenprevamt').value != null) {
            if (parseFloat(document.getElementById('hiddenprevamt').value) != parseFloat(document.getElementById('txtbillamt').value)) {

                if (parseFloat(document.getElementById('hiddenprevamt').value) > parseFloat(document.getElementById('txtbillamt').value)) {
                    doctype = "CA";
                }
                cioprevgst = document.getElementById('txtciobookid').value;
                prev_cioid = document.getElementById('txtciobookid').value;
                prev_receipt = document.getElementById('txtreceipt').value;
                prev_receipt = document.getElementById('hiddenreceiptno').value;
                prev_ga = (parseFloat(document.getElementById('txtgrossamt').value) - parseFloat(document.getElementById('hiddenprevamt').value));
                document.getElementById('hiddensavemod').value = "0";
                // autogenerated("0");
                autogeneratedtempid();
                // if(document.getElementById('hiddenprint_rec').value == "Y")
                if (document.getElementById('txtagencypaymode').value == "CA0" || (document.getElementById('txtagencypaymode').value == "CR1" && document.getElementById('creditreceipt_allow').value == "Y")) // for credit 
                    autogenerated("3");
                srtcancel = "1";
                modifyMatter = 0;
            }
        }

    }

    if (document.getElementById('hiddenauditsession').value == "n") {
        if (document.getElementById('txtcardamt').value != document.getElementById('txtagreedamt').value)
            auditstatus = "Not Approved";
        else
            auditstatus = "Approved";
    }
    else {
        auditstatus = "Not Approved";
    }

    //splitting of date
    var chkgstinc="1";
    if (document.getElementById('chkgstinc').checked == true)
            chkgstinc = "1";
        else
            chkgstinc = "0";
    var branch = document.getElementById('txtbranch').value;
    var booked_by = document.getElementById('txtbookedby').value;
    var prevbook = document.getElementById('txtprevbook').value;
    var res = Classified_Booking.getdateCHK(document.getElementById('hiddendateformat').value, document.getElementById('txtdatetime').value);
    if (res.error != null) {
        alert(res.error.description);
        return false;
    }
    var date_time = document.getElementById('txtdatetime').value = res.value;
    var ciobookid = document.getElementById('txtciobookid').value;

    //string approvedby=txtappby.Text;B
    //string audit=txtaudit.Text;
    var approvedby = "";
    var audit = "";
    var rono = document.getElementById('txtrono').value;

    var rodate = "";
    if (document.getElementById('txtrodate').value != "") {
        res = null;
        res = Classified_Booking.getdateCHK(document.getElementById('hiddendateformat').value, document.getElementById('txtrodate').value);
        if (res.error != null) {
            alert(res.error.description);
            return false;
        }
        rodate = document.getElementById('txtrodate').value = res.value;
    }
    rodate = document.getElementById('txtrodate').value;
    //string caption = txtcaption.Text;
    var billstatus = document.getElementById('drpbillstatus').value;
    var rostatus = document.getElementById('drprostatus').value;
    var agencycod = document.getElementById('txtagency').value;
    //////////////this is to split the  and get the code
    agencycode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.length + document.getElementById('txtagency').value.lastIndexOf('('));
    agencycode = agencycode.replace(")", "");
    document.getElementById('hiddenagency').value = agencycode;
    ////////////////////////////////////

    var representative = document.getElementById('txtcolexec').value.substring(document.getElementById('txtcolexec').value.lastIndexOf('(') + 1, document.getElementById('txtcolexec').value.lastIndexOf(')'));
    var clientcode = document.getElementById('txtclient').value;
    var client;
    ///this is to split and get the client code

    if (clientcode.lastIndexOf("(".toString()) > 0) {
        //clientcode.IndexOf(
        //char[] splitterclie = { '(' };
        var myarray1 = clientcode.split('(');

        client = myarray1[1];
        client = client.replace(")", '');

        /////this is to chk whether this code exixts in the database if exists than it is a register client else
        ///it is walkinn client
        ///
        res = null;
        res = Classified_Booking.chkwalkinClient(client, document.getElementById('hiddencompcode').value);
        var dcl = res.value;
        if (dcl == null) {
            alert(res.error.description);
            return false;
        }
        if (dcl.Tables[0].Rows.length > 0) {

        }
        else {
            client = clientcode;
        }

    }
    else {

        client = clientcode;
    }
    /////////////////////////////////////////////
    var agencyaddress = document.getElementById('txtagencyaddress').value;
    var clientaddresses = document.getElementById('txtclientadd').value;
    var agency = document.getElementById('drpagscode').value;
    agency = document.getElementById('hiddensubcode').value;
    var dockitno = document.getElementById('txtdockitno1').value;
    var execnamecode = document.getElementById('txtexecname').value;
    //execnamecode = hiddenzone.Value;

    //char[] splitterex = { '(' };
    var execname = "";
    if (execnamecode != "") {
        execname = execnamecode.substring(execnamecode.lastIndexOf('(') + 1, execnamecode.length + execnamecode.lastIndexOf('('));
        execname = execname.replace(")", "");

    }
    var execzone = document.getElementById('txtexeczone').value;
    //execzone = document.getElementById('hiddenzone').value;
    var productcode = document.getElementById('drpproductcat').value;
    var myarraypr;
    var product;
    if (productcode != "") {
//        myarraypr = productcode.split('(');
//        product = myarraypr[1];
        //        product = product.replace(")", "");
        product = document.getElementById('drpproductcat').value;
    }
    else {
        product = "";
    }

    var brand = document.getElementById('drpbrand').value.substring(document.getElementById('drpbrand').value.lastIndexOf('(') + 1, document.getElementById('drpbrand').value.lastIndexOf(')'));
    if(document.getElementById('drpbrand').value.lastIndexOf('(')>0)
    {
        brand = document.getElementById('hiddenbrand').value.substring(document.getElementById('hiddenbrand').value.lastIndexOf('(') + 1, document.getElementById('hiddenbrand').value.lastIndexOf(')'));
    }
    else
    {
        brand = document.getElementById('hiddenbrand').value;// .substring(document.getElementById('hiddenbrand').value.lastIndexOf('(') + 1, document.getElementById('hiddenbrand').value.lastIndexOf(')'));
    }
    var keyno = document.getElementById('txtkeyno').value;
    var billremark = document.getElementById('txtbillremark').value;
    var printremark = document.getElementById('txtprintremark').value;
    var package; //=drppackage.SelectedValue;
    package = document.getElementById('hiddenpackage').value;
    var insertion = document.getElementById('txtinsertion').value;


    var startdate = "";
    if (document.getElementById('txtdummydate').value != "") {
        res = null;
        res = Classified_Booking.getdateCHK(document.getElementById('hiddendateformat').value, document.getElementById('txtdummydate').value);
        if (res.error != null) {
            alert(res.error.description);
            return false;
        }
        startdate = res.value;
    }
    else {
        startdate = "";
    }
    var repeatdateI = document.getElementById('txtrepeatingdate').value;
    //string adtype=drpbooktype.SelectedValue;
    var adtype = "CL0";
    var bookingtype = document.getElementById('drpbooktype').value;
    var adcategory = document.getElementById('drpadcategory').value;
    var subcategory = document.getElementById('drpadsubcategory').value;
    var color = document.getElementById('drpcolor').value;
    var uom = document.getElementById('drpuom').value;
    var pageposition = document.getElementById('drppageposition').value;
    //string pagetype = drppagetype.SelectedValue;
    var pagetype = "";
    //string pageno = txtpageno.Text;
    var pageno = "";
    //string adtype=drpadstype.SelectedValue;
    var adsizheight = document.getElementById('txtadsize1').value;
    var adsizwidth = document.getElementById('txtadsize2').value;
    var ratecode = document.getElementById('txtratecode').value;
    ratecode = document.getElementById('hiddenratecode').value;
    var scheme = document.getElementById('drpscheme').value;
    if (schemeid != "")
        scheme = schemeid;
    // scheme = document.getElementById('hiddenscheme').value;
    var currency = document.getElementById('drpcurrency').value;
    var rpt_currency = document.getElementById('drprptcurrency').value;
    var agreedrate = document.getElementById('txtagreedrate').value;
    var agreedamt = document.getElementById('txtagreedamt').value;
    var spedisc = document.getElementById('txtspedisc').value;
    var spacedisx = "";
    spacedisx = document.getElementById('txtspacedisc').value;
    //string adsizetype = drpadstype.SelectedValue;
    var adsizetype = "0";
    var specialcharges = document.getElementById('txtextracharges').value;
    /////new
    var agencytype = document.getElementById('txtagencytype').value;
    var agencystatus = document.getElementById('txtagencystatus').value;
    agencystatus = document.getElementById('hiddenstatus').value;
    var paymode = document.getElementById('txtagencypaymode').value;

    // paymode = document.getElementById('hiddenpay').value;
    var agencredit = document.getElementById('txtcreditperiod').value;
    var cardrate = document.getElementById('txtcardrate').value;
    var cardamount = document.getElementById('txtcardamt').value;
    var discount = document.getElementById('txtdiscount').value;
    var discountper = document.getElementById('txtdiscpre').value;
    var billaddress = document.getElementById('txtbilladdress').value;
    var totarea = document.getElementById('txttotalarea').value;
    var billcycle = document.getElementById('drpbillcycle').value;
    var revenuecenter = document.getElementById('drprevenue').value;
    var billpay = document.getElementById('drppaymenttype').value;
    // billpay = document.getElementById('hiddenbillpay').value;

    var billheight = document.getElementById('txtbillheight').value;
    var billwidth = document.getElementById('txtbillwidth').value;
    var billto = document.getElementById('drpbillto').value;
    billto = document.getElementById('hiddenbillto').value;
    var invoices = document.getElementById('txtinvoice').value;
    var vts = document.getElementById('txtvts').value;
    var ciragency = document.getElementById('txtciragency').value;
    var ciragencysubcode = '';
    if (ciragency != "" && ciragency.indexOf('(') >= 0) {
        var myarrayex = ciragency.split('(');
        var agecirname = myarrayex[1].replace(")", "").split('+')[0];
        ciragency = trim(agecirname);
        ciragencysubcode = trim(myarrayex[1].replace(")", "").split('+')[1]);
    }
    var cirrate = document.getElementById('txtcirrate').value;
    var ciredition = document.getElementById('hiddenciredi').value;
    var tradedisc = document.getElementById('txttradedisc').value;
    var agencyout = document.getElementById('txtagencyoutstand').value;
    var boxcode = document.getElementById('drpboxcode').value;
    var boxno = document.getElementById('txtboxno').value;
    var boxaddress = document.getElementById('txtboxaddress').value;
    var boxagency;
    var boxclient;
    var tfn;
    var coupan = "";

    /*if(document.getElementById('txtcardamt').value!="" && document.getElementById('txttradedisc').value!="")
    {
    var caramt=document.getElementById('txtgrossamt').value;
    var tradisc=document.getElementById('txttradedisc').value;
    if(tradisc=="")
    tradisc=0;
    var trdisc1=tradisc;
    var addcomm =0;
    if(document.getElementById('txtaddagencycommrate')!=null)
    {
    if(document.getElementById('hiddenagcommflag').value!="1")
    addcomm=document.getElementById('txtaddagencycommrate').value;
    }
    if(addcomm=="")
    {
    addcomm="0";
    }
    if(addcomm!="0")
    {
    trdisc1=parseFloat(tradisc) + parseFloat(addcomm);
    }
    var tot=0;
    if(document.getElementById('agncomm_seq_com').value!="S")
    tot=parseFloat(caramt)-parseFloat(caramt)*parseFloat(trdisc1)/100;
    else
    {
    tot=parseFloat(caramt)-parseFloat(caramt)*parseFloat(tradisc)/100;
    if(addcomm!="0")
    tot=parseFloat(tot)-parseFloat(tot)*parseFloat(addcomm)/100;
    }
           
    document.getElementById('txtbillamt').value=tot.toFixed(2);
    if(document.getElementById('drpbooktype').value=="2" || document.getElementById('drpbooktype').value=="4" || document.getElementById('drpbooktype').value=="5")  
    document.getElementById('txtbillamt').value = "0";
    bill_amt = document.getElementById('txtbillamt').value;
    }
    else
    {
    bill_amt = document.getElementById('txtbillamt').value;
    }*/
    bill_amt = document.getElementById('txtbillamt').value;
    //string pageprem = drppageprem.SelectedValue;
    var pageprem = "0";
    var pageamt = document.getElementById('txtpageamt').value;
    var premper = "";
    var grossamt = document.getElementById('txtgrossamt').value;
    var adsizcolumn = document.getElementById('txtcolum').value;
    var billcolumn = "";
    var billarea;
    if (document.getElementById('txtbillwidth').value != "") {
        billarea = parseFloat(document.getElementById('txtbillwidth').value) * parseFloat(document.getElementById('txtbillheight').value);
    }
    else {
        billarea = 0;
    }
    var specdiscper = document.getElementById('txtspediscper').value;
    var spacediscper = "";
    spacediscper = document.getElementById('txtspadiscper').value;
    var paidins = document.getElementById('txtpaid').value;
    var dealrate = document.getElementById('txtdealrate').value;
    var deviation = document.getElementById('txtdeviation').value;
    var varient = "";

    var contractname = document.getElementById('txtcontractname').value;
    var dealtyp = document.getElementById('txtcontracttype').value;
    var cardname = document.getElementById('txtcardname').value;
    var cardtype = document.getElementById('drptype').value;
    var cardmonth = document.getElementById('drpmonth').value;
    var cardyear = document.getElementById('drpyear').value;
    var cardno = document.getElementById('txtcardno').value;
    var receiptno = document.getElementById('hiddenreceiptno').value;
    if (receiptno == "" && document.getElementById('txtreceipt').value != "")
        receiptno = document.getElementById('txtreceipt').value;
    var caption = "";
    var campaign = "";

    var adscat3 = document.getElementById('drpadcat3').value;
    // adscat3 = document.getElementById('hiddenadscat3').value;
    var adscat4 = document.getElementById('drpadcat4').value;
    //  adscat4 = document.getElementById('hiddenadscat4').value;
    var adscat5 = document.getElementById('drpadcat5').value;
    //  adscat5 = document.getElementById('hiddenadscat5').value;
    var bgcolor = document.getElementById('drpbgcolor').value;
    var bulletcode = document.getElementById('drpbullet').value;
    var bulletprm = document.getElementById('txtbullprem').value;
    // bulletprm = document.getElementById('hiddenbullprem').value;
    var material = document.getElementById('drpmatstat').value;

    if (document.getElementById('drpvarient').options.length > 0) {
        varient = document.getElementById('drpvarient').value;
    }
    //string variant_name = drpvarient.SelectedValue;


    if (document.getElementById('chkage').checked == true) {
        boxagency = "1";
    }
    else {
        boxagency = "0";
    }
    if (document.getElementById('chkclie').checked == true) {
        boxclient = "1";
    }
    else {
        boxclient = "0";
    }

    if (document.getElementById('chktfn').checked == true) {
        tfn = "1";
    }
    else {
        tfn = "0";
    }
    var billhold;
    if (document.getElementById('chkholdbill').checked == true) {
        billhold = "Y";
    }
    else {
        billhold = "N";
    }

    var retainer = document.getElementById('drpretainer').value; //*14Aug*  drpretainer.SelectedValue;
    var nchkno = "";
    var nchkdate = "";
    var nchkamt = "";
    var nchkbankname = "";
    var nourbank = "";
    nchkno = document.getElementById('ttextchqno').value;
    nchkdate = document.getElementById('ttextchqdate').value;
    nchkamt = document.getElementById('ttextchqamt').value;
    nchkbankname = document.getElementById('ttextbankname').value;
    nourbank = document.getElementById('drpourbank').value;
    var clienttype = document.getElementById('drpregular').value;
    var translation = document.getElementById('drptranslation').value;
    var translationcharge = document.getElementById('txttranslationcharges').value;
    var clientcatdisc = document.getElementById('txtclientcatdisc').value;
    var clientcatamt = document.getElementById('txtclientcatam').value;
    var clientcatdistype = document.getElementById('hdnclientcatdistype').value;
    var flatfreqdisc = document.getElementById('txtflatfreqdisc').value;
    var flatfreqamt = document.getElementById('txtflatfreqamt').value;
    var flatfreqdisctype = document.getElementById('hdnflatfreqdisctype').value;
    var catdisc = document.getElementById('txtcatdisc').value;
    var catamt = document.getElementById('txtcatamt').value;
    var catdisctype = document.getElementById('hdncatdisctype').value;
    var canclecharge;
    var rodate = document.getElementById('txtrodate').value;
    if (document.getElementById('chkcanclecharges').checked == true) {
        canclecharge = "1";
    }
    else {
        canclecharge = "0";
    }
    if (document.getElementById('hiddensavemod').value == "0") {

        ///////if 0 than autogenerate the cio booking id and if 1 than autogenerate dockit no.
        // if(document.getElementById('hiddenprint_rec').value == "Y")
        if (document.getElementById('txtagencypaymode').value == "CR1" && document.getElementById('creditreceipt_allow').value == "Y") // for credit 
            autogenerated("3");
        receiptno = document.getElementById('hiddenreceiptno').value;
        ciobookid = document.getElementById('txtciobookid').value;
        res = null;
        res = Classified_Booking.bookidchk(document.getElementById('hiddencompcode').value, document.getElementById('txtciobookid').value, agency, agencycode, rono, "0", document.getElementById('txtkeyno').value, rodate);
        var dck = res.value;
        if (dck == null) {
            alert(res.error.description);
            return false;
        }



        if (dck.Tables[0].Rows.length >= 1) {
            message = "This Booking Id Has Been Assigned";
            alert(message);
            clearClick();
            return false;

        }





        if (document.getElementById('drprostatus').value == "2") {
            autogenerated("1");
            dockitno = document.getElementById('txtdockitno1').value;

        }

        document.getElementById('oldboxno').value = boxno;
        if (boxno != null && boxno != "" && document.getElementById('drpboxcode').value != "0") {

            var branchname1 = document.getElementById('hiddenbranch').value;
            branchname1 = branchname1.substring(0, 2)
            var branch1 = document.getElementById('drpboxcode').value;
            if (branch1 != "0") {
                var resb = Classified_Booking.getboxnovalue(document.getElementById('hiddencompcode').value, branchname1, branch1, "S");
            }
            var dsb = resb.value;
            if (dsb == null) {
                alert(resb.error.description)
                return false;
            }
            var count1 = "0";
            var branchname12 = document.getElementById('hiddenbranch').value;
            branchname12 = branchname12.substring(0, 2)
            if (dsb.Tables[0].Rows.length > 0 && dsb.Tables[0].Rows[0].boxno != null && dsb.Tables[0].Rows[0].boxno != "") {
                var boxval1 = dsb.Tables[0].Rows[0].boxno;
                var cou = boxval1;
                document.getElementById('txtboxno').value = cou;

            }
            else {
                document.getElementById('txtboxno').value = branchname12 + count1;

            }
            if (boxno != document.getElementById('txtboxno').value) {
                boxno = document.getElementById('txtboxno').value;
            }

        }
        /*//////////////////////////////////////////////////////////////////////////////////////////////////
        if the package selected has a rategroup code(in rate master) and matches with one of rate group code in agency or in client master
        * than allow booking and if null in both agency as well as client than also booking is allowed but if the rate
        * group of rate master with referrence to package selected in booking master does not match with agency nor
        * with client than booking is now allowed
        */

        res = null;
        res = Classified_Booking.chkrategroup(color, adcategory, subcategory, package, ratecode, startdate, "0", "CL0", document.getElementById('hiddencompcode').value, agency, client, document.getElementById('hiddendateformat').value);
        var dgr = res.value;
        if (dgr == null) {
            alert(res.error.description);
            return false;
        }



        if (dgr.Tables[0].Rows.length > 0) {
            rategr = dgr.Tables[0].Rows[0].Rate_Gr_Code;
        }
        if (dgr.Tables[2].Rows.length > 0) {
            agencyrate = dgr.Tables[2].Rows[0].client;
        }
        if (dgr.Tables[1].Rows.length > 0) {
            clientrate = dgr.Tables[1].Rows[0].rate;
        }

        //if (agencyrate != "" && clientrate != "")
        //{
        //    if (rategr != agencyrate && rategr != clientrate)
        //    {
        //        message = "Booking is not allowed";
        //        AspNetMessageBox(message);
        //        return;

        //    }
        //}


        // DataSet dins = new DataSet();
        //DataSet dscancel = new DataSet();
        res = null;
        var txtaddagencycommrate = 0;
        if (document.getElementById('txtaddagencycommrate') != null) {
            txtaddagencycommrate = document.getElementById('txtaddagencycommrate').value;
        }
        var addlamt = "";
        var retamt = "";
        var retper = "";
        if (document.getElementById('txtaddagencycommrateamt') != null) {
            addlamt = document.getElementById('txtaddagencycommrateamt').value;
        }
        if (document.getElementById('txtRetainercommamt') != null) {
            retamt = document.getElementById('txtRetainercommamt').value;
        }
        if (document.getElementById('txtRetainercomm') != null) {
            retper = document.getElementById('txtRetainercomm').value;
        }
        var bartertype = "";
        var chktradeval = "1";
        var mobno = document.getElementById('txtMobile').value;
        if (document.getElementById('chktrade').checked == true)
            chktradeval = "1";
        else
            chktradeval = "0";
        if (document.getElementById('txtbartertype').value != "" && document.getElementById('txtbartertype').value.indexOf('(') >= 0 && document.getElementById('txtbartertype').value.indexOf(')') >= 0)
            bartertype = document.getElementById('txtbartertype').value.substring(document.getElementById('txtbartertype').value.indexOf('(') + 1, document.getElementById('txtbartertype').value.indexOf(')'));
        if (ciobookid == "") {
            alert("Booking Id can't be blank");
            return false;
        }
        var grossamtlocal = document.getElementById('txtgrossamtlocal').value;
        var billamtlocal = document.getElementById('txtbillamtlocal').value;
        var chk_adon = "0";
        var adon_refid = "";
        if (document.getElementById('chkadon').checked == true)
            chk_adon = "A";
        adon_refid = document.getElementById('txtreference').value;
        var revisedate = document.getElementById('txtrevisedate').value;
        var online_ad = "N";
        if (document.getElementById('chkonline').checked == true)
            online_ad = "Y";
        var VAT_CODE = document.getElementById('hdnvts').value;
        var coupantype = document.getElementById('drpcoutype').value;
        var coupanno = document.getElementById('txtcouno').value;
        if (coupantype == "0" || coupantype == "")
            coupanno = "";



        if (multibilling_flag == "YES") {

            var count1 = document.getElementById('multibilling_div').getElementsByTagName('table')[0].rows.length - 1;
            var bill_amt_val = "0";


            for (var k2 = 0; k2 < count1; k2++) {
                if (document.getElementById('delete1_' + k2).value != "D") {

                    bill_amt_val = parseFloat(bill_amt_val) + parseFloat(document.getElementById('billamt_' + k2).value)
                }
            }


            if (parseFloat(document.getElementById('txtbillamtlocal').value).toFixed(2) != bill_amt_val.toFixed(2)) {
                alert("Amount of this multi RO is not match with Main RO!!")
                return false;
            }





            for (var k1 = 0; k1 < count1; k1++) {

                if (document.getElementById('delete1_' + k1).value != "D") {
                    var clientcode = document.getElementById('clinetcode_' + k1).value;
                    var client_name = document.getElementById('clinetname_' + k1).value;
                    var clinet_add = ""; //document.getElementById('clientadd_'+k1).value;
                    var clinet_width = ""; //document.getElementById('width_'+k1).value;
                    var client_height = ""; //document.getElementById('height_'+k1).value;
                    var gros_amt = ""; //document.getElementById('grossamt_'+k1).value;
                    var bill_amt1 = document.getElementById('billamt_' + k1).value;
                    var comm = ""; //document.getElementById('commi_'+k1).value;
                    var bill_no = ""; //document.getElementById('hiddencompcode').value;
                    var bill_dt = ""; //document.getElementById('hiddencompcode').value;
                    var flag = "I";
                    var extra1 = ciobookid;
                    var extra2 = "";
                    var extra3 = "";
                    var extra4 = "";
                    var extra5 = "";






                    var res1 = Classified_Booking.multi_billing(document.getElementById('hiddencompcode').value, clientcode, client_name, clinet_add, clinet_width, client_height, gros_amt, comm, bill_amt1, bill_no, bill_dt, document.getElementById('hiddenuserid').value, flag, extra1, extra2, extra3, extra4, extra5);
                    if (res1.error != null) {
                        alert(res.value.toString());
                        return false;
                    }
                }


            }
        }

var teamcode=document.getElementById('hdnteamcode').value;
  //////////////anuja
        var industry = document.getElementById('txtindustry').value.substring(document.getElementById('txtindustry').value.lastIndexOf('(') + 1, document.getElementById('txtindustry').value.lastIndexOf(')'));
        var productcat2 = document.getElementById('txtproduct').value; // document.getElementById('drpproductcat').value;
        // var product;
        if (productcat2 != "") {
            myarraypr = productcat2.split('(');
            productcat = myarraypr[1];
            productcat = productcat.replace(")", "");
        }
        else {
            productcat = "";
        }
        var quotationno = document.getElementById('txtquotationno').value;
        if (document.getElementById('hiddenquotation').value == "Q") {
            keyno = ciobookid;
        } var contactperson = document.getElementById('txtcontactperson').value;
        var mailid = document.getElementById('txtmailid').value;

        var ppubl_rev_cent = document.getElementById('hdnrevenuecentcd').value;
        var tempagcode_v = document.getElementById('hdntempagcode').value;
        ////////////////////////////////////////////
        res = Classified_Booking.insertBooking(adsizetype, branch, booked_by, prevbook, date_time, ciobookid, approvedby, audit, rono, rodate, caption, billstatus, rostatus, agency, client, agencyaddress, clientaddresses, agencycode, dockitno, execname, execzone, product, brand, keyno, billremark, printremark, package, insertion, startdate, repeatdateI, adtype, adcategory, subcategory, color, uom, pageposition, pagetype, pageno, adsizheight, adsizwidth, ratecode, scheme, currency, agreedrate, agreedamt, spedisc, spacedisx, document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value, specialcharges, agencytype, agencystatus, paymode, agencredit, cardrate, cardamount, discount, discountper, billaddress, totarea, billcycle, revenuecenter, billpay, billheight, billwidth, billto, invoices, vts, tradedisc, agencyout, boxcode, boxno, boxaddress, boxagency, boxclient, bookingtype, tfn, coupan, campaign, bill_amt, pageprem, pageamt, premper, grossamt, adsizcolumn, billcolumn, billarea, specdiscper, spacediscper, paidins, dealrate, deviation, varient, contractname, dealtyp, cardname, cardtype, cardmonth, cardyear, cardno, receiptno, adscat3, adscat4, adscat5, bgcolor, bulletcode, bulletprm, material, "", prev_cioid, prev_receipt, prev_ga, "0", "0", "0", "0", "0", "0", "0", document.getElementById('hiddendateformat').value, retainer, txtaddagencycommrate, srtcancel, auditstatus, addlamt, retamt, retper, document.getElementById('drpcashrecieved').value, ciragency, cirrate, ciredition, document.getElementById('hiddencirpub').value, ciragencysubcode, bartertype, document.getElementById('hidattach1').value, document.getElementById('hidattach2').value, document.getElementById('txtcashdiscount').value, document.getElementById('hiddencashrecieved').value, document.getElementById('drpdiscountprem').value, doctype, chktradeval, sharepub, fmgInsert, nchkno, nchkdate, nchkamt, nchkbankname, nourbank, multicode, mobno, agreedrate_active, agreedamt_active, grossamtlocal, billamtlocal, chk_adon, adon_refid, rpt_currency, document.getElementById('hidcurrency_convrate').value, revisedate, clienttype, translation, translationcharge, fmgreasons, canclecharge, document.getElementById('txttranslationdisc').value, document.getElementById('txtpospremdisc').value, billhold, online_ad, fixed_booking, VAT_CODE, coupantype, coupanno, clientcatdisc, clientcatamt, clientcatdistype, flatfreqdisc, flatfreqamt, flatfreqdisctype, catdisc, catamt, catdisctype, representative, teamcode, industry, productcat, chkgstinc, ppubl_rev_cent, contactperson, mailid, quotationno, tempagcode_v);
        
        ////////////////////////////////////////////
        //res = Classified_Booking.insertBooking(adsizetype, branch, booked_by, prevbook, date_time, ciobookid, approvedby, audit, rono, rodate, caption, billstatus, rostatus, agency, client, agencyaddress, clientaddresses, agencycode, dockitno, execname, execzone, product, brand, keyno, billremark, printremark, package, insertion, startdate, repeatdateI, adtype, adcategory, subcategory, color, uom, pageposition, pagetype, pageno, adsizheight, adsizwidth, ratecode, scheme, currency, agreedrate, agreedamt, spedisc, spacedisx, document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value, specialcharges, agencytype, agencystatus, paymode, agencredit, cardrate, cardamount, discount, discountper, billaddress, totarea, billcycle, revenuecenter, billpay, billheight, billwidth, billto, invoices, vts, tradedisc, agencyout, boxcode, boxno, boxaddress, boxagency, boxclient, bookingtype, tfn, coupan, campaign, bill_amt, pageprem, pageamt, premper, grossamt, adsizcolumn, billcolumn, billarea, specdiscper, spacediscper, paidins, dealrate, deviation, varient, contractname, dealtyp, cardname, cardtype, cardmonth, cardyear, cardno, receiptno, adscat3, adscat4, adscat5, bgcolor, bulletcode, bulletprm, material, "", prev_cioid, prev_receipt, prev_ga, "0", "0", "0", "0", "0", "0", "0", document.getElementById('hiddendateformat').value, retainer, txtaddagencycommrate, srtcancel, auditstatus, addlamt, retamt, retper, document.getElementById('drpcashrecieved').value, ciragency, cirrate, ciredition, document.getElementById('hiddencirpub').value, ciragencysubcode, bartertype, document.getElementById('hidattach1').value, document.getElementById('hidattach2').value, document.getElementById('txtcashdiscount').value, document.getElementById('hiddencashrecieved').value, document.getElementById('drpdiscountprem').value, doctype, chktradeval, sharepub, fmgInsert, nchkno, nchkdate, nchkamt, nchkbankname, nourbank, multicode, mobno, agreedrate_active, agreedamt_active, grossamtlocal, billamtlocal, chk_adon, adon_refid, rpt_currency, document.getElementById('hidcurrency_convrate').value, revisedate, clienttype, translation, translationcharge, fmgreasons, canclecharge, document.getElementById('txttranslationdisc').value, document.getElementById('txtpospremdisc').value, billhold, online_ad, fixed_booking, VAT_CODE, coupantype, coupanno, clientcatdisc, clientcatamt, clientcatdistype, flatfreqdisc, flatfreqamt, flatfreqdisctype, catdisc, catamt, catdisctype, representative, teamcode, industry, productcat, chkgstinc, document.getElementById('hdnrevenuecentcd').value, tempagcode_v);

        //  if(res.error!=null)
        //  {
        //   alert(res.error.description);
        //  return false;
        // }
        if (res.value != "") {
            alert(res.value.toString());
            return false;
        }
        //----------------------- save cash received in child table---------------------------- //
        if (document.getElementById('drppaymenttype').value == 'CA0') {
            var res2 = Classified_Booking.insertcashreceived(ciobookid, receiptno, document.getElementById('drpcashrecieved').value);
            if (res2.error != null) {
                alert(res2.error.description);
                return false;
            }
        }
        /*
        this function is created in the javascript to store the insertion line in the table
        */



        //save cheque/dd information

        if ((document.getElementById('drppaymenttype').value == 'CA0' && document.getElementById('hidcash').value == 'Y') || document.getElementById('drppaymenttype').value == 'CH0' || document.getElementById('drppaymenttype').value == 'DD0' || document.getElementById('drppaymenttype').value == 'PO0' || document.getElementById('drppaymenttype').value == 'AD0') {
            if (document.getElementById('drppaymenttype').value == 'CA0' && document.getElementById('hidcash').value == 'Y') {
                var ag_subcode = agencycode.split(agency)[1];
                var retainercode = "0";
                if (retainer.lastIndexOf("(") >= 0)
                    retainercode = retainer.substring(retainer.lastIndexOf("(") + 1, retainer.length - 1);
                //                   var resRe=Classified_Booking.getRepresenttaive(document.getElementById('hiddencompcode').value,execname,retainercode);      
                //                   if(resRe.value==null)
                //                   {
                //                    alert(resRe.error.description);
                //                    return false;
                //                   }
                var repcode = "";
                //if(resRe.value.Tables[0].Rows.length>0)
                // repcode=resRe.value.Tables[0].Rows[0].REPRESENTATIVE;
                if (repcode == null || repcode == "0")
                    repcode = "";
                //if(parseFloat(document.getElementById('txtbillamt').value)>0)
                // {     
                var billamt = document.getElementById('txtbillamt').value;
                var doctype = "RCP";
                if (document.getElementById('drppaymenttype').value == 'PO0')
                    doctype = "PDC";
                else if (document.getElementById('drppaymenttype').value == 'AD0')
                    doctype = "ACR";
                if (prev_cioid != "") {
                    var res = Classified_Booking.getAmount(prev_cioid);

                    if (res.value != null) {
                        if (parseFloat(billamt) > parseFloat(res.value)) {
                            billamt = parseFloat(billamt) - parseFloat(res.value);
                            doctype = "RCP"
                        }
                        else {
                            billamt = parseFloat(res.value) - parseFloat(billamt);
                            doctype = "CA"
                        }

                    }
                }
                //                var error= Classified_Booking.Insert_rcpthdr(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,"","",billamt,"",agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,"","",repcode,doctype,document.getElementById('txtbranch').value,ciobookid,execname,retainer,prev_cioid); 
                //                 if(error.value!="")
                //		    {
                //			    alert(error.value.toString());
                //			    return false;
                //		    }
                // Classified_Booking.Insert_rcpthdr(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,"","",billamt,"",agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,"","",repcode,doctype,document.getElementById('txtbranch').value); 
                // Classified_Booking.Insert_rcptdet(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,"","",billamt,"",agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,"",ciobookid,doctype,document.getElementById('txtbranch').value); 
                //Classified_Booking.Insert_outstand(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,"","",billamt,"",agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,doctype,document.getElementById('txtbranch').value); 
                // }
            }
            else if (document.getElementById('ttextchqno').value == "" || document.getElementById('ttextchqdate').value == "" || document.getElementById('ttextchqamt').value == "" || document.getElementById('ttextbankname').value == "")
            { }
            else {
                var doctype = "RCR";
                var ag_subcode = agencycode.split(agency)[1];
                var retainercode = "0";
                if (retainer.lastIndexOf("(") >= 0)
                    retainercode = retainer.substring(retainer.lastIndexOf("(") + 1, retainer.length - 1);
                //                     var resRe=Classified_Booking.getRepresenttaive(document.getElementById('hiddencompcode').value,execname,retainercode);      
                //                   if(resRe.value==null)
                //                   {
                //                    alert(resRe.error.description);
                //                    return false;
                //                   }
                var repcode = "";
                //                   if(resRe.value.Tables[0].Rows.length>0)
                //                    repcode=resRe.value.Tables[0].Rows[0].REPRESENTATIVE;
                if (repcode == null || repcode == "0")
                    repcode = "";
                //                     var error=Classified_Booking.Insert_rcpthdr(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,document.getElementById('ttextchqno').value,document.getElementById('ttextchqdate').value,document.getElementById('ttextchqamt').value,document.getElementById('ttextbankname').value,agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,"",document.getElementById('drpourbank').value,repcode,doctype,document.getElementById('txtbranch').value,ciobookid,execname,retainer,prev_cioid); 
                //                      if(error.value!="")
                //		    {
                //			    alert(error.value.toString());
                //			    return false;
                //		    }
                // Classified_Booking.Insert_rcpthdr(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,document.getElementById('ttextchqno').value,document.getElementById('ttextchqdate').value,document.getElementById('ttextchqamt').value,document.getElementById('ttextbankname').value,agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,"",document.getElementById('drpourbank').value,repcode,doctype,document.getElementById('txtbranch').value); 
                // Classified_Booking.Insert_rcptdet(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,document.getElementById('ttextchqno').value,document.getElementById('ttextchqdate').value,document.getElementById('ttextchqamt').value,document.getElementById('ttextbankname').value,agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,"",ciobookid,doctype,document.getElementById('txtbranch').value); 
                // Classified_Booking.Insert_outstand(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,document.getElementById('ttextchqno').value,document.getElementById('ttextchqdate').value,document.getElementById('ttextchqamt').value,document.getElementById('ttextbankname').value,agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,doctype,document.getElementById('txtbranch').value); 
            }
        }
        else if (document.getElementById('drppaymenttype').value == 'CR0') {
            var doctype = "RCR";
            if (document.getElementById('txtcardname').value != "" && document.getElementById('drptype').value != "0" && document.getElementById('drpmonth').value != "0" && document.getElementById('drpyear').value != "0" && document.getElementById('txtcardno').value != "") {
                var ag_subcode = agencycode.split(agency)[1];
                var cDate = ""
                if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                    cDate = "28" + "/" + document.getElementById('drpmonth').value + "/" + document.getElementById('drpyear').value;
                }
                if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                    cDate = document.getElementById('drpmonth').value + "/" + "28" + "/" + document.getElementById('drpyear').value;
                }
                if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
                    cDate = document.getElementById('drpyear').value + "/" + document.getElementById('drpmonth').value + "/" + "28";
                }
                //                      var retainercode="0";
                //                    if(retainer.lastIndexOf("(")>=0)
                //                    retainercode=retainer.substring(retainer.indexOf("(")+1,retainer.length-1);
                //                     var resRe=Classified_Booking.getRepresenttaive(document.getElementById('hiddencompcode').value,execname,retainercode);      
                //                   if(resRe.value==null)
                //                   {
                //                    alert(resRe.error.description);
                //                    return false;
                //                   }
                var repcode = "";
                //                   if(resRe.value.Tables[0].Rows.length>0)
                //                    repcode=resRe.value.Tables[0].Rows[0].REPRESENTATIVE;
                if (repcode == null || repcode == "0")
                    repcode = "";
                //                   var error= Classified_Booking.Insert_rcpthdr(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,document.getElementById('txtcardno').value,cDate,"0",document.getElementById('txtcardname').value,agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,document.getElementById('drptype').value,document.getElementById('drpourbank').value,repcode,doctype,document.getElementById('txtbranch').value,ciobookid,execname,retainer,prev_cioid); 
                //                    if(error.value!="")
                //		            {
                //			            alert(error.value.toString());
                //			            return false;
                //		            }
                // Classified_Booking.Insert_rcpthdr(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,document.getElementById('txtcardno').value,cDate,"0",document.getElementById('txtcardname').value,agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,document.getElementById('drptype').value,document.getElementById('drpourbank').value,repcode,doctype,document.getElementById('txtbranch').value); 
                // Classified_Booking.Insert_rcptdet(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,document.getElementById('txtcardno').value,cDate,"0",document.getElementById('txtcardname').value,agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,document.getElementById('drptype').value,ciobookid,doctype,document.getElementById('txtbranch').value); 
                //  Classified_Booking.Insert_outstand(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,document.getElementById('txtcardno').value,cDate,"0",document.getElementById('txtcardname').value,agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,doctype,document.getElementById('txtbranch').value); 
            }
        }
        /////////////////////////////////////////////////////////////////////////////////////
        var resR = saveinsertion();
        if (resR == false) {
            return false;
        }
        /*
        *This is the coding to save the images from the Temp folder to main folder
        */
        /*  if(browser!="Microsoft Internet Explorer")
        {
        var  httpRequest =null;
        httpRequest= new XMLHttpRequest();
        if (httpRequest.overrideMimeType) 
        {
        httpRequest.overrideMimeType('text/xml'); 
        }
            
        httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
        var adcat=document.getElementById('drpadcategory').value;
        httpRequest.open( "GET","saveImageBooking.aspx?cioid="+document.getElementById('txtciobookid').value, false );
        httpRequest.send('');
         
        if (httpRequest.readyState == 4) 
        {
        if (httpRequest.status == 200) 
        {
        strtext=httpRequest.responseText;
        }
        else 
        {
        alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
        }
        }
        }
        else
        { 
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        var adcat=document.getElementById('drpadcategory').value;
        xml.open( "GET","saveImageBooking.aspx?cioid="+document.getElementById('txtciobookid').value, false );
        xml.Send();
           
        }
        */
        ciobookid = document.getElementById('txtciobookid').value;
        if (boxno == document.getElementById('oldboxno').value)
            message = "Data Saved Sucessfully with CIO Id " + ciobookid + "";
        else
            message = "Data Saved Sucessfully with CIO Id " + ciobookid + " and New Box No. is" + boxno + "";
        //send sms
        var sms_link = document.getElementById('hdn_sms_link').value;
        var uid = document.getElementById('hdn_uid').value;
        var pwd = document.getElementById('hdn_pwd').value;
        var sender = document.getElementById('hdn_sender').value;
        send_sms(ciobookid, sms_link, uid, pwd, sender);
        document.getElementById("divloader").style.display = "none";
        alert(message);
        document.getElementById('hiddencioid').value = ciobookid;
        document.getElementById('txtprevbook').value = ciobookid;
        // message = "Value saved";

        getbuttoncheck(document.getElementById('hiddenbuttonidcheck').value);
        document.getElementById('tblinsert').innerHTML = ''
        if (document.getElementById('hiddenprint_rec').value == "Y") {
            if (quotation == 'Q') {
            }
            else {
                printreceipt();
            }

        }
        clearClick();
       
    }
    else//modify
    {
        //   var doctype="";
        //update check info
        // if(document.getElementById('hiddenprint_rec').value == "Y" && document.getElementById('txtreceipt').value=="")
        if (parseInt(document.getElementById('hiddenmodifyinsert').value) > parseInt(document.getElementById('txtinsertion').value)) {
            alert('You Cannot Decrease insertions(Please Cancel Booking..)!');
            document.getElementById('txtinsertion').focus();
            return false;
        }
        if ((document.getElementById('txtagencypaymode').value == "CR1" && document.getElementById('creditreceipt_allow').value == "Y") && document.getElementById('txtreceipt').value == "") // for credit 
            autogenerated("3");

        if (paymode == "CA0" && document.getElementById('hidcash').value == 'Y') {
            /*  var ag_subcode=agencycode.split(agency)[1];
            var retainercode="0";
            if(retainer.lastIndexOf("(")>=0)
            retainercode=retainer.substring(retainer.indexOf("(")+1,retainer.length-1);
            var resRe=Classified_Booking.getRepresenttaive(document.getElementById('hiddencompcode').value,execname,retainercode);      
            if(resRe.value==null)
            {
            alert(resRe.error.description);
            return false;
            }
            var repcode="";
            if(resRe.value.Tables[0].Rows.length>0)
            repcode=resRe.value.Tables[0].Rows[0].REPRESENTATIVE;
            if(repcode==null || repcode=="0")
            repcode="";
            //  if(parseFloat(document.getElementById('txtbillamt').value)>0)
            //   Classified_Booking.update_chqinfo(document.getElementById('hiddencompcode').value,receiptno,"","",document.getElementById('txtbillamt').value,"",agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,"RCP",date_time,document.getElementById('hiddendateformat').value,"","",repcode,document.getElementById('txtciobookid').value,document.getElementById('txtbranch').value);
            Classified_Booking.update_chqinfo(document.getElementById('hiddencompcode').value,document.getElementById('txtreceipt').value,"","",document.getElementById('txtbillamt').value,"",agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,"RCP",date_time,document.getElementById('hiddendateformat').value,"","",repcode,document.getElementById('txtciobookid').value,document.getElementById('txtbranch').value,execname,retainer,prev_cioid,document.getElementById('txtgrossamt').value);
            */

        }

        else if (paymode == "CH0" || paymode == "DD0" || paymode == "PO0" || paymode == "AD0") {
            var ag_subcode = agencycode.split(agency)[1];
            var retainercode = "0";
            if (retainer.lastIndexOf("(") >= 0)
                retainercode = retainer.substring(retainer.indexOf("(") + 1, retainer.length - 1);
            var resRe = Classified_Booking.getRepresenttaive(document.getElementById('hiddencompcode').value, execname, retainercode);
            if (resRe.value == null) {
                alert(resRe.error.description);
                return false;
            }
            var repcode = "";
            if (resRe.value.Tables[0].Rows.length > 0)
                repcode = resRe.value.Tables[0].Rows[0].REPRESENTATIVE;
            if (repcode == null || repcode == "0")
                repcode = "";
            Classified_Booking.update_chqinfo(document.getElementById('hiddencompcode').value, receiptno, document.getElementById('ttextchqno').value, document.getElementById('ttextchqdate').value, document.getElementById('ttextchqamt').value, document.getElementById('ttextbankname').value, agencycode, agency, ag_subcode, document.getElementById('drppaymenttype').value, "RCR", date_time, document.getElementById('hiddendateformat').value, "", document.getElementById('drpourbank').value, repcode, document.getElementById('txtciobookid').value, document.getElementById('txtbranch').value, execname, retainer, prev_cioid, document.getElementById('txtgrossamt').value);

        }
        else if (paymode == "CR0") {
            var ag_subcode = agencycode.split(agency)[1];
            var cDate = ""
            if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                cDate = "28" + "/" + document.getElementById('drpmonth').value + "/" + document.getElementById('drpyear').value;
            }
            if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                cDate = document.getElementById('drpmonth').value + "/" + "28" + "/" + document.getElementById('drpyear').value;
            }
            if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
                cDate = document.getElementById('drpyear').value + "/" + document.getElementById('drpmonth').value + "/" + "28";
            }
            Classified_Booking.update_chqinfo(document.getElementById('hiddencompcode').value, receiptno, document.getElementById('txtcardno').value, cDate, "0", document.getElementById('txtcardname').value, agencycode, agency, ag_subcode, document.getElementById('drppaymenttype').value, "RCR", date_time, document.getElementById('hiddendateformat').value, document.getElementById('drptype').value, document.getElementById('txtciobookid').value, document.getElementById('txtbranch').value, execname, retainer, prev_cioid, document.getElementById('txtgrossamt').value);

        }
        document.getElementById('hiddencioid').value = document.getElementById('txtciobookid').value;
        //            if (document.getElementById('txtciobookid').value != "")
        //            {
        //                res=null;
        //                Classified_Booking.InsertintoTemp(document.getElementById('txtciobookid').value,document.getElementById('hiddencompcode').value);          
        //                res=Classified_Booking.deleteid(document.getElementById('txtciobookid').value,document.getElementById('hiddencompcode').value);              
        //            }
        res = null;
        var txtaddagencycommrate = 0;
        if (document.getElementById('txtaddagencycommrate') != null) {
            txtaddagencycommrate = document.getElementById('txtaddagencycommrate').value;
        }
        var addlamt = "";
        var retamt = "";
        var mobno = document.getElementById('txtMobile').value;
        if (document.getElementById('txtaddagencycommrateamt') != null) {
            addlamt = document.getElementById('txtaddagencycommrateamt').value;
        }
        if (document.getElementById('txtRetainercommamt') != null) {
            retamt = document.getElementById('txtRetainercommamt').value;
        }
        if (document.getElementById('txtRetainercomm') != null) {
            retper = document.getElementById('txtRetainercomm').value;
        }
        receiptno = document.getElementById('txtreceipt').value;
        var bartertype = "";
        var chktradeval = "1";
        if (document.getElementById('chktrade').checked == true)
            chktradeval = "1";
        else
            chktradeval = "0";
        if (document.getElementById('txtbartertype').value != "" && document.getElementById('txtbartertype').value.indexOf('(') >= 0 && document.getElementById('txtbartertype').value.indexOf(')') >= 0)
            bartertype = document.getElementById('txtbartertype').value.substring(document.getElementById('txtbartertype').value.indexOf('(') + 1, document.getElementById('txtbartertype').value.indexOf(')'));
        var grossamtlocal = document.getElementById('txtgrossamtlocal').value;
        var billamtlocal = document.getElementById('txtbillamtlocal').value;
        var chk_adon = "0";
        var adon_refid = "";
        if (document.getElementById('chkadon').checked == true)
            chk_adon = "A";
        adon_refid = document.getElementById('txtreference').value;
        var revisedate = document.getElementById('txtrevisedate').value;
        var online_ad = "N";
        if (document.getElementById('chkonline').checked == true)
            online_ad = "Y";

        var VAT_CODE = document.getElementById('hdnvts').value;
        var coupantype = document.getElementById('drpcoutype').value;
        var coupanno = document.getElementById('txtcouno').value;
        if (coupantype == "0" || coupantype == "")
            coupanno = "";

        if (document.getElementById('multibilling_div').getElementsByTagName('table')[0] != undefined) {
            var count1 = document.getElementById('multibilling_div').getElementsByTagName('table')[0].rows.length - 1;
            var bill_amt_val = "0";

            for (var k2 = 0; k2 < count1; k2++) {
                if (document.getElementById('delete1_' + k2).value != "D") {
                    bill_amt_val = parseFloat(bill_amt_val) + parseFloat(document.getElementById('billamt_' + k2).value)
                }
            }

            if (parseFloat(document.getElementById('txtbillamtlocal').value).toFixed(2) != bill_amt_val.toFixed(2)) {
                alert("Amount of this multi RO is not match with Main RO!!")
                return false;
            }

            for (var k1 = 0; k1 < count1; k1++) {

                if (document.getElementById('delete1_' + k1).value == "D") {



                    var clientcode = document.getElementById('clinetcode_' + k1).value;
                    var client_name = document.getElementById('clinetname_' + k1).value;
                    var clinet_add = ""; // document.getElementById('clientadd_'+k1).value;
                    var clinet_width = ""; //document.getElementById('width_'+k1).value;
                    var client_height = ""; //document.getElementById('height_'+k1).value;
                    var gros_amt = ""; //document.getElementById('grossamt_'+k1).value;
                    var bill_amt1 = document.getElementById('billamt_' + k1).value;
                    var comm = ""; // document.getElementById('commi_'+k1).value;
                    var bill_no = ""; //document.getElementById('hiddencompcode').value;
                    var bill_dt = ""; document.getElementById('hiddencompcode').value;
                    var flag = "D";
                    var extra1 = ciobookid;
                    var extra2 = document.getElementById('hdnsequeceno_' + k1).value;
                    var extra3 = "";
                    var extra4 = "";
                    var extra5 = "";

                    var res1 = Classified_Booking.multi_billing(document.getElementById('hiddencompcode').value, clientcode, client_name, clinet_add, clinet_width, client_height, gros_amt, comm, bill_amt1, bill_no, bill_dt, document.getElementById('hiddenuserid').value, flag, extra1, extra2, extra3, extra4, extra5);
                    if (res1.error != null) {
                        alert(res.value.toString());
                        return false;
                    }

                }


                if (document.getElementById('delete1_' + k1).value != "D") {
                    var clientcode = document.getElementById('clinetcode_' + k1).value;
                    var client_name = document.getElementById('clinetname_' + k1).value;
                    var clinet_add = ""; // document.getElementById('clientadd_'+k1).value;
                    var clinet_width = ""; //document.getElementById('width_'+k1).value;
                    var client_height = ""; //document.getElementById('height_'+k1).value;
                    var gros_amt = ""; //document.getElementById('grossamt_'+k1).value;
                    var bill_amt1 = document.getElementById('billamt_' + k1).value;
                    var comm = ""; // document.getElementById('commi_'+k1).value;
                    var bill_no = ""; //document.getElementById('hiddencompcode').value;
                    var bill_dt = ""; document.getElementById('hiddencompcode').value;
                    var flag = "U";
                    var extra1 = ciobookid;
                    var extra2 = document.getElementById('hdnsequeceno_' + k1).value;
                    var extra3 = "";
                    var extra4 = "";
                    var extra5 = "";


                    var res1 = Classified_Booking.multi_billing(document.getElementById('hiddencompcode').value, clientcode, client_name, clinet_add, clinet_width, client_height, gros_amt, comm, bill_amt1, bill_no, bill_dt, document.getElementById('hiddenuserid').value, flag, extra1, extra2, extra3, extra4, extra5);
                    if (res1.error != null) {
                        alert(res.value.toString());
                        return false;
                    }
                }
            }

        }

        var teamcode = document.getElementById('hdnteamcode').value;
//        var subcat3 = document.getElementById("drpadcat3").value;
//        var subcat4 = document.getElementById("drpadcat4").value;
//        var subcat5 = document.getElementById("drpadcat5").value;
 //////////////anuja
        var industry = document.getElementById('txtindustry').value.substring(document.getElementById('txtindustry').value.lastIndexOf('(') + 1, document.getElementById('txtindustry').value.lastIndexOf(')'));
        var productcat2 = document.getElementById('txtproduct').value; // document.getElementById('drpproductcat').value;
        // var product;
        if (productcat2 != "") {
            myarraypr = productcat2.split('(');
            productcat = myarraypr[1];
            productcat = productcat.replace(")", "");
        }
        else {
            productcat = "";
        }
        ////////////////////////////////////////////
        res = Classified_Booking.updatebooking(adsizetype, branch, booked_by, prevbook, date_time, ciobookid, approvedby, audit, rono, rodate, caption, billstatus, rostatus, agency, client, agencyaddress, clientaddresses, agencycode, dockitno, execname, execzone, product, brand, keyno, billremark, printremark, package, insertion, startdate, repeatdateI, adtype, adcategory, subcategory, color, uom, pageposition, pagetype, pageno, adsizheight, adsizwidth, ratecode, scheme, currency, agreedrate, agreedamt, spedisc, spacedisx, document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value, specialcharges, agencytype, agencystatus, paymode, agencredit, cardrate, cardamount, discount, discountper, billaddress, totarea, billcycle, revenuecenter, billpay, billheight, billwidth, billto, invoices, vts, tradedisc, agencyout, boxcode, boxno, boxaddress, boxagency, boxclient, bookingtype, tfn, coupan, campaign, bill_amt, pageprem, pageamt, premper, grossamt, adsizcolumn, billcolumn, billarea, specdiscper, spacediscper, paidins, dealrate, deviation, varient, contractname, dealtyp, cardname, cardtype, cardmonth, cardyear, cardno, receiptno, adscat3, adscat4, adscat5, bgcolor, bulletcode, bulletprm, material, "0", "0", "0", "0", "0", "0", "0", auditstatus, retainer, txtaddagencycommrate, document.getElementById('hiddendateformat').value, addlamt, retamt, retper, document.getElementById('drpcashrecieved').value, ciragency, cirrate, ciredition, document.getElementById('hiddencirpub').value, ciragencysubcode, bartertype, document.getElementById('hidattach1').value, document.getElementById('hidattach2').value, document.getElementById('txtcashdiscount').value, document.getElementById('hiddencashrecieved').value, document.getElementById('drpdiscountprem').value, doctype, chktradeval, sharepub, fmgInsert, nchkno, nchkdate, nchkamt, nchkbankname, nourbank, multicode, mobno, agreedrate_active, agreedamt_active, grossamtlocal, billamtlocal, chk_adon, adon_refid, rpt_currency, document.getElementById('hidcurrency_convrate').value, revisedate, clienttype, translation, translationcharge, fmgreasons, canclecharge, document.getElementById('txttranslationdisc').value, document.getElementById('txtpospremdisc').value, billhold, online_ad, fixed_booking, VAT_CODE, coupantype, coupanno, clientcatdisc, clientcatamt, clientcatdistype, flatfreqdisc, flatfreqamt, flatfreqdisctype, catdisc, catamt, catdisctype, document.getElementById('hiddensupplimentflag').value, representative,teamcode, industry,productcat,chkgstinc);
        if (res.value == null) {
            alert(res.error.description);
            alert("Update Process is not completed successfully. Please Login again and then Modify");
            return false;
        }

        updatecashreceived();
        Classified_Booking.deletefromtemp(document.getElementById('txtciobookid').value, document.getElementById('hiddencompcode').value);


        var resR = getmodifygrid();
        if (resR == false) {
            return false;
        }
        var emailbranch = "";
        if(document.getElementById('hiddenrateauditflag').value!="rateaudit")
        {
            if (ALLOWBOOKINGBRANCHMAIL == "Y" && mailsavestr != "") {
                //mailsavestr = "NBN~~~~N10~~~~bhanu@4cplus.com^^^^^NBN~~~~N11~~~~bhanu@4cplus.com^^^^^NBN~~~~N12~~~~bhanu@4cplus.com^^^^^NBN~~~~N13~~~~bhanu@4cplus.com^^^^^NBN~~~~N14~~~~bhanu@4cplus.com^^^^^NBN~~~~NB5~~~~bhanu@4cplus.com^^^^^NBN~~~~NB6~~~~bhanu@4cplus.com^^^^^NBN~~~~NB7~~~~bhanu@4cplus.com^^^^^NBN~~~~NB8~~~~bhanu@4cplus.com^^^^^NBN~~~~NB9~~~~bhanu@4cplus.com^^^^^NBN~~~~NBN~~~~bhanu@4cplus.com";
                var arr_split = mailsavestr.split('^^^^^');
                var narr_split = "";
                var mailcenter = "";
                var mailbranch = "";
                var mailid = "";
                for (var i = 0; i < arr_split.length; i++) {
                    var narr_split = trim(arr_split[i]).split('~~~~');
                    mailcenter = narr_split[0];
                    if (emailbranch == "") {
                        emailbranch = narr_split[2];
                    }
                    else {
                        emailbranch = emailbranch + ',' + narr_split[2];
                    }
                    mailbranch = narr_split[1];
                    mailid = narr_split[2];
                    var mailres = Classified_Booking.mailsave(document.getElementById('txtciobookid').value, document.getElementById('hiddencompcode').value, mailcenter, mailbranch, mailid, document.getElementById('hiddenuserid').value, "", "", "", "", "");
                    if (mailres.error != null) {
                        alert(mailres.error.description);
                        return false;
                    }
                }
            }
        }
        Classified_Booking.savelogin_dj(document.getElementById('txtciobookid').value);
        if(document.getElementById('hiddenrateauditflag').value!="rateaudit")
        {
            if (ALLOWBOOKINGBRANCHMAIL == "Y" && mailsavestr != "" ) 
            {
                //var mailres1 = Classified_Booking.mailfinalsave(document.getElementById('hiddencompcode').value, document.getElementById('txtciobookid').value, emailbranch, document.getElementById('hidattach1').value, "", "", "", "");
                //final
                if (hidcopy == "copy")
                {
                    var mailres1 = Classified_Booking.mailfinalsave(document.getElementById('hiddencompcode').value, document.getElementById('txtciobookid').value, emailbranch, document.getElementById('hidattach1').value, "", "", "", "");
                }
                else
                {
                    var mailres1 = Classified_Booking.mailfinalsave(document.getElementById('hiddencompcode').value, document.getElementById('txtciobookid').value, emailbranch, document.getElementById('hidattach1').value, chkbtnStatus, "", "", "");
                }
                    //var mailres1 = Classified_Booking.mailfinalsave(document.getElementById('hiddencompcode').value, document.getElementById('txtciobookid').value, emailbranch, document.getElementById('hidattach1').value, material, "", "", "");

                    // var mailres1 = Classified_Booking.mailfinalsave(compcode, mainbookingid, emailbranch, "", "", "", "", "");
                    if (mailres1.error != null) {
                        alert(mailres1.error.description);
                        return false;
                    }
            }
        }
        var savename = "";
        /*           if(browser!="Microsoft Internet Explorer")
        {
        var  httpRequest =null;
        httpRequest= new XMLHttpRequest();
        if (httpRequest.overrideMimeType) 
        {
        httpRequest.overrideMimeType('text/xml'); 
        }
            
        httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
        var adcat=document.getElementById('drpadcategory').value;
        httpRequest.open( "GET","saveImageBooking.aspx?cioid="+document.getElementById('txtciobookid').value, false );
        httpRequest.send('');
         
        if (httpRequest.readyState == 4) 
        {
        if (httpRequest.status == 200) 
        {
        strtext=httpRequest.responseText;
        }
        else 
        {
        alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
        }
        }
        }
        else
        { 
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        var adcat=document.getElementById('drpadcategory').value;
        xml.open( "GET","saveImageBooking.aspx?cioid="+document.getElementById('txtciobookid').value, false );
        xml.Send();
           
        }*/
        document.getElementById('hiddencioid').value = ciobookid;
        document.getElementById('hiddencalendar').value = "0";
        document.getElementById('txtciobookid').value = gciobookid;
        document.getElementById('txtdockitno1').value = gdockitno;
        document.getElementById('txtkeyno').value = gkeyno;
        document.getElementById('txtrono').value = grono;

        //  document.getElementById('Hdnmodbook').value="";
        if (document.getElementById('hiddensupplimentflag').value != "") {

            var ressupplementb = Classified_Booking.billupdatedata(document.getElementById('hiddencompcode').value, document.getElementById('txtciobookid').value, document.getElementById('hiddensupplementbilldate').value, document.getElementById('hiddensupplementbillno').value, document.getElementById('hiddenuserid').value, document.getElementById('hiddendateformat').value, "1");
            if (ressupplementb.value == null) {
                alert(ressupplementb.error.description);
            }
            for (var j = 0; j <= ressupplementb.value.Tables[0].Rows.length - 1; j++) {
                var ressupplement = Classified_Booking.billupdatedata(document.getElementById('hiddencompcode').value, ressupplementb.value.Tables[0].Rows[j].BILL_CIOID, ressupplementb.value.Tables[0].Rows[j].BILL_DATE, ressupplementb.value.Tables[0].Rows[j].BILL_NO, document.getElementById('hiddenuserid').value, document.getElementById('hiddendateformat').value, "0");
                if (ressupplement.value == null) {
                    alert(ressupplement.error.description);
                }
            }
            window.close();
            return false;
        }
        if (document.getElementById('hiddenrateauditflag').value == "rateaudit") {
            window.close();
            return false;
        }
        if (document.getElementById('regclient').style.display != 'none')
            document.getElementById('regclient').style.display = 'none';
        if (document.getElementById('Hdnmodbook').value == "modify") {
            alert("Data Updated Successfully1");
            document.getElementById("divloader").style.display = "none";
            queryClick();
        }
        else {
            //executeClick();
            alert("Data Updated Successfully2");
            document.getElementById("divloader").style.display = "none";
            clearClick();
        }
        document.getElementById('hiddencioid').value = ciobookid;
        var quotation = document.getElementById('hiddenquotation').value;
printreceipt();
        if (document.getElementById('hiddenprint_rec').value == "Y") {
            if (quotation == 'Q') {

            }
            else {

                printreceipt();
            }

        }
    }
}

//---------- update cash recieved in child table ---------------//
function updatecashreceived() {
    var ciobookid = document.getElementById('txtciobookid').value;
    var cashrcvd = document.getElementById('drpcashrecieved').value;
    if (parseFloat(document.getElementById('drpcashrecieved').value) > parseFloat(document.getElementById('hiddencashrecieved').value))
        var diff = (parseFloat(document.getElementById('drpcashrecieved').value) - parseFloat(document.getElementById('hiddencashrecieved').value));
    else
        var diff = (parseFloat(document.getElementById('hiddencashrecieved').value) - parseFloat(document.getElementById('drpcashrecieved').value));
    if (parseFloat(diff) > 0) {
        autogenerated("3")
        Classified_Booking.insertcashreceived(ciobookid, document.getElementById('txtreceipt').value, diff);
    }

}


function modifyClick() {
    chkbtnStatus = "modify";




    //multibilling_change/////
    if (document.getElementById('multibilling_div').innerHTML != "") {
        document.getElementById('Btnaddrow').style.display = "block";
        document.getElementById('btnhide').style.display = "block";
        document.getElementById('multibilling').disabled = true;
        var count1 = document.getElementById('multibilling_div').getElementsByTagName('table')[0].rows.length - 1;
        for (var x = 0; x < count1; x++) {
            document.getElementById('txtsno_' + x).disabled = false;
            document.getElementById('clinetcode_' + x).disabled = true;
            document.getElementById('clinetname_' + x).disabled = false;
            document.getElementById('billamt_' + x).disabled = false;
            document.getElementById('delete1_' + x).disabled = false;

        }
    }
    else {
        document.getElementById('multibilling').disabled = false;
    }


    document.getElementById('hiddensavemod').value = "01";
    document.getElementById('LinkButton1').disabled = false;
    document.getElementById('LinkButton2').disabled = false;
    document.getElementById('LinkButton3').disabled = false;
    document.getElementById('LinkButton4').disabled = false;
    document.getElementById('LinkButton5').disabled = false;
    document.getElementById('LinkButton6').disabled = false;
    document.getElementById('LinkButton7').disabled = false;
    document.getElementById('txtagreedrate').disabled = false;
    document.getElementById('txtagreedamt').disabled = false;
    document.getElementById('drptranslation').disabled = false;
    document.getElementById('chkholdbill').disabled = false;
    document.getElementById('txtcontactperson').disabled = false;
    document.getElementById('txtmailid').disabled = false;
    modifyMatter = 1;
    /////if in the insertion grid record insertion status is publish or hold or cancel than the main form except the 
    ////insert grid record cannot modify
    res = null;
    res = Classified_Booking.fetchdataforexe(document.getElementById('txtciobookid').value, document.getElementById('hiddencompcode').value);
    var dex = res.value;
    if (dex == null) {
        alert(res.error.description);
        return false;
    }
    document.getElementById('hiddenmodifyinsert').value = document.getElementById('txtinsertion').value;
    var insertstatus = "0";
    for (var j = 0; j <= dex.Tables[0].Rows.length - 1; j++) {


        if (dex.Tables[0].Rows[j].Insert_status == "publish") {
            boxstatus = "publish";
            if (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y")
                insertstatus = "2";
            else
                insertstatus = "0";
            //document.getElementById('hiddensavemod').value = "01";
            break;
        }
        else if (dex.Tables[0].Rows[j].Insert_status == "billed" || document.getElementById('hiddensupplimentflag').value != "") {
            insertstatus = "1";
            boxstatus = "billed"
            document.getElementById('txtprintremark').disabled = false;


            document.getElementById('drpadsubcategory').disabled = false;


            //document.getElementById('hiddensavemod').value = "1";
            break;
            // break;
        }
        else {
            boxstatus = "booked";
            insertstatus = "0";
            //  document.getElementById('hiddensavemod').value = "01";
        }
    }
    if (hidcopy == "copy") {
        insertstatus = "0";
        previnsertion = document.getElementById("txtinsertion").value;
        document.getElementById('btncopy').disabled = false;
        document.getElementById('btndel').disabled = false;
        document.getElementById('txtdummydate').value = ""; // new for blank date in copy case
    }
    if (document.getElementById("Hiddenbillclear").value == "Hold") {
        insertstatus = "0";

    }
    //document.getElementById('txtMobile').value="";
    document.getElementById('txtMobile').disabled = false;
    document.getElementById('Button1').disabled = false;
    if (document.getElementById('drpbooktype').value == "2" || document.getElementById('drpbooktype').value == "6")
        document.getElementById('btnfmg').disabled = false;
    else
        document.getElementById('btnfmg').disabled = true;
    document.getElementById('drpretainer').disabled = false;
    document.getElementById('txtrevisedate').disabled = false;
    if (document.getElementById('hiddensupplimentflag').value == "O" || document.getElementById('hiddensupplimentflag').value == "S") {
        insertstatus = "0";
    }
    if (insertstatus == "2") {
        document.getElementById('txtRetainercomm').disabled = false;
        if (document.getElementById('hiddenuomdesc').value != 'CD')
            document.getElementById('drpbullet').disabled = false;
        document.getElementById('drpdiscountprem').disabled = false;
        if (document.getElementById('txtaddagencycommrateamt') != null)
            document.getElementById('txtaddagencycommrateamt').disabled = false;
        document.getElementById('btndeal').disabled = true;
        document.getElementById('btnshgrid').disabled = false;
        document.getElementById('txttranslationdisc').disabled = false;
        document.getElementById('txtpospremdisc').disabled = false;
        //btnupload.Enabled = false;
        document.getElementById('drpbooktype').disabled = true;
        document.getElementById('txtciobookid').disabled = true;
        // txtappby.Enabled = true;
        //txtaudit.Enabled = true;
        document.getElementById('txtrono').disabled = false;
        document.getElementById('txtrodate').disabled = false;

        document.getElementById('drpbillstatus').disabled = false;
        document.getElementById('drprostatus').disabled = false;
        document.getElementById('txtagency').disabled = false;
        document.getElementById('txtclient').disabled = false;
        // txtagencyaddress.Enabled = true;
        document.getElementById('txtclientadd').disabled = false;
        document.getElementById('drpagscode').disabled = false;
        document.getElementById('txtdockitno1').disabled = true;
        document.getElementById('txtexecname').disabled = false;
        document.getElementById('txtexeczone').disabled = false;
        document.getElementById('txtproduct').disabled = false;
        document.getElementById('drpbrand').disabled = false;
        document.getElementById('txtkeyno').disabled = false;
        document.getElementById('txtbillremark').disabled = false;
        document.getElementById('txtprintremark').disabled = false;
        document.getElementById('btnsharing').disabled = true;

        document.getElementById('drppackage').disabled = true;
        document.getElementById('txtinsertion').disabled = true;
        document.getElementById('txtdummydate').disabled = true;
        document.getElementById('txtrepeatingdate').disabled = true;
        document.getElementById('drpbooktype').disabled = true;
        document.getElementById('drpadcategory').disabled = true;
        document.getElementById('drpadsubcategory').disabled = false;
        document.getElementById('drpadcat3').disabled = true;
        document.getElementById('drpadcat4').disabled = true;
        document.getElementById('drpadcat5').disabled = true;
        document.getElementById('drpbgcolor').disabled = true;
        document.getElementById('drpcolor').disabled = true;
        document.getElementById('chkgstinc').disabled = true;
        document.getElementById('drpuom').disabled = true;
        document.getElementById('drppageposition').disabled = true;
        document.getElementById('chkadon').disabled = true;
        document.getElementById('btnrefid').disabled = true;
        document.getElementById('txtreference').disabled = true;

        // txtadsizetypeheight.Enabled = true;
        //txtadsizetypewidth.Enabled = true;
        document.getElementById('txtratecode').disabled = true;
        document.getElementById('drpscheme').disabled = true;
        //  drpschemepck.Enabled = false;
        document.getElementById('drpcurrency').disabled = true;
        document.getElementById('drprptcurrency').disabled = true;
        document.getElementById('txtagreedrate').disabled = true;
        document.getElementById('drptranslation').disabled = true;
        document.getElementById('txtagreedamt').disabled = true;

        document.getElementById('txtextracharges').disabled = true;
        document.getElementById('txtspedisc').disabled = true;
        document.getElementById('txtspediscper').disabled = true;
        document.getElementById('txtspacedisc').disabled = true;
        document.getElementById('txtspadiscper').disabled = true;
        if (document.getElementById('hidbackdatereceipt').value == "y")
            document.getElementById('txtdatetime').disabled = false;
        else
            document.getElementById('txtdatetime').disabled = true;
        document.getElementById('txtrepeatingdate').disabled = true;

        document.getElementById('drpbillcycle').disabled = true;
        document.getElementById('drprevenue').disabled = true;
        //drpbilltype.Enabled = true;
        document.getElementById('drpbillstatus').disabled = true;
        //drpbillcurrency.Enabled = true;
        document.getElementById('drppaymenttype').disabled = true;
        document.getElementById('drpcashrecieved').disabled = true;
        document.getElementById('txtinvoice').disabled = true;
        document.getElementById('txtvts').disabled = true;
        document.getElementById('txtcirrate').disabled = true;
        document.getElementById('txtciragency').disabled = true;
        document.getElementById('txtciredition').disabled = true;
        if (document.getElementById('txtbillwidth').style.backgroundColor != "#999999") {
            document.getElementById('txtbillwidth').disabled = true;
            document.getElementById('txtbillheight').disabled = true;
        }
        document.getElementById('drpbillto').disabled = true;
        if (document.getElementById('hiddeneiitagcomm').value == "N") {
            document.getElementById('txttradedisc').disabled = true;
            document.getElementById('chktrade').disabled = true;
            if (document.getElementById('txtaddagencycommrate') != null) {
                document.getElementById('txtaddagencycommrate').disabled = true;

                document.getElementById('txtaddagencycommrateamt').disabled = true;

            }
        }
        else if (document.getElementById('hiddeneiitagcomm').value == "T") {
            document.getElementById('txttradedisc').disabled = false;
            document.getElementById('chktrade').disabled = false;
            if (document.getElementById('txtaddagencycommrate') != null) {
                document.getElementById('txtaddagencycommrate').disabled = true;

                document.getElementById('txtaddagencycommrateamt').disabled = true;

            }
        }
        else if (document.getElementById('hiddeneiitagcomm').value == "A") {
            document.getElementById('txttradedisc').disabled = true;
            document.getElementById('chktrade').disabled = true;
            if (document.getElementById('txtaddagencycommrate') != null) {
                document.getElementById('txtaddagencycommrate').disabled = false;

                document.getElementById('txtaddagencycommrateamt').disabled = false;

            }
        }
        else {
            document.getElementById('txttradedisc').disabled = false;
            document.getElementById('chktrade').disabled = false;
            if (document.getElementById('txtaddagencycommrate') != null) {
                document.getElementById('txtaddagencycommrate').disabled = false;

                document.getElementById('txtaddagencycommrateamt').disabled = false;

            }
        }

        //            if (document.getElementById('hiddencancelcharge').value == "Y") {
        //                document.getElementById('chkcanclecharges').disabled = false;
        //                document.getElementById('chkcanclecharges').checked = true;
        //            }
        if (document.getElementById('hiddencancelcharge').value == "Y") {
            document.getElementById('chkcanclecharges').disabled = false;

        }
        else {
            document.getElementById('chkcanclecharges').disabled = true;

        }
        //              if(document.getElementById('txtaddagencycommrate')!=null)
        //          document.getElementById('txtaddagencycommrate').disabled = false;
        document.getElementById('txtagencyoutstand').disabled = true;
        document.getElementById('txtcardrate').disabled = true;
        document.getElementById('txtcardamt').disabled = true;
        document.getElementById('txtdiscount').disabled = true;
        document.getElementById('txtdiscpre').disabled = true;
        document.getElementById('txtadsize2').disabled = true;
        document.getElementById('txtadsize1').disabled = true;
        document.getElementById('txttotalarea').disabled = false;
        document.getElementById('txtbilladdress').disabled = true;

        document.getElementById('drpboxcode').disabled = true;
        //txtboxno.Enabled = true;
        document.getElementById('txtboxaddress').disabled = true;

        document.getElementById('txtbillamt').disabled = true;

        document.getElementById('txtgrossamt').disabled = true;
        document.getElementById('drpboxcode').disabled = true;
        document.getElementById('chkage').disabled = true;
        document.getElementById('chkclie').disabled = true;
        document.getElementById('chktfn').disabled = true;

        document.getElementById('txtboxaddress').disabled = true;
        document.getElementById('txtinsertion').disabled = true;
        document.getElementById('txtcolum').disabled = true;
        document.getElementById('drpmatstat').disabled = true;

        ///////////////////////
        document.getElementById('txtcontractname').disabled = true;
        document.getElementById('txtcontracttype').disabled = true;
        document.getElementById('txtcardname').disabled = true;
        document.getElementById('drptype').disabled = true;
        document.getElementById('drpmonth').disabled = true;
        document.getElementById('drpyear').disabled = true;
        document.getElementById('txtcardno').disabled = true;
        document.getElementById('btnshgrid').disabled = false;
        document.getElementById('btndeal').disabled = true;
        //chequeinfo
        document.getElementById('ttextchqno').disabled = true;
        document.getElementById('ttextchqdate').disabled = true;
        document.getElementById('ttextchqamt').disabled = true;
        document.getElementById('ttextbankname').disabled = true;
        document.getElementById('drpourbank').disabled = true;
        if (document.getElementById('drppaymenttype').value == "CH0" || document.getElementById('drppaymenttype').value == "DD0" || document.getElementById('drppaymenttype').value == 'PO0' || document.getElementById('drppaymenttype').value == 'AD0')  //CR0 is Credit Card code and DD0 is demand draft
        {
            document.getElementById('ttextchqno').disabled = false;
            document.getElementById('ttextchqdate').disabled = false;
            document.getElementById('ttextchqamt').disabled = false;
            document.getElementById('ttextbankname').disabled = false;
            document.getElementById('drpourbank').disabled = false;
            document.getElementById('txtcardname').disabled = true;
            document.getElementById('drptype').disabled = true;
            document.getElementById('drpmonth').disabled = true;
            document.getElementById('drpyear').disabled = true;
            document.getElementById('txtcardno').disabled = true;
        }
        else if (document.getElementById('drppaymenttype').value == "CR0") {
            document.getElementById('ttextchqno').disabled = true;
            document.getElementById('ttextchqdate').disabled = true;
            document.getElementById('ttextchqamt').disabled = true;
            document.getElementById('ttextbankname').disabled = true;
            document.getElementById('drpourbank').disabled = true;
            document.getElementById('txtcardname').disabled = false;
            document.getElementById('drptype').disabled = false;
            document.getElementById('drpmonth').disabled = false;
            document.getElementById('drpyear').disabled = false;
            document.getElementById('txtcardno').disabled = false;
        }
        else if (document.getElementById('drppaymenttype').value == "CA0") {
            document.getElementById('cashrecvd').style.display = "";
            // document.getElementById('tdcashrecvd').style.display="";
            // document.getElementById('drpcashrecieved').value=executequery.Tables[0].Rows[0].CASH_RECIEVED;
            document.getElementById('drpcashrecieved').disabled = false;
            document.getElementById('txtcashdiscount').disabled = false;
        }

        document.getElementById('txtRetainercomm').disabled = false;
        document.getElementById('txtRetainercommamt').disabled = false;
    }
    else if (insertstatus == "1") {

        document.getElementById('txtprintremark').disabled = false;


        document.getElementById('drpadsubcategory').disabled = false;

        if (document.getElementById('txtbillwidth').style.backgroundColor != "#999999") {
            document.getElementById('txtbillwidth').disabled = true;
            document.getElementById('txtbillheight').disabled = true;
        }
        document.getElementById('txttranslationdisc').disabled = true;
        document.getElementById('txtpospremdisc').disabled = true;
        document.getElementById('drpbooktype').disabled = true;
        document.getElementById('txtciobookid').disabled = true;
        // txtappby.Enabled = true;
        //txtaudit.Enabled = true;
        document.getElementById('drpbullet').disabled = true;
        document.getElementById('drpdiscountprem').disabled = true;
        document.getElementById('txtrono').disabled = true;
        document.getElementById('txtrodate').disabled = true;
        document.getElementById('btnsharing').disabled = true;

        document.getElementById('drpbillstatus').disabled = true;
        document.getElementById('drprostatus').disabled = true;
        document.getElementById('txtagency').disabled = true;
        document.getElementById('txtclient').disabled = true;
        // txtagencyaddress.Enabled = true;
        document.getElementById('txtclientadd').disabled = false;
        document.getElementById('drpagscode').disabled = true;
        document.getElementById('txtdockitno1').disabled = true;
        document.getElementById('txtexecname').disabled = true;
        document.getElementById('drpretainer').disabled = true;
        document.getElementById('txtexeczone').disabled = true;
        document.getElementById('txtproduct').disabled = true;
        document.getElementById('drpbrand').disabled = true;
        document.getElementById('txtkeyno').disabled = false;
        document.getElementById('txtbillremark').disabled = true;

        document.getElementById('drppackage').disabled = true;
        document.getElementById('txtinsertion').disabled = true;
        document.getElementById('txtdummydate').disabled = true;
        document.getElementById('txtrepeatingdate').disabled = true;
        document.getElementById('drpbooktype').disabled = true;
        document.getElementById('drpadcategory').disabled = true;

        document.getElementById('drpadcat3').disabled = true;
        document.getElementById('drpadcat4').disabled = true;
        document.getElementById('drpadcat5').disabled = true;
        document.getElementById('drpbgcolor').disabled = true;
        document.getElementById('chkgstinc').disabled = true;
        document.getElementById('drpcolor').disabled = true;
        document.getElementById('drpuom').disabled = true;
        document.getElementById('drppageposition').disabled = true;
        document.getElementById('chkadon').disabled = true;
        document.getElementById('btnrefid').disabled = true;
        document.getElementById('txtreference').disabled = true;
        // txtadsizetypeheight.Enabled = true;
        //txtadsizetypewidth.Enabled = true;
        document.getElementById('txtratecode').disabled = true;
        document.getElementById('drpscheme').disabled = true;
        //  drpschemepck.Enabled = false;
        document.getElementById('drpcurrency').disabled = true;
        document.getElementById('drprptcurrency').disabled = true;
        document.getElementById('txtagreedrate').disabled = true;
        document.getElementById('drptranslation').disabled = true;
        document.getElementById('txtagreedamt').disabled = true;

        document.getElementById('txtextracharges').disabled = true;
        document.getElementById('txtspedisc').disabled = true;
        document.getElementById('txtspediscper').disabled = true;
        document.getElementById('txtspacedisc').disabled = true;
        document.getElementById('txtspadiscper').disabled = true;
        document.getElementById('txtdatetime').disabled = true;
        document.getElementById('txtrepeatingdate').disabled = true;

        document.getElementById('drpbillcycle').disabled = true;
        document.getElementById('drprevenue').disabled = true;
        //drpbilltype.Enabled = true;
        document.getElementById('drpbillstatus').disabled = true;
        //drpbillcurrency.Enabled = true;
        document.getElementById('drppaymenttype').disabled = true;
        document.getElementById('drpcashrecieved').disabled = true;
        document.getElementById('txtinvoice').disabled = true;
        document.getElementById('txtvts').disabled = true;
        if (document.getElementById('txtbillwidth').style.backgroundColor != "#999999") {
            document.getElementById('txtbillwidth').disabled = true;
            document.getElementById('txtbillheight').disabled = true;
        }
        document.getElementById('drpbillto').disabled = true;
        document.getElementById('txttradedisc').disabled = true;
        document.getElementById('chktrade').disabled = true;
        //                if (document.getElementById('hiddencancelcharge').value == "Y") {
        //                    document.getElementById('chkcanclecharges').disabled = true;
        //                    document.getElementById('chkcanclecharges').checked = true;
        //                }    
        document.getElementById('txtagencyoutstand').disabled = true;
        document.getElementById('txtcardrate').disabled = true;
        document.getElementById('txtcardamt').disabled = true;
        document.getElementById('txtdiscount').disabled = true;
        document.getElementById('txtdiscpre').disabled = true;
        document.getElementById('txtadsize2').disabled = true;
        document.getElementById('txtadsize1').disabled = true;
        document.getElementById('txttotalarea').disabled = true;
        document.getElementById('txtbilladdress').disabled = true;

        document.getElementById('drpboxcode').disabled = true;
        //txtboxno.Enabled = true;
        document.getElementById('txtboxaddress').disabled = true;

        document.getElementById('txtbillamt').disabled = true;

        document.getElementById('txtgrossamt').disabled = true;


        document.getElementById('drpboxcode').disabled = true;
        document.getElementById('chkage').disabled = true;
        document.getElementById('chkclie').disabled = true;
        document.getElementById('chktfn').disabled = true;

        document.getElementById('txtboxaddress').disabled = true;
        document.getElementById('txtinsertion').disabled = true;

        document.getElementById('txtcolum').disabled = true;

        document.getElementById('txtboxno').disabled = true;
        document.getElementById('drpmatstat').disabled = true;


        ///////////////////////
        document.getElementById('txtcontractname').disabled = true;
        document.getElementById('txtcontracttype').disabled = true;
        document.getElementById('txtcardname').disabled = true;
        document.getElementById('drptype').disabled = true;
        document.getElementById('drpmonth').disabled = true;
        document.getElementById('drpyear').disabled = true;
        document.getElementById('txtcardno').disabled = true;
        document.getElementById('btnshgrid').disabled = false;
        document.getElementById('btndeal').disabled = true;
        //chequeinfo
        document.getElementById('ttextchqno').disabled = true;
        document.getElementById('ttextchqdate').disabled = true;
        document.getElementById('ttextchqamt').disabled = true;
        document.getElementById('ttextbankname').disabled = true;
        document.getElementById('drpourbank').disabled = true;
        document.getElementById('drpbullet').disabled = true;
        document.getElementById('drpdiscountprem').disabled = true;
        document.getElementById('txttradedisc').disabled = true;
        document.getElementById('chktrade').disabled = true;
        //                if(document.getElementById('txtaddagencycommrate')!=null)
        //            document.getElementById('txtaddagencycommrate').disabled = true;
    }
    else if (insertstatus == "0") {
        if (document.getElementById('txtbillwidth').style.backgroundColor != "#999999") {
            document.getElementById('txtbillwidth').disabled = false;
            document.getElementById('txtbillheight').disabled = false;
        }
        if (document.getElementById('hidonline').value == "Y" && online_flag == true) {
            document.getElementById('chkonline').disabled = false;
            online_flag = false;
        }
        else
            document.getElementById('chkonline').disabled = true;
        //          if(document.getElementById('txtaddagencycommrate')!=null)
        //              document.getElementById('txtaddagencycommrate').disabled = false;
        document.getElementById('txttranslationdisc').disabled = false;
        document.getElementById('txtpospremdisc').disabled = false;
        if (document.getElementById('hiddenuomdesc').value != 'CD')
            document.getElementById('drpbullet').disabled = false;
        document.getElementById('drpdiscountprem').disabled = false;
        document.getElementById('txtRetainercomm').disabled = false;
        //           if(document.getElementById('txtaddagencycommrateamt')!=null)
        //            document.getElementById('txtaddagencycommrateamt').disabled = false;
        document.getElementById('drpcoutype').disabled = false;
        document.getElementById('txtcouno').disabled = false;
        document.getElementById('btndeal').disabled = false;
        document.getElementById('btnshgrid').disabled = false;
        //btnupload.Enabled = true;
        document.getElementById('drpbooktype').disabled = false;
        document.getElementById('txtciobookid').disabled = true;
        // txtappby.Enabled = true;
        //txtaudit.Enabled = true;
        document.getElementById('txtrono').disabled = false;
        document.getElementById('txtrodate').disabled = false;
        document.getElementById('btnsharing').disabled = false;
        document.getElementById('drpbillstatus').disabled = false;
        document.getElementById('drprostatus').disabled = false;
        document.getElementById('txtagency').disabled = false;
        document.getElementById('txtclient').disabled = false;
        // txtagencyaddress.Enabled = true;
        document.getElementById('txtclientadd').disabled = false;
        document.getElementById('drpagscode').disabled = false;
        document.getElementById('txtdockitno1').disabled = true;
        document.getElementById('txtexecname').disabled = false;
        document.getElementById('txtexeczone').disabled = false;
        document.getElementById('txtproduct').disabled = false;
        document.getElementById('drpbrand').disabled = false;
        document.getElementById('txtkeyno').disabled = false;
        document.getElementById('txtbillremark').disabled = false;
        document.getElementById('txtprintremark').disabled = false;
        document.getElementById('drppackage').disabled = false;
        document.getElementById('txtinsertion').disabled = true;
        document.getElementById('txtdummydate').disabled = true;
        document.getElementById('txtrepeatingdate').disabled = false;
        document.getElementById('drpbooktype').disabled = false;
        document.getElementById('drpadcategory').disabled = false;
        document.getElementById('drpadsubcategory').disabled = false;
        document.getElementById('drpadcat3').disabled = false;
        document.getElementById('drpadcat4').disabled = false;
        document.getElementById('drpadcat5').disabled = false;



        document.getElementById('drpbgcolor').disabled = false;

        //document.getElementById('drpbgcolor').disabled = false;

        document.getElementById('drpcolor').disabled = false;
        document.getElementById('chkgstinc').disabled = false;
        document.getElementById('drpuom').disabled = false;
        document.getElementById('drppageposition').disabled = false;
        document.getElementById('chkadon').disabled = true;
        document.getElementById('btnrefid').disabled = true;
        document.getElementById('txtreference').disabled = true;
        // txtadsizetypeheight.Enabled = true;
        //txtadsizetypewidth.Enabled = true;
        document.getElementById('txtratecode').disabled = false;
        document.getElementById('drpscheme').disabled = true;
        //drpschemepck.Enabled = true;
        document.getElementById('drpcurrency').disabled = false;
        document.getElementById('drprptcurrency').disabled = false;
        //   txtagreedrate.Enabled = true;
        //  txtagreedamt.Enabled = true;

        document.getElementById('txtextracharges').disabled = false;
        if (document.getElementById('hidspldisedit').value == "Y") {
            document.getElementById('txtspediscper').disabled = false;
            document.getElementById('txtspedisc').disabled = false;

        }
        else {
            document.getElementById('txtspediscper').disabled = true;
            document.getElementById('txtspedisc').disabled = true;
        }
        document.getElementById('txtspacedisc').disabled = false;
        if (document.getElementById('hiddenuomdesc').value == "CD") {
            document.getElementById('txtspadiscper').disabled = false;
        }
        else {
            document.getElementById('txtspadiscper').disabled = true;
        }
        document.getElementById('txtdatetime').disabled = true;
        document.getElementById('txtrepeatingdate').disabled = false;

        document.getElementById('drpbillcycle').disabled = false;
        document.getElementById('drprevenue').disabled = false;
        //drpbilltype.Enabled = true;
        document.getElementById('drpbillstatus').disabled = false;
        //drpbillcurrency.Enabled = true;
        document.getElementById('drppaymenttype').disabled = true;
        document.getElementById('drpcashrecieved').disabled = false;
        document.getElementById('txtinvoice').disabled = false;
        document.getElementById('txtvts').disabled = false;
        document.getElementById('txtcirrate').disabled = false;
        document.getElementById('txtciragency').disabled = false;
        document.getElementById('txtciredition').disabled = true;
        document.getElementById('drpbillto').disabled = false;
        if (document.getElementById('hiddeneiitagcomm').value == "N") {
            document.getElementById('txttradedisc').disabled = true;
            document.getElementById('chktrade').disabled = true;
            if (document.getElementById('txtaddagencycommrate') != null) {
                document.getElementById('txtaddagencycommrate').disabled = true;
                document.getElementById('txtaddagencycommrateamt').disabled = true;

            }
        }
        else if (document.getElementById('hiddeneiitagcomm').value == "T") {
            document.getElementById('txttradedisc').disabled = false;
            document.getElementById('chktrade').disabled = false;
            if (document.getElementById('txtaddagencycommrate') != null) {
                document.getElementById('txtaddagencycommrate').disabled = true;

                document.getElementById('txtaddagencycommrateamt').disabled = true;

            }
        }
        else if (document.getElementById('hiddeneiitagcomm').value == "A") {
            document.getElementById('txttradedisc').disabled = true;
            document.getElementById('chktrade').disabled = true;
            if (document.getElementById('txtaddagencycommrate') != null) {
                document.getElementById('txtaddagencycommrate').disabled = false;

                document.getElementById('txtaddagencycommrateamt').disabled = false;

            }
        }
        else {
            document.getElementById('txttradedisc').disabled = false;
            document.getElementById('chktrade').disabled = false;
            if (document.getElementById('txtaddagencycommrate') != null) {
                document.getElementById('txtaddagencycommrate').disabled = false;

                document.getElementById('txtaddagencycommrateamt').disabled = false;

            }
        }
        if (document.getElementById('hiddencancelcharge').value == "Y") {
            document.getElementById('chkcanclecharges').disabled = false;

        }
        else {
            document.getElementById('chkcanclecharges').disabled = true;

        }

        //             if (document.getElementById('hiddencancelcharge').value == "Y") {
        //            document.getElementById('chkcanclecharges').disabled = false;
        //            document.getElementById('chkcanclecharges').checked = true;
        //        }

        document.getElementById('txtagencyoutstand').disabled = true;
        document.getElementById('txtcardrate').disabled = true;
        document.getElementById('txtcardamt').disabled = true;
        document.getElementById('txtdiscount').disabled = true;
        document.getElementById('txtdiscpre').disabled = true;
        document.getElementById('txtadsize2').disabled = false;
        document.getElementById('txtadsize1').disabled = false;
        if (document.getElementById('hidlineedit').value == "y")
            document.getElementById('txttotalarea').disabled = false;
        document.getElementById('txtbilladdress').disabled = false;

        document.getElementById('drpboxcode').disabled = false;
        //txtboxno.Enabled = true;
        document.getElementById('txtboxaddress').disabled = false;

        document.getElementById('txtbillamt').disabled = true;

        document.getElementById('txtgrossamt').disabled = true;
        document.getElementById('drpboxcode').disabled = false;
        document.getElementById('chkage').disabled = false;
        document.getElementById('chkclie').disabled = false;
        document.getElementById('chktfn').disabled = false;

        document.getElementById('txtboxaddress').disabled = false;
        document.getElementById('txtinsertion').disabled = false;
        document.getElementById('txtcolum').disabled = false;
        document.getElementById('drpmatstat').disabled = false;



        ///////////////////////
        document.getElementById('txtcontractname').disabled = false;
        document.getElementById('txtcontracttype').disabled = false;
        document.getElementById('txtcardname').disabled = false;
        document.getElementById('drptype').disabled = false;
        document.getElementById('drpmonth').disabled = false;
        document.getElementById('drpyear').disabled = false;
        document.getElementById('txtcardno').disabled = false;
        if (hidcopy == "copy") {
            document.getElementById('btncopy').disabled = false;
        }
        else {
            document.getElementById('btncopy').disabled = true;
        }
        var per = "Y";
        if (per == "Y")
            document.getElementById('btncopy').disabled = false;
        // document.getElementById('btndel').disabled = false;
        document.getElementById('btnshgrid').disabled = false;
        document.getElementById('btndeal').disabled = false;

        //chequeinfo
        document.getElementById('ttextchqno').disabled = true;
        document.getElementById('ttextchqdate').disabled = true;
        document.getElementById('ttextchqamt').disabled = true;
        document.getElementById('ttextbankname').disabled = true;
        document.getElementById('drpourbank').disabled = true;
        if (document.getElementById('drppaymenttype').value == "CH0" || document.getElementById('drppaymenttype').value == "DD0" || document.getElementById('drppaymenttype').value == 'PO0' || document.getElementById('drppaymenttype').value == 'AD0')  //CR0 is Credit Card code and DD0 is demand draft
        {
            document.getElementById('ttextchqno').disabled = false;
            document.getElementById('ttextchqdate').disabled = false;
            document.getElementById('ttextchqamt').disabled = false;
            document.getElementById('ttextbankname').disabled = false;
            document.getElementById('drpourbank').disabled = false;
            document.getElementById('txtcardname').disabled = true;
            document.getElementById('drptype').disabled = true;
            document.getElementById('drpmonth').disabled = true;
            document.getElementById('drpyear').disabled = true;
            document.getElementById('txtcardno').disabled = true;
        }
        else if (document.getElementById('drppaymenttype').value == "CR0") {
            document.getElementById('ttextchqno').disabled = true;
            document.getElementById('ttextchqdate').disabled = true;
            document.getElementById('ttextchqamt').disabled = true;
            document.getElementById('ttextbankname').disabled = true;
            document.getElementById('drpourbank').disabled = true;
            document.getElementById('txtcardname').disabled = false;
            document.getElementById('drptype').disabled = false;
            document.getElementById('drpmonth').disabled = false;
            document.getElementById('drpyear').disabled = false;
            document.getElementById('txtcardno').disabled = false;
        }
        document.getElementById('txtRetainercomm').disabled = false;
        document.getElementById('txtRetainercommamt').disabled = false;
    }
    for (var j = 0; j <= dex.Tables[0].Rows.length - 1; j++) {
        if (dex.Tables[0].Rows[j].Insert_status == "billed" || dex.Tables[0].Rows[j].Insert_status == "cancel") {
            document.getElementById('btncopy').disabled = true;
            document.getElementById('drppackage').disabled = true;
        }
        else {
            document.getElementById('btncopy').disabled = false;
            document.getElementById('drppackage').disabled = false;
            break;
        }
    }
    var ag = Classified_Booking.GETCASH_PAY(document.getElementById('hiddencompcode').value, document.getElementById('drppaymenttype').value);
    var ds_n = ag.value;
    var cashdiscount = 'N';
    if (ds_n != null && ds_n.Tables[0].Rows.length > 0) {
        cashdiscount = ds_n.Tables[0].Rows[0].CASHDISCOUNT;
    }
    if (cashdiscount == 'Y') {
        document.getElementById('cashrecvd').style.display = "";
        document.getElementById('txtcashdiscount').disabled = false;
    }
    else {
        document.getElementById('cashrecvd').style.display = "none";
        document.getElementById('txtcashdiscount').disabled = true;
    }

    if (document.getElementById('hiddenuomdesc').value == "CD") {
        if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtcolum').value != "") {
            document.getElementById('txtadsize2').disabled = true;
            document.getElementById('txtadsize1').style.backgroundColor = "#FFFFFF";
            document.getElementById('txtadsize2').style.backgroundColor = "#FFFFFF";
            document.getElementById('txtcolum').style.backgroundColor = "#FFFFFF";

        }
        else if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtadsize2').value != "") {
            document.getElementById('txtcolum').disabled = true;
            document.getElementById('txtadsize1').style.backgroundColor = "#FFFFFF";
            document.getElementById('txtadsize2').style.backgroundColor = "#FFFFFF";
            document.getElementById('txtcolum').style.backgroundColor = "#FFFFFF";

        }


    }
    else if (document.getElementById('hiddenuomdesc').value != "CD") {
        document.getElementById('txtadsize1').disabled = true;
        document.getElementById('txtadsize2').disabled = true;
        if (document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROD") {
            document.getElementById('Label1').value = "No. Of Lines";
            document.getElementById('txtadsize1').style.backgroundColor = "#999999";
            document.getElementById('txtadsize2').style.backgroundColor = "#999999";
            document.getElementById('txtcolum').style.backgroundColor = "#999999";
            document.getElementById('txtcolum').disabled = true;


        }
        else if (document.getElementById('hiddenuomdesc').value == "ROW") {
            document.getElementById('Label1').value = "No. Of Words";
            document.getElementById('txtadsize1').style.backgroundColor = "#999999";
            document.getElementById('txtadsize2').style.backgroundColor = "#999999";
            document.getElementById('txtcolum').style.backgroundColor = "#999999";
            document.getElementById('txtcolum').disabled = true;
        }

    }

    //document.getElementById('drpretainer').disabled = false;
    //          if(document.getElementById('txtaddagencycommrate')!=null)
    //            document.getElementById('txtaddagencycommrate').disabled = false;
    //saveormodify = "01";
    var listpck = document.getElementById('hiddenpackage').value;
    //ScriptManager.RegisterClientScriptBlock(this, typeof(Classified_Booking), "c1", "bindgridpkg('" + listpck + "')", true);            
    // ScriptManager.RegisterClientScriptBlock(this, typeof(Classified_Booking), "cc", "showgridexecute()", true);
    //    enableGridItems();
    if (hidcopy == "copy") {
        document.getElementById('hiddendummycioid').value = document.getElementById('txtciobookid').value;
        document.getElementById('hiddensavemod').value = "0";
        agreedrate_active = 0;
        agreedamt_active = 0;
        document.getElementById('txtagreedrate').value = "";
        document.getElementById('txtagreedamt').value = "";
        document.getElementById('txtdiscount').value = "";
        document.getElementById('txtdiscpre').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtbillamt').value = "";
        document.getElementById('hiddenprevamt').value = "";
        document.getElementById('txtagreedrate').className = ' btextforbookrightsmall';
        document.getElementById('txtagreedamt').className = ' btextforbookrightsmall';
        // autogenerated("0");
        var username = Classified_Booking.getusername();
        document.getElementById('txtbookedby').value = username.value;
        showgridexecute();
        document.getElementById('txtdummydate').disabled = false;
        autogeneratedtempid();
        if ((document.getElementById('txtagencypaymode').value == "CR1" && document.getElementById('creditreceipt_allow').value == "Y")) // for credit 
            autogenerated("3");
    }
    else {
        showgridexecute();
    }
    // showgridexecute1(hidcopy);

    chkstatus(document.getElementById('hiddenbuttonidcheck').value);
    document.getElementById('btnSave').disabled = false;
    document.getElementById('btnQuery').disabled = true;
    document.getElementById('btnshgrid').disabled = false;
    //        document.getElementById('txtRetainercommamt').disabled = true;
    //      document.getElementById('txtRetainercomm').disabled = true;
    var clientnam = document.getElementById('txtclient').value;

    if (document.getElementById('hdnregclient').value == "Y") {
        if (clientnam.split('(').length <= 1) {
            document.getElementById('regclient').style.display = "";
            document.getElementById('regclient').disabled = false;
        }
    }
    setButtonImages();
    return false;

}
function nodateentry(evt) {
    var charCode = (evt.which) ? evt.which : event.keyCode
    //alert(event.keyCode)
    if (charCode >= 0 && charCode <= 1000)

    //document.getElementById('txtdummydate').value="";
        return false;
}
function checknumeric(evt) {
    var charCode = event.keyCode

    if ((charCode >= 48 && charCode <= 57) || (charCode >= 96 && charCode <= 105) || (charCode == 127) || (charCode == 8) || (charCode == 9) || (charCode == 46)) {
        return true;
    }
    else {
        return false;
    }

}
function fillDATA() {
    var msg = checkSession();
    if (msg == false) {
        window.location.href = "login.aspx";
        return false;
    }
    document.getElementById('btnShow').disabled = false;
    var dateformat = document.getElementById('hiddendateformat').value;
    document.getElementById('hiddensavemod').value = "1";
    globfromline = "";
    if (executequery.Tables[0].Rows.length > 0) {
        if (executequery.Tables[0].Rows[rownumEx].prev_booking != null && executequery.Tables[0].Rows[rownumEx].prev_booking != "") {
            var res = Classified_Booking.checkCIOIDReference(document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[rownumEx].cio_booking_id);
            if (res.value != null) {
                if (executequery.Tables[0].Rows[rownumEx].cio_booking_id != res.value) {
                    alert("CIO ID " + executequery.Tables[0].Rows[rownumEx].cio_booking_id + " has been ReScheduled to New CIO ID " + res.value);
                    return false;
                }
            }
        }
        document.getElementById('txtquotationno').disabled = true

        if (executequery.Tables[0].Rows[0].QUOTATION_NO != null) {
            document.getElementById('txtquotationno').value = executequery.Tables[0].Rows[0].QUOTATION_NO;
        } else {
            document.getElementById('txtquotationno').value = "";
        }
         //////////////////anuja
        if (executequery.Tables[0].Rows[rownumEx].INDUSTRY_NAME != null) {
            document.getElementById('txtindustry').value = executequery.Tables[0].Rows[rownumEx].INDUSTRY_NAME;
        }
        else {
            document.getElementById('txtindustry').value = "";
        }

        var res56 = Classified_Booking.productbind(document.getElementById('hiddencompcode').value, document.getElementById('txtindustry').value.substring(document.getElementById('txtindustry').value.lastIndexOf('(') + 1, document.getElementById('txtindustry').value.lastIndexOf(')')));
        var dsvarient345 = res56.value;
        if (dsvarient345 == null) {
            alert(res56.error.description)
            return false;
        }
        //document.getElementById('drpproductcat').options.length = 0;
        // document.getElementById('drpproductcat').options[0] = new Option("Select productsubcat", "0");
        //document.getElementById('drpproductcat').options.length = 0;
        document.getElementById('drpproductcat').options.length = 0;
        for (var i = 0; i < dsvarient345.Tables[0].Rows.length; ++i) {
            document.getElementById('drpproductcat').options[document.getElementById('drpproductcat').options.length] = new Option(dsvarient345.Tables[0].Rows[i].prod_desc, dsvarient345.Tables[0].Rows[i].prod_cat_code);
            document.getElementById('drpproductcat').options.length;
            if (executequery.Tables[0].Rows[rownumEx].product == document.getElementById('drpproductcat').options[i].value) {
                document.getElementById('drpproductcat').value = executequery.Tables[0].Rows[rownumEx].product.toString();
            }
        }
        if (executequery.Tables[0].Rows[rownumEx].product == null || executequery.Tables[0].Rows[rownumEx].product.toString() == "") {
            document.getElementById('drpproductcat').options.length = 0;
            //document.getElementById('drpproductcat').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].PACKAGE_TYPE != null) {
            if (executequery.Tables[0].Rows[rownumEx].PACKAGE_TYPE == "A") {
                document.getElementById('chkadon').checked = true;
                document.getElementById('lbreference').style.display = "block";
                document.getElementById('tdref').style.display = "block";
                //  document.getElementById('btnrefid').style.display="block";
            }
            else {
                document.getElementById('chkadon').checked = false;
                document.getElementById('lbreference').style.display = "none";
                document.getElementById('tdref').style.display = "none";
                //   document.getElementById('btnrefid').style.display="none";
            }
        }
                
        if (executequery.Tables[0].Rows[rownumEx].AD_REFID != null) {
            document.getElementById('txtreference').value = executequery.Tables[0].Rows[rownumEx].AD_REFID;
        }
        else {
            document.getElementById('txtreference').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].REPRESENTATIVE != null) {
            document.getElementById('txtcolexec').value = executequery.Tables[0].Rows[rownumEx].REPRESENTATIVE;
        }
        else {
            document.getElementById('txtcolexec').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].TEAM_CODE != null) {
            document.getElementById('hdnteamcode').value = executequery.Tables[0].Rows[rownumEx].TEAM_CODE;
        }
        else {
            document.getElementById('hdnteamcode').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].FIXED_BOOKING != null) {
            fixed_booking = executequery.Tables[0].Rows[rownumEx].FIXED_BOOKING;
        }


        if (executequery.Tables[0].Rows[rownumEx].VAT_CODE != null) {
            document.getElementById('hdnvts').value = executequery.Tables[0].Rows[rownumEx].VAT_CODE;
        }
        else {
            document.getElementById('hdnvts').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].LOCALGROSSAMT != null) {
            document.getElementById('txtgrossamtlocal').value = executequery.Tables[0].Rows[rownumEx].LOCALGROSSAMT;
        }
        if (executequery.Tables[0].Rows[rownumEx].CPN_CODE != null && executequery.Tables[0].Rows[rownumEx].CPN_CODE != "") {
            document.getElementById('drpcoutype').value = executequery.Tables[0].Rows[rownumEx].CPN_CODE;
        }
        else {
            document.getElementById('drpcoutype').value = "0";
        }

        if (executequery.Tables[0].Rows[rownumEx].CPN_NAME != null) {
            document.getElementById('txtcouno').value = executequery.Tables[0].Rows[rownumEx].CPN_NAME;
        }
        else {
            document.getElementById('txtcouno').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CLIENT_CAT_DISC != null) {
            document.getElementById('txtclientcatdisc').value = executequery.Tables[0].Rows[rownumEx].CLIENT_CAT_DISC;
        }
        else {
            document.getElementById('txtclientcatdisc').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CLIENT_CAT_D_AMT != null) {
            document.getElementById('txtclientcatam').value = executequery.Tables[0].Rows[rownumEx].CLIENT_CAT_D_AMT;
        }
        else {
            document.getElementById('txtclientcatam').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CLIENT_CAT_D_TYP != null) {
            document.getElementById('hdnclientcatdistype').value = executequery.Tables[0].Rows[rownumEx].CLIENT_CAT_D_TYP;
        }
        else {
            document.getElementById('hdnclientcatdistype').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].FLAT_FEQ_DISC != null) {
            document.getElementById('txtflatfreqdisc').value = executequery.Tables[0].Rows[rownumEx].FLAT_FEQ_DISC;
        }
        else {
            document.getElementById('txtflatfreqdisc').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].FLAT_FEQ_D_AMT != null) {
            document.getElementById('txtflatfreqamt').value = executequery.Tables[0].Rows[rownumEx].FLAT_FEQ_D_AMT;
        }
        else {
            document.getElementById('txtflatfreqamt').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].FLAT_FEQ_D_TYP != null) {
            document.getElementById('hdnflatfreqdisctype').value = executequery.Tables[rownumEx].Rows[0].FLAT_FEQ_D_TYP;
        }
        else {
            document.getElementById('hdnflatfreqdisctype').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CAT_DISC != null) {
            document.getElementById('txtcatdisc').value = executequery.Tables[0].Rows[rownumEx].CAT_DISC;
        }
        else {
            document.getElementById('txtcatdisc').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CAT_D_AMT != null) {
            document.getElementById('txtcatamt').value = executequery.Tables[0].Rows[rownumEx].CAT_D_AMT;
        }
        else {
            document.getElementById('txtcatamt').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CAT_D_TYP != null) {
            document.getElementById('hdncatdisctype').value = executequery.Tables[0].Rows[rownumEx].CAT_D_TYP;
        }
        else {
            document.getElementById('hdncatdisctype').value = "";
        }
        //Inserting in hidden field to compare new and  Previous amount 
        if (executequery.Tables[0].Rows[rownumEx].LOCALBILLAMT != null) {
            document.getElementById('txtbillamtlocal').value = executequery.Tables[0].Rows[rownumEx].LOCALBILLAMT;
        }
        if (executequery.Tables[0].Rows[rownumEx].ATTACHMENT1 != null && executequery.Tables[0].Rows[rownumEx].ATTACHMENT1 != "") {
            document.getElementById('hidattach1').value = executequery.Tables[0].Rows[rownumEx].ATTACHMENT1;
            document.getElementById('attachment1').src = "Images/indexred.jpg";
        }
        if (executequery.Tables[0].Rows[rownumEx].ATTACHMENT2 != null && executequery.Tables[0].Rows[rownumEx].ATTACHMENT2 != "") {
            document.getElementById('hidattach2').value = executequery.Tables[0].Rows[rownumEx].ATTACHMENT2;
            document.getElementById('attachment2').src = "Images/indexred.jpg";
        }
        if (executequery.Tables[0].Rows[rownumEx].pub_center != null) {
            document.getElementById('hiddencenter').value = executequery.Tables[0].Rows[rownumEx].pub_center;
        }
        if (executequery.Tables[0].Rows[rownumEx].branch != null) {
            document.getElementById('txtbranch').value = executequery.Tables[0].Rows[rownumEx].branch;
        }
        else {
            document.getElementById('txtbranch').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CREATION_DATETIME != null) {
            document.getElementById('lblcreationdatetime').innerHTML = executequery.Tables[0].Rows[rownumEx].CREATION_DATETIME;
        }
        else {
            document.getElementById('lblcreationdatetime').innerHTML = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].BRANCH_NAME != null) {
            document.getElementById('txtbranch_name').value = executequery.Tables[0].Rows[rownumEx].BRANCH_NAME;
        }
        else {
            document.getElementById('txtbranch_name').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CLIENT_TYPE != null) {
            document.getElementById('drpregular').value = executequery.Tables[0].Rows[rownumEx].CLIENT_TYPE;
        }
        else {
            document.getElementById('drpregular').value = "0";
        }
        if (executequery.Tables[0].Rows[rownumEx].TRANSLATION_CODE != null) {
            document.getElementById('drptranslation').value = executequery.Tables[0].Rows[rownumEx].TRANSLATION_CODE;
        }
        else {
            document.getElementById('drptranslation').value = "0";
        }
        if (executequery.Tables[0].Rows[0].TRANSLATION_DISC != null) {
            document.getElementById('txttranslationdisc').value = executequery.Tables[0].Rows[0].TRANSLATION_DISC;
        }
        else {
            document.getElementById('txttranslationdisc').value = "";
        }
        if (executequery.Tables[0].Rows[0].POSPREM_DISC != null) {
            document.getElementById('txtpospremdisc').value = executequery.Tables[0].Rows[0].POSPREM_DISC;
        }
        else {
            document.getElementById('txtpospremdisc').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].TRANSLATION_PREMIUM != null) {
            document.getElementById('txttranslationcharges').value = executequery.Tables[0].Rows[rownumEx].TRANSLATION_PREMIUM;
            document.getElementById('hiddentranalpremtype').value = executequery.Tables[0].Rows[rownumEx].TRANSLATION_TYPE;
            hdntranschgon=executequery.Tables[0].Rows[rownumEx].TRANSLATION_CHGON;
        }
        else {
            document.getElementById('txttranslationcharges').value = "";
            document.getElementById('hiddentranalpremtype').value = "";
            hdntranschgon="";
        }
        if (executequery.Tables[0].Rows[rownumEx].REVISE_DATE != null) {
            document.getElementById('txtrevisedate').value = executequery.Tables[0].Rows[rownumEx].REVISE_DATE;
        }
        else {
            document.getElementById('txtrevisedate').value = "";
        }

        if (executequery.Tables[0].Rows[rownumEx].MOBILENO != null) {
            document.getElementById('txtMobile').value = executequery.Tables[0].Rows[rownumEx].MOBILENO;
        }
        else {
            document.getElementById('txtMobile').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].BARTE_AMOUNT != null) {
            document.getElementById('hiddenbarteramt').value = executequery.Tables[0].Rows[rownumEx].BARTE_AMOUNT;
        }
        else {
            document.getElementById('hiddenbarteramt').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].BARTERTYPE != null && executequery.Tables[0].Rows[rownumEx].BARTE_DESC != null) {
            document.getElementById('txtbartertype').value = executequery.Tables[0].Rows[rownumEx].BARTE_DESC + '(' + executequery.Tables[0].Rows[rownumEx].BARTERTYPE + ')';
        }
        else {
            document.getElementById('txtbartertype').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CIRRATE != null) {
            document.getElementById('txtcirrate').value = executequery.Tables[0].Rows[rownumEx].CIRRATE;
        }
        else {
            document.getElementById('txtcirrate').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CIRPUBLICATION != null) {
            document.getElementById('hiddencirpub').value = executequery.Tables[0].Rows[rownumEx].CIRPUBLICATION;
        }
        else {
            document.getElementById('hiddencirpub').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CIREDITION != null) {
            document.getElementById('hiddenciredi').value = executequery.Tables[0].Rows[rownumEx].CIREDITION;
        }
        else {
            document.getElementById('hiddenciredi').value = "";
        }
        document.getElementById('txtciragency').value = "";
        // for getting circulation agency name
        if (executequery.Tables[0].Rows[rownumEx].CIRAGENCY != null && executequery.Tables[0].Rows[rownumEx].CIRAGENCY_SUBCODE != null && executequery.Tables[0].Rows[rownumEx].CIRAGENCY != "") {
            var resagname = Classified_Booking.getcirAgency(document.getElementById('hiddencompcode').value, document.getElementById('txtbranch').value, executequery.Tables[0].Rows[rownumEx].CIRAGENCY, executequery.Tables[0].Rows[rownumEx].CIRAGENCY_SUBCODE);
            if (resagname.value == null) {
                alert(resagname.error.description);
                return false;
            }
            if (resagname.value.Tables.length > 0 && resagname.value.Tables[0].Rows.length > 0) {
                if (resagname.value.Tables[0].Rows[0].AGENCYNAME != null)
                    document.getElementById('txtciragency').value = resagname.value.Tables[0].Rows[0].AGENCYNAME + '(' + executequery.Tables[0].Rows[rownumEx].CIRAGENCY + ' + ' + executequery.Tables[0].Rows[rownumEx].CIRAGENCY_SUBCODE + ')';
                else
                    document.getElementById('txtciragency').value = "";
            }
        }
        // for getting circulation EDITION name
        document.getElementById('txtciredition').value = "";
        if (executequery.Tables[0].Rows[rownumEx].CIREDITION != null && executequery.Tables[0].Rows[rownumEx].CIREDITION != "") {
            var resagname = Classified_Booking.getcirEdition(document.getElementById('hiddencompcode').value, document.getElementById('hiddenciredi').value);
            if (resagname.value == null) {
                alert(resagname.error.description);
                return false;
            }
            if (resagname.value.Tables.length > 0 && resagname.value.Tables[0].Rows.length > 0) {
                if (resagname.value.Tables[0].Rows[0].EDITIONNAME != null)
                    document.getElementById('txtciredition').value = resagname.value.Tables[0].Rows[0].EDITIONNAME;
            }
        }
        if (executequery.Tables[0].Rows[rownumEx].booked_by != null) {
            document.getElementById('txtbookedby').value = executequery.Tables[0].Rows[rownumEx].booked_by;
        }
        else {
            document.getElementById('txtbookedby').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].prev_booking != null) {
            document.getElementById('txtprevbook').value = executequery.Tables[0].Rows[rownumEx].prev_booking;
        }
        else {
            document.getElementById('txtprevbook').value = "";
        }
        if (document.getElementById('txtaddagencycommrateamt') != null) {
            if (executequery.Tables[0].Rows[rownumEx].ADD_AGENCY_COMM_AMT != null) {
                document.getElementById('txtaddagencycommrateamt').value = executequery.Tables[0].Rows[rownumEx].ADD_AGENCY_COMM_AMT;
            }
            else {
                document.getElementById('txtaddagencycommrateamt').value = "";
            }
        }
        if (executequery.Tables[0].Rows[rownumEx].RETAINER_COMM_AMT != null) {
            document.getElementById('txtRetainercommamt').value = executequery.Tables[0].Rows[rownumEx].RETAINER_COMM_AMT;
        }
        else {
            document.getElementById('txtRetainercommamt').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].RETAINER_COMM != null) {
            if (executequery.Tables[0].Rows[rownumEx].RETAINER_COMM1 != null)
                document.getElementById('txtRetainercomm').value = executequery.Tables[0].Rows[rownumEx].RETAINER_COMM1;
            else
                document.getElementById('txtRetainercomm').value = executequery.Tables[0].Rows[rownumEx].RETAINER_COMM;
        }
        else {
            document.getElementById('txtRetainercomm').value = "";
        }
        if (hidcopy != "copy") {
            var datetime = executequery.Tables[0].Rows[rownumEx].DATE_TIME;
            if (datetime != null) {
                document.getElementById('txtdatetime').value = datetime;
                /* if(document.getElementById('hiddenconnect')!=null)
                {
                if(document.getElementById('hiddenconnect').value=='sql')
                document.getElementById('txtdatetime').value = datetime;
                else
                document.getElementById('txtdatetime').value = date_frmt_orcl_no(dateformat, datetime);
                }    
                else
                {
                document.getElementById('txtdatetime').value = date_frmt_orcl_no(dateformat, datetime);
                }*/
            }
            else {
                document.getElementById('txtdatetime').value = "";
            }
        }
        if (executequery.Tables[0].Rows[rownumEx].boxchrg != null) {
            boxpercen = executequery.Tables[0].Rows[rownumEx].boxchrg;
            document.getElementById('hiddenboxchrgtype').value = executequery.Tables[0].Rows[rownumEx].boxchargetype;
        }


        if (executequery.Tables[0].Rows[rownumEx].APP_USER != null) {
            document.getElementById('txtappby').value = executequery.Tables[0].Rows[rownumEx].APP_USER;
        }
        else {
            document.getElementById('txtappby').value = "";
        }
        //  alert(executequery.Tables[0].Rows[rownumEx].ONLINE_AD);
        if (executequery.Tables[0].Rows[rownumEx].ONLINE_AD != null && executequery.Tables[0].Rows[rownumEx].ONLINE_AD == "Y") {
            document.getElementById('chkonline').checked = true;
        }
        else {
            document.getElementById('chkonline').checked = false;
        }

        if (executequery.Tables[0].Rows[rownumEx].audit != null) {
            document.getElementById('txtaudit').value = executequery.Tables[0].Rows[rownumEx].audit;
        }
        else {
            document.getElementById('txtaudit').value = "";
        }


        if (executequery.Tables[0].Rows[rownumEx].cio_booking_id != null) {
            document.getElementById('txtciobookid').value = executequery.Tables[0].Rows[rownumEx].cio_booking_id;
        }
        else {
            document.getElementById('txtciobookid').value = "";
        }
        //txtappby.Text = executequery.Tables[0].Rows[rownumEx].ItemArray[5].ToString();
        // txtaudit.Text = executequery.Tables[0].Rows[rownumEx].ItemArray[6].ToString();
        if (executequery.Tables[0].Rows[rownumEx].RO_No != null) {
            document.getElementById('txtrono').value = executequery.Tables[0].Rows[rownumEx].RO_No;
        }
        else {
            document.getElementById('txtrono').value = "";
        }
        var ro_date = executequery.Tables[0].Rows[rownumEx].RO_Date;
        if (ro_date != null) {
            document.getElementById('txtrodate').value = ro_date;
            /*  if(document.getElementById('hiddenconnect')!=null)
            {
            if(document.getElementById('hiddenconnect').value=='sql')
            document.getElementById('txtrodate').value =  ro_date;
            else
            document.getElementById('txtrodate').value = date_frmt_orcl_no(dateformat, ro_date);
            }    
            else
            {
            document.getElementById('txtrodate').value = date_frmt_orcl_no(dateformat, ro_date);
            }*/

        }
        else {
            document.getElementById('txtrodate').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].bill_status != null) {
            document.getElementById('drpbillstatus').value = executequery.Tables[0].Rows[rownumEx].bill_status;
        }
        else {
            document.getElementById('drpbillstatus').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].ro_status != null) {
            document.getElementById('drprostatus').value = executequery.Tables[0].Rows[rownumEx].ro_status;
            rostatusmain = document.getElementById('drprostatus').value;
        }
        else {
            document.getElementById('drprostatus').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].AgencyName != null) {
            document.getElementById('txtagency').value = executequery.Tables[0].Rows[rownumEx].AgencyName;
        }
        else {
            document.getElementById('txtagency').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].EDTN_WISE_BILL_REQ != null) {

            if (executequery.Tables[0].Rows[rownumEx].EDTN_WISE_BILL_REQ == "Y")
                if (roundoff != "off" && roundoff != "rowise")
                    roundoff = "editionwise";
                else {
                    if (roundoff != "off" && roundoff != "rowise")
                        roundoff = "insertionwise";
                }
        }
        else {
            if (roundoff != "off" && roundoff != "rowise")
                roundoff = "insertionwise";
        }
        document.getElementById('txtagency').title = document.getElementById('txtagency').value;
        //drpagency_SelectedIndexChanged(sender, e);

        ///////////////this is to bind the subagency drop down
        agencycodeglo = executequery.Tables[0].Rows[rownumEx].Agency_sub_code;
        var res2 = Classified_Booking.bindsubagency(executequery.Tables[0].Rows[rownumEx].Agency_sub_code, document.getElementById('hiddencompcode').value);

        var dsbsa = res2.value;
        if (dsbsa == null) {
            alert(res2.error.description);
            return false;
        }


        document.getElementById('drpagscode').options.length = 0;
        document.getElementById('drpagscode').options[0] = new Option("Select Agency", "0");
        document.getElementById('drpagscode').options.length = 1;
        for (var i = 0; i < dsbsa.Tables[0].Rows.length; ++i) {
            document.getElementById('drpagscode').options[document.getElementById('drpagscode').options.length] = new Option(dsbsa.Tables[0].Rows[i].agency_name, dsbsa.Tables[0].Rows[i].Agency_Code);

            document.getElementById('drpagscode').options.length;
        }


        //////////////////////////////////////////////////////
        if (executequery.Tables[0].Rows[rownumEx].Client_code != null) {
            if (executequery.Tables[0].Rows[rownumEx].Client != null) {
                if (executequery.Tables[0].Rows[rownumEx].Client == "")
                    document.getElementById('txtclient').value = executequery.Tables[0].Rows[rownumEx].Client_code;
                else
                    document.getElementById('txtclient').value = executequery.Tables[0].Rows[rownumEx].Client + "(" + executequery.Tables[0].Rows[rownumEx].Client_code + ")";


            }
            else
                document.getElementById('txtclient').value = executequery.Tables[0].Rows[rownumEx].Client_code;     //.ItemArray[14].ToString();
        }
        else {
            document.getElementById('txtclient').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].Agency_address != null) {
            document.getElementById('txtagencyaddress').value = executequery.Tables[0].Rows[rownumEx].Agency_address;
        }
        else {
            document.getElementById('txtagencyaddress').value = "";
        }
        document.getElementById('txtagencyaddress').title = document.getElementById('txtagencyaddress').value;
        if (executequery.Tables[0].Rows[rownumEx].Client_address != null) {
            document.getElementById('txtclientadd').value = executequery.Tables[0].Rows[rownumEx].Client_address;
        }
        else {
            document.getElementById('txtclientadd').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].Agency_code != null) {
            document.getElementById('hiddensubcode').value = document.getElementById('drpagscode').value = executequery.Tables[0].Rows[rownumEx].Agency_code;
        }
        else {
            document.getElementById('hiddensubcode').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].Dockit_no != null) {
            document.getElementById('txtdockitno1').value = executequery.Tables[0].Rows[rownumEx].Dockit_no;
        }
        else {
            document.getElementById('txtdockitno1').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].execname != null) {
            document.getElementById('txtexecname').value = executequery.Tables[0].Rows[rownumEx].execname;
        }
        else {
            document.getElementById('txtexecname').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].Executive_zone != null) {
            document.getElementById('hiddenzone').value = document.getElementById('txtexeczone').value = executequery.Tables[0].Rows[rownumEx].Executive_zone;
        }
        else {
            document.getElementById('hiddenzone').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].PRODUCTCAT != null && executequery.Tables[0].Rows[rownumEx].PRODUCTCAT != "") {
            document.getElementById('txtproduct').value = executequery.Tables[0].Rows[rownumEx].PRODUCTCAT;
        }
        else {
            document.getElementById('txtproduct').value = "";
        }
        //drpproduct_SelectedIndexChanged1(sender, e);
        //drpbrand.SelectedValue = executequery.Tables[0].Rows[rownumEx].ItemArray[21].ToString();
        /////////////////////////////////////////////this is to bind the brand drop down
//        res2 = null;
//        if (executequery.Tables[0].Rows[rownumEx].Product_code != null && executequery.Tables[0].Rows[rownumEx].Product_code != "") {
//            res2 = Classified_Booking.brandbind(document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[rownumEx].Product_code);
//            var dsbrand = res2.value;
//            if (dsbrand == null) {
//                alert(res2.error.description);
//                return false;
//            }

//            document.getElementById('drpbrand').options.length = 0;
//            document.getElementById('drpbrand').options[0] = new Option("Select Brand", "0");
//            document.getElementById('drpbrand').options.length = 1;
//            for (var i = 0; i < dsbrand.Tables[0].Rows.length; ++i) {
//                document.getElementById('drpbrand').options[document.getElementById('drpbrand').options.length] = new Option(dsbrand.Tables[0].Rows[i].brand_name, dsbrand.Tables[0].Rows[i].brand_code);

//                document.getElementById('drpbrand').options.length;
//            }

//        }
        //hiddenbrand.Value=drpbrand.SelectedValue = executequery.Tables[0].Rows[rownumEx].ItemArray[21].ToString();
        if (executequery.Tables[0].Rows[rownumEx].Brand_code == null || executequery.Tables[0].Rows[rownumEx].Brand_code.toString() == "") {
            document.getElementById('drpbrand').value = "";
            document.getElementById('hiddenbrand').value = "";
        }
        else {
            if (executequery.Tables[0].Rows[rownumEx].Brand_code != null) {
                document.getElementById('hiddenbrand').value = document.getElementById('drpbrand').value = executequery.Tables[0].Rows[rownumEx].Brand_code.toString();
            }
            else {
                document.getElementById('hiddenbrand').value = "";
            }
        }
        // varient fill in dropdown
        res2 = Classified_Booking.fillvarient(document.getElementById('hiddenbrand').value.substring(document.getElementById('hiddenbrand').value.lastIndexOf('(') + 1, document.getElementById('hiddenbrand').value.lastIndexOf(')')),document.getElementById('hiddencompcode').value);
        var dsvarient = res2.value;
        if (dsvarient == null) {
            alert(res2.error.description)
            return false;
        }
        document.getElementById('drpvarient').options.length = 0;
        document.getElementById('drpvarient').options[0] = new Option("Select Varient", "0");
        document.getElementById('drpvarient').options.length = 1;
        for (var i = 0; i < dsvarient.Tables[0].Rows.length; ++i) {
            document.getElementById('drpvarient').options[document.getElementById('drpvarient').options.length] = new Option(dsvarient.Tables[0].Rows[i].varient_name, dsvarient.Tables[0].Rows[i].varient_code);
            document.getElementById('drpvarient').options.length;
            if (executequery.Tables[0].Rows[0].Brand_code != null && executequery.Tables[0].Rows[0].Variant_code == document.getElementById('drpvarient').options[i].value) {
                document.getElementById('hiddenvar').value = document.getElementById('drpvarient').value = executequery.Tables[0].Rows[0].Variant_code.toString();
            }
        }
        if (executequery.Tables[0].Rows[0].Variant_code == null || executequery.Tables[0].Rows[0].Variant_code.toString() == "") {
            document.getElementById('drpvarient').options.length = 0;
            document.getElementById('hiddenvar').value = "";
        }
        
        ////////////////////this is to bind the varient dropdown


        ////////////////////////////////////////////////////////////////////////////////
        if (executequery.Tables[0].Rows[rownumEx].Key_no != null) {
            document.getElementById('txtkeyno').value = executequery.Tables[0].Rows[rownumEx].Key_no;
        }
        else {
            document.getElementById('txtkeyno').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].Bill_remarks != null) {
            document.getElementById('txtbillremark').value = executequery.Tables[0].Rows[rownumEx].Bill_remarks;
        }
        else {
            document.getElementById('txtbillremark').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].Print_remark != null) {
            document.getElementById('txtprintremark').value = executequery.Tables[0].Rows[rownumEx].Print_remark;
        }
        else {
            document.getElementById('txtprintremark').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].Package_code != null) {
            var listpck = executequery.Tables[0].Rows[rownumEx].Package_code;
            document.getElementById('hiddenpackage').value = listpck;
            //////////////////this is to bind the package grid on what the value is saved in the database


            res2 = null;
            res2 = Classified_Booking.bindpacforexe(document.getElementById('hiddencompcode').value, listpck);
            var dsexecut = res2.value;
            if (dsexecut == null) {
                alert(res2.error.description);
                return false;
            }




            document.getElementById('drppackagecopy').options.length = 0;
            for (i = 0; i <= dsexecut.Tables[0].Rows.length - 1; i++) {
                if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "") {
                    if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "0") {
                        var arrfor_uom = dsexecut.Tables[0].Rows[i].pck_code.toString().split('@');
                        //var res3 = Classified_Booking.getPackageInsert(arrfor_uom[0].toString(), document.getElementById('txtciobookid').value, document.getElementById('hiddensupplimentflag').value);
                        var res3 = Classified_Booking.getPackageInsert(arrfor_uom[0].toString(), document.getElementById('txtciobookid').value, document.getElementById('hiddensupplimentflag').value, document.getElementById('hiddenquotation').value);
                        var dsinsert = res3.value;
                        if (dsinsert == null) {
                            alert(res3.error.description);
                            return false;
                        }
                        var T = dsexecut.Tables[0].Rows[i].Package_Name + "(" + dsinsert.Tables[0].Rows[0].inserts + ")";
                        var V = dsexecut.Tables[0].Rows[i].pck_code + "(" + dsinsert.Tables[0].Rows[0].inserts + ")";
                        if (dsinsert.Tables[0].Rows[0].inserts != null) {
                            document.getElementById('drppackagecopy').options[document.getElementById('drppackagecopy').options.length] = new Option(T, V);

                            document.getElementById('drppackagecopy').options.length;
                        }

                        //                        ListItem li;
                        //                        li = new ListItem();
                        //                        li.Text = dsexecut.Tables[0].Rows[i].ItemArray[1].ToString() + "(" + dsinsert.Tables[0].Rows[0].ItemArray[0].ToString() + ")";
                        //                        li.Value = dsexecut.Tables[0].Rows[i].ItemArray[2].ToString() + "(" + dsinsert.Tables[0].Rows[0].ItemArray[0].ToString() + ")"; ;
                        //                        //state = ds.Tables[0].Rows[i].ItemArray[2].ToString();
                        //                        drppackagecopy.Items.Add(li);

                    }
                }
            }

        }
        else {
            document.getElementById('hiddenpackage').value = "";
        }

        if (executequery.Tables[0].Rows[rownumEx].No_of_insertion != null) {
            document.getElementById('txtinsertion').value = executequery.Tables[0].Rows[rownumEx].No_of_insertion;
            document.getElementById('hiddeninsertion').value = executequery.Tables[0].Rows[rownumEx].No_of_insertion;
        }
        else {
            document.getElementById('txtinsertion').value = "";
            document.getElementById('hiddeninsertion').value = "";
        }

        var start_date = executequery.Tables[0].Rows[rownumEx].Insertion_date;
        if (start_date != null) {
            document.getElementById('txtdummydate').value = start_date;
            /*if(document.getElementById('hiddenconnect')!=null)
            {
            if(document.getElementById('hiddenconnect').value=='sql')
            document.getElementById('txtdummydate').value =  start_date;
            else
            document.getElementById('txtdummydate').value = date_frmt_orcl_no(dateformat, start_date);
            }    
            else
            {
            document.getElementById('txtdummydate').value = date_frmt_orcl_no(dateformat, start_date);
            }
            */
        }
        else {
            document.getElementById('txtdummydate').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].Repeating_day != null) {
            document.getElementById('txtrepeatingdate').value = executequery.Tables[0].Rows[rownumEx].Repeating_day;
        }
        var mag = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.lastIndexOf(')'));
        var resT = Classified_Booking.bindAdTypeAgencyWise(mag, document.getElementById('hiddencompcode').value);
        bindBookType_Agency();
        var obj = document.getElementById('drpbooktype');
        /*   var resType=Classified_Booking.bindAdTypeAgencyWiseXML();
           
        obj.options.length = 0; 
        if(resType!=null && resType.value!="")
        {
            
        var arr=resType.value.split(",");
        obj.options[0]=new Option("Select Booking Type","0");
        for(var i=0;i<arr.length;i++)
        {
        obj.options[obj.options.length] = new Option(arr[i].toString(),arr[parseFloat(i,10)+1].toString());
        i++;
        }
        }*/
        if (resT.value != "") {
            for (var i = 1; i < obj.options.length; i++) {
                if (resT.value.indexOf(obj[i].value) < 0) {
                    //obj.options.remove(i);
                    obj.remove(i);
                }
            }
        }
        if (executequery.Tables[0].Rows[rownumEx].Booking_type != null) {
            document.getElementById('drpbooktype').value = executequery.Tables[0].Rows[rownumEx].Booking_type;
        }
        if (executequery.Tables[0].Rows[rownumEx].Ad_cat_code != null) {
            document.getElementById('drpadcategory').value = executequery.Tables[0].Rows[rownumEx].Ad_cat_code;
        }
        res = Classified_Booking.getadsubcat(document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value);
        var ds = res.value;
        var objadscat = document.getElementById('drpadsubcategory');
        objadscat.options.length = 0;
        objadscat.options[0] = new Option("-Select-", "0");
        //alert(pkgitem.options.length);
        objadscat.options.length = 1;
        for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
            objadscat.options[objadscat.options.length] = new Option(ds.Tables[0].Rows[i].Adv_Subcat_Name, ds.Tables[0].Rows[i].Adv_Subcat_Code);

            objadscat.options.length;
        }
        if (executequery.Tables[0].Rows[rownumEx].Ad_sub_cat_code != null) {
            document.getElementById('drpadsubcategory').value = executequery.Tables[0].Rows[rownumEx].Ad_sub_cat_code;
        }
        if (executequery.Tables[0].Rows[rownumEx].Color_code != null) {
            document.getElementById('drpcolor').value = executequery.Tables[0].Rows[rownumEx].Color_code;
        }
        if (executequery.Tables[0].Rows[rownumEx].Uom_code != null) {
            document.getElementById('drpuom').value = executequery.Tables[0].Rows[rownumEx].Uom_code;
        }
        //*25Aug* 
        res3 = null;
        res3 = Classified_Booking.gettheuom_desc(document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[rownumEx].Uom_code);
        var ds_uom_ = res3.value;
        if (ds_uom_ == null) {
            alert(res3.error.description);
            return false;
        }
        if (ds_uom_.Tables[0].Rows.length > 0) {
            document.getElementById('hiddenuomdesc').value = ds_uom_.Tables[0].Rows[0].uom_desc;
            document.getElementById('hiddenlogocode').value = ds_uom_.Tables[0].Rows[0].Logo;
        }


        //*25Aug*
        if (executequery.Tables[0].Rows[rownumEx].Page_position_code != null) {
            document.getElementById('drppageposition').value = executequery.Tables[0].Rows[rownumEx].Page_position_code;
            pgposprem = "per";
        }

        //string adtype=drpadstype.SelectedValue;
        if (executequery.Tables[0].Rows[rownumEx].Ad_size_height != null) {
            document.getElementById('txtadsize1').value = executequery.Tables[0].Rows[rownumEx].Ad_size_height;
        }

        if (executequery.Tables[0].Rows[rownumEx].FIXED_DEPOSIT != null) {
            fixed_deposit = executequery.Tables[0].Rows[rownumEx].FIXED_DEPOSIT;
        }

        if (executequery.Tables[0].Rows[0].Ad_size_width != null) {
            document.getElementById('txtadsize2').value = executequery.Tables[0].Rows[0].Ad_size_width;
        }





        if (executequery.Tables[0].Rows[rownumEx].Ad_size_width != null) {
            document.getElementById('txtadsize2').value = executequery.Tables[0].Rows[rownumEx].Ad_size_width;
        }
        ////this is to bind the ratecode drpdown
        res3 = null
        if (executequery.Tables[0].Rows[rownumEx].Ad_cat_code != null) {
            if (executequery.Tables[0].Rows[rownumEx].REVISE_DATE != null && executequery.Tables[0].Rows[rownumEx].REVISE_DATE != "" && executequery.Tables[0].Rows[rownumEx].REVISE_DATE != "0") {
                res3 = Classified_Booking.bindratecodeforreviserate(executequery.Tables[0].Rows[rownumEx].Ad_cat_code, document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[rownumEx].REVISE_DATE);
                var dx = res3.value;
                if (dx == null) {
                    alert(dx.error.description);
                    return false;
                }
                document.getElementById('txtratecode').options.length = 0;
                document.getElementById('txtratecode').options[0] = new Option("-Select Rate Code-", "0");
                document.getElementById('txtratecode').options.length = 1;

                for (var i = 0; i < dx.Tables[0].Rows.length; ++i) {
                    document.getElementById('txtratecode').options[document.getElementById('txtratecode').options.length] = new Option(dx.Tables[0].Rows[i].rate_mast_code, dx.Tables[0].Rows[i].rate_mast_code);

                    document.getElementById('txtratecode').options.length;
                }
                document.getElementById('drpbullet').options.length = 0;
                document.getElementById('drpbullet').options[0] = new Option("-Select Bullet-", "0");
                document.getElementById('drpbullet').options.length = 1;

                for (var i = 0; i < dx.Tables[1].Rows.length; ++i) {
                    document.getElementById('drpbullet').options[document.getElementById('drpbullet').options.length] = new Option(dx.Tables[1].Rows[i].Bullet_Desc, dx.Tables[1].Rows[i].Bullet_Code);

                    document.getElementById('drpbullet').options.length;
                }
            }
            else {
                if (document.getElementById('configclient').value == "SP") {
                    res3 = Classified_Booking.ratebind(executequery.Tables[0].Rows[rownumEx].Ad_cat_code, document.getElementById('hiddencompcode').value);
                }
                else {
                    res3 = Classified_Booking.bindratecodecenterwise(executequery.Tables[0].Rows[rownumEx].Ad_cat_code, document.getElementById('hiddencompcode').value, document.getElementById('txtbranch').value, document.getElementById('txtdatetime').value, document.getElementById('hiddendateformat').value, document.getElementById('drpuom').value);
                }
                var dx = res3.value;
                if (dx == null) {
                    alert(dx.error.description);
                    return false;
                }
                document.getElementById('txtratecode').options.length = 0;
                document.getElementById('txtratecode').options[0] = new Option("-Select Rate Code-", "0");
                document.getElementById('txtratecode').options.length = 1;

                for (var i = 0; i < dx.Tables[0].Rows.length; ++i) {
                    document.getElementById('txtratecode').options[document.getElementById('txtratecode').options.length] = new Option(dx.Tables[0].Rows[i].rate_mast_code, dx.Tables[0].Rows[i].rate_mast_code);

                    document.getElementById('txtratecode').options.length;
                }
                document.getElementById('drpbullet').options.length = 0;
                document.getElementById('drpbullet').options[0] = new Option("-Select Bullet-", "0");
                document.getElementById('drpbullet').options.length = 1;

                for (var i = 0; i < dx.Tables[1].Rows.length; ++i) {
                    document.getElementById('drpbullet').options[document.getElementById('drpbullet').options.length] = new Option(dx.Tables[1].Rows[i].Bullet_Desc, dx.Tables[1].Rows[i].Bullet_Code);

                    document.getElementById('drpbullet').options.length;
                }
            }

        }
        if (executequery.Tables[0].Rows[rownumEx].DISC_PREMIUM != null) {
            document.getElementById('drpdiscountprem').value = executequery.Tables[0].Rows[rownumEx].DISC_PREMIUM;
        }
        if (executequery.Tables[0].Rows[rownumEx].DISC_TYPE != null) {
            hiddisctype = executequery.Tables[0].Rows[rownumEx].DISC_TYPE;
        }
        if (executequery.Tables[0].Rows[rownumEx].Special_discount != null) {
            document.getElementById('txtspedisc').value = executequery.Tables[0].Rows[rownumEx].Special_discount;
        }
        if (executequery.Tables[0].Rows[rownumEx].Special_disc_per != null) {
            document.getElementById('txtspediscper').value = executequery.Tables[0].Rows[rownumEx].Special_disc_per;
        }
        if (executequery.Tables[0].Rows[0].Space_disc_per != null) {
            document.getElementById('txtspadiscper').value = executequery.Tables[0].Rows[0].Space_disc_per;
        }
        if (executequery.Tables[0].Rows[0].Space_discount != null) {
            document.getElementById('txtspacedisc').value = executequery.Tables[0].Rows[0].Space_discount;
        }
        if (executequery.Tables[0].Rows[rownumEx].Rate_code != null) {
            document.getElementById('txtratecode').value = executequery.Tables[0].Rows[rownumEx].Rate_code;
        }
        if (executequery.Tables[0].Rows[rownumEx].Scheme_type_code != null) {
            document.getElementById('drpscheme').value = executequery.Tables[0].Rows[rownumEx].Scheme_type_code;
        }
        if (executequery.Tables[0].Rows[rownumEx].SCHEMEID != null) {
            schemeid = executequery.Tables[0].Rows[rownumEx].SCHEMEID;
        }
        if (executequery.Tables[0].Rows[rownumEx].Scheme_type_code != null) {
            document.getElementById('hiddenscheme').value = executequery.Tables[0].Rows[rownumEx].Scheme_type_code;
        }
        //       drpschemepck.SelectedValue = executequery.Tables[0].Rows[rownumEx].ItemArray[41].ToString();
        if (executequery.Tables[0].Rows[rownumEx].Currency_code != null) {
            document.getElementById('drpcurrency').value = executequery.Tables[0].Rows[rownumEx].Currency_code;
        }
        if (executequery.Tables[0].Rows[rownumEx].RECEIPT_CURRENCY != null) {
            document.getElementById('drprptcurrency').value = executequery.Tables[0].Rows[rownumEx].RECEIPT_CURRENCY;
        }
        if (executequery.Tables[0].Rows[rownumEx].CONV_CURR_RATE != null) {
            document.getElementById('hidcurrency_convrate').value = executequery.Tables[0].Rows[rownumEx].CONV_CURR_RATE;
        }
        if (executequery.Tables[0].Rows[rownumEx].Agrred_rate != null) {
            document.getElementById('txtagreedrate').value = executequery.Tables[0].Rows[rownumEx].Agrred_rate;
        }
        if (executequery.Tables[0].Rows[rownumEx].Agreed_amount != null) {
            document.getElementById('txtagreedamt').value = executequery.Tables[0].Rows[rownumEx].Agreed_amount;
        }
        if (executequery.Tables[0].Rows[rownumEx].ACTIVE_AGREEDRATE != null) {
            agreedrate_active = executequery.Tables[0].Rows[rownumEx].ACTIVE_AGREEDRATE;
        }
        else {
            agreedrate_active = 0;
        }
        if (executequery.Tables[0].Rows[rownumEx].ACTIVE_AGREEDAMT != null) {
            agreedamt_active = executequery.Tables[0].Rows[rownumEx].ACTIVE_AGREEDAMT;
        }
        else {
            agreedamt_active = 0;
        }
        if (agreedrate_active == 1) {
            document.getElementById('txtagreedrate').className = ' btextforbookrightsmallbold';
        }
        else {
            document.getElementById('txtagreedrate').className = ' btextforbookrightsmall';
        }
        if (agreedamt_active == 1) {
            document.getElementById('txtagreedamt').className = ' btextforbookrightsmallbold';
        }
        else {
            document.getElementById('txtagreedamt').className = ' btextforbookrightsmall';
        }
        if (executequery.Tables[0].Rows[rownumEx].Special_charges != null) {
            document.getElementById('txtextracharges').value = executequery.Tables[0].Rows[rownumEx].Special_charges;
        }
        if (executequery.Tables[0].Rows[rownumEx].Agency_status != null) {
            document.getElementById('hiddenstatus').value = document.getElementById('txtagencystatus').value = executequery.Tables[0].Rows[rownumEx].Agency_status;
        }
        if (executequery.Tables[0].Rows[rownumEx].Agency_type != null) {
            document.getElementById('txtagencytype').value = executequery.Tables[0].Rows[rownumEx].Agency_type;
        }
        //this is To the bind the the agencypaymode dropdown on execution
        res3 = null;
        if (executequery.Tables[0].Rows[rownumEx].Agency_sub_code != null) {
            res3 = Classified_Booking.getstatuspaymode(executequery.Tables[0].Rows[rownumEx].Agency_sub_code, executequery.Tables[0].Rows[rownumEx].Agency_code, document.getElementById('hiddencompcode').value, document.getElementById('txtdatetime').value, document.getElementById('hiddendateformat').value, "CL0");
            var dch = res3.value;
            if (dch == null) {
                alert(res3.error.description);
                return false;
            }



            document.getElementById('txtagencypaymode').options.length = 0;
            if (dch.Tables[5].Rows.length > 0) {
                for (var i = 0; i < dch.Tables[5].Rows.length; i++) {
                    document.getElementById('txtagencypaymode').options[document.getElementById('txtagencypaymode').options.length] = new Option(dch.Tables[5].Rows[i].payment_mode_name, dch.Tables[5].Rows[i].pay_mode_code);

                    document.getElementById('txtagencypaymode').options.length;

                }

            }
        }
        ///////////////////////////////////////////////////////////////////////////////////////////////////
        if (executequery.Tables[0].Rows[rownumEx].Agency_pay != null) {
            document.getElementById('hiddenpay').value = document.getElementById('txtagencypaymode').value = executequery.Tables[0].Rows[rownumEx].Agency_pay;
        }
        if (document.getElementById('txtagencypaymode').value != "")
            document.getElementById('hiddenpaymode').value = document.getElementById('hiddenpaymode').value = document.getElementById('txtagencypaymode').options[document.getElementById('txtagencypaymode').selectedIndex].text;
        if (executequery.Tables[0].Rows[rownumEx].Agency_credit != null) {
            document.getElementById('txtcreditperiod').value = executequery.Tables[0].Rows[rownumEx].Agency_credit;
        }
        if (executequery.Tables[0].Rows[rownumEx].Total_area != null) {
            document.getElementById('txttotalarea').value = executequery.Tables[0].Rows[rownumEx].Total_area;
            globfromline = document.getElementById('txttotalarea').value;
        }
        if (executequery.Tables[0].Rows[rownumEx].Card_rate != null) {
            document.getElementById('txtcardrate').value = executequery.Tables[0].Rows[rownumEx].Card_rate;
        }
        if (executequery.Tables[0].Rows[rownumEx].Card_amount != null) {
            document.getElementById('txtcardamt').value = executequery.Tables[0].Rows[rownumEx].Card_amount;
        }
        if (executequery.Tables[0].Rows[rownumEx].Discount != null) {
            document.getElementById('txtdiscount').value = executequery.Tables[0].Rows[rownumEx].Discount;
        }
        if (executequery.Tables[0].Rows[rownumEx].Discount_per != null) {
            document.getElementById('txtdiscpre').value = executequery.Tables[0].Rows[rownumEx].Discount_per;
        }
        if (executequery.Tables[0].Rows[rownumEx].Bill_cycle != null) {
            document.getElementById('drpbillcycle').value = executequery.Tables[0].Rows[rownumEx].Bill_cycle;
        }
        if (executequery.Tables[0].Rows[rownumEx].Revenue_center != null) {
            document.getElementById('drprevenue').value = executequery.Tables[0].Rows[rownumEx].Revenue_center;
        }
        if (document.getElementById('drprevenue').selectedIndex != "-1") {
            document.getElementById('hiddenbranch').value = document.getElementById('drprevenue').options[document.getElementById('drprevenue').selectedIndex].text; //drprevenue.SelectedItem.Text.ToString();
        }
        ////this is to bind the bill pay mode
        document.getElementById('drppaymenttype').options.length = 0;
        if (dch.Tables[5].Rows.length > 0) {
            for (var i = 0; i < dch.Tables[5].Rows.length; i++) {
                document.getElementById('drppaymenttype').options[document.getElementById('drppaymenttype').options.length] = new Option(dch.Tables[5].Rows[i].payment_mode_name, dch.Tables[5].Rows[i].pay_mode_code);

                document.getElementById('drppaymenttype').options.length;
            }

        }
        if (executequery.Tables[0].Rows[rownumEx].Bill_pay != null) {
            document.getElementById('hiddenbillpay').value = document.getElementById('drppaymenttype').value = executequery.Tables[0].Rows[rownumEx].Bill_pay;
        }
        if (document.getElementById('drppaymenttype').value == "CH0" || document.getElementById('drppaymenttype').value == "DD0" || document.getElementById('drppaymenttype').value == 'PO0' || document.getElementById('drppaymenttype').value == 'AD0')  //CR0 is Credit Card code and DD0 is demand draft
        {
            document.getElementById('tdchqno').style.display = "";
            document.getElementById('tdourbank').style.display = "";
            document.getElementById('tdchqdate').style.display = "";
            document.getElementById('tdchqamt').style.display = "";
            document.getElementById('tdbankname').style.display = "";

            document.getElementById('tdtextchqno').style.display = "";
            document.getElementById('tdtextourbank').style.display = "";
            document.getElementById('tdtextchqdate').style.display = "";
            document.getElementById('tdtextchqamt').style.display = "";
            document.getElementById('tdtextbankname').style.display = "";
            if (executequery.Tables[0].Rows[rownumEx].CHK_DATE != null) {
                document.getElementById('ttextchqdate').value = executequery.Tables[0].Rows[rownumEx].CHK_DATE;
            }
            if (executequery.Tables[0].Rows[rownumEx].CHK_AMT != null) {
                document.getElementById('ttextchqamt').value = executequery.Tables[0].Rows[rownumEx].CHK_AMT;
            }
            if (executequery.Tables[0].Rows[rownumEx].CHK_BANK_NAME != null) {
                document.getElementById('ttextbankname').value = executequery.Tables[0].Rows[rownumEx].CHK_BANK_NAME;
            }
            if (executequery.Tables[0].Rows[rownumEx].OUR_BANK != null) {
                document.getElementById('drpourbank').value = executequery.Tables[0].Rows[rownumEx].OUR_BANK;
            }
            if (executequery.Tables[0].Rows[rownumEx].CHK_NO != null) {
                document.getElementById('ttextchqno').value = executequery.Tables[0].Rows[rownumEx].CHK_NO;
            }
        }
        if (document.getElementById('drppaymenttype').value == "CR0")  //CR0 is Credit Card code
        {
            document.getElementById('tdcarname').style.display = "";
            document.getElementById('tdtxtcarname').style.display = "";
            document.getElementById('tdtype').style.display = "";
            document.getElementById('tddrptyp').style.display = "";
            document.getElementById('tdexdat').style.display = "";

            document.getElementById('tdtxtexdat').style.display = "";
            document.getElementById('tdcardno').style.display = "";
            document.getElementById('tdtxtcarno').style.display = "";
            //                document.getElementById('txtcardname').value=executequery.Tables[0].Rows[rownumEx].Card_name;
            //                document.getElementById('drptype').value=executequery.Tables[0].Rows[rownumEx].Card_type;
            //                document.getElementById('txtcardno').value=executequery.Tables[0].Rows[rownumEx].Card_number;  
            //                document.getElementById('drpmonth').value=executequery.Tables[0].Rows[rownumEx].Card_month;  
            //                document.getElementById('drpyear').value=executequery.Tables[0].Rows[rownumEx].Card_year;

            document.getElementById('tdchqno').style.display = "none";
            document.getElementById('tdourbank').style.display = "none";
            document.getElementById('tdchqdate').style.display = "none";
            document.getElementById('tdchqamt').style.display = "none";
            document.getElementById('tdbankname').style.display = "none";

            document.getElementById('tdtextchqno').style.display = "none";
            document.getElementById('tdtextourbank').style.display = "none";
            document.getElementById('tdtextchqdate').style.display = "none";
            document.getElementById('tdtextchqamt').style.display = "none";
            document.getElementById('tdtextbankname').style.display = "none";


        }
        else if (document.getElementById('drppaymenttype').value == "CA0") {
            document.getElementById('cashrecvd').style.display = "";
            //document.getElementById('tdcashrecvd').style.display="";
            if (executequery.Tables[0].Rows[rownumEx].CASHDISCOUNT == null || executequery.Tables[0].Rows[rownumEx].CASHDISCOUNT == "null")
                document.getElementById('txtcashdiscount').value = "0";
            else
                document.getElementById('txtcashdiscount').value = executequery.Tables[0].Rows[rownumEx].CASHDISCOUNT;
            if (executequery.Tables[0].Rows[rownumEx].CASHDISCTYPE == null || executequery.Tables[0].Rows[rownumEx].CASHDISCTYPE == "null")
                document.getElementById('hiddencashdiscper').value = "";
            else
                document.getElementById('hiddencashdiscper').value = executequery.Tables[0].Rows[rownumEx].CASHDISCTYPE;


            if (executequery.Tables[0].Rows[rownumEx].CASH_RECIEVED == null || executequery.Tables[0].Rows[rownumEx].CASH_RECIEVED == "null")
                document.getElementById('drpcashrecieved').value = "0";
            else
                document.getElementById('drpcashrecieved').value = executequery.Tables[0].Rows[rownumEx].CASH_RECIEVED;
            document.getElementById('hiddencashrecieved').value = executequery.Tables[0].Rows[rownumEx].CASH_RECIEVED;
            document.getElementById('drpcashrecieved').disabled = true;
            document.getElementById('txtcashdiscount').disabled = true;
        }
        var ag = Classified_Booking.GETCASH_PAY(document.getElementById('hiddencompcode').value, document.getElementById('drppaymenttype').value);
        var ds_n = ag.value;
        var cashdiscount = 'N';
        if (ds_n != null && ds_n.Tables[0].Rows.length > 0) {
            cashdiscount = ds_n.Tables[0].Rows[0].CASHDISCOUNT;
        }
        if (cashdiscount == 'Y') {
            document.getElementById('cashrecvd').style.display = "";
            //document.getElementById('tdcashrecvd').style.display="";
            if (executequery.Tables[0].Rows[rownumEx].CASHDISCOUNT == null || executequery.Tables[0].Rows[rownumEx].CASHDISCOUNT == "null")
                document.getElementById('txtcashdiscount').value = "0";
            else
                document.getElementById('txtcashdiscount').value = executequery.Tables[0].Rows[rownumEx].CASHDISCOUNT;
            if (executequery.Tables[0].Rows[rownumEx].CASHDISCTYPE == null || executequery.Tables[0].Rows[rownumEx].CASHDISCTYPE == "null")
                document.getElementById('hiddencashdiscper').value = "";
            else
                document.getElementById('hiddencashdiscper').value = executequery.Tables[0].Rows[rownumEx].CASHDISCTYPE;


            if (executequery.Tables[0].Rows[rownumEx].CASH_RECIEVED == null || executequery.Tables[0].Rows[rownumEx].CASH_RECIEVED == "null")
                document.getElementById('drpcashrecieved').value = "0";
            else
                document.getElementById('drpcashrecieved').value = executequery.Tables[0].Rows[rownumEx].CASH_RECIEVED;
            document.getElementById('hiddencashrecieved').value = executequery.Tables[0].Rows[rownumEx].CASH_RECIEVED;
            document.getElementById('drpcashrecieved').disabled = true;
            document.getElementById('txtcashdiscount').disabled = true;
        }
        if (executequery.Tables[0].Rows[rownumEx].Bill_height != null) {
            document.getElementById('txtbillheight').value = executequery.Tables[0].Rows[rownumEx].Bill_height;
        }
        if (executequery.Tables[0].Rows[rownumEx].Bill_width != null) {
            document.getElementById('txtbillwidth').value = executequery.Tables[0].Rows[rownumEx].Bill_width;
        }
        //////////////this is to bind the bill to 
        res3 = null;
        if (executequery.Tables[0].Rows[rownumEx].Agency_sub_code != null) {
            res3 = Classified_Booking.getbillval(executequery.Tables[0].Rows[rownumEx].Agency_sub_code, document.getElementById('hiddencompcode').value);
            var dbt = res3.value;
            if (dbt == null) {
                alert(res3.error.description);
                return false;
            }


            ////////////////////////////////////////////////////
            document.getElementById('drpbillto').options.length = 0;
            var client_val = document.getElementById('txtclient').value;
            var client_name = document.getElementById('txtclient').value;
            if (document.getElementById('txtclient').value.indexOf("(".toString()) > 0) {
                client_val = document.getElementById('txtclient').value.substring(document.getElementById('txtclient').value.lastIndexOf("(") + 1, document.getElementById('txtclient').value.length - 1); //document.getElementById('txtclient').value.substring(0,document.getElementById('txtclient').value.lastIndexOf("("));
                client_name = document.getElementById('txtclient').value.substring(0, document.getElementById('txtclient').value.lastIndexOf("("));
            }
            document.getElementById('drpbillto').options[0] = new Option(client_name, client_val);

            for (var k = 0; k < dbt.Tables[0].Rows.length; k++) {
                if (dbt.Tables[0].Rows[k].bill_to == "")
                    document.getElementById('drpbillto').options[document.getElementById('drpbillto').options.length] = new Option(dbt.Tables[0].Rows[k].agency_name, dbt.Tables[0].Rows[k].SUB_agency_code);
                else
                    document.getElementById('drpbillto').options[document.getElementById('drpbillto').options.length] = new Option(dbt.Tables[0].Rows[k].agency_name, dbt.Tables[0].Rows[k].bill_to);
                document.getElementById('drpbillto').options.length;
            }
        }
        if (executequery.Tables[0].Rows[rownumEx].Bill_to != null) {
            document.getElementById('hiddenbillto').value = executequery.Tables[0].Rows[rownumEx].Bill_to;
        }
        if (executequery.Tables[0].Rows[rownumEx].Bill_to != null) {
            document.getElementById('drpbillto').value = executequery.Tables[0].Rows[rownumEx].Bill_to;
        }
        if (executequery.Tables[0].Rows[rownumEx].Invoices != null) {
            document.getElementById('txtinvoice').value = executequery.Tables[0].Rows[rownumEx].Invoices;
        }
        if (executequery.Tables[0].Rows[rownumEx].Vts != null) {
            document.getElementById('txtvts').value = executequery.Tables[0].Rows[rownumEx].Vts;
        }
        if (executequery.Tables[0].Rows[rownumEx].Bill_add != null) {
            document.getElementById('txtbilladdress').value = executequery.Tables[0].Rows[rownumEx].Bill_add;
        }
        if (executequery.Tables[0].Rows[rownumEx].Trade_disc != null) {
            document.getElementById('txttradedisc').value = executequery.Tables[0].Rows[rownumEx].Trade_disc;
            document.getElementById('txttd').value = executequery.Tables[0].Rows[rownumEx].Trade_disc;
            //                document.getElementById('hiddenagcommflag').value=executequery.Tables[0].Rows[rownumEx].ADDFLAG;
            //                document.getElementById('hiddentradedisc').value=executequery.Tables[0].Rows[rownumEx].COMM_RATE;
        }
        if (executequery.Tables[0].Rows[rownumEx].ADDFLAG != null) {
            document.getElementById('hiddenagcommflag').value = executequery.Tables[0].Rows[rownumEx].ADDFLAG;
        }
        if (executequery.Tables[0].Rows[rownumEx].COMM_RATE != null) {
            document.getElementById('hiddentradedisc').value = executequery.Tables[0].Rows[rownumEx].COMM_RATE;
        }
        if (executequery.Tables[0].Rows[rownumEx].CHKTRADE != null) {
            if (executequery.Tables[0].Rows[rownumEx].CHKTRADE == "1")
                document.getElementById('chktrade').checked = true;
            else
                document.getElementById('chktrade').checked = false;
        }
        if (executequery.Tables[0].Rows[rownumEx].GSTINCLUSIVEFLAG != null) {
            if (executequery.Tables[0].Rows[rownumEx].GSTINCLUSIVEFLAG == "1")
                document.getElementById('chkgstinc').checked = true;
            else
                document.getElementById('chkgstinc').checked = false;
        }
        if (executequery.Tables[0].Rows[rownumEx].BILL_HOLD != null) {
            if (executequery.Tables[0].Rows[rownumEx].BILL_HOLD == "Y")
                document.getElementById('chkholdbill').checked = true;
            else
                document.getElementById('chkholdbill').checked = false;
        }
        if (executequery.Tables[0].Rows[rownumEx].CANCELLATION_CHARGE != null) {
            if (executequery.Tables[0].Rows[rownumEx].CANCELLATION_CHARGE == "1")
                document.getElementById('chkcanclecharges').checked = true;
            else
                document.getElementById('chkcanclecharges').checked = false;
        }
        if (executequery.Tables[0].Rows[rownumEx].Agency_out != null) {
            document.getElementById('txtagencyoutstand').value = executequery.Tables[0].Rows[rownumEx].Agency_out;
        }

        if (executequery.Tables[0].Rows[rownumEx].Page_amount != null) {
            document.getElementById('txtpageamt').value = executequery.Tables[0].Rows[rownumEx].Page_amount;
        }
        if (executequery.Tables[0].Rows[rownumEx].Gross_amount != null) {
            document.getElementById('txtgrossamt').value = executequery.Tables[0].Rows[rownumEx].Gross_amount;
        }

        //Inserting in hidden field to compare new and  Previous amount 
        if (executequery.Tables[0].Rows[rownumEx].Bill_amount != null) {
            document.getElementById('hiddenprevamt').value = executequery.Tables[0].Rows[rownumEx].Bill_amount;
        }

        if (executequery.Tables[0].Rows[rownumEx].Bill_amount != null) {
            document.getElementById('txtbillamt').value = executequery.Tables[0].Rows[rownumEx].Bill_amount;
            document.getElementById('hiddenbillamt').value = document.getElementById('txtbillamt').value;
        }
        if (executequery.Tables[0].Rows[rownumEx].Box_code != null) {
            document.getElementById('drpboxcode').value = executequery.Tables[0].Rows[rownumEx].Box_code;
        }
        if (executequery.Tables[0].Rows[rownumEx].Box_no != null) {
            document.getElementById('txtboxno').value = executequery.Tables[0].Rows[rownumEx].Box_no;
        }
        if (executequery.Tables[0].Rows[rownumEx].Box_agency == "1") {
            document.getElementById('chkage').checked = true;
        }
        else {
            document.getElementById('chkage').checked = false;
        }
        if (executequery.Tables[0].Rows[rownumEx].Box_client.toString() == "1") {
            document.getElementById('chkclie').checked = true;
        }
        else {
            document.getElementById('chkclie').checked = false;
        }
        if (executequery.Tables[0].Rows[rownumEx].Box_address != null) {
            document.getElementById('txtboxaddress').value = executequery.Tables[0].Rows[rownumEx].Box_address;
        }
        if (executequery.Tables[0].Rows[rownumEx].Tfn == "1") {
            document.getElementById('chktfn').value = true;
        }
        else {
            document.getElementById('chktfn').value = false;
        }
        if (executequery.Tables[0].Rows[rownumEx].Ad_size_column != null) {
            document.getElementById('txtcolum').value = executequery.Tables[0].Rows[rownumEx].Ad_size_column;
        }
        if (executequery.Tables[0].Rows[rownumEx].Paid_ins != null) {
            document.getElementById('txtpaid').value = executequery.Tables[0].Rows[rownumEx].Paid_ins;
        }
        if (executequery.Tables[0].Rows[rownumEx].Contract_rate != null) {
            document.getElementById('txtdealrate').value = executequery.Tables[0].Rows[rownumEx].Contract_rate;
        }
        if (executequery.Tables[0].Rows[rownumEx].Deviation != null) {
            document.getElementById('txtdeviation').value = executequery.Tables[0].Rows[rownumEx].Deviation;
        }
        if (executequery.Tables[0].Rows[rownumEx].Contract_name != null) {
            document.getElementById('txtcontractname').value = executequery.Tables[0].Rows[rownumEx].Contract_name;
        }
        if (executequery.Tables[0].Rows[rownumEx].Contract_type != null) {
            document.getElementById('txtcontracttype').value = executequery.Tables[0].Rows[rownumEx].Contract_type;
        }
        //            if(executequery.Tables[0].Rows[rownumEx].Card_name!=null)
        //            {
        //                document.getElementById('txtcardname').value = executequery.Tables[0].Rows[rownumEx].Card_name;
        //             }   
        //             if(executequery.Tables[0].Rows[rownumEx].Card_type!=null)
        //             {
        //                document.getElementById('drptype').value = executequery.Tables[0].Rows[rownumEx].Card_type;
        //             }   
        //             if(executequery.Tables[0].Rows[rownumEx].Card_month!=null)
        //             {
        //                document.getElementById('drpmonth').value = executequery.Tables[0].Rows[rownumEx].Card_month;
        //             }   
        //             if(executequery.Tables[0].Rows[rownumEx].Card_year!=null)
        //             {
        //                document.getElementById('drpyear').value = executequery.Tables[0].Rows[rownumEx].Card_year;
        //             }   
        //             if(executequery.Tables[0].Rows[rownumEx].Card_number!=null)
        //             {
        //                document.getElementById('txtcardno').value = executequery.Tables[0].Rows[rownumEx].Card_number;
        //             }   
        if (executequery.Tables[0].Rows[rownumEx].Receipt_no != null) {
            document.getElementById('hiddenreceiptno').value = document.getElementById('txtreceipt').value = executequery.Tables[0].Rows[rownumEx].Receipt_no;
            //get check info
            if (document.getElementById('drppaymenttype').value == "CH0" || document.getElementById('drppaymenttype').value == "DD0" || document.getElementById('drppaymenttype').value == 'PO0' || document.getElementById('drppaymenttype').value == 'AD0') {
                var ds_chq = Classified_Booking.ChequeInfo(document.getElementById('hiddencompcode').value, document.getElementById('txtreceipt').value);
                if (ds_chq.value != null) {
                    if (ds_chq.value.Tables[0].Rows.length > 0) {
                        document.getElementById('ttextchqno').value = ds_chq.value.Tables[0].Rows[0].chno;
                        var cDate = "";
                        if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                            cDate = ds_chq.value.Tables[0].Rows[0].chdt;
                        }
                        else if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                            var txt = ds_chq.value.Tables[0].Rows[0].chdt.split("/");
                            cDate = txt[1] + "/" + txt[0] + "/" + txt[2];
                        }
                        else if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
                            var txt = ds_chq.value.Tables[0].Rows[0].chdt.split("/");
                            cDate = txt[2] + "/" + txt[1] + "/" + txt[0];
                        }
                        document.getElementById('ttextchqdate').value = cDate;
                        document.getElementById('ttextchqamt').value = ds_chq.value.Tables[0].Rows[0].amount;
                        if (document.getElementById('ttextchqamt').value.indexOf("-") >= 0)
                            document.getElementById('ttextchqamt').value = document.getElementById('ttextchqamt').value.replace("-", "");
                        document.getElementById('ttextbankname').value = ds_chq.value.Tables[0].Rows[0].bank;
                        if (ds_chq.value.Tables[0].Rows[0].cashbank != null)
                            document.getElementById('drpourbank').value = ds_chq.value.Tables[0].Rows[0].cashbank;
                        else
                            document.getElementById('drpourbank').value = "0";
                    }
                }
            }
            else if (document.getElementById('drppaymenttype').value == "CR0") {
                var ds_chq = Classified_Booking.ChequeInfo(document.getElementById('hiddencompcode').value, document.getElementById('txtreceipt').value);
                if (ds_chq.value != null) {
                    if (ds_chq.value.Tables[0].Rows.length > 0) {
                        document.getElementById('txtcardname').value = ds_chq.value.Tables[0].Rows[0].bank;
                        document.getElementById('drptype').value = ds_chq.value.Tables[0].Rows[0].remark;
                        document.getElementById('txtcardno').value = ds_chq.value.Tables[0].Rows[0].chno;
                        var txt = ds_chq.value.Tables[0].Rows[0].chdt.split("/");
                        document.getElementById('drpmonth').value = parseInt(txt[1], 10);
                        document.getElementById('drpyear').value = txt[2];
                    }
                }
            }
        }
        if (executequery.Tables[0].Rows[rownumEx].Material_status != null) {
            document.getElementById('drpmatstat').value = executequery.Tables[0].Rows[rownumEx].Material_status;
        }

        ////this is to bind the adscat3 drpdown



        if (executequery.Tables[0].Rows[rownumEx].Ad_Subcat3 == null || executequery.Tables[0].Rows[rownumEx].Ad_Subcat3 == "" || executequery.Tables[0].Rows[rownumEx].Ad_Subcat3 == "0") {
            document.getElementById('drpadcat3').options.length = 0;
            document.getElementById('hiddenadscat3').value = "";

        }
        else {
            res3 = null;
            res3 = Classified_Booking.getvalfromadcat3(executequery.Tables[0].Rows[rownumEx].Ad_sub_cat_code, document.getElementById('hiddencompcode').value, "0");
            var dacat = res3.value;
            if (dacat == null) {
                alert(dacat.error.description);
                return false;
            }


            ////////////////////////////////////////////////////////////////
            document.getElementById('drpadcat3').options.length = 0;
            document.getElementById('drpadcat3').options[0] = new Option("Select", "0");
            for (var k = 0; k < dacat.Tables[0].Rows.length; k++) {
                document.getElementById('drpadcat3').options[document.getElementById('drpadcat3').options.length] = new Option(dacat.Tables[0].Rows[k].catname, dacat.Tables[0].Rows[k].catcode);

                document.getElementById('drpadcat3').options.length;
            }


        }

        if (executequery.Tables[0].Rows[rownumEx].Ad_Subcat3 != null) {
            document.getElementById('hiddenadscat3').value = document.getElementById('drpadcat3').value = executequery.Tables[0].Rows[rownumEx].Ad_Subcat3;
        }

        ////////////////////this is to bind the adcat4 drp down
        if (executequery.Tables[0].Rows[rownumEx].Ad_Subcat4 == "null" || executequery.Tables[0].Rows[rownumEx].Ad_Subcat4 == null || executequery.Tables[0].Rows[rownumEx].Ad_Subcat4 == "" || executequery.Tables[0].Rows[rownumEx].Ad_Subcat4 == "0") {
            document.getElementById('drpadcat4').options.length = 0;
            document.getElementById('hiddenadscat4').value = "";

        }
        else {
            ////////////when 1 than bind the adscat4 drp down
            res3 = null;
            res3 = Classified_Booking.getvalfromadcat3(executequery.Tables[0].Rows[rownumEx].Ad_Subcat3, document.getElementById('hiddencompcode').value, "1");
            var dacat = res3.value;
            if (dacat == null) {
                alert(dacat.error.description);
                return false;
            }


            ////////////////////////////////////////////////////////////////
            document.getElementById('drpadcat4').options.length = 0;
            document.getElementById('drpadcat4').options[0] = new Option("Select", "0");
            for (var k = 0; k < dacat.Tables[0].Rows.length; k++) {
                document.getElementById('drpadcat4').options[document.getElementById('drpadcat4').options.length] = new Option(dacat.Tables[0].Rows[k].Cat_Name, dacat.Tables[0].Rows[k].Cat_Code);

                document.getElementById('drpadcat4').options.length;
            }

        }

        document.getElementById('hiddenadscat4').value = document.getElementById('drpadcat4').value = executequery.Tables[0].Rows[rownumEx].Ad_Subcat4;

        ///bind adcat5 drpdown
        if (executequery.Tables[0].Rows[rownumEx].Ad_subcat5 == "null" || executequery.Tables[0].Rows[rownumEx].Ad_subcat5 == null || executequery.Tables[0].Rows[rownumEx].Ad_subcat5 == "" || executequery.Tables[0].Rows[rownumEx].Ad_subcat5 == "0") {
            document.getElementById('drpadcat5').options.length = 0;
            document.getElementById('hiddenadscat5').value = "";
        }
        else {
            ////////////when 1 than bind the adscat4 drp down

            res3 = null;
            res3 = Classified_Booking.getvalfromadcat3(executequery.Tables[0].Rows[rownumEx].Ad_Subcat4, document.getElementById('hiddencompcode').value, "2");
            var dacat = res3.value;
            if (dacat == null) {
                alert(dacat.error.description);
                return false;
            }


            ////////////////////////////////////////////////////////////////
            document.getElementById('drpadcat5').options.length = 0;
            document.getElementById('drpadcat5').options[0] = new Option("Select", "0");
            for (var k = 0; k < dacat.Tables[0].Rows.length; k++) {
                document.getElementById('drpadcat5').options[document.getElementById('drpadcat5').options.length] = new Option(dacat.Tables[0].Rows[k].Cat_Name, dacat.Tables[0].Rows[k].Cat_Code);

                document.getElementById('drpadcat5').options.length;
            }
        }
        document.getElementById('hiddenadscat5').value = document.getElementById('drpadcat5').value = executequery.Tables[0].Rows[rownumEx].Ad_subcat5;


        //////bind the bg color drp down 
        if (executequery.Tables[0].Rows[rownumEx].Bg_color != null) {
            document.getElementById('drpbgcolor').value = executequery.Tables[0].Rows[rownumEx].Bg_color;
        }
        if (executequery.Tables[0].Rows[rownumEx].Bullet_code != null) {
            document.getElementById('drpbullet').value = executequery.Tables[0].Rows[rownumEx].Bullet_code;
        }
        if (executequery.Tables[0].Rows[rownumEx].Bullet_premium != null) {
            document.getElementById('txtbullprem').value = executequery.Tables[0].Rows[rownumEx].Bullet_premium;
            document.getElementById('hiddenbullprem').value = document.getElementById('txtbullprem').value;
        }
        var resbull = Classified_Booking.getbullprem(document.getElementById('hiddencompcode').value, document.getElementById('drpbullet').value, document.getElementById('txtdatetime').value, document.getElementById('txtbranch').value);

        var dsbull = resbull.value;
        if (dsbull.Tables[0].Rows.length > 0) {
            document.getElementById('hiddenbulletpremtype').value = dsbull.Tables[0].Rows[0].Bullet_Charges_Type;
        }
        /* *14Aug*
        if (drpretainer.Items.FindByValue(executequery.Tables[0].Rows[rownumEx].ItemArray[134].ToString()) != null)
        {
        drpretainer.SelectedValue = executequery.Tables[0].Rows[rownumEx].ItemArray[134].ToString();
        } */
        if (executequery.Tables[0].Rows[rownumEx].RETAINER1 != null) {
            document.getElementById('drpretainer').value = executequery.Tables[0].Rows[rownumEx].RETAINER1;
        }
        if (executequery.Tables[0].Rows[rownumEx].ADD_AGENCY_COMM != null) {
            if (document.getElementById('txtaddagencycommrate') != null) {
                document.getElementById('txtaddagencycommrate').value = executequery.Tables[0].Rows[rownumEx].ADD_AGENCY_COMM;
            }
        }
        //hiddenretainer.Value = executequery.Tables[0].Rows[rownumEx].ItemArray[134].ToString();
        //txtretainer.Text = executequery.Tables[0].Rows[rownumEx].ItemArray[135].ToString();
        getSharing();
        if (document.getElementById('drpbooktype').value == "2" || document.getElementById('drpbooktype').value == "6")
            getFMGRef();
        getmultiexe();
    }

    else {
        alert("Your Search Produces No Result");
        clearClick();
        return false;
    }

    // }
    updateStatus();
    document.getElementById('btnfirst').disabled = true;
    document.getElementById('btnprevious').disabled = true;

    var count = executequery.Tables[0].Rows.length - 1;
    if (executequery.Tables[0].Rows.length - 1 == 0) {
        document.getElementById('btnfirst').disabled = true;
        document.getElementById('btnprevious').disabled = true;
        document.getElementById('btnnext').disabled = true;
        document.getElementById('btnlast').disabled = true;
    }

    if (rownumEx == count) {
        document.getElementById('btnlast').disabled = true;
        document.getElementById('btnnext').disabled = true;
    }
    else {
        document.getElementById('btnlast').disabled = false;
        document.getElementById('btnnext').disabled = false;
    }
    ////// we have called a javascript function to show the grid during execution mode
    //ScriptManager.RegisterClientScriptBlock(this, typeof(Classified_Booking), "cc", "bindpackage()", true);
    document.getElementById('btndel').disabled = true;

    showcardinfo(executequery.Tables[0].Rows[rownumEx].Bill_pay);
    showgridexecute();

    if (document.getElementById('hiddenuomdesc').value == "CD") {
        document.getElementById('txtbillheight').disabled = true;
        document.getElementById('txtbillwidth').disabled = true;
        document.getElementById('txtbillheight').style.backgroundColor = "#FFFFFF";
        document.getElementById('txtbillwidth').style.backgroundColor = "#FFFFFF";

        if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtcolum').value != "") {
            document.getElementById('txtadsize2').disabled = true;
            document.getElementById('txtadsize1').style.backgroundColor = "#FFFFFF";
            document.getElementById('txtadsize2').style.backgroundColor = "#FFFFFF";
            document.getElementById('txtcolum').style.backgroundColor = "#FFFFFF";

        }
        else if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtadsize2').value != "") {
            document.getElementById('txtcolum').disabled = true;
            document.getElementById('txtadsize1').style.backgroundColor = "#FFFFFF";
            document.getElementById('txtadsize2').style.backgroundColor = "#FFFFFF";
            document.getElementById('txtcolum').style.backgroundColor = "#FFFFFF";

        }


    }
    else if (document.getElementById('hiddenuomdesc').value != "CD") {
        document.getElementById('txtadsize1').disabled = true;
        document.getElementById('txtadsize2').disabled = true;
        document.getElementById('txtbillheight').disabled = true;
        document.getElementById('txtbillwidth').disabled = true;
        document.getElementById('txtbillheight').style.backgroundColor = "#999999";
        document.getElementById('txtbillwidth').style.backgroundColor = "#999999";
        if (document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROD") {
            document.getElementById('Label1').innerHTML = "No. Of Lines";
            document.getElementById('txtadsize1').style.backgroundColor = "#999999";
            document.getElementById('txtadsize2').style.backgroundColor = "#999999";
            document.getElementById('txtcolum').style.backgroundColor = "#999999";


        }
        else if (document.getElementById('hiddenuomdesc').value == "ROW") {
            document.getElementById('Label1').innerHTML = "No. Of Words";
            document.getElementById('txtadsize1').style.backgroundColor = "#999999";
            document.getElementById('txtadsize2').style.backgroundColor = "#999999";
            document.getElementById('txtcolum').style.backgroundColor = "#999999";
        }

    }
}
function deleteCheck() {
    if (document.getElementById('txtciobookid').value == "") {
        alert("Please Enter Booking Id");
        return false;
    }
    if (confirm("Do You Want To Cancel the Booking")) {
        //Classified_Booking.deleteBooking(document.getElementById('txtciobookid').value);
        activeD = "btnDelete";
        modifyClick();

        // alert("Booking Cancelled Successfully");
        //clearClick();

        document.getElementById("txtgrossamt").value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        return false;
    }
    else {
        activeD = "";
        return false;
    }
}
function changepackage() {
    //*25Aug*
    if (document.getElementById('LinkButton5').disabled == true)
        return false;
    if (document.getElementById('LinkButton5').disabled == false) {
        if (document.getElementById('txtagency').value == "") {
            alert("Please fill the Agency Sub Code");
            document.getElementById('txtagency').focus();
            return false;
        }
        else if (document.getElementById('drpagscode').value == "" || document.getElementById('drpagscode').value == "0") {
            alert("Please select the Agency Sub Code");
            document.getElementById('drpagscode').focus();
            return false;
        }
        if (document.getElementById('txtrono').value != "" && document.getElementById('txtrono').disabled == false) {
            if (document.getElementById('txtrodate').value == "") {
                alert("Please fill ro date");
                document.getElementById('txtrodate').focus();
                return false;
            }
        }
        if (document.getElementById('LinkButton1').disabled == false) {
            if (document.getElementById('drpretainer').disabled == false) {
                if (document.getElementById('drpretainer').value == "" && document.getElementById('txtexecname').value == "") {
                    var a = "Executive name";
                    var b = "Retainer";
                    if (browser != "Microsoft Internet Explorer") {
                        a = document.getElementById('lbececname').textContent.replace("*[F2]", "");
                        b = document.getElementById('lblretainer').textContent.replace("*[F2]", "");
                    }
                    else {
                        a = document.getElementById('lbececname').innerText.replace("*[F2]", "");
                        b = document.getElementById('lblretainer').innerText.replace("*[F2]", "");
                    }
                    alert('Please fill ' + a + ' or ' + b + '.');

                    document.getElementById('drpretainer').focus();
                    return false;
                }
            }
        }
        if (document.getElementById('drpbooktype').value == "0") {
            alert("Please Select Booking Type");
            return false;
        }
        if (document.getElementById('drpcolor').value == "0") {
            alert("Please Select Color");
            document.getElementById('drpcolor').focus();
            return false;
        }
        if (document.getElementById('drpadcategory').value == "0") {
            alert("Please Select Ad Category");
            document.getElementById('drpadcategory').focus();
            return false;
        }
        if (document.getElementById('drpadcat3').value == "0" || document.getElementById('drpadcat3').value == "") {
            alert("Please Select Ad Sub Category 3");
            document.getElementById('drpadcat3').focus();
            return false;
        }
        if (browser != "Microsoft Internet Explorer") {
            chmandat = document.getElementById('lbadscat').textContent;
        }
        else {
            chmandat = document.getElementById('lbadscat').innerText;
        }
        if (chmandat.indexOf('*') >= 0) {
            if (document.getElementById('drpadsubcategory').value == "0") {
                alert("Please Select Ad Sub Category");
                document.getElementById('drpadsubcategory').focus();
                return false;
            }
        }
        if (document.getElementById('drpuom').value == "0") {
            alert("Please Select UOM");
            return false;
        }

        document.getElementById('LinkButton5').style.fontWeight = "bold";
        document.getElementById('LinkButton5').style.color = "#FFFF80";
        document.getElementById('LinkButton1').style.fontWeight = "normal";
        document.getElementById('LinkButton1').style.color = "White";
        document.getElementById('LinkButton2').style.fontWeight = "normal";
        document.getElementById('LinkButton2').style.color = "White";
        document.getElementById('LinkButton3').style.fontWeight = "normal";
        document.getElementById('LinkButton3').style.color = "White";
        document.getElementById('LinkButton4').style.fontWeight = "normal";
        document.getElementById('LinkButton4').style.color = "White";
        document.getElementById('LinkButton6').style.fontWeight = "normal";
        document.getElementById('LinkButton6').style.color = "White";
        document.getElementById('LinkButton7').style.fontWeight = "normal";
        document.getElementById('LinkButton7').style.color = "White";
        document.getElementById('tbvts').style.display = "none";
        //alert(document.getElementById('LinkButton1').click);
        document.getElementById('tblrate').style.display = "none";
        document.getElementById('tblbill').style.display = "none";
        //document.getElementById('tblsize').style.display="none";
        document.getElementById('addetails').style.display = "none";

        document.getElementById('pagedetail').style.display = "none";
        document.getElementById('tblpackage').style.display = "block";
        if (document.getElementById('drpcurrency').disabled == false) {
            document.getElementById('drpcurrency').focus();
        }
        document.getElementById('tbbox').style.display = "none";
        if (document.getElementById('drpcolor').value == "0" || document.getElementById('drpcolor').value == "") {
            alert('Please select Color.');
            changediv();
            document.getElementById('drpcolor').focus();
            return false;
        }
        if (document.getElementById('drpadcategory').value == "0" || document.getElementById('drpadcategory').value == "") {
            alert('Please Select Category.');
            changediv();
            document.getElementById('drpadcategory').focus();
            return false;
        }
        if (document.getElementById('drpuom').value == "0" || document.getElementById('drpuom').value == "") {
            alert('Please select UOM.');
            changediv();
            if (document.getElementById('drpuom').disabled == false)
                document.getElementById('drpuom').focus();
            return false;
        }

        if (enLink == "1") {
            document.getElementById('LinkButton1').disabled = false;
            document.getElementById('LinkButton2').disabled = false;
            document.getElementById('LinkButton3').disabled = false;
            document.getElementById('LinkButton4').disabled = false;
            document.getElementById('LinkButton5').disabled = false;
            document.getElementById('LinkButton6').disabled = false;
            document.getElementById('LinkButton7').disabled = false;
        }

        //		if(document.getElementById('txtrepeatingdate').value!="")
        //		{
        //		onInsertionChange();
        //		}
        //popUpCalendar(this, Form1.txtdummydate, 'mm/dd/yyyy');
        //if()
        document.getElementById('drppackage').focus();
        return false;
    }
}

function keySort(dropdownlist, caseSensitive) {
    // check the keypressBuffer attribute is defined on the dropdownlist 
    var undefined;
    if (dropdownlist.keypressBuffer == undefined) {
        dropdownlist.keypressBuffer = '';
    }
    // get the key that was pressed 
    var key = String.fromCharCode(window.event.keyCode);
    dropdownlist.keypressBuffer += key;
    if (!caseSensitive) {
        // convert buffer to lowercase
        dropdownlist.keypressBuffer = dropdownlist.keypressBuffer.toLowerCase();
    }
    // find if it is the start of any of the options 
    var optionsLength = dropdownlist.options.length;
    for (var n = 0; n < optionsLength; n++) {
        var optionText = dropdownlist.options[n].text;
        if (!caseSensitive) {
            optionText = optionText.toLowerCase();
        }
        if (optionText.indexOf(dropdownlist.keypressBuffer, 0) == 0) {
            dropdownlist.selectedIndex = n;
            return false; // cancel the default behavior since 
            // we have selected our own value 
        }
    }
    // reset initial key to be inline with default behavior 
    dropdownlist.keypressBuffer = key;
    if (document.activeElement.id == "drpadcategory")
        filladsubcatmain();
    else if (document.activeElement.id == "drpadsubcategory")
        bindadscat3();
    else if (document.activeElement.id == "drpadcat3")
        bindadscat4();
    else if (document.activeElement.id == "drpadcat4")
        bindadcat5();
    return true; // give default behavior 
}
function createtextbox(parent, id1, value, class1, onclickfunction, onchangefunction, onkeydownfunction, onfocusfunction) {
    var inputElm = document.createElement('input');
    inputElm.setAttribute("type", "text");
    inputElm.setAttribute("id", id1);
    inputElm.setAttribute("value", value);
    if (class1 != 0) {
        inputElm.setAttribute("class", class1);
    }
    if (onclickfunction != '0') {

        inputElm.onclick = new Function(onclickfunction);
    }
    if (onchangefunction != '0') {

        inputElm.onchange = new Function(onchangefunction);
    }
    if (onkeydownfunction != '0') {

        inputElm.onkeydown = new Function(onkeydownfunction);
    }
    if (onfocusfunction != '0') {

        inputElm.onfocus = new Function(onfocusfunction);
    }
    parent.appendChild(inputElm);


    //inputElm.onclick=new ght();

}
function chkDateforGrid(txtid) {
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    if ((txtid.id.indexOf("Text") == 0 && txtid.id != "") || (document.activeElement.id.indexOf("Text") == 0 && document.activeElement.id.value != "")) {
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtbillamt').value = "";
        var validformat = '';
        var dateformat = document.getElementById('hiddendateformat').value;
        var activeID = document.activeElement.id;
        if (activeID == "")
            activeID = txtid.id;
        // var currdate = document.getElementById(activeID).value;
        //==================To enter Date Without "/" ============================//
        var dateInitial = "20";
        var dateenter = document.getElementById(activeID).value;
        if (dateenter != "") {
            if (dateenter.indexOf('/') < 0) {
                var date12 = "";
                if (dateformat == "mm/dd/yyyy") {
                    if (dateenter.length >= "8")
                        date12 = dateenter.substring(0, 2) + "/" + dateenter.substring(2, 4) + "/" + dateenter.substring(4, 8);
                    else if (dateenter.length >= "6")
                        date12 = dateenter.substring(0, 2) + "/" + dateenter.substring(2, 4) + "/" + dateInitial + dateenter.substring(4, 6);
                    else
                        date12 = dateenter;
                }
                if (dateformat == "yyyy/mm/dd") {
                    if (dateenter.length >= "8")
                        date12 = dateenter.substring(0, 4) + "/" + dateenter.substring(4, 6) + "/" + dateenter.substring(6, 8);
                    else if (dateenter.length >= "6")
                        date12 = dateInitial + dateenter.substring(0, 2) + "/" + dateenter.substring(2, 4) + "/" + dateenter.substring(4, 6);
                    else
                        date12 = dateenter;
                }
                if (dateformat == "dd/mm/yyyy") {
                    if (dateenter.length >= "8")
                        date12 = dateenter.substring(0, 2) + "/" + dateenter.substring(2, 4) + "/" + dateenter.substring(4, 8);
                    else if (dateenter.length >= "6")
                        date12 = dateenter.substring(0, 2) + "/" + dateenter.substring(2, 4) + "/" + dateInitial + dateenter.substring(4, 6);
                    else
                        date12 = dateenter;
                }
                document.getElementById(activeID).value = date12;
            }
            //==============================================================================//
            if (dateformat == "mm/dd/yyyy") {
                validformat = /^\d{2}\/\d{2}\/\d{4}$/ //Basic check for format validity
            }
            if (dateformat == "yyyy/mm/dd") {
                validformat = /^\d{4}\/\d{2}\/\d{2}$/ //Basic check for format validity
            }
            if (dateformat == "dd/mm/yyyy") {
                validformat = /^\d{2}\/\d{2}\/\d{4}$/ //Basic check for format validity
            }

            //var activeID=document.activeElement.id;
            var currdate = document.getElementById(activeID).value;
            var fromdate = document.getElementById('txtdatetime').value;
            var todate = currdate;
            if (!validformat.test(currdate)) {
                alert(" Please Fill The Date In " + dateformat + " Format");
                document.getElementById(activeID).value = "";
                return false;
            }
            //

            //For From Date Converssion 
            if (dateformat == "dd/mm/yyyy") {
                if (fromdate != "") {
                    var txt = fromdate;
                    var txt1;
                    if (txt.indexOf("-") >= 0) {
                        txt1 = txt.split("-");
                    }
                    else {
                        txt1 = txt.split("/");
                    }

                    var dd = txt1[0];
                    var mm1 = txt1[1];
                    var mm;
                    if (txt.indexOf("-") >= 0) {
                        mm = getMonthNo(mm1);
                    }
                    else {
                        mm = mm1;
                    }
                    var yy = txt1[2];
                    var dayc = daysInMonth(mm, yy);
                    if (dd > dayc) {
                        alert("InValid Date");
                        document.getElementById(activeID).value = "";
                        return false;
                    }
                    if (mm > 12) {
                        alert("InValid Date");
                        document.getElementById(activeID).value = "";
                        return false;
                    }
                    fromdate = mm + '/' + dd + '/' + yy;
                }
                else {
                    fromdate = fromdate;
                }

            }

            if (dateformat == "yyyy/mm/dd") {
                if (fromdate != "") {
                    var txt = fromdate;
                    var txt1 = txt.split("/");
                    var yy = txt1[0];
                    var mm = txt1[1];
                    var dd = txt1[2];
                    var dayc = daysInMonth(mm, yy);
                    if (dd > dayc) {
                        alert("InValid Date");
                        document.getElementById(activeID).value = "";
                        return false;
                    }
                    if (mm > 12) {
                        alert("InValid Date");
                        document.getElementById(activeID).value = "";
                        return false;
                    }
                    fromdate = mm + '/' + dd + '/' + yy;
                }
                else {
                    fromdate = fromdate;
                }
            }

            if (dateformat == "mm/dd/yyyy") {
                fromdate = fromdate;
            }

            //For From Date Converssion /************************************************************/
            if (dateformat == "dd/mm/yyyy") {
                if (todate != "") {
                    var txt = todate;
                    var txt1 = txt.split("/");
                    var dd = txt1[0];
                    var mm = txt1[1];
                    var yy = txt1[2];
                    var dayc = daysInMonth(mm, yy);
                    if (dd > dayc) {
                        alert("InValid Date");
                        document.getElementById(activeID).value = "";
                        return false;
                    }
                    if (mm > 12) {
                        alert("InValid Date");
                        document.getElementById(activeID).value = "";
                        return false;
                    }
                    todate = mm + '/' + dd + '/' + yy;
                }
                else {
                    todate = todate;
                }

            }

            if (dateformat == "yyyy/mm/dd") {
                if (todate != "") {
                    var txt = todate;
                    var txt1 = txt.split("/");
                    var yy = txt1[0];
                    var mm = txt1[1];
                    var dd = txt1[2];
                    var dayc = daysInMonth(mm, yy);
                    if (dd > dayc) {
                        alert("InValid Date");
                        document.getElementById(activeID).value = "";
                        return false;
                    }
                    if (mm > 12) {
                        alert("InValid Date");
                        document.getElementById(activeID).value = "";
                        return false;
                    }
                    todate = mm + '/' + dd + '/' + yy;
                }
                else {
                    todate = todate;
                }
            }

            if (dateformat == "mm/dd/yyyy") {
                todate = todate;
            }
            //



            var fdate = new Date(fromdate);
            fdate.setDate(fdate.getDate() + 1);
            var tdate = new Date(todate);
            if (tdate < fdate && (document.getElementById('hiddenbackdatebook').value == "0" || document.getElementById('hiddenbackdatebook').value == "N")) {
                // document.getElementById(activeID).value="";
                alert("Published Date can't Be Less than or equal to Current Date");
                dummydate = tempdate;
                document.getElementById(activeID).value = "";
                document.getElementById(activeID).focus();
                return false;
            }
            //for backdays check
            var pcompcode = document.getElementById('hiddencompcode').value;
            var pformname = "Classified_Booking"
            var puserid = document.getElementById('hiddenuserid').value
            var pentrydate = document.getElementById(activeID).value
            var pdateformat = document.getElementById('hiddendateformat').value;
            var pextra1 = ""
            var pextra2 = ""
            if (pdateformat == "dd/mm/yyyy") {
                var tmpdata = pentrydate.split("/")
                seldt = tmpdata[1] + "/" + tmpdata[0] + "/" + tmpdata[2]
            }
            else if (pdateformat == "yyyy/mm/dd") {
                var tmpdata = pentrydate.split("/")
                seldt = tmpdata[1] + "/" + tmpdata[2] + "/" + tmpdata[0]
            }
            var dt = new Date()
            var seldt = new Date(seldt)
            if (dt.toString().substring(0, 10) != seldt.toString().substring(0, 10)) {
                var ds = Classified_Booking.backdate_validate(pcompcode, pformname, puserid, pentrydate, pdateformat, pextra1, pextra2);
                if (ds.error != null) {
                    alert(ds.error);
                    return false;
                }
                else if (ds.value == 'N') {
                    alert('You can not enter data for this date !!');
                    document.getElementById(activeID).value = "";
                    document.getElementById(activeID).focus();
                    return false;
                }
                else {
                }
            }
            // check valid date for grid item line
            validDate_Grid(activeID);
        }
    }

    //	return false;
}
function daysInMonth(iMonth, iYear) {
    iMonth = parseInt(iMonth, 10) - 1;
    return 32 - new Date(iYear, iMonth, 32).getDate();
}

function validDate_Grid(name) {
    var compcode = document.getElementById('hiddencompcode').value;
    //var strid1=strid.split('@');
    if (name.length > 7)
        var gtid = name.substring(7, name.length);
    else
        var gtid = name.substring(4, name.length);
    editid = "edit" + gtid;
    var pkgid = document.getElementById('hiddenpckcode' + gtid).value;
    var pkgalias = document.getElementById('pkg_alias' + gtid).value;
    var pkgname = document.getElementById(editid).value;
    pkgname = pkgname.replace("+", "^");
    var value = "1";
    var dateday = document.getElementById(name).value;

    var strtext = "";
    center = '0';
    if (document.getElementById('chkall') != null) {
        if (document.getElementById('chkall').checked == false) {
            center = document.getElementById('hiddencenter').value;
        }
        else {
            center = '0';
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        var httpRequest = null; ;
        httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml');
        }

        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };
        var adcat = document.getElementById('drpadcategory').value;
        httpRequest.open("GET", "packagename.aspx?center=" + center + "&adtype=" + document.getElementById('hiddenadtype').value + "&pkgalias=" + pkgalias + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + value + "&dateday=" + dateday + "&pkgname=" + pkgname, false);
        httpRequest.send('');
        //alert(httpRequest.readyState);
        if (httpRequest.readyState == 4) {
            //alert(httpRequest.status);
            if (httpRequest.status == 200) {
                strtext = httpRequest.responseText;
            }
            else {
                alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
            }
        }
    }
    else {
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        var adcat = document.getElementById('drpadcategory').value;
        xml.Open("GET", "packagename.aspx?center=" + center + "&adtype=" + document.getElementById('hiddenadtype').value + "&pkgalias=" + pkgalias + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + value + "&dateday=" + dateday + "&pkgname=" + pkgname, false);
        xml.Send();
        strtext = xml.responseText;
    }
    if (strtext == "NOT A VALID DATE") {
        alert("NOT A VALID DATE");
        document.getElementById(name).value = "";
        document.getElementById(name).focus();
        return false;
    }
    if (strtext == "0") {
        alert("Publication day doesnot match with day for Edition " + pkgname);
        document.getElementById(name).value = "";
        // document.getElementById(name).value=tempdate;

    }
    if (strtext != "1" && strtext != "0") {
        //document.getElementById(name).value=strtext;
        setTimeout("changeText('" + name + "','" + strtext + "')", 5);
    }
    else {
        document.getElementById(name).value = document.getElementById(name).value;
    }

}
function changeText(th1, val) {
    if (document.getElementById(th1).value == document.getElementById('txtdummydate').value)
        document.getElementById('txtdummydate').value = val;
    document.getElementById(th1).value = val;
}
function openSelectionEdiionDiv() {
    //alert(document.getElementById('drppackage').left);
    //arrEdition_Item='';
    document.getElementById('showselectedition').innerHTML = "";
    //    var pkg_edi=document.getElementById('drppackage').value.split('@')[1].split('+');
    //    var res=Classified_Booking.getPkgEdition(document.getElementById('hiddencompcode').value,document.getElementById('drppackage').value.split('@')[0]);
    var pkg_edi = drppack.split('@')[1].split('+');
    var res = Classified_Booking.getPkgEdition(document.getElementById('hiddencompcode').value, drppack.split('@')[0]);
    var str = "";
    var dFlag = true;
    if (res.value != null && res.value != "") {
        document.getElementById('hiddenpkgedition').value = res.value;
        if (parseInt(res.value) != pkg_edi.length) {
            str = "<table width=100%>";
            for (var i = 0; i < parseInt(pkg_edi.length); i++) {
                document.getElementById('showselectedition').style.left = 180;
                document.getElementById('showselectedition').style.top = 420;
                str = str + "<tr><td><input type=checkbox id='chk" + i + "' onClick='editionClick(chk" + i + ")'></td><td id='tdname" + i + "'>" + pkg_edi[i] + "</td></tr>";

            }
            str = str + "<tr valign=bottom><td ><input type=button value='OK' class='topbutton' style='width:30px' onClick='okEditionClick();'></td><td><input type=button class=topbutton value='Cancel' onClick='closeClick();'></td></tr></table>";
            document.getElementById('showselectedition').innerHTML = str;
            document.getElementById('showselectedition').style.display = "block";
            dFlag = false;
        }
        else {
            for (var i = 0; i < parseInt(pkg_edi.length); i++) {
                if (arrEdition_Item != "") {
                    arrEdition_Item = arrEdition_Item + "," + pkg_edi[i] + "~" + drppack.split('@')[0];
                }
                else {
                    arrEdition_Item = pkg_edi[i] + "~" + drppack.split('@')[0];
                }
            }
        }
    }
    return dFlag;
}
function editionClick(activeid) {
    var i = 0;
    var count = 0;
    for (i = 0; i < document.getElementById('showselectedition').getElementsByTagName("TBODY")[0].rows.length - 1; i++) {
        if (document.getElementById('chk' + i).checked == true)
            count = parseInt(count, 10) + 1;
    }
    if (count > parseInt(document.getElementById('hiddenpkgedition').value)) {
        alert("You Can't Select More Editions");
        activeid.checked = false;
        return false;

    }
    //document.getElementById('showselectedition').getElementsByTagName("tbody")[0].appendChild(Make_Row);
}
function closeClick() {
    document.getElementById('showselectedition').style.display = 'none';
}
function okEditionClick() {
    var i = 0;
    var count = 0;

    for (i = 0; i < document.getElementById('showselectedition').getElementsByTagName("TBODY")[0].rows.length - 1; i++) {
        if (document.getElementById('chk' + i).checked == true) {
            count = parseInt(count, 10) + 1;
            if (arrEdition_Item == '')
                arrEdition_Item = trim(document.getElementById('tdname' + i).innerHTML) + "~" + document.getElementById('drppackage').value.split('@')[0];
            else
                arrEdition_Item = trim(arrEdition_Item) + ',' + trim(document.getElementById('tdname' + i).innerHTML) + "~" + document.getElementById('drppackage').value.split('@')[0];
        }
    }
    if (count > parseInt(document.getElementById('hiddenpkgedition').value) || count < parseInt(document.getElementById('hiddenpkgedition').value)) {
        alert("Please Select " + document.getElementById('hiddenpkgedition').value + " Editions.");
        return false;

    }
    bindGrid_Edition();
    document.getElementById('showselectedition').style.display = 'none';
}
function bindGrid_Edition() {
    var obj = document.getElementById('drppackagecopy');
    for (var x = 0; x < obj.options.length; x++) {
        if (document.getElementById('drppackage').value == obj[x].value.substring(0, obj[x].value.indexOf('('))) {
            // alert("This package is already shifted");
            var insertCount = 1;
            if (obj[x].value.indexOf('(') >= 0) {
                insertCount = obj[x].value.substring(obj[x].value.indexOf('(') + 1, obj[x].value.length - 1);
            }
            insertCount = parseInt(insertCount) + 1;
            obj[x].value = obj[x].value.substring(0, obj[x].value.indexOf('(')) + '(' + insertCount + ')';
            obj[x].text = obj[x].text.substring(0, obj[x].text.indexOf('(')) + '(' + insertCount + ')';
            onInsertionChange('');
            return false;
        }
    }
    var strid = document.getElementById('drppackage').value;
    var compcode = document.getElementById('hiddencompcode').value;
    var strid1 = strid.split('@');
    var pkgid = strid1[0];
    var pkgname = strid1[1];
    glpkgname = pkgname;
    var value = "0";
    var dateday = "";
    var strtext = "";
    var code = "";
    var desc = "";


    if (browser != "Microsoft Internet Explorer") {
        var httpRequest = null;
        httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml');
        }

        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };
        var adcat = document.getElementById('drpadcategory').value;
        httpRequest.open("GET", "packagename.aspx?adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + value + "&pkgname=" + pkgname + "&dateday=" + dateday, false);
        httpRequest.send('');

        if (httpRequest.readyState == 4) {
            if (httpRequest.status == 200) {
                strtext = httpRequest.responseText;
            }
            else {
                alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
            }
        }
    }
    else {
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        var adcat = document.getElementById('drpadcategory').value;
        xml.Open("GET", "packagename.aspx?adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + value + "&pkgname=" + pkgname + "&dateday=" + dateday, false);
        xml.Send();
        strtext = xml.responseText;
    }
    if (strtext == "NOT A VALID DATE") {
        alert("NOT A VALID DATE");
        return false;
    }
    document.getElementById('pkgname').value = strtext;
    if (document.getElementById('drppackagecopy').options.length == 0) {
        che_flag = 0;
    }
    if (che_flag == 1) {
        alert("Can't select multiple Package");
        return false;
    }
    else if ((document.getElementById('drppackagecopy').options.length > 0) && (pkgname.indexOf(" or ") >= 0)) {
        alert("Can't select this Package");
        return false;
    }
    else {
        if (pkgname.indexOf(" or ") >= 0) {
            che_flag = 1;
            Classified_Booking.bindTable(pkgname, bindTable_callback);
            check_or = "1";
        }
        var val_ = "";
        var agencytype = "CL0"; // document.getElementById('drpadtype').value;
        if (browser != "Microsoft Internet Explorer") {
            var httpRequest = null; ;
            httpRequest = new XMLHttpRequest();
            if (httpRequest.overrideMimeType) {
                httpRequest.overrideMimeType('text/xml');
            }

            httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

            httpRequest.open("GET", "gettheinsertionfromcombin.aspx?desc=" + glpkgname + "&code=" + pkgid + "&agencytype=" + agencytype, false);
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) {
                    val_ = httpRequest.responseText;
                }
                else {
                    alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                }
            }
        }
        else {
            var xml = new ActiveXObject("Microsoft.XMLHTTP");
            xml.Open("GET", "gettheinsertionfromcombin.aspx?desc=" + glpkgname + "&code=" + pkgid + "&agencytype=" + agencytype, false);
            xml.Send();
            val_ = xml.responseText;
        }

        var insertO = document.getElementById('txtinsertion').value;
        document.getElementById('tempinsert').value = document.getElementById('txtinsertion').value;
        if (document.getElementById('tempinsert').value == "")
            document.getElementById('tempinsert').value = 1;
        if (insertO == "")
            insertO = 1;
        if (val_ != "" && val_ != "0" && val_ != null) {
            document.getElementById('txtinsertion').value = val_;


        }
        else {
            document.getElementById('tempinsert').value = document.getElementById('txtinsertion').value;
        }

        if (che_flag == 0) {
            if (strtext != "0") {
                AddItem(document.getElementById('drppackagecopy'), strtext, strid, val_);
            }
            document.getElementById('txtdummydate').focus();
        }
    }
    document.getElementById('txtinsertion').value = insertO;
    // document.getElementById('drpuom').focus();
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    return false;
}
function checkValidEdition(editionName, pkgcode) {
    var bFlag = false;
    if (arrEdition_Item != "") {
        var arr_split = arrEdition_Item.split(',');
        for (var i = 0; i < arr_split.length; i++) {
            var narr_split = trim(arr_split[i]).split('~');
            if (trim(narr_split[0]) == trim(editionName) && trim(narr_split[1]) == trim(pkgcode)) {
                bFlag = true;
                break;
            }
        }
    }
    else
        bFlag = true;
    return bFlag;
}
function parentid_QBC(ins) {

    gb_ins = ins;

    /*this is to chk whether the lines is not graeater than max lines if yes than don't allow booking*/
    var adtype = "";
    if (window.opener.document.getElementById('drpadtype') != null) {
        adtype = window.opener.document.getElementById('drpadtype').value
    }
    var adcat = window.opener.document.getElementById('drpadcategory').value;
    var adscat = window.opener.document.getElementById('drpadsubcategory').value;
    var adscat1 = window.opener.document.getElementById('drpadcat3').value;
    var adscat2 = window.opener.document.getElementById('drpadcat4').value;
    var adscat3 = window.opener.document.getElementById('drpadcat5').value;
    var color = window.opener.document.getElementById('drpcolor').value;
    var uom = window.opener.document.getElementById('drpuom').value;
    var uomdesc = window.opener.document.getElementById('hiddenuomdesc').value;
    var dateformat = window.opener.document.getElementById('hiddendateformat').value;
    var currency = window.opener.document.getElementById('hiddencurrency').value;
    var compcode = window.opener.document.getElementById('hiddencompcode').value;
    var dateselect = window.opener.document.getElementById('txtdummydate').value;
    var noofinserts = window.opener.document.getElementById('txtinsertion').value;
    var ratecode = "qbc";
    var lines = ""

    lines = window.document.getElementById('txtnoofline').value
    if (window.document.getElementById('hiddenLineCount').value == "" || window.document.getElementById('hiddenLineCount').value == "0") {
        window.document.getElementById('hiddenLineCount').value = lines;
    }
    window.opener.document.getElementById('hiddenLineCount').value = window.document.getElementById('hiddenLineCount').value;


    //////////////this code is to split the code as well as ites description

    var objpack = window.opener.document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var codepck = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (temp != "") {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                codepck = tempvalcode + "," + codepck;
                desc = tempcode + "," + desc;


            }
            else {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                codepck = tempvalcode;
                desc = tempcode;
            }
        }

    }




    var package1 = codepck;

    /*mysql*/
    /* if(window.opener.opener.document.getElementById('hiddenagencyrate').value=="yes" && window.opener.opener.document.getElementById('hiddentypedatabase').value=="mysql")
    {
    matterprev.getthemaxlines_agency(adtype,color,adcat,adscat,currency,ratecode,package1,dateselect,compcode,uom,noofinserts,lines,adscat1,adscat2,adscat3,"",lines,dateformat,uomdesc,window.opener.opener.document.getElementById('hiddenagencycodeforrate').value,call_getmaxlines)
    }
    else
    {
    matterprev.getthemaxlines(adtype,color,adcat,adscat,currency,ratecode,package1,dateselect,compcode,uom,noofinserts,lines,adscat1,adscat2,adscat3,"",lines,dateformat,uomdesc,call_getmaxlines)
    }  */
    window.document.getElementById('btnok').disabled = false;
    window.document.getElementById('btnprintf').disabled = false;
    return false;



    ////  

    return false;

}

function checkTrade() {
    if (tradefoc != document.getElementById('txttradedisc').value) {
        var caramt = document.getElementById('txtgrossamt').value;
        //	    if(document.getElementById('txttradedisc').value!="" && document.getElementById('txtgrossamt').value=="")
        //	    {
        //	        document.getElementById('txttradedisc').value=document.getElementById('hiddentradedisc').value;
        //	    }
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtbillamt').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        if (document.getElementById('txttradedisc').value != "" && document.getElementById('hiddentradedisc').value != "") {
            if (parseFloat(document.getElementById('txttradedisc').value) > parseFloat(document.getElementById('hiddentradedisc').value)) {
                document.getElementById('txtgrossamt').value = "";
                document.getElementById('txtbillamt').value = "";
                alert("Agency Commission can't be greater than " + document.getElementById('hiddentradedisc').value);
                document.getElementById('txttradedisc').value = document.getElementById('hiddentradedisc').value;
                document.getElementById('txttd').value = document.getElementById('hiddentradedisc').value;
                return false;
            }
            if (document.getElementById('txtcardamt').value != "" && document.getElementById('txttradedisc').value != "" && document.getElementById('txtgrossamt').value) {
                //document.getElementById('txtgrossamt').value="";
                document.getElementById('txtbillamt').value = "";

                var tradisc = document.getElementById('txttradedisc').value;
                if (document.getElementById('chktrade').checked == false)
                    tradisc = 0;
                if (tradisc == "")
                    tradisc = 0;
                var trdisc1 = tradisc;
                var addcomm = 0;
                if (document.getElementById('txtaddagencycommrate') != null) {
                    if (document.getElementById('hiddenagcommflag').value != "1")
                        addcomm = document.getElementById('txtaddagencycommrate').value;
                }
                if (addcomm == "") {
                    addcomm = "0";
                }
                if (addcomm != "0") {
                    trdisc1 = parseInt(tradisc) + parseFloat(addcomm);
                }
                var tot = 0;
                if (document.getElementById('agncomm_seq_com').value == "S")
                    tot = parseFloat(caramt) - parseFloat(caramt) * parseFloat(trdisc1) / 100;
                else {
                    tot = parseFloat(caramt) - parseFloat(caramt) * parseFloat(tradisc) / 100;
                    if (addcomm != "0") {
                        tot = parseFloat(tot) - parseFloat(tot) * parseFloat(addcomm) / 100;
                    }
                }
                document.getElementById('txtbillamt').value = tot.toFixed(2);
            }
        }
    }
}


function getRetainerCommAmt() {
    /* if(document.getElementById('txtcardamt').value!="" && document.getElementById('txttradedisc').value!="")
    {
    var caramt=document.getElementById('txtgrossamt').value;
    var tradisc=document.getElementById('txttradedisc').value;
    var trdisc1=tradisc;
    var addcomm =0;
    if(document.getElementById('txtaddagencycommrate')!=null)
    {
    addcomm=document.getElementById('txtaddagencycommrate').value;
    }
    if(addcomm=="")
    {
    addcomm="0";
    }
    if(addcomm!="0")
    {
    trdisc1=parseFloat(tradisc) + parseFloat(addcomm);
    }
    var tot=parseFloat(caramt)-parseFloat(caramt)*parseFloat(trdisc1)/100;
    document.getElementById('txtbillamt').value=tot.toFixed(2);
    } */
    if (document.getElementById('drpretainer').value == "" || document.getElementById('drpretainer').value == "0" || document.getElementById('txtRetainercomm').value == "") {
        document.getElementById('txtRetainercomm').value = "";
        document.getElementById('txtRetainercommamt').value = "";
    }
    if (document.getElementById('drpretainer').value != "" && document.getElementById('drpretainer').value != "0") {

        /* if(document.getElementById('txtRetainercomm').value!="" && document.getElementById('txtaddagencycommrate').value!="")
        {
        OriRetainerComm();
        var addcomm =0;
        if(document.getElementById('txtaddagencycommrate')!=null)
        {
        addcomm=document.getElementById('txtaddagencycommrate').value;
        }
        if(addcomm=="")
        addcomm=0;
        document.getElementById('txtRetainercomm').value=parseFloat(document.getElementById('txtRetainercomm').value) - parseFloat(addcomm);
        }*/
        document.getElementById('txtRetainercommamt').value = "";
        if (parseFloat(document.getElementById('txtRetainercomm').value) > parseFloat(document.getElementById('retcomm').value)) {
            alert("Retainer Commission can't be greater than " + document.getElementById('retcomm').value);
            document.getElementById('txtRetainercomm').value = document.getElementById('retcomm').value;

        }
        if (document.getElementById('retcommtype').value == "") {
            var retain_name = document.getElementById('drpretainer').value.split('(');
            var retain_code = retain_name[1].replace(')', '');
            var ds_ret = Classified_Booking.getRetainerComm(retain_code, document.getElementById('hiddencompcode').value);

            if (ds_ret.value == null)
                return false;

            if (ds_ret.value.Tables[0].Rows.length > 0) {
                document.getElementById('retcommtype').value = ds_ret.value.Tables[0].Rows[0].Discount;
                document.getElementById('retcomm').value = ds_ret.value.Tables[0].Rows[0].retainercomm;
            }
        }
        if (document.getElementById('retcommtype').value == "Gross" && document.getElementById('txtgrossamt').value != "" && document.getElementById('txtRetainercomm').value != "" && document.getElementById('txtRetainercomm').value != null) {
            document.getElementById('txtRetainercommamt').value = (parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(document.getElementById('txtRetainercomm').value) / 100).toFixed(2);
        }
        else if (document.getElementById('retcommtype').value == "Net" && document.getElementById('txtbillamt').value != "" && document.getElementById('txtRetainercomm').value != "" && document.getElementById('txtRetainercomm').value != null) {
            document.getElementById('txtRetainercommamt').value = (parseFloat(document.getElementById('txtbillamt').value) * parseFloat(document.getElementById('txtRetainercomm').value) / 100).toFixed(2);
        }
        else {
            document.getElementById('txtRetainercommamt').value = "";
            document.getElementById('txtRetainercomm').value = "";
        }

    }
}

function getAddlAgencyComm() {
    if (document.getElementById('txtgrossamt').value == '') {
        document.getElementById('txtaddagencycommrate').value = "";
        document.getElementById('txtaddagencycommrateamt').value = "";
    }
    if (document.getElementById('txtaddagencycommrateamt') != null && document.getElementById('txtaddagencycommrateamt').value == "" || document.getElementById('txtaddagencycommrateamt').value == "0") {
        document.getElementById('btnshgrid').focus();
        return false;
    }
    if (document.getElementById('txtaddagencycommrateamt').value != "" && document.getElementById('txtgrossamt').value != "") {
        var agcommamt = (parseFloat(document.getElementById('txtaddagencycommrateamt').value) / parseFloat(document.getElementById('txtgrossamt').value)) * 100;
        document.getElementById('txtaddagencycommrate').value = agcommamt.toFixed(2);
        document.getElementById('txtbillamt').value = '';
    }
    if (document.getElementById('hiddenafency_retainer').value == "Y") {
        if (document.getElementById('drpretainer').value == "") {
            document.getElementById('btnshgrid').focus();
            return false;
        }
        else {
            //get retainer code *6Aug*
            if (document.getElementById('drpretainer').value == null || document.getElementById('drpretainer').value == "" || document.getElementById('drpretainer').value == "0") {
                document.getElementById('btnshgrid').focus();  //*25Aug*
                return false;
            }
            else {
                var retain_name = document.getElementById('drpretainer').value.split('(');
                var retain_code = retain_name[1].replace(')', '');
            }
            //*6Aug*  var response = Classified_Booking.getRetainerComm(document.getElementById('drpretainer').value,document.getElementById('hiddencompcode').value);
            var response = Classified_Booking.getRetainerComm(retain_code, document.getElementById('hiddencompcode').value);
            if (response != null) {
                var ds = response.value;
                if (ds == null)
                    return false;
                if (ds.Tables[0].Rows.length > 0) {
                    if (ds.Tables[0].Rows[0].retainercomm == null) {
                        var retainercomm = 0;
                    }
                    else {
                        retainercomm = ds.Tables[0].Rows[0].retainercomm;
                    }
                    if (retainercomm != "0") {
                        if (parseInt(document.getElementById('txtaddagencycommrate').value) > parseInt(retainercomm)) {
                            alert("Agency Commission can't be greater than Retainer Commission.");
                            document.getElementById('txtaddagencycommrate').value = "";
                            document.getElementById('txtaddagencycommrateamt').value = "";
                            document.getElementById('txtaddagencycommrate').focus();
                            return false;
                        }
                    }
                }
            }
        }
    }
    else {
        document.getElementById('btnshgrid').focus();
        return false;
    }

    document.getElementById('txtgrossamt').value = '';
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
}


function fillcopyfilename() {
    //logonam="lnam"+i

    if (document.getElementById("fil0") != null && document.getElementById("fil0").value != "") {
        count = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
        itemlinecnt = parseInt( parseInt(count) / parseInt(document.getElementById('txtinsertion').value));
        count = count - itemlinecnt;
        filid = itemlinecnt;
        var filemidid = 2;
        //var filelastid=parseInt(itemlinecnt)+1;
        var tCount = 0;
        var counterT = 0;
        var ins_vari = document.getElementById('ins' + counterT);
        if (ins_vari != null) {
            while (parseInt(ins_vari.innerHTML) == "1") {
                tCount = parseInt(tCount) + 1;
                counterT = parseInt(counterT) + 1;
                ins_vari = document.getElementById('ins' + counterT);
                if (ins_vari == null)
                    break;
            }
        }
        gridItemCount = tCount;  //get gridcount
        itemlinecnt = gridItemCount;

        for (var i = 1; i <= count; i = i + itemlinecnt) {
            for (var j = 0; j < itemlinecnt; j++) {
                if (document.getElementById("logonam" + filid).value == "") {
                    document.getElementById("logonam" + filid).value = document.getElementById("logonam" + j).value;
                }
                if (document.getElementById("logohei" + filid).value == "") {
                    document.getElementById("logohei" + filid).value = document.getElementById("logohei" + j).value;
                }
                if (document.getElementById("logowid" + filid).value == "") {
                    document.getElementById("logowid" + filid).value = document.getElementById("logowid" + j).value;
                }
                if (document.getElementById("fil" + filid).value == "") {
                    var arrfile = document.getElementById("fil" + j).value.split('-');
                    if (arrfile.length > 2) {

                        var cioid = arrfile[0];
                        var filenamenew = arrfile[0];
                        filenamenew += "-" + filemidid;
                        var filelastid = filid + 1;
                        filenamenew += "-" + filelastid + ".xtg";
                        document.getElementById("fil" + filid).value = filenamenew;



                        var xml = new ActiveXObject("Microsoft.XMLHTTP");
                        xml.Open("GET", "copyMatter.aspx?filename=" + document.getElementById("fil" + j).value + "&copyfilename=" + filenamenew + "&cioid=" + cioid, false);
                        xml.Send();
                        strtext = xml.responseText;
                    }
                    else {
                        //alert(document.getElementById("fil"+filid).value)
                        document.getElementById("fil" + filid).value = document.getElementById("fil" + j).value;

                    }

                }
                filid = filid + 1;
            }
            filemidid = filemidid + 1;
        }

    }
    ////bhanu start
    if (document.getElementById("resno0") != null && document.getElementById("resno0").value != "") {
        count = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
        itemlinecnt = parseInt(count) / parseInt(document.getElementById('txtinsertion').value);
        count = count - itemlinecnt;
        filid = itemlinecnt;
        var filemidid = 2;
        for (var i = 1; i <= count; i = i + itemlinecnt) {
            for (var j = 0; j < itemlinecnt; j++) {
                if (document.getElementById("resno" + filid).value == "") {
                    document.getElementById("resno" + filid).value = document.getElementById("resno" + j).value;
                }
                if (document.getElementById("seccode" + filid).value == "") {
                    document.getElementById("seccode" + filid).value = document.getElementById("seccode" + j).value;
                }
                filid = filid + 1;
            }
            filemidid = filemidid + 1;
        }
        //        
    }
    ////bhanu end
}


function uploadlogoall() {
    if (window.opener.document.getElementById('txtdummydate').value == "") {
        alert("Please Fill the Publish date");
        return false;
    }
    var hei = document.getElementById('txtlogohei').value;
    var wid = document.getElementById('txtlogowid').value;
    var colwidth = document.getElementById('hiddenwidth').value;
    // if(wid>colwidth)
    //{
    //  alert("Logo Width can't be Greater Than Ad Width");
    //return false;
    //}
    // var tot_area="txttotalarea"
    // var ins_id="All";
    // var eyecatch=document.getElementById('drpbullet').value;
    // var bgcolor=document.getElementById('drpbgcolor').value;
    // var eyecatchlength=document.getElementById('txteyecathval').value;
    //  var width=document.getElementById('txtadsize2').value;
    // var agcdd=document.getElementById('drpagency_comp').value;
    //width="3.8";

    /*change*/

    var objpack = window.opener.document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var code = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (temp != "") {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode + "," + code;
                desc = tempcode + "," + desc;


            }
            else {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode;
                desc = tempcode;
            }
        }

    }
    var pubedit = desc.replace("+", "^");
    width = desc.replace("+", "^");
    code = code.replace("+", "^");

    // var uom=document.getElementById('drpuom').value;
    //   var ins="0";
    //  var edit="All";
    var ciobookid = window.opener.document.getElementById('txtciobookid').value;
    //  var fileid="bookdiv";   
    //  var logo="logo";
    // var valh="0";
    // var chk_modify=document.getElementById('hiddensavemod').value;
    /*in India*/
    var datefield = window.opener.document.getElementById('txtdummydate').value;
    if (clientfromconfig1 == "SP") {
        document.getElementById('btnok').disabled = false;
        document.getElementById('btnprev').disabled = false;
    }
    //window.open('logoupload.aspx?adheight='+hei+'&adwidth='+wid+'&ins='+ins+'&edition='+edit+'&ciobookid='+ciobookid+'&fileid='+fileid+'&logo='+logo+'&pubedit='+pubedit+'&code='+code+'&uom='+uom+'&chk_modify='+chk_modify+'&agcode='+agcdd,'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=244,left=210,width=350px,height=95px');
    window.open('logoupload.aspx?adheight=' + hei + '&adwidth=' + wid + '&insertNo=' + document.getElementById('hiddenInsertNo').value + '&srno=' + document.getElementById('hiddensrno').value + '&ciobookid=' + ciobookid + '&edition=' + width.split("(")[0] + '&datefield=' + datefield + '&logoid=1', 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=244,left=210,width=350px,height=95px');
    //window.open('temupload.aspx?adheight='+hei+'&adwidth='+wid+'&ins='+ins+'&edition='+edit+'&ciobookid='+ciobookid+'&fileid='+fileid+'&logo='+logo+'&pubedit='+pubedit,'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=244,left=210,width=350px,height=95px');
    return false;


}
function placeSymbol(event)// for dictionary editor
{
    if (event.keyCode == "90") {
        // alert(event.keyCode);
        event.keyCode = 221;
    }
}




function checkContiniuity() {
    if (document.getElementById('tblinsert').innerHTML != "") {
        var y = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length;
        var dt1;
        var boold;
        for (var i = 0; i < y - 1; i++) {
            var pkgcodegrid = 'hiddenpckcode' + i;
            if (document.getElementById(pkgcodegrid) != null) {
                if (document.getElementById(pkgcodegrid).value == 'DB42' || document.getElementById(pkgcodegrid).value == 'DB66' || document.getElementById(pkgcodegrid).value == 'DB60' || document.getElementById(pkgcodegrid).value == 'DB63' || document.getElementById(pkgcodegrid).value == 'DB45' || document.getElementById(pkgcodegrid).value == 'DB51' || document.getElementById(pkgcodegrid).value == 'DB54' || document.getElementById(pkgcodegrid).value == 'DB48' || document.getElementById(pkgcodegrid).value == 'DB57' || document.getElementById(pkgcodegrid).value == 'DB36' || document.getElementById(pkgcodegrid).value == 'DB33' || document.getElementById(pkgcodegrid).value == 'DB28' || document.getElementById(pkgcodegrid).value == 'DB22')// 3insertion
                {
                    boold = false;
                    for (x = i; x < i + 3; x++) {
                        var dateC = document.getElementById('Text' + x).value;
                        var splitaliddate = dateC.split("/");
                        if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[0] + "/" + splitaliddate[1];
                        }
                        else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[1] + "/" + splitaliddate[0];
                        }
                        else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
                            dateC = splitaliddate[0] + "/" + splitaliddate[1] + "/" + splitaliddate[2];
                        }
                        if (x == i)
                            dt1 = new Date(dateC);
                        else {
                            var dt2 = new Date(dateC);
                            var ddiff = daysDiff(dt2, dt1);
                            if (ddiff == 1)
                                dt1 = new Date(dateC);
                            else {
                                //                                        alert("Please Take Continuous Date for Item Line No. "+(parseInt(x)+1));
                                //                                        return false;
                                if (ddiff < 1) {
                                    alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                    return false;
                                }
                                var fdate = (dt1.getMonth() + 1).toString() + "/" + dt1.getDate().toString() + "/" + dt1.getYear().toString();
                                var tdate = (dt2.getMonth() + 1).toString() + "/" + dt2.getDate().toString() + "/" + dt2.getYear().toString();
                                var res = QBC.checkNoIssueBhaskar(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid).value, fdate, tdate);
                                if (res.value == null) {
                                    alert(res.error.description);
                                    return false;
                                }
                                else {
                                    if (res.value.Tables[0].Rows.length > 0) {
                                        if (parseInt(res.value.Tables[0].Rows[0].countname) <= 0 || ddiff > 2) {
                                            alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                            return false;
                                        }
                                        else {
                                            dt1 = new Date(dateC);
                                        }
                                    }
                                    else {
                                        dt1 = new Date(dateC);
                                    }
                                }
                            }
                        }
                    }
                    i = parseInt(i) + 2;
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB41' || document.getElementById(pkgcodegrid).value == 'DB56' || document.getElementById(pkgcodegrid).value == 'DB62' || document.getElementById(pkgcodegrid).value == 'DB65' || document.getElementById(pkgcodegrid).value == 'DB44' || document.getElementById(pkgcodegrid).value == 'DB47' || document.getElementById(pkgcodegrid).value == 'DB53' || document.getElementById(pkgcodegrid).value == 'DB50' || document.getElementById(pkgcodegrid).value == 'DB59' || document.getElementById(pkgcodegrid).value == 'DB35' || document.getElementById(pkgcodegrid).value == 'DB32' || document.getElementById(pkgcodegrid).value == 'DB21' || document.getElementById(pkgcodegrid).value == 'DB27')// for 2 cont. insert date
                {
                    boold = false;
                    for (x = i; x < i + 2; x++) {
                        var dateC = document.getElementById('Text' + x).value;
                        var splitaliddate = dateC.split("/");
                        if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[0] + "/" + splitaliddate[1];
                        }
                        else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[1] + "/" + splitaliddate[0];
                        }
                        else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
                            dateC = splitaliddate[0] + "/" + splitaliddate[1] + "/" + splitaliddate[2];
                        }
                        if (x == i)
                            dt1 = new Date(dateC);
                        else {
                            var dt2 = new Date(dateC);
                            var ddiff = daysDiff(dt2, dt1);
                            if (ddiff == 1)
                                dt1 = new Date(dateC);
                            else {
                                //                                        alert("Please Take Continuous Date for Item Line No. "+(parseInt(x)+1));
                                //                                        return false;
                                if (ddiff < 1) {
                                    alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                    return false;
                                }
                                var fdate = (dt1.getMonth() + 1).toString() + "/" + dt1.getDate().toString() + "/" + dt1.getYear().toString();
                                var tdate = (dt2.getMonth() + 1).toString() + "/" + dt2.getDate().toString() + "/" + dt2.getYear().toString();
                                var res = QBC.checkNoIssueBhaskar(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid).value, fdate, tdate);
                                if (res.value == null) {
                                    alert(res.error.description);
                                    return false;
                                }
                                else {
                                    if (res.value.Tables[0].Rows.length > 0) {
                                        if (parseInt(res.value.Tables[0].Rows[0].countname) <= 0 || ddiff > 2) {
                                            alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                            return false;
                                        }
                                        else {
                                            dt1 = new Date(dateC);
                                        }
                                    }
                                    else {
                                        dt1 = new Date(dateC);
                                    }
                                }
                            }
                        }
                    }
                    i = parseInt(i) + 1;
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB29')// for 7 cont. insert date
                {
                    boold = false;
                    for (x = i; x < i + 7; x++) {
                        var dateC = document.getElementById('Text' + x).value;
                        var splitaliddate = dateC.split("/");
                        if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[0] + "/" + splitaliddate[1];
                        }
                        else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[1] + "/" + splitaliddate[0];
                        }
                        else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
                            dateC = splitaliddate[0] + "/" + splitaliddate[1] + "/" + splitaliddate[2];
                        }
                        if (x == i)
                            dt1 = new Date(dateC);
                        else {
                            var dt2 = new Date(dateC);
                            var ddiff = daysDiff(dt2, dt1);
                            if (ddiff == 1)
                                dt1 = new Date(dateC);
                            else {
                                //                                        alert("Please Take Continuous Date for Item Line No. "+(parseInt(x)+1));
                                //                                        return false;
                                if (ddiff < 1) {
                                    alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                    return false;
                                }
                                var fdate = (dt1.getMonth() + 1).toString() + "/" + dt1.getDate().toString() + "/" + dt1.getYear().toString();
                                var tdate = (dt2.getMonth() + 1).toString() + "/" + dt2.getDate().toString() + "/" + dt2.getYear().toString();
                                var res = QBC.checkNoIssueBhaskar(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid).value, fdate, tdate);
                                if (res.value == null) {
                                    alert(res.error.description);
                                    return false;
                                }
                                else {
                                    if (res.value.Tables[0].Rows.length > 0) {
                                        if (parseInt(res.value.Tables[0].Rows[0].countname) <= 0 || ddiff > 2) {
                                            alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                            return false;
                                        }
                                        else {
                                            dt1 = new Date(dateC);
                                        }
                                    }
                                    else {
                                        dt1 = new Date(dateC);
                                    }
                                }
                            }
                        }
                    }
                    i = parseInt(i) + 6;

                }
                else if (document.getElementById(pkgcodegrid).value == 'DB30')// for 15 cont. insert date
                {
                    boold = false;
                    for (x = i; x < i + 15; x++) {
                        var dateC = document.getElementById('Text' + x).value;
                        var splitaliddate = dateC.split("/");
                        if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[0] + "/" + splitaliddate[1];
                        }
                        else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[1] + "/" + splitaliddate[0];
                        }
                        else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
                            dateC = splitaliddate[0] + "/" + splitaliddate[1] + "/" + splitaliddate[2];
                        }
                        if (x == i)
                            dt1 = new Date(dateC);
                        else {
                            var dt2 = new Date(dateC);
                            var ddiff = daysDiff(dt2, dt1);
                            if (ddiff == 1)
                                dt1 = new Date(dateC);
                            else {
                                //                                        alert("Please Take Continuous Date for Item Line No. "+(parseInt(x)+1));
                                //                                        return false;
                                if (ddiff < 1) {
                                    alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                    return false;
                                }
                                var fdate = (dt1.getMonth() + 1).toString() + "/" + dt1.getDate().toString() + "/" + dt1.getYear().toString();
                                var tdate = (dt2.getMonth() + 1).toString() + "/" + dt2.getDate().toString() + "/" + dt2.getYear().toString();
                                var res = QBC.checkNoIssueBhaskar(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid).value, fdate, tdate);
                                if (res.value == null) {
                                    alert(res.error.description);
                                    return false;
                                }
                                else {
                                    if (res.value.Tables[0].Rows.length > 0) {
                                        if (parseInt(res.value.Tables[0].Rows[0].countname) <= 0 || ddiff > 2) {
                                            alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                            return false;
                                        }
                                        else {
                                            dt1 = new Date(dateC);
                                        }
                                    }
                                    else {
                                        dt1 = new Date(dateC);
                                    }
                                }
                            }
                        }
                    }
                    i = parseInt(i) + 14;
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB43' || document.getElementById(pkgcodegrid).value == 'DB58' || document.getElementById(pkgcodegrid).value == 'DB64' || document.getElementById(pkgcodegrid).value == 'DB67' || document.getElementById(pkgcodegrid).value == 'DB46' || document.getElementById(pkgcodegrid).value == 'DB52' || document.getElementById(pkgcodegrid).value == 'DB55' || document.getElementById(pkgcodegrid).value == 'DB49' || document.getElementById(pkgcodegrid).value == 'DB61' || document.getElementById(pkgcodegrid).value == 'DB37' || document.getElementById(pkgcodegrid).value == 'DB34' || document.getElementById(pkgcodegrid).value == 'DB31' || document.getElementById(pkgcodegrid).value == 'DB23')// for 30 cont. insert date
                {
                    boold = false;
                    for (x = i; x < i + 30; x++) {
                        var dateC = document.getElementById('Text' + x).value;
                        var splitaliddate = dateC.split("/");
                        if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[0] + "/" + splitaliddate[1];
                        }
                        else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[1] + "/" + splitaliddate[0];
                        }
                        else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
                            dateC = splitaliddate[0] + "/" + splitaliddate[1] + "/" + splitaliddate[2];
                        }
                        if (x == i)
                            dt1 = new Date(dateC);
                        else {
                            var dt2 = new Date(dateC);
                            var ddiff = daysDiff(dt2, dt1);
                            if (ddiff == 1)
                                dt1 = new Date(dateC);
                            else {
                                //                                        alert("Please Take Continuous Date for Item Line No. "+(parseInt(x)+1));
                                //                                        return false;
                                if (ddiff < 1) {
                                    alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                    return false;
                                }
                                var fdate = (dt1.getMonth() + 1).toString() + "/" + dt1.getDate().toString() + "/" + dt1.getYear().toString();
                                var tdate = (dt2.getMonth() + 1).toString() + "/" + dt2.getDate().toString() + "/" + dt2.getYear().toString();
                                var res = QBC.checkNoIssueBhaskar(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid).value, fdate, tdate);
                                if (res.value == null) {
                                    alert(res.error.description);
                                    return false;
                                }
                                else {
                                    if (res.value.Tables[0].Rows.length > 0) {
                                        if (parseInt(res.value.Tables[0].Rows[0].countname) <= 0 || ddiff > 2) {
                                            alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                            return false;
                                        }
                                        else {
                                            dt1 = new Date(dateC);
                                        }
                                    }
                                    else {
                                        dt1 = new Date(dateC);
                                    }
                                }
                            }
                        }
                    }
                    i = parseInt(i) + 29;
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB38' || document.getElementById(pkgcodegrid).value == 'DB24')// for 90 cont. insert date
                {
                    boold = false;
                    for (x = i; x < i + 90; x++) {
                        var dateC = document.getElementById('Text' + x).value;
                        var splitaliddate = dateC.split("/");
                        if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[0] + "/" + splitaliddate[1];
                        }
                        else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[1] + "/" + splitaliddate[0];
                        }
                        else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
                            dateC = splitaliddate[0] + "/" + splitaliddate[1] + "/" + splitaliddate[2];
                        }
                        if (x == i)
                            dt1 = new Date(dateC);
                        else {
                            var dt2 = new Date(dateC);
                            var ddiff = daysDiff(dt2, dt1);
                            if (ddiff == 1)
                                dt1 = new Date(dateC);
                            else {
                                //                                        alert("Please Take Continuous Date for Item Line No. "+(parseInt(x)+1));
                                //                                        return false;
                                if (ddiff < 1) {
                                    alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                    return false;
                                }
                                var fdate = (dt1.getMonth() + 1).toString() + "/" + dt1.getDate().toString() + "/" + dt1.getYear().toString();
                                var tdate = (dt2.getMonth() + 1).toString() + "/" + dt2.getDate().toString() + "/" + dt2.getYear().toString();
                                var res = QBC.checkNoIssueBhaskar(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid).value, fdate, tdate);
                                if (res.value == null) {
                                    alert(res.error.description);
                                    return false;
                                }
                                else {
                                    if (res.value.Tables[0].Rows.length > 0) {
                                        if (parseInt(res.value.Tables[0].Rows[0].countname) <= 0 || ddiff > 2) {
                                            alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                            return false;
                                        }
                                        else {
                                            dt1 = new Date(dateC);
                                        }
                                    }
                                    else {
                                        dt1 = new Date(dateC);
                                    }
                                }
                            }
                        }
                    }
                    i = parseInt(i) + 89;
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB39' || document.getElementById(pkgcodegrid).value == 'DB25')// for 180 cont. insert date
                {
                    boold = false;
                    for (x = i; x < i + 180; x++) {
                        var dateC = document.getElementById('Text' + x).value;
                        var splitaliddate = dateC.split("/");
                        if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[0] + "/" + splitaliddate[1];
                        }
                        else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[1] + "/" + splitaliddate[0];
                        }
                        else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
                            dateC = splitaliddate[0] + "/" + splitaliddate[1] + "/" + splitaliddate[2];
                        }
                        if (x == i)
                            dt1 = new Date(dateC);
                        else {
                            var dt2 = new Date(dateC);
                            var ddiff = daysDiff(dt2, dt1);
                            if (ddiff == 1)
                                dt1 = new Date(dateC);
                            else {
                                //                                        alert("Please Take Continuous Date for Item Line No. "+(parseInt(x)+1));
                                //                                        return false;
                                if (ddiff < 1) {
                                    alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                    return false;
                                }
                                var fdate = (dt1.getMonth() + 1).toString() + "/" + dt1.getDate().toString() + "/" + dt1.getYear().toString();
                                var tdate = (dt2.getMonth() + 1).toString() + "/" + dt2.getDate().toString() + "/" + dt2.getYear().toString();
                                var res = QBC.checkNoIssueBhaskar(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid).value, fdate, tdate);
                                if (res.value == null) {
                                    alert(res.error.description);
                                    return false;
                                }
                                else {
                                    if (res.value.Tables[0].Rows.length > 0) {
                                        if (parseInt(res.value.Tables[0].Rows[0].countname) <= 0 || ddiff > 2) {
                                            alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                            return false;
                                        }
                                        else {
                                            dt1 = new Date(dateC);
                                        }
                                    }
                                    else {
                                        dt1 = new Date(dateC);
                                    }
                                }
                            }
                        }
                    }
                    i = parseInt(i) + 179;
                }

                else if (document.getElementById(pkgcodegrid).value == 'DB40' || document.getElementById(pkgcodegrid).value == 'DB26')// for 365 cont. insert date
                {
                    boold = false;
                    for (x = i; x < i + 365; x++) {
                        var dateC = document.getElementById('Text' + x).value;
                        var splitaliddate = dateC.split("/");
                        if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[0] + "/" + splitaliddate[1];
                        }
                        else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[1] + "/" + splitaliddate[0];
                        }
                        else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
                            dateC = splitaliddate[0] + "/" + splitaliddate[1] + "/" + splitaliddate[2];
                        }
                        if (x == i)
                            dt1 = new Date(dateC);
                        else {
                            var dt2 = new Date(dateC);
                            var ddiff = daysDiff(dt2, dt1);
                            if (ddiff == 1)
                                dt1 = new Date(dateC);
                            else {
                                //                                        alert("Please Take Continuous Date for Item Line No. "+(parseInt(x)+1));
                                //                                        return false;
                                if (ddiff < 1) {
                                    alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                    return false;
                                }
                                var fdate = (dt1.getMonth() + 1).toString() + "/" + dt1.getDate().toString() + "/" + dt1.getYear().toString();
                                var tdate = (dt2.getMonth() + 1).toString() + "/" + dt2.getDate().toString() + "/" + dt2.getYear().toString();
                                var res = QBC.checkNoIssueBhaskar(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid).value, fdate, tdate);
                                if (res.value == null) {
                                    alert(res.error.description);
                                    return false;
                                }
                                else {
                                    if (res.value.Tables[0].Rows.length > 0) {
                                        if (parseInt(res.value.Tables[0].Rows[0].countname) <= 0 || ddiff > 2) {
                                            alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                            return false;
                                        }
                                        else {
                                            dt1 = new Date(dateC);
                                        }
                                    }
                                    else {
                                        dt1 = new Date(dateC);
                                    }
                                }
                            }
                        }
                    }
                    i = parseInt(i) + 364;
                }

            }
        }
    }
}


function daysDiff(day1, day2) {
    var diff = Date.parse(day1) - Date.parse(day2);
    var daysDiff = Math.floor(diff / 1000 / 60 / 60 / 24);
    return daysDiff;
}
function getInsert(code) {
    if (browser != "Microsoft Internet Explorer") {
        var httpRequest = null; ;
        httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml');
        }

        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

        httpRequest.open("GET", "gettheinsertionfromcombin.aspx?desc=&code=" + code + "&agencytype=CL0", false);
        httpRequest.send('');
        //alert(httpRequest.readyState);
        if (httpRequest.readyState == 4) {
            //alert(httpRequest.status);
            if (httpRequest.status == 200) {
                val_ = httpRequest.responseText;
            }
            else {
                alert('There was a problem with the request.');
            }
        }
    }
    else {
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        xml.Open("GET", "gettheinsertionfromcombin.aspx?desc=&code=" + code + "&agencytype=CL0", false);
        xml.Send();
        val_ = xml.responseText;

    }
    return val_;
}


function roundTotal() {
    if (document.getElementById('tblinsert').innerHTML != "") {
        var y = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length;
        var dt1;
        var boold;
        var gridGross = 0;
        var netAMt = 0;
        for (var i = 0; i < y - 1; i++) {
            var pkgcodegrid = 'hiddenpckcode' + i;
            if (document.getElementById(pkgcodegrid) != null) {
                if (document.getElementById(pkgcodegrid).value == 'DB42' || document.getElementById(pkgcodegrid).value == 'DB66' || document.getElementById(pkgcodegrid).value == 'DB60' || document.getElementById(pkgcodegrid).value == 'DB63' || document.getElementById(pkgcodegrid).value == 'DB45' || document.getElementById(pkgcodegrid).value == 'DB51' || document.getElementById(pkgcodegrid).value == 'DB54' || document.getElementById(pkgcodegrid).value == 'DB48' || document.getElementById(pkgcodegrid).value == 'DB57' || document.getElementById(pkgcodegrid).value == 'DB36' || document.getElementById(pkgcodegrid).value == 'DB33' || document.getElementById(pkgcodegrid).value == 'DB28' || document.getElementById(pkgcodegrid).value == 'DB22')// 3insertion
                {
                    for (x = i; x < i + 3; x++) {
                        var gross = "gro" + x;
                        if (document.getElementById(gross) != null && document.getElementById(gross).value != '') {
                            netAMt = parseFloat(netAMt) + parseFloat(document.getElementById(gross).value);
                        }
                        if (document.getElementById("card" + x) != null && document.getElementById("card" + x) != "" && document.getElementById(gross).value != '0') {
                            gridGross = parseFloat(gridGross) + parseFloat(document.getElementById("card" + x).value);
                        }
                    }
                    i = parseInt(i) + 2;

                    var diff1 = Math.round(netAMt) - parseFloat(netAMt);
                    if (parseFloat(netAMt) > Math.round(netAMt))
                        diff1 = parseFloat(netAMt) - Math.round(netAMt);
                    if (diff1 > 0) {
                        document.getElementById("gro" + i).value = parseFloat(document.getElementById("gro" + i).value) + parseFloat(diff1);
                        document.getElementById("gro" + i).value = parseFloat(document.getElementById("gro" + i).value).toFixed(2)
                    }
                    // for card amount
                    var diff = Math.round(gridGross) - parseFloat(gridGross);
                    if (parseFloat(gridGross) > Math.round(gridGross))
                        diff = parseFloat(gridGross) - Math.round(gridGross);
                    if (diff > 0) {
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value) + parseFloat(diff);
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value).toFixed(2)
                    }
                    netAMt = Math.round(netAMt);
                    gridGross = Math.round(gridGross);
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB41' || document.getElementById(pkgcodegrid).value == 'DB56' || document.getElementById(pkgcodegrid).value == 'DB62' || document.getElementById(pkgcodegrid).value == 'DB65' || document.getElementById(pkgcodegrid).value == 'DB44' || document.getElementById(pkgcodegrid).value == 'DB47' || document.getElementById(pkgcodegrid).value == 'DB53' || document.getElementById(pkgcodegrid).value == 'DB50' || document.getElementById(pkgcodegrid).value == 'DB59' || document.getElementById(pkgcodegrid).value == 'DB35' || document.getElementById(pkgcodegrid).value == 'DB32' || document.getElementById(pkgcodegrid).value == 'DB21' || document.getElementById(pkgcodegrid).value == 'DB27')// for 2 cont. insert date
                {
                    for (x = i; x < i + 2; x++) {
                        var gross = "gro" + x;
                        if (document.getElementById(gross) != null && document.getElementById(gross).value != '') {
                            netAMt = parseFloat(netAMt) + parseFloat(document.getElementById(gross).value);
                        }
                        if (document.getElementById("card" + x) != null && document.getElementById("card" + x) != "" && document.getElementById(gross).value != '0') {
                            gridGross = parseFloat(gridGross) + parseFloat(document.getElementById("card" + x).value);
                        }
                    }
                    i = parseInt(i) + 1;

                    var diff1 = Math.round(netAMt) - parseFloat(netAMt);
                    if (parseFloat(netAMt) > Math.round(netAMt))
                        diff1 = parseFloat(netAMt) - Math.round(netAMt);
                    if (diff1 > 0) {
                        document.getElementById("gro" + i).value = parseFloat(document.getElementById("gro" + i).value) + parseFloat(diff1);
                        document.getElementById("gro" + i).value = parseFloat(document.getElementById("gro" + i).value).toFixed(2)
                    }
                    // for card amount
                    var diff = Math.round(gridGross) - parseFloat(gridGross);
                    if (parseFloat(gridGross) > Math.round(gridGross))
                        diff = parseFloat(gridGross) - Math.round(gridGross);
                    if (diff > 0) {
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value) + parseFloat(diff);
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value).toFixed(2)
                    }
                    netAMt = Math.round(netAMt);
                    gridGross = Math.round(gridGross);
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB29')// for 7 cont. insert date
                {
                    for (x = i; x < i + 7; x++) {
                        var gross = "gro" + x;
                        if (document.getElementById(gross) != null && document.getElementById(gross).value != '') {
                            netAMt = parseFloat(netAMt) + parseFloat(document.getElementById(gross).value);
                        }
                        if (document.getElementById("card" + x) != null && document.getElementById("card" + x) != "" && document.getElementById(gross).value != '0') {
                            gridGross = parseFloat(gridGross) + parseFloat(document.getElementById("card" + x).value);
                        }
                    }
                    i = parseInt(i) + 6;

                    var diff1 = Math.round(netAMt) - parseFloat(netAMt);
                    if (parseFloat(netAMt) > Math.round(netAMt))
                        diff1 = parseFloat(netAMt) - Math.round(netAMt);
                    if (diff1 > 0) {
                        document.getElementById("gro" + i).value = parseFloat(document.getElementById("gro" + i).value) + parseFloat(diff1);
                        document.getElementById("gro" + i).value = parseFloat(document.getElementById("gro" + i).value).toFixed(2)
                    }
                    // for card amount
                    var diff = Math.round(gridGross) - parseFloat(gridGross);
                    if (parseFloat(gridGross) > Math.round(gridGross))
                        diff = parseFloat(gridGross) - Math.round(gridGross);
                    if (diff > 0) {
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value) + parseFloat(diff);
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value).toFixed(2)
                    }
                    netAMt = Math.round(netAMt);
                    gridGross = Math.round(gridGross);
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB30')// for 15 cont. insert date
                {
                    for (x = i; x < i + 15; x++) {
                        var gross = "gro" + x;
                        if (document.getElementById(gross) != null && document.getElementById(gross).value != '') {
                            netAMt = parseFloat(netAMt) + parseFloat(document.getElementById(gross).value);
                        }
                        if (document.getElementById("card" + x) != null && document.getElementById("card" + x) != "" && document.getElementById(gross).value != '0') {
                            gridGross = parseFloat(gridGross) + parseFloat(document.getElementById("card" + x).value);
                        }
                    }
                    i = parseInt(i) + 14;

                    var diff1 = Math.round(netAMt) - parseFloat(netAMt);
                    if (parseFloat(netAMt) > Math.round(netAMt))
                        diff1 = parseFloat(netAMt) - Math.round(netAMt);
                    if (diff1 > 0) {
                        document.getElementById("gro" + i).value = parseFloat(document.getElementById("gro" + i).value) + parseFloat(diff1);
                        document.getElementById("gro" + i).value = parseFloat(document.getElementById("gro" + i).value).toFixed(2)
                    }
                    // for card amount
                    var diff = Math.round(gridGross) - parseFloat(gridGross);
                    if (parseFloat(gridGross) > Math.round(gridGross))
                        diff = parseFloat(gridGross) - Math.round(gridGross);
                    if (diff > 0) {
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value) + parseFloat(diff);
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value).toFixed(2)
                    }
                    netAMt = Math.round(netAMt);
                    gridGross = Math.round(gridGross);
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB43' || document.getElementById(pkgcodegrid).value == 'DB58' || document.getElementById(pkgcodegrid).value == 'DB64' || document.getElementById(pkgcodegrid).value == 'DB67' || document.getElementById(pkgcodegrid).value == 'DB46' || document.getElementById(pkgcodegrid).value == 'DB52' || document.getElementById(pkgcodegrid).value == 'DB55' || document.getElementById(pkgcodegrid).value == 'DB49' || document.getElementById(pkgcodegrid).value == 'DB61' || document.getElementById(pkgcodegrid).value == 'DB37' || document.getElementById(pkgcodegrid).value == 'DB34' || document.getElementById(pkgcodegrid).value == 'DB31' || document.getElementById(pkgcodegrid).value == 'DB23')// for 30 cont. insert date
                {
                    for (x = i; x < i + 30; x++) {
                        var gross = "gro" + x;
                        if (document.getElementById(gross) != null && document.getElementById(gross).value != '') {
                            netAMt = parseFloat(netAMt) + parseFloat(document.getElementById(gross).value);
                        }
                        if (document.getElementById("card" + x) != null && document.getElementById("card" + x) != "" && document.getElementById(gross).value != '0') {
                            gridGross = parseFloat(gridGross) + parseFloat(document.getElementById("card" + x).value);
                        }
                    }
                    i = parseInt(i) + 29;

                    var diff1 = Math.round(netAMt) - parseFloat(netAMt);
                    if (parseFloat(netAMt) > Math.round(netAMt))
                        diff1 = parseFloat(netAMt) - Math.round(netAMt);
                    if (diff1 > 0) {
                        document.getElementById("gro" + i).value = parseFloat(document.getElementById("gro" + i).value) + parseFloat(diff1);
                        document.getElementById("gro" + i).value = parseFloat(document.getElementById("gro" + i).value).toFixed(2)
                    }
                    // for card amount
                    var diff = Math.round(gridGross) - parseFloat(gridGross);
                    if (parseFloat(gridGross) > Math.round(gridGross))
                        diff = parseFloat(gridGross) - Math.round(gridGross);
                    if (diff > 0) {
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value) + parseFloat(diff);
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value).toFixed(2)
                    }
                    netAMt = Math.round(netAMt);
                    gridGross = Math.round(gridGross);
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB38' || document.getElementById(pkgcodegrid).value == 'DB24')// for 90 cont. insert date
                {
                    for (x = i; x < i + 90; x++) {
                        var gross = "gro" + x;
                        if (document.getElementById(gross) != null && document.getElementById(gross).value != '') {
                            netAMt = parseFloat(netAMt) + parseFloat(document.getElementById(gross).value);
                        }
                        if (document.getElementById("card" + x) != null && document.getElementById("card" + x) != "" && document.getElementById(gross).value != '0') {
                            gridGross = parseFloat(gridGross) + parseFloat(document.getElementById("card" + x).value);
                        }
                    }
                    i = parseInt(i) + 89;

                    var diff1 = Math.round(netAMt) - parseFloat(netAMt);
                    if (parseFloat(netAMt) > Math.round(netAMt))
                        diff1 = parseFloat(netAMt) - Math.round(netAMt);
                    if (diff1 > 0) {
                        document.getElementById("gro" + i).value = parseFloat(document.getElementById("gro" + i).value) + parseFloat(diff1);
                        document.getElementById("gro" + i).value = parseFloat(document.getElementById("gro" + i).value).toFixed(2)
                    }
                    // for card amount
                    var diff = Math.round(gridGross) - parseFloat(gridGross);
                    if (parseFloat(gridGross) > Math.round(gridGross))
                        diff = parseFloat(gridGross) - Math.round(gridGross);
                    if (diff > 0) {
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value) + parseFloat(diff);
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value).toFixed(2)
                    }
                    netAMt = Math.round(netAMt);
                    gridGross = Math.round(gridGross);
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB39' || document.getElementById(pkgcodegrid).value == 'DB25')// for 180 cont. insert date
                {
                    for (x = i; x < i + 180; x++) {
                        var gross = "gro" + x;
                        if (document.getElementById(gross) != null && document.getElementById(gross).value != '') {
                            netAMt = parseFloat(netAMt) + parseFloat(document.getElementById(gross).value);
                        }
                        if (document.getElementById("card" + x) != null && document.getElementById("card" + x) != "" && document.getElementById(gross).value != '0') {
                            gridGross = parseFloat(gridGross) + parseFloat(document.getElementById("card" + x).value);
                        }
                    }
                    i = parseInt(i) + 179;

                    var diff1 = Math.round(netAMt) - parseFloat(netAMt);
                    if (parseFloat(netAMt) > Math.round(netAMt))
                        diff1 = parseFloat(netAMt) - Math.round(netAMt);
                    if (diff1 > 0) {
                        document.getElementById("gro" + i).value = parseFloat(document.getElementById("gro" + i).value) + parseFloat(diff1);
                        document.getElementById("gro" + i).value = parseFloat(document.getElementById("gro" + i).value).toFixed(2)
                    }
                    // for card amount
                    var diff = Math.round(gridGross) - parseFloat(gridGross);
                    if (parseFloat(gridGross) > Math.round(gridGross))
                        diff = parseFloat(gridGross) - Math.round(gridGross);
                    if (diff > 0) {
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value) + parseFloat(diff);
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value).toFixed(2)
                    }
                    netAMt = Math.round(netAMt);
                    gridGross = Math.round(gridGross);
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB40' || document.getElementById(pkgcodegrid).value == 'DB26')// for 365 cont. insert date
                {
                    for (x = i; x < i + 365; x++) {
                        var gross = "gro" + x;
                        if (document.getElementById(gross) != null && document.getElementById(gross).value != '') {
                            netAMt = parseFloat(netAMt) + parseFloat(document.getElementById(gross).value);
                        }
                        if (document.getElementById("card" + x) != null && document.getElementById("card" + x) != "" && document.getElementById(gross).value != '0') {
                            gridGross = parseFloat(gridGross) + parseFloat(document.getElementById("card" + x).value);
                        }
                    }
                    i = parseInt(i) + 364;

                    var diff1 = Math.round(netAMt) - parseFloat(netAMt);
                    if (parseFloat(netAMt) > Math.round(netAMt))
                        diff1 = parseFloat(netAMt) - Math.round(netAMt);
                    if (diff1 > 0) {
                        document.getElementById("gro" + i).value = parseFloat(document.getElementById("gro" + i).value) + parseFloat(diff1);
                        document.getElementById("gro" + i).value = parseFloat(document.getElementById("gro" + i).value).toFixed(2)
                    }
                    // for card amount
                    var diff = Math.round(gridGross) - parseFloat(gridGross);
                    if (parseFloat(gridGross) > Math.round(gridGross))
                        diff = parseFloat(gridGross) - Math.round(gridGross);
                    if (diff > 0) {
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value) + parseFloat(diff);
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value).toFixed(2)
                    }
                    netAMt = Math.round(netAMt);
                    gridGross = Math.round(gridGross);
                }
                else {
                    var gross = "gro" + i;
                    if (document.getElementById(gross) != null && document.getElementById(gross).value != '') {
                        netAMt = parseFloat(netAMt) + parseFloat(document.getElementById(gross).value);
                    }
                    if (document.getElementById("card" + i) != null && document.getElementById("card" + i) != "" && document.getElementById(gross).value != '0') {
                        gridGross = parseFloat(gridGross) + parseFloat(document.getElementById("card" + i).value);
                    }
                }
            }
        }
        document.getElementById('txtgrossamt').value = Math.round(netAMt);
        document.getElementById('txtcardamt').value = Math.round(gridGross);
        //    if(tradedisc!=null && tradedisc!="")
        //        document.getElementById('txtbillamt').value=parseFloat(document.getElementById('txtgrossamt').value) - (parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(tradedisc) /100);

    }
}
function focusN() {
    if (document.getElementById('hidlineedit').value != "y") {
        changedivrate();
    }
}

function addagencycommRate() {
    //      if(document.getElementById('txtgrossamt').value=='' &&document.getElementById('txtaddagencycommrateamt')!=null)
    //    {
    //        document.getElementById('txtaddagencycommrate').value="";
    //        document.getElementById('txtaddagencycommrateamt').value="";
    //    }
    if (document.getElementById('txtaddagencycommrateamt') != null && document.getElementById('txtaddagencycommrate').value == "") {
        document.getElementById('txtaddagencycommrate').value = 0;
    }
    if (document.getElementById('txtaddagencycommrateamt') != null && document.getElementById('txtaddagencycommrate').value != "" && document.getElementById('txtgrossamt').value != "") {
        //        var agcommamt=parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(document.getElementById('txtaddagencycommrate').value) /100;
        //        document.getElementById('txtaddagencycommrateamt').value=agcommamt.toFixed(2);
        var trdisc = document.getElementById('txttradedisc').value
        if (document.getElementById('chktrade').checked == false)
            trdisc = "0";
        if (trdisc == "")
            trdisc = 0;
        var trdisc1 = trdisc;
        var addcomm1 = 0;
        var agncomamnt = 0;
        if (document.getElementById('txtaddagencycommrate') != null) {
            if (document.getElementById('hiddenagcommflag').value != "1")
                addcomm1 = document.getElementById('txtaddagencycommrate').value;
        }
        if (addcomm1 == "") {
            addcomm1 = "0";
        }
        if (addcomm1 != "0") {
            trdisc1 = parseFloat(trdisc) + parseFloat(addcomm1);
        }
        var agcommamt = 0;
        var agcommamt1 = 0;
        if (document.getElementById('agncomm_seq_com').value != "S") {
            agcommamt = (parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(trdisc1) / 100);
            if (addcomm1 != "0" && addcomm1 != "") {
                agcommamt = (parseFloat(agcommamt) * parseFloat(addcomm1) / 100);
            }
        }
        else {
            agcommamt = parseFloat(document.getElementById('txtgrossamt').value) - (parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(trdisc) / 100);
            agcommamt1 = (parseFloat(agcommamt) * parseFloat(addcomm1) / 100);
            agcommamt = agcommamt1;

        }
        // var agcommamt=parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(document.getElementById('txtaddagencycommrate').value) /100;
        if (document.getElementById('txtaddagencycommrateamt') != null)
            document.getElementById('txtaddagencycommrateamt').value = agcommamt.toFixed(2);
    }

    if (document.getElementById('agncomm_seq_com').value != "S") {
        for (var j = 0; j < document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1; j++) {
            agncomamnt = (parseFloat(document.getElementById("gro" + j).value) * parseFloat(trdisc1) / 100);
            document.getElementById("agmn" + j).value = agncomamnt;
            agncomamnt = parseFloat(document.getElementById("gro" + j).value) - agncomamnt
            agncomamnt = (parseFloat(agncomamnt) * parseFloat(addcomm1) / 100);
            document.getElementById("adlag" + j).value = agncomamnt;
        }
    }
    else {
        for (var j = 0; j < document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1; j++) {
            agncomamnt = (parseFloat(document.getElementById("gro" + j).value) * parseFloat(trdisc) / 100);
            document.getElementById("agmn" + j).value = agncomamnt;
            agncomamnt = parseFloat(document.getElementById("gro" + j).value) - agncomamnt
            agncomamnt = (parseFloat(agncomamnt) * parseFloat(addcomm1) / 100);
            document.getElementById("adlag" + j).value = agncomamnt;
        }
    }
    //    var cashdisamnt = "";
    //    if ((document.getElementById('txtcashdiscount').value != "") && document.getElementById('txtcashdiscount').disabled != true) {
    //        for (var j = 0; j < document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1; j++) {
    //            //  agncomamnt = (parseFloat(document.getElementById("gro" + j).value) * parseFloat(trdisc) / 100);
    //            //   document.getElementById("spld" + j).value = ((parseFloat(document.getElementById('card' + i).value) / parseFloat(cardrate)) * 100).toFixed(2);
    //            cashdisamnt = (parseFloat(document.getElementById("gro" + j).value) * parseFloat(document.getElementById('txtcashdiscount').value) / 100);
    //            //   agncomamnt = parseFloat(document.getElementById("gro" + j).value) - agncomamnt
    //            //   agncomamnt = (parseFloat(agncomamnt) * parseFloat(addcomm1) / 100);
    //            document.getElementById("cashd" + j).value = cashdisamnt;
    //        }
    //    }

    if (document.getElementById('hiddenafency_retainer').value == "Y") {
        if (document.getElementById('drpretainer').value == "") {
            // document.getElementById('btnshgrid').focus();
            // document.getElementById('txtgrossamt').value='';
            return false;
        }
        else {
            //get retainer code *6Aug*
            if (document.getElementById('drpretainer').value == null || document.getElementById('drpretainer').value == "" || document.getElementById('drpretainer').value == "0") {
                // document.getElementById('btnshgrid').focus();  //*25Aug*
                //  document.getElementById('txtgrossamt').value='';
                return false;
            }
            else {
                var retain_name = document.getElementById('drpretainer').value.split('(');
                var retain_code = retain_name[1].replace(')', '');
            }
            //*6Aug*  var response = Classified_Booking.getRetainerComm(document.getElementById('drpretainer').value,document.getElementById('hiddencompcode').value);
            var response = Classified_Booking.getRetainerComm(retain_code, document.getElementById('hiddencompcode').value);
            if (response != null) {
                var ds = response.value;
                if (ds == null) {
                    // document.getElementById('txtgrossamt').value='';
                    return false;
                }
                if (ds.Tables[0].Rows.length > 0) {
                    if (ds.Tables[0].Rows[0].retainercomm == null) {
                        var retainercomm = 0;
                    }
                    else {
                        retainercomm = ds.Tables[0].Rows[0].retainercomm;
                    }
                    if (retainercomm != "0") {
                        if (parseInt(document.getElementById('txtaddagencycommrate').value) > parseInt(retainercomm)) {
                            alert("Agency Commission can't be greater than Retainer Commission.");
                            if (document.getElementById('txtaddagencycommrateamt') != null) {
                                document.getElementById('txtaddagencycommrateamt').value = "";
                                document.getElementById('txtaddagencycommrate').value = "";
                                document.getElementById('txtaddagencycommrate').focus();
                            }
                            return false;
                        }
                    }
                }
            }
        }
    }
    else {
        document.getElementById('btnshgrid').focus();
        return false;
    }

    // document.getElementById('txtgrossamt').value='';
    // return false;
}
function chkmaincodeAgency(name) {
    if (name == "agency") {
        if (document.getElementById('txtagency').value.indexOf("(") > 0) {
            var code = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.lastIndexOf(')'));
            var res = Classified_Booking.chkCodeMain("agency", code, document.getElementById('hiddencompcode').value);
            if (res.value != null) {
                if (res.value == false) {
                    alert("Please Enter Valid Agency");
                    // document.getElementById('txtagency').value="";
                    document.getElementById('txtagency').focus();
                    return false;
                }
                else if (code.indexOf(document.getElementById('drpagscode').value) != 0) {
                    alert("Agency and Ageny Code doesn't match");
                    // document.getElementById('txtagency').value="";
                    document.getElementById('drpagscode').focus();
                    return false;
                }
            }

        }
        else if (document.getElementById('txtagency').value != "") {
            alert("Please Enter Valid Agency");
            return false;
        }
    }
    else if (name == "retainer") {
        if (document.getElementById('drpretainer').value.indexOf("(") > 0) {
            var code = document.getElementById('drpretainer').value.substring(document.getElementById('drpretainer').value.lastIndexOf('(') + 1, document.getElementById('drpretainer').value.lastIndexOf(')'));
            var res = Classified_Booking.chkCodeMain("retainer", code, document.getElementById('hiddencompcode').value);
            if (res.value != null) {
                if (res.value == false) {
                    var b = "Retainer";
                    if (browser != "Microsoft Internet Explorer") {

                        b = document.getElementById('lblretainer').textContent.replace("*[F2]", "");
                    }
                    else {

                        b = document.getElementById('lblretainer').innerText.replace("*[F2]", "");
                    }
                    alert("Please Enter Valid " + b);
                    //   document.getElementById('drpretainer').value="";
                    document.getElementById('drpretainer').focus();
                    return false;
                }
            }

        }
        else if (document.getElementById('drpretainer').value != "" && document.getElementById('drpretainer').value != "0") {
            var b = "Retainer";
            if (browser != "Microsoft Internet Explorer") {

                b = document.getElementById('lblretainer').textContent.replace("*[F2]", "");
            }
            else {

                b = document.getElementById('lblretainer').innerText.replace("*[F2]", "");
            }
            alert("Please Enter Valid " + b);
            return false;
        }
    }
    else if (name == "executive") {
        if (document.getElementById('txtexecname').value.indexOf("(") > 0) {
            var code = document.getElementById('txtexecname').value.substring(document.getElementById('txtexecname').value.lastIndexOf('(') + 1, document.getElementById('txtexecname').value.lastIndexOf(')'));
            var res = Classified_Booking.chkCodeMain("executive", code, document.getElementById('hiddencompcode').value);
            if (res.value != null) {
                if (res.value == false) {
                    var a = "Executive name";
                    if (browser != "Microsoft Internet Explorer") {
                        a = document.getElementById('lbececname').textContent.replace("*[F2]", "");
                    }
                    else {
                        a = document.getElementById('lbececname').innerText.replace("*[F2]", "");
                    }
                    alert("Please Enter Valid " + a);
                    //  document.getElementById('txtexecname').value="";
                    document.getElementById('txtexecname').focus();
                    return false;
                }
            }

        }
        else if (document.getElementById('txtexecname').value != "" && document.getElementById('txtexecname').value != "0") {
            var a = "Executive name";
            if (browser != "Microsoft Internet Explorer") {
                a = document.getElementById('lbececname').textContent.replace("*[F2]", "");
            }
            else {
                a = document.getElementById('lbececname').innerText.replace("*[F2]", "");
            }
            alert("Please Enter Valid " + a);
            return false;
        }
    }
    else if (name.indexOf('seccode') >= 0) {
        var code = document.getElementById(name).value;
        //else if (name == "seccode") {
        //var code = document.getElementById("seccode0").value;
        var res = Classified_Booking.chkCodeMain("seccode", code, document.getElementById('hiddencompcode').value);
        if (res.value != null) {
            if (res.value == false) {
                var a = "Chart Type";
                var b = "Chart Type";
                alert("Please Enter Valid " + a);
                document.getElementById('seccode0').focus();
                return false;
            }
        }
    }
    else if (name.indexOf('resno') >= 0) {
        var code = document.getElementById(name).value;
        //else if (name == "resno") {
        //var code = document.getElementById("resno0").value;
        var res = Classified_Booking.chkCodeMain("resno", code, document.getElementById('hiddencompcode').value);
        if (res.value != null) {
            if (res.value == false) {
                var a = "Order Type";
                var b = "Order Type";
                alert("Please Enter Valid " + a);
                document.getElementById('resno0').focus();
                return false;
            }
        }
    }

}
function blankGross() {
    //    if(paivar=="Y")
    //    {
    //        document.getElementById(document.activeElement.id).value="Y";
    //    }
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtbillamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
}


function ShowClassified_Page() {
    if (document.getElementById('TextBox1').value == null || document.getElementById('TextBox1').value == "" || document.getElementById('TextBox1').value == "0") {
        alert('Enter Page number for Preview.');
        return false;
    }
    if (document.getElementById('drpEdition').value == "0" || document.getElementById('drpEdition').value == "" || document.getElementById('drpEdition').value == null) {
        alert('Select Edition for Preview.');
        return false;
    }
    chldWindow = window.open('AdvtPreview.aspx?pEdition=' + document.getElementById('drpedition').value + '&ppage=' + document.getElementById('TextBox1').value, 'Preview', 'width=660px,height=1020,resizable=0,left=10,top=10,scrollbars=yes');
    return false;
}

function popUpCalendarPreview(ctl, ctl2, format) {
    // var aaaa=ctl2.value;
    //alert(ctl2.disabled);

    if (ctl2.disabled == true) {
        hideCalendar();
        return;
    }
    var abc = document.getElementById('hiddendateformat').value;
    if (abc == null || abc == "" || abc == "undefined") {
        format = "mm/dd/yyyy";
    }
    else {
        format = abc;
    }
    var leftpos = 100
    var toppos = 0

    if (bPageLoaded) {
        if (crossobj.visibility == "hidden") {
            ctlToPlaceValue = ctl2
            dateFormat = format;

            formatChar = " "
            aFormat = dateFormat.split(formatChar)
            if (aFormat.length < 3) {
                formatChar = "/"
                aFormat = dateFormat.split(formatChar)
                if (aFormat.length < 3) {
                    formatChar = "."
                    aFormat = dateFormat.split(formatChar)
                    if (aFormat.length < 3) {
                        formatChar = "-"
                        aFormat = dateFormat.split(formatChar)
                        if (aFormat.length < 3) {
                            // invalid date	format
                            formatChar = ""
                        }
                    }
                }
            }

            tokensChanged = 0
            if (formatChar != "") {
                // use user's date

                aData = ctl2.value.split(formatChar)

                for (i = 0; i < 3; i++) {
                    if ((aFormat[i] == "d") || (aFormat[i] == "dd")) {
                        dateSelected = parseInt(aData[i], 10)
                        tokensChanged++
                    }
                    else if ((aFormat[i] == "m") || (aFormat[i] == "mm")) {
                        monthSelected = parseInt(aData[i], 10) - 1
                        tokensChanged++
                    }
                    else if (aFormat[i] == "yyyy") {
                        yearSelected = parseInt(aData[i], 10)
                        tokensChanged++
                    }
                    else if (aFormat[i] == "mmm") {
                        for (j = 0; j < 12; j++) {
                            if (aData[i] == monthName[j]) {
                                monthSelected = j
                                tokensChanged++
                            }
                        }
                    }
                    else if (aFormat[i] == "mmmm") {
                        for (j = 0; j < 12; j++) {
                            if (aData[i] == monthName2[j]) {
                                monthSelected = j
                                tokensChanged++
                            }
                        }
                    }
                }
            }

            if ((tokensChanged != 3) || isNaN(dateSelected) || isNaN(monthSelected) || isNaN(yearSelected)) {
                var ad = new Date;
                dateSelected = ad.getDate(); //dateNow
                monthSelected = ad.getMonth(); //monthNow
                yearSelected = ad.getYear(); //yearNow
            }

            odateSelected = dateSelected
            omonthSelected = monthSelected
            oyearSelected = yearSelected

            aTag = eval(ctl)
            var btag;
            do {
                aTag = eval(aTag.offsetParent);
                leftpos += aTag.offsetLeft;
                toppos += aTag.offsetTop;
                btag = eval(aTag)
            } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");

            crossobj.left = fixedX == -1 ? ctl.offsetLeft + leftpos - 250 : fixedX
            crossobj.top = fixedY == -1 ? ctl.offsetTop + toppos + ctl.offsetHeight + 2 : fixedY
            constructCalendar(1, monthSelected, yearSelected);
            crossobj.visibility = (dom || ie) ? "visible" : "show"

            hideElement('SELECT', document.getElementById("calendar"));
            hideElement('APPLET', document.getElementById("calendar"));

            bShow = true;
        }
        else {
            hideCalendar()
            if (ctlNow != ctl) { popUpCalendarPreview(ctl, ctl2, format) }
        }
        ctlNow = ctl
    }
}
function getsplchargeBlank() {
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtbillamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
}
function OriRetainerComm() {
    if (document.getElementById('drpretainer').value != "" && document.getElementById('drpretainer').value != "0") {
        document.getElementById('txtRetainercomm').value = "";
        var retain_name = document.getElementById('drpretainer').value.split('(');
        var retain_code = retain_name[1].replace(')', '');
        var ds_ret = Classified_Booking.getRetainerComm(retain_code, document.getElementById('hiddencompcode').value);

        if (ds_ret.value == null)
            return false;

        if (ds_ret.value.Tables[0].Rows.length > 0) {
            document.getElementById('retcommtype').value = ds_ret.value.Tables[0].Rows[0].Discount;
            document.getElementById('txtRetainercomm').value = ds_ret.value.Tables[0].Rows[0].retainercomm;
            document.getElementById('retcomm').value = ds_ret.value.Tables[0].Rows[0].retainercomm;
            if (document.getElementById('retcommtype').value == "Gross" && document.getElementById('txtgrossamt').value != "" && document.getElementById('txtRetainercomm').value != "" && document.getElementById('txtRetainercomm').value != null) {
                document.getElementById('txtRetainercommamt').value = (parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(document.getElementById('txtRetainercomm').value) / 100).toFixed(2);
            }
            else if (document.getElementById('retcommtype').value == "Net" && document.getElementById('txtbillamt').value != "" && document.getElementById('txtRetainercomm').value != "" && document.getElementById('txtRetainercomm').value != null) {
                document.getElementById('txtRetainercommamt').value = (parseFloat(document.getElementById('txtbillamt').value) * parseFloat(document.getElementById('txtRetainercomm').value) / 100).toFixed(2);
            }
        }

    }
}


//=====================    get date for MY SQL ===================================//


function mySqlDate(value1) {
    var dateformat = document.getElementById('hiddendateformat').value;
    var newdate = value1;
    if (dateformat == "dd/mm/yyyy") {
        var arrvalue1 = newdate.split('/');
        dd = arrvalue1[0];
        mm = arrvalue1[1];
        yy = arrvalue1[2];
    }
    else if (dateformat == "mm/dd/yyyy") {
        var arrvalue1 = newdate.split('/');
        dd = arrvalue1[1];
        mm = arrvalue1[0];
        yy = arrvalue1[2];
    }
    else if (dateformat == "yyyy/mm/dd") {
        var arrvalue1 = newdate.split('/');
        dd = arrvalue1[2];
        mm = arrvalue1[1];
        yy = arrvalue1[0];
    }
    if (document.getElementById('hiddenconnect').value == "mysql") {
        /* var arrvalue1=value1.split('-');
        dd=arrvalue1[0];
        mm=arrvalue1[1];
        yy=arrvalue1[2];  */
        //mm=getmonthstrNumber(mm);
        //  newdate=yy + "-" + mm + "-" + dd;
        newdate = yy + "/" + mm + "/" + dd;
    }
    return newdate;
}


function getmonthstrNumber(m_value) {
    var month = "";
    switch (m_value) {
        case "Jan":
            month = "01";
            break;

        case "Feb":
            month = "02";
            break;

        case "Mar":
            month = "03";
            break;

        case "Apr":
            month = "04";
            break;

        case "May":
            month = "05";
            break;

        case "Jun":
            month = "06";
            break;

        case "Jul":
            month = "07";
            break;

        case "Aug":
            month = "08";
            break;

        case "Sep":
            month = "09";
            break;

        case "Oct":
            month = "10";
            break;

        case "Nov":
            month = "11";
            break;

        case "Dec":
            month = "12";
            break;

        ////////////////   


    }

    return month;
}
function checkBarterAmt() {
    if (document.getElementById('txtbartertype').value != "") {
        var bartertype = "";
        if (document.getElementById('txtbartertype').value != "" && document.getElementById('txtbartertype').value.indexOf('(') >= 0 && document.getElementById('txtbartertype').value.indexOf(')') >= 0)
            bartertype = document.getElementById('txtbartertype').value.substring(document.getElementById('txtbartertype').value.indexOf('(') + 1, document.getElementById('txtbartertype').value.indexOf(')'));
        if (bartertype != "") {
            var res = Classified_Booking.getBarterBookingAmt(bartertype, document.getElementById('txtciobookid').value, document.getElementById('hiddencompcode').value);
            if (res.value != null) {
                var ds = res.value;
                if (ds.Tables[0].Rows.length > 0) {
                    if (ds.Tables[0].Rows[0].AMT != null) {
                        var bookingamount = parseFloat(ds.Tables[0].Rows[0].AMT) + parseFloat(document.getElementById('txtbillamt').value);
                        var barteramount = document.getElementById('hiddenbarteramt').value;
                        if (parseFloat(bookingamount) > parseFloat(barteramount)) {
                            if (document.getElementById('hiddenstopbarterbooking').value == "Y") {
                                alert("Booking Amount exceed Barter Amount");
                                return false;
                            }
                            else {
                                if (confirm("Booking Amount exceed Barter Amount. Do You want to Continue")) {
                                    return true;
                                }
                                else {
                                    return false;
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}
function checkCirValidAgency() {
    if (document.getElementById('txtciragency').value != "") {
        if (document.getElementById('txtciragency').value.indexOf('(') < 0 || document.getElementById('txtciragency').value.indexOf(')') < 0 || document.getElementById('txtciragency').value.indexOf('+') < 0) {
            alert('Please Enter Valid Cir. Agency');
            document.getElementById('txtciragency').focus();
            return false;
        }
        else {
            var ciragency = document.getElementById('txtciragency').value;
            var ciragencysubcode = '';
            if (ciragency != "") {
                var myarrayex = ciragency.split('(');
                var agecirname = myarrayex[1].replace(")", "").split('+')[0];
                ciragency = trim(agecirname);
                ciragencysubcode = trim(myarrayex[1].replace(")", "").split('+')[1]);
            }
            var resagname = Classified_Booking.getcirAgency(document.getElementById('hiddencompcode').value, document.getElementById('txtbranch').value, ciragency, ciragencysubcode)
            if (resagname.value == null) {
                alert(resagname.error.description);
                return false;
            }
            if (resagname.value.Tables.length < 0 || resagname.value.Tables[0].Rows.length < 0) {
                alert('Please Enter Valid Cir. Agency');
                document.getElementById('txtciragency').focus();
                return false;
            }
            else if (resagname.value.Tables[0].Rows[0].AGENCYNAME == null || resagname.value.Tables[0].Rows[0].AGENCYNAME == "null") {
                alert('Please Enter Valid Cir. Agency');
                document.getElementById('txtciragency').focus();
                return false;
            }
        }
    }
}
function blankAgency() {
    if (document.getElementById('txtagency').value == "") {
        alert("Please Enter Agency");
        document.getElementById('txtagency').focus();
        return false;
    }
}
function setButtonImages() {
    if (document.getElementById('btnNew').disabled == true)
        document.getElementById('btnNew').src = "btimages/new-off.jpg";
    else
        document.getElementById('btnNew').src = "btimages/new.jpg";

    if (document.getElementById('btnSave').disabled == true)
        document.getElementById('btnSave').src = "btimages/save-off.jpg";
    else
        document.getElementById('btnSave').src = "btimages/save.jpg";

    if (document.getElementById('btnModify').disabled == true)
        document.getElementById('btnModify').src = "btimages/modify-off.jpg";
    else
        document.getElementById('btnModify').src = "btimages/modify.jpg";

    if (document.getElementById('btnQuery').disabled == true)
        document.getElementById('btnQuery').src = "btimages/query-off.jpg";
    else
        document.getElementById('btnQuery').src = "btimages/query.jpg";

    if (document.getElementById('btnExecute').disabled == true)
        document.getElementById('btnExecute').src = "btimages/execute-off.jpg";
    else
        document.getElementById('btnExecute').src = "btimages/execute.jpg";

    if (document.getElementById('btnCancel').disabled == true)
        document.getElementById('btnCancel').src = "btimages/clear-off.jpg";
    else
        document.getElementById('btnCancel').src = "btimages/clear.jpg";

    if (document.getElementById('btnfirst').disabled == true)
        document.getElementById('btnfirst').src = "btimages/first-off.jpg";
    else
        document.getElementById('btnfirst').src = "btimages/first.jpg";

    if (document.getElementById('btnprevious').disabled == true)
        document.getElementById('btnprevious').src = "btimages/previous-off.jpg";
    else
        document.getElementById('btnprevious').src = "btimages/previous.jpg";

    if (document.getElementById('btnnext').disabled == true)
        document.getElementById('btnnext').src = "btimages/next-off.jpg";
    else
        document.getElementById('btnnext').src = "btimages/next.jpg";

    if (document.getElementById('btnlast').disabled == true)
        document.getElementById('btnlast').src = "btimages/last-off.jpg";
    else
        document.getElementById('btnlast').src = "btimages/last.jpg";

    if (document.getElementById('btnDelete').disabled == true)
        document.getElementById('btnDelete').src = "btimages/delete-off.jpg";
    else
        document.getElementById('btnDelete').src = "btimages/delete.jpg";

    if (document.getElementById('btnExit').disabled == true)
        document.getElementById('btnExit').src = "btimages/exit-off.jpg";
    else
        document.getElementById('btnExit').src = "btimages/exit.jpg";
}
function checkTradeFocus() {
    tradefoc = document.getElementById('txttradedisc').value;
}
function getfocusPackage(obj) {
    var idfoc = obj.id;
    if (idfocus != "") {
        document.getElementById(idfocus).style.backgroundColor = "";
    }
    document.getElementById(idfoc).style.backgroundColor = "#FFFF80";

    idfocus = obj.id;
    with (obj.style) {
        left = obj.offsetLeft;
        top = obj.offsetTop;
        width = "280px"
        // position="absolute";

    }
}
function lostfocusPackage(obj) {
    with (obj.style) {
        left = obj.offsetLeft;
        top = obj.offsetTop;
        width = "180px"
        // position="absolute";

    }
}
function opensplitedition(edition, idnum) {
    var size = "siz" + idnum;
    var insertsta = "inssta" + idnum;
    showid = "sho" + idnum;
    var showidval = "";
    if (document.getElementById(showid) != null)
        showidval = document.getElementById(showid).value;
    if (showidval == "") {
        showid = "spltdata" + idnum;
        showidval = document.getElementById(showid).value;
    }
    if (document.getElementById(size) != null && document.getElementById(size).value != "") {
        window.open('spliteditionsize.aspx?cioid=' + document.getElementById('txtciobookid').value + '&showid=' + showidval + '&insertstatus=' + document.getElementById(insertsta).value + '&chkbtnStatus=' + chkbtnStatus + '&totalarea=' + document.getElementById(size).value + '&idnum=' + idnum + '&dateformat=' + document.getElementById('hiddendateformat').value + '&edition=' + edition + '&receiptno=' + document.getElementById('txtreceipt').value, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=144,left=210,width=560px,height=300px');
    }
    else {
        alert("ToTal Area can't be blank");
        return false;
    }
}
function getDiscPrem() {
    hiddisctype = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtbillamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    var res = Classified_Booking.getDiscPrem(document.getElementById('hiddencompcode').value, document.getElementById('drpdiscountprem').value);
    var ds = res.value;
    if (ds == null) {
        alert(res.error.description);
        return false;
    }
    if (ds.Tables[0].Rows.length > 0 && ds.Tables[0].Rows[0].DESC_PREM != null) {
        if (ds.Tables[0].Rows[0].DISC_TYPE == "P") {
            document.getElementById('txtspediscper').value = ds.Tables[0].Rows[0].DESC_PREM;
            document.getElementById('txtspedisc').value = "";
            spdisc = 0;
            spdiscper = 1;
            hiddisctype = "P";
        }
        else if (ds.Tables[0].Rows[0].DISC_TYPE == "F") {
            document.getElementById('txtspedisc').value = ds.Tables[0].Rows[0].DESC_PREM;
            document.getElementById('txtspediscper').value = "";
            spdisc = 1;
            spdiscper = 0;
            hiddisctype = "F";
        }
        else {
            document.getElementById('txtspediscper').value = ds.Tables[0].Rows[0].DESC_PREM;
            document.getElementById('txtspedisc').value = "";
            spdisc = 0;
            spdiscper = 1;
            hiddisctype = "S";
        }
        var len = "bookdiv";
        var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
        for (var i = 0; i < y; i++) {
            if (document.getElementById("disc_" + i) != null) {
                document.getElementById("disc_" + i).value = ds.Tables[0].Rows[0].DESC_PREM;
            }
            else {
                i = y;
            }
        }
    }
    else {
        document.getElementById('txtspediscper').value = "";
        document.getElementById('txtspedisc').value = "";
        var len = "bookdiv";
        var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
        for (var i = 0; i < y; i++) {
            if (document.getElementById("inssta" + i).value == 'booked' && document.getElementById("disc_" + i) != null) {
                document.getElementById("disc_" + i).value = "";
            }
            else {
                i = y;
            }
        }
    }
}
//new change for space discount calculation
function getspacedisc(Activid) {
    if (document.getElementById('txtspacedisc').value != "" || document.getElementById('txtspacedisc').value != "") {
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtbillamt').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        if (document.getElementById('hiddenuomdesc').value == 'CD') {
            var totalarea_var;
            if (document.getElementById("txtbillwidth").value != "" && document.getElementById("txtbillheight").value != "") {
                totalarea_var = parseFloat(document.getElementById("txtbillwidth").value) * parseFloat(document.getElementById("txtbillheight").value);
            }
            totalarea_var = document.getElementById('txttotalarea').value;
            //var totalarea_var=document.getElementById('txttotalarea');
            var billAmount = 0;
            if (document.getElementById('txtagreedrate').value != "" && document.getElementById('txtagreedamt').value != "" && agreedrate_active == "0") {
                document.getElementById('txtspacedisc').value = "";
                document.getElementById('txtspadiscper').value = "";
                // alert('Special discount can not applied in case of agreed rate.' );
                return false;
            }
            var cardrate = document.getElementById('txtcardrate').value;
            if (agreedrate_active == 1) {
                cardrate = document.getElementById('txtagreedrate').value;
            }
            if (Activid == "txtspacedisc" && document.getElementById('txtspacedisc').value != "") {
                document.getElementById('txtgrossamt').value = "";
                document.getElementById('txtgrossamtlocal').value = "";
                document.getElementById('txtbillamtlocal').value = "";
                if (parseFloat(cardrate) < parseFloat(document.getElementById('txtspacedisc').value)) {
                    // alert('Special discount can not be greated than card rate');
                    document.getElementById('txtspacedisc').value = "";
                    return false;
                }
                ddiscspace = 1;
                ddiscspaceper = 0;
                document.getElementById('txtspadiscper').value = ((parseFloat(document.getElementById('txtspacedisc').value) / parseFloat(cardrate)) * 100).toFixed(2);
            }

            if (Activid == "txtspadiscper" && document.getElementById('txtspadiscper').value != "") {
                document.getElementById('txtgrossamt').value = "";
                document.getElementById('txtgrossamtlocal').value = "";
                document.getElementById('txtbillamtlocal').value = "";
                if (parseFloat(document.getElementById('txtspadiscper').value) > 100) {
                    alert('Space discount can not be greated than 100%');
                    document.getElementById('txtspadiscper').value = "";
                    return false;
                }
                ddiscspace = 0;
                ddiscspaceper = 1;
                document.getElementById('txtspacedisc').value = (parseFloat(cardrate) * parseFloat(document.getElementById('txtspadiscper').value) / 100).toFixed(2);
            }
            if (document.getElementById('txtspacedisc').value != "") {
                ddiscspace = 1;
                ddiscspaceper = 0;
            }
            if (document.getElementById('txtspacedisc').value == "" || document.getElementById('txtspadiscper').value == "") {
                ddiscspace = 0;
                ddiscspaceper = 0;
                document.getElementById('txtspacedisc').value = "";
                document.getElementById('txtspadiscper').value = "";
            }
            else {
                var paidCount = document.getElementById('txtinsertion').value;
                var finsert = 1;
                var tinsert = 0;
                var br_spcharge = 0;
                document.getElementById('txtgrossamt').value = "";
                document.getElementById('txtgrossamtlocal').value = "";
                document.getElementById('txtbillamtlocal').value = "";
                if (document.getElementById('drppackagecopy').options.length > 0) {
                    for (var insertCou = 0; insertCou < document.getElementById('drppackagecopy').options.length; insertCou++) {
                        if (document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') >= 0) {
                            tinsert = document.getElementById('drppackagecopy').options[insertCou].value.substring(document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') + 1, document.getElementById('drppackagecopy').options[insertCou].value.indexOf(')'));
                            if (parseInt(tinsert) > parseInt(finsert)) {
                                finsert = tinsert;
                            }
                            paidCount = parseInt(paidCount) * parseInt(tinsert);
                        }
                    }
                }
                var splcharges = document.getElementById('txtspacedisc').value;
                var grossAmt = (parseFloat(cardrate) - parseFloat(splcharges)) * parseInt(paidCount, 10) * parseFloat(totalarea_var);
                if (ddiscspace == 1) {
                    var len = "bookdiv";
                    var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
                    for (var s = 0; s < count; s++) {
                        var gross_var = document.getElementById('gro' + s);
                        var bill_var = document.getElementById('ba' + s);
                        var insertsta = document.getElementById("inssta" + s);
                        var splcharges_grid = (parseFloat(document.getElementById('card' + s).value) / parseFloat(document.getElementById('txtcardrate').value)) * splcharges;
                        if (gross_var != null && document.getElementById("inssta" + s).value != "cancel" && document.getElementById("pai" + s).value != "N") {
                            if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                                gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid) * parseFloat(totalarea_var))).toFixed(4);
                            // bill_var.value = (parseFloat(bill_var.value) - (parseFloat(splcharges_grid)*parseFloat(totalarea_var))).toFixed(2);                       
                            // trade disc
                            var tradisc = document.getElementById('txttradedisc').value;
                            if (document.getElementById('chktrade').checked == false)
                                tradisc = 0;
                            if (tradisc == "")
                                tradisc = 0;
                            var trdisc1 = tradisc;
                            var addcomm = 0;
                            if (document.getElementById('txtaddagencycommrate') != null) {
                                if (document.getElementById('hiddenagcommflag').value != "1")
                                    addcomm = document.getElementById('txtaddagencycommrate').value;
                            }
                            if (addcomm == "") {
                                addcomm = "0";
                            }
                            if (addcomm != "0") {
                                trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                            }
                            if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                                bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);
                            br_spcharge = (parseFloat(br_spcharge) + parseFloat(gross_var.value)).toFixed(2);
                            billAmount = (parseFloat(billAmount) + parseFloat(bill_var.value)).toFixed(2);
                        }
                    }
                }


                if (ddiscspaceper == 1) {
                    //  var br_spcharge=0;
                    var splcharges = document.getElementById('txtspadiscper').value;
                    var grossAmt = document.getElementById('txtgrossamt').value;
                    var len = "bookdiv";
                    var ratio = 0;
                    var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
                    for (var s = 0; s < count; s++) {
                        var gross_var = document.getElementById('gro' + s);
                        var bill_var = document.getElementById('ba' + s);
                        var insertsta = document.getElementById("inssta" + s);
                        if (gross_var != null && document.getElementById("inssta" + s).value != "cancel" && document.getElementById("pai" + s).value != "N") {

                            //                    if(s==count-1)
                            //                    {
                            //                        document.getElementById('gro'+s).value = (parseFloat(document.getElementById('gro'+s).value) - ((parseFloat(splcharges)*parseFloat(cardrate)/100)-parseFloat(br_spcharge))).toFixed(2);
                            //                    }
                            //                    else
                            //                    {
                            //                       ratio = (parseFloat(document.getElementById('gro'+s).value) * (parseFloat(splcharges)*parseFloat(cardrate)*parseFloat(document.getElementById('txttotalarea').value)/100) / parseFloat(grossAmt))
                            var splcharges_grid = (parseFloat(document.getElementById('card' + s).value) * splcharges) / 100;
                            if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                                gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid) * parseFloat(totalarea_var))).toFixed(4);
                            //  bill_var.value = (parseFloat(bill_var.value) - (parseFloat(splcharges_grid)*parseFloat(totalarea_var))).toFixed(2);
                            // trade disc
                            var tradisc = document.getElementById('txttradedisc').value;
                            if (document.getElementById('chktrade').checked == false)
                                tradisc = 0;
                            if (tradisc == "")
                                tradisc = 0;
                            var trdisc1 = tradisc;
                            var addcomm = 0;
                            if (document.getElementById('txtaddagencycommrate') != null) {
                                if (document.getElementById('hiddenagcommflag').value != "1")
                                    addcomm = document.getElementById('txtaddagencycommrate').value;
                            }
                            if (addcomm == "") {
                                addcomm = "0";
                            }
                            if (addcomm != "0") {
                                trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                            }
                            if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                                bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);
                            br_spcharge = (parseFloat(br_spcharge) + parseFloat(gross_var.value)).toFixed(2);
                            billAmount = (parseFloat(billAmount) + parseFloat(bill_var.value)).toFixed(2);
                            //                    }  
                        }
                    }
                }
                if (br_spcharge == 0) {
                    if (grossAmt == "")
                        grossAmt = 0;
                    br_spcharge = grossAmt;
                }
                document.getElementById('txtgrossamt').value = parseFloat(br_spcharge);
                if (Activid == "txtspacedisc" || Activid == "txtspadiscper")
                    document.getElementById('txtgrossamt').value = "";
                if (billAmount != 0)
                    document.getElementById('txtbillamt').value = parseFloat(billAmount).toFixed(2);
            }
            if (document.getElementById('txtspadiscper').value != "") {
                var spacedisc = document.getElementById('txtspadiscper').value;
                if (document.getElementById('txtspediscper').value != "") {
                    spacedisc = parseFloat(spacedisc) + parseFloat(document.getElementById('txtspediscper').value);
                }
                if (document.getElementById('hiddenuserdisc').value != "" && document.getElementById('hiddenuserdisc').value != "0") {
                    if (parseFloat(spacedisc) > parseFloat(document.getElementById('hiddenuserdisc').value)) {
                        alert("User Allowed Commission can't be greater than " + document.getElementById('hiddenuserdisc').value);
                        document.getElementById('txtspadiscper').value = "";
                        document.getElementById('txtspacedisc').value = "";
                        return false;
                    }
                }

            }
        }
    }
}
function getspecialdisc(Activid) {
    //if(document.getElementById('txtspedisc').value!="" || document.getElementById('txtspediscper').value!="")
    //{
    commaremove();
    var totalarea_var;
    if (document.getElementById("txtbillwidth").value != "" && document.getElementById("txtbillheight").value != "") {
        totalarea_var = parseFloat(document.getElementById("txtbillwidth").value) * parseFloat(document.getElementById("txtbillheight").value);
    }
    totalarea_var = document.getElementById('txttotalarea').value;
    br_spcharge = 0;
    var billAmount = 0;
    //var totalarea_var=document.getElementById('txttotalarea');
    var pkg_copy = document.getElementById('drppackagecopy');
    if (document.getElementById('txtagreedrate').value != "" && document.getElementById('txtagreedamt').value != "" && agreedrate_active == 0) {
        document.getElementById('txtspedisc').value = "";
        document.getElementById('txtspediscper').value = "";
        // alert('Special discount can not applied in case of agreed rate.' );
        return false;
    }
    if (document.getElementById('hiddenuomdesc').value != "CD" && document.getElementById('hiddenuomdesc').value != "ROW") {
        document.getElementById('txtspedisc').value = "";
        document.getElementById('txtspediscper').value = "";
        // alert('Special discount can not applied in case of agreed rate.' );
        return false;
    }
    var cardrate = document.getElementById('txtcardrate').value;
    if (agreedrate_active == 1) {
        cardrate = document.getElementById('txtagreedrate').value;
    }
    if (Activid == "txtspedisc" && document.getElementById('txtspedisc').value != "") {
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        document.getElementById('txtbillamt').value = "";
        if (parseFloat(cardrate) < parseFloat(document.getElementById('txtspedisc').value)) {
            // alert('Special discount can not be greated than card rate');
            document.getElementById('txtspedisc').value = "";
            return false;
        }
        spdisc = 1;
        spdiscper = 0;
        document.getElementById('txtspediscper').value = ((parseFloat(document.getElementById('txtspedisc').value) / parseFloat(cardrate)) * 100).toFixed(2);
    }

    if (Activid == "txtspediscper" && document.getElementById('txtspediscper').value != "") {
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        document.getElementById('txtbillamt').value = "";
        if (parseFloat(document.getElementById('txtspediscper').value) > 100) {
            alert('Special discount can not be greated than 100%');
            document.getElementById('txtspediscper').value = "";
            return false;
        }
        spdisc = 0;
        spdiscper = 1;
        document.getElementById('txtspedisc').value = (parseFloat(cardrate) * parseFloat(document.getElementById('txtspediscper').value) / 100).toFixed(2);
    }
    if (document.getElementById('txtspedisc').value != "" && spdisc != 1 && spdiscper != 1) {
        spdisc = 0;
        spdiscper = 1;
    }
    if ((document.getElementById('txtspedisc').value == "" || document.getElementById('txtspediscper').value == "") && document.getElementById('txtgrossamt').value == "") {
        spdisc = 0;
        spdiscper = 0;
        document.getElementById('txtspedisc').value = "";
        document.getElementById('txtspediscper').value = "";
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        document.getElementById('txtbillamt').value = "";
    }
    else {
        if (document.getElementById('txtspedisc').value == "" && document.getElementById('txtspediscper').value != "") {
            document.getElementById('txtspedisc').value = (parseFloat(cardrate) * parseFloat(document.getElementById('txtspediscper').value) / 100).toFixed(2);
        }
        else if (document.getElementById('txtspedisc').value != "" && document.getElementById('txtspediscper').value == "") {
            document.getElementById('txtspediscper').value = ((parseFloat(document.getElementById('txtspedisc').value) / parseFloat(cardrate)) * 100).toFixed(2);
        }
        var paidCount = document.getElementById('txtinsertion').value;
        var finsert = 1;
        var tinsert = 0;
        var br_spcharge = 0;
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        document.getElementById('txtbillamt').value = "";
        if (pkg_copy.options.length > 0) {
            for (var insertCou = 0; insertCou < pkg_copy.options.length; insertCou++) {
                if (pkg_copy.options[insertCou].value.indexOf('(') >= 0) {
                    tinsert = pkg_copy.options[insertCou].value.substring(pkg_copy.options[insertCou].value.indexOf('(') + 1, pkg_copy.options[insertCou].value.indexOf(')'));
                    if (parseInt(tinsert) > parseInt(finsert)) {
                        finsert = tinsert;
                    }
                    paidCount = parseInt(paidCount) * parseInt(tinsert);
                }
            }
        }
        var splcharges = document.getElementById('txtspedisc').value;
        var grossAmt = (parseFloat(cardrate) - parseFloat(splcharges)) * parseInt(paidCount, 10) * parseFloat(document.getElementById('txttotalarea').value);
        if (spdisc == 0 && spdiscper == 0) {
            spdiscper = 1;
        }
        if (spdisc == 1) {
            var len = "bookdiv";
            var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
            for (var s = 0; s < count; s++) {
                splcharges = document.getElementById('txtspedisc').value;
                if (document.getElementById("disc_" + s) != null && document.getElementById("disc_" + s).value != "" && document.getElementById("disc_" + s).value != "0")
                    splcharges = document.getElementById("disc_" + s).value;
                if (splcharges == "")
                    splcharges = 0;
                var gross_var = document.getElementById('gro' + s);
                var bill_var = document.getElementById('ba' + s);
                var insertsta = document.getElementById("inssta" + s);
                var tot1 = document.getElementById("siz" + s);
                var splcharges_grid = (parseFloat(document.getElementById('gro' + s).value) / parseFloat(document.getElementById('txtcardamt').value)) * splcharges;
                if (gross_var != null && document.getElementById("inssta" + s).value != "cancel" && document.getElementById("pai" + s).value != "N") {
                    if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                        document.getElementById("spld" + s).value = (parseFloat(splcharges_grid)).toFixed(2);
                        // gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid)*parseFloat(tot1.value))).toFixed(2);    
                        gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid))).toFixed(4);
                    }
                    //  bill_var.value = (parseFloat(bill_var.value) - (parseFloat(splcharges_grid)*parseFloat(totalarea_var))).toFixed(2);                      
                    // trade disc
                    var tradisc = document.getElementById('txttradedisc').value;
                    if (document.getElementById('chktrade').checked == false)
                        tradisc = 0;
                    if (tradisc == "")
                        tradisc = 0;
                    var trdisc1 = tradisc;
                    var addcomm = 0;
                    if (document.getElementById('txtaddagencycommrate') != null) {
                        if (document.getElementById('hiddenagcommflag').value != "1")
                            addcomm = document.getElementById('txtaddagencycommrate').value;
                    }
                    if (addcomm == "") {
                        addcomm = "0";
                    }
                    if (addcomm != "0") {
                        trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                    }
                    if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                        if (document.getElementById('agncomm_seq_com').value != "S")
                            bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);
                        else {
                            bill_var.value = parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(tradisc) / 100);
                            if (addcomm != "0" && addcomm != "") {
                                bill_var.value = parseFloat(bill_var.value) - (parseFloat(bill_var.value) * parseFloat(addcomm) / 100);
                            }
                        }
                        if (document.getElementById('drpbooktype').value == "2" || document.getElementById('drpbooktype').value == "6" || document.getElementById('drpbooktype').value == "4" || document.getElementById('drpbooktype').value == "5") {
                            bill_var.value = "0";
                        }
                    }
                    br_spcharge = (parseFloat(br_spcharge) + parseFloat(gross_var.value)).toFixed(2);
                    billAmount = (parseFloat(billAmount) + parseFloat(bill_var.value)).toFixed(2);
                }
            }
        }


        if (spdiscper == 1) {
            //  var br_spcharge=0;
            var splcharges = document.getElementById('txtspediscper').value;
            var grossAmt = document.getElementById('txtgrossamt').value;
            var len = "bookdiv";
            var ratio = 0;
            var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
            for (var s = 0; s < count; s++) {
                splcharges = document.getElementById('txtspediscper').value;
                if (document.getElementById("disc_" + s) != null && document.getElementById("disc_" + s).value != "" && document.getElementById("disc_" + s).value != "0")
                    splcharges = document.getElementById("disc_" + s).value;
                if (splcharges == "")
                    splcharges = 0;
                var gross_var = document.getElementById('gro' + s);
                var bill_var = document.getElementById('ba' + s);
                var tot1 = document.getElementById("siz" + s);
                var insertsta = document.getElementById("inssta" + s);
                if (gross_var != null && document.getElementById("inssta" + s).value != "cancel") {
                    //                    if(s==count-1)
                    //                    {
                    //                        document.getElementById('gro'+s).value = (parseFloat(document.getElementById('gro'+s).value) - ((parseFloat(splcharges)*parseFloat(cardrate)/100)-parseFloat(br_spcharge))).toFixed(2);
                    //                    }
                    //                    else
                    //                    {
                    //                       ratio = (parseFloat(document.getElementById('gro'+s).value) * (parseFloat(splcharges)*parseFloat(cardrate)*parseFloat(document.getElementById('txttotalarea').value)/100) / parseFloat(grossAmt))
                    if (agreedrate_active == 1 && document.getElementById('hiddenuomdesc').value == "CD") {
                        var t = parseFloat(document.getElementById('txtagreedrate').value) / parseFloat(document.getElementById('txtcardrate').value);
                        t = parseFloat(t) * parseFloat(document.getElementById('card' + s).value);
                        var splcharges_grid = (parseFloat(t) * splcharges) / 100;
                    }
                    else
                        var splcharges_grid = (parseFloat(document.getElementById('gro' + s).value) * splcharges) / 100;
                    if (gross_var != null && document.getElementById("inssta" + s).value != "cancel" && document.getElementById("pai" + s).value != "N") {
                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                            document.getElementById("spld" + s).value = (parseFloat(splcharges_grid)).toFixed(2);
                            gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid))).toFixed(4);
                        }
                        // gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid)*parseFloat(tot1.value))).toFixed(2);
                        //bill_var.value = (parseFloat(bill_var.value) - (parseFloat(splcharges_grid)*parseFloat(totalarea_var))).toFixed(2);
                        // trade disc
                        var tradisc = document.getElementById('txttradedisc').value;
                        if (document.getElementById('chktrade').checked == false)
                            tradisc = 0;
                        if (tradisc == "")
                            tradisc = 0;
                        var trdisc1 = tradisc;
                        var addcomm = 0;
                        if (document.getElementById('txtaddagencycommrate') != null) {
                            if (document.getElementById('hiddenagcommflag').value != "1")
                                addcomm = document.getElementById('txtaddagencycommrate').value;
                        }
                        if (addcomm == "") {
                            addcomm = "0";
                        }
                        if (addcomm != "0") {
                            trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                        }
                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                            if (document.getElementById('agncomm_seq_com').value != "S")
                                bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);
                            else {
                                bill_var.value = parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(tradisc) / 100);
                                if (addcomm != "0" && addcomm != "") {
                                    bill_var.value = parseFloat(bill_var.value) - (parseFloat(bill_var.value) * parseFloat(addcomm) / 100);
                                }
                            }
                            if (document.getElementById('drpbooktype').value == "2" || document.getElementById('drpbooktype').value == "6" || document.getElementById('drpbooktype').value == "4" || document.getElementById('drpbooktype').value == "5") {
                                bill_var.value = "0";
                            }
                        }
                        br_spcharge = (parseFloat(br_spcharge) + parseFloat(gross_var.value)).toFixed(2);
                        billAmount = (parseFloat(billAmount) + parseFloat(bill_var.value)).toFixed(2);
                    }
                    //                    }  
                }
            }
        }
        if (br_spcharge == 0) {
            if (grossAmt == "")
                grossAmt = 0;
            br_spcharge = grossAmt;
        }
        document.getElementById('txtgrossamt').value = parseFloat(br_spcharge);
        if (Activid == "txtspedisc" || Activid == "txtspediscper")
            document.getElementById('txtgrossamt').value = "";
        if (billAmount != 0)
            document.getElementById('txtbillamt').value = parseFloat(billAmount).toFixed(2);
        if (br_spcharge == 0)
            document.getElementById('txtbillamt').value = parseFloat(billAmount).toFixed(2);
    }

    if (document.getElementById('txtspediscper').value != "") {
        var spacedisc = document.getElementById('txtspediscper').value;

        //var splamnt;
        //var cashamnt;
        //        if ((document.getElementById('txtspediscper').value != "") && document.getElementById('txtgrossamt').value != "" && parseFloat(spacedisc) > parseFloat(document.getElementById('hiddenuserdisc').value)) {
        //            for (var j = 0; j < document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1; j++) {

        //                document.getElementById("spld" + j).value = (parseFloat(document.getElementById('card' + j).value) * parseFloat(document.getElementById('txtspediscper').value) / 100).toFixed(2);

        //                document.getElementById("cashd" + j).value = "0";
        //            }
        //        }

        if (document.getElementById('hiddenuserdisc').value != "" && document.getElementById('hiddenuserdisc').value != "0") {
            if (parseFloat(spacedisc) > parseFloat(document.getElementById('hiddenuserdisc').value)) {
                alert("User Allowed Commission can't be greater than " + document.getElementById('hiddenuserdisc').value);
                document.getElementById('txtspediscper').value = "";
                document.getElementById('txtspedisc').value = "";
                document.getElementById('txtgrossamt').value = "";
                document.getElementById('txtgrossamtlocal').value = "";
                document.getElementById('txtbillamtlocal').value = "";
                return false;
            }
        }

    }
    else {
        var len = "bookdiv";
        var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
        for (var s = 0; s < count; s++) {
            var insertsta = document.getElementById("inssta" + s);
            if (insertsta.value != "billed") {
                document.getElementById("spld" + s).value = "";
            }
        }
    }
    //}
}
//****************Fuction to Print Matter********************//
function buttonprintf() {
    if(browser!="Microsoft Internet Explorer")
    {
        //document.getElementById('editordiv').value=trim(document.getElementById('editordiv').value);
		
        if(document.getElementById('editordiv').innerHTML=="")
        {
            alert("Please type the matter");
            document.getElementById('editordiv').focus();
            return false;
        }
    }
    else
    {
        //document.getElementById('editordiv').innerText=trim(document.getElementById('editordiv').innerText);
        if(document.getElementById('editordiv').innerText=="")
        {
            alert("Please type the matter");
            document.getElementById('editordiv').focus();
            return false;
        }
    }

    var matterText = "";

        if(browser!="Microsoft Internet Explorer")
        {
            matterText=document.getElementById('editordiv').innerHTML;
        }
        else
        {
            matterText=document.getElementById('editordiv').innerText;
        }
        
        if(matterText!="")
        {
            var str = matterText;
            //var resp = editor_new.savethematterinsession(str, matterText);
            Editor.savethematterinsessionforprint(str, matterText);
        }
        
    var matterTextv="";
    window.open('Classified_Print.aspx?matter=' + matterTextv, 'Print', 'width=700px,height=500,resizable=0,left=200,top=0,scrollbars=yes');
    return false;
}
function openPubPrecentage() {
    var objpack = document.getElementById('drppackagecopy');
    var temp = "";
    // var tempcode="";
    var tempval = "";
    ///  var tempvalcode="";
    //var desc="";
    var code = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (code != "") {
                temp = tempval.split("@");
                //tempvalcode=temp[0];
                //tempcode=temp[1];
                code = temp[0] + "," + code;
                // desc=tempcode+","+desc;
            }
            else {
                temp = tempval.split("@");
                // tempvalcode=temp[0];
                //tempcode=temp[1];
                code = temp[0];
                //desc=tempcode;
            }
        }
    }
    var insertstatus = 0;
    code = code.replace("+", "~");
    if (document.getElementById('txtagreedamt').disabled == true)
        insertstatus = 1;
    window.open('booking_sharepub.aspx?agreedamt=' + document.getElementById('txtagreedamt').value + '&sharepub=' + sharepub + '&insertstatus=' + insertstatus + '&package=' + code + '&cioid=' + document.getElementById('txtciobookid').value + '&compcode=' + document.getElementById('hiddencompcode').value, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=144,left=210,width=300px,height=300px');

    return false;
}
function getSharing() {
    sharepub = "";
    var res = Classified_Booking.getPubSharing("", document.getElementById('hiddencompcode').value, document.getElementById('txtciobookid').value);
    if (res.error != null) {
        alert(res.error.description);
        return false;
    }
    var ds = res.value;
    if (ds != null) {
        for (var i = 0; i < ds.Tables[0].Rows.length; i++) {
            if (sharepub == "")
                sharepub = ds.Tables[0].Rows[i].PUBLICATION + "~" + ds.Tables[0].Rows[i].SHARING + "~" + ds.Tables[0].Rows[i].TYPE;
            else
                sharepub = sharepub + "$" + ds.Tables[0].Rows[i].PUBLICATION + "~" + ds.Tables[0].Rows[i].SHARING + "~" + ds.Tables[0].Rows[i].TYPE;
        }
    }
}
function getFMGRef() {
    fmgInsert = "";
    fmgsize = "";
    fmgInsert = "";
    fmgreasons = "";
    var res = Classified_Booking.fetchFMGrefID(document.getElementById('txtciobookid').value);
    if (res.error != null) {
        alert(res.error.description);
        return false;
    }
    var ds = res.value;
    if (ds != null) {
        for (var i = 0; i < ds.Tables[0].Rows.length; i++) {
            if (fmgInsert == "")
                fmgInsert = ds.Tables[0].Rows[i].INSERTID;
            else
                fmgInsert = fmgInsert + "$" + ds.Tables[0].Rows[i].INSERTID;

            if (fmgsize == "")
                fmgsize = ds.Tables[0].Rows[i].Size_Book;
            //        else
            // fmgsize = fmgsize + "$" + ds.Tables[0].Rows[i].Size_Book;

            if (fmgcolor == "")
                fmgcolor = ds.Tables[0].Rows[i].Col_Code;
            if (fmgreasons == "")
                fmgreasons = ds.Tables[0].Rows[i].FMG_REASONS;
            //        else
            // fmgcolor = fmgcolor + "$" + ds.Tables[0].Rows[i].Col_Code;   
        }
    }
}
function openFMGRef() {
    var agencycode = "";
    if (document.getElementById('txtagency').value != "")
        agencycode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf("(") + 1, document.getElementById('txtagency').value.lastIndexOf(")"));
    window.open('fmg_transaction.aspx?fmgInsert=' + fmgInsert + '&agencycode=' + agencycode + '&adtype=' + "CL0" + '&fmgreasons=' + fmgreasons, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=144,left=210,width=700px,height=600px');
}
function boldcountingrid() {
    if (confirm("Do You Want To Copy the Bold Characters in all Editions")) {
        var n1 = document.activeElement.id;
        var data = document.getElementById(n1).value;
        var item = parseInt(document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1);
        for (var i = 0; i < item; i++) {
            document.getElementById('splboldsize' + i).value = data;
        }
    }
}
function days_between(date11, date22) {

    // The number of milliseconds in one day
    var date1 = new Date(date11);
    var date2 = new Date(date22);
    var ONE_DAY = 1000 * 60 * 60 * 24

    // Convert both dates to milliseconds
    var date1_ms = date1.getTime()
    var date2_ms = date2.getTime()

    // Calculate the difference in milliseconds
    var difference_ms = Math.abs(date1_ms - date2_ms)

    // Convert back to days and return
    return Math.round(difference_ms / ONE_DAY)

}
function getBigDate(pfdate, pldate, dateformat, flag) {
    var pfdate1 = pfdate;
    var pldate1 = pldate;
    if (dateformat == "dd/mm/yyyy") {
        if (pfdate != "") {
            var txt = pfdate;
            var txt1;

            txt1 = txt.split("/");


            var dd = txt1[0];
            var mm1 = txt1[1];
            var mm;
            mm = mm1;
            var yy = txt1[2];
            pfdate = mm + '/' + dd + '/' + yy;
        }
        else {
            pfdate = pfdate;
        }

    }

    if (dateformat == "yyyy/mm/dd") {
        if (pfdate != "") {
            var txt = pfdate;
            var txt1 = txt.split("/");
            var yy = txt1[0];
            var mm = txt1[1];
            var dd = txt1[2];
            pfdate = mm + '/' + dd + '/' + yy;
        }
        else {
            pfdate = pfdate;
        }
    }

    if (dateformat == "mm/dd/yyyy") {
        pfdate = pfdate;
    }

    //For From Date Converssion /************************************************************/
    if (dateformat == "dd/mm/yyyy") {
        if (pldate != "") {
            var txt = pldate;
            var txt1 = txt.split("/");
            var dd = txt1[0];
            var mm = txt1[1];
            var yy = txt1[2];
            pldate = mm + '/' + dd + '/' + yy;
        }
        else {
            pldate = pldate;
        }

    }

    if (dateformat == "yyyy/mm/dd") {
        if (pldate != "") {
            var txt = pldate;
            var txt1 = txt.split("/");
            var yy = txt1[0];
            var mm = txt1[1];
            var dd = txt1[2];
            pldate = mm + '/' + dd + '/' + yy;
        }
        else {
            pldate = pldate;
        }
    }

    if (dateformat == "mm/dd/yyyy") {
        pldate = pldate;
    }
    var date1 = new Date(pfdate);
    var date2 = new Date(pldate);
    if (flag == "min") {
        if (date1 < date2) {
            return pfdate1;
        }
        else {
            return pldate1;
        }
    }
    else {
        if (date1 > date2) {
            return pfdate1;
        }
        else {
            return pldate1;
        }
    }
    //
}
///////bhanu3jun
function openmultiselect() {
    window.open('multiexecselect.aspx?execode=' + multiselect + '&cioid=' + document.getElementById('txtciobookid').value + '&modify=' + modifyMatter, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=144,left=210,width=600px,height=600px');
}

function getmultiexe() {
    multiselect = "";
    var resb = Classified_Booking.fetchmultiexe(document.getElementById('txtciobookid').value, document.getElementById('hiddencompcode').value);
    if (resb.error != null) {
        alert(resb.error.description);
        return false;
    }
    var dsb = resb.value;
    if (dsb != null) {
        for (var i = 0; i < dsb.Tables[0].Rows.length; i++) {
            if (multiselect == "")
                multiselect = dsb.Tables[0].Rows[i].TEAM_SHARE + "~" + dsb.Tables[0].Rows[i].execod;
            else
                multiselect = multiselect + "$" + dsb.Tables[0].Rows[i].TEAM_SHARE + "~" + dsb.Tables[0].Rows[i].execod;
        }
    }
}
function bindBookType_Agency() {
    if (browser != "Microsoft Internet Explorer") {
        var c = 0;
        var obj = document.getElementById('drpbooktype');
        obj.options.length = 0;
        obj.options[0] = new Option("Select Booking Type", "0");
        //alert(xmlObj.childNodes[15].childNodes.length);
        for (c = 1; c <= xmlObj.childNodes[15].childNodes.length - 1; c = c + 4) {
            //alert(xmlObj.childNodes[15].childNodes[c].childNodes[0].nodeValue);
            //alert(xmlObj.childNodes[15].childNodes[c+2].childNodes[0].nodeValue);
            if (document.getElementById('hidfmgallow').value == 'y')
                obj.options[obj.options.length] = new Option(xmlObj.childNodes[15].childNodes[c].childNodes[0].nodeValue, xmlObj.childNodes[15].childNodes[c + 2].childNodes[0].nodeValue);
            else {
                if (xmlObj.childNodes[15].childNodes[c].childNodes[0].nodeValue != '2' && xmlObj.childNodes[15].childNodes[c].childNodes[0].nodeValue != 'FMG')
                    obj.options[obj.options.length] = new Option(xmlObj.childNodes[15].childNodes[c].childNodes[0].nodeValue, xmlObj.childNodes[15].childNodes[c + 2].childNodes[0].nodeValue);
            }
            //dbill=dbill+"<option value="+xmlObj.childNodes[15].childNodes[c].childNodes[0].nodeValue+">"+xmlObj.childNodes[15].childNodes[c+2].childNodes[0].nodeValue+"</option>";
        }
        if (obj.options.length > 1) {
            obj.options[1].selected = true;
        }

    }
    else {
        var c = 0;
        if (xmlObj.childNodes(1) == null) {
            loadXML('xml/billcycle.xml');
        }
        var obj = document.getElementById('drpbooktype');
        obj.options.length = 0;
        obj.options[0] = new Option("Select Booking Type", "0");

        for (c = 0; c <= xmlObj.childNodes(7).childNodes.length - 1; c++) {
            if (document.getElementById('hidfmgallow').value == 'y')
                obj.options[obj.options.length] = new Option(xmlObj.childNodes(7).childNodes(c).text, xmlObj.childNodes(7).childNodes(c + 1).text);
            else {
                if (xmlObj.childNodes(7).childNodes(c).text != '2' && xmlObj.childNodes(7).childNodes(c).text != 'FMG')
                    obj.options[obj.options.length] = new Option(xmlObj.childNodes(7).childNodes(c).text, xmlObj.childNodes(7).childNodes(c + 1).text);
            }
            // dbill=dbill+"<option value="+xmlObj.childNodes(7).childNodes(c+1).text+">"+xmlObj.childNodes(1).childNodes(c).text+"</option>";
            c = c + 1;
        }
        if (obj.options.length > 1) {
            obj.options[1].selected = true;
        }
    }
}

function checkNew(name) {
    var gridtab_vari = document.getElementById('gridtab');
    var center_vari = document.getElementById('hiddencenter');
    var adtype_vari = document.getElementById('hiddenadtype');
    var chkall_vari = document.getElementById('chkall');
    var adcat_vari = document.getElementById('drpadcategory');
    var dateformat_vari = document.getElementById('hiddendateformat');
    for (i = 0; i < gridtab_vari.getElementsByTagName("tbody")[0].rows.length - 1; i++) {
        if (repeatdate == "0" || repeatdate == "1") {
            var id = "Text" + i;
            if (caldatemonth.length >= i) {
                //   if(caldatemonth[i]!=undefined)
                //    {
                //var mmM=caldatemonth[i].toString();
                //}
                //else{
                var mmM = parseInt(monthSelected, 10) + 1;
                mmM = mmM.toString();
                // }
            }
            else {
                var mmM = parseInt(monthSelected, 10) + 1;
                mmM = mmM.toString();
            }
            if (mmM.toString().length == 1)
                mmM = "0" + mmM.toString();

            if (dateformat_vari.value == "mm/dd/yyyy") {
                vvalue = mmM + "/" + dateSelected + "/" + yearSelected;
            }
            else if (dateformat_vari.value == "dd/mm/yyyy") {
                vvalue = dateSelected + "/" + mmM + "/" + yearSelected; ;
            }
            else if (dateformat_vari.value = "yyyy/mm/dd") {
                vvalue = yearSelected + "/" + mmM + "/" + dateSelected; ;
            }

            if (dateSelected != undefined) {
                if (browser != "Microsoft Internet Explorer") {
                    var pkgfullname = document.getElementById('pkg_alias' + i).value;
                    var pkgid = document.getElementById('hiddenpckcode' + i).value;
                    var pkgname = document.getElementById('pkg_alias' + i).value;
                    var compcode = document.getElementById('hiddencompcode').value;

                    dateday = vvalue;

                    document.getElementById('Text' + i).value = vvalue;
                }
                else {
                    var pkgfullname = document.getElementById('pkg_alias' + i).value;
                    var pkgid = document.getElementById('hiddenpckcode' + i).value;
                    var pkgname = document.getElementById('pkg_alias' + i).value;
                    var compcode = document.getElementById('hiddencompcode').value;
                    dateday = vvalue;

                    document.getElementById('Text' + i).value = vvalue;
                }
                if (browser != "Microsoft Internet Explorer") {
                    var httpRequest = null; ;
                    httpRequest = new XMLHttpRequest();
                    if (httpRequest.overrideMimeType) {
                        httpRequest.overrideMimeType('text/xml');
                    }

                    httpRequest.onreadystatechange = function () { alertContents(httpRequest) };
                    var adcat = adcat_vari.value;
                    httpRequest.open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
                    httpRequest.send('');
                    //alert(httpRequest.readyState);
                    if (httpRequest.readyState == 4) {
                        //alert(httpRequest.status);
                        if (httpRequest.status == 200) {
                            strtext = httpRequest.responseText;
                        }
                        else {
                            alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                        }
                    }
                }
                else {
                    validuse = "";
                    var xml = new ActiveXObject("Microsoft.XMLHTTP");
                    var adcat = adcat_vari;
                    var center = '';
                    if (center_vari != null) {
                        center = center_vari.value;
                        if (chkall_vari != null) {
                            if (chkall_vari.checked == true) {
                                center = '0';
                            }
                        }
                        else {
                            center = '0';
                        }
                    }
                    xml.Open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
                    xml.Send();
                    strtext = xml.responseText;
                }
                if (strtext == "NOT A VALID DATE") {
                    alert("NOT A VALID DATE");
                    document.getElementById('Text' + i).value = "";
                    if (name == "txtdummydate")
                        document.getElementById('txtdummydate').value = "";
                    return false;
                }
                if (strtext == "0") {
                    alert("Day is not the publishing day");
                    document.getElementById('Text' + i).value = "";
                    if (name == "txtdummydate")
                        document.getElementById('txtdummydate').value = "";
                    return false;
                }
                else {
                    if (strtext == "1")
                        document.getElementById(id).value = vvalue;
                    else {
                        if (strtext != "") {
                            if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                                var txt = strtext;
                                var txt1 = txt.split("/");
                                var dd = txt1[0];
                                var mm1 = txt1[1];
                                var mm = txt1[1]; //getMonthNo(mm1);
                                var yy = txt1[2];
                                caldate[cali] = dd;
                                caldatemonth[cali] = mm;
                                caldateyear[cali] = yy;
                                cali = parseInt(cali, 10) + 1;
                            }
                            else if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                                var txt = strtext;
                                var txt1 = txt.split("/");
                                var dd = txt1[1];
                                var mm1 = txt1[0];
                                var mm = txt1[0]; //getMonthNo(mm1);
                                var yy = txt1[2];
                                caldate[cali] = dd;
                                caldatemonth[cali] = mm;
                                caldateyear[cali] = yy;
                                cali = parseInt(cali, 10) + 1;
                            }
                            else if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
                                var txt = strtext;
                                var txt1 = txt.split("/");
                                var dd = txt1[2];
                                var mm1 = txt1[1];
                                var mm = txt1[1]; //getMonthNo(mm1);
                                var yy = txt1[0];
                                caldate[cali] = dd;
                                caldatemonth[cali] = mm;
                                caldateyear[cali] = yy;
                                cali = parseInt(cali, 10) + 1;
                            }
                        }
                        document.getElementById(id).value = strtext;
                    }
                }
            }
        }
        //temp=parseInt(temp)+1;  
    }
}
function dropDateCheck(ddate, text_var, pkg_id, pkg_alias, pkgname) {
    var dateformat_vari = document.getElementById("hiddendateformat");
    var compcode_vari = document.getElementById('hiddencompcode');
    var adcat = document.getElementById('drpadcategory').value;
    var val_ue = "1";
    if (browser != "Microsoft Internet Explorer") {
        var httpRequest = null; ;
        httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml');
        }

        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

        httpRequest.open("GET", "packagename.aspx?pkgalias=" + pkg_alias + "&adcat=" + adcat + "&pkgid=" + pkg_id + "&compcode=" + compcode_vari.value + "&value=" + val_ue + "&dateday=" + ddate + "&pkgname=" + pkgname, false);
        httpRequest.send('');
        //alert(httpRequest.readyState);
        if (httpRequest.readyState == 4) {
            //alert(httpRequest.status);
            if (httpRequest.status == 200) {
                strtext = httpRequest.responseText;
            }
            else {
                alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
            }
        }
    }
    else {
        validuse = "";
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        var adcat = document.getElementById('drpadcategory').value;
        xml.Open("GET", "packagename.aspx?pkgalias=" + pkg_alias + "&adcat=" + adcat + "&pkgid=" + pkg_id + "&compcode=" + compcode_vari.value + "&value=" + val_ue + "&dateday=" + ddate + "&pkgname=" + pkgname, false);
        xml.Send();
        strtext = xml.responseText;
    }

    //      var text_var=document.getElementById("Text" + i);
    if (strtext != "" && strtext != "1" && strtext != "0" && strtext != null && strtext != "NOT A VALID DATE") {

        if (text_var != null) {
            text_var.value = strtext;
            text_var.value = ddate;
        }
        return false;

    }
    else {
        if (text_var != null)
            text_var.value = ddate;
        return true;
    }
}
function adonChange() {
    if (document.getElementById('chkadon').checked == true) {
        document.getElementById('lbreference').style.display = "block";
        document.getElementById('tdref').style.display = "block";
        //   document.getElementById('btnrefid').style.display="block";
        document.getElementById('drppackagecopy').options.length = 0;
        document.getElementById('tblinsert').innerHTML = "";
        bindpackage_adon("adon");
    }
    else {
        document.getElementById('lbreference').style.display = "none";
        document.getElementById('tdref').style.display = "none";
        // document.getElementById('btnrefid').style.display="none";
        document.getElementById('txtreference').value = "";
        document.getElementById('drppackagecopy').options.length = 0;
        document.getElementById('tblinsert').innerHTML = "";
        bindpackage_adon("main");
    }

}
function bindpackage_adon(type) {
    var res2 = null;
    if (type == "adon") {
        res2 = Classified_Booking.bindAdOnPackage(document.getElementById('hiddencompcode').value, "CL0");
        var dsexecut = res2.value;
        if (dsexecut == null) {
            alert(res2.error.description);
            return false;
        }
        document.getElementById('drppackage').options.length = 0;
        for (i = 0; i <= dsexecut.Tables[0].Rows.length - 1; i++) {
            if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "") {
                if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "0") {

                    var T = dsexecut.Tables[0].Rows[i].Package_Name;
                    var V = dsexecut.Tables[0].Rows[i].pck_code;
                    document.getElementById('drppackage').options[document.getElementById('drppackage').options.length] = new Option(T, V);
                    document.getElementById('drppackage').options.length;
                }
            }
        }
    }
    else {
        res2 = Classified_Booking.bindpackage_Main(document.getElementById('hiddencompcode').value);
        var dsexecut = res2.value;
        if (dsexecut == null) {
            alert(res2.error.description);
            return false;
        }
        document.getElementById('drppackage').options.length = 0;
        for (i = 0; i <= dsexecut.Tables[0].Rows.length - 1; i++) {
            if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "") {
                if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "0") {

                    var T = dsexecut.Tables[0].Rows[i].Package_Name;
                    var V = dsexecut.Tables[0].Rows[i].pck_code;
                    document.getElementById('drppackage').options[document.getElementById('drppackage').options.length] = new Option(T, V);
                    document.getElementById('drppackage').options.length;
                }
            }
        }
    }
}
function openRefID() {
    if (document.getElementById('txtreference').value != "") {
        var res = Classified_Booking.fetchpwd(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value);
        var ds = res.value;
        if (ds == null) {
            alert(res.error.description);
            return false;
        }
        var pwd = "";
        if (ds.Tables[0].Rows.length > 0) {
            pwd = ds.Tables[0].Rows[0].PASSWORD;
        }
        window.open(TVURL + "?password=" + pwd + "&type=transaction&qbc=" + document.getElementById('txtbranch').value + "&center=" + document.getElementById('hiddencenter').value + "&username=" + document.getElementById('hiddenuserid').value + "&refid=" + document.getElementById('txtreference').value);
    }
    else {
        alert("Please Enter Reference ID");
        document.getElementById('txtreference').focus();
        return false;
    }
}
//=====For Revise rate====//
function getdatafrompermissionmast() {
    pagePositionbind();
    if (document.getElementById('hiddenquotation').value == "Q") {
        givebuttonpermission('ClassifiedQuotation');
    }
    else {
        givebuttonpermission('Classified_Booking');
    }
    //  givebuttonpermission('Classified_Booking');

    var res = Classified_Booking.getpermission(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value);
    document.getElementById('hdnrevise').value = "";
    var ds = res.value;
    if (ds == null) {
        alert(res.error.description);
        return false;
    }
    document.getElementById('regclient').style.display = 'none';
    for (var k = 0; k < ds.Tables[0].Rows.length; k++) {
        if (ds.Tables[0].Rows[k].PERMISSION_DESC == "Allow to Select Old Date Rates") {
            document.getElementById('hdnrevise').value = ds.Tables[0].Rows[0].PERMISSION_DESC;
            document.getElementById('lbrevtd').style.display = "block";
            document.getElementById('txtrevtd').style.display = "block";
            break;
        }
    }
    if (document.getElementById('Hdnmodbook').value == "modify") {
        queryClick();
    }
}
//===== To generate Temp. Booking Ids =======//
function autogeneratedtempid() {

    // var res = Classified_Booking.getBookingIdNo(document.getElementById('hiddencompcode').value, auto, no, document.getElementById('txtciobookid').value);
    if (document.getElementById('configclient').value == "SP") {
        var quotation = document.getElementById('hiddenquotation').value;
        if (quotation != "Q" || quotation == "") {
            quotation = "B";
        }
        var adtype = document.getElementById('hiddenadtype').value;
        var systemdate = document.getElementById('hdnsysdate').value;
        var compcode = document.getElementById('hiddencompcode').value;
        var auto = "0";
        var nam = "0";
        var savedata = "Y";
        var extra1 = "";
        var extra2 = "";
        var extra3 = "";
        var extra4 = "";
        var extra5 = "";
        var dateformate = document.getElementById('hiddendateformat').value;
        var res = Classified_Booking.gettempBookingIdNo1(compcode, auto, nam, quotation, adtype, systemdate, savedata, dateformate, extra1, extra2, extra3, extra4, extra5);



        // var res = Booking_master.getBookingIdNo(document.getElementById('hiddencompcode').value, auto, no, document.getElementById('txtciobookid').value);
        //**** code genrate hide by rikkkee
        //var res = Classified_Booking.gettempBookingIdNo(document.getElementById('hiddencompcode').value);
        var da = res.value;
        if (da == null) {
            alert(res.error.description);
            return false;
        }

        document.getElementById('txtciobookid').value = da.Tables[0].Rows[0].GEN_NO;
    }
    else {

        var res = Classified_Booking.gettempBookingIdNo(document.getElementById('hiddencompcode').value);

        var da = res.value;
        if (da == null) {
            alert(res.error.description);
            return false;
        }
        if (da.Tables[0].Rows.length > 0 && da.Tables[0].Rows[0].ID != "") {
            var ab = da.Tables[0].Rows[0].ID;
            var cou1 = parseInt(ab, 10);
            var countlen = cou1.toString().length;
            if (countlen == 1) {
                zeros = "0000000" + cou1;
            }
            else if (countlen == 2) {
                zeros = "000000" + cou1;
            }
            else if (countlen == 3) {
                zeros = "00000" + cou1;
            }
            else if (countlen == 4) {
                zeros = "0000" + cou1;
            }
            else if (countlen == 5) {
                zeros = "000" + cou1;
            }
            else if (countlen == 6) {
                zeros = "00" + cou1;
            }
            else if (countlen == 7) {
                zeros = "0" + cou1;
            }
            else if (countlen == 8) {
                zeros = "0" + cou1;
            }

            document.getElementById('txtciobookid').value = zeros;
        }
    }

}
//=====Changes for Searching agency acc. to agency address.....//Kuldeep Bhati
function openadvpopup() {
    if (document.getElementById("div2").style.display == "none" && document.getElementById("txtagency").disabled == false) {
        document.getElementById("div2").style.display = "block";
        aTag = eval(document.getElementById("txtagency"))
        var btag;
        var leftpos = 0;
        var toppos = 0;
        do {
            aTag = eval(aTag.offsetParent);
            leftpos += aTag.offsetLeft;
            toppos += aTag.offsetTop;
            btag = eval(aTag)
        } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
        document.getElementById('div2').style.top = document.getElementById("txtagency").offsetTop + toppos - 13 + "px";
        document.getElementById('div2').style.left = document.getElementById("txtagency").offsetLeft + leftpos + 140 + "px";
    }
    else {
        document.getElementById("div2").style.display = "none";
    }
}
function searchagency() {
    document.getElementById("div1").style.display = "block";
    aTag = eval(document.getElementById("txtagency"))
    var btag;
    var leftpos = 0;
    var toppos = 0;
    do {
        aTag = eval(aTag.offsetParent);
        leftpos += aTag.offsetLeft;
        toppos += aTag.offsetTop;
        btag = eval(aTag)
    } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
    document.getElementById('div1').style.top = document.getElementById("txtagency").offsetTop + toppos + "px";
    document.getElementById('div1').style.left = document.getElementById("txtagency").offsetLeft + leftpos + "px";

    Classified_Booking.bindagencynamefromadd(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value, document.getElementById('txtagency').value.toUpperCase(), document.getElementById('txtagaddf2').value, bindagencyname_callback);
}
//===== TO SHOW AGENCY REMARRK ON MOUSE OVER// KULDEEP BHATI
function opentooltip(event, res) {
    var agcode = "";
    var client = "";
    var alert = "";
    if (document.getElementById('txtagency').value != "" && document.getElementById('txtagency').value.indexOf("(") >= 0 && document.getElementById('txtagency').value.indexOf(")") >= 0) {
        agcode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.lastIndexOf(')'));
    }
    if (document.getElementById('txtclient').value != "" && document.getElementById('txtclient').value.indexOf("(") >= 0 && document.getElementById('txtclient').value.indexOf(")") >= 0) {
        client = document.getElementById('txtclient').value.substring(document.getElementById('txtclient').value.lastIndexOf('(') + 1, document.getElementById('txtclient').value.lastIndexOf(')'));
    }
    if (res == "Agency" && agcode != "") {
        if (chkbtnStatus == "new") {
            alert = document.getElementById('hndagalert1').value;
        }
        else {
            var resr = Classified_Booking.getagencyRemark(document.getElementById('hiddencompcode').value, document.getElementById('txtciobookid').value, agcode, "", "A");
            if (resr.value != null)
                if (resr.value.Tables[0].Rows.length > 0)
                    alert = resr.value.Tables[0].Rows[0].REMARK;
        }

    }
    else if (res == "Client" && client != "") {
        if (chkbtnStatus == "new") {
            alert = document.getElementById('hndalert1').value;
        }
        else {
            var resr = Classified_Booking.getagencyRemark(document.getElementById('hiddencompcode').value, document.getElementById('txtciobookid').value, "", client, "C");
            if (resr.value != null)
                if (resr.value.Tables[0].Rows.length > 0)
                    alert = resr.value.Tables[0].Rows[0].REMARK;
        }
    }
    if (browser != "Microsoft Internet Explorer")
        document.getElementById("tdremark").textContent = alert; //"Hello This is Example of Agency Tooltip";
    else
        document.getElementById("tdremark").innerText = alert;
    var x = event.clientX + document.body.scrollLeft;
    var y = event.clientY + document.body.scrollTop + 10;
    if (alert != "" && alert != null)
        document.getElementById('Popup').style.display = "block";
    document.getElementById('Popup').style.left = x + "px";
    document.getElementById('Popup').style.top = y - 100 + "px";
}
function HideTooltip() {
    document.getElementById('Popup').style.display = "none";
}
//=========*********This is to insert Remark in Grid if Changes form Header*****=========//
function getremarkintogrid() {
    var len = "bookdiv";
    if (document.getElementById(len) != null) {
        var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
        var k;
        var remark_inserts;
        var premark = document.getElementById('txtprintremark').value;
        if (parseInt(document.getElementById('txtinsertion').value) > 1 && chkbtnStatus != "new") {
            if (confirm("Do You want to copy in all Insertion")) {
                for (k = 0; k < y - 1; k++) {
                    remark_inserts = "rem" + k;
                    var remark_inserts_var = document.getElementById(remark_inserts);
                    var par1 = (remark_inserts_var.parentNode).parentNode;
                    if (browser != "Microsoft Internet Explorer") {
                        if (document.getElementById(remark_inserts) != null) {
                            document.getElementById(remark_inserts).value = premark;
                        }

                    }
                    else {
                        if (par1.all[remark_inserts] != null) {
                            par1.all[remark_inserts].value = premark;
                        }
                    }
                }
            }
        }
        else {
            var drppackage_vari = document.getElementById('drppackagecopy');
            if (drppackage_vari.options.length > 0) {
                var t_flag = false;
                for (var insertCou = 0; insertCou < drppackage_vari.options.length; insertCou++) {
                    var tinsert = drppackage_vari.options[insertCou].value.substring(drppackage_vari.options[insertCou].value.lastIndexOf('(') + 1, drppackage_vari.options[insertCou].value.lastIndexOf(')'));
                    if (parseInt(tinsert) > 1) {
                        t_flag = true;
                        insertCou = drppackage_vari.options.length;
                    }
                }
                if (t_flag == true && chkbtnStatus != "new") {
                    if (confirm("Do You want to copy in all Insertion")) {
                        for (k = 0; k < y - 1; k++) {
                            remark_inserts = "rem" + k;
                            var remark_inserts_var = document.getElementById(remark_inserts);
                            var par1 = (remark_inserts_var.parentNode).parentNode;
                            if (browser != "Microsoft Internet Explorer") {
                                if (document.getElementById(remark_inserts) != null) {
                                    document.getElementById(remark_inserts).value = premark;
                                }

                            }
                            else {
                                if (par1.all[remark_inserts] != null) {
                                    par1.all[remark_inserts].value = premark;
                                }
                            }
                        }
                    }
                }
                else {
                    for (k = 0; k < y - 1; k++) {
                        remark_inserts = "rem" + k;
                        var remark_inserts_var = document.getElementById(remark_inserts);
                        var par1 = (remark_inserts_var.parentNode).parentNode;
                        if (browser != "Microsoft Internet Explorer") {
                            if (document.getElementById(remark_inserts) != null) {
                                document.getElementById(remark_inserts).value = premark;
                            }

                        }
                        else {
                            if (par1.all[remark_inserts] != null) {
                                par1.all[remark_inserts].value = premark;
                            }
                        }
                    }
                }
            }
        }
    }
}
function pagePositionbind() {
    document.getElementById('txtpageamt').value = "";
    var compcode = document.getElementById('hiddencompcode').value;
    var bookdate = document.getElementById('txtdatetime').value;
    var resr = Classified_Booking.bindpagePosition(compcode, bookdate, document.getElementById('hiddendateformat').value, "CL0");
    var resp = resr.value;
    var pkgitem = document.getElementById("drppageposition");
    pkgitem.options.length = 1;
    pkgitem.options[0] = new Option("Select Page Position", "0");
    if (resp != null) {
        for (var i = 0; i < resp.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(resp.Tables[0].Rows[i].Pos_Type, resp.Tables[0].Rows[i].Pos_Type_Code);
            pkgitem.options.length;
        }
    }
}
function AdcatChange() {
    //        document.getElementById('drppageprem').value = "0";
    //        getpremper();
}


/////bhanu st
function gettrapremium() {

    var translation = document.getElementById('drptranslation').value;
    var compcode = document.getElementById('hiddencompcode').value;
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    if (translation != "0") {
        var res = Classified_Booking.gettraprem(compcode, translation);
        var ds = res.value;
        if (ds.Tables[0].Rows.length > 0) {
            document.getElementById('txttranslationcharges').value = ds.Tables[0].Rows[0].CHARGE_AMT
            document.getElementById('txttranslationdisc').value = "";
            document.getElementById('hiddentranalpremtype').value = ds.Tables[0].Rows[0].CHARGES_TYPE
            hdntranschgon = ds.Tables[0].Rows[0].CHARGES_ON
            if (document.getElementById('txtgrossamt').value != "") {
                // getagrredamou();
            }

        }
    }
    else {
        document.getElementById('txttranslationcharges').value = "";
        document.getElementById('hiddentranalpremtype').value = "";
        document.getElementById('txttranslationdisc').value = "";
        hdntranschgon = "";
        if (document.getElementById('txtgrossamt').value != "") {
            //  getagrredamou();
        }
    }

    return false;



}
/////bhanu en
////bhanu 5/3/2012
function filterinsert() {
    var msg = checkSession();
    if (msg == false) {
        window.location.href = "login.aspx";
        return false;
    }
    if (document.getElementById('txtciobookid').value == '') {
        document.getElementById('txtciobookid').value = document.getElementById('hiddencioid').value;
    }
    var cioid = document.getElementById('txtciobookid').value;
    var compcode = document.getElementById('hiddencompcode').value;
    if (filterins == "") {
        Classified_Booking.showgridforexe1(cioid, compcode, document.getElementById('hiddenquotation').value, call_showgrid);
        filterins = "1";
    }
    else {
        //  Classified_Booking.showgridforexe(cioid, compcode, call_showgrid);
        var res = Classified_Booking.showgridforexe(cioid, compcode, document.getElementById('hiddensupplimentflag').value, document.getElementById('hiddenquotation').value);
        call_showgrid(res);
        filterins = "";
    }
    return false;
}
/////bhanu end


function closediv() {
    document.getElementById("txtagaddf2").value = "";
    document.getElementById("div2").style.display = "none";
}

function Btncopyclick() {
    var obj = document.getElementById('drppackage');
    if (obj.value == "0") {
        alert("Please select the package");
        obj.focus();
        return false;
    }
    for (var x = 0; x < obj.options.length; x++) {
        if (obj.options[x].selected == true) {
            drppack = obj.options[x].value;
            addpkgname();
        }
    }
    tooltipadsubcat();
    return false;
}

function validation() {



    if (document.getElementById("txttranslationcharges").value != "") {

        if (parseFloat(document.getElementById("txttranslationdisc").value) > parseFloat(document.getElementById("txttranslationcharges").value)) {
            alert('Trans. Disc(%) can not be greated than T.Charges');
            document.getElementById("txttranslationdisc").value = "";
            document.getElementById("txttranslationdisc").focus();
            return false;
        }

    }

    else {

        if (parseFloat(document.getElementById("txttranslationdisc").value) > 100) {
            alert('Trans. Disc(%) can not be greated than 100%');
            document.getElementById("txttranslationdisc").value = "";
            document.getElementById("txttranslationdisc").focus();
            return false;
        }
    }

    if (document.getElementById("txtpageamt").value != "") {

        if (parseFloat(document.getElementById("txtpospremdisc").value) > parseFloat(document.getElementById("txtpageamt").value)) {
            alert('PosPrem. Disc.(%) can not be greated than Post Prem. Amt');
            document.getElementById("txtpospremdisc").value = "";
            document.getElementById("txtpospremdisc").focus();
            return false;
        }

    }

    else {

        if (parseFloat(document.getElementById("txtpospremdisc").value) > 100) {
            alert('PosPrem. Disc.(%) can not be greated than 100%');
            document.getElementById("txtpospremdisc").value = "";
            document.getElementById("txtpospremdisc").focus();
            return false;
        }
    }
}


function btnclientreg() {
    if (document.getElementById('txtclient').value == "") {
        alert("Please Enter client Name");
        return false;
    }


    var frombooking = "1";
    var clientname = document.getElementById('txtclient').value;
    clientname = clientname.replace("&", "!");
    window.open('ClientMaster.aspx?frombooking=' + frombooking + '&clientname=' + clientname, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0,scrollbars=yes');

    return false;
}

function tooltipadsubcat() {
    var compcode = document.getElementById('hiddencompcode').value;
    if (document.getElementById('bookdiv') != null) {
        var len = "bookdiv";
        var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
        var k;
        var adsubcat;
        var i = 0;
        var adsubcategoryval = document.getElementById('drpadsubcategory').value;
        //        for (k = 0; k < y - 1; k++) {

        //            adsubcat = "ads" + i;
        //            var adsubcategoryval = document.getElementById(adsubcat).value
        //            if (adsubcategoryval != null && adsubcategoryval != "" && adsubcategoryval != "0") {
        //                var res = Classified_Booking.bindtootipsubcat(adsubcategoryval, compcode)
        //                var ds = res.value;
        //                if (ds != null && ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0 && ds.Tables[0].Rows[0].Adv_Subcat_Name !=undefined &&  ds.Tables[0].Rows[0].Adv_Subcat_Name != "undefined" && ds.Tables[0].Rows[0].Adv_Subcat_Name != null || ds.Tables[0].Rows[0].Adv_Subcat_Name != "") {
        //                    document.getElementById(adsubcat).title = ds.Tables[0].Rows[0].Adv_Subcat_Name;
        //                }

        //            }
        //            i = parseInt(i) + 1;

        //        }

    }



}

function uploadlogoall1() {

    var hei = document.getElementById('txtlogohei1').value;
    var wid = document.getElementById('txtlogowid1').value;
    var colwidth = document.getElementById('hiddenwidth').value;
    if (window.opener.document.getElementById('txtdummydate').value == "") {
        alert("Please Fill the Publish date");
        return false;
    }
    // var tot_area="txttotalarea"
    // var ins_id="All";
    // var eyecatch=document.getElementById('drpbullet').value;
    // var bgcolor=document.getElementById('drpbgcolor').value;
    // var eyecatchlength=document.getElementById('txteyecathval').value;
    //  var width=document.getElementById('txtadsize2').value;
    // var agcdd=document.getElementById('drpagency_comp').value;
    //width="3.8";

    /*change*/

    var objpack = window.opener.document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var code = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (temp != "") {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode + "," + code;
                desc = tempcode + "," + desc;


            }
            else {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode;
                desc = tempcode;
            }
        }

    }
    var pubedit = desc.replace("+", "^");
    width = desc.replace("+", "^");
    code = code.replace("+", "^");

    // var uom=document.getElementById('drpuom').value;
    //   var ins="0";
    //  var edit="All";
    var ciobookid = window.opener.document.getElementById('txtciobookid').value;
    //  var fileid="bookdiv";   
    //  var logo="logo";
    // var valh="0";
    // var chk_modify=document.getElementById('hiddensavemod').value;
    /*in India*/
    var datefield = window.opener.document.getElementById('txtdummydate').value;
    if (clientfromconfig1 == "SP") {
        document.getElementById('btnok').disabled = false;
        document.getElementById('btnprev').disabled = true;
    }
    //window.open('logoupload.aspx?adheight='+hei+'&adwidth='+wid+'&ins='+ins+'&edition='+edit+'&ciobookid='+ciobookid+'&fileid='+fileid+'&logo='+logo+'&pubedit='+pubedit+'&code='+code+'&uom='+uom+'&chk_modify='+chk_modify+'&agcode='+agcdd,'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=244,left=210,width=350px,height=95px');
    window.open('logoupload.aspx?adheight=' + hei + '&adwidth=' + wid + '&insertNo=' + document.getElementById('hiddenInsertNo').value + '&srno=' + document.getElementById('hiddensrno').value + '&ciobookid=' + ciobookid + '&edition=' + width.split("(")[0] + '&datefield=' + datefield + '&logoid=2', 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=244,left=210,width=350px,height=95px');
    //window.open('temupload.aspx?adheight='+hei+'&adwidth='+wid+'&ins='+ins+'&edition='+edit+'&ciobookid='+ciobookid+'&fileid='+fileid+'&logo='+logo+'&pubedit='+pubedit,'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=244,left=210,width=350px,height=95px');
    return false;


}
function getfocusPackagecat(obj) {
    var idfoc = obj.id;
    if (idfocus != "") {
        document.getElementById(idfocus).style.backgroundColor = "";
    }
    document.getElementById(idfoc).style.backgroundColor = "#FFFF80";

    idfocus = obj.id;
    with (obj.style) {
        left = obj.offsetLeft;
        top = obj.offsetTop;
        width = "280px"
        // position="absolute";

    }
}
function lostfocusPackagecat(obj) {
    with (obj.style) {
        left = obj.offsetLeft;
        top = obj.offsetTop;
        width = "120px"
        // position="absolute";

    }
}


function isNumberKey(evt) {
    var charCode = (evt.which) ? evt.which : event.keyCode
    if (charCode > 31 && (charCode < 48 || charCode > 57))
        return false;

    return true;
}
function openOnlineFields() {
    if (document.getElementById('chkonline').checked == true && document.getElementById('chkonline').disabled == false)
        window.open('classified/fields.aspx?scatid=' + document.getElementById('drpadsubcategory').value + '&catid=' + document.getElementById('drpadcategory').value + '&adid=' + document.getElementById('txtciobookid').value + '&compCode=' + document.getElementById('hiddencompcode').value + '&adPremium=' + document.getElementById('drppageposition').value, 'Ankur2', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0,scrollbars=yes');
}
function alertContents(httpRequest) {

    if (httpRequest.readyState == 4) {
        if (httpRequest.status == 200) {
            //alert(httpRequest.responseText);
            s = httpRequest.responseText;
        } else {
            alert('There was a problem with the request.');
        }
    }

}
function bindpackagedatewise() {
    res2 = Classified_Booking.bindpackage_DateWise(document.getElementById('hiddencompcode').value, document.getElementById('txtdatetime').value, document.getElementById('hiddendateformat').value);
    var dsexecut = res2.value;
    if (dsexecut == null) {
        alert(res2.error.description);
        return false;
    }
    document.getElementById('drppackage').options.length = 0;
    for (i = 0; i <= dsexecut.Tables[0].Rows.length - 1; i++) {
        if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "") {
            if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "0") {

                var T = dsexecut.Tables[0].Rows[i].Package_Name;
                var V = dsexecut.Tables[0].Rows[i].pck_code;
                document.getElementById('drppackage').options[document.getElementById('drppackage').options.length] = new Option(T, V);
                document.getElementById('drppackage').options.length;
            }
        }
    }
}
function deductCoupan(count) {
    var res = Classified_Booking.getCouAmount(document.getElementById('hiddencompcode').value, document.getElementById('hiddencenter').value, document.getElementById('drpcoutype').value);
    var ds = res.value;
    var dedamt = 0;
    var amt = 0;
    var arr_split = document.getElementById('txtcouno').value.split(',')
    if (ds != null && ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0) {
        for (var i = 0; i < arr_split.length; i++) {
            if (arr_split[i] != "") {
                amt = amt + ds.Tables[0].Rows[0].AMOUNT
            }
        }
        count = parseInt(count, 10) - 1;
        for (var i = count; i >= 0; i--) {
            if (amt > 0) {
                var billvar = document.getElementById('ba' + i);
                var grossvar = document.getElementById('gro' + i);
                var paidvar = document.getElementById('pai' + i).value;
                var coupanamt = document.getElementById('coupan' + i);
                var insertsta = document.getElementById('inssta' + i).value;
                if (insertsta != null && insertsta != 'cancel' && insertsta != 'billed' && paidvar != null && paidvar != 'N') {
                    if (parseFloat(amt) > parseFloat(grossvar.value)) {
                        amt = parseFloat(amt) - parseFloat(grossvar.value);
                        dedamt = parseFloat(dedamt) + parseFloat(billvar.value);
                        billvar.value = 0;
                        coupanamt.value = amt;
                    }
                    else {

                        var tamt = parseFloat(grossvar.value) - parseFloat(amt);
                        var tradisc = document.getElementById('txttradedisc').value;
                        var mainbill = billvar.value;
                        if (document.getElementById('chktrade').checked == false)
                            tradisc = 0;
                        if (tradisc == "")
                            tradisc = 0;
                        var trdisc1 = tradisc;

                        var billamount = 0;
                        billamount = parseFloat(tamt) - (parseFloat(tamt) * trdisc1 / 100);
                        billvar.value = billamount;
                        dedamt = parseFloat(dedamt) + (parseFloat(mainbill) - parseFloat(billamount));
                        amt = 0;
                        coupanamt.value = (parseFloat(mainbill) - parseFloat(billamount));
                    }
                }
            }
        }
    }
    document.getElementById('txtbillamt').value = parseFloat(document.getElementById('txtbillamt').value) - parseFloat(dedamt);
}
function coupancheck() {
    if (document.getElementById('drpcoutype').value != "0" && document.getElementById('drpcoutype').value != "" && document.getElementById('txtcouno').value == "") {
        alert("Please Enter CPN No.");
        document.getElementById('txtcouno').focus();
        return false;
    }
    if (document.getElementById('drpcoutype').value != "0" && document.getElementById('drpcoutype').value != "" && document.getElementById('txtcouno').value != "") {
        var agcode = "";
        var execcode = "";
        var fDate = '';
        var lDate = '';
        var len = "bookdiv";
        var diffDays = 0;
        var dateformat = document.getElementById('hiddendateformat').value;
        var rowcount = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
        if (rowcount > 0) {
            if (document.getElementById('Text0').value == "")
                fDate = date_frmt_orcl(dateformat, gfollodate);
            else
                fDate = date_frmt_orcl(dateformat, document.getElementById('Text0').value);
            if (document.getElementById('Text' + (rowcount - 1)).value == "")
                lDate = date_frmt_orcl(dateformat, gfollodate);
            else
                lDate = date_frmt_orcl(dateformat, document.getElementById('Text' + (rowcount - 1)).value);
            var date1 = new Date(fDate);
            var date2 = new Date(lDate);
            diffDays = Math.round(Math.abs(date2 - date1) / (86400000))
        }
        if (document.getElementById('txtagency').value != "" && document.getElementById('txtagency').value.indexOf("(") >= 0 && document.getElementById('txtagency').value.indexOf(")") >= 0) {
            agcode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.lastIndexOf(')'));
        }
        if (document.getElementById('txtexecname').value != "" && document.getElementById('txtexecname').value.indexOf("(") >= 0 && document.getElementById('txtexecname').value.indexOf(")") >= 0) {
            execcode = document.getElementById('txtexecname').value.substring(document.getElementById('txtexecname').value.lastIndexOf('(') + 1, document.getElementById('txtexecname').value.lastIndexOf(')'));
        }
        var arr_split = document.getElementById('txtcouno').value.split(',')
        for (var i = 0; i < arr_split.length; i++) {
            var cpn = arr_split[i];
            if (cpn != "") {
                var rescou = Classified_Booking.validationCoupan(document.getElementById('hiddencompcode').value, document.getElementById('hiddencenter').value, cpn, document.getElementById('drpcoutype').value, agcode, execcode, document.getElementById('txtdatetime').value, document.getElementById('hiddendateformat').value);
                var dscou = rescou.value;
                if (dscou != null && dscou.Tables.length > 0 && dscou.Tables[0].Rows[0].CIO_BOOKING_ID != "") {
                    alert("Coupan Already Used With Reference No. " + dscou.Tables[0].Rows[0].CIO_BOOKING_ID);
                    document.getElementById('txtcouno').value = "";
                    return false;
                }
                if (dscou != null && dscou.Tables.length > 1 && dscou.Tables[1].Rows.length > 0) {
                    if (dscou.Tables[1].Rows[0].CPN_SIZE != document.getElementById('txttotalarea').value) {
                        alert("Coupon Size is not valid !!!");
                        document.getElementById('txtcouno').value = "";
                        return false;
                    }
                    if (dscou.Tables[1].Rows[0].UOM != "" && dscou.Tables[1].Rows[0].UOM != "0" && dscou.Tables[1].Rows[0].UOM != document.getElementById('hiddenuomdesc').value) {
                        alert("Coupon UOM is not valid !!!");
                        document.getElementById('txtcouno').value = "";
                        return false;
                    }
                    if (diffDays > 0 && diffDays >= dscou.Tables[1].Rows[0].CONSUMPTION_PERIOD) {
                        alert("Coupon Consumption Period is not valid !!!");
                        document.getElementById('txtcouno').value = "";
                        return false;
                    }
                }
                if (dscou != null && dscou.Tables.length > 2 && dscou.Tables[2].Rows.length > 0) {
                    if (dscou.Tables[2].Rows[0].REPORTING_TYPE != "" && dscou.Tables[2].Rows[0].REPORTING_TYPE != "0") {
                        if (dscou.Tables[2].Rows[0].REPORTING_TO == agcode || dscou.Tables[2].Rows[0].REPORTING_TO == execcode) {
                            alert("Coupon No. is not valid for Executive/Agency !!!");
                            document.getElementById('txtcouno').value = "";
                            return false;
                        }
                    }
                }
                else if (dscou == null || dscou.Tables[2].Rows.length == 0) {
                    alert("Coupon No. is not valid !!!");
                    document.getElementById('txtcouno').value = "";
                    return false;
                }
            }
        }
    }
}
function tcharges(){
 if ((document.getElementById('hiddentranalpremtype') != null && (document.getElementById('txttranslationcharges') != null && document.getElementById('txttranslationcharges').value != "" && document.getElementById('txttranslationcharges').value != "0" && boxstatus != "billed") || (document.getElementById('drptranslation').value != "" && document.getElementById('drptranslation').value != "0" && boxstatus != "billed")) && hdntranschgon=="N"){ //for on translation charges
     var count1 = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
     for (var t = 0; t < count1; t++) {
             var billvar = document.getElementById('ba' + t);
             var grossvar = document.getElementById('gro' + t);
             var paidvar = document.getElementById('pai' + t).value;
             var insertsta = document.getElementById('inssta' + t).value; 
             
                var tranlationcharge = 0;
                var Insertgrossamt = 0;
                if (document.getElementById('txttranslationcharges') != null)
                    var tranlationch = document.getElementById('txttranslationcharges').value;
                if (tranlationch != "" && document.getElementById('txttranslationdisc').value != "")
                    tranlationch = parseFloat(tranlationch) - parseFloat(document.getElementById('txttranslationdisc').value);
                if (tranlationch != null && tranlationch != "" && tranlationch != "0") {
                    tranlationcharge = parseInt(tranlationch);
                }      
                if (insertsta != null && insertsta != 'cancel' && insertsta != 'billed' && paidvar != null && paidvar != 'N') {
                 if(document.getElementById('hiddentranalpremtype').value=="F"){
                     Insertgrossamt = parseFloat(tranlationcharge) / count1;
                     grossvar.value=(parseFloat(grossvar.value)+parseFloat(Insertgrossamt)).toFixed(2);
                     //grossamtTotal1 = parseFloat(grossamtTotal1) + parseFloat(grossvar.value);
                     //tclientcatam = parseFloat(tclientcatam) + parseFloat(Insertgrossamt);
                     }
                     else{
                         Insertgrossamt = (parseFloat(grossvar.value) * parseFloat(tranlationcharge) / 100).toFixed(2);
                         grossvar.value = (parseFloat(grossvar.value) + parseFloat(Insertgrossamt)).toFixed(2);
                         //grossamtTotal1 = parseFloat(grossamtTotal1) + parseFloat(grossvar.value);
                         //tclientcatam = parseFloat(tclientcatam) + parseFloat(clicatamt.value);
                     }
                 }
            }
    }
 }
function getexteradisc() {
    if (document.getElementById('txtclientcatdisc').value != "" || document.getElementById('txtflatfreqdisc').value != "" || document.getElementById('txtcatdisc').value != "") {
        var count1 = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
        var grossamt_var1 = document.getElementById('txtgrossamt');
        var grossamtTotal1 = 0;
        var tclientcatam = 0;
        var tflatfreqamt = 0;
        var tcatamt = 0;

        var mclientcatdisc = document.getElementById('txtclientcatdisc').value;
        var mflatfreqdisc = document.getElementById('txtflatfreqdisc').value;
        var mcatdisc = document.getElementById('txtcatdisc').value;
        var clientcatdistype = document.getElementById('hdnclientcatdistype').value;
        var flatfreqdisctype = document.getElementById('hdnflatfreqdisctype').value;
        var catdisctype = document.getElementById('hdncatdisctype').value;
        var mclientcatdistype = document.getElementById('txtclientcatam');
        var mflatfreqdisctype = document.getElementById('txtflatfreqamt');
        var mcatdisctype = document.getElementById('txtcatamt');
        for (var t = 0; t < count1; t++) {
            var billvar = document.getElementById('ba' + t);
            var grossvar = document.getElementById('gro' + t);
            var paidvar = document.getElementById('pai' + t).value;
            var insertsta = document.getElementById('inssta' + t).value;
            var clicatamt = document.getElementById('clicatamt' + t);
            var flatfreqamt = document.getElementById('flatfreqamt' + t);
            var catamt = document.getElementById('catamt' + t);
            if (document.getElementById('txtclientcatdisc').value != "") {
                if (insertsta != null && insertsta != 'cancel' && insertsta != 'billed' && paidvar != null && paidvar != 'N') {
                    if (clientcatdistype == "F") {
                        clicatamt.value = parseFloat(mclientcatdisc) / tot_row_count;
                        grossvar.value = (parseFloat(grossvar.value) - parseFloat(clicatamt.value)).toFixed(2);
                        //grossamtTotal1 = parseFloat(grossamtTotal1) + parseFloat(grossvar.value);
                        tclientcatam = parseFloat(tclientcatam) + parseFloat(clicatamt.value);
                    }
                    else {
                        clicatamt.value = (parseFloat(grossvar.value) * parseFloat(mclientcatdisc) / 100).toFixed(2);
                        grossvar.value = (parseFloat(grossvar.value) - parseFloat(clicatamt.value)).toFixed(2);
                        //grossamtTotal1 = parseFloat(grossamtTotal1) + parseFloat(grossvar.value);
                        tclientcatam = parseFloat(tclientcatam) + parseFloat(clicatamt.value);
                    }
                }
            }
            if (document.getElementById('txtflatfreqdisc').value != "") {
                if (insertsta != null && insertsta != 'cancel' && insertsta != 'billed' && paidvar != null && paidvar != 'N') {
                    if (flatfreqdisctype == "F") {
                        flatfreqamt.value = parseFloat(mflatfreqdisc) / tot_row_count;
                        grossvar.value = (parseFloat(grossvar.value) - parseFloat(flatfreqamt.value)).toFixed(2);
                        //grossamtTotal1 = parseFloat(grossamtTotal1) + parseFloat(grossvar.value);
                        tflatfreqamt = parseFloat(tflatfreqamt) + parseFloat(flatfreqamt.value);
                    }
                    else {
                        flatfreqamt.value = (parseFloat(grossvar.value) * parseFloat(mflatfreqdisc) / 100).toFixed(2);
                        grossvar.value = (parseFloat(grossvar.value) - parseFloat(flatfreqamt.value)).toFixed(2);
                        //grossamtTotal1 = parseFloat(grossamtTotal1) + parseFloat(grossvar.value);
                        tflatfreqamt = parseFloat(tflatfreqamt) + parseFloat(flatfreqamt.value);
                    }
                }
            }
            if (document.getElementById('txtcatdisc').value != "") {
                if (insertsta != null && insertsta != 'cancel' && insertsta != 'billed' && paidvar != null && paidvar != 'N') {
                    if (catdisctype == "F") {
                        catamt.value = parseFloat(mcatdisc) / tot_row_count;
                        grossvar.value = (parseFloat(grossvar.value) - parseFloat(catamt.value)).toFixed(2);
                        //grossamtTotal1 = parseFloat(grossamtTotal1) + parseFloat(grossvar.value);
                        tcatamt = parseFloat(tcatamt) + parseFloat(catamt.value);
                    }
                    else {
                        catamt.value = (parseFloat(grossvar.value) * parseFloat(mcatdisc) / 100).toFixed(2);
                        grossvar.value = (parseFloat(grossvar.value) - parseFloat(catamt.value)).toFixed(2);
                        //grossamtTotal1 = parseFloat(grossamtTotal1) + parseFloat(grossvar.value);
                        tcatamt = parseFloat(tcatamt) + parseFloat(catamt.value);
                    }
                }
            }
            grossamtTotal1 = parseFloat(grossamtTotal1) + parseFloat(grossvar.value);
            var tradisc = document.getElementById('txttradedisc').value;
            if (document.getElementById('chktrade').checked == false)
                tradisc = 0;
            if (tradisc == "")
                tradisc = 0;
            var trdisc1 = tradisc;
            var addcomm = 0;
            if (document.getElementById('txtaddagencycommrate') != null) {
                if (document.getElementById('hiddenagcommflag').value != "1")
                    addcomm = document.getElementById('txtaddagencycommrate').value;
            }
            if (addcomm == "") {
                addcomm = "0";
            }
            if (addcomm != "0") {
                trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
            }

            var billamount = 0;
            billamount = parseFloat(grossvar.value) - (parseFloat(grossvar.value) * trdisc1 / 100);
            billvar.value = billamount;
        }
        mclientcatdistype.value = (parseFloat(tclientcatam)).toFixed(2);
        mflatfreqdisctype.value = (parseFloat(tflatfreqamt)).toFixed(2);
        mcatdisctype.value = (parseFloat(tcatamt)).toFixed(2);
        grossamt_var1.value = parseFloat(grossamtTotal1);
    }
}
function getdayFromDate(dateformat, value1) {
    var dd = "";
    var mm = "";
    var yy = "";
    var newdate = "";
    if (dateformat == "dd/mm/yyyy") {
        var arrvalue1 = value1.split('/');
        dd = arrvalue1[0];
        mm = arrvalue1[1];
        yy = arrvalue1[2];
    }
    else if (dateformat == "mm/dd/yyyy") {
        var arrvalue1 = value1.split('/');
        dd = arrvalue1[1];
        mm = arrvalue1[0];
        yy = arrvalue1[2];
    }
    else if (dateformat == "yyyy/mm/dd") {
        var arrvalue1 = value1.split('/');
        dd = arrvalue1[2];
        mm = arrvalue1[1];
        yy = arrvalue1[0];
    }
    var str = mm + "/" + dd + "/" + yy;
    newdate = new Date(str);
    var weekday = new Array(7);
    weekday[0] = "Sunday";
    weekday[1] = "Monday";
    weekday[2] = "Tuesday";
    weekday[3] = "Wednesday";
    weekday[4] = "Thursday";
    weekday[5] = "Friday";
    weekday[6] = "Saturday";

    var n = weekday[newdate.getDay()];
    return n;

}

function commaremove() {
    if (COMMASALLOWINBOOKING == "Y") {
        document.getElementById('txtagreedrate').value = document.getElementById('txtagreedrate').value.replace(/[^\d\.\-\ ]/g, '');
        document.getElementById('txtagreedamt').value = document.getElementById('txtagreedamt').value.replace(/[^\d\.\-\ ]/g, '');
        document.getElementById('txtgrossamtlocal').value = document.getElementById('txtgrossamtlocal').value.replace(/[^\d\.\-\ ]/g, '');
        document.getElementById('txtgrossamt').value = document.getElementById('txtgrossamt').value.replace(/[^\d\.\-\ ]/g, '');
        document.getElementById('txtbillamtlocal').value = document.getElementById('txtbillamtlocal').value.replace(/[^\d\.\-\ ]/g, '');
        document.getElementById('txtbillamt').value = document.getElementById('txtbillamt').value.replace(/[^\d\.\-\ ]/g, '');
        document.getElementById('txtcardrate').value = document.getElementById('txtcardrate').value.replace(/[^\d\.\-\ ]/g, '');
        document.getElementById('txtcardamt').value = document.getElementById('txtcardamt').value.replace(/[^\d\.\-\ ]/g, '');
        document.getElementById('txtdiscount').value = document.getElementById('txtdiscount').value.replace(/[^\d\.\-\ ]/g, '');
        document.getElementById('txtpageamt').value = document.getElementById('txtpageamt').value.replace(/[^\d\.\-\ ]/g, '');
        document.getElementById('txtspedisc').value = document.getElementById('txtspedisc').value.replace(/[^\d\.\-\ ]/g, '');
        var rowcount = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
        for (var itemCount = 0; itemCount < parseInt(rowcount); itemCount++) {
            document.getElementById("card" + itemCount).value = document.getElementById("card" + itemCount).value.replace(/[^\d\.\-\ ]/g, '');
            document.getElementById("disrat" + itemCount).value = document.getElementById("disrat" + itemCount).value.replace(/[^\d\.\-\ ]/g, '');
            document.getElementById("agr" + itemCount).value = document.getElementById("agr" + itemCount).value.replace(/[^\d\.\-\ ]/g, '');
            document.getElementById("sol" + itemCount).value = document.getElementById("sol" + itemCount).value.replace(/[^\d\.\-\ ]/g, '');
            document.getElementById("grolocal" + itemCount).value = document.getElementById("grolocal" + itemCount).value.replace(/[^\d\.\-\ ]/g, '');
            document.getElementById("balocal" + itemCount).value = document.getElementById("balocal" + itemCount).value.replace(/[^\d\.\-\ ]/g, '');
            document.getElementById("gro" + itemCount).value = document.getElementById("gro" + itemCount).value.replace(/[^\d\.\-\ ]/g, '');
            document.getElementById("ba" + itemCount).value = document.getElementById("ba" + itemCount).value.replace(/[^\d\.\-\ ]/g, '');
        }
    }

}
function commaenable() {
    if (COMMASALLOWINBOOKING == "Y") {
        document.getElementById('txtagreedrate').value = document.getElementById('txtagreedrate').value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        document.getElementById('txtagreedamt').value = document.getElementById('txtagreedamt').value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        document.getElementById('txtgrossamtlocal').value = document.getElementById('txtgrossamtlocal').value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        document.getElementById('txtgrossamt').value = document.getElementById('txtgrossamt').value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        document.getElementById('txtbillamtlocal').value = document.getElementById('txtbillamtlocal').value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        document.getElementById('txtbillamt').value = document.getElementById('txtbillamt').value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        document.getElementById('txtcardrate').value = document.getElementById('txtcardrate').value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        document.getElementById('txtcardamt').value = document.getElementById('txtcardamt').value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        document.getElementById('txtdiscount').value = document.getElementById('txtdiscount').value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        document.getElementById('txtpageamt').value = document.getElementById('txtpageamt').value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        document.getElementById('txtspedisc').value = document.getElementById('txtspedisc').value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        var rowcount = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
        for (var itemCount = 0; itemCount < parseInt(rowcount); itemCount++) {
            document.getElementById("card" + itemCount).value = document.getElementById("card" + itemCount).value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            document.getElementById("disrat" + itemCount).value = document.getElementById("disrat" + itemCount).value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            document.getElementById("agr" + itemCount).value = document.getElementById("agr" + itemCount).value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            document.getElementById("sol" + itemCount).value = document.getElementById("sol" + itemCount).value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            document.getElementById("grolocal" + itemCount).value = document.getElementById("grolocal" + itemCount).value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            document.getElementById("balocal" + itemCount).value = document.getElementById("balocal" + itemCount).value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            document.getElementById("gro" + itemCount).value = document.getElementById("gro" + itemCount).value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            document.getElementById("ba" + itemCount).value = document.getElementById("ba" + itemCount).value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
    }
}









var multibilling_flag = "";
function multibilling_grid() {
    multibilling_flag = "YES";
    if (document.getElementById('txtbillamtlocal').value == "") {
        alert("Please Get Rate First");
        return false;
    }
    document.getElementById('Btnaddrow').style.display = "block";
    document.getElementById('btnhide').style.display = "block";


    BindDetialGrid()
    return false;
}


function CreateHeaderPart() {
    var hdsview = "";
    hdsview += "<table id='DetailTable'  style='overflow:hide;width: 100%;font-family: Arial, Helvetica, sans-serif;color: #666;font-size: 12px;background: #eaebec;border: #ccc 1px solid; border-radius: 3px;border-collapse: collapse;border-spacing: 0;box-shadow: 0 1px 2px #d1d1d1;'>";
    hdsview += "<tr height='15px'>";
    hdsview += "<td style='width:6%;background-color:#7DAAE3;'><label style='font-size:11px;font-weight:bold;font-family:Arial, Helvetica, sans-serif;color:white;cursor:pointer;vertical-align:top;'>Sr No.</label></td>"
    hdsview += "<td style='width:20%;background-color:#7DAAE3;'><label style='font-size:11px;font-weight:bold;font-family:Arial, Helvetica, sans-serif;color:white;cursor:pointer;vertical-align:top;'>Client Code</label></td>"
    hdsview += "<td style='width:35%;background-color:#7DAAE3;'><label style='font-size:11px;font-weight:bold;font-family:Arial, Helvetica, sans-serif;color:white;cursor:pointer;vertical-align:top;'>Client Name<font color=red> *[F2]</font></label></td>"
    hdsview += "<td style='width:25%;background-color:#7DAAE3;'><label style='font-size:11px;font-weight:bold;font-family:Arial, Helvetica, sans-serif;color:white;cursor:pointer;vertical-align:top;'>&nbsp;Bill Amount</label></td>"
    hdsview += "<td style='width:10%;background-color:#7DAAE3;'><label style='font-size:11px;font-weight:bold;font-family:Arial, Helvetica, sans-serif;color:white;cursor:pointer;vertical-align:top;'>Del.</label></td>"
    hdsview += "</tr>"

    return hdsview;
}



function BindDetialGrid() {
    count = 0;
    document.getElementById('multibilling_div').innerHTML = "";
    var sno = 1;
    var hdsview = "";
    hdsview += CreateHeaderPart();
    hdsview += "<tr>"

    hdsview += "<td>"
    hdsview += "<input type='text'  disabled style='border: 1px solid #929292;background-color:#ffffff;font-family:Arial, Helvetica, sans-serif;font-size:12px;width:94%;text-align:center;' value='" + sno + "'  id=txtsno_" + count + ">"
    hdsview += "<input type='hidden' id=hdnsequeceno_" + count + " value='" + "" + "'  >"
    hdsview += "</td>"

    hdsview += "<td>"
    hdsview += "<input type = 'text' disabled style='border: 1px solid #929292;background-color:#ffffff;font-family:Arial, Helvetica, sans-serif;font-size:12px;width:95%;text-transform:uppercase;' id=clinetcode_" + count + "    />"
    hdsview += "<input type='hidden' id=hdnclientcode_" + count + " >"
    hdsview += "</td>"

    hdsview += "<td>"
    hdsview += "<input type = 'text' enabled style='border: 1px solid #929292;background-color:#ffffff;font-family:Arial, Helvetica, sans-serif;font-size:12px;width:96%;text-transform:uppercase;'  id = 'clinetname_" + count + "'   onkeyup = 'javascript:return bindclient(event);' >"
    hdsview += "<input type='hidden' id=hdnclientname_" + count + " >"
    hdsview += "</td>"





    hdsview += "<td>"
    hdsview += "<input type='text' enabled style='width:50px;border: 1px solid #929292;background-color:#ffffff;font-family:Arial, Helvetica, sans-serif;font-size:12px;width:95%;text-transform:uppercase;' id=billamt_" + count + "    maxlength='195'  >"
    hdsview += "<input type='hidden' id=hdnbillamt_" + count + " >"
    hdsview += "</td>"

    hdsview += "<td>"
    hdsview += "<input type='checkbox' enabled style='border: 1px solid #929292;background-color:#ffffff;font-family:Arial, Helvetica, sans-serif;font-size:12px;width:96%;text-transform:uppercase;'  id = 'delete1_" + count + "'   onchange = 'javascript:return delete_row(this.id);' >"
    hdsview += "</td>"


    hdsview += "</tr>"
    hdsview += "</table>"


    document.getElementById('multibilling_div').innerHTML = hdsview;

    document.getElementById("multibilling_div").style.display = "block";
    aTag = eval(document.getElementById('txtbillamt'))
    var btag;
    var leftpos = 300;
    var toppos = 200;
    do {
        aTag = eval(aTag.offsetParent);
        leftpos += aTag.offsetLeft;
        toppos += aTag.offsetTop;
        btag = eval(aTag)
    } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
    document.getElementById('multibilling_div').style.top = document.getElementById("txtbillamt").offsetTop + (toppos) + "px";
    document.getElementById('multibilling_div').style.left = document.getElementById("txtbillamt").offsetLeft + leftpos + "px";



    count++;
    return false;
}



function delete_row(id) {
    var activeid = document.activeElement.id.split('_')[1];
    document.getElementById('txtsno_' + activeid).disabled = true;
    document.getElementById('clinetcode_' + activeid).disabled = true;
    document.getElementById('clinetname_' + activeid).disabled = true;
    document.getElementById('billamt_' + activeid).disabled = true;
    if (document.getElementById('delete1_' + activeid).checked == true) {
        document.getElementById('delete1_' + activeid).value = "D"
        document.getElementById('delete1_' + activeid).disabled = true;
    }
    else
        document.getElementById('delete1_' + activeid).value = ""

    return false;
}


function OffSetForGrid(activeid, divid, griddivid) {
    var lb = document.getElementById(listboxid);
    for (var i = lb.options.length - 1; i >= 0; i--) {
        lb.options[i] = null;
    }
    lb.selectedIndex = -1;

    var a11 = document.activeElement
    var a111 = document.activeElement
    var curtop = 0;
    var curleft = 0;
    if (a11.offsetParent) {
        while (1) {
            curtop += a11.offsetTop;
            if (!a11.offsetParent)
                break;
            a11 = a11.offsetParent;
        }
    }
    else if (a11.y) {
        curtop += a11.y;
    }
    if (a111.offsetParent) {
        while (1) {
            curleft += a111.offsetLeft
            if (!a111.offsetParent)
                break;
            a111 = a111.offsetParent;
        }
    }
    else if (a111.x) {
        curleft += a111.x;
    }
    curleft = curleft - document.getElementById(griddivid).scrollLeft;
    curtop = curtop - document.getElementById(griddivid).scrollTop;
    document.getElementById(divid).style.top = curtop + 18 + "px";
    document.getElementById(divid).style.left = curleft + "px";
}


function CreateNewRow() {
    if (confirm("Do You Want To Add New Row")) {
        var table = document.getElementById("DetailTable");
        var rowCount = table.rows.length;
        var colCount = table.rows[1].cells.length;

        var row = table.insertRow(rowCount);
        for (var i = 0; i < colCount; i++) {
            var newcell = row.insertCell(i);
            newcell.innerHTML = table.rows[rowCount - 1].cells[i].innerHTML;
            for (var x = 0; x < newcell.childNodes.length; x++) {
                switch (newcell.childNodes[x].type || newcell.childNodes[x].tagName) {
                    case "text":
                        if (newcell.childNodes[x].id.indexOf('txtsno') == 0) {
                            newcell.childNodes[x].value = parseInt(rowCount); newcell.childNodes[x].id = newcell.childNodes[x].id.split('_')[0] + "_" + (parseInt(newcell.childNodes[x].id.split('_')[1]) + parseInt(1));
                        }
                        else {
                            newcell.childNodes[x].value = ""; newcell.childNodes[x].id = newcell.childNodes[x].id.split('_')[0] + "_" + (parseInt(newcell.childNodes[x].id.split('_')[1]) + parseInt(1));
                            if (newcell.childNodes[x].id.indexOf('clinetcode') == 0) {
                                document.getElementById(newcell.childNodes[x].id).disabled = true;
                            }
                            else {
                                document.getElementById(newcell.childNodes[x].id).disabled = false;
                            }

                        }
                        break;
                    case "hidden":
                        newcell.childNodes[x].value = ""; newcell.childNodes[x].id = newcell.childNodes[x].id.split('_')[0] + "_" + (parseInt(newcell.childNodes[x].id.split('_')[1]) + parseInt(1));
                        break;

                    case "checkbox":
                        newcell.childNodes[x].value = ""; newcell.childNodes[x].id = newcell.childNodes[x].id.split('_')[0] + "_" + (parseInt(newcell.childNodes[x].id.split('_')[1]) + parseInt(1));
                        document.getElementById(newcell.childNodes[x].id).disabled = false;
                        break;
                    case "select-one":
                        newcell.childNodes[x].value = newcell.childNodes[x].value; newcell.childNodes[x].id = newcell.childNodes[x].id.split('_')[0] + "_" + (parseInt(newcell.childNodes[x].id.split('_')[1]) + parseInt(1));
                        break;
                }

            }
        }
        document.getElementById(row.cells[2].childNodes[0].id).focus();
        count++;
        return false
    }
    return false;
}








function bindclient(event) {
    var keycode = (event.which) ? event.which : event.keyCode

    //alert(keycode)

    var activeid = document.activeElement.id.split('_')[1];
    if (keycode != 113) {
        CurrentTextId = document.activeElement.id;
        //OffSetForGrid(document.activeElement.id, "divitmname", "lstitmname", "view");
        var itemname = document.getElementById(CurrentTextId).value.toUpperCase();

        document.getElementById("div3").style.display = "block";
        aTag = eval(document.getElementById('clinetname_' + activeid))
        var btag;
        var leftpos = 0;
        var toppos = 0;
        do {
            aTag = eval(aTag.offsetParent);
            leftpos += aTag.offsetLeft;
            toppos += aTag.offsetTop;
            btag = eval(aTag)
        } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
        document.getElementById('div3').style.top = document.getElementById("txtclient").offsetTop + (toppos + 15) + "px";
        document.getElementById('div3').style.left = document.getElementById("txtclient").offsetLeft + leftpos + "px";

        Classified_Booking.bindclientname(document.getElementById('hiddencompcode').value, document.getElementById('clinetname_' + activeid).value, "Y", bindclientname_callback1);


        //  GatePassEntry.GetGatePassItem(compcode, unitcode, brancode, gt_pass_type, ref_gt_no, ref_gt_dt, itemname, po_no, po_dt, userid, dateformat, extra1, extra2, extra3, extra4, extra5, BindItem_CallBack);
        //  return false;
    }



    else if (keycode != 13 && keycode != 37 && keycode != 39 && keycode != 9 && keycode != 17 && keycode == false && keycode == false && keycode == false) {
        document.getElementById('clinetcode_' + activeid).value = "";
        document.getElementById('hdnclientcode_' + activeid).value = "";
        document.getElementById('clinetname_' + activeid).value = "";
        document.getElementById('hdnclientname_' + activeid).value = "";
        document.getElementById('clientadd_' + activeid).value = "";
        document.getElementById('hdnclinetadd_' + activeid).value = "";
    }
    if (keycode == true && keycode == 88) {
        document.getElementById('clinetcode_' + activeid).value = "";
        document.getElementById('hdnclientcode_' + activeid).value = "";
        document.getElementById('clinetname_' + activeid).value = "";
        document.getElementById('hdnclientname_' + activeid).value = "";
        document.getElementById('clientadd_' + activeid).value = "";
        document.getElementById('hdnclinetadd_' + activeid).value = "";
    }
    else if (keycode == 27) {
        //        document.getElementById('clinetcode_' + activeid).value = "";
        //        document.getElementById('hdnclientcode_' + activeid).value = "";
        //        document.getElementById('clinetname_' + activeid).value = "";
        //        document.getElementById('hdnclientname_' + activeid).value = "";

        document.getElementById("div3").style.display = "none";
        document.getElementById(CurrentTextId).focus();
        return false;
    }

}

function bindclientname_callback1(response) {

    ds = response.value;
    var pkgitem = document.getElementById("lstclient_multibilling");
    pkgitem.options.length = 0;
    pkgitem.options[0] = new Option("-Select Client-", "0");
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {
        //alert(pkgitem.options.length);
        pkgitem.options.length = 1;
        for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].Cust_Name + "~" + ds.Tables[0].Rows[i].Cust_Code + "~" + ds.Tables[0].Rows[i].Add1, ds.Tables[0].Rows[i].Cust_Name + "~" + ds.Tables[0].Rows[i].Cust_Code + "~" + ds.Tables[0].Rows[i].Add1);

            pkgitem.options.length;
        }
    }


    return false;
}
function fillclient(event) {
    var key = event.keyCode ? event.keyCode : event.which;
    if (key == 13 || event.type == "click") {
        var page = document.getElementById('lstclient_multibilling').value;
        if (page == "") {
            alert("Please select item ");
            document.getElementById('lstclient_multibilling').focus();
            return false;
        }
        var activeid = CurrentTextId.split('_')[1];
        var str = page.split("~");
        //        for (var x = 0; x < count; x++) {
        //            if (activeid != x) {
        //                if (str[1] == document.getElementById('hdnitemcd_' + x).value) {
        //                    alert("Item already selected");
        //                    return false;
        //                }
        //            }
        //        }
        document.getElementById(CurrentTextId).value = str[0];
        document.getElementById('hdnclientname_' + activeid).value = str[0];
        document.getElementById('clinetcode_' + activeid).value = str[1];
        document.getElementById('hdnclientcode_' + activeid).value = str[1];

        document.getElementById("div3").style.display = "none";
        document.getElementById(CurrentTextId).focus();
        return false;
    }
    else if (key == 27) {
        document.getElementById("div3").style.display = "none";
        document.getElementById(CurrentTextId).focus();
        return false;
    }
}



function hide_grid() {
    multibilling_flag = "No"
    document.getElementById('multibilling_div').innerHTML = "";
    document.getElementById('multibilling_div').style.display = "none";
    return false;
}



function callback_execgrid(res) {
    var dsgrid = res.value;
    document.getElementById('multibilling_div').innerHTML = "";
    var hdsview = "";
    hdsview += CreateHeaderPart();
    var sno = 1;
    for (count = 0; count < dsgrid.Tables[0].Rows.length; count++) {
        hdsview += "<tr>"



        hdsview += "<td>"
        hdsview += "<input type='text'  disabled style='border: 1px solid #929292;background-color:#ffffff;font-family:Arial, Helvetica, sans-serif;font-size:12px;width:96%;text-align:center;' value='" + sno + "'  id=txtsno_" + count + ">"
        hdsview += "<input type='hidden' id=hdnsequeceno_" + count + " value='" + dsgrid.Tables[0].Rows[count].SEQ_ID + "'  >"
        hdsview += "</td>"
        sno++;
        hdsview += "<td>"
        hdsview += "<input type = 'text' disabled style='border: 1px solid #929292;background-color:#ffffff;font-family:Arial, Helvetica, sans-serif;font-size:12px;width:99%;text-transform:uppercase;'  value='" + dsgrid.Tables[0].Rows[count].CLIENT_CODE + "' id=clinetcode_" + count + "    />"
        hdsview += "<input type='hidden' id=hdnclientcode_" + count + " value='" + dsgrid.Tables[0].Rows[count].CLIENT_CODE + "'  >"
        hdsview += "</td>"

        hdsview += "<td>"
        hdsview += "<input type = 'text' disabled style='border: 1px solid #929292;background-color:#ffffff;font-family:Arial, Helvetica, sans-serif;font-size:12px;width:96%;text-transform:uppercase;' value='" + dsgrid.Tables[0].Rows[count].CLIENT_NAME + "' id = 'clinetname_" + count + "'   onkeyup = 'javascript:return bindclient(event);' >"
        hdsview += "<input type='hidden' id=hdnclientname_" + count + " value='" + dsgrid.Tables[0].Rows[count].CLIENT_NAME + "' >";
        hdsview += "</td>"

        //    hdsview += "<td>"
        //    hdsview += "<input type='text'  enabled style='border: 1px solid #929292;background-color:#ffffff;font-family:Arial, Helvetica, sans-serif;font-size:12px;width:99%;text-align:right;text-transform:uppercase;'  value='" + dsgrid.Tables[0].Rows[count].CLIENT_ADDRESS + "' id=clientadd_" + count + "      >"
        //    hdsview += "<input type='hidden' id=hdnclinetadd_" + count + "  value='" + dsgrid.Tables[0].Rows[count].CLIENT_ADDRESS + "'>"
        //    hdsview += "</td>"
        //  
        //    hdsview += "<td>"
        //    hdsview += "<input type='text'  enabled style='border: 1px solid #929292;background-color:#ffffff;font-family:Arial, Helvetica, sans-serif;font-size:12px;width:99%;text-transform:uppercase;'   value='" + dsgrid.Tables[0].Rows[count].WIDTH + "' id=width_" + count + "    maxlength='195'  >"
        //    hdsview += "<input type='hidden' id=hdnclinetadd_" + count + "  value='" + dsgrid.Tables[0].Rows[count].WIDTH + "'>"
        //    hdsview += "</td>"
        //    
        //    hdsview += "<td>"
        //    hdsview += "<input type='text'  enabled style='border: 1px solid #929292;background-color:#ffffff;font-family:Arial, Helvetica, sans-serif;font-size:12px;width:99%;text-transform:uppercase;'  value='" +  dsgrid.Tables[0].Rows[count].HEIGHT + "' id=height_" + count + "    maxlength='195'  >"
        //    hdsview += "<input type='hidden' id=hdnheight_" + count + " value='" +  dsgrid.Tables[0].Rows[count].HEIGHT + "'>"
        //    hdsview += "</td>"
        //    
        //    
        //    
        //    hdsview += "<td>"
        //    hdsview += "<input type='text' enabled style='border: 1px solid #929292;background-color:#ffffff;font-family:Arial, Helvetica, sans-serif;font-size:12px;width:99%;text-transform:uppercase;'  value='" + dsgrid.Tables[0].Rows[count].GROSS_AMT + "'   id=grossamt_" + count + "    maxlength='195'  >"
        //    hdsview += "<input type='hidden' id=hdngrossamt_" + count + "  value='" + dsgrid.Tables[0].Rows[count].GROSS_AMT + "'>"
        //    hdsview += "</td>"
        //  
        //   
        //    hdsview  += "<td>"
        //    hdsview += "<input type='text' enabled style='border: 1px solid #929292;background-color:#ffffff;font-family:Arial, Helvetica, sans-serif;font-size:12px;width:99%;text-transform:uppercase;' value='" + dsgrid.Tables[0].Rows[count].COMMI + "'  id=commi_" + count + "    maxlength='195'  >"
        //    hdsview += "<input type='hidden' id=hdncommi_" + count + " >"
        //    hdsview += "</td>"


        hdsview += "<td>"
        hdsview += "<input type='text' disabled style='border: 1px solid #929292;background-color:#ffffff;font-family:Arial, Helvetica, sans-serif;font-size:12px;width:99%;text-transform:uppercase;'   value='" + dsgrid.Tables[0].Rows[count].BILL_AMT + "' id=billamt_" + count + "    maxlength='195'  >"
        hdsview += "<input type='hidden' id=hdnbillamt_" + count + " value='" + dsgrid.Tables[0].Rows[count].BILL_AMT + "'>"
        hdsview += "</td>"

        hdsview += "<td>"
        hdsview += "<input type='checkbox' disabled style='border: 1px solid #929292;background-color:#ffffff;font-family:Arial, Helvetica, sans-serif;font-size:12px;width:96%;text-transform:uppercase;'  id = 'delete1_" + count + "'   onchange = 'javascript:return delete_row(event);' >"
        hdsview += "</td>"

        hdsview += "</tr>"




    }
    hdsview += "</table>"
    document.getElementById('multibilling_div').innerHTML = hdsview;



    document.getElementById("multibilling_div").style.display = "block";
    //            cTag = eval(document.getElementById('txtbillamt'))
    //            var btag;
    //            var leftpos = 0;
    //            var toppos = 0;
    //            do {
    //                cTag = eval(cTag.offsetParent);
    //                leftpos += cTag.offsetLeft;
    //                toppos += cTag.offsetTop;
    //                btag = eval(aTag)
    //            } while (cTag.tagName != "BODY" && cTag.tagName != "HTML");
    document.getElementById('multibilling_div').style.top = "500" + "px";
    document.getElementById('multibilling_div').style.left = "450" + "px";

    // document.getElementById('Btnaddrow').disabled = true;
    return false;
}



function selectmatter(id) {


    var str = id.split("_");
    var k = str[1];
    document.getElementById('puvdiv11').style.display = "block";
    var pubcode = document.getElementById('pubcode_' + k).value;
    var comcode = document.getElementById('hidencomcode').value;
    var res = Editor.publiNameReturn(comcode, pubcode);
    res = res.value;
    document.getElementById('hinpubselect').value = document.getElementById('pubcode_' + k).value;
    document.getElementById('Label2').innerHTML = "<span style='font-size:12px;color:#DA6200;'>" + res.Tables[0].Rows[0].Pub_Name + "</span>";
    var desiredValue = res.Tables[0].Rows[0].LANGNAME.substr(0, 1).toUpperCase() + res.Tables[0].Rows[0].LANGNAME.substr(1, res.Tables[0].Rows[0].LANGNAME.length).toLowerCase();
    var el = document.getElementById("fnt_fntname");
    for (var i = 0; i < el.options.length; i++) {
        if (el.options[i].text == desiredValue) {
            el.selectedIndex = i;
            if (desiredValue == "Tamil")
            {
                var b = "DIN11";
            }
            else if (desiredValue == "English") {
                var b = "GothamCondensed";
            }
            else if (desiredValue == "Kannad")
            {
                var b = "KANNAN";
            }
            document.getElementById('KEYBORD').selectedIndex = 1;
            document.getElementById('editordiv').focus();
            document.execCommand("FontName", false, b)
            if (browser == "Microsoft Internet Explorer") {
                var atext1 = document.selection.createRange();
                atext1.moveStart("character", -1);
                if (atext1.text == " ") {
                    atext1.select()
                    document.execCommand("FontName", false, b)
                    atext1.moveStart("character", 1);
                    atext1.select()
                }
            }
            break;
        }
    }
    //    var language = res.Tables[0].Rows[0].LANGNAME.substr(0, 1).toUpperCase() + res.Tables[0].Rows[0].LANGNAME.substr(1, res.Tables[0].Rows[0].LANGNAME.length).toLowerCase()
    //    document.getElementById("fnt_fntname").text = language;

    //if (document.getElementById('divpub_' + k).innerHTML != "") {
    //document.getElementById('editordiv').innerHTML = "";
    document.getElementById('editordiv').innerHTML = document.getElementById('divpub_' + k).innerHTML;
    // }

    return false;
}


function copyhtml() {
    var values = document.getElementById('editordiv').innerHTML;
    var packagecode = document.getElementById('hiddenpublicode').value;
    var res = Editor.findpub(packagecode);
    var ds = res.value;
    if (ds.Tables[0].Rows.length > 0) {
        var datalengt = ds.Tables[0].Rows[0].PUBLS.split(',');
        for (var i = 0; i < datalengt.length; i++) {
            if (document.getElementById('hinpubselect').value == datalengt[i]) {
                document.getElementById('divpub_' + i).innerHTML = values;
                 if (browser != "Microsoft Internet Explorer") {
                  if (document.getElementById('divpub_' + i).innerText == "") {
                    document.getElementById('filename_' + i).innerText = "";
                   // document.getElementById('filename_' + i).innerHTML = "";
                }
                 }
                 else{
                if (document.getElementById('divpub_' + i).innerText == "") {
                    document.getElementById('filename_' + i).innerText = "";
                   // document.getElementById('filename_' + i).innerHTML = "";
                }
                }
            }
        }

    }

    return false;

}
function pubvalidation() {

    if (browser != "Microsoft Internet Explorer") 
    {
        if (document.getElementById('Label2').textContent == "Publication ") {
            alert('Please click on editor button for publication matter');
            return false;
        }
    }
    else
    {
        if (document.getElementById('Label2').innerText == "Publication ") {
            alert('Please click on editor button for publication matter');
            return false;
        }
    }
   
//    var values = document.getElementById('editordiv').innerHTML;
//    var packagecode = document.getElementById('hiddenpublicode').value;
//    var res = Editor.findpub(packagecode);
//    var ds = res.value;
//    if (ds.Tables[0].Rows.length > 0) {
//        var datalengt = ds.Tables[0].Rows[0].PUBLS.split(',');
//        for (var i = 0; i < datalengt.length; i++) {
//            if (document.getElementById('hinpubselect').value == datalengt[i]) {
//                document.getElementById('divpub_' + i).innerHTML = "<span>" + values + "</span>";
//            }
//        }

//    }

   // return false;

}

function fillfilename() {
    var packagecode = opener.document.getElementById('hiddenpublicode').value;
    var res = matterprev.findpub(packagecode);
    var ds = res.value;
    if (opener.document.getElementById('hiddenFileName').value != "") {
        var hiddenfilename_vari = opener.document.getElementById('hiddenFileName').value;
        var hiddenfilename_vari1 = hiddenfilename_vari.split('-'); //0007497-LO2 .xtg
        hiddenfilename_vari1 = hiddenfilename_vari1[1].split('.');
        var linecount = opener.document.getElementById('hiddenLineCount').value;
    }
    if (ds.Tables[0].Rows.length > 0) {
        var datalengt = ds.Tables[0].Rows[0].PUBLS.split(',');
        for (var i = 0; i < datalengt.length; i++) {
            if (datalengt[i] == hiddenfilename_vari1[0]) {
                ///opener.document.getElementById('hiddenfilenme111').value = hiddenfilename_vari;
                opener.document.getElementById('filename_' + i).value = hiddenfilename_vari;
                opener.document.getElementById('linecount_' + i).value = linecount;

            }
        }
    }
    window.close();
    return false;

}
function opendivforteam(){
if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbececname').textContent;
    }
    else {
        chmandat = document.getElementById('lbececname').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtexecname').value == "" && (document.getElementById('drpretainer').value == "0" || document.getElementById('drpretainer').value == "")) {
            var a = "Executive name";
            if (browser != "Microsoft Internet Explorer") {
                a = document.getElementById('lbececname').textContent.replace("*[F2]", "");
            }
            else {
                a = document.getElementById('lbececname').innerText.replace("*[F2]", "");
           }
            alert('Please Enter ' + a);
            document.getElementById('txtexecname').focus();
            return false;
        }
    }
document.getElementById('showteamdiv').innerHTML = "";
var teamstr="";
teamstr= "<table width=100%>";
teamstr=teamstr+"<tr><td  align=\"center\" valign=\"top\" >Team Name</td><td><input type = 'text' enabled style='border: 1px solid #929292;background-color:#ffffff;font-family:Arial, Helvetica, sans-serif;font-size:12px;width:96%;text-transform:uppercase;'  id = 'teamname'   onkeyup = 'javascript:return bindteam(event);' ></td></tr>"
teamstr = teamstr + "<tr valign=bottom><td ><input type=button value='OK' class='topbutton' style='width:30px' onClick='okteamselect();'></td><td><input type=button class=topbutton value='Cancel' onClick='closeteamClick();'></td>";
teamstr=teamstr+"</tr><div id='teamdiv' Width=100px Height=50px style='position:absolute;display: none;'><select name='teamlist'   id='teamlist' CssClass='btextlist' onkeydown='fillteam(event);' onClick='fillteam(event);' size=4 Width=100px Height=50px></select></div></table>"
document.getElementById('showteamdiv').innerHTML =teamstr;
document.getElementById('showteamdiv').style.display = "block";
document.getElementById('teamname').value= document.getElementById('hdnteamcode').value;
aTag = eval(document.getElementById("btnteam"))
    var btag;
    var leftpos = 0;
    var toppos = 0;
    do {
        aTag = eval(aTag.offsetParent);
        leftpos += aTag.offsetLeft;
        toppos += aTag.offsetTop;
        btag = eval(aTag)
    } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
    document.getElementById('showteamdiv').style.top = document.getElementById('btnteam').offsetTop + toppos + "px";
    document.getElementById('showteamdiv').style.left = document.getElementById('btnteam').offsetLeft + leftpos + "px";
}
function closeteamClick() {
    document.getElementById('showteamdiv').style.display = 'none';
}
function okteamselect(){
document.getElementById('hdnteamcode').value=document.getElementById('teamname').value;
var resteam = Classified_Booking.getteamname(document.getElementById('hiddencompcode').value, "", document.getElementById('hdnteamcode').value, "", "", "", "");
document.getElementById('lblteamname').innerHTML =resteam.value.Tables[0].Rows[0].TEAM_NAME
document.getElementById('showteamdiv').style.display = 'none';
}
function bindteam(event){
var browser = navigator.appName;
var key = event.keyCode ? event.keyCode : event.which;
    if (event.keyCode == 113) {
    var activeidteam = document.activeElement.id;
        var resteam = Classified_Booking.getteamname(document.getElementById('hiddencompcode').value,document.getElementById('teamname').value,"","","","","");
        var divid = "teamdiv";
        var listboxid = "teamlist";
        if (resteam == null)
                return false;
            var objadscat = document.getElementById(listboxid);
            objadscat.options.length = 0;
            objadscat.options[0] = new Option("-Select-", "0");
            //alert(pkgitem.options.length);
            objadscat.options.length = 1;
            for (var i = 0; i < resteam.value.Tables[0].Rows.length; ++i) {
                objadscat.options[objadscat.options.length] = new Option(resteam.value.Tables[0].Rows[i].TEAM_NAME, resteam.value.Tables[0].Rows[i].TEAM_CODE);

                objadscat.options.length;
            }
            aTag = eval(document.getElementById("txtexeczone"))
            var btag;
            var leftpos = 0;
            var toppos = 0;
            do {
                aTag = eval(aTag.offsetParent);
                leftpos += aTag.offsetLeft;
                toppos += aTag.offsetTop;
                btag = eval(aTag)
            } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
            document.getElementById('teamdiv').style.top = document.getElementById('txtexeczone').offsetTop + "px";
            document.getElementById('teamdiv').style.left = document.getElementById('txtexeczone').offsetLeft + "px";
            document.getElementById('teamname').style.backgroundColor = "#FFFF80";
            document.getElementById('teamdiv').style.display = "block";
            //document.getElementById('teamdiv').cssclass = "btextlist";

            document.getElementById(listboxid).focus();
    }
}
function fillteam(event){
var keycode = event.keyCode ? event.keyCode : event.which;
    if (keycode == 13 || event.type == "click") {
    if (document.getElementById('teamlist').value == "0") {
                alert("Please select Team");
                return false;
            }
            document.getElementById("teamdiv").style.display = "none";
            var page = document.getElementById('teamlist').value;
            document.getElementById('teamname').value = page;
            document.getElementById('teamname').focus();
            return false;
            }
            else if (keycode == 27) {
        jq('#teamdiv').hide("slow");
        jq('#teamname').focus();
    }
}

////////multibilling_changes(end)//////////
function send_sms(ciobookid, sms_link, uid, pwd, sender) {
    var comp_cd = document.getElementById('hiddencompcode').value;
    var ciobookid = ciobookid;
    var extra1 = sms_link;
    var extra2 = uid;
    var extra3 = pwd;
    var extra4 = sender;
    var extra5 = "";
    var sms = Classified_Booking.send_sms(comp_cd, ciobookid, extra1, extra2, extra3, extra4, extra5)
    if (sms.error == null) {
        alert('SMS Send');
        return false;
    }

    return false;
}
////////////////anuja

function bindprodcat() {
    var brandval = document.getElementById('txtindustry').value.substring(document.getElementById('txtindustry').value.lastIndexOf('(') + 1, document.getElementById('txtindustry').value.lastIndexOf(')'));
    // document.getElementById('hdnindus').value = document.getElementById('txtindustry').value;
    var compcode = document.getElementById('hiddencompcode').value;
    var pkgitem = document.getElementById("drpproductcat");
    pkgitem.options.length = 0;
    if (brandval != "") {
        Classified_Booking.fillprodcat(compcode, brandval, "", call_fillproduct);
    }
    return false;
}

function call_fillproduct(res) {
    var ds = res.value;
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {
        var pkgitem = document.getElementById("drpproductcat");
        pkgitem.options.length = 0;
        pkgitem.options[0] = new Option("-Select Product cate.-", "0");
        //alert(pkgitem.options.length);
        pkgitem.options.length = 1;
        for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].pro_sub_name, ds.Tables[0].Rows[i].pro_subcat_code);
            pkgitem.options.length;
        }

    }

}

function bindvarient() {
    var brandval = document.getElementById('drpbrand').value.substring(document.getElementById('drpbrand').value.lastIndexOf('(') + 1, document.getElementById('drpbrand').value.lastIndexOf(')'));
    document.getElementById('hiddenbrand').value = document.getElementById('drpbrand').value;
    var compcode = document.getElementById('hiddencompcode').value;
    var pkgitem = document.getElementById("drpvarient");
    pkgitem.options.length = 0;
    if (brandval != "") {
        Classified_Booking.fillvarient(brandval, compcode, call_fillvarient);
    }
    return false;
}

function call_fillvarient(res) {
    var ds = res.value;
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {
        var pkgitem = document.getElementById("drpvarient");
        pkgitem.options.length = 0;
        pkgitem.options[0] = new Option("-Select varient-", "0");
        //alert(pkgitem.options.length);
        pkgitem.options.length = 1;
        for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].varient_name, ds.Tables[0].Rows[i].varient_code);
            pkgitem.options.length;
        }

    }

}
function openadvpopup1() {
    if (document.getElementById("div4").style.display == "none" && document.getElementById("txtclient").disabled == false) {
        document.getElementById("div4").style.display = "block";
        aTag = eval(document.getElementById("txtclient"))
        var btag;
        var leftpos = 0;
        var toppos = 0;
        do {
            aTag = eval(aTag.offsetParent);
            leftpos += aTag.offsetLeft;
            toppos += aTag.offsetTop;
            btag = eval(aTag)
        } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
        document.getElementById('div4').style.top = document.getElementById("txtclient").offsetTop + toppos - 13 + "px";
        document.getElementById('div4').style.left = document.getElementById("txtclient").offsetLeft + leftpos + 140 + "px";
    }
    else {
        document.getElementById("div4").style.display = "none";
    }
}
function searchclient() {
    document.getElementById("divclient").style.display = "block";
    aTag = eval(document.getElementById("txtclient"))
    var btag;
    var leftpos = 0;
    var toppos = 0;
    do {
        aTag = eval(aTag.offsetParent);
        leftpos += aTag.offsetLeft;
        toppos += aTag.offsetTop;
        btag = eval(aTag)
    } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
    document.getElementById('divclient').style.top = document.getElementById("txtclient").offsetTop + toppos + "px";
    document.getElementById('divclient').style.left = document.getElementById("txtclient").offsetLeft + leftpos + "px";

    Classified_Booking.bindclientnamefromadd(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value, document.getElementById('txtclient').value.toUpperCase(), document.getElementById('txtcliaddf2').value, bindclientname_callback);
}

function closediv1() {
    document.getElementById("txtcliaddf2").value = "";
    document.getElementById("div4").style.display = "none";
}
function chkdate(datefortmat, ds) {
    //var datefortmat="mm/dd/yyyy";
    //var ds='7/1/2017';
    var arr = ds.toString().split("/");
    var fstr = "";
    for (var j = 0; j < arr.length; j++) {
        if (datefortmat == "dd/mm/yyyy" || datefortmat == "mm/dd/yyyy") {
            if (j == 0 || j == 1) {
                if (arr[j].length == 1) {
                    if (j == 0)
                        fstr = fstr + "0" + arr[j].toString();
                    else
                        fstr = fstr + "/0" + arr[j].toString();
                }
                else {
                    if (j == 0)
                        fstr = fstr + arr[j].toString();
                    else
                        fstr = fstr + "/" + arr[j].toString();
                }
            }
            else {
                fstr = fstr + "/" + arr[j].toString();
            }
        }
        else {
            if (j == 1 || j == 2) {
                if (arr[j].length == 1) {
                    if (j == 0)
                        fstr = fstr + "0" + arr[j].toString();
                    else
                        fstr = fstr + "/0" + arr[j].toString();
                }
                else {
                    fstr = fstr + "/" + arr[j].toString();
                }
            }
            else {
                if (j == 0)
                    fstr = fstr + arr[j].toString();
                else
                    fstr = fstr + "/" + arr[j].toString();
            }
        }
    }
    //alert(fstr);
    return fstr;
}
function gstcal(){
//if ( agreedamt_active == "1"){
if (agreedamt_active == "1" || document.getElementById('txtagreedamt').value != "" || document.getElementById('txtagreedrate').value == "") {
        agreedamt_active = "1";
        if (document.getElementById('txtagreedamt').value=="" || document.getElementById('txtagreedamt').value=="0" ){
            alert("Please Enter Agreed Amount... ");
            document.getElementById('txtgrossamt').value = "";
            document.getElementById('txtbillamt').value = "";
            document.getElementById('txtgrossamtlocal').value = "";
            document.getElementById('txtbillamtlocal').value = "";
            return false;
        }    
        document.getElementById('txtdatetime').value = chkdate(document.getElementById('hiddendateformat').value, document.getElementById('txtdatetime').value);
        var agencycodesubcode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.lastIndexOf(')'));
        var client = document.getElementById('txtclient').value.substring(document.getElementById('txtclient').value.lastIndexOf('(') + 1, document.getElementById('txtclient').value.lastIndexOf(')'));
        var res_gst = Classified_Booking.getgstcode(document.getElementById('hiddencompcode').value,agencycodesubcode,client,document.getElementById('drpuom').value,document.getElementById('drprevenue').value,document.getElementById('drpadcategory').value,document.getElementById('txtdatetime').value,"","","","","");
        var ds_GST = res_gst.value;
        if (ds_GST == null) {
            alert(res_gst.error.description);
            blankGross();
            return false;
        }
        var gststr="";        
        if (ds_GST.Tables.length > 0 && ds_GST.Tables[0].Rows.length > 0) {
             var gsttaxtotper=0; 
             var gstcesstotper=0;           
            if (ds_GST.Tables[0].Rows[0].MSG!="" && ds_GST.Tables[0].Rows[0].MSG!="NULL"  && ds_GST.Tables[0].Rows[0].MSG!=null && ds_GST.Tables[0].Rows[0].MSG!="null"){
                alert(ds_GST.Tables[0].Rows[0].MSG);
                return false;
            }
            else{
                if ( agreedamt_active == "1"){
                    for (var n2 = 0; n2 < ds_GST.Tables[0].Rows.length; n2++) {
                        if (ds_GST.Tables[0].Rows[n2].ON_AMOUNT=='CH'){
                            gstcesstotper=parseFloat(gstcesstotper)+parseFloat(ds_GST.Tables[0].Rows[n2].RATE);
                        }
                        else{
                            gsttaxtotper=parseFloat(gsttaxtotper)+parseFloat(ds_GST.Tables[0].Rows[n2].RATE);
                        }
                    }                            
                 }
             }
       }
    billid=document.getElementById('txtagreedamt');
    if(document.getElementById('chkgstinc').checked== true){
        if (parseFloat(gsttaxtotper)>0 && parseFloat(gstcesstotper)>0){ 
            billid.value= ((parseFloat(billid.value)*10000)/(10000+(parseFloat(gsttaxtotper)*100)+(parseFloat(gsttaxtotper)*parseFloat(gstcesstotper)))).toFixed(4);
        }
        else if(parseFloat(gsttaxtotper)>0){
                billid.value=(parseFloat(billid.value)/(1+(parseFloat(gsttaxtotper)/100))).toFixed(4)
        }
        var resp=getagreedamt_Rate();
     }
     else
     {
        if (parseFloat(gsttaxtotper)>0 && parseFloat(gstcesstotper)>0){ 
              
            var gstamt=((parseFloat(billid.value) * parseFloat(gsttaxtotper)) / 100).toFixed(6);
            var gstcessamt=((parseFloat(gstamt) * parseFloat(gstcesstotper)) / 100).toFixed(6);
            billid.value = (parseFloat(billid.value) + parseFloat(gstamt)+parseFloat(gstcessamt)).toFixed(2);
        }
        else if(parseFloat(gsttaxtotper)>0){
                billid.value=(parseFloat(billid.value)+((parseFloat(billid.value) * parseFloat(gsttaxtotper)) / 100)).toFixed(2);
        }
        var resp=getagreedamt_Rate();
     }    
 }
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtbillamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    return false;
}
function openadvpopup1() {
    if (document.getElementById("div4").style.display == "none" && document.getElementById("txtclient").disabled == false) {
        document.getElementById("div4").style.display = "block";
        aTag = eval(document.getElementById("txtclient"))
        var btag;
        var leftpos = 0;
        var toppos = 0;
        do {
            aTag = eval(aTag.offsetParent);
            leftpos += aTag.offsetLeft;
            toppos += aTag.offsetTop;
            btag = eval(aTag)
        } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
        document.getElementById('div4').style.top = document.getElementById("txtclient").offsetTop + toppos - 13 + "px";
        document.getElementById('div4').style.left = document.getElementById("txtclient").offsetLeft + leftpos + 140 + "px";
    }
    else {
        document.getElementById("div4").style.display = "none";
    }
}
function searchclient() {
    document.getElementById("divclient").style.display = "block";
    aTag = eval(document.getElementById("txtclient"))
    var btag;
    var leftpos = 0;
    var toppos = 0;
    do {
        aTag = eval(aTag.offsetParent);
        leftpos += aTag.offsetLeft;
        toppos += aTag.offsetTop;
        btag = eval(aTag)
    } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
    document.getElementById('divclient').style.top = document.getElementById("txtclient").offsetTop + toppos + "px";
    document.getElementById('divclient').style.left = document.getElementById("txtclient").offsetLeft + leftpos + "px";

    Classified_Booking.bindclientnamefromadd(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value, document.getElementById('txtclient').value.toUpperCase(), document.getElementById('txtcliaddf2').value, bindclientname_callback);
}

function closediv1() {
    document.getElementById("txtcliaddf2").value = "";
    document.getElementById("div4").style.display = "none";
}

function revenueonblrenableasnew() {
    var msg = checkSession();
    if (msg == false) {
        window.location.href = "login.aspx";
        return false;
    }
    clearClick();
    enLink = "1";
    cali = 0;
    schemeid = "";
    chkbtnStatus = "new";
    boxstatus = "";
    if (ALLOWBOOKINGBRANCHMAIL == "Y") {
        // document.getElementById('btnmail').style.display = "block";we
        document.getElementById('btnmail').disabled = false;
    }
    else {
        //document.getElementById('btnmail').style.display = "none";
        document.getElementById('btnmail').disabled = true;
    }
    if (document.getElementById('hidonline').value == "Y")
        document.getElementById('chkonline').disabled = false;
    else
        document.getElementById('chkonline').disabled = true;
    document.getElementById('btnfmg').disabled = true;
    document.getElementById('Button1').disabled = false;
    // document.getElementById('Button1').disabled=true;
    document.getElementById('btnsharing').disabled = false;
    document.getElementById('drpregular').disabled = false;
    document.getElementById('drptranslation').disabled = false;
    document.getElementById('txttranslationdisc').disabled = false;
    document.getElementById('txtpospremdisc').disabled = false;
    document.getElementById('hiddendummycioid').value = "";
    document.getElementById('btnShow').disabled = false;
    document.getElementById('hiddenprevamt').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    document.getElementById('txtMobile').disabled = false;
    document.getElementById('txtMobile').value = "";
    document.getElementById('hiddenprint_rec').value = "";
    document.getElementById('hiddenreceiptno').value = "";
    document.getElementById('chkgstinc').disabled = false;
    modifyMatter = 0;
    document.getElementById('chkholdbill').disabled = false;
    document.getElementById('chkholdbill').checked = false;
    if (document.getElementById('hiddencutofftime').value == "y") {
        var res = Classified_Booking.getCurTime(document.getElementById('hiddencompcode').value);
        var ds = res.value;
        if (ds == null) {
            alert(res.error.description);
            return false;
        }
        if (ds.Tables[0].Rows.length > 0) {
            if (ds.Tables[0].Rows[0].T == "Y") {
                var curdate = document.getElementById('currdate').value;
                var fromdate = "";
                if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                    fromdate = curdate.split('/')[1] + '/' + curdate.split('/')[0] + '/' + curdate.split('/')[2];
                    var fdate = new Date(fromdate);
                    fdate.setDate(fdate.getDate() + 1);
                    document.getElementById('txtdatetime').value = (parseInt(fdate.getDate(), 10)) + '/' + (parseInt(fdate.getMonth(), 10) + 1) + '/' + fdate.getYear();
                }
                else if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                    fromdate = curdate;
                    var fdate = new Date(fromdate);
                    fdate.setDate(fdate.getDate() + 1);
                    document.getElementById('txtdatetime').value = (parseInt(fdate.getMonth(), 10) + 1) + '/' + (parseInt(fdate.getDate(), 10)) + '/' + fdate.getYear();
                }
                else if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
                    fromdate = curdate.split('/')[1] + '/' + curdate.split('/')[2] + '/' + curdate.split('/')[0];
                    var fdate = new Date(fromdate);
                    fdate.setDate(fdate.getDate() + 1);
                    document.getElementById('txtdatetime').value = fdate.getYear() + '/' + (parseInt(fdate.getMonth(), 10) + 1) + '/' + (parseInt(fdate.getDate(), 10));
                }
            }
            else {
                document.getElementById('txtdatetime').value = document.getElementById('currdate').value;
            }
        }
    }
    else {
        document.getElementById('txtdatetime').value = document.getElementById('currdate').value;
    }
    document.getElementById('hiddensavemod').value = "0";

    //bindretainer();
    document.getElementById('chkadon').disabled = false;
    document.getElementById('btnrefid').disabled = false;
    document.getElementById('txtreference').disabled = false;
    document.getElementById('txtRetainercomm').disabled = false;
    document.getElementById('tdchqno').style.display = "none";
    document.getElementById('tdourbank').style.display = "none";
    document.getElementById('tdchqdate').style.display = "none";
    document.getElementById('tdchqamt').style.display = "none";
    document.getElementById('tdbankname').style.display = "none";

    document.getElementById('tdtextchqno').style.display = "none";
    document.getElementById('tdtextourbank').style.display = "none";
    document.getElementById('tdtextchqdate').style.display = "none";
    document.getElementById('tdtextchqamt').style.display = "none";
    document.getElementById('tdtextbankname').style.display = "none";

    document.getElementById('tdcarname').style.display = "none";
    document.getElementById('tdtxtcarname').style.display = "none";
    document.getElementById('tdtype').style.display = "none";
    document.getElementById('tddrptyp').style.display = "none";
    document.getElementById('tdexdat').style.display = "none";

    document.getElementById('tdtxtexdat').style.display = "none";
    document.getElementById('tdcardno').style.display = "none";
    document.getElementById('tdtxtcarno').style.display = "none";

    document.getElementById('txtcardname').value = "";
    document.getElementById('drptype').value = 0;
    document.getElementById('drpmonth').value = 0;
    document.getElementById('drpyear').value = 0;
    document.getElementById('txtcardno').value = "";
    document.getElementById('drpcoutype').disabled = false;
    document.getElementById('txtcouno').disabled = false;
    document.getElementById('txtcouno').value = "";
    document.getElementById('drpcoutype').value = "0";
    document.getElementById('LinkButton1').disabled = false;
    document.getElementById('LinkButton2').disabled = false;
    document.getElementById('LinkButton3').disabled = false;
    document.getElementById('LinkButton4').disabled = false;
    document.getElementById('LinkButton5').disabled = false;
    document.getElementById('LinkButton6').disabled = false;
    document.getElementById('LinkButton7').disabled = false;
    document.getElementById('btnshgrid').disabled = false;
    // btnupload.Enabled = true;
    document.getElementById('drpbooktype').disabled = false;
    document.getElementById('txtciobookid').disabled = true;
    document.getElementById('txtrono').disabled = false;
    document.getElementById('txtrodate').disabled = false;
    document.getElementById('drpbillstatus').disabled = false;
    document.getElementById('drprostatus').disabled = false;
    document.getElementById('txtagency').disabled = false;
    document.getElementById('txtclient').disabled = false;
    document.getElementById('txtclientadd').disabled = false;
    document.getElementById('drpagscode').disabled = false;
    document.getElementById('txtdockitno1').disabled = true;
    document.getElementById('txtexecname').disabled = false;
    document.getElementById('txtexeczone').disabled = false;
    document.getElementById('txtproduct').disabled = false;
    document.getElementById('drpbrand').disabled = false;
    document.getElementById('txtkeyno').disabled = false;
    document.getElementById('txtbillremark').disabled = false;
    document.getElementById('txtprintremark').disabled = false;
    document.getElementById('drppackage').disabled = false;
    document.getElementById('txtinsertion').disabled = false;
    document.getElementById('txtdummydate').disabled = false;
    document.getElementById('txtrevisedate').disabled = false;
    document.getElementById('txtrepeatingdate').disabled = false;
    document.getElementById('drpbooktype').disabled = false;
    document.getElementById('drpadcategory').disabled = false;
    document.getElementById('drpadsubcategory').disabled = false;
    document.getElementById('drpcolor').disabled = false;
    document.getElementById('drpuom').disabled = false;
    document.getElementById('drppageposition').disabled = false;
    document.getElementById('txtratecode').disabled = false;
    document.getElementById('drpscheme').disabled = true;
    document.getElementById('drpcurrency').disabled = false;
    document.getElementById('drprptcurrency').disabled = false;
    document.getElementById('txtagreedrate').disabled = false;
    document.getElementById('txtagreedamt').disabled = false;
    document.getElementById('txtextracharges').disabled = false;
    if (document.getElementById('hidspldisedit').value == "Y") {
        document.getElementById('txtspediscper').disabled = false;
        document.getElementById('txtspedisc').disabled = false;

    }
    else {
        document.getElementById('txtspediscper').disabled = true;
        document.getElementById('txtspedisc').disabled = true;
    }

    if (document.getElementById('hidbackdatereceipt').value == "y")
        document.getElementById('txtdatetime').disabled = false;
    else
        document.getElementById('txtdatetime').disabled = true;
    document.getElementById('txtspacedisc').disabled = false;
    if (document.getElementById('hiddenuomdesc').value == "CD") {
        document.getElementById('txtspadiscper').disabled = false;
    }
    else {
        document.getElementById('txtspadiscper').disabled = true;
    }
    document.getElementById('txtspadiscper').value = "";
    document.getElementById('txtspacedisc').value = "";
    document.getElementById('txtrepeatingdate').disabled = false;
    document.getElementById('drpbillcycle').disabled = false;
    document.getElementById('drprevenue').disabled = false;
    document.getElementById('drpbillstatus').disabled = false;
    document.getElementById('drppaymenttype').disabled = false;
    document.getElementById('txtinvoice').disabled = false;
    document.getElementById('txtvts').disabled = false;
    document.getElementById('txtcirrate').disabled = false;
    document.getElementById('txtciragency').disabled = false;
    document.getElementById('txtciredition').disabled = true;
    document.getElementById('txtbillwidth').disabled = false;
    document.getElementById('txtbillheight').disabled = false;
    document.getElementById('drpbillto').disabled = false;
    if (document.getElementById('hiddeneiitagcomm').value == "N") {
        document.getElementById('txttradedisc').disabled = true;
        document.getElementById('chktrade').disabled = true;
        if (document.getElementById('txtaddagencycommrate') != null) {
            document.getElementById('txtaddagencycommrate').disabled = true;
            document.getElementById('txtaddagencycommrate').value = "";
            document.getElementById('txtaddagencycommrateamt').disabled = true;
            document.getElementById('txtaddagencycommrateamt').value = "";
        }
    }
    else if (document.getElementById('hiddeneiitagcomm').value == "T") {
        document.getElementById('txttradedisc').disabled = false;
        document.getElementById('chktrade').disabled = false;
        if (document.getElementById('txtaddagencycommrate') != null) {
            document.getElementById('txtaddagencycommrate').disabled = true;
            document.getElementById('txtaddagencycommrate').value = "";
            document.getElementById('txtaddagencycommrateamt').disabled = true;
            document.getElementById('txtaddagencycommrateamt').value = "";
        }
    }
    else if (document.getElementById('hiddeneiitagcomm').value == "A") {
        document.getElementById('txttradedisc').disabled = true;
        document.getElementById('chktrade').disabled = true;
        if (document.getElementById('txtaddagencycommrate') != null) {
            document.getElementById('txtaddagencycommrate').disabled = false;
            document.getElementById('txtaddagencycommrate').value = "";
            document.getElementById('txtaddagencycommrateamt').disabled = false;
            document.getElementById('txtaddagencycommrateamt').value = "";
        }
    }
    else {
        document.getElementById('txttradedisc').disabled = false;
        document.getElementById('chktrade').disabled = false;
        if (document.getElementById('txtaddagencycommrate') != null) {
            document.getElementById('txtaddagencycommrate').disabled = false;
            document.getElementById('txtaddagencycommrate').value = "";
            document.getElementById('txtaddagencycommrateamt').disabled = false;
            document.getElementById('txtaddagencycommrateamt').value = "";
        }
    }

    if (document.getElementById('hiddencancelcharge').value == "Y") {
        document.getElementById('chkcanclecharges').disabled = false;
        document.getElementById('chkcanclecharges').checked = false;
    }
    else {
        document.getElementById('chkcanclecharges').disabled = true;
        document.getElementById('chkcanclecharges').checked = false;
    }
    document.getElementById('txtagencyoutstand').disabled = true;
    document.getElementById('txtcardrate').disabled = true;
    document.getElementById('txtcardamt').disabled = true;
    document.getElementById('txtdiscount').disabled = true;
    document.getElementById('txtdiscpre').disabled = true;
    document.getElementById('txtadsize2').disabled = false;
    document.getElementById('txtadsize1').disabled = false;
    if (document.getElementById('hidlineedit').value == "y")
        document.getElementById('txttotalarea').disabled = false;
    document.getElementById('txtbilladdress').disabled = false;
    document.getElementById('drpboxcode').disabled = false;
    document.getElementById('txtboxaddress').disabled = false;
    document.getElementById('txtbillamt').disabled = true;
    document.getElementById('txtgrossamt').disabled = true;
    document.getElementById('drpboxcode').disabled = false;
    document.getElementById('chkage').disabled = false;
    document.getElementById('chkclie').disabled = false;
    document.getElementById('chktfn').disabled = false;
    document.getElementById('txtboxaddress').disabled = false;
    document.getElementById('txtinsertion').disabled = false;
    document.getElementById('txtcolum').disabled = false;
    document.getElementById('txtcardname').disabled = false;
    document.getElementById('drptype').disabled = false;
    document.getElementById('drpmonth').disabled = false;
    document.getElementById('drpyear').disabled = false;
    document.getElementById('txtcardno').disabled = false;
    document.getElementById('txtagencypaymode').disabled = true;
    document.getElementById('btncopy').disabled = false;
    document.getElementById('btnshgrid').disabled = false;
    document.getElementById('btndeal').disabled = false;
    document.getElementById('drpadcat3').disabled = false;
    document.getElementById('drpadcat4').disabled = false;
    document.getElementById('drpadcat3').options.length = 0;
    document.getElementById('drpadcat4').options.length = 0;
    document.getElementById('drpbgcolor').disabled = false;
    document.getElementById('drpadcat5').disabled = false;
    document.getElementById('drpadcat5').options.length = 0;
    document.getElementById('drpbgcolor').value = "0";
    document.getElementById('drpbullet').disabled = false;
    // txtagreedamt.Enabled = false;
    //   txtagreedrate.Enabled = false;
    document.getElementById('drpbullet').value = "0";
    document.getElementById('drpdiscountprem').disabled = false;
    document.getElementById('drpdiscountprem').value = "0";
    //btndel.Enabled = true;
    document.getElementById('drpmatstat').disabled = false;

    document.getElementById('drpretainer').disabled = false;

    document.getElementById('drpmatstat').value = "0";

    document.getElementById('txtcontractname').value = "";
    document.getElementById('txtcontracttype').value = "";
    document.getElementById('txtcardname').value = "";
    document.getElementById('drptype').value = "0";
    document.getElementById('drpmonth').value = "0";
    document.getElementById('drpyear').value = "0";
    document.getElementById('txtcardno').Text = "";
    //////////////////////////////


    //     drpschemepck.SelectedValue = "0";


    //*14Aug* drpretainer.SelectedValue = "0";

    document.getElementById('txtcolum').value = "";

    document.getElementById('txtbillamt').value = "";

    document.getElementById('txtrono').value = "";
    document.getElementById('txtbilladdress').value = "";
    document.getElementById('txtrodate').value = "";
    document.getElementById('txtcreditperiod').value = "";
    document.getElementById('drpbillstatus').value = "0";
    // document.getElementById('drprostatus').value = "0";
    document.getElementById('txtagency').value = "";
    document.getElementById('txtclient').value = "";
    document.getElementById('txtagencyaddress').value = "";
    document.getElementById('txtclientadd').value = "";
    document.getElementById('drpagscode').value = "0";
    document.getElementById('txtdockitno1').value = "";
    document.getElementById('txtexecname').value = "";
    document.getElementById('txtexeczone').value = "";
    document.getElementById('txtproduct').value = "";
    document.getElementById('drpbrand').value = "";
    document.getElementById('txtkeyno').value = "";
    document.getElementById('txtbillremark').value = "";
    document.getElementById('txtprintremark').value = "";
    //  drppackage.SelectedValue = "0";
    document.getElementById('txtinsertion').value = "";
    document.getElementById('txtdummydate').value = "";
    document.getElementById('txtrevisedate').value = "";
    document.getElementById('txtrepeatingdate').value = "";

    document.getElementById('drpadcategory').value = "0";
    document.getElementById('drpadsubcategory').value = "0";
    // document.getElementById('drpcolor').value = "0";
    document.getElementById('drpcolor').selectedIndex = 1;
    if (document.getElementById('drpuom').options.length > 2) {
        document.getElementById('drpuom').selectedIndex = 2;
        gettheuomdesc();
    }
    else
        document.getElementById('drpuom').value = "0";
    document.getElementById('drppageposition').value = "0";


    //txtadsizetypeheight.Text = "";
    //txtadsizetypewidth.Text = "";
    //txtratecode.SelectedValue = "0";
    document.getElementById('txtratecode').value = "0";
    document.getElementById('drpscheme').value = "";
    //   drpschemepck.SelectedValue = "0";
    document.getElementById('drpcurrency').value = "0";
    document.getElementById('drprptcurrency').value = "0";
    document.getElementById('txtagreedrate').value = "";
    document.getElementById('txtagreedamt').value = "";

    document.getElementById('txtextracharges').value = "";
    document.getElementById('txtspedisc').value = "";
    document.getElementById('txtspediscper').value = "";
    //document.getElementById('drpbillcycle').value = "0";
    if (document.getElementById("configclient").value == "RP") {
        if (document.getElementById('drpuom').value == "RO0") {
            document.getElementById('drpbillcycle').value = "6";
        }
        else if (document.getElementById('drpbillcycle').options.length > 1)
            document.getElementById('drpbillcycle').selectedIndex = 1;
        else
            document.getElementById('drpbillcycle').value = "0";
    }
    else {
        if (document.getElementById('drpbillcycle').options.length > 1)
            document.getElementById('drpbillcycle').selectedIndex = 1;
        else
            document.getElementById('drpbillcycle').value = "0";

    }
    // document.getElementById('drprevenue').value = "0";
    //drpbilltype.SelectedValue = "0";
    document.getElementById('drpbillstatus').value = "0";
    //drpbillcurrency.SelectedValue = "0";
    document.getElementById('txtagencypaymode').options.length = 0;
    document.getElementById('drppaymenttype').options.length = 0;
    document.getElementById('txtinvoice').value = "";
    document.getElementById('txtvts').value = "";
    document.getElementById('txtcirrate').value = "";
    document.getElementById('txtciragency').value = "";
    document.getElementById('txtciredition').value = "";
    document.getElementById('txtbillwidth').value = "";
    document.getElementById('txtbillheight').value = "";
    //drpbillto.SelectedValue = "0";
    document.getElementById('drpbillto').options.length = 0;
    document.getElementById('txttradedisc').value = "";
    document.getElementById('txttd').value = "";
    document.getElementById('txtdesignation').value = "";
    document.getElementById('chktrade').checked = true;
    document.getElementById('hiddentradedisc').value = "";
    document.getElementById('txtagencyoutstand').value = "";
    document.getElementById('txtcardrate').value = "";
    document.getElementById('txtcardamt').value = "";
    document.getElementById('txtdiscount').value = "";
    document.getElementById('txtdiscpre').value = "";
    document.getElementById('txtadsize2').value = "";
    document.getElementById('txtadsize1').value = "";
    document.getElementById('txttotalarea').value = "";
    document.getElementById('drpboxcode').value = "0";
    document.getElementById('txtboxno').value = "";
    document.getElementById('txtboxaddress').value = "";
    document.getElementById('chkage').checked = false;
    document.getElementById('chkclie').checked = false;

    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    document.getElementById('drppackage').value = "0";
    document.getElementById('drppackagecopy').options.length = 0;


    document.getElementById('drpboxcode').value = "0";
    document.getElementById('chkage').checked = false;
    document.getElementById('chkclie').checked = false;
    document.getElementById('chktfn').checked = false;

    document.getElementById('txtboxaddress').value = "";
    document.getElementById('txtinsertion').value = "";
    //        document.getElementById('drpbooktype').value = "3";

    document.getElementById('hiddensavemod').value = "0";
    document.getElementById('drpretainer').value = "";
    document.getElementById('ttextchqno').value = "";
    document.getElementById('ttextchqdate').value = "";
    document.getElementById('ttextchqamt').value = "";
    document.getElementById('ttextbankname').value = "";
    document.getElementById('drpourbank').value = "0";
    document.getElementById('ttextchqno').disabled = false;
    document.getElementById('ttextchqdate').disabled = false;
    document.getElementById('ttextchqamt').disabled = false;
    document.getElementById('ttextbankname').disabled = false;
    document.getElementById('drpourbank').disabled = false;
    /////////if 0 than autogenerate the cio booking id and if 1 than autogenerate dockit no.
    //autogenerated("0");
    autogeneratedtempid() // to generate temp booking id

    rownumEx = 0;


    //bindpackage();


    chkstatus(document.getElementById('hiddenbuttonidcheck').value);
    document.getElementById('btnSave').disabled = false;
    document.getElementById('btnNew').disabled = true;
    document.getElementById('btnQuery').disabled = true;

    //drpuom.SelectedValue = Session["uom"].ToString();
    document.getElementById('drpcurrency').value = document.getElementById('hiddencurrency').value;
    document.getElementById('drprptcurrency').value = document.getElementById('hiddencurrency').value;
    // lbmeasure.Text = drpuom.SelectedItem.Text.ToString();
    if (document.getElementById('drpuom').value != '') {
        document.getElementById('lbbilluom').value = document.getElementById('drpuom').options[document.getElementById('drpuom').selectedIndex].text
    }
    if (document.getElementById('lbbilluom').value == "CD") {
        document.getElementById('lbmeasure').value = "CM";
        document.getElementById('lbmeasuretotal').value = "Sq" + "&nbsp;" + "CM";
    }
    else {
        document.getElementById('lbmeasuretotal').value = "";
        document.getElementById('lbmeasure').value = "";
    }
    if (document.getElementById('drprevenue').selectedIndex != "-1") {
        document.getElementById('hiddenbranch').value = document.getElementById('drprevenue').options[document.getElementById('drprevenue').selectedIndex].text; //drprevenue.SelectedItem.Text.ToString();
    }
    document.getElementById('btndel').disabled = false;
    document.getElementById('tblinsert').innerHTML = '';
    document.getElementById('txtagency').focus();
    bindBookType_Agency();
    if (document.getElementById('hdndepo').value == "depo") {


        agencycodeglo = document.getElementById('hdnagencyname').value.substring(document.getElementById('hdnagencyname').value.lastIndexOf('(') + 1, document.getElementById('hdnagencyname').value.lastIndexOf(')'));
        document.getElementById('txtagency').value = document.getElementById('hdnagencyname').value;
        document.getElementById('txtagencyaddress').value = document.getElementById('hdnagencyaddress').value;
        Classified_Booking.bindagencusub(agencycodeglo, document.getElementById('hiddencompcode').value, call_bindagsub);
        document.getElementById('txtagency').disabled = true;
        document.getElementById('txtagencyaddress').disabled = true;
    }
    document.getElementById('drpbooktype').value = "3";
    setButtonImages();
    var obj = document.getElementById('drpbooktype');
    /*  var resType=Classified_Booking.bindAdTypeAgencyWiseXML();
           
    obj.options.length = 0; 
    if(resType!=null && resType.value!="")
    {
            
    var arr=resType.value.split(",");
    obj.options[0]=new Option("Select Booking Type","0");
    for(var i=0;i<arr.length;i++)
    {
    obj.options[obj.options.length] = new Option(arr[i].toString(),arr[parseFloat(i,10)+1].toString());
    i++;
    }
    obj.options[1].selected=true;
    }*/
    if (document.getElementById('hdntxttranslationdisc').value == "show") {
        document.getElementById('txttranslationdisc').disabled = false;
    }
    else {
        document.getElementById('txttranslationdisc').disabled = true;
    }
    if (document.getElementById('hdntxtpospremdisc').value == "show") {
        document.getElementById('txtpospremdisc').disabled = false;
    }
    else {
        document.getElementById('txtpospremdisc').disabled = true;
    }
    if (document.getElementById('hdntxtspediscper').value == "show") {
        document.getElementById('txtspediscper').disabled = false;
    }
    else {
        document.getElementById('txtspediscper').disabled = true;
    }
    if (document.getElementById('hdntxtspacedisc').value == "show") {
        document.getElementById('txtspacedisc').disabled = false;
    }
    else {
        document.getElementById('txtspacedisc').disabled = true;
    }
    if (document.getElementById('hdntxtaddagencycommrate').value == "show") {
        document.getElementById('txtaddagencycommrate').disabled = false;
        document.getElementById('txtaddagencycommrateamt').disabled = false;


    }
    else {
        document.getElementById('txtaddagencycommrate').disabled = true;
        document.getElementById('txtaddagencycommrateamt').disabled = true;
    }
    if (document.getElementById('hdntxtRetainercomm').value == "show") {
        document.getElementById('txtRetainercomm').disabled = false;
    }
    else {
        document.getElementById('txtRetainercomm').disabled = true;
    }
    if (document.getElementById('hdntxtextracharges').value == "show") {
        document.getElementById('txtextracharges').disabled = false;
    }
    else {
        document.getElementById('txtextracharges').disabled = true;
    }
    if (document.getElementById('hdntxtspedisc').value == "show") {
        document.getElementById('txtspedisc').disabled = false;
    }
    else {
        document.getElementById('txtspedisc').disabled = true;
    }
    if (document.getElementById('hdntxtspadiscper').value == "show") {
        document.getElementById('txtspadiscper').disabled = false;
    }
    else {
        document.getElementById('txtspadiscper').disabled = true;
    }
     
    //document.getElementById('txtbranch_name').value = document.getElementById('hdnbbrnch').value;
    bindpackagerevcentwise();
    document.getElementById('txtagency').focus();
     
    return false;
}


function clearonrevenuecent() {
    document.getElementById('multibilling_div').innerHTML = "";
    document.getElementById('multibilling_div').style.display = "none";
    document.getElementById('showteamdiv').innerHTML = "";
    online_flag = false;
    vat_app = 0;
    cioprevgst = "";
    globfromline = "";
    bill_comp_amt = "";
    hdntranschgon = "";
    fixed_booking = "N";
    if (roundoff == "editionwise")
        roundoff = "insertionwise";
    rostatusmain = "";
    agreedrate_active = 0;
    agreedamt_active = 0;
    hiddisctype = "";
    modifydtcount = 1;
    sharepub = "";
    noissueflag = false;
    document.getElementById('chkonline').disabled = true;
    document.getElementById('chkonline').checked = false;
    document.getElementById('hidcurrency_convrate').value = "";
    document.getElementById('hiddenbillamt').value = "";
    document.getElementById('hiddenrateauditflag').value = "";
    document.getElementById('txtagreedrate').className = ' btextforbookrightsmall';
    document.getElementById('txtagreedamt').className = ' btextforbookrightsmall';
    document.getElementById('btnfmg').disabled = true;
    document.getElementById('hiddenagcommflag').value = "";
    document.getElementById('hidattach1').value = "";
    document.getElementById('attachment1').src = "Images/index.jpeg"
    document.getElementById('hidattach2').value = "";
    document.getElementById('attachment2').src = "Images/index.jpeg"
    document.getElementById('txtcashdiscount').value = "";
    document.getElementById('hiddencashrecieved').value = "";
    activeD = "";
    paivar = "";
    hidcopy = "";
    boxpercen = "";
    dateSelected = "";
    monthSelected = "";
    yearSelected = "";
    arrEdition_Item = '';
    schemeid = "";
    chkbtnStatus = "";
    multiselect = "";
    multicode = "";
    filterins = "";
    hideCalendar();
    caldate = null;
    caldate = new Array();
    caldatemonth = null;
    caldatemonth = new Array();
    caldateyear = null;
    caldateyear = new Array();
    if (document.getElementById('regclient').style.display != 'none')
        document.getElementById('regclient').style.display = 'none';

    document.getElementById('lbreference').style.display = "none";
    document.getElementById('tdref').style.display = "none";
    document.getElementById("div2").style.display = "none";
    document.getElementById('txtagaddf2').value = "";
    document.getElementById("div4").style.display = "none";
    document.getElementById('txtcliaddf2').value = "";
    document.getElementById('txtcolexec').value = "";
    //  document.getElementById('btnrefid').style.display="none";
    document.getElementById('lblcreationdatetime').innerHTML = ""
    document.getElementById('drpregular').value = "0";
    document.getElementById('drpregular').disabled = true;
    document.getElementById('drptranslation').value = "0";
    document.getElementById('txttranslationcharges').value = "";
    document.getElementById('txttranslationdisc').value = "";
    document.getElementById('txttranslationdisc').disabled = true;
    document.getElementById('txtpospremdisc').value = "";
    document.getElementById('txtpospremdisc').disabled = true;
    document.getElementById('chkadon').disabled = true;
    document.getElementById('btnrefid').disabled = true;
    document.getElementById('txtreference').disabled = true;
    document.getElementById('txtreference').value = "";
    document.getElementById('chkcanclecharges').disabled = true;
    document.getElementById('txtaudit').value = "";
    document.getElementById('txtappby').value = "";
    document.getElementById('chkadon').checked = false;
    document.getElementById('btnsharing').disabled = true;
    document.getElementById('Button1').disabled = false;
    document.getElementById('hiddendummycioid').value = "";
    if (document.getElementById("divbarter") != null)
        document.getElementById("divbarter").style.display = "none";
    document.getElementById('divcopyinsertion').style.display = "none";
    document.getElementById('hiddenbarteramt').value = '';
    document.getElementById('hiddenstopbarterbooking').value = "";
    document.getElementById('txtbartertype').value = "";
    document.getElementById('drpedition').options.length = 1;
    document.getElementById('TextBox1').value = "";
    document.getElementById("divretainer").style.display = "none";
    document.getElementById('hiddenadscat3').value = "";
    document.getElementById('hiddenadscat4').value = "";
    document.getElementById('hiddenadscat5').value = "";
    document.getElementById('hiddenprevamt').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    document.getElementById('hiddenprint_rec').value = "";
    document.getElementById('hiddenreceiptno').value = "";
    document.getElementById('txtdatetime').value = document.getElementById('currdate').value;
    document.getElementById('txtRetainercomm').disabled = true;
    document.getElementById('txtRetainercommamt').disabled = true;
    document.getElementById('btnShow').disabled = true;
    document.getElementById('txtdatetime').disabled = true;
    document.getElementById('txtMobile').value = "";
    document.getElementById('txtMobile').disabled = true;
    document.getElementById('txtspacedisc').value = "";
    document.getElementById('txtspadiscper').value = "";
    document.getElementById('hiddentradedisc').value = "";
    document.getElementById('retcommtype').value = "";
    document.getElementById('retcomm').value = "";
    document.getElementById('txtbillwidth').value = "";
    document.getElementById('txtbillheight').value = "";
    document.getElementById('showselectedition').style.display = 'none'
    document.getElementById('txtRetainercomm').value = "";
    document.getElementById('txtRetainercommamt').value = "";
    document.getElementById('txtbullprem').value = "";
    document.getElementById('ttextchqno').value = "";
    document.getElementById('ttextchqdate').value = "";
    document.getElementById('ttextchqamt').value = "";
    document.getElementById('ttextbankname').value = "";
    document.getElementById('drpourbank').value = "0";
    document.getElementById('txtcardname').value = "";
    document.getElementById('drptype').value = 0;
    document.getElementById('drpmonth').value = 0;
    document.getElementById('drpyear').value = 0;
    document.getElementById('txtcardno').value = "";
    document.getElementById('hiddenboxchrgtype').value = "";
    document.getElementById('hiddencalendar').value = "0";
    document.getElementById('hiddensavemod').value = "0";
    document.getElementById('LinkButton1').disabled = true;
    document.getElementById('LinkButton2').disabled = true;
    document.getElementById('LinkButton3').disabled = true;
    document.getElementById('LinkButton4').disabled = true;
    document.getElementById('LinkButton5').disabled = true;
    document.getElementById('LinkButton6').disabled = true;
    document.getElementById('LinkButton7').disabled = true;
    document.getElementById('drpretainer').value = "";
    document.getElementById('drpretainer').disabled = true;
    document.getElementById('btnshgrid').disabled = true;
    document.getElementById('txtbillwidth').disabled = true;
    document.getElementById('txtbillheight').disabled = true;
    document.getElementById('drpagscode').options.length = 0;
    // btnupload.Enabled = false;
    document.getElementById('txtbartertype').disabled = true;
    document.getElementById('txtciobookid').disabled = true;
    // txtappby.Enabled = false;
    // txtaudit.Enabled = false;
    document.getElementById('txtrono').disabled = true;
    document.getElementById('txtrodate').disabled = true;
    document.getElementById('chkholdbill').disabled = true;
    document.getElementById('chkholdbill').checked = false;
    document.getElementById('tdchqno').style.display = "none";
    document.getElementById('tdourbank').style.display = "none";
    document.getElementById('tdchqdate').style.display = "none";
    document.getElementById('tdchqamt').style.display = "none";
    document.getElementById('tdbankname').style.display = "none";

    document.getElementById('tdtextchqno').style.display = "none";
    document.getElementById('tdtextourbank').style.display = "none";
    document.getElementById('tdtextchqdate').style.display = "none";
    document.getElementById('tdtextchqamt').style.display = "none";
    document.getElementById('tdtextbankname').style.display = "none";

    document.getElementById('tdcarname').style.display = "none";
    document.getElementById('tdtxtcarname').style.display = "none";
    document.getElementById('tdtype').style.display = "none";
    document.getElementById('tddrptyp').style.display = "none";
    document.getElementById('tdexdat').style.display = "none";

    document.getElementById('tdtxtexdat').style.display = "none";
    document.getElementById('tdcardno').style.display = "none";
    document.getElementById('tdtxtcarno').style.display = "none";
    document.getElementById('txtcardname').value = "";
    document.getElementById('drptype').value = 0;
    document.getElementById('drpmonth').value = 0;
    document.getElementById('drpyear').value = 0;
    document.getElementById('txtcardno').value = "";
    document.getElementById('drpcoutype').disabled = true;
    document.getElementById('txtcouno').disabled = true;
    document.getElementById('txtcouno').value = "";
    document.getElementById('drpcoutype').value = "0";
    document.getElementById('drpbillstatus').disabled = true;
    document.getElementById('drprostatus').disabled = true;
    document.getElementById('txtagency').disabled = true;
    document.getElementById('txtclient').disabled = true;
    document.getElementById('txtagencyaddress').disabled = true;
    document.getElementById('txtclientadd').disabled = true;
    document.getElementById('drpagscode').disabled = true;
    document.getElementById('txtdockitno1').disabled = true;
    document.getElementById('txtexecname').disabled = true;
    document.getElementById('txtexeczone').disabled = true;
    document.getElementById('txtproduct').disabled = false;
    document.getElementById('drpbrand').disabled = true;
    document.getElementById('txtkeyno').disabled = true;
    document.getElementById('txtbillremark').disabled = true;
    document.getElementById('txtprintremark').disabled = true;
    document.getElementById('drppackage').disabled = true;
    document.getElementById('txtinsertion').disabled = true;
    document.getElementById('txtdummydate').disabled = true;
    document.getElementById('txtrevisedate').disabled = true;
    document.getElementById('txtrepeatingdate').disabled = true;
    document.getElementById('drpbooktype').disabled = true;
    document.getElementById('drpadcategory').disabled = true;
    document.getElementById('drpadsubcategory').disabled = true;
    document.getElementById('drpcolor').disabled = true;
    document.getElementById('drpuom').disabled = true;
    document.getElementById('drppageposition').disabled = true;

    // txtadsizetypeheight.Enabled = false;
    //txtadsizetypewidth.Enabled = false;
    document.getElementById('txtratecode').disabled = true;
    document.getElementById('drpscheme').disabled = true;
    //       drpschemepck.Enabled = false;
    document.getElementById('drpcurrency').disabled = true;
    document.getElementById('drprptcurrency').disabled = true;
    document.getElementById('txtagreedrate').disabled = true;
    document.getElementById('txtagreedamt').disabled = true;

    document.getElementById('txtextracharges').disabled = true;
    document.getElementById('txtspedisc').disabled = true;
    document.getElementById('txtspediscper').disabled = true;

    document.getElementById('txtdatetime').disabled = true;
    document.getElementById('txtrepeatingdate').disabled = true;


    document.getElementById('txtadsize1').disabled = true;
    document.getElementById('txtadsize2').disabled = true;
    document.getElementById('txttotalarea').disabled = true;
    document.getElementById('txtcardrate').disabled = true;
    document.getElementById('txtcardamt').disabled = true;
    document.getElementById('txtdiscount').disabled = true;
    document.getElementById('txtdiscpre').disabled = true;
    document.getElementById('txtrepeatingdate').disabled = true;
    document.getElementById('drpbillcycle').disabled = true;
    document.getElementById('drprevenue').disabled = true;
    document.getElementById('drppaymenttype').disabled = true;
    document.getElementById('txtbillheight').disabled = true;
    document.getElementById('txtbillwidth').disabled = true;
    document.getElementById('drpbillto').disabled = true;
    document.getElementById('txtinvoice').disabled = true;
    document.getElementById('txtvts').disabled = true;
    document.getElementById('txtcirrate').disabled = true;
    document.getElementById('txtciragency').disabled = true;
    document.getElementById('txtciredition').disabled = true;
    document.getElementById('txtbilladdress').disabled = true;
    document.getElementById('txttradedisc').disabled = true;
    document.getElementById('chktrade').disabled = true;
    document.getElementById('txtagencyoutstand').disabled = true;


    document.getElementById('drpboxcode').disabled = true;
    document.getElementById('chkage').disabled = true;
    document.getElementById('chkclie').disabled = true;
    document.getElementById('chktfn').disabled = true;

    document.getElementById('txtboxaddress').disabled = true;
    document.getElementById('txtinsertion').disabled = true;

    document.getElementById('txtcolum').disabled = true;


    document.getElementById('txtclientcatdisc').value = "";
    document.getElementById('txtclientcatam').value = "";
    document.getElementById('txtflatfreqdisc').value = "";
    document.getElementById('txtflatfreqamt').value = "";
    document.getElementById('txtcatdisc').value = "";
    document.getElementById('txtcatamt').value = "";
    document.getElementById('hdnclientcatdistype').value = "";
    document.getElementById('hdnflatfreqdisctype').value = "";
    document.getElementById('hdncatdisctype').value = "";
    ///////////////////////
    document.getElementById('txtcontractname').disabled = true;
    document.getElementById('txtcontracttype').disabled = true;
    document.getElementById('txtcardname').disabled = true;
    document.getElementById('drptype').disabled = true;
    document.getElementById('drpmonth').disabled = true;
    document.getElementById('drpyear').disabled = true;
    document.getElementById('txtcardno').disabled = true;
    document.getElementById('btncopy').disabled = true;
    document.getElementById('btndel').disabled = true;

    document.getElementById('drpadcat3').disabled = true;
    document.getElementById('drpadcat4').disabled = true;
    document.getElementById('drpadcat3').options.length = 0;
    document.getElementById('drpadcat4').options.length = 0;

    document.getElementById('drpbgcolor').disabled = true;
    document.getElementById('drpadcat5').disabled = true;

    document.getElementById('drpretainer').disabled = true;

    if (document.getElementById('txtaddagencycommrate') != null) {
        document.getElementById('txtaddagencycommrate').disabled = true;
        document.getElementById('txtaddagencycommrate').value = "";
        document.getElementById('txtaddagencycommrateamt').disabled = true;
        document.getElementById('txtaddagencycommrateamt').value = "";
    }
    document.getElementById('drpadcat5').options.length = 0;
    document.getElementById('drpbgcolor').value = "0";

    document.getElementById('drpbullet').disabled = true;
    document.getElementById('drpbullet').value = "0";
    document.getElementById('drpdiscountprem').disabled = true;
    document.getElementById('drpdiscountprem').value = "0";
    document.getElementById('drpmatstat').disabled = true;
    document.getElementById('drpmatstat').value = "0";

    document.getElementById('txtcontractname').value = "";
    document.getElementById('txtcontracttype').value = "";
    document.getElementById('txtcardname').value = "";
    document.getElementById('drptype').value = "0";
    document.getElementById('drpmonth').value = "0";
    document.getElementById('drpyear').value = "0";
    document.getElementById('txtcardno').value = "";
    //////////////////////////////

    document.getElementById('txtcolum').value = "";

    //*14Aug* drpretainer.SelectedValue = "0";
    document.getElementById('txtciobookid').value = "";
    document.getElementById('txtcreditperiod').value = "";
    // txtappby.Text = "";
    // txtaudit.Text = "";
    document.getElementById('txtrono').value = "";
    document.getElementById('txtrodate').value = "";

    document.getElementById('drpbillstatus').value = "0";
    //  document.getElementById('drprostatus').value = "0";
    document.getElementById('txtagency').value = "";
    document.getElementById('txtclient').value = "";
    document.getElementById('txtagencyaddress').value = "";
    document.getElementById('txtclientadd').value = "";
    document.getElementById('drpagscode').value = "0";
    document.getElementById('txtdockitno1').value = "";
    document.getElementById('txtexecname').value = "";
    document.getElementById('txtexeczone').value = "";
    document.getElementById('txtproduct').value = "";
    document.getElementById('drpbrand').value = "";
    document.getElementById('txtkeyno').value = "";
    document.getElementById('txtbillremark').value = "";
    document.getElementById('txtprintremark').value = "";
    //drppackage.SelectedValue = "0";
    //drppackage.Items.Clear();
    ///////////on the click of clear button bind the grid again to uncheck
    document.getElementById('txtinsertion').value = "";
    document.getElementById('txtdummydate').value = "";
    document.getElementById('txtrevisedate').value = "";
    document.getElementById('txtrepeatingdate').value = "";
    document.getElementById('drpbooktype').value = "0";
    document.getElementById('drpadcategory').value = "0";
    document.getElementById('drpadsubcategory').value = "0";
    document.getElementById('drpcolor').value = "0";
    document.getElementById('drpuom').value = "0";
    document.getElementById('drppageposition').value = "0";

    document.getElementById('txtratecode').value = "0";
    document.getElementById('drpscheme').value = "";
    //   drpschemepck.SelectedValue = "0";
    document.getElementById('drpcurrency').value = "0";
    document.getElementById('drprptcurrency').value = "0";
    document.getElementById('txtagreedrate').value = "";
    document.getElementById('txtagreedamt').value = "";

    document.getElementById('txtextracharges').value = "";
    document.getElementById('txtspedisc').value = "";
    document.getElementById('txtspediscper').value = "";
    document.getElementById('txtagencytype').value = "";
    document.getElementById('txtagencystatus').value = "";
    //txtagencypaymode.Items.Clear();
    document.getElementById('txtagencypaymode').options.length = 0;
    document.getElementById('txtadsize1').value = "";
    document.getElementById('txtadsize2').value = "";
    document.getElementById('txttotalarea').value = "";
    document.getElementById('txtcardrate').value = "";
    document.getElementById('txtcardamt').value = "";
    document.getElementById('txtdiscount').value = "";
    document.getElementById('txtdiscpre').value = "";
    document.getElementById('txtrepeatingdate').value = "";
    document.getElementById('drpbillcycle').value = "0";
    // document.getElementById('drprevenue').value = "0";
    document.getElementById('drppaymenttype').options.length = 0;
    document.getElementById('drpcashrecieved').value = "";
    document.getElementById('txtbillheight').value = "";
    document.getElementById('txtbillwidth').value = "";
    //drpbillto.SelectedValue = "0";
    document.getElementById('drpbillto').options.length = 0;
    document.getElementById('txtinvoice').value = "";
    document.getElementById('txtvts').value = "";
    document.getElementById('txtcirrate').value = "";
    document.getElementById('txtciragency').value = "";
    document.getElementById('txtciredition').value = "";
    document.getElementById('txtbilladdress').value = "";
    document.getElementById('txttradedisc').value = "";
    document.getElementById('txttd').value = "";
    document.getElementById('txtdesignation').value = "";
    document.getElementById('chktrade').checked = true;
    document.getElementById('hiddentradedisc').value = "";
    document.getElementById('txtagencyoutstand').value = "";

    document.getElementById('txtpageamt').value = "";


    document.getElementById('drpboxcode').value = "0";
    document.getElementById('chkage').checked = false;
    document.getElementById('chkclie').checked = false;
    document.getElementById('chktfn').checked = false;

    document.getElementById('txtboxaddress').value = "";
    document.getElementById('txtinsertion').value = "";

    //*14Aug* drpretainer.SelectedValue = "0";

    document.getElementById('drppackage').value = "0";
    document.getElementById('drppackagecopy').options.length = 0;
    document.getElementById('btndel').disabled = true;
    document.getElementById('tblinsert').innerHTML = ''
    document.getElementById('tblrate').style.display = 'none';
    document.getElementById('tblbill').style.display = 'none';
    document.getElementById('addetails').style.display = 'none';
    document.getElementById('pagedetail').style.display = 'none';
    document.getElementById('tblpackage').style.display = 'none';
    document.getElementById('tbbox').style.display = 'none';
    document.getElementById('tbvts').style.display = 'none';
    if (document.getElementById('hiddenrostatus').value == "1") {
        document.getElementById('drprostatus').value = "2";
    }
    else {
        document.getElementById('drprostatus').value = "1";
    }
    disablelistbox();


    // document.getElementById('hiddensavemod').value = "01";

    getbuttoncheck(document.getElementById('hiddenbuttonidcheck').value);
    if (document.getElementById('btnNew').disabled == false) {
        document.getElementById('btnNew').focus();
    }
    var res = Classified_Booking.getPrevBookId();
    if (res.value != null) {
        if (res.value.Tables[0].Rows.length > 0) {
            document.getElementById('txtprevbook').value = res.value.Tables[0].Rows[0].cio_booking_id;
        }
    }
    var res = null;
    res = Classified_Booking.getRev();
    if (res.value != null) {
        document.getElementById('drprevenue').value = res.value;
        document.getElementById('txtbranch').value = res.value;
        document.getElementById('txtbranch_name').value = document.getElementById('hdnbranch_name').value;
        document.getElementById('txtbookedby').value = document.getElementById('hiddenusername').value;
        // document.getElementById('txtbranch').value=document.getElementById('drprevenue').options[document.getElementById('drprevenue').selectedIndex].text;
    }
    res = Classified_Booking.getCen();
    if (res.value != null) {
        document.getElementById('hiddencenter').value = res.value;
    }

    document.getElementById('multibilling_div').innerHTML = "";

    setButtonImages();
    revenueonblrenableasnew();
    document.getElementById('txtagency').focus();
    return false;

}
function bindpackagerevcentwise() {
    res2 = Classified_Booking.bindpackagerevcentwise(document.getElementById('hiddencompcode').value, document.getElementById('hiddenadtype').value, document.getElementById('hdnrevenuecentcd').value);
    var dsexecut = res2.value;
    if (dsexecut == null) {
        alert(res2.error.description);
        return false;
    }
    document.getElementById('drppackage').options.length = 0;
    for (i = 0; i <= dsexecut.Tables[0].Rows.length - 1; i++) {
        if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "") {
            if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "0") {

                var T = dsexecut.Tables[0].Rows[i].Package_Name;
                var V = dsexecut.Tables[0].Rows[i].pck_code;
                document.getElementById('drppackage').options[document.getElementById('drppackage').options.length] = new Option(T, V);
                document.getElementById('drppackage').options.length;
            }
        }
    }
}
function openTempAgencyPopUp() {
    if (document.getElementById('hdntempagcode').value == "") {
        if (document.getElementById('txtciobookid').value != "") {
            popup = window.open("Temp_Agency_Mast.aspx?PrintRevCentName=" + document.getElementById('txtrevenuecenternew').value + "&PrintRevCentCd=" + document.getElementById('hdnrevenuecentcd').value + "&refbookingid=" + document.getElementById('txtciobookid').value + "&refflag=" + "I", "", "Popup", "toolbar=yes,scrollbars=yes,resizable=yes,top=500,left=300,width=2000,height=1600");
            //window.open("Popup.htm", "Popup", "width=300,height=100");
            popup.focus();
        }
    }
    else {
        popup = window.open("Temp_Agency_Mast.aspx?PrintRevCentName=" + document.getElementById('txtrevenuecenternew').value + "&PrintRevCentCd=" + document.getElementById('hdnrevenuecentcd').value + "&refbookingid=" + document.getElementById('txtciobookid').value + "&refflag=" + "E", "", "Popup","toolbar=yes,scrollbars=yes,resizable=yes,top=500,left=300,width=2000,height=1600" );
        //window.open("Popup.htm", "Popup", "width=300,height=100");"toolbar=yes,scrollbars=yes,resizable=yes,top=500,left=500,width=400,height=400"
        popup.focus();
    }
    return false;
}



// for main and sub package

//function bindpackmaingrp() {}

function bindpackmaingrp(event){
   // if (event.keyCode != 113 && event.keyCode != 27) {
    if (event.keyCode == 27) 
    {
        if (document.activeElement.id == "txtpackmaingrp") 
        {
                if (document.getElementById("divpackmgrp").style.display == "block") 
                {
                    document.getElementById("divpackmgrp").style.display = "none"
                    document.getElementById('txtpackmaingrp').value = "";
                    document.getElementById('txtpackmaingrp').focus();
                }
                return false;
        
        }
        else  if (document.activeElement.id == "txtpacksubgrp") 
        {
                 if (document.getElementById("divpacksgrp").style.display == "block") 
                 {
                    document.getElementById("divpacksgrp").style.display = "none"
                    document.getElementById('txtpacksubgrp').value = "";
                    document.getElementById('txtpacksubgrp').focus();
                 }
                 return false;
        
        }
    } 
    else    
    {
        if (document.activeElement.id == "txtpackmaingrp") 
        {
            /*if (document.getElementById('txtpackmaingrp').value == "") {
                if (document.getElementById("divpackmgrp").style.display == "block") {
                    document.getElementById("divpackmgrp").style.display = "none"
                    document.getElementById('txtpackmaingrp').focus();
                    return false;
                }
                return false;
            }*/
            if (event.keyCode == 40) {
                document.getElementById("lstpackmgrp").focus();
                return false;
            }
            else if (event.keyCode == 27) {
                if (document.getElementById("divpackmgrp").style.display == "block") {
                    document.getElementById("divpackmgrp").style.display = "none"
                    document.getElementById('txtpackmaingrp').value = "";
                    document.getElementById('txtpackmaingrp').focus();
                }
                return false;
            }

            document.getElementById("divpackmgrp").style.display = "block";
            aTag = eval(document.getElementById("txtpackmaingrp"))
            var btag;
            var leftpos = 0;
            var toppos = 0;
            do {
                aTag = eval(aTag.offsetParent);
                leftpos += aTag.offsetLeft;
                toppos += aTag.offsetTop;
                btag = eval(aTag)
            } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
            document.getElementById('divpackmgrp').style.top = document.getElementById("txtpackmaingrp").offsetTop + (toppos + 15) + "px";
            document.getElementById('divpackmgrp').style.left = document.getElementById("txtpackmaingrp").offsetLeft + leftpos + "px";
            
            var compcode = document.getElementById('hiddencompcode').value;
            var varpackmaingrpc = document.getElementById('txtpackmaingrp').value;
            var extra1="";
            var extra2="";
            Classified_Booking.bindpackagemaingrp(compcode, "",varpackmaingrpc, extra1,extra2, bindpackagemaingroup_callback);
        }
        else  if (document.activeElement.id == "txtpacksubgrp") 
        {
              /*if (document.getElementById('txtpacksubgrp').value == "") {
                if (document.getElementById("divpacksgrp").style.display == "block") {
                    document.getElementById("divpacksgrp").style.display = "none"
                    document.getElementById('txtpacksubgrp').focus();
                    return false;
                }
                return false;
            }*/
            if (event.keyCode == 40) {
                document.getElementById("lstpacksgrp").focus();
                return false;
            }
            else if (event.keyCode == 27) {
                if (document.getElementById("divpacksgrp").style.display == "block") {
                    document.getElementById("divpacksgrp").style.display = "none"
                    document.getElementById('txtpacksubgrp').value = "";
                    document.getElementById('txtpacksubgrp').focus();
                }
                return false;
            }

            document.getElementById("divpacksgrp").style.display = "block";
            aTag = eval(document.getElementById("txtpacksubgrp"))
            var btag;
            var leftpos = 0;
            var toppos = 0;
            do {
                aTag = eval(aTag.offsetParent);
                leftpos += aTag.offsetLeft;
                toppos += aTag.offsetTop;
                btag = eval(aTag)
            } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
            document.getElementById('divpacksgrp').style.top = document.getElementById("txtpacksubgrp").offsetTop + (toppos + 15) + "px";
            document.getElementById('divpacksgrp').style.left = document.getElementById("txtpacksubgrp").offsetLeft + leftpos + "px";
            
            var compcode = document.getElementById('hiddencompcode').value;
            var varpacksubgrp = document.getElementById('txtpacksubgrp').value;
            var varpackmaingrp = document.getElementById('hdnpackmaingrp').value;
            var extra1="";
            var extra2="";
            Classified_Booking.bindpackagesubgrp(compcode,varpackmaingrp, "",varpacksubgrp, extra1,extra2, bindpackagesubgroup_callback);
        }

    }

}


function bindpackagemaingroup_callback(response) {

    ds = response.value;
    var pkgitem = document.getElementById("lstpackmgrp");
    pkgitem.options.length = 0;
    pkgitem.options[0] = new Option("-Select Group-", "0");
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) 
    {
        //alert(pkgitem.options.length);
        pkgitem.options.length = 1;
        for (var i = 0; i < ds.Tables[0].Rows.length; ++i) 
        {
            //pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].MAIN_GROUP_NAME, ds.Tables[0].Rows[i].MAIN_GROUP_CODE);
             pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].MAIN_GROUP_NAME + '+' + ds.Tables[0].Rows[i].MAIN_GROUP_CODE, ds.Tables[0].Rows[i].MAIN_GROUP_NAME + '+' + ds.Tables[0].Rows[i].MAIN_GROUP_CODE );
            pkgitem.options.length;
        }
    }

    //  document.getElementById('txtclient').value = "";
    //document.getElementById("lstpackmgrp").focus();  //uncomment

    //document.getElementById("lstpackmgrp").value = "0"; //uncomment

    return false;
}

            function insertmaingrp() 
            {
            // alert(event.keyCode);
                if (document.activeElement.id == "lstpackmgrp") 
                {
                    if (document.getElementById('lstpackmgrp').value == "0" || document.getElementById('lstpackmgrp').value == "") 
                    {
                        alert("Please select GROUP");
                        return false;
                    }
                    document.getElementById("divpackmgrp").style.display = "none";
                    var datetime = "";
                    var page = document.getElementById('lstpackmgrp').value;

                    var id = "";
                    var split = page.split("+");
                    var namecode = split[0];
                    var add = split[1];
                    document.getElementById('hdnpackmaingrp').value = add;
                    document.getElementById('txtpackmaingrp').value = namecode;

                return false;
                }
            }



    function bindpackagesubgroup_callback(response) 
    {

        ds = response.value;
        var pkgitem = document.getElementById("lstpacksgrp");
        pkgitem.options.length = 0;
        pkgitem.options[0] = new Option("-Select Sub Group-", "0");
        if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) 
        {
            //alert(pkgitem.options.length);
            pkgitem.options.length = 1;
            for (var i = 0; i < ds.Tables[0].Rows.length; ++i) 
            {
                //pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].SUB_GROUP_NAME, ds.Tables[0].Rows[i].SUB_GROUP_CODE);
                pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].SUB_GROUP_NAME + '+' + ds.Tables[0].Rows[i].SUB_GROUP_CODE, ds.Tables[0].Rows[i].SUB_GROUP_NAME + '+' + ds.Tables[0].Rows[i].SUB_GROUP_CODE );
                pkgitem.options.length;
            }
        }
        return false;
    }


           function insertsubgrp() 
            {
                    if (document.activeElement.id == "lstpacksgrp") 
                    {
                        if (document.getElementById('lstpacksgrp').value == "0"  || document.getElementById('lstpacksgrp').value == "") 
                        {
                            alert("Please select SUB GROUP");
                            return false;
                        }
                        document.getElementById("divpacksgrp").style.display = "none";
                        var datetime = "";
                        var page = document.getElementById('lstpacksgrp').value;

                        var id = "";
                        var split = page.split("+");
                        var namecode = split[0];
                        var add = split[1];
                        document.getElementById('hdnpacksubgrp').value = add;
                        document.getElementById('txtpacksubgrp').value = namecode;

                        if( document.getElementById('hdnpackmaingrp').value != "" ||document.getElementById('hdnpacksubgrp').value!="" ||document.getElementById('hdnpacksubgrp').value!="undefined")
                        {
                            var compcode = document.getElementById('hiddencompcode').value;
                            var varpacksubgrp = document.getElementById('hdnpacksubgrp').value;
                            var varpackmaingrp = document.getElementById('hdnpackmaingrp').value;
                       
                            Classified_Booking.bindpackagegroup(compcode,"CL0" ,"","",varpackmaingrp,varpacksubgrp ,call_fillpackage);
                            //return false;
                        }
                       
                        return false;
                    }
            }





function call_fillpackage(res) {
    var ds = res.value;
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {
        var pkgitem = document.getElementById("drppackage");
        pkgitem.options.length = 0;        pkgitem.options[0] = new Option("-Select Package-", "0");        //alert(pkgitem.options.length);
        pkgitem.options.length = 1;
        
     for (var i = 0; i < ds.Tables[0].Rows.length; ++i) 
     {

                var opt = document.createElement("option");

                document.getElementById("drppackage").options.add(opt);

                opt.text = ds.Tables[0].Rows[i].Package_Name;

                opt.value = ds.Tables[0].Rows[i].pck_code;

            }

    }

}

