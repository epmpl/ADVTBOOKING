var agnf2 = "";
var enLink = "0";
var xmlObj = null;
var browser = navigator.appName;
var roundoff = "";
fixed_booking = "N";
var arrEdition_Item = '';
var idnew = 0;
var spdisc = 0;
var spdiscper = 0;
var repeatdate = "0";
var agreedrate_active = 0;
var agreedamt_active = 0;
var boxpercen = "";
var browserversion = msieversion();
var cardid;
var billrate = "";
var sharepub = "";
var rostatusmain = "";
var flag = 0;

function msieversion() {
    var ua = window.navigator.userAgent
    var msie = ua.indexOf("MSIE ")

    if (msie > 0)      // If Internet Explorer, return version number
        return parseInt(ua.substring(msie + 5, ua.indexOf(".", msie)))
    else                 // If another browser, return 0
        return 0

}

function loadXML(xmlFile) {
    var httpRequest = null;

    if (browser != "Microsoft Internet Explorer") {

        req = new XMLHttpRequest();
        //alert(req);
        req.onreadystatechange = getMessage;
        req.open("GET", xmlFile, true);
        req.send('');

    }
    else {
        xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
        xmlDoc.async = "false";
        xmlDoc.onreadystatechange = verify;
        xmlDoc.load(xmlFile);
        xmlObj = xmlDoc.documentElement;
     
    }

}

function getMessage() {
    var response = "";
    if (req.readyState == 4) {
        if (req.status == 200) {
            response = req.responseText;
        }
    }

    var parser = new DOMParser();
    xmlDoc = parser.parseFromString(response, "text/xml");
    xmlObj = xmlDoc.documentElement;
}
loadXML('xml/billcycle.xml');

function verify() {
  
    if (xmlDoc.readyState != 4) {
        return false;
    }
}



function blankfields() {

    document.getElementById('txtagency').disabled = true;
    document.getElementById('txtagencyaddress').disabled = true;
    document.getElementById('drpagscode').disabled = true;
    document.getElementById('txtagencystatus').disabled = true;
    document.getElementById('txtcreditperiod').disabled = true;
    document.getElementById('txtrodate').disabled = true;
    document.getElementById('txtdockitno1').disabled = true;
    document.getElementById('txtexecname').disabled = true;
    document.getElementById('txtagencyoutstand').disabled = true;
    document.getElementById('txtclient').disabled = true;
    document.getElementById('txtclientadd').disabled = true;
    document.getElementById('txtmobile').disabled = true;
    document.getElementById('txtagencypaymode').disabled = true;
    document.getElementById('txtrono').disabled = true;
    document.getElementById('drprostatus').disabled = true;
    document.getElementById('txtkeyno').disabled = true;
    document.getElementById('txtexeczone').disabled = true;
    document.getElementById('drpretainer').disabled = true;
    document.getElementById('btnExecute').disabled = true;
    setButtonImages();

    return false;
}



function clearClick() {

    f1 = 0;
    vat_app = 0;
    if (roundoff == "editionwise")
        roundoff = "insertionwise";
    cali = 0;
    agreedrate_active = 0;
    agreedamt_active = 0;
    boxstatus = "";
    sharepub = "";
    pgposprem = "";
    hiddisctype = "";
    document.getElementById('hidcurrency_convrate').value = "";
    document.getElementById('txtreference').value = "";
    document.getElementById('hiddenbillamt').value = "";
    document.getElementById('txtagreedrate').className = ' btextforbookrightsmall';
    document.getElementById('txtagreedamt').className = ' btextforbookrightsmall';
    document.getElementById('hiddenrateauditflag').value = "";
    rostatusmain = "";
    document.getElementById('hiddenagcommflag').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    hidcopy = "";
    schemeid = "";
    activeD = "";
    filterins = "";
   // document.getElementById('txtappby').value = "";anuj
    //document.getElementById('txtaudit').value = "";
    if (document.getElementById('regclient').style.display != 'none')
        document.getElementById('regclient').style.display = 'none';

    //credit info
    chkbtnStatus = "";
    hideCalendar();
    
    caldate = null;
    caldate = new Array();
    caldatemonth = null;
    caldatemonth = new Array();
    caldateyear = null;
    caldateyear = new Array();
    
    document.getElementById('lbreference').style.display = "none";
    document.getElementById('tdref').style.display = "none";
    document.getElementById("div2").style.display = "none";
    document.getElementById('txtagaddf2').value = "";
    //   document.getElementById('btnrefid').style.display="none";
   // document.getElementById('drpregular').value = "0";
    //document.getElementById('drpregular').disabled = true;
    //document.getElementById('drptranslation').value = "0";
    //document.getElementById('txttranslationcharges').value = "";
    document.getElementById('txttranslationdisc').value = "";
    document.getElementById('txttranslationdisc').disabled = true;
    document.getElementById('txtpospremdisc').value = "";
    document.getElementById('txtpospremdisc').disabled = true;
    document.getElementById('txtreference').disabled = true;
    //document.getElementById('txtpremper').disabled = true;
    //document.getElementById('chkDealerPanel').disabled = true;
    //document.getElementById('chkDealerPanel').checked = false;
    document.getElementById('btnfmg').disabled = true;
    //document.getElementById('btnsharing').disabled = true;
    document.getElementById('chkholdbill').disabled = true;
    document.getElementById('chkholdbill').checked = false;
    //document.getElementById('txtcashdiscount').value = "";
    document.getElementById('hiddencashrecieved').value = "";
    //document.getElementById('hidattach1').value = "";
    document.getElementById('attachment1').src = "Images/index.jpeg"
    //document.getElementById('hidattach2').value = "";
    document.getElementById('attachment2').src = "Images/index.jpeg"
    //document.getElementById('drpedition').options.length = 1;
    //document.getElementById('drpinsertion').options.length = 1;
    document.getElementById('hiddenbarteramt').value = '';
    document.getElementById('hiddenstopbarterbooking').value = "";
    document.getElementById('divcopyinsertion').style.display = "none";
    //document.getElementById('txtbartertype').value = "";
    document.getElementById('chkcontract').disabled = true;
    document.getElementById('Button1').disabled = true;
    document.getElementById('chkcontract').checked = false;
    //document.getElementById('lblcreationdatetime').innerHTML = ""
    document.getElementById('hiddencirpub').value = '';
    document.getElementById('hiddenciredi').value = '';
   // document.getElementById('btnRefresh').disabled = true;
    //document.getElementById('btnPaginate').disabled = true;
   // document.getElementById('btnSpaceCheck').disabled = true;
   // document.getElementById('btnPreference').disabled = true;
    //document.getElementById('btnsavepaginate').disabled = true;
   
    document.getElementById('txtdatetime').disabled = true;
   document.getElementById('txtmobile').value = "";
   document.getElementById('txtmobile').disabled = true;
    if (document.getElementById("divreference") != null)
        document.getElementById("divreference").style.display = "none";
    if (document.getElementById("divbarter") != null)
        document.getElementById("divbarter").style.display = "none";
    if (document.getElementById("divspace") != null)
        document.getElementById("divspace").style.display = "none";
    if (document.getElementById('Panel1') != null)
        document.getElementById('Panel1').innerHTML = '<DIV id=Divn1 style=\"BORDER-RIGHT: thin groove; BORDER-TOP: thin groove; FONT-SIZE: 6pt; VISIBILITY: hidden; BORDER-LEFT: thin groove; WIDTH: 60px; BORDER-BOTTOM: thin groove; POSITION: absolute; HEIGHT: 80px\"><IMG class=drag id=Image1 style=\"BORDER-RIGHT: 1px solid; BORDER-TOP: 1px solid; VISIBILITY: hidden; BORDER-LEFT: 1px solid; BORDER-BOTTOM: 1px solid\" src=\"\"> </DIV><DIV id=Divpg1 style=\"BORDER-RIGHT: thin groove; BORDER-TOP: thin groove; FONT-SIZE: 8pt; LEFT: 14px; VISIBILITY: hidden; BORDER-LEFT: thin groove; WIDTH: 20px; BORDER-BOTTOM: thin groove; POSITION: absolute; TOP: 46px; HEIGHT: 10px\"></DIV>';
    multiselect = "";
    multicode = "";
    arrEdition_Item = '';

  
    document.getElementById('hiddenprevamt').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('hiddenprint_rec').value = "";
   // document.getElementById('txtdatetime').value = document.getElementById('currdate').value;
    document.getElementById('txtpageamt').value = "";
    document.getElementById('hiddenreceiptno').value = "";
    document.getElementById('hiddentradedisc').value = "";
    document.getElementById('retcommtype').value = "";
    document.getElementById('retcomm').value = "";
    if (document.getElementById('txtaddagencycommrateamt') != null)
        document.getElementById('txtaddagencycommrateamt').disabled = true;
    document.getElementById('txtRetainercomm').disabled = true;
    document.getElementById('txtRetainercommamt').value = "";
    document.getElementById('txtRetainercomm').value = "";
    document.getElementById('showselectedition').style.display = 'none'
   
    //document.getElementById('ttextchqno').value = "";
    //document.getElementById('drpourbank').value = "0";
    //document.getElementById('ttextchqdate').value = "";
    //document.getElementById('ttextchqamt').value = "";
    //document.getElementById('ttextbankname').value = "";
    document.getElementById('hiddenboxchrgtype').value = "";
   // document.getElementById('txtcardname').value = "";
   // document.getElementById('drptype').value = 0;
    //document.getElementById('drpmonth').value = 0;
   // document.getElementById('drpyear').value = 0;
   // document.getElementById('txtcardno').value = "";
    document.getElementById('chkcanclecharges').disabled = true;
    document.getElementById('drpagscode').options.length = 0;
    //document.getElementById('tdcarname').style.display = "none";
    //document.getElementById('tdtxtcarname').style.display = "none";
    //document.getElementById('tdtype').style.display = "none";
    //document.getElementById('tddrptyp').style.display = "none";
    //document.getElementById('tdexdat').style.display = "none";

    //document.getElementById('tdtxtexdat').style.display = "none";
    //document.getElementById('tdcardno').style.display = "none";
    //document.getElementById('tdtxtcarno').style.display = "none";

    //document.getElementById('txtcardname').value = "";
    //document.getElementById('drptype').value = 0;
    //document.getElementById('drpmonth').value = 0;
    //document.getElementById('drpyear').value = 0;
    //document.getElementById('txtcardno').value = "";
    document.getElementById('txtagency').style.backgroundColor = "#FFFFFF";
    //document.getElementById('hiddencalendar').value = "0";
    document.getElementById('hiddensavemod').value = "0";
    document.getElementById('LinkButton1').disabled = true;
    document.getElementById('LinkButton2').disabled = true;
    document.getElementById('LinkButton3').disabled = true;
    document.getElementById('LinkButton4').disabled = true;
    document.getElementById('LinkButton5').disabled = true;
//    document.getElementById('LinkButton6').disabled = true;
//    document.getElementById('LinkButton7').disabled = true;
    document.getElementById('drpretainer').value = "";
    document.getElementById('drpretainer').disabled = true;
    document.getElementById('btnshgrid').disabled = true;

    document.getElementById('txtciobookid').disabled = true;
    if (document.getElementById('hiddenaddAgencyComm').value == "Y") {
        document.getElementById('txtaddagencycommrate').disabled = false;
        if (document.getElementById('txtaddagencycommrateamt') != null)
            document.getElementById('txtaddagencycommrateamt').disabled = false;
    }
   // document.getElementById('txtpageno').disabled = true;
    //document.getElementById('drppagetype').disabled = true;
    document.getElementById('txtrono').disabled = true;
    document.getElementById('txtrodate').disabled = true;
    //document.getElementById('txtcaption').disabled == true;
   // document.getElementById('txtcaption').value = "";
   // document.getElementById('drpbillstatus').disabled = true;
    document.getElementById('drprostatus').disabled = true;
    document.getElementById('txtagency').disabled = true;
    document.getElementById('txtclient').disabled = true;
    document.getElementById('txtagencyaddress').disabled = true;
    document.getElementById('txtclientadd').disabled = true;
  
    document.getElementById('drpagscode').disabled = true;
    document.getElementById('txtdockitno1').disabled = true;
    document.getElementById('txtexecname').disabled = true;
    document.getElementById('txtexeczone').disabled = true;
    //document.getElementById('txtproduct').disabled = false;
   // document.getElementById('drpbrand').disabled = true;
    document.getElementById('txtkeyno').disabled = true;
    document.getElementById('txtbillremark').disabled = true;
    document.getElementById('txtprintremark').disabled = true;
    document.getElementById('drppackage').disabled = true;
    document.getElementById('txtinsertion').disabled = true;
    document.getElementById('txtdummydate').disabled = true;
    document.getElementById('txtrevisedate').disabled = true;
    document.getElementById('txtrepeatingdate').disabled = true;
    document.getElementById('drpbooktype').disabled = true;
    document.getElementById('txtcategory').disabled = false;
   // document.getElementById('drpadsubcategory').disabled = true;
   // document.getElementById('drpcolor').disabled = true;
    document.getElementById('drpuom').disabled = true;
    document.getElementById('drpposition').disabled = true;
    //document.getElementById('drpdiscountprem').disabled = true;
    // txtadsizetypeheight.Enabled = false;
    //txtadsizetypewidth.Enabled = false;
    document.getElementById('txtratecode').disabled = true;
    document.getElementById('drpscheme').disabled = true;
    //       drpschemepck.Enabled = false;
    document.getElementById('drpcurrency').disabled = true;
    document.getElementById('drprptcurrency').disabled = true;
    document.getElementById('txtagreedrate').disabled = true;
    document.getElementById('txtagreedamt').disabled = true;

    document.getElementById('txtextracharges').disabled = true;
    document.getElementById('txtdatetime').disabled = true;
    document.getElementById('txtrepeatingdate').disabled = true;

   // document.getElementById('txtadsize1').disabled = true;
   // document.getElementById('txtadsize2').disabled = true;
    //document.getElementById('txtadsize1dealer').disabled = true;
    //document.getElementById('txtadsize2dealer').disabled = true;
    //document.getElementById('drpdealertype').disabled = true;
    //document.getElementById('txtadsize1dealer').value = "";
    //document.getElementById('txtadsize2dealer').value = "";
    //document.getElementById('drpdealertype').selectedIndex = 0;
    document.getElementById('txttotalarea').disabled = true;
    document.getElementById('txtcardrate').disabled = true;
    document.getElementById('txtcardamt').disabled = true;
    document.getElementById('txtdiscount').disabled = true;
    document.getElementById('txtdiscpre').disabled = true;
    document.getElementById('txtrepeatingdate').disabled = true;
    document.getElementById('drpbillcycle').disabled = true;
    document.getElementById('drprevenue').disabled = true;
    document.getElementById('drppaymenttype').disabled = true;
    document.getElementById('txtbillheight').disabled = true;
    document.getElementById('txtbillwidth').disabled = true;
    document.getElementById('drpbillto').disabled = true;
    document.getElementById('txtinvoice').disabled = true;
    document.getElementById('txtvts').disabled = true;
    document.getElementById('txtcirrate').disabled = true;
    //document.getElementById('txtbartertype').disabled = true;
    document.getElementById('txtciragency').disabled = true;
    document.getElementById('txtciredition').disabled = true;
    document.getElementById('txtbilladdress').disabled = true;
    document.getElementById('txttradedisc').disabled = true;
    document.getElementById('chktrade').disabled = true;
    document.getElementById('chktrade').disabled = true;
    document.getElementById('txtagencyoutstand').disabled = true;

    document.getElementById('drpboxcode').disabled = true;
    document.getElementById('chkage').disabled = true;
    document.getElementById('chkclie').disabled = true;
    document.getElementById('chktfn').disabled = true;
    document.getElementById('chkadon').disabled = true;
    document.getElementById('btnrefid').disabled = true;

    document.getElementById('txtboxaddress').disabled = true;
    document.getElementById('txtinsertion').disabled = true;

    //document.getElementById('txtcolum').disabled = true;

    ///////////////////////
    document.getElementById('txtcontractname').disabled = true;
    document.getElementById('txtcontracttype').disabled = true;
    //document.getElementById('txtcardname').disabled = true;
    //document.getElementById('drptype').disabled = true;
  //  document.getElementById('drpmonth').disabled = true;
    //document.getElementById('drpyear').disabled = true;
    //document.getElementById('txtcardno').disabled = true;
    document.getElementById('btncopy').disabled = true;
    document.getElementById('btndel').disabled = true;

    //document.getElementById('drpadcat3').disabled = true;
    //document.getElementById('drpadcat4').disabled = true;
    //document.getElementById('drpadcat3').options.length = 0;
    //document.getElementById('drpadcat4').options.length = 0;

    //document.getElementById('drpadcat5').disabled = true;
    document.getElementById('drpretainer').disabled = true;
    if (document.getElementById('txtaddagencycommrate') != null) {
        document.getElementById('txtaddagencycommrate').disabled = true;
        document.getElementById('txtaddagencycommrate').value = "";
    }
    if (document.getElementById('txtaddagencycommrateamt') != null) {
        document.getElementById('txtaddagencycommrateamt').disabled = true;
        document.getElementById('txtaddagencycommrateamt').value = "";
    }
    //document.getElementById('drpadcat5').options.length = 0;

    ////        document.getElementById('drpbgcolor').disabled = true;
    ////        document.getElementById('drpbgcolor').value = "0";
    ////        document.getElementById('drpbullet').disabled = true;
    ////        document.getElementById('drpbullet').value = "0";

    //document.getElementById('drpmatsta').disabled = true;
    //document.getElementById('drpmatsta').value = "0";

    document.getElementById('txtcontractname').value = "";
    hidcontract = "";
    document.getElementById('txtcontracttype').value = "";
    //document.getElementById('txtcardname').value = "";
    //document.getElementById('drptype').value = "0";
    //document.getElementById('drpmonth').value = "0";
    //document.getElementById('drpyear').value = "0";
    //document.getElementById('txtcardno').value = "";
    //////////////////////////////

    //document.getElementById('txtcolum').value = "";

    document.getElementById('txtciobookid').value = "";
    document.getElementById('txtrono').value = "";
    document.getElementById('txtrodate').value = "";

    document.getElementById('drpbillstatus').value = "0";
    document.getElementById('drprostatus').value = "0";
    document.getElementById('txtagency').value = "";
    document.getElementById('txtclient').value = "";
    document.getElementById('txtagencyaddress').value = "";
    document.getElementById('txtclientadd').value = "";
    document.getElementById('drpagscode').value = "0";
    document.getElementById('txtdockitno1').value = "";
    document.getElementById('txtexecname').value = "";
    document.getElementById('txtexeczone').value = "";
    ////document.getElementById('txtproduct').value = "";
    //document.getElementById('drpbrand').value = "0";
    document.getElementById('txtkeyno').value = "";
    document.getElementById('txtbillremark').value = "";
    document.getElementById('txtprintremark').value = "";
    document.getElementById('txtcreditperiod').value = "";
    //drppackage.SelectedValue = "0";
    //drppackage.Items.Clear();
    ///////////on the click of clear button bind the grid again to uncheck
    document.getElementById('txtinsertion').value = "";
    document.getElementById('txtdummydate').value = "";
    document.getElementById('txtrevisedate').value = "";
    document.getElementById('txtrepeatingdate').value = "";
    document.getElementById('drpbooktype').value = "0";
   // document.getElementById('txtcategory').value = "0";
    //document.getElementById('drpadsubcategory').value = "0";
    //document.getElementById('drpcolor').value = "0";
    if (document.getElementById('drpuom').options.length > 1)
        document.getElementById('drpuom').selectedIndex = "1";
    else
        document.getElementById('drpuom').value = "0";
    document.getElementById('drpposition').value = "0";
    //document.getElementById('drpdiscountprem').value = "0";
    document.getElementById('txtratecode').value = "0";
    document.getElementById('drpscheme').value = "";
    //   drpschemepck.SelectedValue = "0";
    document.getElementById('drpcurrency').value = "0";
    document.getElementById('drprptcurrency').value = "0";
    document.getElementById('txtagreedrate').value = "";
    document.getElementById('txtagreedamt').value = "";

    document.getElementById('txtextracharges').value = "";

    //document.getElementById('txtagencytype').value = "";
    document.getElementById('txtagencystatus').value = "";
    //txtagencypaymode.Items.Clear();
    document.getElementById('txtagencypaymode').options.length = 0;
    //document.getElementById('txtadsize1').value = "";
    //document.getElementById('txtadsize2').value = "";
    document.getElementById('txttotalarea').value = "";
    document.getElementById('txtcardrate').value = "";
    document.getElementById('txtcardamt').value = "";
    document.getElementById('txtdiscount').value = "";
    document.getElementById('txtdiscpre').value = "";
    document.getElementById('txtrepeatingdate').value = "";
    document.getElementById('drpbillcycle').value = "0";
    //document.getElementById('drprevenue').value = "0";
    document.getElementById('drppaymenttype').options.length = 0;
    //document.getElementById('drpcashrecieved').value = "";
    document.getElementById('txtbillheight').value = "";
    ///document.getElementById('txtbillwidth').value = "";
    //drpbillto.SelectedValue = "0";
    document.getElementById('drpbillto').options.length = 0;
    document.getElementById('txtinvoice').value = "";
    document.getElementById('txtvts').value = "";
    document.getElementById('txtcirrate').value = "";
    //document.getElementById('txtbartertype').value = "";
    //document.getElementById('hiddenbarteramt').value = "";
    //document.getElementById('hiddenstopbarterbooking').value = "";
    document.getElementById('txtciredition').value = "";
    //document.getElementById('txtciragency').value = "";
    document.getElementById('txtbilladdress').value = "";
    document.getElementById('txttradedisc').value = "";
    document.getElementById('chktrade').checked = true;
    document.getElementById('txtagencyoutstand').value = "";

    document.getElementById('txtpageamt').value = "";

    document.getElementById('drpboxcode').value = "0";
    document.getElementById('chkage').checked = false;
    document.getElementById('chkclie').checked = false;
    document.getElementById('chktfn').checked = false;
    document.getElementById('chkadon').checked = false;
    document.getElementById('txtboxaddress').value = "";
    document.getElementById('txtinsertion').value = "";
    //document.getElementById('hiddenboxno').value = "";

    //*14Aug* drpretainer.SelectedValue = "0";

    document.getElementById('drppackage').value = "0";
    document.getElementById('drppackagecopy').options.length = 0;
    document.getElementById('btndel').disabled = true;
    document.getElementById('tblinsert').innerHTML = ''
    document.getElementById('tblrate').style.display = 'none';
    document.getElementById('tblbill').style.display = 'none';
    document.getElementById('addetails').style.display = 'none';
    document.getElementById('pagedetail').style.display = 'none';
    document.getElementById('tblpackage').style.display = 'none';
    document.getElementById('tbbox').style.display = 'none';
 

    document.getElementById('hiddensavemod').value = "01";
    getbuttoncheck(document.getElementById('hiddenbuttonidcheck').value);
    if (document.getElementById('btnNew').disabled == false) {
        document.getElementById('btnNew').focus();
    }

    var res = web_booking.getPrevBookId();
    if (res.value != null) {
        if (res.value.Tables[0].Rows.length > 0) {
            document.getElementById('txtprevbook').value = res.value.Tables[0].Rows[0].cio_booking_id;
        }
    }
    var res = null;
    res = web_booking.getRev();
    if (res.value != null) {
        document.getElementById('drprevenue').value = res.value;
        //document.getElementById('txtbranch').value = res.value;
        //document.getElementById('txtbranch_name').value = document.getElementById('hdnbranch_name').value;
        document.getElementById('txtbookedby').value = document.getElementById('hiddenusername').value;
        //document.getElementById('txtbranch').value=document.getElementById('drprevenue').options[document.getElementById('drprevenue').selectedIndex].text;
    }
    res = web_booking.getCen();
    if (res.value != null) {
        document.getElementById('hiddencenter').value = res.value;
    }
 
    disablelistbox();
    setButtonImages();
    
    return false;
}


function newclick() {
    var msg = checkSession();

        if (msg == false) {
        window.location.href = "login.aspx";
        return false;
    }
    clearClick();
    enLink = "1";
    cali = 0;
    boxstatus = "";
    schemeid = "";
    chkbtnStatus = "new";
    if (document.getElementById('hidpremedit').value == 'Y')
       // document.getElementById('txtpremper').disabled = false;
   // else
        //document.getElementById('txtpremper').disabled = true;
    document.getElementById('txttranslationdisc').disabled = false;
    document.getElementById('txtpospremdisc').disabled = false;
    document.getElementById('btnfmg').disabled = true;
    document.getElementById('Button1').disabled = false;
    document.getElementById('txtreference').disabled = false;
    document.getElementById('chkcontract').disabled = false;


    document.getElementById('drpposition').disabled = false;

    document.getElementById('txtmobile').disabled = false;
    document.getElementById('txtmobile').value = "";
    document.getElementById('hiddenprevamt').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    document.getElementById('txtreceipt').value = "";
    document.getElementById('hiddenprint_rec').value = "";
    document.getElementById('hiddenreceiptno').value = "";
    document.getElementById('hiddensavemod').value = "0";
    if (document.getElementById('hiddencutofftime').value == "y") {
        var res = web_booking.getCurTime(document.getElementById('hiddencompcode').value);
        var ds = res.value;
        if (ds == null) {
            alert(res.error.description);
            return false;
        }
        if (ds.Tables[0].Rows.length > 0) {
            if (ds.Tables[0].Rows[0].T == "Y") {
                var curdate = document.getElementById('currdate').value;
                var fromdate = "";
                if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                    fromdate = curdate.split('/')[1] + '/' + curdate.split('/')[0] + '/' + curdate.split('/')[2];
                    var fdate = new Date(fromdate);
                    fdate.setDate(fdate.getDate() + 1);
                    document.getElementById('txtdatetime').value = (fdate.getDate()) + '/' + (parseInt(fdate.getMonth(), 10) + 1) + '/' + fdate.getYear();
                }
                else if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                    fromdate = curdate;
                    var fdate = new Date(fromdate);
                    fdate.setDate(fdate.getDate() + 1);
                    document.getElementById('txtdatetime').value = (parseInt(fdate.getMonth(), 10) + 1) + '/' + (fdate.getDate()) + '/' + fdate.getYear();
                }
                else if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
                    fromdate = curdate.split('/')[1] + '/' + curdate.split('/')[2] + '/' + curdate.split('/')[0];
                    var fdate = new Date(fromdate);
                    fdate.setDate(fdate.getDate() + 1);
                    document.getElementById('txtdatetime').value = fdate.getYear() + '/' + (parseInt(fdate.getMonth(), 10) + 1) + '/' + (fdate.getDate());
                }
            }
            else {
                document.getElementById('txtdatetime').value = document.getElementById('currdate').value;
            }
        }
    }
    else {
        document.getElementById('txtdatetime').value = document.getElementById('currdate').value;
    }
    document.getElementById('LinkButton1').disabled = false;
    document.getElementById('LinkButton2').disabled = false;
    document.getElementById('LinkButton3').disabled = false;
    document.getElementById('LinkButton4').disabled = false;
    document.getElementById('LinkButton5').disabled = false;

    document.getElementById('btnshgrid').disabled = false;

    document.getElementById('drpbooktype').disabled = false;
    document.getElementById('txtciobookid').disabled = true;
    document.getElementById('txtrono').disabled = false;
    document.getElementById('txtrodate').disabled = false;
    document.getElementById('drpbillstatus').disabled = false;
    document.getElementById('drprostatus').disabled = false;
    document.getElementById('txtagency').disabled = false;
    document.getElementById('txtclient').disabled = false;
    if (document.getElementById('hiddenaddAgencyComm').value == "Y" && document.getElementById('txtaddagencycommrate') != null) {
        document.getElementById('txtaddagencycommrate').disabled = false;
        if (document.getElementById('txtaddagencycommrateamt') != null)
            document.getElementById('txtaddagencycommrateamt').disabled = false;
    }
    document.getElementById('txtRetainercomm').disabled = false;
    
    document.getElementById('txtspediscper').value = "";
    document.getElementById('txtspacedisc').disabled = false;
    document.getElementById('txtspadiscper').disabled = false;
    document.getElementById('txtspadiscper').value = "";

    document.getElementById('drppageprem').disabled = false;
    document.getElementById('drppageprem').value = "0";

    document.getElementById('txtclientadd').disabled = false;
    document.getElementById('drpagscode').disabled = false;
    document.getElementById('txtdockitno1').disabled = true;
    document.getElementById('txtexecname').disabled = false;
    document.getElementById('txtexeczone').disabled = false;

    document.getElementById('txtkeyno').disabled = false;
    document.getElementById('txtbillremark').disabled = false;
    document.getElementById('txtprintremark').disabled = false;
    document.getElementById('drppackage').disabled = false;
    document.getElementById('txtinsertion').disabled = false;
    document.getElementById('txtdummydate').disabled = false;
    document.getElementById('txtrevisedate').disabled = false;
    document.getElementById('txtrepeatingdate').disabled = false;
    document.getElementById('drpbooktype').disabled = false;
    document.getElementById('drpuom').disabled = false;
    document.getElementById('txtratecode').disabled = false;
    document.getElementById('drpscheme').disabled = false;
    document.getElementById('drpcurrency').disabled = false;
    document.getElementById('drprptcurrency').disabled = false;
    document.getElementById('txtagreedrate').disabled = false;
    document.getElementById('txtagreedamt').disabled = false;
    document.getElementById('txtextracharges').disabled = false;
    if (document.getElementById('hidbackdatereceipt').value == "y")
        document.getElementById('txtdatetime').disabled = false;
    else
        document.getElementById('txtdatetime').disabled = true;
    document.getElementById('txtrepeatingdate').disabled = false;
    document.getElementById('drpbillcycle').disabled = false;
    document.getElementById('drprevenue').disabled = false;
    document.getElementById('drpbillstatus').disabled = false;
    document.getElementById('drppaymenttype').disabled = false;
    document.getElementById('txtinvoice').disabled = false;
    document.getElementById('txtvts').disabled = false;
    document.getElementById('txtcirrate').disabled = false;
    document.getElementById('txtciragency').disabled = false;
    document.getElementById('txtciredition').disabled = true;
    document.getElementById('txtbillwidth').disabled = false;
    document.getElementById('txtbillheight').disabled = false;
    document.getElementById('drpbillto').disabled = false;
    if (document.getElementById('hiddeneiitagcomm').value == "N") {
        document.getElementById('txttradedisc').disabled = true;
        document.getElementById('chktrade').disabled = true;
        if (document.getElementById('txtaddagencycommrate') != null) {
            document.getElementById('txtaddagencycommrate').disabled = true;
            document.getElementById('txtaddagencycommrate').value = "";
            document.getElementById('txtaddagencycommrateamt').disabled = true;
            document.getElementById('txtaddagencycommrateamt').value = "";
        }
    }
    else if (document.getElementById('hiddeneiitagcomm').value == "T") {
        document.getElementById('txttradedisc').disabled = false;
        document.getElementById('chktrade').disabled = false;
        if (document.getElementById('txtaddagencycommrate') != null) {
            document.getElementById('txtaddagencycommrate').disabled = true;
            document.getElementById('txtaddagencycommrate').value = "";
            document.getElementById('txtaddagencycommrateamt').disabled = true;
            document.getElementById('txtaddagencycommrateamt').value = "";
        }
    }
    else if (document.getElementById('hiddeneiitagcomm').value == "A") {
        document.getElementById('txttradedisc').disabled = true;
        document.getElementById('chktrade').disabled = true;
        if (document.getElementById('txtaddagencycommrate') != null) {
            document.getElementById('txtaddagencycommrate').disabled = false;
            document.getElementById('txtaddagencycommrate').value = "";
            document.getElementById('txtaddagencycommrateamt').disabled = false;
            document.getElementById('txtaddagencycommrateamt').value = "";
        }
    }
    else {
        document.getElementById('txttradedisc').disabled = false;
        document.getElementById('chktrade').disabled = false;
        if (document.getElementById('txtaddagencycommrate') != null) {
            document.getElementById('txtaddagencycommrate').disabled = false;
            document.getElementById('txtaddagencycommrate').value = "";
            document.getElementById('txtaddagencycommrateamt').disabled = false;
            document.getElementById('txtaddagencycommrateamt').value = "";
        }
    }

    if (document.getElementById('hiddencancelcharge').value == "Y") {
        document.getElementById('chkcanclecharges').disabled = false;
        document.getElementById('chkcanclecharges').checked = false;
    }
    else {
        document.getElementById('chkcanclecharges').disabled = true;
        document.getElementById('chkcanclecharges').checked = false;
    }
    document.getElementById('txtagencyoutstand').disabled = true;
    document.getElementById('txtcardrate').disabled = true;
    document.getElementById('txtcardamt').disabled = true;
    document.getElementById('txtdiscount').disabled = true;
    document.getElementById('txtdiscpre').disabled = true;
    document.getElementById('txttotalarea').disabled = false;
    document.getElementById('txtbilladdress').disabled = false;
    document.getElementById('drpboxcode').disabled = false;
    document.getElementById('txtboxaddress').disabled = false;
    document.getElementById('txtbillamt').disabled = true;
    document.getElementById('txtgrossamt').disabled = true;
    document.getElementById('chkage').disabled = false;
    document.getElementById('chkclie').disabled = false;
    document.getElementById('chktfn').disabled = false;
    document.getElementById('chkadon').disabled = false;
    document.getElementById('btnrefid').disabled = false;
    document.getElementById('txtinsertion').disabled = false;
    document.getElementById('txtagencypaymode').disabled = true;
    document.getElementById('btncopy').disabled = false;
    document.getElementById('btnshgrid').disabled = false;
    document.getElementById('btndeal').disabled = true;
   

    document.getElementById('drpretainer').disabled = false;
  

    document.getElementById('txtcontractname').value = "";
    hidcontract = "";
    document.getElementById('txtcontracttype').value = "";
  
    document.getElementById('txtbillamt').value = "";
    document.getElementById('txtrono').value = "";
    document.getElementById('txtbilladdress').value = "";
    document.getElementById('txtrodate').value = "";

    document.getElementById('drpbillstatus').value = "0";
    if (document.getElementById('hiddenrostatus').value == "1") {
        document.getElementById('drprostatus').value = "2";
    }
    else {
        document.getElementById('drprostatus').value = "1";
    }
    document.getElementById('txtagency').value = "";
    document.getElementById('txtclient').value = "";
    document.getElementById('txtagencyaddress').value = "";
    document.getElementById('txtclientadd').value = "";
    document.getElementById('drpagscode').value = "0";
    document.getElementById('txtdockitno1').value = "";
    document.getElementById('txtexecname').value = "";
    document.getElementById('txtexeczone').value = "";
    //document.getElementById('txtproduct').value = "";
    //document.getElementById('drpbrand').value = "0";
    document.getElementById('txtkeyno').value = "";
    document.getElementById('txtbillremark').value = "";
    document.getElementById('txtprintremark').value = "";
    document.getElementById('txtinsertion').value = "";
    document.getElementById('txtdummydate').value = "";
    document.getElementById('txtrevisedate').value = "";
    document.getElementById('txtrepeatingdate').value = "";

    //document.getElementById('txtcategory').value = "0";
    //document.getElementById('drpadsubcategory').value = "0";
    //document.getElementById('drpcolor').value = "0";
    if (document.getElementById('drpuom').options.length > 1) {
        if (document.getElementById('hiddenuom').value != "")
            document.getElementById('drpuom').value = document.getElementById('hiddenuom').value;
        else
            document.getElementById('drpuom').selectedIndex = "1";
    }
    else
        document.getElementById('drpuom').value = "0";
    document.getElementById('drpposition').value = "0";
    //document.getElementById('drpdiscountprem').value = "0";
    document.getElementById('txtratecode').value = "0";
    document.getElementById('drpscheme').value = "";

    document.getElementById('drpcurrency').value = "0";
    document.getElementById('drprptcurrency').value = "0";
    document.getElementById('txtagreedrate').value = "";
    document.getElementById('txtagreedamt').value = "";

    document.getElementById('txtextracharges').value = "";
    //document.getElementById('drpbillcycle').value = "0";
    if (document.getElementById('drpbillcycle').options.length > 1)
        document.getElementById('drpbillcycle').selectedIndex = 1;
    else
        document.getElementById('drpbillcycle').value = "0";
    //  document.getElementById('drprevenue').value = "0";

    document.getElementById('drpbillstatus').value = "0";

    document.getElementById('txtagencypaymode').options.length = 0;
    document.getElementById('drppaymenttype').options.length = 0;
    document.getElementById('txtinvoice').value = "";
    document.getElementById('txtvts').value = "";
    document.getElementById('txtcirrate').value = "";
    //document.getElementById('txtbartertype').value = "";
    document.getElementById('hiddenbarteramt').value = "";
    document.getElementById('hiddenstopbarterbooking').value = "";
    document.getElementById('txtciragency').value = "";
    document.getElementById('txtciredition').value = "";
    document.getElementById('txtbillwidth').value = "";
    document.getElementById('txtbillheight').value = "";

    document.getElementById('drpbillto').options.length = 0;
    document.getElementById('txttradedisc').value = "";
    document.getElementById('chktrade').checked = true;
    document.getElementById('chkholdbill').disabled = false;
    document.getElementById('chkholdbill').checked = false;
    document.getElementById('txtagencyoutstand').value = "";
    document.getElementById('txtcardrate').value = "";
    document.getElementById('txtcardamt').value = "";
    document.getElementById('txtdiscount').value = "";
    document.getElementById('txtdiscpre').value = "";
    //document.getElementById('txtadsize2').value = "";
    //document.getElementById('txtadsize1').value = "";
    document.getElementById('txttotalarea').value = "";
    document.getElementById('drpboxcode').value = "0";
    document.getElementById('txtboxno').value = "";
    document.getElementById('txtboxaddress').value = "";

    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    document.getElementById('drppackage').value = "0";
    document.getElementById('drppackagecopy').options.length = 0;

    document.getElementById('drpboxcode').value = "0";
    document.getElementById('chkage').checked = false;
    document.getElementById('chkclie').checked = false;
    document.getElementById('chktfn').checked = false;
    document.getElementById('chkadon').checked = false;
    //document.getElementById('chkcoupan').checked = false;
    document.getElementById('txtboxaddress').value = "";
    document.getElementById('txtinsertion').value = "";
    //        document.getElementById('drpbooktype').value = "3";

    document.getElementById('drpretainer').value = "";

    //document.getElementById('ttextchqno').value = "";
    //document.getElementById('drpourbank').value = "0";
    //document.getElementById('ttextchqdate').value = "";
    //document.getElementById('ttextchqamt').value = "";
    //document.getElementById('ttextbankname').value = "";

    //credit info
    //document.getElementById('tdcarname').style.display = "none";
    //document.getElementById('tdtxtcarname').style.display = "none";
    //document.getElementById('tdtype').style.display = "none";
    //document.getElementById('tddrptyp').style.display = "none";
    //document.getElementById('tdexdat').style.display = "none";

   // document.getElementById('tdtxtexdat').style.display = "none";
   // document.getElementById('tdcardno').style.display = "none";
    //document.getElementById('tdtxtcarno').style.display = "none";

    //document.getElementById('txtcardname').value = "";
    //document.getElementById('drptype').value = 0;
    //document.getElementById('drpmonth').value = 0;
    //document.getElementById('drpyear').value = 0;
    //document.getElementById('txtcardno').value = "";

    /////////if 0 than autogenerate the cio booking id and if 1 than autogenerate dockit no.
    //autogenerated("0");
    autogeneratedtempid() // to generate temp booking id
    rownumEx = 0;

    //chkstatus(document.getElementById('hiddenbuttonidcheck').value);anuj//
    document.getElementById('btnSave').disabled = false;
    document.getElementById('btnNew').disabled = true;
    document.getElementById('btnQuery').disabled = true;
    //document.getElementById('btnsavepaginate').disabled = false;

    document.getElementById('drpcurrency').value = document.getElementById('hiddencurrency').value;
    document.getElementById('drprptcurrency').value = document.getElementById('hiddencurrency').value;
    // document.getElementById('drpuom').value=document.getElementById('hiddenuom').value;
    if (document.getElementById('drpuom').selectedIndex != -1 && document.getElementById('drpuom').selectedIndex != 0) {
        //document.getElementById('lbmeasure').value = document.getElementById('drpuom').options[document.getElementById('drpuom').selectedIndex].text;
        document.getElementById('lbbilluom').value = document.getElementById('drpuom').options[document.getElementById('drpuom').selectedIndex].text;
        document.getElementById('lbmeasuretotal').value = "Sq" + "&nbsp;" + document.getElementById('drpuom').options[document.getElementById('drpuom').selectedIndex].text;
    }
    if (document.getElementById('drprevenue').selectedIndex != "-1") {
        //document.getElementById('hiddenbranch').value = document.getElementById('drprevenue').options[document.getElementById('drprevenue').selectedIndex].text; //drprevenue.SelectedItem.Text.ToString();
    }
    document.getElementById('btndel').disabled = false;
    document.getElementById('tblinsert').innerHTML = '';
    document.getElementById('txtagency').focus();
    bindBookType_Agency();
    document.getElementById('drpbooktype').value = "3";
    document.getElementById('drpuom').value = "0";
    //setButtonImages();
    setButtonImages();

    //          var obj=document.getElementById('drpbooktype');
    /* var resType=web_booking.bindAdTypeAgencyWiseXML();
          
    obj.options.length = 0; 
    if(resType!=null && resType.value!="")
    {
            
    var arr=resType.value.split(",");
    obj.options[0]=new Option("Select Booking Type","0");
    for(var i=0;i<arr.length;i++)
    {
    obj.options[obj.options.length] = new Option(arr[i].toString(),arr[parseFloat(i,10)+1].toString());
    i++;
    }
    obj.options[1].selected=true;
    }*/
    return false;
}










function Exit() {
    if (confirm("Do you want top skip this page?")) {
        window.close();
        return false;
    }
    return false;

}








function tabvalue(event) {


    var key = event.keyCode ? event.keyCode : event.which;
    if (event.keyCode == 113) {
       
         if (document.activeElement.id == "txtagency") {
            if (document.getElementById('txtagency').value.length <= 2) {
                alert("Please Enter Minimum 3 Character For Searching.");
                document.getElementById('txtagency').value = "";
                return false;
            }
            document.getElementById("div1").style.display = "block";
            aTag = eval(document.getElementById("txtagency"))
            var btag;
            var leftpos = 0;
            var toppos = 0;
            do {
                aTag = eval(aTag.offsetParent);
                leftpos += aTag.offsetLeft;
                toppos += aTag.offsetTop;
                btag = eval(aTag)
            } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
            document.getElementById('div1').style.top = document.getElementById("txtagency").offsetTop + toppos + "px";
            document.getElementById('div1').style.left = document.getElementById("txtagency").offsetLeft + leftpos + "px";
           
            document.getElementById('div1').style.top=parseInt(document.getElementById('txtagency').offsetTop) + parseInt(document.getElementById('sectd').offsetTop) + parseInt(document.getElementById('tdagen').offsetTop) + parseInt(document.getElementById('tbl1').offsetTop) + parseInt(document.getElementById('tbl2').offsetTop) + parseInt(document.getElementById('tbl3').offsetTop) + /*parseInt(document.getElementById('OuterTable').offsetTop)*/
            (-40) + "px";
            
            web_booking.bindagencyname(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value, document.getElementById('txtagency').value, "N", bindagencyname_callback);

        }
        
        
      
        else if (document.activeElement.id == "txtclient") {
    
            if (document.getElementById('txtclient').value.length <= 2) {
                alert("Please Enter Minimum 3 Character For Searching.");
                document.getElementById('txtclient').value = "";
                return false;
            }
            document.getElementById("divclient").style.display = "block";
            aTag = eval(document.getElementById("txtclient"))
            var btag;
            var leftpos = 0;
            var toppos = 0;
            do {
                aTag = eval(aTag.offsetParent);
                leftpos += aTag.offsetLeft;
                toppos += aTag.offsetTop;
                btag = eval(aTag)
            } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
            document.getElementById('divclient').style.top = document.getElementById("txtclient").offsetTop + toppos + "px";
            document.getElementById('divclient').style.left = document.getElementById("txtclient").offsetLeft + leftpos + "px";
            
           
            web_booking.bindclientname(document.getElementById('hiddencompcode').value, document.getElementById('txtclient').value, "N", bindclientname_callback);
        }
      
        else if (document.activeElement.id == "txtexecname") {
            if (document.getElementById('txtexecname').value.length <= 2) {
                alert("Please Enter Minimum 3 Character For Searching.");
                document.getElementById('txtexecname').value = "";
                return false;
            }
            document.getElementById("divexec").style.display = "block";
            aTag = eval(document.getElementById("txtexecname"))
            var btag;
            var leftpos = 0;
            var toppos = 0;
            do {
                aTag = eval(aTag.offsetParent);
                leftpos += aTag.offsetLeft;
                toppos += aTag.offsetTop;
                btag = eval(aTag)
            } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
            document.getElementById('divexec').style.top = document.getElementById("txtexecname").offsetTop + toppos + "px";
            document.getElementById('divexec').style.left = document.getElementById("txtexecname").offsetLeft + leftpos + "px";
           
            web_booking.bindExec(document.getElementById('hiddencompcode').value, document.getElementById('txtexecname').value, bindexecname_callback);
        }
        //*14Aug*
        else if (document.activeElement.id == "drpretainer") {
        if (document.activeElement.id == "drpretainer") {
                if (document.getElementById('txtexecname').value != "") {
                    var b = "Retainer";
                    if (browser != "Microsoft Internet Explorer") {

                        b = document.getElementById('lblretainer').textContent.replace("*[F2]", "");
                    }
                    else {

                        b = document.getElementById('lblretainer').innerText.replace("*[F2]", "");
                    }
                    if (confirm('Are you sure you want to Take ' + b)) {
                        if (document.getElementById('drpretainer').value.length <= 2) {
                            alert("Please Enter Minimum 3 Character For Searching.");
                            document.getElementById('drpretainer').value = "";
                            return false;
                        }
                        document.getElementById('txtexecname').value = "";
                        document.getElementById('txtexeczone').value = "";
                        document.getElementById("divretainer").style.display = "block";
                        aTag = eval(document.getElementById("drpretainer"))
                        var btag;
                        var leftpos = 0;
                        var toppos = 0;
                        do {
                            aTag = eval(aTag.offsetParent);
                            leftpos += aTag.offsetLeft;
                            toppos += aTag.offsetTop;
                            btag = eval(aTag)
                        } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
                        document.getElementById('divretainer').style.top = document.getElementById("drpretainer").offsetTop + toppos + "px";
                        document.getElementById('divretainer').style.left = document.getElementById("drpretainer").offsetLeft + leftpos + "px";
                      
                        var agcode = "";
                        if (document.getElementById('txtagency').value != "" && document.getElementById('txtagency').value.indexOf("(") >= 0 && document.getElementById('txtagency').value.indexOf(")") >= 0)
                            agcode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.lastIndexOf(')'));
                        web_booking.bindRetainer(document.getElementById('hiddencompcode').value, document.getElementById('drpretainer').value, agcode, bindretainer_callback);

                    }
                    else {
                        document.getElementById('drpretainer').value = "";
                        document.getElementById("divretainer").style.display = "none";
                    }
                }
                else {
                    if (document.getElementById('drpretainer').value.length <= 2) {
                        alert("Please Enter Minimum 3 Character For Searching.");
                        document.getElementById('drpretainer').value = "";
                        return false;
                    }

                    document.getElementById("divretainer").style.display = "block";
                    aTag = eval(document.getElementById("drpretainer"))
                    var btag;
                    var leftpos = 0;
                    var toppos = 0;
                    do {
                        aTag = eval(aTag.offsetParent);
                        leftpos += aTag.offsetLeft;
                        toppos += aTag.offsetTop;
                        btag = eval(aTag)
                    } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
                    document.getElementById('divretainer').style.top = document.getElementById("drpretainer").offsetTop + toppos + "px";
                    document.getElementById('divretainer').style.left = document.getElementById("drpretainer").offsetLeft + leftpos + "px";
                  
                    var agcode = "";
                    if (document.getElementById('txtagency').value != "" && document.getElementById('txtagency').value.indexOf("(") >= 0 && document.getElementById('txtagency').value.indexOf(")") >= 0)
                        agcode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.lastIndexOf(')'));
                    web_booking.bindRetainer(document.getElementById('hiddencompcode').value, document.getElementById('drpretainer').value, agcode, bindretainer_callback);
                }
            }
            else {
                if (document.getElementById('drpretainer').value.length <= 2) {
                    alert("Please Enter Minimum 3 Character For Searching.");
                    document.getElementById('drpretainer').value = "";
                    return false;
                }

                document.getElementById("divretainer").style.display = "block";
                aTag = eval(document.getElementById("drpretainer"))
                var btag;
                var leftpos = 0;
                var toppos = 0;
                do {
                    aTag = eval(aTag.offsetParent);
                    leftpos += aTag.offsetLeft;
                    toppos += aTag.offsetTop;
                    btag = eval(aTag)
                } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
                document.getElementById('divretainer').style.top = document.getElementById("drpretainer").offsetTop + toppos + "px";
                document.getElementById('divretainer').style.left = document.getElementById("drpretainer").offsetLeft + leftpos + "px";
              
                var agcode = "";
                if (document.getElementById('txtagency').value != "" && document.getElementById('txtagency').value.indexOf("(") >= 0 && document.getElementById('txtagency').value.indexOf(")") >= 0)
                    agcode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.lastIndexOf(')'));
                web_booking.bindRetainer(document.getElementById('hiddencompcode').value, document.getElementById('drpretainer').value, agcode, bindretainer_callback);
            }

        }
      
       
       
    }

    else if (event.keyCode == 27) {
       
         if (document.getElementById("div1").style.display == "block") {
            document.getElementById("div1").style.display = "none"
            document.getElementById('txtagency').focus();
        }
        else if (document.getElementById("divclient").style.display == "block") {
            document.getElementById("divclient").style.display = "none"
            document.getElementById('txtclient').focus();
        }
      
        else if (document.getElementById("divexec").style.display == "block") {
            document.getElementById("divexec").style.display = "none"
            document.getElementById('txtexecname').focus();
        }
        else if (document.getElementById("divretainer").style.display == "block") {
            document.getElementById("divretainer").style.display = "none"
            document.getElementById('drpretainer').focus();
        }

       
        return false;

    }

    else if (event.keyCode == 13 || event.keyCode == 9 && event.shiftKey == false) {


    if (document.activeElement.id == "drpmatsta") {
            document.getElementById('LinkButton5').focus();
          
            changepackage();
           
            return false;
        }

        else if (document.activeElement.id == "txtprintremark") {
            document.getElementById('LinkButton2').focus();
            changediv1();
        return false;
        }

        else if (document.activeElement.id == "btncopy") {
           
            Btncopyclick();

            return false;

        }



        else if (document.activeElement.id == "btndel") {

        removepkgname();

            return false;

        }
        
          else if (document.activeElement.id == "txttotalarea") {
            document.getElementById('LinkButton4').focus();
            changedivrate();
           
            return false;

        }





        else if (document.activeElement.id == "txtgrossamt") {
            document.getElementById('LinkButton3').focus();
            changebilldiv();

            return false;

        }
        
        
    
      
         if (document.activeElement.id == "lstclient") {
            if (document.getElementById('lstclient').value == "0") {
                alert("Please select the client");
                return false;
            }
            document.getElementById("divclient").style.display = "none";
            var datetime = document.getElementById('txtdatetime').value;

            /*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
            this is the page which is designed to get the name as well as the add ress of client if 0 than client name and 
            address and if 0 than agency name and address
            @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@22222*/

            var page = document.getElementById('lstclient').value;
            var id = "";

            if (browser != "Microsoft Internet Explorer") {
                var httpRequest = null; ;
                httpRequest = new XMLHttpRequest();
                if (httpRequest.overrideMimeType) {
                    httpRequest.overrideMimeType('text/xml');
                }

                httpRequest.onreadystatechange = function() { alertContents(httpRequest) };

                httpRequest.open("GET", "clientName.aspx?page=" + page + "&adtype=" + "WE0" + "&datetime=" + datetime + "&value=1", false);
                httpRequest.send('');

                if (httpRequest.readyState == 4) {
                 
                    if (httpRequest.status == 200) {
                        id = httpRequest.responseText;
                    }
                    else {
                        alert('There was a problem with the request.');
                    }
                }
            }
            else {
                var xml = new ActiveXObject("Microsoft.XMLHTTP");
                xml.Open("GET", "clientName.aspx?page=" + page + "&adtype=" + "WE0" + "&datetime=" + datetime + "&value=1", false);
                xml.Send();
                id = xml.responseText;
            }

            var split = id.split("+");
            var namecode = split[0];
            var add = split[1];
            document.getElementById('txtclient').value = namecode;
            if (document.getElementById('hiddensavemod').value == "0") {
                document.getElementById('txtclientadd').value = add;
                document.getElementById('txtclientadd').focus();
            }
          
            return false;
        }
   
   
         if (document.activeElement.id == "lstretainer") {
            if (document.getElementById('drpretainer').value == "0") {
                var b = "Retainer";
                if (browser != "Microsoft Internet Explorer") {

                    b = document.getElementById('lblretainer').textContent.replace("*[F2]", "");
                }
                else {

                    b = document.getElementById('lblretainer').innerText.replace("*[F2]", "");
                }
                alert("Please Select " + b);
                return false;
            }
            showretainervalue();
        }
        else if (document.activeElement.id == "lstagency") {
            if (document.getElementById('lstagency').value == "0") {
                alert("Please select the agency sub code");
                return false;
            }
            document.getElementById("div1").style.display = "none";
            var datetime = document.getElementById('txtdatetime').value;
           
            /*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
            this is the page which is designed to get the name as well as the add ress of client if 0 than client name and 
            address and if 0 than agency name and address
            @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@22222*/

            var page = document.getElementById('lstagency').value;
            agencycodeglo = page;

            var id = "";
            if (browser != "Microsoft Internet Explorer") {
                var httpRequest = null; ;
                httpRequest = new XMLHttpRequest();
                if (httpRequest.overrideMimeType) {
                    httpRequest.overrideMimeType('text/xml');
                }

                httpRequest.onreadystatechange = function() { alertContents(httpRequest) };

                httpRequest.open("GET", "clientName.aspx?page=" + page + "&adtype=" + "WE0" + "&datetime=" + datetime + "&value=0", false);
                httpRequest.send('');
             
                if (httpRequest.readyState == 4) {
                  
                    if (httpRequest.status == 200) {
                        id = httpRequest.responseText;
                    }
                    else {
                        alert('There was a problem with the request.');
                    }
                }
            }
            else {
                var xml = new ActiveXObject("Microsoft.XMLHTTP");
                xml.Open("GET", "clientName.aspx?page=" + page + "&adtype=" + "WE0" + "&datetime=" + datetime + "&value=0", false);
                xml.Send();
                id = xml.responseText;
            }

            var split = id.split("+");
            var nameagen = split[0];
            var agenadd = split[1];
            document.getElementById('txtagency').value = nameagen;
            document.getElementById('hiddenagency').value = document.getElementById('lstagency').value;
            if (document.getElementById('hiddensavemod').value == "0" || document.getElementById('hiddensavemod').value == "01") {
                document.getElementById('txtagencyaddress').value = agenadd;
       
                    document.getElementById('txtclient').focus();
           
               web_booking.bindagencusub(page, document.getElementById('hiddencompcode').value, call_bindagsub);
            }
            return false;
        }
        ///////////////for product

        else if (document.activeElement.id == "lstproduct") {
            if (document.getElementById('lstproduct').value == "0") {
                alert("Please select the product");
                return false;
            }
            document.getElementById("divproduct").style.display = "none";
            var datetime = document.getElementById('txtdatetime').value;
          
            /*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
            this is the page which is designed to get the name as well as the add ress of client if 0 than client name and 
            address and if 0 than agency name and address and if 2 than its for product
            @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@22222*/

            var page = document.getElementById('lstproduct').value;
            //agencycodeglo=page;

            var id = "";
            if (browser != "Microsoft Internet Explorer") {
                var httpRequest = null; ;
                httpRequest = new XMLHttpRequest();
                if (httpRequest.overrideMimeType) {
                    httpRequest.overrideMimeType('text/xml');
                }

                httpRequest.onreadystatechange = function() { alertContents(httpRequest) };

                httpRequest.open("GET", "clientName.aspx?page=" + page + "&adtype=" + "WE0" + "&datetime=" + datetime + "&value=2", false);
                httpRequest.send('');
               
                if (httpRequest.readyState == 4) {
                   
                    if (httpRequest.status == 200) {
                        id = httpRequest.responseText;
                    }
                    else {
                        alert('There was a problem with the request.');
                    }
                }
            }
            else {
                var xml = new ActiveXObject("Microsoft.XMLHTTP");
                xml.Open("GET", "clientName.aspx?page=" + page + "&adtype=" + "WE0" + "&datetime=" + datetime + "&value=2", false);
                xml.Send();
                id = xml.responseText;
            }

            document.getElementById('txtproduct').value = id;


            document.getElementById('drpbrand').options.length = 0;
            document.getElementById('drpbrand').focus();
            web_booking.getbrand(page, document.getElementById('hiddencompcode').value, call_bindproduct);
            return false;
        }
       
        else if (document.activeElement.id == "lstexec") {
            if (document.getElementById('lstexec').value == "0") {
                var a = "Executive name";
                if (browser != "Microsoft Internet Explorer") {
                    a = document.getElementById('lbececname').textContent.replace("*[F2]", "");
                }
                else {
                    a = document.getElementById('lbececname').innerText.replace("*[F2]", "");
                }
                alert("Please select the " + a);
                return false;
            }
            document.getElementById("divexec").style.display = "none";
            var datetime = document.getElementById('txtdatetime').value;
           
            /*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
            this is the page which is designed to get the name as well as the add ress of client if 0 than client name and 
            address and if 0 than agency name and address and if 2 than its for product and 3 for exec
            @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@22222*/

            var page = document.getElementById('lstexec').value;
            //agencycodeglo=page;

            var id = "";
            if (browser != "Microsoft Internet Explorer") {
                var httpRequest = null; ;
                httpRequest = new XMLHttpRequest();
                if (httpRequest.overrideMimeType) {
                    httpRequest.overrideMimeType('text/xml');
                }

                httpRequest.onreadystatechange = function() { alertContents(httpRequest) };

                httpRequest.open("GET", "clientName.aspx?page=" + page + "&adtype=" + "WE0" + "&datetime=" + datetime + "&value=3", false);
                httpRequest.send('');
              
                if (httpRequest.readyState == 4) {
                   
                    if (httpRequest.status == 200) {
                        id = httpRequest.responseText;
                    }
                    else {
                        alert('There was a problem with the request.');
                    }
                }
            }
            else {
                var xml = new ActiveXObject("Microsoft.XMLHTTP");
                xml.Open("GET", "clientName.aspx?page=" + page + "&adtype=" + "WE0" + "&datetime=" + datetime + "&value=3", false);
                xml.Send();
                id = xml.responseText;
            }
            document.getElementById('txtexecname').value = id;


           
            web_booking.getexeczone(page, document.getElementById('hiddencompcode').value, call_bindexeczone);
              changediv();
            document.getElementById('drpretainer').focus();
            return false;
        }

      
    
        else if (document.activeElement.id == "drpretainer") {
            changediv();
           
            return false;
        }

       
      
      
        
       
        else {
            var idcursor;
            if (event.shiftKey == false) {

                event.keyCode = 9;
                return event.keyCode;
            }

        }
    }
 
 
    else if ((event.keyCode == 9) && (document.activeElement.type == "button" || document.activeElement.type == "image" || document.activeElement.type == "submit" || document.activeElement.id == "LinkButton1" || document.activeElement.id == "LinkButton2" || document.activeElement.id == "LinkButton3" || document.activeElement.id == "LinkButton4" || document.activeElement.id == "LinkButton5")) {

     
      
        if (document.activeElement.id == "LinkButton1") {
            changediv1();
        }
      
        return event.keyCode;

    }

}



function bindretainer_callback(res) {
    var ds = res.value;
    var pkgitem = document.getElementById("lstretainer");
    pkgitem.options.length = 0;
    pkgitem.options[0] = new Option("-Select-", "0");

    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {
        pkgitem.options.length = 1;
        for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].Retain_Name, ds.Tables[0].Rows[i].Retain_Code);

            pkgitem.options.length;

        }

    }
    document.getElementById("divretainer").style.display = "block";
    document.getElementById('drpretainer').value = "";
   
    document.getElementById("lstretainer").value = "0";
    document.getElementById("lstretainer").focus();
   
    return false;


}





function f2query(event) {
    if (agnf2 == "Y" && event.keyCode != 113) {
        if (document.activeElement.id == "txtagency") {

            if (document.getElementById('txtagency').value == "") {
                if (document.getElementById("div1").style.display == "block") {
                    document.getElementById("div1").style.display = "none"
                    document.getElementById('txtagency').focus();
                    return false;
                }
                return false;
            }
            if (event.keyCode == 40) {
                document.getElementById("lstagency").focus();
                return false;
            }
            if (document.getElementById("div1").style.display == "none") {
                document.getElementById("div1").style.display = "block";
                aTag = eval(document.getElementById("txtagency"))
                var btag;
                var leftpos = 0;
                var toppos = 0;
                do {
                    aTag = eval(aTag.offsetParent);
                    leftpos += aTag.offsetLeft;
                    toppos += aTag.offsetTop;
                    btag = eval(aTag)
                } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
                document.getElementById('div1').style.top = document.getElementById("txtagency").offsetTop + (toppos + 15) + "px";
                document.getElementById('div1').style.left = document.getElementById("txtagency").offsetLeft + leftpos + "px";
            }
          
            (-20) + "px";
          
            web_booking.bindagencyname(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value, document.getElementById('txtagency').value, "Y", bindagencyname_callback);

        }
        else if (document.activeElement.id == "txtclient") {
         
            if (document.getElementById('txtclient').value == "") {
                if (document.getElementById("divclient").style.display == "block") {
                    document.getElementById("divclient").style.display = "none"
                    document.getElementById('txtclient').focus();
                    return false;
                }
                return false;
            }
            if (event.keyCode == 40) {
                document.getElementById("lstclient").focus();
                return false;
            }
            else if (event.keyCode == 27) {
                if (document.getElementById("divclient").style.display == "block") {
                    document.getElementById("divclient").style.display = "none"
                    document.getElementById('txtclient').value = "";
                    document.getElementById('txtclient').focus();
                }
                return false;
            }

            document.getElementById("divclient").style.display = "block";
            aTag = eval(document.getElementById("txtclient"))
            var btag;
            var leftpos = 0;
            var toppos = 0;
            do {
                aTag = eval(aTag.offsetParent);
                leftpos += aTag.offsetLeft;
                toppos += aTag.offsetTop;
                btag = eval(aTag)
            } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
            document.getElementById('divclient').style.top = document.getElementById("txtclient").offsetTop + (toppos + 15) + "px";
            document.getElementById('divclient').style.left = document.getElementById("txtclient").offsetLeft + leftpos + "px";
            web_booking.bindclientname(document.getElementById('hiddencompcode').value, document.getElementById('txtclient').value, "Y", bindclientname_callback);
        }
    }
}



function bindexecname_callback(response) {
    ds = response.value;
    var pkgitem = document.getElementById("lstexec");
    pkgitem.options.length = 0;
    pkgitem.options[0] = new Option("-Select-", "0");
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {
        pkgitem.options.length = 1;
        for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].exec_name, ds.Tables[0].Rows[i].exe_no);

            pkgitem.options.length;
        }

    }
    document.getElementById('txtexecname').value = "";
    document.getElementById("lstexec").value = "0";
    if (document.getElementById("lstexec").style.visibility == "hidden")
        document.getElementById("lstexec").style.visibility = "visible";
    document.getElementById("lstexec").focus();
    return false;
}





function bindclientname_callback(response) {

    ds = response.value;
    var pkgitem = document.getElementById("lstclient");
    pkgitem.options.length = 0;
    pkgitem.options[0] = new Option("-Select Client-", "0");
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {


        //alert(pkgitem);


        //alert(pkgitem.options.length);
        pkgitem.options.length = 1;
        for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].Cust_Name, ds.Tables[0].Rows[i].Cust_Code);

            pkgitem.options.length;

        }

    }
    if (agnf2 != "Y") {
        document.getElementById('txtclient').value = "";
        document.getElementById("lstclient").focus();  //uncomment
    }
    document.getElementById("lstclient").value = "0";

    return false;
}




function bindagencyname_callback(response) {
    ds = response.value;
    if (ds == null) {
        alert(response.error.description);
        return false;
    }
    document.getElementById('drpretainer').value = "";
    var pkgitem = document.getElementById("lstagency");
    pkgitem.options.length = 0;
    pkgitem.options[0] = new Option("-Select Agency-", "0");
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {





        pkgitem.options.length = 1;

        for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].agency_name + '+' + ds.Tables[0].Rows[i].CITYNAME, ds.Tables[0].Rows[i].code_subcode);
           
            pkgitem.options.length;

        }
    }
    if (agnf2 != "Y") {
        document.getElementById('txtagency').value = "";

        document.getElementById("lstagency").focus();
    }
  
    document.getElementById("lstagency").value = "0";
 
    return false;
}
function insertagency() {
     if (document.activeElement.id == "lstclient") {
        if (document.getElementById('lstclient').value == "0") {
            alert("Please select the client");
            return false;
        }
        document.getElementById("divclient").style.display = "none";
        var datetime = document.getElementById('txtdatetime').value;
       

        var page = document.getElementById('lstclient').value;

        var id = "";

        if (browser != "Microsoft Internet Explorer") {
            var httpRequest = null; ;
            httpRequest = new XMLHttpRequest();
            if (httpRequest.overrideMimeType) {
                httpRequest.overrideMimeType('text/xml');
            }
            httpRequest.onreadystatechange = function() { alertContents(httpRequest) };
            httpRequest.open("GET", "clientName.aspx?page=" + page + "&adtype=" + "WE0" + "&datetime=" + datetime + "&value=1", false);
            httpRequest.send('');
                     if (httpRequest.readyState == 4) {
                
                if (httpRequest.status == 200) {
                    id = httpRequest.responseText;
                }
                else {
                    alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                    return false;
                }
            }
            else {
                alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                return false;
            }
        }
        else {
            var xml = new ActiveXObject("Microsoft.XMLHTTP");
            xml.Open("GET", "clientName.aspx?page=" + page + "&adtype=" + "WE0" + "&datetime=" + datetime + "&value=1", false);
            xml.Send();
            id = xml.responseText;
        }
        if (id == "yes") {
            alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
            return false;
        }
        var split = id.split("+");
        var namecode = split[0];
        var add = split[1];
        document.getElementById('txtclient').value = namecode;
        if (document.getElementById('hiddensavemod').value == "0" || document.getElementById('hiddensavemod').value == "01") {
            document.getElementById('txtclientadd').value = add;

            document.getElementById('txtclientadd').focus();
        }
            return false;
    }
    else if (document.activeElement.id == "lstagency") {
        if (document.getElementById('lstagency').value == "0") {
            alert("Please select the agency sub code");
            return false;
        }
        document.getElementById("div1").style.display = "none";
        var datetime = document.getElementById('txtdatetime').value;
       
        

        var page = document.getElementById('lstagency').value;
        agencycodeglo = page;

        var id = "";

        if (browser != "Microsoft Internet Explorer") {
            var httpRequest = null; ;
            httpRequest = new XMLHttpRequest();
            if (httpRequest.overrideMimeType) {
                httpRequest.overrideMimeType('text/xml');
            }

            httpRequest.onreadystatechange = function() { alertContents(httpRequest) };

            httpRequest.open("GET", "clientName.aspx?page=" + page + "&adtype=" + "WE0" + "&datetime=" + datetime + "&value=0", false);
            httpRequest.send('');
            
            if (httpRequest.readyState == 4) {
               
                if (httpRequest.status == 200) {
                    id = httpRequest.responseText;
                }
                else {
                    alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                    return false;
                }
            }
        }
        else {
            var xml = new ActiveXObject("Microsoft.XMLHTTP");
            xml.Open("GET", "clientName.aspx?page=" + page + "&adtype=" + "WE0" + "&datetime=" + datetime + "&value=0", false);
            xml.Send();
            id = xml.responseText;
        }
        if (id == "yes") {
            alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
            return false;
        }
        var split = id.split("+");
        var nameagen = split[0];
        var agenadd = split[1];



        document.getElementById('txtagency').value = nameagen;
        
        document.getElementById('hiddenagency').value = document.getElementById('lstagency').value;
        if (document.getElementById('hiddensavemod').value == "0" || document.getElementById('hiddensavemod').value == "01") {
            document.getElementById('txtagencyaddress').value = agenadd;

            web_booking.bindagencusub(page, document.getElementById('hiddencompcode').value, call_bindagsub);
        }
        return false;
    }
    else if (document.activeElement.id == "lstexec") {
        if (document.getElementById('lstexec').value == "0") {
            var a = "Executive name";
            if (browser != "Microsoft Internet Explorer") {
                a = document.getElementById('lbececname').textContent.replace("*[F2]", "");
            }
            else {
                a = document.getElementById('lbececname').innerText.replace("*[F2]", "");
            }
            alert("Please select the " + a);
            return false;
        }
        document.getElementById("divexec").style.display = "none";
        var datetime = document.getElementById('txtdatetime').value;
     
        var page = document.getElementById('lstexec').value;
       
        var id = "";
        if (browser != "Microsoft Internet Explorer") {
            var httpRequest = null; ;
            httpRequest = new XMLHttpRequest();
            if (httpRequest.overrideMimeType) {
                httpRequest.overrideMimeType('text/xml');
            }

            httpRequest.onreadystatechange = function() { alertContents(httpRequest) };

            httpRequest.open("GET", "clientName.aspx?page=" + page + "&adtype=" + "WE0" + "&datetime=" + datetime + "&value=3", false);
            httpRequest.send('');
          
            if (httpRequest.readyState == 4) {
                              if (httpRequest.status == 200) {
                    id = httpRequest.responseText;
                }
                else {
                    alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                    return false;
                }
            }
        }
        else {
            var xml = new ActiveXObject("Microsoft.XMLHTTP");
            xml.Open("GET", "clientName.aspx?page=" + page + "&adtype=" + "WE0" + "&datetime=" + datetime + "&value=3", false);
            xml.Send();
            id = xml.responseText;
        }
        if (id == "yes") {
            alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
            return false;
        }
        document.getElementById('txtexecname').value = id;
        document.getElementById('txtexeczone').focus();
        web_booking.getexeczone(page, document.getElementById('hiddencompcode').value, call_bindexeczone);
        return false;
    }

}

function showretainervalue() {
    if (document.getElementById('lstretainer').value == "0") {
        var b = "Retainer";
        if (browser != "Microsoft Internet Explorer") {

            b = document.getElementById('lblretainer').textContent.replace("*[F2]", "");
        }
        else {

            b = document.getElementById('lblretainer').innerText.replace("*[F2]", "");
        }
        alert("Please Select " + b);
        return false;
    }


    document.getElementById('drpretainer').value = document.getElementById('lstretainer').options[document.getElementById('lstretainer').selectedIndex].text + "(" + document.getElementById('lstretainer').value + ")";
    document.getElementById('lstretainer').options.length = 0;
    document.getElementById("divretainer").style.display = "none";
    if (document.getElementById('drpretainer').value != "" && document.getElementById('drpretainer').value != "0") {
                var retain_name = document.getElementById('drpretainer').value.split('(');
        var retain_code = retain_name[1].replace(')', '');
        var ds_ret = web_booking.getRetainerComm(retain_code, document.getElementById('hiddencompcode').value);

        if (ds_ret.value == null)
            return false;

        if (ds_ret.value.Tables[0].Rows.length > 0) {
            document.getElementById('retcommtype').value = ds_ret.value.Tables[0].Rows[0].Discount;
            document.getElementById('txtRetainercomm').value = ds_ret.value.Tables[0].Rows[0].retainercomm;
            document.getElementById('retcomm').value = ds_ret.value.Tables[0].Rows[0].retainercomm;
            if (document.getElementById('retcommtype').value == "Gross" && document.getElementById('txtgrossamt').value != "" && document.getElementById('txtRetainercomm').value != "" && document.getElementById('txtRetainercomm').value != null) {
                document.getElementById('txtRetainercommamt').value = (parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(document.getElementById('txtRetainercomm').value) / 100).toFixed(2);
            }
            else if (document.getElementById('retcommtype').value == "Net" && document.getElementById('txtbillamt').value != "" && document.getElementById('txtRetainercomm').value != "" && document.getElementById('txtRetainercomm').value != null) {
                document.getElementById('txtRetainercommamt').value = (parseFloat(document.getElementById('txtbillamt').value) * parseFloat(document.getElementById('txtRetainercomm').value) / 100).toFixed(2);
            }
        }

    }
    changediv();

    return false;

}


function call_bindagsub(response) {
    ds = response.value;
    var pkgitem = document.getElementById("drpagscode");
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {
 pkgitem.options.length = 0;
      for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].agency_name, ds.Tables[0].Rows[i].Agency_Code);
  pkgitem.options.length;
  }
    }
 getpayandstatus();
 return false;

}



function getpayandstatus() {
 
    var subagency = document.getElementById("drpagscode").value;
    var datetime = document.getElementById('txtdatetime').value;
    var agencycode = document.getElementById('txtagency').value;
    var compcode = document.getElementById('hiddencompcode').value
    var dateformat = document.getElementById('hiddendateformat').value
    if (subagency == "0") {
        alert("Please select sub agency");
        return false;
    }
  web_booking.getpayandstatus(agencycodeglo, subagency, compcode, datetime, dateformat, call_fillpay);
    return false;
}

function call_fillpay(res) {
    var ds = res.value;
    document.getElementById('hndagalert1').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtbillamt').value = "";
    if (ds == null) {
        alert(res.error.description);
        return false;
    }
    if (ds.Tables[1].Rows.length > 0) {
        if (ds.Tables[1].Rows[0].status_name == "INACTIVE" || ds.Tables[1].Rows[0].status_name == "BANNED") {
            alert("You Can't Book Ad with InActive/Banned Agency");
            document.getElementById("drpagscode").options.length = 0;
            document.getElementById("txtagency").value = "";
            document.getElementById('txtagency').title = "";
            document.getElementById('txtagencytype').value = "";
            document.getElementById('txtagencystatus').value = "";
            document.getElementById('txtcreditperiod').value = "";
            document.getElementById('txtagencypaymode').value = "";
            document.getElementById('txttradedisc').value = "";
            document.getElementById('txttd').value = "";
            document.getElementById('txtdesignation').value = "";
            document.getElementById('hiddenagcommflag').value = "";
            document.getElementById('txtgrossamt').value = "";
            if (document.getElementById('txtaddagencycommrate') != null)
                document.getElementById('txtaddagencycommrate').value = "";
            document.getElementById('hiddentradedisc').value = "";
            //
            document.getElementById('txtagencyaddress').value = "";
            document.getElementById('txtagencyaddress').title = "";
            document.getElementById("txtagency").focus();
            return false;
        }
    }
    if (ds.Tables[2].Rows[0].CREDIT_LIMIT != "" && ds.Tables[2].Rows[0].CREDIT_LIMIT != null) {
        if (parseFloat(ds.Tables[7].Rows[0].outstand) > parseFloat(ds.Tables[2].Rows[0].CREDIT_LIMIT) && (ds.Tables[7].Rows[0].OUTSTANDING_AMT_CRITERIA != null && ds.Tables[7].Rows[0].OUTSTANDING_AMT_CRITERIA != '3')) {
            if (!confirm('Outstanding amount of this agency exceeding the Credit Limit. Do you still want to book an Advertisement?')) {
                document.getElementById("drpagscode").options.length = 0;
                document.getElementById("txtagency").value = "";
                document.getElementById('txtagency').title = "";
                document.getElementById('txtagencytype').value = "";
                document.getElementById('txtagencystatus').value = "";
                document.getElementById('txtcreditperiod').value = "";
                document.getElementById('txtagencypaymode').value = "";
                document.getElementById('txttradedisc').value = "";
                document.getElementById('txttd').value = "";
                document.getElementById('txtdesignation').value = "";
                document.getElementById('hiddenagcommflag').value = "";
                document.getElementById('txtgrossamt').value = "";
                if (document.getElementById('txtaddagencycommrate') != null)
                    document.getElementById('txtaddagencycommrate').value = "";

                document.getElementById('hiddentradedisc').value = "";
                //
                document.getElementById('txtagencyaddress').value = "";
                document.getElementById('txtagencyaddress').title = "";
                document.getElementById("txtagency").focus();
                return false;
            }
        }
    }

    bindBookType_Agency();
    if (ds.Tables[2].Rows[0].VAT != null) {
        if (ds.Tables[2].Rows[0].VAT == "1")
            vat_app = "1";
        else
            vat_app = "0";

    }
    if (ds.Tables[2].Rows[0].EDTN_WISE_BILL_REQ != null) {
        if (ds.Tables[2].Rows[0].EDTN_WISE_BILL_REQ == "Y")
            if (roundoff != "off")
            roundoff = "editionwise";
    }
    else {
        if (roundoff != "off")
            roundoff = "insertionwise";
    }
    if (ds.Tables[2].Rows[0].BOOKING_TYPE != null && ds.Tables[2].Rows[0].BOOKING_TYPE != "") {
        var btype = ds.Tables[2].Rows[0].BOOKING_TYPE;
        btype = btype.split(",");
        var k = btype.length;
        var obj = document.getElementById('drpbooktype');
        var len = obj.options.length;
        for (var i = 0; i < k; i++) {
            for (var j = 0; j < len; j++) {
                if (obj[j].value == btype[i]) {
                    obj[j].label = "R";
                }
            }
        }

        for (var j = 0; j < len; ) {
            if (obj[j].label != "R") {
                obj.options.remove(j);
                len = len - 1;

                //j=0;
            }
            else {
                obj[j].label = "";
                len = len - 1;
                j++
            }
        }
    }
    document.getElementById('txtagency').title = document.getElementById('txtagency').value;
    document.getElementById('txtagencyaddress').title = document.getElementById('txtagencyaddress').value;
    if (ds.Tables[0].Rows.length > 0) {
        document.getElementById('txtagencytype').value = ds.Tables[0].Rows[0].agency_type_name
    }
    if (ds.Tables[1].Rows.length > 0) {
        document.getElementById('txtagencystatus').value = ds.Tables[1].Rows[0].status_name;
        document.getElementById('hiddenstatus').value = ds.Tables[1].Rows[0].status_name;


    }
    if (ds.Tables[2].Rows.length > 0) {
        document.getElementById('txtdesignation').value = ds.Tables[2].Rows[0].AGENCY_DESIGNATION;
        document.getElementById('txtcreditperiod').value = ds.Tables[2].Rows[0].Credit_Days;
        if (ds.Tables[2].Rows[0].ALERT != null && ds.Tables[2].Rows[0].ALERT != "") {
            document.getElementById('hndagalert1').value = ds.Tables[2].Rows[0].ALERT;
            alert(ds.Tables[2].Rows[0].ALERT);
        }
        if (ds.Tables[2].Rows[0].AGENCY_DEAL_ALERT != null && ds.Tables[2].Rows[0].AGENCY_DEAL_ALERT != "") {
            alert("Agency has this Deal " + ds.Tables[2].Rows[0].AGENCY_DEAL_ALERT);
        }
    }
    if (ds.Tables.length > 7) {
        if (ds.Tables[7].Rows.length > 0)
            document.getElementById('txtagencyoutstand').value = ds.Tables[7].Rows[0].outstand;
    }
    if (ds.Tables[4].Rows.length > 0) {
        if (ds.Tables[4].Rows[0].CASH_DISCOUNT1 != null)
            document.getElementById('txtcashdiscount').value = ds.Tables[4].Rows[0].CASH_DISCOUNT1;
        if (ds.Tables[4].Rows[0].CASH_DISCOUNT != null)
            document.getElementById('txtcashdiscount').value = ds.Tables[4].Rows[0].CASH_DISCOUNT;
        if (ds.Tables[4].Rows[0].CASH_DISCOUNTTYPE1 != null)
            document.getElementById('hiddencashrecieved').value = ds.Tables[4].Rows[0].CASH_DISCOUNTTYPE1;
        if (ds.Tables[4].Rows[0].CASH_DISCOUNTTYPE != null)
            document.getElementById('hiddencashrecieved').value = ds.Tables[4].Rows[0].CASH_DISCOUNTTYPE;
        document.getElementById('txttradedisc').value = ds.Tables[4].Rows[0].comm_rate;
        document.getElementById('txttd').value = ds.Tables[4].Rows[0].comm_rate;
        document.getElementById('hiddenagcommflag').value = ds.Tables[4].Rows[0].FLAG;
        document.getElementById('txtgrossamt').value = "";
        if (ds.Tables[4].Rows[0].Addl_Comm_Rate != null && document.getElementById('txtaddagencycommrate') != null)
            document.getElementById('txtaddagencycommrate').value = ds.Tables[4].Rows[0].Addl_Comm_Rate;
        document.getElementById('hiddentradedisc').value = document.getElementById('txttradedisc').value;
    }
    else {
        alert("Please update the " + document.getElementById('txtagency').value + " Commission detail");
        document.getElementById("txtagency").value = "";
        document.getElementById('txtagencytype').value = "";
        document.getElementById('txtagencystatus').value = "";
        document.getElementById('txtcreditperiod').value = "";
        document.getElementById('txtagencypaymode').value = "";
        document.getElementById('txttradedisc').value = "";
        document.getElementById('txttd').value = "";
        document.getElementById('txtdesignation').value = "";
        document.getElementById('hiddenagcommflag').value = "";
        document.getElementById('txtgrossamt').value = "";
        if (document.getElementById('txtaddagencycommrate') != null)
            document.getElementById('txtaddagencycommrate').value = "";
        //
        document.getElementById('hiddentradedisc').value = "";
        document.getElementById('txtagencyaddress').value = "";
        document.getElementById("txtagency").focus();
        return false;
    }
    if (ds.Tables[5].Rows.length > 0) {
        //document.getElementById('txtagencypaymode').value=ds.Tables[5].Rows[0].payment_mode_name;
        ///this is to bind the payment drop down and bill to drop down
        var pkgitem = document.getElementById('txtagencypaymode');
        var billobj = document.getElementById('drppaymenttype');
        pkgitem.options.length = 0;
        billobj.options.length = 0;
        billobj.options[0] = new Option("Select", "0");
        billobj.options.length;
        //billobj.options[0]=new Option("--Select City--","0");
        //alert(pkgitem.options.length);
        for (var i = 0; i < ds.Tables[5].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[5].Rows[i].payment_mode_name, ds.Tables[5].Rows[i].pay_mode_code);
            billobj.options[billobj.options.length] = new Option(ds.Tables[5].Rows[i].payment_mode_name, ds.Tables[5].Rows[i].pay_mode_code);

            billobj.options.length;
            pkgitem.options.length;

        }
        if (document.getElementById('hdndefpayment').value == null || document.getElementById('hdndefpayment').value == "") {
            document.getElementById('txtagencypaymode').value = ds.Tables[5].Rows[0].pay_mode_code;
            document.getElementById('drppaymenttype').value = ds.Tables[5].Rows[0].pay_mode_code;
            document.getElementById('hiddenpay').value = ds.Tables[5].Rows[0].pay_mode_code;
            document.getElementById('hiddenbillpay').value = ds.Tables[5].Rows[0].pay_mode_code;
        }
        else {
            document.getElementById('txtagencypaymode').value = document.getElementById('hdndefpayment').value;
            document.getElementById('drppaymenttype').value = document.getElementById('hdndefpayment').value;
            document.getElementById('hiddenpay').value = document.getElementById('hdndefpayment').value;
            document.getElementById('hiddenbillpay').value = document.getElementById('hdndefpayment').value;
        }
        var ag = web_booking.GETCASH_PAY(document.getElementById('hiddencompcode').value, document.getElementById('drppaymenttype').value);
        var ds_n = ag.value;
        var cashdiscount = 'N';
        if (ds_n != null && ds_n.Tables[0].Rows.length > 0) {
            cashdiscount = ds_n.Tables[0].Rows[0].CASHDISCOUNT;
        }
        ///if pay mode is credit card than open the card name,its type and no div
        if (document.getElementById('drppaymenttype').value == "CA0")  //CR0 is Credit Card code
        {
            document.getElementById('cashrecvd').style.display = "";
            // document.getElementById('tdcashrecvd').style.display="";
            // document.getElementById('drpcashrecieved').value=executequery.Tables[0].Rows[0].CASH_RECIEVED;
            document.getElementById('drpcashrecieved').disabled = false;
            document.getElementById('txtcashdiscount').disabled = false;
            document.getElementById('hiddenbillpay').value = document.getElementById('drppaymenttype').value;
        }
        else if (document.getElementById('drppaymenttype').value == "CR0")  //CR0 is Credit Card code
        {
            document.getElementById('tdcarname').style.display = "";
            document.getElementById('tdtxtcarname').style.display = "";
            document.getElementById('tdtype').style.display = "";
            document.getElementById('tddrptyp').style.display = "";
            document.getElementById('tdexdat').style.display = "";

            document.getElementById('tdtxtexdat').style.display = "";
            document.getElementById('tdcardno').style.display = "";
            document.getElementById('tdtxtcarno').style.display = "";
            document.getElementById('hiddenbillpay').value = document.getElementById('drppaymenttype').value;

            //             document.getElementById('txtcardname').disabled=false;
            //            document.getElementById('drptype').disabled=false;
            //            document.getElementById('drpmonth').disabled=false;
            //            document.getElementById('drpyear').disabled=false;
            //            document.getElementById('txtcardno').disabled=false;

            document.getElementById('tdrec').style.display = "none";
            document.getElementById('receipt').style.display = "none";
            document.getElementById('print').style.display = "none";

            document.getElementById('tdchqno').style.display = "none";
            document.getElementById('tdchqdate').style.display = "none";
            document.getElementById('tdchqamt').style.display = "none";
            document.getElementById('tdbankname').style.display = "none";

            document.getElementById('tdtextchqno').style.display = "none";
            document.getElementById('tdtextchqdate').style.display = "none";
            document.getElementById('tdtextchqamt').style.display = "none";
            document.getElementById('tdtextbankname').style.display = "none";
            document.getElementById('cashrecvd').style.display = "none";

            document.getElementById("txtreceipt").value = "";
        }
        else if (document.getElementById('drppaymenttype').value == "CH0" || document.getElementById('drppaymenttype').value == "DD0" || document.getElementById('drppaymenttype').value == 'PO0')  //CR0 is Credit Card code and DD0 is demand draft
        {
            //            document.getElementById('ttextchqno').disabled = false;
            //            document.getElementById('ttextchqdate').disabled = false;
            //            document.getElementById('ttextchqamt').disabled = false;
            //            document.getElementById('ttextbankname').disabled = false;
            document.getElementById('tdchqno').style.display = "";
            document.getElementById('tdchqdate').style.display = "";
            document.getElementById('tdchqamt').style.display = "";
            document.getElementById('tdbankname').style.display = "";

            document.getElementById('tdtextchqno').style.display = "";
            document.getElementById('tdtextchqdate').style.display = "";
            document.getElementById('tdtextchqamt').style.display = "";
            document.getElementById('tdtextbankname').style.display = "";
            document.getElementById('hiddenbillpay').value = document.getElementById('drppaymenttype').value;

            document.getElementById('tdrec').style.display = "none";
            document.getElementById('receipt').style.display = "none";
            document.getElementById('print').style.display = "none";
            document.getElementById('tdcarname').style.display = "none";
            document.getElementById('tdtxtcarname').style.display = "none";
            document.getElementById('tdtype').style.display = "none";
            document.getElementById('tddrptyp').style.display = "none";
            document.getElementById('tdexdat').style.display = "none";

            document.getElementById('tdtxtexdat').style.display = "none";
            document.getElementById('tdcardno').style.display = "none";
            document.getElementById('tdtxtcarno').style.display = "none";

            document.getElementById("txtreceipt").value = "";
            document.getElementById('cashrecvd').style.display = "none";
        }
        else {
            document.getElementById('tdcarname').style.display = "none";
            document.getElementById('tdtxtcarname').style.display = "none";
            document.getElementById('tdtype').style.display = "none";
            document.getElementById('tddrptyp').style.display = "none";
            document.getElementById('tdexdat').style.display = "none";

            document.getElementById('tdtxtexdat').style.display = "none";
            document.getElementById('tdcardno').style.display = "none";
            document.getElementById('tdtxtcarno').style.display = "none";

            document.getElementById('txtcardname').value = "";
            document.getElementById('drptype').value = "0";
            document.getElementById('drpmonth').value = "0";
            document.getElementById('drpyear').value = "0";
            document.getElementById('txtcardno').value = "";
            document.getElementById("txtreceipt").value = "";

            document.getElementById('tdchqno').style.display = "none";
            document.getElementById('tdchqdate').style.display = "none";
            document.getElementById('tdchqamt').style.display = "none";
            document.getElementById('tdbankname').style.display = "none";

            document.getElementById('tdtextchqno').style.display = "none";
            document.getElementById('tdtextchqdate').style.display = "none";
            document.getElementById('tdtextchqamt').style.display = "none";
            document.getElementById('tdtextbankname').style.display = "none";

            document.getElementById('ttextchqno').value = "";
            document.getElementById('ttextchqdate').value = "";
            document.getElementById('ttextchqamt').value = "";
            document.getElementById('ttextbankname').value = "";
            document.getElementById('hiddenbillpay').value = document.getElementById('drppaymenttype').value;
            document.getElementById('cashrecvd').style.display = "none";
        }
        if (cashdiscount == 'Y') {
            document.getElementById('cashrecvd').style.display = "";
            // document.getElementById('tdcashrecvd').style.display="";
            // document.getElementById('drpcashrecieved').value=executequery.Tables[0].Rows[0].CASH_RECIEVED;
            document.getElementById('drpcashrecieved').disabled = false;
            document.getElementById('txtcashdiscount').disabled = false;
            document.getElementById('hiddenbillpay').value = document.getElementById('drppaymenttype').value;
        }
        else {
            document.getElementById('cashrecvd').style.display = "none";
        }
        ///////if pay mode is check,cash or current dated chk than show the div of receipt no and hide vts and no. of invoices
        //            if(ds.Tables[5].Rows[0].pay_mode_code=="CA0" || ds.Tables[5].Rows[0].pay_mode_code=="CH0" || ds.Tables[5].Rows[0].pay_mode_code=="DD0" || ds.Tables[5].Rows[0].pay_mode_code=="CA1")
        //            {
        //                         document.getElementById('tdrec').style.display="block";
        //                         document.getElementById('receipt').style.display="block";
        //                         document.getElementById('print').style.display="block";   
        //                         
        //////                         document.getElementById('vts').style.display="none";
        //////                         document.getElementById('tdvts').style.display="none";
        //////                         document.getElementById('invoice').style.display="none";
        //////                         document.getElementById('tdinvoice').style.display="none";

        //                         ////to generate the receipt no. auto
        //                         if(document.getElementById('receipt').style.display=="block")
        //                         {
        //                                var pre=document.getElementById("hiddenprefix").value
        //                                var suf=document.getElementById("hiddensufix").value
        //                                var center="";
        //                                var preferreceipt=document.getElementById('hiddenprereceipt').value;
        //                                
        //                                var zero="";
        //                            if(ds.Tables[6].Rows.length>0  && ds.Tables[6].Rows[0].recno!=null)
        //                            {
        //                            
        //                                var val=ds.Tables[6].Rows[0].recno;
        //                                var vallen=val.toString().length;
        //                                //val=parseInt(val)+1;
        //                                
        //                                 //var tempno = Convert.ToString(xy1);
        //                                  
        //                                if(preferreceipt=="1")
        //                               {
        //                                center=document.getElementById('txtbranch').value.substring(0,3);
        //                               
        //                               }
        //                               else if(preferreceipt=="2")
        //                               {
        //                                center=document.getElementById('txtagency').value.substring(0,3);
        //                               }
        //                               if(vallen==0)
        //                               {
        //                                zero="000000";
        //                               }
        //                               else if(vallen==1)
        //                               {
        //                                zero="00000"+val;
        //                               }
        //                                 else if(vallen==2)
        //                               {
        //                                zero="0000"+val;
        //                               }
        //                                 else if(vallen==3)
        //                               {
        //                                zero="000"+val;
        //                               }
        //                                 else if(vallen==4)
        //                               {
        //                                zero="000"+val;
        //                               }
        //                                 else if(vallen==5)
        //                               {
        //                                zero="00"+val;
        //                               }
        //                                 else if(vallen==6)
        //                               {
        //                                zero="0"+val;
        //                               }
        //                                         document.getElementById("txtreceipt").value=center+zero;
        //                                 if(preferreceipt=="3")
        //                               {
        //                                 document.getElementById("txtreceipt").value="";
        //                                document.getElementById("txtreceipt").value=pre+val+suf;
        //                               }   
        //                            }
        //                            else
        //                            {
        //                                document.getElementById("txtreceipt").value=pre+0000+suf;
        //                            }
        //                            
        //                         }
        //                         document.getElementById('hiddenreceiptno').value=document.getElementById("txtreceipt").value
        //            
        //            }
    }
    if (document.getElementById('txtagencystatus').value == "Banned") {
        alert("You Cannot book the ad with this agency");
        return false;

    }
    bind_agen_bill();

}

function bind_agen_bill() {
    var compcode = document.getElementById('hiddencompcode').value
    if (agencycodeglo != "undefined" && agencycodeglo != undefined)
        web_booking.bindbillto_ag(agencycodeglo, compcode, call_bindbillto);


}



function call_bindbillto(response) {
    ds = response.value;
    var pkgitem = document.getElementById("drpbillto");
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {
        pkgitem.options.length = 0;
        var client_val = document.getElementById('txtclient').value;
        var client_name = document.getElementById('txtclient').value;
        if (document.getElementById('txtclient').value.indexOf("(".toString()) > 0) {
            client_val = document.getElementById('txtclient').value.substring(document.getElementById('txtclient').value.lastIndexOf("(") + 1, document.getElementById('txtclient').value.length - 1); //document.getElementById('txtclient').value.substring(0,document.getElementById('txtclient').value.lastIndexOf("("));
            client_name = document.getElementById('txtclient').value.substring(0, document.getElementById('txtclient').value.lastIndexOf("("));
        }
      //pkgitem.options[0] = new Option("elect Bill", "0");
    
       
        for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
            if (ds.Tables[0].Rows[i].bill_to == "")
                pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].agency_name, ds.Tables[1].Rows[0].sub_agency_code);
            else
                pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].agency_name, ds.Tables[0].Rows[i].bill_to);
           
            pkgitem.options.length;
        }

    }
    if (ds.Tables[1].Rows.length > 0) {
        document.getElementById("drpbillto").value = ds.Tables[1].Rows[0].sub_agency_code;
        document.getElementById('hiddenbillto').value = ds.Tables[1].Rows[0].sub_agency_code;
    }
    return false;
}


function call_bindexeczone(res) {
    var ds = res.value;
    if (ds != null) {
        if (document.getElementById('drpretainer').value != '0' && document.getElementById('drpretainer').value != '' ) {
            var a = "Executive name";
            if (browser != "Microsoft Internet Explorer") {
                a = document.getElementById('lbececname').textContent.replace("*[F2]", "");
            }
            else {
                a = document.getElementById('lbececname').innerText.replace("*[F2]", "");
            }
            if (confirm('Are you sure you want to Take ' + a)) {
                document.getElementById('drpretainer').value = "";
                document.getElementById('txtRetainercomm').value = "";
            }
            else {
                document.getElementById('txtexeczone').value = "";
                document.getElementById('txtexecname').value = "";
                return false;
            }
        }
        if (ds.Tables[0].Rows.length > 0) {
            document.getElementById('txtexeczone').value = ds.Tables[0].Rows[0].zone_name
            document.getElementById('hiddenzone').value = document.getElementById('txtexeczone').value;
        }
    }
}







function changediv() {
   
    if (document.getElementById('LinkButton1').disabled == true)
        return false;


    if (document.getElementById('txtagency').value == "") {
        alert("Please fill the agency name");
        document.getElementById('txtagency').disabled = false;
        document.getElementById('txtagency').focus();
        return false;
    }


    if (document.getElementById('txtclient').value == "") {
        alert("Please fill the client name");
        document.getElementById('txtclient').disabled = false;
        document.getElementById('txtclient').focus();
        return false;
    }





        
    if (document.getElementById('drpretainer').disabled == false) {
        if (document.getElementById('drpretainer').value == "" && document.getElementById('txtexecname').value == "") {
            var a = "Executive name";
            var b = "Retainer";
            if (browser != "Microsoft Internet Explorer") {
                a = document.getElementById('lbececname').textContent.replace("*[F2]", "");
                b = document.getElementById('lblretainer').textContent.replace("*[F2]", "");
            }
            else {
                a = document.getElementById('lbececname').innerText.replace("*[F2]", "");
                b = document.getElementById('lblretainer').innerText.replace("*[F2]", "");
            }
            alert('Please fill ' + a + ' or ' + b + '.');

            document.getElementById('drpretainer').focus();
            return false;
        }
    }
   

    if (enLink == "1") {
        document.getElementById('LinkButton1').disabled = false;
        document.getElementById('LinkButton2').disabled = false;
        document.getElementById('LinkButton3').disabled = false;
        document.getElementById('LinkButton4').disabled = false;
        document.getElementById('LinkButton5').disabled = false;
//        document.getElementById('LinkButton6').disabled = false;
//        document.getElementById('LinkButton7').disabled = false;
    }
    if (document.getElementById('LinkButton1').disabled == false) {
        

        

        document.getElementById('LinkButton1').style.fontWeight = "bold";
        document.getElementById('LinkButton1').style.color = "#FFFF80";
        document.getElementById('LinkButton3').style.fontWeight = "normal";
        document.getElementById('LinkButton3').style.color = "White";
        document.getElementById('LinkButton2').style.fontWeight = "normal";
        document.getElementById('LinkButton2').style.color = "White";
        document.getElementById('LinkButton5').style.fontWeight = "normal";
        document.getElementById('LinkButton5').style.color = "White";
        document.getElementById('LinkButton4').style.fontWeight = "normal";
        document.getElementById('LinkButton4').style.color = "White";
//        document.getElementById('LinkButton6').style.fontWeight = "normal";
//        document.getElementById('LinkButton6').style.color = "White";
//        document.getElementById('LinkButton7').style.fontWeight = "normal";
//        document.getElementById('LinkButton7').style.color = "White";
        document.getElementById('tbvts').style.display = "none";
        document.getElementById('tblrate').style.display = "none";
        document.getElementById('tblbill').style.display = "none";
        
        document.getElementById('addetails').style.display = "block";
        if (document.getElementById('drpbooktype').disabled == false) {
          
            document.getElementById('drpbooktype').focus();
        }
        document.getElementById('pagedetail').style.display = "none";
      
        document.getElementById('tblpackage').style.display = "none";
        document.getElementById('tbbox').style.display = "none";
        return false;
    }
}
function changepackage() {
  
    if (document.getElementById('LinkButton5').disabled == true)
        return false;
    if (document.getElementById('txtagency').value == "") {
        alert("Please fill the agency name");
        document.getElementById('txtagency').disabled = false;
        document.getElementById('txtagency').focus();
        return false;
    }

    if (document.getElementById('txtcategory').value == "" || document.getElementById('hdncategory').value == "") {
        alert("Please Select Ad Category using F2");
        document.getElementById('txtcategory').disabled = false;
        document.getElementById('txtcategory').focus();
        return false;
    }


    if (document.getElementById('txtclient').value == "") {
        alert("Please fill the client name");
        document.getElementById('txtclient').disabled = false;
        document.getElementById('txtclient').focus();
        return false;
    }
    if (document.getElementById('LinkButton5').disabled == false) {


        if (document.getElementById('drpretainer').disabled == false) {
            if (document.getElementById('drpretainer').value == "" && document.getElementById('txtexecname').value == "") {
                var a = "Executive name";
                var b = "Retainer";
                if (browser != "Microsoft Internet Explorer") {
                    a = document.getElementById('lbececname').textContent.replace("*[F2]", "");
                    b = document.getElementById('lblretainer').textContent.replace("*[F2]", "");
                }
                else {
                    a = document.getElementById('lbececname').innerText.replace("*[F2]", "");
                    b = document.getElementById('lblretainer').innerText.replace("*[F2]", "");
                }
                alert('Please fill ' + a + ' or ' + b + '.');

                document.getElementById('drpretainer').focus();
                return false;
            }
        }


       
    
    
       
       
        if (document.getElementById('drpbooktype').value == "0") {
            alert("Please Select Booking Type");
            document.getElementById('drpbooktype').focus();
            return false;
        }


//        if (document.getElementById('txtcategory').value == "" || document.getElementById('hdncategory').value == "") {
//            alert("Please Select Ad Category");
//            document.getElementById('txtcategory').focus();
//            return false;
//        }
        
       
   
        
        if (document.getElementById('drpuom').value == "0") {
            alert("Please Select UOM");
            document.getElementById('drpuom').focus();
            return false;
        }

        document.getElementById('LinkButton5').style.fontWeight = "bold";
        document.getElementById('LinkButton5').style.color = "#FFFF80";
        document.getElementById('LinkButton1').style.fontWeight = "normal";
        document.getElementById('LinkButton1').style.color = "White";
        document.getElementById('LinkButton2').style.fontWeight = "normal";
        document.getElementById('LinkButton2').style.color = "White";
        document.getElementById('LinkButton3').style.fontWeight = "normal";
        document.getElementById('LinkButton3').style.color = "White";
        document.getElementById('LinkButton4').style.fontWeight = "normal";
        document.getElementById('LinkButton4').style.color = "White";
//        document.getElementById('LinkButton6').style.fontWeight = "normal";
//        document.getElementById('LinkButton6').style.color = "White";
//        document.getElementById('LinkButton7').style.fontWeight = "normal";
//        document.getElementById('LinkButton7').style.color = "White";
        document.getElementById('tbvts').style.display = "none";
        document.getElementById('tblrate').style.display = "none";
        document.getElementById('tblbill').style.display = "none";
        document.getElementById('addetails').style.display = "none";
        document.getElementById('pagedetail').style.display = "none";
        document.getElementById('tblpackage').style.display = "block";
        if (document.getElementById('drpcurrency').disabled == false) {
            document.getElementById('drpcurrency').focus();
        }


        if (enLink == "1") {
            document.getElementById('LinkButton1').disabled = false;
            document.getElementById('LinkButton2').disabled = false;
            document.getElementById('LinkButton3').disabled = false;
            document.getElementById('LinkButton4').disabled = false;
            document.getElementById('LinkButton5').disabled = false;
//            document.getElementById('LinkButton6').disabled = false;
//            document.getElementById('LinkButton7').disabled = false;
        }
        //document.getElementById('tblbill').style.display = "block";
        //document.getElementById('drpcurrency').focus();
        return false;
    }
}

function keySort(dropdownlist, caseSensitive) {
    
    var undefined;
    if (dropdownlist.keypressBuffer == undefined) {
        dropdownlist.keypressBuffer = '';
    }
    
    var key = String.fromCharCode(window.event.keyCode);
    dropdownlist.keypressBuffer += key;
    if (!caseSensitive) {
       
        dropdownlist.keypressBuffer = dropdownlist.keypressBuffer.toLowerCase();
    }
    
    var optionsLength = dropdownlist.options.length;
    for (var n = 0; n < optionsLength; n++) {
        var optionText = dropdownlist.options[n].text;
        if (!caseSensitive) {
            optionText = optionText.toLowerCase();
        }
        if (optionText.indexOf(dropdownlist.keypressBuffer, 0) == 0) {
            dropdownlist.selectedIndex = n;
            return false;
           
        }
    }
   
    dropdownlist.keypressBuffer = key;
    if (document.activeElement.id == "txtcategory")
        filladsubcatmain();
    else if (document.activeElement.id == "drpadsubcategory")
        bindadscat3();
    else if (document.activeElement.id == "drpadcat3")
        bindadscat4();
    else if (document.activeElement.id == "drpadcat4")
        bindadcat5();
    return true; 
} 





function checkro() {
    if (document.getElementById('txtrono').value == "" && document.getElementById('hiddockit').value == 'y') {
        if (confirm('Are you sure you want to create Dokit Booking?')) {
            document.getElementById('drprostatus').value = "2";
        }
        else {
            document.getElementById('txtrono').focus();
        }

    }
}






function filladcategory(event) {
    if (event.keyCode == "113") {
        if (document.activeElement.id == "txtcategory") {
            var divid = "divadcategory";
            var listboxid = "lstadcategory";
            var extra1 = document.getElementById('hiddencompcode').value;
            var ds = web_booking.advcat(extra1)
            if (ds == null)
                return false;
            var objadscat = document.getElementById(listboxid);
            objadscat.options.length = 0;
            objadscat.style.width = "254px"
            objadscat.options[0] = new Option("-Select Ad Category-", "0");

            objadscat.options.length = 1;
            for (var i = 0; i < ds.value.Tables[0].Rows.length; ++i) {
                objadscat.options[objadscat.options.length] = new Option(ds.value.Tables[0].Rows[i].Adv_Cat_Code + "-" + ds.value.Tables[0].Rows[i].Adv_Cat_Name, ds.value.Tables[0].Rows[i].Adv_Cat_Code);
                objadscat.options.length;
            }
            aTag = eval(document.getElementById('txtcategory'))
            var btag;
            var leftpos = 0;
            var toppos = 0;
            do {
                aTag = eval(aTag.offsetParent);
                leftpos += aTag.offsetLeft;
                toppos += aTag.offsetTop;
                btag = eval(aTag)
            } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
            var tot = document.getElementById('lstadcategory').scrollLeft;
            var scrolltop = document.getElementById('lstadcategory').scrollTop;
            document.getElementById(divid).style.left = document.getElementById('txtcategory').offsetLeft + leftpos - tot + "px";
            document.getElementById(divid).style.top = document.getElementById('txtcategory').offsetTop + toppos - scrolltop + "px"; //"510px";

            document.getElementById(divid).style.display = "block";
            document.getElementById('lstadcategory').focus();
        }
    }
    else if (event.keyCode == 8 || event.keyCode == 46) {
        document.getElementById('txtcategory').value = "";


        return true;
    }

    else if (event.ctrlKey == true && event.keyCode == 88) {
    document.getElementById('txtcategory').value = "";
    document.getElementById('hdncategory').value = "";
      

        return true;
    }
}

function onclickadcategory(event) {
    var key = event.keyCode ? event.keyCode : event.which;
    if (key == 13 || event.type == "click") {
        if (document.activeElement.id == "lstadcategory") {
            if (document.getElementById('lstadcategory').value == "0") {
                alert("Please select the Ad Category");
                return false;
            }
            document.getElementById("divadcategory").style.display = "none";
            var page = document.getElementById('lstadcategory').value;
            agencycodeglo = page;
            for (var k = 0; k <= document.getElementById('lstadcategory').length - 1; k++) {
            
                if (document.getElementById('lstadcategory').options[k].value == page) {
                    if (browser != "Microsoft Internet Explorer") {
                        var abc = document.getElementById('lstadcategory').options[k].textContent;
                    }
                    else {
                        var abc = document.getElementById('lstadcategory').options[k].innerText;
                    }
                    var splitpub = abc;
                    var str = splitpub.split("-");
                    abc = str[0];
                    xyz = str[1];
                    uvw = str[2];
                    var abc2 = str[0];

                    document.getElementById('txtcategory').value = xyz + "(" + abc + ")";
                    document.getElementById('hdncategory').value = abc;

                    bindrategroupvode();
                    document.getElementById('txtcategory').focus()
                   

                    return false;
                }
            }
        }

    }

    else if (event.keyCode == 27) {
        document.getElementById("divadcategory").style.display = "none";
        document.getElementById('txtcategory').focus();
    }
}




function Btncopyclick() {

 
    var obj = document.getElementById('drppackage');
    if (obj.value == "0") {
        alert("Please select the package");
        obj.focus();
        return false;
    }
    for (var x = 0; x < obj.options.length; x++) {
        if (obj.options[x].selected == true) {
            drppack = obj.options[x].value;
            addpkgname();
        }
    }
   
    return false;
}



function tooltipadsubcat() {
    var compcode = document.getElementById('hiddencompcode').value;
    if (document.getElementById('bookdiv') != null) {
        var len = "bookdiv";
        var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
        var k;
        var adsubcat;
        var i = 0;
        var adsubcategoryval = document.getElementById('drpadsubcategory').value;
        for (k = 0; k < y - 1; k++) {

            adsubcat = "ads" + i;
            var adsubcategoryval = document.getElementById(adsubcat).value
            if (adsubcategoryval != null && adsubcategoryval != "" && adsubcategoryval != "0") {
                var res = web_booking.bindtootipsubcat(adsubcategoryval, compcode)
                var ds = res.value;
                if (ds.Tables[0].Rows[0].Adv_Subcat_Name != null || ds.Tables[0].Rows[0].Adv_Subcat_Name != "") {
                    document.getElementById(adsubcat).title = ds.Tables[0].Rows[0].Adv_Subcat_Name;
                }

            }
            i = parseInt(i) + 1;

        }
    }
}




function addpkgname() {


    document.getElementById('txtcardrate').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";

    var obj = document.getElementById('drppackagecopy');
    var cF = 0;
    for (var x = 0; x < obj.options.length; x++) {
       
        if (drppack == obj[x].value.substring(0, obj[x].value.lastIndexOf('('))) {
            cF = 1;
        }
    }
    var dCheck = true;
    if (cF == 0)
      
    if (dCheck == false)
        return false;

    subtractrow = "";
    for (var x = 0; x < obj.options.length; x++) {
       
        if (drppack == obj[x].value.substring(0, obj[x].value.lastIndexOf('('))) {
          
            var insertCount = 1;
            if (obj[x].value.indexOf('(') >= 0) {
                insertCount = obj[x].value.substring(obj[x].value.lastIndexOf('(') + 1, obj[x].value.length - 1);
            }
            var _val = getInsert(obj[x].value.substring(0, obj[x].value.lastIndexOf('@')));
            if (_val != "" && _val != null && _val != "0")
                insertCount = parseInt(insertCount) + parseInt(_val);
            else
                insertCount = parseInt(insertCount) + 1;
            obj[x].value = obj[x].value.substring(0, obj[x].value.lastIndexOf('(')) + '(' + insertCount + ')';
            obj[x].text = obj[x].text.substring(0, obj[x].text.lastIndexOf('(')) + '(' + insertCount + ')';
            onInsertionChange('');
            return false;
        }
    }

    var strid = drppack;
    var compcode = document.getElementById('hiddencompcode').value;
    var strid1 = strid.split('@');
    var pkgid = strid1[0];
    var pkgname = strid1[1];
    glpkgname = pkgname;
    var value = "0";
    var dateday = "";
    var strtext = "";
    var code = "";
    var desc = "";


    if (browser != "Microsoft Internet Explorer") {
    
   
        var httpRequest = null;
        httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml');
        }
       

        httpRequest.onreadystatechange = function() { alertContents(httpRequest) };

       
        var adcat = "";
 
        httpRequest.open("GET", "packagename.aspx?adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + value + "&pkgname=" + pkgname + "&dateday=" + dateday, false);
        httpRequest.send('');
       
        if (httpRequest.readyState == 4) {
            if (httpRequest.status == 200) {
                strtext = httpRequest.responseText;
            }
            else {
                alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
            }
        }
    }
    else {
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
       
        var adcat = "";
        xml.Open("GET", "packagename.aspx?adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + value + "&pkgname=" + pkgname + "&dateday=" + dateday, false);
        xml.Send();
        strtext = xml.responseText;
    }
    if (strtext == "NOT A VALID DATE") {
        alert("NOT A VALID DATE");
        return false;
    }
   
    if (document.getElementById('drppackagecopy').options.length == 0) {
        che_flag = 0;
    }
    if (che_flag == 1) {
        alert("Can't select multiple Package");
        return false;
    }
    else if ((document.getElementById('drppackagecopy').options.length > 0) && (pkgname.indexOf(" or ") >= 0)) {
        alert("Can't select this Package");
        return false;
    }
    else {
        if (pkgname.indexOf(" or ") >= 0) {
            che_flag = 1;
            web_booking.bindTable(pkgname, bindTable_callback);
            check_or = "1";
        }
        var val_ = "";
        var agencytype = "WE0"; 
        if (browser != "Microsoft Internet Explorer") {
            var httpRequest = null; ;
            httpRequest = new XMLHttpRequest();
            if (httpRequest.overrideMimeType) {
                httpRequest.overrideMimeType('text/xml');
            }

            httpRequest.onreadystatechange = function() { alertContents(httpRequest) };

            httpRequest.open("GET", "gettheinsertionfromcombin.aspx?desc=" + glpkgname + "&code=" + pkgid + "&agencytype=" + agencytype, false);
            httpRequest.send('');
          
            if (httpRequest.readyState == 4) {
                
                if (httpRequest.status == 200) {
                    val_ = httpRequest.responseText;
                }
                else {
                    alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                }
            }
        }
        else {
            var xml = new ActiveXObject("Microsoft.XMLHTTP");
            xml.Open("GET", "gettheinsertionfromcombin.aspx?desc=" + glpkgname + "&code=" + pkgid + "&agencytype=" + agencytype, false);
            xml.Send();
            val_ = xml.responseText;
        }

        var insertO = document.getElementById('txtinsertion').value;
        document.getElementById('tempinsert').value = document.getElementById('txtinsertion').value;
        if (document.getElementById('tempinsert').value == "")
            document.getElementById('tempinsert').value = 1;
        if (insertO == "")
            insertO = 1;
        if (val_ != "" && val_ != "0" && val_ != null) {
            document.getElementById('txtinsertion').value = val_


        }
        if (che_flag == 0) {
            if (strtext != "0") {
                AddItem(document.getElementById('drppackagecopy'), strtext, strid, val_);
            }
            document.getElementById('txtdummydate').focus();
        }
        document.getElementById('txtinsertion').value = insertO;
    }

  
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    return false;
}


function AddItem(objListBox, strText, strId, val_) {

   
    suboradd = "1";
    previnsertion = "0";
    getid = "";
    if (strText.indexOf('(') < 0) {
        strText = strText + '(1)';
        strId = strId + '(1)';
    }

    if (objListBox.length > 0) {

        var arr = new Array();
        var arr1 = new Array();
        for (j = 0; j <= objListBox.length - 1; j++) {
          
            arr[j] = objListBox.options[j].text;
            arr1[j] = objListBox.options[j].value;
           
        }

        for (k = objListBox.length - 1; k >= 0; k--)
       
        {objListBox.remove(k); }

        var opt = document.createElement("OPTION");
        opt.text = strText;
        opt.value = strId;
        objListBox.options.add(opt);

        var x = 0;
        for (x in arr) {
            if (x == "remove") {
                var option = document.createElement("OPTION");
                option.text = arr[0];
                option.value = arr1[0];
                objListBox.options.add(option);
            }
        }


    }
    else {
        
        var opt = document.createElement("OPTION");
        opt.text = strText;
        opt.value = strId;
        objListBox.options.add(opt);


    }
    if (val_ != "" && val_ != "0" && val_ != null) {
        var obj = document.getElementById('drppackagecopy');
        for (var x = 0; x < obj.options.length; x++) {
            if (document.getElementById('drppackage').value == obj[x].value.substring(0, obj[x].value.lastIndexOf('('))) {
                // alert("This package is already shifted");
                var insertCount = val_;
                var insertCount1 = 0;
                if (obj[x].value.indexOf('(') >= 0) {
                    insertCount1 = obj[x].value.substring(obj[x].value.lastIndexOf('(') + 1, obj[x].value.length - 1);
                    insertCount1 = parseInt(insertCount1) - 1;
                }
                insertCount = parseInt(insertCount) + parseInt(insertCount1);
                obj[x].value = obj[x].value.substring(0, obj[x].value.lastIndexOf('(')) + '(' + insertCount + ')';
                obj[x].text = obj[x].text.substring(0, obj[x].text.lastIndexOf('(')) + '(' + insertCount + ')';
                x = obj.options.length;
            }
        }
    }
    //====//
    document.getElementById('hiddencalendar').value = "0";
    document.getElementById('txtrepeatingdate').value = "";

    insertLinedrop();
    




}



function insertLinedrop() {


    caldate = null;
    caldate = new Array();
    caldatemonth = null;
    caldatemonth = new Array();
    caldateyear = null;
    caldateyear = new Array();
    if (document.getElementById('hiddensavemod').value != "1" && document.getElementById('drppackage').value != "0") {
        if (document.getElementById('txtinsertion').value == "")
            document.getElementById('txtinsertion').value = "1";
        document.getElementById('txtpaid').value = "1";
        //document.getElementById('txtratecode').value="0";
        document.getElementById('txtcardrate').value = "";
        document.getElementById('txtcardamt').value = "";
        document.getElementById('txtagreedrate').value = "";
        document.getElementById('txtagreedamt').value = "";
        document.getElementById('txtdiscount').value = "";
        document.getElementById('txtdiscpre').value = "";
        //document.getElementById('txtspedisc').value="";
        //document.getElementById('txtspediscper').value="";
        document.getElementById('txtspacedisc').value = "";
        document.getElementById('txtspadiscper').value = "";
        document.getElementById('txtextracharges').value = "";
        document.getElementById('txtspedisc').value = "";
        document.getElementById('txtspediscper').value = "";
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtbillamt').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        document.getElementById('txtdealrate').value = "";
        document.getElementById('txtdeviation').value = "";
        if (document.getElementById('drppackagecopy').options.length == 0) {
            document.getElementById('txtdummydate').value = "";
        }

        //////////////this funtion is to open the deal type on package change when prefeerrence is set to yes
        //////////////////////////////////////////////////////////////////////////////////////////////////////

        var objpack = document.getElementById('drppackagecopy');
        var temp = "";
        var tempcode = "";
        var tempval = "";
        var tempvalcode = "";
        var desc = "";
        var code = "";
        var i = objpack.options.length;
        var j;

        for (j = 0; j < i; j++) {
            if (parseInt(i) > 0) {
                tempval = objpack[j].value;
                //tempvalcode=objpack[j].value;
                if (temp != "") {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    cyop_code = tempvalcode + "^" + cyop_code;
                    cyop_desc = tempcode + "^" + cyop_desc;
                    code = tempvalcode + "," + code;
                    desc = tempcode + "," + desc;
                }
                else {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    code = tempvalcode;
                    desc = tempcode;
                    cyop_code = tempvalcode;
                    cyop_desc = tempcode;
                }
            }

        }
    
        document.getElementById('hiddenpackage').value = code;
        var insert = document.getElementById('hiddeninserts').value;

        if (che_flag == 1) {
            desc = document.getElementById('hidval').value;
        }
        var class_insert = document.getElementById('txtinsertion').value;
        var lines_to;
      
        
            lines_to = document.getElementById('txttotalarea').value;
       





        var adcat3 = ""; 
     var adcat4 ="";
   var adcat5 = "";

        var clientname = document.getElementById('txtclient').value;
        var client_split;
        if (clientname.indexOf("(") >= 0) {
            clientname = clientname.split("(");
            client_split = clientname[1];
            client_split = client_split.replace(")", "");
            clientname = client_split;

        }
        if (document.getElementById('txtinsertion').value == null || document.getElementById('txtinsertion').value == "null") {
            document.getElementById('txtinsertion').value = "1";
        }
        if (document.getElementById('tempinsert').value == null || document.getElementById('tempinsert').value == "null") {
            document.getElementById('tempinsert').value = "1";
        }
        // class_insert = document.getElementById('tempinsert').value;

        var adcategory = "";
        var drpadsubcategory = "";
        var drpcolor = "";
        var hiddenclickdate = "";
        var ds_drop = web_booking.getData(desc, document.getElementById('tempinsert').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, adcategory, drpadsubcategory, drpcolor, "WE0", document.getElementById('drpcurrency').value, document.getElementById('txtratecode').value, hiddenclickdate, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, "", class_insert, lines_to, adcat3, adcat4, adcat5, clientname);
  
        insertLinedrop_callback(ds_drop);
    
        return;
    }
    
    
    

    return;
}






function notchar2() {
    insert = document.getElementById('txtinsertion').value;
    if ((event.keyCode >= 48 && event.keyCode <= 57) || (event.keyCode == 127) || (event.keyCode == 8) || (event.keyCode == 9) || (event.keyCode == 46)) {
        if (document.activeElement.id == 'txtinsertion' && event.keyCode == 46)
            return false;
        else
            return true;
    }
    else {
        return false;
    }
}




function removepkgname() {

    if (document.getElementById('drppackagecopy').options.length == 0) {
        alert("There is no item to delete");
        return false;

    }

    else if (document.getElementById('drppackagecopy').value == "") {
        alert("Please select the package for delete");
        document.getElementById('chktfn').focus();
        return false;
    }
    var strId = document.getElementById('drppackagecopy').value;

    // insertLinesubtract_callback(strId,'child');
    RemoveItem(document.getElementById('drppackagecopy'), strId);
    if (document.getElementById('drppackagecopy').options.length != 0) {
        document.getElementById('hiddencalendar').value = "0";
        insertLinedrop();
    }
    else {
        document.getElementById('tblinsert').innerHTML = "";
        document.getElementById('hiddencalendar').value = "0";
        //document.getElementById('drpscheme').value="0";
        document.getElementById('drpscheme').value = "0";
        globalschemedisc = "";
        check_or = "0";
        document.getElementById('tempinsert').value = "";
    }
    if (document.getElementById('drppackagecopy').options.length == 0) {
        agreedrate_active = 0;
        agreedamt_active = 0;
        cali = 0;
        sharepub = "";
        dummydate = "";
        arrEdition_Item = '';
        document.getElementById('txtdummydate').value = "";
        document.getElementById('tempinsert').value = "";
        caldate = null;
        caldate = new Array();
        caldatemonth = null;
        caldatemonth = new Array();
        caldateyear = null;
        caldateyear = new Array();
       
    }
    return false;
}



function RemoveItem(objListBox, strId) {
    var intIndex = GetItemIndex(objListBox, strId);
    if (strId.indexOf('(') >= 0) {
        var no = strId.substring(strId.lastIndexOf('(') + 1, strId.lastIndexOf(')'));
        var pkgcode = strId.substring(0, strId.lastIndexOf('@'));
        if (parseInt(no) != 1) {
            var _val = getInsert(pkgcode);
            if (_val != "" && _val != "0" && _val != null) {
                no = parseInt(no) - parseInt(_val);
            }
            else {
                no = parseInt(no) - 1;
            }
            if (no == 0) {
                if (intIndex != -1) {
                    objListBox.remove(intIndex);

                }
            }
            else {
                objListBox.options[intIndex].value = objListBox.options[intIndex].value.substring(0, objListBox.options[intIndex].value.lastIndexOf('(')) + '(' + no + ')';
                objListBox.options[intIndex].text = objListBox.options[intIndex].text.substring(0, objListBox.options[intIndex].text.lastIndexOf('(')) + '(' + no + ')';

            }
        }
        else {
            if (intIndex != -1)
                objListBox.remove(intIndex);
        }
    }
    else {
        if (intIndex != -1)
            objListBox.remove(intIndex);
    }
}


function GetItemIndex(objListBox, strId) {
    for (var i = 0; i < objListBox.children.length; i++) {
        var strCurrentValueId = objListBox.children[i].value;
        if (strId == strCurrentValueId) {
            return i;
        }
    }
    return -1;
}




function getInsert(code) {
    if (browser != "Microsoft Internet Explorer") {
        var httpRequest = null; ;
        httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml');
        }

        httpRequest.onreadystatechange = function() { alertContents(httpRequest) };

        httpRequest.open("GET", "gettheinsertionfromcombin.aspx?desc=&code=" + code + "&agencytype=WE0", false);
        httpRequest.send('');
        //alert(httpRequest.readyState);
        if (httpRequest.readyState == 4) {
            //alert(httpRequest.status);
            if (httpRequest.status == 200) {
                val_ = httpRequest.responseText;
            }
            else {
                alert('There was a problem with the request.');
            }
        }
    }
    else {
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        xml.Open("GET", "gettheinsertionfromcombin.aspx?desc=&code=" + code + "&agencytype=WE0", false);
        xml.Send();
        val_ = xml.responseText;

    }
    return val_;
}



function onInsertionChange(actid) {
    document.getElementById('tempinsert').value = document.getElementById('txtinsertion').value;
    if (document.getElementById('txtinsertion').value == "0" || document.getElementById('txtinsertion').value == "") {
        alert("Insertion can't be 0 OR blank");
        return false;
    }
    if (document.getElementById('txtinsertion').value != "" && document.getElementById('bookdiv') != null && document.getElementById('txtinsertion').value != "0") {
        if (actid == "txtinsertion")
            subtractrow = "show";
        if (document.getElementById('hiddensavemod').value == "01") {
            if (parseInt(document.getElementById('hiddenmodifyinsert').value) > parseInt(document.getElementById('txtinsertion').value)) {
                alert('You Cannot Decrease insertions(Please Cancel Booking..)!');
                return false;
            }
        }

        if (previnsertion == '') {
            previnsertion = document.getElementById('txtinsertion').value;
        }
        document.getElementById('txtgrossamt').value = '';
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        if (document.getElementById('txtinsertion').value != "") {
            insert = document.getElementById('txtinsertion').value;
        }
//        var adcat3 = document.getElementById('drpadcat3').value;anuj
//        var adcat4 = document.getElementById('drpadcat4').value;
//        var adcat5 = document.getElementById('drpadcat5').value;
        var clientname = document.getElementById('txtclient').value;
        var client_split;
        if (clientname.indexOf("(") >= 0) {
            clientname = clientname.split("(");
            client_split = clientname[1];
            client_split = client_split.replace(")", "");
            clientname = client_split;
        }
        //////////////this code is to split the code as well as ites description
        var ins = parseInt(document.getElementById('txtinsertion').value, 10);
        document.getElementById('txtinsertion').value = ins;
        ///////this is to get the value into paid ins. text b0x
        if (document.getElementById('txtpaid').value != "" && document.getElementById('txtinsertion').value != "") {
            var paidno = document.getElementById('txtpaid').value;
            var valinsert = document.getElementById('txtinsertion').value;
            document.getElementById('txtpaid').value = (parseInt(valinsert, 10) - parseInt(paidno, 10)) + parseInt(paidno, 10);
        }
        var count1 = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
        for (var j1 = 0; j1 < count1; j1++) {
            var paid = document.getElementById("pai" + j1);
            if (paid != null) {
                paid.value = 'Y';
            }
        }
        var objpack = document.getElementById('drppackagecopy');
        var temp = "";
        var tempcode = "";
        var tempval = "";
        var tempvalcode = "";
        var desc = "";
        var code = "";
        var i = objpack.options.length;
        var j;

        for (j = 0; j < i; j++) {
            if (parseInt(i) > 0) {
                tempval = objpack[j].value;
                //tempvalcode=objpack[j].value;
                if (temp != "") {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    code = tempvalcode + "," + code;
                    desc = tempcode + "," + desc;
                }
                else {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    code = tempvalcode;
                    desc = tempcode;
                }
            }
        }


        //////////////////////////////////////////////////////////////////

        document.getElementById('drpscheme').value = "";
        if (document.getElementById('txtrepeatingdate').value != "") {
            var insertval = document.getElementById('txtinsertion').value
            if (parseInt(document.getElementById('txtinsertion').value) == 1) {
                //alert("In case of Insertion 1Repeating Day can't be greater than 1")
                if (document.getElementById('drppackagecopy').options.length > 0) {
                    for (var insertCou = 0; insertCou < document.getElementById('drppackagecopy').options.length; insertCou++) {
                        if (document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') >= 0) {
                            var tinsert = document.getElementById('drppackagecopy').options[insertCou].value.substring(document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') + 1, document.getElementById('drppackagecopy').options[insertCou].value.indexOf(')'));
                            if (tinsert > 1)
                                break;
                        }
                    }
                }
                if (tinsert <= 1) {
                    document.getElementById('txtrepeatingdate').value = "";
                    // return false;   //***
                }
            }

            repeatdate = "1";
            suboradd = "1";
        }
        else {
            repeatdate = "0";
            suboradd = "1";
        }


        var insert = desc.substring(desc.indexOf('(') + 1, desc.indexOf(')'));
        insert = parseInt(insert, 10) * parseInt(document.getElementById('txtinsertion').value, 10);
        if (parseInt(insert, 10) > parseInt(previnsertion, 10)) {
            suboradd = "1";
        }
        if (parseInt(previnsertion) > parseInt(insert, 10)) {
            repeatdate = "1";
            suboradd = "0";
        }
        if (repeatdate == "1") {
            //document.getElementById('tblinsert').innerHTML="";
            subtractrow = "";
        }
        var insert = document.getElementById('hiddeninserts').value;
        var class_insert = document.getElementById('txtinsertion').value;
        var lines_to;
       
            lines_to = document.getElementById('txttotalarea').value;
  
        //if(document.getElementById('tblinsert').innerHTML=="")
        if (subtractrow == "") {

            //web_booking.getData(document.getElementById('drppackage').value,document.getElementById('txtinsertion').value,document.getElementById('txtrepeatingdate').value,document.getElementById('txtdummydate').value,document.getElementById('hiddendateformat').value,document.getElementById('hiddencompcode').value,insertLinedrop_callback);    
            if (suboradd == "1") {
                if (parseInt(document.getElementById('txtinsertion').value, 10) > parseInt(previnsertion, 10) && chkbtnStatus != "new") {
                    var repeatdate_vari = "";
                    if (document.getElementById('txtrepeatingdate').value == "" && parseInt(document.getElementById('txtinsertion').value, 10) > 1)
                        repeatdate_vari = "1";
                    else
                        repeatdate_vari = document.getElementById('txtrepeatingdate').value;
                    var ds_linedrop = web_booking.getData(desc, document.getElementById('tempinsert').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, adcategory, drpadsubcategory, drpcolor, "WE0", document.getElementById('drpcurrency').value, document.getElementById('txtratecode').value, hiddenclickdate, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, "", class_insert, lines_to, adcat3, adcat4, adcat5, clientname);
                    insertLine_callback_1(ds_linedrop);
                }
                else {
                    if (document.getElementById('chktfn').checked == false) {
                        document.getElementById('tblinsert').innerHTML == ""
                        if (che_flag == 1) {
                            desc = document.getElementById('hidval').value;
                        }
                        // previnsertion=document.getElementById('txtinsertion').value;
                        var repeatdate_vari = "";
                        if (document.getElementById('txtrepeatingdate').value == "" && parseInt(document.getElementById('txtinsertion').value, 10) > 1)
                            repeatdate_vari = "1";
                        else
                            repeatdate_vari = document.getElementById('txtrepeatingdate').value;

                        var adcategory = "";
                        var drpadsubcategory = "";
                        var hiddenclickdate = "";
                        var adcat3 = "";
                        var adcat4 = "";
                        var adcat5 = "";
                        var ds_drop = web_booking.getData(desc, document.getElementById('tempinsert').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, adcategory, drpadsubcategory, "", "WE0", document.getElementById('drpcurrency').value, document.getElementById('txtratecode').value, hiddenclickdate, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, "", class_insert, lines_to, adcat3, adcat4, adcat5, clientname);
                        insertLinedrop_callback(ds_drop);
                    }
                    else {
                        document.getElementById('tblinsert').innerHTML == ""
                        if (che_flag == 1) {
                            desc = document.getElementById('hidval').value;
                        }
                        // previnsertion=document.getElementById('txtinsertion').value;
                        var repeatdate_vari = "";
                        if (document.getElementById('txtrepeatingdate').value == "" && parseInt(document.getElementById('txtinsertion').value, 10) > 1)
                            repeatdate_vari = "1";
                        else
                            repeatdate_vari = document.getElementById('txtrepeatingdate').value;
                        var adcategory = "";
                        var drpadsubcategory = "";
                        var hiddenclickdate = "";
                        var adcat3 = "";
                        var adcat4 = "";
                        var adcat5 = "";
                        var ds_drop = web_booking.getData(desc, document.getElementById('tempinsert').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, adcategory, drpadsubcategory, "", "WE0", document.getElementById('drpcurrency').value, document.getElementById('txtratecode').value, hiddenclickdate, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, "", class_insert, lines_to, adcat3, adcat4, adcat5, clientname);
                        insertLinedrop_callback(ds_drop);
                    }
                }
            }
            else {
                if (che_flag == 1) {
                    desc = document.getElementById('hidval').value;
                }
                insertLinesubtract_callback("", 'main');
            }
        }
        else {
        
        
        
          if (che_flag == 1) {
                desc = document.getElementById('hidval').value;
            }
            if (chkbtnStatus != "new") {
                var ds_linedrop = web_booking.getData(desc, document.getElementById('txtinsertion').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('txtcategory').value, "", "B", document.getElementById('hiddenadtype').value, document.getElementById('drpcurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, "", document.getElementById('drppageprem').value, clientname, "", "", "","","");
                insertLine_callback(ds_linedrop);
            }
            else {
                checkflag = "2";
                var ds_linedrop = web_booking.getData(desc, document.getElementById('txtinsertion').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('txtcategory').value, "", "B", document.getElementById('hiddenadtype').value, document.getElementById('drpcurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, "", document.getElementById('drppageprem').value, clientname, "", "", "","","");
                insertLine_callback(ds_linedrop);}
        
        
        
        
        
        
////            if (che_flag == 1) {
////                desc = document.getElementById('hidval').value;
////            }
////            var repeatdate_vari = "";
////            if (document.getElementById('txtrepeatingdate').value == "" && parseInt(document.getElementById('txtinsertion').value, 10) > 1)
////                repeatdate_vari = "1";
////            else
////                repeatdate_vari = document.getElementById('txtrepeatingdate').value;
////            var adcategory = "";
////            var drpadsubcategory = "";
////            var hiddenclickdate = "";
////            var adcat3 = "";
////            var adcat4 = "";
////            var adcat5 = "";
////            var ds_linedrop = web_booking.getData(desc, document.getElementById('tempinsert').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, adcategory, drpadsubcategory, "", "WE0", document.getElementById('drpcurrency').value, document.getElementById('txtratecode').value, hiddenclickdate, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, "", class_insert, lines_to, adcat3, adcat4, adcat5, clientname);
////            insertLinedrop_callback(ds_linedrop);
////            ///////}
        }
    }
}

var temped;




function insertLinedrop_callback(response) {


    caldate = null;
    caldate = new Array();
    caldatemonth = null;
    caldatemonth = new Array();
    caldateyear = null;
    caldateyear = new Array();
    var ds = response.value;
    document.getElementById('txtrepeatingdate').value = "";
   
    if (ds == null) {
        alert("There is Some Network Error. Please Do the Booking Again");
        return false;
    }

    var uom_vari = document.getElementById('drpuom');

    var matsta_vari = document.getElementById('drpmatsta');
    var drppagepos_vari = document.getElementById('drpposition');
    var adcat_vari = document.getElementById('hdncategory'); 
    var pkgcopy_vari = document.getElementById('drppackagecopy');
    noofinsert = ds.Tables[0].Rows.length;
    noofinsertlo = ds.Tables[0].Rows.length;
    gridItemCount = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value);
    fillinsert = ds.Tables[0].Rows.length;

    var getinsval = document.getElementById('txtinsertion').value;
    var totval = parseInt(noofinsert) / parseInt(getinsval);

    var dat = "mm+" / "+" / "+dd+" / "+yyyy";
    var i = 0;
    var j = 0;
    var k = 0;
    var l = 0;
    var m = 0;
    var n = 0;
    var o = 0;
    var p = 0;
    var str = "";
    var premid;
    var premper;
   
    var height;
    var width;
   
    var uomid;
    var adtypid;
    var cardid;
    var editid;
    var solorate;
    var premper1;
    var prem1id;
    var namecode;
    var inserts;
    var pagepost;
    var preall;
    var adcat;
    var adsubcat;
    var size;
    var matsta;
    var filename;
    var discrate;
    var insertsta;
    var billstat;
    var repeat;
    var picfield;

    var paid;
    var agrred;
    var solo;
    var gross;
    var pageno_inserts;
    var caption_inserts;
    var remark_inserts;
    var page;
    var pageprem;
    var noofcol;
    var billamt;
    var billrate;
    var agnamnt;
    var adlagn;
    var spldisc;
    var cashdisc;
    var roundoffval;
    var pagstr = "";
    var prm;

    var dcat1 = "";
    var dcol = "";
    var dinsert = "";
    var dstatus = "";
    var dposition = "";
    var dprem1 = "";
    var dpre = "";
    var dmcat = "";
    var dbill = "";
    var dadcat3 = "";
    var dadcat4 = "";
    var dadcat5 = "";
    var dpaid = "";
    var dcou = "";
    var matsta = "";
var aa="";

    if (document.getElementById('drpuom').value == "CPC") {


        aa = "No of click";



    }


    if (document.getElementById('drpuom').value == "CPD") {


        aa = "No of Days";



    }


    if (document.getElementById('drpuom').value == "CPM") {


        aa = "No of Impression";



    }
    if (document.getElementById('drpuom').value == "MO0") {


        aa = "Area";



    }

    str = "<div id=\"bookdiv\" runat=\"server\" style=\"OVERFLOW: auto; WIDTH: 896px; HEIGHT: 160px; \"><table cellpadding=\"1\" cellspacing=\"1\" id=\"gridtab\" width=\"1000px\" border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\"><td align=\"center\" valign=\"top\" >No.</td><td align=\"center\" valign=\"top\" >Edition</td><td valign=\"top\" align=\"center\">Start Date</td><td valign=\"top\" align=\"center\">Expiry Date</td><td align=\"center\" valign=\"top\">Ad Sub Cat.</td><td align=\"center\" valign=\"top\" id=\"siz\">" + aa + "</td><td valign=\"top\" id='uploadA' style=\"cursor:pointer;color:red;\"   onclick=\"uploadimageall()\" >Upload</td><td align=\"center\" valign=\"top\">Insertion Sta.</td>";

    str = str + "<td align=\"center\" valign=\"top\">Card Rate</td><td valign=\"top\" align=\"center\">Disc. Rate</td><td valign=\"top\" align=\"center\">Agreed Amt</td><td align=\"center\" valign=\"top\">File Name</td><td valign=\"top\">Material</td><td valign=\"top\">Additional Info</td>";

    if (browser!= "Microsoft Internet Explorer") {
        str = str + "<td align=\"center\" valign=\"top\">Premium 1</td><td align=\"center\" valign=\"top\">Position Premium</td><td align=\"center\" valign=\"top\">Pre(%)</td>";

        str = str + "<td align=\"center\" valign=\"top\">Adv Cat.</td>";


        str = str + "<td valign=\"top\">Discount</td><td valign=\"top\">Paid</td><td valign=\"top\">Paid Ins.</td><td valign=\"top\" >Solo Rate</td><td valign=\"top\" >Local Gross Amt</td><td valign=\"top\" >Page No.</td><td valign=\"top\" >Caption</td><td valign=\"top\" >Remarks</td><td valign=\"top\" >Local Bill Amt</td><td valign=\"top\" >Gross Amt</td><td valign=\"top\" >Bill Amt</td><td valign=\"top\" >Page Setup</td>";

      
    }
    else {
        str = str + "<td align=\"center\" valign=\"top\">Premium 1</td><td align=\"center\" valign=\"top\">Position Premium</td><td align=\"center\" valign=\"top\">Pre(%)</td>";
      
        str = str + "<td align=\"center\" valign=\"top\">Adv Cat.</td>";


        str = str + "<td valign=\"top\">Discount</td><td valign=\"top\">Paid</td><td valign=\"top\">Paid Ins.</td><td valign=\"top\" >Solo Rate</td><td valign=\"top\" >Local Gross Amt</td><td valign=\"top\" >Page No.</td><td valign=\"top\" >Caption</td><td valign=\"top\" >Remarks</td><td valign=\"top\" >Local Bill Amt</td><td valign=\"top\" >Gross Amt</td><td valign=\"top\" >Bill Amt</td><td valign=\"top\" >Page Setup</td>";

    }
    if (browser != "Microsoft Internet Explorer") {
        if (xmlObj.childNodes[25].childNodes[15].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >Agn Amt</td>";
        }
        if (xmlObj.childNodes[25].childNodes[17].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >AdlAgn Amt</td>";
        }
        if (xmlObj.childNodes[25].childNodes[19].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >Spldisc</td>";
        }
        if (xmlObj.childNodes[25].childNodes[21].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >CashDisc</td>";
        }
        if (xmlObj.childNodes[25].childNodes[23].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >Round off</td>";
        }
    }
    else {
        if (xmlObj.childNodes[12].childNodes[7].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >Agn Amt</td>";
        }
        if (xmlObj.childNodes[12].childNodes[8].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >AdlAgn Amt</td>";
        }
        if (xmlObj.childNodes[12].childNodes[9].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >Spldisc</td>";
        }
        if (xmlObj.childNodes[12].childNodes[10].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >CashDisc</td>";
        }
        if (xmlObj.childNodes[12].childNodes[11].childNodes[0].nodeValue != "hide") {
            str = str + "<td  align=\"center\" valign=\"top\" >Round off</td>";
        }
    }

    str = str + "</tr></table></div>";
    document.getElementById('tblinsert').innerHTML = str;
    gridtab_vari = document.getElementById('gridtab');
    document.getElementById('hiddenrowcount').value = ds.Tables[0].Rows.length;
    countGridElement = ds.Tables[0].Rows.length;
    retrows = ds.Tables[0].Rows.length;
   

    insertval = 1;
  
    var insC = document.getElementById('txtinsertion').value;
    if (insC == "") {
        insC = "1";
    }
    retrows = parseInt(ds.Tables[0].Rows.length) / parseInt(insC);
    dcou = 0;
    var inew = 0;
    var insprev = 0;
    for (inew = 0; inew < ds.Tables[0].Rows.length; inew++)
     {
        var dCheck = true;
        var dCheck = checkValidEdition(ds.Tables[0].Rows[inew].Edition_Name);
        if (dCheck == false)
            countGridElement = parseInt(countGridElement, 10) - 1;
        if (dCheck == true) {
            uomid = "uom" + i;
            var id = "Text" + i;
            editid = "edit" + i;
        
            inserts = "ins" + i;
            remark_inserts = "rem" + i;
          
            noofcol = "nocol" + i;
            agnamnt = "agmn" + i;
            adlagn = "adlag" + i;
            spldisc = "spld" + i;
            cashdisc = "cashd" + i;
            roundoffval = "roundoffval" + i;

  

//            if (i % noofinsert == 0 || i % totval == 0) {
                insertval = parseInt(ds.Tables[0].Rows[inew].IDNUM) + 1;


                Make_Row = document.createElement("tr");

                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.setAttribute("class", "TextField");
                make_td.innerHTML = insertval;
                make_td.id = inserts;
                if (insprev != insertval) {
                    insprev = insertval;
                    make_td.title = "Edit Insert";
                }
                Make_Row.appendChild(make_td);
                // EDITION
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.setAttribute("class", "dtGrid");
                str = "<input class=\"btextforgrid7\" type=\"text\" disabled id=" + editid + " value='" + ds.Tables[0].Rows[inew].Edition_Name + "'>";
                 temped = ds.Tables[0].Rows[inew].Edition_Name;
                 
                
                
                
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
               
          //  }
//            else {
////                insertval = parseInt(ds.Tables[0].Rows[inew].IDNUM) + 1;
//                Make_Row = document.createElement("tr");
////                var upl = "upload" + i;
////                Make_Row = document.createElement("tr");
////                make_td = document.createElement("td");
////                make_td.align = "center";
////                make_td.innerHTML = "<input  class=\"button1\" type=\"button\" id=" + upl + " Value=\"Attachment\" >";
////                Make_Row.appendChild(make_td);
//                
//              
//                make_td = document.createElement("td");
//                make_td.align = "center";
//                make_td.setAttribute("class", "TextField");
//                make_td.innerHTML = insertval;
//                make_td.id = inserts;
//                if (insprev != insertval) {
//                    insprev = insertval;
//                    make_td.title = "Edit Insert";
//                }
//                Make_Row.appendChild(make_td);
//                // EDITION
//                make_td = document.createElement("td");
//                make_td.align = "center";
//                make_td.setAttribute("class", "dtGrid");
//                str = "<input class=\"btextforgrid7\" type=\"text\" disabled id=" + editid + " value='" + ds.Tables[0].Rows[inew].Edition_Name + "'>";
//                make_td.innerHTML = str;
//                Make_Row.appendChild(make_td);
//                
//            }
          
           //Date
            make_td = document.createElement("td");
            make_td.align = "center";

            str = "<input class=\"btextforgriddate\" type=\"text\" id=" + id + "  value='" + ds.Tables[0].Rows[inew].Date + "'  >";

           
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);


            var expirydt = "lat" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.setAttribute("class", "dtGrid");
            make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + expirydt + "  value=\"\" >";
            Make_Row.appendChild(make_td);
            
            
            
            


            //Ad sub cat 
            adsubcat = "ads" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.setAttribute("class", "dtGrid");
            make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + adsubcat + "  value=\"\" >";
            Make_Row.appendChild(make_td);

           //size
              size = "size" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.setAttribute("class", "dropdownforgrid");
            make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + size + "  value=\"\" >";
            Make_Row.appendChild(make_td);

//attachment
            var upl = "upload" + i;
           
                           make_td = document.createElement("td");
                        make_td.align = "center";
                          make_td.innerHTML = "<input  class=\"button1\" type=\"button\" id=" + upl + " Value=\"Attachment\" >";
                      Make_Row.appendChild(make_td);
  
           
           
          
            //insert status
            insertsta = "inssta" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\" disabled  type=\"text\" id=" + insertsta + "  value='booked'>";
            Make_Row.appendChild(make_td);

    



            var cs = 0;


            if (ds.Tables[8].Rows.length == 0) {
                //card rate
                cardid="cardrate"+i;
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\"  id=" + cardid + " value=\"\" >";
                Make_Row.appendChild(make_td);
            }
            
            
            insertsta = "inssta" + i;
            billstat = "bill" + i;
           
            insertsta = "inssta" + i;
            billstat = "bill" + i;
            //disc rate
             discrate = "disrat" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + discrate + "  value=\"\" >";
            Make_Row.appendChild(make_td);

           //agreed amt
             agrred = "agr" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agrred + "  value=\"\" >";
            Make_Row.appendChild(make_td);
//file name
            filename = "fil" + i;

            
            make_td = document.createElement("td");
            make_td.align = "center";
            str = "<input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled  value=\"\" >";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);


            //material
            matsta = "material" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.setAttribute("class", "dropdownforgrid");
            str = "<input class=\"btextforgrid7\" type=\"text\" disabled id=" + matsta + " value='" + matsta_vari.value + "'>";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);


//geographical
            var geogra = "geo" + i;

            make_td = document.createElement("td");
            make_td.align = "center";
            
            
            
            make_td.innerHTML = "<input  class=\"button1\" type=\"button\" id=" + geogra   +" Value=\"Addi. Info\" >";
            Make_Row.appendChild(make_td);
            
            
            


            ////////////this is to for premium

            late = "lat" + i;

            repeat = "rep" + i;
            var dat = "mm+" / "+" / "+dd+" / "+yyyy";

            ////////////this is to for premium

            make_td = document.createElement("td");
            premper = "prempe" + i;
                make_td.align = "center";
                make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + premper + "   value=\"\"  >";

                Make_Row.appendChild(make_td);



                make_td = document.createElement("td");
                pospre = "posprem" + i;
                make_td.align = "center";
                make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + pospre + "   value=\"\"  >";

                Make_Row.appendChild(make_td);
            
            

            namecode = "one";


      
         
            adtypid = "adtyp" + i;
            namecode = "two";
            preall = "preall" + i;
           
            page = "pgpre" + i;
           
            var h;


            //prm %

 pageprem = "pagper" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + pageprem + "   value=\"\"  >";

            Make_Row.appendChild(make_td);

            



      
        
         //ad cat
 adcat = "adcat" + i;
            Make_Row.appendChild(make_td);
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input  class=\"dropdownforgrid\" type=\"text\" id=" + adcat + " value='" + adcat_vari.value + "'>";
            Make_Row.appendChild(make_td);

//discount
 var discount_ = "disc_" + i;
            Make_Row.appendChild(make_td);
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id=" + discount_ + " value=\"\" >";
            Make_Row.appendChild(make_td);

            ///////////////////////////////////////////////
            
            paid = "pai" + i;
        
          
           

            ///////////////this is to bind the drop down for paid/free insertion

          
    
           

                   
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        if (document.getElementById('hiddisceditgrid').value == "Y")
                            make_td.innerHTML = "<input class=\"btextsmallsizeH\" type=\"text\" id=" + discount_ + "   value=\"\" >";
                        else
                            make_td.innerHTML = "<input class=\"btextsmallsizeH\" disabled type=\"text\" id=" + discount_ + "   value=\"\" >";
                        Make_Row.appendChild(make_td);
                 
                        if (dpaid == "") {
                         
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dpaid = dpaid + "<select id=" + paid + " class=\"dropdownforgridsmall\" >";
                            dpaid = dpaid + "<option value=\"Y\">Yes</option>";
                            dpaid = dpaid + "<option value=\"N\">No</option>";
                            dpaid = dpaid + "<option value=\"P\">Paid</option>";
                            dpaid = dpaid + "</select>";
                            
                            make_td.innerHTML = dpaid;
                            Make_Row.appendChild(make_td);

                        }
                        else {
                           
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dpaid.replace("pai" + dcou, paid);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                        }
          
           // SOLO RATE
               solo = "sol" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + solo + "  value=\"\">";
            Make_Row.appendChild(make_td);

            //local gross amt
              gross = "gro" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + gross + "  value=\"\">";
            Make_Row.appendChild(make_td);

            // page no
            pageno_inserts="pageno"+i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input  class=\"btextforinsertright\" onkeypress=\"javascript:return rateenter(event);\"   type=\"text\" id=" + pageno_inserts + "  value=\"\">";
            Make_Row.appendChild(make_td);

            //caption 
caption_inserts="caption"+i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input  class=\"btextforgrid\"    type=\"text\" id=" + caption_inserts + " value=\"\">";
            Make_Row.appendChild(make_td);
            //remark
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input  class=\"btextforgrid\"    type=\"text\" id=" + remark_inserts + "  value=\"\">";
            Make_Row.appendChild(make_td);

            //local bill amt
            var billamtlocal = "balocal" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + billamtlocal + "  value=\"\">";
            Make_Row.appendChild(make_td);

           //grossamt 
            var grosslocal = "grolocal" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + grosslocal + "  value=\"\">";
            Make_Row.appendChild(make_td);

            //billamt
            var billamt = "ba" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + billamt + "  value=\"\">";
            Make_Row.appendChild(make_td);



            //pageset
            var pageset = "pgst" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input  class=\"button1\" type=\"button\" id=" + pageset + " Value=\"Page Set\"  onclick=\"link()\"  >";
            Make_Row.appendChild(make_td);


            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[15].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agnamnt + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agnamnt + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[7].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agnamnt + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agnamnt + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[17].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + adlagn + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + adlagn + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[8].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + adlagn + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + adlagn + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[19].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + spldisc + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + spldisc + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[9].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + spldisc + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + spldisc + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[21].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cashdisc + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cashdisc + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[10].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cashdisc + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cashdisc + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[23].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + roundoffval + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + roundoffval + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[11].childNodes[0].nodeValue != "hide") {
                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + roundoffval + "  value=\"\">";
                    Make_Row.appendChild(make_td);
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + roundoffval + "  value=\"\">";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
                }
            }


  

            // for logo
            var logohei = "logohei" + i;
            var logowid = "logowid" + i;
            var logonam = "logonam" + i;

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"btextsmallsize\"  type=\"text\" id=" + logohei + " Value=\"\" >";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"btextsmallsize\" type=\"text\" id=" + logowid + " Value=\"\" >";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);


                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input  class=\"dropdownforgrid\" type=\"text\" id=" + logonam + " Value=\"\" >";
                    make_td.style.display = "none";
                    Make_Row.appendChild(make_td);
        

    
            pkgcodegrid = 'hiddenpckcode' + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkgcodegrid + "' value='" + ds.Tables[0].Rows[inew].EDITION_CODE + "'>";
            Make_Row.appendChild(make_td);
            var pubcode = 'pubcode' + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pubcode + "' value='" + ds.Tables[0].Rows[inew].PUBCODE + "'>";
            Make_Row.appendChild(make_td);
            var pkg_ins = 'pkg_ins' + i;
            for (var countpkg = 0; countpkg < pkgcopy_vari.length; countpkg++) {
                var pkgcopy = pkgcopy_vari.options[countpkg].value;
                var arrpkgcopy = pkgcopy.split('@')
                var pkgcopycode = arrpkgcopy[0];
                var arr_pkg_ins_value = arrpkgcopy[1].split('(');
                var pkg_ins_value = arr_pkg_ins_value[1].replace(')', '');
                if (pkgcopycode == ds.Tables[0].Rows[inew].EDITION_CODE) {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_ins + "' value='" + pkg_ins_value + "'>";
                    Make_Row.appendChild(make_td);
                    countpkg = pkgcopy_vari.length;
                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_ins + "' value='" + pkg_ins_value + "'>";
                    Make_Row.appendChild(make_td);
                    countpkg = pkgcopy_vari.length;
                }
            }

            pkg_alias = 'pkg_alias' + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_alias + "' value='" + ds.Tables[0].Rows[inew].PKGNAME + "'>";
            Make_Row.appendChild(make_td);

            var spltdata = "spltdata" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + spltdata + "' value=\"\">";
            Make_Row.appendChild(make_td);


            var subedidata = "subedidata" + i; make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + subedidata + "' value=\"\">";
            Make_Row.appendChild(make_td);

            var vat = "vat" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + vat + "' value=\"\">";
            Make_Row.appendChild(make_td);

            var boxc = "boxc" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + boxc + "' value=\"\">";
            Make_Row.appendChild(make_td);

            var vat_inc = "vat_inc" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + vat_inc + "' value=\"\">";
            Make_Row.appendChild(make_td);

            var coupan = "coupan" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + coupan + "' value=\"\">";
            Make_Row.appendChild(make_td);

            var clicatamt = "clicatamt" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + clicatamt + "' value=\"\">";
            Make_Row.appendChild(make_td);

            var flatfreqamt = "flatfreqamt" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + flatfreqamt + "' value=\"\">";
            Make_Row.appendChild(make_td);

            var catamt = "catamt" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + catamt + "' value=\"\">";
            Make_Row.appendChild(make_td);
            


            gridtab_vari.getElementsByTagName("tbody")[0].appendChild(Make_Row);
       
            i = parseInt(i, 10) + 1;
        }

    }
    var rowcount = gridtab_vari.rows.length - 1;
    document.getElementById('hdnrowcount').value = rowcount;
    var dateformat_vari = document.getElementById('hiddendateformat');
    var compcode_vari = document.getElementById('hiddencompcode');
    var center_vari = document.getElementById('hiddencenter');
    var adtype_vari = document.getElementById('hiddenadtype');
    var chkall_vari = document.getElementById('chkall');
    var temp = idnew;
    idnew = ds.Tables[0].Rows.length;

    previnsertion = document.getElementById('txtinsertion').value;
    if (browserversion > 6) {
        $(".dropdownforgridsmall").change(function() {
            if (document.activeElement.id.indexOf("pai") >= 0) {
                blankGross();
            }
        });
        $(".btextsmallsizeH").change(function() {
            if (document.activeElement.id.indexOf("pgpre") >= 0 || document.activeElement.id.indexOf("nocol") >= 0 || document.activeElement.id.indexOf("hei") >= 0 || document.activeElement.id.indexOf("wid") >= 0 || document.activeElement.id.indexOf("ins") >= 0) {
                var i;
                if (document.activeElement.id.indexOf("disc_") >= 0) {
                    blankGross();
                }
                if (document.activeElement.id.indexOf("pgpre") >= 0) {
                    i = document.activeElement.id.substring(5, document.activeElement.id.length + 1);
                    var page = "pgpre" + i;
                    var pagstr = "sec";
                    var f = getpageprem(page, i, pagstr);
                    if (f == false)
                        return false;
                }
                else {
                    if (document.activeElement.id.indexOf("nocol") >= 0) {
                        i = document.activeElement.id.substring(5, document.activeElement.id.length + 1);

                    }
                    else {
                        i = document.activeElement.id.substring(3, document.activeElement.id.length + 1);

                    }
                    var height = "hei" + i;
                    var width = "wid" + i;
                    var inserts = "ins" + i;
                    var insertval = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(i, 10) + 1].cells[0].innerHTML;
                    var noofcol = "nocol" + i;
                    var f = gettotalsize(height, width, i, inserts, insertval, noofcol);
                    if (f == false)
                        return false;
                }
            }
        });
        $(".btextforgriddate").change(function() {
            if (document.activeElement.id.indexOf("Text") >= 0) {
                document.getElementById('txtgrossamt').value = "";
                document.getElementById('txtbillamt').value = "";
                document.getElementById('txtgrossamtlocal').value = "";
                document.getElementById('txtbillamtlocal').value = "";
                var f = chkDateforGrid(this);
                if (f == false)
                    return false;
            }
            else if (document.activeElement.id.indexOf("rep") >= 0 || document.activeElement.id.indexOf("lat") >= 0) {
                checkdate(document.getElementById(document.activeElement.id));
            }
        });
        for (i = 0; i < gridtab_vari.getElementsByTagName("tbody")[0].rows.length - 1; i++) {
            if (repeatdate == "0" || repeatdate == "1") {
                var id = "Text" + i;
                if (caldatemonth.length >= i) {
                    //   if(caldatemonth[i]!=undefined)
                    //    {
                    //var mmM=caldatemonth[i].toString();
                    //}
                    //else{
                    var mmM = parseInt(monthSelected, 10) + 1;
                    mmM = mmM.toString();
//                    if (dateSelected.toString().length == 1)
//                        dateSelected = "0" + dateSelected.toString();
                    // }
                }
                else {
                    var mmM = parseInt(monthSelected, 10) + 1;
                    mmM = mmM.toString();
//                    if (dateSelected.toString().length == 1)
//                        dateSelected = "0" + dateSelected.toString();
                }
                if (mmM.toString().length == 1)
                    mmM = "0" + mmM.toString();

                if (dateformat_vari.value == "mm/dd/yyyy") {
                    vvalue = mmM + "/" + dateSelected + "/" + yearSelected;
                }
                else if (dateformat_vari.value == "dd/mm/yyyy") {
                    vvalue = dateSelected + "/" + mmM + "/" + yearSelected; ;
                }
                else if (dateformat_vari.value = "yyyy/mm/dd") {
                    vvalue = yearSelected + "/" + mmM + "/" + dateSelected; ;
                }
                vvalue = document.getElementById('Text' + i).value;
                if (dateSelected != undefined && dateSelected != "") {
                    if (browser != "Microsoft Internet Explorer") {
                        var pkgfullname = document.getElementById('pkg_alias' + i).value;
                        var pkgid = document.getElementById('hiddenpckcode' + i).value;
                        var pkgname = document.getElementById('pkg_alias' + i).value;
                        var compcode = compcode_vari.value;

                        dateday = vvalue;

                        document.getElementById('Text' + i).value = vvalue;
                    }
                    else {
                        var pkgfullname = document.getElementById('pkg_alias' + i).value;
                        var pkgid = document.getElementById('hiddenpckcode' + i).value;
                        var pkgname = document.getElementById('pkg_alias' + i).value;
                        var compcode = compcode_vari.value;
                        dateday = vvalue;

                        document.getElementById('Text' + i).value = vvalue;
                    }
                    if (browser != "Microsoft Internet Explorer") {
                        var httpRequest = null; ;
                        httpRequest = new XMLHttpRequest();
                        if (httpRequest.overrideMimeType) {
                            httpRequest.overrideMimeType('text/xml');
                        }

                        httpRequest.onreadystatechange = function() { alertContents(httpRequest) };
                        var adcat = adcat_vari.value;
                        httpRequest.open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
                        httpRequest.send('');
                        //alert(httpRequest.readyState);
                        if (httpRequest.readyState == 4) {
                            //alert(httpRequest.status);
                            if (httpRequest.status == 200) {
                                strtext = httpRequest.responseText;
                            }
                            else {
                                alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                            }
                        }
                    }
                    else {
                        validuse = "";
                        var xml = new ActiveXObject("Microsoft.XMLHTTP");
                        var adcat = adcat_vari;
                        var center = '';
                        if (center_vari != null) {
                            center = center_vari.value;
                            if (chkall_vari != null) {
                                if (chkall_vari.checked == true) {
                                    center = '0';
                                }
                            }
                            else {
                                center = '0';
                            }
                        }
                        xml.Open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
                        xml.Send();
                        strtext = xml.responseText;
                    }
                    if (strtext == "NOT A VALID DATE") {
                        alert("NOT A VALID DATE");
                        document.getElementById(id).value = "";
                        return false;
                    }
                    if (strtext == "0") {
                        //alert("Day is not the publishing day");
                        document.getElementById(id).value = "";
                        return false;
                    }
                    else {
                        if (strtext == "1")
                            document.getElementById(id).value = vvalue;
                        else {
                            if (strtext != "") {
                                if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                                    var txt = strtext;
                                    var txt1 = txt.split("/");
                                    var dd = txt1[0];
                                    var mm1 = txt1[1];
                                    var mm = txt1[1]; //getMonthNo(mm1);
                                    var yy = txt1[2];
                                    caldate[cali] = dd;
                                    caldatemonth[cali] = mm;
                                    caldateyear[cali] = yy;
                                    cali = parseInt(cali, 10) + 1;
                                }
                                else if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                                    var txt = strtext;
                                    var txt1 = txt.split("/");
                                    var dd = txt1[1];
                                    var mm1 = txt1[0];
                                    var mm = txt1[0]; //getMonthNo(mm1);
                                    var yy = txt1[2];
                                    caldate[cali] = dd;
                                    caldatemonth[cali] = mm;
                                    caldateyear[cali] = yy;
                                    cali = parseInt(cali, 10) + 1;
                                }
                                else if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
                                    var txt = strtext;
                                    var txt1 = txt.split("/");
                                    var dd = txt1[2];
                                    var mm1 = txt1[1];
                                    var mm = txt1[1]; //getMonthNo(mm1);
                                    var yy = txt1[0];
                                    caldate[cali] = dd;
                                    caldatemonth[cali] = mm;
                                    caldateyear[cali] = yy;
                                    cali = parseInt(cali, 10) + 1;
                                }
                            }
                            document.getElementById(id).value = strtext;
                            if (vvalue != strtext) {
                                alert(vvalue + " Date is no issue date of edition " + pkgname);
                                document.getElementById(id).value = "";
                                cali = cali - 1;
                            }
                        }
                    }
                }
            }
            temp = parseInt(temp) + 1;
        }
    }
    
    else {
        for (i = 0; i < gridtab_vari.getElementsByTagName("tbody")[0].rows.length - 1; i++) {
            var id = "Text" + i;
            var noofcol = "nocol" + i;
            var height = "hei" + i;
            var width = "wid" + i;
            var late = "lat" + i;
            var repeat = "rep" + i;
            //var latedate = "latdate" + i;
            var repeatdateI = "repdate" + i;
            var page = "pgpre" + i;
            var pagstr = "sec";
            var adcat = "adcat" + i;
            var adsubcat = "ads" + i;
            var height_var = document.getElementById(height);
         ///   var par1 = (height_var.parentNode).parentNode;anuj
            var inserts = "ins" + i;
            var paid = "pai" + i;
            var disc = "disc_" + i;
            var boldcount = "splboldsize" + i;
            var insertval = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[i + 1].cells[0].innerHTML;
         
            if (repeatdate == "0" || repeatdate == "1") {
                var id = "Text" + i;
               
                var mmM = parseInt(monthSelected, 10) + 1;
                mmM = mmM.toString();
                //}
                if (mmM.toString().length == 1)
                    mmM = "0" + mmM.toString();
                if (dateformat_vari.value == "mm/dd/yyyy") {
                    vvalue = mmM + "/" + dateSelected + "/" + yearSelected;
                }
                else if (dateformat_vari.value == "dd/mm/yyyy") {
                    vvalue = dateSelected + "/" + mmM + "/" + yearSelected; ;
                }
                else if (dateformat_vari.value = "yyyy/mm/dd") {
                    vvalue = yearSelected + "/" + mmM + "/" + dateSelected; ;
                }
                vvalue = document.getElementById('Text' + i).value;

                if (dateSelected != undefined && dateSelected != "") {
                    if (browser != "Microsoft Internet Explorer") {
                        var pkgfullname = document.getElementById('pkg_alias' + i).value;
                        var pkgid = document.getElementById('hiddenpckcode' + i).value;
                        var pkgname = document.getElementById('pkg_alias' + i).value;
                        var compcode = compcode_vari.value;

                        dateday = vvalue;

                        document.getElementById('Text' + i).value = vvalue;
                    }
                    else {
                  

                      
                    }
                    if (browser != "Microsoft Internet Explorer") {
                        var httpRequest = null; ;
                        httpRequest = new XMLHttpRequest();
                        if (httpRequest.overrideMimeType) {
                            httpRequest.overrideMimeType('text/xml');
                        }

                        httpRequest.onreadystatechange = function() { alertContents(httpRequest) };
                        var adcat = adcat_vari.value;
                        httpRequest.open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
                        httpRequest.send('');
                       
                        if (httpRequest.readyState == 4) {
                           
                            if (httpRequest.status == 200) {
                                strtext = httpRequest.responseText;
                            }
                            else {
                                alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                            }
                        }
                    }
                    else {
                        validuse = "";
                        var xml = new ActiveXObject("Microsoft.XMLHTTP");
                        var adcat = adcat_vari;
                        var center = '';
                        if (center_vari != null) {
                            center = center_vari.value;
                            if (chkall_vari != null) {
                                if (chkall_vari.checked == true) {
                                    center = '0';
                                }
                            }
                            else {
                                center = '0';
                            }
                        }
                    }
                }
            }
            temp = parseInt(temp) + 1;
        }
    }
    
 
    return false;
}



function checkValidEdition(editionName) {
    var bFlag = false;
    if (arrEdition_Item != "") {
        var arr_split = arrEdition_Item.split(',');
        for (var i = 0; i < arr_split.length; i++) {
            if (trim(arr_split[i]) == trim(editionName)) {
                bFlag = true;
                break;
            }
        }
    }
    else
        bFlag = true;
    return bFlag;
}



function documentClick(event) {
 
    if (browser != "Microsoft Internet Explorer") {
        //          document.activeElement.id=arguments[0].target.id == "uploadA")
        var activeid = arguments[0].target.id;
      
        if (activeid == "" && document.activeElement.id != "")
            activeid = document.activeElement.id;
        if (activeid.indexOf("ins") == 0 && document.getElementById(activeid).title != "") {
            opencopyDivInsertion(activeid);
        }
        else if (activeid.indexOf("uploadA") == 0) {
            uploadimageall();
        }
        
        else if (activeid.indexOf("geo0") == 0) {
     
           
            var n1 = document.activeElement.id;
            var idnum = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(n1.replace('geo', ''), 10) + 1].cells[0].innerHTML;

      

            if (flag == 0) {
                return geographical123(idnum);
            }
            if (flag == 1) {

                var edition = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(n1.replace('geo', ''), 10) + 1].cells[1].innerHTML;

                return executegeo(idnum, edition.split('value=')[1].split('>')[0]);
            }

        }      
        
        else if (activeid.indexOf("vtsbtn") == 0) {
            openVtsPopup(activeid);
        }
        else if (activeid.indexOf("material") == 0) {
            if (flag == 1) {

                var n1 = document.activeElement.id;
                var idnum = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(n1.replace('material', ''), 10) + 1].cells[0].innerHTML;

                var edition = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(n1.replace('material', ''), 10) + 1].cells[1].innerHTML;
                var filename = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(n1.replace('material', ''), 10) + 1].cells[11].innerHTML;
                return uploadimage(n1.replace('upload', 'pic'), idnum, edition.split('value=')[1].split('>')[0], filename.split('value=')[1].split('>')[0]);
            }
        }

        else if (activeid.indexOf("aglist") == 0 || activeid.indexOf("aglistpop") == 0) {
            FillSubCatinGrid();
        }


        else if (activeid.indexOf("pgst") == 0) {

            window.open('http://192.168.5.179/Adsdemo/home.aspx', '_blank', 'resizable=yes')


        }
        
        else if (activeid.indexOf("pai") == 0) {
            document.getElementById('txtgrossamt').value = "";
            document.getElementById('txtbillamt').value = "";
            if (document.getElementById(activeid).value == "Y") {
                paivar = "Y";
            }
            else {
                paivar = "";
            }

        }
        else if (activeid.indexOf("splt") == 0) {
            var n1 = activeid;

            var idnum = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(n1.replace('splt', ''), 10) + 1].cells[0].innerHTML;
            var editid = "edit" + idnum;
            opensplitedition(document.getElementById(editid).value, idnum);
        }
        else if (activeid.indexOf("subedi") == 0) {
            if (document.getElementById('txttotalarea').value == "") {
                alert("Please fill Size");
                return false;
            }
            var n1 = activeid;
            var idnum = activeid.replace("subedi", "");
            var editid = "edit" + idnum;
            var size = "siz" + idnum;
            var hei = "hei" + idnum;
            var wid = "wid" + idnum;
            var id = "Text" + idnum;
            var data = "subedidata" + idnum;
            showid = "sho" + idnum;
            var insertsta = "inssta" + idnum;
            var pkgcode = "hiddenpckcode" + idnum;
            var showidval = "";
            if (document.getElementById(showid) != null)
                showidval = document.getElementById(showid).value;
            window.open('booking_subeditiondetail.aspx?package=' + document.getElementById(pkgcode).value + '&cioid=' + document.getElementById('txtciobookid').value + '&uomdesc=' + document.getElementById('hiddenuomdesc').value + '&compcode=' + document.getElementById('hiddencompcode').value + '&insertdate=' + document.getElementById(id).value + '&width=' + document.getElementById(wid).value + '&data=' + document.getElementById(data).value + '&height=' + document.getElementById(hei).value + '&edition=' + document.getElementById(editid).value + '&insertid=' + showidval + '&insertstatus=' + document.getElementById(insertsta).value + '&btnstatus=' + chkbtnStatus + '&totarea=' + document.getElementById(size).value + '&idnum=' + idnum + '&dateformat=' + document.getElementById('hiddendateformat').value + '&receiptno=' + document.getElementById('txtreceipt').value, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=144,left=210,width=560px,height=300px');
        }
    }
    else {
        if (document.activeElement.id.indexOf("ins") == 0 && document.getElementById(document.activeElement.id).title != "") {
            opencopyDivInsertion(document.activeElement.id);
        }
        //        else if (document.activeElement.id.indexOf("uploadA") == 0) {
        //            uploadimageall();
        //        }


        //        else if (document.activeElement.id.indexOf("geo") == 0) 
        //            geographical123();

        else if (document.activeElement.id.indexOf("vtsbtn") == 0) {
            openVtsPopup(document.activeElement.id);
        }
        else if (document.activeElement.id.indexOf("material") == 0) {
            if (flag == 1) {

                var n1 = document.activeElement.id;
                var idnum = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(n1.replace('material', ''), 10) + 1].cells[0].innerHTML;

                var edition = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(n1.replace('material', ''), 10) + 1].cells[1].innerHTML;
                var filename = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(n1.replace('material', ''), 10) + 1].cells[11].innerHTML;
                return uploadimage(n1.replace('upload', 'pic'), idnum, edition.split('value=')[1].split('>')[0], filename.split('value=')[1].split('>')[0]);
            }
        }


        else if (document.activeElement.id.indexOf("pgst") == 0) {

        window.open('http://192.168.5.179/Adsdemo/home.aspx', '_blank', 'resizable=yes')
        
        
        }

        else if (document.activeElement.id.indexOf("geo") == 0) {
            var n1 = document.activeElement.id;
            var idnum = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(n1.replace('geo', ''), 10) + 1].cells[0].innerHTML;

           

            if (flag == 0) {
                return geographical123(idnum);
            }
            if (flag == 1) {

                var edition = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(n1.replace('geo', ''), 10) + 1].cells[1].innerHTML;




                return executegeo(idnum, edition.split('value=')[1].split('>')[0]);
            }

        }


        else if (document.activeElement.id.indexOf("aglist") == 0 || document.activeElement.id.indexOf("aglistpop") == 0) {
            FillSubCatinGrid();
        }
        else if (document.activeElement.id.indexOf("pai") == 0) {
            document.getElementById('txtgrossamt').value = "";
            document.getElementById('txtbillamt').value = "";
            if (document.getElementById(document.activeElement.id).value == "Y") {
                paivar = "Y";
            }
            else {
                paivar = "";
            }

        }
        else if (document.activeElement.id.indexOf("splt") == 0) {
            var n1 = document.activeElement.id;

            var idnum = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(n1.replace('splt', ''), 10) + 1].cells[0].innerHTML;
            var editid = "edit" + idnum;
            opensplitedition(document.getElementById(editid).value, idnum);
        }
        else if (document.activeElement.id.indexOf("subedi") == 0) {
            if (document.getElementById('txttotalarea').value == "") {
                alert("Please fill Size");
                return false;
            }
            var n1 = document.activeElement.id;
            var idnum = document.activeElement.id.replace("subedi", "");
            var editid = "edit" + idnum;
            var size = "siz" + idnum;
            var hei = "hei" + idnum;
            var wid = "wid" + idnum;
            var id = "Text" + idnum;
            var data = "subedidata" + idnum;
            showid = "sho" + idnum;
            var insertsta = "inssta" + idnum;
            var pkgcode = "hiddenpckcode" + idnum;
            var showidval = "";
            if (document.getElementById(showid) != null)
                showidval = document.getElementById(showid).value;
            window.open('booking_subeditiondetail.aspx?package=' + document.getElementById(pkgcode).value + '&cioid=' + document.getElementById('txtciobookid').value + '&uomdesc=' + document.getElementById('hiddenuomdesc').value + '&compcode=' + document.getElementById('hiddencompcode').value + '&insertdate=' + document.getElementById(id).value + '&width=' + document.getElementById(wid).value + '&data=' + document.getElementById(data).value + '&height=' + document.getElementById(hei).value + '&edition=' + document.getElementById(editid).value + '&insertid=' + showidval + '&insertstatus=' + document.getElementById(insertsta).value + '&btnstatus=' + chkbtnStatus + '&totarea=' + document.getElementById(size).value + '&idnum=' + idnum + '&dateformat=' + document.getElementById('hiddendateformat').value + '&receiptno=' + document.getElementById('txtreceipt').value, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=144,left=210,width=560px,height=300px');
        }
    }
}



function changediv1() {
    //*25Aug* check for retainer or Executive
    if (document.getElementById('LinkButton1').disabled == true)
        return false;
//    if (document.getElementById('drpretainer').value == "" && document.getElementById('txtexecname').value == "") {
//        alert('Please fill Executive Name or Retainer.');
//        if (document.getElementById('drpretainer').disabled == false)
//            document.getElementById('drpretainer').focus();
//        return false;
//    }

    if (enLink == "1") {
        document.getElementById('LinkButton1').disabled = false;
        document.getElementById('LinkButton2').disabled = false;
        document.getElementById('LinkButton3').disabled = false;
        document.getElementById('LinkButton4').disabled = false;
        document.getElementById('LinkButton5').disabled = false;
//        document.getElementById('LinkButton6').disabled = false;
//        document.getElementById('LinkButton7').disabled = false;
    }
    if (document.getElementById('LinkButton2').disabled == false) {
        if (document.getElementById('txtagency').value == "") {
            alert("Please fill the agency name");
            document.getElementById('txtagency').disabled = false;
            document.getElementById('txtagency').focus();
            return false;
        }


        if (document.getElementById('txtclient').value == "") {
            alert("Please fill the client name");
            document.getElementById('txtclient').disabled = false;
            document.getElementById('txtclient').focus();
            return false;
        }




 

        if (document.getElementById('drpretainer').disabled == false) {
            if (document.getElementById('drpretainer').value == "" && document.getElementById('txtexecname').value == "") {
                var a = "Executive name";
                var b = "Retainer";
                if (browser != "Microsoft Internet Explorer") {
                    a = document.getElementById('lbececname').textContent.replace("*[F2]", "");
                    b = document.getElementById('lblretainer').textContent.replace("*[F2]", "");
                }
                else {
                    a = document.getElementById('lbececname').innerText.replace("*[F2]", "");
                    b = document.getElementById('lblretainer').innerText.replace("*[F2]", "");
                }
                alert('Please fill ' + a + ' or ' + b + '.');

                document.getElementById('drpretainer').focus();
                return false;
            }
        }




      


        if (document.getElementById('drpbooktype').value == "0") {
            alert("Please Select Booking Type");
            document.getElementById('drpbooktype').focus();
            return false;
        }


//        if (document.getElementById('txtcategory').value == "" || document.getElementById('hdncategory').value == "") {
//            alert("Please Select Ad Category");
//            document.getElementById('txtcategory').focus();
//            return false;
//        }




        if (document.getElementById('drpuom').value == "0") {
            alert("Please Select UOM");
            document.getElementById('drpuom').focus();
            return false;
        }

        if (document.getElementById('txtagency').value == "") {
            alert("Please fill the Agency Sub Code");
            document.getElementById('txtagency').focus();
            return false;
        } 

        if (document.getElementById('drpcurrency').value == "0") {
            alert("Please Select Currency");
            document.getElementById('drpcurrency').focus();
            return false;
        }
        
     

   
        if (document.getElementById('drppackagecopy').options.length == 0) {
            alert("Please Select Package");
            if (document.getElementById('tblpackage').style.display == "block")
                document.getElementById('drppackage').focus();
            return false;
        }
        if (document.getElementById('txtdummydate').value == "") {
            alert("Please Enter Date");
            if (document.getElementById('tblpackage').style.display == "block")
                document.getElementById('txtdummydate').focus();
            return false;
        }
        if (document.getElementById('drpcurrency').value == "0" || document.getElementById('drpcurrency').value == "") {
            alert("Please Select Currency");
            if (document.getElementById('tblpackage').style.display == "block")
                document.getElementById('drpcurrency').focus();
            return false;
        }

        if (document.getElementById('drprptcurrency').value == "0") {
            alert("Please Select Reciept Currency");
            document.getElementById('drprptcurrency').focus();
            return false;
        }
        
        
        document.getElementById('LinkButton2').style.fontWeight = "bold";
        document.getElementById('LinkButton2').style.color = "#FFFF80";

        document.getElementById('LinkButton3').style.fontWeight = "normal";
        document.getElementById('LinkButton3').style.color = "White";
        document.getElementById('LinkButton4').style.fontWeight = "normal";
        document.getElementById('LinkButton4').style.color = "White";
        document.getElementById('LinkButton5').style.fontWeight = "normal";
        document.getElementById('LinkButton5').style.color = "White";
        document.getElementById('LinkButton1').style.fontWeight = "normal";
        document.getElementById('LinkButton1').style.color = "White";
//        document.getElementById('LinkButton6').style.fontWeight = "normal";
//        document.getElementById('LinkButton6').style.color = "White";
//        document.getElementById('LinkButton7').style.fontWeight = "normal";
//        document.getElementById('LinkButton7').style.color = "White";
        document.getElementById('tbvts').style.display = "none";
        document.getElementById('tblrate').style.display = "none";
        document.getElementById('tblbill').style.display = "none";
        //alert(document.getElementById('LinkButton1').click);
        document.getElementById('pagedetail').style.display = "block";
       
        document.getElementById('addetails').style.display = "none";
        //document.getElementById('tblsize').style.display="none";
        document.getElementById('tblpackage').style.display = "none";
        document.getElementById('tbbox').style.display = "none";
        //document.getElementById('drppageprem').focus();    

        return false;
    }
}




function changedivrate() {
    if (document.getElementById('LinkButton4').disabled == true)
        return false;


    if (document.getElementById('txtagency').value == "") {
        alert("Please fill the agency name");
        document.getElementById('txtagency').disabled = false;
        document.getElementById('txtagency').focus();
        return false;
    }


    if (document.getElementById('txtclient').value == "") {
        alert("Please fill the client name");
        document.getElementById('txtclient').disabled = false;
        document.getElementById('txtclient').focus();
        return false;
    }

    if (document.getElementById('drpretainer').disabled == false) {
        if (document.getElementById('drpretainer').value == "" && document.getElementById('txtexecname').value == "") {
            var a = "Executive name";
            var b = "Retainer";
            if (browser != "Microsoft Internet Explorer") {
                a = document.getElementById('lbececname').textContent.replace("*[F2]", "");
                b = document.getElementById('lblretainer').textContent.replace("*[F2]", "");
            }
            else {
                a = document.getElementById('lbececname').innerText.replace("*[F2]", "");
                b = document.getElementById('lblretainer').innerText.replace("*[F2]", "");
            }
            alert('Please fill ' + a + ' or ' + b + '.');

            document.getElementById('drpretainer').focus();
            return false;
        }
    }

    
    
    if (document.getElementById('txtratecode').options.length == 1) {
         }
          if (document.getElementById('LinkButton1').disabled == true)
        return false;
             if (enLink == "1") {
        document.getElementById('LinkButton1').disabled = false;
        document.getElementById('LinkButton2').disabled = false;
        document.getElementById('LinkButton3').disabled = false;
        document.getElementById('LinkButton4').disabled = false;
        document.getElementById('LinkButton5').disabled = false;
//        document.getElementById('LinkButton6').disabled = false;
//        document.getElementById('LinkButton7').disabled = false;
    }
    if (document.getElementById('LinkButton4').disabled == false) {
 
        if (document.getElementById('drpbooktype').value == "0") {
            alert("Please Select Booking Type");
            document.getElementById('drpbooktype').focus();
            return false;
        }


//        if (document.getElementById('txtcategory').value == "" || document.getElementById('hdncategory').value == "") {
//            alert("Please Select Ad Category");
//            document.getElementById('txtcategory').focus();
//            return false;
//        }




        if (document.getElementById('drpuom').value == "0") {
            alert("Please Select UOM");
            document.getElementById('drpuom').focus();
            return false;
        }




        if (document.getElementById('drpcurrency').value == "0") {
            alert("Please Select Currency");
            document.getElementById('drpcurrency').focus();
            return false;
        }




        if (document.getElementById('drppackagecopy').options.length == 0) {
            alert("Please Select Package");
            if (document.getElementById('tblpackage').style.display == "block")
                document.getElementById('drppackage').focus();
            return false;
        }
        if (document.getElementById('txtdummydate').value == "") {
            alert("Please Enter Date");
            if (document.getElementById('tblpackage').style.display == "block")
                document.getElementById('txtdummydate').focus();
            return false;
        }
        if (document.getElementById('drpcurrency').value == "0" || document.getElementById('drpcurrency').value == "") {
            alert("Please Select Currency");
            if (document.getElementById('tblpackage').style.display == "block")
                document.getElementById('drpcurrency').focus();
            return false;
        }

        if (document.getElementById('drprptcurrency').value == "0") {
            alert("Please Select Reciept Currency");
            document.getElementById('drprptcurrency').focus();
            return false;
        }


        var chmandat;
        if (browser != "Microsoft Internet Explorer") {
            chmandat = document.getElementById('lblpage').textContent;
        }
        else {
            chmandat = document.getElementById('lblpage').innerText;
        }
        if (chmandat.indexOf("*") >= 0 && document.getElementById('drppageprem').value != "CA0") {
            alert("Please Select Page Premium");
            document.getElementById('drppageprem').disabled = false;
            document.getElementById('drppageprem').focus();
            return false;
        }



        if (document.getElementById('txttotalarea').value == "") {
            alert("Please Enter Total Area");
            document.getElementById('txttotalarea').disabled = false;
            document.getElementById('txttotalarea').focus();
            return false;
        }
        
        
        

        document.getElementById('LinkButton4').style.fontWeight = "bold";
        document.getElementById('LinkButton4').style.color = "#FFFF80";
        document.getElementById('LinkButton3').style.fontWeight = "normal";
        document.getElementById('LinkButton3').style.color = "White";
        document.getElementById('LinkButton2').style.fontWeight = "normal";
        document.getElementById('LinkButton2').style.color = "White";
        document.getElementById('LinkButton5').style.fontWeight = "normal";
        document.getElementById('LinkButton5').style.color = "White";
        document.getElementById('LinkButton1').style.fontWeight = "normal";
        document.getElementById('LinkButton1').style.color = "White";
//        document.getElementById('LinkButton6').style.fontWeight = "normal";
//        document.getElementById('LinkButton6').style.color = "White";
//        document.getElementById('LinkButton7').style.fontWeight = "normal";
//        document.getElementById('LinkButton7').style.color = "White";
        document.getElementById('tbvts').style.display = "none";
        //alert(document.getElementById('LinkButton1').click);
        document.getElementById('tblrate').style.display = "block";
        if (document.getElementById('txtratecode').disabled == false) {
            document.getElementById('txtratecode').focus();
        }
        document.getElementById('tblbill').style.display = "none";
        document.getElementById('addetails').style.display = "none";
        document.getElementById('pagedetail').style.display = "none";
        //document.getElementById('tblsize').style.display="none";
        document.getElementById('tblpackage').style.display = "none";
        document.getElementById('tbbox').style.display = "none";
        //retainer text box fill *4sep*

        if (document.getElementById('drpretainer').value != "" && document.getElementById('drpretainer').value != "0" && document.getElementById('txtRetainercomm').value == "") {
            document.getElementById('txtRetainercomm').value = "";
            var retain_name = document.getElementById('drpretainer').value.split('(');
            if (retain_name.length > 1) {
                var retain_code = retain_name[1].replace(')', '');
              
            }

        }
        
        return false;
    }
}




function changebilldiv() {
    if (document.getElementById('LinkButton3').disabled == true)
        return false;
    if (document.getElementById('txtagency').value == "") {
        alert("Please fill the agency name");
        document.getElementById('txtagency').disabled = false;
        document.getElementById('txtagency').focus();
        return false;
    }


    if (document.getElementById('txtclient').value == "") {
        alert("Please fill the client name");
        document.getElementById('txtclient').disabled = false;
        document.getElementById('txtclient').focus();
        return false;
    }
    if (document.getElementById('drpretainer').disabled == false) {
        if (document.getElementById('drpretainer').value == "" && document.getElementById('txtexecname').value == "") {
            var a = "Executive name";
            var b = "Retainer";
            if (browser != "Microsoft Internet Explorer") {
                a = document.getElementById('lbececname').textContent.replace("*[F2]", "");
                b = document.getElementById('lblretainer').textContent.replace("*[F2]", "");
            }
            else {
                a = document.getElementById('lbececname').innerText.replace("*[F2]", "");
                b = document.getElementById('lblretainer').innerText.replace("*[F2]", "");
            }
            alert('Please fill ' + a + ' or ' + b + '.');

            document.getElementById('drpretainer').focus();
            return false;
        }
    }
        
        
    if (enLink == "1") {
        document.getElementById('LinkButton1').disabled = false;
        document.getElementById('LinkButton2').disabled = false;
        document.getElementById('LinkButton3').disabled = false;
        document.getElementById('LinkButton4').disabled = false;
        document.getElementById('LinkButton5').disabled = false;
//        document.getElementById('LinkButton6').disabled = false;
//        document.getElementById('LinkButton7').disabled = false;
    }
    if (document.getElementById('LinkButton3').disabled == false) {



      



        if (document.getElementById('drpbooktype').value == "0") {
            alert("Please Select Booking Type");
            document.getElementById('drpbooktype').focus();
            return false;
        }


//        if (document.getElementById('txtcategory').value == "" || document.getElementById('hdncategory').value == "") {
//            alert("Please Select Ad Category");
//            document.getElementById('txtcategory').focus();
//            return false;
//        }




        if (document.getElementById('drpuom').value == "0") {
            alert("Please Select UOM");
            document.getElementById('drpuom').focus();
            return false;
        }




        if (document.getElementById('drpcurrency').value == "0") {
            alert("Please Select Currency");
            document.getElementById('drpcurrency').focus();
            return false;
        }




        if (document.getElementById('drppackagecopy').options.length == 0) {
            alert("Please Select Package");
            if (document.getElementById('tblpackage').style.display == "block")
                document.getElementById('drppackage').focus();
            return false;
        }
        if (document.getElementById('txtdummydate').value == "") {
            alert("Please Enter Date");
            if (document.getElementById('tblpackage').style.display == "block")
                document.getElementById('txtdummydate').focus();
            return false;
        }
        if (document.getElementById('drpcurrency').value == "0" || document.getElementById('drpcurrency').value == "") {
            alert("Please Select Currency");
            if (document.getElementById('tblpackage').style.display == "block")
                document.getElementById('drpcurrency').focus();
            return false;
        }

        if (document.getElementById('drprptcurrency').value == "0") {
            alert("Please Select Reciept Currency");
            document.getElementById('drprptcurrency').focus();
            return false;
        }

        var chmandat;
        if (browser != "Microsoft Internet Explorer") {
            chmandat = document.getElementById('lblpage').textContent;
        }
        else {
            chmandat = document.getElementById('lblpage').innerText;
        }
        if (chmandat.indexOf("*") >= 0 && document.getElementById('drppageprem').value != "CA0") {
            alert("Please Select Page Premium");
            document.getElementById('drppageprem').disabled = false;
            document.getElementById('drppageprem').focus();
            return false;
        }
        

        if (document.getElementById('txttotalarea').value == "") {
            alert("Please Enter Total Area");
            document.getElementById('txttotalarea').disabled = false;
            document.getElementById('txttotalarea').focus();
            return false;
        }

        if (document.getElementById('txtratecode').value == "0") {
            alert("Please Select Rate Code");
            document.getElementById('txtratecode').focus();
            return false;
        }
        
        
        
        
        
        
      
        
        
        
        if (document.getElementById('LinkButton1').disabled == false) {
           
        }



        document.getElementById('LinkButton3').style.fontWeight = "bold";
        document.getElementById('LinkButton3').style.color = "#FFFF80";
        document.getElementById('LinkButton1').style.fontWeight = "normal";
        document.getElementById('LinkButton1').style.color = "White";
        document.getElementById('LinkButton2').style.fontWeight = "normal";
        document.getElementById('LinkButton2').style.color = "White";
        document.getElementById('LinkButton5').style.fontWeight = "normal";
        document.getElementById('LinkButton5').style.color = "White";
        document.getElementById('LinkButton4').style.fontWeight = "normal";
        document.getElementById('LinkButton4').style.color = "White";
//        document.getElementById('LinkButton6').style.fontWeight = "normal";
//        document.getElementById('LinkButton6').style.color = "White";
//        document.getElementById('LinkButton7').style.fontWeight = "normal";
//        document.getElementById('LinkButton7').style.color = "White";
        document.getElementById('tbvts').style.display = "none";
        //alert(document.getElementById('LinkButton1').click);
        document.getElementById('tblrate').style.display = "none";
        //document.getElementById('tblbill').style.display="none";
        document.getElementById('tblbill').style.display = "block";
        if (document.getElementById('drpbillcycle').disabled == false) {
            document.getElementById('drpbillcycle').focus();
        }
        document.getElementById('addetails').style.display = "none";
        document.getElementById('pagedetail').style.display = "none";
        document.getElementById('tblpackage').style.display = "none";
        document.getElementById('tbbox').style.display = "none";
        document.getElementById('tbvts').style.display = 'none';
       

        document.getElementById('tdrec').style.display = "none";
        
        if (document.getElementById('hiddensavemod').value == "1") {
            if (document.getElementById('txtagencypaymode').value == "CR1" && document.getElementById('creditreceipt_allow').value == "N") {
                document.getElementById('tdrec').style.display = "none";
                document.getElementById('receipt').style.display = "none";
                document.getElementById('print').style.display = "none";
            }
            else {
                document.getElementById('tdrec').style.display = "";
                document.getElementById('receipt').style.display = "";
                document.getElementById('print').style.display = "";
            }
        }
        else {
            document.getElementById('tdrec').style.display = "none";
            document.getElementById('receipt').style.display = "none";
            document.getElementById('print').style.display = "none";
        }
        
        return false;
    }
}


function bindrategroupvode() {

    web_booking.bindratecode(document.getElementById('hdncategory').value, document.getElementById('hiddencompcode').value, call_bindrategroupvode);
    return false;
}

function call_bindrategroupvode(response) {
    var ds = response.value;
    var pkgitem = document.getElementById("txtratecode");
    pkgitem.options.length = 0;
    pkgitem.options[0] = new Option("-Select", "0");
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {
        pkgitem.options.length = 1;
        for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].rate_mast_code, ds.Tables[0].Rows[i].rate_mast_code);

            pkgitem.options.length;
        }

    }
}





function insertLinesubtract_callback(packagename, check) {
    // get No of Insertion
    var rowCount = parseInt(document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length);
    var finsert = 1;
    var insertion = document.getElementById('txtinsertion').value;
    var gridtab_vari = document.getElementById('gridtab');
    var pkgcopy_vari = document.getElementById('drppackagecopy');
    var bookdiv_vari = document.getElementById('bookdiv');
    if (spdiscper == 1) {
        document.getElementById('txtspedisc').value = "";
    }
    else if (spdisc == 1) {
        document.getElementById('txtspediscper').value = "";
    }
    if (check == 'main') {
        if (pkgcopy_vari.options.length > 0) {
            for (var insertCou = 0; insertCou < pkgcopy_vari.options.length; insertCou++) {
                rowCount = parseInt(bookdiv_vari.getElementsByTagName('table')[0].rows.length);
                if (pkgcopy_vari.options[insertCou].value.indexOf('(') >= 0) {
                    tinsert = pkgcopy_vari.options[insertCou].value.substring(pkgcopy_vari.options[insertCou].value.indexOf('(') + 1, pkgcopy_vari.options[insertCou].value.indexOf(')'));
                }

                var dInsert = (parseInt(previnsertion, 10) * parseInt(tinsert, 10)) - (parseInt(insertion, 10) * parseInt(tinsert, 10));
                var insid = "";
                for (var d = parseInt(rowCount) - 2; d >= 0; d--) {
                    var id = gridtab_vari.getElementsByTagName("tbody")[0].rows[d + 1].cells[0].id.substr(3, gridtab_vari.getElementsByTagName("tbody")[0].rows[d + 1].cells[0].id.length - 3);
                    var ins_vari = document.getElementById("ins" + id);
                    var par1 = (ins_vari.parentNode).parentNode;
                    if (insid != "") {
                        if (insid != ins_vari.innerHTML) {
                            dInsert = parseInt(dInsert) - 1;
                        }
                    }
                    if (dInsert == 0)
                        break;
                    var strid = pkgcopy_vari.options[insertCou].value;
                    var strid1 = strid.split('@');
                    var pkgid = strid1[0];
                    if (browser != "Microsoft Internet Explorer") {
                        var pkgcodegrid = document.getElementById("hiddenpckcode" + id).value;
                    }
                    else {
                        var pkgcodegrid = par1.all["hiddenpckcode" + id].value;
                    }
                    if (pkgcodegrid == pkgid) {
                        insid = ins_vari.innerHTML;
                        gridtab_vari.deleteRow(d + 1);
                        try {
                            delete caldate[d];
                            delete caldatemonth[d];
                            delete caldateyear[d];
                        }
                        catch (er) { }
                    }
                }
            }
        }

    }
    else {
        if (pkgcopy_vari.options.length > 0) {
            for (var insertCou = 0; insertCou < pkgcopy_vari.options.length; insertCou++) {
                rowCount = parseInt(bookdiv_vari.getElementsByTagName('table')[0].rows.length);
                if (pkgcopy_vari.options[insertCou].value.indexOf('(') >= 0) {
                    tinsert = pkgcopy_vari.options[insertCou].value.substring(pkgcopy_vari.options[insertCou].value.indexOf('(') + 1, pkgcopy_vari.options[insertCou].value.indexOf(')'));
                }
                if (packagename == pkgcopy_vari.options[insertCou].value) {
                    var prevtinsert = parseInt(tinsert) + 1;
                    var insid = "";
                    var dInsert = (parseInt(previnsertion, 10) * parseInt(prevtinsert, 10)) - (parseInt(insertion, 10) * parseInt(tinsert, 10));
                    for (n = 0; n < dInsert; n++) {
                        for (var d = parseInt(rowCount) - 2; d >= 0; d--) {
                            var ins_vari = document.getElementById("ins" + id);
                            var par1 = (ins_vari.parentNode).parentNode;
                            var strid = pkgcopy_vari.options[insertCou].value;
                            var strid1 = strid.split('@');
                            var pkgid = strid1[0];
                            var id = gridtab_vari.getElementsByTagName("tbody")[0].rows[d + 1].cells[0].id.substr(3, gridtab_vari.getElementsByTagName("tbody")[0].rows[d + 1].cells[0].id.length - 3);
                            if (browser != "Microsoft Internet Explorer") {
                                var pkgcodegrid = document.getElementById("hiddenpckcode" + id).value;
                            }
                            else {
                                var pkgcodegrid = par1.all["hiddenpckcode" + id].value;
                            }
                            if (insid != "") {

                                if (insid != ins_vari.innerHTML && n == dInsert - 1) {
                                    return false;
                                }
                            }
                            if (pkgcodegrid == pkgid) {
                                if (insid != "") {
                                    if (insid != ins_vari.innerHTML) {
                                        n = parseInt(n, 10) + 1;
                                    }
                                }
                                insid = ins_vari.innerHTML;
                                gridtab_vari.deleteRow(d + 1);
                                try {
                                    delete caldate[d];
                                    delete caldatemonth[d];
                                    delete caldateyear[d];
                                }
                                catch (er) { }
                            }
                        }
                    }
                }

            }
        }
    }
    previnsertion = document.getElementById('txtinsertion').value;
    document.getElementById('hiddenrowcount').value = parseInt(document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length) - 1;
    return false;

}


 





	    function getremarkintogrid() {
	        var len = "bookdiv";
	        if (document.getElementById(len) != null) {
	            var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
	            var k;
	            var remark_inserts;
	            var premark = document.getElementById('txtprintremark').value;
	            for (k = 0; k < y - 1; k++) {


	                remark_inserts = "rem" + k;
	                var remark_inserts_var = document.getElementById(remark_inserts);
	                var par1 = (remark_inserts_var.parentNode).parentNode;
	                if (browser != "Microsoft Internet Explorer") {
	                    if (document.getElementById(remark_inserts) != null) {
	                        document.getElementById(remark_inserts).value = premark;
	                    }

	                }
	                else {
	                    if (par1.all[remark_inserts] != null) {
	                        par1.all[remark_inserts].value = premark.toUpperCase();
	                    }
	                }
	            }
	        }
	    }



	    function getsizeintogrid() {
	        var len = "bookdiv";
	        if (document.getElementById(len) != null) {
	            var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
	            var k;
	            var size;
	            var psize = document.getElementById('txttotalarea').value;
	            for (k = 0; k < y - 1; k++) {


	                size = "size" + k;
	                var size_var = document.getElementById(size);
	                var par1 = (size_var.parentNode).parentNode;
	                if (browser != "Microsoft Internet Explorer") {
	                    if (document.getElementById(size) != null) {
	                        document.getElementById(size).value = psize;
	                    }

	                }
	                else {
	                    if (par1.all[size] != null) {
	                        par1.all[size].value = psize.toUpperCase();
	                    }
	                }
	            }
	        }
	    }



	    function checkGridDate_Validation() {
	        var rowcount = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
	        var len = "bookdiv";
	        var id;
	        var height;
	        var width;
	        var pagepost;
	        var matsta;
	        var insertsta;
	        var editdate;
	        var size;
	        var inserts;
	        var gross_var = document.getElementById('txtgrossamt');
	        var ratecode_var = document.getElementById("txtratecode");
	        var adsize1_var = document.getElementById('txtadsize1');
	        var adsize2_var = document.getElementById('txtadsize2');
	        if (document.getElementById('txttotalarea').value == "") {
	            alert("Please Enter Size/Lines");
	            return false;
	        }
	        gfollodate = "";
	        for (var itemCount = 0; itemCount < parseInt(rowcount); itemCount++) {
	            id = "Text" + itemCount;
	            height = "hei" + itemCount;
	            width = "wid" + itemCount;
	            pagepost = "pagpos" + itemCount;
	            matsta = "mat" + itemCount;
	            insertsta = "inssta" + itemCount;
	            cardid = "cardrate" + itemCount;
	            editid = "edit" + itemCount;
	            editdate = "Text" + itemCount;
	            size = "siz" + itemCount;
	            inserts = "ins" + itemCount;
	            var file_nam = "fil" + itemCount;
	            var noofcol = "nocol" + itemCount;
	            var alertLine = parseInt(itemCount) + 1;
	            var par1;
	            var id_var = document.getElementById(id);
	            par1 = (id_var.parentNode).parentNode;
	            if (document.getElementById(id).value != "")
	                gfollodate = document.getElementById(id).value;

	            if (browser != "Microsoft Internet Explorer") {
	                //   alert(document.getElementById(height).value);
	                if (document.getElementById(id).value == "" && document.getElementById("hdnfollodate").value == "N") {
	                    alert("Please Fill the insertion date for Item Line " + alertLine);
	                    document.getElementById(id).focus();
	                    gross_var.value = '';
	                    return false;
	                }
//	                else if (document.getElementById(height).value == "" && adsize1_var.disabled == false) {
//	                    alert("Please fill height for Item Line " + alertLine);
//	                    document.getElementById('txtgrossamt').focus();
//	                    gross_var.value = '';
//	                    return false;
//	                }

//	                else if ((document.getElementById(width).value == "" && document.getElementById(noofcol).value == "") && adsize2_var.disabled == false) {
//	                    alert("Please fill width or Columns for Item Line " + alertLine);

//	                    gross_var.value = '';
//	                    return false;
//	                }

//	                else if (document.getElementById(size).value == "" && adsize2_var.disabled == true) {
//	                    alert("Please fill size for Item Line " + alertLine);
//	                    gross_var.value = '';
//	                    return false;
//	                }
	                else if (ratecode_var != null) {
	                    if (ratecode_var.value == "0") {
	                        alert("Please Select RateCode");
	                        return false;
	                    }
	                }
	                else if (document.getElementById(matsta) != null) {
	                    if (document.getElementById(matsta).value == "" || document.getElementById(matsta).value == "0") {
	                        alert("Please select material status for  Item Line " + alertLine);
	                        document.getElementById(matsta).focus();
	                        return false;

	                    }
	                }

	                else if (document.getElementById(insertsta) != null) {
	                    if (document.getElementById(insertsta).value == "" || document.getElementById(insertsta).value == "0") {
	                        alert("Please select material status for  Item Line " + alertLine);
	                        document.getElementById(matsta).focus();
	                        return false;

	                    }
	                }

	            }
	            else {
	                if (par1.all[id].value == "" && document.getElementById("hdnfollodate").value == "N") {
	                    alert("Please Fill the insertion date for Item Line " + alertLine);
	                    par1.all[id].focus();
	                    gross_var.value = '';
	                    return false;
	                }

//	                else if (par1.all[height].value == "" && adsize1_var.disabled == false) {
//	                    alert("Please fill height for Item Line " + alertLine);
//	                    document.getElementById('txtgrossamt').value = '';
//	                    return false;
//	                }

//	                else if ((par1.all[width].value == "" && par1.all[noofcol].value == "") && adsize2_var.disabled == false) {
//	                    alert("Please fill width or Columns for Item Line " + alertLine);
//	                    gross_var.value = '';
//	                    return false;
//	                }
//	                else if (par1.all[size].value == "" && adsize2_var.disabled == true) {
//	                    alert("Please fill size for Item Line " + alertLine);
//	                    gross_var.value = '';
//	                    return false;
//	                }
	                /*   else if(document.getElementById(file_nam).value=="")
	                {
	                alert("Please upload Material for Item Line "+alertLine);
	                return false;
	                } */
	                else if (ratecode_var != null) {
	                    if (ratecode_var.value == "0") {
	                        alert("Please Select RateCode");
	                        return false;
	                    }
	                }
	                else if (par1.all[matsta] != null) {
	                    if (par1.all[matsta].value == "" || par1.all[matsta].value == "0") {
	                        alert("Please select material status for  Item Line " + alertLine);
	                        par1.all[matsta].focus();
	                        return false;

	                    }
	                }
	                else if (par1.all[insertsta].value == "" || par1.all[insertsta].value == "0") {
	                    alert("Please select insertion status for  Item Line " + alertLine);
	                    par1.all[insertsta].focus();
	                    return false;

	                }
	            }
	        }
	        //totalspaceavilable();
	        if (document.getElementById('allowpaidchangeper').value != "N")
	            ResetPaidInsertion();
	        flooramount = 0;
	        var resn = bindFinalRate();
	        if (resn == false)
	            return false;
	        //special charges  
	        if (hiddisctype != "S") {
	            getspecialdisc('');  //special discount   
	        }
	        getspacedisc('');
	        getsplcharge();

	        getRetainerCommAmt();
	        addagencycommRate();

	        if (parseFloat(flooramount) != 0 && parseFloat(flooramount) > parseFloat(document.getElementById('txtgrossamt').value)) {
	            alert("Booking Amount can't be less than " + flooramount);
	            document.getElementById('txtbillamt').value = "";
	            return false;
	        }
	        if (document.getElementById('chkcontract').checked == true && document.getElementById('txtcontractname').value != '' && document.getElementById('txtcontracttype').value != "INSERTS") {
	            bindContractRate();
	        }
	        if (document.getElementById('configclient').value != "PUNE" && document.getElementById('configclient').value != "RP" && vat_app == "1") {
	            bindVtsRate();
	        }
	        // Calculation for Translation Charge..
//	        if (document.getElementById('hiddentranalpremtype') != null && (document.getElementById('txttranslationcharges') != null &&  || (document.getElementById('drptranslation').value != "" && document.getElementById('drptranslation').value != "0" && boxstatus != "billed")) //for on translation charges
//	        {
//	            var tranlationcharge = 0;
//	            var Insertgrossamt = 0;
//	            var count1 = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
//	            // for (var i = 0; i < count1; i++) {
//	            if (document.getElementById("ins0").innerHTML == 1) {
//	                // if (document.getElementById('gro' + i).value != "" && document.getElementById('gro' + i).value != null)
//	                if (document.getElementById('txtagreedamt').value != "" && document.getElementById('txtagreedamt').value != null) {
//	                    var paidCount = document.getElementById('txtinsertion').value;
//	                    var finsert = 1;
//	                    var tinsert = 0;
//	                    if (document.getElementById('drppackagecopy').options.length > 0) {
//	                        for (var insertCou = 0; insertCou < document.getElementById('drppackagecopy').options.length; insertCou++) {
//	                            if (document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') >= 0) {
//	                                tinsert = document.getElementById('drppackagecopy').options[insertCou].value.substring(document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') + 1, document.getElementById('drppackagecopy').options[insertCou].value.indexOf(')'));
//	                                if (parseInt(tinsert) > parseInt(finsert)) {
//	                                    finsert = tinsert;
//	                                }
//	                                paidCount = parseInt(paidCount) * parseInt(tinsert);
//	                            }
//	                        }
//	                    }
//	                    Insertgrossamt = parseFloat(Insertgrossamt) + (parseFloat(document.getElementById('txtagreedamt').value) / parseFloat(paidCount));
//	                }
//	                else if (document.getElementById('txtcardamt').value != "" && document.getElementById('txtcardamt').value != null)
//	                    Insertgrossamt = parseFloat(Insertgrossamt) + parseFloat(document.getElementById('txtcardamt').value);

//	            }
//	            // else {
//	            //  break;
//	            // }
//	            //  }

//	            if (document.getElementById('txttranslationcharges') != null)
//	                var tranlationch = document.getElementById('txttranslationcharges').value;
//	            if (tranlationch != "" && document.getElementById('txttranslationdisc').value != "")
//	                tranlationch = parseFloat(tranlationch) - parseFloat(document.getElementById('txttranslationdisc').value);
//	            if (tranlationch != null && tranlationch != "" && tranlationch != "0") {
//	                tranlationcharge = parseInt(tranlationch);
//	            }
//	            if (document.getElementById('hiddentranalpremtype').value == 'P') {
//	                //tranlationcharge = (parseFloat(document.getElementById('txtbillamt').value) * parseFloat(tranlationcharge)) / 100;
//	                tranlationcharge = ((Insertgrossamt) * parseFloat(tranlationcharge)) / 100;
//	            }
//	            document.getElementById('txtbillamt').value = parseFloat(document.getElementById('txtbillamt').value) + parseFloat(tranlationcharge);
//	            if (document.getElementById("ba0") != null && document.getElementById("ba0").value != "") {
//	                document.getElementById("ba0").value = parseFloat(document.getElementById("ba0").value) + parseFloat(tranlationcharge);

//	            }
//	        }
//	        if (document.getElementById('drpbillcycle').value == "6" && roundoff != "editionwise")
//	            roundoff = "rowise";
//	        else {
//	            if (roundoff != "editionwise")
//	                roundoff = "insertionwise";
//	        }
	        //chk barter amount
	       // var resn = checkBarterAmt();
	        if (resn == false)
	            return false;
	        // for round off
	        var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
	        billamtA = 0;
	        var f = false;
	        if (roundoff == "editionwise") {
	            var billLo = 0;
	            var billMa = 0;
	            for (var n = 0; n < count; n++) {
	                billid = document.getElementById('ba' + n);
	                billidlocal = document.getElementById('balocal' + n);
	                if (document.getElementById('ba' + n).value != 0 && document.getElementById('inssta' + n).value == "booked") {

	                    var billAmtC = document.getElementById('ba' + n).value;
	                    var billamt = billAmtC;
	                    var billamtA = parseFloat(billAmtC) + .01;
	                    billamtA = Math.round(billamtA);
	                    var diff = parseFloat(billamtA) - parseFloat(billamt);
	                    if (billid != null) {
	                        billid.value = parseFloat(billid.value) + parseFloat(diff);
	                        billid.value = parseFloat(billid.value).toFixed(2)
	                    }

	                    billAmtC = document.getElementById('balocal' + n).value;
	                    billamt = billAmtC;
	                    billamtA = parseFloat(billAmtC) + .01;
	                    billamtA = Math.round(billamtA);
	                    diff = parseFloat(billamtA) - parseFloat(billamt);
	                    if (billidlocal != null) {
	                        billidlocal.value = parseFloat(billidlocal.value) + parseFloat(diff);
	                        billidlocal.value = parseFloat(billidlocal.value).toFixed(2)
	                    }

	                }
	                billMa = parseFloat(billMa) + parseFloat(billid.value);
	                billLo = parseFloat(billLo) + parseFloat(billidlocal.value);
	            }
	            document.getElementById('txtbillamt').value = billMa;
	            document.getElementById('txtbillamtlocal').value = billLo;
	        }
	        if (roundoff == "rowise") {
	            var billamt = document.getElementById('txtbillamt').value;
	            var billamtA = parseFloat(document.getElementById('txtbillamt').value) + .01;
	            billamtA = Math.round(billamtA);
	            var diff = parseFloat(billamtA) - parseFloat(billamt);
	            document.getElementById('txtbillamt').value = billamtA;
	        }


	        for (var i1 = 0; i1 < count; i1++) {

	            if (document.getElementById('ba' + i1).value != 0 && document.getElementById('inssta' + i1).value == "booked" && f == false && roundoff == "rowise") {
	                document.getElementById('ba' + i1).value = parseFloat(document.getElementById('ba' + i1).value) + parseFloat(diff);
	                document.getElementById('ba' + i1).value = parseFloat(document.getElementById('ba' + i1).value).toFixed(2);
	                // i1=count;
	                f = true;
	                if (document.getElementById('hiddenboxchrgtype') != null && document.getElementById('txtboxchrg') != null && document.getElementById('txtboxchrg').value != "" && document.getElementById('txtboxchrg').value != "0") //for on gross box charges
	                {
	                    f = true;
	                }
	                //     else{
	                // i1=parseInt(count,10)-1;
	                //  }
	            }
	            if (document.getElementById('hiddenboxchrgtype') != null && (document.getElementById('txtboxchrg') != null && document.getElementById('txtboxchrg').value != "" && document.getElementById('txtboxchrg').value != "0") || (document.getElementById('drpboxcode').value != "" && document.getElementById('drpboxcode').value != "0")) //for on gross box charges
	            {
	                if (document.getElementById('hiddeninsertwise').value == 'no' && i1 == 0) {
	                    var boxcharge = 0;

	                    if (document.getElementById('txtboxchrg') != null)
	                        boxpercen = document.getElementById('txtboxchrg').value;
	                    if (boxpercen != null && boxpercen != "" && boxpercen != "0") {
	                        boxcharge = parseInt(boxpercen);
	                    }
	                    if (document.getElementById('hiddenboxchrgtype').value == '2') {
	                        boxcharge = (parseFloat(document.getElementById('txtbillamt').value) * parseFloat(boxcharge)) / 100;
	                    }
	                    document.getElementById('txtbillamt').value = parseFloat(document.getElementById('txtbillamt').value) + parseFloat(boxcharge);
	                    if (document.getElementById("ba0") != null && document.getElementById("ba0").value != "") {
	                        document.getElementById("ba0").value = parseFloat(document.getElementById("ba0").value) + parseFloat(boxcharge);
	                        document.getElementById("boxc0").value = boxcharge;
	                    }
	                }
	            }
	            if (document.getElementById('hiddenboxchrgtype') != null) //for on gross box charges
	            {
	                if (document.getElementById('hiddeninsertwise').value == 'yes') {
	                    var boxcharge = 0;

	                    if (document.getElementById('txtboxchrg') != null)
	                        boxpercen = document.getElementById('txtboxchrg').value;

	                    if (boxpercen != null && boxpercen != "" && boxpercen != "0") {
	                        boxcharge = parseInt(boxpercen);
	                    }
	                    if (document.getElementById('pai' + i1).value == "N" || document.getElementById('inssta' + i1).value == "cancel") {
	                        boxcharge = 0;
	                    }
	                    if (document.getElementById('hiddenboxchrgtype').value == '2') {
	                        boxcharge = (parseFloat(document.getElementById('gro' + i1).value) * parseFloat(boxcharge)) / 100;
	                    }
	                    if (document.getElementById('inssta' + i1).value == "booked") {
	                        document.getElementById('ba' + i1).value = parseFloat(document.getElementById('ba' + i1).value) + parseFloat(boxcharge);
	                        document.getElementById('ba' + i1).value = parseFloat(document.getElementById('ba' + i1).value).toFixed(2);
	                       // document.getElementById("boxc" + i1).value = boxcharge;
	                    }

	                }
	            }

	            billamtA = parseFloat(billamtA) + parseFloat(document.getElementById('ba' + i1).value)
	            document.getElementById("grolocal" + i1).value = document.getElementById("gro" + i1).value;
	            document.getElementById("balocal" + i1).value = document.getElementById("ba" + i1).value;
	        }
	        if (document.getElementById('hiddenboxchrgtype') != null && document.getElementById('txtboxchrg') != null && document.getElementById('txtboxchrg').value != "" && document.getElementById('txtboxchrg').value != "0") //for on gross box charges
	            document.getElementById('txtbillamt').value = parseFloat(billamtA).toFixed(2);
	        else
	            document.getElementById('txtbillamt').value = parseFloat(document.getElementById('txtbillamt').value);
	        document.getElementById('txtbillamt').value = parseFloat(document.getElementById('txtbillamt').value).toFixed(2);
	        document.getElementById('txtgrossamtlocal').value = document.getElementById('txtgrossamt').value;
	        document.getElementById('txtbillamtlocal').value = document.getElementById('txtbillamt').value;
	        if (document.getElementById('drpcurrency').value != document.getElementById('hidcurr').value || document.getElementById('drpcurrency').value != document.getElementById('drprptcurrency').value)
	            getAmount_Currency();
	        // roundoff insertionwise
	            if (roundoff == "insertionwise") {
	            var tCount = 0;
	            var counterT = 0;
	            var i = 0;
	            var f_total = 0;
	            var f_totallocal = 0;
	            for (var i1 = 0; i1 < count; ) {
	                i = i + 1;
	                var ins_vari = document.getElementById('ins' + i1);
	                if (ins_vari != null) {
	                    tCount = 0;
	                    while (parseInt(ins_vari.innerHTML) == parseInt(i)) {
	                        tCount = parseInt(tCount) + 1;
	                        counterT = parseInt(counterT) + 1;
	                        ins_vari = document.getElementById('ins' + counterT);
	                        if (ins_vari == null)
	                            break;
	                    }
	                }
	                gridItemCount = tCount;  //get gridcount
	                var billid;
	                var billidlocal;
	                var billAmtC = 0;
	                var billAmtClocal = 0;
	                var insertsta1 = "";
	                var drpbooktype_vari = document.getElementById('drpbooktype').value
	                for (var n = 0; n < gridItemCount; n++) {
	                    insertsta1 = document.getElementById("inssta" + i1);
	                    roundamt = document.getElementById('roundoffval' + i1);
	                    if (document.getElementById('ba' + i1).value != 0 && document.getElementById('inssta' + i1).value != "billed" && document.getElementById('inssta' + i1).value != "cancel") {
	                        billid = document.getElementById('ba' + i1);
	                        billidlocal = document.getElementById('balocal' + i1);
	                        roundamt = document.getElementById('roundoffval' + i1);
	                    }
	                    billAmtC = parseFloat(billAmtC) + parseFloat(document.getElementById('ba' + i1).value);
	                    billAmtClocal = parseFloat(billAmtClocal) + parseFloat(document.getElementById('balocal' + i1).value);
	                    f_total = parseFloat(f_total) + parseFloat(document.getElementById('ba' + i1).value);
	                    f_totallocal = parseFloat(f_totallocal) + parseFloat(document.getElementById('balocal' + i1).value);
	                    i1 = i1 + 1;
	                }
	                var billamt = billAmtC;
	                //var billamtA= parseFloat(billAmtC) + .01;
	                billamtA = (Math.floor((billAmtC) * 20) / 20);
	                var diff = parseFloat(billamtA) - parseFloat(billamt);
	                if (billid != null) {
	                    billid.value = parseFloat(billid.value) + parseFloat(diff);
	                    billid.value = parseFloat(billid.value).toFixed(2);
	                    roundamt.value = parseFloat(diff).toFixed(2);
	                    f_total = parseFloat(f_total) + parseFloat(diff);
	                    f_total = parseFloat(f_total).toFixed(2)
	                }
	                billamt = billAmtClocal;
	                //billamtA= parseFloat(billAmtClocal) + .01;
	                billamtA = (Math.floor((billAmtClocal) * 20) / 20);
	                var diff = parseFloat(billamtA) - parseFloat(billamt);
	                if (billidlocal != null) {
	                    billidlocal.value = parseFloat(billidlocal.value) + parseFloat(diff);
	                    billidlocal.value = parseFloat(billidlocal.value).toFixed(2)
	                    f_totallocal = parseFloat(f_totallocal) + parseFloat(diff);
	                    f_totallocal = parseFloat(f_totallocal).toFixed(2)
	                }
	                if (drpbooktype_vari == "2" || drpbooktype_vari == "4" || drpbooktype_vari == "5" || drpbooktype_vari == "6") {
	                    if (insertsta1.value != "billed") {
	                        roundamt.value = "";
	                    }
	                }
	            }
	            document.getElementById('txtbillamt').value = f_total;
	            document.getElementById('txtbillamtlocal').value = f_totallocal;
	        }

	        return false;
	    }







function ResetPaidInsertion() {
    var agreedrate_vari = document.getElementById('txtagreedrate');
    var agreedamt_vari = document.getElementById('txtagreedamt');
    var drppackagecopy_vari = document.getElementById('drppackagecopy');
    var len = "bookdiv";
    if (document.getElementById(len) != null && document.getElementById(len) != "null") {
        if ((agreedrate_vari.value != "" && agreedrate_vari.value != "0") || (agreedamt_vari.value != "" && agreedamt_vari.value != "0") || document.getElementById('txtratecode').value == "0") {

            var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
            for (var s = 0; s < count; s++) {
                var pai_vari = document.getElementById('pai' + s);
                if (pai_vari != null) {
                    pai_vari.value = 'Y';
                }
            }
            // get paid Insertion
            var paidCount = document.getElementById('txtinsertion').value;
            var finsert = 1;
            var tinsert = 0;
            if (drppackagecopy_vari.options.length > 0) {
                for (var insertCou = 0; insertCou < drppackagecopy_vari.options.length; insertCou++) {
                    if (drppackagecopy_vari.options[insertCou].value.indexOf('(') >= 0) {
                        tinsert = drppackagecopy_vari.options[insertCou].value.substring(drppackagecopy_vari.options[insertCou].value.indexOf('(') + 1, drppackagecopy_vari.options[insertCou].value.indexOf(')'));
                        if (parseInt(tinsert) > parseInt(finsert)) {
                            finsert = tinsert;
                        }
                        paidCount = parseInt(paidCount) * parseInt(tinsert);
                    }
                }
            }
            document.getElementById('txtpaid').value = paidCount;
        }
    }
}




function bindFinalRate() {
    var premper_vari = "";
    
    var discprem= "";
    var spediscper = document.getElementById('txtspediscper').value;
    var chkadon_var = "";
    if (document.getElementById('chkadon').checked == true) {
        chkadon_var = "Y";
    }
    else {
        chkadon_var = "N";
    }
    if (document.getElementById('txtagreedamt').value == "" && document.getElementById('txtagreedrate').value != "" && document.getElementById('txtagreedrate').value != "0" && document.getElementById('txtagreedrate').value != "0.00")
        agreedrate_active = "1";
    else if (document.getElementById('txtagreedrate').value == "" && document.getElementById('txtagreedamt').value != "" && document.getElementById('txtagreedamt').value != "0" && document.getElementById('txtagreedamt').value != "0.00")
        agreedamt_active = "1";
    getagreedamt_Rate();
    //calculate trade discount
    var tradisc = document.getElementById('txttradedisc').value;
    if (document.getElementById('chktrade').checked == false)
        tradisc = 0;
    if (tradisc == "")
        tradisc = 0;
    var trdisc1 = tradisc;
    var addcomm = 0;
    if (document.getElementById('txtaddagencycommrate') != null) {
        if (document.getElementById('hiddenagcommflag').value != "1")
            addcomm = document.getElementById('txtaddagencycommrate').value;
    }
    if (addcomm == "") {
        addcomm = "0";
    }
    if (addcomm != "0") {
        trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
    }
    var billamount = 0;
    var agncomm_seq_com_vari = document.getElementById('agncomm_seq_com').value;
    var drpbooktype_vari = document.getElementById('drpbooktype').value;
    var grossamt_vari = document.getElementById('txtgrossamt');
    var billamt_vari = document.getElementById('txtbillamt');
    var spacedisc_vari = document.getElementById('txtspacedisc').value;
    var hiddenratecheckdate_vari = document.getElementById('hiddenratecheckdate').value;
    var datetime_vari = document.getElementById('txtdatetime').value;
    var schemetype_vari = document.getElementById('hiddenschemetype').value;
    var hidschememin_vari = document.getElementById('hidschememin').value;
    var bullet_var = document.getElementById('drpbullet');
    var scheme_var = ""; //document.getElementById('drpscheme');
    var scheme_var_id = document.getElementById('drpscheme');
    var noofinsertion = document.getElementById('txtinsertion').value;
    var compcode = document.getElementById('hiddencompcode').value;
    var uom = document.getElementById('drpuom').value;
    var adtype = "WE0";
    var currency = document.getElementById('drpcurrency').value;
    var ratecode = document.getElementById('txtratecode').value;
    var clientcode = ""; //getclientcode();
    var uomdesc = document.getElementById('hiddenuomdesc').value;
    var agencycode = document.getElementById('hiddenagency').value;
    var agency_vari = document.getElementById('txtagency');
    var drppackage_vari = document.getElementById('drppackagecopy');
    if (agency_vari.value != "") {
        agencycode = agency_vari.value.substring(agency_vari.value.lastIndexOf("(") + 1, agency_vari.value.lastIndexOf(")"));
    }
    //====Changes for Rate Revise===//
    if (document.getElementById('hdnrevise').value != "" && document.getElementById('txtrevisedate').value != "") {
        var resagchk = web_booking.chkagencyforraterevise(compcode, agencycode);
        if (resagchk.value == null) {
            alert(resagchk.error.description);
            return false;
        }
        if (resagchk.value.Tables[0].Rows.length > 0) {
            if (resagchk.value.Tables[0].Rows[0].RATE_REVISE != '1') {
                alert("You Can't select Revise Date for This Agency");
                return false;
            }
        }
    }
    if (document.getElementById('hdnfollodate').value == "Y" && gfollodate == "") {
        alert("Please Fill the insertion date");
        return false;
    }
    //==****************===//
    var center = document.getElementById('hiddencenter').value; //"0"
    var ratepremtype = document.getElementById('hiddenratepremtype').value;
    var dateformat = document.getElementById('hiddendateformat').value;
    var eyecatchtype = '';
    if (document.getElementById('hiddenbulletpremtype') != null)
        eyecatchtype = document.getElementById('hiddenbulletpremtype').value;
    var bPrem = '';
    if (document.getElementById('hiddenbullprem') != null)
        bPrem = document.getElementById('hiddenbullprem').value;
    var boxchargeInsertionwise = document.getElementById('hiddeninsertwise').value;
    var boxcharge = 0;
    if (document.getElementById('txtboxchrg') != null)
        boxpercen = document.getElementById('txtboxchrg').value;
    if (boxpercen != null && boxpercen != "" && boxpercen != "0") {
        boxcharge = parseInt(boxpercen);
    }
    flagins = "1";
    var grossamtfinal = 0;
    var cardamt = 0;
    var grossamtfinalAgreed = 0;
    var newcode = "";
    schemeid = "";
    var agreedcancelAmt = 0;
    var res = null;
    len = "bookdiv";
    var query = '';
    var rowcount = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
    var editionname = '';
    var pkgcode = '';
    var color = '';
    var cat1 = '';
    var cat2 = '';
    var cat3 = '';
    var cat4 = '';
    var cat5 = '';
    var line = '';
    var insert_date = '';
    var ratecheck_date = '';
    var cardrateSum = 0;
    var k = 0;
    var canclecharge = 0;
    var cntrfill = 0;
    var counter = 0;
    var counterT = 0;
    var cardrate = 0;
    var finsert = 1;
    var tinsert = 0;
    var pkg_insertion = '';
    var ad_width = '';
    var pkg_alias = '';
    var pagepost = '';
    var premiumno = '';
    //  var paidCount=document.getElementById('txtinsertion').value;
    var paidCount = 0;
    var finsertF = 0;
    finsertF = 0;
    if (drppackage_vari.options.length > 0) {
        for (var insertCou = 0; insertCou < drppackage_vari.options.length; insertCou++) {
            if (drppackage_vari.options[insertCou].value.indexOf('(') >= 0) {
                tinsert = drppackage_vari.options[insertCou].value.substring(drppackage_vari.options[insertCou].value.lastIndexOf('(') + 1, drppackage_vari.options[insertCou].value.lastIndexOf(')'));
                if (parseInt(tinsert) > parseInt(finsert)) {
                    finsert = tinsert;
                }
                finsertF = parseInt(finsertF) + parseInt(tinsert);
                // paidCount = parseInt(paidCount) * parseInt(tinsert);
                paidCount = parseInt(paidCount) + (parseInt(tinsert) * parseInt(document.getElementById('txtinsertion').value));
            }
        }
    }
    document.getElementById('txtpaid').value = paidCount;
    // finsert = parseInt(finsertF) * parseInt(document.getElementById('txtinsertion').value);
    if (document.getElementById('configclient').value == "BHASKAR") {
        finsert = parseInt(finsertF) * parseInt(document.getElementById('txtinsertion').value);
    }
    else {
        finsert = parseInt(finsert) * parseInt(document.getElementById('txtinsertion').value);
    }
    var gridItemCount = parseInt(rowcount) / parseInt(finsertF);
    var freeIns = "N";
    var flag_agreed = 0;
    var paid_var = document.getElementById('txtpaid');
    var color_vari = document.getElementById('drpcolor');
    var drpadcat_vari = document.getElementById('txtcategory');
    var drpadsubcat_vari = document.getElementById('drpadsubcategory');
    var drpadcat3_vari = document.getElementById('drpadcat3');
    var drpadcat4_vari = document.getElementById('drpadcat4');
    var drpadcat5_vari = document.getElementById('drpadcat5');
    var totalarea_vari = document.getElementById('txttotalarea');
    var agreedrate_vari = document.getElementById('txtagreedrate');
    var agreedamt_vari = document.getElementById('txtagreedamt');
    var hiddenbox_vari = document.getElementById('hiddenboxchrgtype');
    var pospremdisc = document.getElementById('txtpospremdisc').value;
    if (pospremdisc == "")
        pospremdisc = "0";
    // for consumption period
    var fDate = '';
    var lDate = '';
    var schemecountNumber = 0;
    var splboldspecialsize1 = "";
    if (rowcount > 0) {
        if (document.getElementById('Text0').value == "")
            fDate = date_frmt_orcl(dateformat, gfollodate);
        else
            fDate = date_frmt_orcl(dateformat, document.getElementById('Text0').value);
        if (document.getElementById('lat' + (rowcount - 1)).value == "") {
            var newdate = ad_month(gfollodate);
            document.getElementById('lat' + (rowcount - 1)).value = newdate;
            lDate = date_frmt_orcl(dateformat, newdate);
        }
        else {
            lDate = date_frmt_orcl(dateformat, document.getElementById('lat' + (rowcount - 1)).value);
        }
    }
    var sPaid = 0; //paid_var.value;
    var freeIns_S = "N";
    for (var i = 0; i < parseInt(finsert); i++) {
        //  if(freeIns_S=="Y")
        //  {
        //  sPaid=parseInt(sPaid,10)+1;
        //}
        if (freeIns == "Y") {
            if (schemecountNumber != "" && schemecountNumber != "0")
                paid_var.value = parseInt(paid_var.value) - parseInt(schemecountNumber, 10);
            else
                paid_var.value = parseInt(paid_var.value) - 1;
        }
        freeIns = "N";
        freeIns_S = "N";
        counterT = counter;
        editionname = '';
        splboldspecialsize1 = "";
        pkgcode = '';
        color = '';
        cat1 = '';
        cat2 = '';
        cat3 = '';
        cat4 = '';
        cat5 = '';
        pkg_insertion = '';
        ad_width = '';
        line = '';
        insert_date = '';
        splboldspecialsize1 = '';
        ratecheck_date = '';

        pkg_alias = '';
        ad_width = '';
        pagepost = '';
        premiumno = '';
        var tCount = 0;
        var insval;
        var ins_vari = document.getElementById('ins' + counterT);
        if (ins_vari != null) {
            while (parseInt(ins_vari.innerHTML) == parseInt(i) + 1) {
                tCount = parseInt(tCount) + 1;
                counterT = parseInt(counterT) + 1;
                ins_vari = document.getElementById('ins' + counterT);
                if (ins_vari == null)
                    break;
            }
        }
        gridItemCount = tCount;  //get gridcount
        var pfdate;
        var pldate;
        var pkgcode_p;
        var cancelcount = 0;
        for (var j = 0; j < parseInt(gridItemCount); j++) {
            var par1;
            var edit_vari = document.getElementById('edit' + k);
            par1 = (edit_vari.parentNode).parentNode;
            //var col_vari=document.getElementById('col'+k);
            //alert("bh")
            if (browser != "Microsoft Internet Explorer") {
                var splboldsize = document.getElementById("splboldsize" + k);
                var col_vari = document.getElementById('col' + k);
                var adcat_vari = document.getElementById('adcat' + k);
                var cat2_vari = document.getElementById('ads' + k);
                var cat3_vari = document.getElementById('adscat3' + k);
                var cat4_vari = document.getElementById('adscat4' + k);
                var cat5_vari = document.getElementById('adscat5' + k);
                var preall_vari = document.getElementById('preall' + k);
                //            var adcat_vari=document.getElementById('adcat'+k);
                //            var cat2_vari=document.getElementById('ads'+k);
                //            var cat3_vari=document.getElementById('adscat3'+k);
                //            var cat4_vari=document.getElementById('adscat4'+k);
                //            var cat5_vari=document.getElementById('adscat5'+k);
                var siz_vari;
                siz_vari = document.getElementById('siz' + k);

                var text_vari;
                text_vari = document.getElementById('Text' + k);
                if (text_vari.value == "")
                    var pmdate = gfollodate;
                else
                    var pmdate = text_vari.value;
                if (j != 0) {
                    pfdate = getBigDate(pfdate, pmdate, dateformat, "min");
                    pldate = getBigDate(pldate, pmdate, dateformat, "max");
                }
                if (j == 0) {
                    pfdate = pmdate; //text_vari.value;
                    pldate = pmdate; //text_vari.value;
                }
                //  var pkgins_vari=document.getElementById('pkg_ins'+k);
                var pkgins_vari = document.getElementById('pkg_ins' + k);
                var wid_vari;
                wid_vari = document.getElementById('wid' + k);

                var pkgalias_vari = document.getElementById('pkg_alias' + k);
                var pgpre_vari = document.getElementById('pgpre' + k);
                var prem_vari = document.getElementById('prem' + k);
                var hiddenpck_vari = document.getElementById('hiddenpckcode' + k);
                //alert("bhanu");
            }
            else {
                var splboldsize = par1.all["splboldsize" + k];
                var col_vari = par1.all['col' + k];
                var adcat_vari = par1.all['adcat' + k];
                var cat2_vari = par1.all['ads' + k];
                var cat3_vari = par1.all['adscat3' + k];
                var cat4_vari = par1.all['adscat4' + k];
                var cat5_vari = par1.all['adscat5' + k];
//                     var adcat_vari=document.getElementById('adcat'+k);
//                 var cat2_vari=document.getElementById('ads'+k);
//                     var cat3_vari=document.getElementById('adscat3'+k);
//                      var cat4_vari=document.getElementById('adscat4'+k);
//                      var cat5_vari=document.getElementById('adscat5'+k);
                var siz_vari;
                siz_vari = par1.all['siz' + k];

                var text_vari;
                text_vari = par1.all['Text' + k];
                if (text_vari.value == "")
                    var pmdate = gfollodate;
                else
                    var pmdate = text_vari.value;
                if (j != 0) {
                    pfdate = getBigDate(pfdate, pmdate, dateformat, "min");
                    pldate = getBigDate(pldate, pmdate, dateformat, "max");
                }
                if (j == 0) {
                    pfdate = pmdate; //text_vari.value;
                    pldate = pmdate; //text_vari.value;
                }
                //  var pkgins_vari=document.getElementById('pkg_ins'+k);
                var pkgins_vari = par1.all['pkg_ins' + k];
                var wid_vari;
                wid_vari = par1.all['wid' + k];

                var pkgalias_vari = par1.all['pkg_alias' + k];
                var pgpre_vari = par1.all['pgpre' + k];
                var prem_vari = par1.all['prem' + k];
                var preall_vari = par1.all['preall' + k];
                var hiddenpck_vari = par1.all['hiddenpckcode' + k];
            }

            //            var pkgalias_vari=document.getElementById('pkg_alias'+k);
            //            var pgpre_vari=document.getElementById('pgpre'+k);
            //            var prem_vari=document.getElementById('prem'+k);
            //            var hiddenpck_vari=document.getElementById('hiddenpckcode'+k);
            //  pldate=text_vari.value;
            var t = document.getElementById('allowprem_card_disc_rate').value;
            pkgcode_p = hiddenpck_vari.value;
            if (edit_vari != null) {
                if (editionname == '') {
                    editionname = edit_vari.value;
                }
                else {
                    editionname = editionname + ',' + edit_vari.value;
                }

                if (pkgcode == '') {
                    pkgcode = hiddenpck_vari.value;
                }
                else {
                    pkgcode = pkgcode + ',' + hiddenpck_vari.value;
                }

                if (color == '') {
                    color = "B";
                }
                else {
                      color = color + ',' + "B";
                }

                if (cat1 == '') {
                    if (adcat_vari != null) {
                        if (adcat_vari.value != "")
                            cat1 = adcat_vari.value;
                        else
                            cat1 = "0";
                    }
                    else
                        cat1 = drpadcat_vari.value;
                }
                else {
                    if (adcat_vari != null) {
                        if (adcat_vari.value != "")
                            cat1 = cat1 + ',' + adcat_vari.value;
                        else
                            cat1 = cat1 + ',' + "0";
                    }
                    else
                        cat1 = cat1 + ',' + drpadcat_vari.value;
                }

                if (cat2 == '') {
                    if (cat2_vari != null) {
                        if (cat2_vari.value != '') {
                            cat2 = cat2_vari.value;
                        }
                        else {
                            cat2 = "0";
                        }
                    }
                    else {
                        if (drpadsubcat_vari.value == "") {
                            cat2 = "0";
                        }
                        else {
                            cat2 = drpadsubcat_vari.value;
                        }
                    }
                }
                else {
                    if (cat2_vari != null) {
                        if (cat2_vari.value != '') {
                            cat2 = cat2 + ',' + cat2_vari.value;
                        }
                        else {
                            cat2 = cat2 + ',' + "0";
                        }

                    }
                    else {
                        if (drpadsubcat_vari.value == "") {
                            cat2 = cat2 + ',' + "0";
                        }
                        else {
                            cat2 = cat2 + ',' + drpadsubcat_vari.value;
                        }
                    }
                }

//                if (cat3 == '') {
//                    if (cat3_vari != null) {
//                        if (cat3_vari.value == '') {
//                            cat3 = "0";
//                        }
//                        else {
//                            cat3 = cat3_vari.value;
//                        }
//                    }
//                    else {
//                        if (drpadcat3_vari.value == "") {
//                            cat3 = "0";
//                        }
//                        else {
//                            cat3 = drpadcat3_vari.value;
//                        }
//                    }
//                }
//                else {
//                    if (cat3_vari != null) {
//                        if (cat3_vari.value == '') {
//                            cat3 = cat3 + ',' + "0";
//                        }
//                        else {
//                            cat3 = cat3 + ',' + cat3_vari.value;
//                        }
//                    }

//                    else {
//                        if (drpadcat3_vari.value == "") {
//                            cat3 = cat3 + ',' + "0";
//                        }
//                        else {
//                            cat3 = cat3 + ',' + drpadcat3_vari.value;
//                        }
//                    }
//                }

//                if (cat4 == '') {
//                    if (cat4_vari != null) {
//                        if (cat4_vari.value == "") {
//                            cat4 = "0";
//                        }
//                        else {
//                            cat4 = cat4_vari.value;
//                        }
//                    }

//                    else {
//                        if (drpadcat4_vari.value == "") {
//                            cat4 = "0";
//                        }
//                        else {
//                            cat4 = drpadcat4_vari.value;
//                        }
//                    }
//                }
//                else {
//                    if (cat4_vari != null) {
//                        if (cat4_vari.value == "") {
//                            cat4 = cat4 + ',' + "0";
//                        }
//                        else {
//                            cat4 = cat4 + ',' + cat4_vari.value;
//                        }

//                    }
//                    else {
//                        if (drpadcat4_vari.value == "") {
//                            cat4 = cat4 + ',' + "0";
//                        }
//                        else {
//                            cat4 = cat4 + ',' + drpadcat4_vari.value;
//                        }
//                    }
//                }

//                if (cat5 == '') {
//                    if (cat5_vari != null) {
//                        if (cat5_vari.value == "") {
//                            cat5 = "0";
//                        }
//                        else {
//                            cat5 = cat5_vari.value;
//                        }
//                    }

//                    else {
//                        if (drpadcat5_vari.value == "") {
//                            cat5 = "0";
//                        }
//                        else {
//                            cat5 = drpadcat5_vari.value;
//                        }
//                    }
//                }
//                else {
//                    if (cat5_vari != null) {
//                        if (cat5_vari.value == "") {
//                            cat5 = cat5 + ',' + "0";
//                        }
//                        else {
//                            cat5 = cat5 + ',' + cat5_vari.value;
//                        }
//                    }

//                    else {
//                        if (drpadcat5_vari.value == "") {
//                            cat5 = cat5 + ',' + "0";
//                        }
//                        else {
//                            cat5 = cat5 + ',' + drpadcat5_vari.value;
//                        }
//                    }
//                }
                var mline;
                if (siz_vari != null)
                    mline = siz_vari.value;
                else
                    mline = totalarea_vari.value;
                if (uomdesc != "CD" && spacedisc_vari != '') {
                    mline = parseInt(mline, 10) - parseInt(spacedisc_vari, 10);
                }
                if (line == '') {
                    line = mline;
                }
                else {
                    line = line + ',' + mline;
                }

                //                if(line=='')
                //                {
                //                    if(siz_vari!=null)
                //                        line=siz_vari.value;
                //                    else
                //                        line=totalarea_vari.value;
                //                }
                //                else
                //                {
                //                    if(siz_vari!=null)
                //                        line=line + ',' + siz_vari.value;
                //                    else
                //                        line=line + ',' + totalarea_vari.value;
                //                }
                //===============Change for folloup dates============//
                var ratedate = "";
                if (text_vari.value == "" && document.getElementById('hdnfollodate').value == "Y")
                    ratedate = gfollodate;
                else
                    ratedate = text_vari.value;
                //***************//
                if (insert_date == '') {
                    insert_date = date_frmt_orcl(dateformat, ratedate); //text_vari.value);

                }
                else {
                    var datestr = date_frmt_orcl(dateformat, ratedate); //text_vari.value);
                    insert_date = insert_date + ',' + datestr;
                }
                //====Changes for Rate Revise===//
                if (document.getElementById('hdnrevise').value != "" && document.getElementById('txtrevisedate').value != "") {
                    if (ratecheck_date == '') {
                        ratecheck_date = date_frmt_orcl(dateformat, document.getElementById('txtrevisedate').value);
                    }
                    else {
                        var datestr = date_frmt_orcl(dateformat, document.getElementById('txtrevisedate').value);
                        ratecheck_date = ratecheck_date + ',' + datestr;

                    }
                }
                else {
                    if (hiddenratecheckdate_vari == 'i') {
                        if (ratecheck_date == '') {
                            ratecheck_date = date_frmt_orcl(dateformat, ratedate);
                        }
                        else {
                            var datestr = date_frmt_orcl(dateformat, ratedate);
                            ratecheck_date = ratecheck_date + ',' + datestr;

                        }
                    }
                    else {
                        if (ratecheck_date == '') {
                            ratecheck_date = date_frmt_orcl(dateformat, datetime_vari);
                            // ratecheck_date=mySqlDate(document.getElementById('txtdatetime').value);
                        }
                        else {
                            //var datestr=mySqlDate(document.getElementById('txtdatetime').value);
                            var datestr = date_frmt_orcl(dateformat, datetime_vari);
                            ratecheck_date = ratecheck_date + ',' + datestr;

                        }
                    }
                }
                if (pkg_insertion == '') {
                    if (pkgins_vari.value == "") {
                        pkg_insertion = "1";
                    }
                    else {
                        pkg_insertion = pkgins_vari.value;
                    }
                }
                else {
                    if (pkgins_vari.value == "") {
                        pkg_insertion = pkg_insertion + ',' + "0";
                    }
                    else {
                        pkg_insertion = pkg_insertion + ',' + pkgins_vari.value;
                    }
                }
//                if (ad_width == '') {
//                    if (wid_vari.value == '') {
//                        ad_width = '0';
//                    }
//                    else {
//                        ad_width = wid_vari.value;
//                    }
//                }
//                else {
//                    if (wid_vari.value == '') {
//                        ad_width = ad_width + ',' + '0';
//                    }
//                    else {
//                        ad_width = ad_width + ',' + wid_vari.value;
//                    }
//                }
                if (pkg_alias == '') {
                    pkg_alias = pkgalias_vari.value;
                }
                else {
                    pkg_alias = pkg_alias + ',' + pkgalias_vari.value;
                }

                if (pagepost == '') {
                    if (preall_vari != null && preall_vari.value == "2") {
                        pagepost = '0';
                    }
                    else {
                        if (pgpre_vari != null && pgpre_vari.value != '') {
                            pagepost = pgpre_vari.value;

                        }
                        else {
                            pagepost = '0';
                        }
                    }
                }
                else {
                    if (preall_vari != null && preall_vari.value == "2") {
                        pagepost = pagepost + ',' + '0';
                    }
                    else {
                        if (pgpre_vari != null && pgpre_vari.value != '') {
                            pagepost = pagepost + ',' + pgpre_vari.value;
                        }
                        else {
                            pagepost = pagepost + ',' + '0';
                        }
                    }
                }
                //for premium if any
                if (premiumno == '') {
                    if (prem_vari != null && prem_vari.value != '') {
                        premiumno = prem_vari.value;
                    }
                    else if (document.getElementById('drppageprem') != null && document.getElementById('drppageprem').value != "0" && document.getElementById('drppageprem').value != "") {
                        premiumno = document.getElementById('drppageprem').value;
                    }
                    else {
                        premiumno = '0';
                    }
                }
                else {
                    if (prem_vari != null && prem_vari.value != '') {
                        premiumno = premiumno + ',' + prem_vari.value;
                    }
                    else if (document.getElementById('drppageprem') != null && document.getElementById('drppageprem').value != "0" && document.getElementById('drppageprem').value != "") {
                    premiumno = premiumno + ',' + document.getElementById('drppageprem').value;
                    }
                    else {
                        premiumno = premiumno + ',' + '0';
                    }
                }
                // for bold character
                if (splboldspecialsize1 == '') {
                    if (splboldsize != null) {
                        if (splboldsize.value != "")
                            splboldspecialsize1 = splboldsize.value;
                        else
                            splboldspecialsize1 = "0";
                    }
                    else
                        splboldspecialsize1 = "0";
                }
                else {
                    if (splboldsize != null) {
                        if (splboldsize.value != "")
                            splboldspecialsize1 = splboldspecialsize1 + ',' + splboldsize.value;
                        else
                            splboldspecialsize1 = splboldspecialsize1 + ',' + "0";
                    }
                    else
                        splboldspecialsize1 = splboldspecialsize1 + ',' + "0";
                }
            }
            if (document.getElementById("inssta" + k).value == 'cancel')
                cancelcount = cancelcount + 1;
            k++;
        } // end of first loop
        var resT = web_booking.getPackageConsumption(pkgcode_p, pfdate, pldate, dateformat);
        if (resT.value == null) {
            alert(resT.error.description);
            return false;
        }
        if (resT.value.Tables[0].Rows.length > 0) {
            if (resT.value.Tables[0].Rows[0].MSG != 'A') {
                alert(resT.value.Tables[0].Rows[0].MSG);
                return false;
            }
        }
        newcode = editionname + "$" + pkgcode + "$" + color + "$" + cat1 + "$" + cat2 + "$" + "0" + "$" + "0" + "$" + "0" + "$" + line + "$" + insert_date + "$" + ratecheck_date + "$" + pkg_insertion + "$" + line + "$" + pkg_alias + "$" + pagepost + "$" + premiumno + "$" + splboldspecialsize1;
        //alert(newcode);
        cardamt = 0;
        res = web_booking.get_rate(noofinsertion, dateformat, compcode, uom, adtype, currency, ratecode, clientcode, uomdesc, agencycode, newcode, center, ratepremtype, '0', schemetype_vari, fDate, lDate, parseInt(i) + 1, chkadon_var, discprem, spediscper, pospremdisc);
        cntrfill = 0;

        var ds = res.value;
        if (ds == null) {
            alert(res.error.description);
            return false;
        }
        if (ds.Tables[3].Rows.length > 0) {
            if (ds.Tables[3].Rows[0].FLOORAMT != null)
                flooramount = ds.Tables[3].Rows[0].FLOORAMT;
        }
        if (ds.Tables[1].Rows.length > 0) {
            if (ds.Tables[1].Rows[0].CANCELLATION_CHARGES != null)
                canclecharge = ds.Tables[1].Rows[0].CANCELLATION_CHARGES;
        }
        var scpkg = "";
        schemecountNumber = 0;
        if (cancelcount == gridItemCount)
            freeIns = "Y";
        for (var t1 = 0; t1 < ds.Tables[2].Rows.length; t1++) {

            if (ds.Tables[2].Rows[t1].PKG_CODE != scpkg && freeIns != "Y") {
                scpkg = ds.Tables[2].Rows[t1].PKG_CODE;
                schemecountNumber = parseInt(schemecountNumber, 10) + 1;
            }
        }
        var schemeCount = 0;

        var chkscheme_Type = 0;
        var gridItemTotal = 0;
        for (; cntrfill < parseInt(gridItemCount); cntrfill++) {
            var pkgcode = document.getElementById("hiddenpckcode" + counter);
            if (pkgcode == null)
                break;

            var msg = "";
            if (ds.Tables[0].Rows.length > 0) {
                msg = ds.Tables[0].Rows[0].MESSAGE;
            }
            if (msg.indexOf('Consumption') >= 0)
                alert(msg);
            if (ds.Tables[0].Rows.length <= 0 || (ds.Tables[0].Rows.length > 0 && msg.indexOf('Consumption') >= 0)) {
                var par1;
                var cardid = document.getElementById("cardrate" + counter);
                par1 = (cardid.parentNode).parentNode;
                if (browser != "Microsoft Internet Explorer") {
                    solo = document.getElementById("sol" + counter);
                    gross = document.getElementById("gro" + counter);
                    var billrate = document.getElementById("ba" + counter);
                    var paidno = document.getElementById("pai" + counter);
                    var agrred = document.getElementById("agr" + counter);
                    var insertsta = document.getElementById("inssta" + counter); //"inssta"+counter;    
                    var eyecatchRate = 0;
                    var pkgalias = document.getElementById("pkg_alias" + counter);
                    var editioncomp = document.getElementById("edit" + counter);
                    var boxc = document.getElementById("boxc" + counter);
                    var vat_inc = document.getElementById("vat_inc" + counter);
                }
                else {
                    solo = par1.all["sol" + counter];
                    gross = par1.all["gro" + counter];
                    var paidno = par1.all["pai" + counter];
                    var billrate = par1.all["ba" + counter];
                    var agrred = par1.all["agr" + counter];
                    var insertsta = par1.all["inssta" + counter]; //"inssta"+counter;    
                    var eyecatchRate = 0;
                    var pkgalias = par1.all["pkg_alias" + counter];
                    var editioncomp = par1.all["edit" + counter];
                    var boxc = par1.all["boxc" + counter];
                    var vat_inc = par1.all["vat_inc" + counter];
                }
                // NEW CHANGE 19 NOV 09
                schemeCount = 0;
                bill_comp_amt = "";
                if (insertsta.value == "billed")
                    bill_comp_amt = cardid.value;
                if (insertsta.value != "billed") {
                   // vat_inc.value = ds.Tables[1].Rows[cntrfill].VAT_INC;
                    agrred.value = "";
                }
                if (ds.Tables[2].Rows.length > 0 && agreedamt_vari.value != '' && agreedamt_vari.value != '0') {
                    for (var t = 0; t < ds.Tables[2].Rows.length; t++) {
                        if (ds.Tables[2].Rows[t].PKG_CODE == ds.Tables[1].Rows[cntrfill].PCODE) {
                            schemeCount = parseInt(schemeCount) + parseInt(ds.Tables[2].Rows[t].TO_INS) - parseInt(ds.Tables[2].Rows[t].FROM_INSERT) + 1;
                            scheme_var = ds.Tables[2].Rows[t].SCHEMENAME;
                            schemeid = ds.Tables[2].Rows[t].SCHEMEID;
                        }
                    }
                }
                if (pkgcode.value == ds.Tables[1].Rows[cntrfill].PCODE && LTrim(RTrim(pkgalias.value)) == LTrim(RTrim(ds.Tables[1].Rows[cntrfill].PKG_ALIAS))) {
                    var scheme = "";
                    var edicount = cntrfill;
                    //  if((agreedrate_vari.value== '' || agreedrate_vari.value== '0') && (agreedamt_vari.value=='' || agreedamt_vari.value=='0') && chkscheme_Type==0)
                    // {        //----3-----------
                    chkscheme_Type = 1;

                    for (var scicount = 0; scicount < ds.Tables[2].Rows.length; scicount++) {       //----4-----------
                        var edipac = '';
                        if (ds.Tables[2].Rows[scicount].VAL == 'P')
                            edipac = pkgcode.value;
                        else
                            edipac = editioncomp.value;
                        if (edipac == ds.Tables[2].Rows[scicount].PKG_CODE && (parseInt(i) + 1 >= ds.Tables[2].Rows[scicount].FROM_INSERT && parseInt(i) + 1 <= ds.Tables[2].Rows[scicount].TO_INS) && paidno.value != "P") {           //----5-----------
                            chkscheme_Type = 0;
                            if (uomdesc == 'CD') {
                                cardid.value = ds.Tables[1].Rows[edicount].EXTRARATE;
                                solo.value = ds.Tables[1].Rows[edicount].SOLORATE;
                            }
                            else {
                                cardid.value = ds.Tables[1].Rows[edicount].CARDRATE;
                                solo.value = ds.Tables[1].Rows[edicount].SOLORATE;
                            }
                            if (insertsta.value != "billed")
                                agrred.value = "";
                            var gridgross = "";
                            if (insertsta.value != "billed")
                                gross.value = ds.Tables[1].Rows[edicount].FCARDRATE;
                            gridgross = gross.value;
                            // cardamt=parseFloat(cardamt) + parseFloat(ds.Tables[1].Rows[edicount].FCARDRATE);
                            cardamt = parseFloat(cardamt) + parseFloat(ds.Tables[1].Rows[edicount].FEXTRARATE) + parseFloat(ds.Tables[1].Rows[edicount].CARDRATE);
                            if ((cardid.value == "0" || cardid.value == "") && cardamt != "" && uomdesc == 'CD') {
                                cardid.value = parseFloat(cardamt) / parseFloat(totalarea_vari.value);
                                cardid.value = parseFloat(cardid.value).toFixed(2);
                            }


                            // for insertion wise box charges
                            //                                        if(boxchargeInsertionwise=='yes')
                            //                                        {
                            //                                            if(hiddenbox_vari.value=='2')
                            //                                            {
                            //                                                boxcharge=(parseFloat(gridgross) * parseFloat(boxcharge))/100;
                            //                                            }
                            //                                            grossamtfinal=parseFloat(grossamtfinal) + parseFloat(boxcharge);
                            //                                            if(insertsta.value!="billed")
                            //                                            {
                            //                                                gross.value = parseFloat(gross.value) + parseFloat(boxcharge);
                            //                                                boxc.value=boxcharge;
                            //                                             }   
                            //                                        }
                            gridgross = gross.value;
                            if (ds.Tables[2].Rows[scicount].TYPE == "per") {
                                if (hidschememin_vari == "Y" && ds.Tables[1].Rows[edicount].MINWORD != null && parseInt(document.getElementById('siz' + counter).value) > parseInt(ds.Tables[1].Rows[edicount].MINWORD)) {
                                    var exrate = ds.Tables[1].Rows[edicount].FEXTRARATE;
                                    gridgross = parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) - (parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) * parseFloat(ds.Tables[2].Rows[scicount].AMT) / 100);
                                    gridgross = parseFloat(gridgross) + parseFloat(exrate);
                                }
                                else {
                                    gridgross = parseFloat(gridgross) - (parseFloat(gridgross) * parseFloat(ds.Tables[2].Rows[scicount].AMT) / 100);
                                }
                                if (parseInt(gridgross) == 0) {
                                    freeIns = "Y";
                                    freeIns_S = "Y";
                                }
                                grossamtfinal = parseFloat(grossamtfinal) + parseFloat(gridgross); //+gridgross;
                                //agreed rate
                                if (insertsta.value != "billed")
                                    gross.value = gridgross.toFixed(4);
                            }
                            else {
                                var schratio = 0;
                                if (gridItemTotal == 0) {
                                    for (var f = 0; f < ds.Tables[1].Rows.length; f++) {
                                        gridItemTotal = gridItemTotal + ds.Tables[1].Rows[f].FCARDRATE;
                                    }

                                }
                                schratio = (parseFloat(ds.Tables[2].Rows[scicount].AMT) / parseFloat(gridItemTotal)) * parseFloat(ds.Tables[1].Rows[edicount].FCARDRATE);
                                // grossamtfinal = parseFloat(grossamtfinal) + (parseFloat(gridgross) - (parseFloat(ds.Tables[2].Rows[scicount].AMT) / parseInt(gridItemCount)));
                                grossamtfinal = parseFloat(grossamtfinal) + (parseFloat(gridgross) - (parseFloat(schratio)));
                                if (insertsta.value != "billed") {

                                    if (t == "D") {
                                        if (ds.Tables[1].Rows[edicount].PREM1 == null)
                                            ds.Tables[1].Rows[edicount].PREM1 = "0";
                                        if (ds.Tables[1].Rows[edicount].PREM2 == null)
                                            ds.Tables[1].Rows[edicount].PREM2 = "0";
                                        if (hidschememin_vari == "Y" && ds.Tables[1].Rows[edicount].MINWORD != null && parseInt(document.getElementById('siz' + counter).value) > parseInt(ds.Tables[1].Rows[edicount].MINWORD)) {
                                            var exrate = ds.Tables[1].Rows[edicount].FEXTRARATE;
                                            //  gross.value = parseFloat(gridgross) - (parseFloat(ds.Tables[2].Rows[scicount].AMT) / parseInt(gridItemCount));
                                            // gridgross=parseFloat(gridgross) + parseFloat(exrate);
                                            //
                                            gridgross = parseFloat(gridgross) + parseFloat(exrate);
                                            var newrate = parseFloat(gridgross) - (parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) * parseFloat(ds.Tables[1].Rows[edicount].PREM1) / 100);
                                            newrate = parseFloat(newrate) - (parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                            gross.value = parseFloat(newrate) - (parseFloat(schratio));
                                            gross.value = parseFloat(gross.value) + (parseFloat(gross.value) * parseFloat(ds.Tables[1].Rows[edicount].PREM1) / 100) + (parseFloat(gross.value) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);

                                        }
                                        else {
                                            // gross.value = parseFloat(gridgross) - (parseFloat(ds.Tables[2].Rows[scicount].AMT) / parseInt(gridItemCount));
                                            var tr = parseFloat(ds.Tables[1].Rows[edicount].CARDRATE);
                                            if (ds.Tables[1].Rows[edicount].FEXTRARATE != null && ds.Tables[1].Rows[edicount].FEXTRARATE != "null") {
                                                tr = parseFloat(tr) + parseFloat(ds.Tables[1].Rows[edicount].FEXTRARATE);
                                            }
                                            var newrate = parseFloat(gridgross) - (parseFloat(tr) * parseFloat(ds.Tables[1].Rows[edicount].PREM1) / 100);
                                            newrate = parseFloat(newrate) - (parseFloat(tr) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                            gross.value = parseFloat(newrate) - (parseFloat(schratio));
                                            gross.value = parseFloat(gross.value) + (parseFloat(gross.value) * parseFloat(ds.Tables[1].Rows[edicount].PREM1) / 100) + (parseFloat(gross.value) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                        }
                                    }
                                    else {
                                        if (hidschememin_vari == "Y" && ds.Tables[1].Rows[edicount].MINWORD != null && parseInt(document.getElementById('siz' + counter).value) > parseInt(ds.Tables[1].Rows[edicount].MINWORD)) {
                                            var exrate = ds.Tables[1].Rows[edicount].FEXTRARATE;
                                            gross.value = parseFloat(gridgross) - (parseFloat(schratio));
                                            gridgross = parseFloat(gridgross) + parseFloat(exrate);
                                        }
                                        else {
                                            gross.value = parseFloat(gridgross) - (parseFloat(schratio));
                                        }
                                    }
                                }
                            }
                            if (bullet_var != null && bullet_var.value != '0') {
                                if (eyecatchtype != 'S') {
                                    if (eyecatchtype == 'P') {
                                        if (bPrem.indexOf('%') > 0)
                                            bPrem = bPrem.split('%')[0];
                                        eyecatchRate = (parseFloat(gridgross) * parseFloat(bPrem)) / 100;
                                        if (t == "D") {
                                            if (ds.Tables[1].Rows[edicount].PREM1 == null)
                                                ds.Tables[1].Rows[edicount].PREM1 = "0";
                                            if (ds.Tables[1].Rows[edicount].PREM2 == null)
                                                ds.Tables[1].Rows[edicount].PREM2 = "0";
                                            var x = (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM1)) / 100;
                                            x = parseFloat(x) + (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                            eyecatchRate = parseFloat(eyecatchRate) + parseFloat(x);

                                        }
                                        grossamtfinal = parseFloat(grossamtfinal) + parseFloat(eyecatchRate);
                                        if (insertsta.value != "billed")
                                            gross.value = parseFloat(gross.value) + parseFloat(eyecatchRate);
                                    }
                                    else if (eyecatchtype == 'F') {
                                        if (bPrem.indexOf('%') > 0)
                                            bPrem = bPrem.split('%')[0];
                                        eyecatchRate = parseFloat(bPrem); //parseFloat(grossamtfinal) + parseFloat(bPrem);
                                        if (t == "D") {
                                            if (ds.Tables[1].Rows[edicount].PREM1 == null)
                                                ds.Tables[1].Rows[edicount].PREM1 = "0";
                                            if (ds.Tables[1].Rows[edicount].PREM2 == null)
                                                ds.Tables[1].Rows[edicount].PREM2 = "0";
                                            var x = (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM1)) / 100;
                                            x = parseFloat(x) + (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM2)) / 100;
                                            eyecatchRate = parseFloat(eyecatchRate) + parseFloat(x);

                                        }
                                        grossamtfinal = parseFloat(grossamtfinal) + (parseFloat(eyecatchRate) / parseInt(gridItemCount));
                                        if (insertsta.value != "billed")
                                            gross.value = parseFloat(gross.value) + (parseFloat(eyecatchRate) / parseInt(gridItemCount));
                                    }
                                }
                            }
                            scheme_var_id.value = ds.Tables[2].Rows[scicount].SCHEMENAME;
                            schemeid = ds.Tables[2].Rows[scicount].SCHEMEID;
                            if (paidno != null && ds.Tables[2].Rows[scicount].TYPE == "per" && ds.Tables[2].Rows[scicount].AMT == "100") {
                                if (paidno.value != "P")
                                    paidno.value = 'N';
                            }
                            else if (paidno != null) {
                                paidno.value = 'Y';
                            }
                            scheme = 'Y';
                            edicount = gridItemCount;
                            if (i == 0) {
                                if (uomdesc == 'CD') {
                                    //  cardrate=parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].EXTRARATE);
                                    if (ds.Tables[1].Rows[cntrfill].EXTRARATE != "0" && ds.Tables[1].Rows[cntrfill].EXTRARATE != "")
                                        cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].EXTRARATE);
                                    else
                                        cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].CARDRATE) / parseFloat(totalarea_vari.value);
                                }
                                else {
                                    cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].CARDRATE);
                                }
                            }
                            break;
                        }  //----5-----------

                    }    //----4-----------   
                    // }     //----3-----------  
                    if (scheme == '') {
                        if (uomdesc == 'CD') {
                           // cardid.value = ds.Tables[1].Rows[cntrfill].EXTRARATE;
                            solo.value = ds.Tables[1].Rows[cntrfill].SOLORATE;
                        }
                        else {
                            //cardid.value = ds.Tables[1].Rows[cntrfill].CARDRATE;
                            solo.value = ds.Tables[1].Rows[cntrfill].SOLORATE;
                        }
                        var gridgross = 0;
                        if (insertsta.value != "billed")
                            gross.value = ds.Tables[1].Rows[edicount].FCARDRATE;
                        gridgross = gross.value;
                        // cardamt=parseFloat(cardamt) + parseFloat(ds.Tables[1].Rows[cntrfill].FCARDRATE);
                        cardamt = parseFloat(cardamt) + parseFloat(ds.Tables[1].Rows[cntrfill].FEXTRARATE) + parseFloat(ds.Tables[1].Rows[cntrfill].CARDRATE);
//                        if ((cardid.value == "0" || cardid.value == "") && cardamt != "" && uomdesc == 'CD') {
//                            cardid.value = parseFloat(cardamt) / parseFloat(totalarea_vari.value);
//                            cardid.value = parseFloat(cardid.value).toFixed(2);
//                        }
                        if ((agreedrate_vari.value != '' && agreedrate_vari.value != '0') && (agreedamt_vari.value != '' && agreedamt_vari.value != '0')) {
                            if (agreedrate_active == 0 && agreedamt_active == 0) {
                                agreedamt_active = 1;
                                flag_agreed = 2;
                            }
                        }
                        if (agreedrate_active == 1 || agreedamt_active == 1) {
                            var rowcountNum = rowcount;
                            if (schemeCount > 0) {
                                rowcountNum = parseInt(rowcount) - (parseInt(schemeCount) * parseInt(gridItemCount));
                                if (flag_agreed != 2)
                                    flag_agreed = 1;
                            }
                            //////                                    if(flag_agreed==1) 
                            //////                                    {
                            //////                                        var num=(parseFloat(parseFloat(agreedamt_vari.value) / parseInt(finsert))).toFixed(2);
                            //////                                        agreedamt_vari.value=parseFloat(agreedamt_vari.value) - (parseFloat(num) * parseFloat(schemeCount));
                            //////                                        flag_agreed=2;
                            //////                                    }
                            if (insertsta.value != "billed")
                                agrred.value = (parseFloat(parseFloat(agreedamt_vari.value) / parseInt(rowcountNum))).toFixed(2);
                            /*   if(counter==parseInt(rowcount) - 1)
                            {
                            if(insertsta.value!="billed")
                            agrred.value = (parseFloat(agreedamt_vari.value) - parseFloat(grossamtfinalAgreed)).toFixed(2) ;
                            }*/
                            // for applying scheme in Agreed Amount
                            // 25 june 2010
                            //////                                   if(schemeCount>0)
                            //////                                   {
                            //////                                        // if(pkgcode.value==ds.Tables[2].Rows[0].PKG_CODE && (parseInt(i)+1>=ds.Tables[2].Rows[0].FROM_INSERT && parseInt(i)+1<=ds.Tables[2].Rows[0].TO_INS))
                            //////                                        var diffcount=parseInt(finsert) - parseInt(schemeCount);
                            //////                                      //   if(pkgcode.value==ds.Tables[2].Rows[0].PKG_CODE && (parseInt(i)+1>parseInt(diffcount)))
                            //////                                        if((parseInt(i)+1>parseInt(diffcount)))
                            //////                                        { 
                            //////                                                 freeIns="Y";
                            //////                                                 gross.value =0;
                            //////                                                 paidno.value='N';
                            //////                                                 //  scheme_var.value=ds.Tables[2].Rows[0].SCHEMENAME;
                            //////                                        }   
                            //////                                        else
                            //////                                        {
                            //////                                             gross.value = (parseFloat(agrred.value)).toFixed(2);
                            //////                                        }     
                            //////                                   }
                            //////                                   else
                            //////                                   {
                            //////                                    gross.value = (parseFloat(agrred.value)).toFixed(2);
                            //////                                   } 
                            if (insertsta.value == 'cancel' || paidno.value == "N") {
                                agreedcancelAmt = parseFloat(agreedcancelAmt) + parseFloat(agrred.value);
                                // freeIns="Y";
                                if (insertsta.value != "billed")
                                    gross.value = 0;
                                paidno.value = 'N';
                                grossamtfinalAgreed = parseFloat(grossamtfinalAgreed) + parseFloat(agrred.value);
                            }


                            if (insertsta.value != "billed")
                                gross.value = parseFloat(gross.value).toFixed(4);
                            gridgross = gross.value;

                            //////  END

                            edicount = gridItemCount;  //by nand on 2 oct
                            if (i == 0) {
                                if (uomdesc == 'CD') {
                                    //  cardrate=parseFloat(cardrate) + ds.Tables[1].Rows[cntrfill].EXTRARATE;
                                    if (ds.Tables[1].Rows[cntrfill].EXTRARATE != "0" && ds.Tables[1].Rows[cntrfill].EXTRARATE != "")
                                        cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].EXTRARATE);
                                    else
                                        cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].CARDRATE) / parseFloat(totalarea_vari.value);
                                }
                                else {
                                    cardrate = parseFloat(cardrate) + ds.Tables[1].Rows[cntrfill].CARDRATE;
                                }
                            }
                            var grossValue = parseFloat(gross.value);
                            grossamtfinal = parseFloat(grossamtfinal) + parseFloat(gridgross);
                            grossamtfinalAgreed = parseFloat(grossamtfinalAgreed) + parseFloat(gridgross);
                            // for box charges in agreed amount
                            if (paidno.value == "N" || insertsta.value == 'cancel')
                                boxcharge = "0";
                            //                                      if(boxchargeInsertionwise=='yes' && paidno.value!='N')
                            //                                    {
                            //                                        var tboxcharge=0;
                            //                                           tboxcharge=boxcharge;
                            //                                        if(hiddenbox_vari.value=='2')
                            //                                        {
                            //                                             tboxcharge=(parseFloat(gridgross) * parseFloat(boxcharge))/100;
                            //                                        }  
                            //                                         tboxcharge=parseFloat(tboxcharge) / parseFloat(gridItemCount);
                            //                                          boxc.value=tboxcharge;
                            //                                        grossamtfinal=parseFloat(grossamtfinal) + parseFloat(tboxcharge);
                            //                                        if(insertsta.value!="billed")
                            //                                        gross.value = parseFloat(gross.value) + parseFloat(tboxcharge);
                            //                                    }
                            //                                    else{
                            //                                    boxc.value="";
                            //                                    }
                        }
                        else {
                            if (insertsta.value != "billed")
                                gross.value = ds.Tables[1].Rows[cntrfill].FCARDRATE;
                            gridgross = gross.value;
                            grossamtfinal = parseFloat(grossamtfinal) + parseFloat(gridgross);
                            if (bullet_var != null && bullet_var.value != '0') {
                                if (eyecatchtype != 'S') {
                                    if (eyecatchtype == 'P') {
                                        if (bPrem.indexOf('%') > 0)
                                            bPrem = bPrem.split('%')[0];
                                        eyecatchRate = (parseFloat(gridgross) * parseFloat(bPrem)) / 100;
                                        if (t == "D") {
                                            if (ds.Tables[1].Rows[edicount].PREM1 == null)
                                                ds.Tables[1].Rows[edicount].PREM1 = "0";
                                            if (ds.Tables[1].Rows[edicount].PREM2 == null)
                                                ds.Tables[1].Rows[edicount].PREM2 = "0";
                                            var x = (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM1)) / 100;
                                            x = parseFloat(x) + (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                            eyecatchRate = parseFloat(eyecatchRate) + parseFloat(x);

                                        }
                                        grossamtfinal = parseFloat(grossamtfinal) + parseFloat(eyecatchRate);
                                        if (insertsta.value != "billed")
                                            gross.value = parseFloat(gross.value) + parseFloat(eyecatchRate);
                                    }
                                    else if (eyecatchtype == 'F') {
                                        if (bPrem.indexOf('%') > 0)
                                            bPrem = bPrem.split('%')[0];
                                        eyecatchRate = parseFloat(bPrem); //parseFloat(grossamtfinal) + parseFloat(bPrem);
                                        if (t == "D") {
                                            if (ds.Tables[1].Rows[edicount].PREM1 == null)
                                                ds.Tables[1].Rows[edicount].PREM1 = "0";
                                            if (ds.Tables[1].Rows[edicount].PREM2 == null)
                                                ds.Tables[1].Rows[edicount].PREM2 = "0";
                                            var x = (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM1)) / 100;
                                            x = parseFloat(x) + (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM2)) / 100;
                                            eyecatchRate = parseFloat(eyecatchRate) + parseFloat(x);

                                        }
                                        grossamtfinal = parseFloat(grossamtfinal) + (parseFloat(eyecatchRate) / parseInt(gridItemCount));
                                        if (insertsta.value != "billed")
                                            gross.value = parseFloat(gross.value) + (parseFloat(eyecatchRate) / parseInt(gridItemCount));
                                    }
                                }
                            }
                            // for insertion wise Box Charges 
                            //                                    if(boxchargeInsertionwise=='yes')
                            //                                    {
                            //                                        var tboxcharge=0;
                            //                                           tboxcharge=boxcharge;
                            //                                        if(hiddenbox_vari.value=='2')
                            //                                        {
                            //                                             tboxcharge=(parseFloat(gridgross) * parseFloat(boxcharge))/100;
                            //                                        }  
                            //                                         tboxcharge=parseFloat(tboxcharge) / parseFloat(gridItemCount);
                            //                                          boxc.value=tboxcharge;
                            //                                        grossamtfinal=parseFloat(grossamtfinal) + parseFloat(tboxcharge);
                            //                                        if(insertsta.value!="billed")
                            //                                        gross.value = parseFloat(gross.value) + parseFloat(tboxcharge);
                            //                                    }

                            edicount = gridItemCount;
                            if (insertsta.value != "billed")
                                agrred.value = "";
                            if (i == 0) {
                                if (uomdesc == 'CD') {
                                    // cardrate=parseFloat(cardrate) + ds.Tables[1].Rows[cntrfill].EXTRARATE;
                                    if (ds.Tables[1].Rows[cntrfill].EXTRARATE != "0" && ds.Tables[1].Rows[cntrfill].EXTRARATE != "")
                                        cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].EXTRARATE);
                                    else
                                        cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].CARDRATE) / parseFloat(totalarea_vari.value);
                                }
                                else {
                                    cardrate = parseFloat(cardrate) + ds.Tables[1].Rows[cntrfill].CARDRATE;
                                }
                            }
                            var grossValue = parseFloat(gross.value);
                            if (insertsta.value != "billed")
                                gross.value = grossValue.toFixed(4);
                            // break;
                        }
                    }
                    if (insertsta.value == 'cancel' || paidno.value == "N") {
                        if (insertsta.value != "billed") {
                            if (hidschememin_vari != "Y" || insertsta.value == 'cancel') {
                                if (ds.Tables[1].Rows[cntrfill].CANCELLATION_CHARGES != null && ds.Tables[1].Rows[cntrfill].CANCELLATION_CHARGES != "0" && document.getElementById('chkcanclecharges').checked == true) {
                                    gross.value = parseFloat(gross.value) * parseFloat(ds.Tables[1].Rows[cntrfill].CANCELLATION_CHARGES) / 100;
                                }
                                else {
                                    gross.value = 0;
                                }
                            }
                        }
                        //freeIns="Y";
                        if (boxchargeInsertionwise == 'yes') {
                            grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(gridgross) + parseFloat(eyecatchRate) + parseFloat(boxcharge));
                        }
                        else {
                            grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(gridgross) + parseFloat(eyecatchRate));
                        }
                        // var paidno= "pai"+counter;
                        if (paidno != null) {
                            paidno.value = 'N';
                        }
                    }
                    else if (paidno != null) {
                        if (paidno.value == 'N') {
                            gross.value = 0;
                            if (boxchargeInsertionwise == 'yes') {
                                grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(gridgross) + parseFloat(eyecatchRate) + parseFloat(boxcharge));
                            }
                            else {
                                grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(gridgross) + parseFloat(eyecatchRate));
                            }
                        }
                    }
                    // 25 june10
//                    if (paidno.value != 'N')
//                       // cardrateSum = parseFloat(cardrateSum) + parseFloat(cardid.value);
//                    else if (insertsta.value == 'cancel')
//                       // cardrateSum = parseFloat(cardrateSum) + parseFloat(cardid.value);

                    if (billrate != null) {
                        //                                    var tradisc=document.getElementById('txttradedisc').value;
                        //                                    if(document.getElementById('chktrade').checked==false)
                        //                                        tradisc=0;
                        //                                    if(tradisc=="")
                        //                                        tradisc=0;
                        //                                    var trdisc1=tradisc;
                        //                                    var addcomm =0;
                        //                                    if(document.getElementById('txtaddagencycommrate')!=null)
                        //                                    {
                        //                                        if(document.getElementById('hiddenagcommflag').value!="1")
                        //                                            addcomm=document.getElementById('txtaddagencycommrate').value;
                        //                                    }
                        //                                    if(addcomm=="")
                        //                                    {
                        //                                        addcomm="0";
                        //                                    }
                        //                                    if(addcomm!="0")
                        //                                    {
                        //                                        trdisc1=parseFloat(tradisc) + parseFloat(addcomm);
                        //                                    }
                        var billamt = 0;
                        if (agncomm_seq_com_vari != "S")
                            billamt = parseFloat(gross.value) - (parseFloat(gross.value) * parseFloat(trdisc1) / 100);
                        else {
                            billamt = parseFloat(gross.value) - parseFloat(gross.value) * parseFloat(tradisc) / 100;
                            if (addcomm != "0" && addcomm != "") {
                                billamt = parseFloat(billamt) - parseFloat(billamt) * parseFloat(addcomm) / 100;
                            }
                        }
                        //   var billamt=parseFloat(gross.value) - (parseFloat(gross.value) * parseFloat(trdisc1)/100);
                        if (insertsta.value != "billed")
                            billrate.value = billamt.toFixed(2);
                        if (billrate.value != "" && counter != parseInt(rowcount) - 1) {
                            billamount = parseFloat(billamount) + parseFloat(billrate.value);
                        }
                        if (drpbooktype_vari == "2" || drpbooktype_vari == "6" || drpbooktype_vari == "4" || drpbooktype_vari == "5") {
                            if (insertsta.value != "billed")
                                billrate.value = 0;
                        }
                    }
                    if (bill_comp_amt != "" && parseFloat(cardid.value) != parseFloat(bill_comp_amt)) {
                        alert("Amount Not Match");
                        cardid.value = bill_comp_amt;
                        return false;
                    }
                    counter++;

                }
                else {
                    for (var edicount = 0; edicount < parseInt(gridItemCount); edicount++) {               //----1-----------

                        if (pkgcode.value == ds.Tables[1].Rows[edicount].PCODE && LTrim(RTrim(pkgalias.value)) == LTrim(RTrim(ds.Tables[1].Rows[edicount].PKG_ALIAS))) {           //----2-----------
                            var scheme = "";
                            //  if((agreedrate_vari.value== '' || agreedrate_vari.value== '0') && (agreedamt_vari.value=='' || agreedamt_vari.value=='0'))
                            //  {        //----3-----------
                            for (var scicount = 0; scicount < ds.Tables[2].Rows.length; scicount++) {       //----4-----------
                                var edipac = '';
                                if (ds.Tables[2].Rows[scicount].VAL == 'P')
                                    edipac = pkgcode.value;
                                else
                                    edipac = editioncomp.value;
                                if (edipac == ds.Tables[2].Rows[scicount].PKG_CODE && (parseInt(i) + 1 >= ds.Tables[2].Rows[scicount].FROM_INSERT && parseInt(i) + 1 <= ds.Tables[2].Rows[scicount].TO_INS) && paidno.value != "P") {           //----5-----------
                                    if (uomdesc == 'CD') {
                                        cardid.value = ds.Tables[1].Rows[edicount].EXTRARATE;
                                        solo.value = ds.Tables[1].Rows[edicount].SOLORATE;
                                    }
                                    else {
                                        cardid.value = ds.Tables[1].Rows[edicount].CARDRATE;
                                        solo.value = ds.Tables[1].Rows[edicount].SOLORATE;
                                    }
                                    var gridgross = "";
                                    if (insertsta.value != "billed") {
                                        agrred.value = "";
                                        gross.value = ds.Tables[1].Rows[edicount].FCARDRATE;
                                    }
                                    gridgross = gross.value;
                                    // cardamt=parseFloat(cardamt) + parseFloat(ds.Tables[1].Rows[edicount].FCARDRATE);
                                    cardamt = parseFloat(cardamt) + parseFloat(ds.Tables[1].Rows[edicount].FEXTRARATE) + parseFloat(ds.Tables[1].Rows[edicount].CARDRATE);
                                    if ((cardid.value == "0" || cardid.value == "") && cardamt != "" && uomdesc == 'CD') {
                                        cardid.value = parseFloat(cardamt) / parseFloat(totalarea_vari.value);
                                        cardid.value = parseFloat(cardid.value).toFixed(2);
                                    }


                                    // for insertion wise box charges

                                    //                                        if(boxchargeInsertionwise=='yes')
                                    //                                        {
                                    //                                            var tboxcharge=0;
                                    //                                            tboxcharge=boxcharge;
                                    //                                            if(hiddenbox_vari.value=='2')
                                    //                                            {
                                    //                                                tboxcharge=(parseFloat(gridgross) * parseFloat(boxcharge))/100;
                                    //                                            }
                                    //                                             tboxcharge=parseFloat(tboxcharge) / parseFloat(gridItemCount);
                                    //                                              boxc.value=tboxcharge;
                                    //                                            grossamtfinal=parseFloat(grossamtfinal) + parseFloat(tboxcharge);
                                    //                                            if(insertsta.value!="billed")
                                    //                                            gross.value = parseFloat(gross.value) + parseFloat(tboxcharge);
                                    //                                        }
                                    gridgross = gross.value;
                                    if (ds.Tables[2].Rows[scicount].TYPE == "per") {
                                        if (hidschememin_vari == "Y" && ds.Tables[1].Rows[edicount].MINWORD != null && parseInt(document.getElementById('siz' + counter).value) > parseInt(ds.Tables[1].Rows[edicount].MINWORD)) {
                                            var exrate = ds.Tables[1].Rows[edicount].FEXTRARATE;
                                            gridgross = parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) - (parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) * parseFloat(ds.Tables[2].Rows[scicount].AMT) / 100);
                                            gridgross = parseFloat(gridgross) + parseFloat(exrate);
                                        }
                                        else {
                                            gridgross = parseFloat(gridgross) - (parseFloat(gridgross) * parseFloat(ds.Tables[2].Rows[scicount].AMT) / 100);
                                        }
                                        if (parseInt(gridgross) == 0) {
                                            freeIns = "Y";
                                            freeIns_S = "Y";
                                        }
                                        grossamtfinal = parseFloat(grossamtfinal) + parseFloat(gridgross); //+gridgross;
                                        //agreed rate
                                        if (insertsta.value != "billed")
                                            gross.value = gridgross.toFixed(4);
                                    }
                                    else {
                                        var schratio = 0;
                                        if (gridItemTotal == 0) {
                                            for (var f = 0; f < ds.Tables[1].Rows.length; f++) {
                                                gridItemTotal = gridItemTotal + ds.Tables[1].Rows[f].FCARDRATE;
                                            }

                                        }
                                        schratio = (parseFloat(ds.Tables[2].Rows[scicount].AMT) / parseFloat(gridItemTotal)) * parseFloat(ds.Tables[1].Rows[edicount].FCARDRATE);
                                        // grossamtfinal = parseFloat(grossamtfinal) + (parseFloat(gridgross) - (parseFloat(ds.Tables[2].Rows[scicount].AMT) / parseInt(gridItemCount)));
                                        grossamtfinal = parseFloat(grossamtfinal) + (parseFloat(gridgross) - (parseFloat(schratio)));
                                        if (insertsta.value != "billed") {

                                            if (t == "D") {
                                                if (ds.Tables[1].Rows[edicount].PREM1 == null)
                                                    ds.Tables[1].Rows[edicount].PREM1 = "0";
                                                if (ds.Tables[1].Rows[edicount].PREM2 == null)
                                                    ds.Tables[1].Rows[edicount].PREM2 = "0";
                                                if (hidschememin_vari == "Y" && ds.Tables[1].Rows[edicount].MINWORD != null && parseInt(document.getElementById('siz' + counter).value) > parseInt(ds.Tables[1].Rows[edicount].MINWORD)) {
                                                    var exrate = ds.Tables[1].Rows[edicount].FEXTRARATE;
                                                    //  gross.value = parseFloat(gridgross) - (parseFloat(ds.Tables[2].Rows[scicount].AMT) / parseInt(gridItemCount));
                                                    // gridgross=parseFloat(gridgross) + parseFloat(exrate);
                                                    //
                                                    gridgross = parseFloat(gridgross) + parseFloat(exrate);
                                                    var newrate = parseFloat(gridgross) - (parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) * parseFloat(ds.Tables[1].Rows[edicount].PREM1) / 100);
                                                    newrate = parseFloat(newrate) - (parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                                    gross.value = parseFloat(newrate) - (parseFloat(schratio));
                                                    gross.value = parseFloat(gross.value) + (parseFloat(gross.value) * parseFloat(ds.Tables[1].Rows[edicount].PREM1) / 100) + (parseFloat(gross.value) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);

                                                }
                                                else {
                                                    // gross.value = parseFloat(gridgross) - (parseFloat(ds.Tables[2].Rows[scicount].AMT) / parseInt(gridItemCount));
                                                    var tr = parseFloat(ds.Tables[1].Rows[edicount].CARDRATE);
                                                    if (ds.Tables[1].Rows[edicount].FEXTRARATE != null && ds.Tables[1].Rows[edicount].FEXTRARATE != "null") {
                                                        tr = parseFloat(tr) + parseFloat(ds.Tables[1].Rows[edicount].FEXTRARATE);
                                                    }
                                                    var newrate = parseFloat(gridgross) - (parseFloat(tr) * parseFloat(ds.Tables[1].Rows[edicount].PREM1) / 100);
                                                    newrate = parseFloat(newrate) - (parseFloat(tr) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                                    gross.value = parseFloat(newrate) - (parseFloat(schratio));
                                                    gross.value = parseFloat(gross.value) + (parseFloat(gross.value) * parseFloat(ds.Tables[1].Rows[edicount].PREM1) / 100) + (parseFloat(gross.value) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                                }
                                            }
                                            else {
                                                if (hidschememin_vari == "Y" && ds.Tables[1].Rows[edicount].MINWORD != null && parseInt(document.getElementById('siz' + counter).value) > parseInt(ds.Tables[1].Rows[edicount].MINWORD)) {
                                                    var exrate = ds.Tables[1].Rows[edicount].FEXTRARATE;
                                                    gross.value = parseFloat(gridgross) - (parseFloat(schratio));
                                                    gridgross = parseFloat(gridgross) + parseFloat(exrate);
                                                }
                                                else {
                                                    gross.value = parseFloat(gridgross) - (parseFloat(schratio));
                                                }
                                            }
                                        }
                                    }
                                    if (bullet_var.value != '0') {
                                        if (eyecatchtype != 'S') {
                                            if (eyecatchtype == 'P') {
                                                if (bPrem.indexOf('%') > 0)
                                                    bPrem = bPrem.split('%')[0];
                                                eyecatchRate = (parseFloat(gridgross) * parseFloat(bPrem)) / 100;
                                                if (t == "D") {
                                                    if (ds.Tables[1].Rows[edicount].PREM1 == null)
                                                        ds.Tables[1].Rows[edicount].PREM1 = "0";
                                                    if (ds.Tables[1].Rows[edicount].PREM2 == null)
                                                        ds.Tables[1].Rows[edicount].PREM2 = "0";
                                                    var x = (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM1)) / 100;
                                                    x = parseFloat(x) + (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                                    eyecatchRate = parseFloat(eyecatchRate) + parseFloat(x);

                                                }
                                                grossamtfinal = parseFloat(grossamtfinal) + parseFloat(eyecatchRate);
                                                if (insertsta.value != "billed")
                                                    gross.value = parseFloat(gross.value) + parseFloat(eyecatchRate);
                                            }
                                            else if (eyecatchtype == 'F') {
                                                if (bPrem.indexOf('%') > 0)
                                                    bPrem = bPrem.split('%')[0];
                                                eyecatchRate = parseFloat(bPrem); //parseFloat(grossamtfinal) + parseFloat(bPrem);
                                                if (t == "D") {
                                                    if (ds.Tables[1].Rows[edicount].PREM1 == null)
                                                        ds.Tables[1].Rows[edicount].PREM1 = "0";
                                                    if (ds.Tables[1].Rows[edicount].PREM2 == null)
                                                        ds.Tables[1].Rows[edicount].PREM2 = "0";
                                                    var x = (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM1) / 100);
                                                    x = parseFloat(x) + (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                                    eyecatchRate = parseFloat(eyecatchRate) + parseFloat(x);

                                                }
                                                grossamtfinal = parseFloat(grossamtfinal) + (parseFloat(eyecatchRate) / parseInt(gridItemCount));
                                                if (insertsta.value != "billed")
                                                    gross.value = parseFloat(gross.value) + (parseFloat(eyecatchRate) / parseInt(gridItemCount));
                                            }
                                        }
                                    }
                                    scheme_var_id.value = ds.Tables[2].Rows[scicount].SCHEMENAME;
                                    schemeid = ds.Tables[2].Rows[scicount].SCHEMEID;
                                    if (paidno != null && ds.Tables[2].Rows[scicount].TYPE == "per" && ds.Tables[2].Rows[scicount].AMT == "100") {
                                        if (paidno.value != "P")
                                            paidno.value = 'N';
                                    }
                                    else if (paidno != null) {
                                        paidno.value = 'Y';
                                    }
                                    scheme = 'Y';

                                    if (i == 0) {
                                        if (uomdesc == 'CD') {
                                            // cardrate=parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[edicount].EXTRARATE);
                                            if (ds.Tables[1].Rows[edicount].EXTRARATE != "0" && ds.Tables[1].Rows[edicount].EXTRARATE != "")
                                                cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[edicount].EXTRARATE);
                                            else
                                                cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) / parseFloat(totalarea_vari.value);
                                        }
                                        else {
                                            cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[edicount].CARDRATE);
                                        }
                                    }
                                    edicount = gridItemCount;
                                    break;
                                }  //----5-----------

                            }    //----4-----------   
                            // }     //----3-----------  
                            if (scheme == '') {
                                if (uomdesc == 'CD') {
                                    cardid.value = ds.Tables[1].Rows[edicount].EXTRARATE;
                                    solo.value = ds.Tables[1].Rows[edicount].SOLORATE;
                                }
                                else {
                                    cardid.value = ds.Tables[1].Rows[edicount].CARDRATE;
                                    solo.value = ds.Tables[1].Rows[edicount].SOLORATE;
                                }
                                // cardamt=parseFloat(cardamt) + parseFloat(ds.Tables[1].Rows[edicount].FCARDRATE);
                                cardamt = parseFloat(cardamt) + parseFloat(ds.Tables[1].Rows[edicount].FEXTRARATE) + parseFloat(ds.Tables[1].Rows[edicount].CARDRATE);
                                if ((cardid.value == "0" || cardid.value == "") && cardamt != "" && uomdesc == 'CD') {
                                    cardid.value = parseFloat(cardamt) / parseFloat(totalarea_vari.value);
                                    cardid.value = parseFloat(cardid.value).toFixed(2);
                                }
                                var gridgross = 0;
                                if ((agreedrate_vari.value != '' && agreedrate_vari.value != '0') && (agreedamt_vari.value != '' && agreedamt_vari.value != '0')) {
                                    if (agreedrate_active == 0 && agreedamt_active == 0) {
                                        agreedamt_active = 1;
                                        flag_agreed = 2;
                                    }
                                }
                                if (agreedrate_active == 1 || agreedamt_active == 1) {
                                    var rowcountNum = rowcount;
                                    if (schemeCount > 0) {
                                        rowcountNum = parseInt(rowcount) - (parseInt(schemeCount) * parseInt(gridItemCount));
                                        if (flag_agreed != 2)
                                            flag_agreed = 1;
                                    }
                                    //////                                    if(flag_agreed==1)
                                    //////                                    {
                                    //////                                        var num=(parseFloat(parseFloat(agreedamt_vari.value) / parseInt(finsert))).toFixed(2);
                                    //////                                        agreedamt_vari.value=parseFloat(agreedamt_vari.value) - (parseFloat(num) * parseFloat(schemeCount));
                                    //////                                        flag_agreed=2;
                                    //////                                    }
                                    if (insertsta.value != "billed")
                                        agrred.value = (parseFloat(parseFloat(agreedamt_vari.value) / parseInt(rowcountNum))).toFixed(2);
                                    /* if(counter==parseInt(rowcount) - 1)
                                    {
                                    if(insertsta.value!="billed")
                                    agrred.value = (parseFloat(agreedamt_vari.value) - parseFloat(grossamtfinalAgreed)).toFixed(2) ;
                                    }*/
                                    // for applying scheme in Agreed Amount
                                    // 25 june 2010
                                    //////                                   if(schemeCount>0)
                                    //////                                   {
                                    //////                                   var diffcount=parseInt(finsert) - parseInt(schemeCount);
                                    //////                                      //   if(pkgcode.value==ds.Tables[2].Rows[0].PKG_CODE && parseInt(i)+1>diffcount)
                                    //////                                        if((parseInt(i)+1>parseInt(diffcount)))
                                    //////                                        { 
                                    //////                                                 freeIns="Y";
                                    //////                                                 gross.value =0;
                                    //////                                                  paidno.value='N';
                                    //////                                                  // scheme_var.value=ds.Tables[2].Rows[0].SCHEMENAME;
                                    //////                                        }   
                                    //////                                        else
                                    //////                                        {
                                    //////                                             gross.value = (parseFloat(agrred.value)).toFixed(2);
                                    //////                                        }     
                                    //////                                   }
                                    //////                                   else
                                    //////                                   {
                                    //////                                    gross.value = (parseFloat(agrred.value)).toFixed(2);
                                    //////                                   } 
                                    if (insertsta.value == 'cancel' || paidno.value == "N") {
                                        agreedcancelAmt = parseFloat(agreedcancelAmt) + parseFloat(agrred.value);
                                        //freeIns="Y";
                                        if (insertsta.value != "billed")
                                            gross.value = 0;
                                        paidno.value = 'N';
                                        grossamtfinalAgreed = parseFloat(grossamtfinalAgreed) + parseFloat(agrred.value);
                                    }
                                    gridgross = gross.value = parseFloat(gross.value).toFixed(4);

                                    //////  END
                                    edicount = gridItemCount;  //by nand on 2 oct
                                    if (i == 0) {
                                        if (uomdesc == 'CD') {
                                            //  cardrate=parseFloat(cardrate) + ds.Tables[1].Rows[cntrfill].EXTRARATE;
                                            if (ds.Tables[1].Rows[cntrfill].EXTRARATE != "0" && ds.Tables[1].Rows[cntrfill].EXTRARATE != "")
                                                cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].EXTRARATE);
                                            else
                                                cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].CARDRATE) / parseFloat(totalarea_vari.value);
                                        }
                                        else {
                                            cardrate = parseFloat(cardrate) + ds.Tables[1].Rows[cntrfill].CARDRATE;
                                        }
                                    }
                                    var grossValue = parseFloat(gross.value);
                                    grossamtfinal = parseFloat(grossamtfinal) + parseFloat(gridgross);
                                    grossamtfinalAgreed = parseFloat(grossamtfinalAgreed) + parseFloat(gridgross);
                                    // for box charges in agreed amount
                                    if (paidno.value == "N")
                                        boxcharge = "0";
                                    //                                      if(boxchargeInsertionwise=='yes' && paidno.value!='N')
                                    //                                    {
                                    //                                        var tboxcharge=0;
                                    //                                           tboxcharge=boxcharge;
                                    //                                        if(hiddenbox_vari.value=='2')
                                    //                                        {
                                    //                                             tboxcharge=(parseFloat(gridgross) * parseFloat(boxcharge))/100;
                                    //                                        }  
                                    //                                         tboxcharge=parseFloat(tboxcharge) / parseFloat(gridItemCount);
                                    //                                          boxc.value=tboxcharge;
                                    //                                        grossamtfinal=parseFloat(grossamtfinal) + parseFloat(tboxcharge);
                                    //                                        if(insertsta.value!="billed")
                                    //                                        gross.value = parseFloat(gross.value) + parseFloat(tboxcharge);
                                    //                                    }
                                    //                                    else{
                                    //                                         boxc.value="";
                                    //                                    }
                                }
                                else {
                                    if (insertsta.value != "billed") {
                                        agrred.value = "";
                                        gridgross = gross.value = ds.Tables[1].Rows[edicount].FCARDRATE;
                                    }
                                    grossamtfinal = parseFloat(grossamtfinal) + parseFloat(gridgross);
                                    if (bullet_var != null && bullet_var.value != '0') {
                                        if (eyecatchtype != 'S') {
                                            if (eyecatchtype == 'P') {
                                                if (bPrem.indexOf('%') > 0)
                                                    bPrem = bPrem.split('%')[0];
                                                eyecatchRate = (parseFloat(gridgross) * parseFloat(bPrem)) / 100;
                                                if (t == "D") {
                                                    if (ds.Tables[1].Rows[edicount].PREM1 == null)
                                                        ds.Tables[1].Rows[edicount].PREM1 = "0";
                                                    if (ds.Tables[1].Rows[edicount].PREM2 == null)
                                                        ds.Tables[1].Rows[edicount].PREM2 = "0";
                                                    var x = (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM1)) / 100;
                                                    x = parseFloat(x) + (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM2) / 100);
                                                    eyecatchRate = parseFloat(eyecatchRate) + parseFloat(x);

                                                }
                                                grossamtfinal = parseFloat(grossamtfinal) + parseFloat(eyecatchRate);
                                                if (insertsta.value != "billed")
                                                    gross.value = parseFloat(gross.value) + parseFloat(eyecatchRate);
                                            }
                                            else if (eyecatchtype == 'F') {
                                                if (bPrem.indexOf('%') > 0)
                                                    bPrem = bPrem.split('%')[0];
                                                eyecatchRate = parseFloat(bPrem); //parseFloat(grossamtfinal) + parseFloat(bPrem);
                                                if (t == "D") {
                                                    if (ds.Tables[1].Rows[edicount].PREM1 == null)
                                                        ds.Tables[1].Rows[edicount].PREM1 = "0";
                                                    if (ds.Tables[1].Rows[edicount].PREM2 == null)
                                                        ds.Tables[1].Rows[edicount].PREM2 = "0";
                                                    var x = (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM1)) / 100;
                                                    x = parseFloat(x) + (parseFloat(eyecatchRate) * parseFloat(ds.Tables[1].Rows[edicount].PREM2)) / 100;
                                                    eyecatchRate = parseFloat(eyecatchRate) + parseFloat(x);

                                                }
                                                grossamtfinal = parseFloat(grossamtfinal) + (parseFloat(eyecatchRate) / parseInt(gridItemCount));
                                                if (insertsta.value != "billed")
                                                    gross.value = parseFloat(gross.value) + (parseFloat(eyecatchRate) / parseInt(gridItemCount));
                                            }
                                        }
                                    }
                                    // for insertion wise Box Charges 
                                    //                                    if(boxchargeInsertionwise=='yes')
                                    //                                    {
                                    //                                        var tboxcharge=0;
                                    //                                        tboxcharge=boxcharge;
                                    //                                        if(hiddenbox_vari.value=='2')
                                    //                                        {
                                    //                                             tboxcharge=(parseFloat(gridgross) * parseFloat(boxcharge))/100;
                                    //                                        }  
                                    //                                         tboxcharge=parseFloat(tboxcharge) / parseFloat(gridItemCount);
                                    //                                          boxc.value=tboxcharge;
                                    //                                        grossamtfinal=parseFloat(grossamtfinal) + parseFloat(tboxcharge);
                                    //                                        if(insertsta.value!="billed")
                                    //                                        gross.value = parseFloat(gross.value) + parseFloat(tboxcharge);
                                    //                                    }

                                    edicount = gridItemCount;
                                    if (i == 0) {
                                        if (uomdesc == 'CD') {
                                            //                                            cardrate=parseFloat(cardrate) + ds.Tables[1].Rows[cntrfill].EXTRARATE;
                                            if (ds.Tables[1].Rows[cntrfill].EXTRARATE != "0" && ds.Tables[1].Rows[cntrfill].EXTRARATE != "")
                                                cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].EXTRARATE);
                                            else
                                                cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].CARDRATE) / parseFloat(totalarea_vari.value);
                                        }
                                        else {
                                            cardrate = parseFloat(cardrate) + ds.Tables[1].Rows[cntrfill].CARDRATE;
                                        }
                                    }
                                    var grossValue = parseFloat(gross.value);
                                    gross.value = grossValue.toFixed(4);
                                    // break;
                                }
                            }
                            if (insertsta.value == 'cancel' || paidno.value == "N") {
                                if (hidschememin_vari != "Y" || insertsta.value == 'cancel')
                                    gross.value = 0;
                                boxc.value = "";
                                //freeIns="Y";
                                if (boxchargeInsertionwise == 'yes') {
                                    grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(gridgross) + parseFloat(eyecatchRate) + parseFloat(boxcharge));
                                }
                                else {
                                    grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(gridgross) + parseFloat(eyecatchRate));
                                }
                                // var paidno= "pai"+counter;
                                if (paidno != null) {
                                    paidno.value = 'N';
                                }
                            }
                            else if (paidno != null) {
                                if (paidno.value == 'N') {
                                    gross.value = 0;
                                    boxc.value = "";
                                    if (boxchargeInsertionwise == 'yes') {
                                        grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(gridgross) + parseFloat(eyecatchRate) + parseFloat(boxcharge));
                                    }
                                    else {
                                        grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(gridgross) + parseFloat(eyecatchRate));
                                    }
                                }
                            }
                            if (paidno.value != 'N')
                                cardrateSum = parseFloat(cardrateSum) + parseFloat(cardid.value);
                            else if (insertsta.value == 'cancel')
                                cardrateSum = parseFloat(cardrateSum) + parseFloat(cardid.value);
                            if (billrate != null) {
                                //                                  var tradisc=document.getElementById('txttradedisc').value;
                                //                                  if(document.getElementById('chktrade').checked==false)
                                //                                 tradisc=0;
                                //                                    if(tradisc=="")
                                //                                        tradisc=0;
                                //                                    var trdisc1=tradisc;
                                //                                    var addcomm =0;
                                //                                    if(document.getElementById('txtaddagencycommrate')!=null)
                                //                                    {
                                //                                    if(document.getElementById('hiddenagcommflag').value!="1")
                                //                                        addcomm=document.getElementById('txtaddagencycommrate').value;
                                //                                    }
                                //                                    if(addcomm=="")
                                //                                    {
                                //                                        addcomm="0";
                                //                                    }
                                //                                    if(addcomm!="0")
                                //                                    {
                                //                                        trdisc1=parseFloat(tradisc) + parseFloat(addcomm);
                                //                                    }
                                var billamt = 0;
                                if (agncomm_seq_com_vari != "S")
                                    billamt = parseFloat(gross.value) - (parseFloat(gross.value) * parseFloat(trdisc1) / 100);
                                else {
                                    billamt = parseFloat(gross.value) - parseFloat(gross.value) * parseFloat(tradisc) / 100;
                                    if (addcomm != "0" && addcomm != "") {
                                        billamt = parseFloat(billamt) - parseFloat(billamt) * parseFloat(addcomm) / 100;
                                    }
                                }
                                if (insertsta.value != "billed")
                                    billrate.value = billamt.toFixed(2);
                                if (billrate.value != "" && counter != parseInt(rowcount) - 1) {
                                    billamount = parseFloat(billamount) + parseFloat(billrate.value);
                                }
                                if (drpbooktype_vari == "2" || drpbooktype_vari == "6" || drpbooktype_vari == "4" || drpbooktype_vari == "5") {
                                    if (insertsta.value != "billed")
                                        billrate.value = 0;
                                }
                            }
                            if (bill_comp_amt != "" && parseFloat(cardid.value) != parseFloat(bill_comp_amt)) {
                                alert("Amount Not Match");
                                cardid.value = bill_comp_amt;
                                return false;
                            }
                            counter++;
                        }

                    }
                }
                // END


            }
            else {
                alert(ds.Tables[0].Rows[0].MESSAGE);
                return false;
            }

        }

    }
    // for grossa mount
    if (scheme_var != "[object]" && scheme_var_id.value == "") {
        scheme_var_id.value = scheme_var;
    }
    if (freeIns == "Y") {
        if (schemecountNumber != "" && schemecountNumber != "0")
            paid_var.value = parseInt(paid_var.value) - parseInt(schemecountNumber, 10);
        else
            paid_var.value = parseInt(paid_var.value) - 1;
    }
    //    if(freeIns_S=="Y")  
    // {
    // sPaid=parseInt(sPaid,10)+1;
    // }
    /* if(hiddenbox_vari!=null)
    {
    if(boxchargeInsertionwise=='no')
    {
    if(hiddenbox_vari.value=='2')
    {
    boxcharge=(parseFloat(grossamtfinal) * parseFloat(boxcharge))/100;
    }
    grossamtfinal=parseFloat(grossamtfinal) + parseFloat(boxcharge);   
    }  
    }   */
    if (agreedrate_active == 1 || agreedamt_active == 1) {
        if (hiddenbox_vari != null) {
            if (boxchargeInsertionwise == 'yes') {
                if (hiddenbox_vari.value == '2') {
                    boxcharge = (parseFloat(agreedamt_vari.value) * parseFloat(boxcharge)) / 100;
                }
                else {
                    boxcharge = parseFloat(boxcharge) * parseFloat(document.getElementById('txtinsertion').value)
                }
                //grossamtfinal=parseFloat(grossamtfinal) + parseFloat(boxcharge);   
            }
        }
        grossamt_vari.value = parseFloat(agreedamt_vari.value) + parseFloat(boxcharge);
        grossamt_vari.value = parseFloat(grossamt_vari.value) - parseFloat(agreedcancelAmt);
    }
    else
        grossamt_vari.value = grossamtfinal.toFixed(2);
    document.getElementById('txtcardrate').value = cardrate.toFixed(2);
    grossamt_vari.value = parseFloat(grossamt_vari.value).toFixed(2);
    //document.getElementById('txtcardamt').value=grossamtfinal.toFixed(2);
    /* if( document.getElementById('txtpageamt').value!="")
    {
    var posprem=document.getElementById('txtpageamt').value;
    if(document.getElementById('txtpospremdisc').value!="")
    posprem=parseFloat(posprem)-parseFloat(document.getElementById('txtpospremdisc').value);
       
    cardamt=parseFloat(cardamt)  - parseFloat(document.getElementById('txtcardrate').value) * parseFloat(document.getElementById('txttotalarea').value) * parseFloat(posprem) / 100;
    }*/
    document.getElementById('txtcardamt').value = cardamt.toFixed(2);
    cardamt = 0;
    // Bill Calculation
    if (document.getElementById('configclient').value == "BHASKAR")
        roundTotal();
    if (document.getElementById('txtcardamt').value != "")//&& document.getElementById('txttradedisc').value!="")
    {
        var caramt = grossamt_vari.value;
        //            var tradisc=document.getElementById('txttradedisc').value;
        //            if(document.getElementById('chktrade').checked==false)
        //                    tradisc=0;
        //            if(tradisc=="")
        //                tradisc = 0;
        //            var trdisc1=tradisc;
        //            var addcomm =0;
        //            if(document.getElementById('txtaddagencycommrate')!=null)
        //            {
        //            if(document.getElementById('hiddenagcommflag').value!="1")
        //                addcomm=document.getElementById('txtaddagencycommrate').value;
        //            }
        //            if(addcomm=="")
        //            {
        //                addcomm="0";
        //            }
        //            if(addcomm!="0")
        //            {
        //                trdisc1=parseFloat(tradisc) + parseFloat(addcomm);
        //            }
        var tot = 0;
        if (agncomm_seq_com_vari != "S")
            tot = parseFloat(caramt) - parseFloat(caramt) * parseFloat(trdisc1) / 100;
        else {
            tot = parseFloat(caramt) - parseFloat(caramt) * parseFloat(tradisc) / 100;
            if (addcomm != "0" && addcomm != "") {
                tot = parseFloat(tot) - parseFloat(tot) * parseFloat(addcomm) / 100;
            }
        }
        billamt_vari.value = tot.toFixed(2);
    }
    else {
        billamt_vari.value = grossamt_vari.value;
    }
    // for agreed amounr ration in grid
    if (agreedamt_active == "1")//&& sPaid!="0")
    {
        if (document.getElementById('txtpaid').value == "0")
            document.getElementById('txtpaid').value = "1";
        agreedrate_vari.value = (parseFloat(agreedamt_vari.value) / (parseInt((paid_var.value), 10) * parseFloat(totalarea_vari.value))).toFixed(3);
        agreedrate_vari.value = parseFloat(agreedrate_vari.value) * parseInt(drppackage_vari.options.length, 10);
    }
    if ((agreedrate_vari.value != '' && agreedrate_vari.value != '0') && (agreedamt_vari.value != '' && agreedamt_vari.value != '0')) {
        var grossTot = 0;
        var grossTotAgreed = 0;
        var grossTotFinal = 0;
        billamount = 0;
        var cancelAmount = 0;
        var cancelBillAmount = 0;
        var d_data_gross;
        var d_data_Agreed;
        var d_data_bill;
        var totarea_m = totalarea_vari.value;
        var totarea_g = totalarea_vari.value;
        var crrate = document.getElementById('txtcardrate').value;
        var agrate_m = parseFloat(agreedrate_vari.value); // * parseInt(document.getElementById('txtpaid').value,10);
        for (k1 = 0; k1 < rowcount; k1++) {
            var cardid = "cardrate" + k1;
            var insertsta = document.getElementById("inssta" + k1);
            var paidno = document.getElementById("pai" + k1);
            var insertsta = document.getElementById("inssta" + k1);
            var billrate = document.getElementById("ba" + k1);
            if (agreedamt_active != 1)
                totarea_g = document.getElementById("siz" + k1).value;
            var discrate = document.getElementById("disrat" + k1);
            if (document.getElementById("agr" + k1).value == "")
                document.getElementById("agr" + k1).value = 0;
            if (paidno.value != 'N' && insertsta.value != 'cancel') {
                var disc_rate = (parseFloat(document.getElementById(cardid).value) / parseFloat(crrate)) * parseFloat(agrate_m);
                if (insertsta.value != "billed")
                    discrate.value = disc_rate;
                var gross = parseFloat(totarea_g) * parseFloat(discrate.value);
                // var gross=(parseFloat(document.getElementById(cardid).value) / parseFloat(cardrateSum)) * parseFloat(agreedamt_vari.value);
                var diff = (parseFloat(agreedamt_vari.value) - parseFloat(cancelAmount)) - (parseFloat(grossTot) + parseFloat(gross));
                diff = (parseFloat(diff)).toFixed(2);
                if (parseFloat(diff) < 1 && parseFloat(diff) >= 0) {
                    if (insertsta.value != "billed")
                        document.getElementById("gro" + k1).value = ((parseFloat(agreedamt_vari.value) - parseFloat(cancelAmount)) - parseFloat(grossTot)).toFixed(4);
                    grossTot = parseFloat(grossTot) + parseFloat(document.getElementById("gro" + k1).value);
                    grossTotAgreed = parseFloat(grossTotAgreed) + parseFloat(document.getElementById("agr" + k1).value);
                }
                else if (k1 == parseInt(rowcount) - 1) {
                    if (insertsta.value != "billed")
                        document.getElementById("gro" + k1).value = ((parseFloat(agreedamt_vari.value) - parseFloat(cancelAmount)) - parseFloat(grossTot)).toFixed(4);
                    grossTot = parseFloat(grossTot) + parseFloat(document.getElementById("gro" + k1).value);
                    grossTotAgreed = parseFloat(grossTotAgreed) + parseFloat(document.getElementById("agr" + k1).value);
                }
                else {
                    if (document.getElementById(cardid) != null) {
                        if (insertsta.value != "billed")
                            document.getElementById("gro" + k1).value = (gross).toFixed(4);
                        grossTot = parseFloat(grossTot) + parseFloat(document.getElementById("gro" + k1).value);
                        grossTotAgreed = parseFloat(grossTotAgreed) + parseFloat(document.getElementById("agr" + k1).value);
                    }
                }
                grossTotFinal = grossTot;
                if (insertsta.value != "billed" && insertsta.value != "cancel") {
                    if (parseFloat(totarea_g) > parseFloat(totarea_m)) {
                        var diffg = parseFloat(totarea_g) - parseFloat(totarea_m);
                        var t = (parseFloat(document.getElementById("sol" + k1).value) * parseFloat(diffg));
                        document.getElementById("gro" + k1).value = parseFloat(document.getElementById("gro" + k1).value) + parseFloat(t);
                        grossTotFinal = parseFloat(grossTotFinal) + parseFloat(t);
                    }
                    d_data_gross = document.getElementById("gro" + k1);
                    d_data_bill = document.getElementById("ba" + k1);
                    d_data_Agreed = document.getElementById("agr" + k1);
                }
                // for billing calculation
                //                  var tradisc=document.getElementById('txttradedisc').value;
                //                  if(document.getElementById('chktrade').checked==false)
                //                    tradisc=0;
                //                                    if(tradisc=="")
                //                                        tradisc=0;
                //                                    var trdisc1=tradisc;
                //                                    var addcomm =0;
                //                                    if(document.getElementById('txtaddagencycommrate')!=null)
                //                                    {
                //                                    if(document.getElementById('hiddenagcommflag').value!="1")
                //                                        addcomm=document.getElementById('txtaddagencycommrate').value;
                //                                    }
                //                                    if(addcomm=="")
                //                                    {
                //                                        addcomm="0";
                //                                    }
                //                                    if(addcomm!="0")
                //                                    {
                //                                        trdisc1=parseFloat(tradisc) + parseFloat(addcomm);
                //                                    }
                var billamt = 0;
                if (agncomm_seq_com_vari != "S")
                    billamt = parseFloat(document.getElementById("gro" + k1).value) - (parseFloat(document.getElementById("gro" + k1).value) * parseFloat(trdisc1) / 100);
                else {
                    billamt = parseFloat(document.getElementById("gro" + k1).value) - parseFloat(document.getElementById("gro" + k1).value) * parseFloat(tradisc) / 100;
                    if (addcomm != "0" && addcomm != "") {
                        billamt = parseFloat(billamt) - parseFloat(billamt) * parseFloat(addcomm) / 100;
                    }
                }
                //   var billamt=parseFloat(gross.value) - (parseFloat(gross.value) * parseFloat(trdisc1)/100);
                //   var diffBill= parseFloat(document.getElementById('txtbillamt').value) -  (parseFloat(billamount) + parseFloat(billamt));
                // diffBill = (parseFloat(diffBill)).toFixed(2);
                //  if(parseFloat(diffBill)<1 && parseFloat(diffBill)>=0)
                // {
                // billrate.value=(parseFloat(document.getElementById('txtbillamt').value) - parseFloat(billamount)).toFixed(2);
                // }
                //  else
                //  {
                if (insertsta.value != "billed")
                    billrate.value = billamt.toFixed(2);
                //  }   
                if (billrate.value != "" && counter != parseInt(rowcount) - 1) {
                    billamount = parseFloat(billamount) + parseFloat(billrate.value);
                }
                if (drpbooktype_vari == "2" || drpbooktype_vari == "6" || drpbooktype_vari == "4" || drpbooktype_vari == "5") {
                    if (insertsta.value != "billed")
                        billrate.value = 0;
                }
            }
            else {
                if (insertsta.value == 'cancel') {
                    //cancelAmount =parseFloat(cancelAmount) +  ((parseFloat(document.getElementById(cardid).value) / parseFloat(cardrateSum)) * parseFloat(agreedamt_vari.value));
                }
                if (insertsta.value != "billed") {

                    var disc_rate = (parseFloat(document.getElementById(cardid).value) / parseFloat(crrate)) * parseFloat(agrate_m);
                    if (insertsta.value != "billed")
                        discrate.value = disc_rate;
                    if (agreedamt_active == "1")
                        var gross = (parseFloat(document.getElementById(cardid).value) / parseFloat(cardrateSum)) * parseFloat(agreedamt_vari.value);
                    else
                        var gross = parseFloat(totarea_g) * parseFloat(discrate.value); //(parseFloat(document.getElementById(cardid).value) / parseFloat(cardrateSum)) * parseFloat(agreedamt_vari.value);
                    var diff = (parseFloat(agreedamt_vari.value) - parseFloat(cancelAmount)) - (parseFloat(grossTot) + parseFloat(gross));
                    diff = (parseFloat(diff)).toFixed(2);
                    if (parseFloat(diff) < 1 && parseFloat(diff) >= 0) {
                        if (insertsta.value != "billed") {
                            if (agreedamt_active == "1")
                                document.getElementById("gro" + k1).value = ((parseFloat(agreedamt_vari.value) - parseFloat(cancelAmount)) - parseFloat(grossTot)).toFixed(4);
                            else
                                document.getElementById("gro" + k1).value = parseFloat(totarea_g) * parseFloat(discrate.value);
                            // document.getElementById("gro"+k1).value =  ((parseFloat(agreedamt_vari.value) - parseFloat(cancelAmount)) - parseFloat(grossTot)).toFixed(2);
                            if (agreedrate_active == 1 && premper_vari != "" && premper_vari != "0") {
                                document.getElementById("gro" + k1).value = parseFloat(document.getElementById("gro" + k1).value) + (parseFloat(gross) * parseFloat(premper_vari) / 100);
                            }
                        }
                        if (canclecharge != null && canclecharge != "0" && document.getElementById('chkcanclecharges').checked == true) {
                            document.getElementById("gro" + k1).value = parseFloat(document.getElementById("gro" + k1).value) * parseFloat(canclecharge) / 100;
                        }
                        else {
                            document.getElementById("gro" + k1).value = 0;
                            document.getElementById("agr" + k1).value = 0;
                            document.getElementById("disrat" + k1).value = 0;
                        }
                        grossTot = parseFloat(grossTot) + parseFloat(document.getElementById("gro" + k1).value);
                        grossTotAgreed = parseFloat(grossTotAgreed) + parseFloat(document.getElementById("agr" + k1).value);
                    }
                    else if (k1 == parseInt(rowcount) - 1) {
                        if (insertsta.value != "billed") {
                            document.getElementById("gro" + k1).value = parseFloat(totarea_g) * parseFloat(discrate.value);
                            //  document.getElementById("gro"+k1).value =  ((parseFloat(agreedamt_vari.value) - parseFloat(cancelAmount)) - parseFloat(grossTot)).toFixed(2);
                            if (agreedrate_active == 1 && premper_vari != "" && premper_vari != "0") {
                                document.getElementById("gro" + k1).value = parseFloat(document.getElementById("gro" + k1).value) + (parseFloat(gross) * parseFloat(premper_vari) / 100);
                            }
                        }
                        if (canclecharge != null && canclecharge != "0" && document.getElementById('chkcanclecharges').checked == true) {
                            document.getElementById("gro" + k1).value = parseFloat(document.getElementById("gro" + k1).value) * parseFloat(canclecharge) / 100;
                        }
                        else {
                            document.getElementById("gro" + k1).value = 0;
                            document.getElementById("agr" + k1).value = 0;
                            document.getElementById("disrat" + k1).value = 0;
                        }
                        grossTot = parseFloat(grossTot) + parseFloat(document.getElementById("gro" + k1).value);
                        grossTotAgreed = parseFloat(grossTotAgreed) + parseFloat(document.getElementById("agr" + k1).value);
                    }
                    else {
                        if (document.getElementById(cardid) != null) {
                            if (insertsta.value != "billed") {
                                document.getElementById("gro" + k1).value = (gross).toFixed(4);
                                if (agreedrate_active == 1 && premper_vari != "" && premper_vari != "0") {
                                    document.getElementById("gro" + k1).value = parseFloat(document.getElementById("gro" + k1).value) + (parseFloat(gross) * parseFloat(premper_vari) / 100);
                                }
                            }
                            if (canclecharge != null && canclecharge != "0" && document.getElementById('chkcanclecharges').checked == true) {
                                document.getElementById("gro" + k1).value = parseFloat(document.getElementById("gro" + k1).value) * parseFloat(canclecharge) / 100;
                            }
                            else {
                                document.getElementById("gro" + k1).value = 0;
                                document.getElementById("agr" + k1).value = 0;
                                document.getElementById("disrat" + k1).value = 0;
                            }
                            grossTot = parseFloat(grossTot) + parseFloat(document.getElementById("gro" + k1).value);
                            grossTotAgreed = parseFloat(grossTotAgreed) + parseFloat(document.getElementById("agr" + k1).value);
                        }
                    }
                    grossTotFinal = grossTot;
                    if (insertsta.value != "billed" && insertsta.value != "cancel") {
                        d_data_gross = document.getElementById("gro" + k1);
                        d_data_bill = document.getElementById("ba" + k1);
                        d_data_Agreed = document.getElementById("agr" + k1);
                    }

                    var billamt = 0;
                    if (agncomm_seq_com_vari != "S")
                        billamt = parseFloat(document.getElementById("gro" + k1).value) - (parseFloat(document.getElementById("gro" + k1).value) * parseFloat(trdisc1) / 100);
                    else {
                        billamt = parseFloat(document.getElementById("gro" + k1).value) - parseFloat(document.getElementById("gro" + k1).value) * parseFloat(tradisc) / 100;
                        if (addcomm != "0" && addcomm != "") {
                            billamt = parseFloat(billamt) - parseFloat(billamt) * parseFloat(addcomm) / 100;
                        }
                    }

                    if (insertsta.value != "billed")
                        billrate.value = billamt.toFixed(2);

                    if (billrate.value != "" && counter != parseInt(rowcount) - 1) {
                        billamount = parseFloat(billamount) + parseFloat(billrate.value);
                    }
                    if (drpbooktype_vari == "2" || drpbooktype_vari == "4" || drpbooktype_vari == "5" || drpbooktype_vari == "6" || parseFloat(totalarea_vari.value) == 0) {
                        if (insertsta.value != "billed")
                            billrate.value = 0;
                    }
                }
            }
        }
        if (agreedamt_active == 1)
            agreedrate_vari.value = parseFloat(agreedrate_vari.value).toFixed(2);
        var diffagg = parseFloat(agreedamt_vari.value) - parseFloat(grossTot); // + parseFloat(cancelAmount));
        diffagg = (diffagg).toFixed(2);
        var diffagg_rate = parseFloat(agreedamt_vari.value) - (parseFloat(grossTotAgreed));
        diffagg_rate = (diffagg_rate).toFixed(2);
        if (agreedrate_active == 1) {
            diffagg = 0;
            diffagg_rate = 0;
        }
        if (d_data_gross != undefined) {
            if (d_data_Agreed != undefined && parseInt(diffagg_rate, 10) != 0) {
                var nid = d_data_Agreed.id.replace("agr", "disrat");
                var nsid = d_data_Agreed.id.replace("agr", "siz");
                d_data_Agreed.value = parseFloat(d_data_Agreed.value) + parseFloat(diffagg_rate);
                document.getElementById(nid).value = parseFloat(d_data_Agreed.value) / parseFloat(document.getElementById(nsid).value);
            }
            d_data_gross.value = parseFloat(d_data_gross.value) + parseFloat(diffagg);
            grossTot = parseFloat(grossTot) + parseFloat(diffagg);
            grossTotFinal = parseFloat(grossTotFinal) + parseFloat(diffagg);
            //         var tradisc=document.getElementById('txttradedisc').value;
            //                   if(document.getElementById('chktrade').checked==false)
            //                    tradisc=0;
            //                                    if(tradisc=="")
            //                                        tradisc=0;
            //                                    var trdisc1=tradisc;
            //                                    var addcomm =0;
            //                                    if(document.getElementById('txtaddagencycommrate')!=null)
            //                                    {
            //                                    if(document.getElementById('hiddenagcommflag').value!="1")
            //                                        addcomm=document.getElementById('txtaddagencycommrate').value;
            //                                    }
            //                                    if(addcomm=="")
            //                                    {
            //                                        addcomm="0";
            //                                    }
            //                                    if(addcomm!="0")
            //                                    {
            //                                        trdisc1=parseFloat(tradisc) + parseFloat(addcomm);
            //                                    }
            var diffaggB = parseFloat(diffagg) - (parseFloat(diffagg) * parseFloat(trdisc1) / 100);
            d_data_bill.value = parseFloat(d_data_bill.value) + parseFloat(diffaggB);
            billamount = parseFloat(billamount) + parseFloat(diffaggB);
        }
        grossamt_vari.value = parseFloat(grossTotFinal).toFixed(2);
        billamt_vari.value = parseFloat(billamount).toFixed(2);
    }


    //        if(boxchargeInsertionwise=='yes')
    //        {
    //            var lastItem="ba"+ (parseInt(counter)-1).toString();
    //              var paidno= "pai"+(parseInt(counter)-1).toString();
    //            var fAmt= parseFloat(document.getElementById('txtbillamt').value)-parseFloat(billamount);
    //            if(document.getElementById(lastItem)!=null && document.getElementById(paidno)!=null && document.getElementById(paidno).value!="N")
    //            {
    //                document.getElementById(lastItem).value=fAmt.toFixed(2);
    //                if(fAmt<0)
    //                {
    //                    if(document.getElementById("ba0")!=null && document.getElementById("ba0").value!="")
    //                    {
    //                        document.getElementById("ba0").value=(parseFloat(document.getElementById("ba0").value) + parseFloat(fAmt)).toFixed(2);
    //                    }
    //                    document.getElementById(lastItem).value=0;
    //                }
    //             }   
    //        }
    if (drpbooktype_vari == "2" || drpbooktype_vari == "6" || drpbooktype_vari == "4" || drpbooktype_vari == "5") {
        var lastItem = "ba" + (parseInt(counter) - 1).toString();
        var insertsta = document.getElementById("inssta" + (parseInt(counter) - 1).toString());
        if (document.getElementById(lastItem) != null) {
            if (insertsta.value != "billed")
                document.getElementById(lastItem).value = 0;
        }
        billamt_vari.value = 0;
    }
    ///  return false;
}




function getagreedamt() {
    //*********
    if (document.getElementById('txtcardamt').value == "") {
        alert("Please Firstly click on GetRate Button");
        document.getElementById('txtagreedamt').value = "";
        document.getElementById('txtagreedrate').value = "";
        document.getElementById('btnshgrid').focus();
        return false;
    }
    if (document.getElementById('txtagreedamt').value != "") {
        if (parseInt(document.getElementById('txtagreedamt').value) == "0") {
            document.getElementById('txtagreedamt').value = "";
            document.getElementById('txtagreedrate').value = "";
            agreedrate_active = 0;
            agreedamt_active = 0;
        }
        ////        if(parseInt(document.getElementById('txtagreedrate').value)=="0")
        ////        {
        ////            document.getElementById('txtagreedrate').value="";
        ////            document.getElementById('txtagreedamt').value="";
        ////            agreedrate_active=0;
        ////            agreedamt_active=0;
        ////        }
    }

    ////    if(document.getElementById('txtagreedrate').value!="")
    ////    {
    ////        if(parseInt(document.getElementById('txtagreedamt').value)=="0")
    ////        {
    ////            document.getElementById('txtagreedamt').value="";
    ////            document.getElementById('txtagreedrate').value="";
    ////            agreedrate_active=0;
    ////            agreedamt_active=0;
    ////        }
    ////        if(parseInt(document.getElementById('txtagreedrate').value)=="0")
    ////        {
    ////            document.getElementById('txtagreedrate').value="";
    ////            document.getElementById('txtagreedamt').value="";
    ////            agreedrate_active=0;
    ////            agreedamt_active=0;
    ////        }
    ////    }
    //***********
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    document.getElementById('drpscheme').value = "";
    document.getElementById('txtdiscount').value = "";
    document.getElementById('txtdiscpre').value = "";
    var paidCount = document.getElementById('txtinsertion').value;
    var finsert = 1;
    var tinsert = 0;
    if (document.getElementById('drppackagecopy').options.length > 0) {
        for (var insertCou = 0; insertCou < document.getElementById('drppackagecopy').options.length; insertCou++) {
            if (document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') >= 0) {
                tinsert = document.getElementById('drppackagecopy').options[insertCou].value.substring(document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') + 1, document.getElementById('drppackagecopy').options[insertCou].value.indexOf(')'));
                if (parseInt(tinsert) > parseInt(finsert)) {
                    finsert = tinsert;
                }
                paidCount = parseInt(paidCount) * parseInt(tinsert);
            }
        }
    }
    if ((agreedrate_active == 1 || document.activeElement.id == 'txtagreedrate') && document.getElementById('txtagreedrate').value != "" && document.getElementById('txtagreedrate').value != "0") {
        agreedrate_active = 1;
        agreedamt_active = 0;
        if (document.getElementById('txttotalarea').value != "" && document.getElementById('txttotalarea').value != "NaN") {
            document.getElementById('txtagreedamt').value = (parseInt((paidCount), 10) * parseFloat(document.getElementById('txtagreedrate').value) * parseFloat(document.getElementById('txttotalarea').value)).toFixed(2);
            if (document.getElementById('txtcardrate').value != "") {
                document.getElementById('txtdiscount').value = (parseFloat(document.getElementById('txtcardrate').value) - parseFloat(document.getElementById('txtagreedrate').value)).toFixed(2);
                document.getElementById('txtdiscpre').value = (parseFloat(document.getElementById('txtdiscount').value) * 100 / parseFloat(document.getElementById('txtcardrate').value)).toFixed(2);
            }
        }

    }
    if ((agreedamt_active == 1 || document.activeElement.id == 'txtagreedamt') && document.getElementById('txtagreedamt').value != "" && document.getElementById('txtagreedamt').value != "0") {
        agreedrate_active = 0;
        agreedamt_active = 1;
        if (document.getElementById('txttotalarea').value != "" && document.getElementById('txttotalarea').value != "NaN") {
            document.getElementById('txtagreedrate').value = (parseFloat(document.getElementById('txtagreedamt').value) / (parseInt((paidCount), 10) * parseFloat(document.getElementById('txttotalarea').value))).toFixed(2);
            if (document.getElementById('txtcardrate').value != "") {
                document.getElementById('txtdiscount').value = (parseFloat(document.getElementById('txtcardrate').value) - parseFloat(document.getElementById('txtagreedrate').value)).toFixed(2);
                document.getElementById('txtdiscpre').value = (parseFloat(document.getElementById('txtdiscount').value) * 100 / parseFloat(document.getElementById('txtcardrate').value)).toFixed(2);
            }
        }
    }
    else if (document.activeElement.id == 'txtagreedamt' && document.getElementById('txtagreedamt').value == "" && document.getElementById('txtagreedamt').value != "0") {
        document.getElementById('txtagreedrate').value = "";
    }
    if ((document.getElementById('txtagreedrate').value == "" || document.getElementById('txtagreedrate').value == "NaN") && (document.getElementById('txtagreedamt').value == "" || document.getElementById('txtagreedamt').value == "NaN")) {
        agreedrate_active = 0;
        agreedamt_active = 0;
    }
    if (document.getElementById('hiddenuomdesc').value == "CD" && document.getElementById('hiddenuserdisc').value != "" && document.getElementById('hiddenuserdisc').value != "0" && document.getElementById('txtdiscpre').value != "" && document.getElementById('txtdiscpre').value != "0") {
        if (parseFloat(document.getElementById('txtdiscpre').value) > parseFloat(document.getElementById('hiddenuserdisc').value)) {
            alert("User Allowed Commission can't be greater than " + document.getElementById('hiddenuserdisc').value);
            document.getElementById('txtagreedrate').value = "";
            document.getElementById('txtagreedamt').value = "";
            document.getElementById('txtdiscpre').value = "";
            document.getElementById('txtdiscount').value = "";
            agreedrate_active = 0;
            agreedamt_active = 0;
            document.getElementById('txtagreedrate').focus();
            return false;
        }
    }
}
//*******************************************
function getagreedamt_Rate() {
    var totalarea = document.getElementById('txttotalarea').value;
    if (document.getElementById("txtbillwidth").value != "" && document.getElementById("txtbillheight").value != "") {
        if (document.getElementById('txtcolum').value != "")
            totalarea = parseFloat(document.getElementById("txtbillwidth").value) * parseFloat(document.getElementById("txtcolum").value);
        else
            totalarea = parseFloat(document.getElementById("txtbillwidth").value) * parseFloat(document.getElementById("txtbillheight").value);
    }
    var agreedrate_vari = document.getElementById('txtagreedrate');
    var agreedamt_vari = document.getElementById('txtagreedamt');
    if (agreedrate_vari.value != "") {
        if (parseFloat(agreedrate_vari.value) == "0" || parseFloat(agreedrate_vari.value) == "0.00") {
            agreedamt_vari.value = "";
            agreedrate_vari.value = "";
            agreedrate_active = 0;
            agreedamt_active = 0;
        }
    }
    else if (agreedamt_vari.value != "") {
        if (parseFloat(agreedamt_vari.value) == "0" || parseFloat(agreedamt_vari.value) == "0.00") {
            agreedamt_vari.value = "";
            agreedrate_vari.value = "";
            agreedrate_active = 0;
            agreedamt_active = 0;
        }
    }

    var paidCount = document.getElementById('txtinsertion').value;
    var finsert = 1;
    var tinsert = 0;
    document.getElementById('txtgrossamt').value = "";
    var drppackage_vari = document.getElementById('drppackagecopy');
    var totalarea_vari = document.getElementById('txttotalarea');
    var cardrate_vari = document.getElementById('txtcardrate');
    var dis_vari = document.getElementById('txtdiscount');
    var discpre_vari = document.getElementById('txtdiscpre');
    if (drppackage_vari.options.length > 0) {
        for (var insertCou = 0; insertCou < drppackage_vari.options.length; insertCou++) {
            if (drppackage_vari.options[insertCou].value.indexOf('(') >= 0) {
                tinsert = drppackage_vari.options[insertCou].value.substring(drppackage_vari.options[insertCou].value.indexOf('(') + 1, drppackage_vari.options[insertCou].value.indexOf(')'));
                if (parseInt(tinsert) > parseInt(finsert)) {
                    finsert = tinsert;
                }
                paidCount = parseInt(paidCount) * parseInt(tinsert);
            }
        }
    }
    if (agreedrate_active == 1) {
        agreedrate_active = 1;
        agreedamt_active = 0;
        if (totalarea_vari.value != "" && totalarea_vari.value != "NaN" && agreedrate_vari.value != "" && agreedrate_vari.value != "0") {
            agreedamt_vari.value = (parseInt((paidCount), 10) * parseFloat(agreedrate_vari.value) * parseFloat(totalarea)).toFixed(2);
            if (cardrate_vari.value != "") {
                dis_vari.value = (parseFloat(cardrate_vari.value) - parseFloat(agreedrate_vari.value)).toFixed(2);
                discpre_vari.value = (parseFloat(dis_vari.value) * 100 / parseFloat(cardrate_vari.value)).toFixed(2);
            }
        }

    }
    if (agreedamt_active == 1) {
        agreedrate_active = 0;
        agreedamt_active = 1;
        if (totalarea_vari.value != "" && totalarea_vari.value != "NaN" && agreedamt_vari.value != "" && agreedamt_vari.value != "0") {
            agreedrate_vari.value = (parseFloat(agreedamt_vari.value) / (parseInt((paidCount), 10) * parseFloat(totalarea))); //.toFixed(2);
            if (cardrate_vari.value != "") {
                dis_vari.value = (parseFloat(cardrate_vari.value) - parseFloat(agreedrate_vari.value)).toFixed(2);
                discpre_vari.value = (parseFloat(dis_vari.value) * 100 / parseFloat(cardrate_vari.value)).toFixed(2);
            }
        }

    }

}



function date_frmt_orcl(dateformat, value1) {
    var dd = "";
    var mm = "";
    var yy = "";
    var newdate = "";
    if (dateformat == "dd/mm/yyyy") {
        var arrvalue1 = value1.split('/');
        dd = arrvalue1[0];
        mm = arrvalue1[1];
        yy = arrvalue1[2];
    }
    else if (dateformat == "mm/dd/yyyy") {
        var arrvalue1 = value1.split('/');
        dd = arrvalue1[1];
        mm = arrvalue1[0];
        yy = arrvalue1[2];
    }
    else if (dateformat == "yyyy/mm/dd") {
        var arrvalue1 = value1.split('/');
        dd = arrvalue1[2];
        mm = arrvalue1[1];
        yy = arrvalue1[0];
    }

    if (document.getElementById('hiddenconnect').value == "orcl") {
        mm = getmonthstr(mm);
        newdate = dd + "-" + mm + "-" + yy;
    }
    else {
        newdate = yy + "-" + mm + "-" + dd;
    }
    return newdate;

}

function getmonthstr(m_value) {
    var month = "";
    switch (m_value) {
        case "1":
            month = "JAN";
            break;

        case "2":
            month = "FEB";
            break;

        case "3":
            month = "MAR";
            break;

        case "4":
            month = "APR";
            break;

        case "5":
            month = "MAY";
            break;

        case "6":
            month = "JUN";
            break;

        case "7":
            month = "JUL";
            break;

        case "8":
            month = "AUG";
            break;

        case "9":
            month = "SEP";
            break;

        case "10":
            month = "OCT";
            break;

        case "11":
            month = "NOV";
            break;

        case "12":
            month = "DEC";
            break;

        //////////////// 

        case "01":
            month = "JAN";
            break;

        case "02":
            month = "FEB";
            break;

        case "03":
            month = "MAR";
            break;

        case "04":
            month = "APR";
            break;

        case "05":
            month = "MAY";
            break;

        case "06":
            month = "JUN";
            break;

        case "07":
            month = "JUL";
            break;

        case "08":
            month = "AUG";
            break;

        case "09":
            month = "SEP";
            break;
    }

    return month;
}





function notchar2Area() {
    if (document.getElementById('hiddenuomdesc').value == "ROL" && event.keyCode == 46)
        return false;
    insert = document.getElementById('txtinsertion').value;
    if ((event.keyCode >= 48 && event.keyCode <= 57) || (event.keyCode == 127) || (event.keyCode == 8) || (event.keyCode == 9) || (event.keyCode == 46)) {
        return true;
    }
    else {
        return false;
    }
}



// Removes ending whitespaces
function RTrim(value) {

    var re = /((\s*\S+)*)\s*/;
    return value.replace(re, "document.getElementById1");

}

// Removes leading and ending whitespaces
function trim(value) {

    return LTrim(RTrim(value));

}



function LTrim(value) {

    var re = /\s*((\S+\s*)*)/;
    return value.replace(re, "document.getElementById1");

}



function getsplcharge() {
    if (document.getElementById('txtextracharges').value != "") {
        var billamt = 0;
        var grossamtTotal = 0;
        var grossamt_var = document.getElementById('txtgrossamt');
        var br_spcharge = 0;
        var splcharges = document.getElementById('txtextracharges').value;
        var grossAmt = grossamt_var.value;
        var len = "bookdiv";
        var ratio = 0;
        var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
        for (var s = 0; s < count; s++) {
            var gross_var = document.getElementById('gro' + s);
            var bill_var = document.getElementById('ba' + s);
            var insertsta = document.getElementById("inssta" + s);
            if (gross_var != null) {
                if (s == count - 1) {

                    if (insertsta.value != "billed")
                        gross_var.value = (parseFloat(gross_var.value) + (parseFloat(splcharges) - parseFloat(br_spcharge))).toFixed(4);
                    // bill_var.value = (parseFloat(bill_var.value) + (parseFloat(splcharges)-parseFloat(br_spcharge))).toFixed(2);
                    // trade disc
                    var tradisc = document.getElementById('txttradedisc').value;
                    if (document.getElementById('chktrade').checked == false)
                        tradisc = 0;
                    if (tradisc == "")
                        tradisc = 0;
                    var trdisc1 = tradisc;
                    var addcomm = 0;
                    if (document.getElementById('txtaddagencycommrate') != null) {
                        if (document.getElementById('hiddenagcommflag').value != "1")
                            addcomm = document.getElementById('txtaddagencycommrate').value;
                    }
                    if (addcomm == "") {
                        addcomm = "0";
                    }
                    if (addcomm != "0") {
                        trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                    }

                    if (insertsta.value != "billed" && document.getElementById('hidspltd').value == "Y")
                        bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);
                    else {
                        if (insertsta.value != "billed") {
                            bill_var.value = (parseFloat(bill_var.value) + (parseFloat(splcharges) - parseFloat(br_spcharge))).toFixed(2);
                        }
                    }
                    if (parseFloat(gross_var.value) < 0) {
                        if (document.getElementById('gro0') != null && document.getElementById('gro0').value != "") {
                            if (insertsta.value != "billed")
                                document.getElementById('gro0').value = (parseFloat(document.getElementById('gro0').value) + parseFloat(gross_var.value)).toFixed(4); ;
                        }
                        if (insertsta.value != "billed")
                            gross_var.value = 0;
                    }
                    if (document.getElementById('inssta' + s).value == "cancel" || document.getElementById('pai' + s).value == "N") {
                        if (insertsta.value != "billed")
                            gross_var.value = 0;
                    }
                    if (parseFloat(bill_var.value) < 0) {
                        if (document.getElementById('ba0') != null && document.getElementById('ba0').value != "") {
                            if (document.getElementById('inssta0').value != "billed")
                                document.getElementById('ba0').value = (parseFloat(document.getElementById('ba0').value) + parseFloat(bill_var.value)).toFixed(2);
                        }
                        if (insertsta.value != "billed")
                            bill_var.value = 0;
                    }

                    if (document.getElementById('drpbooktype').value == "2" || document.getElementById('drpbooktype').value == "6" || document.getElementById('drpbooktype').value == "4" || document.getElementById('drpbooktype').value == "5" || document.getElementById('inssta' + s).value == "cancel" || document.getElementById('pai' + s).value == "N") {
                        if (insertsta.value != "billed")
                            bill_var.value = 0;
                    }
                    billamt = parseFloat(billamt) + parseFloat(bill_var.value);
                    billamt = parseFloat(billamt).toFixed(2)
                    grossamtTotal = parseFloat(grossamtTotal) + parseFloat(gross_var.value);
                    grossamtTotal = parseFloat(grossamtTotal).toFixed(2)
                }
                else {
                    ratio = (parseFloat(gross_var.value) * parseFloat(splcharges)) / parseFloat(grossAmt)
                    if (insertsta.value != "billed")
                        gross_var.value = (parseFloat(gross_var.value) + parseFloat(ratio)).toFixed(4);
                    //  bill_var.value = (parseFloat(bill_var.value) + parseFloat(ratio)).toFixed(2);
                    // trade disc
                    var tradisc = document.getElementById('txttradedisc').value;
                    if (document.getElementById('chktrade').checked == false)
                        tradisc = 0;
                    if (tradisc == "")
                        tradisc = 0;
                    var trdisc1 = tradisc;
                    var addcomm = 0;
                    if (document.getElementById('txtaddagencycommrate') != null) {
                        if (document.getElementById('hiddenagcommflag').value != "1")
                            addcomm = document.getElementById('txtaddagencycommrate').value;
                    }
                    if (addcomm == "") {
                        addcomm = "0";
                    }
                    if (addcomm != "0") {
                        trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                    }
                    if (insertsta.value != "billed" && document.getElementById('hidspltd').value == "Y")
                        bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);
                    else {
                        if (insertsta.value != "billed") {
                            bill_var.value = (parseFloat(bill_var.value) + (parseFloat(ratio))).toFixed(2);
                        }
                    }
                    if (document.getElementById('inssta' + s).value == "cancel" || document.getElementById('pai' + s).value == "N") {
                        if (insertsta.value != "billed") {
                            gross_var.value = 0;
                            bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);
                        }
                    }
                    if (document.getElementById('drpbooktype').value == "2" || document.getElementById('drpbooktype').value == "6" || document.getElementById('drpbooktype').value == "4" || document.getElementById('drpbooktype').value == "5" || document.getElementById('inssta' + s).value == "cancel" || document.getElementById('pai' + s).value == "N") {
                        if (document.getElementById('inssta0').value != "billed")
                            bill_var.value = 0;
                    }
                    billamt = parseFloat(billamt) + parseFloat(bill_var.value);
                    billamt = parseFloat(billamt).toFixed(2);
                    grossamtTotal = parseFloat(grossamtTotal) + parseFloat(gross_var.value);
                    grossamtTotal = parseFloat(grossamtTotal).toFixed(2)
                    br_spcharge = (parseFloat(br_spcharge) + parseFloat(ratio)).toFixed(2);
                    //                if(splcharges!="" && splcharges!="0" && document.getElementById('inssta'+s).value=="cancel" && br_spcharge==0)
                    //               {
                    //                   var br_spcharge1 = parseFloat(splcharges)/parseFloat(count);
                    //                   splcharges=parseFloat(splcharges) - parseFloat(br_spcharge1);
                    //                }
                }
            }
        }
        grossamt_var.value = (parseFloat(grossamt_var.value) + parseFloat(splcharges)).toFixed(2);
        if (billamt != "" && billamt != "0")
            document.getElementById('txtbillamt').value = parseFloat(billamt).toFixed(2);
        if (grossamtTotal != "" && grossamtTotal != "0")
            document.getElementById('txtgrossamt').value = parseFloat(grossamtTotal).toFixed(2);
    }

}


function getRetainerCommAmt() {
    /* if(document.getElementById('txtcardamt').value!="" && document.getElementById('txttradedisc').value!="")
    {
    var caramt=document.getElementById('txtgrossamt').value;
    var tradisc=document.getElementById('txttradedisc').value;
    var trdisc1=tradisc;
    var addcomm =0;
    if(document.getElementById('txtaddagencycommrate')!=null)
    {
    addcomm=document.getElementById('txtaddagencycommrate').value;
    }
    if(addcomm=="")
    {
    addcomm="0";
    }
    if(addcomm!="0")
    {
    trdisc1=parseFloat(tradisc) + parseFloat(addcomm);
    }
    var tot=parseFloat(caramt)-parseFloat(caramt)*parseFloat(trdisc1)/100;
    document.getElementById('txtbillamt').value=tot.toFixed(2);
    } */
    if (document.getElementById('drpretainer').value == "" || document.getElementById('drpretainer').value == "0" || document.getElementById('txtRetainercomm').value == "") {
        document.getElementById('txtRetainercomm').value = "";
        document.getElementById('txtRetainercommamt').value = "";
    }
    if (document.getElementById('drpretainer').value != "" && document.getElementById('drpretainer').value != "0") {

        /* if(document.getElementById('txtRetainercomm').value!="" && document.getElementById('txtaddagencycommrate').value!="")
        {
        OriRetainerComm();
        var addcomm =0;
        if(document.getElementById('txtaddagencycommrate')!=null)
        {
        addcomm=document.getElementById('txtaddagencycommrate').value;
        }
        if(addcomm=="")
        addcomm=0;
        document.getElementById('txtRetainercomm').value=parseFloat(document.getElementById('txtRetainercomm').value) - parseFloat(addcomm);
        }*/
        document.getElementById('txtRetainercommamt').value = "";
        if (parseFloat(document.getElementById('txtRetainercomm').value) > parseFloat(document.getElementById('retcomm').value)) {
            alert("Retainer Commission can't be greater than " + document.getElementById('retcomm').value);
            document.getElementById('txtRetainercomm').value = document.getElementById('retcomm').value;

        }
        if (document.getElementById('retcommtype').value == "") {
            var retain_name = document.getElementById('drpretainer').value.split('(');
            var retain_code = retain_name[1].replace(')', '');
            var ds_ret = web_booking.getRetainerComm(retain_code, document.getElementById('hiddencompcode').value);

            if (ds_ret.value == null)
                return false;

            if (ds_ret.value.Tables[0].Rows.length > 0) {
                document.getElementById('retcommtype').value = ds_ret.value.Tables[0].Rows[0].Discount;
                document.getElementById('retcomm').value = ds_ret.value.Tables[0].Rows[0].retainercomm;
            }
        }
        if (document.getElementById('retcommtype').value == "Gross" && document.getElementById('txtgrossamt').value != "" && document.getElementById('txtRetainercomm').value != "" && document.getElementById('txtRetainercomm').value != null) {
            document.getElementById('txtRetainercommamt').value = (parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(document.getElementById('txtRetainercomm').value) / 100).toFixed(2);
        }
        else if (document.getElementById('retcommtype').value == "Net" && document.getElementById('txtbillamt').value != "" && document.getElementById('txtRetainercomm').value != "" && document.getElementById('txtRetainercomm').value != null) {
            document.getElementById('txtRetainercommamt').value = (parseFloat(document.getElementById('txtbillamt').value) * parseFloat(document.getElementById('txtRetainercomm').value) / 100).toFixed(2);
        }
        else {
            document.getElementById('txtRetainercommamt').value = "";
            document.getElementById('txtRetainercomm').value = "";
        }

    }
}


function addagencycommRate() {
    //      if(document.getElementById('txtgrossamt').value=='' &&document.getElementById('txtaddagencycommrateamt')!=null)
    //    {
    //        document.getElementById('txtaddagencycommrate').value="";
    //        document.getElementById('txtaddagencycommrateamt').value="";
    //    }

    if (document.getElementById('txtaddagencycommrateamt') != null && document.getElementById('txtaddagencycommrate').value != "" && document.getElementById('txtgrossamt').value != "") {
        var trdisc = document.getElementById('txttradedisc').value
        if (document.getElementById('chktrade').checked == false)
            trdisc = "0";
        if (trdisc == "")
            trdisc = 0;
        var trdisc1 = trdisc;
        var addcomm1 = 0;
        var agncomamnt = 0;
        if (document.getElementById('txtaddagencycommrate') != null) {
            if (document.getElementById('hiddenagcommflag').value != "1")
                addcomm1 = document.getElementById('txtaddagencycommrate').value;
        }
        if (addcomm1 == "") {
            addcomm1 = "0";
        }
        if (addcomm1 != "0") {
            trdisc1 = parseFloat(trdisc) + parseFloat(addcomm1);
        }
        var agcommamt = 0;
        var agcommamt1 = 0;
        if (document.getElementById('agncomm_seq_com').value != "S") {
            agcommamt = (parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(trdisc1) / 100);
            if (addcomm1 != "0" && addcomm1 != "") {
                agcommamt = (parseFloat(agcommamt) * parseFloat(addcomm1) / 100);
            }
        }
        else {
            agcommamt = parseFloat(document.getElementById('txtgrossamt').value) - (parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(trdisc) / 100);

            agcommamt1 = (parseFloat(agcommamt) * parseFloat(addcomm1) / 100);
            agcommamt = agcommamt1;

        }
        // var agcommamt=parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(document.getElementById('txtaddagencycommrate').value) /100;
        if (document.getElementById('txtaddagencycommrateamt') != null)
            document.getElementById('txtaddagencycommrateamt').value = agcommamt.toFixed(2);
    }


    if (document.getElementById('agncomm_seq_com').value != "S") {
        for (var j = 0; j < document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1; j++) {
            agncomamnt = (parseFloat(document.getElementById("gro" + j).value) * parseFloat(trdisc1) / 100);
            document.getElementById("agmn" + j).value = agncomamnt;
            agncomamnt = parseFloat(document.getElementById("gro" + j).value) - agncomamnt
            agncomamnt = (parseFloat(agncomamnt) * parseFloat(addcomm1) / 100);
            document.getElementById("adlag" + j).value = agncomamnt;
        }
    }
    else {

        for (var j = 0; j < document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1; j++) {
            agncomamnt = (parseFloat(document.getElementById("gro" + j).value) * parseFloat(trdisc) / 100);
            document.getElementById("agmn" + j).value = agncomamnt;
            agncomamnt = parseFloat(document.getElementById("gro" + j).value) - agncomamnt
            agncomamnt = (parseFloat(agncomamnt) * parseFloat(addcomm1) / 100);
            document.getElementById("adlag" + j).value = agncomamnt;

        }
    }

    //    var cashdisamnt = "";
    //    if ((document.getElementById('txtcashdiscount').value != "") && document.getElementById('txtcashdiscount').disabled != true) {
    //        for (var j = 0; j < document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1; j++) {
    //            //  agncomamnt = (parseFloat(document.getElementById("gro" + j).value) * parseFloat(trdisc) / 100);
    //            //   document.getElementById("spld" + j).value = ((parseFloat(document.getElementById('card' + i).value) / parseFloat(cardrate)) * 100).toFixed(2);
    //            cashdisamnt = (parseFloat(document.getElementById("gro" + j).value) * parseFloat(document.getElementById('txtcashdiscount').value) / 100);
    //            //   agncomamnt = parseFloat(document.getElementById("gro" + j).value) - agncomamnt
    //            //   agncomamnt = (parseFloat(agncomamnt) * parseFloat(addcomm1) / 100);
    //            document.getElementById("cashd" + j).value = cashdisamnt;
    //        }
    //    }

    if (document.getElementById('hiddenafency_retainer').value == "Y") {
        if (document.getElementById('drpretainer').value == "") {
            // document.getElementById('btnshgrid').focus();
            // document.getElementById('txtgrossamt').value='';
            return false;
        }
        else {
            //get retainer code *6Aug*
            if (document.getElementById('drpretainer').value == null || document.getElementById('drpretainer').value == "" || document.getElementById('drpretainer').value == "0") {
                // document.getElementById('btnshgrid').focus();  //*25Aug*
                //  document.getElementById('txtgrossamt').value='';
                return false;
            }
            else {
                var retain_name = document.getElementById('drpretainer').value.split('(');
                var retain_code = retain_name[1].replace(')', '');
            }
            //*6Aug*  var response = Booking_master.getRetainerComm(document.getElementById('drpretainer').value,document.getElementById('hiddencompcode').value);
            var response = Booking_master.getRetainerComm(retain_code, document.getElementById('hiddencompcode').value);
            if (response != null) {
                var ds = response.value;
                if (ds == null) {
                    // document.getElementById('txtgrossamt').value='';
                    return false;
                }
                if (ds.Tables[0].Rows.length > 0) {
                    if (ds.Tables[0].Rows[0].retainercomm == null) {
                        var retainercomm = 0;
                    }
                    else {
                        retainercomm = ds.Tables[0].Rows[0].retainercomm;
                    }
                    if (retainercomm != "0") {
                        if (parseInt(document.getElementById('txtaddagencycommrate').value) > parseInt(retainercomm)) {
                            alert("Agency Commission can't be greater than Retainer Commission.");
                            if (document.getElementById('txtaddagencycommrateamt') != null) {
                                document.getElementById('txtaddagencycommrateamt').value = "";
                                document.getElementById('txtaddagencycommrate').value = "";
                                document.getElementById('txtaddagencycommrate').focus();
                            }
                            return false;
                        }
                    }
                }
            }
        }
    }
    else {
        document.getElementById('btnshgrid').focus();
        return false;
    }


    // document.getElementById('txtgrossamt').value='';
    // return false;
}





function autogeneratedtempid() {

    // var res = web_booking.getBookingIdNo(document.getElementById('hiddencompcode').value, auto, no, document.getElementById('txtciobookid').value);
    var res = web_booking.gettempBookingIdNo(document.getElementById('hiddencompcode').value);
    var da = res.value;
    if (da == null) {
        alert(res.error.description);
        return false;
    }
    if (da.Tables[0].Rows.length > 0 && da.Tables[0].Rows[0].ID != "") {
        var ab = da.Tables[0].Rows[0].ID;
        var cou1 = parseInt(ab, 10);
        var countlen = cou1.toString().length;
        if (countlen == 1) {
            zeros = "0000000" + cou1;
        }
        else if (countlen == 2) {
            zeros = "000000" + cou1;
        }
        else if (countlen == 3) {
            zeros = "00000" + cou1;
        }
        else if (countlen == 4) {
            zeros = "0000" + cou1;
        }
        else if (countlen == 5) {
            zeros = "000" + cou1;
        }
        else if (countlen == 6) {
            zeros = "00" + cou1;
        }
        else if (countlen == 7) {
            zeros = "0" + cou1;
        }
        else if (countlen == 8) {
            zeros = "0" + cou1;
        }

        document.getElementById('txtciobookid').value = zeros;
    }

}


function checkValidation() {
    if (document.getElementById('drppaymenttype').value == "CA0" && document.getElementById('hiddensavemod').value == "01" && document.getElementById('txtbillamt').value != "" && document.getElementById('hiddenbillamt').value != "" && document.getElementById('drprostatus').value == "1") {
        if (parseFloat(document.getElementById('txtbillamt').value) < document.getElementById('hiddenbillamt').value && parseFloat(document.getElementById('txtbillamt').value) != 0) {
            alert("For Payment Type Cash, Billing Amount can't be less than previous Billing Amount");
            return false;
        }
    }

    if (sharepub == "" && document.getElementById('hidshareman').value == "Y") {
        var packagecode = '';
        var obj = document.getElementById('drppackagecopy');
        for (var x = 0; x < obj.options.length; x++) {

            var insertCount1 = 0;
            if (obj[x].value.indexOf('(') >= 0) {
                insertCount1 = obj[x].value.substring(obj[x].value.lastIndexOf('(') + 1, obj[x].value.length - 1);
                //  insertCount1=parseInt(insertCount1)-1;
            }
            for (x1 = 0; x1 < insertCount1; x1++) {
                if (packagecode == '')
                    packagecode = obj[x].value.substring(0, obj[x].value.lastIndexOf('@'));
                else
                    packagecode = packagecode + ',' + obj[x].value.substring(0, obj[x].value.lastIndexOf('@'));

            }


        }
        var respub = web_booking.getpubcount(document.getElementById('hiddencompcode').value, document.getElementById('txtinsertion').value, packagecode, document.getElementById('txtciobookid').value);
        var dspub = "";
        if (respub.error == null) {
            dspub = respub.value;
        }
        if (dspub.Tables.length > 0) {
            if (dspub.Tables[0].Rows.length > 1) {
                alert("Sharing Precentage is mandatory ");
                return false;
            }
        }
    }
    if (!confirm('Are you sure you want to Save Booking')) {
        return false;
    }
    var rescir = checkCirValidAgency();
 
    
//    if (rescir == false)
//        return false;
    var chmandat = "";
    var adsize1_vari = document.getElementById('txtadsize1');
    var adsize2_vari = document.getElementById('txtadsize2');
    ////////////////THIS IS THE XML CREATED TO MAKE THE MANDATORY FROM XML
    var drpag_vari = document.getElementById('drpagscode');
    var agency_vari = document.getElementById('txtagency');
    var rostatus_vari = document.getElementById('drprostatus');
    var rono_vari = document.getElementById('txtrono');
    var rodate_vari = document.getElementById('txtrodate')
    if (rostatusmain != "1" && document.getElementById('hiddensepcashier').value == "Y" && rostatus_vari.value == "1" && document.getElementById('drppaymenttype').value == "CA0") {
        alert("In Case of Seperate Cashier, Cash Booking Can't be Confirmed from there.");
        return false;
    }
    txtagencypaymode_vari = document.getElementById('txtagencypaymode');
    if (browser != "Microsoft Internet Explorer") {
        // loadXML('xml/bookingmaster.xml');
        /////////////////////////////////////////////////////
        chmandat = document.getElementById('lbagency').textContent;



        if (chmandat.indexOf('*') >= 0) {
            if (agency_vari.value == "") {
                alert("Please Fill The Agency Name");
                agency_vari.focus();
                return false;
            }
        }

        chmandat = document.getElementById('lbagescode').textContent;
        if (chmandat.indexOf('*') >= 0) {
            if (drpag_vari.value == "" || drpag_vari.value == "0") {
                alert("Please Fill Agency Sub Code");
                drpag_vari.focus();
                return false;
            }
        }
        chmandat = document.getElementById('lblmobile').textContent;
        if (chmandat.indexOf('*') >= 0) {
            if (document.getElementById('txtmobile').value == "") {
                alert("Please Fill Mobile No ");
                if (document.getElementById('txtmobile').disabled == false)
                    document.getElementById('txtmobile').focus();
                return false;
            }
        }
        if (txtagencypaymode_vari.value == "0" || txtagencypaymode_vari.value == "") {
            alert("Please Enter Agency PayMode");
            return false;
        }
        chmandat = document.getElementById('lbclient').textContent;
        if (chmandat.indexOf('*') >= 0) {
            if (document.getElementById('txtclient').value == "" || document.getElementById('txtclient').value == "0") {
                alert("Please Enter Client");
                document.getElementById('txtclient').focus();
                return false;
            }
        }
        chmandat = rostatus_vari.textContent;
        if (chmandat.indexOf('*') >= 0) {
            if (rostatus_vari.value == "0") {
                alert("Please Fill ro status");
                rostatus_vari.focus();
                return false;
            }
        }
    }
    else {
        var xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
        // loadXML('xml/bookingmaster.xml');
        /////////////////////////////////////////////////////
        chmandat = document.getElementById('lbagency').innerText;
        if (chmandat.indexOf('*') >= 0) {
            if (agency_vari.value == "") {
                alert("Please Fill The Agency Name");
                agency_vari.focus();
                return false;
            }
        }
        chmandat = document.getElementById('lbagescode').innerText;
        if (chmandat.indexOf('*') >= 0) {
            if (drpag_vari.value == "" || drpag_vari.value == "0") {
                alert("Please Fill Agency Sub Code");
                drpag_vari.focus();
                return false;
            }
        }
        chmandat = document.getElementById('lbclient').innerText;
        if (chmandat.indexOf('*') >= 0) {
            if (document.getElementById('txtclient').value == "" || document.getElementById('txtclient').value == "0") {
                alert("Please Enter Client");
                document.getElementById('txtclient').focus();
                return false;
            }
        }

//        chmandat = document.getElementById('lbmobileno').innerText;
//        if (chmandat.indexOf('*') >= 0) {
            if (document.getElementById('txtmobile').value == "") {
                alert("Please Fill Mobile No ");
                if (document.getElementById('txtmobile').disabled == false)
                    document.getElementById('txtmobile').focus();
                return false;
            }
//        }
        chmandat = rostatus_vari.innerText;
        if (chmandat.indexOf('*') >= 0) {
            if (rostatus_vari.value == "0") {
                alert("Please Fill ro status");
                rostatus_vari.focus();
                return false;
            }
        }
    }
    if (rostatus_vari.value == "0") {
        alert("Please Enter Ro Status");
        return false;
    }
    if (document.getElementById('hiddenrostatus').value == "1" && rostatus_vari.value != '1')
        rostatus_vari.value = 2; //document.getElementById('hiddenrostatus').value;
    else {
        if (document.getElementById('drppaymenttype').value != "CA0")
            rostatus_vari.value = 1;
    }

    if (rostatus_vari.value == "1" && rono_vari.value == "" && document.getElementById('drppaymenttype').value != "CA0") {
        alert("Please fill RO No");
        rono_vari.focus();
        return false;
    }
    if (rostatus_vari.value == "1" && rodate_vari.value == "" && document.getElementById('drppaymenttype').value != "CA0") {
        alert("Please fill RO Date");
        rodate_vari.focus();
        return false;
    }
    if (rono_vari.value != "") {
        if (rodate_vari.value == "") {
            alert("Please fill RO date");
            rodate_vari.focus();
            return false;
        }
    }

    if (rodate_vari.value != "") {
        if (rono_vari.value == "") {
            alert("Please fill RO no");
            rono_vari.focus();
            return false;
        }
    }
    if (document.getElementById('drppaymenttype').value == "CA0" && document.getElementById('hiddensepcashier').value == "Y") {
        rostatus_vari.value = "2";
    }
    else if (document.getElementById('drppaymenttype').value == "CA0") {
        rostatus_vari.value = "1";
    }
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbececname').textContent;
    }
    else {
        chmandat = document.getElementById('lbececname').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtexecname').value == "" && (document.getElementById('drpretainer').value == "0" || document.getElementById('drpretainer').value == "")) {
            var a = "Executive name";
            var b = "Retainer";
            if (browser != "Microsoft Internet Explorer") {
                a = document.getElementById('lbececname').textContent.replace("*[F2]", "");
                b = document.getElementById('lblretainer').textContent.replace("*[F2]", "");
            }
            else {
                a = document.getElementById('lbececname').innerText.replace("*[F2]", "");
                b = document.getElementById('lblretainer').innerText.replace("*[F2]", "");
            }
            alert('Please Enter ' + a + ' or Select ' + b);
            document.getElementById('txtexecname').focus();
            return false;
        }
    }
    if (document.getElementById('txtexecname').value != "") {
        if (browser != "Microsoft Internet Explorer") {
            chmandat = document.getElementById('lbexeczone').textContent;
        }
        else {
            chmandat = document.getElementById('lbexeczone').innerText;
        }
        if (chmandat.indexOf('*') >= 0) {
            if (document.getElementById('txtexeczone').value == "") {
                alert('Please Enter ' + (chmandat.replace('*', "")));
                document.getElementById('txtexeczone').focus();
                return false;
            }
        }
    }
    if (document.getElementById('drpbooktype').value == "0") {
        alert("Please Select Booking Type");
        return false;
    }
    if ((document.getElementById('drpbooktype').value == "2" || document.getElementById('drpbooktype').value == "6") && fmgInsert == "") {
        alert("Please Enter FMG Booking against which Booking");
        return false;
    }


    if (document.getElementById('txtcategory').value == "") {
        alert("Please Select Ad Category");
        return false;
    }

    var adcategory = document.getElementById('hdncategory').value;
    if (adcategory != "") {
        var res = web_booking.getRegClientCheck(adcategory);
        if (res.value != null) {
            if (res.value == "Y") {
                if (document.getElementById('txtclient').value.lastIndexOf('(') < 0) {
                    alert("For Category " + document.getElementById('txtcategory').options[document.getElementById('txtcategory').selectedIndex].text + ", You can take only Registered Client");
                    document.getElementById('txtclient').focus();
                    return false;
                }
            }
        }
    }

//    if (chmandat.indexOf('*') >= 0) {
//        if ((document.getElementById('drpadsubcategory').value == "0" || document.getElementById('drpadsubcategory').value == "") && document.getElementById('drpadsubcategory').options.length > 1) {
//            alert("Please Select The Ad Sub Cat");
//            //document.getElementById('drpadsubcategory').focus();
//            return false;
//        }
//    }

//    if (browser != "Microsoft Internet Explorer") {
//        chmandat = document.getElementById('lbproduct').textContent;
//    }
//    else {
//        chmandat = document.getElementById('lbproduct').innerText;
//    }
//    if (chmandat.indexOf('*') >= 0) {
//        if (document.getElementById('txtproduct').value == "") {
//            alert('Please Enter ' + (chmandat.replace('*', "")));
//            changediv();
//            document.getElementById('txtproduct').focus();
//            return false;
//        }
//    }

//    if (browser != "Microsoft Internet Explorer") {
//        chmandat = document.getElementById('lbbrand').textContent;
//    }
//    else {
//        chmandat = document.getElementById('lbbrand').innerText;
//    }
//    if (chmandat.indexOf('*') >= 0) {
//        if (document.getElementById('drpbrand').value == "0") {
//            alert('Please Enter ' + (chmandat.replace('*', "")));
//            changediv();
//            document.getElementById('drpbrand').focus();
//            return false;
//        }
//    }
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('Label2').textContent;
    }
    else {
        chmandat = document.getElementById('Label2').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drpuom').value == "0") {
            alert('Please Enter Uom');
            document.getElementById('divpopup').style.display = "block";
            //document.getElementById('hidehref').innerHTML = "Hide";

            document.getElementById('drpuom').focus();
            return false;
        }

    }
    // for Caption  in ad details tab  
//    if (browser != "Microsoft Internet Explorer") {
//        chmandat = document.getElementById('lbcaption').textContent;
//    }
//    else {
//        chmandat = document.getElementById('lbcaption').innerText;
//    }
//    if (chmandat.indexOf('*') >= 0) {
//        if (document.getElementById('txtcaption').value == "") {
//            alert('Please Enter Caption');
//            //document.getElementById('txtcaption').focus();
//            return false;
//        }

//    }
    // for barter type in ad details tab
//    if (browser != "Microsoft Internet Explorer") {
//        chmandat = document.getElementById('lblbartertype').textContent;
//    }
//    else {
//        chmandat = document.getElementById('lblbartertype').innerText;
//    }
//    if (chmandat.indexOf('*') >= 0) {
//        if (document.getElementById('txtbartertype').value == "" && document.getElementById('drpbooktype').value == "1") {
//            alert('Please Enter ' + (chmandat.replace('*', "")));
//            document.getElementById('divpopup').style.display = "block";
//            document.getElementById('hidehref').innerHTML = "Hide";
//            changediv();
//            document.getElementById('txtbartertype').focus();
//            return false;
//        }
//    }
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbcurrency').textContent;
    }
    else {
        chmandat = document.getElementById('lbcurrency').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drpcurrency').value == "0" || document.getElementById('drpcurrency').value == "") {
            alert('Please Enter Currency');
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changepackage();
            document.getElementById('drpcurrency').focus();
            return false;
        }

    }
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbrptcurrency').textContent;
    }
    else {
        chmandat = document.getElementById('lbrptcurrency').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drprptcurrency').value == "0" || document.getElementById('drprptcurrency').value == "") {
            alert('Please Enter Receipt Currency');
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changepackage();
            document.getElementById('drprptcurrency').focus();
            return false;
        }

    }
    if (document.getElementById('chkadon').checked == true && document.getElementById('txtreference').value == "") {
        alert("Please Select Reference ID For Adon");
        return false;
    }
    if (document.getElementById('drppackagecopy').options.length == 0) {
        alert("Please Select Package");
        return false;
    }
    if (document.getElementById('txtdummydate').value == "") {
        alert("Please Enter Date");
        return false;
    }



    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbnoofins').textContent;
    }
    else {
        chmandat = document.getElementById('lbnoofins').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtinsertion').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changepackage();
            document.getElementById('txtinsertion').focus();
            return false;
        }

    }
//    if (browser != "Microsoft Internet Explorer") {
//        chmandat = document.getElementById('lbpagepost').textContent;
//    }
//    else {
//        chmandat = document.getElementById('lbpagepost').innerText;
//    }
//    if (chmandat.indexOf('*') >= 0) {
//        if (document.getElementById('drpposition').value == "0") {
//            alert('Please Enter Page Details');
//            document.getElementById('divpopup').style.display = "block";
//            document.getElementById('hidehref').innerHTML = "Hide";
//            //     changediv1();
//            document.getElementById('drpposition').focus();
//            return false;
//        }

//    }
/*anuj
    if (document.getElementById('hiddenuomdesc').value == "CD") {
        if (adsize1_vari.value == "") {
            alert('Please enter height');
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changediv1();
            adsize1_vari.focus();
            return false;
        }
        if (adsize1_vari.value != "") {
            if (adsize2_vari.value == "" && document.getElementById('txtcolum').value == "") {
                alert('Please enter width');
                document.getElementById('divpopup').style.display = "block";
                document.getElementById('hidehref').innerHTML = "Hide";
                changediv1();
                adsize1_vari.focus();
                return false;
            }
        }
    }
    else {
        if (document.getElementById('txttotalarea').value == "") {
            alert('Please Enter Number of lines');
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changediv1();
            //document.getElementById('txtadsize1').focus();
            return false;
        }
    }

    if (document.getElementById('chkDealerPanel').checked == true && (document.getElementById('txtadsize1dealer').value == "" || document.getElementById('txtadsize1dealer').value == "")) {
        alert('Please Enter Dealer Panel Height/Width');
        document.getElementById('divpopup').style.display = "block";
        document.getElementById('hidehref').innerHTML = "Hide";
        changediv1();
        //document.getElementById('txtadsize1').focus();
        return false;
    }
    if (document.getElementById('drpdealertype').value == "0" && document.getElementById('chkDealerPanel').checked == true) {
        alert('Please Select Dealer Type');
        document.getElementById('divpopup').style.display = "block";
        document.getElementById('hidehref').innerHTML = "Hide";
        changediv1();
        //document.getElementById('txtadsize1').focus();
        return false;
    }
    if (document.getElementById('txtadsize1').disabled == true) {
        if (document.getElementById('txttotalarea').value == "") {
            alert('Please Enter Number of lines');
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changediv1();
            adsize1_vari.focus();
            return false;
        }
    }
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbpageno').textContent;
    }
    else {
        chmandat = document.getElementById('lbpageno').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtpageno').value == "" || document.getElementById('txtpageno').value == "0") {
            alert("Page No. Can't be Blank or 0");
            if (document.getElementById('txtpageno').style.display != "")
                document.getElementById('txtpageno').focus();
            return false;
        }

    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbscheme').textContent;
    }
    else {
        chmandat = document.getElementById('lbscheme').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drpscheme').value == "0") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changedivrate();
            document.getElementById('drpscheme').focus();
            return false;
        }

    }
    if (document.getElementById('txtratecode').value == "0") {
        changedivrate();
        alert("Please Enter Rate Code");
        document.getElementById('txtratecode').focus();
        return false;
    }
    if (document.getElementById('txtgrossamt').value == "" || document.getElementById('txtgrossamtlocal').value == "") {
        changedivrate();
        alert("Please Enter Gross Amount");
        if (document.getElementById('txtgrossamt').disabled == false)
            document.getElementById('txtgrossamt').focus();
        return false;
    }









    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblcardamt').textContent;
    }
    else {
        chmandat = document.getElementById('lblcardamt').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtcardamt').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            //document.getElementById('drppackage').focus();
            return false;
        }

    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbagreed').textContent;
    }
    else {
        chmandat = document.getElementById('lbagreed').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtagreedrate').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changedivrate();
            document.getElementById('txtagreedrate').focus();
            return false;
        }

    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbagreamo').textContent;
    }
    else {
        chmandat = document.getElementById('lbagreamo').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtagreedamt').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changedivrate();
            document.getElementById('txtagreedamt').focus();
            return false;
        }

    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbldiscount').textContent;
    }
    else {
        chmandat = document.getElementById('lbldiscount').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtdiscount').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changedivrate();
            document.getElementById('txtdiscount').focus();
            return false;
        }

    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbldiscpre').textContent;
    }
    else {
        chmandat = document.getElementById('lbldiscpre').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtdiscpre').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changedivrate();
            document.getElementById('txtdiscpre').focus();
            return false;
        }

    }




    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblbillcycle').textContent;
    }
    else {
        chmandat = document.getElementById('lblbillcycle').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drpbillcycle').value == "0") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changebilldiv();
            document.getElementById('drpbillcycle').focus();
            return false;
        }

    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblrevenuecenter').textContent;
    }
    else {
        chmandat = document.getElementById('lblrevenuecenter').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drprevenue').value == "0") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            changebilldiv();
            document.getElementById('drprevenue').focus();
            return false;
        }

    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblpaymenttype').textContent;
    }
    else {
        chmandat = document.getElementById('lblpaymenttype').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drppaymenttype').value == "0" || document.getElementById('drppaymenttype').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            changebilldiv();
            document.getElementById('drppaymenttype').focus();
            return false;
        }


    }
    //-------------ad by rinki -------------//
    if (document.getElementById('drpcashrecieved').value != "" && (parseFloat(document.getElementById('drpcashrecieved').value) > parseFloat(document.getElementById('txtbillamt').value))) {
        alert('Cash Receieved Amount cannot be greater than Bill Amount.');
        return false;
    }
    //--------------------------------------//
    //check info
    if (document.getElementById('drppaymenttype').value == "CH0" || document.getElementById('drppaymenttype').value == "DD0" || document.getElementById('drppaymenttype').value == 'PO0' || document.getElementById('drppaymenttype').value == "AD0") {
        if (document.getElementById('ttextchqno').value == "" || document.getElementById('ttextchqdate').value == "" || document.getElementById('ttextchqamt').value == "" || document.getElementById('ttextbankname').value == "") {
            alert('Please fill all fields of Cheque/DD/PDC/ACR.');
            document.getElementById('ttextchqno').focus;
            return false;
        }
    }
    else if (document.getElementById('drppaymenttype').value == "CR0") {
        if (document.getElementById('txtcardname').value == "" || document.getElementById('drptype').value == "0" || document.getElementById('drpmonth').value == "0" || document.getElementById('drpyear').value == "0" || document.getElementById('txtcardno').value == "") {
            alert('Please fill all fields of Credit Card.');
            document.getElementById('txtcardname').focus;
            return false;
        }
    }
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbbillstatus').textContent;
    }
    else {
        chmandat = document.getElementById('lbbillstatus').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drpbillstatus').value == "0") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changebilldiv();
            document.getElementById('drpbillstatus').focus();
            return false;
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblbillsize').textContent;
    }
    else {
        chmandat = document.getElementById('lblbillsize').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtbillwidth').value == "" || document.getElementById('txtbillheight').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            changebilldiv();
            document.getElementById('txtbillwidth').focus();
            return false;
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblbillto').textContent;
    }
    else {
        chmandat = document.getElementById('lblbillto').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drpbillto').value == "0") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changebilldiv();
            document.getElementById('drpbillto').focus();
            return false;
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblinvoice').textContent;
    }
    else {
        chmandat = document.getElementById('lblinvoice').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtinvoice').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changebilldiv();
            document.getElementById('txtinvoice').focus();
            return false;
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblvts').textContent;
    }
    else {
        chmandat = document.getElementById('lblvts').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtvts').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changebilldiv();
            document.getElementById('txtvts').focus();
            return false;
        }
    }

    // for circulation agency in VTS TAB
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblciragency').textContent;
    }
    else {
        chmandat = document.getElementById('lblciragency').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtciragency').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changebilldiv();
            document.getElementById('txtciragency').focus();
            return false;
        }
    }
    // for circulation Rate in VTS TAB
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblcirrate').textContent;
    }
    else {
        chmandat = document.getElementById('lblcirrate').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtcirrate').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changebilldiv();
            document.getElementById('txtcirrate').focus();
            return false;
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblbilladdress').textContent;
    }
    else {
        chmandat = document.getElementById('lblbilladdress').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtbilladdress').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            changebilldiv();
            document.getElementById('txtbilladdress').focus();
            return false;
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbltradedisc').textContent;
    }
    else {
        chmandat = document.getElementById('lbltradedisc').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txttradedisc').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changebilldiv();
            document.getElementById('txttradedisc').focus();
            return false;
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbbillamt').textContent;
    }
    else {
        chmandat = document.getElementById('lbbillamt').innerText;
    }
    //  if(chmandat.indexOf('*')>= 0)
    // {
    if (document.getElementById('txtbillamt').value == "")// || document.getElementById('txtbillamt').value=="0")
    {
        alert('Please Enter ' + (chmandat.replace('*', "")));
        changebilldiv();
        //document.getElementById('drppackage').focus();
        return false;
    }
    // }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblagencyoutstand').textContent;
    }
    else {
        chmandat = document.getElementById('lblagencyoutstand').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtagencyoutstand').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            document.getElementById('divpopup').style.display = "block";
            document.getElementById('hidehref').innerHTML = "Hide";
            changebilldiv();
            document.getElementById('txtagencyoutstand').focus();
            return false;
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbboxcode').textContent;
    }
    else {
        chmandat = document.getElementById('lbboxcode').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drpboxcode').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            openboxpopup();
            document.getElementById('drpboxcode').focus();
            return false;
        }

    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbboxno').textContent;
    }
    else {
        chmandat = document.getElementById('lbboxno').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtboxno').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            openboxpopup();
            document.getElementById('txtboxno').focus();
            return false;
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbboxadd').textContent;
    }
    else {
        chmandat = document.getElementById('lbboxadd').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtboxaddress').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));
            openboxpopup();
            document.getElementById('txtboxaddress').focus();
            return false;
        }
    }
anuj 
*/


    ////////////////////////////this is to chk that agency code,agency sub code and ro no should be unique if they are not
    ////////than dont allow booking hiddensavemod
  /*  var res = chkmaincodeAgency("agency");
    if (res == false)
        return false;
    if (document.getElementById('drpretainer').value != "") {
        var res = chkmaincodeAgency("retainer");
        if (res == false)
            return false;
    }
    if (document.getElementById('txtexecname').value != "") {
        var res = chkmaincodeAgency("executive");
        if (res == false)
            return false;
    }
    if (document.getElementById('txtrono').value != "" && document.getElementById('hiddensavemod').value != "01") {
        var rono = document.getElementById('txtrono').value;
        var cioid = document.getElementById('txtciobookid').value;
        var agencycode = document.getElementById('hiddenagency').value;
        if (agencycode.indexOf("(".toString()) > 0) {
            agencycode = agencycode.substring(agencycode.lastIndexOf('(') + 1, agencycode.lastIndexOf(')'));
            agencycode = agencycode.replace(")", "");
        }
        var agencyscode = document.getElementById('hiddensubcode').value;
        var savemod = document.getElementById('hiddensavemod').value
        var compcode = document.getElementById('hiddencompcode').value
        var keyno = document.getElementById('txtkeyno').value;
        var val1 = "";
        if (browser != "Microsoft Internet Explorer") {
            var httpRequest = null; ;
            httpRequest = new XMLHttpRequest();
            if (httpRequest.overrideMimeType) {
                httpRequest.overrideMimeType('text/xml');
            }

            httpRequest.onreadystatechange = function() { alertContents(httpRequest) };

            httpRequest.open("GET", "chkuniqueforbook.aspx?keyno=" + keyno + "&rono=" + rono + "&cioid=" + cioid + "&agencycode=" + agencyscode + "&agencyscode=" + agencycode + "&savemod=" + savemod + "&compcode=" + compcode, false);
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) {
                    val1 = httpRequest.responseText;
                }
                else {
                    alert('There was a problem with the request.');
                }
            }
        }
        else {
            var xml = new ActiveXObject("Microsoft.XMLHTTP");
            xml.Open("GET", "chkuniqueforbook.aspx?keyno=" + keyno + "&rono=" + rono + "&cioid=" + cioid + "&agencycode=" + agencyscode + "&agencyscode=" + agencycode + "&savemod=" + savemod + "&compcode=" + compcode, false);
            xml.Send();
            val1 = xml.responseText;
        }
        if (val1 == "0") {
            alert("The Agency Code,Agency Sub Code and Ro no. should be unique");
            return false;
        }
        if (val1 == "1") {
            alert("The Agency Code,Agency Sub Code and Key No. is not unique");
            //  return false;
        }
    }

    if (document.getElementById('txtgrossamt').value == "" || document.getElementById('txtgrossamtlocal').value == "") {
        alert("Please get the original rate ");
        return false;
    }
    /////////////////////////this check is used to check from the main values that this pck exists or not


    var val = "";
    //////////////////////////////////////////////////////////////////////////////////////////////////////


    if (document.getElementById('tblinsert').innerHTML == "") {
        alert("Please Fill the grid");
        return false;
    }
    ////////////////this is to chk the mandatory field of grid whether they are selected or fill or not
    var len = "bookdiv";
    var id;
    var height;
    var width;
    var pagepost;
    var matsta;
    var insertsta;
    var editdate;
    var size;
    var pageno_inserts;
    var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
    savtotid = totid
    var y;

    y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    var cardid;
    var editid;
    //var y=document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    var i;
    var k = 0;
    var i = 0;
    var adsize1_vari = document.getElementById('txtadsize1');
    var adsize2_vari = document.getElementById('txtadsize2');
    var d1 = "";
    var d2;
    d2 = document.getElementById('txtdatetime').value;
    var dateformat = document.getElementById('hiddendateformat').value;
    if (dateformat == "dd/mm/yyyy") {
        if (d2 != "") {

            var txt = d2;
            var txt1 = txt.split("/");
            var dd = txt1[0];
            var mm1 = txt1[1];
            var mm = txt1[1]; //getMonthNo(mm1);
            var yy = txt1[2];
            d2 = mm + '/' + dd + '/' + yy;

        }
        else {
            d2 = d2;
        }

    }

    if (dateformat == "yyyy/mm/dd") {
        if (d2 != "") {
            var txt = d2;
            var txt1 = txt.split("/");
            var yy = txt1[0];
            var mm = txt1[1];
            var dd = txt1[2];
            d2 = mm + '/' + dd + '/' + yy;
        }
        else {
            d2 = d2;
        }
    }
    var maxdays_vari = document.getElementById('hiddenmaxdays').value;
    var chmandat = "";
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbpageno').textContent;
    }
    else {
        chmandat = document.getElementById('lbpageno').innerText;
    }
    for (k = 0; k < y - 1; k++) {

        id = document.getElementById("Text" + i);
        var par1 = (id.parentNode).parentNode;
        if (browser != "Microsoft Internet Explorer") {
            height = document.getElementById("hei" + i);
            width = document.getElementById("wid" + i);
            pageno_inserts = document.getElementById("pagno" + i);
            pagepost = document.getElementById("pgpre" + i); //"pagpos"+i;
            matsta = document.getElementById("mat" + i);
            insertsta = document.getElementById("inssta" + i);
            cardid = document.getElementById("card" + i);
            editid = document.getElementById("edit" + i);

            editdate = document.getElementById("Text" + i);
            size = document.getElementById("siz" + i);
            var adcat = document.getElementById("adcat" + i);
            var col = document.getElementById("col" + i);
            var vts = document.getElementById("vts" + i);
            var sectioncode = document.getElementById("seccode" + i);
            var resourceno = document.getElementById("resno" + i);
        }
        else {
            height = par1.all["hei" + i];
            pageno_inserts = par1.all["pagno" + i];
            width = par1.all["wid" + i];
            pagepost = par1.all["pgpre" + i]; //"pagpos"+i;
            matsta = par1.all["mat" + i];
            insertsta = par1.all["inssta" + i];
            cardid = par1.all["card" + i];
            editid = par1.all["edit" + i];
            editdate = par1.all["Text" + i];
            size = par1.all["siz" + i];
            var adcat = par1.all["adcat" + i];
            var col = par1.all["col" + i];
            var vts = par1.all["vts" + i];
            var sectioncode = par1.all["seccode" + i];
            var resourceno = par1.all["resno" + i];
        }

        if (id.value == "" && document.getElementById("hdnfollodate").value == "N") {
            alert("Please Fill the insertion date");
            id.focus();
            return false;
        }
        d1 = id.value;
        if (dateformat == "dd/mm/yyyy") {
            if (d1 != "") {

                var txt = d1;
                var txt1 = txt.split("/");
                var dd = txt1[0];
                var mm1 = txt1[1];
                var mm = txt1[1]; //getMonthNo(mm1);
                var yy = txt1[2];
                d1 = mm + '/' + dd + '/' + yy;

            }
            else {
                d1 = d1;
            }

        }

        if (dateformat == "yyyy/mm/dd") {
            if (d1 != "") {
                var txt = d1;
                var txt1 = txt.split("/");
                var yy = txt1[0];
                var mm = txt1[1];
                var dd = txt1[2];
                d1 = mm + '/' + dd + '/' + yy;
            }
            else {
                d1 = d1;
            }
        }
        if (d1 != "") {
            var days = days_between(d1, d2);
            if (days > parseInt(maxdays_vari) && maxdays_vari != "0") {
                alert("User can not take the publish date more than the " + maxdays_vari + " days from booking date");
                return false;
            }
        }
        else if (cardid.value == "") {
            alert("Please get the card rate");

            return false;

        }
        else if (insertsta.value == "" || insertsta.value == "0") {
            alert("Please select insertion status");
            insertsta.focus();
            return false;

        }

        else if (col.value == "" || col.value == "0") {
            alert("Please Enter Color");
            col.focus();
            return false;
        }
        else if (adcat != null && (adcat.value == "" || adcat.value == "0")) {
            alert("Please select Ad Category");
            adcat.focus();

            return false;
        }
        else if (height.value == "") {
            if (adsize1_vari.disabled == false) {
                alert("Please fill height into grid");
                height.focus();
                return false;
            }

        }
        else if (width.value == "") {
            if (adsize2_vari.disabled == false) {
                alert("Please fill width into grid");
                width.focus();
                return false;
            }
        }
        else if (size.value == "") {
            if (adsize2_vari.disabled == true) {
                alert("Please fill size into grid");
                width.focus();
                return false;
            }
        }
        if ((document.getElementById('drpbooktype').value == "2" || document.getElementById('drpbooktype').value == "6")) {
            if (fmgsize != size.value) {
                alert("Booking size shoould be same as  FMG Booking");
                //return false;
            }
            if (fmgcolor != col.value) {
                alert("Booking Color shoould be same as  FMG Booking");
                // return false;
            }
        }
        //                 else if(vts!=null && vts.value!="" && document.getElementById('txtciragency').value=="")
        //                {
        //                    alert("Please select Cir. Agency in VTS Tab");
        //                   // document.getElementById('txtciragency').focus();
        //                    
        //                    return false;
        //                }

        if (chmandat.indexOf('*') >= 0) {
            if (pageno_inserts.value == "" || pageno_inserts.value == "0") {
                alert("Please Enter PageNo in Grid");
                return false;
            }
        }
        if (sectioncode != null && (sectioncode.value == "" || sectioncode.value == "null")) {
            alert("Please Enter Section Code in Grid");
            return false;
        }
        if (resourceno != null && (resourceno.value == "" || resourceno.value == "null")) {
            alert("Please Enter Resource No in Grid");
            return false;
        }
        i = i + 1;
    }
    //*25Aug*
    if (txtagencypaymode_vari.value == "CA0" || txtagencypaymode_vari.value == "CH0" || txtagencypaymode_vari.value == "AD0" || (txtagencypaymode_vari.value == "CR1" && document.getElementById('creditreceipt_allow').value == "Y")) // for credit 
    {
        if (confirm("Do You Want To Print The Receipt")) {
            if (document.getElementById('txtclient').value == "") {
                alert("Please Fill the Client Name");
                document.getElementById('txtclient').focus();
                return false;
            }

            if (txtagencypaymode_vari.value == "") {
                alert("Please Agency pay mode.");
                return false;
            }
            if (txtagencypaymode_vari.selectedIndex != -1)
                document.getElementById('hiddenpaymode').value = txtagencypaymode_vari.options[txtagencypaymode_vari.selectedIndex].text;
            document.getElementById('hiddenprint_rec').value = "Y";
        }
        else {
            document.getElementById('hiddenprint_rec').value = "";
        }
    }

    if (document.getElementById('txtproduct').value != "" && document.getElementById('txtproduct').value.lastIndexOf('(') < 0) {
        alert("Please Select Product By F2");

        document.getElementById('txtproduct').value = "";
        return false;
    }
    document.getElementById('hiddenratecode').value = document.getElementById('txtratecode').value
    //***************
    var resn = checkBarterAmt();
    if (resn == false)
        return false;*/
    saveClick();
    return false;
}



function checkCirValidAgency() {
    if (document.getElementById('txtciragency').value != "") {
        if (document.getElementById('txtciragency').value.indexOf('(') < 0 || document.getElementById('txtciragency').value.indexOf(')') < 0 || document.getElementById('txtciragency').value.indexOf('+') < 0) {
            alert('Please Enter Valid Cir. Agency');
            document.getElementById('txtciragency').focus();
            return false;
        }
        else {
            var ciragency = document.getElementById('txtciragency').value;
            var ciragencysubcode = '';
            if (ciragency != "") {
                var myarrayex = ciragency.split('(');
                var agecirname = myarrayex[1].replace(")", "").split('+')[0];
                ciragency = trim(agecirname);
                ciragencysubcode = trim(myarrayex[1].replace(")", "").split('+')[1]);
            }
            var resagname = web_booking.getcirAgency(document.getElementById('hiddencompcode').value, document.getElementById('txtbranch').value, ciragency, ciragencysubcode)
            if (resagname.value == null) {
                alert(resagname.error.description);
                return false;
            }
            if (resagname.value.Tables.length < 0 || resagname.value.Tables[0].Rows.length < 0) {
                alert('Please Enter Valid Cir. Agency');
                document.getElementById('txtciragency').focus();
                return false;
            }
            else if (resagname.value.Tables[0].Rows[0].AGENCYNAME == null || resagname.value.Tables[0].Rows[0].AGENCYNAME == "null") {
                alert('Please Enter Valid Cir. Agency');
                document.getElementById('txtciragency').focus();
                return false;
            }
        }
    }
}



function disablelistbox() {
    document.getElementById("div1").style.display = "none"
    document.getElementById("divclient").style.display = "none"
   // document.getElementById("divproduct").style.display = "none"
    document.getElementById("divexec").style.display = "none"
    document.getElementById("divciragency").style.display = "none";
}



function getbuttoncheck(id) {
    if (id == "0" || id == "8") {
        document.getElementById('btnNew').disabled = false;
        document.getElementById('btnQuery').disabled = false;
        document.getElementById('btnCancel').disabled = false;
        document.getElementById('btnExit').disabled = false;
        document.getElementById('btnSave').disabled = false;
        document.getElementById('btnExecute').disabled = true;
        document.getElementById('btnfirst').disabled = true;
        document.getElementById('btnlast').disabled = true;
        document.getElementById('btnModify').disabled = true;
        document.getElementById('btnprevious').disabled = true;
        document.getElementById('btnnext').disabled = true;
        document.getElementById('btnDelete').disabled = true;
        setButtonImages();
    }
    if (id == "1" || id == "9") {
        document.getElementById("btnNew").disabled = false;
        document.getElementById("btnQuery").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnExit").disabled = false;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnExecute").disabled = true;

        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnModify").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

    }
    if (id == "2" || id == "10") {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnQuery").disabled = false;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnExit").disabled = false;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnModify").disabled = false;

        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnfirst").disabled = false;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;
        document.getElementById("btnExit").disabled = false;
    }
    if (id == "3" || id == "11") {
        document.getElementById("btnNew").disabled = false;
        document.getElementById("btnQuery").disabled = false;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnModify").disabled = true;
        document.getElementById("btnCancel").disabled = true;
        document.getElementById("btnExit").disabled = true;
        document.getElementById("btnDelete").disabled = true;


        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

    }
    if (id == "4" || id == "12") {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnQuery").disabled = false;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnExit").disabled = false;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;
        document.getElementById("btnExecute").disabled = true;

        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnExit").disabled = false;


        document.getElementById("btnModify").disabled = true;

        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

    }
    if (id == "5" || id == "13") {
        document.getElementById("btnNew").disabled = false;
        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnQuery").disabled = false;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnExit").disabled = false;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnModify").disabled = true;

    }
    if (id == "6" || id == "14") {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnQuery").disabled = false;
        document.getElementById("btnModify").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnExit").disabled = false;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;
        document.getElementById("btnExecute").disabled = true;
    }
    if (id == "7" || id == "15") {
        document.getElementById("btnNew").disabled = false;
        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnQuery").disabled = false;
        document.getElementById("btnModify").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnExit").disabled = false;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;
        document.getElementById("btnExecute").disabled = true;
    }
}



function chkstatus(FlagStatus) {
    if (FlagStatus == 0 || FlagStatus == 8) {
        document.getElementById('btnNew').disabled = true;
        document.getElementById('btnQuery').disabled = true;
        document.getElementById('btnDelete').disabled = true;
        document.getElementById('btnSave').disabled = true;
        document.getElementById('btnsavepaginate').disabled = true;
        document.getElementById('btnExecute').disabled = true;
        document.getElementById('btnCancel').disabled = true;
        document.getElementById('btnModify').disabled = true;

        document.getElementById('btnfirst').disabled = true;
        document.getElementById('btnnext').disabled = true;
        document.getElementById('btnprevious').disabled = true;
        document.getElementById('btnlast').disabled = true;
        document.getElementById('btnExit').disabled = true;
    }
    if (FlagStatus == 1 || FlagStatus == 9) {
        document.getElementById('btnNew').disabled = true;
        document.getElementById('btnQuery').disabled = true;
        document.getElementById('btnDelete').disabled = true;
        document.getElementById('btnExecute').disabled = true;
        document.getElementById('btnModify').disabled = true;
        document.getElementById('btnfirst').disabled = true;
        document.getElementById('btnnext').disabled = true;
        document.getElementById('btnprevious').disabled = true;
        document.getElementById('btnlast').disabled = true;
        document.getElementById('btnExit').disabled = false;
        document.getElementById('btnSave').disabled = false;
        document.getElementById('btnsavepaginate').disabled = false;
        document.getElementById('btnCancel').disabled = false;

    }
    if (FlagStatus == 2 || FlagStatus == 10) {
        document.getElementById('btnExecute').disabled = false;
        document.getElementById('btnQuery').disabled = false;
        document.getElementById('btnDelete').disabled = true;
        document.getElementById('btnNew').disabled = true;
        document.getElementById('btnCancel').disabled = false;
        document.getElementById('btnExecute').disabled = true;
        document.getElementById('btnModify').disabled = true;
        document.getElementById('btnExit').disabled = false;
        document.getElementById('btnSave').disabled = true;
        document.getElementById('btnsavepaginate').disabled = true;
        document.getElementById('btnfirst').disabled = true;
        document.getElementById('btnnext').disabled = true;
        document.getElementById('btnprevious').disabled = true;
        document.getElementById('btnlast').disabled = true;
    }

    if (FlagStatus == 3 || FlagStatus == 11) {
        document.getElementById('btnExecute').disabled = false;
        document.getElementById('btnQuery').disabled = true;
        document.getElementById('btnDelete').disabled = true;
        document.getElementById('btnNew').disabled = true;
        document.getElementById('btnCancel').disabled = false;
        document.getElementById('btnExecute').disabled = true;
        document.getElementById('btnModify').disabled = true;
        document.getElementById('btnExit').disabled = false;
        document.getElementById('btnSave').disabled = false;
        document.getElementById('btnsavepaginate').disabled = false;
        document.getElementById('btnfirst').disabled = true;
        document.getElementById('btnnext').disabled = true;
        document.getElementById('btnprevious').disabled = true;
        document.getElementById('btnlast').disabled = true;

    }

    if (FlagStatus == 4 || FlagStatus == 12) {
        document.getElementById('btnExecute').disabled = false;
        document.getElementById('btnQuery').disabled = true;
        document.getElementById('btnDelete').disabled = true;
        document.getElementById('btnNew').disabled = true;
        document.getElementById('btnCancel').disabled = false;
        document.getElementById('btnExecute').disabled = true;
        document.getElementById('btnModify').disabled = true;
        document.getElementById('btnExit').disabled = false;
        document.getElementById('btnSave').disabled = true;
        document.getElementById('btnsavepaginate').disabled = true;
        document.getElementById('btnfirst').disabled = true;
        document.getElementById('btnnext').disabled = true;
        document.getElementById('btnprevious').disabled = true;
        document.getElementById('btnlast').disabled = true;

    }
    if (FlagStatus == 5 || FlagStatus == 13) {
        document.getElementById('btnExecute').disabled = false;
        document.getElementById('btnQuery').disabled = true;
        document.getElementById('btnDelete').disabled = true;
        document.getElementById('btnNew').disabled = true;
        document.getElementById('btnCancel').disabled = false;
        document.getElementById('btnExecute').disabled = true;
        document.getElementById('btnModify').disabled = true;
        document.getElementById('btnExit').disabled = false;
        document.getElementById('btnSave').disabled = true;
        document.getElementById('btnsavepaginate').disabled = true;
        document.getElementById('btnfirst').disabled = true;
        document.getElementById('btnnext').disabled = true;
        document.getElementById('btnprevious').disabled = true;
        document.getElementById('btnlast').disabled = true;

    }
    if (FlagStatus == 6 || FlagStatus == 14) {
        document.getElementById('btnExecute').disabled = false;
        document.getElementById('btnQuery').disabled = true;
        document.getElementById('btnDelete').disabled = true;
        document.getElementById('btnNew').disabled = true;
        document.getElementById('btnCancel').disabled = false;
        document.getElementById('btnExecute').disabled = true;
        document.getElementById('btnModify').disabled = true;
        document.getElementById('btnExit').disabled = false;
        document.getElementById('btnSave').disabled = true;
        document.getElementById('btnsavepaginate').disabled = true;
        document.getElementById('btnfirst').disabled = true;
        document.getElementById('btnnext').disabled = true;
        document.getElementById('btnprevious').disabled = true;
        document.getElementById('btnlast').disabled = true;

    }
    if (FlagStatus == 7 || FlagStatus == 15) {
        document.getElementById('btnExecute').disabled = false;
        document.getElementById('btnQuery').disabled = true;
        document.getElementById('btnDelete').disabled = true;
        document.getElementById('btnNew').disabled = true;
        document.getElementById('btnCancel').disabled = false;
        document.getElementById('btnExecute').disabled = true;
        document.getElementById('btnModify').disabled = true;
        document.getElementById('btnExit').disabled = false;
        document.getElementById('btnSave').disabled = false;
        document.getElementById('btnsavepaginate').disabled = false;
        document.getElementById('btnfirst').disabled = true;
        document.getElementById('btnnext').disabled = true;
        document.getElementById('btnprevious').disabled = true;
        document.getElementById('btnlast').disabled = true;
    }

}


function bindBookType_Agency() {
    if (browser != "Microsoft Internet Explorer") {
        var c = 0;
        var obj = document.getElementById('drpbooktype');
        obj.options.length = 0;
        obj.options[0] = new Option("Select Booking Type", "0");
        //alert(xmlObj.childNodes[15].childNodes.length);
        for (c = 1; c <= xmlObj.childNodes[15].childNodes.length - 1; c = c + 4) {
            //   alert(xmlObj.childNodes[15].childNodes[c].childNodes[0].nodeValue);
            // alert(xmlObj.childNodes[15].childNodes[c+2].childNodes[0].nodeValue);
            obj.options[obj.options.length] = new Option(xmlObj.childNodes[15].childNodes[c].childNodes[0].nodeValue, xmlObj.childNodes[15].childNodes[c + 2].childNodes[0].nodeValue);
            //dbill=dbill+"<option value="+xmlObj.childNodes[15].childNodes[c].childNodes[0].nodeValue+">"+xmlObj.childNodes[15].childNodes[c+2].childNodes[0].nodeValue+"</option>";
        }
        if (obj.options.length > 1) {
            obj.options[1].selected = true;
        }

    }
    else {
        var c = 0;
        if (xmlObj.childNodes(1) == null) {
            loadXML('xml/billcycle.xml');
        }
        var obj = document.getElementById('drpbooktype');
        obj.options.length = 0;
        obj.options[0] = new Option("Select Booking Type", "0");

        for (c = 0; c <= xmlObj.childNodes(7).childNodes.length - 1; c++) {
            obj.options[obj.options.length] = new Option(xmlObj.childNodes(7).childNodes(c).text, xmlObj.childNodes(7).childNodes(c + 1).text);
            // dbill=dbill+"<option value="+xmlObj.childNodes(7).childNodes(c+1).text+">"+xmlObj.childNodes(1).childNodes(c).text+"</option>";
            c = c + 1;
        }
        if (obj.options.length > 1) {
            obj.options[1].selected = true;
        }
    }
}



function setButtonImages() {
    if (document.getElementById('btnNew').disabled == true)
        document.getElementById('btnNew').src = "btimages/new-off.jpg";
    else
        document.getElementById('btnNew').src = "btimages/new.jpg";

    if (document.getElementById('btnSave').disabled == true)
        document.getElementById('btnSave').src = "btimages/save-off.jpg";
    else
        document.getElementById('btnSave').src = "btimages/save.jpg";

    if (document.getElementById('btnModify').disabled == true)
        document.getElementById('btnModify').src = "btimages/modify-off.jpg";
    else
        document.getElementById('btnModify').src = "btimages/modify.jpg";

    if (document.getElementById('btnQuery').disabled == true)
        document.getElementById('btnQuery').src = "btimages/query-off.jpg";
    else
        document.getElementById('btnQuery').src = "btimages/query.jpg";

    if (document.getElementById('btnExecute').disabled == true)
        document.getElementById('btnExecute').src = "btimages/execute-off.jpg";
    else
        document.getElementById('btnExecute').src = "btimages/execute.jpg";

    if (document.getElementById('btnCancel').disabled == true)
        document.getElementById('btnCancel').src = "btimages/clear-off.jpg";
    else
        document.getElementById('btnCancel').src = "btimages/clear.jpg";

    if (document.getElementById('btnfirst').disabled == true)
        document.getElementById('btnfirst').src = "btimages/first-off.jpg";
    else
        document.getElementById('btnfirst').src = "btimages/first.jpg";

    if (document.getElementById('btnprevious').disabled == true)
        document.getElementById('btnprevious').src = "btimages/previous-off.jpg";
    else
        document.getElementById('btnprevious').src = "btimages/previous.jpg";

    if (document.getElementById('btnnext').disabled == true)
        document.getElementById('btnnext').src = "btimages/next-off.jpg";
    else
        document.getElementById('btnnext').src = "btimages/next.jpg";

    if (document.getElementById('btnlast').disabled == true)
        document.getElementById('btnlast').src = "btimages/last-off.jpg";
    else
        document.getElementById('btnlast').src = "btimages/last.jpg";

    if (document.getElementById('btnDelete').disabled == true)
        document.getElementById('btnDelete').src = "btimages/delete-off.jpg";
    else
        document.getElementById('btnDelete').src = "btimages/delete.jpg";

    if (document.getElementById('btnExit').disabled == true)
        document.getElementById('btnExit').src = "btimages/exit-off.jpg";
    else
        document.getElementById('btnExit').src = "btimages/exit.jpg";
}



function saveClick() {
    var msg = checkSession();
    if (msg == false) {
        window.location.href = "login.aspx";
        return false;
    }
    //dan
    var doctype = "";
    if (document.getElementById('drppaymenttype').value == 'CA0' || document.getElementById('drppaymenttype').value == 'CH0')
        doctype = "RCP";
    else if (document.getElementById('drppaymenttype').value == 'PO0')
        doctype = "PDC";
    else if (document.getElementById('drppaymenttype').value == 'AD0')
        doctype = "ACR";
////    if (document.getElementById('hiddenorigbranch').value != document.getElementById('txtbranch').value) {
////        alert("Booking Modification can't be done by diffrenet branch");
////        return false;
////    }
    var strtextd = "";
    var httpRequest = null;
    httpRequest = new XMLHttpRequest();
    if (httpRequest.overrideMimeType) {
        httpRequest.overrideMimeType('text/xml');
    }
    //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };

    httpRequest.open("GET", "checksessiondan.aspx", false);
    httpRequest.send('');
    //alert(httpRequest.readyState);
    if (httpRequest.readyState == 4) {
        //alert(httpRequest.status);
        if (httpRequest.status == 200) {
            strtextd = httpRequest.responseText;
        }
        else {
            //alert('There was a problem with the request.');
            if (browser != "Microsoft Internet Explorer") {
                //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
            }
        }
    }
    if (strtextd != "sess") {
        alert('session expired');
        window.location.href = "Default.aspx";
        return false;
    }

    var prev_cioid = "";
    var prev_receipt = "";
    var prev_ga = 0;
    var srtcancel = "0";
    var auditstatus = "";
    document.getElementById('hiddenclientname').value = document.getElementById('txtclient').value;
    // autogenerated("3");
    if ((document.getElementById('txtagencypaymode').value == "CA0" || document.getElementById('txtagencypaymode').value == "DD0" || document.getElementById('txtagencypaymode').value == "CH0") && document.getElementById('drprostatus').value == "1") {
        if (document.getElementById('hiddenprevamt').value != "" && document.getElementById('hiddenprevamt').value != null) {
            if (parseFloat(document.getElementById('hiddenprevamt').value) != parseFloat(document.getElementById('txtbillamt').value)) {

                if (parseFloat(document.getElementById('hiddenprevamt').value) > parseFloat(document.getElementById('txtbillamt').value)) {
                    doctype = "CA";
                }
                prev_cioid = document.getElementById('txtciobookid').value;
                prev_receipt = document.getElementById('txtreceipt').value;
                prev_receipt = document.getElementById('hiddenreceiptno').value;
                prev_ga = (parseFloat(document.getElementById('txtgrossamt').value) - parseFloat(document.getElementById('hiddenprevamt').value));
                document.getElementById('hiddensavemod').value = "0";
                //autogenerated("0");
                autogeneratedtempid();
                //  if(document.getElementById('hiddenprint_rec').value == "Y")
                if ((document.getElementById('txtagencypaymode').value == "CR1" && document.getElementById('creditreceipt_allow').value == "Y")) // for credit 
                    autogenerated("3");
                srtcancel = "1";
            }
        }

    }

    if (document.getElementById('hiddenaudit').value == "n") {
        if (document.getElementById('txtcardamt').value != document.getElementById('txtagreedamt').value)
            auditstatus = "Not Approved";
        else
            auditstatus = "Approved";
    }
    else {
        auditstatus = "Not Approved";
    }
    var VAT_CODE = document.getElementById('hdnvts').value;
   // var branch = document.getElementById('txtbranch').value;
    var booked_by = document.getElementById('txtbookedby').value;
    var prevbook = document.getElementById('txtprevbook').value;
    var res = web_booking.getdateCHK(document.getElementById('hiddendateformat').value, document.getElementById('txtdatetime').value);
    if (res.error != null) {
        alert(res.error.description);
        return false;
    }
    var date_time = document.getElementById('txtdatetime').value = res.value;
    var ciobookid = document.getElementById('txtciobookid').value;

    var approvedby = "";
    var audit = "";
    var rono = document.getElementById('txtrono').value;

    var rodate = "";
    if (document.getElementById('txtrodate').value != "") {
        res = null;
        res = web_booking.getdateCHK(document.getElementById('hiddendateformat').value, document.getElementById('txtrodate').value);
        if (res.error != null) {
            alert(res.error.description);
            return false;
        }
        rodate = document.getElementById('txtrodate').value = res.value;
    }
    rodate = document.getElementById('txtrodate').value;

    //var caption = document.getElementById('txtcaption').value;
    var billstatus = document.getElementById('drpbillstatus').value;
    var rostatus = document.getElementById('drprostatus').value;
    var agencycod = document.getElementById('txtagency').value;

    //////////////this is to split the  and get the code   
    //    var myarray = agencycod.split('(');
    //    var agencycode = myarray[1];
    //    agencycode = agencycode.replace(")", "");
    agencycode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.length + document.getElementById('txtagency').value.lastIndexOf('('));
    agencycode = agencycode.replace(")", "");
    document.getElementById('hiddenagency').value = agencycode;
    var clientcode = document.getElementById('txtclient').value;
    var client;

    ///this is to split and get the client code
    if (clientcode.indexOf("(".toString()) > 0) {
        var myarray1 = clientcode.split('(');
        client = myarray1[1];
        client = client.replace(")", '');

        /////this is to chk whether this code exixts in the database if exists than it is a register client else
        res = null;
        res = web_booking.chkwalkinClient(client, document.getElementById('hiddencompcode').value);
        var dcl = res.value;
        if (dcl == null) {
            alert(res.error.description);
            return false;
        }
        if (dcl.Tables[0].Rows.length > 0) {

        }
        else {
            client = clientcode;
        }
    }
    else {
        client = clientcode;
    }

    ///////////////////////////
    var agencyaddress = document.getElementById('txtagencyaddress').value;
    var clientaddresses = document.getElementById('txtclientadd').value;
    var agency = document.getElementById('drpagscode').value;
    agency = document.getElementById('hiddensubcode').value;
    var dockitno = document.getElementById('txtdockitno1').value;
    var execnamecode = document.getElementById('txtexecname').value;

    var execname = "";
    if (execnamecode != "") {
        execname = execnamecode.substring(execnamecode.lastIndexOf('(') + 1, execnamecode.length + execnamecode.lastIndexOf('('));
        execname = execname.replace(")", "");
        //         var myarrayex = execnamecode.split('(');
        //         execname = myarrayex[1];
        //         execname = execname.replace(")", "");
    }
    var execzone = document.getElementById('txtexeczone').value;
    // execzone = document.getElementById('hiddenzone').value;
    //var productcode = document.getElementById('txtproduct').value;
    var myarraypr;
    var product;
//    if (productcode != "") {
//        myarraypr = productcode.split('(');
//        product = myarraypr[1];
//        product = product.replace(")", "");
//    }
//    else {
//        product = "";
//    }

    //var brand = document.getElementById('drpbrand').value;
    // brand = document.getElementById('hiddenbrand').value;
    var keyno = document.getElementById('txtkeyno').value;
    var billremark = document.getElementById('txtbillremark').value;
    var printremark = document.getElementById('txtprintremark').value;
    var package = document.getElementById('hiddenpackage').value;
    var insertion = document.getElementById('txtinsertion').value;

    var startdate = "";
    if (document.getElementById('txtdummydate').value != "") {
        ////         res=null;
        ////         res=web_booking.getdateCHK(document.getElementById('hiddendateformat').value, document.getElementById('txtdummydate').value);
        ////         if(res.error!=null)
        ////         {
        ////            alert(res.error.description);
        ////            return false;
        ////         }
        ////         startdate = res.value;
        startdate = document.getElementById('txtdummydate').value;
    }
    else {
        startdate = "";
    }
    var repeatdate = document.getElementById('txtrepeatingdate').value;
    var adtype = "WE0";
    var clientcatdisc = document.getElementById('txtclientcatdisc').value;
    var clientcatamt = document.getElementById('txtclientcatam').value;
    var clientcatdistype = document.getElementById('hdnclientcatdistype').value;
    var flatfreqdisc = document.getElementById('txtflatfreqdisc').value;
    var flatfreqamt = document.getElementById('txtflatfreqamt').value;
    var flatfreqdisctype = document.getElementById('hdnflatfreqdisctype').value;
    var catdisc = document.getElementById('txtcatdisc').value;
    var catamt = document.getElementById('txtcatamt').value;
    var catdisctype = document.getElementById('hdncatdisctype').value; 
    var bookingtype = document.getElementById('drpbooktype').value;
    var adcategory = document.getElementById('hdncategory').value;
   // var subcategory = document.getElementById('drpadsubcategory').value;
    //var color = document.getElementById('drpcolor').value;
    var uom = document.getElementById('drpuom').value;
    var pageposition = document.getElementById('drpposition').value;
    //var pagetype = document.getElementById('drppagetype').value;
    //var pageno = document.getElementById('txtpageno').value;
    //var adsizheight = document.getElementById('txtadsize1').value;
    //var adsizwidth = document.getElementById('txtadsize2').value;
    var ratecode = document.getElementById('txtratecode').value;
    //    ratecode = document.getElementById('hiddenratecode').value;
    var scheme = document.getElementById('drpscheme').value;
    if (schemeid != "")
        scheme = schemeid;
    //    scheme = document.getElementById('hiddenscheme').value;
    var currency = document.getElementById('drpcurrency').value;
    var rcpt_currency = document.getElementById('drprptcurrency').value;
    var agreedrate = document.getElementById('txtagreedrate').value;
    var agreedamt = document.getElementById('txtagreedamt').value;
    var spedisc = "";
    var spacedisx = "";
    var adsizetype = "0";
    var specialcharges = document.getElementById('txtextracharges').value;
    //var agencytype = document.getElementById('txtagencytype').value;
    var agencystatus = document.getElementById('hiddenstatus').value;
    var paymode = document.getElementById('drppaymenttype').value;
    var agencredit = document.getElementById('txtcreditperiod').value;
    var cardrate = document.getElementById('txtcardrate').value;
    var cardamount = document.getElementById('txtcardamt').value;
    var discount = document.getElementById('txtdiscount').value;
    var discountper = document.getElementById('txtdiscpre').value;
    var billaddress = document.getElementById('txtbilladdress').value;
    var totarea = document.getElementById('txttotalarea').value;
    var billcycle = document.getElementById('drpbillcycle').value;
    var revenuecenter = document.getElementById('drprevenue').value;
    //var billpay = document.getElementById('hiddenbillpay').value;
    var billpay = document.getElementById('drppaymenttype').value;
    var billheight = document.getElementById('txtbillheight').value;
    var billwidth = document.getElementById('txtbillwidth').value;
    var billto = document.getElementById('drpbillto').value;
    // var billto = document.getElementById('hiddenbillto').value;
    var invoices = document.getElementById('txtinvoice').value;
    var vts = document.getElementById('txtvts').value;
    var ciragency = document.getElementById('txtciragency').value;
    var ciragencysubcode = '';
    if (ciragency != "") {
        var myarrayex = ciragency.split('(');
        var agecirname = myarrayex[1].replace(")", "").split('+')[0];
        ciragency = trim(agecirname);
        ciragencysubcode = trim(myarrayex[1].replace(")", "").split('+')[1]);
    }
    var cirrate = document.getElementById('txtcirrate').value;
    var ciredition = document.getElementById('hiddenciredi').value;
    var tradedisc = document.getElementById('txttradedisc').value;
    var agencyout = document.getElementById('txtagencyoutstand').value;
    var boxcode = document.getElementById('drpboxcode').value;
    var boxno = document.getElementById('txtboxno').value;
    var boxaddress = document.getElementById('txtboxaddress').value;
    var boxagency;
    var boxclient;
    var tfn;
    var coupan = "";
  //  var campaign = document.getElementById('txtcamp').value;
    /* if(document.getElementById('txtcardamt').value!="" && document.getElementById('txttradedisc').value!="")
    {
    var caramt=document.getElementById('txtgrossamt').value;
    var tradisc=document.getElementById('txttradedisc').value;
    if(tradisc=="")
    tradisc=0;
    var trdisc1=tradisc;
    var addcomm =0;
    if(document.getElementById('txtaddagencycommrate')!=null)
    {
    if(document.getElementById('hiddenagcommflag').value!="1")
    addcomm=document.getElementById('txtaddagencycommrate').value;
    }
    if(addcomm=="")
    {
    addcomm="0";
    }
    if(addcomm!="0")
    {
    trdisc1=parseInt(tradisc) + parseFloat(addcomm);
    }
    var tot=0;
    if(document.getElementById('agncomm_seq_com').value!="S")
    tot=parseFloat(caramt)-parseFloat(caramt)*parseFloat(trdisc1)/100;
    else
    {
    tot=parseFloat(caramt)-parseFloat(caramt)*parseFloat(tradisc)/100;
    if(addcomm!="0" && addcomm!="")
    {
    tot=parseFloat(tot)-parseFloat(tot)*parseFloat(addcomm)/100;
    } 
    }
    document.getElementById('txtbillamt').value=tot.toFixed(2);
    if(document.getElementById('drpbooktype').value=="2" || document.getElementById('drpbooktype').value=="4" || document.getElementById('drpbooktype').value=="5")  
    document.getElementById('txtbillamt').value = "0";
    bill_amt = document.getElementById('txtbillamt').value;
    }
    else
    {
    bill_amt = document.getElementById('txtbillamt').value;
    }  */
    //bill_amt = document.getElementById('txtbillamt').value;
    var pageprem = document.getElementById('drppageprem').value;
    var pageamt = document.getElementById('txtpageamt').value;
  //  var premper = document.getElementById('txtpremper').value;
    var grossamt = document.getElementById('txtgrossamt').value;
    //var adsizcolumn = document.getElementById('txtcolum').value;
    var billcolumn = "";
    var billarea;
    if (document.getElementById('txtbillwidth').value != "") {
        billarea = parseFloat(document.getElementById('txtbillwidth').value) * parseFloat(document.getElementById('txtbillheight').value);
    }
    else {
        billarea = 0;
    }

    var specdiscper = document.getElementById('txtspediscper').value;
    var spacediscper = document.getElementById('txtspadiscper').value;
    spedisc = document.getElementById('txtspedisc').value;
    spacedisx = document.getElementById('txtspacedisc').value;
    var paidins = document.getElementById('txtpaid').value;
    var dealrate = document.getElementById('txtdealrate').value;
    var deviation = document.getElementById('txtdeviation').value;
    var varient = "";
//    if (document.getElementById('drpvarient').options.length > 0) {
//        varient = document.getElementById('drpvarient').value;
//    }
    // var varient = document.getElementById('hiddenvar').value;

  //  var contractname = document.getElementById('txtcontractname').value;
    contractname = hidcontract;
    if (contractname == undefined)
        contractname = "";
    var dealtyp = document.getElementById('txtcontracttype').value;
  //  var cardname = document.getElementById('txtcardname').value;
   // var cardtype = document.getElementById('drptype').value;
    //var cardmonth = document.getElementById('drpmonth').value;
    //var cardyear = document.getElementById('drpyear').value;
   // var cardno = document.getElementById('txtcardno').value;
    var receiptno = document.getElementById('hiddenreceiptno').value;
    if (receiptno == "" && document.getElementById('txtreceipt').value != "")
        receiptno = document.getElementById('txtreceipt').value;
//    var caption = document.getElementById('txtcaption').value;
    var campaign = "";

   // var adscat3 = document.getElementById('drpadcat3').value;
    //  adscat3 = document.getElementById('hiddenadscat3').value;
    //var adscat4 = document.getElementById('drpadcat4').value;
    //  adscat4 = document.getElementById('hiddenadscat4').value;
    //var adscat5 = document.getElementById('drpadcat5').value;
    //  adscat5 = document.getElementById('hiddenadscat5').value;
    var bgcolor = "0";
    var bulletcode = "0";
    var bulletprm = "";
    //  bulletprm = document.getElementById('hiddenbullprem').value;
    //var material = document.getElementById('drpmatsta').value;
    if (document.getElementById('chkage').checked == true) {
        boxagency = "1";
    }
    else {
        boxagency = "0";
    }
    if (document.getElementById('chkclie').checked == true) {
        boxclient = "1";
    }
    else {
        boxclient = "0";
    }

    if (document.getElementById('chktfn').checked == true) {
        tfn = "1";
    }
    else {
        tfn = "0";
    }
    var billhold;
    if (document.getElementById('chkholdbill').checked == true) {
        billhold = "Y";
    }
    else {
        billhold = "N";
    }
//    //if (document.getElementById('chkcoupan').checked == true) {
//        coupan = "1";
//    }
//    else {
//        coupan = "0";
//    }
    var nchkno = "";
    var nchkdate = "";
    var nchkamt = "";
    var nchkbankname = "";
    var nourbank = "";
    //nchkno = document.getElementById('ttextchqno').value;
   // nchkdate = document.getElementById('ttextchqdate').value;
    //nchkamt = document.getElementById('ttextchqamt').value;
//nchkbankname = document.getElementById('ttextbankname').value;
  //  nourbank = document.getElementById('drpourbank').value;
//var clienttype = document.getElementById('drpregular').value;
 //   var translation = document.getElementById('drptranslation').value;
    //var translationcharge = document.getElementById('txttranslationcharges').value;
    var canclecharge;
    if (document.getElementById('chkcanclecharges').checked == true) {
        canclecharge = "1";
    }
    else {
        canclecharge = "0";
    }
    var retainer = document.getElementById('drpretainer').value;
    var addagencycommVar = 0;
    if (document.getElementById('txtaddagencycommrate') != null)
        addagencycommVar = document.getElementById('txtaddagencycommrate').value;
    if (document.getElementById('hiddensavemod').value == "0") {
        // if(document.getElementById('hiddenprint_rec').value == "Y")
        if (document.getElementById('txtagencypaymode').value == "CR1" && document.getElementById('creditreceipt_allow').value == "Y") // for credit 
            autogenerated("3");
        receiptno = document.getElementById('hiddenreceiptno').value;
        ciobookid = document.getElementById('txtciobookid').value;
        res = null;
        res = web_booking.bookidchk(document.getElementById('hiddencompcode').value, document.getElementById('txtciobookid').value, agency, agencycode, rono, "0", document.getElementById('txtkeyno').value);
        var dck = res.value;
        if (dck == null) {
            alert(res.error.description);
            return false;
        }
        if (dck.Tables[0].Rows.length >= 1) {
            message = "This Booking Id Has Been Assigned";
            alert(message);
            clearClick();
            return false;
        }
        if (document.getElementById('drprostatus').value == "2") {
            autogenerated("1");
            dockitno = document.getElementById('txtdockitno1').value;

        }
       /// document.getElementById('oldboxno').value = boxno;
//        if (boxno != null && boxno != "") {

//            var branchname1 = document.getElementById('hiddenbranch').value;
//            branchname1 = branchname1.substring(0, 2)
//            var branch1 = document.getElementById('drpboxcode').value;
//            if (branch1 != "0") {
//                var resb = web_booking.getboxnovalue(document.getElementById('hiddencompcode').value, branchname1, branch1, "S");
//            }
//            var dsb = resb.value;
//            if (dsb == null) {
//                alert(resb.error.description)
//                return false;
//            }
//            var count1 = "0";
//            var branchname12 = document.getElementById('hiddenbranch').value;
//            branchname12 = branchname12.substring(0, 2)
//            if (dsb.Tables[0].Rows.length > 0 && dsb.Tables[0].Rows[0].boxno != null && dsb.Tables[0].Rows[0].boxno != "") {
//                var boxval1 = dsb.Tables[0].Rows[0].boxno;
//                var cou = boxval1;
//                document.getElementById('txtboxno').value = cou;
//                if (document.getElementById('txtkeyno').value == "")
//                    document.getElementById('txtkeyno').value = document.getElementById('txtboxno').value;
//            }
//            else {
//                document.getElementById('txtboxno').value = branchname12 + count1;
//                if (document.getElementById('txtkeyno').value == "")
//                    document.getElementById('txtkeyno').value = document.getElementById('txtboxno').value;

//            }
//            if (boxno != document.getElementById('txtboxno').value) {
//                boxno = document.getElementById('txtboxno').value;
//                if (document.getElementById('txtkeyno').value == "")
//                    document.getElementById('txtkeyno').value = document.getElementById('txtboxno').value;
//            }

//        }
        //        if(rostatus=="0")
        //            rostatus="2";
        res = null;
        var subcategory = "";
        var color="B"
        res = web_booking.chkrategroup(color, adcategory, subcategory, package, ratecode, startdate, currency, "WE0", document.getElementById('hiddencompcode').value, agency, client, document.getElementById('hiddendateformat').value);
        var dgr = res.value;
        if (dgr == null) {
            alert(res.error.description);
            return false;
        }
        if (dgr.Tables[0].Rows.length > 0) {
            rategr = dgr.Tables[0].Rows[0].Rate_Gr_Code;
        }
        if (dgr.Tables[2].Rows.length > 0) {
            agencyrate = dgr.Tables[2].Rows[0].client;
        }
        if (dgr.Tables[1].Rows.length > 0) {
            clientrate = dgr.Tables[1].Rows[0].rate;
        }

        res = null;
        var txtaddagencycommrate = 0;
        if (document.getElementById('txtaddagencycommrate') != null) {
            txtaddagencycommrate = document.getElementById('txtaddagencycommrate').value;
        }

        var addlamt = "";
        var retamt = "";
        var retper = "";
        if (document.getElementById('txtaddagencycommrateamt') != null) {
            addlamt = document.getElementById('txtaddagencycommrateamt').value;
        }
        if (document.getElementById('txtRetainercommamt') != null) {
            retamt = document.getElementById('txtRetainercommamt').value;
        }
        if (document.getElementById('txtRetainercomm') != null) {
            retper = document.getElementById('txtRetainercomm').value;
        }
        var bartertype = "";
        var chktradeval = "1";
        if (document.getElementById('chktrade').checked == true)
            chktradeval = "1";
        else
            chktradeval = "0";
//        if (document.getElementById('txtbartertype').value != "" && document.getElementById('txtbartertype').value.indexOf('(') >= 0 && document.getElementById('txtbartertype').value.indexOf(')') >= 0)
//            bartertype = document.getElementById('txtbartertype').value.substring(document.getElementById('txtbartertype').value.indexOf('(') + 1, document.getElementById('txtbartertype').value.indexOf(')'));
        if (ciobookid == "") {
            alert("Booking Id can't be blank");
            return false;
        }
        var online_ad = "N";
        var dealerpanel = "";
//        if (document.getElementById('chkDealerPanel').checked == true)
//            dealerpanel = "Y";
//        else
//            dealerpanel = "N";
       // var dealerh = document.getElementById('txtadsize1dealer').value;
        //var dealerw = document.getElementById('txtadsize2dealer').value;
       // var dealertype = document.getElementById('drpdealertype').value;
        var mobno = document.getElementById('txtmobile').value;
        var grossamtlocal = document.getElementById('txtgrossamtlocal').value;
        var billamtlocal = document.getElementById('txtbillamtlocal').value;
        var revisedate = document.getElementById('txtrevisedate').value;
        var chk_adon = "0";
        var adon_refid = "";
        if (document.getElementById('chkadon').checked == true)
            chk_adon = "A";
        adon_refid = document.getElementById('txtreference').value;
        var branch = document.getElementById('hdnrevenue').value;
        var caption = "";
        var product = "";
      //  var pageposition = "";
        var pagetype = "";
        var pageno = "";
        var adsizheight = "";
        var premper = "";
        var adsizcolumn=""
        var cardname = "";
        var cardtype=""
        var cardmonth=""
        var cardyear=""
        var cardno = "";
        var adscat3 = "";
        var adscat4 = "";
        var adscat5 = "";
        var material = "";
        document.getElementById('hidattach1').value;
        document.getElementById('hidattach2').value;
        //document.getElementById('txtcashdiscount').value = "";
        var txtcashdiscount = "";
        // document.getElementById('drpdiscountprem').value = "";
        var drpdiscountpre = ""; 
        var fmgInsert = "";
        var dealerh = "";
        var dealerw = "";
        var dealertype;
        var dealertype;
        var billamtlocal = "";  //nan
        var clienttype = "";
        var translation = "";
        var translationcharge = "";
        var fmgreasons = "";
       var  brand="";
       var adsizwidth = "";
       var agencytype = "";

       var drpdiscountprem = "";
       var bill_amt = ""; //nan
       var coupantype = "";
       var coupanno = "";
       if (coupantype == "0" || coupantype == "")
           coupanno = "";
       //document.getElementById('drpcashrecieved').value
       var drpcashrecieved = "";
       var dealertype = "";
       res = web_booking.insertBooking(adsizetype, branch, booked_by, prevbook, date_time, ciobookid, approvedby, audit, rono, rodate, caption, billstatus, rostatus, agency, client, agencyaddress, clientaddresses, agencycode, dockitno, execname, execzone, product, brand, keyno, billremark, printremark, package, insertion, startdate, repeatdate, adtype, adcategory, subcategory, color, uom, pageposition, pagetype, pageno, adsizheight, adsizwidth, ratecode, scheme, currency, agreedrate, agreedamt, spedisc, spacedisx, document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value, specialcharges, agencytype, agencystatus, paymode, agencredit, cardrate, cardamount, discount, discountper, billaddress, totarea, billcycle, revenuecenter, billpay, billheight, billwidth, billto, invoices, vts, tradedisc, agencyout, boxcode, boxno, boxaddress, boxagency, boxclient, bookingtype, tfn, coupan, campaign, bill_amt, pageprem, pageamt, premper, grossamt, adsizcolumn, billcolumn, billarea, specdiscper, spacediscper, paidins, dealrate, deviation, varient, contractname, dealtyp, cardname, cardtype, cardmonth, cardyear, cardno, receiptno, adscat3, adscat4, adscat5, bgcolor, bulletcode, bulletprm, material, "", prev_cioid, prev_receipt, prev_ga, "0", "0", "0", "0", "0", "0", "0", document.getElementById('hiddendateformat').value, retainer, txtaddagencycommrate, srtcancel, auditstatus, addlamt, retamt, retper, drpcashrecieved, ciragency, cirrate, ciredition, document.getElementById('hiddencirpub').value, ciragencysubcode, bartertype, document.getElementById('hidattach1').value, document.getElementById('hidattach2').value, txtcashdiscount, document.getElementById('hiddencashrecieved').value, drpdiscountprem, doctype, chktradeval, sharepub, fmgInsert, nchkno, nchkdate, nchkamt, nchkbankname, nourbank, dealerpanel, dealerh, dealerw, dealertype, multicode, mobno, agreedrate_active, agreedamt_active, grossamtlocal, billamtlocal, chk_adon, adon_refid, rcpt_currency, document.getElementById('hidcurrency_convrate').value, revisedate, clienttype, translation, translationcharge, fmgreasons, canclecharge, document.getElementById('txttranslationdisc').value, document.getElementById('txtpospremdisc').value, billhold, online_ad, fixed_booking, VAT_CODE, coupantype, coupanno, clientcatdisc, clientcatamt, clientcatdistype, flatfreqdisc, flatfreqamt, flatfreqdisctype, catdisc, catamt, catdisctype);

        // if(res.error!=null)
        //   {
        //  alert(res.error.description);
        //  return false;
        // }
        if (res.value != "") {
            alert(res.value.toString());
            return false;
        }
        //----------------------- save cash received in child table---------------------------- //
        if (document.getElementById('drppaymenttype').value == 'CA0') {


        //    document.getElementById('drppaymenttype').value
            var res2 = web_booking.insertcashreceived(ciobookid, receiptno, "");
            if (res2.error != null) {
                alert(res2.error.description);
                return false;
            }
        }

        //save cheque/dd information

        if ((document.getElementById('drppaymenttype').value == 'CA0' && document.getElementById('hidcash').value == 'Y') || document.getElementById('drppaymenttype').value == 'CH0' || document.getElementById('drppaymenttype').value == 'DD0' || document.getElementById('drppaymenttype').value == 'PO0' || document.getElementById('drppaymenttype').value == 'AD0') {
            if (document.getElementById('drppaymenttype').value == 'CA0' && document.getElementById('hidcash').value == 'Y') {
                var ag_subcode = agencycode.split(agency)[1];
                var retainercode = "0";
                if (retainer.lastIndexOf("(") >= 0)
                    retainercode = retainer.substring(retainer.lastIndexOf("(") + 1, retainer.length - 1);
                //               var resRe=web_booking.getRepresenttaive(document.getElementById('hiddencompcode').value,execname,retainercode);      
                //               if(resRe.value==null)
                //               {
                //                alert(resRe.error.description);
                //                return false;
                //               }
                var repcode = "";
                //  if(resRe.value.Tables[0].Rows.length>0)
                //   repcode=resRe.value.Tables[0].Rows[0].REPRESENTATIVE;
                if (repcode == null || repcode == "0")
                    repcode = "";
                //    if(parseFloat(document.getElementById('txtbillamt').value)>0)
                //   {
                var billamt = document.getElementById('txtbillamt').value;
                var doctype = "RCP";
                if (document.getElementById('drppaymenttype').value == 'AD0')
                    doctype = "ACR";
                else if (document.getElementById('drppaymenttype').value == 'PO0')
                    doctype = "PDC";
                if (prev_cioid != "") {
                    var res = web_booking.getAmount(prev_cioid);

                    if (res.value != null) {
                        if (parseFloat(billamt) >= parseFloat(res.value)) {
                            billamt = parseFloat(billamt) - parseFloat(res.value);
                            doctype = "RCP"
                        }
                        else {
                            billamt = parseFloat(res.value) - parseFloat(billamt);
                            doctype = "CA"
                        }

                    }
                }
                //            var error=web_booking.Insert_rcpthdr(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,"","",billamt,"",agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,"","",repcode,doctype,document.getElementById('txtbranch').value,ciobookid,execname,retainer,prev_cioid); 
                //            if(error.value!="")
                //		    {
                //			    alert(error.value.toString());
                //			    return false;
                //		    }
                //web_booking.Insert_rcpthdr(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,"","",billamt,"",agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,"","",repcode,doctype,document.getElementById('txtbranch').value); 
                // web_booking.Insert_rcptdet(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,"","",billamt,"",agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,"",ciobookid,doctype,document.getElementById('txtbranch').value); 
                //  web_booking.Insert_outstand(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,"","",billamt,"",agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,doctype,document.getElementById('txtbranch').value); 
                // }
            }
          //  else if (document.getElementById('ttextchqno').value == "" || document.getElementById('ttextchqdate').value == "" || document.getElementById('ttextchqamt').value == "" || document.getElementById('ttextbankname').value == "")
           // { }
            else {
                var doctype = "RCR";
                var ag_subcode = agencycode.split(agency)[1];
                var retainercode = "0";
                if (retainer.lastIndexOf("(") >= 0)
                    retainercode = retainer.substring(retainer.indexOf("(") + 1, retainer.length - 1);
                //               var resRe=web_booking.getRepresenttaive(document.getElementById('hiddencompcode').value,execname,retainercode);      
                //               if(resRe.value==null)
                //               {
                //                alert(resRe.error.description);
                //                return false;
                //               }        
                var repcode = "";
                //  if(resRe.value.Tables[0].Rows.length>0)
                //  repcode=resRe.value.Tables[0].Rows[0].REPRESENTATIVE;
                if (repcode == null || repcode == "0")
                    repcode = "";
                //                     var error=web_booking.Insert_rcpthdr(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,document.getElementById('ttextchqno').value,document.getElementById('ttextchqdate').value,document.getElementById('ttextchqamt').value,document.getElementById('ttextbankname').value,agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,"",document.getElementById('drpourbank').value,repcode,doctype,document.getElementById('txtbranch').value,ciobookid,execname,retainer,prev_cioid); 
                //                      if(error.value!="")
                //		                {
                //			                alert(error.value.toString());
                //			                return false;
                //		                }
                // web_booking.Insert_rcpthdr(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,document.getElementById('ttextchqno').value,document.getElementById('ttextchqdate').value,document.getElementById('ttextchqamt').value,document.getElementById('ttextbankname').value,agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,"",document.getElementById('drpourbank').value,repcode,doctype,document.getElementById('txtbranch').value); 
                //web_booking.Insert_rcptdet(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,document.getElementById('ttextchqno').value,document.getElementById('ttextchqdate').value,document.getElementById('ttextchqamt').value,document.getElementById('ttextbankname').value,agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,"",ciobookid,doctype,document.getElementById('txtbranch').value); 
                // web_booking.Insert_outstand(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,document.getElementById('ttextchqno').value,document.getElementById('ttextchqdate').value,document.getElementById('ttextchqamt').value,document.getElementById('ttextbankname').value,agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,doctype,document.getElementById('txtbranch').value); 
            }
        }
        else if (document.getElementById('drppaymenttype').value == 'CR0') {
            var doctype = "RCR";
            if (document.getElementById('txtcardname').value != "" && document.getElementById('drptype').value != "0" && document.getElementById('drpmonth').value != "0" && document.getElementById('drpyear').value != "0" && document.getElementById('txtcardno').value != "") {
                var ag_subcode = agencycode.split(agency)[1];
                var cDate = ""
                if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                    cDate = "28" + "/" + document.getElementById('drpmonth').value + "/" + document.getElementById('drpyear').value;
                }
                if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                    cDate = document.getElementById('drpmonth').value + "/" + "28" + "/" + document.getElementById('drpyear').value;
                }
                if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
                    cDate = document.getElementById('drpyear').value + "/" + document.getElementById('drpmonth').value + "/" + "28";
                }
                //                     var retainercode="0";
                //            if(retainer.lastIndexOf("(")>=0)
                //            retainercode=retainer.substring(retainer.indexOf("(")+1,retainer.length-1);
                //                     var resRe=web_booking.getRepresenttaive(document.getElementById('hiddencompcode').value,execname,retainercode);      
                //                       if(resRe.value==null)
                //                       {
                //                        alert(resRe.error.description);
                //                        return false;
                //                       }
                var repcode = "";
                // if(resRe.value.Table[0].Rows.length>0)
                //  repcode=resRe.value.Tables[0].Rows[0].REPRESENTATIVE;
                if (repcode == null || repcode == "0")
                    repcode = "";
                //                            var error= web_booking.Insert_rcpthdr(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,document.getElementById('txtcardno').value,cDate,"0",document.getElementById('txtcardname').value,agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,document.getElementById('drptype').value,document.getElementById('drpourbank').value,repcode,doctype,document.getElementById('txtbranch').value,ciobookid,execname,retainer,prev_cioid); 
                //                             if(error.value!="")
                //		                    {
                //			                    alert(error.value.toString());
                //			                    return false;
                //		                    }
                //web_booking.Insert_rcpthdr(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,document.getElementById('txtcardno').value,cDate,"0",document.getElementById('txtcardname').value,agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,document.getElementById('drptype').value,document.getElementById('drpourbank').value,repcode,doctype,document.getElementById('txtbranch').value); 
                // web_booking.Insert_rcptdet(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,document.getElementById('txtcardno').value,cDate,"0",document.getElementById('txtcardname').value,agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,document.getElementById('drptype').value,ciobookid,doctype,document.getElementById('txtbranch').value); 
                // web_booking.Insert_outstand(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value,document.getElementById('hiddenreceiptno').value,date_time,document.getElementById('txtcardno').value,cDate,"0",document.getElementById('txtcardname').value,agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,document.getElementById('hiddendateformat').value,doctype,document.getElementById('txtbranch').value); 
            }
        }
        var resR = saveinsertion();

     
//        if (resR == false) {
//            return false;
//        }

        ////////////////////////////////////////////   
        /*  if(browser!="Microsoft Internet Explorer")
        {
        var  httpRequest =null;
        httpRequest= new XMLHttpRequest();
        if (httpRequest.overrideMimeType) 
        {
        httpRequest.overrideMimeType('text/xml'); 
        }
                
        httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
        var adcat=document.getElementById('txtcategory').value;
        httpRequest.open( "GET","saveImageBooking.aspx?cioid="+document.getElementById('txtciobookid').value, false );
        httpRequest.send('');
             
        if (httpRequest.readyState == 4) 
        {
        if (httpRequest.status == 200) 
        {
        strtext=httpRequest.responseText;
        }
        else 
        {
        alert('There was a problem with the request.');
        }
        }
        }
        else
        { 
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        var adcat=document.getElementById('txtcategory').value;
        xml.open( "GET","saveImageBooking.aspx?cioid="+document.getElementById('txtciobookid').value, false );
        xml.Send();               
        }*/
        ciobookid = document.getElementById('txtciobookid').value;
        document.getElementById('hiddencioid').value = ciobookid;
        document.getElementById('txtprevbook').value = ciobookid;
        if (document.activeElement.id == "btnsavepaginate") {
            if (document.getElementById('hiddenprint_rec').value == "Y") {
                printreceipt_display();
            }
            executeClick();
            Paginate();

        }
        else {
            if (document.getElementById('hiddenprint_rec').value == "Y") {
                printreceipt_display();
            }
            clearClick();
            document.getElementById('tblinsert').innerHTML = ''
        }
       // document.getElementById('hiddenboxno').value = "";
        //if (boxno == document.getElementById('oldboxno').value)
            message = "Data Saved Sucessfully with CIO Id " + ciobookid + "";
        //else
           // message = "Data Saved Sucessfully with CIO Id " + ciobookid + " and New Box No. is" + boxno + "";
        alert(message);
        document.getElementById('hiddencioid').value = ciobookid;
        document.getElementById('txtprevbook').value = ciobookid;

        getbuttoncheck(document.getElementById('hiddenbuttonidcheck').value);


    }
    else  //modify
    {
        //update check info
        // if(document.getElementById('hiddenprint_rec').value == "Y" && document.getElementById('txtreceipt').value=="")
        if (parseInt(document.getElementById('hiddenmodifyinsert').value) > parseInt(document.getElementById('txtinsertion').value)) {
            alert('You Cannot Decrease insertions(Please Cancel Booking..)!');
            document.getElementById('txtinsertion').focus();
            return false;
        }
        if ((document.getElementById('txtagencypaymode').value == "CR1" && document.getElementById('creditreceipt_allow').value == "Y") && document.getElementById('txtreceipt').value == "") // for credit 
            autogenerated("3");
        if (paymode == "CA0" && document.getElementById('hidcash').value == 'Y') {
            /*  var ag_subcode=agencycode.split(agency)[1];
            var retainercode="0";
            if(retainer.lastIndexOf("(")>=0)
            retainercode=retainer.substring(retainer.indexOf("(")+1,retainer.length-1);
            var resRe=web_booking.getRepresenttaive(document.getElementById('hiddencompcode').value,execname,retainercode);      
            if(resRe.value==null)
            {
            alert(resRe.error.description);
            return false;
            }
            var repcode="";
            if(resRe.value.Tables[0].Rows.length>0)
            repcode=resRe.value.Tables[0].Rows[0].REPRESENTATIVE;
            if(repcode==null || repcode=="0")
            repcode="";
            //    if(parseFloat(document.getElementById('txtbillamt').value)>0)
            //  {
          
           // web_booking.update_chqinfo(document.getElementById('hiddencompcode').value,receiptno,"","",document.getElementById('txtbillamt').value,"",agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,"RCP",date_time,document.getElementById('hiddendateformat').value,"","",repcode,document.getElementById('txtciobookid').value,document.getElementById('txtbranch').value);
            web_booking.update_chqinfo(document.getElementById('hiddencompcode').value,document.getElementById('txtreceipt').value,"","",document.getElementById('txtbillamt').value,"",agencycode,agency,ag_subcode,document.getElementById('drppaymenttype').value,"RCP",date_time,document.getElementById('hiddendateformat').value,"","",repcode,document.getElementById('txtciobookid').value,document.getElementById('txtbranch').value,execname,retainer,prev_cioid,document.getElementById('txtgrossamt').value);
            */
            //  }

        }
        else if (paymode == "CH0" || paymode == "DD0" || paymode == "PO0" || paymode == "AD0") {
            var ag_subcode = agencycode.split(agency)[1];
            var retainercode = "0";
            if (retainer.lastIndexOf("(") >= 0)
                retainercode = retainer.substring(retainer.indexOf("(") + 1, retainer.length - 1);
            var resRe = web_booking.getRepresenttaive(document.getElementById('hiddencompcode').value, execname, retainercode);
            if (resRe.value == null) {
                alert(resRe.error.description);
                return false;
            }
            var repcode = "";
            if (resRe.value.Tables[0].Rows.length > 0)
                repcode = resRe.value.Tables[0].Rows[0].REPRESENTATIVE;
            if (repcode == null || repcode == "0")
                repcode = "";
            web_booking.update_chqinfo(document.getElementById('hiddencompcode').value, receiptno, "", "", "", "", agencycode, agency, ag_subcode, document.getElementById('drppaymenttype').value, "RCR", date_time, document.getElementById('hiddendateformat').value, "", "", repcode, document.getElementById('txtciobookid').value, document.getElementById('hdnrevenue').value, execname, retainer, prev_cioid, document.getElementById('txtgrossamt').value);

        }
        else if (paymode == "CR0") {
            var ag_subcode = agencycode.split(agency)[1];
            var retainercode = "0";
            if (retainer.lastIndexOf("(") >= 0)
                retainercode = retainer.substring(retainer.indexOf("(") + 1, retainer.length - 1);
            var resRe = web_booking.getRepresenttaive(document.getElementById('hiddencompcode').value, execname, retainercode);
            if (resRe.value == null) {
                alert(resRe.error.description);
                return false;
            }
            var repcode = "";
            if (resRe.value.Tables[0].Rows.length > 0)
                repcode = resRe.value.Tables[0].Rows[0].REPRESENTATIVE;
            if (repcode == null || repcode == "0")
                repcode = "";
            var cDate = ""
            if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                cDate = "28" + "/" + document.getElementById('drpmonth').value + "/" + document.getElementById('drpyear').value;
            }
            if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                cDate = document.getElementById('drpmonth').value + "/" + "28" + "/" + document.getElementById('drpyear').value;
            }
            if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
                cDate = document.getElementById('drpyear').value + "/" + document.getElementById('drpmonth').value + "/" + "28";
            }
            web_booking.update_chqinfo(document.getElementById('hiddencompcode').value, receiptno, document.getElementById('txtcardno').value, cDate, "0", document.getElementById('txtcardname').value, agencycode, agency, ag_subcode, document.getElementById('drppaymenttype').value, "RCR", date_time, document.getElementById('hiddendateformat').value, document.getElementById('drptype').value, document.getElementById('drpourbank').value, repcode, document.getElementById('txtciobookid').value, document.getElementById('txtbranch').value, execname, retainer, prev_cioid, document.getElementById('txtgrossamt').value);

        }
        //**************

        //        if (document.getElementById('txtciobookid').value != "")
        //        {
        //            res=null;
        //            web_booking.InsertintoTemp(document.getElementById('txtciobookid').value,document.getElementById('hiddencompcode').value);          
        //            res=web_booking.deleteid(document.getElementById('txtciobookid').value,document.getElementById('hiddencompcode').value);          
        //        }
        res = null;
        var txtaddagencycommrate = 0;
        if (document.getElementById('txtaddagencycommrate') != null) {
            txtaddagencycommrate = document.getElementById('txtaddagencycommrate').value;
        }
        var addlamt = "";
        var retamt = "";
        if (document.getElementById('txtaddagencycommrateamt') != null) {
            addlamt = document.getElementById('txtaddagencycommrateamt').value;
        }
        if (document.getElementById('txtRetainercommamt') != null) {
            retamt = document.getElementById('txtRetainercommamt').value;
        }
        if (document.getElementById('txtRetainercomm') != null) {
            retper = document.getElementById('txtRetainercomm').value;
        }
        receiptno = document.getElementById('txtreceipt').value;
        var chktradeval = "1";
        if (document.getElementById('chktrade').checked == true)
            chktradeval = "1";
        else
            chktradeval = "0";
        var bartertype = "";
      //  if (document.getElementById('txtbartertype').value != "" && document.getElementById('txtbartertype').value.indexOf('(') >= 0 && document.getElementById('txtbartertype').value.indexOf(')') >= 0)
          //  bartertype = document.getElementById('txtbartertype').value.substring(document.getElementById('txtbartertype').value.indexOf('(') + 1, document.getElementById('txtbartertype').value.indexOf(')'));
        var dealerpanel = "";
//       // if (document.getElementById('chkDealerPanel').checked == true)
//            dealerpanel = "Y";
//        else
//            dealerpanel = "N";
      //  var dealerh = document.getElementById('txtadsize1dealer').value;
        //var dealerw = document.getElementById('txtadsize2dealer').value;
        //var dealertype = document.getElementById('drpdealertype').value;
        var mobno = document.getElementById('txtmobile').value;
        var grossamtlocal = document.getElementById('txtgrossamtlocal').value;
        var billamtlocal = document.getElementById('txtbillamtlocal').value;
        var chk_adon = "0";
        var adon_refid = "";
        if (document.getElementById('chkadon').checked == true)
            chk_adon = "A";
        adon_refid = document.getElementById('txtreference').value;
        var revisedate = document.getElementById('txtrevisedate').value;

     var  caption=""
     var product = "";
var brand = "";
var subcategory="";
var color="B";
var pageposition="";
var pagetype="";
var pageno="";
var adsizheight="";
var adsizwidth="";

var agencytype="";
var bill_amt="";
var premper="";
var adsizcolumn="";
var cardname="";
var cardtype="";
var cardmonth="";
var cardyear="";
var cardno="";
var adscat3="";
 var adscat4=""; var  adscat5="";
// document.getElementById('drpcashrecieved').value
//document.getElementById('txtcashdiscount').value
//document.getElementById('drpdiscountprem').value
var fmgInsert="";
var dealerh="";
var dealerw="";
var dealertype="";
var clienttype="";
var translation="";
var translationcharge="";
var fmgreasons = "";
var branch = document.getElementById('hdnrevenue').value;

var adcategory = document.getElementById('hdncategory').value     
        
        res = web_booking.updatebooking(adsizetype, branch, booked_by, prevbook, date_time, ciobookid, approvedby, audit, rono, rodate, caption, billstatus, rostatus, agency, client, agencyaddress, clientaddresses, agencycode, dockitno, execname, execzone, product, brand, keyno, billremark, printremark, package, insertion, startdate, repeatdate, adtype, adcategory, subcategory, color, uom, pageposition, pagetype, pageno, adsizheight, adsizwidth, ratecode, scheme, currency, agreedrate, agreedamt, spedisc, spacedisx, document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value, specialcharges, agencytype, agencystatus, paymode, agencredit, cardrate, cardamount, discount, discountper, billaddress, totarea, billcycle, revenuecenter, billpay, billheight, billwidth, billto, invoices, vts, tradedisc, agencyout, boxcode, boxno, boxaddress, boxagency, boxclient, bookingtype, tfn, coupan, campaign, bill_amt, pageprem, pageamt, premper, grossamt, adsizcolumn, billcolumn, billarea, specdiscper, spacediscper, paidins, dealrate, deviation, varient, contractname, dealtyp, cardname, cardtype, cardmonth, cardyear, cardno, receiptno, adscat3, adscat4, adscat5, bgcolor, bulletcode, bulletprm, "", "0", "0", "0", "0", "0", "0", "0", auditstatus, retainer, txtaddagencycommrate, document.getElementById('hiddendateformat').value, addlamt, retamt, retper,"", ciragency, cirrate, ciredition, document.getElementById('hiddencirpub').value, ciragencysubcode, bartertype, document.getElementById('hidattach1').value, document.getElementById('hidattach2').value, "", "", "", doctype, chktradeval, sharepub, fmgInsert, nchkno, nchkdate, nchkamt, nchkbankname, nourbank, dealerpanel, dealerh, dealerw, dealertype, multicode, mobno, agreedrate_active, agreedamt_active, grossamtlocal, billamtlocal, chk_adon, adon_refid, rcpt_currency, document.getElementById('hidcurrency_convrate').value, revisedate, clienttype, translation, translationcharge, fmgreasons, canclecharge, document.getElementById('txttranslationdisc').value, document.getElementById('txtpospremdisc').value, billhold);
        if (res.value == null) {
            alert(res.error.description);
            alert("Update Process is not completed successfully. Please Login again and then Modify");
            return false;
        }
     //---   updatecashreceived();
        web_booking.deletefromtemp(document.getElementById('txtciobookid').value, document.getElementById('hiddencompcode').value);
      //===(anuj)  getmodifygrid();

        var savename = "";
        /* if(browser!="Microsoft Internet Explorer")
        {
        var  httpRequest =null;
        httpRequest= new XMLHttpRequest();
        if (httpRequest.overrideMimeType) 
        {
        httpRequest.overrideMimeType('text/xml'); 
        }
            
        httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
        var adcat=document.getElementById('txtcategory').value;
        httpRequest.open( "GET","saveImageBooking.aspx?cioid="+document.getElementById('txtciobookid').value, false );
        httpRequest.send('');
         
        if (httpRequest.readyState == 4) 
        {
        if (httpRequest.status == 200) 
        {
        strtext=httpRequest.responseText;
        }
        else 
        {
        alert('There was a problem with the request.');
        }
        }
        }
        else
        { 
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        var adcat=document.getElementById('txtcategory').value;
        xml.open( "GET","saveImageBooking.aspx?cioid="+document.getElementById('txtciobookid').value, false );
        xml.Send();           
        }*/
        document.getElementById('hiddencioid').value = ciobookid;
        document.getElementById('hiddencalendar').value = "0";
        document.getElementById('txtciobookid').value = gciobookid;
        document.getElementById('txtdockitno1').value = gdockitno;
        document.getElementById('txtkeyno').value = gkeyno;
        document.getElementById('txtrono').value = grono;
       // document.getElementById('hiddenboxno').value = "";
        alert("Data Updated Successfully");
        //document.getElementById('Hdnmodbook').value="";
        if (document.getElementById('hiddenrateauditflag').value == "rateaudit") {
            window.close();
            return false;
        }
        if (document.getElementById('regclient').style.display != 'none')
            document.getElementById('regclient').style.display = 'none';

        if (document.getElementById('Hdnmodbook').value == "modify") {
            queryClick();
        }
        else {
            executeClick();
        }

        if (document.getElementById('hiddenprint_rec').value == "Y") {
            printreceipt_display();
        }

    }
    setButtonImages();
}


function autogenerated(no) {
    //Booking id
    if (no == "0") {
        var dt = new Date()
        var auto = "";
        var cen = document.getElementById('hiddencenter').value;
        cen = cen.substring(0, 3);
        var year = dt.getFullYear();
        var zeros = "";
        ////this to chk from the preferrences if from the preferrences it is  1 than generate id as center + year + 8 digit no.
        ////and if it is 2 than center + yrar + uid + 8 digit no.
        if (document.getElementById('hiddencioidformat').value == "1") {
            auto = cen + year;
        }
        else if (document.getElementById('hiddencioidformat').value == "2") {
            auto = cen + year + document.getElementById('hiddenuserid').value;
        }
        else if (document.getElementById('hiddencioidformat').value == "3") {
            auto = "";
        }
        else if (document.getElementById('hiddencioidformat').value == "4") {
            auto = "DI";
        }
        var autogen = auto + "0";
        var res = web_booking.getBookingIdNo(document.getElementById('hiddencompcode').value, auto, no, document.getElementById('txtciobookid').value);
        var da = res.value;
        if (da == null) {
            alert(res.error.description);
            return false;
        }
        if (da.Tables[0].Rows.length > 0 && da.Tables[0].Rows[0].ID != "") {
            var ab = da.Tables[0].Rows[0].ID;
            year = da.Tables[0].Rows[0].YEAR1;
            if (document.getElementById('hiddencioidformat').value == "1") {
                auto = cen + year;
            }
            else if (document.getElementById('hiddencioidformat').value == "2") {
                auto = cen + year + document.getElementById('hiddenuserid').value;
            }
            else if (document.getElementById('hiddencioidformat').value == "3") {
                auto = "";
            }
            else if (document.getElementById('hiddencioidformat').value == "4") {
                auto = "DI";
            }
            var cou1 = parseInt(ab, 10);
            var countlen = cou1.toString().length;
            if (countlen == 1) {
                zeros = "0000000" + cou1;
            }
            else if (countlen == 2) {
                zeros = "000000" + cou1;
            }
            else if (countlen == 3) {
                zeros = "00000" + cou1;
            }
            else if (countlen == 4) {
                zeros = "0000" + cou1;
            }
            else if (countlen == 5) {
                zeros = "000" + cou1;
            }
            else if (countlen == 6) {
                zeros = "00" + cou1;
            }
            else if (countlen == 7) {
                zeros = "0" + cou1;
            }
            else if (countlen == 8) {
                zeros = "0" + cou1;
            }

            document.getElementById('txtciobookid').value = auto + zeros;
        }
        else {
            document.getElementById('txtciobookid').value = autogen;

        }
    }
    //Dokit number
    else if (no == "1") {
        var auto = "DN";
        var autogen = auto + "0";
        var res = web_booking.getBookingIdNo(document.getElementById('hiddencompcode').value, auto, no, document.getElementById('txtciobookid').value);
        var da = res.value;
        if (da == null) {
            alert(res.error.description);
            return false;
        }
        if (da.Tables[0].Rows.length > 0 && da.Tables[0].Rows[0].ID != "") {
            var ab = da.Tables[0].Rows[0].ID;
            var cou1 = parseInt(ab, 10);
            //  cou1++;
            document.getElementById('txtdockitno1').value = auto + cou1;
        }
        else {
            document.getElementById('txtdockitno1').value = autogen;
        }

    }
    else if (no == "2") {
        var auto = "BN";
        var autogen = auto + "0";
        var res = web_booking.getBookingIdNo(document.getElementById('hiddencompcode').value, auto, no, document.getElementById('txtciobookid').value);
        var da = res.value;
        if (da == null) {
            alert(res.error.description);
            return false;
        }
        if (da.Tables[0].Rows.length > 0 && da.Tables[0].Rows[0].boxno != "" && da.Tables[0].Rows[0].boxno != undefined) {
            var ab = da.Tables[0].Rows[0].boxno;
            var cou1 = parseInt(ab, 10);
            cou1++;
            document.getElementById('txtboxno').value = auto + cou1;
            if (document.getElementById('txtkeyno').value == "")
                document.getElementById('txtkeyno').value = document.getElementById('txtboxno').value;
        }
        else {
            document.getElementById('txtboxno').value = autogen;
            if (document.getElementById('txtkeyno').value == "")
                document.getElementById('txtkeyno').value = document.getElementById('txtboxno').value;
        }


    }

    //get max receipt number 
    else if (no == "3") {
        document.getElementById('txtreceipt').value = "";
        document.getElementById('hiddenreceiptno').value = "";
        var res = web_booking.getBookingIdNo(document.getElementById('hiddencompcode').value, "", no, document.getElementById('txtciobookid').value);
        var da = res.value;
        //***************************************
        if (da == null) {
            alert(res.error.description);
            return false;
        }
        var max_number = "0";
        if (da.Tables[0].Rows[0].recno.toString().length == 1)
            max_number = "000" + da.Tables[0].Rows[0].recno;
        else if (da.Tables[0].Rows[0].recno.toString().length == 2)
            max_number = "00" + da.Tables[0].Rows[0].recno;
        else if (da.Tables[0].Rows[0].recno.toString().length == 3)
            max_number = "0" + da.Tables[0].Rows[0].recno;
        else
            max_number = da.Tables[0].Rows[0].recno;
        //for sambad only
        if (document.getElementById('hiddenprereceipt').value == "6") {

            document.getElementById('txtreceipt').value = "D-BHU-" + max_number;
            document.getElementById('hiddenreceiptno').value = document.getElementById('txtreceipt').value;
        }
        else //for sambad only    
        {
            if (document.getElementById('hiddenhidReceipt').value != "" && document.getElementById('txtbranch').value != "") {
                var arr = document.getElementById('txtbranch').value;
                var res = web_booking.getBAlias(document.getElementById('txtbranch').value, document.getElementById('hiddencompcode').value);
                if (res.value != null && res.value.Tables[0].Rows.length > 0) {
                    var str = res.value.Tables[0].Rows[0].ALIAS;
                    var str1 = document.getElementById('hiddenhidReceipt').value.substring(0, document.getElementById('hiddenhidReceipt').value.indexOf("/"));
                    document.getElementById('hiddenhidReceipt').value = document.getElementById('hiddenhidReceipt').value.replace(str1, str);
                }

            }
            if (document.getElementById('hiddenpaymode').value == "CASH") {
                document.getElementById('txtreceipt').value = "R/" + document.getElementById('hiddenhidReceipt').value + max_number;
                document.getElementById('hiddenreceiptno').value = document.getElementById('txtreceipt').value;
            }
            else {
                document.getElementById('txtreceipt').value = document.getElementById('hiddenhidReceipt').value + max_number;
                document.getElementById('hiddenreceiptno').value = document.getElementById('txtreceipt').value;
            }
        }
    }

}

function saveinsertion() {
    var premium11;
    var premium22;
    var len = "bookdiv";
    var insertno;
    var premid;
    var premper;
    var colid;
    var heightid;
    var widthid;
    var size;
    var late;
    //var uomid;
    //var adtypid;
    var cardid;
    var editid;
    var solorate;
    var premper1;
    var prem1id;
    var namecode;
    var inserts;
    var pagepost;
    var preall;
    var adcat;
    var adsubcat;
    var matsta;
    var filename;
    var discrate;
    var insertsta;
    var billstat;
    var id;
    var repeat;
    var i = 0;
    var paid;
    var discount_;
    var agrred;
    var solo;
    var gross;
    var insert = "0";
    var pageno_inserts;
    var remark_inserts;
    var caption_inserts;
    var agnamnt;
    var adlgn;
    var spldisc;
    var cashdisc;
    var roundoffval;
    var clicatamtval;
    var flatfreqamtval;
    var catamtval;
    var page;
    var pageprem;
    var noofcol;
    var billamt;
    var billrate;
    var insert_id;
    var insert_pageno;
    var sectioncode_val = "";
    var resourceno_val = "";
    var center = document.getElementById('hiddencenter').value;
   // var branch = document.getElementById('hiddenbranch').value;
    var dealerh;
    var dealerw;
    var compcode = document.getElementById('hiddencompcode').value;
    var userid = document.getElementById('hiddenuserid').value;
    var cioid = document.getElementById('txtciobookid').value;
    //var y=document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
    var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
    var k;
    var dateformat = document.getElementById('hiddendateformat').value;
    web_booking.insertionCount(cioid, y);
    for (k = 0; k < y; k++) {


        var spltdata = "spltdata" + i;
        var subedi = "subedidata" + i;
        premium11 = "prempe" + i;
        //  premium22 = "pagper" + i;

        premium22 = "posprem" + i;
        discount_ = "disc_" + i;
        insert_id = "sho" + i;
        id = "Text" + i;
        editid = "edit" + i;
////        premid = "prem" + i;
////        prem1id = "premone" + i;
        colid = "col" + i;
        heightid = "hei" + i;
        widthid = "wid" + i;
        size = "size" + i;
        pagepost = "pagpos" + i;
        namecode = "one";
        premper = "premper" + i;
        premper1 = "premperone" + i;
        //adtypid="adtyp"+i;
        namecode = "two";
        preall = "preall" + i;
        adcat = "adcat" + i;
        late = "lat" + i;
        matsta = "material" + i;
        cardid = "cardrate" + i;
        filename = "fil" + i;
        discrate = "disrat" + i;
        insertsta = "inssta" + i;
        billstat = "bill" + i;
        adsubcat = "ads" + i;
        repeat = "rep" + i;
        insertno = "ins" + i;
        paid = "pai" + i
        agrred = "agr" + i;
        solo = "sol" + i;
        gross = "grolocal" + i;
        pageno_inserts = "pagno" + i; ;
        remark_inserts = "rem" + i;
        caption_inserts = "caption" + i;
        page = "pageno" + i;
        pageprem = "pagper" + i;
        noofcol = "nocol" + i;
        billamt = "ba" + i;
        billrate = "br" + i;
        dealerh = "dealerh" + i;
        dealerw = "dealerw" + i;
        agnamnt = "agmn" + i;
        adlgn = "adlag" + i;
        spldisc = "spld" + i;
        cashdisc = "cashd" + i;
        roundoffval = "roundoffval" + i;
        clicatamtval = "clicatamt" + i;
        flatfreqamtval = "flatfreqamt" + i;
        catamtval = "catamt" + i;
        var splitdata = "";
        var subedidata = "";
        var sectioncode = "seccode" + i;
        var resourceno = "resno" + i;
        var edit_vari = document.getElementById(editid);
        var par1 = (edit_vari.parentNode).parentNode;
        if (browser != "Microsoft Internet Explorer") {
            if (document.getElementById(spltdata) != null) {
                splitdata = document.getElementById(spltdata).value;
            }
            if (document.getElementById(subedi) != null) {
                subedidata = document.getElementById(subedi).value;
            }
            if (document.getElementById(sectioncode) != null) {
                sectioncode_val = document.getElementById(sectioncode).value;
            }
            if (document.getElementById(resourceno) != null) {
                resourceno_val = document.getElementById(resourceno).value;
            }
            var insernum = document.getElementById(insertno).innerHTML;
            var insertdate = document.getElementById(id).value;
            var edition = document.getElementById(editid).value;
//            var premium1 = document.getElementById(premid).value;
//            var premium2 = ""; //document.getElementById(prem1id).value;
            //var height = document.getElementById(heightid).value;
           // var width = document.getElementById(widthid).value;
            var totalsize = document.getElementById(size).value;
        
            //var pagepost = document.getElementById(pagepost).value;
           // var color = document.getElementById(colid).value;
            var premper11 = '';
            if (document.getElementById(premper) != undefined)
                premper11 = document.getElementById(premper).value;
            var premper2 = ""; //document.getElementById(premper1).value;
           // var premallow = document.getElementById(preall).value;
            var adcategory = document.getElementById(adcat).value;
            var latestdate = document.getElementById(late).value;
            var material = document.getElementById(matsta).value;
            var cardrate = document.getElementById(cardid).value;
            var filename = document.getElementById(filename).value;
            var discrate = document.getElementById(discrate).value;
            var insertstatus = document.getElementById(insertsta).value;
           // var billstatus = document.getElementById(billstat).value;
            var adsubcat = document.getElementById(adsubcat).value;
           // var repdate = document.getElementById(repeat).value;
            var paidins = document.getElementById(paid).value;
            var insagreedrate = document.getElementById(agrred).value;
            var inssolo = document.getElementById(solo).value;
            var grossrate = document.getElementById(gross).value;
            //insert_pageno = document.getElementById(pageno_inserts).value;
            var insert_remark = document.getElementById(remark_inserts).value;
            var insert_caption = document.getElementById(caption_inserts).value;
            var page_code = ""; //document.getElementById(page).value;
            var page_per = ""; //document.getElementById(pageprem).value;
            //var no_ofcol = document.getElementById(noofcol).value;
            var bill_amt = document.getElementById(billamt).value;
           // var bill_rate = document.getElementById(billrate).value;
//            var dealerheight = document.getElementById(dealerh).value;
            //            var dealerwidth = document.getElementById(dealerw).value;
            var clicatamt = document.getElementById(clicatamtval).value;
            var flatfreqamt = document.getElementById(flatfreqamtval).value;
            var catamt = document.getElementById(catamtval).value;
            var premium1 = "";
            var premium2 = "";
            var premallow = "";

            var latestdate = "";
            var billstatus = "";
            var height = "";
            var width = "";
            var repdate = "";
            var ofcol = "";
            var bill_rate = "";
            var dealerheight = "";
            var dealerwidth = "";
            var no_ofcol = "";
            var insertid = '0';
            //26sep09
            var pkgcodegrid_value = "";
            var pkginsgrid_value = "";
            var pkg_alias_value = "";
            var pkgcodegrid = "hiddenpckcode" + i;

            var pkg_ins = "pkg_ins" + i;

            var pkg_alias = "pkg_alias" + i;
            if (document.getElementById(pkgcodegrid) != null) {
                pkgcodegrid_value = document.getElementById(pkgcodegrid).value;
            }

            if (document.getElementById(pkg_ins) != null) {
                pkginsgrid_value = document.getElementById(pkg_ins).value;
            }

            if (document.getElementById(pkg_alias) != null) {
                pkg_alias_value = trim(document.getElementById(pkg_alias).value);
            }

            if (document.getElementById(insert_id) != null)
                insertid = document.getElementById(insert_id).value;
            var agncommant = document.getElementById(agnamnt).value;
            var adlgamnt = document.getElementById(adlgn).value;
            var splcomamt = document.getElementById(spldisc).value;
            var cashammt = document.getElementById(cashdisc).value;
            var roundoffamt = document.getElementById(roundoffval).value;
        }
        else {
            var insernum = par1.all[insertno].innerHTML;
            if (par1.all[spltdata] != null) {
                splitdata = par1.all[spltdata].value;
            }
            if (par1.all[subedi] != null) {
                subedidata = par1.all[subedi].value;
            }
            if (par1.all[sectioncode] != null) {
                sectioncode_val = par1.all[sectioncode].value;
            }
            if (par1.all[resourceno] != null) {
                resourceno_val = par1.all[resourceno].value;
            }
            var insertdate = par1.all[id].value;
            var edition = par1.all[editid].value;
            //            var premium1 = par1.all[premium11].value;

         

           
            var premium2 = par1.all[premium22].value; //document.getElementById(prem1id).value;
            var height = "";
            var width = "";
            var totalsize = par1.all[size].value;
           var pagepost = "";
           // var color = par1.all[colid].value;
//            var premper11 = '';
//            if (par1.all[premper] != undefined)
//                premper11 = par1.all[premper].value;
//            var premper2 = ""; //document.getElementById(premper1).value;
            var premallow = "";
            var adcategory = par1.all[adcat].value;
           
            var material = par1.all[matsta].value;
            var cardrate = par1.all[cardid].value;
            var filename = par1.all[filename].value;
            var discrate = par1.all[discrate].value;
            var insertstatus = par1.all[insertsta].value;
            var billstatus = "";
            var adsubcat = par1.all[adsubcat].value;
            var repdate = "";
            var paidins = par1.all[paid].value;
            var insagreedrate = par1.all[agrred].value;
            var inssolo = par1.all[solo].value;
            var grossrate = par1.all[gross].value;

            var latestdate = par1.all[late].value;
            //insert_pageno = par1.all[pageno_inserts].value;anuj
            var insert_remark = par1.all[remark_inserts].value;
            var insert_caption = par1.all[caption_inserts].value;
            var dealerheight = "";
            var dealerwidth = "";
            var page_code = ""; //document.getElementById(page).value;
            var page_per = ""; //document.getElementById(pageprem).value;
            var no_ofcol = "";
            var bill_amt = "";
            var bill_rate = "";

            var insertid = '0';
            //26sep09
            var pkgcodegrid_value = "";
            var pkginsgrid_value = "";
            var pkg_alias_value = "";
            var pkgcodegrid = "hiddenpckcode" + i;

            var pkg_ins = "pkg_ins" + i;

            var pkg_alias = "pkg_alias" + i;
            if (par1.all[pkgcodegrid] != null) {
                pkgcodegrid_value = par1.all[pkgcodegrid].value;
            }

            if (par1.all[pkg_ins] != null) {
                pkginsgrid_value = par1.all[pkg_ins].value;
            }

            if (par1.all[pkg_alias] != null) {
                pkg_alias_value = trim(par1.all[pkg_alias].value);
            }

            if (par1.all[insert_id] != null)
                insertid = par1.all[insert_id].value;
            var agncommant = par1.all[agnamnt].value;
            var adlgamnt = par1.all[adlgn].value;
            var splcomamt = par1.all[spldisc].value;
            var cashammt = par1.all[cashdisc].value;
            var roundoffamt = par1.all[roundoffval].value;
            var clicatamt = par1.all[clicatamtval].value;
            var flatfreqamt = par1.all[flatfreqamtval].value;
            var catamt = par1.all[catamtval].value;
        }
        insertid = '0';
        //var vtsvalue = document.getElementById('vts' + i).value;
        var cirvts = '';
        var cirpub = '';
        var ciredi = '';
        var cirrate = '';
        var cirdate = '';
        var ciragency = document.getElementById('txtciragency').value;
        var ciragencysubcode = '';
        if (ciragency != "") {
            var myarrayex = ciragency.split('(');
            var agecirname = myarrayex[1].replace(")", "").split('+')[0];
            ciragency = trim(agecirname);
            ciragencysubcode = trim(myarrayex[1].replace(")", "").split('+')[1]);
        }
//        if (vtsvalue != "") {
//            cirvts = vtsvalue.split('ÿ')[0];
//            cirpub = vtsvalue.split('ÿ')[1];
//            ciredi = vtsvalue.split('ÿ')[2];
//            cirrate = vtsvalue.split('ÿ')[3];
//            cirdate = vtsvalue.split('ÿ')[4];
//        }
//        if (insert_pageno == "" || insert_pageno == null)anuj
//            insert_pageno = document.getElementById('txtpageno').value;
//        if (cioid == "") {
//            alert("Booking Id can't be blank");
//            return false;
//        }
        var boxcharge = "";
        var vat_inc = "";
        var grosslocal = document.getElementById("grolocal" + i).value;
        var billamtlocal = document.getElementById("ba" + i).value;
        var discountmain = "";

        var insert_pageno = "";
        // document.getElementById('txtbranch').value
        var txtbranch = "";
        // document.getElementById('hiddenserverip').value
        var hiddenserverip = "";

        // document.getElementById('vat' + i).value
        var vat = "";
        var premper11 = "";
        var premper2 = "";
        var color = "B";
        if (document.getElementById(discount_) != null)
            discountmain = document.getElementById(discount_).value;
        var premium123 = document.getElementById('drppageprem').value;
        var res = web_booking.insertinsertion(insertdate, edition, premium123, premium2, premallow, adcategory, latestdate, material, cardrate, filename, discrate, insertstatus, billstatus, adsubcat, compcode, userid, cioid, height, width, totalsize, pagepost, premper11, premper2, color, repdate, insernum, paidins, insagreedrate, inssolo, grossrate, insert, insert_pageno, insert_remark, page_code, page_per, no_ofcol, bill_amt, bill_rate, insertid, dateformat, pkgcodegrid_value, pkginsgrid_value, pkg_alias_value, cirvts, cirpub, ciredi, cirrate, cirdate, ciragency, ciragencysubcode, center, txtbranch, hiddenserverip, splitdata, subedidata, vat, boxcharge, vat_inc, grosslocal, billamtlocal, sectioncode_val, resourceno_val, insert_caption, dealerheight, dealerwidth, discountmain, agncommant, adlgamnt, splcomamt, cashammt, roundoffamt, "", "", clicatamt, flatfreqamt, catamt);
        if (res.error != null) {
            alert(res.error.description);
            web_booking.rollback(cioid);
            return false;
        }
        if (res.value != "") {
            alert(res.value.toString());
            web_booking.rollback(cioid);
            return false;
        }
        
        
        
        i = parseInt(i) + 1;
    }
    var sta = "";
    var pcentname = document.getElementById('hiddencenter').value;
    pcentname = pcentname.substring(0, 3);
    var idformat = document.getElementById('hiddencioidformat').value;
    var quotation = document.getElementById('hiddenquotation').value;
    var ressta = web_booking.commit(y, cioid, compcode, pcentname, userid, idformat, quotation);

    if (ressta.error != null) {
        alert(ressta.error.description);
        //web_booking.rollback(cioid);
        return false;
    }
    sta = ressta.value.split('$~$')[0];
    mainbookingid = ressta.value.split('$~$')[1];
   
    if (sta == "N") {
        alert("There is some problem while saving the total records " + y.toString() + "  grid Details. Please contact with 4cplus  for further information");
        return false;
    }
    web_booking.savelogin_dj(mainbookingid);
    document.getElementById('tblinsert').innerHTML = ""

    document.getElementById('tblrate').style.display = "none";
    document.getElementById('tblbill').style.display = "none";
    //document.getElementById('tblsize').style.display="none";
    document.getElementById('addetails').style.display = "none";
    document.getElementById('pagedetail').style.display = "none";
    document.getElementById('tblpackage').style.display = "none";
    document.getElementById('tbbox').style.display = "none";
    //document.getElementById('txtciobookid').value="";
    document.getElementById('txtciobookid').value = mainbookingid;
    document.getElementById('LinkButton1').disabled = true;
    document.getElementById('LinkButton2').disabled = true;
    document.getElementById('LinkButton3').disabled = true;
    document.getElementById('LinkButton4').disabled = true;
    document.getElementById('LinkButton5').disabled = true;
//    document.getElementById('LinkButton6').disabled = true;
//    document.getElementById('LinkButton7').disabled = true;
    var flagrate;
    ////////////////

    noofinsert = "";
    noofinsertlo = "";
    rowwhenupdate = "";
    fillinsert = "";
    insertval = "";
    boxpercen = "";
    //boxgamt;
    //boxbill;
    glspedisc = "0";
    glspadisc = "0";
    glspeccharge = "0";
    glpre = "0";
    //savtotid;
    getid = "";
    countgridloop = "";
    schemediscount = "";
    subtractrow = "0";
    if (quotation == 'Q') {
        web_booking.btnSavecall(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value, mainbookingid, quotation);
    }

    // return false;


}



function getspacedisc(Activid) {
    var totalarea_var = document.getElementById('txttotalarea').value;
    if (document.getElementById("txtbillwidth").value != "" && document.getElementById("txtbillheight").value != "") {
        totalarea_var = parseFloat(document.getElementById("txtbillwidth").value) * parseFloat(document.getElementById("txtbillheight").value);
    }
    //var totalarea_var=document.getElementById('txttotalarea');
    var billAmount = 0;
    if (document.getElementById('txtagreedrate').value != "" && document.getElementById('txtagreedamt').value != "" && agreedrate_active == "0") {
        document.getElementById('txtspacedisc').value = "";
        document.getElementById('txtspadiscper').value = "";
        // alert('Special discount can not applied in case of agreed rate.' );
        return false;
    }
    var cardrate = document.getElementById('txtcardrate').value;
    if (agreedrate_active == 1) {
        cardrate = document.getElementById('txtagreedrate').value;
    }
    if (Activid == "txtspacedisc" && document.getElementById('txtspacedisc').value != "") {
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        if (parseFloat(cardrate) < parseFloat(document.getElementById('txtspacedisc').value)) {
            // alert('Special discount can not be greated than card rate');
            document.getElementById('txtspacedisc').value = "";
            return false;
        }
        ddiscspace = 1;
        ddiscspaceper = 0;
        document.getElementById('txtspadiscper').value = ((parseFloat(document.getElementById('txtspacedisc').value) / parseFloat(cardrate)) * 100).toFixed(2);
    }

    if (Activid == "txtspadiscper" && document.getElementById('txtspadiscper').value != "") {
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        if (parseFloat(document.getElementById('txtspadiscper').value) > 100) {
            alert('Space discount can not be greated than 100%');
            document.getElementById('txtspadiscper').value = "";
            return false;
        }
        ddiscspace = 0;
        ddiscspaceper = 1;
        document.getElementById('txtspacedisc').value = (parseFloat(cardrate) * parseFloat(document.getElementById('txtspadiscper').value) / 100).toFixed(2);
    }
    if (document.getElementById('txtspacedisc').value != "") {
        ddiscspace = 1;
        ddiscspaceper = 0;
    }
    if (document.getElementById('txtspacedisc').value == "" || document.getElementById('txtspadiscper').value == "") {
        ddiscspace = 0;
        ddiscspaceper = 0;
        document.getElementById('txtspacedisc').value = "";
        document.getElementById('txtspadiscper').value = "";
    }
    else {
        var paidCount = document.getElementById('txtinsertion').value;
        var finsert = 1;
        var tinsert = 0;
        var br_spcharge = 0;
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        if (document.getElementById('drppackagecopy').options.length > 0) {
            for (var insertCou = 0; insertCou < document.getElementById('drppackagecopy').options.length; insertCou++) {
                if (document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') >= 0) {
                    tinsert = document.getElementById('drppackagecopy').options[insertCou].value.substring(document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') + 1, document.getElementById('drppackagecopy').options[insertCou].value.indexOf(')'));
                    if (parseInt(tinsert) > parseInt(finsert)) {
                        finsert = tinsert;
                    }
                    paidCount = parseInt(paidCount) * parseInt(tinsert);
                }
            }
        }
        var splcharges = document.getElementById('txtspacedisc').value;
        var grossAmt = (parseFloat(cardrate) - parseFloat(splcharges)) * parseInt(paidCount, 10) * parseFloat(totalarea_var);
        if (ddiscspace == 1) {
            var len = "bookdiv";
            var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
            for (var s = 0; s < count; s++) {
                var gross_var = document.getElementById('gro' + s);
                var bill_var = document.getElementById('ba' + s);
                var insertsta = document.getElementById("inssta" + s);
                var splcharges_grid = (parseFloat(document.getElementById('card' + s).value) / parseFloat(document.getElementById('txtcardrate').value)) * splcharges;
                if (gross_var != null && document.getElementById("inssta" + s).value != "cancel" && document.getElementById("pai" + s).value != "N") {
                    if (insertsta.value != "billed")
                        gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid) * parseFloat(totalarea_var))).toFixed(4);
                    // bill_var.value = (parseFloat(bill_var.value) - (parseFloat(splcharges_grid)*parseFloat(totalarea_var))).toFixed(2);                       
                    // trade disc
                    var tradisc = document.getElementById('txttradedisc').value;
                    if (document.getElementById('chktrade').checked == false)
                        tradisc = 0;
                    if (tradisc == "")
                        tradisc = 0;
                    var trdisc1 = tradisc;
                    var addcomm = 0;
                    if (document.getElementById('txtaddagencycommrate') != null) {
                        if (document.getElementById('hiddenagcommflag').value != "1")
                            addcomm = document.getElementById('txtaddagencycommrate').value;
                    }
                    if (addcomm == "") {
                        addcomm = "0";
                    }
                    if (addcomm != "0") {
                        trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                    }
                    if (insertsta.value != "billed")
                        bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);
                    br_spcharge = (parseFloat(br_spcharge) + parseFloat(gross_var.value)).toFixed(2);
                    billAmount = (parseFloat(billAmount) + parseFloat(bill_var.value)).toFixed(2);
                }
            }
        }


        if (ddiscspaceper == 1) {
            //  var br_spcharge=0;
            var splcharges = document.getElementById('txtspadiscper').value;
            var grossAmt = document.getElementById('txtgrossamt').value;
            var len = "bookdiv";
            var ratio = 0;
            var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
            for (var s = 0; s < count; s++) {
                var gross_var = document.getElementById('gro' + s);
                var bill_var = document.getElementById('ba' + s);
                var insertsta = document.getElementById("inssta" + s);
                if (gross_var != null && document.getElementById("inssta" + s).value != "cancel" && document.getElementById("pai" + s).value != "N") {

                    //                    if(s==count-1)
                    //                    {
                    //                        document.getElementById('gro'+s).value = (parseFloat(document.getElementById('gro'+s).value) - ((parseFloat(splcharges)*parseFloat(cardrate)/100)-parseFloat(br_spcharge))).toFixed(2);
                    //                    }
                    //                    else
                    //                    {
                    //                       ratio = (parseFloat(document.getElementById('gro'+s).value) * (parseFloat(splcharges)*parseFloat(cardrate)*parseFloat(document.getElementById('txttotalarea').value)/100) / parseFloat(grossAmt))
                    var splcharges_grid = (parseFloat(document.getElementById('card' + s).value) * splcharges) / 100;
                    if (insertsta.value != "billed")
                        gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid) * parseFloat(totalarea_var))).toFixed(4);
                    //  bill_var.value = (parseFloat(bill_var.value) - (parseFloat(splcharges_grid)*parseFloat(totalarea_var))).toFixed(2);
                    // trade disc
                    var tradisc = document.getElementById('txttradedisc').value;
                    if (document.getElementById('chktrade').checked == false)
                        tradisc = 0;
                    if (tradisc == "")
                        tradisc = 0;
                    var trdisc1 = tradisc;
                    var addcomm = 0;
                    if (document.getElementById('txtaddagencycommrate') != null) {
                        if (document.getElementById('hiddenagcommflag').value != "1")
                            addcomm = document.getElementById('txtaddagencycommrate').value;
                    }
                    if (addcomm == "") {
                        addcomm = "0";
                    }
                    if (addcomm != "0") {
                        trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                    }
                    if (insertsta.value != "billed")
                        bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);
                    br_spcharge = (parseFloat(br_spcharge) + parseFloat(gross_var.value)).toFixed(2);
                    billAmount = (parseFloat(billAmount) + parseFloat(bill_var.value)).toFixed(2);
                    //                    }  
                }
            }
        }
        if (br_spcharge == 0) {
            if (grossAmt == "")
                grossAmt = 0;
            br_spcharge = grossAmt;
        }
        document.getElementById('txtgrossamt').value = parseFloat(br_spcharge);
        if (Activid == "txtspacedisc" || Activid == "txtspadiscper")
            document.getElementById('txtgrossamt').value = "";
        if (billAmount != 0)
            document.getElementById('txtbillamt').value = parseFloat(billAmount).toFixed(2);
    }
    if (document.getElementById('txtspadiscper').value != "") {
        var spacedisc = document.getElementById('txtspadiscper').value;
        if (document.getElementById('txtspediscper').value != "") {
            spacedisc = parseFloat(spacedisc) + parseFloat(document.getElementById('txtspediscper').value);
        }
        if (document.getElementById('hiddenuserdisc').value != "" && document.getElementById('hiddenuserdisc').value != "0") {
            if (parseFloat(spacedisc) > parseFloat(document.getElementById('hiddenuserdisc').value)) {
                alert("User Allowed Commission can't be greater than " + document.getElementById('hiddenuserdisc').value);
                document.getElementById('txtspadiscper').value = "";
                document.getElementById('txtspacedisc').value = "";
                return false;
            }
        }

    }
}



function queryClick() {
    // document.getElementById('hiddensavemod').value = "1";
    clearClick();
    document.getElementById('btnQuery').disabled = true;
    rownumEx = 0;
    executequery = null;
    document.getElementById("div2").style.display = "none";
    document.getElementById('txtagaddf2').value = "";
    document.getElementById('LinkButton1').disabled = true;
    document.getElementById('LinkButton2').disabled = true;
    document.getElementById('LinkButton3').disabled = true;
    document.getElementById('LinkButton4').disabled = true;
    document.getElementById('LinkButton5').disabled = true;
//    document.getElementById('LinkButton6').disabled = true;
//    document.getElementById('LinkButton7').disabled = true;
    document.getElementById('btnshgrid').disabled = true;
    document.getElementById('txtagencypaymode').disabled = true;
    document.getElementById('txtciobookid').value = "";
    document.getElementById('txtrono').value = "";
    document.getElementById('txtrodate').value = "";
    document.getElementById('drpbillstatus').value = "0";
    document.getElementById('drprostatus').value = "0";
    document.getElementById('txtagency').value = "";
    document.getElementById('txtclient').value = "";
    document.getElementById('txtagencyaddress').value = "";
    document.getElementById('txtclientadd').value = "";
    document.getElementById('drpagscode').value = "0";
    document.getElementById('txtdockitno1').value = "";
    document.getElementById('txtexecname').value = "";
    document.getElementById('txtexeczone').value = "";
    //document.getElementById('txtproduct').value = "";
    //document.getElementById('drpbrand').value = "0";
    document.getElementById('txtkeyno').value = "";
    document.getElementById('txtbillremark').value = "";
    document.getElementById('txtprintremark').value = "";
    document.getElementById('txtmobile').value = "";
    document.getElementById('txtmobile').disabled = true;

    //document.getElementById('txtpremper').value = "";


    document.getElementById('txtinsertion').value = "";
    document.getElementById('txtdummydate').value = "";
    document.getElementById('txtrevisedate').value = "";
    document.getElementById('txtrepeatingdate').value = "";
    document.getElementById('drpbooktype').value = "0";
    //document.getElementById('txtcategory').value = "0";
    //document.getElementById('drpadsubcategory').value = "0";
  //  document.getElementById('drpcolor').value = "0";
    document.getElementById('drpuom').value = "0";
    document.getElementById('drpposition').value = "0";
    //document.getElementById('drpdiscountprem').value = "0";
    //document.getElementById('drppagetype').value = "0";

    //document.getElementById('drpadstype').value = "0";
    document.getElementById('txtratecode').value = "0";
    document.getElementById('drpscheme').value = "";
    //document.getElementById('txtpageno').value = "";
    document.getElementById('drpcurrency').value = "0";
    document.getElementById('drprptcurrency').value = "0";
    document.getElementById('txtagreedrate').value = "";
    document.getElementById('txtagreedamt').value = "";
    document.getElementById('txtspedisc').value = "";
    document.getElementById('txtspacedisc').value = "";
    document.getElementById('txtspediscper').value = "";
    document.getElementById('txtspadiscper').value = "";

    document.getElementById('txtextracharges').value = "";
    //document.getElementById('txtcolum').value = "";

    //document.getElementById('drpmatsta').disabled = true;
    //document.getElementById('drpmatsta').value = "0";

    if (document.getElementById('txtaddagencycommrate') != null) {
        document.getElementById('txtaddagencycommrate').value = "";
    }
    document.getElementById('txtcontractname').value = "";
    hidcontract = "";
    document.getElementById('txtcontracttype').value = "";
    //document.getElementById('txtcardname').value = "";
    //document.getElementById('drptype').value = "0";
    //document.getElementById('drpmonth').value = "0";
    //document.getElementById('drpyear').value = "0";
    //document.getElementById('txtcardno').value = "0";

    document.getElementById('drppackage').value = "0";
    document.getElementById('drppackagecopy').options.length = 0;
    document.getElementById('txtagencypaymode').options.length = 0;
    //document.getElementById('drpadcat3').disabled = true
    //document.getElementById('drpadcat4').disabled = true
    //document.getElementById('drpadcat3').options.length = 0;
    //document.getElementById('drpadcat4').options.length = 0;
    document.getElementById('Button1').disabled = false;
    //document.getElementById('drpadcat5').disabled = true;
    //document.getElementById('drpadcat5').options.length = 0;

    //////////////////////////////
    document.getElementById('txtdockitno1').disabled = false;
    document.getElementById('txtkeyno').disabled = false;
    document.getElementById('txtrono').disabled = false;
    document.getElementById('txtagency').disabled = false;
    document.getElementById('txtclient').disabled = false;

    document.getElementById('txtciobookid').disabled = false;

    document.getElementById('hiddensavemod').value = "01";
    //chkstatus(document.getElementById('hiddenbuttonidcheck').value);anuj

    document.getElementById('btnQuery').disabled = true;
    document.getElementById('btnExecute').disabled = false;
    document.getElementById('btnSave').disabled = true;
    document.getElementById('tblinsert').innerHTML = '';
    document.getElementById('btnExecute').focus();

    if (document.getElementById('Hdnmodbook').value == "modify") {

        document.getElementById('txtciobookid').value = document.getElementById('Hdnmodbook').value;
        var dt = new Date()
        var auto = "";
        var cen = document.getElementById('hiddencenter').value;
        cen = cen.substring(0, 3);
        var year = dt.getFullYear();
        if (document.getElementById('hiddencioidformat').value == "1") {
            auto = cen + year;
        }
        else if (document.getElementById('hiddencioidformat').value == "2") {
            auto = cen + year + document.getElementById('hiddenuserid').value;
        }
        else if (document.getElementById('hiddencioidformat').value == "3") {
            auto = "";
        }
        else if (document.getElementById('hiddencioidformat').value == "4") {
            auto = "DI";
        }
        document.getElementById('txtciobookid').focus();
        document.getElementById('txtciobookid').value = document.getElementById('txtprevbook').value;

    }


    setButtonImages()
    return false;
}






function executeClick(id) {


    flag = 1;
    document.getElementById('btnModify').disabled = false;
    document.getElementById('btnExecute').disabled = true;
    setButtonImages();
    boxstatus = "";
    if (id == "btnExecute") {
        if (document.getElementById('hiddencopybooking').value == "y") {
            if (confirm("Do you want to copy the data ?")) {
                hidcopy = "copy";
            }
            else {
                hidcopy = "";
            }
        }
    }
    chkbtnStatus = "execute";
    var msg = checkSession();
    if (rownumEx == undefined || rownumEx == "undefined")
        rownumEx = 0;
    if (msg == false) {
        window.location.href = "login.aspx";
        return false;
    }
    //dan
    var strtextd = "";
    var httpRequest = null;
    httpRequest = new XMLHttpRequest();
    if (httpRequest.overrideMimeType) {
        httpRequest.overrideMimeType('text/xml');
    }
    //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };

    httpRequest.open("GET", "checksessiondan.aspx", false);
    httpRequest.send('');
    //alert(httpRequest.readyState);
    if (httpRequest.readyState == 4) {
        //alert(httpRequest.status);
        if (httpRequest.status == 200) {
            strtextd = httpRequest.responseText;
        }
        else {
            //alert('There was a problem with the request.');
            if (browser != "Microsoft Internet Explorer") {
                //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
            }
        }
    }
    if (strtextd != "sess") {
        alert('session expired');
        window.location.href = "Default.aspx";
        return false;
    }
    document.getElementById('tblinsert').innerHTML = '';
    document.getElementById('hiddensavemod').value = "1";
    document.getElementById('LinkButton1').disabled = false;
    document.getElementById('LinkButton2').disabled = false;
    document.getElementById('LinkButton3').disabled = false;
    document.getElementById('LinkButton4').disabled = false;
    document.getElementById('LinkButton5').disabled = false;
//    document.getElementById('LinkButton6').disabled = false;
//    document.getElementById('LinkButton7').disabled = false;

    //////////////////////////////////////////////////////////////////////////

    document.getElementById('btnshgrid').disabled = true;
    //btnupload.Enabled = false;
    document.getElementById('txttranslationdisc').disabled = true;
    document.getElementById('txtpospremdisc').disabled = true;
    document.getElementById('drpbooktype').disabled = true;
    document.getElementById('txtciobookid').disabled = true;
    // txtappby.Enabled = true;
    //txtaudit.Enabled = true;
    document.getElementById('txtrono').disabled = true;
    document.getElementById('txtrevisedate').disabled = true;
    document.getElementById('txtrodate').disabled = true;
    //document.getElementById('txtcaption').disabled = true;
    document.getElementById('txtmobile').disabled = true;
    document.getElementById('txtdatetime').disabled = true;
    document.getElementById('drpbillstatus').disabled = true;
    document.getElementById('drprostatus').disabled = true;
    document.getElementById('txtagency').disabled = true;
    document.getElementById('txtclient').disabled = true;
    // txtagencyaddress.Enabled = true;
    document.getElementById('txtclientadd').disabled = true;
    document.getElementById('drpagscode').disabled = true;
    document.getElementById('txtdockitno1').disabled = true;
    document.getElementById('txtexecname').disabled = true;
    document.getElementById('txtexeczone').disabled = true;
    //document.getElementById('txtproduct').disabled = true;
    //document.getElementById('drpbrand').disabled = true;
    document.getElementById('txtkeyno').disabled = true;
    document.getElementById('txtbillremark').disabled = true;
    document.getElementById('txtprintremark').disabled = true;
    document.getElementById('drppackage').disabled = true;
    document.getElementById('txtinsertion').disabled = true;
    document.getElementById('txtdummydate').disabled = true;
    document.getElementById('txtrepeatingdate').disabled = true;
    document.getElementById('drpbooktype').disabled = true;
    document.getElementById('txtcategory').disabled = true;
    //document.getElementById('drpadsubcategory').disabled = true;
    //document.getElementById('drpcolor').disabled = true;
    document.getElementById('drpuom').disabled = true;
    document.getElementById('drpposition').disabled = true;
    //document.getElementById('drpdiscountprem').disabled = true;
    //document.getElementById('drppagetype').disabled = true;
   // document.getElementById('txtpageno').disabled = true;
   // document.getElementById('drpadstype').disabled = false;
    document.getElementById('txtRetainercommamt').disabled = true;
    if (document.getElementById('txtaddagencycommrateamt') != null)
        document.getElementById('txtaddagencycommrateamt').disabled = true;

    document.getElementById('txtratecode').disabled = true;
    document.getElementById('drpscheme').disabled = true;
    document.getElementById('drpcurrency').disabled = true;
    document.getElementById('drprptcurrency').disabled = true;
    document.getElementById('txtagreedrate').disabled = true;
    document.getElementById('txtagreedamt').disabled = true;
    document.getElementById('txtspedisc').disabled = true;
    document.getElementById('txtspacedisc').disabled = true;

    document.getElementById('txtextracharges').disabled = true;
    document.getElementById('txtdatetime').disabled = true;
    document.getElementById('txtrepeatingdate').disabled = true;

    document.getElementById('drpbillcycle').disabled = true;
    document.getElementById('drprevenue').disabled = true;
    //drpbilltype.Enabled = true;
    document.getElementById('drpbillstatus').disabled = true;
    //drpbillcurrency.Enabled = true;
    document.getElementById('drppaymenttype').disabled = true;
    document.getElementById('txtinvoice').disabled = true;
    document.getElementById('txtvts').disabled = true;
    document.getElementById('txtcirrate').disabled = true;
    document.getElementById('Button1').disabled = true;
    document.getElementById('txtciragency').disabled = true;
    document.getElementById('txtciredition').disabled = true;
    document.getElementById('txtbillwidth').disabled = true;
    document.getElementById('txtbillheight').disabled = true;
    document.getElementById('drpbillto').disabled = true;
    document.getElementById('txttradedisc').disabled = true;
    document.getElementById('chktrade').disabled = true;
    document.getElementById('txtagencyoutstand').disabled = true;
    document.getElementById('txtcardrate').disabled = true;
    document.getElementById('txtcardamt').disabled = true;
    document.getElementById('txtdiscount').disabled = true;
    document.getElementById('txtdiscpre').disabled = true;
    //document.getElementById('txtadsize2').disabled = true;
    //document.getElementById('txtadsize1').disabled = true;
    document.getElementById('txttotalarea').disabled = true;
    document.getElementById('txtbilladdress').disabled = true;

    document.getElementById('drpboxcode').disabled = true;
    //txtboxno.Enabled = true;
    document.getElementById('txtboxaddress').disabled = true;
    //document.getElementById('txtcamp').disabled = true;
    document.getElementById('txtbillamt').disabled = true;
    document.getElementById('drppageprem').disabled = true;
    document.getElementById('txtgrossamt').disabled = true;

    document.getElementById('drpboxcode').disabled = true;
    document.getElementById('chkage').disabled = true;
    document.getElementById('chkclie').disabled = true;
    document.getElementById('chktfn').disabled = true;
    document.getElementById('chkadon').disabled = true;
    //document.getElementById('chkcoupan').disabled = true;

    document.getElementById('txtinsertion').disabled = true;

    //document.getElementById('txtcolum').disabled = true;
    document.getElementById('txtspediscper').disabled = true;
    document.getElementById('txtspadiscper').disabled = true;
    document.getElementById('txtboxno').disabled = true;
    document.getElementById('txtcontractname').disabled = true;
    document.getElementById('txtcontracttype').disabled = true;
    //document.getElementById('txtcardname').disabled = true;
    //document.getElementById('drptype').disabled = true;
    //document.getElementById('drpmonth').disabled = true;
    //document.getElementById('drpyear').disabled = true;
    //document.getElementById('txtcardno').disabled = true;
    document.getElementById('txtagencypaymode').disabled = true;

    document.getElementById('btncopy').disabled = true;
    document.getElementById('btndel').disabled = true;
    document.getElementById('btndeal').disabled = true;
    //document.getElementById('drpmatsta').disabled = true;

    document.getElementById('drpretainer').disabled = true;
    if (document.getElementById('txtaddagencycommrate') != null) {
        document.getElementById('txtaddagencycommrate').disabled = true;
    }

    //checkinfo
    //document.getElementById('ttextchqno').disabled = true;
    //document.getElementById('drpourbank').disabled = true;
    //document.getElementById('ttextchqdate').disabled = true;
    //document.getElementById('ttextchqamt').disabled = true;
    //document.getElementById('ttextbankname').disabled = true;
    chkbtnStatus = "";
    ///////////////////////////////////////////////////////////////////////////

    var ciobookid = document.getElementById('hiddencioid').value = document.getElementById('txtciobookid').value;
    gciobookid = ciobookid;
    var docno = document.getElementById('txtdockitno1').value;
    gdockitno = docno;
    var keyno = document.getElementById('txtkeyno').value;
    gkeyno = keyno;
    var rono = document.getElementById('txtrono').value;
    grono = rono;

    var agencycod = document.getElementById('txtagency').value;
    var agencycode = "";
    //////////////this is to split the  and get the code
    if (agencycod != "") {
        var myarray = agencycod.split('(');
        agencycode = myarray[1];
        agencycode = agencycode.replace(")", "");
        gagencyscode = agencycode;
    }
    ////for client
    var clientcode = document.getElementById('txtclient').value;
    var client = "";
    ///this is to split and get the client code

    if (clientcode.indexOf("(".toString()) > 0 && clientcode != "") {
        var myarray1 = clientcode.split('(');
        client = myarray1[1];
        client = client.replace(")", '');
        var res = web_booking.chkwalkinClient(client, document.getElementById('hiddencompcode').value);
        var dcl = res.value;
        if (dcl == null) {
            alert(res.error.description);
            return false;
        }
        if (dcl.Tables[0].Rows.length > 0) {

        }
        else {
            client = clientcode;
        }
    }
    else {
        client = clientcode;
    }
    gclient = client;
    ////////////////////////////////////////////////////////////////////////////////////////
    var res1 = web_booking.executeBooking(document.getElementById('hiddencompcode').value, ciobookid, docno, keyno, rono, agencycode, client, "WE0", document.getElementById('hiddendateformat').value, document.getElementById('hiddenuserid').value);
    executequery = res1.value;
    if (executequery == null) {
        alert(res1.error.description);
        return false;
    }
    
    
    // dateinsert getdatechk = new dateinsert();
    if (executequery.Tables[0].Rows.length > 0) {



//        if (executequery.Tables[0].Rows[0].uom_code == "CPC") {


//            document.getElementById('lbltotarea').innerHTML = "No of Click";
//            return false;

//        }

//        if (executequery.Tables[0].Rows[0].uom_code == "CPD") {


//            document.getElementById('lbltotarea').innerHTML = "No of Days";
//            return false;

//        }


//        if (executequery.Tables[0].Rows[0].uom_code == "CPM") {


//            document.getElementById('lbltotarea').innerHTML = "No of Impression";
//            return false;

//        }
//    
    
    
    
    
    
    
    
        if (executequery.Tables[0].Rows[0].prev_booking != null && executequery.Tables[0].Rows[0].prev_booking != "") {
            var res = web_booking.checkCIOIDReference(document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[0].cio_booking_id);
            if (res.value != null) {
                if (executequery.Tables[0].Rows[0].cio_booking_id != res.value) {
                    alert("CIO ID " + executequery.Tables[0].Rows[0].cio_booking_id + " has been ReScheduled to New CIO ID " + res.value);
                    return false;
                }
            }
        }
        if (executequery.Tables[0].Rows[0].PACKAGE_TYPE != null) {
            if (executequery.Tables[0].Rows[0].PACKAGE_TYPE == "A") {
                document.getElementById('chkadon').checked = true;
                document.getElementById('lbreference').style.display = "block";
                document.getElementById('tdref').style.display = "block";
                //  document.getElementById('btnrefid').style.display="block";
            }
            else {
                document.getElementById('chkadon').checked = false;
                document.getElementById('lbreference').style.display = "none";
                document.getElementById('tdref').style.display = "none";
                //  document.getElementById('btnrefid').style.display="none";
            }
        }
        if (executequery.Tables[0].Rows[0].AD_REFID != null) {
            document.getElementById('txtreference').value = executequery.Tables[0].Rows[0].AD_REFID;
        }
        else {
            document.getElementById('txtreference').value = "";
        }
//        if (executequery.Tables[0].Rows[0].Caption != null) {anuj
//            document.getElementById('txtcaption').value = executequery.Tables[0].Rows[0].Caption;
//        }
//        else {
//            //document.getElementById('txtcaption').value = "";
//        }
//        if (executequery.Tables[0].Rows[0].DISC_PREMIUM != null) {
//            document.getElementById('drpdiscountprem').value = executequery.Tables[0].Rows[0].DISC_PREMIUM;
//        }
        if (executequery.Tables[0].Rows[0].DISC_TYPE != null) {
            hiddisctype = executequery.Tables[0].Rows[0].DISC_TYPE;
        }
        if (executequery.Tables[0].Rows[0].ATTACHMENT1 != null && executequery.Tables[0].Rows[0].ATTACHMENT1 != "") {
            document.getElementById('hidattach1').value = executequery.Tables[0].Rows[0].ATTACHMENT1;
            document.getElementById('attachment1').src = "Images/indexred.jpg";
        }
        if (executequery.Tables[0].Rows[0].ATTACHMENT2 != null && executequery.Tables[0].Rows[0].ATTACHMENT2 != "") {
            document.getElementById('hidattach2').value = executequery.Tables[0].Rows[0].ATTACHMENT2;
            document.getElementById('attachment2').src = "Images/indexred.jpg";
        }

        if (executequery.Tables[0].Rows[0].MOBILENO != null) {
            document.getElementById('txtmobile').value = executequery.Tables[0].Rows[0].MOBILENO;
        }
        else {
            document.getElementById('txtmobile').value = "";
        }
        if (executequery.Tables[0].Rows[0].CREATION_DATETIME != null) {
            document.getElementById('lblcreationdatetime').innerHTML = executequery.Tables[0].Rows[0].CREATION_DATETIME;
        }
        else {
            document.getElementById('lblcreationdatetime').innerHTML = "";
        }
//        if (executequery.Tables[0].Rows[0].branch != null) {
//            document.getElementById('txtbranch').value = executequery.Tables[0].Rows[0].branch;
//        }
        if (executequery.Tables[0].Rows[0].BRANCH_NAME != null) {
            document.getElementById('txtbranch_name').value = executequery.Tables[0].Rows[0].BRANCH_NAME;
        }
        else {
            document.getElementById('txtbranch_name').value = "";
        }
//        if (executequery.Tables[0].Rows[0].CLIENT_TYPE != null) {
//            document.getElementById('drpregular').value = executequery.Tables[0].Rows[0].CLIENT_TYPE;
//        }
//        else {
//            document.getElementById('drpregular').value = "0";
//        }
        if (executequery.Tables[0].Rows[0].TRANSLATION_DISC != null) {
            document.getElementById('txttranslationdisc').value = executequery.Tables[0].Rows[0].TRANSLATION_DISC;
        }
        else {
            document.getElementById('txttranslationdisc').value = "";
        }
        if (executequery.Tables[0].Rows[0].POSPREM_DISC != null) {
            document.getElementById('txtpospremdisc').value = executequery.Tables[0].Rows[0].POSPREM_DISC;
        }
        else {
            document.getElementById('txtpospremdisc').value = "";
        }
//        if (executequery.Tables[0].Rows[0].TRANSLATION_CODE != null) {
//            document.getElementById('drptranslation').value = executequery.Tables[0].Rows[0].TRANSLATION_CODE;
//        }
//        else {
//            document.getElementById('drptranslation').value = "0";anuj
//        }
        if (executequery.Tables[0].Rows[0].TRANSLATION_PREMIUM != null) {
            document.getElementById('txttranslationcharges').value = executequery.Tables[0].Rows[0].TRANSLATION_PREMIUM;
            document.getElementById('hiddentranalpremtype').value = executequery.Tables[0].Rows[0].TRANSLATION_TYPE;
        }
        else {
          //  document.getElementById('txttranslationcharges').value = "";
            document.getElementById('hiddentranalpremtype').value = "";
        }
        if (executequery.Tables[0].Rows[0].REVISE_DATE != null) {
            document.getElementById('txtrevisedate').value = executequery.Tables[0].Rows[0].REVISE_DATE;
        }
        else {
            document.getElementById('txtrevisedate').value = "";
        }
        if (executequery.Tables[0].Rows[0].BARTE_AMOUNT != null) {
            document.getElementById('hiddenbarteramt').value = executequery.Tables[0].Rows[0].BARTE_AMOUNT;
        }
        if (executequery.Tables[0].Rows[0].BARTERTYPE != null && executequery.Tables[0].Rows[0].BARTE_DESC != null) {
            document.getElementById('txtbartertype').value = executequery.Tables[0].Rows[0].BARTE_DESC + '(' + executequery.Tables[0].Rows[0].BARTERTYPE + ')';
        }
        if (executequery.Tables[0].Rows[rownumEx].CIRRATE != null) {
            document.getElementById('txtcirrate').value = executequery.Tables[0].Rows[rownumEx].CIRRATE;
        }
        else {
            document.getElementById('txtcirrate').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CIRPUBLICATION != null) {
            document.getElementById('hiddencirpub').value = executequery.Tables[0].Rows[rownumEx].CIRPUBLICATION;
        }
        else {
            document.getElementById('hiddencirpub').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CIREDITION != null) {
            document.getElementById('hiddenciredi').value = executequery.Tables[0].Rows[rownumEx].CIREDITION;
        }
        else {
            document.getElementById('hiddenciredi').value = "";
        }
        document.getElementById('txtciragency').value = "";
        // for getting circulation agency name
        if (executequery.Tables[0].Rows[rownumEx].CIRAGENCY != null && executequery.Tables[0].Rows[rownumEx].CIRAGENCY_SUBCODE != null && executequery.Tables[0].Rows[rownumEx].CIRAGENCY != "") {
            var resagname = web_booking.getcirAgency(document.getElementById('hiddencompcode').value, document.getElementById('txtbranch').value, executequery.Tables[0].Rows[rownumEx].CIRAGENCY, executequery.Tables[0].Rows[rownumEx].CIRAGENCY_SUBCODE);
            if (resagname.value == null) {
                alert(resagname.error.description);
                return false;
            }
            if (resagname.value.Tables.length > 0 && resagname.value.Tables[0].Rows.length > 0) {
                if (resagname.value.Tables[0].Rows[0].AGENCYNAME != null)
                    document.getElementById('txtciragency').value = resagname.value.Tables[0].Rows[0].AGENCYNAME + '(' + executequery.Tables[0].Rows[rownumEx].CIRAGENCY + ' + ' + executequery.Tables[0].Rows[rownumEx].CIRAGENCY_SUBCODE + ')';
                else
                    document.getElementById('txtciragency').value = "";
            }
        }
        // for getting circulation EDITION name
        document.getElementById('txtciredition').value = "";
        if (executequery.Tables[0].Rows[rownumEx].CIREDITION != null) {
            var resagname = web_booking.getcirEdition(document.getElementById('hiddencompcode').value, document.getElementById('hiddenciredi').value);
            if (resagname.value == null) {
                alert(resagname.error.description);
                return false;
            }
            if (resagname.value.Tables.length > 0 && resagname.value.Tables[0].Rows.length > 0 && resagname.value.Tables[0].Rows[0].EDITIONNAME != null && resagname.value.Tables[0].Rows[0].EDITIONNAME != "null") {
                document.getElementById('txtciredition').value = resagname.value.Tables[0].Rows[0].EDITIONNAME;
            }
        }
        if (executequery.Tables[0].Rows[rownumEx].ADD_AGENCY_COMM_AMT != null) {
            if (document.getElementById('txtaddagencycommrateamt') != null)
                document.getElementById('txtaddagencycommrateamt').value = executequery.Tables[0].Rows[rownumEx].ADD_AGENCY_COMM_AMT;
        }
        else {
            if (document.getElementById('txtaddagencycommrateamt') != null)
                document.getElementById('txtaddagencycommrateamt').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].RETAINER_COMM_AMT != null) {
            document.getElementById('txtRetainercommamt').value = executequery.Tables[0].Rows[rownumEx].RETAINER_COMM_AMT;
        }
        else {
            document.getElementById('txtRetainercommamt').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].RETAINER_COMM != null) {
            if (executequery.Tables[0].Rows[rownumEx].RETAINER_COMM1 != null)
                document.getElementById('txtRetainercomm').value = executequery.Tables[0].Rows[rownumEx].RETAINER_COMM1;
            else
                document.getElementById('txtRetainercomm').value = executequery.Tables[0].Rows[rownumEx].RETAINER_COMM;
        }
        else {
            document.getElementById('txtRetainercomm').value = "";
        }

        if (executequery.Tables[0].Rows[0].APP_USER != null) {
            document.getElementById('txtappby').value = executequery.Tables[0].Rows[0].APP_USER;
        }
        else {
            document.getElementById('txtappby').value = "";
        }


        if (executequery.Tables[0].Rows[0].audit != null) {
            document.getElementById('txtaudit').value = executequery.Tables[0].Rows[0].audit;
        }
        else {
            document.getElementById('txtaudit').value = "";
        }
        if (executequery.Tables[0].Rows[0].booked_by != null) {
            document.getElementById('txtbookedby').value = executequery.Tables[0].Rows[0].booked_by;
        }
        if (executequery.Tables[0].Rows[0].prev_booking != null) {
            document.getElementById('txtprevbook').value = executequery.Tables[0].Rows[0].prev_booking;
        }
        if (executequery.Tables[0].Rows[0].boxchrg != null) {
            boxpercen = executequery.Tables[0].Rows[0].boxchrg;
            document.getElementById('hiddenboxchrgtype').value = executequery.Tables[0].Rows[0].boxchargetype;
        }
        if (hidcopy != "copy") {
            var datetime = executequery.Tables[0].Rows[0].DATE_TIME;
            if (datetime != null) {
                document.getElementById('txtdatetime').value = datetime; //getdatechk.getDate(dateformat, datetime);
            }
        }
        if (executequery.Tables[0].Rows[0].cio_booking_id != null) {
            document.getElementById('txtciobookid').value = executequery.Tables[0].Rows[0].cio_booking_id;
        }

        if (executequery.Tables[0].Rows[0].RO_No != null) {
            document.getElementById('txtrono').value = executequery.Tables[0].Rows[0].RO_No;
        }
        var ro_date = executequery.Tables[0].Rows[0].RO_Date;
        if (ro_date != null) {
            document.getElementById('txtrodate').value = ro_date; //getdatechk.getDate(dateformat, ro_date);
        }
        if (executequery.Tables[0].Rows[0].bill_status != null) {
            document.getElementById('drpbillstatus').value = executequery.Tables[0].Rows[0].bill_status;
        }
        if (executequery.Tables[0].Rows[0].ro_status != null) {
            document.getElementById('drprostatus').value = executequery.Tables[0].Rows[0].ro_status;
            rostatusmain = document.getElementById('drprostatus').value;
        }
        if (executequery.Tables[0].Rows[0].AgencyName != null) {
            document.getElementById('txtagency').value = document.getElementById('hiddenagency').value = executequery.Tables[0].Rows[0].AgencyName;
        }
        if (executequery.Tables[0].Rows[0].EDTN_WISE_BILL_REQ != null) {

            if (executequery.Tables[0].Rows[0].EDTN_WISE_BILL_REQ == "Y")
                if (roundoff != "off")
                roundoff = "editionwise";
            else {
                if (roundoff != "off")
                    roundoff = "insertionwise";
            }
        }
        else {
            if (roundoff != "off")
                roundoff = "insertionwise";
        }
        document.getElementById('txtagency').title = document.getElementById('txtagency').value;
        var res2 = web_booking.bindsubagency(executequery.Tables[0].Rows[0].Agency_sub_code, document.getElementById('hiddencompcode').value);

        var dsbsa = res2.value;
        if (dsbsa == null) {
            alert(res2.error.description);
            return false;
        }
        document.getElementById('drpagscode').options.length = 0;
        document.getElementById('drpagscode').options[0] = new Option("Select Agency", "0");
        document.getElementById('drpagscode').options.length = 1;
        for (var i = 0; i < dsbsa.Tables[0].Rows.length; ++i) {
            document.getElementById('drpagscode').options[document.getElementById('drpagscode').options.length] = new Option(dsbsa.Tables[0].Rows[i].agency_name, dsbsa.Tables[0].Rows[i].Agency_Code);
            document.getElementById('drpagscode').options.length;
        }


        //////////////////////////////////////////////////////
        if (executequery.Tables[0].Rows[0].Client_code != null) {
            if (executequery.Tables[0].Rows[0].Client != null) {
                if (executequery.Tables[0].Rows[0].Client == "")
                    document.getElementById('txtclient').value = executequery.Tables[0].Rows[0].Client_code;
                else
                    document.getElementById('txtclient').value = executequery.Tables[0].Rows[0].Client + "(" + executequery.Tables[0].Rows[0].Client_code + ")";


            }
            else
                document.getElementById('txtclient').value = executequery.Tables[0].Rows[0].Client_code;     //.ItemArray[14].ToString();
        }
        else {
            document.getElementById('txtclient').value = "";
        }
        //            if(executequery.Tables[0].Rows[0].Client!=null)
        //            {
        //                document.getElementById('txtclient').value = document.getElementById('hiddenclientname').value=executequery.Tables[0].Rows[0].Client;     //.ItemArray[14].ToString();
        //            }    
        if (executequery.Tables[0].Rows[0].Agency_address != null) {
            document.getElementById('txtagencyaddress').value = executequery.Tables[0].Rows[0].Agency_address;
        }
        document.getElementById('txtagencyaddress').title = document.getElementById('txtagencyaddress').value;
        if (executequery.Tables[0].Rows[0].Client_address != null) {
            document.getElementById('txtclientadd').value = executequery.Tables[0].Rows[0].Client_address;
        }
        if (executequery.Tables[0].Rows[0].Agency_code != null) {
            document.getElementById('hiddensubcode').value = document.getElementById('drpagscode').value = executequery.Tables[0].Rows[0].Agency_code;
        }
        if (executequery.Tables[0].Rows[0].Dockit_no != null) {
            document.getElementById('txtdockitno1').value = executequery.Tables[0].Rows[0].Dockit_no;
        }
        if (executequery.Tables[0].Rows[0].execname != null) {
            document.getElementById('txtexecname').value = executequery.Tables[0].Rows[0].execname;
        }
        if (executequery.Tables[0].Rows[0].Executive_zone != null) {
            document.getElementById('hiddenzone').value = document.getElementById('txtexeczone').value = executequery.Tables[0].Rows[0].Executive_zone;
        }
        if (executequery.Tables[0].Rows[0].product != null) {
            document.getElementById('txtproduct').value = executequery.Tables[0].Rows[0].product;
        }

        /////////////////////////////////////////////this is to bind the brand drop down
        res2 = null;
        if (executequery.Tables[0].Rows[0].Product_code != null) {
            res2 = web_booking.brandbind(document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[0].Product_code);
            var dsbrand = res2.value;
            if (dsbrand == null) {
                alert(res2.error.description);
                return false;
            }

////            //document.getElementById('drpbrand').options.length = 0;anuj
////            document.getElementById('drpbrand').options[0] = new Option("Select Brand", "0");
////            document.getElementById('drpbrand').options.length = 1;
////            for (var i = 0; i < dsbrand.Tables[0].Rows.length; ++i) {
////                document.getElementById('drpbrand').options[document.getElementById('drpbrand').options.length] = new Option(dsbrand.Tables[0].Rows[i].brand_name, dsbrand.Tables[0].Rows[i].brand_code);
////                document.getElementById('drpbrand').options.length;
////            }
        }

//        if (executequery.Tables[0].Rows[0].Brand_code == null || executequery.Tables[0].Rows[0].Brand_code.toString() == "") {
//            document.getElementById('drpbrand').options.length = 0;
//            document.getElementById('hiddenbrand').value = "";
//        }
//        else {
//            if (executequery.Tables[0].Rows[0].Brand_code != null) {
//                document.getElementById('hiddenbrand').value = document.getElementById('drpbrand').value = executequery.Tables[0].Rows[0].Brand_code.toString();
//            }
//        }

        res2 = web_booking.varientbind(document.getElementById('hiddencompcode').value, document.getElementById('hiddenbrand').value);
        var dsvarient = res2.value;
        if (dsvarient == null) {
            alert(res2.error.description)
            return false;
        }
        //document.getElementById('drpvarient').options.length = 0;anuj
       // document.getElementById('drpvarient').options[0] = new Option("Select Varient", "0");
        //document.getElementById('drpvarient').options.length = 1;
//        for (var i = 0; i < dsvarient.Tables[0].Rows.length; ++i) {
//            document.getElementById('drpvarient').options[document.getElementById('drpvarient').options.length] = new Option(dsvarient.Tables[0].Rows[i].varient_name, dsvarient.Tables[0].Rows[i].varient_code);
//            document.getElementById('drpvarient').options.length;
//            if (executequery.Tables[0].Rows[0].Brand_code != null && executequery.Tables[0].Rows[0].Variant_code == document.getElementById('drpvarient').options[i].value) {
//                document.getElementById('hiddenvar').value = document.getElementById('drpvarient').value = executequery.Tables[0].Rows[0].Variant_code.toString();
//            }
//        }
//        if (executequery.Tables[0].Rows[0].Variant_code == null || executequery.Tables[0].Rows[0].Variant_code.toString() == "") {
//            document.getElementById('drpvarient').options.length = 0;
//            document.getElementById('hiddenvar').value = "";
//        }

        ////////////////////////////////////////////////////////////////////////////////
        if (executequery.Tables[0].Rows[0].Key_no != null) {
            document.getElementById('txtkeyno').value = executequery.Tables[0].Rows[0].Key_no;
        }
        if (executequery.Tables[0].Rows[0].Bill_remarks != null) {
            document.getElementById('txtbillremark').value = executequery.Tables[0].Rows[0].Bill_remarks;
        }
        if (executequery.Tables[0].Rows[0].Print_remark != null) {
            document.getElementById('txtprintremark').value = executequery.Tables[0].Rows[0].Print_remark;
        }
        if (executequery.Tables[0].Rows[0].Package_code != null) {
            var listpck = executequery.Tables[0].Rows[0].Package_code;
            document.getElementById('hiddenpackage').value = listpck;
            //////////////////this is to bind the package grid on what the value is saved in the database

            res2 = null;
            res2 = web_booking.bindpacforexe(document.getElementById('hiddencompcode').value, listpck);
            var dsexecut = res2.value;
            if (dsexecut == null) {
                alert(res2.error.description);
                return false;
            }
            if (document.getElementById('chkadon').checked == true) {
                bindpackage_adon();
            }
            document.getElementById('drppackagecopy').options.length = 0;
            for (i = 0; i <= dsexecut.Tables[0].Rows.length - 1; i++) {
                if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "") {
                    if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "0") {
                        var arrfor_uom = dsexecut.Tables[0].Rows[i].pck_code.toString().split('@');
                        var res3 = web_booking.getPackageInsert(arrfor_uom[0].toString(), document.getElementById('txtciobookid').value);
                        var dsinsert = res3.value;
                        if (dsinsert == null) {
                            alert(res3.error.description);
                            return false;
                        }
                        var T = dsexecut.Tables[0].Rows[i].Package_Name + "(" + dsinsert.Tables[0].Rows[0].inserts + ")";
                        var V = dsexecut.Tables[0].Rows[i].pck_code + "(" + dsinsert.Tables[0].Rows[0].inserts + ")";
                        if (dsinsert.Tables[0].Rows[0].inserts != null) {
                            document.getElementById('drppackagecopy').options[document.getElementById('drppackagecopy').options.length] = new Option(T, V);
                            document.getElementById('drppackagecopy').options.length;
                        }
                    }
                }
            }

        }

        if (executequery.Tables[0].Rows[0].No_of_insertion != null) {
            document.getElementById('txtinsertion').value = executequery.Tables[0].Rows[0].No_of_insertion;
            document.getElementById('hiddeninsertion').value = executequery.Tables[0].Rows[0].No_of_insertion;
        }

        var start_date = executequery.Tables[0].Rows[0].Insertion_date;
        if (start_date != null) {
            document.getElementById('txtdummydate').value = start_date; //getdatechk.getDate(dateformat, start_date);
        }
        if (executequery.Tables[0].Rows[0].Repeating_day != null) {
            document.getElementById('txtrepeatingdate').value = executequery.Tables[0].Rows[0].Repeating_day;
        }
        var mag = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.lastIndexOf(')'));
        var resT = web_booking.bindAdTypeAgencyWise(mag, document.getElementById('hiddencompcode').value);
        bindBookType_Agency();
        var obj = document.getElementById('drpbooktype');
        /* var resType=web_booking.bindAdTypeAgencyWiseXML();
           
        obj.options.length = 0; 
        if(resType!=null && resType.value!="")
        {
            
        var arr=resType.value.split(",");
        obj.options[0]=new Option("Select Booking Type","0");
        for(var i=0;i<arr.length;i++)
        {
        obj.options[obj.options.length] = new Option(arr[i].toString(),arr[parseFloat(i,10)+1].toString());
        i++;
        }
        }*/
        if (resT.value != "") {
            for (var i = 1; i < obj.options.length; i++) {
                if (resT.value.indexOf(obj[i].value) < 0) {
                    //obj.options.remove(i);
                    obj.remove(i);
                }
            }
        }
        if (executequery.Tables[0].Rows[0].Booking_type != null) {
            document.getElementById('drpbooktype').value = executequery.Tables[0].Rows[0].Booking_type;
        }
        if (executequery.Tables[0].Rows[0].Ad_cat_code != null) {
            document.getElementById('txtcategory').value = executequery.Tables[0].Rows[0].Ad_cat_code;
            document.getElementById('hdncategory').value = executequery.Tables[0].Rows[0].Ad_cat_code;
        }
        //            if (executequery.Tables[0].Rows[0].Ad_sub_cat_code==null || executequery.Tables[0].Rows[0].Ad_sub_cat_code == "" || executequery.Tables[0].Rows[0].Ad_sub_cat_code=="0")
        //            {
        //                document.getElementById('drpadsubcategory').options.length=0;
        //                document.getElementById('hiddenadsubcategory').value = "";
        //            }
        //            else
        //            {
        if (executequery.Tables[0].Rows[0].Ad_cat_code != null) {
            var ds_adsubcat = null;
            ds_adsubcat = web_booking.getadsubcat(document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[0].Ad_cat_code, document.getElementById('hiddencattype').value);
            var dacat = ds_adsubcat.value;
            if (dacat == null) {
                alert(ds_adsubcat.error.description);
                return false;
            }

            ////////////////////////////////////////////////////////////////
//            document.getElementById('drpadsubcategory').options.length = 0;
//            document.getElementById('drpadsubcategory').options[0] = new Option("Select", "0");
//            for (var k = 0; k < dacat.Tables[0].Rows.length; k++) {
//                document.getElementById('drpadsubcategory').options[document.getElementById('drpadsubcategory').options.length] = new Option(dacat.Tables[0].Rows[k].Adv_Subcat_Name, dacat.Tables[0].Rows[k].Adv_Subcat_Code);
//                document.getElementById('drpadsubcategory').options.length;
//            }

        }
//        if (executequery.Tables[0].Rows[0].Ad_sub_cat_code != null) {
//            document.getElementById('hiddenadsubcategory').value = document.getElementById('drpadsubcategory').value = executequery.Tables[0].Rows[0].Ad_sub_cat_code;
//        }
//        if (executequery.Tables[0].Rows[0].Color_code != null) {
//            document.getElementById('drpcolor').value = executequery.Tables[0].Rows[0].Color_code;
//        }
        if (executequery.Tables[0].Rows[0].Uom_code != null) {
            document.getElementById('drpuom').value = executequery.Tables[0].Rows[0].Uom_code;
        }
        if (executequery.Tables[0].Rows[0].Page_position_code != null) {
            document.getElementById('drpposition').value = executequery.Tables[0].Rows[0].Page_position_code;
            pgposprem = "per";
        }
//        if (executequery.Tables[0].Rows[0].Page_type_code != null) {
//            document.getElementById('drppagetype').value = executequery.Tables[0].Rows[0].Page_type_code;
//        }
//        if (executequery.Tables[0].Rows[0].Page_no != null) {
//            document.getElementById('txtpageno').value = executequery.Tables[0].Rows[0].Page_no;
//        }

        res3 = null;
        res3 = web_booking.gettheuom_desc(document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[0].Uom_code);
        var ds_uom_ = res3.value;
        if (ds_uom_ == null) {
            alert(res3.error.description);
            return false;
        }
        if (ds_uom_.Tables[0].Rows.length > 0) {
            document.getElementById('hiddenuomdesc').value = ds_uom_.Tables[0].Rows[0].uom_desc;
        }

        if (executequery.Tables[0].Rows[0].Ad_size_height != null) {
            document.getElementById('txtadsize1').value = executequery.Tables[0].Rows[0].Ad_size_height;
        }
        if (executequery.Tables[0].Rows[0].Ad_size_width != null) {
            document.getElementById('txtadsize2').value = executequery.Tables[0].Rows[0].Ad_size_width;
        }
        // for dealer panel
//   anuj     if (executequery.Tables[0].Rows[0].DEALERPANEL != null && executequery.Tables[0].Rows[0].DEALERPANEL == "Y") {
//            document.getElementById('chkDealerPanel').checked = true;
//        }
//        else {
//            document.getElementById('chkDealerPanel').checked = false;
//        }
        if (executequery.Tables[0].Rows[0].DEALER_H != null) {
            document.getElementById('txtadsize1dealer').value = executequery.Tables[0].Rows[0].DEALER_H;
        }
        if (executequery.Tables[0].Rows[0].DEALER_W != null) {
            document.getElementById('txtadsize2dealer').value = executequery.Tables[0].Rows[0].DEALER_W;
        }
        if (executequery.Tables[0].Rows[0].DEALERTYPE != null) {
            document.getElementById('drpdealertype').value = executequery.Tables[0].Rows[0].DEALERTYPE;
        }
        ////this is to bind the ratecode drpdown
        res3 = null
        if (executequery.Tables[0].Rows[0].Ad_cat_code != null) {
            if (executequery.Tables[0].Rows[0].REVISE_DATE != null && executequery.Tables[0].Rows[0].REVISE_DATE != "" && executequery.Tables[0].Rows[0].REVISE_DATE != "0") {
                res3 = web_booking.bindratecodeforreviserate(executequery.Tables[0].Rows[0].Ad_cat_code, document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[0].REVISE_DATE);
                var dx = res3.value;
                if (dx == null) {
                    alert(dx.error.description);
                    return false;
                }
                document.getElementById('txtratecode').options.length = 0;
                document.getElementById('txtratecode').options[0] = new Option("-Select Rate Code-", "0");
                document.getElementById('txtratecode').options.length = 1;

                for (var i = 0; i < dx.Tables[0].Rows.length; ++i) {
                    document.getElementById('txtratecode').options[document.getElementById('txtratecode').options.length] = new Option(dx.Tables[0].Rows[i].rate_mast_code, dx.Tables[0].Rows[i].rate_mast_code);

                    document.getElementById('txtratecode').options.length;
                }
            }
            else {
                res3 = web_booking.ratebind(executequery.Tables[0].Rows[0].Ad_cat_code, document.getElementById('hiddencompcode').value);
                var dx = res3.value;
                if (dx == null) {
                    alert(dx.error.description);
                    return false;
                }
                document.getElementById('txtratecode').options.length = 0;
                document.getElementById('txtratecode').options[0] = new Option("-Select Rate Code-", "0");
                document.getElementById('txtratecode').options.length = 1;

                for (var i = 0; i < dx.Tables[0].Rows.length; ++i) {
                    document.getElementById('txtratecode').options[document.getElementById('txtratecode').options.length] = new Option(dx.Tables[0].Rows[i].rate_mast_code, dx.Tables[0].Rows[i].rate_mast_code);

                    document.getElementById('txtratecode').options.length;
                }
            }

        }
        if (executequery.Tables[0].Rows[0].Rate_code != null) {
            document.getElementById('txtratecode').value = executequery.Tables[0].Rows[0].Rate_code;
        }
        if (executequery.Tables[0].Rows[0].Scheme_type_code != null) {
            document.getElementById('drpscheme').value = executequery.Tables[0].Rows[0].Scheme_type_code;
        }
        if (executequery.Tables[0].Rows[0].SCHEMEID != null) {
            schemeid = executequery.Tables[0].Rows[0].SCHEMEID;
        }
        else
            schemeid = "";
        if (executequery.Tables[0].Rows[0].Scheme_type_code != null) {
            document.getElementById('hiddenscheme').value = executequery.Tables[0].Rows[0].Scheme_type_code;
        }

        if (executequery.Tables[0].Rows[0].Currency_code != null) {
            document.getElementById('drpcurrency').value = executequery.Tables[0].Rows[0].Currency_code;
        }
        if (executequery.Tables[0].Rows[0].RECEIPT_CURRENCY != null) {
            document.getElementById('drprptcurrency').value = executequery.Tables[0].Rows[0].RECEIPT_CURRENCY;
        }
        if (executequery.Tables[0].Rows[0].CONV_CURR_RATE != null) {
            document.getElementById('hidcurrency_convrate').value = executequery.Tables[0].Rows[0].CONV_CURR_RATE;
        }
        if (executequery.Tables[0].Rows[0].Agrred_rate != null) {
            document.getElementById('txtagreedrate').value = executequery.Tables[0].Rows[0].Agrred_rate;
        }
        if (executequery.Tables[0].Rows[0].Agreed_amount != null) {
            document.getElementById('txtagreedamt').value = executequery.Tables[0].Rows[0].Agreed_amount;
        }
        if (executequery.Tables[0].Rows[0].ACTIVE_AGREEDRATE != null) {
            agreedrate_active = executequery.Tables[0].Rows[0].ACTIVE_AGREEDRATE;
        }
        else {
            agreedrate_active = 0;
        }
        if (executequery.Tables[0].Rows[0].ACTIVE_AGREEDAMT != null) {
            agreedamt_active = executequery.Tables[0].Rows[0].ACTIVE_AGREEDAMT;
        }
        else {
            agreedamt_active = 0;
        }
        if (agreedrate_active == 1) {
            document.getElementById('txtagreedrate').className = ' btextforbookrightsmallbold';
        }
        else {
            document.getElementById('txtagreedrate').className = ' btextforbookrightsmall';
        }
        if (agreedamt_active == 1) {
            document.getElementById('txtagreedamt').className = ' btextforbookrightsmallbold';
        }
        else {
            document.getElementById('txtagreedamt').className = ' btextforbookrightsmall';
        }
        if (executequery.Tables[0].Rows[0].Special_charges != null) {
            document.getElementById('txtextracharges').value = executequery.Tables[0].Rows[0].Special_charges;
        }
        if (executequery.Tables[0].Rows[0].Agency_status != null) {
            document.getElementById('hiddenstatus').value = document.getElementById('txtagencystatus').value = executequery.Tables[0].Rows[0].Agency_status;
        }
//        if (executequery.Tables[0].Rows[0].Agency_type != null) {anuj
//            document.getElementById('txtagencytype').value = executequery.Tables[0].Rows[0].Agency_type;
//        }

         res3 = null;
        if (executequery.Tables[0].Rows[0].Agency_sub_code != null) {
            res3 = web_booking.getstatuspaymode(executequery.Tables[0].Rows[0].Agency_sub_code, executequery.Tables[0].Rows[0].Agency_code, document.getElementById('hiddencompcode').value, document.getElementById('txtdatetime').value, document.getElementById('hiddendateformat').value, "WE0");
            var dch = res3.value;
            if (dch == null) {
                alert(res3.error.description);
                return false;
            }

            document.getElementById('txtagencypaymode').options.length = 0;
            if (dch.Tables[5].Rows.length > 0) {
                for (var i = 0; i < dch.Tables[5].Rows.length; i++) {
                    document.getElementById('txtagencypaymode').options[document.getElementById('txtagencypaymode').options.length] = new Option(dch.Tables[5].Rows[i].payment_mode_name, dch.Tables[5].Rows[i].pay_mode_code);
                    document.getElementById('txtagencypaymode').options.length;
                }
            }
        }
        ///////////////////////////////////////////////////////////////////////////////////////////////////
//        if (executequery.Tables[0].Rows[0].Agency_pay != null) {
//            document.getElementById('hiddenpay').value = document.getElementById('txtagencypaymode').value = executequery.Tables[0].Rows[0].Agency_pay;
//            if (document.getElementById('txtagencypaymode').selectedIndex != -1)
//                document.getElementById('hiddenpaymode').value = document.getElementById('txtagencypaymode').options[document.getElementById('txtagencypaymode').selectedIndex].text;
//        }
        if (executequery.Tables[0].Rows[0].Agency_credit != null) {
            document.getElementById('txtcreditperiod').value = executequery.Tables[0].Rows[0].Agency_credit;
        }
        if (executequery.Tables[0].Rows[0].Total_area != null) {
            document.getElementById('txttotalarea').value = executequery.Tables[0].Rows[0].Total_area;
        }
        if (executequery.Tables[0].Rows[0].Card_rate != null) {
            document.getElementById('txtcardrate').value = executequery.Tables[0].Rows[0].Card_rate;
        }
        if (executequery.Tables[0].Rows[0].Card_amount != null) {
            document.getElementById('txtcardamt').value = executequery.Tables[0].Rows[0].Card_amount;
        }
        if (executequery.Tables[0].Rows[0].Discount != null) {
            document.getElementById('txtdiscount').value = executequery.Tables[0].Rows[0].Discount;
        }
        if (executequery.Tables[0].Rows[0].Discount_per != null) {
            document.getElementById('txtdiscpre').value = executequery.Tables[0].Rows[0].Discount_per;
        }
        if (executequery.Tables[0].Rows[0].Bill_cycle != null) {
            document.getElementById('drpbillcycle').value = executequery.Tables[0].Rows[0].Bill_cycle;
        }
        if (executequery.Tables[0].Rows[0].Revenue_center != null) {
            document.getElementById('drprevenue').value = executequery.Tables[0].Rows[0].Revenue_center;
        }
//        if (document.getElementById('drprevenue').selectedIndex != "-1") {anuj
//            document.getElementById('hiddenbranch').value = document.getElementById('drprevenue').options[document.getElementById('drprevenue').selectedIndex].text; //drprevenue.SelectedItem.Text.ToString();
//        }
        ////this is to bind the bill pay mode
        document.getElementById('drppaymenttype').options.length = 0;
        if (dch.Tables[5].Rows.length > 0) {
            for (var i = 0; i < dch.Tables[5].Rows.length; i++) {
                document.getElementById('drppaymenttype').options[document.getElementById('drppaymenttype').options.length] = new Option(dch.Tables[5].Rows[i].payment_mode_name, dch.Tables[5].Rows[i].pay_mode_code);
                document.getElementById('drppaymenttype').options.length;
            }
        }
        if (executequery.Tables[0].Rows[0].Bill_pay != null) {
            document.getElementById('hiddenbillpay').value = document.getElementById('drppaymenttype').value = executequery.Tables[0].Rows[0].Bill_pay;
        }
        var ag = web_booking.GETCASH_PAY(document.getElementById('hiddencompcode').value, document.getElementById('drppaymenttype').value);
        var ds_n = ag.value;
        var cashdiscount = 'N';
        if (ds_n != null && ds_n.Tables[0].Rows.length > 0) {
            cashdiscount = ds_n.Tables[0].Rows[0].CASHDISCOUNT;
        }
        if (document.getElementById('drppaymenttype').value == "CH0" || document.getElementById('drppaymenttype').value == "DD0" || document.getElementById('drppaymenttype').value == 'PO0' || document.getElementById('drppaymenttype').value == 'AD0')  //CR0 is Credit Card code and DD0 is demand draft
        {
         //   document.getElementById('tdchqno').style.display = "";
            //document.getElementById('tdchqdate').style.display = "";
            //document.getElementById('tdchqamt').style.display = "";
          //  document.getElementById('tdbankname').style.display = "";
          //  document.getElementById('tdourbank').style.display = "";


            //document.getElementById('tdtextchqno').style.display = "";
            //document.getElementById('tdtextchqdate').style.display = "";
            //document.getElementById('tdtextchqamt').style.display = "";
            //document.getElementById('tdtextbankname').style.display = "";
            //document.getElementById('tdtextourbank').style.display = "";
        }
        if (document.getElementById('drppaymenttype').value == "CR0")  //CR0 is Credit Card code
        {
            document.getElementById('tdcarname').style.display = "";
            document.getElementById('tdtxtcarname').style.display = "";
            document.getElementById('tdtype').style.display = "";
            document.getElementById('tddrptyp').style.display = "";
            document.getElementById('tdexdat').style.display = "";

            document.getElementById('tdtxtexdat').style.display = "";
            document.getElementById('tdcardno').style.display = "";
            document.getElementById('tdtxtcarno').style.display = "";
            //                document.getElementById('txtcardname').value=executequery.Tables[0].Rows[rownumEx].Card_name;
            //                document.getElementById('drptype').value=executequery.Tables[0].Rows[rownumEx].Card_type;
            //                document.getElementById('txtcardno').value=executequery.Tables[0].Rows[rownumEx].Card_number;  
            //                document.getElementById('drpmonth').value=executequery.Tables[0].Rows[rownumEx].Card_month;  
            //                document.getElementById('drpyear').value=executequery.Tables[0].Rows[rownumEx].Card_year;

            document.getElementById('tdchqno').style.display = "none";
            document.getElementById('tdchqdate').style.display = "none";
            document.getElementById('tdchqamt').style.display = "none";
            document.getElementById('tdbankname').style.display = "none";
            document.getElementById('tdourbank').style.display = "none";
            z
            document.getElementById('tdtextchqno').style.display = "none";
            document.getElementById('tdtextchqdate').style.display = "none";
            document.getElementById('tdtextchqamt').style.display = "none";
            document.getElementById('tdtextbankname').style.display = "none";
            document.getElementById('tdtextourbank').style.display = "none";

        }
        else if (document.getElementById('drppaymenttype').value == "CA0") {
           // document.getElementById('cashrecvd').style.display = "";
            // document.getElementById('tdcashrecvd').style.display="";
//            if (executequery.Tables[0].Rows[0].CASHDISCOUNT == null || executequery.Tables[0].Rows[0].CASHDISCOUNT == "null")
//                //document.getElementById('txtcashdiscount').value = "0";
//            else
//                //document.getElementById('txtcashdiscount').value = executequery.Tables[0].Rows[0].CASHDISCOUNT;
            if (executequery.Tables[0].Rows[0].CASHDISCTYPE == null || executequery.Tables[0].Rows[0].CASHDISCTYPE == "null")
                document.getElementById('hiddencashdiscper').value = "";
            else
                document.getElementById('hiddencashdiscper').value = executequery.Tables[0].Rows[0].CASHDISCTYPE;

//            if (executequery.Tables[0].Rows[0].CASH_RECIEVED == null || executequery.Tables[0].Rows[0].CASH_RECIEVED == "null")
//                //document.getElementById('drpcashrecieved').value = "0";
//            else
                //document.getElementById('drpcashrecieved').value = executequery.Tables[0].Rows[0].CASH_RECIEVED;
            document.getElementById('hiddencashrecieved').value = executequery.Tables[0].Rows[0].CASH_RECIEVED;

            //document.getElementById('drpcashrecieved').disabled = true;
            //document.getElementById('txtcashdiscount').disabled = true;
        }
        if (cashdiscount == 'Y') {
            //document.getElementById('cashrecvd').style.display = "";anuj
            // document.getElementById('tdcashrecvd').style.display="";
            //if (executequery.Tables[0].Rows[0].CASHDISCOUNT == null || executequery.Tables[0].Rows[0].CASHDISCOUNT == "null")
                //document.getElementById('txtcashdiscount').value = "0";
           // else
                //document.getElementById('txtcashdiscount').value = executequery.Tables[0].Rows[0].CASHDISCOUNT;
            if (executequery.Tables[0].Rows[0].CASHDISCTYPE == null || executequery.Tables[0].Rows[0].CASHDISCTYPE == "null")
                document.getElementById('hiddencashdiscper').value = "";
            else
                document.getElementById('hiddencashdiscper').value = executequery.Tables[0].Rows[0].CASHDISCTYPE;

//         anuj   if (executequery.Tables[0].Rows[0].CASH_RECIEVED == null || executequery.Tables[0].Rows[0].CASH_RECIEVED == "null")
//                document.getElementById('drpcashrecieved').value = "0";
//            else
//                document.getElementById('drpcashrecieved').value = executequery.Tables[0].Rows[0].CASH_RECIEVED;
            document.getElementById('hiddencashrecieved').value = executequery.Tables[0].Rows[0].CASH_RECIEVED;

           // document.getElementById('drpcashrecieved').disabled = true;
            //document.getElementById('txtcashdiscount').disabled = true;
        }
        else {
            //document.getElementById('cashrecvd').style.display = "none";
        }
        if (executequery.Tables[0].Rows[0].Bill_height != null) {
            document.getElementById('txtbillheight').value = executequery.Tables[0].Rows[0].Bill_height;
        }
        if (executequery.Tables[0].Rows[0].Bill_width != null) {
            document.getElementById('txtbillwidth').value = executequery.Tables[0].Rows[0].Bill_width;
        }
        //////////////this is to bind the bill to 
        res3 = null;
        if (executequery.Tables[0].Rows[0].Agency_sub_code != null) {
            res3 = web_booking.getbillval(executequery.Tables[0].Rows[0].Agency_sub_code, document.getElementById('hiddencompcode').value);
            var dbt = res3.value;
            if (dbt == null) {
                alert(res3.error.description);
                return false;
            }

            ////////////////////////////////////////////////////
            document.getElementById('drpbillto').options.length = 0;
            var client_val = document.getElementById('txtclient').value;
            var client_name = document.getElementById('txtclient').value;
            if (document.getElementById('txtclient').value.indexOf("(".toString()) > 0) {
                client_val = document.getElementById('txtclient').value.substring(document.getElementById('txtclient').value.lastIndexOf("(") + 1, document.getElementById('txtclient').value.length - 1); //document.getElementById('txtclient').value.substring(0,document.getElementById('txtclient').value.lastIndexOf("("));
                client_name = document.getElementById('txtclient').value.substring(0, document.getElementById('txtclient').value.lastIndexOf("("));
            }
            document.getElementById('drpbillto').options[0] = new Option(client_name, client_val);
            for (var k = 0; k < dbt.Tables[0].Rows.length; k++) {
                if (dbt.Tables[0].Rows[k].bill_to == "")
                    document.getElementById('drpbillto').options[document.getElementById('drpbillto').options.length] = new Option(dbt.Tables[0].Rows[k].agency_name, dbt.Tables[0].Rows[k].SUB_agency_code);
                else
                    document.getElementById('drpbillto').options[document.getElementById('drpbillto').options.length] = new Option(dbt.Tables[0].Rows[k].agency_name, dbt.Tables[0].Rows[k].bill_to);
                document.getElementById('drpbillto').options.length;
            }
        }
        if (executequery.Tables[0].Rows[rownumEx].Bill_to != null) {
            document.getElementById('hiddenbillto').value = executequery.Tables[0].Rows[rownumEx].Bill_to;
        }
        if (executequery.Tables[0].Rows[0].Bill_to != null) {
            document.getElementById('drpbillto').value = executequery.Tables[0].Rows[0].Bill_to;
        }
        if (executequery.Tables[0].Rows[0].Invoices != null) {
            document.getElementById('txtinvoice').value = executequery.Tables[0].Rows[0].Invoices;
        }
        if (executequery.Tables[0].Rows[0].Vts != null) {
            document.getElementById('txtvts').value = executequery.Tables[0].Rows[0].Vts;
        }
        if (executequery.Tables[0].Rows[0].Bill_add != null) {
            document.getElementById('txtbilladdress').value = executequery.Tables[0].Rows[0].Bill_add;
        }
        if (executequery.Tables[0].Rows[0].Trade_disc != null) {
            document.getElementById('txttradedisc').value = executequery.Tables[0].Rows[0].Trade_disc;
            //                document.getElementById('hiddentradedisc').value= executequery.Tables[0].Rows[0].COMM_RATE;
            //                document.getElementById('hiddenagcommflag').value=executequery.Tables[0].Rows[0].ADDFLAG;
        }
        if (executequery.Tables[0].Rows[0].ADDFLAG != null) {
            document.getElementById('hiddenagcommflag').value = executequery.Tables[0].Rows[0].ADDFLAG;
        }
        if (executequery.Tables[0].Rows[0].COMM_RATE != null) {
            document.getElementById('hiddentradedisc').value = executequery.Tables[0].Rows[0].COMM_RATE;
        }
        if (executequery.Tables[0].Rows[0].CHKTRADE != null) {
            if (executequery.Tables[0].Rows[0].CHKTRADE == "1")
                document.getElementById('chktrade').checked = true;
            else
                document.getElementById('chktrade').checked = false;
        }
        if (executequery.Tables[0].Rows[0].BILL_HOLD != null) {
            if (executequery.Tables[0].Rows[0].BILL_HOLD == "Y")
                document.getElementById('chkholdbill').checked = true;
            else
                document.getElementById('chkholdbill').checked = false;
        }
        if (executequery.Tables[0].Rows[0].CANCELLATION_CHARGE != null) {
            if (executequery.Tables[0].Rows[0].CANCELLATION_CHARGE == "1")
                document.getElementById('chkcanclecharges').checked = true;
            else
                document.getElementById('chkcanclecharges').checked = false;
        }
        if (executequery.Tables[0].Rows[0].Agency_out != null) {
            document.getElementById('txtagencyoutstand').value = executequery.Tables[0].Rows[0].Agency_out;
        }
        //recorrect it
        if (executequery.Tables[0].Rows[0].Campaign != null)
            //document.getElementById('txtcamp').value = executequery.Tables[0].Rows[0].Campaign;
        if (executequery.Tables[0].Rows[0].Page_prem != null)
            document.getElementById('drppageprem').value = executequery.Tables[0].Rows[0].Page_prem;
        if (executequery.Tables[0].Rows[0].Prem_per != null) {
            document.getElementById('txtpremper').value = executequery.Tables[0].Rows[0].Prem_per;
        }

        //***

        if (executequery.Tables[0].Rows[0].Page_amount != null) {
            document.getElementById('txtpageamt').value = executequery.Tables[0].Rows[0].Page_amount;
        }
        if (executequery.Tables[0].Rows[0].Gross_amount != null) {
            document.getElementById('txtgrossamt').value = executequery.Tables[0].Rows[0].Gross_amount;
        }

        //Inserting in hidden field to compare new and  Previous amount 
        if (executequery.Tables[0].Rows[0].Bill_amount != null) {
            document.getElementById('hiddenprevamt').value = executequery.Tables[0].Rows[0].Bill_amount;
        }
        //new field
        if (executequery.Tables[0].Rows[0].LOCALGROSSAMT != null) {
            document.getElementById('txtgrossamtlocal').value = executequery.Tables[0].Rows[0].LOCALGROSSAMT;
        }

        //Inserting in hidden field to compare new and  Previous amount 
        if (executequery.Tables[0].Rows[0].LOCALBILLAMT != null) {
            document.getElementById('txtbillamtlocal').value = executequery.Tables[0].Rows[0].LOCALBILLAMT;
        }

        if (executequery.Tables[0].Rows[0].Bill_amount != null) {
            document.getElementById('txtbillamt').value = executequery.Tables[0].Rows[0].Bill_amount;
            document.getElementById('hidden').value = document.getElementById('txtbillamt').value;
        }
        if (executequery.Tables[0].Rows[0].Box_code != null) {
            document.getElementById('drpboxcode').value = executequery.Tables[0].Rows[0].Box_code;
        }
        if (executequery.Tables[0].Rows[0].Box_no != null) {
            document.getElementById('txtboxno').value = executequery.Tables[0].Rows[0].Box_no;
        }
        if (executequery.Tables[0].Rows[0].Box_agency.toString() == "1") {
            document.getElementById('chkage').checked = true;
        }
        else {
            document.getElementById('chkage').checked = false;
        }
        if (executequery.Tables[0].Rows[0].Box_client.toString() == "1") {
            document.getElementById('chkclie').checked = true;
        }
        else {
            document.getElementById('chkclie').checked = false;
        }
        if (executequery.Tables[0].Rows[0].Box_address != null) {
            document.getElementById('txtboxaddress').value = executequery.Tables[0].Rows[0].Box_address;
        }
        if (executequery.Tables[0].Rows[0].Tfn == "1") {
            document.getElementById('chktfn').value = true;
        }
        else {
            document.getElementById('chktfn').value = false;
        }
        if (executequery.Tables[0].Rows[0].Ad_size_column != null) {
            document.getElementById('txtcolum').value = executequery.Tables[0].Rows[0].Ad_size_column;
        }
        //recorrect it
        if (executequery.Tables[0].Rows[0].Special_disc_per != null) {
            document.getElementById('txtspediscper').value = executequery.Tables[0].Rows[0].Special_disc_per;
        }
        if (executequery.Tables[0].Rows[0].Space_disc_per != null) {
            document.getElementById('txtspadiscper').value = executequery.Tables[0].Rows[0].Space_disc_per;
        }
        //***
        if (executequery.Tables[0].Rows[0].Special_discount != null) {
            document.getElementById('txtspedisc').value = executequery.Tables[0].Rows[0].Special_discount;
        }
        if (executequery.Tables[0].Rows[0].Space_discount != null) {
            document.getElementById('txtspacedisc').value = executequery.Tables[0].Rows[0].Space_discount;
        }
        if (executequery.Tables[0].Rows[0].Paid_ins != null) {
            document.getElementById('txtpaid').value = executequery.Tables[0].Rows[0].Paid_ins;
        }
        if (executequery.Tables[0].Rows[0].Contract_rate != null) {
            document.getElementById('txtdealrate').value = executequery.Tables[0].Rows[0].Contract_rate;
        }
        if (document.getElementById('txtdealrate').value != "") {
            document.getElementById('chkcontract').checked = true;
        }
        if (executequery.Tables[0].Rows[0].Deviation != null) {
            document.getElementById('txtdeviation').value = executequery.Tables[0].Rows[0].Deviation;
        }
        if (executequery.Tables[0].Rows[0].Contract_name != null) {
            document.getElementById('txtcontractname').value = executequery.Tables[0].Rows[0].Contract_name;
            hidcontract = executequery.Tables[0].Rows[0].CONTRACT_NAME1;
        }
        if (executequery.Tables[0].Rows[0].Contract_type != null) {
            document.getElementById('txtcontracttype').value = executequery.Tables[0].Rows[0].Contract_type;
        }
        if (executequery.Tables[0].Rows[0].Variant_code == "") {
            //document.getElementById('drpvarient').options.length = 0;
        }
      //anuj  document.getElementById('hiddenvar').value = document.getElementById('drpvarient').value = executequery.Tables[0].Rows[0].Variant_code;

        if (executequery.Tables[0].Rows[0].Card_name != null) {
           //anuj document.getElementById('txtcardname').value = executequery.Tables[0].Rows[0].Card_name;
        }
        if (executequery.Tables[0].Rows[0].VAT_CODE != null) {
            document.getElementById('hdnvts').value = executequery.Tables[0].Rows[0].VAT_CODE;
        }
        else {
            document.getElementById('hdnvts').value = "";
        }
        if (executequery.Tables[0].Rows[0].Card_type != null) {
            //an document.getElementById('drptype').value = executequery.Tables[0].Rows[0].Card_type;
        }
        if (executequery.Tables[0].Rows[0].Card_month != null) {
          //  document.getElementById('drpmonth').value = executequery.Tables[0].Rows[0].Card_month;
        }
        if (executequery.Tables[0].Rows[0].Card_year != null) {
            //document.getElementById('drpyear').value = executequery.Tables[0].Rows[0].Card_year;
        }
        if (executequery.Tables[0].Rows[0].Card_number != null) {
            //document.getElementById('txtcardno').value = executequery.Tables[0].Rows[0].Card_number;
        }
        if (executequery.Tables[0].Rows[0].Receipt_no != null) {
            document.getElementById('hiddenreceiptno').value = document.getElementById('txtreceipt').value = executequery.Tables[0].Rows[0].Receipt_no;
        }
        else
            document.getElementById('hiddenreceiptno').value = document.getElementById('txtreceipt').value = "";
        //get check info
        if (document.getElementById('drppaymenttype').value == "CH0" || document.getElementById('drppaymenttype').value == "DD0" || document.getElementById('drppaymenttype').value == 'PO0' || document.getElementById('drppaymenttype').value == 'AD0') {
            /* var ds_chq=web_booking.ChequeInfo(document.getElementById('hiddencompcode').value,document.getElementById('txtreceipt').value);
            if(ds_chq.value!=null)
            {
            if(ds_chq.value.Tables[0].Rows.length>0)
            {
            if(ds_chq.value.Tables[0].Rows[0].chno!=null)
            document.getElementById('ttextchqno').value=ds_chq.value.Tables[0].Rows[0].chno;  
            else
            document.getElementById('ttextchqno').value="";    
            var cDate="";
            if(ds_chq.value.Tables[0].Rows[0].chdt!=null)
            {
            if(document.getElementById('hiddendateformat').value=="dd/mm/yyyy")
            {
            cDate=ds_chq.value.Tables[0].Rows[0].chdt;  
            }          
            else if(document.getElementById('hiddendateformat').value=="mm/dd/yyyy")
            {
            var txt=ds_chq.value.Tables[0].Rows[0].chdt.split("/");
            cDate=txt[1] + "/" + txt[0] + "/" + txt[2];
            }
            else if(document.getElementById('hiddendateformat').value=="yyyy/mm/dd")
            {
            var txt=ds_chq.value.Tables[0].Rows[0].chdt.split("/");
            cDate=txt[2] + "/" + txt[1] + "/" + txt[0];
            }
            }        
            document.getElementById('ttextchqdate').value=cDate; 
            if(ds_chq.value.Tables[0].Rows[0].amount!=null) 
            document.getElementById('ttextchqamt').value=ds_chq.value.Tables[0].Rows[0].amount;  
            else
            document.getElementById('ttextchqamt').value="";    
            if(document.getElementById('ttextchqamt').value.indexOf("-")>=0)
            document.getElementById('ttextchqamt').value=document.getElementById('ttextchqamt').value.replace("-","");
            if(ds_chq.value.Tables[0].Rows[0].bank!=null)    
            document.getElementById('ttextbankname').value=ds_chq.value.Tables[0].Rows[0].bank;                          
            else
            document.getElementById('ttextbankname').value="";   
                                
            if(ds_chq.value.Tables[0].Rows[0].cashbank!=null)    
            document.getElementById('drpourbank').value=ds_chq.value.Tables[0].Rows[0].cashbank;                          
            else
            document.getElementById('drpourbank').value="0";  
                                 
            }
            }*/
            if (executequery.Tables[0].Rows[0].CHK_DATE != null) {
                document.getElementById('ttextchqdate').value = executequery.Tables[0].Rows[0].CHK_DATE;
            }
            if (executequery.Tables[0].Rows[0].CHK_AMT != null) {
                document.getElementById('ttextchqamt').value = executequery.Tables[0].Rows[0].CHK_AMT;
            }
            if (executequery.Tables[0].Rows[0].CHK_BANK_NAME != null) {
                document.getElementById('ttextbankname').value = executequery.Tables[0].Rows[0].CHK_BANK_NAME;
            }
            if (executequery.Tables[0].Rows[0].OUR_BANK != null) {
                document.getElementById('drpourbank').value = executequery.Tables[0].Rows[0].OUR_BANK;
            }
            if (executequery.Tables[0].Rows[0].CHK_NO != null) {
                document.getElementById('ttextchqno').value = executequery.Tables[0].Rows[0].CHK_NO;
            }

        }

        else if (document.getElementById('drppaymenttype').value == "CR0") {
            var ds_chq = web_booking.ChequeInfo(document.getElementById('hiddencompcode').value, document.getElementById('txtreceipt').value);
            if (ds_chq.value != null) {
                if (ds_chq.value.Tables[0].Rows.length > 0) {
                    if (ds_chq.value.Tables[0].Rows[0].bank != null)
                        document.getElementById('txtcardname').value = ds_chq.value.Tables[0].Rows[0].bank;
                    else
                        document.getElementById('txtcardname').value = "";
                    if (ds_chq.value.Tables[0].Rows[0].remark != null)
                        document.getElementById('drptype').value = ds_chq.value.Tables[0].Rows[0].remark;
                    else
                        document.getElementById('drptype').value = "";
                    if (ds_chq.value.Tables[0].Rows[0].chno != null)
                        document.getElementById('txtcardno').value = ds_chq.value.Tables[0].Rows[0].chno;
                    else
                        document.getElementById('txtcardno').value = "";
                    if (ds_chq.value.Tables[0].Rows[0].chdt != null) {
                        var txt = ds_chq.value.Tables[0].Rows[0].chdt.split("/");
                        document.getElementById('drpmonth').value = parseInt(txt[1], 10);
                        document.getElementById('drpyear').value = txt[2];
                    }
                }
            }
        }
        //*********************
        //}    
        if (executequery.Tables[0].Rows[0].Material_status != null) {
            document.getElementById('drpmatsta').value = executequery.Tables[0].Rows[0].Material_status;
        }



        if (executequery.Tables[0].Rows[0].Ad_sub_cat_code == null) // || executequery.Tables[0].Rows[0].Ad_Subcat3.toString() == "")
        {
          //  document.getElementById('drpadcat3').options.length = 0;
            //document.getElementById('hiddenadscat3').value = "";
        }
        else {
            res3 = null;
            res3 = web_booking.getvalfromadcat3(executequery.Tables[0].Rows[0].Ad_sub_cat_code, document.getElementById('hiddencompcode').value, "0");
            var dacat = res3.value;
            if (dacat == null) {
                alert(dacat.error.description);
                return false;
            }

            ////////////////////////////////////////////////////////////////
//            document.getElementById('drpadcat3').options.length = 0;
//            document.getElementById('drpadcat3').options[0] = new Option("Select", "0");
//            for (var k = 0; k < dacat.Tables[0].Rows.length; k++) {
//                document.getElementById('drpadcat3').options[document.getElementById('drpadcat3').options.length] = new Option(dacat.Tables[0].Rows[k].catname, dacat.Tables[0].Rows[k].catcode);
//                document.getElementById('drpadcat3').options.length;
//            }

        }

//    anuj    if (executequery.Tables[0].Rows[0].Ad_Subcat3 != null) {
//            document.getElementById('hiddenadscat3').value = document.getElementById('drpadcat3').value = executequery.Tables[0].Rows[0].Ad_Subcat3;
//        }

        ////////////////////this is to bind the adcat4 drp down
   if (executequery.Tables[0].Rows[0].Ad_Subcat3 == null || executequery.Tables[0].Rows[0].Ad_Subcat3.toString() == "") {
//            document.getElementById('drpadcat4').options.length = 0;
//            document.getElementById('hiddenadscat4').value = "";
       }
        else {
            ////////////when 1 than bind the adscat4 drp down
            res3 = null;
            res3 = web_booking.getvalfromadcat3(executequery.Tables[0].Rows[0].Ad_Subcat3, document.getElementById('hiddencompcode').value, "1");
            var dacat = res3.value;
            if (dacat == null) {
                alert(dacat.error.description);
                return false;
            }


            ////////////////////////////////////////////////////////////////
            document.getElementById('drpadcat4').options.length = 0;
            document.getElementById('drpadcat4').options[0] = new Option("Select", "0");
            for (var k = 0; k < dacat.Tables[0].Rows.length; k++) {
                document.getElementById('drpadcat4').options[document.getElementById('drpadcat4').options.length] = new Option(dacat.Tables[0].Rows[k].Cat_Name, dacat.Tables[0].Rows[k].Cat_Code);
                document.getElementById('drpadcat4').options.length;
            }
        }
        if (executequery.Tables[0].Rows[0].Ad_Subcat4 != null) {
            //document.getElementById('hiddenadscat4').value = document.getElementById('drpadcat4').value = executequery.Tables[0].Rows[0].Ad_Subcat4;
        }

        ///bind adcat5 drpdown
        if (executequery.Tables[0].Rows[0].Ad_Subcat4 == null || executequery.Tables[0].Rows[0].Ad_Subcat4.toString() == "") {
            //document.getElementById('drpadcat5').options.length = 0;
           // document.getElementById('hiddenadscat5').value = "";
        }
        else {
            ////////////when 1 than bind the adscat4 drp down
            res3 = null;
            res3 = web_booking.getvalfromadcat3(executequery.Tables[0].Rows[0].Ad_Subcat4, document.getElementById('hiddencompcode').value, "2");
            var dacat = res3.value;
            if (dacat == null) {
                alert(dacat.error.description);
                return false;
            }


            ////////////////////////////////////////////////////////////////
            document.getElementById('drpadcat5').options.length = 0;
            document.getElementById('drpadcat5').options[0] = new Option("Select", "0");
            for (var k = 0; k < dacat.Tables[0].Rows.length; k++) {
                document.getElementById('drpadcat5').options[document.getElementById('drpadcat5').options.length] = new Option(dacat.Tables[0].Rows[k].Cat_Name, dacat.Tables[0].Rows[k].Cat_Code);
                document.getElementById('drpadcat5').options.length;
            }
        }
        if (executequery.Tables[0].Rows[0].Ad_subcat5 != null) {
            ////document.getElementById('hiddenadscat5').value = document.getElementById('drpadcat5').value = executequery.Tables[0].Rows[0].Ad_subcat5;
        }


        //////bind the bg color drp down 
        ////            if(executequery.Tables[0].Rows[0].Bg_color!=null)
        ////            {
        ////                document.getElementById('drpbgcolor').value = executequery.Tables[0].Rows[0].Bg_color;
        ////            }    
        ////            if(executequery.Tables[0].Rows[0].Bullet_code!=null)
        ////            {
        ////                document.getElementById('drpbullet').value = executequery.Tables[0].Rows[0].Bullet_code;
        ////            }    
        ////            if(executequery.Tables[0].Rows[0].Bullet_premium!=null)
        ////            {
        ////                document.getElementById('txtbullprem').value = executequery.Tables[0].Rows[0].Bullet_premium;
        ////            }   

        if (executequery.Tables[0].Rows[0].RETAINER1 != null) {
            document.getElementById('drpretainer').value = executequery.Tables[0].Rows[0].RETAINER1;
        }
        if (executequery.Tables[0].Rows[0].ADD_AGENCY_COMM != null) {
            if (document.getElementById('txtaddagencycommrate') != null) {
                document.getElementById('txtaddagencycommrate').value = executequery.Tables[0].Rows[0].ADD_AGENCY_COMM;
            }
        }
        getSharing();
        if (document.getElementById('drpbooktype').value == "2" || document.getElementById('drpbooktype').value == "6")
            getFMGRef();
        getmultiexe();
    }

    else {
        alert("Your Search Produces No Result");
        clearClick();
        return false;
    }

    // }
    //updateStatus();
    document.getElementById('btnlast').disabled = false;
    document.getElementById('btnnext').disabled = false;
    document.getElementById('btnfirst').disabled = true;
    document.getElementById('btnprevious').disabled = true;

    if (executequery.Tables[0].Rows.length - 1 == 0) {
        document.getElementById('btnfirst').disabled = true;
        document.getElementById('btnprevious').disabled = true;
        document.getElementById('btnnext').disabled = true;
        document.getElementById('btnlast').disabled = true;
    }
    ////// we have called a javascript function to show the grid during execution mode
    //ScriptManager.RegisterClientScriptBlock(this, typeof(web_booking), "cc", "bindpackage()", true);
    document.getElementById('btndel').disabled = true;

   // showcardinfo(executequery.Tables[0].Rows[0].Bill_pay);anuj
   showgridexecute();
    document.getElementById('txtRetainercomm').disabled = true;
    if (document.getElementById('txtaddagencycommrateamt') != null) {
        document.getElementById('txtaddagencycommrateamt').disabled = true;
        document.getElementById('txtaddagencycommrate').disabled = true;
    }
   //anuj document.getElementById('drpadstype').disabled = true;
    //        if (document.getElementById('hiddenaudit').value != "")
    //        {
    //            modifyClick();
    //        }        

    setButtonImages();
    return false;
}


function getSharing() {
    sharepub = "";
    var res = web_booking.getPubSharing("", document.getElementById('hiddencompcode').value, document.getElementById('txtciobookid').value);
    if (res.error != null) {
        alert(res.error.description);
        return false;
    }
    var ds = res.value;
    if (ds != null) {
        for (var i = 0; i < ds.Tables[0].Rows.length; i++) {
            if (sharepub == "")
                sharepub = ds.Tables[0].Rows[i].PUBLICATION + "~" + ds.Tables[0].Rows[i].SHARING + "~" + ds.Tables[0].Rows[i].TYPE;
            else
                sharepub = sharepub + "document.getElementById" + ds.Tables[0].Rows[i].PUBLICATION + "~" + ds.Tables[0].Rows[i].SHARING + "~" + ds.Tables[0].Rows[i].TYPE;
        }
    }
}




function getmultiexe() {
    multiselect = "";
    var resb = web_booking.fetchmultiexe(document.getElementById('txtciobookid').value, document.getElementById('hiddencompcode').value);
    if (resb.error != null) {
        alert(resb.error.description);
        return false;
    }
    var dsb = resb.value;
    if (dsb != null) {
        for (var i = 0; i < dsb.Tables[0].Rows.length; i++) {
            if (multiselect == "")
                multiselect = dsb.Tables[0].Rows[i].TEAM_SHARE + "~" + dsb.Tables[0].Rows[i].execod;
            else
                multiselect = multiselect + "document.getElementById" + dsb.Tables[0].Rows[i].TEAM_SHARE + "~" + dsb.Tables[0].Rows[i].execod;
        }
    }
}



function showcardinfo(caval) {
    if (caval == "CR0") {
        document.getElementById('tdcarname').style.display = "";
        document.getElementById('tdtxtcarname').style.display = "";
        document.getElementById('tdtype').style.display = "";
        document.getElementById('tddrptyp').style.display = "";
        document.getElementById('tdexdat').style.display = "";
        document.getElementById('tdtxtexdat').style.display = "";
        document.getElementById('tdcardno').style.display = "";
        document.getElementById('tdtxtcarno').style.display = "";
        document.getElementById('drpourbank').style.display = "";
        return false;
    }
    else {
        document.getElementById('tdcarname').style.display = "none";
        document.getElementById('tdtxtcarname').style.display = "none";
        document.getElementById('tdtype').style.display = "none";
        document.getElementById('tddrptyp').style.display = "none";
        document.getElementById('tdexdat').style.display = "none";
        if ((document.getElementById('txtagencypaymode').value == "CR1" && document.getElementById('creditreceipt_allow').value == "Y"))
            document.getElementById('print').style.display = "none";
        document.getElementById('tdtxtexdat').style.display = "none";
        document.getElementById('tdcardno').style.display = "none";
        document.getElementById('tdtxtcarno').style.display = "none";

        return false;

    }
}



function nextClick() {
    rownumEx++;
    buttonmovement(rownumEx);
    document.getElementById('btnfirst').disabled = false;
    document.getElementById('btnlast').disabled = false;
    document.getElementById('btnprevious').disabled = false;
    document.getElementById('btnnext').disabled = false;
    var count = executequery.Tables[0].Rows.length - 1;
    if (rownumEx == count) {
        document.getElementById('btnnext').disabled = true;
        document.getElementById('btnlast').disabled = true;
    }
    setButtonImages();
    return false;
}


function alertContents(httpRequest) {
    debugger;
    if (httpRequest.readyState == 4) {
        if (httpRequest.status == 200) {
            var flag = httpRequest.responseText;
        }
        else {
            alert('There was a problem with the request.');
        }
    }

}



function buttonmovement(rownumEx) {
    var msg = checkSession();
    if (msg == false) {
        window.location.href = "login.aspx";
        return false;
    }
    clearClick();
    document.getElementById('hiddensavemod').value = "1";
    document.getElementById('tblinsert').innerHTML = '';
    document.getElementById('LinkButton1').disabled = false;
    document.getElementById('LinkButton2').disabled = false;
    document.getElementById('LinkButton3').disabled = false;
    document.getElementById('LinkButton4').disabled = false;
    document.getElementById('LinkButton5').disabled = false;
//    document.getElementById('LinkButton6').disabled = false;
//    document.getElementById('LinkButton7').disabled = false;

    //////////////////////////////////////////////////////////////////////////

    if (executequery == null) {
        alert(res1.error.description);
        return false;
    }
    if (executequery.Tables[0].Rows.length > 0) {
        if (executequery.Tables[0].Rows[rownumEx].prev_booking != null && executequery.Tables[0].Rows[rownumEx].prev_booking != "") {
            var res = web_booking.checkCIOIDReference(document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[rownumEx].cio_booking_id);
            if (res.value != null) {
                if (executequery.Tables[0].Rows[rownumEx].cio_booking_id != res.value) {
                    alert("CIO ID " + executequery.Tables[0].Rows[rownumEx].cio_booking_id + " has been ReScheduled to New CIO ID " + res.value);
                    return false;
                }
            }
        }
        if (executequery.Tables[0].Rows[rownumEx].PACKAGE_TYPE != null) {
            if (executequery.Tables[0].Rows[rownumEx].PACKAGE_TYPE == "A") {
                document.getElementById('chkadon').checked = true;
                document.getElementById('lbreference').style.display = "block";
                document.getElementById('tdref').style.display = "block";
                //  document.getElementById('btnrefid').style.display="block";
            }
            else {
                document.getElementById('chkadon').checked = false;
                document.getElementById('lbreference').style.display = "none";
                document.getElementById('tdref').style.display = "none";
                // document.getElementById('btnrefid').style.display="none";
            }
        }
        if (executequery.Tables[0].Rows[rownumEx].AD_REFID != null) {
            document.getElementById('txtreference').value = executequery.Tables[0].Rows[rownumEx].AD_REFID;
        }
        else {
            document.getElementById('txtreference').value = "";
        }

        if (executequery.Tables[0].Rows[rownumEx].DISC_PREMIUM != null) {
            //document.getElementById('drpdiscountprem').value = executequery.Tables[0].Rows[rownumEx].DISC_PREMIUM;
        }
        if (executequery.Tables[0].Rows[rownumEx].DISC_TYPE != null) {
            hiddisctype = executequery.Tables[0].Rows[rownumEx].DISC_TYPE;
        }
        if (executequery.Tables[0].Rows[rownumEx].ATTACHMENT1 != null && executequery.Tables[0].Rows[rownumEx].ATTACHMENT1 != "") {
            document.getElementById('hidattach1').value = executequery.Tables[0].Rows[rownumEx].ATTACHMENT1;
            document.getElementById('attachment1').src = "Images/indexred.jpg"
        }
        if (executequery.Tables[0].Rows[rownumEx].ATTACHMENT2 != null && executequery.Tables[0].Rows[rownumEx].ATTACHMENT2 != "") {
            document.getElementById('hidattach2').value = executequery.Tables[0].Rows[rownumEx].ATTACHMENT2;
            document.getElementById('attachment2').src = "Images/indexred.jpg"
        }
        if (executequery.Tables[0].Rows[rownumEx].pub_center != null) {
            document.getElementById('hiddencenter').value = executequery.Tables[0].Rows[rownumEx].pub_center;
        }
        if (executequery.Tables[0].Rows[rownumEx].VAT_CODE != null) {
            document.getElementById('hdnvts').value = executequery.Tables[0].Rows[rownumEx].VAT_CODE;
        }
        else {
            document.getElementById('hdnvts').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].branch != null) {
            //document.getElementById('txtbranch').value = executequery.Tables[0].Rows[rownumEx].branch;
        }
        else {
           // document.getElementById('txtbranch').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CLIENT_TYPE != null) {
            //document.getElementById('drpregular').value = executequery.Tables[0].Rows[rownumEx].CLIENT_TYPE;
        }
        else {
            //document.getElementById('drpregular').value = "0";
        }
        if (executequery.Tables[0].Rows[rownumEx].TRANSLATION_CODE != null) {
            //document.getElementById('drptranslation').value = executequery.Tables[0].Rows[rownumEx].TRANSLATION_CODE;
        }
        else {
            //document.getElementById('drptranslation').value = "0";
        }
        if (executequery.Tables[0].Rows[rownumEx].TRANSLATION_PREMIUM != null) {
            document.getElementById('txttranslationcharges').value = executequery.Tables[0].Rows[rownumEx].TRANSLATION_PREMIUM;
            document.getElementById('hiddentranalpremtype').value = executequery.Tables[0].Rows[rownumEx].TRANSLATION_TYPE;
        }
        else {
            //document.getElementById('txttranslationcharges').value = "";
            document.getElementById('hiddentranalpremtype').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].TRANSLATION_DISC != null) {
            document.getElementById('txttranslationdisc').value = executequery.Tables[0].Rows[rownumEx].TRANSLATION_DISC;
        }
        else {
            document.getElementById('txttranslationdisc').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].POSPREM_DISC != null) {
            document.getElementById('txtpospremdisc').value = executequery.Tables[0].Rows[rownumEx].POSPREM_DISC;
        }
        else {
            document.getElementById('txtpospremdisc').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].BRANCH_NAME != null) {
            document.getElementById('txtbranch_name').value = executequery.Tables[0].Rows[rownumEx].BRANCH_NAME;
        }
        else {
            document.getElementById('txtbranch_name').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CREATION_DATETIME != null) {
            document.getElementById('lblcreationdatetime').innerHTML = executequery.Tables[0].Rows[rownumEx].CREATION_DATETIME;
        }
        else {
            document.getElementById('lblcreationdatetime').innerHTML = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].REVISE_DATE != null) {
            document.getElementById('txtrevisedate').value = executequery.Tables[0].Rows[rownumEx].REVISE_DATE;
        }
        else {
            document.getElementById('txtrevisedate').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].MOBILENO != null) {
            document.getElementById('txtmobile').value = executequery.Tables[0].Rows[rownumEx].MOBILENO;
        }
        else {
            document.getElementById('txtmobile').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].BARTE_AMOUNT != null) {
            document.getElementById('hiddenbarteramt').value = executequery.Tables[0].Rows[rownumEx].BARTE_AMOUNT;
        }
        else {
            document.getElementById('hiddenbarteramt').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].BARTERTYPE != null && executequery.Tables[0].Rows[rownumEx].BARTE_DESC != null) {
            document.getElementById('txtbartertype').value = executequery.Tables[0].Rows[rownumEx].BARTE_DESC + '(' + executequery.Tables[0].Rows[rownumEx].BARTERTYPE + ')';
        }
        else {
            //document.getElementById('txtbartertype').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CIRRATE != null) {
            document.getElementById('txtcirrate').value = executequery.Tables[0].Rows[rownumEx].CIRRATE;
        }
        else {
            document.getElementById('txtcirrate').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CIRPUBLICATION != null) {
            document.getElementById('hiddencirpub').value = executequery.Tables[0].Rows[rownumEx].CIRPUBLICATION;
        }
        else {
            document.getElementById('hiddencirpub').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CIREDITION != null) {
            document.getElementById('hiddenciredi').value = executequery.Tables[0].Rows[rownumEx].CIREDITION;
        }
        else {
            document.getElementById('hiddenciredi').value = "";
        }
        document.getElementById('txtciragency').value = "";
        // for getting circulation agency name
        if (executequery.Tables[0].Rows[rownumEx].CIRAGENCY != null && executequery.Tables[0].Rows[rownumEx].CIRAGENCY_SUBCODE != null && executequery.Tables[0].Rows[rownumEx].CIRAGENCY != "") {
            var resagname = web_booking.getcirAgency(document.getElementById('hiddencompcode').value, document.getElementById('txtbranch').value, executequery.Tables[0].Rows[rownumEx].CIRAGENCY, executequery.Tables[0].Rows[rownumEx].CIRAGENCY_SUBCODE);
            if (resagname.value == null) {
                alert(resagname.error.description);
                return false;
            }
            if (resagname.value.Tables.length > 0 && resagname.value.Tables[0].Rows.length > 0) {
                if (resagname.value.Tables[0].Rows[0].AGENCYNAME != null)
                    document.getElementById('txtciragency').value = resagname.value.Tables[0].Rows[0].AGENCYNAME + '(' + executequery.Tables[0].Rows[rownumEx].CIRAGENCY + ' + ' + executequery.Tables[0].Rows[rownumEx].CIRAGENCY_SUBCODE + ')';
                else
                    document.getElementById('txtciragency').value = "";
            }
        }
        // for getting circulation EDITION name
        document.getElementById('txtciredition').value = "";
        if (executequery.Tables[0].Rows[rownumEx].CIREDITION != null && executequery.Tables[0].Rows[rownumEx].CIREDITION != "") {
            var resagname = web_booking.getcirEdition(document.getElementById('hiddencompcode').value, document.getElementById('hiddenciredi').value);
            if (resagname.value == null) {
                alert(resagname.error.description);
                return false;
            }
            if (resagname.value.Tables.length > 0 && resagname.value.Tables[0].Rows.length > 0) {
                if (resagname.value.Tables[0].Rows[0].EDITIONNAME != null)
                    document.getElementById('txtciredition').value = resagname.value.Tables[0].Rows[0].EDITIONNAME;
            }
        }
        if (executequery.Tables[0].Rows[rownumEx].booked_by != null) {
            document.getElementById('txtbookedby').value = executequery.Tables[0].Rows[rownumEx].booked_by;
        }
        else {
            document.getElementById('txtbookedby').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].ADD_AGENCY_COMM_AMT != null) {
            if (document.getElementById('txtaddagencycommrateamt') != null)
                document.getElementById('txtaddagencycommrateamt').value = executequery.Tables[0].Rows[rownumEx].ADD_AGENCY_COMM_AMT;
        }
        else {
            if (document.getElementById('txtaddagencycommrateamt') != null)
                document.getElementById('txtaddagencycommrateamt').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].RETAINER_COMM_AMT != null) {
            document.getElementById('txtRetainercommamt').value = executequery.Tables[0].Rows[rownumEx].RETAINER_COMM_AMT;
        }
        else {
            document.getElementById('txtRetainercommamt').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].RETAINER_COMM != null) {
            if (executequery.Tables[0].Rows[rownumEx].RETAINER_COMM1 != null)
                document.getElementById('txtRetainercomm').value = executequery.Tables[0].Rows[rownumEx].RETAINER_COMM1;
            else
                document.getElementById('txtRetainercomm').value = executequery.Tables[0].Rows[rownumEx].RETAINER_COMM;
        }
        else {
            document.getElementById('txtRetainercomm').value = "";
        }

        if (executequery.Tables[0].Rows[rownumEx].boxchrg != null) {
            boxpercen = executequery.Tables[0].Rows[rownumEx].boxchrg;
            document.getElementById('hiddenboxchrgtype').value = executequery.Tables[0].Rows[rownumEx].boxchargetype;
        }
        if (executequery.Tables[0].Rows[rownumEx].prev_booking != null) {
            document.getElementById('txtprevbook').value = executequery.Tables[0].Rows[rownumEx].prev_booking;
        }
        else {
            document.getElementById('txtprevbook').value = "";
        }
        if (hidcopy != "copy") {
            var datetime = executequery.Tables[0].Rows[rownumEx].DATE_TIME;
            if (datetime != null) {
                document.getElementById('txtdatetime').value = datetime; //getdatechk.getDate(dateformat, datetime);
            }
            else {
                document.getElementById('txtdatetime').value = "";
            }
        }
        if (executequery.Tables[0].Rows[rownumEx].cio_booking_id != null) {
            document.getElementById('txtciobookid').value = executequery.Tables[0].Rows[rownumEx].cio_booking_id;
        }
        if (executequery.Tables[0].Rows[rownumEx].RO_No != null) {
            document.getElementById('txtrono').value = executequery.Tables[0].Rows[rownumEx].RO_No;
        }
        else {
            document.getElementById('txtrono').value = "";
        }
        var ro_date = executequery.Tables[0].Rows[rownumEx].RO_Date;
        if (ro_date != null) {
            document.getElementById('txtrodate').value = ro_date; //getdatechk.getDate(dateformat, ro_date);
        }
        else {
            document.getElementById('txtrodate').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].bill_status != null) {
            document.getElementById('drpbillstatus').value = executequery.Tables[0].Rows[rownumEx].bill_status;
        }
        else {
            document.getElementById('drpbillstatus').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].ro_status != null) {
            document.getElementById('drprostatus').value = executequery.Tables[0].Rows[rownumEx].ro_status;
            rostatusmain = document.getElementById('drprostatus').value;
        }
        else {
            document.getElementById('drprostatus').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].AgencyName != null) {
            document.getElementById('txtagency').value = executequery.Tables[0].Rows[rownumEx].AgencyName;
        }
        else {
            document.getElementById('txtagency').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].EDTN_WISE_BILL_REQ != null) {

            if (executequery.Tables[0].Rows[rownumEx].EDTN_WISE_BILL_REQ == "Y")
                if (roundoff != "off")
                roundoff = "editionwise";
            else {
                if (roundoff != "off")
                    roundoff = "insertionwise";
            }
        }
        else {
            if (roundoff != "off")
                roundoff = "insertionwise";
        }
        document.getElementById('txtagency').title = document.getElementById('txtagency').value;
        if (executequery.Tables[0].Rows[rownumEx].Caption != null) {
            //document.getElementById('txtcaption').value = executequery.Tables[0].Rows[rownumEx].Caption;
        }
        else {
            //document.getElementById('txtcaption').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].APP_USER != null) {
            document.getElementById('txtappby').value = executequery.Tables[0].Rows[rownumEx].APP_USER;
        }
        else {
            document.getElementById('txtappby').value = "";
        }


        if (executequery.Tables[0].Rows[rownumEx].audit != null) {
            document.getElementById('txtaudit').value = executequery.Tables[0].Rows[rownumEx].audit;
        }
        else {
            document.getElementById('txtaudit').value = "";
        }
        ///////////////this is to bind the subagency drop down

        var res2 = web_booking.bindsubagency(executequery.Tables[0].Rows[rownumEx].Agency_sub_code, document.getElementById('hiddencompcode').value);

        var dsbsa = res2.value;
        if (dsbsa == null) {
            alert(res2.error.description);
            return false;
        }

        document.getElementById('drpagscode').options.length = 0;
        document.getElementById('drpagscode').options[0] = new Option("Select Agency", "0");
        document.getElementById('drpagscode').options.length = 1;
        for (var i = 0; i < dsbsa.Tables[0].Rows.length; ++i) {
            document.getElementById('drpagscode').options[document.getElementById('drpagscode').options.length] = new Option(dsbsa.Tables[0].Rows[i].agency_name, dsbsa.Tables[0].Rows[i].Agency_Code);
            document.getElementById('drpagscode').options.length;
        }

        //////////////////////////////////////////////////////
        if (executequery.Tables[0].Rows[rownumEx].Client_code != null) {
            if (executequery.Tables[0].Rows[rownumEx].Client != null) {
                if (executequery.Tables[0].Rows[rownumEx].Client == "")
                    document.getElementById('txtclient').value = executequery.Tables[0].Rows[rownumEx].Client_code;
                else
                    document.getElementById('txtclient').value = executequery.Tables[0].Rows[rownumEx].Client + "(" + executequery.Tables[0].Rows[rownumEx].Client_code + ")";


            }
            else
                document.getElementById('txtclient').value = executequery.Tables[0].Rows[rownumEx].Client_code;     //.ItemArray[14].ToString();
        }
        else {
            document.getElementById('txtclient').value = "";
        }
        //            if(executequery.Tables[0].Rows[rownumEx].Client!=null)
        //            {
        //                document.getElementById('txtclient').value = executequery.Tables[0].Rows[rownumEx].Client;     //.ItemArray[14].ToString();
        //            }
        //            else
        //            {
        //            }    
        if (executequery.Tables[0].Rows[rownumEx].Agency_address != null) {
            document.getElementById('txtagencyaddress').value = executequery.Tables[0].Rows[rownumEx].Agency_address;
        }
        document.getElementById('txtagencyaddress').title = document.getElementById('txtagencyaddress').value;
        if (executequery.Tables[0].Rows[rownumEx].Client_address != null) {
            document.getElementById('txtclientadd').value = executequery.Tables[0].Rows[rownumEx].Client_address;
        }
        if (executequery.Tables[0].Rows[rownumEx].Agency_code != null) {
            document.getElementById('hiddensubcode').value = document.getElementById('drpagscode').value = executequery.Tables[0].Rows[rownumEx].Agency_code;
        }
        if (executequery.Tables[0].Rows[rownumEx].Dockit_no != null) {
            document.getElementById('txtdockitno1').value = executequery.Tables[0].Rows[rownumEx].Dockit_no;
        }
        if (executequery.Tables[0].Rows[rownumEx].execname != null) {
            document.getElementById('txtexecname').value = executequery.Tables[0].Rows[rownumEx].execname;
        }
        if (executequery.Tables[0].Rows[rownumEx].Executive_zone != null) {
            document.getElementById('hiddenzone').value = document.getElementById('txtexeczone').value = executequery.Tables[0].Rows[rownumEx].Executive_zone;
        }
        if (executequery.Tables[0].Rows[rownumEx].product != null) {
            document.getElementById('txtproduct').value = executequery.Tables[0].Rows[rownumEx].product;
        }

        /////////////////////////////////////////////this is to bind the brand drop down
        res2 = null;
        if (executequery.Tables[0].Rows[rownumEx].Product_code != null) {
            res2 = web_booking.brandbind(document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[rownumEx].Product_code);
            var dsbrand = res2.value;
            if (dsbrand == null) {
                alert(res2.error.description);
                return false;
            }
//            document.getElementById('drpbrand').options.length = 0;anuj
//            document.getElementById('drpbrand').options[0] = new Option("Select Brand", "0");
//            document.getElementById('drpbrand').options.length = 1;
//            for (var i = 0; i < dsbrand.Tables[0].Rows.length; ++i) {
//                document.getElementById('drpbrand').options[document.getElementById('drpbrand').options.length] = new Option(dsbrand.Tables[0].Rows[i].brand_name, dsbrand.Tables[0].Rows[i].brand_code);
//                document.getElementById('drpbrand').options.length;
//            }
        }
        //hiddenbrand.Value=drpbrand.SelectedValue = executequery.Tables[0].Rows[0].ItemArray[21].ToString();
        if (executequery.Tables[0].Rows[rownumEx].Brand_code == null || executequery.Tables[0].Rows[rownumEx].Brand_code.toString() == "") {
//            document.getElementById('drpbrand').options.length = 0;
//            document.getElementById('hiddenbrand').value = "";
        }
        else {
            if (executequery.Tables[0].Rows[rownumEx].Brand_code != null) {
                document.getElementById('hiddenbrand').value = document.getElementById('drpbrand').value = executequery.Tables[0].Rows[rownumEx].Brand_code.toString();
            }
        }
        ////////////////////this is to bind the varient dropdown
        res2 = web_booking.varientbind(document.getElementById('hiddencompcode').value, document.getElementById('hiddenbrand').value);
        var dsvarient = res2.value;
        if (dsvarient == null) {
            alert(res.error.description)
            return false;
        }
//        document.getElementById('drpvarient').options.length = 0;
//        document.getElementById('drpvarient').options[0] = new Option("Select Varient", "0");
//        document.getElementById('drpvarient').options.length = 1;
//        for (var i = 0; i < dsvarient.Tables[0].Rows.length; ++i) {
//            document.getElementById('drpvarient').options[document.getElementById('drpvarient').options.length] = new Option(dsvarient.Tables[0].Rows[i].varient_name, dsvarient.Tables[0].Rows[i].varient_code);
//            document.getElementById('drpvarient').options.length;
//        }

        if (executequery.Tables[0].Rows[rownumEx].Variant_code == null || executequery.Tables[0].Rows[rownumEx].Variant_code.toString() == "") {
            //document.getElementById('drpvarient').options.length = 0;
            //document.getElementById('hiddenvar').value = "";
        }
        else {
            if (executequery.Tables[0].Rows[rownumEx].Brand_code != null) {
                //document.getElementById('hiddenvar').value = document.getElementById('drpvarient').value = executequery.Tables[0].Rows[rownumEx].Variant_code.toString();
            }
        }
        ////////////////////////////////////////////////////////////////////////////////
        if (executequery.Tables[0].Rows[rownumEx].Key_no != null) {
            document.getElementById('txtkeyno').value = executequery.Tables[0].Rows[rownumEx].Key_no;
        }
        if (executequery.Tables[0].Rows[rownumEx].Bill_remarks != null) {
            document.getElementById('txtbillremark').value = executequery.Tables[0].Rows[rownumEx].Bill_remarks;
        }
        if (executequery.Tables[0].Rows[0].Print_remark != null) {
            document.getElementById('txtprintremark').value = executequery.Tables[0].Rows[rownumEx].Print_remark;
        }
        if (executequery.Tables[0].Rows[rownumEx].Package_code != null) {
            var listpck = executequery.Tables[0].Rows[rownumEx].Package_code;
            document.getElementById('hiddenpackage').value = listpck;
            //////////////////this is to bind the package grid on what the value is saved in the database
            res2 = null;
            res2 = web_booking.bindpacforexe(document.getElementById('hiddencompcode').value, listpck);
            var dsexecut = res2.value;
            if (dsexecut == null) {
                alert(res2.error.description);
                return false;
            }
            if (document.getElementById('chkadon').checked == true) {
                bindpackage_adon();
            }
            document.getElementById('drppackagecopy').options.length = 0;
            for (i = 0; i <= dsexecut.Tables[0].Rows.length - 1; i++) {
                if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "") {
                    if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "0") {
                        var arrfor_uom = dsexecut.Tables[0].Rows[i].pck_code.toString().split('@');
                        var res3 = web_booking.getPackageInsert(arrfor_uom[0].toString(), document.getElementById('txtciobookid').value);
                        var dsinsert = res3.value;
                        if (dsinsert == null) {
                            alert(res3.error.description);
                            return false;
                        }
                        var T = dsexecut.Tables[0].Rows[i].Package_Name + "(" + dsinsert.Tables[0].Rows[0].inserts + ")";
                        var V = dsexecut.Tables[0].Rows[i].pck_code + "(" + dsinsert.Tables[0].Rows[0].inserts + ")";
                        if (dsinsert.Tables[0].Rows[0].inserts != null) {
                            document.getElementById('drppackagecopy').options[document.getElementById('drppackagecopy').options.length] = new Option(T, V);

                            document.getElementById('drppackagecopy').options.length;
                        }
                    }
                }
            }
        }

        if (executequery.Tables[0].Rows[rownumEx].No_of_insertion != null) {
            document.getElementById('txtinsertion').value = executequery.Tables[0].Rows[rownumEx].No_of_insertion;
            document.getElementById('hiddeninsertion').value = executequery.Tables[0].Rows[rownumEx].No_of_insertion;
        }

        var start_date = executequery.Tables[0].Rows[rownumEx].Insertion_date;
        if (start_date != null) {
            document.getElementById('txtdummydate').value = start_date; //getdatechk.getDate(dateformat, start_date);
        }
        if (executequery.Tables[0].Rows[rownumEx].Repeating_day != null) {
            document.getElementById('txtrepeatingdate').value = executequery.Tables[0].Rows[rownumEx].Repeating_day;
        }
        // 
        if (executequery.Tables[0].Rows[rownumEx].Page_type_code != null) {
            //document.getElementById('drppagetype').value = executequery.Tables[0].Rows[rownumEx].Page_type_code;
        }

        if (executequery.Tables[0].Rows[rownumEx].Page_no != null) {
            document.getElementById('txtpageno').value = executequery.Tables[0].Rows[rownumEx].Page_no;
        }
        //   
        var mag = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.lastIndexOf(')'));
        var resT = web_booking.bindAdTypeAgencyWise(mag, document.getElementById('hiddencompcode').value);
        bindBookType_Agency();
        var obj = document.getElementById('drpbooktype');
        /* var resType=web_booking.bindAdTypeAgencyWiseXML();
           
        obj.options.length = 0; 
        if(resType!=null && resType.value!="")
        {
            
        var arr=resType.value.split(",");
        obj.options[0]=new Option("Select Booking Type","0");
        for(var i=0;i<arr.length;i++)
        {
        obj.options[obj.options.length] = new Option(arr[i].toString(),arr[parseFloat(i,10)+1].toString());
        i++;
        }
        }*/
        if (resT.value != "") {
            for (var i = 1; i < obj.options.length; i++) {
                if (resT.value.indexOf(obj[i].value) < 0) {
                    //                         obj.options.remove(i);
                    obj.remove(i);
                }
            }
        }
        if (executequery.Tables[0].Rows[rownumEx].Booking_type != null) {
            document.getElementById('drpbooktype').value = executequery.Tables[0].Rows[rownumEx].Booking_type;
        }
        if (executequery.Tables[0].Rows[rownumEx].Ad_cat_code != null) {
            document.getElementById('txtcategory').value = executequery.Tables[0].Rows[rownumEx].Ad_cat_code;
        }
        if (executequery.Tables[0].Rows[rownumEx].Ad_cat_code != null) {
            var ds_adsubcat = null;
            ds_adsubcat = web_booking.getadsubcat(document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[rownumEx].Ad_cat_code, document.getElementById('hiddencattype').value);
            var dacat = ds_adsubcat.value;
            if (dacat == null) {
                alert(dacat.error.description);
                return false;
            }

            ////////////////////////////////////////////////////////////////
            //document.getElementById('drpadsubcategory').options.length = 0;
            //document.getElementById('drpadsubcategory').options[0] = new Option("Select", "0");
            for (var k = 0; k < dacat.Tables[0].Rows.length; k++) {
                document.getElementById('drpadsubcategory').options[document.getElementById('drpadsubcategory').options.length] = new Option(dacat.Tables[0].Rows[k].Adv_Subcat_Name, dacat.Tables[0].Rows[k].Adv_Subcat_Code);
                document.getElementById('drpadsubcategory').options.length;
            }

        }
        if (executequery.Tables[0].Rows[0].Ad_sub_cat_code != null) {
            //document.getElementById('drpadsubcategory').value = executequery.Tables[0].Rows[rownumEx].Ad_sub_cat_code;
        }
        if (executequery.Tables[0].Rows[rownumEx].Color_code != null) {
            //document.getElementById('drpcolor').value = executequery.Tables[0].Rows[0].Color_code;
        }
        if (executequery.Tables[0].Rows[rownumEx].Uom_code != null) {
            document.getElementById('drpuom').value = executequery.Tables[0].Rows[rownumEx].Uom_code;
        }

        res3 = null;
        res3 = web_booking.gettheuom_desc(document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[rownumEx].Uom_code);
        var ds_uom_ = res3.value;
        if (ds_uom_ == null) {
            alert(res3.error.description);
            return false;
        }
        if (ds_uom_.Tables[0].Rows.length > 0) {
            document.getElementById('hiddenuomdesc').value = ds_uom_.Tables[0].Rows[0].uom_desc;
        }

        if (executequery.Tables[0].Rows[rownumEx].Page_position_code != null) {
            document.getElementById('drpposition').value = executequery.Tables[0].Rows[rownumEx].Page_position_code;
            pgposprem = "per";
        }

        //string adtype=drpadstype.SelectedValue;
        if (executequery.Tables[0].Rows[rownumEx].Ad_size_height != null) {
            document.getElementById('txtadsize1').value = executequery.Tables[0].Rows[rownumEx].Ad_size_height;
        }
        if (executequery.Tables[0].Rows[rownumEx].Ad_size_width != null) {
            document.getElementById('txtadsize2').value = executequery.Tables[0].Rows[rownumEx].Ad_size_width;
        }

        // for dealer panel
        if (executequery.Tables[0].Rows[rownumEx].DEALERPANEL != null && executequery.Tables[0].Rows[rownumEx].DEALERPANEL == "Y") {
            document.getElementById('chkDealerPanel').checked = true;
        }
        else {
            //document.getElementById('chkDealerPanel').checked = false;
        }
        if (executequery.Tables[0].Rows[rownumEx].DEALER_H != null) {
            document.getElementById('txtadsize1dealer').value = executequery.Tables[0].Rows[rownumEx].DEALER_H;
        }
        if (executequery.Tables[0].Rows[rownumEx].DEALER_W != null) {
            document.getElementById('txtadsize2dealer').value = executequery.Tables[0].Rows[rownumEx].DEALER_W;
        }
        if (executequery.Tables[0].Rows[rownumEx].DEALERTYPE != null) {
            document.getElementById('drpdealertype').value = executequery.Tables[0].Rows[rownumEx].DEALERTYPE;
        }
        ////this is to bind the ratecode drpdown
        res3 = null
        if (executequery.Tables[0].Rows[rownumEx].Ad_cat_code != null) {
            if (executequery.Tables[0].Rows[rownumEx].REVISE_DATE != null && executequery.Tables[0].Rows[rownumEx].REVISE_DATE != "" && executequery.Tables[0].Rows[rownumEx].REVISE_DATE != "0") {
                res3 = web_booking.bindratecodeforreviserate(executequery.Tables[0].Rows[rownumEx].Ad_cat_code, document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[rownumEx].REVISE_DATE);
                var dx = res3.value;
                if (dx == null) {
                    alert(dx.error.description);
                    return false;
                }
                document.getElementById('txtratecode').options.length = 0;
                document.getElementById('txtratecode').options[0] = new Option("-Select Rate Code-", "0");
                document.getElementById('txtratecode').options.length = 1;

                for (var i = 0; i < dx.Tables[0].Rows.length; ++i) {
                    document.getElementById('txtratecode').options[document.getElementById('txtratecode').options.length] = new Option(dx.Tables[0].Rows[i].rate_mast_code, dx.Tables[0].Rows[i].rate_mast_code);

                    document.getElementById('txtratecode').options.length;
                }
            }
            else {
                res3 = web_booking.ratebind(executequery.Tables[0].Rows[rownumEx].Ad_cat_code, document.getElementById('hiddencompcode').value);
                var dx = res3.value;
                if (dx == null) {
                    alert(dx.error.description);
                    return false;
                }
                document.getElementById('txtratecode').options.length = 0;
                document.getElementById('txtratecode').options[0] = new Option("-Select Rate Code-", "0");
                document.getElementById('txtratecode').options.length = 1;

                for (var i = 0; i < dx.Tables[0].Rows.length; ++i) {
                    document.getElementById('txtratecode').options[document.getElementById('txtratecode').options.length] = new Option(dx.Tables[0].Rows[i].rate_mast_code, dx.Tables[0].Rows[i].rate_mast_code);

                    document.getElementById('txtratecode').options.length;
                }
            }

        }
        if (executequery.Tables[0].Rows[rownumEx].Rate_code != null) {
            document.getElementById('txtratecode').value = executequery.Tables[0].Rows[0].Rate_code;
            //document.getElementById('hiddenratecode').value = executequery.Tables[0].Rows[0].Rate_code;
        }
        if (executequery.Tables[0].Rows[rownumEx].Scheme_type_code != null) {
            document.getElementById('drpscheme').value = executequery.Tables[0].Rows[rownumEx].Scheme_type_code;
            document.getElementById('hiddenscheme').value = executequery.Tables[0].Rows[rownumEx].Scheme_type_code;
        }
        if (executequery.Tables[0].Rows[rownumEx].SCHEMEID != null) {
            schemeid = executequery.Tables[0].Rows[rownumEx].SCHEMEID;
        }
        else
            schemeid = "";
        if (executequery.Tables[0].Rows[rownumEx].Currency_code != null) {
            document.getElementById('drpcurrency').value = executequery.Tables[0].Rows[rownumEx].Currency_code;
        }
        if (executequery.Tables[0].Rows[rownumEx].RECEIPT_CURRENCY != null) {
            document.getElementById('drprptcurrency').value = executequery.Tables[0].Rows[rownumEx].RECEIPT_CURRENCY;
        }
        if (executequery.Tables[0].Rows[rownumEx].CONV_CURR_RATE != null) {
            document.getElementById('hidcurrency_convrate').value = executequery.Tables[0].Rows[rownumEx].CONV_CURR_RATE;
        }
        if (executequery.Tables[0].Rows[rownumEx].Agrred_rate != null) {
            document.getElementById('txtagreedrate').value = executequery.Tables[0].Rows[rownumEx].Agrred_rate;
        }
        if (executequery.Tables[0].Rows[rownumEx].Agreed_amount != null) {
            document.getElementById('txtagreedamt').value = executequery.Tables[0].Rows[rownumEx].Agreed_amount;
        }
        if (executequery.Tables[0].Rows[rownumEx].ACTIVE_AGREEDRATE != null) {
            agreedrate_active = executequery.Tables[0].Rows[rownumEx].ACTIVE_AGREEDRATE;
        }
        else {
            agreedrate_active = 0;
        }
        if (executequery.Tables[0].Rows[rownumEx].ACTIVE_AGREEDAMT != null) {
            agreedamt_active = executequery.Tables[0].Rows[rownumEx].ACTIVE_AGREEDAMT;
        }
        else {
            agreedamt_active = 0;
        }
        if (agreedrate_active == 1) {
            document.getElementById('txtagreedrate').className = ' btextforbookrightsmallbold';
        }
        else {
            document.getElementById('txtagreedrate').className = ' btextforbookrightsmall';
        }
        if (agreedamt_active == 1) {
            document.getElementById('txtagreedamt').className = ' btextforbookrightsmallbold';
        }
        else {
            document.getElementById('txtagreedamt').className = ' btextforbookrightsmall';
        }
        //
        if (executequery.Tables[0].Rows[rownumEx].Special_discount != null) {
            document.getElementById('txtspedisc').value = executequery.Tables[0].Rows[rownumEx].Special_discount;
        }
        if (executequery.Tables[0].Rows[rownumEx].Space_discount != null) {
            document.getElementById('txtspacedisc').value = executequery.Tables[0].Rows[rownumEx].Space_discount;
        }
        if (executequery.Tables[0].Rows[rownumEx].Special_disc_per != null) {
            document.getElementById('txtspediscper').value = executequery.Tables[0].Rows[rownumEx].Special_disc_per;
        }
        if (executequery.Tables[0].Rows[rownumEx].Space_disc_per != null) {
            document.getElementById('txtspadiscper').value = executequery.Tables[0].Rows[rownumEx].Space_disc_per;
        }
        //

        if (executequery.Tables[0].Rows[rownumEx].Special_charges != null) {
            document.getElementById('txtextracharges').value = executequery.Tables[0].Rows[rownumEx].Special_charges;
        }
        if (executequery.Tables[0].Rows[rownumEx].Agency_status != null) {
            document.getElementById('hiddenstatus').value = document.getElementById('txtagencystatus').value = executequery.Tables[0].Rows[rownumEx].Agency_status;
        }
        if (executequery.Tables[0].Rows[rownumEx].Agency_type != null) {
           // document.getElementById('txtagencytype').value = executequery.Tables[0].Rows[rownumEx].Agency_type;
        }
        //this is To the bind the the agencypaymode dropdown on execution
        res3 = null;
        if (executequery.Tables[0].Rows[rownumEx].Agency_sub_code != null) {
            res3 = web_booking.getstatuspaymode(executequery.Tables[0].Rows[rownumEx].Agency_sub_code, executequery.Tables[0].Rows[rownumEx].Agency_code, document.getElementById('hiddencompcode').value, document.getElementById('txtdatetime').value, document.getElementById('hiddendateformat').value, "DI0");
            var dch = res3.value;
            if (dch == null) {
                alert(res3.error.description);
                return false;
            }

            document.getElementById('txtagencypaymode').options.length = 0;
            if (dch.Tables[5].Rows.length > 0) {
                for (var i = 0; i < dch.Tables[5].Rows.length; i++) {
                    document.getElementById('txtagencypaymode').options[document.getElementById('txtagencypaymode').options.length] = new Option(dch.Tables[5].Rows[i].payment_mode_name, dch.Tables[5].Rows[i].pay_mode_code);
                    document.getElementById('txtagencypaymode').options.length;
                }
            }
        }
        ///////////////////////////////////////////////////////////////////////////////////////////////////
//        if (executequery.Tables[0].Rows[rownumEx].Agency_pay != null) {anuj
//            document.getElementById('hiddenpay').value = document.getElementById('txtagencypaymode').value = executequery.Tables[0].Rows[rownumEx].Agency_pay;
//            if (document.getElementById('txtagencypaymode').selectedIndex != -1)
//                document.getElementById('hiddenpaymode').value = document.getElementById('txtagencypaymode').options[document.getElementById('txtagencypaymode').selectedIndex].text;
//        }
        if (executequery.Tables[0].Rows[rownumEx].Agency_credit != null) {
            document.getElementById('txtcreditperiod').value = executequery.Tables[0].Rows[rownumEx].Agency_credit;
        }
        if (executequery.Tables[0].Rows[rownumEx].Total_area != null) {
            document.getElementById('txttotalarea').value = executequery.Tables[0].Rows[rownumEx].Total_area;
        }
        if (executequery.Tables[0].Rows[rownumEx].Card_rate != null) {
            document.getElementById('txtcardrate').value = executequery.Tables[0].Rows[rownumEx].Card_rate;
        }
        if (executequery.Tables[0].Rows[rownumEx].Card_amount != null) {
            document.getElementById('txtcardamt').value = executequery.Tables[0].Rows[rownumEx].Card_amount;
        }
        if (executequery.Tables[0].Rows[rownumEx].Discount != null) {
            document.getElementById('txtdiscount').value = executequery.Tables[0].Rows[rownumEx].Discount;
        }
        if (executequery.Tables[0].Rows[rownumEx].Discount_per != null) {
            document.getElementById('txtdiscpre').value = executequery.Tables[0].Rows[rownumEx].Discount_per;
        }
        if (executequery.Tables[0].Rows[rownumEx].Bill_cycle != null) {
            document.getElementById('drpbillcycle').value = executequery.Tables[0].Rows[rownumEx].Bill_cycle;
        }
        if (executequery.Tables[0].Rows[rownumEx].Revenue_center != null) {
            document.getElementById('drprevenue').value = executequery.Tables[0].Rows[rownumEx].Revenue_center;
        }
//        if (document.getElementById('drprevenue').selectedIndex != "-1") {
//            document.getElementById('hiddenbranch').value = document.getElementById('drprevenue').options[document.getElementById('drprevenue').selectedIndex].text; //drprevenue.SelectedItem.Text.ToString();
//        }
        ////this is to bind the bill pay mode
        document.getElementById('drppaymenttype').options.length = 0;
        if (dch.Tables[5].Rows.length > 0) {
            for (var i = 0; i < dch.Tables[5].Rows.length; i++) {
                document.getElementById('drppaymenttype').options[document.getElementById('drppaymenttype').options.length] = new Option(dch.Tables[5].Rows[i].payment_mode_name, dch.Tables[5].Rows[i].pay_mode_code);
                document.getElementById('drppaymenttype').options.length;
            }

        }
        if (executequery.Tables[0].Rows[rownumEx].Bill_pay != null) {
            document.getElementById('hiddenbillpay').value = document.getElementById('drppaymenttype').value = executequery.Tables[0].Rows[rownumEx].Bill_pay;
        }
        var ag = web_booking.GETCASH_PAY(document.getElementById('hiddencompcode').value, document.getElementById('drppaymenttype').value);
        var ds_n = ag.value;
        var cashdiscount = 'N';
        if (ds_n != null && ds_n.Tables[0].Rows.length > 0) {
            cashdiscount = ds_n.Tables[0].Rows[0].CASHDISCOUNT;
        }
        if (executequery.Tables[0].Rows[rownumEx].Bill_height != null) {
            document.getElementById('txtbillheight').value = executequery.Tables[0].Rows[rownumEx].Bill_height;
        }
        if (executequery.Tables[0].Rows[rownumEx].Bill_width != null) {
            document.getElementById('txtbillwidth').value = executequery.Tables[0].Rows[rownumEx].Bill_width;
        }
        //////////////this is to bind the bill to 
        res3 = null;
        if (executequery.Tables[0].Rows[rownumEx].Agency_sub_code != null) {
            res3 = web_booking.getbillval(executequery.Tables[0].Rows[rownumEx].Agency_sub_code, document.getElementById('hiddencompcode').value);
            var dbt = res3.value;
            if (dbt == null) {
                alert(res3.error.description);
                return false;
            }
            ////////////////////////////////////////////////////

            document.getElementById('drpbillto').options.length = 0;
            var client_val = document.getElementById('txtclient').value;
            var client_name = document.getElementById('txtclient').value;
            if (document.getElementById('txtclient').value.indexOf("(".toString()) > 0) {
                client_val = document.getElementById('txtclient').value.substring(document.getElementById('txtclient').value.lastIndexOf("(") + 1, document.getElementById('txtclient').value.length - 1); //document.getElementById('txtclient').value.substring(0,document.getElementById('txtclient').value.lastIndexOf("("));
                client_name = document.getElementById('txtclient').value.substring(0, document.getElementById('txtclient').value.lastIndexOf("("));
            }
            document.getElementById('drpbillto').options[0] = new Option(client_name, client_val);

            for (var k = 0; k < dbt.Tables[0].Rows.length; k++) {
                if (dbt.Tables[0].Rows[k].bill_to == "")
                    document.getElementById('drpbillto').options[document.getElementById('drpbillto').options.length] = new Option(dbt.Tables[0].Rows[k].agency_name, dbt.Tables[0].Rows[k].bill_to);
                else
                    document.getElementById('drpbillto').options[document.getElementById('drpbillto').options.length] = new Option(dbt.Tables[0].Rows[k].agency_name, dbt.Tables[0].Rows[k].SUB_agency_code);
                document.getElementById('drpbillto').options.length;
            }
        }
        if (executequery.Tables[0].Rows[rownumEx].Bill_to != null) {
            document.getElementById('hiddenbillto').value = executequery.Tables[0].Rows[rownumEx].Bill_to;
            document.getElementById('drpbillto').value = executequery.Tables[0].Rows[rownumEx].Bill_to;
        }
        //            if(executequery.Tables[0].Rows[0].Bill_to!=null)
        //            {
        //                document.getElementById('drpbillto').value = executequery.Tables[0].Rows[0].Bill_to;
        //            }    
        if (executequery.Tables[0].Rows[rownumEx].Invoices != null) {
            document.getElementById('txtinvoice').value = executequery.Tables[0].Rows[rownumEx].Invoices;
        }
        if (executequery.Tables[0].Rows[rownumEx].Vts != null) {
            document.getElementById('txtvts').value = executequery.Tables[0].Rows[rownumEx].Vts;
        }
        if (executequery.Tables[0].Rows[rownumEx].Page_prem != null) {
            document.getElementById('drppageprem').value = executequery.Tables[0].Rows[rownumEx].Page_prem;
        }
        if (executequery.Tables[0].Rows[rownumEx].Bill_add != null) {
            document.getElementById('txtbilladdress').value = executequery.Tables[0].Rows[rownumEx].Bill_add;
        }
        if (executequery.Tables[0].Rows[rownumEx].Trade_disc != null) {
            document.getElementById('txttradedisc').value = executequery.Tables[0].Rows[rownumEx].Trade_disc;
            //                 document.getElementById('hiddentradedisc').value=executequery.Tables[0].Rows[rownumEx].COMM_RATE;
            //                 document.getElementById('hiddenagcommflag').value=executequery.Tables[0].Rows[rownumEx].ADDFLAG;
        }
        if (executequery.Tables[0].Rows[rownumEx].ADDFLAG != null) {
            document.getElementById('hiddenagcommflag').value = executequery.Tables[0].Rows[rownumEx].ADDFLAG;
        }
        if (executequery.Tables[0].Rows[rownumEx].COMM_RATE != null) {
            document.getElementById('hiddentradedisc').value = executequery.Tables[0].Rows[rownumEx].COMM_RATE;
        }
        if (executequery.Tables[0].Rows[rownumEx].CHKTRADE != null) {
            if (executequery.Tables[0].Rows[rownumEx].CHKTRADE == "1")
                document.getElementById('chktrade').checked = true;
            else
                document.getElementById('chktrade').checked = false;
        }
        if (executequery.Tables[0].Rows[rownumEx].BILL_HOLD != null) {
            if (executequery.Tables[0].Rows[rownumEx].BILL_HOLD == "Y")
                document.getElementById('chkholdbill').checked = true;
            else
                document.getElementById('chkholdbill').checked = false;
        }
        if (executequery.Tables[0].Rows[rownumEx].CANCELLATION_CHARGE != null) {
            if (executequery.Tables[0].Rows[rownumEx].CANCELLATION_CHARGE == "1")
                document.getElementById('chkcanclecharges').checked = true;
            else
                document.getElementById('chkcanclecharges').checked = false;
        }
        if (executequery.Tables[0].Rows[rownumEx].Agency_out != null) {
            document.getElementById('txtagencyoutstand').value = executequery.Tables[0].Rows[rownumEx].Agency_out;
        }

        if (executequery.Tables[0].Rows[rownumEx].Page_amount != null) {
            document.getElementById('txtpageamt').value = executequery.Tables[0].Rows[rownumEx].Page_amount;
        }
        if (executequery.Tables[0].Rows[rownumEx].Gross_amount != null) {
            document.getElementById('txtgrossamt').value = executequery.Tables[0].Rows[rownumEx].Gross_amount;
        }

        //Inserting in hidden field to compare new and  Previous amount 
        if (executequery.Tables[0].Rows[rownumEx].Bill_amount != null) {
            document.getElementById('hiddenprevamt').value = executequery.Tables[0].Rows[rownumEx].Bill_amount;
        }
        if (executequery.Tables[0].Rows[rownumEx].LOCALGROSSAMT != null) {
            document.getElementById('txtgrossamtlocal').value = executequery.Tables[0].Rows[rownumEx].LOCALGROSSAMT;
        }

        //Inserting in hidden field to compare new and  Previous amount 
        if (executequery.Tables[0].Rows[rownumEx].LOCALBILLAMT != null) {
            document.getElementById('txtbillamtlocal').value = executequery.Tables[0].Rows[rownumEx].LOCALBILLAMT;
        }
        if (executequery.Tables[0].Rows[rownumEx].Bill_amount != null) {
            document.getElementById('txtbillamt').value = executequery.Tables[0].Rows[rownumEx].Bill_amount;
            document.getElementById('hiddenbillamt').value = document.getElementById('txtbillamt').value;
        }
        if (executequery.Tables[0].Rows[rownumEx].Box_code != null) {
            document.getElementById('drpboxcode').value = executequery.Tables[0].Rows[rownumEx].Box_code;
        }
        if (executequery.Tables[0].Rows[rownumEx].Box_no != null) {
            document.getElementById('txtboxno').value = executequery.Tables[0].Rows[rownumEx].Box_no;
        }
        if (executequery.Tables[0].Rows[rownumEx].Box_agency.toString() == "1") {
            document.getElementById('chkage').checked = true;
        }
        else {
            document.getElementById('chkage').checked = false;
        }
        if (executequery.Tables[0].Rows[rownumEx].Box_client.toString() == "1") {
            document.getElementById('chkclie').checked = true;
        }
        else {
            document.getElementById('chkclie').checked = false;
        }
        if (executequery.Tables[0].Rows[rownumEx].Box_address != null) {
            document.getElementById('txtboxaddress').value = executequery.Tables[0].Rows[rownumEx].Box_address;
        }
        if (executequery.Tables[0].Rows[rownumEx].Tfn == "1") {
            document.getElementById('chktfn').value = true;
        }
        else {
            document.getElementById('chktfn').value = false;
        }
        if (executequery.Tables[0].Rows[rownumEx].Ad_size_column != null) {
            document.getElementById('txtcolum').value = executequery.Tables[0].Rows[rownumEx].Ad_size_column;
        }
        if (executequery.Tables[0].Rows[rownumEx].Paid_ins != null) {
            document.getElementById('txtpaid').value = executequery.Tables[0].Rows[rownumEx].Paid_ins;
        }
        if (executequery.Tables[0].Rows[rownumEx].Contract_rate != null) {
            document.getElementById('txtdealrate').value = executequery.Tables[0].Rows[rownumEx].Contract_rate;
        }
        if (document.getElementById('txtdealrate').value != "") {
            document.getElementById('chkcontract').checked = true;
        }
        else {
            document.getElementById('chkcontract').checked = false;
        }
        if (executequery.Tables[0].Rows[rownumEx].Deviation != null) {
            document.getElementById('txtdeviation').value = executequery.Tables[0].Rows[rownumEx].Deviation;
        }
        if (executequery.Tables[0].Rows[rownumEx].Contract_name != null) {
            document.getElementById('txtcontractname').value = executequery.Tables[0].Rows[rownumEx].Contract_name;
            hidcontract = executequery.Tables[0].Rows[rownumEx].CONTRACT_NAME1;
        }
        if (executequery.Tables[0].Rows[rownumEx].Contract_type != null) {
            document.getElementById('txtcontracttype').value = executequery.Tables[0].Rows[rownumEx].Contract_type;
        }
        //            if(executequery.Tables[0].Rows[rownumEx].Card_name!=null)
        //            {
        //                document.getElementById('txtcardname').value = executequery.Tables[0].Rows[rownumEx].Card_name;
        //            }   
        //            if(executequery.Tables[0].Rows[rownumEx].Card_type!=null)
        //            {
        //                document.getElementById('drptype').value = executequery.Tables[0].Rows[rownumEx].Card_type;
        //            }
        if (executequery.Tables[0].Rows[rownumEx].Variant_code != null) {
            //document.getElementById('hiddenvar').value = document.getElementById('drpvarient').value = executequery.Tables[0].Rows[rownumEx].Variant_code;
        }

        //             if(executequery.Tables[0].Rows[rownumEx].Card_month!=null)
        //             {
        //                document.getElementById('drpmonth').value = executequery.Tables[0].Rows[rownumEx].Card_month;
        //             }   
        //             if(executequery.Tables[0].Rows[rownumEx].Card_year!=null)
        //             {
        //                document.getElementById('drpyear').value = executequery.Tables[0].Rows[rownumEx].Card_year;
        //             }   
        //             if(executequery.Tables[0].Rows[rownumEx].Card_number!=null)
        //             {
        //                document.getElementById('txtcardno').value = executequery.Tables[0].Rows[rownumEx].Card_number;
        //             }   
        if (executequery.Tables[0].Rows[rownumEx].Receipt_no != null) {
            document.getElementById('hiddenreceiptno').value = document.getElementById('txtreceipt').value = executequery.Tables[0].Rows[rownumEx].Receipt_no;
        }
        if (document.getElementById('drppaymenttype').value == "CA0") {
            document.getElementById('cashrecvd').style.display = "";
            // document.getElementById('tdcashrecvd').style.display="";
            if (executequery.Tables[0].Rows[rownumEx].CASHDISCOUNT == null || executequery.Tables[0].Rows[rownumEx].CASHDISCOUNT == "null")
                document.getElementById('txtcashdiscount').value = "0";
            else
                document.getElementById('txtcashdiscount').value = executequery.Tables[0].Rows[rownumEx].CASHDISCOUNT;
            if (executequery.Tables[0].Rows[rownumEx].CASHDISCTYPE == null || executequery.Tables[0].Rows[rownumEx].CASHDISCTYPE == "null")
                document.getElementById('hiddencashdiscper').value = "";
            else
                document.getElementById('hiddencashdiscper').value = executequery.Tables[0].Rows[rownumEx].CASHDISCTYPE;

            if (executequery.Tables[0].Rows[rownumEx].CASH_RECIEVED == null || executequery.Tables[0].Rows[rownumEx].CASH_RECIEVED == "null")
                document.getElementById('drpcashrecieved').value = "0";
            else
                document.getElementById('drpcashrecieved').value = executequery.Tables[0].Rows[rownumEx].CASH_RECIEVED;
            document.getElementById('hiddencashrecieved').value = executequery.Tables[0].Rows[rownumEx].CASH_RECIEVED;

            document.getElementById('drpcashrecieved').disabled = true;
            document.getElementById('txtcashdiscount').disabled = true;
        }
        else if (document.getElementById('drppaymenttype').value == "CH0" || document.getElementById('drppaymenttype').value == "DD0" || document.getElementById('drppaymenttype').value == 'PO0' || document.getElementById('drppaymenttype').value == 'AD0') {
            /* var ds_chq=web_booking.ChequeInfo(document.getElementById('hiddencompcode').value,document.getElementById('txtreceipt').value);
            if(ds_chq.value!=null && ds_chq.value.Tables[0].Rows.length>0)
            {
            if(ds_chq.value.Tables[0].Rows[0].chno!=null)
            document.getElementById('ttextchqno').value=ds_chq.value.Tables[0].Rows[0].chno;  
            else
            document.getElementById('ttextchqno').value="";    
            var cDate="";
            if(ds_chq.value.Tables[0].Rows[0].chdt!=null)
            {
            if(document.getElementById('hiddendateformat').value=="dd/mm/yyyy")
            {
            cDate=ds_chq.value.Tables[0].Rows[0].chdt;  
            }          
            else if(document.getElementById('hiddendateformat').value=="mm/dd/yyyy")
            {
            var txt=ds_chq.value.Tables[0].Rows[0].chdt.split("/");
            cDate=txt[1] + "/" + txt[0] + "/" + txt[2];
            }
            else if(document.getElementById('hiddendateformat').value=="yyyy/mm/dd")
            {
            var txt=ds_chq.value.Tables[0].Rows[0].chdt.split("/");
            cDate=txt[2] + "/" + txt[1] + "/" + txt[0];
            }
            }       
            document.getElementById('ttextchqdate').value=cDate;  
            if(ds_chq.value.Tables[0].Rows[0].amount!=null)
            document.getElementById('ttextchqamt').value=ds_chq.value.Tables[0].Rows[0].amount;  
            else
            document.getElementById('ttextchqamt').value="";    
            if(document.getElementById('ttextchqamt').value.indexOf("-")>=0)
            document.getElementById('ttextchqamt').value=document.getElementById('ttextchqamt').value.replace("-","");
            if(ds_chq.value.Tables[0].Rows[0].bank!=null)    
            document.getElementById('ttextbankname').value=ds_chq.value.Tables[0].Rows[0].bank;                          
            else
            document.getElementById('ttextbankname').value="";
            if(ds_chq.value.Tables[0].Rows[0].cashbank!=null)    
            document.getElementById('drpourbank').value=ds_chq.value.Tables[0].Rows[0].cashbank;                          
            else
            document.getElementById('drpourbank').value="0";       
            }*/
            if (executequery.Tables[0].Rows[rownumEx].CHK_DATE != null) {
                document.getElementById('ttextchqdate').value = executequery.Tables[0].Rows[rownumEx].CHK_DATE;
            }
            if (executequery.Tables[0].Rows[rownumEx].CHK_AMT != null) {
                document.getElementById('ttextchqamt').value = executequery.Tables[0].Rows[rownumEx].CHK_AMT;
            }
            if (executequery.Tables[0].Rows[rownumEx].CHK_BANK_NAME != null) {
                document.getElementById('ttextbankname').value = executequery.Tables[0].Rows[rownumEx].CHK_BANK_NAME;
            }
            if (executequery.Tables[0].Rows[rownumEx].OUR_BANK != null) {
                document.getElementById('drpourbank').value = executequery.Tables[0].Rows[rownumEx].OUR_BANK;
            }
            if (executequery.Tables[0].Rows[rownumEx].CHK_NO != null) {
                document.getElementById('ttextchqno').value = executequery.Tables[0].Rows[rownumEx].CHK_NO;
            }
        }
        else if (document.getElementById('drppaymenttype').value == "CR0") {
            var ds_chq = web_booking.ChequeInfo(document.getElementById('hiddencompcode').value, document.getElementById('txtreceipt').value);
            if (ds_chq.value != null && ds_chq.value.Tables[0].Rows.length > 0) {
                if (ds_chq.value.Tables[0].Rows[0].bank != null)
                    document.getElementById('txtcardname').value = ds_chq.value.Tables[0].Rows[0].bank;
                else
                    document.getElementById('txtcardname').value = "";
                if (ds_chq.value.Tables[0].Rows[0].remark != null)
                    document.getElementById('drptype').value = ds_chq.value.Tables[0].Rows[0].remark;
                else
                    document.getElementById('drptype').value = "";
                if (ds_chq.value.Tables[0].Rows[0].chno != null)
                    document.getElementById('txtcardno').value = ds_chq.value.Tables[0].Rows[0].chno;
                else
                    document.getElementById('txtcardno').value = "";
                if (ds_chq.value.Tables[0].Rows[0].chdt != null) {
                    var txt = ds_chq.value.Tables[0].Rows[0].chdt.split("/");
                    document.getElementById('drpmonth').value = parseInt(txt[1], 10);
                    document.getElementById('drpyear').value = txt[2];
                }

            }
        }
        if (cashdiscount == 'Y') {
//            if (executequery.Tables[0].Rows[rownumEx].CASHDISCOUNT == null || executequery.Tables[0].Rows[rownumEx].CASHDISCOUNT == "null")
//                document.getElementById('txtcashdiscount').value = "0";
//            else
//                document.getElementById('txtcashdiscount').value = executequery.Tables[0].Rows[rownumEx].CASHDISCOUNT;
//            if (executequery.Tables[0].Rows[rownumEx].CASHDISCTYPE == null || executequery.Tables[0].Rows[rownumEx].CASHDISCTYPE == "null")
//                document.getElementById('hiddencashdiscper').value = "";
//            else
//                document.getElementById('hiddencashdiscper').value = executequery.Tables[0].Rows[rownumEx].CASHDISCTYPE;

//            if (executequery.Tables[0].Rows[rownumEx].CASH_RECIEVED == null || executequery.Tables[0].Rows[rownumEx].CASH_RECIEVED == "null")
//                document.getElementById('drpcashrecieved').value = "0";
//            else
//                document.getElementById('drpcashrecieved').value = executequery.Tables[0].Rows[rownumEx].CASH_RECIEVED;
//            document.getElementById('hiddencashrecieved').value = executequery.Tables[0].Rows[rownumEx].CASH_RECIEVED;

//            document.getElementById('drpcashrecieved').disabled = true;
//            document.getElementById('txtcashdiscount').disabled = true;
        }
        else {
           // document.getElementById('cashrecvd').style.display = "none";
        }
        if (executequery.Tables[0].Rows[rownumEx].Material_status != null) {
            document.getElementById('drpmatsta').value = executequery.Tables[0].Rows[rownumEx].Material_status;
        }

        ////this is to bind the adscat3 drpdown

        if (executequery.Tables[0].Rows[rownumEx].Ad_sub_cat_code == null || executequery.Tables[0].Rows[rownumEx].Ad_sub_cat_code.toString() == "" || executequery.Tables[0].Rows[rownumEx].Ad_sub_cat_code == "0") {
//            document.getElementById('drpadcat3').options.length = 0;
//            document.getElementById('hiddenadscat3').value = "";
        }
        else {
            res3 = null;
            res3 = web_booking.getvalfromadcat3(executequery.Tables[0].Rows[rownumEx].Ad_sub_cat_code, document.getElementById('hiddencompcode').value, "0");
            var dacat = res3.value;
            if (dacat == null) {
                alert(dacat.error.description);
                return false;
            }


            ////////////////////////////////////////////////////////////////
//            document.getElementById('drpadcat3').options.length = 0;
//            document.getElementById('drpadcat3').options[0] = new Option("Select", "0");
//            for (var k = 0; k < dacat.Tables[0].Rows.length; k++) {
//                document.getElementById('drpadcat3').options[document.getElementById('drpadcat3').options.length] = new Option(dacat.Tables[0].Rows[k].catname, dacat.Tables[0].Rows[k].catcode);
//                document.getElementById('drpadcat3').options.length;
//            }

        }

        if (executequery.Tables[0].Rows[rownumEx].Ad_Subcat3 != null) {
           // document.getElementById('hiddenadscat3').value = document.getElementById('drpadcat3').value = executequery.Tables[0].Rows[rownumEx].Ad_Subcat3;
        }

        ////////////////////this is to bind the adcat4 drp down
        if (executequery.Tables[0].Rows[rownumEx].Ad_Subcat3 == null || executequery.Tables[0].Rows[rownumEx].Ad_Subcat3.toString() == "" || executequery.Tables[0].Rows[rownumEx].Ad_Subcat3 == "0") {
            //document.getElementById('drpadcat4').options.length = 0;
            //document.getElementById('hiddenadscat4').value = "";
        }
        else {
            ////////////when 1 than bind the adscat4 drp down
            res3 = null;
            res3 = web_booking.getvalfromadcat3(executequery.Tables[0].Rows[rownumEx].Ad_Subcat3, document.getElementById('hiddencompcode').value, "1");
            var dacat = res3.value;
            if (dacat == null) {
                alert(dacat.error.description);
                return false;
            }

            ////////////////////////////////////////////////////////////////
            //document.getElementById('drpadcat4').options.length = 0;
            //document.getElementById('drpadcat4').options[0] = new Option("Select", "0");
            for (var k = 0; k < dbt.Tables[0].Rows.length; k++) {
//                document.getElementById('drpadcat4').options[document.getElementById('drpadcat4').options.length] = new Option(dacat.Tables[0].Rows[k].Cat_Name, dacat.Tables[0].Rows[k].Cat_Code);
//                document.getElementById('drpadcat4').options.length;
            }
        }
        if (executequery.Tables[0].Rows[rownumEx].Ad_Subcat4 != null) {
           // document.getElementById('hiddenadscat4').value = document.getElementById('drpadcat4').value = executequery.Tables[0].Rows[0].Ad_Subcat4;
        }

        ///bind adcat5 drpdown
        if (executequery.Tables[0].Rows[rownumEx].Ad_Subcat4 == null || executequery.Tables[0].Rows[rownumEx].Ad_Subcat4.toString() == "" || executequery.Tables[0].Rows[rownumEx].Ad_Subcat4 == "0") {
//            document.getElementById('drpadcat5').options.length = 0;
//            document.getElementById('hiddenadscat5').value = "";
        }
        else {
            ////////////when 1 than bind the adscat4 drp down

            res3 = null;
            res3 = web_booking.getvalfromadcat3(executequery.Tables[0].Rows[rownumEx].Ad_Subcat4, document.getElementById('hiddencompcode').value, "2");
            var dacat = res3.value;
            if (dacat == null) {
                alert(dacat.error.description);
                return false;
            }


            ////////////////////////////////////////////////////////////////
//            document.getElementById('drpadcat5').options.length = 0;
//            document.getElementById('drpadcat5').options[0] = new Option("Select", "0");
//            for (var k = 0; k < dbt.Tables[0].Rows.length; k++) {
//                document.getElementById('drpadcat5').options[document.getElementById('drpadcat5').options.length] = new Option(dacat.Tables[0].Rows[k].Cat_Name, dacat.Tables[0].Rows[k].Cat_Code);
//                document.getElementById('drpadcat5').options.length;
//            }
        }
        if (executequery.Tables[0].Rows[rownumEx].Ad_subcat5 != null) {
            //document.getElementById('hiddenadscat5').value = document.getElementById('drpadcat5').value = executequery.Tables[0].Rows[rownumEx].Ad_subcat5;
        }


        if (executequery.Tables[0].Rows[rownumEx].RETAINER1 != null) {
            document.getElementById('drpretainer').value = executequery.Tables[0].Rows[rownumEx].RETAINER1;
        }
        if (executequery.Tables[0].Rows[rownumEx].ADD_AGENCY_COMM != null) {
            if (document.getElementById('txtaddagencycommrate') != null) {
                document.getElementById('txtaddagencycommrate').value = executequery.Tables[0].Rows[rownumEx].ADD_AGENCY_COMM;
            }
        }
        getSharing();
        if (document.getElementById('drpbooktype').value == "2" || document.getElementById('drpbooktype').value == "6")
            getFMGRef();
        getmultiexe();
        //grid
      //  updateStatus();
       // showcardinfo(executequery.Tables[0].Rows[rownumEx].Bill_pay);
        showgridexecute();

//        if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtcolum').value != "") {
//            document.getElementById('txtadsize2').disabled = true;
//            document.getElementById('txtadsize1').style.backgroundColor = "#FFFFFF";
//            document.getElementById('txtadsize2').style.backgroundColor = "#FFFFFF";
//            document.getElementById('txtcolum').style.backgroundColor = "#FFFFFF";

//        }
//        else if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtadsize2').value != "") {
//            document.getElementById('txtcolum').disabled = true;
//            document.getElementById('txtadsize1').style.backgroundColor = "#FFFFFF";
//            document.getElementById('txtadsize2').style.backgroundColor = "#FFFFFF";
//            document.getElementById('txtcolum').style.backgroundColor = "#FFFFFF";

//        }
    }
    return false;
}


function lastClick() {
    rownumEx = executequery.Tables[0].Rows.length - 1;
    buttonmovement(rownumEx);
    document.getElementById('btnfirst').disabled = false;
    document.getElementById('btnlast').disabled = true;
    document.getElementById('btnprevious').disabled = false;
    document.getElementById('btnnext').disabled = true;
    setButtonImages();
    return false;
}


function firstClick() {
    rownumEx = 0;
    buttonmovement(rownumEx);

    //////////////////////////////////////////////////////////////////////////

    document.getElementById('btnfirst').disabled = true;
    document.getElementById('btnprevious').disabled = true;
    document.getElementById('btnlast').disabled = false;
    document.getElementById('btnnext').disabled = false;
    
    setButtonImages();
    return false;
}


function previousClick() {
    rownumEx--;
    buttonmovement(rownumEx);
    document.getElementById('btnfirst').disabled = false;
    document.getElementById('btnlast').disabled = false;
    document.getElementById('btnprevious').disabled = false;
    document.getElementById('btnnext').disabled = false;
    if (rownumEx == 0) {
        document.getElementById('btnfirst').disabled = true;
        document.getElementById('btnprevious').disabled = true;
    }
    setButtonImages();
    return false;
}


function showgridexecute() {
    var msg = checkSession();
    if (msg == false) {
        window.location.href = "login.aspx";
        return false;
    }
    if (document.getElementById('txtciobookid').value == '') {
        document.getElementById('txtciobookid').value = document.getElementById('hiddencioid').value;
    }
    var cioid = document.getElementById('txtciobookid').value;
    var compcode = document.getElementById('hiddencompcode').value;

    // web_booking.showgridforexe(cioid,compcode,call_showgrid);
    var res = web_booking.showgridforexe(cioid, compcode);
    call_showgrid(res);
    return false;
}


function call_showgrid(res)
{
    Make_Row = '';
    var ds = res.value;
    var str = "";
    var editid;
    var inserts;
    var adsubcat;
    var dat = "mm+" / "+dd+" / "+yyyy";
    var l;
    var j;
    var colid;
    var height;
    var width;
    var size;
    var pagepost;
    var p;
    var cardid;
    var matsta;
    var filename;
    var discrate;
    var insertsta;
    var billstat;
    var late;
    var repeat;
    var premid;
    var premper;
    var premper1;
    var adtypid;
    var namecode;
    var preall;
    var adcat;
    var picfield;
    var agrred;
    var paid;
    var solo;
    var gross;
    var showid;
    var pageno_inserts;
    var remark_inserts;
    var caption_inserts;
    var page;
    var pageprem;
    var noofcol;
    var billamt;
    var billrate;
    var pagstr;
    var dbill = "";
    var dcou = 0;
    var agnamnt;
    var adlgn;
    var spldisc;
    var cashdisc;
    var roundoffval;
    var dateformat = document.getElementById('hiddendateformat').value;
    var objedition = document.getElementById('drpedition');
    var showordisable = document.getElementById('hiddensavemod').value;
    var noinsertgrid = document.getElementById('txtinsertion').value;
    var drppagepos_vari = document.getElementById('drpposition');
    arrEdition_Item = "";
    noofinsertlo = parseInt(ds.Tables[0].Rows.length) / parseInt(noinsertgrid)
    rowwhenupdate = ds.Tables[0].Rows.length;
    insertval = 1;
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {
        //this is the for loop we are implementing so that the rows appear the same as the rows in tbl_booking_insert table
        var count = ds.Tables[0].Rows.length - 1;
        countgridloop = ds.Tables[0].Rows.length;
        retrows = ds.Tables[0].Rows.length - 1;
        var i = 0;
        str = "<div id=\"bookdiv\" runat=\"server\" style=\"OVERFLOW: auto; WIDTH: 896px; HEIGHT: 160px; \"><table cellpadding=\"1\" cellspacing=\"1\" id=\"gridtab\" width=\"1000px\" border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\"><td align=\"center\" valign=\"top\" >No.</td><td align=\"center\" valign=\"top\" >Edition</td><td valign=\"top\" align=\"center\">Start Date</td><td valign=\"top\" align=\"center\">Expiry Date</td><td align=\"center\" valign=\"top\">Ad Sub Cat.</td><td align=\"center\" valign=\"top\" id=\"siz\">Size</td><td valign=\"top\" id='uploadA' style=\"cursor:pointer;color:red;\" >Upload</td><td align=\"center\" valign=\"top\">Insertion Sta.</td>";

        str = str + "<td align=\"center\" valign=\"top\">Card Rate</td><td valign=\"top\" align=\"center\">Disc. Rate</td><td valign=\"top\" align=\"center\">Agreed Amt</td><td align=\"center\" valign=\"top\">File Name</td><td valign=\"top\">Material</td><td valign=\"top\">Addi. Info</td>";

        if (browser != "Microsoft Internet Explorer") {
            str = str + "<td align=\"center\" valign=\"top\">Premium 1</td><td align=\"center\" valign=\"top\">Position Premium</td><td align=\"center\" valign=\"top\">Pre(%)</td>";

            str = str + "<td align=\"center\" valign=\"top\">Adv Cat.</td>";


            str = str + "<td valign=\"top\">Discount</td><td valign=\"top\">Paid</td><td valign=\"top\">Paid Ins.</td><td valign=\"top\" >Solo Rate</td><td valign=\"top\" >Local Gross Amt</td><td valign=\"top\" >Page No.</td><td valign=\"top\" >Caption</td><td valign=\"top\" >Remarks</td><td valign=\"top\" >Local Bill Amt</td><td valign=\"top\" >Gross Amt</td><td valign=\"top\" >Bill Amt</td><td valign=\"top\" >Page Set</td>";


        }
        else {
            str = str + "<td align=\"center\" valign=\"top\">Premium 1</td><td align=\"center\" valign=\"top\">Position Premium</td><td align=\"center\" valign=\"top\">Pre(%)</td>";

            str = str + "<td align=\"center\" valign=\"top\">Adv Cat.</td>";


            str = str + "<td valign=\"top\">Discount</td><td valign=\"top\">Paid</td><td valign=\"top\">Paid Ins.</td><td valign=\"top\" >Solo Rate</td><td valign=\"top\" >Local Gross Amt</td><td valign=\"top\" >Page No.</td><td valign=\"top\" >Caption</td><td valign=\"top\" >Remarks</td><td valign=\"top\" >Local Bill Amt</td><td valign=\"top\" >Gross Amt</td><td valign=\"top\" >Bill Amt</td><td valign=\"top\" >Page Set</td>";

        }
        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[25].childNodes[15].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >Agn Amt</td>";
            }
            if (xmlObj.childNodes[25].childNodes[17].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >AdlAgn Amt</td>";
            }
            if (xmlObj.childNodes[25].childNodes[19].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >Spldisc</td>";
            }
            if (xmlObj.childNodes[25].childNodes[21].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >CashDisc</td>";
            }
            if (xmlObj.childNodes[25].childNodes[23].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >Round off</td>";
            }
        }
        else {
            if (xmlObj.childNodes[12].childNodes[7].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >Agn Amt</td>";
            }
            if (xmlObj.childNodes[12].childNodes[8].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >AdlAgn Amt</td>";
            }
            if (xmlObj.childNodes[12].childNodes[9].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >Spldisc</td>";
            }
            if (xmlObj.childNodes[12].childNodes[10].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >CashDisc</td>";
            }
            if (xmlObj.childNodes[12].childNodes[11].childNodes[0].nodeValue != "hide") {
                str = str + "<td  align=\"center\" valign=\"top\" >Round off</td>";
            }
        }
       // str = str + "<td valign=\"top\" id='uploadA' style=\"cursor:pointer;color:red;\" >Upload</td>";


        str = str + "</tr></table></div>";
        document.getElementById('tblinsert').innerHTML = str;
        var gridtab_vari = document.getElementById('gridtab');
        var insprev = 0;
        for (i = 0; i <= count; i++) {
            if (showordisable != "1" && ds.Tables[0].Rows[i].Insert_status != "billed" && (ds.Tables[0].Rows[i].Insert_status != "publish" && document.getElementById('hiddenrateauditflag').value != "rateaudit" && document.getElementById('hiddenrateauditpreferrence').value != "Y"))
                document.getElementById('btnshgrid').disabled = false;

            var id = "Text" + i;
            editid = "edit" + i;
            inserts = "ins" + i;
            btn_Pg_ = "btn_Pg_" + i;
            agnamnt = "agmn" + i;
            adlgn = "adlag" + i;
            spldisc = "spld" + i;
            cashdisc = "cashd" + i;
            roundoffval = "roundoffval" + i;

            Make_Row = document.createElement("tr");
            make_td = document.createElement("td");
            make_td.align = "center";
            str = "<input  class='buttonpgset' id='" + btn_Pg_ + "'  type='button' Value='PageSet'>";
            make_td.innerHTML = str;
           // Make_Row.appendChild(make_td);

          
            // new change 31 dec 09
            if (ds.Tables[0].Rows[i].no_insert == "1") {
                if (arrEdition_Item == "")
                    arrEdition_Item = ds.Tables[0].Rows[i].Edition;
                else
                    arrEdition_Item = arrEdition_Item + "," + ds.Tables[0].Rows[i].Edition;
            }
            insertval = ds.Tables[0].Rows[i].no_insert;
            make_td = document.createElement("td");
            make_td.align = "center";
            //make_td.setAttribute('readonly', true);
            make_td.setAttribute("class", "TextField");
            make_td.innerHTML = ds.Tables[0].Rows[i].no_insert;
            make_td.id = inserts;
            if (insprev != insertval)// && showordisable!="1" )
            {
                insprev = insertval;
                make_td.title = "Edit Insert";
            }
            Make_Row.appendChild(make_td);
            // EDITION
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.setAttribute("class", "dtGrid");
            str = "<input class=\"btextforgrid7\" type=\"text\" disabled id=" + editid + " value='" + ds.Tables[0].Rows[i].Edition + "'>";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);

            //////this is to bind the insertion date   publish
            var mode = "1";
            var insdat = ds.Tables[0].Rows[i].Insert_date

            if (insdat == "" || insdat == null || insdat == "null")
                var getdateforexe = "";
            else
                var getdateforexe = savedateinto(ds.Tables[0].Rows[i].Insert_date, mode);
            var billdate = ds.Tables[0].Rows[i].BILL_DATE;
            if (billdate == "" || billdate == null || billdate == "null")
                billdate = "";
            else
                billdate = savedateinto(billdate, mode);
            if (showordisable == "1" || ((ds.Tables[0].Rows[i].Insert_status == "cancel" || (ds.Tables[0].Rows[i].Insert_status == "billed" && getdateforexe != "") || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y") && getdateforexe != "")) && hidcopy != "copy")) {
                ////                str=str + "<td><input class=\"btextforgrid\"  type=\"text\" disabled id="+id+" value="+getdateforexe+"><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1."+id+", Form1."+id+", "+dat+");\" height=\"14\" width=\"14\" /></td>";
                make_td = document.createElement("td");
                make_td.align = "center";
                if (ds.Tables[0].Rows[i].Insert_status != "cancel" && showordisable == "01") {
                   // var t_res = compareDatewithBilledDate(dateformat, getdateforexe, billdate, ds.Tables[0].Rows[i].INSERT_STATUS_PUB, ds.Tables[0].Rows[i].Insert_status);
//                    if (t_res == true)
//                        str = "<input class=\"btextforgriddate\" type=\"text\"  id=" + id + "  value=" + getdateforexe + " >";
//                    else
//                        str = "<input class=\"btextforgriddate\" type=\"text\" disabled id=" + id + "  value=" + getdateforexe + " >";
                }
                else
                    str = "<input class=\"btextforgriddate\" type=\"text\" disabled id=" + id + "  value=" + getdateforexe + " >";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
            else {
                ////                str=str + "<td><input class=\"btextforgrid\"  type=\"text\" id="+id+" value="+getdateforexe+" ><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1."+id+", Form1."+id+", "+dat+");\" height=\"14\" width=\"14\" /></td>";
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextforgriddate\" type=\"text\" id=" + id + " onchange=\"return chkDateforGrid(this);\"   value=" + getdateforexe + " >";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
var latdate;
            if (ds.Tables[0].Rows[i].Latest_by == null) {
                latdate = "";
            }
            else {
                latdate = ds.Tables[0].Rows[i].Latest_by;
            }

            if (showordisable == "1") {
                var latedate = "lat" + i;

                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.setAttribute("class", "dtGrid");
                make_td.innerHTML = "<input class=\"btextforgriddate\"   type=\"text\"   disabled id=" + latedate + "  value=" + latdate + ">";

                Make_Row.appendChild(make_td);
            }
            else {
                var latedate = "lat" + i;

                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.setAttribute("class", "dtGrid");
                make_td.innerHTML = "<input class=\"btextforgriddate\"   type=\"text\"    id=" + latedate + "  value=" + latdate + ">";

                Make_Row.appendChild(make_td);
            }
                 
            
            
            

            ////this is to bind the Ad sub cat drop down
            adsubcat = "ads" + i;
            var adsubcatval = '';
            if (ds.Tables[0].Rows[i].Ad_sub_cat != null)
                adsubcatval = ds.Tables[0].Rows[i].Ad_sub_cat;
            if (showordisable == "1" || ((ds.Tables[0].Rows[i].Insert_status == "cancel" || (ds.Tables[0].Rows[i].Insert_status == "billed" && getdateforexe != "") || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y") && getdateforexe != "")) && hidcopy != "copy")) {
                ////                str=str+"<td><select disabled id="+adsubcat+" class=\"dropdownforgrid1\" >";
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.setAttribute("class", "dtGrid");
                if (i == 0) {
                    str = "<input class=\"btextforgrid\" disabled type=\"text\"  id=" + adsubcat + " value=" + adsubcatval + "><div id='agdiv' Width=100px Height=50px style='position:absolute;display: none;'><select name='aglist'  id='aglist' CssClass='btextlist' size=4 Width=100px Height=50px></select></div>";
                }
                else {
                    str = "<input class=\"btextforgrid\" disabled type=\"text\"  id=" + adsubcat + " value=" + adsubcatval + ">";
                }
            }
            else {
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.setAttribute("class", "dtGrid");
                ////                str=str+"<td><select id="+adsubcat+" class=\"dropdownforgrid1\" onchange=\"getvalueintoinserts("+adsubcat+","+inserts+","+ds.Tables[0].Rows[i].no_insert+");\">";
                if (i == 0) {
                    str = "<input class=\"btextforgrid\"  type=\"text\"  id=" + adsubcat + " value=" + adsubcatval + "><div id='agdiv' Width=100px Height=50px style='position:absolute;display: none;'><select name='aglist'   id='aglist' CssClass='btextlist' size=4 Width=100px Height=50px></select></div>";
                }
                else {
                    str = "<input class=\"btextforgrid\"  type=\"text\"  id=" + adsubcat + " value=" + adsubcatval + ">";
                }
            }
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);

         


////            }

       

            premid = "prem" + i;
            prem1id = "premone" + i;
            height = "hei" + i;
            width = "wid" + i;
            size = "siz" + i;
            pagepost = "pagpos" + i;
            noofcol = "nocol" + i;
            var widthexe;
            var noofexe;
            if (ds.Tables[0].Rows[i].Width == null) {
                widthexe = ""
            }
            else {
                widthexe = ds.Tables[0].Rows[i].Width
            }

            if (ds.Tables[0].Rows[i].No_ofcolumn == null) {
                noofexe = "";
            }
            else {
                noofexe = ds.Tables[0].Rows[i].No_ofcolumn;
            }

            if (showordisable == "1" || ((ds.Tables[0].Rows[i].Insert_status == "cancel" || (ds.Tables[0].Rows[i].Insert_status == "billed" && getdateforexe != "") || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y") && getdateforexe != "")) && hidcopy != "copy")) {


                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Size_book + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
            else {


                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Size_book + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }

            var upl = "material" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input  class=\"button1\" type=\"button\" id=" + upl + " Value=\"Attachment\"  onclick=\"uploadimage()\">";
            Make_Row.appendChild(make_td);
            






         
            
            
            
            
            ////this loop is to bind the insert status
            insertsta = "inssta" + i;
            if (hidcopy == "copy" && showordisable == "0") {
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input class=\"btextforgrid\" disabled  type=\"text\" id=" + insertsta + "  value='" + "booked" + "'>";
                Make_Row.appendChild(make_td);
            }

            else if (showordisable == "1" || ((ds.Tables[0].Rows[i].Insert_status == "cancel" || (ds.Tables[0].Rows[i].Insert_status == "billed" && getdateforexe != "") || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y") && getdateforexe != "")) && hidcopy != "copy")) {
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input class=\"btextforgrid\" disabled  type=\"text\" id=" + insertsta + "  value='" + ds.Tables[0].Rows[i].Insert_status + "'>";
                Make_Row.appendChild(make_td);
            }
            else {
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input class=\"btextforgrid\" disabled  type=\"text\" id=" + insertsta + "  value='" + ds.Tables[0].Rows[i].Insert_status + "'>";
                Make_Row.appendChild(make_td);
            }

            //this is to fill card rate
            cardid = "cardrate" + i; 
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].Card_rate!=null)
                str = "<input class=\"btextforgrid\" disabled  type=\"text\" id=" + cardid + "  value='" + ds.Tables[0].Rows[i].Card_rate + "'>";
            else
            str = "<input class=\"btextforgriddate\" type=\"text\" id=" + cardid + "   value=\"\"  >";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);


            //// this is for the discount rate
            discrate = "disrat" + i;

            billstat = "bill" + i;
            agrred = "agr" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].Disc_rate != null)
                make_td.innerHTML = "<input class=\"btextforgrid\" type=\"text\" disabled id=" + discrate + "  value=" + ds.Tables[0].Rows[i].Disc_rate + ">";
            else
                make_td.innerHTML = "<input class=\"btextforgrid\" type=\"text\" disabled id=" + discrate + "  value=''>";

            Make_Row.appendChild(make_td);
            //agreed amt
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].Agreed_rate != null)
                make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agrred + "  value=" + ds.Tables[0].Rows[i].Agreed_rate + ">";
            else
                make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agrred + "  value=''>";
            Make_Row.appendChild(make_td);





            //////////// for file name
            filename = "fil" + i;
            if (ds.Tables[0].Rows[i].File_name == null) {
                ds.Tables[0].Rows[i].File_name = "";
            }
            if (hidcopy == "copy" && showordisable == "0") {
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextforgrid\" type=\"text\" disabled id=" + filename + " disabled  value=" + "" + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
            else {
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextforgrid\" type=\"text\" disabled id=" + filename + " disabled  value=" + ds.Tables[0].Rows[i].File_name + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }

            /////////////this is to bind the status material drop down
            matsta = "mat" + i;
            if (showordisable == "1" || ((ds.Tables[0].Rows[i].Insert_status == "cancel" || (ds.Tables[0].Rows[i].Insert_status == "billed" && getdateforexe != "") || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y") && getdateforexe != "")) && hidcopy != "copy")) {
                make_td = document.createElement("td");
                make_td.align = "center";
                if (ds.Tables[0].Rows[i].Status_material != null) {
                    str = "<input class=\"btextforgrid\" disabled  id=" + matsta + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Status_material + ">";
                }
                else {
                    str = "<input class=\"btextforgrid\" disabled  id=" + matsta + " type=\"text\"  value=''>";
                }
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
            else {
                make_td = document.createElement("td");
                make_td.align = "center";
                if (ds.Tables[0].Rows[i].Status_material == null) {
                    str = "<input class=\"btextforgrid\"   id=" + matsta + " type=\"text\"  value=''>";
                }
                else {
                    str = "<input class=\"btextforgrid\"   id=" + matsta + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Status_material + ">";
                }
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
            //geography

           
            
            var geogr= "geo" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input  class=\"button1\" type=\"button\" id=" + geogr + " Value=\"Add. Info\"  >";
            Make_Row.appendChild(make_td);
            
            
            
//premium1

            make_td = document.createElement("td");
            premper = "prempe" + i;
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + premper + "  disabled  value=" + ds.Tables[0].Rows[i].File_name + " >";

            Make_Row.appendChild(make_td);



            make_td = document.createElement("td");
            pospre = "posprem" + i;
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + pospre + "  disabled  value=" + ds.Tables[0].Rows[i].File_name + "  >";

            Make_Row.appendChild(make_td);



            //prm %

            pageprem = "pagper" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + pageprem + "   value=\"\"  >";

            Make_Row.appendChild(make_td);


            //ad cat
            if (showordisable == "1" || ((ds.Tables[0].Rows[i].Insert_status == "cancel" || (ds.Tables[0].Rows[i].Insert_status == "billed" && getdateforexe != "") || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y") && getdateforexe != "")) && hidcopy != "copy")) {

                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input disabled class=\"dropdownforgrid\" type=\"text\" id=" + adcat + " value='" + ds.Tables[0].Rows[i].Ad_cat + "'>";
                Make_Row.appendChild(make_td);
            }
            else {
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input  class=\"dropdownforgrid\" type=\"text\" id=" + adcat + " value='" + ds.Tables[0].Rows[i].Ad_cat + "'>";
                Make_Row.appendChild(make_td);
            }
            //Discount

   






            var discount_ = "disc_" + i;
            //bhanu//
            if (ds.Tables[0].Rows[i].DISCOUNT == null)
                ds.Tables[0].Rows[i].DISCOUNT = "";
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[25].childNodes[13].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[8].Rows[0].Paid_permission == "0" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) {
                        make_td.innerHTML = "<input class=\"btextsmallsizeH\" disabled type=\"text\" id=" + discount_ + "   value='" + ds.Tables[0].Rows[i].DISCOUNT + "' >";
                    }
                    else if (document.getElementById('hiddisceditgrid').value == "Y")
                        make_td.innerHTML = "<input class=\"btextsmallsizeH\"  type=\"text\" id=" + discount_ + "  value='" + ds.Tables[0].Rows[i].DISCOUNT + "'  >";
                    else
                        make_td.innerHTML = "<input class=\"btextsmallsizeH\" disabled type=\"text\" id=" + discount_ + "  value='" + ds.Tables[0].Rows[i].DISCOUNT + "'  >";

                    Make_Row.appendChild(make_td);
                }
                if (xmlObj.childNodes[23].childNodes[37].childNodes[0].nodeValue != "enable") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<select disabled id=" + paid + " class=\"dropdownforgridsmall\" >";
                }
                else {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[8].Rows[0].Paid_permission == "0" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) {
                        ////                            str=str+"</select></td><td><select disabled id="+paid+" class=\"dropdownforgridsmall\" >";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<select disabled id=" + paid + " class=\"dropdownforgridsmall\" >";
                    }
                    else {
                        if (ds.Tables[8].Rows[0].Paid_permission == "0") {
                            ////                                str=str+"</select></td><td><select id="+paid+" disabled class=\"dropdownforgridsmall\" \">";//onchange=\"putpaidintoinsert("+paid+","+inserts+","+ds.Tables[0].Rows[i].no_insert+");\">";
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = "<select id=" + paid + " disabled class=\"dropdownforgridsmall\">";
                        }
                        else {
                            ////                                str=str+"</select></td><td><select id="+paid+" class=\"dropdownforgridsmall\" \">";//onchange=\"putpaidintoinsert("+paid+","+inserts+","+ds.Tables[0].Rows[i].no_insert+");\">";                                    
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = "<select id=" + paid + " class=\"dropdownforgridsmall\">";
                        }
                    }
                }
            }
            else {
                if (xmlObj.childNodes[12].childNodes[6].childNodes[0].nodeValue != "hide") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[8].Rows[0].Paid_permission == "0" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) {
                        make_td.innerHTML = "<input class=\"btextsmallsizeH\" disabled type=\"text\" id=" + discount_ + "   value='" + ds.Tables[0].Rows[i].DISCOUNT + "' >";
                    }
                    else if (document.getElementById('hiddisceditgrid').value == "Y")
                        make_td.innerHTML = "<input class=\"btextsmallsizeH\"  type=\"text\" id=" + discount_ + "  value='" + ds.Tables[0].Rows[i].DISCOUNT + "'  >";
                    else
                        make_td.innerHTML = "<input class=\"btextsmallsizeH\" disabled type=\"text\" id=" + discount_ + "   value='" + ds.Tables[0].Rows[i].DISCOUNT + "'  >";

                    Make_Row.appendChild(make_td);
                }
                if (xmlObj.childNodes[11].childNodes[18].childNodes[0].nodeValue != "enable") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<select disabled id=" + paid + " class=\"dropdownforgridsmall\" >";
                }
                else {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[8].Rows[0].Paid_permission == "0" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) {
                    
                    }
                    else {
                        if (ds.Tables[8].Rows[0].Paid_permission == "0") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = "<select id=" + paid + " disabled class=\"dropdownforgridsmall\">";
                        }
                        else {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = "<select id=" + paid + " class=\"dropdownforgridsmall\">";
                        }
                    }
                }
            }
///paid
            make_td = document.createElement("td");
            premper = "prempe" + i;
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + premper + "   value=\"\"  >";

            Make_Row.appendChild(make_td);



            //paid ins

            pageprem = "pagper" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + pageprem + "   value=\"\"  >";

            Make_Row.appendChild(make_td);



// solo and gross rate


            solo = "sol" + i;
            gross = "gro" + i;
            if (showordisable == "1" || ((ds.Tables[0].Rows[i].Insert_status == "cancel" || (ds.Tables[0].Rows[i].Insert_status == "billed" && getdateforexe != "") || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y") && getdateforexe != "")) && hidcopy != "copy")) {
                ////                        str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" disabled id="+solo+"  value="+ds.Tables[0].Rows[i].Solo_rate+"></td>";
                ////                        str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" disabled id="+gross+"  value="+ds.Tables[0].Rows[i].Gross_rate+"></td>";
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextforgrid\" disabled type=\"text\" disabled id=" + solo + "  value=" + ds.Tables[0].Rows[i].Solo_rate + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);

                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextforgrid\" disabled type=\"text\" disabled id=" + grosslocal + "  value=" + ds.Tables[0].Rows[i].LOCALGROSSAMT + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
            else {
                ////                        str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+solo+"  value="+ds.Tables[0].Rows[i].Solo_rate+"></td>";
                ////                        str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+gross+"  value="+ds.Tables[0].Rows[i].Gross_rate+"></td>";
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextforgrid\" disabled type=\"text\" disabled id=" + solo + "  value=" + ds.Tables[0].Rows[i].Solo_rate + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);

                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input class=\"btextforgrid\" disabled type=\"text\" disabled id=" + grosslocal + "  value=" + ds.Tables[0].Rows[i].LOCALGROSSAMT + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
                //                                str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+solo+"  value="+ds.Tables[0].Rows[i].Solo_rate+"></td>";
                //                                str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+gross+"  value="+ds.Tables[0].Rows[i].Gross_rate+"></td>";

            }

//page --
            make_td = document.createElement("td");
            premper = "prempe" + i;
            make_td.align = "center";
            make_td.innerHTML = "<input class=\"btextforgriddate\" type=\"text\" id=" + premper + "   value=\"\"  >";

            Make_Row.appendChild(make_td);



           // caption



            caption_inserts = "cap" + i;
            if (ds.Tables[0].Rows[i].CAPTION == null) {
                ds.Tables[0].Rows[i].CAPTION = "";
            }
            if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "cancel" || ds.Tables[0].Rows[i].Insert_status == "billed" || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y"))) {
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input  class=\"btextforgrid\"  disabled  type=\"text\" id=" + caption_inserts + " title='" + ds.Tables[0].Rows[i].CAPTION + "'  value='" + ds.Tables[0].Rows[i].CAPTION + "'>";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
            else {
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input  class=\"btextforgrid\"   type=\"text\" id=" + caption_inserts + "  title='" + ds.Tables[0].Rows[i].CAPTION + "' value='" + ds.Tables[0].Rows[i].CAPTION + "'>";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }




          //  remark


            remark_inserts = "rem" + i;
            if (ds.Tables[0].Rows[i].Remarks == null) {
                ds.Tables[0].Rows[i].Remarks = "";
            }
            if (showordisable == "1" || ((ds.Tables[0].Rows[i].Insert_status == "cancel" || (ds.Tables[0].Rows[i].Insert_status == "billed" && getdateforexe != "") || ((ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "audit by rate") && (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y") && getdateforexe != "")) && hidcopy != "copy")) {
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input  class=\"btextforgrid\"  disabled  type=\"text\" id=" + remark_inserts + " title='" + ds.Tables[0].Rows[i].Remarks + "'  value='" + ds.Tables[0].Rows[i].Remarks + "'>";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }
            else {
                make_td = document.createElement("td");
                make_td.align = "center";
                str = "<input  class=\"btextforgrid\"   type=\"text\" id=" + remark_inserts + "  title='" + ds.Tables[0].Rows[i].Remarks + "' value='" + ds.Tables[0].Rows[i].Remarks + "'>";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
            }





            // new field for local gross and local bill amount
            var grosslocal = "grolocal" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].LOCALBILLAMT != null)
                make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + billamtlocal + "  value='" + ds.Tables[0].Rows[i].LOCALBILLAMT + "'>";
            else
                make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + billamtlocal + "  value=''>";
            Make_Row.appendChild(make_td);

            // str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billamt+"  value=\"\"></td>";
            var billamtlocal = "balocal" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].Gross_rate != null)
                make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + gross + "  value='" + ds.Tables[0].Rows[i].Gross_rate + "'>";
            else
                make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + gross + "  value=\"\">";
            Make_Row.appendChild(make_td);
            //bill amt

            var grid_billamt = ds.Tables[0].Rows[i].LOCALBILLAMT
            var grid_agnamnt = ds.Tables[0].Rows[i].agncyamnt;
            var grid_adlagn = ds.Tables[0].Rows[i].adlgncyamt;
            var grid_splamt = ds.Tables[0].Rows[i].spldisamt;
            var grid_cashamt = ds.Tables[0].Rows[i].cashdisamt;
            var grid_roundamt = ds.Tables[0].Rows[i].ROUND_VALUE;
            if (browser != "Microsoft Internet Explorer") {
             
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + billamt + "  value=" + grid_billamt + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
             

            }
            else {

             
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    if (grid_billamt != null) 
                        str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + billamt + "  value=" + grid_billamt + ">";
                   else
                       make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + billamt + "   value=\"\">";
                  
                    make_td.innerHTML = str;
                   // make_td.style.display = ;
                    Make_Row.appendChild(make_td);

                }


                //pageset
                var pageset = "pgst" + i;
                make_td = document.createElement("td");
                make_td.align = "center";
                make_td.innerHTML = "<input  class=\"button1\" type=\"button\" id=" + pageset + " Value=\"Page Set\" onclick=\"link()\"  >";
                Make_Row.appendChild(make_td);

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[25].childNodes[15].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + agnamnt + "  value=" + grid_agnamnt + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + agnamnt + "  value=" + grid_agnamnt + ">";
                        make_td.innerHTML = str;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }
                else {
                    if (xmlObj.childNodes[12].childNodes[7].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + agnamnt + "  value=" + grid_agnamnt + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + agnamnt + "  value=" + grid_agnamnt + ">";
                        make_td.innerHTML = str;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[25].childNodes[17].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + adlgn + "  value=" + grid_adlagn + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + adlgn + "  value=" + grid_adlagn + ">";
                        make_td.innerHTML = str;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }
                else {
                    if (xmlObj.childNodes[12].childNodes[8].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + adlgn + "  value=" + grid_adlagn + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + adlgn + "  value=" + grid_adlagn + ">";
                        make_td.innerHTML = str;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[25].childNodes[19].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + spldisc + "  value=" + grid_splamt + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + spldisc + "  value=" + grid_splamt + ">";
                        make_td.innerHTML = str;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }
                else {
                    if (xmlObj.childNodes[12].childNodes[9].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + spldisc + "  value=" + grid_splamt + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + spldisc + "  value=" + grid_splamt + ">";
                        make_td.innerHTML = str;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[25].childNodes[21].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + cashdisc + "  value=" + grid_cashamt + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + cashdisc + "  value=" + grid_cashamt + ">";
                        make_td.innerHTML = str;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }
                else {
                    if (xmlObj.childNodes[12].childNodes[10].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + cashdisc + "  value=" + grid_cashamt + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + cashdisc + "  value=" + grid_cashamt + ">";
                        make_td.innerHTML = str;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[25].childNodes[23].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + roundoffval + "  value=" + grid_roundamt + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + roundoffval + "  value=" + grid_roundamt + ">";
                        make_td.innerHTML = str;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }
                else {
                    if (xmlObj.childNodes[12].childNodes[11].childNodes[0].nodeValue != "hide") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + roundoffval + "  value=" + grid_roundamt + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextforgrid\"  type=\"text\" id=" + roundoffval + "  value=" + grid_roundamt + ">";
                        make_td.innerHTML = str;
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }
    


            showid = "sho" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            str = "<input class=\"btextforgrid\" style=\"display:none;\" type=\"text\" id=" + showid + "  value=" + ds.Tables[0].Rows[i].insert_id + ">";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);

            pkgcodegrid = 'hiddenpckcode' + i;
            //This is a hidden field in the insertion grid which holds the Package Code for internal processing only

            make_td = document.createElement("td");
            make_td.align = "center";
            str = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkgcodegrid + "' value='" + ds.Tables[0].Rows[i].PACKAGE_CODE + "'>";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);


            var pubcode = 'pubcode' + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pubcode + "' value='" + ds.Tables[0].Rows[i].PUBCODE + "'>";
            Make_Row.appendChild(make_td);

            var pkg_ins = 'pkg_ins' + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            str = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_ins + "' value='" + ds.Tables[0].Rows[i].INSERTS + "'>";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);

            pkg_alias = 'pkg_alias' + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            str = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_alias + "' value='" + ds.Tables[0].Rows[i].PKG_ALIAS + "'>";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);


            var spltdata = "spltdata" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            str = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + spltdata + "' value=\"\">";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);


            var subedidata = "subedidata" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            str = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + subedidata + "' value=\"\">";
            make_td.innerHTML = str;
            Make_Row.appendChild(make_td);

            var vat = "vat" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + vat + "' value='" + ds.Tables[0].Rows[i].VATAMT + "'>";
            Make_Row.appendChild(make_td);

            var boxc = "boxc" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].BOXCHARGE != "null" && ds.Tables[0].Rows[i].BOXCHARGE != null)
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + boxc + "' value='" + ds.Tables[0].Rows[i].BOXCHARGE + "'>";
            else
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + boxc + "' value=''>";
            Make_Row.appendChild(make_td);

            var vat_inc = "vat_inc" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].VAT_INC != "null" && ds.Tables[0].Rows[i].VAT_INC != null)
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + vat_inc + "' value='" + ds.Tables[0].Rows[i].VAT_INC + "'>";
            else
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + vat_inc + "' value=''>";
            Make_Row.appendChild(make_td);

            var coupan = "coupan" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].COUPON_AMOUNT != "null" && ds.Tables[0].Rows[i].COUPON_AMOUNT != null)
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + coupan + "' value='" + ds.Tables[0].Rows[i].COUPON_AMOUNT + "'>";
            else
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + coupan + "' value=''>";
            Make_Row.appendChild(make_td);

            var clicatamt = "clicatamt" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].CLIENT_CAT_D_AMT != "null" && ds.Tables[0].Rows[i].CLIENT_CAT_D_AMT != null)
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + clicatamt + "' value='" + ds.Tables[0].Rows[i].CLIENT_CAT_D_AMT + "'>";
            else
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + clicatamt + "' value=''>";
            Make_Row.appendChild(make_td);

            var flatfreqamt = "flatfreqamt" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].FLAT_FEQ_D_AMT != "null" && ds.Tables[0].Rows[i].FLAT_FEQ_D_AMT != null)
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + flatfreqamt + "' value='" + ds.Tables[0].Rows[i].FLAT_FEQ_D_AMT + "'>";
            else
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + flatfreqamt + "' value=''>";
            Make_Row.appendChild(make_td);

            var catamt = "catamt" + i;
            make_td = document.createElement("td");
            make_td.align = "center";
            if (ds.Tables[0].Rows[i].CAT_D_AMT != "null" && ds.Tables[0].Rows[i].CAT_D_AMT != null)
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + catamt + "' value='" + ds.Tables[0].Rows[i].CAT_D_AMT + "'>";
            else
                make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + catamt + "' value=''>";
            Make_Row.appendChild(make_td);
     

        

            gridtab_vari.getElementsByTagName("tbody")[0].appendChild(Make_Row);
            


        }

        if (browserversion > 6) {
            var dateformat_vari = document.getElementById('hiddendateformat');
            var compcode_vari = document.getElementById('hiddencompcode');
            var center_vari = document.getElementById('hiddencenter');
            var adtype_vari = document.getElementById('hiddenadtype');
            var chkall_vari = document.getElementById('chkall');

            var temp = idnew;
        
        
        
            $(".dropdownforgridsmall").change(function() {
                if (document.activeElement.id.indexOf("pai") >= 0) {
                    blankGross();
                }
            });
            $(".btextsmallsizeH").change(function() {
                if (document.activeElement.id.indexOf("pgpre") >= 0 || document.activeElement.id.indexOf("nocol") >= 0 || document.activeElement.id.indexOf("hei") >= 0 || document.activeElement.id.indexOf("wid") >= 0 || document.activeElement.id.indexOf("ins") >= 0) {
                    var i;
                    if (document.activeElement.id.indexOf("disc_") >= 0) {
                        blankGross();
                    }
                    if (document.activeElement.id.indexOf("pgpre") >= 0) {
                        i = document.activeElement.id.substring(5, document.activeElement.id.length + 1);
                        var page = "pgpre" + i;
                        var pagstr = "sec";
                        var f = getpageprem(page, i, pagstr);
                        if (f == false)
                            return false;
                    }
                    else {
                        if (document.activeElement.id.indexOf("nocol") >= 0) {
                            i = document.activeElement.id.substring(5, document.activeElement.id.length + 1);

                        }
                        else {
                            i = document.activeElement.id.substring(3, document.activeElement.id.length + 1);

                        }
                        var height = "hei" + i;
                        var width = "wid" + i;
                        var inserts = "ins" + i;
                        var insertval = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(i, 10) + 1].cells[0].innerHTML;
                        var noofcol = "nocol" + i;
                        var f = gettotalsize(height, width, i, inserts, insertval, noofcol);
                        if (f == false)
                            return false;
                    }
                }
            });
            $(".btextforgriddate").change(function() {
                if (document.activeElement.id.indexOf("Text") >= 0) {
                    document.getElementById('txtgrossamt').value = "";
                    document.getElementById('txtbillamt').value = "";
                    document.getElementById('txtgrossamtlocal').value = "";
                    document.getElementById('txtbillamtlocal').value = "";
                    var f = chkDateforGrid(this);
                    if (f == false)
                        return false;
                }
                else if (document.activeElement.id.indexOf("rep") >= 0 || document.activeElement.id.indexOf("lat") >= 0) {
                    checkdate(document.getElementById(document.activeElement.id));
                }
            });
            for (i = 0; i < gridtab_vari.getElementsByTagName("tbody")[0].rows.length - 1; i++) {
                if (repeatdate == "0" || repeatdate == "1") {
                    var id = "Text" + i;
                    if (caldatemonth.length >= i) {
                        //   if(caldatemonth[i]!=undefined)
                        //    {
                        //var mmM=caldatemonth[i].toString();
                        //}
                        //else{
                        var mmM = parseInt(monthSelected, 10) + 1;
                        mmM = mmM.toString();
                        //if (dateSelected.toString().length == 1)
                          //  dateSelected = "0" + dateSelected.toString();
                        // }
                    }
                    else {
                        var mmM = parseInt(monthSelected, 10) + 1;
                        mmM = mmM.toString();
//                        if (dateSelected.toString().length == 1)
//                            dateSelected = "0" + dateSelected.toString();
                    }
                    if (mmM.toString().length == 1)
                        mmM = "0" + mmM.toString();

                    if (dateformat_vari.value == "mm/dd/yyyy") {
                        vvalue = mmM + "/" + dateSelected + "/" + yearSelected;
                    }
                    else if (dateformat_vari.value == "dd/mm/yyyy") {
                        vvalue = dateSelected + "/" + mmM + "/" + yearSelected; ;
                    }
                    else if (dateformat_vari.value = "yyyy/mm/dd") {
                        vvalue = yearSelected + "/" + mmM + "/" + dateSelected; ;
                    }
                    vvalue = document.getElementById('Text' + i).value;
                    if (dateSelected != undefined && dateSelected != "") {
                        if (browser != "Microsoft Internet Explorer") {
                            var pkgfullname = document.getElementById('pkg_alias' + i).value;
                            var pkgid = document.getElementById('hiddenpckcode' + i).value;
                            var pkgname = document.getElementById('pkg_alias' + i).value;
                            var compcode = compcode_vari.value;

                            dateday = vvalue;

                            document.getElementById('Text' + i).value = vvalue;
                        }
                        else {
                            var pkgfullname = document.getElementById('pkg_alias' + i).value;
                            var pkgid = document.getElementById('hiddenpckcode' + i).value;
                            var pkgname = document.getElementById('pkg_alias' + i).value;
                            //var compcode = compcode_vari.value;
                            dateday = vvalue;

                            document.getElementById('Text' + i).value = vvalue;
                        }
                        if (browser != "Microsoft Internet Explorer") {
                            var httpRequest = null; ;
                            httpRequest = new XMLHttpRequest();
                            if (httpRequest.overrideMimeType) {
                                httpRequest.overrideMimeType('text/xml');
                            }

                            httpRequest.onreadystatechange = function() { alertContents(httpRequest) };
                            var adcat = adcat_vari.value;
                            httpRequest.open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
                            httpRequest.send('');
                            //alert(httpRequest.readyState);
                            if (httpRequest.readyState == 4) {
                                //alert(httpRequest.status);
                                if (httpRequest.status == 200) {
                                    strtext = httpRequest.responseText;
                                }
                                else {
                                    alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                                }
                            }
                        }
                        else {
                            validuse = "";
                            var xml = new ActiveXObject("Microsoft.XMLHTTP");
                            //var adcat = adcat_vari;
                            var center = '';
//                            if (center_vari != null) {
//                                center = center_vari.value;
//                                if (chkall_vari != null) {
//                                    if (chkall_vari.checked == true) {
//                                        center = '0';
//                                    }
//                                }
//                                else {
//                                    center = '0';
//                                }
//                            }
                            xml.Open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
                            xml.Send();
                            strtext = xml.responseText;
                        }
                        if (strtext == "NOT A VALID DATE") {
                            alert("NOT A VALID DATE");
                            document.getElementById(id).value = "";
                            return false;
                        }
                        if (strtext == "0") {
                            //alert("Day is not the publishing day");
                            document.getElementById(id).value = "";
                            return false;
                        }
                        else {
                            if (strtext == "1")
                                document.getElementById(id).value = vvalue;
                            else {
                                if (strtext != "") {
                                    if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                                        var txt = strtext;
                                        var txt1 = txt.split("/");
                                        var dd = txt1[0];
                                        var mm1 = txt1[1];
                                        var mm = txt1[1]; //getMonthNo(mm1);
                                        var yy = txt1[2];
                                        caldate[cali] = dd;
                                        caldatemonth[cali] = mm;
                                        caldateyear[cali] = yy;
                                        cali = parseInt(cali, 10) + 1;
                                    }
                                    else if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                                        var txt = strtext;
                                        var txt1 = txt.split("/");
                                        var dd = txt1[1];
                                        var mm1 = txt1[0];
                                        var mm = txt1[0]; //getMonthNo(mm1);
                                        var yy = txt1[2];
                                        caldate[cali] = dd;
                                        caldatemonth[cali] = mm;
                                        caldateyear[cali] = yy;
                                        cali = parseInt(cali, 10) + 1;
                                    }
                                    else if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
                                        var txt = strtext;
                                        var txt1 = txt.split("/");
                                        var dd = txt1[2];
                                        var mm1 = txt1[1];
                                        var mm = txt1[1]; //getMonthNo(mm1);
                                        var yy = txt1[0];
                                        caldate[cali] = dd;
                                        caldatemonth[cali] = mm;
                                        caldateyear[cali] = yy;
                                        cali = parseInt(cali, 10) + 1;
                                    }
                                }
                                document.getElementById(id).value = strtext;
                                if (vvalue != strtext) {
                                    alert(vvalue + " Date is no issue date of edition " + pkgname);
                                    document.getElementById(id).value = "";
                                    cali = cali - 1;
                                }
                            }
                        }
                    }
                }
                temp = parseInt(temp) + 1;
            }
        }
        else {
            for (i = 0; i <= count; i++) {
                var height = "hei" + i;
                var late = "lat" + i;
                var repeat = "rep" + i;
                var page = "pagpos" + i;
                var pagstr = "sec";
                var adcat = "adcat" + i;
                var adsubcat = "ads" + i;
                var premid = "prem" + i;
                var id = "Text" + i;
                var width = "wid" + i;
                var noofcol = "nocol" + i;
                inserts = "ins" + i;
                var paid = "pai" + i;
                var disc = "disc_" + i;
                var insertval = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[i + 1].cells[1].innerHTML;
                var height_vari = document.getElementById(height);
             //   var par1 = (height_vari.parentNode).parentNode;
                if (browser != "Microsoft Internet Explorer") {
//                    document.getElementById(height).onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
//                    document.getElementById(width).onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
//                    document.getElementById(noofcol).onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");

//                    document.getElementById(late).onchange = new Function("return checkdate(Form1." + late + ");");
//                    document.getElementById(repeat).onchange = new Function("return checkdate(Form1." + repeat + ");");
//                    document.getElementById(page).onchange = "return getpageprem('" + page + "'," + i + ",'" + pagstr + "');";
//                    document.getElementById(id).onchange = new Function("return chkDateforGrid(this);");
//                    document.getElementById(premid).onchange = new Function("getpercenprem('" + premid + "'," + i + ",'" + namecode + "')");
//                    if (document.getElementById(paid) != undefined && document.getElementById(paid) != "undefined" && document.getElementById(paid) != null)
//                        document.getElementById(paid).onchange = new Function("return blankGross();");
//                    if (document.getElementById(disc) != undefined && document.getElementById(disc) != "undefined" && document.getElementById(disc) != null)
//                        document.getElementById(disc).onchange = new Function("return blankGross();");

                }
                else {
                    //anujpar1.all[height].onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                    //anujpar1.all[width].onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                    //anujpar1.all[noofcol].onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");

//                    par1.all[late].onchange = new Function("return checkdate(Form1." + late + ");");
//                    par1.all[repeat].onchange = new Function("return checkdate(Form1." + repeat + ");");
//                  //  par1.all[page].onchange = "return getpageprem('" + page + "'," + i + ",'" + pagstr + "');";
//                    par1.all[id].onchange = new Function("return chkDateforGrid(this);");
//                    par1.all[premid].onchange = new Function("getpercenprem('" + premid + "'," + i + ",'" + namecode + "')");
//                    if (par1.all[paid] != undefined && par1.all[paid] != "undefined" && par1.all[paid] != null)
//                        par1.all[paid].onchange = new Function("return blankGross();");
//                    if (par1.all[disc] != undefined && par1.all[disc] != "undefined" && par1.all[disc] != null)
//                        par1.all[disc].onchange = new Function("return blankGross();");
                }
            }
        }
        arrangeArrayItems();

    }
    if (activeD == "btnDelete" && document.getElementById('tblinsert').innerHTML != "") {
        activeD = "";
        var y = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length;

        for (var i = 0; i < y - 1; i++) {
            if (document.getElementById("inssta" + i) != null && document.getElementById("inssta" + i).value == "booked") {
                document.getElementById("inssta" + i).value = "cancel";
                document.getElementById("txtgrossamt").value = "";
                document.getElementById('txtgrossamtlocal').value = "";
                document.getElementById('txtbillamtlocal').value = "";
            }
        }
    }

    ////        // add insertion
//    var objinsert = document.getElementById('drpinsertion');
//    if (objinsert.options.length <= 1) {
//        objinsert.options.length = 0;
//        objinsert.options[0] = new Option("-Select-", "0");
//        for (var i = 1; i <= document.getElementById('txtinsertion').value; i++) {
//            objinsert.options[objinsert.options.length] = new Option(i, i);
//            objinsert.options.length;
//        }
//    }
  //anuj  tooltipadsubcat();

}




function savedateinto(dat, id) {
    var sadate = dat;
    var setdate;
    var dateformat = document.getElementById('hiddendateformat').value;
    if (id == "0") {
        if (sadate != "") {
            if (dateformat == "mm/dd/yyyy") {
                return setdate = sadate;
            }
            if (dateformat == "dd/mm/yyyy") {
                var txt1 = sadate;
                var txt2 = txt1.split("/");
                var dd = txt2[0];
                var mm = txt2[1];
                var yy = txt2[2];
                return setdate = mm + '/' + dd + '/' + yy;
            }
            if (dateformat == "yyyy/mm/dd") {
                var txt1 = sadate;
                var txt2 = txt1.split("/");
                var yy = txt2[0];
                var mm = txt2[1];
                var dd = txt2[2];
                return setdate = mm + '/' + dd + '/' + yy;

            }
        }
    }
    if (id == "1") {
        var currdate = new Date(sadate);


        var dd = currdate.getDate();
        var mm = currdate.getMonth() + 1;
        var yyyy = currdate.getFullYear();
        if (mm.toString().length == 1)
            mm = "0" + mm;
        if (dd.toString().length == 1)
            dd = "0" + dd;
        var currdate1 = mm + '/' + dd + '/' + yyyy;
        var currda = dd + '/' + mm + '/' + yyyy;
        var curryear = yyyy + '/' + mm + '/' + dd;

        if (dateformat == "mm/dd/yyyy") {
            return currdate1;

        }
        else if (dateformat == "dd/mm/yyyy") {
            return currda;

        }
        if (dateformat == "yyyy/mm/dd") {
            return curryear;

        }



    }


}




function insertLine() {
    //////////////this code is to split the code as well as ites description   
    var objpack = document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var code = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (temp != "") {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode + "," + code;
                desc = tempcode + "," + desc;
            }
            else {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode;
                desc = tempcode;
            }
        }

    }

    //////////////////////////////////////////////////////////////////

    var insert = document.getElementById('hiddeninserts').value;

    if (checkflag == 1) {
        document.getElementById('txtinsertion').value = parseInt(document.getElementById('txtinsertion').value) + 1;
        document.getElementById('txtpaid').value = document.getElementById('txtinsertion').value;
    }
    var clientname = document.getElementById('txtclient').value;
    var client_split;
    if (clientname.indexOf("(") >= 0) {
        clientname = clientname.split("(");
        client_split = clientname[1];
        client_split = client_split.replace(")", "");
        clientname = client_split;

    }
//    var adcat3 = document.getElementById('drpadcat3').value;
//    var adcat4 = document.getElementById('drpadcat4').value;
    //    var adcat5 = document.getElementById('drpadcat5').value;
    var adcat3 = "";
    var adcat4 = "";
    var adcat5 = "";
    //document.getElementById('drpadsubcategory').value
    var drpadsubcategory = "";
    // document.getElementById('drpcolor').value
    var drpcolor = "B"
    var check_or = "";
    //web_booking.getData(document.getElementById('drppackage').value,document.getElementById('txtinsertion').value,document.getElementById('txtrepeatingdate').value,document.getElementById('txtdummydate').value,document.getElementById('hiddendateformat').value,document.getElementById('hiddencompcode').value,insertLine_callback);
    if (che_flag == 1) {
        desc = document.getElementById('hidval').value;
    }
    var ds_linedrop = web_booking.getData(desc, document.getElementById('txtinsertion').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('hdncategory').value, drpadsubcategory, drpcolor, "WE0", document.getElementById('drpcurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, document.getElementById('drppageprem').value, clientname, adcat3, adcat4, adcat5,"");
    insertLinedrop_callback(ds_linedrop);
}


function checkdateInsert() {
    if (document.getElementById('txtdummydate').value == "") {
        alert("Please Select Publish date first");
        //document.getElementById('txtdummydate').focus();
        return false;
    }
    rateenter(event);
}




function rateenter(event) {
    //alert(event.keyCode);
    if (document.all) {
        if ((event.keyCode >= 46 && event.keyCode <= 57) || (event.keyCode == 127) || (event.keyCode == 8) || (event.keyCode == 9) || (event.keyCode == 190) || (event.keyCode >= 96 && event.keyCode <= 105) || (event.keyCode == 110)) {
            return true;
        }
        else {
            return false;
        }
    }
    else {
        // alert(event.which);
        if ((event.which >= 46 && event.which <= 57) || (event.which == 127) || (event.which == 8) || (event.which == 9) || (event.which == 0) || (event.which == 190) || (event.which >= 96 && event.which <= 105) || (event.which == 110)) {
            return true;
        }
        else {
            return false;
        }
    }
}



function onRepeatingDate() {
    if (document.getElementById('txtinsertion').value == "0") {
        alert("Insertion can't be 0");
        return false;
    }
    if (document.getElementById('txtdummydate').value == "") {
        alert("Please enter Date");
        document.getElementById('txtdummydate').focus();
        return false;
    }
    document.getElementById('txtgrossamt').value = '';
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
//    var adcat3 = document.getElementById('drpadcat3').value;
//    var adcat4 = document.getElementById('drpadcat4').value;
//    var adcat5 = document.getElementById('drpadcat5').value;
    var clientname = document.getElementById('txtclient').value;
    var client_split;
    if (clientname.indexOf("(") >= 0) {
        clientname = clientname.split("(");
        client_split = clientname[1];
        client_split = client_split.replace(")", "");
        clientname = client_split;
    }
    //////////////this code is to split the code as well as ites description 

    ///////this is to get the value into paid ins. text b0x
    if (document.getElementById('txtpaid').value != "") {
        var paidno = document.getElementById('txtpaid').value;
        var valinsert = document.getElementById('txtinsertion').value;
        document.getElementById('txtpaid').value = (parseInt(valinsert) - parseInt(paidno)) + parseInt(paidno);
    }

    var objpack = document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var code = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            if (temp != "") {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode + "," + code;
                desc = tempcode + "," + desc;
            }
            else {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode;
                desc = tempcode;
            }
        }
    }

    if (document.getElementById('txtrepeatingdate').value != "") {
        var insertval = document.getElementById('txtinsertion').value
        if (parseInt(document.getElementById('txtinsertion').value) == 1) {
            if (document.getElementById('drppackagecopy').options.length > 0) {
                for (var insertCou = 0; insertCou < document.getElementById('drppackagecopy').options.length; insertCou++) {
                    if (document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') >= 0) {
                        var tinsert = document.getElementById('drppackagecopy').options[insertCou].value.substring(document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') + 1, document.getElementById('drppackagecopy').options[insertCou].value.indexOf(')'));
                        if (tinsert > 1)
                            break;
                    }
                }
            }
            if (tinsert <= 1) {
                document.getElementById('txtrepeatingdate').value = "";
                return false;
            }
        }

        repeatdate = "1";
        suboradd = "1";
    }
    else {
        repeatdate = "0";
        suboradd = "1";
    }
    if (parseInt(previnsertion) > parseInt(document.getElementById('txtinsertion').value)) {
        repeatdate = "1";
        suboradd = "0";
    }
    if (repeatdate == "1") {
        //document.getElementById('tblinsert').innerHTML="";
        subtractrow = "";
    }
    if (parseInt(document.getElementById('txtinsertion').value) > parseInt(previnsertion)) {
        suboradd = "1";
    }

    var insert = document.getElementById('hiddeninserts').value;
    var class_insert = document.getElementById('txtinsertion').value;

    var center = "0";

    var lines_to;
//    if (document.getElementById('txtadsize1').disabled == false) {
//        lines_to = "";
//    }

        lines_to = document.getElementById('txttotalarea').value;
        var adsubcategory = "";
        var drpcolor = "B"
        var check_or = "";
        var adcat3 = "";
        var adcat4 = "";
        var adcat5 = "";
        
    var res = web_booking.getData(desc, document.getElementById('txtinsertion').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('hdncategory').value, adsubcategory, drpcolor, "WE0", document.getElementById('drpcurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname); //,callback_repeatingdate);
    var ds = res.value;
    var i = 0;
    var inew = 0;
    for (inew = 0; inew <= ds.Tables[0].Rows.length - 1; inew++) {
        var dCheck = checkValidEdition(ds.Tables[0].Rows[inew].Edition_Name);
        //var dCheck=true;
        if (dCheck == true) {
            var val_ue = "1";
            var pkg_id = "0";
            var strtext = "";
            pkg_id = document.getElementById('hiddenpckcode' + i).value;
            var pkgalias = document.getElementById('pkg_alias' + i).value;
            var pkgname = document.getElementById("edit" + i).value;
            pkgname = pkgname.replace("+", "^");
            if (browser != "Microsoft Internet Explorer") {
                var httpRequest = null; ;
                httpRequest = new XMLHttpRequest();
                if (httpRequest.overrideMimeType) {
                    httpRequest.overrideMimeType('text/xml');
                }

                httpRequest.onreadystatechange = function() { alertContents(httpRequest) };
                var adcat = document.getElementById('txtcategory').value;
                httpRequest.open("GET", "packagename.aspx?pkgalias=" + pkgalias + "&adcat=" + adcat + "&pkgid=" + pkg_id + "&compcode=" + document.getElementById('hiddencompcode').value + "&value=" + val_ue + "&dateday=" + ds.Tables[0].Rows[inew].Date + "&pkgname=" + ds.Tables[0].Rows[inew].Edition_Name, false);
                httpRequest.send('');
                //alert(httpRequest.readyState);
                if (httpRequest.readyState == 4) {
                    //alert(httpRequest.status);
                    if (httpRequest.status == 200) {
                        strtext = httpRequest.responseText;
                    }
                    else {
                        alert('There was a problem with the request.');
                    }
                }
            }
            else {
                validuse = "";
                var xml = new ActiveXObject("Microsoft.XMLHTTP");
                var adcat = document.getElementById('hdncategory').value;
                xml.Open("GET", "packagename.aspx?pkgalias=" + pkgalias + "&adcat=" + adcat + "&pkgid=" + pkg_id + "&compcode=" + document.getElementById('hiddencompcode').value + "&value=" + val_ue + "&dateday=" + ds.Tables[0].Rows[inew].Date + "&pkgname=" + ds.Tables[0].Rows[inew].Edition_Name, false);
                xml.Send();
                strtext = xml.responseText;
            }
            if (strtext == "NOT A VALID DATE") {
                alert("NOT A VALID DATE");
                document.getElementById("Text" + i).value = "";
                document.getElementById("Text" + i).focus();
                return false;
            }
            if (strtext != "" && strtext != "1" && strtext != "0" && strtext != null) {
                if (document.getElementById("Text" + i) != null) {
                    if (ds.Tables[0].Rows[inew].Date != strtext) {
                        alert(ds.Tables[0].Rows[inew].Date + " Date is no issue date of edition " + pkgname);
                        document.getElementById("Text" + i).value = "";
                        cali = cali - 1;
                    }
                    else
                        document.getElementById("Text" + i).value = strtext;
                }
                //28-sep-2011 (in case of uganda testing )
                //               for(y=i+1;y<ds.Tables[0].Rows.length;y++)
                //               {
                //                    if(ds.Tables[0].Rows[y].Edition_Name==ds.Tables[0].Rows[inew].Edition_Name)
                //                    {
                //                         var mm,dd,yy;
                //                        if (document.getElementById("hiddendateformat").value == "dd/mm/yyyy")
                //                        {
                //                             var dk1=ds.Tables[0].Rows[y].Date.split("/")
                //                             var dk1=ds.Tables[0].Rows[y].Date.split("/")
                //                             dt=new Date(dk1[1] + '/' + dk1[0] + '/' + dk1[2]);
                //                             dt.setDate(dt.getDate() + 1);
                //                             if(dt.getDate().toString().length==1)
                //                                dd="0" + dt.getDate().toString();
                //                             else
                //                                 dd=dt.getDate().toString();
                //                                 
                //                              if((dt.getMonth()+1).toString().length==1)
                //                                mm="0" + (dt.getMonth()+1).toString();
                //                             else
                //                                 mm=(dt.getMonth()+1).toString();
                //                                 
                //                                yy=dt.getFullYear().toString();
                //                             ds.Tables[0].Rows[y].Date=dd + '/' + mm + '/' + yy;
                //                        }
                //                        if (document.getElementById("hiddendateformat").value == "mm/dd/yyyy")
                //                        {
                //                              dt=new Date(ds.Tables[0].Rows[y].Date);
                //                              dt.setDate(dt.getDate() + 1);
                //                              if(dt.getDate().toString().length==1)
                //                                dd="0" + dt.getDate().toString();
                //                             else
                //                                 dd=dt.getDate().toString();
                //                                 
                //                              if((dt.getMonth()+1).toString().length==1)
                //                                mm="0" + (dt.getMonth()+1).toString();
                //                             else
                //                                 mm=(dt.getMonth()+1).toString();
                //                                 
                //                                yy=dt.getFullYear().toString();
                //                                
                //                              ds.Tables[0].Rows[y].Date=mm + '/' + dd + '/' + yy;
                //                        }
                //                        if (document.getElementById("hiddendateformat").value == "yyyy/mm/dd")
                //                        {
                //                             var dk1=ds.Tables[0].Rows[y].Date.split("/")
                //                              dt=new Date(dk1[2] + '/' + dk1[1] + '/' + dk1[0]   );
                //                              dt.setDate(dt.getDate() + 1);
                //                              if(dt.getDate().toString().length==1)
                //                                dd="0" + dt.getDate().toString();
                //                             else
                //                                 dd=dt.getDate().toString();
                //                                 
                //                              if((dt.getMonth()+1).toString().length==1)
                //                                mm="0" + (dt.getMonth()+1).toString();
                //                             else
                //                                 mm=(dt.getMonth()+1).toString();
                //                                 
                //                                yy=dt.getFullYear().toString();
                //                                
                //                              ds.Tables[0].Rows[y].Date=yy + '/' + mm + '/' + dd ;
                //                        }       
                //       
                //                    }
                //               }
                //               
            }
            else {
                if (document.getElementById("Text" + i) != null) {
                    if (ds.Tables[0].Rows[inew].Date == null)
                        ds.Tables[0].Rows[inew].Date = "";
                    document.getElementById("Text" + i).value = ds.Tables[0].Rows[inew].Date;
                }
            }
            i = parseInt(i, 10) + 1;
        }
    }
}



 




function drpuomlabel() {

    if (document.getElementById('drpuom').value == "CPC") {


        document.getElementById('lbltotarea').innerHTML = "No of Click";
        return false;

    }

    if (document.getElementById('drpuom').value == "CPD") {


        document.getElementById('lbltotarea').innerHTML = "No of Days";
        return false;

    }


    if (document.getElementById('drpuom').value == "CPM") {


        document.getElementById('lbltotarea').innerHTML = "No of Impression";
        return false;

    }

    if (document.getElementById('drpuom').value == "MO0") {


        document.getElementById('lbltotarea').innerHTML =  "Area";



    }



}

function uploadimageall() {
    if (document.getElementById('tblinsert').innerHTML == "") {
        alert("please fill insertion grid");
        return false;
    }
    var ins = document.getElementById('hdnrowcount').value
    var edit = "All";
    var ciobookid = document.getElementById('txtciobookid').value;
    var fileid = "bookdiv";
    var filename = "";
    var temp = "A";
   // var strReturn = window.showModalDialog('Defaultweb.aspx?&userid=' + document.getElementById('hiddenuserid').value, '', 'status:no;dialogWidth:1024px;dialogHeight:500px;dialogHide:true;center=yes;dialogleft:30px;dialogtop:80px;help:no;scroll:yes;titlebar=no;toolbar=no');
    
   window.open('Defaultweb.aspx?filename=bookdiv' + filename + "&ciobookid=" + ciobookid + "&temp=" + temp + '&ins=' + ins + '&edition=' + edit + '&fileid=' + fileid, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=144,left=210,width=450px,height=180px');
    return false;
}


function uploadimage(id, ins, edition, filename) {
    var ival = parseInt(ins) ;
    var ciobookid = document.getElementById('txtciobookid').value;
    // var filename = document.getElementById('fil' + ival).value;
    var insertid = ival;

    var temp = "B";
        window.open('Defaultweb.aspx?filename=bookdiv' + "&ciobookid=" + ciobookid + "&temp=" + temp + '&ins=' + ins + '&edition=' + edition + '&fileid=' + filename, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=144,left=210,width=450px,height=180px');
        return false;
 
 
}




function savewebmaterial() {
    var extra = "";
    var cio = document.getElementById('hdnciobookid').value;
    var ins = document.getElementById('hdnins').value;
    var edit = document.getElementById('hdnedit123').value;
    var fileid = document.getElementById('hdnfileid').value;
    if (fileid == "bookdiv") {
        var filname = cio + "-" + edit;
    }
    else {
        var filname = cio + "-"  + edit;
    }
    
      getfilename(filname,fileid);

    
    var aa = document.getElementById('txt').value;


    var imagefile1 = aa.split(".");
    var tot1 = imagefile1[0];
    var imagefile = imagefile1[1];


    if (imagefile == "jpg")
        {
            var tot2 = tot1.replace(tot1, filname + ".jpg");
        }


        var re = Defaultweb.Button1_Click(cio, imagefile, aa, "", filname);



        if (re.value == "True") {
            alert('Web Material Save Successfully'); exitdefault3();
          
        } else {
            alert('Data Not Saved')

        }

   
    return false;
}


function exitdefault3() {
    window.close();
    return false;


}



function getfilename(filename, fileid) {
    if (fileid == "bookdiv") {
        var dd = document.getElementById('hdnins').value;
        var i ;
for(i=0;i<dd;i++)
    window.opener.document.getElementById('fil'+i).innerText = filename;

}
else
{
    var ff = fileid;
var aa=ff.charAt(ff.length-1)
window.opener.document.getElementById('fil' + aa).innerText = filename;
}
return false;

}


function geographical123(idnum) {

    var ciobookid = document.getElementById('txtciobookid').value;


    var editiongeo = temped;

    var adcategory = document.getElementById('hdncategory').value;
    var uom1 = document.getElementById('drpuom').value;
    var txtdummydate1 = document.getElementById('txtdummydate').value;
    var drppageprem = document.getElementById('drppageprem').value;
    var chmandat;
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lblpage').textContent;
    }
    else {
        chmandat = document.getElementById('lblpage').innerText;
    }
    if (chmandat.indexOf("*") >= 0 && document.getElementById('drppageprem').value != "CA0") {
        alert("Please Select Page Premium");
        changediv1();
        document.getElementById('drppageprem').disabled = false;
        document.getElementById('drppageprem').focus();
        return false;
    }
    

   // var strReturn = window.showModalDialog('geoweb.aspx?filename=bookdiv' + "&ciobookid=" + ciobookid + "&adcategory=" + adcategory + "&uom1=" + uom1 + "&drppageprem=" + drppageprem + "&txtdummydate1=" + txtdummydate1 + "&editiongeo=" + editiongeo + "&noofinsert=" + idnum, '', 'status:no;dialogWidth:600px;dialogHeight:700px;dialogHide:true;center=yes;dialogleft:30px;dialogtop:80px;help:no;scroll:yes;titlebar=no;toolbar=no');

    window.open('geoweb.aspx?filename=bookdiv' + "&ciobookid=" + ciobookid + "&adcategory=" + adcategory + "&uom1=" + uom1 + "&drppageprem=" + drppageprem + "&txtdummydate1=" + txtdummydate1 + "&editiongeo=" + editiongeo + "&noofinsert=" + idnum, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=144,left=210,width=600px,height=700px');

    return false;
}



function executegeo(insert, edition) {

   
    if (f1 == 1) {


        var ciobookid = document.getElementById('txtciobookid').value;

        var flag123 = "M";
        var adcategory = document.getElementById('hdncategory').value;
        var uom1 = document.getElementById('drpuom').value;
        var txtdummydate1 = document.getElementById('txtdummydate').value;
        var drppageprem = document.getElementById('drppageprem').value;

        var strReturn = window.showModalDialog('geoweb1.aspx?filename=bookdiv' + "&ciobookid=" + ciobookid + "&adcategory=" + adcategory + "&uom1=" + uom1 + "&drppageprem=" + drppageprem + "&txtdummydate1=" + txtdummydate1 + "&editiongeo=" + edition + "&flag=" + flag123 + "&noofinsert=" + insert, '', 'status:no;dialogWidth:600px;dialogHeight:700px;dialogHide:true;center=yes;dialogleft:30px;dialogtop:80px;help:no;scroll:yes;titlebar=no;toolbar=no');
      //  window.open('geoweb1.aspx?filename=bookdiv' + "&ciobookid=" + ciobookid  +"&adcategory=" + adcategory + "&uom1=" + uom1 + "&drppageprem=" + drppageprem + "&txtdummydate1=" + txtdummydate1 + "&editiongeo=" + edition + "&flag=" + flag123 + "&noofinsert=" + insert, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=144,left=210,width=600px,height=700px');

    }
    else if (f1 == 0) {

    var ciobookid = document.getElementById('txtciobookid').value;

    var flag1234 = "E";

    var strReturn = window.showModalDialog('geoweb1.aspx?filename=bookdiv' + "&ciobookid=" + ciobookid + "&editiongeo=" + edition + "&flag=" + flag1234 + "&noofinsert=" + insert, '', 'status:no;dialogWidth:600px;dialogHeight:700px;dialogHide:true;center=yes;dialogleft:30px;dialogtop:80px;help:no;scroll:yes;titlebar=no;toolbar=no');
//window.open('geoweb1.aspx?filename=bookdiv' + "&ciobookid=" + ciobookid + "&editiongeo=" + edition + "&flag=" + flag1234 + "&noofinsert=" + insert, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=144,left=210,width=600px,height=700px');
    
    
    }
    else {
    
    
    }


}

var f1 = 0;
function modifyClick() {
    f1 = 1;
//    chkbtnStatus = "modify";
    document.getElementById('hiddensavemod').value = "01";
    if (document.getElementById('btnpaginatedvol') != null)
        document.getElementById('btnpaginatedvol').disabled = false;
    //document.getElementById('btnRefresh').disabled = false;
    //document.getElementById('btnPaginate').disabled = false;
    document.getElementById('chkholdbill').disabled = false;
    // document.getElementById('btnPreference').disabled = false;
    //document.getElementById('btnSpaceCheck').disabled = false;
    //document.getElementById('btnsavepaginate').disabled = false;
    document.getElementById('LinkButton1').disabled = false;
    document.getElementById('LinkButton2').disabled = false;
    document.getElementById('LinkButton3').disabled = false;
    document.getElementById('LinkButton4').disabled = false;
    document.getElementById('LinkButton5').disabled = false;
    //document.getElementById('LinkButton6').disabled = false;
    //document.getElementById('LinkButton7').disabled = false;
    if (document.getElementById('txtaddagencycommrate') != null)
        document.getElementById('txtaddagencycommrate').disabled = false;
    document.getElementById('hiddenmodifyinsert').value = document.getElementById('txtinsertion').value;
    //document.getElementById('drptranslation').disabled = false;
    /////if in the insertion grid record insertion status is publish or hold or cancel than the main form except the 
    ////insert grid record cannot modify
    res = null;
    res = web_booking.showgridforexe(document.getElementById('txtciobookid').value, document.getElementById('hiddencompcode').value);
    var dex = res.value;
    if (dex == null) {
        alert(res.error.description);
        return false;
    }

    for (var j = 0; j <= dex.Tables[0].Rows.length - 1; j++) {
        if (dex.Tables[0].Rows[j].Insert_status == "publish") {
            boxstatus = "publish";
            if (document.getElementById('hiddenrateauditflag').value != "rateaudit" || document.getElementById('hiddenrateauditpreferrence').value != "Y")
                insertstatus = "2";
            else
                insertstatus = "0";
            break;
        }
        else if (dex.Tables[0].Rows[j].Insert_status == "billed") {
            insertstatus = "1";
            boxstatus = "billed";
            document.getElementById('txtcaption').disabled = false;


            document.getElementById('txtprintremark').disabled = false;


            document.getElementById('drpadsubcategory').disabled = false;
            break;
        }

        //  document.getElementById('hiddensavemod').value = "1";



        else {
            insertstatus = "0";
        }
    }
    if (hidcopy == "copy") {
        insertstatus = "0";
        previnsertion = document.getElementById("txtinsertion").value;
        document.getElementById('btncopy').disabled = false;
        document.getElementById('btndel').disabled = false;
    }
//    if (document.getElementById("Hiddenbillclear").value == "Hold") {
//        insertstatus = "2";

//    }

    if (document.getElementById('drpbooktype').value == "2" || document.getElementById('drpbooktype').value == "6")
        document.getElementById('btnfmg').disabled = false;
    else
        document.getElementById('btnfmg').disabled = true;
    document.getElementById('Button1').disabled = false;

    //document.getElementById('txtMobile').value="";
   // document.getElementById('txtMobile').disabled = false;
    document.getElementById('drpretainer').disabled = false;
    document.getElementById('txtrevisedate').disabled = false;
    if (insertstatus == "2") {
       // document.getElementById('btnsharing').disabled = true;
        document.getElementById('chkcontract').disabled = true;

        document.getElementById('btndeal').disabled = true;
        document.getElementById('btnshgrid').disabled = true;

        document.getElementById('drpbooktype').disabled = true;
        //document.getElementById('txtbartertype').disabled = true;
        document.getElementById('txtciobookid').disabled = true;

        document.getElementById('txtrono').disabled = false;
        document.getElementById('txtrodate').disabled = false;
        //document.getElementById('txtcaption').disabled = false;
        document.getElementById('drpbillstatus').disabled = false;
        document.getElementById('drprostatus').disabled = false;
        document.getElementById('txtagency').disabled = false;
        document.getElementById('txtclient').disabled = false;
        document.getElementById('txtagencypaymode').disabled = true;

        document.getElementById('txtclientadd').disabled = false;
        document.getElementById('drpagscode').disabled = false;
        document.getElementById('txtdockitno1').disabled = true;
        document.getElementById('txtexecname').disabled = false;
        document.getElementById('txtexeczone').disabled = false;
        //document.getElementById('txtproduct').disabled = false;
        //document.getElementById('drpbrand').disabled = false;
        document.getElementById('txtkeyno').disabled = false;
        document.getElementById('txtbillremark').disabled = false;
        document.getElementById('txtprintremark').disabled = false;
        //document.getElementById('txtpageno').disabled = false;
        //document.getElementById('drppagetype').disabled = false;
        //document.getElementById('drpvarient').disabled = false;
        document.getElementById('drppackage').disabled = true;
        document.getElementById('txtinsertion').disabled = true;
        document.getElementById('txtdummydate').disabled = true;
        document.getElementById('txtrepeatingdate').disabled = true;
        document.getElementById('drpbooktype').disabled = true;
        //document.getElementById('txtbartertype').disabled = true;
        //document.getElementById('txtcategory').disabled = true;
        //document.getElementById('drpadsubcategory').disabled = false;
        //document.getElementById('drpadcat3').disabled = true;
        //document.getElementById('drpadcat4').disabled = true;
        //document.getElementById('drpadcat5').disabled = true;
        //document.getElementById('drpcolor').disabled = true;
        document.getElementById('drpuom').disabled = true;
        document.getElementById('drpposition').disabled = true;
        //document.getElementById('drpdiscountprem').disabled = true;
        //document.getElementById('txtpageno').disabled = false;
        //document.getElementById('drpadstype').disabled = true;
        //document.getElementById('drppagetype').disabled = false;
        document.getElementById('txtratecode').disabled = true;
        document.getElementById('drpscheme').disabled = true;
        //  drpschemepck.Enabled = false;
        document.getElementById('drpcurrency').disabled = true;
        document.getElementById('drprptcurrency').disabled = true;
        document.getElementById('txtagreedrate').disabled = true;
        //document.getElementById('drptranslation').disabled = true;
        document.getElementById('txtagreedamt').disabled = true;
        document.getElementById('txtspedisc').disabled = true;
        document.getElementById('txtspacedisc').disabled = true;
        document.getElementById('txtspediscper').disabled = true;
        document.getElementById('txtspadiscper').disabled = true;

        document.getElementById('txtextracharges').disabled = true;
        if (document.getElementById('hidbackdatereceipt').value == "y")
            document.getElementById('txtdatetime').disabled = false;
        else
            document.getElementById('txtdatetime').disabled = true;
        document.getElementById('txtrepeatingdate').disabled = true;

        document.getElementById('drppageprem').disabled = true;

        //document.getElementById('txtpremper').disabled = true;
        document.getElementById('drpbillcycle').disabled = false;
        document.getElementById('drprevenue').disabled = true;
        //drpbilltype.Enabled = true;
        document.getElementById('drpbillstatus').disabled = true;
        //drpbillcurrency.Enabled = true;
        document.getElementById('drppaymenttype').disabled = true;
        //document.getElementById('drpcashrecieved').disabled = true;
        document.getElementById('txtinvoice').disabled = true;
        document.getElementById('txtvts').disabled = true;
        document.getElementById('txtcirrate').disabled = true;
        document.getElementById('txtciragency').disabled = true;
        document.getElementById('txtciredition').disabled = true;
        document.getElementById('txtbillwidth').disabled = true;
        document.getElementById('txtbillheight').disabled = true;
        document.getElementById('drpbillto').disabled = true;
        document.getElementById('txttradedisc').disabled = false;

        //            if(document.getElementById('txtaddagencycommrate')!=null)
        //          document.getElementById('txtaddagencycommrate').disabled = false;
        document.getElementById('txtagencyoutstand').disabled = true;
        document.getElementById('txtcardrate').disabled = true;
        document.getElementById('txtcardamt').disabled = true;
        document.getElementById('txtdiscount').disabled = true;
        document.getElementById('txtdiscpre').disabled = true;
        //document.getElementById('txtadsize2').disabled = true;
        //document.getElementById('txtadsize1').disabled = true;
        //document.getElementById('chkDealerPanel').disabled = true;
        document.getElementById('txttotalarea').disabled = true;
        document.getElementById('txtbilladdress').disabled = true;

        document.getElementById('drpboxcode').disabled = true;
        //txtboxno.Enabled = true;
        document.getElementById('txtboxaddress').disabled = true;
        //document.getElementById('txtcamp').disabled = true;
        document.getElementById('txtbillamt').disabled = true;

        document.getElementById('txtgrossamt').disabled = true;
        document.getElementById('drpboxcode').disabled = true;
        document.getElementById('chkage').disabled = true;
        document.getElementById('chkclie').disabled = true;
        document.getElementById('chktfn').disabled = true;
        document.getElementById('chkadon').disabled = true;
        document.getElementById('btnrefid').disabled = true;
        document.getElementById('txtreference').disabled = true;
        document.getElementById('txtboxaddress').disabled = true;
        document.getElementById('txtinsertion').disabled = true;
        //document.getElementById('txtcolum').disabled = true;
        document.getElementById('drpmatsta').disabled = true;
        ///////////////////////
        document.getElementById('txtcontractname').disabled = true;
        document.getElementById('txtcontracttype').disabled = true;
        //document.getElementById('txtcardname').disabled = true;
        //document.getElementById('drptype').disabled = true;
        //document.getElementById('drpmonth').disabled = false;
        //document.getElementById('drpyear').disabled = true;
        //document.getElementById('txtcardno').disabled = true;
        document.getElementById('btnshgrid').disabled = true;
        document.getElementById('btndeal').disabled = true;
        //chequeinfo
        //document.getElementById('ttextchqno').disabled = true;
        //document.getElementById('drpourbank').disabled = true;
        //document.getElementById('ttextchqdate').disabled = true;
       // document.getElementById('ttextchqamt').disabled = true;
        //document.getElementById('ttextbankname').disabled = true;
        document.getElementById('txtRetainercomm').disabled = false;
        document.getElementById('txttranslationdisc').disabled = false;
        document.getElementById('txtpospremdisc').disabled = false;
        //            if(document.getElementById('txtaddagencycommrateamt')!=null)
        //            document.getElementById('txtaddagencycommrateamt').disabled=false;
        if (document.getElementById('hiddeneiitagcomm').value == "N") {
            document.getElementById('txttradedisc').disabled = true;
            document.getElementById('chktrade').disabled = true;
            if (document.getElementById('txtaddagencycommrate') != null) {
                document.getElementById('txtaddagencycommrate').disabled = true;

                document.getElementById('txtaddagencycommrateamt').disabled = true;

            }
        }
        else if (document.getElementById('hiddeneiitagcomm').value == "T") {
            document.getElementById('txttradedisc').disabled = false;
            document.getElementById('chktrade').disabled = false;
            if (document.getElementById('txtaddagencycommrate') != null) {
                document.getElementById('txtaddagencycommrate').disabled = true;

                document.getElementById('txtaddagencycommrateamt').disabled = true;

            }
        }
        else if (document.getElementById('hiddeneiitagcomm').value == "A") {
            document.getElementById('txttradedisc').disabled = true;
            document.getElementById('chktrade').disabled = true;
            if (document.getElementById('txtaddagencycommrate') != null) {
                document.getElementById('txtaddagencycommrate').disabled = false;

                document.getElementById('txtaddagencycommrateamt').disabled = false;

            }
        }
        else {
            document.getElementById('txttradedisc').disabled = false;
            document.getElementById('chktrade').disabled = false;
            if (document.getElementById('txtaddagencycommrate') != null) {
                document.getElementById('txtaddagencycommrate').disabled = false;

                document.getElementById('txtaddagencycommrateamt').disabled = false;

            }
        }
        if (document.getElementById('hiddencancelcharge').value == "Y") {
            document.getElementById('chkcanclecharges').disabled = false;

        }
        else {
            document.getElementById('chkcanclecharges').disabled = true;

        }
    }
    else if (insertstatus == "1") {

        document.getElementById('txtcaption').disabled = false;


        document.getElementById('txtprintremark').disabled = false;


        document.getElementById('drpadsubcategory').disabled = false;

        document.getElementById('txttranslationdisc').disabled = true;
        document.getElementById('txtpospremdisc').disabled = true;
        document.getElementById('btnsharing').disabled = true;
        document.getElementById('chkcontract').disabled = true;
        document.getElementById('drpbooktype').disabled = true;
        document.getElementById('txtbartertype').disabled = true;
        document.getElementById('txtciobookid').disabled = true;

        document.getElementById('txtrono').disabled = true;
        document.getElementById('txtrodate').disabled = true;

        document.getElementById('drpbillstatus').disabled = true;
        document.getElementById('drprostatus').disabled = true;
        document.getElementById('txtagency').disabled = true;
        document.getElementById('txtclient').disabled = true;
        // txtagencyaddress.Enabled = true;
        document.getElementById('txtclientadd').disabled = false;
        document.getElementById('drpagscode').disabled = true;
        document.getElementById('txtdockitno1').disabled = true;
        document.getElementById('txtexecname').disabled = true;
        document.getElementById('drpretainer').disabled = true;
        document.getElementById('txtexeczone').disabled = true;
        document.getElementById('txtproduct').disabled = true;
        document.getElementById('drpbrand').disabled = true;
        document.getElementById('txtkeyno').disabled = true;
        document.getElementById('txtbillremark').disabled = true;

        document.getElementById('drppackage').disabled = true;
        document.getElementById('txtinsertion').disabled = true;
        document.getElementById('txtdummydate').disabled = true;
        document.getElementById('txtrepeatingdate').disabled = true;
        document.getElementById('drpbooktype').disabled = true;
        document.getElementById('txtbartertype').disabled = true;
        document.getElementById('txtcategory').disabled = true;

        document.getElementById('drpadcat3').disabled = true;
        document.getElementById('drpadcat4').disabled = true;
        document.getElementById('drpadcat5').disabled = true;

        document.getElementById('drpcolor').disabled = true;
        document.getElementById('drpuom').disabled = true;
        document.getElementById('drpposition').disabled = true;
        document.getElementById('drpdiscountprem').disabled = true;
        document.getElementById('txtpageno').disabled = false;
        document.getElementById('drpadstype').disabled = true;
        document.getElementById('drppagetype').disabled = false;

        document.getElementById('txtratecode').disabled = true;
        document.getElementById('drpscheme').disabled = true;
        //  drpschemepck.Enabled = false;
        document.getElementById('drpcurrency').disabled = true;
        document.getElementById('drprptcurrency').disabled = true;
        document.getElementById('txtagreedrate').disabled = true;
        document.getElementById('drptranslation').disabled = true;
        document.getElementById('txtagreedamt').disabled = true;
        document.getElementById('txtspedisc').disabled = true;
        document.getElementById('txtspacedisc').disabled = true;
        document.getElementById('txtspediscper').disabled = true;
        document.getElementById('txtspadiscper').disabled = true;
        document.getElementById('txtextracharges').disabled = true;
        if (document.getElementById('hidbackdatereceipt').value == "y")
            document.getElementById('txtdatetime').disabled = false;
        else
            document.getElementById('txtdatetime').disabled = true;
        document.getElementById('txtrepeatingdate').disabled = true;

        document.getElementById('drpbillcycle').disabled = true;
        document.getElementById('drprevenue').disabled = true;
        //drpbilltype.Enabled = true;
        document.getElementById('drpbillstatus').disabled = true;
        //drpbillcurrency.Enabled = true;
        document.getElementById('drppaymenttype').disabled = true;
        document.getElementById('drpcashrecieved').disabled = true;
        document.getElementById('txtinvoice').disabled = true;
        document.getElementById('txtvts').disabled = true;
        document.getElementById('txtcirrate').disabled = true;
        document.getElementById('txtciragency').disabled = true;
        document.getElementById('txtciredition').disabled = true;
        document.getElementById('txtbillwidth').disabled = true;
        document.getElementById('txtbillheight').disabled = true;
        document.getElementById('drpbillto').disabled = true;
        document.getElementById('txttradedisc').disabled = true;
        document.getElementById('chktrade').disabled = true;
        if (document.getElementById('txtaddagencycommrate') != null)
            document.getElementById('txtaddagencycommrate').disabled = true;
        document.getElementById('txtagencyoutstand').disabled = true;
        document.getElementById('txtcardrate').disabled = true;
        document.getElementById('txtcardamt').disabled = true;
        document.getElementById('txtdiscount').disabled = true;
        document.getElementById('txtdiscpre').disabled = true;
        document.getElementById('txtadsize2').disabled = true;
        document.getElementById('txtadsize1').disabled = true;
        document.getElementById('chkDealerPanel').disabled = true;
        document.getElementById('txttotalarea').disabled = true;
        document.getElementById('txtbilladdress').disabled = true;

        document.getElementById('drpboxcode').disabled = true;

        document.getElementById('txtbillamt').disabled = true;

        document.getElementById('txtgrossamt').disabled = true;
        document.getElementById('txtcamp').disabled = true;

        document.getElementById('drppageprem').disabled = true;
        document.getElementById('txtpremper').disabled = true;
        document.getElementById('chkage').disabled = true;
        document.getElementById('chkclie').disabled = true;
        document.getElementById('chktfn').disabled = true;
        document.getElementById('chkadon').disabled = true;
        document.getElementById('btnrefid').disabled = true;
        document.getElementById('txtreference').disabled = true;
        document.getElementById('txtboxaddress').disabled = true;
        document.getElementById('txtinsertion').disabled = true;

        document.getElementById('txtcolum').disabled = true;

        document.getElementById('txtboxno').disabled = true;
        document.getElementById('drpmatsta').disabled = true;

        ///////////////////////
        document.getElementById('txtcontractname').disabled = true;
        document.getElementById('txtcontracttype').disabled = true;
        document.getElementById('txtcardname').disabled = true;
        document.getElementById('drptype').disabled = true;
        document.getElementById('drpmonth').disabled = false;
        document.getElementById('drpyear').disabled = true;
        document.getElementById('txtcardno').disabled = true;
        document.getElementById('btnshgrid').disabled = true;
        document.getElementById('btndeal').disabled = true;
        //chequeinfo
        document.getElementById('ttextchqno').disabled = true;
        document.getElementById('drpourbank').disabled = true;
        document.getElementById('ttextchqdate').disabled = true;
        document.getElementById('ttextchqamt').disabled = true;
        document.getElementById('ttextbankname').disabled = true;

    }
    else if (insertstatus == "0") {
        document.getElementById('txttranslationdisc').disabled = false;
        document.getElementById('txtpospremdisc').disabled = false;
        //document.getElementById('btnsharing').disabled = false;
        document.getElementById('chkcontract').disabled = false;
        document.getElementById('btndeal').disabled = true;
        document.getElementById('btnshgrid').disabled = false;
        //btnupload.Enabled = true;
        document.getElementById('drpbooktype').disabled = false;
        if (document.getElementById('drpbooktype').value == "1")
            document.getElementById('txtbartertype').disabled = false;
        document.getElementById('txtciobookid').disabled = true;
        // txtappby.Enabled = true;
        //txtaudit.Enabled = true;
        document.getElementById('txtRetainercomm').disabled = false;
        //            if(document.getElementById('txtaddagencycommrateamt')!=null)
        //            document.getElementById('txtaddagencycommrateamt').disabled = false;
        document.getElementById('txtrono').disabled = false;
        document.getElementById('txtrodate').disabled = false;
        //document.getElementById('txtcamp').disabled = true;
        //document.getElementById('txtcaption').disabled = false;
        document.getElementById('drpbillstatus').disabled = false;
        document.getElementById('drprostatus').disabled = false;
        document.getElementById('txtagency').disabled = false;
        document.getElementById('txtclient').disabled = false;
        document.getElementById('txtagencypaymode').disabled = true;
        // txtagencyaddress.Enabled = true;
        document.getElementById('txtclientadd').disabled = false;
        document.getElementById('drpagscode').disabled = false;
        document.getElementById('txtdockitno1').disabled = true;
        document.getElementById('txtexecname').disabled = false;
        document.getElementById('txtexeczone').disabled = false;
        //document.getElementById('txtproduct').disabled = false;
        //document.getElementById('drpbrand').disabled = false;
        document.getElementById('txtkeyno').disabled = false;
        document.getElementById('txtbillremark').disabled = false;
        document.getElementById('txtprintremark').disabled = false;
        document.getElementById('drppackage').disabled = false;
        document.getElementById('txtinsertion').disabled = false;
        document.getElementById('txtdummydate').disabled = true;
        document.getElementById('txtrepeatingdate').disabled = false;
        document.getElementById('drpbooktype').disabled = false;
        if (document.getElementById('drpbooktype').value == '1')
            document.getElementById('txtbartertype').disabled = false;
        //document.getElementById('txtcategory').disabled = false;
        //document.getElementById('drpadsubcategory').disabled = false;
        //document.getElementById('drpadcat3').disabled = false;
        //document.getElementById('drpadcat4').disabled = false;
        //document.getElementById('drpadcat5').disabled = false;

        //document.getElementById('drpcolor').disabled = false;
        document.getElementById('drpuom').disabled = false;
        document.getElementById('drpposition').disabled = false;
        //document.getElementById('drpdiscountprem').disabled = false;
        //document.getElementById('txtpageno').disabled = false;
        //document.getElementById('drpadstype').disabled = true;
        //document.getElementById('drppagetype').disabled = false;

        document.getElementById('txtratecode').disabled = false;
        document.getElementById('drpscheme').disabled = true;

        document.getElementById('drpcurrency').disabled = false;
        document.getElementById('drprptcurrency').disabled = false;
        document.getElementById('txtagreedrate').disabled = false;
        document.getElementById('txtagreedamt').disabled = false;
////        //if (document.getElementById('hidspldisedit').value == "Y") {
//            document.getElementById('txtspediscper').disabled = false;
//            document.getElementById('txtspedisc').disabled = false;

////        }
//        else {
//            document.getElementById('txtspediscper').disabled = true;
//            document.getElementById('txtspedisc').disabled = true;
//        }

        document.getElementById('txtspacedisc').disabled = false;

        document.getElementById('txtspadiscper').disabled = false;
        document.getElementById('txtextracharges').disabled = false;
        if (document.getElementById('hidbackdatereceipt').value == "y")
            document.getElementById('txtdatetime').disabled = false;
        else
            document.getElementById('txtdatetime').disabled = true;

        document.getElementById('txtrepeatingdate').disabled = false;

        document.getElementById('drpbillcycle').disabled = false;
        document.getElementById('drprevenue').disabled = false;
        //drpbilltype.Enabled = true;
        document.getElementById('drpbillstatus').disabled = false;
        //drpbillcurrency.Enabled = true;
        if (document.getElementById('drprostatus').value == "2") {
            document.getElementById('drppaymenttype').disabled = false;
        }
        else {
            document.getElementById('drppaymenttype').disabled = true;
        }
        //document.getElementById('drpcashrecieved').disabled = false;
        //document.getElementById('txtcashdiscount').disabled = false;

        document.getElementById('txtinvoice').disabled = false;
        document.getElementById('txtvts').disabled = false;
        document.getElementById('txtcirrate').disabled = false;
        document.getElementById('txtciragency').disabled = false;
        document.getElementById('txtciredition').disabled = true;
        document.getElementById('txtbillwidth').disabled = false;
        document.getElementById('txtbillheight').disabled = false;
        document.getElementById('drpbillto').disabled = false;
        document.getElementById('txttradedisc').disabled = false;

        //            if(document.getElementById('txtaddagencycommrate')!=null)
        //          document.getElementById('txtaddagencycommrate').disabled = false;
        document.getElementById('txtagencyoutstand').disabled = true;
        document.getElementById('txtcardrate').disabled = true;
        document.getElementById('txtcardamt').disabled = true;
        document.getElementById('txtdiscount').disabled = true;
        document.getElementById('txtdiscpre').disabled = true;
        //document.getElementById('txtadsize2').disabled = false;
        //document.getElementById('txtadsize1').disabled = false;
       // document.getElementById('chkDealerPanel').//disabled = false;
//        if (document.getElementById('chkDealerPanel').checked == true) {
//            document.getElementById('txtadsize1dealer').disabled = false;
//            document.getElementById('txtadsize2dealer').disabled = false;
//            document.getElementById('drpdealertype').disabled = false;
//        }
//        else {
//            document.getElementById('txtadsize1dealer').disabled = true;
//            document.getElementById('txtadsize2dealer').disabled = true;
//            document.getElementById('drpdealertype').disabled = true;
//        }
        document.getElementById('txttotalarea').disabled = true;
        document.getElementById('txtbilladdress').disabled = false;

        document.getElementById('drpboxcode').disabled = false;
        document.getElementById('txtbillamt').disabled = true;

        document.getElementById('txtgrossamt').disabled = true;
        document.getElementById('drpboxcode').disabled = false;
        document.getElementById('chkage').disabled = false;
        document.getElementById('chkclie').disabled = false;
        document.getElementById('chktfn').disabled = false;
        document.getElementById('chkadon').disabled = true;
        document.getElementById('btnrefid').disabled = true;
        document.getElementById('txtreference').disabled = true;
        document.getElementById('txtboxaddress').disabled = false;
        //document.getElementById('txtinsertion').disabled = true;
        //document.getElementById('txtcolum').disabled = false;
        document.getElementById('drpmatsta').disabled = false;

        ///////////////////////
        document.getElementById('txtcontractname').disabled = false;
        document.getElementById('txtcontracttype').disabled = false;
        //document.getElementById('txtcardname').disabled = false;
        //document.getElementById('drptype').disabled = false;
        //document.getElementById('drpmonth').disabled = false;
        //document.getElementById('drpyear').disabled = false;
        //document.getElementById('txtcardno').disabled = false;
        if (hidcopy == "copy") {
            document.getElementById('btncopy').disabled = false;
        }
        else {
            document.getElementById('btncopy').disabled = true;
        }
        // document.getElementById('btndel').disabled = false;
        document.getElementById('btnshgrid').disabled = false;
        document.getElementById('btndeal').disabled = true;

        //document.getElementById('ttextchqno').disabled = false;
        //document.getElementById('drpourbank').disabled = false;
        //document.getElementById('ttextchqdate').disabled = false;
        //document.getElementById('ttextchqamt').disabled = false;
        //document.getElementById('ttextbankname').disabled = false;
        document.getElementById('drppageprem').disabled = false;
        if (document.getElementById('hidpremedit').value == 'Y')
            //document.getElementById('txtpremper').disabled = false;
       // else
            //document.getElementById('txtpremper').disabled = true;
        document.getElementById('txtRetainercomm').disabled = false;
        if (document.getElementById('txtaddagencycommrateamt') != null)
            document.getElementById('txtaddagencycommrateamt').disabled = false;
        if (document.getElementById('hiddeneiitagcomm').value == "N") {
            document.getElementById('txttradedisc').disabled = true;
            document.getElementById('chktrade').disabled = true;
            if (document.getElementById('txtaddagencycommrate') != null) {
                document.getElementById('txtaddagencycommrate').disabled = true;

                document.getElementById('txtaddagencycommrateamt').disabled = true;

            }
        }
        else if (document.getElementById('hiddeneiitagcomm').value == "T") {
            document.getElementById('txttradedisc').disabled = false;
            document.getElementById('chktrade').disabled = false;
            if (document.getElementById('txtaddagencycommrate') != null) {
                document.getElementById('txtaddagencycommrate').disabled = true;

                document.getElementById('txtaddagencycommrateamt').disabled = true;

            }
        }
        else if (document.getElementById('hiddeneiitagcomm').value == "A") {
            document.getElementById('txttradedisc').disabled = true;
            document.getElementById('chktrade').disabled = true;
            if (document.getElementById('txtaddagencycommrate') != null) {
                document.getElementById('txtaddagencycommrate').disabled = false;

                document.getElementById('txtaddagencycommrateamt').disabled = false;

            }
        }
        else {
            document.getElementById('txttradedisc').disabled = false;
            document.getElementById('chktrade').disabled = false;
            if (document.getElementById('txtaddagencycommrate') != null) {
                document.getElementById('txtaddagencycommrate').disabled = false;

                document.getElementById('txtaddagencycommrateamt').disabled = false;

            }
        }
        if (document.getElementById('hiddencancelcharge').value == "Y") {
            document.getElementById('chkcanclecharges').disabled = false;

        }
        else {
            document.getElementById('chkcanclecharges').disabled = true;

        }
    }
    if (document.getElementById('drppaymenttype').value == "CA0") {
        document.getElementById('txtagency').disabled = true;
        document.getElementById('txtclient').disabled = true;
    }
//    if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtcolum').value != "") {
//        document.getElementById('txtadsize2').disabled = true;
//        document.getElementById('txtadsize1').style.backgroundColor = "#FFFFFF";
//        document.getElementById('txtadsize2').style.backgroundColor = "#FFFFFF";
//        document.getElementById('txtcolum').style.backgroundColor = "#FFFFFF";

//    }
//    else if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtadsize2').value != "") {
//        document.getElementById('txtcolum').disabled = true;
//        document.getElementById('txtadsize1').style.backgroundColor = "#FFFFFF";
//        document.getElementById('txtadsize2').style.backgroundColor = "#FFFFFF";
//        document.getElementById('txtcolum').style.backgroundColor = "#FFFFFF";
//    }


    // document.getElementById('drpretainer').disabled = false;
    //        if(document.getElementById('txtaddagencycommrate')!=null)
    //            document.getElementById('txtaddagencycommrate').disabled = false;       
    var listpck = document.getElementById('hiddenpackage').value;
    // enableGridItems();
    // showgridexecute1(hidcopy);
    showgridexecute();
    if (hidcopy == "copy") {
        document.getElementById('hiddensavemod').value = "0";
        document.getElementById('txtdummydate').disabled = false;
        //autogenerated("0");
        autogeneratedtempid();
        if ((document.getElementById('txtagencypaymode').value == "CR1" && document.getElementById('creditreceipt_allow').value == "Y")) // for credit 
            autogenerated("3");
    }
    //  showgridexecute1(hidcopy);
    chkstatus("1");
    document.getElementById('btnSave').disabled = false;
    document.getElementById('btnQuery').disabled = true;
    //document.getElementById('btnsavepaginate').disabled = true;
    document.getElementById('btnshgrid').disabled = false;
    var clientnam = document.getElementById('txtclient').value;

    if (document.getElementById('hdnregclient').value == "Y") {
        if (clientnam.split('(').length <= 1) {
            document.getElementById('regclient').style.display = "";
            document.getElementById('regclient').disabled = false;
        }
    }
    // document.getElementById('btnshgrid').disabled = false;
    setButtonImages();

    return false;
}




function updatecashreceived() {
    var ciobookid = document.getElementById('txtciobookid').value;
    var cashrcvd = document.getElementById('drpcashrecieved').value;
    if (parseFloat(document.getElementById('drpcashrecieved').value) > parseFloat(document.getElementById('hiddencashrecieved').value))
        var diff = (parseFloat(document.getElementById('drpcashrecieved').value) - parseFloat(document.getElementById('hiddencashrecieved').value));
    else
        var diff = (parseFloat(document.getElementById('hiddencashrecieved').value) - parseFloat(document.getElementById('drpcashrecieved').value));
    if (parseFloat(diff) > 0) {
        autogenerated("3")
        web_booking.insertcashreceived(ciobookid, document.getElementById('txtreceipt').value, diff);
    }

}





function getmodifygrid() {
    var len = "bookdiv";
    var insertno;
    var premid;
    var premper;
    var colid;
    var heightid;
    var widthid;
    var size;
    var late;
    //var uomid;
    //var adtypid;
    var cardid;
    var editid;
    var solorate;
    var premper1;
    var prem1id;
    var namecode;
    var inserts;
    var pagepost;
    var preall;
    var adcat;
    var adsubcat;
    var matsta;
    var filename;
    var discrate;
    var insertsta;
    var billstat;
    var id;
    var repeat;
    var i = 0;
    var paid;
    var agrred;
    var solo;
    var gross;
    var showid;
    var pageno_inserts;
    var remark_inserts;
    var caption_inserts;
    var clicatamtval;
    var flatfreqamtval;
    var catamtval;
    var agnamnt;
    var adlgn;
    var spldisc;
    var cashdisc;
    var roundoffval;
    var page;
    var pageprem;
    var noofcol;
    var billamt;
    var billrate;
    var sectioncode_val = "";
    var resourceno_val = "";
    var dealerh = "";
    var dealerw = "";
    var center = document.getElementById('hiddencenter').value;
    //var branch = document.getElementById('hiddenbranch').value;
    var compcode = document.getElementById('hiddencompcode').value;
    var userid = document.getElementById('hiddenuserid').value;
    var cioid = document.getElementById('txtciobookid').value;
    var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
    //var y=parseInt(noofinsert)   
    var k;
    var dateformat = document.getElementById('hiddendateformat').value;
    for (k = 0; k < y - 1; k++) {


        showid = "sho" + i;
        id = "Text" + i;
        editid = "edit" + i;
        premid = "prem" + i;
        prem1id = "premone" + i;
        colid = "col" + i;
        heightid = "hei" + i;
        widthid = "wid" + i;
        size = "siz" + i;
        pagepost = "pagpos" + i;
        namecode = "one";
        premper = "premper" + i;
        premper1 = "premperone" + i;
        adtypid = "adtyp" + i;
        namecode = "two";
        preall = "preall" + i;
        adcat = "adcat" + i;
        late = "lat" + i;
        matsta = "mat" + i;
        cardid = "card" + i;
        filename = "fil" + i;
        discrate = "disrat" + i;
        insertsta = "inssta" + i;
        billstat = "bill" + i;
        adsubcat = "ads" + i;
        repeat = "rep" + i;
        insertno = "ins" + i;
        paid = "pai" + i
        agrred = "agr" + i;
        solo = "sol" + i;
        gross = "gro" + i;
        pageno_inserts = "pagno" + i; ;
        remark_inserts = "rem" + i;
        caption_inserts = "cap" + i;
        page = "pgpre" + i;
        pageprem = "pagper" + i;
        noofcol = "nocol" + i;
        billamt = "ba" + i;
        billrate = "br" + i;
        dealerh = "dealerh" + i;
        dealerw = "dealerw" + i;
        var sectioncode = "seccode" + i;
        var resourceno = "resno" + i;
        agnamnt = "agmn" + i;
        adlgn = "adlag" + i;
        spldisc = "spld" + i;
        cashdisc = "cashd" + i;
        roundoffval = "roundoffval" + i;
        clicatamtval = "clicatamt" + i;
        flatfreqamtval = "flatfreqamt" + i;
        catamtval = "catamt" + i;
        var editid_var = document.getElementById(editid);
        var par1 = (editid_var.parentNode).parentNode;
        //To update subedition detail table
        var subedi = "subedidata" + i;
        var subedidata = "";

        if (browser != "Microsoft Internet Explorer") {
            var insernum = document.getElementById(insertno).innerHTML;
            var insertdate = document.getElementById(id).value;
            var edition = document.getElementById(editid).value;
            var premium1 = document.getElementById(premid).value;
            var premium2 = "";  //document.getElementById(prem1id).value;
            var height = document.getElementById(heightid).value;
            var width = document.getElementById(widthid).value;
            var totalsize = document.getElementById(size).value;
            var pagepost = document.getElementById(pagepost).value;
            var color = document.getElementById(colid).value;
            var premper11 = document.getElementById(premper).value;
            var premper2 = ""; // document.getElementById(premper1).value;
            var premallow = document.getElementById(preall).value;
            var adcategory = document.getElementById(adcat).value;
            var latestdate = document.getElementById(late).value;
            var material = document.getElementById(matsta).value;
            var cardrate = document.getElementById(cardid).value;
            var filename = document.getElementById(filename).value;
            var discrate = document.getElementById(discrate).value;
            var insertstatus = document.getElementById(insertsta).value;
            var billstatus = document.getElementById(billstat).value;
            var adsubcat = document.getElementById(adsubcat).value;
            var repdate = document.getElementById(repeat).value;
            var paidins = document.getElementById(paid).value;
            var insagreedrate = document.getElementById(agrred).value;
            var inssolo = document.getElementById(solo).value;
            var grossrate = document.getElementById(gross).value;
            var insert_pageno = document.getElementById(pageno_inserts).value;
            var insert_remark = document.getElementById(remark_inserts).value;
            var insert_caption = document.getElementById(caption_inserts).value;
            var page_code = ""; //document.getElementById(page).value;
            var page_per = ""; //document.getElementById(premid).value;
            var no_ofcol = document.getElementById(noofcol).value;
            var bill_amt = document.getElementById(billamt).value;
            var bill_rate = document.getElementById(billrate).value;
            var dealerheight = document.getElementById(dealerh).value;
            var dealerwidth = document.getElementById(dealerw).value;
            var biil_agnamnt = document.getElementById(agnamnt).value;
            var bill_adagnamnt = document.getElementById(adlgn).value;
            var biil_splamt = document.getElementById(spldisc).value;
            var bill_cashamt = document.getElementById(cashdisc).value;
            var bill_roundamt = document.getElementById(roundoffval).value;
            var clicatamt = document.getElementById(clicatamtval).value;
            var flatfreqamt = document.getElementById(flatfreqamtval).value;
            var catamt = document.getElementById(catamtval).value;
            var insert_id = "sho" + i;
            var insertid = '0';
            var pkgcodegrid_value = "";
            var pkginsgrid_value = "";
            var pkg_alias_value = "";
            var pkgcodegrid = "hiddenpckcode" + i;

            var pkg_ins = "pkg_ins" + i;

            var pkg_alias = "pkg_alias" + i;
            if (document.getElementById(pkgcodegrid) != null) {
                pkgcodegrid_value = document.getElementById(pkgcodegrid).value;
            }

            if (document.getElementById(pkg_ins) != null) {
                pkginsgrid_value = document.getElementById(pkg_ins).value;
            }

            if (document.getElementById(pkg_alias) != null) {
                pkg_alias_value = trim(document.getElementById(pkg_alias).value);
            }
            if (document.getElementById(insert_id) != null)
                insertid = document.getElementById(insert_id).value;

            if (document.getElementById(sectioncode) != null) {
                sectioncode_val = document.getElementById(sectioncode).value;
            }
            if (document.getElementById(resourceno) != null) {
                resourceno_val = document.getElementById(resourceno).value;
            }
            if (document.getElementById(subedi) != null) {
                subedidata = document.getElementById(subedi).value;
            }
        }
        else {
            var insernum = par1.all[insertno].innerHTML;
            //var insertdate = par1.all[id].value;
            var edition = par1.all[editid].value;
            //var premium1 = par1.all[premid].value;
            var premium2 = "";  //document.getElementById(prem1id).value;
            //var height = par1.all[heightid].value;
            //var width = par1.all[widthid].value;
            var totalsize = par1.all[size].value;
            //var pagepost = par1.all[pagepost].value;
            //var color = par1.all[colid].value;
            //var premper11 = par1.all[premper].value;
            var premper2 = ""; // document.getElementById(premper1).value;
            //var premallow = par1.all[preall].value;
            //var adcategory = par1.all[adcat].value;
            //var latestdate = par1.all[late].value;
            var material = par1.all[matsta].value;
            //var cardrate = par1.all[cardid].value;
            var filename = par1.all[filename].value;
            var discrate = par1.all[discrate].value;
            var insertstatus = par1.all[insertsta].value;
            //var billstatus = par1.all[billstat].value;
            var adsubcat = par1.all[adsubcat].value;
            //var repdate = par1.all[repeat].value;
            //var paidins = par1.all[paid].value;
            var insagreedrate = par1.all[agrred].value;
            var inssolo = par1.all[solo].value;
            var grossrate = par1.all[gross].value;
            //var insert_pageno = par1.all[pageno_inserts].value;
            var insert_remark = par1.all[remark_inserts].value;
            var insert_caption = par1.all[caption_inserts].value;
            var page_code = ""; //document.getElementById(page).value;
            var page_per = ""; //document.getElementById(premid).value;
            //var no_ofcol = par1.all[noofcol].value;
            //var bill_amt = par1.all[billamt].value;
            //var bill_rate = par1.all[billrate].value;
            //var dealerheight = par1.all[dealerh].value;
            //var dealerwidth = par1.all[dealerw].value;
            var insert_id = "sho" + i;
            var insertid = '0';
            var pkgcodegrid_value = "";
            var pkginsgrid_value = "";
            var pkg_alias_value = "";
            var pkgcodegrid = "hiddenpckcode" + i;

            var pkg_ins = "pkg_ins" + i;

            var pkg_alias = "pkg_alias" + i;
            if (par1.all[pkgcodegrid] != null) {
                pkgcodegrid_value = par1.all[pkgcodegrid].value;
            }

            if (par1.all[pkg_ins] != null) {
                pkginsgrid_value = par1.all[pkg_ins].value;
            }

            if (par1.all[pkg_alias] != null) {
                pkg_alias_value = trim(par1.all[pkg_alias].value);
            }
            if (par1.all[insert_id] != null)
                insertid = par1.all[insert_id].value;

            if (par1.all[sectioncode] != null) {
                sectioncode_val = par1.all[sectioncode].value;
            }
            if (par1.all[resourceno] != null) {
                resourceno_val = par1.all[resourceno].value;
            }
            if (par1.all[subedi] != null) {
                subedidata = par1.all[subedi].value;
            }
            var biil_agnamnt = par1.all[agnamnt].value;
            var bill_adagnamnt = par1.all[adlgn].value;
            var biil_splamt = par1.all[spldisc].value;
            var bill_cashamt = par1.all[cashdisc].value;
            var bill_roundamt = par1.all[roundoffval].value;
            var clicatamt = par1.all[clicatamtval].value;
            var flatfreqamt = par1.all[flatfreqamtval].value;
            var catamt = par1.all[catamtval].value;
        }
        //var vtsvalue = document.getElementById('vts' + i).value;
        var cirvts = '';
        var cirpub = '';
        var ciredi = '';
        var cirrate = '';
        var cirdate = '';
        var ciragency = document.getElementById('txtciragency').value;
        var ciragencysubcode = '';
        if (ciragency != "") {
            var myarrayex = ciragency.split('(');
            var agecirname = myarrayex[1].replace(")", "").split('+')[0];
            ciragency = trim(agecirname);
            ciragencysubcode = trim(myarrayex[1].replace(")", "").split('+')[1]);
        }
//        if (vtsvalue != "") {
//            cirvts = vtsvalue.split('ÿ')[0];
//            cirpub = vtsvalue.split('ÿ')[1];
//            ciredi = vtsvalue.split('ÿ')[2];
//            cirrate = vtsvalue.split('ÿ')[3];
//            cirdate = vtsvalue.split('ÿ')[4];
//        }
        //var modid=document.getElementById(showid).value
        //Booking_master.modifygridinsert(insertdate,edition,premium1,premium2,premallow,adcategory,latestdate,material,cardrate,filename,discrate,insertstatus,billstatus,adsubcat,compcode,userid,cioid,height,width,totalsize,pagepost,premper11,premper2,color,repdate,insernum,paidins,insagreedrate,inssolo,grossrate,modid);
        //var boxcharge = document.getElementById('boxc' + i).value;
        //var vat_inc = document.getElementById('vat_inc' + i).value;
      //  var grosslocal = document.getElementById("grolocal" + i).value;
        //var billamtlocal = document.getElementById("balocal" + i).value;
        var discountmain = "";
        if (document.getElementById("disc_" + i) != null)
            discountmain = document.getElementById("disc_" + i).value;
        Booking_master.modifygridinsert(insertdate, edition, premium1, premium2, premallow, adcategory, latestdate, material, cardrate, filename, discrate, insertstatus, billstatus, adsubcat, compcode, userid, cioid, height, width, totalsize, pagepost, premper11, premper2, color, repdate, insernum, paidins, insagreedrate, inssolo, grossrate, insert_pageno, insert_remark, page_code, page_per, no_ofcol, bill_amt, bill_rate, "0", "0", "0", dateformat, pkgcodegrid_value, pkginsgrid_value, pkg_alias_value, insertid, cirvts, cirpub, ciredi, cirrate, cirdate, ciragency, ciragencysubcode, center, document.getElementById('txtbranch').value, document.getElementById('hiddenserverip').value, document.getElementById('vat' + i).value, boxcharge, vat_inc, grosslocal, billamtlocal, sectioncode_val, resourceno_val, insert_caption, dealerheight, dealerwidth, subedidata, discountmain, biil_agnamnt, bill_adagnamnt, biil_splamt, bill_cashamt, bill_roundamt, bill_pdfheightval, "", clicatamt, flatfreqamt, catamt);
        i = i + 1;
    }

    if (document.getElementById('hiddensavemod').value == "0") {
        document.getElementById('tblinsert').innerHTML = ""
        document.getElementById('tblrate').style.display = "none";
        document.getElementById('tblbill').style.display = "none";
        //document.getElementById('tblsize').style.display="none";
        document.getElementById('addetails').style.display = "none";
        document.getElementById('pagedetail').style.display = "none";
        document.getElementById('tblpackage').style.display = "none";
        document.getElementById('tbbox').style.display = "none";
        document.getElementById('txtciobookid').value = "";
        document.getElementById('LinkButton1').disabled = true;
        document.getElementById('LinkButton2').disabled = true;
        document.getElementById('LinkButton3').disabled = true;
        document.getElementById('LinkButton4').disabled = true;
        document.getElementById('LinkButton5').disabled = true;
        document.getElementById('LinkButton6').disabled = true;
        document.getElementById('LinkButton7').disabled = true;
    }

    return false;


}



function blankGross() {
    //    if(paivar=="Y")
    //    {
    //        document.getElementById(document.activeElement.id).value="Y";
    //    }
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtbillamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
}

function link() {

    alert('a');
    return false;
}



function getpremper() {
    var len = "bookdiv";
    if (agreedrate_active != 1) {
        document.getElementById('txtagreedrate').value = "";
        document.getElementById('txtagreedamt').value = "";
        document.getElementById('txtdiscount').value = "";
        document.getElementById('txtdiscpre').value = "";
    }
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txtbillamt').value = "";
    document.getElementById('txtgrossamtlocal').value = "";
    document.getElementById('txtbillamtlocal').value = "";
    // if(document.getElementById('drppageprem').value!="0")
    {
        web_booking.getPremPage(document.getElementById('drppageprem').value, '0', getPremPage_callBack);
    }

    //     var page=document.getElementById('drppageprem').value;
    //     if(page=="0")
    //     {
    //          document.getElementById('txtpremper').value="";        
    //          return false;
    //     }
    //        
    //        var val="";
    //        if(browser!="Microsoft Internet Explorer")
    //        {
    //            var  httpRequest =null;;
    //            httpRequest= new XMLHttpRequest();
    //            if (httpRequest.overrideMimeType) {
    //            httpRequest.overrideMimeType('text/xml'); 
    //            }
    //            
    //            httpRequest.onreadystatechange = function() {alertContents(httpRequest) };

    //            httpRequest.open( "GET","getpremium.aspx?page="+page, false );
    //            httpRequest.send('');
    //            //alert(httpRequest.readyState);
    //            if (httpRequest.readyState == 4) 
    //            {
    //                //alert(httpRequest.status);
    //                if (httpRequest.status == 200) 
    //                {
    //                    val=httpRequest.responseText;
    //                }
    //                else 
    //                {
    //                    alert('There was a problem with the request.');
    //                }
    //            }
    //        }
    //        else
    //        {
    //            var xml = new ActiveXObject("Microsoft.XMLHTTP");
    //            xml.Open( "GET","getpremium.aspx?page="+page, false );
    //            xml.Send();
    //            val=xml.responseText;
    //        }
    //        val=val.split("^");
    //        val=val[0];
    //        document.getElementById('txtpremper').value=val;
    //        if(document.getElementById('tblinsert').innerHTML!="")
    //        {
    //             flagins="0";
    //        }
}

function getPremPage_callBack(res) {
    var len = "bookdiv";
    var ds = res.value;
  //  document.getElementById('txtpremper').value = "";
    if (ds != null) {
       // if (ds.Tables[0].Rows.length > 0) {
           // if (ds.Tables[0].Rows[0].page_no != null)
             //   document.getElementById('txtpageno').value = ds.Tables[0].Rows[0].page_no;
          //  document.getElementById('txtpremper').value = ds.Tables[0].Rows[0].premium_charges;
       // }
    }
    if (document.getElementById('tblinsert').innerHTML != "") {
        //var y=parseInt(noofinsertlo)   
        var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
        var k;
        var colid;
        var p_no;
        var i = 0;
        var pageprem_var = document.getElementById('drppageprem');
        var pageno_var = document.getElementById('txtpageno');
        for (k = 0; k < y - 1; k++) {
            colid = "prempe" + i;
            var colid_var = document.getElementById(colid);
            p_no = "pagno" + i;
            if (document.getElementById("prempe" + i) != null)
             //   document.getElementById("prempe" + i).value = document.getElementById('txtpremper').value;
            //   if(drp_prem==colid_var.value || colid_var.value=='' || colid_var.value=="0")
            // {
            colid_var.value = pageprem_var.value;
            //document.getElementById(p_no).value = pageno_var.value;
            //}
            i = parseInt(i) + 1;
        }
        drp_prem = pageprem_var.value;
    }
}




function getposition() {

    var len = "bookdiv";
    var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    for (k = 0; k < y - 1; k++) {
        colid1 = "posprem" + i;
        var colid_var1 = document.getElementById(colid1);
       colid_var1.value =document.getElementById('drpposition').value;
    
    }

    return false;
}


  function validDate_Grid(name) {
	                    var compcode = document.getElementById('hiddencompcode').value;
	                    //var strid1=strid.split('@');
	                    if (name.length > 7)
	                        var gtid = name.substring(7, name.length);
	                    else
	                        var gtid = name.substring(4, name.length);
	                    editid = "edit" + gtid;
	                    var pkgid = document.getElementById('hiddenpckcode' + gtid).value;
	                    var pkgalias = document.getElementById('pkg_alias' + gtid).value;
	                    var pkgname = document.getElementById(editid).value;
	                    pkgname = pkgname.replace("+", "^");
	                    var value = "1";
	                    var dateday = document.getElementById(name).value;

	                    var strtext = "";
	                    center = '0';
	                    if (document.getElementById('chkall') != null) {
	                        if (document.getElementById('chkall').checked == false) {
	                            center = document.getElementById('hiddencenter').value;
	                        }
	                        else {
	                            center = '0';
	                        }
	                    }

	                    if (browser != "Microsoft Internet Explorer") {
	                        var httpRequest = null; ;
	                        httpRequest = new XMLHttpRequest();
	                        if (httpRequest.overrideMimeType) {
	                            httpRequest.overrideMimeType('text/xml');
	                        }

	                        httpRequest.onreadystatechange = function() { alertContents(httpRequest) };
	                        var adcat = document.getElementById('txtcategory').value;
	                        httpRequest.open("GET", "packagename.aspx?center=" + center + "&adtype=" + document.getElementById('hiddenadtype').value + "&pkgalias=" + pkgalias + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + value + "&dateday=" + dateday + "&pkgname=" + pkgname, false);
	                        httpRequest.send('');
	                        //alert(httpRequest.readyState);
	                        if (httpRequest.readyState == 4) {
	                            //alert(httpRequest.status);
	                            if (httpRequest.status == 200) {
	                                strtext = httpRequest.responseText;
	                            }
	                            else {
	                                alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
	                            }
	                        }
	                    }
	                    else {
	                        var xml = new ActiveXObject("Microsoft.XMLHTTP");
	                        var adcat = document.getElementById('txtcategory').value;
	                        xml.Open("GET", "packagename.aspx?center=" + center + "&adtype=" + document.getElementById('hiddenadtype').value + "&pkgalias=" + pkgalias + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + value + "&dateday=" + dateday + "&pkgname=" + pkgname, false);
	                        xml.Send();
	                        strtext = xml.responseText;
	                    }
	                    if (strtext == "NOT A VALID DATE") {
	                        alert("NOT A VALID DATE");
	                        document.getElementById(name).value = "";
	                        document.getElementById(name).focus();
	                        return false;
	                    }
	                    if (strtext == "0") {
	                        alert("Publication day doesnot match with day for Edition " + pkgname);
	                        document.getElementById(name).value = "";
	                        // document.getElementById(name).value=tempdate;

	                    }
	                    if (strtext != "1" && strtext != "0") {
	                        //document.getElementById(name).value=strtext;
	                        setTimeout("changeText('" + name + "','" + strtext + "')", 5);
	                    }
	                    else {
	                        document.getElementById(name).value = document.getElementById(name).value;
	                    }

	                }

	                function insertLine_callback(response) {
	                    var ds = response.value;


	                    if (ds == null) {
	                        alert("There is Some Network Error. Please Do the Booking Again");
	                        return false;
	                    }
	                    fillinsert = ds.Tables[0].Rows.length;
	                    var i = 0;
	                    var str = "";
	                    var adtype_vari = document.getElementById('hiddenadtype');
	                    var chkall_vari = "";// document.getElementById('chkall');
	                    var pagepremcopy = document.getElementById('drppageprem'); //chnage for negative amt mimoh
	                    var pagepremper = ""; //document.getElementById('txtpremper');
	                    var center_vari = "";  //document.getElementById('hiddencenter');
	                    var adsubcat_vari = "";  document.getElementById('drpadsubcategory');
	                    var color_vari = "B";  //document.getElementById('drpcolor');
	                    var column_vari = "";  //document.getElementById('txtcolum');
	                    var uom_vari = document.getElementById('drpuom');
	                    var hiddenuom_vari = document.getElementById('hiddenuomdesc');
	                    var matsta_vari = document.getElementById('drpmatsta');
	                    var drppagepos_vari = ""; //document.getElementById('drppageposition');
	                    var adcat_vari = ""; //document.getElementById('drpadcategory');
	                    var pkgcopy_vari = document.getElementById('drppackagecopy');
	                    var gridtab_vari = document.getElementById('gridtab');
	                    var dateformat_vari = document.getElementById('hiddendateformat');
	                    var caption_per = ""; document.getElementById('txtcaption');
	                    var remarks_per = document.getElementById('txtprintremark');
	                    var adcat_vari = document.getElementById('hdncategory');
	                    var dat = "mm+" / "+" / "+dd+" / "+yyyy";
	                    var j = 0;
	                    var k = 0;
	                    var l = 0;
	                    var m = 0;
	                    var n = 0;
	                    var o = 0;
	                    var p = 0;
	                    var premid;
	                    var premper;
	                    var colid;
	                    var height;
	                    var width;
	                    var size;
	                    var late;
	                    var adtypid;
	                    var uomid;
	                    var cardid;
	                    var premper1;
	                    var prem1id;
	                    var name;
	                    var inserts;
	                    var pagepost;
	                    var preall;
	                    var adcat;
	                    var adsubcat;
	                    var matsta;
	                    var filename;
	                    var discrate;
	                    var insertsta;
	                    var billstat;
	                    var editid;
	                    var repeat;
	                    var picfieldl;
	                    var colid;
	                    var paid;
	                    var agrred;
	                    var solo;
	                    var gross;
	                    var s;
	                    var count;
	                    var len = "bookdiv";
	                    var pageno_inserts;
	                    var remark_inserts;
	                    var caption_inserts;
	                    var page;
	                    var pageprem;
	                    var billamt;
	                    var billrate;
	                    var agnamnt;
	                    var adlgn;
	                    var spldisc;
	                    var cashdisc;
	                    var pagstr;
	                    var agnamnt;
	                    var adlgn;
	                    var spldisc;
	                    var cashdisc;
	                    var roundoffval;
	                    //new change for bind grid line
	                    var dcat1 = "";
	                    var dcol = "";
	                    var dinsert = "";
	                    var dstatus = "";
	                    var dposition = "";
	                    var dprem1 = "";
	                    var dpre = "";
	                    var dmcat = "";
	                    var dbill = "";
	                    var dadcat3 = "";
	                    var dadcat4 = "";
	                    var dadcat5 = "";
	                    var dpaid = "";
	                    var dcou = 0;
	                    //***************************
	                    var objedition = document.getElementById('drpedition');
	                    if (spdiscper == 1) {
	                        document.getElementById('txtspedisc').value = "";
	                    }
	                    else if (spdisc == 1) {
	                        document.getElementById('txtspediscper').value = "";
	                    }
	                    if (document.getElementById('hiddensavemod').value != "0") {
	                        count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
	                        idnew = parseInt(count);
	                        document.getElementById('hiddenrowcount').value = count;
	                        //insertval=count;
	                        if (document.getElementById('hiddeninsertion').value != "") {
	                            gridItemCount = parseInt(count) / parseInt(document.getElementById('hiddeninsertion').value);
	                            insertval = document.getElementById('hiddeninsertion').value;
	                            tempins = document.getElementById('hiddeninsertion').value;
	                            count = parseInt(ds.Tables[0].Rows.length, 10) / parseInt(document.getElementById('txtinsertion').value, 10);
	                            count = parseInt(count) * parseInt(document.getElementById('hiddeninsertion').value);
	                            document.getElementById('hiddeninsertion').value = ""
	                        }


	                    }
	                    else {
	                        count = document.getElementById('hiddenrowcount').value;
	                        document.getElementById('hiddenrowcount').value = ds.Tables[0].Rows.length;
	                    }
	                    // count=document.getElementById(len).getElementsByTagName('table')[0].rows.length-1;
	                    /*if(document.getElementById('txtrepeatingdate').value!="")
	                    {
	                    count=0;
	                    }*/

	                    var temp = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
	                    //i=count;
	                    i = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
	                    var adsize1val = ""; //document.getElementById('txtadsize1').value;
	                    var adsize2val = ""; //document.getElementById('txtadsize2').value;
	                    var colval = ""; //document.getElementById('txtcolum').value;
	                    var areaval = document.getElementById('txttotalarea').value;
	                    dcou = i;
	                    var insprev = 0;
	                    var ins_vari_m = document.getElementById('ins' + (parseInt(count, 10) - 1).toString());
	                    var data_arr = new Array();
	                    if (ins_vari_m != null) {
	                        var tsec = parseInt(count, 10) - 1;
	                        var insidM = "1";
	                        if (ds.Tables[0].Rows.length > 0 && ds.Tables[0].Rows[count] != null)
	                            insidM = ds.Tables[0].Rows[count].IDNUM;
	                        var sd = 0;
//	                        while (parseInt(ins_vari_m.innerHTML) == insidM) {
//	                            var strN = document.getElementById('edit' + tsec).value + "~" + document.getElementById('Text' + tsec).value;
//	                            strN = strN + "~" + document.getElementById('hei' + tsec).value + "~" + document.getElementById('wid' + tsec).value;
//	                            strN = strN + "~" + document.getElementById('siz' + tsec).value + "~" + document.getElementById('nocol' + tsec).value;
//	                            data_arr[sd] = strN;
//	                            tsec = tsec - 1;
//	                            sd = sd + 1;
//	                            ins_vari_m = document.getElementById('ins' + tsec);
//	                            if (ins_vari_m == null)
//	                                break;
//	                        }
	                    }
	                    for (s = count; s < ds.Tables[0].Rows.length; s++) {

	                        if (getid != "" && parseInt(i) < parseInt(getid)) {
	                            i = getid;
	                            // i=parseInt(i)+1;
	                        }
	                        var vvalue = "";
	                        if (checkflag == 1) {
	                            caldate[cali] = dateSelected;
	                            caldatemonth[cali] = parseInt(monthSelected) + 1;
	                            caldateyear[cali] = yearSelected;
	                            // cali=cali+1;
	                        }
	                        var dCheck = checkValidEdition(ds.Tables[0].Rows[s].Edition_Name);
	                        //var dCheck=true;
	                        if (dCheck == true) {
	                            var id = "Text" + i;
	                            uomid = "uom" + i;
	                            inserts = "ins" + i;
	                            editid = "edit" + i;
	                            colid = "col" + i;
	                            agrred = "agr" + i;
	                            btn_Pg_ = "btn_Pg_" + i;
	                            agnamnt = "agmn" + i;
	                            adlgn = "adlag" + i;
	                            spldisc = "spld" + i;
	                            cashdisc = "cashd" + i;
	                            roundoffval = "roundoffval" + i;
	                            //bind button pageset for pagination
	                            Make_Row = document.createElement("tr");
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                          //  str = "<input  class='buttonpgset' id='" + btn_Pg_ + "' type='button' Value='PageSet'>";
	                          //  make_td.innerHTML = str;
	                       //     Make_Row.appendChild(make_td);


	                            insertval = parseInt(ds.Tables[0].Rows[s].IDNUM) + 1;
	                            // Make_Row=document.createElement("tr");
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.setAttribute("class", "TextField");
	                            make_td.innerHTML = insertval;
	                            make_td.id = inserts;
	                            if (insprev != insertval) {
	                                insprev = insertval;
	                                make_td.title = "Edit Insert";
	                            }
	                            Make_Row.appendChild(make_td);

	                            // edition
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.setAttribute("class", "dtGrid");
	                            str = "<input class=\"btextforgrid7\" type=\"text\" disabled id=" + editid + " value='" + ds.Tables[0].Rows[s].Edition_Name + "'>";
	                            make_td.innerHTML = str;
	                            Make_Row.appendChild(make_td);

	                            //date
//	                            var nDate = "";
//	                            if (ds.Tables[0].Rows[s].Date != null) {
//	                                nDate = ds.Tables[0].Rows[s].Date;
//	                            }

//	                            for (var e = 0; e < data_arr.length; e++) {
//	                                var d_ = data_arr[e].split("~")[1];
//	                                var E_ = data_arr[e].split("~")[0];
//	                                if (ds.Tables[0].Rows[s].Edition_Name == E_.toString()) {
//	                                    if (noissueflag == true) {
//	                                        nDate = d_;
//	                                        if (nDate != "") {
//	                                            nDate = getRepeat(nDate, document.getElementById('txtrepeatingdate').value, dateformat_vari.value);
//	                                        }
//	                                    }
//	                                    adsize1val = data_arr[e].split("~")[2];
//	                                    adsize2val = data_arr[e].split("~")[3];
//	                                    areaval = data_arr[e].split("~")[4];
//	                                    colval = data_arr[e].split("~")[5];
//	                                    data_arr[e] = E_ + "~" + nDate + "~" + adsize1val + "~" + adsize2val + "~" + areaval + "~" + colval;
//	                                    e = data_arr.length;
//	                                }
//	                            }
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            //str="<input class=\"btextforgrid\" type=\"text\" id="+id+"   onfocus=\"popUpCalendar(Form1."+id+", Form1."+id+", "+dat+");\"  onkeydown=\"return nodateentry(event);\" value="+nDate+" ><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1."+id+", Form1."+id+", "+dat+");\" height=\"14\" width=\"14\" />";
	                            str = "<input class=\"btextforgriddate\" type=\"text\" id=" + id + "    value=" + ds.Tables[0].Rows[s].Date + ">";
	                            make_td.innerHTML = str;
	                            Make_Row.appendChild(make_td);

	                            var expirydt = "lat" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.setAttribute("class", "dtGrid");
	                            str = "<input class=\"btextforgriddate\" type=\"text\" id=" + expirydt + "    value=''>";
	                            make_td.innerHTML = str;
	                            Make_Row.appendChild(make_td);

	                            // Ad Sub Cat
	                            adsubcat = "ads" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.setAttribute("class", "dtGrid");
	                            if (adsubcat_vari.value != '0') {
	                                str = "<input class=\"btextforgrid\" type=\"text\"  id=" + adsubcat + " value= ''>"; //avi
	                            }
	                            else {
	                                str = "<input class=\"btextforgrid\" type=\"text\"  id=" + adsubcat + " value=''>";
	                            }

	                            make_td.innerHTML = str;
	                            Make_Row.appendChild(make_td);


	                            size = "size" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.setAttribute("class", "dtGrid");
	                            str = "<input class=\"btextforgrid\" type=\"text\"  id=" + size + " value=''>";
	                            make_td.innerHTML = str;
	                            Make_Row.appendChild(make_td);
	                            

//	                            filename = "fil" + i;
//	                            var upl = "upload" + i
//	                            make_td = document.createElement("td");
//	                            make_td.align = "center";
//	                            str = "<input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled  value=\"\">";
//	                            make_td.innerHTML = str;
//	                            Make_Row.appendChild(make_td);

	                            var upl = "upload" + i
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.setAttribute("class", "button1");
	                            make_td.innerHTML = "<input  class=\"button1\" type=\"button\"  id=" + upl + " Value=\"Attachment\">";
	                            Make_Row.appendChild(make_td);
	                            
	                            
	                            insertsta = "inssta" + i;
	                            billstat = "bill" + i;

	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.setAttribute("class", "dtGrid");
	                            make_td.innerHTML = "<input  class=\"btextforgrid\" disabled type=\"text\"  id=" + insertsta + " Value='Booked'>";
	                            Make_Row.appendChild(make_td);
	                            ////////this is to bind the status of insertion drop down  agrred

	                           var cs=0
	                           if (ds.Tables[8].Rows.length == 0) {
	                               cardid = "cardrate" + i;
	                               make_td = document.createElement("td");
	                               make_td.align = "center";
	                               make_td.setAttribute("class", "dtGrid");
	                               make_td.innerHTML = "<input  class=\"btextforgrid\" type=\"text\"  id=" + cardid + " Value=''>";
	                               Make_Row.appendChild(make_td);
	                           }

	                            discrate = "disrat" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.setAttribute("class", "dtGrid");
	                            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + discrate + "  value=\"\">";
	                            Make_Row.appendChild(make_td);

	                            // str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+agrred+"  value=\"\"></td>";
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.setAttribute("class", "dtGrid");
	                            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agrred + "  value=\"\">";
	                            Make_Row.appendChild(make_td);


	                            ////this loop is to bind the page position
	                            filename = "fil" + i;
	                           
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.setAttribute("class", "dtGrid");
	                            str = "<input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled  value=\"\">";
	                            make_td.innerHTML = str;
	                            Make_Row.appendChild(make_td);

	                            matsta = "material" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.setAttribute("class", "dtGrid");
	                            str = "<input class=\"btextforgrid7\" type=\"text\" id=" + matsta + " disabled  value="+matsta_vari.value+">";
	                            make_td.innerHTML = str;
	                            Make_Row.appendChild(make_td);

	                            var geogra = "geo" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.setAttribute("class", "dtGrid");
	                            str = "<input class=\"button1\" type=\"button\" id=" + geogra + "   value=\"Addi. Info\">";
	                            make_td.innerHTML = str;
	                            Make_Row.appendChild(make_td);




	                            ////////////this is to for larest date

	                            late = "lat" + i;
	                            repeat = "rep" + i;
	                            var dat = "mm+" / "+" / "+dd+" / "+yyyy";

	                            premper = "prempe" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.setAttribute("class", "dtGrid");
	                            str = "<input class=\"btextforgrid\" type=\"text\" id=" + premper + " disabled  value=\"\">";
	                            make_td.innerHTML = str;
	                            Make_Row.appendChild(make_td);


	                            var  pospre = "posprem" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.setAttribute("class", "dtGrid");
	                            str = "<input class=\"btextforgrid\" type=\"text\" id=" + pospre + " disabled  value=\"\">";
	                            make_td.innerHTML = str;
	                            Make_Row.appendChild(make_td);

	                            

	                            namecode = "one";

	                           
	                            premper1 = "premperone" + i;
	                            adtypid = "adtyp" + i;
	                            var namecode2 = "two";
	                            preall = "preall" + i;
	                            adcat = "adcat" + i;
	                            page = "pgpre" + i;
	                            pageprem = "pagper" + i;
	                            var h;
	                            ///this is to bind the page prem 2 drp down
	                            pagstr = "sec"


	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.setAttribute("class", "dtGrid");
	                            str = "<input class=\"btextforgriddate\" type=\"text\" id=" + pageprem + " disabled  value=\"\">";
	                            make_td.innerHTML = str;
	                            Make_Row.appendChild(make_td);

	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                           
	                                make_td.innerHTML = "<input  class=\"dropdownforgrid\" type=\"text\" id=" + adcat + " value='"+ adcat_vari.value+"' >";
	                            
	                            Make_Row.appendChild(make_td);

	                            var discount_ = "disc_" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";

	                            make_td.innerHTML = "<input  class=\"dropdownforgrid\" type=\"text\" id=" + discount_ + "value='' >";

	                            Make_Row.appendChild(make_td);

	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.setAttribute("class", "dtGrid");
	                            if(document.getElementById('hiddisceditgrid').value=="Y")
	                                str = "<input class=\"btextsmallsizeH\" type=\"text\" id=" + discount_ + "   value=\"\">";
	                            else
	                                str = "<input class=\"btextsmallsizeH\" type=\"text\" id=" + discount_ + " disabled  value=\"\">";
	                            make_td.innerHTML = str;
	                            Make_Row.appendChild(make_td);
	                            
	                            
	                            

	                            paid = "pai" + i;
	                            solo = "sol" + i;
	                            gross = "gro" + i;
	                            
	                            ///////////////this is to bind the drop down for paid/free insertion
	                            if (dpaid == "") {
	                                make_td = document.createElement("td");
	                                make_td.align = "center";
	                                dpaid = dpaid + "<select id=" + paid + " class=\"dropdownforgridsmall\"  >";
	                                dpaid = dpaid + "<option value=\"Y\">Yes</option>";
	                                dpaid = dpaid + "<option value=\"N\">No</option>";
	                                dpaid = dpaid + "<option value=\"P\">Paid</option>";
	                                dpaid = dpaid + "</select>";
	                                make_td.innerHTML = dpaid;
	                                Make_Row.appendChild(make_td);
	                            }
	                            else {
	                                make_td = document.createElement("td");
	                                make_td.align = "center";
	                                str = dpaid.replace("pai" + dcou, paid);
	                                make_td.innerHTML = str;
	                                Make_Row.appendChild(make_td);
	                            }

	                            billamt = "ba" + i;
	                            billrate = "br" + i;
	                            agnamnt = "agmn" + i;
	                            adlgn = "adlag" + i;
	                            spldisc = "spld" + i;
	                            cashdisc = "cashd" + i;
	                            str = str + "</select></td>";

	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + solo + "  value=\"\">";
	                            Make_Row.appendChild(make_td);

	                            //str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+gross+"  value=\"\"></td>";
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + gross + "  value=\"\">";
	                            Make_Row.appendChild(make_td);

	                            pageno_inserts = "pageno" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.innerHTML = "<input class=\"btextforgrid\"  type=\"text\" id=" + pageno_inserts + "  value=\"\">";
	                            Make_Row.appendChild(make_td);

	                            caption_inserts = "caption" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.innerHTML = "<input class=\"btextforgrid\"  type=\"text\" id=" + caption_inserts + "  value=\"\">";
	                            Make_Row.appendChild(make_td);

	                            remark_inserts = "rem" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.innerHTML = "<input class=\"btextforgrid\"  type=\"text\" id=" + remark_inserts + "  value=\"\">";
	                            Make_Row.appendChild(make_td);

	                            var billamtlocal = "balocal" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + billamtlocal + "  value=\"\">";
	                            Make_Row.appendChild(make_td);

	                            var grosslocal = "grolocal" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + grosslocal + "  value=\"\">";
	                            Make_Row.appendChild(make_td);
	                            
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + billamt + "  value=\"\">";
	                            Make_Row.appendChild(make_td);

	                            var pageset = "pgst" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.innerHTML = "<input class=\"button1\"  type=\"button\" id=" + pageset + "  value=\"Pageset\">";
	                            Make_Row.appendChild(make_td);

	                            if (browser != "Microsoft Internet Explorer") {
	                                if (xmlObj.childNodes[25].childNodes[15].childNodes[0].nodeValue != "hide") {
	                                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agnamnt + "  value=\"\">";
	                                    Make_Row.appendChild(make_td);
	                                }
	                                else {
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agnamnt + "  value=\"\">";
	                                    make_td.style.display = "none";
	                                    Make_Row.appendChild(make_td);
	                                }
	                            }
	                            else {
	                                if (xmlObj.childNodes[12].childNodes[7].childNodes[0].nodeValue != "hide") {
	                                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agnamnt + "  value=\"\">";
	                                    Make_Row.appendChild(make_td);
	                                }
	                                else {
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agnamnt + "  value=\"\">";
	                                    make_td.style.display = "none";
	                                    Make_Row.appendChild(make_td);
	                                }
	                            }

	                            if (browser != "Microsoft Internet Explorer") {
	                                if (xmlObj.childNodes[25].childNodes[17].childNodes[0].nodeValue != "hide") {
	                                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + adlgn + "  value=\"\">";
	                                    Make_Row.appendChild(make_td);
	                                }
	                                else {
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + adlgn + "  value=\"\">";
	                                    make_td.style.display = "none";
	                                    Make_Row.appendChild(make_td);
	                                }
	                            }
	                            else {
	                                if (xmlObj.childNodes[12].childNodes[8].childNodes[0].nodeValue != "hide") {
	                                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + adlgn + "  value=\"\">";
	                                    Make_Row.appendChild(make_td);
	                                }
	                                else {
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + adlgn + "  value=\"\">";
	                                    make_td.style.display = "none";
	                                    Make_Row.appendChild(make_td);
	                                }
	                            }

	                            if (browser != "Microsoft Internet Explorer") {
	                                if (xmlObj.childNodes[25].childNodes[19].childNodes[0].nodeValue != "hide") {
	                                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + spldisc + "  value=\"\">";
	                                    Make_Row.appendChild(make_td);
	                                }
	                                else {
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + spldisc + "  value=\"\">";
	                                    make_td.style.display = "none";
	                                    Make_Row.appendChild(make_td);
	                                }
	                            }
	                            else {
	                                if (xmlObj.childNodes[12].childNodes[9].childNodes[0].nodeValue != "hide") {
	                                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + spldisc + "  value=\"\">";
	                                    Make_Row.appendChild(make_td);
	                                }
	                                else {
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + spldisc + "  value=\"\">";
	                                    make_td.style.display = "none";
	                                    Make_Row.appendChild(make_td);
	                                }
	                            }

	                            if (browser != "Microsoft Internet Explorer") {
	                                if (xmlObj.childNodes[25].childNodes[21].childNodes[0].nodeValue != "hide") {
	                                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cashdisc + "  value=\"\">";
	                                    Make_Row.appendChild(make_td);
	                                }
	                                else {
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cashdisc + "  value=\"\">";
	                                    make_td.style.display = "none";
	                                    Make_Row.appendChild(make_td);
	                                }
	                            }
	                            else {
	                                if (xmlObj.childNodes[12].childNodes[10].childNodes[0].nodeValue != "hide") {
	                                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cashdisc + "  value=\"\">";
	                                    Make_Row.appendChild(make_td);
	                                }
	                                else {
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cashdisc + "  value=\"\">";
	                                    make_td.style.display = "none";
	                                    Make_Row.appendChild(make_td);
	                                }
	                            }
	                            if (browser != "Microsoft Internet Explorer") {
	                                if (xmlObj.childNodes[25].childNodes[23].childNodes[0].nodeValue != "hide") {
	                                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + roundoffval + "  value=\"\">";
	                                    Make_Row.appendChild(make_td);
	                                }
	                                else {
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + roundoffval + "  value=\"\">";
	                                    make_td.style.display = "none";
	                                    Make_Row.appendChild(make_td);
	                                }
	                            }
	                            else {
	                                if (xmlObj.childNodes[12].childNodes[11].childNodes[0].nodeValue != "hide") {
	                                    //str=str+"<td><input class=\"btextforgrid\"    type=\"text\" id="+billrate+"  value=\"\"></td>";
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + roundoffval + "  value=\"\">";
	                                    Make_Row.appendChild(make_td);
	                                }
	                                else {
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + roundoffval + "  value=\"\">";
	                                    make_td.style.display = "none";
	                                    Make_Row.appendChild(make_td);
	                                }
	                            }
	                            
	                            var logohei = "logohei" + i;
	                            var logowid = "logowid" + i;
	                            var logonam = "logonam" + i;

//	                            make_td = document.createElement("td");
//	                            make_td.align = "center";
//	                            make_td.innerHTML = "<input class=\"btextforgrid\"  type=\"text\" id=" + logohei + "  value=\"\">";
//	                            make_td.style.diaplay ="none";
//	                            Make_Row.appendChild(make_td);

//	                            make_td = document.createElement("td");
//	                            make_td.align = "center";
//	                            make_td.innerHTML = "<input class=\"btextforgrid\"  type=\"text\" id=" + logowid + "  value=\"\">";
//	                            make_td.style.diaplay ="none";
//	                            Make_Row.appendChild(make_td);

//	                            make_td = document.createElement("td");
//	                            make_td.align = "center";
//	                            make_td.innerHTML = "<input class=\"btextforgrid\"  type=\"text\" id=" + logonam + "  value=\"\">";
//	                            make_td.style.diaplay ="none";
//	                            Make_Row.appendChild(make_td);
	                            

	                            

	                            pkgcodegrid = 'hiddenpckcode' + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkgcodegrid + "' value='" + ds.Tables[0].Rows[s].EDITION_CODE + "'>";
	                            Make_Row.appendChild(make_td);

	                            var pubcode = 'pubcode' + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pubcode + "' value='" + ds.Tables[0].Rows[s].PUBCODE + "'>";
	                            Make_Row.appendChild(make_td);

	                            //This below code for  puting the number of occurance of packages into grid
	                            var pkg_ins = 'pkg_ins' + i;
	                            for (var countpkg = 0; countpkg < pkgcopy_vari.length; countpkg++) {
	                                var pkgcopy = pkgcopy_vari.options[countpkg].value;
	                                var arrpkgcopy = pkgcopy.split('@');
	                                var pkgcopycode = arrpkgcopy[0];
	                                var arr_pkg_ins_value = arrpkgcopy[1].split('(');
	                                var pkg_ins_value = arr_pkg_ins_value[1].replace(')', '');
	                                if (pkgcopycode == ds.Tables[0].Rows[s].EDITION_CODE) {
	                                    // str=str+"<td><input disabled class=\"btextsmallsize\" type=\"text\" id='"+pkg_ins+"' value="+pkg_ins_value+"></td>";
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_ins + "' value='" + pkg_ins_value + "'>";
	                                    Make_Row.appendChild(make_td);
	                                    countpkg = pkgcopy_vari.length;
	                                }
	                                else {
	                                    make_td = document.createElement("td");
	                                    make_td.align = "center";
	                                    make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_ins + "' value='" + pkg_ins_value + "'>";
	                                    Make_Row.appendChild(make_td);
	                                    countpkg = pkgcopy_vari.length;
	                                }
	                            }

	                            pkg_alias = 'pkg_alias' + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_alias + "' value='" + ds.Tables[0].Rows[s].PKGNAME + "'>";
	                            Make_Row.appendChild(make_td);

	                            var spltdata = "spltdata" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + spltdata + "' value=\"\">";
	                            Make_Row.appendChild(make_td);


	                            var subedidata = "subedidata" + i; make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + subedidata + "' value=\"\">";
	                            Make_Row.appendChild(make_td);

	                            var vat = "vat" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + vat + "' value=\"\">";
	                            Make_Row.appendChild(make_td);

	                            var boxc = "boxc" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + boxc + "' value=\"\">";
	                            Make_Row.appendChild(make_td);

	                            var vat_inc = "vat_inc" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + vat_inc + "' value=\"\">";
	                            Make_Row.appendChild(make_td);

	                            var coupan = "coupan" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + coupan + "' value=\"\">";
	                            Make_Row.appendChild(make_td);

	                            var clicatamt = "clicatamt" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + clicatamt + "' value=\"\">";
	                            Make_Row.appendChild(make_td);

	                            var flatfreqamt = "flatfreqamt" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + flatfreqamt + "' value=\"\">";
	                            Make_Row.appendChild(make_td);

	                            var catamt = "catamt" + i;
	                            make_td = document.createElement("td");
	                            make_td.align = "center";
	                            make_td.innerHTML = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + catamt + "' value=\"\">";
	                            Make_Row.appendChild(make_td);
	                            //   str=str+"<td><input disabled class=\"btextsmallsize\" type=\"text\" id='"+spltdata+"' value=\"\"></td>";

	                            

	                            gridtab_vari.getElementsByTagName("tbody")[0].appendChild(Make_Row);
	                           

	                            i = parseInt(i) + 1;
	                        }

	                    } //end of for

	                    var rowcount = gridtab_vari.rows.length - 1;
	                    document.getElementById('hdnrowcount').value = rowcount;
	                    var dateformat_vari = document.getElementById('hiddendateformat');
	                    var compcode_vari = document.getElementById('hiddencompcode');
	                    var center_vari = document.getElementById('hiddencenter');
	                    var adtype_vari = document.getElementById('hiddenadtype');
	                    var chkall_vari = document.getElementById('chkall');
	                    var temp = idnew;
	                    idnew = ds.Tables[0].Rows.length;

	                    previnsertion = document.getElementById('txtinsertion').value;
	                    
	                      
	                    if (browserversion > 6) {
	                        $(".dropdownforgridsmall").change(function() {
	                            if (document.activeElement.id.indexOf("pai") >= 0) {
	                                blankGross();
	                            }
	                        });
	                        $(".btextsmallsizeH").change(function() {
	                        if ( document.activeElement.id.indexOf("pgpre") >= 0 || document.activeElement.id.indexOf("nocol") >= 0 || document.activeElement.id.indexOf("hei") >= 0 || document.activeElement.id.indexOf("wid") >= 0 || document.activeElement.id.indexOf("ins") >= 0) {
	                                var i;
	                                if (document.activeElement.id.indexOf("disc_") >= 0) {
	                                    blankGross();

	                                }
	                                if (document.activeElement.id.indexOf("pgpre") >= 0) {
	                                    i = document.activeElement.id.substring(5, document.activeElement.id.length + 1);
	                                    var page = "pgpre" + i;
	                                    var pagstr = "sec";
	                                    var f = getpageprem(page, i, pagstr);
	                                    if (f == false)
	                                        return false;
	                                }
	                                else {
	                                    if (document.activeElement.id.indexOf("nocol") >= 0) {
	                                        i = document.activeElement.id.substring(5, document.activeElement.id.length + 1);

	                                    }
	                                    else {
	                                        i = document.activeElement.id.substring(3, document.activeElement.id.length + 1);

	                                    }
	                                    var height = "hei" + i;
	                                    var width = "wid" + i;
	                                    var inserts = "ins" + i;
	                                    var insertval = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(i, 10) + 1].cells[0].innerHTML;
	                                    var noofcol = "nocol" + i;
	                                    var f = gettotalsize(height, width, i, inserts, insertval, noofcol);
	                                    if (f == false)
	                                        return false;
	                                }
	                            }
	                        });
	                        $(".btextforgriddate").change(function() {
	                            if (document.activeElement.id.indexOf("Text") >= 0) {
	                                var f = chkDateforGrid(this);
	                                if (f == false)
	                                    return false;
	                            }
	                            else if (document.activeElement.id.indexOf("rep") >= 0 || document.activeElement.id.indexOf("lat") >= 0) {
	                                checkdate(document.getElementById(document.activeElement.id));
	                            }
	                        });
	                        for (i = count; i < gridtab_vari.getElementsByTagName("tbody")[0].rows.length - 1; i++) {

	                            if (repeatdate == "0" || repeatdate == "1") {
	                                var id = "Text" + temp;
	                                if (document.getElementById('Text' + temp) == null)
	                                    return false;
	                                //   if(caldatemonth[temp]!=undefined)
	                                //  {
	                                // var mmM=caldatemonth[temp].toString();
	                                //}else{
	                                var mmM = parseInt(monthSelected, 10) + 1;
	                                mmM = mmM.toString();
	                                //}
	                                if (mmM.toString().length == 1)
	                                    mmM = "0" + mmM.toString();
	                                if (dateSelected.toString().length == 1)
	                                    dateSelected = "0" + dateSelected.toString();
	                                if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
	                                    vvalue = mmM + "/" + dateSelected + "/" + yearSelected;
	                                }
	                                else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
	                                    vvalue = dateSelected + "/" + mmM + "/" + yearSelected; ;
	                                }
	                                else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
	                                    vvalue = yearSelected + "/" + mmM + "/" + dateSelected; ;
	                                }
	                                if (document.getElementById('Text' + i) != null && document.getElementById('Text' + i).value != "" && checkflag == "2") {
	                                    vvalue = document.getElementById('Text' + i).value;

	                                }

	                                if (dateSelected != undefined && dateSelected!="") {
	                                    if (browser != "Microsoft Internet Explorer") {
	                                        var pkgfullname = document.getElementById('pkg_alias' + i).value;
	                                        var pkgid = document.getElementById('hiddenpckcode' + i).value;
	                                        var pkgname = document.getElementById('pkg_alias' + i).value;
	                                        var compcode = document.getElementById('hiddencompcode').value;

	                                        dateday = vvalue;

	                                        document.getElementById('Text' + i).value = vvalue;
	                                    }
	                                    else {
	                                        var pkgfullname = document.getElementById('pkg_alias' + i).value;
	                                        var pkgid = document.getElementById('hiddenpckcode' + i).value;
	                                        var pkgname = document.getElementById('pkg_alias' + i).value;
	                                        var compcode = document.getElementById('hiddencompcode').value;
	                                        dateday = vvalue;

	                                        document.getElementById('Text' + i).value = vvalue;
	                                    }
	                                    if (browser != "Microsoft Internet Explorer") {
	                                        var httpRequest = null; ;
	                                        httpRequest = new XMLHttpRequest();
	                                        if (httpRequest.overrideMimeType) {
	                                            httpRequest.overrideMimeType('text/xml');
	                                        }

	                                        httpRequest.onreadystatechange = function() { alertContents(httpRequest) };
	                                        var adcat = adcat_vari.value;
	                                        httpRequest.open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
	                                        httpRequest.send('');
	                                        //alert(httpRequest.readyState);
	                                        if (httpRequest.readyState == 4) {
	                                            //alert(httpRequest.status);
	                                            if (httpRequest.status == 200) {
	                                                strtext = httpRequest.responseText;
	                                            }
	                                            else {
	                                                alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
	                                            }
	                                        }
	                                    }
	                                    else {
	                                        validuse = "";
	                                        var xml = new ActiveXObject("Microsoft.XMLHTTP");
	                                        var adcat = adcat_vari;
	                                        var center = '';
	                                        if (center_vari != null) {
	                                            center = center_vari.value;
	                                            if (chkall_vari != null) {
	                                                if (chkall_vari.checked == true) {
	                                                    center = '0';
	                                                }
	                                            }
	                                            else {
	                                                center = '0';
	                                            }
	                                        }
	                                        xml.Open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
	                                        xml.Send();
	                                        strtext = xml.responseText;
	                                    }
	                                    if (strtext == "NOT A VALID DATE") {
	                                        alert("NOT A VALID DATE");
	                                        document.getElementById(id).value = "";
	                                        document.getElementById(id).focus();
	                                        //  return false;
	                                    }
	                                    if (strtext == "0") {
	                                        alert("Day is not the publishing day");
	                                        document.getElementById(id).value = "";
	                                        //   return false;
	                                    }
	                                    else {
	                                        if (strtext == "1")
	                                            document.getElementById(id).value = vvalue;
	                                        else {
	                                            if (strtext != "") {
	                                                if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
	                                                    var txt = strtext;
	                                                    var txt1 = txt.split("/");
	                                                    var dd = txt1[0];
	                                                    var mm1 = txt1[1];
	                                                    var mm = txt1[1]; //getMonthNo(mm1);
	                                                    var yy = txt1[2];
	                                                    caldate[cali] = dd;
	                                                    caldatemonth[cali] = mm;
	                                                    caldateyear[cali] = yy;
	                                                    cali = parseInt(cali, 10) + 1;
	                                                }
	                                                else if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
	                                                    var txt = strtext;
	                                                    var txt1 = txt.split("/");
	                                                    var dd = txt1[1];
	                                                    var mm1 = txt1[0];
	                                                    var mm = txt1[0]; //getMonthNo(mm1);
	                                                    var yy = txt1[2];
	                                                    caldate[cali] = dd;
	                                                    caldatemonth[cali] = mm;
	                                                    caldateyear[cali] = yy;
	                                                    cali = parseInt(cali, 10) + 1;
	                                                }
	                                                else if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
	                                                    var txt = strtext;
	                                                    var txt1 = txt.split("/");
	                                                    var dd = txt1[2];
	                                                    var mm1 = txt1[1];
	                                                    var mm = txt1[1]; //getMonthNo(mm1);
	                                                    var yy = txt1[0];
	                                                    caldate[cali] = dd;
	                                                    caldatemonth[cali] = mm;
	                                                    caldateyear[cali] = yy;
	                                                    cali = parseInt(cali, 10) + 1;
	                                                }
	                                            }
	                                            document.getElementById(id).value = strtext;
	                                            if (vvalue != strtext) {
	                                                //alert(vvalue + " Date is no issue date of edition " + pkgname);
	                                                document.getElementById(id).value = "";
	                                                cali = cali - 1;
	                                            }
	                                        }
	                                    }
	                                }
	                            }
	                            temp = parseInt(temp) + 1;
	                        }
	                        checkflag = 1;
	                    }
	                    else {

	                        for (i = count; i < gridtab_vari.getElementsByTagName("tbody")[0].rows.length - 1; i++) {

	                            var height = "hei" + i;
	                            var late = "lat" + i;
	                            var repeat = "rep" + i;
	                            var page = "pagpos" + i;
	                            var pagstr = "sec";
	                            var adcat = "adcat" + i;
	                            var adsubcat = "ads" + i;
	                            var premid = "prem" + i;
	                            var id = "Text" + i;
	                            var width = "wid" + i;
	                            var noofcol = "nocol" + i;
	                            inserts = "ins" + i;
	                            var paid = "pai" + i;
	                            var disc = "disc_" + i;
	                            var dateday = "";
	                            var insertval = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(i, 10) + 1].cells[1].innerHTML;
	                            var height_vari = document.getElementById(height);
	                            //var par1 = (height_vari.parentNode).parentNode;
	                            
	                            if (repeatdate == "0" || repeatdate == "1") {
	                                var id = "Text" + temp;
	                                if (document.getElementById('Text' + temp) == null)
	                                    return false;
	                                //  if(caldatemonth[temp]!=null)
	                                //var mmM=caldatemonth[temp].toString();
	                                //else{
	                                var mmM = parseInt(monthSelected, 10) + 1;
	                                mmM = mmM.toString();
	                                //}
	                                if (mmM.toString().length == 1)
	                                    mmM = "0" + mmM.toString();
	                                if (dateSelected.toString().length == 1)
	                                    dateSelected = "0" + dateSelected.toString();
	                                if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
	                                    vvalue = mmM + "/" + dateSelected + "/" + yearSelected;
	                                }
	                                else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
	                                    vvalue = dateSelected + "/" + mmM + "/" + yearSelected; ;
	                                }
	                                else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
	                                    vvalue = yearSelected + "/" + mmM + "/" + dateSelected; ;
	                                }

	                                if (document.getElementById('Text' + i) != null && document.getElementById('Text' + i).value != "" && checkflag == "2") {
	                                    vvalue = document.getElementById('Text' + i).value;

	                                }
	                                if (dateSelected != undefined && dateSelected!="") {
	                                    if (browser != "Microsoft Internet Explorer") {
	                                        var pkgfullname = document.getElementById('pkg_alias' + i).value;
	                                        var pkgid = document.getElementById('hiddenpckcode' + i).value;
	                                        var pkgname = document.getElementById('pkg_alias' + i).value;
	                                        var compcode = document.getElementById('hiddencompcode').value;

	                                        dateday = vvalue;

	                                        document.getElementById('Text' + i).value = vvalue;
	                                    }
	                                    else {
	                                        
	                                    }
	                                    if (browser != "Microsoft Internet Explorer") {
	                                        var httpRequest = null; ;
	                                        httpRequest = new XMLHttpRequest();
	                                        if (httpRequest.overrideMimeType) {
	                                            httpRequest.overrideMimeType('text/xml');
	                                        }

	                                        httpRequest.onreadystatechange = function() { alertContents(httpRequest) };
	                                        var adcat = adcat_vari.value;
	                                        httpRequest.open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
	                                        httpRequest.send('');
	                                        //alert(httpRequest.readyState);
	                                        if (httpRequest.readyState == 4) {
	                                            //alert(httpRequest.status);
	                                            if (httpRequest.status == 200) {
	                                                strtext = httpRequest.responseText;
	                                            }
	                                            else {
	                                                alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
	                                            }
	                                        }
	                                    }
	                                    else {
	                                        validuse = "";
	                                        var xml = new ActiveXObject("Microsoft.XMLHTTP");
	                                        var adcat = adcat_vari;
	                                        var center = '';
	                                        if (center_vari != null) {
	                                            center = center_vari.value;
	                                            if (chkall_vari != null) {
	                                                if (chkall_vari.checked == true) {
	                                                    center = '0';
	                                                }
	                                            }
	                                            else {
	                                                center = '0';
	                                            }
	                                        }
	                                        xml.Open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
	                                        xml.Send();
	                                        strtext = xml.responseText;
	                                    }
	                                    if (strtext == "NOT A VALID DATE") {
	                                        alert("NOT A VALID DATE");
	                                        document.getElementById(id).value = "";
	                                        document.getElementById(id).focus();
	                                        // return false;
	                                    }
	                                    if (strtext == "0") {
	                                        alert("Day is not the publishing day");
	                                        document.getElementById(id).value = "";
	                                        // return false;
	                                    }
	                                    else {
	                                        if (strtext == "1")
	                                            document.getElementById(id).value = vvalue;
	                                        else {
	                                            if (strtext != "") {
	                                                if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
	                                                    var txt = strtext;
	                                                    var txt1 = txt.split("/");
	                                                    var dd = txt1[0];
	                                                    var mm1 = txt1[1];
	                                                    var mm = txt1[1]; //getMonthNo(mm1);
	                                                    var yy = txt1[2];
	                                                    caldate[cali] = dd;
	                                                    caldatemonth[cali] = mm;
	                                                    caldateyear[cali] = yy;
	                                                    cali = parseInt(cali, 10) + 1;
	                                                }
	                                                else if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
	                                                    var txt = strtext;
	                                                    var txt1 = txt.split("/");
	                                                    var dd = txt1[1];
	                                                    var mm1 = txt1[0];
	                                                    var mm = txt1[0]; //getMonthNo(mm1);
	                                                    var yy = txt1[2];
	                                                    caldate[cali] = dd;
	                                                    caldatemonth[cali] = mm;
	                                                    caldateyear[cali] = yy;
	                                                    cali = parseInt(cali, 10) + 1;
	                                                }
	                                                else if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
	                                                    var txt = strtext;
	                                                    var txt1 = txt.split("/");
	                                                    var dd = txt1[2];
	                                                    var mm1 = txt1[1];
	                                                    var mm = txt1[1]; //getMonthNo(mm1);
	                                                    var yy = txt1[0];
	                                                    caldate[cali] = dd;
	                                                    caldatemonth[cali] = mm;
	                                                    caldateyear[cali] = yy;
	                                                    cali = parseInt(cali, 10) + 1;
	                                                }
	                                            }
	                                            document.getElementById(id).value = strtext;
	                                            if (vvalue != strtext) {
	                                                //alert(vvalue + " Date is no issue date of edition " + pkgname);
	                                                document.getElementById(id).value = "";
	                                                cali = cali - 1;
	                                            }
	                                        }
	                                    }
	                                }
	                            }
	                            temp = parseInt(temp) + 1;
	                        }
	                        checkflag = 1;
	                    }
	                    checkflag = "0";
	                    previnsertion = document.getElementById('txtinsertion').value;
	                    fillcopyfilename();
	                    constructCalendar();
	                    noissueflag = false;
	                    return false;
	                }


	                function fillcopyfilename() {
	                    //logonam="lnam"+i

	                    if (document.getElementById("fil0") != null && document.getElementById("fil0").value != "") {
	                        count = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
	                        itemlinecnt = parseInt(count) / parseInt(document.getElementById('txtinsertion').value);
	                        count = count - itemlinecnt;
	                        filid = itemlinecnt;
	                        var filemidid = 2;
	                        //var filelastid=parseInt(itemlinecnt)+1;
	                        var tCount = 0;
	                        var counterT = 0;
	                        var ins_vari = document.getElementById('ins' + counterT);
	                        if (ins_vari != null) {
	                            while (parseInt(ins_vari.innerHTML) == "1") {
	                                tCount = parseInt(tCount) + 1;
	                                counterT = parseInt(counterT) + 1;
	                                ins_vari = document.getElementById('ins' + counterT);
	                                if (ins_vari == null)
	                                    break;
	                            }
	                        }
	                        gridItemCount = tCount;  //get gridcount
	                        itemlinecnt = gridItemCount;

	                        for (var i = 1; i <= count; i = i + itemlinecnt) {
	                            for (var j = 0; j < itemlinecnt; j++) {
	                                if (document.getElementById("fil" + filid).value == "") {
	                                    //var arrfile=document.getElementById("fil"+j).value.split('-');
	                                    //                        if(arrfile.length>2)
	                                    //                        {
	                                    //                            var cioid=arrfile[0];
	                                    //                            var filenamenew=arrfile[0];
	                                    //                            filenamenew+="-"+filemidid;
	                                    //                            var filelastid=filid+1;
	                                    //                            filenamenew+="-"+filelastid+".xtg";
	                                    //                            document.getElementById("fil"+filid).value=filenamenew;
	                                    //                            
	                                    //                           
	                                    //                           
	                                    ////                            var xml = new ActiveXObject("Microsoft.XMLHTTP");
	                                    ////                           xml.Open( "GET","copyMatter.aspx?filename="+document.getElementById("fil"+j).value+"&copyfilename="+filenamenew+"&cioid="+cioid, false );
	                                    ////                           xml.Send();
	                                    ////                           strtext=xml.responseText;
	                                    //                        }
	                                    //                        else
	                                    //                        {
	                                    //alert(document.getElementById("fil"+filid).value)
	                                    document.getElementById("fil" + filid).value = document.getElementById("fil" + j).value;

	                                    //  }

	                                }
	                                filid = filid + 1;
	                            }
	                            filemidid = filemidid + 1;
	                        }

	                    }


	                }


	                function gettotalsize(h, w, id, ins, insval, c) {

	                    document.getElementById('txtgrossamt').value = "";
	                    document.getElementById('txtgrossamtlocal').value = "";
	                    document.getElementById('txtbillamtlocal').value = "";
	                    var cardid = "card" + id;

	                    //    if(document.getElementById(cardid).value=="")
	                    //    {
	                    //        alert("Please get the card rate in the insertion grid");
	                    //        changedivrate();
	                    //        document.getElementById('btnshgrid').focus();
	                    //        return false;
	                    //    }

	                    //h=h.id;

	                    if (document.getElementById(h).value == "") {
	                        alert("Please Enter the height");
	                        document.getElementById(h).focus();
	                        return false;
	                    }

	                    // w=w.id;
	                    // c=c.id;

	                    var height = document.getElementById(h).value;
	                    var width = document.getElementById(w).value;
	                    var column = document.getElementById(c).value;
	                    var res = chkamountgrid(h);
	                    if (res == false)
	                        return false;
	                    if (width != "") {
	                        var res = chkamountgrid(w);
	                        if (res == false)
	                            return false;
	                    }
	                    if (column != "") {
	                        var res = chkamountgrid(c);
	                        if (res == false)
	                            return false;
	                    }
	                    var size = "siz" + id;
	                    var filename = "fil" + id;
	                    if (document.getElementById(filename) != null)
	                        document.getElementById(filename).value = "";
	                    //    if ((column == "" || column == "NaN") && (width != "")) {
	                    //        document.getElementById(size).value = formatDecimal(parseFloat(height) * parseFloat(width), true, 2);
	                    //    }
	                    //    else {
	                    //        if (column != "")
	                    //            document.getElementById(size).value = formatDecimal(parseFloat(height) * parseFloat(column), true, 2);
	                    //    }


	                    //new change anuj



	                    var objpack = document.getElementById('drppackagecopy');
	                    var temp = "";
	                    var tempcode = "";
	                    var tempval = "";
	                    var tempvalcode = "";
	                    var desc = "";
	                    var code = "";
	                    var codesplit = "";
	                    var i = objpack.options.length;
	                    var j;



	                    for (j = 0; j < i; j++) {
	                        if (parseInt(i) > 0) {
	                            tempval = objpack[j].value;
	                            //tempvalcode=objpack[j].value;
	                            if (temp != "") {
	                                temp = tempval.split("@");
	                                tempvalcode = temp[0];
	                                tempcode = temp[1];
	                                desc = tempcode + "+" + desc;
	                                desc = tempcode.substr(0, tempcode.lastIndexOf("(")) + "+" + desc;

	                            }
	                            else {
	                                temp = tempval.split("@");
	                                tempvalcode = temp[0];
	                                tempcode = temp[1];
	                                desc = tempcode;
	                                desc = tempcode.substr(0, tempcode.lastIndexOf("("));
	                            }
	                        }

	                    }
	                    //  document.getElementById('drppageposition').focus();
	                    var aa = Booking_master.getwidthforcoll(desc, document.getElementById(c).value, document.getElementById('hiddencompcode').value);

	                    if ((column == "" || column == "NaN") && (width != "")) {
	                        document.getElementById(size).value = formatDecimal(parseFloat(height) * parseFloat(width), true, 2);



	                        if (aa.value.Tables[0].Rows.length > 0) {
	                            if (aa.value.Tables[0].Rows[0].col_cc != null || aa.value.Tables[0].Rows[0].col_cc != "") {
	                                document.getElementById(w).value = aa.value.Tables[0].Rows[0].col_cc;
	                            }
	                        }
	                    }

	                    else {
	                        if (column != "")
	                            document.getElementById(size).value = formatDecimal(parseFloat(height) * parseFloat(column), true, 2);
	                        if (aa.value.Tables[0].Rows.length > 0) {
	                            if (aa.value.Tables[0].Rows[0].col_cc != null || aa.value.Tables[0].Rows[0].col_cc != "") {
	                                document.getElementById(w).value = aa.value.Tables[0].Rows[0].col_cc;
	                            }
	                        }
	                    }
	                    document.getElementById('txtgrossamt').value = "";
	                    document.getElementById('txtgrossamtlocal').value = "";
	                    document.getElementById('txtbillamtlocal').value = "";
	                    //getgrossamt(w,ins,insval);

	                    //             agreed="agr"+id;
	                    //             gross="gro"+id;
	                    //             totarea="siz"+id;
	                    //             solo="sol"+id;
	                    //                        //var totgross=parseFloat(document.getElementById(totarea).value)*parseFloat(document.getElementById(agreed).value)
	                    //                        //document.getElementById(gross).value=totgross.toFixed(2);
	                    //            if(document.getElementById('txtcardrate').value==document.getElementById('txtagreedrate').value)
	                    //            {
	                    //                 var soagr=document.getElementById(solo).value;
	                    //                      //document.getElementById(gross).value=(parseFloat(agr)*parseFloat(totsiz)).toFixed(2);
	                    //                 var totareawithrate=parseFloat(soagr)*parseFloat(document.getElementById(totarea).value)
	                    //                 var totamt=parseFloat(totareawithrate)+parseFloat(glpre)-parseFloat(glspedisc)-parseFloat(glspadisc)+parseFloat(glspeccharge)
	                    //                 document.getElementById(gross).value=(parseFloat(totamt)).toFixed(2);
	                    //             }
	                    //             else
	                    //             {
	                    //                 var totgross=parseFloat(document.getElementById(totarea).value)*parseFloat(document.getElementById(agreed).value)
	                    //                 document.getElementById(gross).value=totgross.toFixed(2);
	                    //             }
	                    //            var y;
	                    //            var totid;
	                    //            if(noofinsert!="")
	                    //            {                 
	                    //                  y=parseInt(noofinsert)   
	                    //                  totid=parseInt(noofinsert)/parseInt(document.getElementById('txtinsertion').value)
	                    //            }
	                    //            else
	                    //            {
	                    //                y=rowwhenupdate;
	                    //                totid=parseInt(rowwhenupdate)/parseInt(document.getElementById('txtinsertion').value)
	                    //            }
	                    //                
	                    //                 var k;
	                    //                 var adgross
	                    //                 var totgross;   
	                    //                 var paid;
	                    //                 var grossamt="";
	                    //                 for(k=0;k<y;k++)
	                    //                    {
	                    //                         
	                    //                            while(document.getElementById("card"+i)==null && i<y)
	                    //                            {
	                    //                                i=i+totid;
	                    //               
	                    //                            }
	                    //                            
	                    //                               if(i>=y)
	                    //                                 {
	                    //                                 break;
	                    //                                 }
	                    //                            
	                    //                            adgross="gro"+i;
	                    //                            paid="pai"+i;
	                    //                            
	                    //                            totgross=document.getElementById(adgross).value 
	                    //                        if(document.getElementById(paid).value=="Y") 
	                    //                        {
	                    //                            if(grossamt!="")
	                    //                            {
	                    //                            grossamt=parseFloat(totgross)+parseFloat(grossamt);
	                    //                            }
	                    //                            else
	                    //                            {
	                    //                            grossamt=parseFloat(totgross);
	                    //                            }
	                    //                            
	                    //                        }
	                    //                        i=parseInt(i)+1;   
	                    //                    }
	                    //                    if(grossamt!="")
	                    //                 {
	                    //                    document.getElementById('txtgrossamt').value=grossamt.toFixed(2);
	                    //                    var trdisc = document.getElementById('txttradedisc').value;
	                    //                    var trdisc1=trdisc;
	                    //                    addcomm =0;
	                    //                    if(document.getElementById('txtaddagencycommrate')!=null)
	                    //                    {
	                    //                         addcomm=document.getElementById('txtaddagencycommrate').value;
	                    //                    }
	                    //                    if(addcomm=="")
	                    //                    {
	                    //                          addcomm="0";
	                    //                    }
	                    //                    if(addcomm!="0")
	                    //                    {
	                    //                          trdisc1=parseInt(trdisc) + parseInt(addcomm);
	                    //                    }
	                    //                            
	                    //                    document.getElementById('txtbillamt').value=parseFloat(grossamt)-parseFloat(grossamt)*parseFloat(trdisc1)/100;
	                    //                 }
	                    //                 if(document.getElementById('txtgrossamt').value=="NaN")
	                    //                 {
	                    //                    document.getElementById('txtgrossamt').value="";
	                    //                 
	                    //                 }
	                    //                 if(document.getElementById('txtbillamt').value=="NaN")
	                    //                 {
	                    //                    document.getElementById('txtbillamt').value="";                 
	                    //                 }


	                }
    function chkDateforGrid(txtid) {
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        if ((txtid.id.indexOf("Text") == 0 && txtid.id != "") || (document.activeElement.id.indexOf("Text") == 0 && document.activeElement.id.value != "")) {
            document.getElementById('txtgrossamt').value = "";
            document.getElementById('txtbillamt').value = "";
            var validformat = '';
            var dateformat = document.getElementById('hiddendateformat').value;
            var activeID = document.activeElement.id;
            if (activeID == "")
                activeID = txtid.id;
            // var currdate = document.getElementById(activeID).value;
            //==================To enter Date Without "/" ============================//
            var dateInitial = "20";
            var dateenter = document.getElementById(activeID).value;
            if (dateenter != "") {
                if (dateenter.indexOf('/') < 0) {
                    var date12 = "";
                    if (dateformat == "mm/dd/yyyy") {
                        if (dateenter.length >= "8")
                            date12 = dateenter.substring(0, 2) + "/" + dateenter.substring(2, 4) + "/" + dateenter.substring(4, 8);
                        else if (dateenter.length >= "6")
                            date12 = dateenter.substring(0, 2) + "/" + dateenter.substring(2, 4) + "/" + dateInitial + dateenter.substring(4, 6);
                        else
                            date12 = dateenter;
                    }
                    if (dateformat == "yyyy/mm/dd") {
                        if (dateenter.length >= "8")
                            date12 = dateenter.substring(0, 4) + "/" + dateenter.substring(4, 6) + "/" + dateenter.substring(6, 8);
                        else if (dateenter.length >= "6")
                            date12 = dateInitial + dateenter.substring(0, 2) + "/" + dateenter.substring(2, 4) + "/" + dateenter.substring(4, 6);
                        else
                            date12 = dateenter;
                    }
                    if (dateformat == "dd/mm/yyyy") {
                        if (dateenter.length >= "8")
                            date12 = dateenter.substring(0, 2) + "/" + dateenter.substring(2, 4) + "/" + dateenter.substring(4, 8);
                        else if (dateenter.length >= "6")
                            date12 = dateenter.substring(0, 2) + "/" + dateenter.substring(2, 4) + "/" + dateInitial + dateenter.substring(4, 6);
                        else
                            date12 = dateenter;
                    }
                    document.getElementById(activeID).value = date12;
                }
                //==============================================================================//
                if (dateformat == "mm/dd/yyyy") {
                    validformat = /^\d{2}\/\d{2}\/\d{4}$/ //Basic check for format validity
                }
                if (dateformat == "yyyy/mm/dd") {
                    validformat = /^\d{4}\/\d{2}\/\d{2}$/ //Basic check for format validity
                }
                if (dateformat == "dd/mm/yyyy") {
                    validformat = /^\d{2}\/\d{2}\/\d{4}$/ //Basic check for format validity
                }

                //var activeID=document.activeElement.id;
                var currdate = document.getElementById(activeID).value;
                var fromdate = document.getElementById('txtdatetime').value;
                var todate = currdate;
                if (!validformat.test(currdate)) {
                    alert(" Please Fill The Date In " + dateformat + " Format");
                    document.getElementById(activeID).value = "";
                    return false;
                }
                //

                //For From Date Converssion 
                if (dateformat == "dd/mm/yyyy") {
                    if (fromdate != "") {
                        var txt = fromdate;
                        var txt1;
                        if (txt.indexOf("-") >= 0) {
                            txt1 = txt.split("-");
                        }
                        else {
                            txt1 = txt.split("/");
                        }

                        var dd = txt1[0];
                        var mm1 = txt1[1];
                        var mm;
                        if (txt.indexOf("-") >= 0) {
                            mm = getMonthNo(mm1);
                        }
                        else {
                            mm = mm1;
                        }
                        var yy = txt1[2];
                        var dayc = daysInMonth(mm, yy);
                        if (dd > dayc) {
                            alert("InValid Date");
                            document.getElementById(activeID).value = "";
                            return false;
                        }
                        if (mm > 12) {
                            alert("InValid Date");
                            document.getElementById(activeID).value = "";
                            return false;
                        }
                        fromdate = mm + '/' + dd + '/' + yy;
                    }
                    else {
                        fromdate = fromdate;
                    }

                }

                if (dateformat == "yyyy/mm/dd") {
                    if (fromdate != "") {
                        var txt = fromdate;
                        var txt1 = txt.split("/");
                        var yy = txt1[0];
                        var mm = txt1[1];
                        var dd = txt1[2];
                        var dayc = daysInMonth(mm, yy);
                        if (dd > dayc) {
                            alert("InValid Date");
                            document.getElementById(activeID).value = "";
                            return false;
                        }
                        if (mm > 12) {
                            alert("InValid Date");
                            document.getElementById(activeID).value = "";
                            return false;
                        }
                        fromdate = mm + '/' + dd + '/' + yy;
                    }
                    else {
                        fromdate = fromdate;
                    }
                }

                if (dateformat == "mm/dd/yyyy") {
                    fromdate = fromdate;
                }

                //For From Date Converssion /************************************************************/
                if (dateformat == "dd/mm/yyyy") {
                    if (todate != "") {
                        var txt = todate;
                        var txt1 = txt.split("/");
                        var dd = txt1[0];
                        var mm = txt1[1];
                        var yy = txt1[2];
                        var dayc = daysInMonth(mm, yy);
                        if (dd > dayc) {
                            alert("InValid Date");
                            document.getElementById(activeID).value = "";
                            return false;
                        }
                        if (mm > 12) {
                            alert("InValid Date");
                            document.getElementById(activeID).value = "";
                            return false;
                        }
                        todate = mm + '/' + dd + '/' + yy;
                    }
                    else {
                        todate = todate;
                    }

                }

                if (dateformat == "yyyy/mm/dd") {
                    if (todate != "") {
                        var txt = todate;
                        var txt1 = txt.split("/");
                        var yy = txt1[0];
                        var mm = txt1[1];
                        var dd = txt1[2];
                        var dayc = daysInMonth(mm, yy);
                        if (dd > dayc) {
                            alert("InValid Date");
                            document.getElementById(activeID).value = "";
                            return false;
                        }
                        if (mm > 12) {
                            alert("InValid Date");
                            document.getElementById(activeID).value = "";
                            return false;
                        }
                        todate = mm + '/' + dd + '/' + yy;
                    }
                    else {
                        todate = todate;
                    }
                }

                if (dateformat == "mm/dd/yyyy") {
                    todate = todate;
                }
                //



                var fdate = new Date(fromdate);
                fdate.setDate(fdate.getDate() + 1);
                var tdate = new Date(todate);
                if (tdate < fdate && (document.getElementById('hiddenbackdatebook').value == "0" || document.getElementById('hiddenbackdatebook').value == "N")) {
                    // document.getElementById(activeID).value="";
                    alert("Published Date can't Be Less than or equal to Current Date");
                    dummydate = tempdate;
                    document.getElementById(activeID).value = "";
                    document.getElementById(activeID).focus();
                    return false;
                }
                //for backdays check
                var pcompcode = document.getElementById('hiddencompcode').value;
                var pformname = "Classified_Booking"
                var puserid = document.getElementById('hiddenuserid').value
                var pentrydate = document.getElementById(activeID).value
                var pdateformat = document.getElementById('hiddendateformat').value;
                var pextra1 = ""
                var pextra2 = ""
                if (pdateformat == "dd/mm/yyyy") {
                    var tmpdata = pentrydate.split("/")
                    seldt = tmpdata[1] + "/" + tmpdata[0] + "/" + tmpdata[2]
                }
                else if (pdateformat == "yyyy/mm/dd") {
                    var tmpdata = pentrydate.split("/")
                    seldt = tmpdata[1] + "/" + tmpdata[2] + "/" + tmpdata[0]
                }
                var dt = new Date()
                var seldt = new Date(seldt)
                if (dt.toString().substring(0, 10) != seldt.toString().substring(0, 10)) {
                    var ds = web_booking.backdate_validate(pcompcode, pformname, puserid, pentrydate, pdateformat, pextra1, pextra2);
                    if (ds.error != null) {
                        alert(ds.error);
                        return false;
                    }
                    else if (ds.value == 'N') {
                        alert('You can not enter data for this date !!');
                        document.getElementById(activeID).value = "";
                        document.getElementById(activeID).focus();
                        return false;
                    }
                    else {
                    }
                }
                // check valid date for grid item line
                validDate_Grid(activeID);
            }
        }

        //	return false;
    }
    function daysInMonth(iMonth, iYear) {
        iMonth = parseInt(iMonth, 10) - 1;
        return 32 - new Date(iYear, iMonth, 32).getDate();
    }
    function ad_month(date) {
        var tmpdata = date.split("/")
        date = tmpdata[1] + "/" + tmpdata[0] + "/" + tmpdata[2]
        var fdate = new Date(date);
        fdate.setMonth(fdate.getMonth() + 1)
        var fdatenew = new Date(fdate)
        fdatenew.setDate(fdatenew.getDate() - 1);
        return fdatenew.getDate() + "/" + parseFloat(parseFloat(fdatenew.getMonth())+1) + "/" + fdatenew.getFullYear();
//        var currDate = new Date(date);
//        var currDay = currDate.getDate();
//        var currMonth = currDate.getMonth() + 1;
//        var currYear = currDate.getFullYear();
//        currDateStr = currMonth + "/" + currDay + "/" + currYear;
//        var ModMonth = currMonth + 1;
//        if (ModMonth > 12) {
//            ModMonth = 1;
//            currYear = currYear + 1;
//        }

//        ModDateStr = currDay + "/" + ModMonth + "/" + currYear
//        return ModDateStr;
    }
    function bindVtsRate() {

    var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
    var billamttot = 0;
    var gridgrosstot = 0;
    var arrshare;
    var dspub;
    if (sharepub != "") {
        arrshare = sharepub.split("$");
        var packagecode = '';
        var obj = document.getElementById('drppackagecopy');
        for (var x = 0; x < obj.options.length; x++) {

            var insertCount1 = 0;
            if (obj[x].value.indexOf('(') >= 0) {
                insertCount1 = obj[x].value.substring(obj[x].value.lastIndexOf('(') + 1, obj[x].value.length - 1);
                //  insertCount1=parseInt(insertCount1)-1;
            }
            for (x1 = 0; x1 < insertCount1; x1++) {
                if (packagecode == '')
                    packagecode = obj[x].value.substring(0, obj[x].value.lastIndexOf('@'));
                else
                    packagecode = packagecode + ',' + obj[x].value.substring(0, obj[x].value.lastIndexOf('@'));

            }


        }
        var respub = web_booking.getpubcount(document.getElementById('hiddencompcode').value, document.getElementById('txtinsertion').value, packagecode, document.getElementById('txtciobookid').value);
        if (respub.error == null) {
            dspub = respub.value;
        }
    }
    var maingross = document.getElementById('txtgrossamt').value;
    var drpbooktype_vari = document.getElementById('drpbooktype').value;
    for (var i = 0; i < count; i++) {
        var vtsvalue = "";
        var cirvts = "";
        var cirpub = "";
        var ciredi = "";
        var cirrate = "";
        var cirdate = "";
        if (vtsvalue != "") {
            cirvts = vtsvalue.split('ÿ')[0];
            cirpub = vtsvalue.split('ÿ')[1];
            ciredi = vtsvalue.split('ÿ')[2];
            cirrate = vtsvalue.split('ÿ')[3];
            cirdate = vtsvalue.split('ÿ')[4];
        }
        var billrate = document.getElementById("ba" + i);
        var billrate = document.getElementById("ba" + i);
        var grossrate = document.getElementById("gro" + i);
        var pubcode = document.getElementById("pubcode" + i);
        var inssta = document.getElementById("inssta" + i);
        var edition = document.getElementById("edit" + i);
        var vat = document.getElementById("vat" + i);
        var pai_var = document.getElementById("pai" + i);
        var vat_inc = document.getElementById("vat_inc" + i);
        var paicashd = document.getElementById("cashd" + i)
        // FOR SHARING PUBLICATION WISE
        if (arrshare != undefined && arrshare.length > 0) {
            var tCount = 0;
            var counterT = 0;
            var ins_vari = document.getElementById('ins' + counterT);
            if (ins_vari != null) {
                while (parseInt(ins_vari.innerHTML) == "1") {
                    tCount = parseInt(tCount) + 1;
                    counterT = parseInt(counterT) + 1;
                    ins_vari = document.getElementById('ins' + counterT);
                    if (ins_vari == null)
                        break;
                }
            }
            var gridItemCount = tCount;
            for (var ishare = 0; ishare < arrshare.length; ishare++) {
                var strSp = arrshare[ishare].split("~");

                if (strSp[0] == pubcode.value && strSp[1] != "") {
                    ishare = arrshare.length;
                    var div = 1;
                    if (dspub != undefined && dspub != null && dspub.Tables[0].Rows.length > 0) {
                        for (var in1 = 0; in1 < dspub.Tables[0].Rows.length; in1++) {
                            if (dspub.Tables[0].Rows[in1].PUBLICATION == pubcode.value) {
                                div = dspub.Tables[0].Rows[in1].COUNTPUB;
                                if (dspub.Tables[0].Rows.length == 1 && div != "" && document.getElementById('txtpaid').value != "" && parseInt(div) > (parseInt(document.getElementById('txtpaid').value) * parseInt(gridItemCount))) {
                                    var d = parseInt(div) - parseInt(document.getElementById('txtpaid').value);
                                    div = parseInt(div) - parseInt(d);
                                }
                            }
                        }
                    }
                    if (((inssta.value != 'cancel' && inssta.value != 'billed' && inssta.value != 'publish') || document.getElementById('hiddensupplimentflag').value != "") && pai_var.value != "N") {
                        if (strSp[2] == "F") {
                            grossrate.value = parseFloat(strSp[1]) / parseFloat(div);
                        }
                        else {
                            grossrate.value = ((parseFloat(maingross) * parseFloat(strSp[1]) / 100)) / parseFloat(div);
                        }
                        //calculate trade discount
                        var tradisc = document.getElementById('txttradedisc').value;
                        if (document.getElementById('chktrade').checked == false)
                            tradisc = 0;
                        if (tradisc == "")
                            tradisc = 0;
                        var trdisc1 = tradisc;
                        var addcomm = 0;
                        if (document.getElementById('txtaddagencycommrate') != null) {
                            if (document.getElementById('hiddenagcommflag').value != "1")
                                addcomm = document.getElementById('txtaddagencycommrate').value;
                        }
                        if (addcomm == "") {
                            addcomm = "0";
                        }
                        if (addcomm != "0") {
                            trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                        }

                        var billamount = 0;
                        billamount = parseFloat(grossrate.value) - (parseFloat(grossrate.value) * trdisc1 / 100);
                        billrate.value = billamount;
                    }
                }
            }
        }

        var insertsta = document.getElementById("inssta" + i);
        // END
        var ag = web_booking.GETCASH_PAY(document.getElementById('hiddencompcode').value, document.getElementById('drppaymenttype').value);
        var ds_n = ag.value;
        var cashdiscount = 'N';
        if (ds_n != null && ds_n.Tables[0].Rows.length > 0) {
            cashdiscount = ds_n.Tables[0].Rows[0].CASHDISCOUNT;
        }
        if (cirrate != "" && cirvts != "") {

            if (document.getElementById('txtcashdiscount').value != "" && cashdiscount == "Y" && document.getElementById('hiddenagcommflag').value != "1" && parseFloat(parseFloat(document.getElementById('txtagencyoutstand').value) + parseFloat(document.getElementById('txtbillamt').value)) < 0) {
                if (document.getElementById('hiddencashdiscper').value == "F") {
                    billrate.value = parseFloat(billrate.value) - parseFloat(document.getElementById('txtcashdiscount').value);
                    paicashd.value = document.getElementById('txtcashdiscount').value;
                }
                else {
                    paicashd.value = ((parseFloat(billrate.value) * parseFloat(document.getElementById('txtcashdiscount').value)) / 100);
                    billrate.value = parseFloat(billrate.value) - ((parseFloat(billrate.value) * parseFloat(document.getElementById('txtcashdiscount').value)) / 100);
                }
            }
            var paidno = document.getElementById("pai" + i);
            //var insertsta = document.getElementById("inssta" + i);

            if (paidno.value != 'N' && insertsta.value != 'cancel') {
                var total = parseFloat(cirrate) * parseFloat(cirvts);
                if (billrate.value != "") {
                    billrate.value = (parseFloat(billrate.value) + parseFloat(total)).toFixed(2);
                    ///  billamttot = parseFloat(billamttot) + parseFloat(billrate.value);
                }
            }
            else {
                //  billamttot = parseFloat(billamttot) + parseFloat(billrate.value);
            }
        }
        else {
            if (document.getElementById('txtcashdiscount').value != "" && cashdiscount == "Y" && document.getElementById('hiddenagcommflag').value != "1" && parseFloat(parseFloat(document.getElementById('txtagencyoutstand').value) + parseFloat(document.getElementById('txtbillamt').value)) < 0) {
                if (document.getElementById('hiddencashdiscper').value == "F") {
                paicashd.value = document.getElementById('txtcashdiscount').value;
                    billrate.value = parseFloat(billrate.value) - parseFloat(document.getElementById('txtcashdiscount').value);
                }
                else {
                paicashd.value = ((parseFloat(billrate.value) * parseFloat(document.getElementById('txtcashdiscount').value)) / 100);
                    billrate.value = parseFloat(billrate.value) - ((parseFloat(billrate.value) * parseFloat(document.getElementById('txtcashdiscount').value)) / 100);

                }
            }
            //   billamttot = parseFloat(billamttot) + parseFloat(billrate.value);
        }
        // For Calculating VAT Rate
        var vatprec = 0;
        if (vat != null && (vat.value == "" || vat.value == null || vat.value == "null")) {
            var resvat = web_booking.getVTSRate(pubcode.value, edition.value, document.getElementById('hiddencompcode').value);
            if (resvat.error != null) {
                alert(resvat.error.description);
                return false;
            }
            var dsvat = resvat.value;
            if (dsvat != null && dsvat.Tables.length > 0 && dsvat.Tables[0].Rows.length > 0) {
                if (dsvat.Tables[0].Rows[0].VATPREC != null) {
                    vatprec = dsvat.Tables[0].Rows[0].VATPREC;
                    vat.value = vatprec;
                    document.getElementById('hdnvts').value = dsvat.Tables[0].Rows[0].VAT_CODE
                    
                }
            }
        }
        else if (vat != null && vat.value != "" && vat.value != null && vat.value != "null") {
        vatprec = vat.value;
        //document.getElementById('hdnvts').value = vat.value
        }
        if (vatprec != "" && vatprec != 0 && vat_inc.value != "1") {
            if (clientfromconfig != "TH" && insertsta.value != 'billed' && insertsta.value != 'cancel')
                billrate.value = parseFloat(billrate.value) + ((parseFloat(billrate.value) * parseFloat(vatprec)) / 100);
            else {
                var grossamt_V = grossrate.value;
                if (dsvat != null && dsvat.Tables.length > 0 && dsvat.Tables[0].Rows.length > 0) {
                    var finalBR = 0;
                    var addcomm = 0;
                    var vatamt_l = (parseFloat(grossamt_V) * parseFloat(vatprec) / 100);
                    finalBR = parseFloat(grossamt_V) - (parseFloat(grossamt_V) * parseFloat(vatprec) / 100);
                    var tradisc = document.getElementById('txttradedisc').value;
                    if (document.getElementById('chktrade').checked == false)
                        tradisc = 0;
                    if (tradisc == "")
                        tradisc = 0;
                    var trdisc1 = tradisc;
                    finalBR = parseFloat(finalBR) - (parseFloat(finalBR) * parseFloat(trdisc1) / 100);
                    if (document.getElementById('txtaddagencycommrate') != null) {
                        if (document.getElementById('hiddenagcommflag').value != "1")
                            addcomm = document.getElementById('txtaddagencycommrate').value;
                    }
                    if (addcomm == "") {
                        addcomm = "0";
                    }
                    finalBR = parseFloat(finalBR) - (parseFloat(finalBR) * parseFloat(addcomm) / 100);
 if ((insertsta.value != 'billed' || document.getElementById('hiddensupplimentflag').value != "") && insertsta.value != 'cancel')
                    billrate.value = parseFloat(finalBR) + parseFloat(vatamt_l);


                }
            }

        }
        else if (vatprec != "" && vatprec != 0 && vat_inc.value == "1") {
            if (clientfromconfig != "TH" && insertsta.value != 'billed' && insertsta.value != 'cancel') {
                var cal = ((parseFloat(billrate.value) * 100)) / (100 + parseFloat(vatprec));
                var tradisc = document.getElementById('txttradedisc').value;
                if (document.getElementById('chktrade').checked == false)
                    tradisc = 0;
                if (tradisc == "")
                    tradisc = 0;
                var trdisc1 = tradisc;
                var addcomm = 0;
                if (document.getElementById('txtaddagencycommrate') != null) {
                    if (document.getElementById('hiddenagcommflag').value != "1")
                        addcomm = document.getElementById('txtaddagencycommrate').value;
                }
                if (addcomm == "") {
                    addcomm = "0";
                }
                if (addcomm != "0") {
                    trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                }
                // cal=parseFloat(cal) + (parseFloat(cal) * parseFloat(trdisc1)/100);
                grossrate.value = (parseFloat(cal)).toFixed(2);
            }
            else {
                var grossamt_V = grossrate.value;

                if (dsvat != null && dsvat.Tables.length > 0 && dsvat.Tables[0].Rows.length > 0) {
                    var finalBR = 0;
                    var addcomm = 0;
                    var vatamt_l = (parseFloat(grossamt_V) * parseFloat(vatprec) / 100);
                    if ((insertsta.value != 'billed' || document.getElementById('hiddensupplimentflag').value != "") && insertsta.value != 'cancel')
                    grossrate.value = parseFloat(grossrate.value) + parseFloat(vatamt_l);
                    grossamt_V = grossrate.value;
                    var vatamt_2 = (parseFloat(grossamt_V) * parseFloat(vatprec) / 100);
                    finalBR = parseFloat(grossamt_V) - (parseFloat(grossamt_V) * parseFloat(vatprec) / 100);
                    var tradisc = document.getElementById('txttradedisc').value;
                    if (document.getElementById('chktrade').checked == false)
                        tradisc = 0;
                    if (tradisc == "")
                        tradisc = 0;
                    var trdisc1 = tradisc;
                    finalBR = parseFloat(finalBR) - (parseFloat(finalBR) * parseFloat(trdisc1) / 100);
                    if (document.getElementById('txtaddagencycommrate') != null) {
                        if (document.getElementById('hiddenagcommflag').value != "1")
                            addcomm = document.getElementById('txtaddagencycommrate').value;
                    }
                    if (addcomm == "") {
                        addcomm = "0";
                    }
                    finalBR = parseFloat(finalBR) - (parseFloat(finalBR) * parseFloat(addcomm) / 100);
if ((insertsta.value != 'billed' || document.getElementById('hiddensupplimentflag').value != "") && insertsta.value != 'cancel')
                    billrate.value = parseFloat(finalBR) + parseFloat(vatamt_2);


                }
            }
        }
        if (drpbooktype_vari == "2" || drpbooktype_vari == "4" || drpbooktype_vari == "5" || drpbooktype_vari == "6") {
            if (inssta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "")
                billrate.value = 0;
        }
        billamttot = parseFloat(billamttot) + parseFloat(billrate.value);
        gridgrosstot = parseFloat(gridgrosstot) + parseFloat(grossrate.value);
    }
    document.getElementById('txtbillamt').value = (parseFloat(billamttot)).toFixed(2);
    document.getElementById('txtgrossamt').value = (parseFloat(gridgrosstot)).toFixed(2);
}
function getAmount_Currency() {

    if (document.getElementById('drpcurrency').value == document.getElementById('hidcurr').value && document.getElementById('drpcurrency').value == document.getElementById('drprptcurrency').value) {
        document.getElementById('txtgrossamtlocal').value = document.getElementById('txtgrossamt').value;
        document.getElementById('txtbillamtlocal').value = document.getElementById('txtbillamt').value;
        var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
        for (var i = 0; i < count; i++) {
            document.getElementById("grolocal" + i).value = document.getElementById("gro" + i).value;
            document.getElementById("balocal" + i).value = document.getElementById("ba" + i).value;
        }
    }
    else if (document.getElementById('drpcurrency').value == document.getElementById('hidcurr').value && document.getElementById('drpcurrency').value != document.getElementById('drprptcurrency').value) {
        document.getElementById('txtgrossamtlocal').value = document.getElementById('txtgrossamt').value;
        document.getElementById('txtbillamtlocal').value = document.getElementById('txtbillamt').value;
        var datep = document.getElementById('txtdatetime').value;
        var compcode = document.getElementById('hiddencompcode').value;
        var dateformat = document.getElementById('hiddendateformat').value;
        var res = web_booking.CONVERTTOLOCAL_CURRENCY(compcode, document.getElementById('drpcurrency').value, document.getElementById('txtgrossamtlocal').value, document.getElementById('txtbillamtlocal').value, datep, dateformat, document.getElementById('drprptcurrency').value);
        var ds = res.value;
        if (ds == null) {
            alert(res.error.description);
            return false;
        }
        if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0) {
            if (ds.Tables[0].Rows[0].STATUS != null && ds.Tables[0].Rows[0].STATUS == "OK") {
                document.getElementById('txtgrossamtlocal').value = ds.Tables[0].Rows[0].GROSS;
                document.getElementById('txtbillamtlocal').value = ds.Tables[0].Rows[0].BILL;
                document.getElementById('hidcurrency_convrate').value = ds.Tables[0].Rows[0].CONV_RATE;
            }
        }
        var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
        for (var i = 0; i < count; i++) {
            document.getElementById("grolocal" + i).value = document.getElementById("gro" + i).value;
            document.getElementById("balocal" + i).value = document.getElementById("ba" + i).value;
            var gross = document.getElementById('grolocal' + i).value;
            var bill = document.getElementById('balocal' + i).value;
            var res = web_booking.CONVERTTOLOCAL_CURRENCY(compcode, document.getElementById('drpcurrency').value, gross, bill, datep, dateformat, document.getElementById('drprptcurrency').value);
            var ds = res.value;
            if (ds == null) {
                alert(res.error.description);
                return false;
            }
            if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0) {
                if (ds.Tables[0].Rows[0].STATUS != null && ds.Tables[0].Rows[0].STATUS == "OK") {
                    document.getElementById("grolocal" + i).value = ds.Tables[0].Rows[0].GROSS;
                    document.getElementById("balocal" + i).value = ds.Tables[0].Rows[0].BILL;
                }
            }
        }
    }
    else if (document.getElementById('drpcurrency').value != document.getElementById('hidcurr').value && document.getElementById('drpcurrency').value != document.getElementById('drprptcurrency').value) {
        document.getElementById('txtgrossamtlocal').value = document.getElementById('txtgrossamt').value;
        document.getElementById('txtbillamtlocal').value = document.getElementById('txtbillamt').value;
        var datep = document.getElementById('txtdatetime').value;
        var compcode = document.getElementById('hiddencompcode').value;
        var dateformat = document.getElementById('hiddendateformat').value;
        var res = web_booking.CONVERTTOLOCAL_CURRENCY(compcode, document.getElementById('drpcurrency').value, document.getElementById('txtgrossamtlocal').value, document.getElementById('txtbillamtlocal').value, datep, dateformat, document.getElementById('hidcurr').value);
        var ds = res.value;
        if (ds == null) {
            alert(res.error.description);
            return false;
        }
        if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0) {
            if (ds.Tables[0].Rows[0].STATUS != null && ds.Tables[0].Rows[0].STATUS == "OK") {
                document.getElementById('txtgrossamt').value = ds.Tables[0].Rows[0].GROSS;
                document.getElementById('txtbillamt').value = ds.Tables[0].Rows[0].BILL;
                document.getElementById('hidcurrency_convrate').value = ds.Tables[0].Rows[0].CONV_RATE;
            }
        }
        var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
        for (var i = 0; i < count; i++) {
            document.getElementById("grolocal" + i).value = document.getElementById("gro" + i).value;
            document.getElementById("balocal" + i).value = document.getElementById("ba" + i).value;
            var gross = document.getElementById('grolocal' + i).value;
            var bill = document.getElementById('balocal' + i).value;
            var res = web_booking.CONVERTTOLOCAL_CURRENCY(compcode, document.getElementById('drpcurrency').value, gross, bill, datep, dateformat, document.getElementById('hidcurr').value);
            var ds = res.value;
            if (ds == null) {
                alert(res.error.description);
                return false;
            }
            if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0) {
                if (ds.Tables[0].Rows[0].STATUS != null && ds.Tables[0].Rows[0].STATUS == "OK") {
                    document.getElementById("gro" + i).value = ds.Tables[0].Rows[0].GROSS;
                    document.getElementById("ba" + i).value = ds.Tables[0].Rows[0].BILL;
                }
            }
        }
        // again converting rate into receipt currencyfrom local
        if (document.getElementById('hidcurr').value != document.getElementById('drprptcurrency').value) {
            document.getElementById('txtgrossamtlocal').value = document.getElementById('txtgrossamt').value;
            document.getElementById('txtbillamtlocal').value = document.getElementById('txtbillamt').value;
            var datep = document.getElementById('txtdatetime').value;
            var compcode = document.getElementById('hiddencompcode').value;
            var dateformat = document.getElementById('hiddendateformat').value;
            var res = web_booking.CONVERTTOLOCAL_CURRENCY(compcode, document.getElementById('drpcurrency').value, document.getElementById('txtgrossamtlocal').value, document.getElementById('txtbillamtlocal').value, datep, dateformat, document.getElementById('drprptcurrency').value);
            var ds = res.value;
            if (ds == null) {
                alert(res.error.description);
                return false;
            }
            if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0) {
                if (ds.Tables[0].Rows[0].STATUS != null && ds.Tables[0].Rows[0].STATUS == "OK") {
                    document.getElementById('txtgrossamtlocal').value = ds.Tables[0].Rows[0].GROSS;
                    document.getElementById('txtbillamtlocal').value = ds.Tables[0].Rows[0].BILL;
                    document.getElementById('hidcurrency_convrate').value = ds.Tables[0].Rows[0].CONV_RATE;
                }
            }
            var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
            for (var i = 0; i < count; i++) {
                document.getElementById("grolocal" + i).value = document.getElementById("gro" + i).value;
                document.getElementById("balocal" + i).value = document.getElementById("ba" + i).value;
                var gross = document.getElementById('grolocal' + i).value;
                var bill = document.getElementById('balocal' + i).value;
                var res = web_booking.CONVERTTOLOCAL_CURRENCY(compcode, document.getElementById('drpcurrency').value, gross, bill, datep, dateformat, document.getElementById('drprptcurrency').value);
                var ds = res.value;
                if (ds == null) {
                    alert(res.error.description);
                    return false;
                }
                if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0) {
                    if (ds.Tables[0].Rows[0].STATUS != null && ds.Tables[0].Rows[0].STATUS == "OK") {
                        document.getElementById("grolocal" + i).value = ds.Tables[0].Rows[0].GROSS;
                        document.getElementById("balocal" + i).value = ds.Tables[0].Rows[0].BILL;
                    }
                }
            }
        }
    }
    else if (document.getElementById('drpcurrency').value != document.getElementById('hidcurr').value && document.getElementById('drpcurrency').value == document.getElementById('drprptcurrency').value) {
        document.getElementById('txtgrossamtlocal').value = document.getElementById('txtgrossamt').value;
        document.getElementById('txtbillamtlocal').value = document.getElementById('txtbillamt').value;
        var datep = document.getElementById('txtdatetime').value;
        var compcode = document.getElementById('hiddencompcode').value;
        var dateformat = document.getElementById('hiddendateformat').value;
        var res = web_booking.CONVERTTOLOCAL_CURRENCY(compcode, document.getElementById('drpcurrency').value, document.getElementById('txtgrossamtlocal').value, document.getElementById('txtbillamtlocal').value, datep, dateformat, document.getElementById('hidcurr').value);
        var ds = res.value;
        if (ds == null) {
            alert(res.error.description);
            return false;
        }
        if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0) {
            if (ds.Tables[0].Rows[0].STATUS != null && ds.Tables[0].Rows[0].STATUS == "OK") {
                document.getElementById('txtgrossamt').value = ds.Tables[0].Rows[0].GROSS;
                document.getElementById('txtbillamt').value = ds.Tables[0].Rows[0].BILL;
                document.getElementById('hidcurrency_convrate').value = ds.Tables[0].Rows[0].CONV_RATE;
            }
        }
        var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
        for (var i = 0; i < count; i++) {
            document.getElementById("grolocal" + i).value = document.getElementById("gro" + i).value;
            document.getElementById("balocal" + i).value = document.getElementById("ba" + i).value;
            var gross = document.getElementById('grolocal' + i).value;
            var bill = document.getElementById('balocal' + i).value;
            var res = web_booking.CONVERTTOLOCAL_CURRENCY(compcode, document.getElementById('drpcurrency').value, gross, bill, datep, dateformat, document.getElementById('hidcurr').value);
            var ds = res.value;
            if (ds == null) {
                alert(res.error.description);
                return false;
            }
            if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0) {
                if (ds.Tables[0].Rows[0].STATUS != null && ds.Tables[0].Rows[0].STATUS == "OK") {
                    document.getElementById("gro" + i).value = ds.Tables[0].Rows[0].GROSS;
                    document.getElementById("ba" + i).value = ds.Tables[0].Rows[0].BILL;
                }
            }
        }
    }
}
function getspecialdisc(Activid) {
    //if(document.getElementById('txtspedisc').value!="" || document.getElementById('txtspediscper').value!="")
    //{
    //commaremove();
    var totalarea_var;
    if (document.getElementById("txtbillwidth").value != "" && document.getElementById("txtbillheight").value != "") {
        totalarea_var = parseFloat(document.getElementById("txtbillwidth").value) * parseFloat(document.getElementById("txtbillheight").value);
    }
    totalarea_var = document.getElementById('txttotalarea').value;
    br_spcharge = 0;
    var billAmount = 0;
    //var totalarea_var=document.getElementById('txttotalarea');
    var pkg_copy = document.getElementById('drppackagecopy');
    if (document.getElementById('txtagreedrate').value != "" && document.getElementById('txtagreedamt').value != "" && agreedrate_active == 0) {
        document.getElementById('txtspedisc').value = "";
        document.getElementById('txtspediscper').value = "";
        // alert('Special discount can not applied in case of agreed rate.' );
        return false;
    }
    if (document.getElementById('hiddenuomdesc').value != "CD" && document.getElementById('hiddenuomdesc').value != "ROW") {
        document.getElementById('txtspedisc').value = "";
        document.getElementById('txtspediscper').value = "";
        // alert('Special discount can not applied in case of agreed rate.' );
        return false;
    }
    var cardrate = document.getElementById('txtcardrate').value;
    if (agreedrate_active == 1) {
        cardrate = document.getElementById('txtagreedrate').value;
    }
    if (Activid == "txtspedisc" && document.getElementById('txtspedisc').value != "") {
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        document.getElementById('txtbillamt').value = "";
        if (parseFloat(cardrate) < parseFloat(document.getElementById('txtspedisc').value)) {
            // alert('Special discount can not be greated than card rate');
            document.getElementById('txtspedisc').value = "";
            return false;
        }
        spdisc = 1;
        spdiscper = 0;
        document.getElementById('txtspediscper').value = ((parseFloat(document.getElementById('txtspedisc').value) / parseFloat(cardrate)) * 100).toFixed(2);
    }

    if (Activid == "txtspediscper" && document.getElementById('txtspediscper').value != "") {
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        document.getElementById('txtbillamt').value = "";
        if (parseFloat(document.getElementById('txtspediscper').value) > 100) {
            alert('Special discount can not be greated than 100%');
            document.getElementById('txtspediscper').value = "";
            return false;
        }
        spdisc = 0;
        spdiscper = 1;
        document.getElementById('txtspedisc').value = (parseFloat(cardrate) * parseFloat(document.getElementById('txtspediscper').value) / 100).toFixed(2);
    }
    if (document.getElementById('txtspedisc').value != "" && spdisc != 1 && spdiscper != 1) {
        spdisc = 0;
        spdiscper = 1;
    }
    if ((document.getElementById('txtspedisc').value == "" || document.getElementById('txtspediscper').value == "") && document.getElementById('txtgrossamt').value == "") {
        spdisc = 0;
        spdiscper = 0;
        document.getElementById('txtspedisc').value = "";
        document.getElementById('txtspediscper').value = "";
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        document.getElementById('txtbillamt').value = "";
    }
    else {
        if (document.getElementById('txtspedisc').value == "" && document.getElementById('txtspediscper').value != "") {
            document.getElementById('txtspedisc').value = (parseFloat(cardrate) * parseFloat(document.getElementById('txtspediscper').value) / 100).toFixed(2);
        }
        else if (document.getElementById('txtspedisc').value != "" && document.getElementById('txtspediscper').value == "") {
            document.getElementById('txtspediscper').value = ((parseFloat(document.getElementById('txtspedisc').value) / parseFloat(cardrate)) * 100).toFixed(2);
        }
        var paidCount = document.getElementById('txtinsertion').value;
        var finsert = 1;
        var tinsert = 0;
        var br_spcharge = 0;
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txtgrossamtlocal').value = "";
        document.getElementById('txtbillamtlocal').value = "";
        document.getElementById('txtbillamt').value = "";
        if (pkg_copy.options.length > 0) {
            for (var insertCou = 0; insertCou < pkg_copy.options.length; insertCou++) {
                if (pkg_copy.options[insertCou].value.indexOf('(') >= 0) {
                    tinsert = pkg_copy.options[insertCou].value.substring(pkg_copy.options[insertCou].value.indexOf('(') + 1, pkg_copy.options[insertCou].value.indexOf(')'));
                    if (parseInt(tinsert) > parseInt(finsert)) {
                        finsert = tinsert;
                    }
                    paidCount = parseInt(paidCount) * parseInt(tinsert);
                }
            }
        }
        var splcharges = document.getElementById('txtspedisc').value;
        var grossAmt = (parseFloat(cardrate) - parseFloat(splcharges)) * parseInt(paidCount, 10) * parseFloat(document.getElementById('txttotalarea').value);
        if (spdisc == 0 && spdiscper == 0) {
            spdiscper = 1;
        }
        if (spdisc == 1) {
            var len = "bookdiv";
            var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
            for (var s = 0; s < count; s++) {
                splcharges = document.getElementById('txtspedisc').value;
                if (document.getElementById("disc_" + s) != null && document.getElementById("disc_" + s).value != "" && document.getElementById("disc_" + s).value != "0")
                    splcharges = document.getElementById("disc_" + s).value;
                if (splcharges == "")
                    splcharges = 0;
                var gross_var = document.getElementById('gro' + s);
                var bill_var = document.getElementById('ba' + s);
                var insertsta = document.getElementById("inssta" + s);
                var tot1 = document.getElementById("siz" + s);
                var splcharges_grid = (parseFloat(document.getElementById('gro' + s).value) / parseFloat(document.getElementById('txtcardamt').value)) * splcharges;
                if (gross_var != null && document.getElementById("inssta" + s).value != "cancel" && document.getElementById("pai" + s).value != "N") {
                    if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                        document.getElementById("spld" + s).value = (parseFloat(splcharges_grid)).toFixed(2);
                        // gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid)*parseFloat(tot1.value))).toFixed(2);    
                        gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid))).toFixed(4);
                    }
                    //  bill_var.value = (parseFloat(bill_var.value) - (parseFloat(splcharges_grid)*parseFloat(totalarea_var))).toFixed(2);                      
                    // trade disc
                    var tradisc = document.getElementById('txttradedisc').value;
                    if (document.getElementById('chktrade').checked == false)
                        tradisc = 0;
                    if (tradisc == "")
                        tradisc = 0;
                    var trdisc1 = tradisc;
                    var addcomm = 0;
                    if (document.getElementById('txtaddagencycommrate') != null) {
                        if (document.getElementById('hiddenagcommflag').value != "1")
                            addcomm = document.getElementById('txtaddagencycommrate').value;
                    }
                    if (addcomm == "") {
                        addcomm = "0";
                    }
                    if (addcomm != "0") {
                        trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                    }
                    if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                        if (document.getElementById('agncomm_seq_com').value != "S")
                            bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);
                        else {
                            bill_var.value = parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(tradisc) / 100);
                            if (addcomm != "0" && addcomm != "") {
                                bill_var.value = parseFloat(bill_var.value) - (parseFloat(bill_var.value) * parseFloat(addcomm) / 100);
                            }
                        }
                        if (document.getElementById('drpbooktype').value == "2" || document.getElementById('drpbooktype').value == "6" || document.getElementById('drpbooktype').value == "4" || document.getElementById('drpbooktype').value == "5") {
                            bill_var.value = "0";
                        }
                    }
                    br_spcharge = (parseFloat(br_spcharge) + parseFloat(gross_var.value)).toFixed(2);
                    billAmount = (parseFloat(billAmount) + parseFloat(bill_var.value)).toFixed(2);
                }
            }
        }


        if (spdiscper == 1) {
            //  var br_spcharge=0;
            var splcharges = document.getElementById('txtspediscper').value;
            var grossAmt = document.getElementById('txtgrossamt').value;
            var len = "bookdiv";
            var ratio = 0;
            var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
            for (var s = 0; s < count; s++) {
                splcharges = document.getElementById('txtspediscper').value;
                if (document.getElementById("disc_" + s) != null && document.getElementById("disc_" + s).value != "" && document.getElementById("disc_" + s).value != "0")
                    splcharges = document.getElementById("disc_" + s).value;
                if (splcharges == "")
                    splcharges = 0;
                var gross_var = document.getElementById('gro' + s);
                var bill_var = document.getElementById('ba' + s);
                var tot1 = document.getElementById("siz" + s);
                var insertsta = document.getElementById("inssta" + s);
                if (gross_var != null && document.getElementById("inssta" + s).value != "cancel") {
                    //                    if(s==count-1)
                    //                    {
                    //                        document.getElementById('gro'+s).value = (parseFloat(document.getElementById('gro'+s).value) - ((parseFloat(splcharges)*parseFloat(cardrate)/100)-parseFloat(br_spcharge))).toFixed(2);
                    //                    }
                    //                    else
                    //                    {
                    //                       ratio = (parseFloat(document.getElementById('gro'+s).value) * (parseFloat(splcharges)*parseFloat(cardrate)*parseFloat(document.getElementById('txttotalarea').value)/100) / parseFloat(grossAmt))
                    if (agreedrate_active == 1 && document.getElementById('hiddenuomdesc').value == "CD") {
                        var t = parseFloat(document.getElementById('txtagreedrate').value) / parseFloat(document.getElementById('txtcardrate').value);
                        t = parseFloat(t) * parseFloat(document.getElementById('card' + s).value);
                        var splcharges_grid = (parseFloat(t) * splcharges) / 100;
                    }
                    else
                        var splcharges_grid = (parseFloat(document.getElementById('gro' + s).value) * splcharges) / 100;
                    if (gross_var != null && document.getElementById("inssta" + s).value != "cancel" && document.getElementById("pai" + s).value != "N") {
                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                            document.getElementById("spld" + s).value = (parseFloat(splcharges_grid)).toFixed(2);
                            gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid))).toFixed(4);
                        }
                        // gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid)*parseFloat(tot1.value))).toFixed(2);
                        //bill_var.value = (parseFloat(bill_var.value) - (parseFloat(splcharges_grid)*parseFloat(totalarea_var))).toFixed(2);
                        // trade disc
                        var tradisc = document.getElementById('txttradedisc').value;
                        if (document.getElementById('chktrade').checked == false)
                            tradisc = 0;
                        if (tradisc == "")
                            tradisc = 0;
                        var trdisc1 = tradisc;
                        var addcomm = 0;
                        if (document.getElementById('txtaddagencycommrate') != null) {
                            if (document.getElementById('hiddenagcommflag').value != "1")
                                addcomm = document.getElementById('txtaddagencycommrate').value;
                        }
                        if (addcomm == "") {
                            addcomm = "0";
                        }
                        if (addcomm != "0") {
                            trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                        }
                        if (insertsta.value != "billed" || document.getElementById('hiddensupplimentflag').value != "") {
                            if (document.getElementById('agncomm_seq_com').value != "S")
                                bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);
                            else {
                                bill_var.value = parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(tradisc) / 100);
                                if (addcomm != "0" && addcomm != "") {
                                    bill_var.value = parseFloat(bill_var.value) - (parseFloat(bill_var.value) * parseFloat(addcomm) / 100);
                                }
                            }
                            if (document.getElementById('drpbooktype').value == "2" || document.getElementById('drpbooktype').value == "6" || document.getElementById('drpbooktype').value == "4" || document.getElementById('drpbooktype').value == "5") {
                                bill_var.value = "0";
                            }
                        }
                        br_spcharge = (parseFloat(br_spcharge) + parseFloat(gross_var.value)).toFixed(2);
                        billAmount = (parseFloat(billAmount) + parseFloat(bill_var.value)).toFixed(2);
                    }
                    //                    }  
                }
            }
        }
        if (br_spcharge == 0) {
            if (grossAmt == "")
                grossAmt = 0;
            br_spcharge = grossAmt;
        }
        document.getElementById('txtgrossamt').value = parseFloat(br_spcharge);
        if (Activid == "txtspedisc" || Activid == "txtspediscper")
            document.getElementById('txtgrossamt').value = "";
        if (billAmount != 0)
            document.getElementById('txtbillamt').value = parseFloat(billAmount).toFixed(2);
        if (br_spcharge == 0)
            document.getElementById('txtbillamt').value = parseFloat(billAmount).toFixed(2);
    }

    if (document.getElementById('txtspediscper').value != "") {
        var spacedisc = document.getElementById('txtspediscper').value;

        //var splamnt;
        //var cashamnt;
        //        if ((document.getElementById('txtspediscper').value != "") && document.getElementById('txtgrossamt').value != "" && parseFloat(spacedisc) > parseFloat(document.getElementById('hiddenuserdisc').value)) {
        //            for (var j = 0; j < document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1; j++) {

        //                document.getElementById("spld" + j).value = (parseFloat(document.getElementById('card' + j).value) * parseFloat(document.getElementById('txtspediscper').value) / 100).toFixed(2);

        //                document.getElementById("cashd" + j).value = "0";
        //            }
        //        }

        if (document.getElementById('hiddenuserdisc').value != "" && document.getElementById('hiddenuserdisc').value != "0") {
            if (parseFloat(spacedisc) > parseFloat(document.getElementById('hiddenuserdisc').value)) {
                alert("User Allowed Commission can't be greater than " + document.getElementById('hiddenuserdisc').value);
                document.getElementById('txtspediscper').value = "";
                document.getElementById('txtspedisc').value = "";
                document.getElementById('txtgrossamt').value = "";
                document.getElementById('txtgrossamtlocal').value = "";
                document.getElementById('txtbillamtlocal').value = "";
                return false;
            }
        }

    }
    else {
        var len = "bookdiv";
        var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
        for (var s = 0; s < count; s++) {
            var insertsta = document.getElementById("inssta" + s);
            if (insertsta.value != "billed") {
                document.getElementById("spld" + s).value = "";
            }
        }
    }
    //}
}
