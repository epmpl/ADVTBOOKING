// JScript File
var jq = jQuery.noConflict();
var getcityornot=""
var selbitocity="";
var biltovar="";
var varbiltocal="";
var datares;
var cityselected;
var str;
//static var z=0;
//static var z=0;
var z=0;
var datemonth;
var show="0";
var cityvar;
var hiddentext;
// this variable is used foe storing value of autogenerated for session
var auto="";

//agencode

function chklimit()
{
if(document.getElementById('txtcredit').value!="")
{
        var limit=document.getElementById('txtcredit').value;
        var i=parseFloat(limit)
        //alert(i);
        if(i>=0 && i<=365)
        {
        return true
        }
        else
        {
        alert("Credit Days cannot exceed 365 days ");
        document.getElementById('txtcredit').value="";
        document.getElementById('txtcredit').focus();
        return false;
        }
}
return false;
}


var browser=navigator.appName;

var xmlDoc=null;
var xmlObj=null;
var req=null;





function loadXML(xmlFile) 
{
    var  httpRequest =null;
    
    if(browser!="Microsoft Internet Explorer")
    { 
        
        req = new XMLHttpRequest();
        //alert(req);
        req.onreadystatechange = getMessage;
        req.open("GET",xmlFile, true);
        req.send('');
        
    }
    else
    {
        xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
        xmlDoc.async="false"; 
        xmlDoc.onreadystatechange=verify; 
        xmlDoc.load(xmlFile); 
        xmlObj=xmlDoc.documentElement; 
        // alert(xmlObj.childNodes(0).childNodes(0).text);
    }

}

function getMessage()
{
    var response="";
    if(req.readyState == 4)
        {
            if(req.status == 200)
            {
                response = req.responseText;
                //alert(response);
            }
        }
        
        var parser=new DOMParser();
        //alert(xmlFile + "  Test"); 
        //xmlDoc.load(xmlFile);
        xmlDoc=parser.parseFromString(response,"text/xml"); 
        xmlObj=xmlDoc.documentElement;
        //debugger;
        //alert(xmlObj);  
        //alert(xmlObj.childNodes[1].childNodes[5].childNodes[0].nodeValue);
}



function verify() 
{ 
 // 0 Object is not initialized 
 // 1 Loading object is loading data 
 // 2 Loaded object has loaded data 
 // 3 Data from object can be worked with 
 // 4 Object completely initialized 
 if (xmlDoc.readyState != 4) 
 { 
   return false; 
 } 
}

//save click for save value in agency master
function saveclick()
{
var browser=navigator.appName;
    document.getElementById('hiddensaurabh').value="0";
     auto=document.getElementById('hiddenauto').value;

  show="1";


  if (document.getElementById('hiddenmrv').value == "Y") {
      if (document.getElementById('txtmryrefno').value == "") {
          mrvrefno();

          // document.getElementById('drpparent').focus();
          return false;
      }
  }
            
            
  
            if(document.getElementById('drpparent').value=="0")
            {
            f13();
            document.getElementById('drpparent').focus();
            return false;
            }
            if(document.getElementById('drpparent').value=="E")
            {
            if(document.getElementById('txtsubsubagcd').value=="0")
            {
            extracd();
            document.getElementById('txtsubsubagcd').focus();
            return false;
            }
            }
            var chmandatrg="";
            if(browser!="Microsoft Internet Explorer")
            {
                chmandatrg=document.getElementById('rategroup').textContent;
            }
            else
            {        
                chmandatrg=document.getElementById('rategroup').innerText;
            }
            if(chmandatrg.indexOf('*')>= 0)
            {
                if(document.getElementById('drprate').value=="0")
                {
                frgc();
                document.getElementById('drprate').focus();
                return false;
                }
            }
            var chmandat="";
            if(browser!="Microsoft Internet Explorer")
            {
                chmandat=document.getElementById('lblbranch').textContent;
            }
            else
            {        
                chmandat=document.getElementById('lblbranch').innerText;
            }
            if(chmandat.indexOf('*')>= 0)
            {
                if(document.getElementById('drpbranch').value=="0")
                {
                f15();
                document.getElementById('drpbranch').focus();
                return false;
                }
            }
            var chmandat1="";
            if(browser!="Microsoft Internet Explorer")
            {
                chmandat1=document.getElementById('rategroup').textContent;
            }
            else
            {        
                chmandat1=document.getElementById('rategroup').innerText;
            }
            if(chmandat1.indexOf('*')>= 0)
            {
                if(document.getElementById('drprate').value=="0" || document.getElementById('drprate').value=="")
                {
                RateGroupalert();
                document.getElementById('drprate').focus();
                return false;
                }
            }
            else if (MenditoryField() == false) {
                return false;
            }

           /* if (document.getElementById('drpgstatus').value == "Y") {
                var chmandat1 = "";
                if (browser != "Microsoft Internet Explorer") {
                    chmandat1 = document.getElementById('lblgstclty').textContent;
                }
                else {
                    chmandat1 = document.getElementById('lblgstclty').innerText;
                }
                if (chmandat1.indexOf('*') >= 0) {
                    if (document.getElementById('txtgstclty').value == "0" || document.getElementById('drprate').value == "") {
                        alert("Please enter the Gst Client Type");
                        document.getElementById('txtgstclty').focus();
                        return false;
                    }
                }


                var chmandat1 = "";
                if (browser != "Microsoft Internet Explorer") {
                    chmandat1 = document.getElementById('lblgstus').textContent;
                }
                else {
                    chmandat1 = document.getElementById('lblgstus').innerText;
                }
                if (chmandat1.indexOf('*') >= 0) {
                    if (document.getElementById('drpgstus').value == "0" || document.getElementById('drpgstus').value == "") {
                        alert("Please enter the Gst Status ");
                        document.getElementById('drpgstus').focus();
                        return false;
                    }
                }


                var chmandat1 = "";
                if (browser != "Microsoft Internet Explorer") {
                    chmandat1 = document.getElementById('lblgstdt').textContent;
                }
                else {
                    chmandat1 = document.getElementById('lblgstdt').innerText;
                }
                if (chmandat1.indexOf('*') >= 0) {
                    if (document.getElementById('txtgstdt').value == "0" || document.getElementById('txtgstdt').value == "") {
                        alert("Please enter the Gst Registration Date");
                        document.getElementById('txtgstdt').focus();
                        return false;
                    }
                }



                var chmandat1 = "";
                if (browser != "Microsoft Internet Explorer") {
                    chmandat1 = document.getElementById('lblgst').textContent;
                }
                else {
                    chmandat1 = document.getElementById('lblgst').innerText;
                }
                if (chmandat1.indexOf('*') >= 0) {
                    if (document.getElementById('txtgstin').value == "0" || document.getElementById('txtgstin').value == "") {
                        alert("Please enter the Gst Registration");
                        document.getElementById('txtgstin').focus();
                        return false;
                    }
                }
            }*/
           

            //LTrim(RTrim(value));
            var ss =LTrim(RTrim(document.getElementById('txtagenname').value));
            if(ss =="")
            {
            f12();
//            alert("Please Enter the Agency Name");
            document.getElementById('txtagenname').value="";
            document.getElementById('txtalias').value = "";
            document.getElementById('txtdesg').value = "";
            
            
            document.getElementById('txtagenname').focus();
            return(false);
            }
            if(document.getElementById('drpagetyp').value == "0")
            {
            f11();
//            alert("Please enter the Agency Type.");
          //  document.getElementById('drpagetyp').disabled=false;
            document.getElementById('drpagetyp').focus();
            return(false);
        }

    
            var chmandat;


if(browser!="Microsoft Internet Explorer")
{
chmandat=document.getElementById('AgencyCategory').textContent;
}
else
{
chmandat=document.getElementById('AgencyCategory').innerText;
}
if(chmandat.indexOf('*')>= 0)
{

             if(document.getElementById('lab').style.display =="block" && document.getElementById('txt').style.display =="block" && document.getElementById('txt1').style.display=="block")
            {

            if(document.getElementById('drpagecate').value == "0")
            {
            f10();
//            alert("Please enter the Agency Category.");
           // document.getElementById('drpagecate').focus();
            return(false);
            }
}


            else if(document.getElementById('drpagecate').value != "0" &&document.getElementById('drpagescat').value == "0")
            {
//            f9();
////            alert("Please enter the Agent Sub Category.");
//            document.getElementById('drpagescat').focus();
//            return(false);
            }
}
        
        var ss =LTrim(RTrim(document.getElementById('txtalias').value));
            if(ss =="")
            {
            f8();
//            alert("Please Enter the Alias");
            document.getElementById('txtalias').focus();
            return(false);
            }
            else if(document.getElementById('txtcountry').value =="0")
            {
            fco();
//            alert("Please Select The Country");
            document.getElementById('txtcountry').focus();
            return(false);
            }
            else if(document.getElementById('drpcity').value =="0")
            {
            f6();            
//            alert("Please Select The City");
            document.getElementById('drpcity').focus();
            return(false);
            }
            else if(document.getElementById('drpregion').value =="0" || document.getElementById('drpregion').value =="" || document.getElementById('drpregion').value ==null)
            {
            regalert();            
//            alert("Please Select The City");
            document.getElementById('drpregion').focus();
            return(false);
            }
            if(browser!="Microsoft Internet Explorer")
            {
                chmandat=document.getElementById('lbltaluka').textContent;
            }
            else
            {        
                chmandat=document.getElementById('lbltaluka').innerText;
            }
            if(chmandat.indexOf('*')>= 0)
            {
                 if(document.getElementById('drptaluka').value =="0" || document.getElementById('drptaluka').value =="" || document.getElementById('drptaluka').value ==null)
                {   
                    ftal();      
                    //alert("Please Enter Taluka");
                document.getElementById('drptaluka').focus();
                return(false);
                }
            }
           if(document.getElementById('drpzone').value =="0" || document.getElementById('drpzone').value =="" || document.getElementById('drpzone').value ==null)
            {   
                fzone();      
//                alert("Please Enter Zone");
            document.getElementById('drpzone').focus();
            return(false);
            }
            if(document.getElementById('txtsagencycode').value=="")
            {
            fbh();
//            alert("Please Enter Type ");
            //document.getElementById('drpparent').focus();
            return false;
            }
            //dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
            alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 

var msg=checkEmail();
if(msg==false)
    return false;
document.getElementById('txtstatus').style.visibility="hidden";
document.getElementById('txtstatusdate').style.visibility="hidden";
document.getElementById('Status').style.visibility="hidden";
document.getElementById('StatusDate').style.visibility="hidden";

var compcode=document.getElementById('hiddencompcode').value;
var userid=document.getElementById('hiddenuserid').value;
//varun
var type=document.getElementById('drpparent').value;
	
	if(hiddentext=="modify" )
	{
			
			var txtagencode1=document.getElementById('txtagencode').value;
	        var branchcode=document.getElementById('drpbranch').value;
			var drpagecate1=document.getElementById('drpagecate').value;
			var dateformat=document.getElementById('hiddendateformat').value;
			var txtsagencycode1=document.getElementById('txtsagencycode').value;
			var txtagenname1 = document.getElementById('txtagenname').value;

			if(txtagenname1.indexOf("'")>=0)
			    {
			   txtagenname1= txtagenname1.replace("'","''");
			    }
			
			var drpagescat1=document.getElementById('drpagescat').value;
			var txtstatus21=document.getElementById('txtstatus2').value;
			var txtalias1 = document.getElementById('txtalias').value;
		
			
			if(txtalias1.indexOf("'")>=0)
			    {
			   txtalias1= txtalias1.replace("'","''");
			    }
			
			var mrvregion1=document.getElementById('mrvregion').value;
			var drpregion1 = document.getElementById('drpregion').value;			
			var txtphone11=document.getElementById('txtphone1').value;
			var txtalert1=document.getElementById('txtalert').value;			
			if(txtalert1.indexOf("'")>=0)
			    {
			   txtalert1= txtalert1.replace("'","''");
			    }
			
			var txtremarks1=document.getElementById('txtremarks').value;
			
			if(txtremarks1.indexOf("'")>=0)
			    {
			   txtremarks1= txtremarks1.replace("'","''");
			    }
			
			var txtadd1=document.getElementById('txtadd').value;
			
			if(txtadd1.indexOf("'")>=0)
			    {
			   txtadd1= txtadd1.replace("'","''");
			    }
			
			var txtaddress1=document.getElementById('txtaddress1').value;
			
			if(txtaddress1.indexOf("'")>=0)
			    {
			   txtaddress1= txtaddress1.replace("'","''");
			    }
			
			var txtaddress2=document.getElementById('txtaddress2').value;
			
			if(txtaddress2.indexOf("'")>=0)
			    {
			   txtaddress2= txtaddress2.replace("'","''");
			    }
			
			var txtstreet1=document.getElementById('txtstreet').value;
			
			if(txtstreet1.indexOf("'")>=0)
			    {
			   txtstreet1= txtstreet1.replace("'","''");
			    }
			
			var txtdistrict1=document.getElementById('txtdistrict').value;
			var txtcountry1=document.getElementById('txtcountry').value;
			var txtphone21=document.getElementById('txtphone2').value;
			var txtmail1=document.getElementById('txtmail').value;
			
			if(txtmail1.indexOf("'")>=0)
			    {
			   txtmail1= txtmail1.replace("'","''");
			    }
			var txttan1=document.getElementById('txttan').value;
			var txtpan1=document.getElementById('txtpan').value;
			var drpress1=document.getElementById('drprepres').value;
			var txtbill1=document.getElementById('txtbill').value;
			var drpagetype1=document.getElementById('drpagetyp').value;
			var txtpincode1=document.getElementById('txtpincode').value;
			var txtstate1=document.getElementById('txtstate').value;
			var txtfax1=document.getElementById('txtfax').value;
			var txtfax2=document.getElementById('txtfax1').value;
			var curtype=document.getElementById('drpcurtyp').value;
			var txtenrolldate1="";
			
			if(dateformat=="dd/mm/yyyy")
			{
			    if(document.getElementById('txtenrolldate').value!="")
			        {
			        var txt=document.getElementById('txtenrolldate').value;
			        var txt1=txt.split("/");
			        var dd=txt1[0];
			        var mm=txt1[1];
			        var yy=txt1[2];
			        txtenrolldate1=mm+'/'+dd+'/'+yy;
			        }
			        else
			        {
			         txtenrolldate1=document.getElementById('txtenrolldate').value;
			        }
			
			}
			if(dateformat=="mm/dd/yyyy")
			    {
			     txtenrolldate1=document.getElementById('txtenrolldate').value;
			    }
			if(dateformat=="yyyy/mm/dd")
			    {
			    if(document.getElementById('txtenrolldate').value!="")
			        {
			        var txt=document.getElementById('txtenrolldate').value;
			        var txt1=txt.split("/");
			        var yy=txt1[0];
			        var mm=txt1[1];
			        var dd=txt1[2];
			        txtenrolldate1=mm+'/'+dd+'/'+yy;
			        }
			    else
			        {
			         txtenrolldate1=document.getElementById('txtenrolldate').value;
			        }
			    }
			if(dateformat=="" || dateformat==null || dateformat=="undefined")
			{
			 txtenrolldate1=document.getElementById('txtenrolldate').value;
			}
			
			var txtnoofvts1=document.getElementById('txtnoofvts').value;
			var drpcity1=document.getElementById('drpcity').value;
			var drptaluka1=document.getElementById('drptaluka').value;
			var txtbussinessdate1=document.getElementById('txtbusineedate').value;
			var txtbussinessdate1="";
			
			if(dateformat=="dd/mm/yyyy")
			{
			        if(document.getElementById('txtbusineedate').value!="")
			        {
			        var txt1=document.getElementById('txtbusineedate').value;
			        var txt2=txt1.split("/");
			        var dd=txt2[0];
			        var mm=txt2[1];
			        var yy=txt2[2];
			         txtbussinessdate1=mm+'/'+dd+'/'+yy;
			        }
			        else
			        {
			       txtbussinessdate1=document.getElementById('txtbusineedate').value;
			        }
        			
			        }
			        if(dateformat=="mm/dd/yyyy")
			        {
			       txtbussinessdate1=document.getElementById('txtbusineedate').value;
			        }
			        if(dateformat=="yyyy/mm/dd")
			        {
			        if(document.getElementById('txtbusineedate').value!="")
			        {
			        var txt1=document.getElementById('txtbusineedate').value;
			        var txt2=txt1.split("/");
			        var yy=txt2[0];
			        var mm=txt2[1];
			        var dd=txt2[2];
			       txtbussinessdate1=mm+'/'+dd+'/'+yy;
			        }
			        else
			        {
			        txtbussinessdate1=document.getElementById('txtbusineedate').value;
			        }
			}
			if(dateformat=="" || dateformat==null || dateformat=="undefined")
			{
			 txtbussinessdate1=document.getElementById('txtbusineedate').value;
			}
			
			var txtmyrefno1=document.getElementById('txtmryrefno').value;
			var txtcredit1=document.getElementById('txtcredit').value;
			var txtsacno1=document.getElementById('txtstacno').value;
			var txtsagencycod1=document.getElementById('txtsagencycode').value;
			var txturl1=document.getElementById('txturl').value;
			var creditdays=document.getElementById('txtcreditlimitdays').value;
        var txtcrlimitfromdate="";			
			if(dateformat=="dd/mm/yyyy")
			{
			    if(document.getElementById('txtcrlimitfromdate').value!="")
			        {
			        var txt=document.getElementById('txtcrlimitfromdate').value;
			        var txt1=txt.split("/");
			        var dd=txt1[0];
			        var mm=txt1[1];
			        var yy=txt1[2];
			        creditlimitdays=mm+'/'+dd+'/'+yy;
			        }
			        else
			        {
			         creditlimitdays=document.getElementById('txtcrlimitfromdate').value;
			        }
			
			}
			if(dateformat=="mm/dd/yyyy")
			    {
			     creditlimitdays=document.getElementById('txtcrlimitfromdate').value;
			    }
			if(dateformat=="yyyy/mm/dd")
			    {
			    if(document.getElementById('txtcrlimitfromdate').value!="")
			        {
			        var txt=document.getElementById('txtcrlimitfromdate').value;
			        var txt1=txt.split("/");
			        var yy=txt1[0];
			        var mm=txt1[1];
			        var dd=txt1[2];
			        creditlimitdays=mm+'/'+dd+'/'+yy;
			        }
			    else
			        {
			         creditlimitdays=document.getElementById('txtcrlimitfromdate').value;
			        }
			    }
			if(dateformat=="" || dateformat==null || dateformat=="undefined")
			{
			 creditlimitdays=document.getElementById('txtcrlimitfromdate').value;
			}
        var recoverylimit=document.getElementById('txtrecoverylimit').value;
			if(txturl1.indexOf("'")>=0)
			    {
			   txturl1= txturl1.replace("'","''");
			    }
			
			var txtcrlimit1=document.getElementById('txtcrlimit').value;
			var txtagenname1=document.getElementById('txtagenname').value;
			var txtstatus=document.getElementById('txtstatus').value;
			var txtstatusdate=document.getElementById('txtstatusdate').value;
			var txtagenho1=document.getElementById('txtagencyho').value;
			var txtsubagenho1 = "";
			var zone=document.getElementById('drpzone').value;
			var acagen=document.getElementById('biltodrp').value;
			var rategrp=document.getElementById('drprate').value;
			var hdstatecode=document.getElementById('hiddenstatecode').value;
          var hddistcode=document.getElementById('hiddendistcode').value;
          var billfreq=document.getElementById('drpbillf').value;
          var oldagen=document.getElementById('txtoldagen').value;
          var length = document.getElementById('bktype').options.length;
           var 	editionwisebilling	=	document.getElementById('drpEdition_wise_Billing').value;
            var abc = "";
                for(var li=0;  li< length; li++)
                {
                    if (document.getElementById('bktype').options[li].selected == true)
                    {
                        if (document.getElementById('bktype').options[li].value != "")
                        {
                            if(abc=="")
                                abc=document.getElementById('bktype').options[li].value;
                            else
                                abc = abc + "," + document.getElementById('bktype').options[li].value;
                        }

                    }
                }
                var booktype=abc;
			var paymode="0";			
			if(document.getElementById('txtbill').value=="")
			{
			    txtbill=document.getElementById('txtbill').value;
			}
			else
			{
			    txtbill=document.getElementById('txtbill').value;
			}			
			var endate=new Date(txtenrolldate1);
            var bdate=new Date(txtbussinessdate1);
            if(endate > bdate)
            {
            f5();
            return false;
            }
			var dateformat=document.getElementById('hiddendateformat').value;
			var depocode=document.getElementById('txtdepocode').value;
			var codsubcode = document.getElementById('txtagencode').value + document.getElementById('txtsagencycode').value;
			var insertremark = "0";
			if (trim(document.getElementById('hdnremarkmod').value) != trim(document.getElementById('txtalert').value)) {
			    insertremark = "1";
			}
			var vat;
            if(document.getElementById("chkvat").checked==true)
            {
            vat="1";
            }
            else
            {
            vat="0";
            }
            var raterevise = "0";
            if (document.getElementById("chkraterevise").checked == true) {
                raterevise = "1";
            }
            var txptsagencycode1 = document.getElementById('txtsagencycode').value;
            var email = document.getElementById('drpemail').value;
            var age_desig = document.getElementById('txtdesg').value.toUpperCase();
            var executive = "";
        var length1 = document.getElementById('Libexecutive').options.length;
        var xyz = "";
            for(var li=0;  li< length1; li++)
            {
                if (document.getElementById('Libexecutive').options[li].selected == true)
                {
                    if (document.getElementById('Libexecutive').options[li].value != "")
                    {
                        if(xyz=="")
                            xyz=document.getElementById('Libexecutive').options[li].value;
                        else
                            xyz = xyz + "," + document.getElementById('Libexecutive').options[li].value;
                    }

                }
            }
            var Libexecutive=xyz;
            //////////add by anuja
            var Retainer = "";
            var length11 = document.getElementById('liretainer').options.length;
            var xyzt = "";
            for (var l1i = 0; l1i < length11; l1i++) {
                if (document.getElementById('liretainer').options[l1i].selected == true) {
                    if (document.getElementById('liretainer').options[l1i].value != "") {
                        if (xyzt == "")
                            xyzt = document.getElementById('liretainer').options[l1i].value;
                        else
                            xyzt = xyzt + "," + document.getElementById('liretainer').options[l1i].value;
                    }

                }
            }
            var Retain = xyzt;
            var sapcode = document.getElementById('txtsapcode').value;
            var security = document.getElementById('txtsecure').value;
            ////////////////////
            var mailcc=document.getElementById('txtmailcc').value;
            var intrestcalculation = document.getElementById('drpcalc').value;
            var bilflag = document.getElementById('drpbilflag').value;
            var gstus = document.getElementById('drpgstus').value;
            //var gstdt = document.getElementById('txtgstdt').value;
            
            var gstdt="";			
			if(dateformat=="dd/mm/yyyy")
			{
			    if(document.getElementById('txtgstdt').value!="")
			        {
			        var txt=document.getElementById('txtgstdt').value;
			        var txt1=txt.split("/");
			        var dd=txt1[0];
			        var mm=txt1[1];
			        var yy=txt1[2];
			        gstdt=mm+'/'+dd+'/'+yy;
			        }
			        else
			        {
			         gstdt=document.getElementById('txtgstdt').value;
			        }
			
			}
			if(dateformat=="mm/dd/yyyy")
			    {
			     gstdt=document.getElementById('txtgstdt').value;
			    }
			if(dateformat=="yyyy/mm/dd")
			    {
			    if(document.getElementById('txtgstdt').value!="")
			        {
			        var txt=document.getElementById('txtgstdt').value;
			        var txt1=txt.split("/");
			        var yy=txt1[0];
			        var mm=txt1[1];
			        var dd=txt1[2];
			        gstdt=mm+'/'+dd+'/'+yy;
			        }
			    else
			        {
			         gstdt=document.getElementById('txtgstdt').value;
			        }
			    }
			if(dateformat=="" || dateformat==null || dateformat=="undefined")
			{
			 gstdt=document.getElementById('txtgstdt').value;
			}
            
            
            
            var gstin = document.getElementById('txtgstin').value;
            var gstatus=document.getElementById('drpgstatus').value;
            var gstcltype = document.getElementById('hdngstclty').value;
            var gstarno=document.getElementById('txtarno').value ;
            var gstprovid=document.getElementById('txtgstprovid').value;
           

        
            var res = emailidvalidation();
            if (res == false) {
                return false;
            }
            var blankcheque;
            if (document.getElementById("chkcheque").checked == true) {
                blankcheque = "1";
            }
            else {
                blankcheque = "0";
            }
            var Securitybond;
            if (document.getElementById("chkbondrecvd").checked == true) {
                Securitybond = "1";
            }
            else {
                Securitybond = "0";
            }
            var kycapp;
            if (document.getElementById("chkyc").checked == true) {
                kycapp = "1";
            }
            else {
                kycapp = "0";
            }
            var addproof;
            if (document.getElementById("chkadproof").checked == true) {
                addproof = "1";
            }
            else {
                addproof = "0";
            }
            Agent_master.modify(compcode, drpagecate1, txtagencode1, txptsagencycode1, txtagenname1, drpagescat1, txtstatus21, txtalias1, mrvregion1, drpregion1, txtphone11, txtalert1, txtremarks1, txtadd1, txtstreet1, txtdistrict1, txtcountry1, txtphone21, txtmail1, txttan1, txtpan1, drpress1, txtbill1, drpagetype1, txtpincode1, txtstate1, txtfax1, txtenrolldate1, txtnoofvts1, drpcity1, txtbussinessdate1, txtmyrefno1, txtcredit1, txtsacno1, txtsagencycod1, txturl1, txtcrlimit1, txtagenho1, txtsubagenho1, userid, txtstatus, txtsubagenho1, paymode, txtpincode1, txtsacno1, type, zone, txtaddress1, txtaddress2, curtype, acagen, txtfax2, rategrp, document.getElementById('drpuserid').value, dateformat, depocode, drptaluka1, document.getElementById('ip1').value, branchcode, hdstatecode, hddistcode, billfreq, oldagen, booktype, vat, raterevise, insertremark, editionwisebilling, Libexecutive, email, age_desig, creditdays, creditlimitdays, recoverylimit, mailcc, document.getElementById('hidkyc').value, intrestcalculation, bilflag, sapcode, security, gstus, gstdt, gstin, Retain, blankcheque,Securitybond,kycapp,addproof,gstatus,gstcltype,gstarno,gstprovid);
            Agent_master.adusersave(codsubcode,document.getElementById('txtdepocode').value,"1");			
			fsv();
			document.getElementById('hiddensaurabh').value="1";
            document.getElementById('hiddenbhanu').value="0";
            var bktyplen=document.getElementById('bktype').options.length;
            var abc1 = "";
                for(var li=0;  li< length; li++)
                {
                    if (document.getElementById('bktype').options[li].selected == true)
                    {
                        if (document.getElementById('bktype').options[li].value != "")
                        {
                            if(abc1=="")
                                abc1=document.getElementById('bktype').options[li].value;
                            else
                                abc1 = abc1 + "," + document.getElementById('bktype').options[li].value;
                        }
                    }
                }
            dsforexecute.Tables[0].Rows[z].BOOKING_TYPE=abc1;
			dsforexecute.Tables[0].Rows[z].Agency_Type_Code=document.getElementById('drpagetyp').value;
			dsforexecute.Tables[0].Rows[z].Agency_Cat_Code=document.getElementById('drpagecate').value;
			dsforexecute.Tables[0].Rows[z].Agency_SubCat_Code=document.getElementById('drpagescat').value;
			dsforexecute.Tables[0].Rows[z].Agency_Code=document.getElementById('txtagencode').value;
			dsforexecute.Tables[0].Rows[z].Agency_Name=document.getElementById('txtagenname').value;
			dsforexecute.Tables[0].Rows[z].Agency_Alias=document.getElementById('txtalias').value;
			dsforexecute.Tables[0].Rows[z].Agency_HO=document.getElementById('txtagencyho').value;
			dsforexecute.Tables[0].Rows[z].Add1=document.getElementById('txtadd').value;
			dsforexecute.Tables[0].Rows[z].Street=document.getElementById('txtstreet').value;
			dsforexecute.Tables[0].Rows[z].City_Code=document.getElementById('drpcity').value;
			dsforexecute.Tables[0].Rows[z].TALUKA=document.getElementById('drptaluka').value;
			dsforexecute.Tables[0].Rows[z].Zip=document.getElementById('mrvregion').value;
			dsforexecute.Tables[0].Rows[z].Dist_Code=document.getElementById('txtdistrict').value;
			dsforexecute.Tables[0].Rows[z].State_Code=document.getElementById('txtstate').value;
			dsforexecute.Tables[0].Rows[z].Country_Code=document.getElementById('txtcountry').value;
			dsforexecute.Tables[0].Rows[z].Phone=document.getElementById('txtphone2').value;
			dsforexecute.Tables[0].Rows[z].Fax=document.getElementById('txtfax').value;
			dsforexecute.Tables[0].Rows[z].URL=document.getElementById('txturl').value;
            dsforexecute.Tables[0].Rows[z].Buss_Start_Date=bdate;
			dsforexecute.Tables[0].Rows[z].Enroll_Date=endate;
			dsforexecute.Tables[0].Rows[z].MRV_Ref_No=document.getElementById('txtmryrefno').value;
			dsforexecute.Tables[0].Rows[z].No_of_VTS=document.getElementById('txtnoofvts').value;
			dsforexecute.Tables[0].Rows[z].Credit_Days=document.getElementById('txtcredit').value;
			dsforexecute.Tables[0].Rows[z].PAN_No=document.getElementById('txtpan').value;
			dsforexecute.Tables[0].Rows[z].TAN_No=document.getElementById('txttan').value;
			dsforexecute.Tables[0].Rows[z].ST_ACC_No=document.getElementById('txtstacno').value;
			dsforexecute.Tables[0].Rows[z].Status_Reason=document.getElementById('txtstatus2').value;
			dsforexecute.Tables[0].Rows[z].Remarks=document.getElementById('txtremarks').value;
			dsforexecute.Tables[0].Rows[z].SUB_Agency_HO=document.getElementById('txtagencyho').value;
			dsforexecute.Tables[0].Rows[z].SUB_Agency_Code=document.getElementById('txtsugagencyho').value;
			dsforexecute.Tables[0].Rows[z].BILL_TO=document.getElementById('biltodrp').value;
			dsforexecute.Tables[0].Rows[z].ALERT=document.getElementById('txtalert').value;
			dsforexecute.Tables[0].Rows[z].CREDIT_LIMIT=document.getElementById('txtcrlimit').value;
			dsforexecute.Tables[0].Rows[z].representative_code=document.getElementById('drprepres').value;
			dsforexecute.Tables[0].Rows[z].pin_code=document.getElementById('txtpincode').value;
			dsforexecute.Tables[0].Rows[z].region=document.getElementById('drpregion').value;
			dsforexecute.Tables[0].Rows[z].Type=document.getElementById('drpparent').value;
			dsforexecute.Tables[0].Rows[z].zone_code=document.getElementById('drpzone').value;
			dsforexecute.Tables[0].Rows[z].Add2=document.getElementById('txtaddress1').value;
			dsforexecute.Tables[0].Rows[z].Add3=document.getElementById('txtaddress2').value;
			dsforexecute.Tables[0].Rows[z].CREDIT_TYPE=document.getElementById('drpcurtyp').value;
			dsforexecute.Tables[0].Rows[z].acagency=document.getElementById('txtbill').value;
			dsforexecute.Tables[0].Rows[z].fax1=document.getElementById('txtfax1').value;
			dsforexecute.Tables[0].Rows[z].DEPOCODE=document.getElementById('txtdepocode').value;
			dsforexecute.Tables[0].Rows[z].Branch_code=document.getElementById('drpbranch').value;
			dsforexecute.Tables[0].Rows[z].OLD_AGENCY = document.getElementById('txtoldagen').value;
			dsforexecute.Tables[0].Rows[z].EmailID = document.getElementById('txtmail').value;
			dsforexecute.Tables[0].Rows[z].AGENCY_DESIGNATION = document.getElementById('txtdesg').value;
			dsforexecute.Tables[0].Rows[z].CREDITDAYS=document.getElementById("txtcreditlimitdays").value;
			dsforexecute.Tables[0].Rows[z].CREDITLIMITDAYS=document.getElementById("txtcrlimitfromdate").value;
			dsforexecute.Tables[0].Rows[z].RECOVERYLIMIT=document.getElementById("txtrecoverylimit").value;
			dsforexecute.Tables[0].Rows[z].VAT = document.getElementById("chkvat").value;
			dsforexecute.Tables[0].Rows[z].RATE_REVISE = document.getElementById("chkraterevise").value;
			dsforexecute.Tables[0].Rows[z].EDTN_WISE_BILL_REQ = document.getElementById('drpEdition_wise_Billing').value;
			dsforexecute.Tables[0].Rows[z].SAP_AGCODE = document.getElementById('txtsapcode').value;
			dsforexecute.Tables[0].Rows[z].GST_REGISTRATION = document.getElementById('drpgstus').value;
			dsforexecute.Tables[0].Rows[z].GST_REGISTRATION_DATE = document.getElementById('txtgstdt').value;
			dsforexecute.Tables[0].Rows[z].GSTIN = document.getElementById('txtgstin').value;
			dsforexecute.Tables[0].Rows[z].GST_STATUS = document.getElementById('drpgstatus').value;
			dsforexecute.Tables[0].Rows[z].GST_CLIENT_TYPE_CD = document.getElementById('txtgstclty').value;
			dsforexecute.Tables[0].Rows[z].GST_ARN_NO = document.getElementById('txtarno').value;
			dsforexecute.Tables[0].Rows[z].GST_PROVISINAL_ID = document.getElementById('txtgstprovid').value;

			document.getElementById('drpgstus').disabled = true;
			document.getElementById('txtgstdt').disabled = true;
			document.getElementById('txtgstin').disabled = true;
			document.getElementById('drpgstatus').disabled = true;
			document.getElementById('txtgstclty').disabled = true;
			document.getElementById('txtarno').disabled = true;
			document.getElementById('txtgstprovid').disabled = true;
			document.getElementById('drpagecate').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('drpbranch').disabled=true;
			document.getElementById('txtdepocode').disabled=true;
			document.getElementById('bktype').disabled=true;
			document.getElementById("txtsapcode").disabled = true;
			document.getElementById("txtsecure").disabled = true;
			document.getElementById("drpEdition_wise_Billing").disabled = true;
			document.getElementById('drpbillf').disabled = true;
			document.getElementById('txtdesg').disabled = true;
			document.getElementById('txtoldagen').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('drpagescat').disabled=true;
			document.getElementById('drpagecate').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('txtsagencycode').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('drpagescat').disabled=true;
			document.getElementById('txtstatus2').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('mrvregion').disabled=true;
			document.getElementById('drpregion').disabled=true;
			document.getElementById('txtphone1').disabled=true;
			document.getElementById('txtalert').disabled=true;
			document.getElementById('txtremarks').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtadd').disabled=true;
			document.getElementById('txtaddress1').disabled=true;
			document.getElementById('txtaddress2').disabled=true;
			document.getElementById('txtstreet').disabled=true;
			document.getElementById('txtdistrict').disabled=true;
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			document.getElementById('txtphone2').disabled=true;
			document.getElementById('txtphone2').disabled=true;
			document.getElementById('txtmail').disabled=true;
			document.getElementById('drpcurtyp').disabled=true;
			document.getElementById('txttan').disabled=true;
			document.getElementById('txtpan').disabled=true;
			document.getElementById('drprepres').disabled=true;
			document.getElementById('txtbill').disabled=true;
			document.getElementById('drpagetyp').disabled=true;
			document.getElementById('txtpincode').disabled=true;
			document.getElementById('txtstate').disabled=true;
			document.getElementById('txtfax').disabled=true;
			document.getElementById('txtfax1').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtnoofvts').disabled=true;
			document.getElementById('drpcity').disabled=true;
			document.getElementById('drptaluka').disabled=true;
			document.getElementById('txtbusineedate').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtmryrefno').disabled=true;
			document.getElementById('txtcredit').disabled=true;
			document.getElementById('txtstacno').disabled=true;
			document.getElementById('txtsagencycode').disabled=true;
			document.getElementById('txturl').disabled=true;
			document.getElementById('txturl').disabled=true;
			document.getElementById('txtphone2').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('btnSave').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('drpregion').disabled=true;
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('drpagetyp').disabled=true;
			document.getElementById('drpcity').disabled=true;
			document.getElementById('txtstatus').disabled=true;
			document.getElementById('txtstatusdate').disabled=true;
			document.getElementById('biltodrp').disabled=true;
			document.getElementById('drprate').disabled=true;
			document.getElementById('drpuserid').disabled=true;
	        document.getElementById('lbcommdetail').disabled=false;
            document.getElementById('lbbankdetail').disabled=false;
            document.getElementById('lbstatusdetail').disabled=false;
            document.getElementById('lbbankmast').disabled=false;
            document.getElementById('lbpaymode').disabled=false;
            document.getElementById('lbcontactdetails').disabled=false;
            document.getElementById('chkvat').disabled=true;
            document.getElementById('chkraterevise').disabled = true;
            document.getElementById('txtdesg').disabled = true;
			document.getElementById('btnSave').disabled=true;
			document.getElementById('btnExit').disabled=false;
			document.getElementById('btnQuery').disabled=false;
			document.getElementById('btnfirst').disabled=false;
			document.getElementById('btnprevious').disabled=false;
			document.getElementById('btnnext').disabled=false;
			document.getElementById('btnlast').disabled=false;
			document.getElementById('btnExecute').disabled=true;
			document.getElementById('btnModify').disabled=false;
			document.getElementById('btnNew').disabled=true;
			document.getElementById('btnDelete').disabled = false;
                if (z==0)
                {
                document.getElementById('btnfirst').disabled=true;
                document.getElementById('btnprevious').disabled=true;
                }

                if(z==(dsforexecute.Tables[0].Rows.length-1))
                {
                    document.getElementById('btnnext').disabled=true;
	                document.getElementById('btnlast').disabled=true;
                }
		    document.getElementById('btnModify').focus();
			if(document.getElementById('hiddenpermission').value=="2")
			{
			    document.getElementById('btnDelete').disabled=true;
			}		
			if(document.getElementById('hiddenpermission').value=="3")
			{
			    document.getElementById('btnDelete').disabled=true;
			}
			
}
else
			{
			//save//
			var txtagencode=document.getElementById('txtagencode').value;
			document.getElementById('agencode').value=document.getElementById('txtagencode').value;
			var drpagecate=document.getElementById('drpagecate').value;
			var txtsagencycode=document.getElementById('txtsagencycode').value;
			document.getElementById('subagencode').value=document.getElementById('txtsagencycode').value;
			var txtagenname1=document.getElementById('txtagenname').value;
			if(txtagenname1.indexOf("'")>=0)
			    {
			   txtagenname1= txtagenname1.replace("'","''");
			    }			
			var txtagenname=txtagenname1;
			var drpagescat=document.getElementById('drpagescat').value;
			var txtstatus2=document.getElementById('txtstatus2').value;
			var txtalias=document.getElementById('txtalias').value;			
			if(txtalias.indexOf("'")>=0)
			    {
			   txtalias= txtalias.replace("'","''");
			    }			
			var mrvregion=document.getElementById('mrvregion').value;
			var drpregion=document.getElementById('drpregion').value;
			var txtphone1=document.getElementById('txtphone1').value;
			var txtalert=document.getElementById('txtalert').value;			
			if(txtalert.indexOf("'")>=0)
			    {
			   txtalert= txtalert.replace("'","''");
			    }			
			var txtremarks=document.getElementById('txtremarks').value;			
			if(txtremarks.indexOf("'")>=0)
			    {
			   txtremarks= txtremarks.replace("'","''");
			    }			
			var txtadd=document.getElementById('txtadd').value;			
			if(txtadd.indexOf("'")>=0)
			    {
			   txtadd= txtadd.replace("'","''");
			    }			
			var txtaddress1=document.getElementById('txtaddress1').value;			
			if(txtaddress1.indexOf("'")>=0)
			    {
			   txtaddress1= txtaddress1.replace("'","''");
			    }			
			var txtaddress2=document.getElementById('txtaddress2').value;
			
			if(txtaddress2.indexOf("'")>=0)
			    {
			   txtaddress2= txtaddress2.replace("'","''");
			    }
			
			var txtstreet=document.getElementById('txtstreet').value;			
			if(txtstreet.indexOf("'")>=0)
			    {
			   txtstreet= txtstreet.replace("'","''");
			    }			
			var txtdistrict=document.getElementById('txtdistrict').value;
			document.getElementById('tdistrict').value=document.getElementById('txtdistrict').value;			
			var txtcountry=document.getElementById('txtcountry').value;
			var txtphone2=document.getElementById('txtphone2').value;
			var txtmail=document.getElementById('txtmail').value;			
			if(txtmail.indexOf("'")>=0)
			    {
			   txtmail= txtmail.replace("'","''");
			    }
			var txttan=document.getElementById('txttan').value;
			var txtpan=document.getElementById('txtpan').value;
			var drpress=document.getElementById('drprepres').value;
			var txtbill=document.getElementById('txtbill').value;
			document.getElementById('tbill').value=document.getElementById('txtbill').value;
			var dateformat=document.getElementById('hiddendateformat').value;
			var drpagetype=document.getElementById('drpagetyp').value;
			var txtpincode=document.getElementById('txtpincode').value;			
			var txtstate=document.getElementById('txtstate').value;
			document.getElementById('tstate').value=document.getElementById('txtstate').value;			
			var txtfax=document.getElementById('txtfax').value;			
			var txtenrolldate="";			
			if(dateformat=="mm/dd/yyyy")
			{
			    txtenrolldate=document.getElementById('txtenrolldate').value;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			    var txt=document.getElementById('txtenrolldate').value;
			    var txt1=txt.split("/");
			    var dd=txt1[0];
			    var mm=txt1[1];
			    var yy=txt1[2];
			     txtenrolldate=mm+'/'+dd+'/'+yy;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			    var txt=document.getElementById('txtenrolldate').value;
			    var txt1=txt.split("/");
			    var yy=txt1[0];
			    var mm=txt1[1];
			    var dd=txt1[2];
			    txtenrolldate=mm+'/'+dd+'/'+yy;
			}
			if(dateformat==null || dateformat=="" || dateformat=="undefined")
			{
		        txtenrolldate=document.getElementById('txtenrolldate').value;
			}
			
			var txtnoofvts=document.getElementById('txtnoofvts').value;
			var taluka=document.getElementById('drptaluka').value;
			var drpcity=document.getElementById('drpcity').value;
			document.getElementById('dcity').value=document.getElementById('drpcity').value;
			document.getElementById('dtaluka').value=document.getElementById('drptaluka').value;
			var txtbussinessdate='';			
			if(dateformat=="mm/dd/yyyy")
			{
			txtbussinessdate=document.getElementById('txtbusineedate').value;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			    var txt=document.getElementById('txtbusineedate').value;
			    var txt1=txt.split("/");
			    var dd=txt1[0];
			    var mm=txt1[1];
			    var yy=txt1[2];
		        txtbussinessdate=mm+'/'+dd+'/'+yy;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			var txt=document.getElementById('txtbusineedate').value;
			var txt1=txt.split("/");
			var yy=txt1[0];
			var mm=txt1[1];
			var dd=txt1[2];
		 txtbussinessdate=mm+'/'+dd+'/'+yy;
			}
			if(dateformat==null || dateformat=="" || dateformat=="undefined")
			{
			 txtbussinessdate=document.getElementById('txtbusineedate').value;
			}
			var txtmyrefno=document.getElementById('txtmryrefno').value;
			var txtcredit=document.getElementById('txtcredit').value;
			var txtsacno=document.getElementById('txtstacno').value;
			var txtsagencycod=document.getElementById('txtsagencycode').value;
			var txturl=document.getElementById('txturl').value;
			var txtcrlimit=document.getElementById('txtcrlimit').value;
			var txtagenname=document.getElementById('txtagenname').value;
			var txtagenho=document.getElementById('txtagencyho').value;
			var txtsubagenho=document.getElementById('txtsugagencyho').value;
			var type=document.getElementById('drpparent').value;
			var subcode=document.getElementById('txtsagencycode').value;
			var branchcode = document.getElementById('drpbranch').value;
			var age_desig = document.getElementById('txtdesg').value;
			var vat;
            if(document.getElementById("chkvat").checked==true)
            {
            vat="1";
            }
            else
            {
            vat="0";
             }
             var raterevise="0";
             if (document.getElementById("chkraterevise").checked == true) {
                 raterevise = "1";
             }	
			var paymode1="0";			
			if(txtagencode != "")
			{			
			//----------saurabh code for agency code duplicacy check
			     if(hiddentext=="new")
                    {
                         document.getElementById('txtagencode').disabled=true;
                      document.getElementById('txtsagencycode').disabled=true;

                          var agencode=document.getElementById('txtagencode').value;
                          var subagencode=document.getElementById('txtsagencycode').value;
                              var compcode=document.getElementById('hiddencompcode').value;
                                 var userid=document.getElementById('hiddenuserid').value;
                             var agenname=document.getElementById('txtagenname').value;
                        var dp=document.getElementById('drpparent').value;			
			//---------variables for the second check function			
			var txtagenho=document.getElementById('txtagencyho').value;
			        var subcode=document.getElementById('txtsagencycode').value;
			var newagencode=document.getElementById('txtagencode').value;
			//----------------------------------------			
			var qbc=document.getElementById('drpuserid').value;
			//*******By Manish Verma			
			 var browser=navigator.appName;
             var  httpRequest =null;       
        var dl="";       
        if(browser!="Microsoft Internet Explorer")
        {
            httpRequest= new XMLHttpRequest();
            if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml'); 
            }            
             httpRequest.onreadystatechange = function() {alertContents_chk(httpRequest) }; 
            httpRequest.open('GET', "agencycodechk.aspx?agencode="+agencode+"&subagencode="+subagencode+"&agenname="+agenname+"&type="+type+"&txtagenho="+txtagenho+"&subcode="+subcode+"&newagencode="+newagencode+"&qbc="+qbc, false);
            httpRequest.send('');
            dl=httpRequest.responseText;
        }
        else if(browser=="Microsoft Internet Explorer")
        {
           var xml = new ActiveXObject("Microsoft.XMLHTTP");
            xml.Open( "GET","agencycodechk.aspx?agencode="+agencode+"&subagencode="+subagencode+"&agenname="+agenname+"&type="+type+"&txtagenho="+txtagenho+"&subcode="+subcode+"&newagencode="+newagencode+"&qbc="+qbc, false );
	        xml.Send();
	        dl=xml.responseText;
        }
        if (dl == "agency code exists")
	                	     {
	                	        f4();
                              if(document.getElementById('txtagencode').disabled==false)
	                	            document.getElementById('txtagencode').focus();
	                	        return false;
	                	     }
	                	     else if(dl=="sub agency code exists")
	                	     {
	                	        f3();
                                if(document.getElementById('txtsagencycode').disabled==false)
                                document.getElementById('txtsagencycode').focus();
                                return false;
	                	     }
// Duplicacy of Agency..
	                	     else if(dl=="enter commission detail")
	                	     {
	                	        f1();
                                document.getElementById('lbcommdetail').focus();
                                document.getElementById('lbcommdetail').style.fontWeight="bold";
                                return false;   
	                	     }
	                	     else if(dl=="enter pay mode detail")
	                	     {
	                	         fp();
                                document.getElementById('lbpaymode').focus();
                                document.getElementById('lbpaymode').style.fontWeight="bold";
                                return false;
	                	     }
	        		}

//-----------------------------------------code over for agency redundancy check-----------------------------
           // userdefine();   //this function work is done from the upper called ActiveX object file           
            document.getElementById('txtsagencycode').disabled=true;			
			document.getElementById('btnSave').disabled=false;
			}
			else
			{
			f7();
			return false;
			}			
			if(document.getElementById('hiddenpermission').value=="5")
			{
			document.getElementById('btnQuery').disabled=true;
			document.getElementById('btnDelete').disabled=false;
			}
			if(document.getElementById('hiddenpermission').value=="1")
			{
			document.getElementById('btnQuery').disabled=true;
			}
			document.getElementById('btnDelete').disabled=true;
			if(document.getElementById('hiddenpermission').value=="2")
			{			
			document.getElementById('btnDelete').disabled=true;			
			}
			//------------------Previous Code by pankaj
			//------------------new Code by Saurabh Agarwal----------------------
        var agencytype = document.getElementById('drpagetyp').value;
        var mrvregion=document.getElementById('mrvregion').value;
        var agentcategory = document.getElementById('drpagecate').value;
        var agentcategory2 = document.getElementById('drpagescat').value;
        var agentcode = document.getElementById('agencode').value;
        var agentname = document.getElementById('txtagenname').value;
        agentname=agentname.replace('&','~');
        var alias = document.getElementById('txtalias').value;
        alias=alias.replace('&','~');
        var agencyho = document.getElementById('txtagencyho').value;
        var address = document.getElementById('txtadd').value;
        var street = document.getElementById('txtstreet').value;
        var city = document.getElementById('dcity').value;
        var taluka = document.getElementById('dtaluka').value;
        var district = document.getElementById('tdistrict').value;
        var state = document.getElementById('tstate').value;
        var country = document.getElementById('txtcountry').value;
        var phone = document.getElementById('txtphone2').value;
        var fax = document.getElementById('txtfax').value;
        var mail = document.getElementById('txtmail').value;
        var url = document.getElementById('txturl').value;
        var bussinessstartdate = document.getElementById('txtbusineedate').value;
        var enrolldate = document.getElementById('txtenrolldate').value;
        var mrerefferenceno = document.getElementById('txtmryrefno').value;
        var novts = document.getElementById('txtnoofvts').value;
        var credit = document.getElementById('txtcredit').value;
        var pan = document.getElementById('txtpan').value;
        var tan = document.getElementById('txttan').value;
        var stacno = document.getElementById('txtstacno').value;
        var status = document.getElementById('txtstatus2').value;
        var remarks = document.getElementById('txtremarks').value;
        var subagencyho = document.getElementById('txtsugagencyho').value;
        var agencycode = document.getElementById('txtsagencycode').value;
        var billto = document.getElementById('biltodrp').value;
        var alert = document.getElementById('txtalert').value;
        var creditlimit = document.getElementById('txtcrlimit').value;
        var code = document.getElementById('txtphone1').value;
        var representative = document.getElementById('drprepres').value;
        var pin = document.getElementById('txtpincode').value;
        var zip="";
        var region = document.getElementById('drpregion').value;
        var type = document.getElementById('drpparent').value;
        var zone = document.getElementById('drpzone').value;
        var address1 = document.getElementById('txtaddress1').value;
        var address2 = document.getElementById('txtaddress2').value;
        var curtype = document.getElementById('drpcurtyp').value;
        var acagen = document.getElementById('txtbill').value;
        var fax2 = document.getElementById('txtfax1').value;
        var rategrp = document.getElementById('drprate').value;
        var branchcode=document.getElementById('drpbranch').value;
        var hdstatecode=document.getElementById('hiddenstatecode').value;
        var hddistcode=document.getElementById('hiddendistcode').value;
        var billfreq=document.getElementById('drpbillf').value;
        var oldagen = document.getElementById('txtoldagen').value;
        var age_desig = document.getElementById('txtdesg').value;
           var creditdays=document.getElementById('txtcreditlimitdays').value;
     	     var txt=document.getElementById('txtcrlimitfromdate').value;
			    var txt1=txt.split("/");
			    var yy=txt1[0];
			    var mm=txt1[1];
			    var dd=txt1[2];			 
			    txtcrlimitfromdate=yy+'/'+mm+'/'+dd;
			    var creditlimitdays=document.getElementById('txtcrlimitfromdate').value;
			    var recoverylimit = document.getElementById('txtrecoverylimit').value;
			    var mailidcc = document.getElementById('txtmailcc').value;
			    var kyc_attach = document.getElementById('hidkyc').value;
			    var intrestcalculation = document.getElementById('drpcalc').value;
			    var bilflag = document.getElementById('drpbilflag').value;
        var subsubcd=document.getElementById('txtsubsubagcd').value;
        var email = document.getElementById('drpemail').value;
        var length = document.getElementById('bktype').options.length;
        var editionwisebilling = document.getElementById('drpEdition_wise_Billing').value;
    
        var xyz = "";
        var abc = "";
            for(var li=0;  li< length; li++)
            {
                if (document.getElementById('bktype').options[li].selected == true)
                {
                    if (document.getElementById('bktype').options[li].value != "")
                    {
                        if(abc=="")
                            abc=document.getElementById('bktype').options[li].value;
                        else
                            abc = abc + "," + document.getElementById('bktype').options[li].value;
                    }

                }
            }
            var length1 = document.getElementById('Libexecutive').options.length;
            for(var li=0;  li< length1; li++)
            {
                if (document.getElementById('Libexecutive').options[li].selected == true)
                {
                    if (document.getElementById('Libexecutive').options[li].value != "")
                    {
                        if(xyz=="")
                            xyz=document.getElementById('Libexecutive').options[li].value;
                        else
                            xyz = xyz + "," + document.getElementById('Libexecutive').options[li].value;
                    }

                }
            }
            var Libexecutive = xyz;
            var Retainer = "";
            var length11 = document.getElementById('liretainer').options.length;
            var xyzt = "";
            for (var l1i = 0; l1i < length11; l1i++) {
                if (document.getElementById('liretainer').options[l1i].selected == true) {
                    if (document.getElementById('liretainer').options[l1i].value != "") {
                        if (xyzt == "")
                            xyzt = document.getElementById('liretainer').options[l1i].value;
                        else
                            xyzt = xyzt + "," + document.getElementById('liretainer').options[l1i].value;
                    }

                }
            }
            var Retain = xyzt;
            var booktype=abc;
       var paymode = "0";
       var vat;
     if(document.getElementById("chkvat").checked==true)
    {
        vat="1";
    }
    else
     {
        vat="0";
	}	
			var dl="";       
        address=address.replace('&','~');
        address1=address1.replace('&','~');
        address2=address2.replace('&','~');
        httpRequest =null;
        age_desig = age_desig.replace("&", ")");
        age_desig = age_desig.replace("#", "(");
        var mrv = document.getElementById('mrvregion').value;
        var ptype = document.getElementById('drpparent').value;
        var agencycode123 = document.getElementById('txtagencode').value;
        var agencysubcode123 = document.getElementById('txtsagencycode').value;
        var extra1 = "";
        var extra2 = "";
        var sapcode = document.getElementById('txtsapcode').value;
        var security = document.getElementById('txtsecure').value;
        var chk = Agent_master.chkagencycode(compcode, ptype, agencycode123, agencysubcode123, extra1, extra2);
        var cc = chk.value;
        var kk = alertforagency(chk.value)
         var gstus=   document.getElementById('drpgstus').value ;
         var gstdt = document.getElementById('txtgstdt').value;
         var gstin = document.getElementById('txtgstin').value;
         var gstatus = document.getElementById('drpgstatus').value;
         var gstcltype = document.getElementById('hdngstclty').value;
         var gstarno = document.getElementById('txtarno').value;
         var gstprovid = document.getElementById('txtgstprovid').value;
         var blankcheque;
         if (document.getElementById("chkcheque").checked == true) {
             blankcheque = "1";
         }
         else {
             blankcheque = "0";
         }
         var Securitybond;
         if (document.getElementById("chkbondrecvd").checked == true) {
             Securitybond = "1";
         }
         else {
             Securitybond = "0";
         }
         var kycapp;
         if (document.getElementById("chkyc").checked == true) {
             kycapp = "1";
         }
         else {
             kycapp = "0";
         }
         var addproof;
         if (document.getElementById("chkadproof").checked == true) {
             addproof = "1";
         }
         else {
             addproof = "0";
         }
        if (kk == false) {
            return false;
        }
        var res = emailidvalidation();
        if (res == false) {
            return false;
        }
        var mrv = document.getElementById('mrvregion').value;
        var userid = document.getElementById('drpuserid').value;
        if(browser!="Microsoft Internet Explorer")
        {
//            httpRequest= new XMLHttpRequest();
//            if (httpRequest.overrideMimeType) {
//            httpRequest.overrideMimeType('text/xml'); 
//            }
//        httpRequest.onreadystatechange = function () { alertContents_save(httpRequest) };
            Agent_master.setSessionre(agentcategory, agentcategory2, agencytype, agentcode, agentname, alias, agencyho, address, street, city, district, state, country, phone, fax, mail, url, bussinessstartdate, enrolldate, mrerefferenceno, novts, credit, pan, tan, stacno, status, remarks, subagencyho, agencycode, billto, alert, creditlimit, code, representative, pin, region, type, zone, address1, address2, curtype, acagen, fax2, rategrp, paymode, userid, taluka, mrvregion, branchcode, hdstatecode, hddistcode, billfreq, oldagen, booktype, vat, raterevise, editionwisebilling, Libexecutive, email, age_desig, mrv, creditdays, creditlimitdays, recoverylimit, mailidcc, kyc_attach, intrestcalculation, bilflag, subsubcd, sapcode, security, gstus, gstdt, gstin, Retain, blankcheque, Securitybond, kycapp, addproof,gstatus,gstcltype,gstarno,gstprovid);
       window.open('agencysave.aspx');
//             httpRequest.open('GET', "agencysave.aspx?agentcategory=" + agentcategory + "&agentcategory2=" + agentcategory2 + "&agencytype=" + agencytype + "&agentcode=" + agentcode + "&agentname=" + agentname + "&alias=" + alias + "&agencyho=" + agencyho + "&address=" + address + "&street=" + street + "&city=" + city + "&district=" + district + "&state=" + state + "&country=" + country + "&phone=" + phone + "&fax=" + fax + "&mail=" + mail + "&url=" + url + "&bussinessstartdate=" + bussinessstartdate + "&enrolldate=" + enrolldate + "&mrerefferenceno=" + mrerefferenceno + "&novts=" + novts + "&credit=" + credit + "&pan=" + pan + "&tan=" + tan + "&stacno=" + stacno + "&status=" + status + "&remarks=" + remarks + "&subagencyho=" + subagencyho + "&agencycode=" + agencycode + "&billto=" + billto + "&alert=" + alert + "&creditlimit=" + creditlimit + "&code=" + code + "&representative=" + representative + "&pin=" + pin + "&region=" + region + "&type=" + type + "&zone=" + zone + "&address1=" + address1 + "&address2=" + address2 + "&curtype=" + curtype + "&acagen=" + acagen + "&fax2=" + fax2 + "&rategrp=" + rategrp + "&paymode=" + paymode + "&qbcuserid=" + document.getElementById('drpuserid').value + "&taluka=" + taluka + "&mrvregion=" + mrvregion + "&branchcode=" + branchcode + "&hdstatecode=" + hdstatecode + "&hddistcode=" + hddistcode + "&billfreq=" + billfreq + "&oldagen=" + oldagen + "&bktype=" + booktype + "&vat=" + vat + "&raterevise=" + raterevise + "&editionwise=" + editionwisebilling + "&executive=" + Libexecutive + "&email=" + email + "&age_desig=" + age_desig + "&mrv=" + mrv + "&creditdays=" + creditdays + "&creditlimitdays=" + creditlimitdays + "&recoverylimit=" + recoverylimit + "&mailidcc=" + mailidcc + "&kyc_attach=" + kyc_attach + "&intrestcalculation=" + intrestcalculation + "&bilflag=" + bilflag + "&subsubcd2=" + subsubcd + "&sapcode=" + sapcode + "&security=" + security + "&gstust=" + gstus + "&gstdat=" + gstdt + "&gstina=" + gstin + "&Retainer =" + Retain + "&blncheque =" + blankcheque + "&sctybond =" + Securitybond + "&kycappli =" + kycapp + "&addproof =" + addproof, false);
//            httpRequest.send('');
//            dl = httpRequest.responseText;
//            var chkcomm = checkcommnull(dl)
//            if (chkcomm == false) {
//                return false;
//            }
        }
        else if(browser=="Microsoft Internet Explorer") {
            Agent_master.setSessionre(agentcategory, agentcategory2, agencytype, agentcode, agentname, alias, agencyho, address, street, city, district, state, country, phone, fax, mail, url, bussinessstartdate, enrolldate, mrerefferenceno, novts, credit, pan, tan, stacno, status, remarks, subagencyho, agencycode, billto, alert, creditlimit, code, representative, pin, region, type, zone, address1, address2, curtype, acagen, fax2, rategrp, paymode, userid, taluka, mrvregion, branchcode, hdstatecode, hddistcode, billfreq, oldagen, booktype, vat, raterevise, editionwisebilling, Libexecutive, email, age_desig, mrv, creditdays, creditlimitdays, recoverylimit, mailidcc, kyc_attach, intrestcalculation, bilflag, subsubcd, sapcode, security, gstus, gstdt, gstin, Retain, blankcheque, Securitybond, kycapp, addproof,gstatus,gstcltype,gstarno,gstprovid);
            window.open('agencysave.aspx'); 
//          	 var xml = new ActiveXObject("Microsoft.XMLHTTP");
//          	 xml.Open("GET", "agencysave.aspx?agentcategory=" + agentcategory + "&agentcategory2=" + agentcategory2 + "&agencytype=" + agencytype + "&agentcode=" + agentcode + "&agentname=" + agentname + "&alias=" + alias + "&agencyho=" + agencyho + "&address=" + address + "&street=" + street + "&city=" + city + "&district=" + district + "&state=" + state + "&country=" + country + "&phone=" + phone + "&fax=" + fax + "&mail=" + mail + "&url=" + url + "&bussinessstartdate=" + bussinessstartdate + "&enrolldate=" + enrolldate + "&mrerefferenceno=" + mrerefferenceno + "&novts=" + novts + "&credit=" + credit + "&pan=" + pan + "&tan=" + tan + "&stacno=" + stacno + "&status=" + status + "&remarks=" + remarks + "&subagencyho=" + subagencyho + "&agencycode=" + agencycode + "&billto=" + billto + "&alert=" + alert + "&creditlimit=" + creditlimit + "&code=" + code + "&representative=" + representative + "&pin=" + pin + "&region=" + region + "&type=" + type + "&zone=" + zone + "&address1=" + address1 + "&address2=" + address2 + "&curtype=" + curtype + "&acagen=" + acagen + "&fax2=" + fax2 + "&rategrp=" + rategrp + "&paymode=" + paymode + "&qbcuserid=" + document.getElementById('drpuserid').value + "&taluka=" + taluka + "&mrvregion=" + mrvregion + "&branchcode=" + branchcode + "&hdstatecode=" + hdstatecode + "&hddistcode=" + hddistcode + "&billfreq=" + billfreq + "&oldagen=" + oldagen + "&bktype=" + booktype + "&vat=" + vat + "&raterevise=" + raterevise + "&editionwise=" + editionwisebilling + "&executive=" + Libexecutive + "&email=" + email + "&age_desig=" + age_desig + "&mrv=" + mrv + "&creditdays=" + creditdays + "&creditlimitdays=" + creditlimitdays + "&recoverylimit=" + recoverylimit + "&mailidcc=" + mailidcc + "&kyc_attach=" + kyc_attach + "&intrestcalculation=" + intrestcalculation + "&bilflag=" + bilflag + "&subsubcd2=" + subsubcd + "&sapcode=" + sapcode + "&security=" + security + "&gstust=" + gstus + "&gstdat=" + gstdt + "&gstina=" + gstin + "&Retainer =" + Retain + "&blncheque =" + blankcheque + "&sctybond =" + Securitybond + "&kycappli =" + kycapp + "&addproof =" + addproof, false);
//		     xml.Send();
//		     dl = xml.responseText;
//		     var chkcomm = checkcommnull(dl)
//		     if (chkcomm == false) {
//		         return false;
//		     }
        }
        var adusercode=agentcode+agencycode;
        Agent_master.adusersave(adusercode,document.getElementById('txtdepocode').value,"1");
		     //---------------------Saurabh Agarwal		     
		     ff();		
		var bktyplen=document.getElementById('bktype').options.length;
         for(var t2=0;t2<bktyplen;t2++)
         {
             document.getElementById('bktype').options[t2].selected=false;
         }     
		document.getElementById('drpbranch').value="0";    
		document.getElementById('drpagetyp').value="0";
        document.getElementById('drpagescat').value="0";
        document.getElementById('drpagecate').value="0";//drpagecate.SelectedValue = "0";
        document.getElementById('drpregion').value="0";//drpregion.SelectedValue = "0";
        document.getElementById('txtagencode').value="";//txtagencode.Text = "";
        document.getElementById('drpcity').value="0";//drpcity.SelectedValue = "0";
        document.getElementById('biltodrp').value="0";//biltodrp.SelectedValue = "0";
        document.getElementById('drpbranch').value="0";
                document.getElementById('drpcalc').value="0";
                document.getElementById('txtdepocode').value = ""
                document.getElementById('drpbilflag').value = "0";
                document.getElementById('txtsapcode').value = ""
                document.getElementById('txtsecure').value = "" ;
        document.getElementById('txtstacno').value="";// txtstacno.Text = "";
        document.getElementById('txtagenname').value="";//txtagenname.Text = "";
        document.getElementById('txtalias').value="";//txtalias.Text = "";
        document.getElementById('txtadd').value="";//txtadd.Text = "";
        document.getElementById('txtstreet').value="";//txtstreet.Text = "";
        document.getElementById('txtmail').value="";//txtmail.Text = "";
        document.getElementById('txtpincode').value="";//txtpincode.Text = "";
        document.getElementById('txtdistrict').value="";//txtdistrict.Text = "";
        document.getElementById('txtstate').value="";//txtstate.Text = "";
        document.getElementById('txtcountry').value="0";//txtcountry.SelectedValue = "0";
        document.getElementById('txtphone1').value="";//txtphone1.Text = "";
        document.getElementById('txtphone2').value="";//txtphone2.Text = "";
        document.getElementById('txtfax').value="";//txtfax.Text = "";
        document.getElementById('txtfax1').value="";//txtfax1.Text = "";
        document.getElementById('txtmryrefno').value="";//txtmryrefno.Text = "";
        document.getElementById('txtnoofvts').value="";//txtnoofvts.Text = "";
        document.getElementById('txtcredit').value="";//txtcredit.Text = "";
       document.getElementById('txttan').value="";// txttan.Text = "";
      document.getElementById('txtpan').value="";//  txtpan.Text = "";
      document.getElementById('txtbill').value="0";//  txtbill.SelectedValue = "0";
       document.getElementById('drprepres').value="0";// drprepres.SelectedValue = "0";
       document.getElementById('txtstatus').value="";// txtstatus.Text = "";
        document.getElementById('txtstatusdate').value="";//txtstatusdate.Text = "";
       document.getElementById('txtstatus2').value="";// txtstatus2.Text = "";
       document.getElementById('txtalert').value="";// txtalert.Text = "";
        document.getElementById('txtremarks').value="";//txtremarks.Text = "";
 document.getElementById('drptaluka').value="0";
 document.getElementById('drptaluka').options.length=0;
        document.getElementById('drpzone').value="0";//drpzone.SelectedValue = "0";
        document.getElementById('drpzone').options.length=0;
      document.getElementById('drpparent').value="0";//  drpparent.SelectedValue = "0";
      document.getElementById('txturl').value="";//  txturl.Text = "";
       document.getElementById('mrvregion').value="";// mrvregion.Text = "";
        document.getElementById('drpregion').options.length=0;
       document.getElementById('txtcrlimit').value="";// txtcrlimit.Text = "";
       document.getElementById('txtagencyho').value="";// txtagencyho.Text = "";
       document.getElementById('txtsugagencyho').value="";// txtsugagencyho.Text = "";
       document.getElementById('txtaddress1').value="";// txtaddress1.Text = "";
       document.getElementById('txtaddress2').value="";// txtaddress2.Text = "";
        document.getElementById('txtsagencycode').value="";//txtsagencycode.Text = "";
        document.getElementById('txtbusineedate').value="";//txtbusineedate.Text = "";
        document.getElementById('txtenrolldate').value="";//txtenrolldate.Text = "";
        document.getElementById('txtagencode').value="";
        document.getElementById('txtsugagencyho').value="";
        document.getElementById('txtoldagen').value = "";
        document.getElementById('drpEdition_wise_Billing').value = "N";
        document.getElementById('drpgstus').value="0";
        document.getElementById('txtgstdt').value="";
        document.getElementById('txtgstin').value = "";
        document.getElementById('txtarno').value="";
       document.getElementById('txtgstprovid').value="";
        document.getElementById("drpEdition_wise_Billing").disabled = true;
        document.getElementById("chkvat").checked = false;
        document.getElementById("chkraterevise").checked = false; 
        //--------------------------------Saurabh Added
			document.getElementById('drpcalc').disabled=true;
			document.getElementById('bktype').disabled=true;
			document.getElementById('Libexecutive').disabled=true;
			document.getElementById('drpagecate').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('txtsagencycode').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('drpagescat').disabled=true;
			document.getElementById('drpagecate').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('txtsagencycode').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('drpagescat').disabled=true;
			document.getElementById('txtstatus2').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('mrvregion').disabled=true;
			document.getElementById('drpregion').disabled=true;
			document.getElementById('txtphone1').disabled=true;
			document.getElementById('txtalert').disabled=true;
			document.getElementById('txtremarks').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtadd').disabled=true;
			document.getElementById('txtaddress1').disabled=true;
			document.getElementById('txtaddress2').disabled=true;
			document.getElementById('txtstreet').disabled=true;
			document.getElementById('txtdistrict').disabled=true;
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			document.getElementById('txtphone2').disabled=true;
			document.getElementById('txtphone2').disabled=true;
			document.getElementById('txtmail').disabled=true;
			document.getElementById('drpcurtyp').disabled=true;
			document.getElementById('txttan').disabled=true;
			document.getElementById('txtpan').disabled=true;
			document.getElementById('drprepres').disabled=true;
			document.getElementById('txtbill').disabled=true;
			document.getElementById('drpagetyp').disabled=true;
			document.getElementById('txtpincode').disabled=true;
			document.getElementById('txtstate').disabled=true;
			document.getElementById('txtfax').disabled=true;
			document.getElementById('txtfax1').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtnoofvts').disabled=true;
			document.getElementById('drpcity').disabled=true;
			document.getElementById('drptaluka').disabled=true;
			document.getElementById('txtbusineedate').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtmryrefno').disabled=true;
			document.getElementById('txtcredit').disabled=true;
			document.getElementById('txtstacno').disabled=true;
			document.getElementById('txtsagencycode').disabled=true;
			document.getElementById('txturl').disabled=true;
			document.getElementById('txturl').disabled=true;
			document.getElementById('txtphone2').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('btnSave').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('drpregion').disabled=true;
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('drpagetyp').disabled=true;
			document.getElementById('drpcity').disabled=true;
			document.getElementById('txtstatus').disabled=true;
			document.getElementById('txtstatusdate').disabled=true;
			document.getElementById('biltodrp').disabled=true;
			document.getElementById('drprate').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('drpagetyp').disabled=true;
			document.getElementById('drpparent').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('drpagetyp').disabled=true;
			document.getElementById('drpagescat').disabled=true;
			document.getElementById('drpbranch').disabled=true;
			document.getElementById('txtdepocode').disabled=true;
			document.getElementById('txtoldagen').disabled=true;
			document.getElementById('chkvat').disabled = true;
			document.getElementById('chkraterevise').disabled = true;
			document.getElementById('drpgstus').disabled = true;
			document.getElementById('txtgstdt').disabled = true;
			document.getElementById('txtgstin').disabled = true;
			document.getElementById('drpgstatus').disabled = true;
			document.getElementById('txtgstclty').disabled = true;
			document.getElementById('txtarno').disabled=true;
			document.getElementById('txtgstprovid').disabled=true;
			//----------------------------------------------------------------------
			document.getElementById("Divgrid1").style.display = "none";
			document.getElementById('btnagencyname').disabled = true;
        document.getElementById('btnNew').disabled=false;//btnNew.Enabled = true;
        document.getElementById('btnQuery').disabled=false;//btnQuery.Enabled = true;
        document.getElementById('btnCancel').disabled=false;//btnCancel.Enabled = true;
        document.getElementById('btnExit').disabled=false;//btnExit.Enabled = true;
        document.getElementById('btnSave').disabled=true;//btnSave.Enabled = false;
        document.getElementById('btnModify').disabled=true;//btnModify.Enabled = false;
        document.getElementById('btnDelete').disabled=true;//btnDelete.Enabled = false;
        document.getElementById('btnExecute').disabled=true;//btnExecute.Enabled = false;
        document.getElementById('btnfirst').disabled=true;//btnfirst.Enabled = false;
        document.getElementById('btnnext').disabled=true;//btnnext.Enabled = false;
        document.getElementById('btnprevious').disabled=true;//btnprevious.Enabled = false;
        document.getElementById('btnlast').disabled=true;//btnlast.Enabled = false;		  
		  document.getElementById('hiddensaurabh').value="0";
		  document.getElementById('drpagetyp').disabled=true; 
		  //---------------------------------new saurabh added
		     document.getElementById('hiddenexecute').value="";
           document.getElementById('txtstatus').style.visibility="hidden";
			document.getElementById('txtstatusdate').style.visibility="hidden";
			document.getElementById('Status').style.visibility="hidden";
			document.getElementById('StatusDate').style.visibility="hidden";			
			document.getElementById('selectagencode').style.visibility="hidden";			
			document.getElementById('txtpincode').value="";
				document.getElementById('txtdesg').value="";
			document.getElementById('txturl').value="";			
			document.getElementById('txtphone1').value="";			
	        document.getElementById('mrvregion').value="";
			document.getElementById('txtbill').value="0";				
			document.getElementById('txturl').value="";
			document.getElementById('txtagencode').value="";		
			document.getElementById('txtagenname').value="";			
			document.getElementById('txtsagencycode').value="";			
			document.getElementById('drpagecate').value="0";
			document.getElementById('txtcrlimit').value="";			
			document.getElementById('txtagencyho').value="";			
			document.getElementById('drpagetyp').value="0";			
			document.getElementById('drpagecate').value="0";			
			document.getElementById('drpagescat').value="0";
			document.getElementById('txtagencyho').value="";			
			document.getElementById('txtsugagencyho').value="";			
			document.getElementById('drprepres').value="0";
			document.getElementById('txtsugagencyho').value="";
            document.getElementById('biltodrp').value="0";
			document.getElementById('getagsubcode').value="";
			document.getElementById('txtstatus2').value="";
			document.getElementById('txtalias').value="";
			document.getElementById('txtalert').value="";
			document.getElementById('txtremarks').value="";
			document.getElementById('txtagenname').value="";			
			document.getElementById('txtadd').value="";
			//********Pankaj			
			document.getElementById('txtaddress1').value="";
			document.getElementById('txtaddress2').value="";			
			//*******Pankaj			
			document.getElementById('txtstreet').value="";
			document.getElementById('txtdistrict').value="";
			document.getElementById('txtcountry').value="0";
			document.getElementById('drpzone').value="0";
			document.getElementById('txtsubsubagcd').value="";	
			document.getElementById('txtphone2').value="";			
			document.getElementById('drpcurtyp').value="0";			
			document.getElementById('txtmail').value="";			
			document.getElementById('txttan').value="";			
				document.getElementById('txtpan').value="";
			document.getElementById('txtbill').options.length=0;
			document.getElementById('txtbill').options[0]=new Option("--Select A/C Agency--","0");			
			document.getElementById('biltodrp').options.length=0;
			document.getElementById('biltodrp').options[0]=new Option("--Select Bill To--","0");			
			document.getElementById('drpcity').options.length=0;
			document.getElementById('drpcity').options[0]=new Option("--Select City--","0");
			document.getElementById('txtpincode').value="";			
			document.getElementById('txtstate').value="";
			document.getElementById('txtfax').value="";
			document.getElementById('txtfax1').value="";
			document.getElementById('txtenrolldate').value="";			
			document.getElementById('txtnoofvts').value="";
			document.getElementById('txtbusineedate').value="";			
			document.getElementById('txtmryrefno').value="";			
			document.getElementById('txtcredit').value="";			
			document.getElementById('txtstacno').value="";
			document.getElementById('drpregion').value="0";			
			document.getElementById('drpparent').value="0";
		document.getElementById("chkvat").checked=false;
			document.getElementById('drpparent').disabled=true;	
			document.getElementById('drprate').disabled=true;
			document.getElementById('txtsagencycode').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('drpagescat').disabled=true;
			document.getElementById('txtstatus2').disabled=true;
			document.getElementById('txtalias').disabled=true;	
			document.getElementById('mrvregion').disabled=true;			
			document.getElementById('drprate').value=document.getElementById('hiddenratecode').value;			
			document.getElementById('drpregion').disabled=true;
			document.getElementById('txtphone1').disabled=true;
			document.getElementById('txtalert').disabled=true;			
			document.getElementById('txtremarks').disabled=true;		
			document.getElementById('txtagenname').disabled=true;			
			document.getElementById('txtadd').disabled=true;
			//***********Pankaj			
			document.getElementById('txtaddress1').disabled=true;;
			document.getElementById('txtaddress2').disabled=true;			
			//**********End	
			document.getElementById('txtsubsubagcd').disabled=true;			
			document.getElementById('txtstreet').disabled=true;			
			document.getElementById('txtdistrict').disabled=true;			
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;			
			document.getElementById('txtphone2').disabled=true;			
			document.getElementById('txtphone2').disabled=true;			
			document.getElementById('txtmail').disabled=true;
			document.getElementById('drpcurtyp').disabled=true;
			document.getElementById('txttan').disabled=true;
			document.getElementById('txtpan').disabled=true;			
			document.getElementById('drprepres').disabled=true;
			document.getElementById('txtbill').disabled=true;			
			document.getElementById('drpagetyp').disabled=true;
			document.getElementById('txtpincode').disabled=true;
			document.getElementById('txtstate').disabled=true;
			document.getElementById('txtfax').disabled=true;
			document.getElementById('txtfax1').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtnoofvts').disabled=true;
			document.getElementById('biltodrp').disabled=true;
			document.getElementById('drptaluka').disabled=true;
			document.getElementById('drpcity').disabled=true;
			document.getElementById('drptaluka').value="0";
			document.getElementById('drpcity').value="0";
				document.getElementById('drpuserid').value="0";
					document.getElementById('drpuserid').disabled=true;
			document.getElementById('txtbusineedate').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtmryrefno').disabled=true;
			document.getElementById('txtcredit').disabled=true;
			document.getElementById('txtstacno').disabled=true;
			document.getElementById('txtsagencycode').disabled=true;
			document.getElementById('txturl').disabled=true;
			document.getElementById('txturl').disabled=true;
			document.getElementById('txtphone2').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('btnSave').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('drpregion').disabled=true;
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			document.getElementById('drpregion').value=0;
				    document.getElementById('lbcommdetail').disabled=true;
    document.getElementById('lbbankdetail').disabled=true;
    document.getElementById('lbstatusdetail').disabled=true;
    document.getElementById('lbbankmast').disabled=true;
    document.getElementById('lbpaymode').disabled=true;
    document.getElementById('lbcontactdetails').disabled=true;
			document.getElementById('fillbill').style.visibility="hidden";
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('chkvat').disabled=true;
			document.getElementById('btnNew').focus();		  		  
		  //------------------------------------------------------------		  
		  var f="0";
       document.getElementById('drpagetyp').disabled=true;
			}
			Agent_master.blankSession();
			setButtonImages();
return false;
}


 function  alertContents_chk(httpRequest)
 {
 
  if (httpRequest.readyState == 4) 
    {
        //alert(httpRequest.status);
        if (httpRequest.status == 200) 
        {
             //alert('hi..');
          var str=httpRequest.responseText;
            
       
        }
        else 
        {
            alert('There was a problem with the request.');
        }
    }
 
 
 }


function alertContents_save(httpRequest)
{
    if (httpRequest.readyState == 4) 
        {
            //alert(httpRequest.status);
            if (httpRequest.status == 200) 
            {
                 //alert('hi..');
              var str=httpRequest.responseText;
                
           
            }
            else 
            {
                alert('There was a problem with the request.');
            }
        }


}


function alertContents_null(httpRequest)
{

if (httpRequest.readyState == 4) 
        {
            //alert(httpRequest.status);
            if (httpRequest.status == 200) 
            {
                 //alert('hi..');
              var str=httpRequest.responseText;
                
           
            }
            else 
            {
                alert('There was a problem with the request.');
            }
        }


}



// Auto generated
// This Function is for check that weather this is case for new or modify

function changeoccured()
{
if(hiddentext=="new" )
			{
	
            uppercase3();
            }
            else
            {
            document.getElementById('txtagenname').value=document.getElementById('txtagenname').value.toUpperCase();
            }
return false;
}


//auto generated
//this is used for increment in code

function uppercase3()
		{
		   if(document.getElementById('drpparent').value=="0" && document.getElementById('txtagenname').value!="")
		        {
		        alert("Please select Type");
		        document.getElementById('drpparent').focus();
		        return false;
                }
    if(document.getElementById('txtagenname').value!="")
       {
		document.getElementById('txtagenname').value=document.getElementById('txtagenname').value.toUpperCase();
	    document.getElementById('txtalias').value=document.getElementById('txtagenname').value;
	    document.getElementById('txtbill').value=document.getElementById('txtagenname').value;
	    

		str=document.getElementById('txtagenname').value;
		var type=document.getElementById('drpparent').value;
		
	        if(document.getElementById('drpparent').value=="P") {
	            str = str.replace(/ /g, "");       
		        Agent_master.chkcode(str,type,fillcall);
		        //return false;
		        }
	        else 
                 {
                    // document.getElementById('txtagencode').disabled=false;
                     if(document.getElementById('txtagencode').value=="")
                             {
                        //     alert("Please Enter Agency Code !!");

                            document.getElementById('selectagencode').style.visibility = "visible";
                        document.getElementById('selectcode').focus();

                             return false;
                            // bindlistboxwithcode('P',document.getElementById('hiddencompcode').value,document.getElementById('hiddenuserid').value);
                    //here the div will open from which the user can select the Agency code
                    
                    
                     document.getElementById('selectagencode').style.visibility="visible";
                     document.getElementById('selectagencode').focus();
                      document.getElementById('selectagencode').style.top=parseInt(document.getElementById('tdagen').offsetTop)+ parseInt(document.getElementById('sectd').offsetTop)+parseInt(document.getElementById('frsttd').offsetTop)+parseInt(document.getElementById('txtagencode').offsetTop)-9;
                        document.getElementById('selectagencode').style.left=parseInt(document.getElementById('tdagen').offsetLeft)+ parseInt(document.getElementById('sectd').offsetLeft)+parseInt(document.getElementById('frsttd').offsetLeft)+parseInt(document.getElementById('txtagencode').offsetLeft) + parseInt(document.getElementById('OuterTable').offsetLeft) +65 ;
                            
                             //alert(document.getElementById('txtagencode').style.left);
//                             var agencode=document.getElementById('txtagencode').value;
//                   
//                            //dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 
Agent_master.chksubcode(str,agencode,type,subfillcall);

                             //return false;
                             }
           
                     
                            
                   //return false;
                }	
                
                
                var compcode=document.getElementById('hiddencompcode').value;
                var userid=document.getElementById('hiddenuserid').value;

                //dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 
Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,call_billto);
                Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,billtodrpcall);	
		        return false;
		        
		        }
		
}

function call_billto(response)
        {
        var value="";
            var ds=response.value;
                datares=ds;
            var bill = document.getElementById("txtbill");
            if(hiddentext=="new")
            {
            if(document.getElementById('drpparent').value=="C")
            {
            bill.options.length = 1;
             bill.options[0]=new Option(document.getElementById('txtagenname').value,document.getElementById('txtsagencycode').value)
            if(ds.Tables[0].Rows.length <= 0)
            {
                bill.options[bill.options.length] = new Option(document.getElementById('txtagenname').value,document.getElementById('txtsagencycode').value);
                bill.options.length;
                return false;

            }
            else
                {
                    for (var i = 0  ; i < ds.Tables[0].Rows.length; ++i)
                            {
                                    bill.options[bill.options.length] = new Option(ds.Tables[0].Rows[i].Agency_Name+"("+ds.Tables[0].Rows[i].CITY_NAME+")",ds.Tables[0].Rows[i].SUB_Agency_Code);
                                    bill.options.length;
                                    if(ds.Tables[0].Rows[i].Type=="P")
                                    {
                                    value=ds.Tables[0].Rows[i].SUB_Agency_Code;
                                    }
                            }
                }
            }
            else
            {
            bill.options[0]=new Option(document.getElementById('txtagenname').value,document.getElementById('txtsagencycode').value)

            }
             if(value!="")
            {document.getElementById('getagsubcode').value=value;
            document.getElementById("txtbill").value=value;
            }
        return false;
        }
        else
        {
        bill.options.length = 0;
        for (var i = 0  ; i < ds.Tables[0].Rows.length; ++i)
                            {
                                    bill.options[bill.options.length] = new Option(ds.Tables[0].Rows[i].Agency_Name+"("+ds.Tables[0].Rows[i].CITY_NAME+")",ds.Tables[0].Rows[i].SUB_Agency_Code);
                                    bill.options.length;
                                      if(ds.Tables[0].Rows[i].Type=="P")
                                    {
                                    value=ds.Tables[0].Rows[i].SUB_Agency_Code;
                                    }
                            }
                   document.getElementById("txtbill").value=varbiltocal;
                   setbilltocode();
                    if(value!="")
            {document.getElementById('getagsubcode').value=value;
            document.getElementById("txtbill").value=value;
            }
                            return false;
        }
      }





/*   commented by rahul goel on 1 dec 2012





		
function call_billto(response)
        {
            var ds=response.value;
                datares=ds;
            var bill = document.getElementById("txtbill");
            if(hiddentext=="new")
            {
            if(document.getElementById('drpparent').value=="C")
            {
            bill.options.length = 1;
             bill.options[0]=new Option(document.getElementById('txtagenname').value,document.getElementById('txtsagencycode').value)
            if(ds.Tables[0].Rows.length <= 0)
            {
                bill.options[bill.options.length] = new Option(document.getElementById('txtagenname').value,document.getElementById('txtsagencycode').value);
                bill.options.length;
                return false;

            }
            else
                {
                    for (var i = 0  ; i < ds.Tables[0].Rows.length; ++i)
                            {
                                    bill.options[bill.options.length] = new Option(ds.Tables[0].Rows[i].Agency_Name+"("+ds.Tables[0].Rows[i].CITY_NAME+")",ds.Tables[0].Rows[i].SUB_Agency_Code);
                                    bill.options.length;
                            }
                }
            }
            else
            {
            bill.options[0]=new Option(document.getElementById('txtagenname').value,document.getElementById('txtsagencycode').value)

            }
        return false;
        }
        else
        {
        bill.options.length = 0;
        for (var i = 0  ; i < ds.Tables[0].Rows.length; ++i)
                            {
                                    bill.options[bill.options.length] = new Option(ds.Tables[0].Rows[i].Agency_Name+"("+ds.Tables[0].Rows[i].CITY_NAME+")",ds.Tables[0].Rows[i].SUB_Agency_Code);
                                    bill.options.length;
                            }
                   document.getElementById("txtbill").value=varbiltocal;
                   setbilltocode();
                            return false;
        }
      }


*/

function setbilltocode()
{
//alert(document.getElementById("txtbill").value);
var bill = document.getElementById("txtbill");
if(hiddentext=="new")
          {
                    selbitocity="";
                       for(var i=0;i<=datares.Tables[0].Rows.length-1;i++)
                               {
                                  if(document.getElementById("txtbill").value==datares.Tables[0].Rows[i].SUB_Agency_Code)
                                        {
                                            selbitocity=document.getElementById("getagsubcode").value=datares.Tables[0].Rows[i].SUB_Agency_Code;
                                           // document.getElementById("getagsubcode").value=datares.Tables[0].Rows[i].SUB_Agency_Code
                                           fillsubho(datares.Tables[0].Rows[i].Agency_Code+datares.Tables[0].Rows[i].SUB_Agency_Code);
                                        }
                                        if(selbitocity=="")
                                   
                                        {
                                            document.getElementById("getagsubcode").value=document.getElementById('txtsagencycode').value;
                                            //=cityselected;
                                            fillsubho(datares.Tables[0].Rows[i].Agency_Code+document.getElementById("txtsagencycode").value);
                                        }

                                }
                                
                                
                           
            }
                            
            else
                 {
                     for(var i=0;i<=datares.Tables[0].Rows.length-1;i++)
                            {
                            if(document.getElementById("txtbill").value==datares.Tables[0].Rows[i].SUB_Agency_Code)
                                    {
                                    document.getElementById("getagsubcode").value=datares.Tables[0].Rows[i].SUB_Agency_Code
                                    fillsubho(datares.Tables[0].Rows[i].Agency_Code+datares.Tables[0].Rows[i].SUB_Agency_Code);
                                    //alert("hello");
                    
                                    }
                             }
                }
                
                
//return false;
}

function subfillcall(res)
		{
		        var ds=res.value;
		        var newstr;
		       // var str;
// Duplicacy of Agency..
/*  
		if(ds.Tables[0].Rows.length!=0)
		            {
		            alert("This Agency name has already assigned !! ");
		            document.getElementById('txtagenname').value="";
		            document.getElementById('txtagenname').focus();
            		document.getElementById('selectcode').value="";
		            return false;
            		}
		        else
		        {
                     */  		        
		                if(ds.Tables[1].Rows.length==0)
		                        {
		                            newstr = null;
		                            str = null;
		                        }
		                else
		                        {
		                            newstr = ds.Tables[1].Rows[0].sub_agency_code;
		                           // str = ds.Tables[0].Rows[0].Agency_Name;
		                        }
		                if(newstr !=null )
		                        {
		                        var code=newstr;//.substr(3,6);
		                        code++;

//		                        //str = str.replace(/ /g, "");
		                       document.getElementById('txtsagencycode').value=str.substr(0,3)+ code;
		                       //  document.getElementById('txtsagencycode').value=newstr+ code;
		                        document.getElementById('getagsubcode').value=document.getElementById('txtsagencycode').value;
		                        }
		                else
		                    {
		                    document.getElementById('txtsagencycode').value=str.substr(0,3)+ "0";
		                    document.getElementById('getagsubcode').value=document.getElementById('txtsagencycode').value;
		                    }
		                    if(ds.Tables[1].Rows[0].Agency_Type_Code== "" || ds.Tables[1].Rows[0].Agency_Type_Code==undefined)
		                    document.getElementById('drpagetyp').value="0";
		                    else
		               document.getElementById('drpagetyp').value=ds.Tables[1].Rows[0].Agency_Type_Code;
		               //document.getElementById('txtagencyho').value=ds.Tables[2].Rows[0].City_Name;
        		
//		        }
		
return false;
}
		
function fillcall(res)
		{
		/////////////////this is to check the sub agecny code for its duplicacy
		
		
		//////////////////////////////////////////////////////////////////////////////
		
		
		
		var ds=res.value;
		
		var newstr;
		var snewstr;
		    if(ds==null)
		    {
		      alert(res.error.description);
		      return false;
		    }
//	Duplicacy of Agency...
/*	    
		    if(ds.Tables[0].Rows.length!=0)
		    {
		    alert("This Agency name has already assigned !! ");
		    document.getElementById('txtagenname').value="";
		    if(document.getElementById('txtagenname').disabled==false)
		      document.getElementById('txtagenname').focus();
    		
		    return false;
		    }*/
		
//		        else
//		        {
                    str=str.replace(/ /g, "");
		            if(document.getElementById('hiddenauto').value==1)//By Manish Verma
                    { 
		                    if(ds.Tables[1].Rows.length==0)
		                        {
		                        newstr=null;
		                        }
		                    else
		                        {
		                         newstr=ds.Tables[1].Rows[0].agency_code;
		                         snewstr=ds.Tables[2].Rows[0].sub_agency_code;
		                        }
		                    if(newstr !=null )
		                        {
		                        var code=newstr;//.substr(2,4);
		                        code++;


		                        var code1 = snewstr;
		                        code1++;
		                        //alert(code);
                        		
		                        document.getElementById('txtagencode').value=str.substr(0,2)+ code;
		                        document.getElementById('txtsagencycode').value = str.substr(0, 3) + code1;
		                        //document.getElementById('getagcode').value=document.getElementById('txtagencode').value;
		                        document.getElementById('getagsubcode').value=document.getElementById('txtsagencycode').value;
		                        }
		                    else
		                            {
		                            document.getElementById('txtagencode').value=str.substr(0,2)+ "0";
		                            document.getElementById('txtsagencycode').value=str.substr(0,3)+ "0";
		                           // document.getElementById('getagcode').value=document.getElementById('txtagencode').value;
		                            document.getElementById('getagsubcode').value=document.getElementById('txtsagencycode').value;
		                            }
		                    document.getElementById('drpagetyp').focus();
		            }
		            
//		}
		
		return false;
		}
		
		
function chkagen()
		{
		var agencode=document.getElementById('txtagencode').value;
		Agent_master.chkag(agencode,fillchkagen);
		return false;
		}
		
function fillchkagen(res)
		{
		
		var ds= res.value;
		        if(ds.Tables[0].Rows.length==0)
		        {
		        alert("This Agency code does not Exist");
		        if(document.getElementById('txtagencode').disabled==false)
		            document.getElementById('txtagencode').focus();
		        return false;
		        }
		uppercase3();
		return false;
		}
		
		
		
		
		
		// this function chk agency code and then convert it in to upper case
		function uppercase()
		{
		document.getElementById('txtagencode').value=document.getElementById('txtagencode').value.toUpperCase();
		//document.getElementById('getagcode').value=document.getElementById('txtagencode').value;
		
//		auto=document.getElementById('hiddenauto').value;
//		if(auto==1)
//		{
//		document.getElementById('txtagencode').value=document.getElementById('txtagencode').value.toUpperCase();
//		//document.getElementById('getagcode').value=document.getElementById('txtagencode').value;
//			chkagen();
//			return false;
//			}
//			else
//			{
//			document.getElementById('txtagencode').value=document.getElementById('txtagencode').value.toUpperCase();
//			document.getElementById('getagcode').value=document.getElementById('txtagencode').value;
//			
//			var compcode=document.getElementById('hiddencompcode').value;
//            var userid=document.getElementById('hiddenuserid').value;
//            //dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 
//dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 
Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,call_billto);	
//			//userdefine();
//			return false;
//			}
//		return ;
		
		}



//		function chk() {
//		
//		var type=document.getElementById('drpparent').value;
//		if(type=="P")
//		{
//		if (document.getElementById('drpparent').value = "P")

//    document.getElementById('txtdesg').disabled = false;

//else {
//    document.getElementById('txtdesg').disabled = true;
//}
//		
//		}

		function chk() {
		    var type = document.getElementById('drpparent').value;
		    if (type == "P") {
		        document.getElementById('txtdesg').disabled = true;
		        document.getElementById('txtdesg').value = "";
		    }

		    else {
		        document.getElementById('txtdesg').disabled = false;
		        document.getElementById('txtdesg').value = "";
		    }
		    return false;
		}



		function enableddisabled()
		{
		    //debugger;
		var type=document.getElementById('drpparent').value;
		if (type == "P") {
		    if (document.getElementById('txtagenname').value != "") {
		        document.getElementById('txtagenname').value = "";
		        document.getElementById('txtagencode').value = "";
		        document.getElementById('txtsagencycode').value = "";
		    }
		    if (document.getElementById('selectagencode').style.visibility == "visible") {
		        document.getElementById('selectagencode').style.visibility = "hidden";
		    }
		    document.getElementById('txtagencode').disabled = true;
		    document.getElementById('txtsagencycode').disabled = true;
		    //document.getElementById('txtdesg').disabled=true;
		    document.getElementById('txtagencode').value = "";
		    //document.getElementById('txtagenname').focus();
		    document.getElementById('txtdesg').disabled = true;
		    document.getElementById('drpparent').focus();

		}

		else if (type == "0") {
		document.getElementById('txtdesg').disabled = true;
	
		}

		else {


		    if (document.getElementById('txtagenname').value != "") {
		        document.getElementById('txtagenname').value = "";
		        document.getElementById('txtagencode').value = "";
		        document.getElementById('txtsagencycode').value = "";
		    }
		    //document.getElementById('txtdesg').disabled=false;
		    document.getElementById('txtagencode').disabled = true;
		    document.getElementById('txtsagencycode').disabled = true;
		    //***************Added by Manish Verma*****************************
		    //debugger;
		    //bhati
		    //bindlistboxwithcode('P',document.getElementById('hiddencompcode').value,document.getElementById('hiddenuserid').value);
		    document.getElementById('selectagencode').style.visibility = "visible";
		    document.getElementById('selectagencode').focus();
		    document.getElementById('selectcode').value = "";
		    if (browser != "Microsoft Internet Explorer") {
		        aTag = eval(document.getElementById("txtagenname"))
		        var btag;
		        var leftpos = 0;
		        var toppos = 0;
		        do {
		            aTag = eval(aTag.offsetParent);
		            leftpos += aTag.offsetLeft;
		            toppos += aTag.offsetTop;
		            btag = eval(aTag)
		        } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
		        document.getElementById('selectagencode').style.top = document.getElementById("txtagenname").offsetTop + toppos + 24 + "px";
		        document.getElementById('selectagencode').style.left = document.getElementById("txtagenname").offsetLeft + leftpos - 3 + "px";

		        //                document.getElementById('selectagencode').style.top=parseInt(document.getElementById('tdagen').offsetTop)+ parseInt(document.getElementById('sectd').offsetTop)+parseInt(document.getElementById('frsttd').offsetTop)+parseInt(document.getElementById('txtagencode').offsetTop)+2 + "px";
		        //                document.getElementById('selectagencode').style.left=parseInt(document.getElementById('tdagen').offsetLeft)+ parseInt(document.getElementById('sectd').offsetLeft)+parseInt(document.getElementById('frsttd').offsetLeft)+parseInt(document.getElementById('txtagencode').offsetLeft) + parseInt(document.getElementById('OuterTable').offsetLeft) +67 + "px";           
		    }
		    else {
		        aTag = eval(document.getElementById("txtagenname"))
		        var btag;
		        var leftpos = 0;
		        var toppos = 0;
		        do {
		            aTag = eval(aTag.offsetParent);
		            leftpos += aTag.offsetLeft;
		            toppos += aTag.offsetTop;
		            btag = eval(aTag)
		        } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
		        document.getElementById('selectagencode').style.top = document.getElementById("txtagenname").offsetTop + toppos + 24 + "px";
		        document.getElementById('selectagencode').style.left = document.getElementById("txtagenname").offsetLeft + leftpos - 3 + "px";

		        //                document.getElementById('selectagencode').style.top=parseInt(document.getElementById('tdagen').offsetTop)+ parseInt(document.getElementById('sectd').offsetTop)+parseInt(document.getElementById('frsttd').offsetTop)+parseInt(document.getElementById('txtagencode').offsetTop)-9;
		        //                document.getElementById('selectagencode').style.left=parseInt(document.getElementById('tdagen').offsetLeft)+ parseInt(document.getElementById('sectd').offsetLeft)+parseInt(document.getElementById('frsttd').offsetLeft)+parseInt(document.getElementById('txtagencode').offsetLeft) + parseInt(document.getElementById('OuterTable').offsetLeft) +65;
		    }

		    document.getElementById('txtagencode').value = ""; //document.getElementById('selectagencode').value;

		    //*****************************************************************
		    //document.getElementById('txtagenname').focus();


		    document.getElementById('txtdesg').disabled = false;

		    document.getElementById('drpparent').focus();
		}
		
		return false;
		}
		
		//this function will get the code and bind it to the list box to select agency code
		function bindlistboxwithcode(agenname,compcode,userid)
		{
		
		Agent_master.bindagencycode(agenname,compcode,userid,call_bindcode)
		
		return false;
		}
		
		function call_bindcode(response)
		{
		var ds=response.value;
		var selectcode=document.getElementById('selectcode');
		selectcode.options.length=0;
		//*****By Manish Verma****
		selectcode.options[0]=new Option("--Select Agency Code--","0");
		//******************************
		//bill.options[bill.options.length] = new Option(document.getElementById('txtagenname').value,document.getElementById('txtagenname').value);
		var i;
		for(i=0;i<=ds.Tables[0].Rows.length-1;i++)
		{
		var code=ds.Tables[0].Rows[i].Agency_Code
		selectcode.options[selectcode.options.length] = new Option(ds.Tables[0].Rows[i].Agency_Name+" ("+code+") ",ds.Tables[0].Rows[i].Agency_Code);
		
		}
		//document.getElementById('selectcode').focus();
		//selectcode.value="0";
		return false;
		}
		
		//this function will set the value of agency code from list box to text of agency code

		
function setcode()
{
		var a="'";
		auto=document.getElementById('hiddenauto').value;
		document.getElementById('txtagencode').disabled=true;
		var agency=document.getElementById('selectcode').value ;            
		 var agencyarr=agency.split("(");             
		 var agencysplit=agencyarr[1];
		 var agencysplit12=  agencyarr[0];           
		 agencysplit=agencysplit.replace(")","");
		var agencode=document.getElementById('txtagencode').value=agencysplit;
		var subscode1=document.getElementById('txtsubsubagcd').value;
		if(subscode1!="")
		{
		var agensubcdarr=subscode1.split("("); 
		var agensubcd=agensubcdarr[1];
		agensubcd=agensubcd.replace(")","");
		var subscode=document.getElementById('txtsubsubagcd').value=agensubcd;
		}
		else
		{
		var subscode=document.getElementById('txtsubsubagcd').value=subscode1;
		}
		
		document.getElementById('txtagenname').value=agencysplit12;
		//document.getElementById('selectcode').value;
		//document.getElementById('selectagencode').style.visibility="hidden";
		//document.getElementById('getagcode').value=document.getElementById('txtagencode').value;
		if(auto==1)
		{
		        var txtagenname1= document.getElementById('txtagenname').value;
		        if(txtagenname1=="")
		        {
		            alert("Please Enter Agency Name");
		            document.getElementById('txtagenname').focus();
		            document.getElementById('selectcode').value="";
		            return false;
		        }
		        if(txtagenname1.indexOf("'")>=0)
	            {
	                txtagenname1=txtagenname1.replace("'","''");
	            }
        			
        		
		        str=txtagenname1//document.getElementById('txtagenname').value;
		        var type=document.getElementById('drpparent').value;
		        //dan
                var strtextd="";
                var  httpRequest =null;
                httpRequest= new XMLHttpRequest();
                if (httpRequest.overrideMimeType) {
                httpRequest.overrideMimeType('text/xml'); 
                }
                  //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
         
                    httpRequest.open( "GET","checksessiondan.aspx", false );
                    httpRequest.send('');
                    //alert(httpRequest.readyState);
                    if (httpRequest.readyState == 4) 
                    {
                        //alert(httpRequest.status);
                        if (httpRequest.status == 200) 
                        {
                            strtextd=httpRequest.responseText;
                        }
                        else 
                        {
                            //alert('There was a problem with the request.');
                            if(browser!="Microsoft Internet Explorer")
                            {
                                //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                            }
                        }
                    }
               if(strtextd!="sess")
               {
                   alert('session expired');
                   window.location.href="Default.aspx";
                   return false;
               } 
                Agent_master.chksubcode(str,agencode,type,subfillcall);
	     }
		    
		   var compcode=document.getElementById('hiddencompcode').value;
           var userid=document.getElementById('hiddenuserid').value;
           Agent_master.bindbillto(agencode,compcode,userid,call_billto);	

           Agent_master.bindbillto(agencode,compcode,userid,billtodrpcall);
       	   return false;
 }
		
		
// this function check that weather function is auto generated or not

		
function autoornot()
{
    document.getElementById('txtagenname').value=trim(document.getElementById('txtagenname').value);
  if(document.getElementById('hiddenauto').value==1)
{
changeoccured();
return false;
}
else
{
document.getElementById('txtagenname').value=document.getElementById('txtagenname').value.toUpperCase();
document.getElementById('txtalias').value=document.getElementById('txtagenname').value;
document.getElementById('txtbill').value=document.getElementById('txtagenname').value;

//******** Added By Manish Verma*****************************************
var compcode=document.getElementById('hiddencompcode').value;
var userid=document.getElementById('hiddenuserid').value;

//dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 
Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,call_billto);
Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,billtodrpcall);
//***********************/Manish******************************************************************

auto=document.getElementById('hiddenauto').value;

if(document.getElementById('drpparent').value=="C")
{
document.getElementById('txtagencode').disabled=true;
document.getElementById('txtsagencycode').disabled=false;
//bindlistboxwithcode('P',document.getElementById('hiddencompcode').value,document.getElementById('hiddenuserid').value);
//alert(document.getElementById('txtagencode').style.top);
document.getElementById('selectagencode').style.visibility="visible";
if(document.getElementById('selectcode').disabled==false)
document.getElementById('selectcode').focus();
}
else if(document.getElementById('drpparent').value=="P")
{
document.getElementById('txtagencode').disabled=false;
document.getElementById('txtsagencycode').disabled=false;
str=document.getElementById('txtagenname').value;
if(document.getElementById('txtagencode').disabled==false)
document.getElementById('txtagencode').focus();
var type = document.getElementById('drpparent').value;
str = str.replace(/ /g, "");
Agent_master.chkcode(str,type,fillcall);
}
else
{
document.getElementById('txtagencode').disabled=true;
document.getElementById('txtsubsubagcd').disabled=true;
document.getElementById('txtsubsubagcd').disabled=true;
}


return false;
}
return false;
}

// if function is user defined then userdefine function execute

function userdefine()
{
    if(document.getElementById('hiddenauto').value!=1)
    {
        if(hiddentext=="new")
        {
        
        document.getElementById('txtagencode').disabled=true;
        document.getElementById('txtsagencycode').disabled=true;

        var agencode=document.getElementById('txtagencode').value;
        var subagencode=document.getElementById('txtsagencycode').value;
        var compcode=document.getElementById('hiddencompcode').value;
        var userid=document.getElementById('hiddenuserid').value;
        var agenname=document.getElementById('txtagenname').value;
        var qbc=document.getElementById('drpuserid').value;
        //Agent_master.user(agencode,subagencode,compcode,userid,agenname,qbc,calluser);
        var res=Agent_master.user(agencode,subagencode,compcode,userid,agenname,qbc);
        calluser(res);

        return false;
        }
    }
return false;
}



//it is a call back or response function for userdefine


function calluser(res)
{
var ds= res.value;
//alert(ds.Tables[0].Rows.length);
//var tab=ds.Tables[0];
//var tab1=ds.Tables[1];
/*new change ankur*/
//if(ds.Tables[3].Rows[0].count!="0")
//{
//    alert("Please Choose another UserId. One agency is already assigned to this User");
//    document.getElementById('drpuserid').focus();
//    return false;
//}
if(document.getElementById('drpparent').value=="P")
{
        if(ds.Tables[0].Rows.length >0)
        {
        alert("This Agency code already Exist");
        if(document.getElementById('txtagencode').disabled==false)
        document.getElementById('txtagencode').focus();
        return false;
        }
         if (ds.Tables[1].Rows.length)
        {
        alert("This Sub Agency Code already exist");
        document.getElementById('txtsagencycode').focus();
        return false;
        }

         if (ds.Tables[2].Rows.length)
        {
        alert("This Agency Name is already been enroled");
        document.getElementById('txtagenname').focus();
        return false;
        }
        else
        {

        var txtagenho=document.getElementById('txtagencyho').value;
			        //var txtsubagenho=document.getElementById('txtsugagencyho').value;
			        var type=document.getElementById('drpparent').value;
			        var subcode=document.getElementById('txtsagencycode').value;
			        var compcode=document.getElementById('hiddencompcode').value;
                var userid=document.getElementById('hiddenuserid').value;
		        var txtagencode=document.getElementById('txtagencode').value;	
	        Agent_master.checkcode(txtagencode,compcode,userid,type,subcode,checkcode_callBack);
	        return false;
        }
}
else if (ds.Tables[1].Rows.length)
{
alert("This Sub Agency Code already exist");
document.getElementById('txtsagencycode').focus();
return false;
}

else if (ds.Tables[2].Rows.length)
{
alert("This Agency Name is already been enroled");
document.getElementById('txtagenname').focus();
return false;
}
else
{

var txtagenho=document.getElementById('txtagencyho').value;
			//var txtsubagenho=document.getElementById('txtsugagencyho').value;
			var type=document.getElementById('drpparent').value;
			var subcode=document.getElementById('txtsagencycode').value;
			var compcode=document.getElementById('hiddencompcode').value;
        var userid=document.getElementById('hiddenuserid').value;
		var txtagencode=document.getElementById('txtagencode').value;	
	Agent_master.checkcode(txtagencode,compcode,userid,type,subcode,checkcode_callBack);
	return false;
}
return false;
}



function checkcode_callBack(response)

{

var txtagencode=document.getElementById('txtsagencycode').value;

var agencode=document.getElementById('txtagencode').value;

var compcode=document.getElementById('hiddencompcode').value;

var userid=document.getElementById('hiddenuserid').value;

                   var ds=response.value;
                  
                   if(ds=="y")
                   {
                   alert("This Agency Code Already Exists ");
                   return false;
                   }
                   else
                   {
                  
                   Agent_master.commcheck(txtagencode,compcode,userid,agencode,commchk);
                   
                   }

}

function commchk(response)
{



//txtsagencycode
var txtagencode=document.getElementById('txtsagencycode').value;
var newagencode=document.getElementById('txtagencode').value;
var compcode=document.getElementById('hiddencompcode').value;


var userid=document.getElementById('hiddenuserid').value;

var ds=response.value;
if(ds=="n")
  {
alert("You Have Not Entered The Commission Detail Please Enter!!!");
document.getElementById('lbcommdetail').focus();
//document.getElementById('lbcommdetail').style.color="red";
document.getElementById('lbcommdetail').style.fontWeight="bold";
return false;
  }
  else
  {
  
  
 // Agent_master.statuscheck(txtagencode,compcode,userid,statuschk);
  Agent_master.paycheck1(txtagencode,compcode,userid,newagencode,paychk);
  
  document.getElementById('lbcommdetail').style.fontWeight="normal";

  }
}

function paychk(response)
{

var txtagencode=document.getElementById('txtagencode').value;

var compcode=document.getElementById('hiddencompcode').value;

var userid=document.getElementById('hiddenuserid').value;

 var ds=response.value;
                   if(ds=="n")
  {
alert("You Have Not Entered The Pay Mode Detail Please Enter!!!");
document.getElementById('lbpaymode').focus();
document.getElementById('lbpaymode').style.fontWeight="bold";
return false;
  }
  else
  {
  
  saveanother();
   document.getElementById('lbpaymode').style.fontWeight="normal";
  
  }
  
  

}



function statuschk(response)
{

var txtagencode=document.getElementById('txtsagencycode').value;

var compcode=document.getElementById('hiddencompcode').value;

var userid=document.getElementById('hiddenuserid').value;

 var ds=response.value;
if(ds=="n")
  {
alert("You Have Not Entered The Status Detail Please Enter!!!");
return false;
  }
  else
  {
 
    
  Agent_master.paycheck1(txtagencode,compcode,userid,paychk);
  
  }

}



function saveanother()
{

//alert("save details");
var txtagencode=document.getElementById('txtagencode').value;
var compcode=document.getElementById('hiddencompcode').value;
var userid=document.getElementById('hiddenuserid').value;
//var txtagencycode=document.getElementById('txtagencode').value;
			var drpagecate=document.getElementById('drpagecate').value;
			
			
			var txtsagencycode=document.getElementById('txtsagencycode').value;
			
			var txtagenname=document.getElementById('txtagenname').value;
			
			
			var drpagescat=document.getElementById('drpagescat').value;
			
			
			var txtstatus2=document.getElementById('txtstatus2').value;
			
			var txtalias=document.getElementById('txtalias').value;
			
			
			var mrvregion=document.getElementById('mrvregion').value;
			
			
			
			var drpregion=document.getElementById('drpregion').value;
			
			
			
			var txtphone1=document.getElementById('txtphone1').value;
			
			
			//txtagname.ReadOnly=false;
			
			var txtalert=document.getElementById('txtalert').value;
			
			var txtremarks=document.getElementById('txtremarks').value;
		
		
		//***********************************Pankaj	
			var txtadd=document.getElementById('txtadd').value;
			var txtaddress1=document.getElementById('txtaddress1').value;
			var txtaddress2=document.getElementById('txtaddress2').value;
			
			var txtstreet=document.getElementById('txtstreet').value;
			
			var txtdistrict=document.getElementById('txtdistrict').value;
			
			var txtcountry=document.getElementById('txtcountry').value;
			
			var txtphone2=document.getElementById('txtphone2').value;
			
			
			
			var txtmail=document.getElementById('txtmail').value;
			
			var txttan=document.getElementById('txttan').value;
			var txtpan=document.getElementById('txtpan').value;
			
			var drpress=document.getElementById('drprepres').value;
			//drpstatus.disabled=true;
			var txtbill=document.getElementById('txtbill').value;
			var dateformat=document.getElementById('hiddendateformat').value;
			var drpagetype=document.getElementById('drpagetyp').value;
			//drpsageo.disabled=true;
			var txtpincode=document.getElementById('txtpincode').value;
			var txtstate=document.getElementById('txtstate').value;
			//string zip="246763";
			var txtfax=document.getElementById('txtfax').value;
			var txtfax1=document.getElementById('txtfax1').value;
			var curtype=document.getElementById('drpcurtyp').value;
			//var txtenrolldate=document.getElementById('txtenrolldate').value;
			
			if(dateformat=="mm/dd/yyyy")
			{
			var txtenrolldate=document.getElementById('txtenrolldate').value;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			if(document.getElementById('txtenrolldate').value != "")
			{
			var txt=document.getElementById('txtenrolldate').value;
			var txt1=txt.split("/");
			var dd=txt1[0];
			var mm=txt1[1];
			var yy=txt1[2];
			var txtenrolldate=mm+'/'+dd+'/'+yy;
			}
			else
			{
			var txtenrolldate=document.getElementById('txtenrolldate').value;
			}
			}
			if(dateformat=="yyyy/mm/dd")
			{
			if(document.getElementById('txtenrolldate').value !="")
			{
			var txt=document.getElementById('txtenrolldate').value;
			var txt1=txt.split("/");
			var yy=txt1[0];
			var mm=txt1[1];
			var dd=txt1[2];
			var txtenrolldate=mm+'/'+dd+'/'+yy;
			}
			else
			{
			var txtenrolldate=document.getElementById('txtenrolldate').value;
			}
			}
			if(dateformat==null || dateformat=="" || dateformat=="undefined")
			{
			var txtenrolldate=document.getElementById('txtenrolldate').value;
			}
			
			
			var txtnoofvts=document.getElementById('txtnoofvts').value;
			//document.getElementById('txtstatusdate').disabled=false;
			
			var drpcity=document.getElementById('drpcity').value;
			var drptaluka=document.getElementById('drptaluka').value;
			
			
			
			//var txtbussinessdate=document.getElementById('txtbusineedate').value;
			if(dateformat=="mm/dd/yyyy")
			{
			var txtbussinessdate=document.getElementById('txtbusineedate').value;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			if(document.getElementById('txtbusineedate').value !="")
			{
			var txt=document.getElementById('txtbusineedate').value;
			var txt1=txt.split("/");
			var dd=txt1[0];
			var mm=txt1[1];
			var yy=txt1[2];
			var txtbussinessdate=mm+'/'+dd+'/'+yy;
			}
			else
			{
			var txtbussinessdate=document.getElementById('txtbusineedate').value;
			}
			}
			if(dateformat=="yyyy/mm/dd")
			{
			if(document.getElementById('txtbusineedate').value !="")
			{
			var txt=document.getElementById('txtbusineedate').value;
			var txt1=txt.split("/");
			var yy=txt1[0];
			var mm=txt1[1];
			var dd=txt1[2];
			var txtbussinessdate=mm+'/'+dd+'/'+yy;
			}
			else
			{
			var txtbussinessdate=document.getElementById('txtbusineedate').value
			}
			}
			if(dateformat==null || dateformat=="" || dateformat=="undefined")
			{
			var txtbussinessdate=document.getElementById('txtbusineedate').value;
			}
			
			
			
			var endate=new Date(txtenrolldate);

            var bdate=new Date(txtbussinessdate);
            if(endate > bdate)
            {
            alert("Business Start date must be greater than Enrollment date");
            return false;
            }
			
			var txtmyrefno=document.getElementById('txtmryrefno').value;
			var txtcredit=document.getElementById('txtcredit').value;
			var txtsacno=document.getElementById('txtstacno').value;
			var txtsagencycod=document.getElementById('txtsagencycode').value;
			
			var txturl=document.getElementById('txturl').value;
			
			
			
			var txtcrlimit=document.getElementById('txtcrlimit').value;
			var txtagenname=document.getElementById('txtagenname').value;
		
			
			var txtagenho=document.getElementById('txtagencyho').value;
			var txtsubagenho=document.getElementById('txtsugagencyho').value;
			var paymode1="0";
			var type=document.getElementById('drpparent').value;
			var zone=document.getElementById('drpzone').value;
			var acagen=document.getElementById('biltodrp').value;
			var rategrp=document.getElementById('drprate').value;
			if(document.getElementById('txtbill').value=="")
			{
			    txtbill=document.getElementById('txtbill').value;
			}
			else
			{
			    txtbill=document.getElementById('txtbill').value;
			}
		var vat;	
			if(document.getElementById("chkvat").checked==true)
     {
        vat="1";
        }
    else
       { 
        vat="0";
        }
			
			document.getElementById('selectagencode').style.visibility="hidden";
			
			Agent_master.save(compcode,drpagecate,txtagencode,txtsagencycode,txtagenname,drpagescat,txtstatus2,txtalias,mrvregion,drpregion,txtphone1,txtalert,txtremarks,txtadd,txtstreet,txtdistrict,txtcountry,txtphone2,txtmail,txttan,txtpan,drpress,txtbill,drpagetype,txtpincode,txtstate,txtfax,txtenrolldate,txtnoofvts,drpcity,txtbussinessdate,txtmyrefno,txtcredit,txtsacno,txtsagencycod,txturl,txtcrlimit,txtagenho,txtsubagenho,userid,paymode1,type,zone,txtaddress1,txtaddress2,curtype,acagen,txtfax1,rategrp,drptaluka,vat);
			
			
		
			
			
			document.getElementById('txtpincode').value="";

			
			document.getElementById('txturl').value="";
			
			document.getElementById('txtphone1').value="";
			
			
			
	        document.getElementById('mrvregion').value="";
				
			
			document.getElementById('txturl').value="";

			
			
			document.getElementById('txtagencode').value="";
		
			document.getElementById('txtagenname').value="";
			
			document.getElementById('txtsagencycode').value="";
			
			document.getElementById('drpagecate').value="0";
			//drpregion.SelectedValue="0";
			
			document.getElementById('txtcrlimit').value="";
			
			document.getElementById('txtagencyho').value="";
			
			document.getElementById('drpagetyp').value="0";
			
			document.getElementById('drpagecate').value="0";
			
			document.getElementById('drpagescat').value="0";
			//drpregion.SelectedValue="0";
			
			document.getElementById('txtagencyho').value="";
			
			document.getElementById('txtsugagencyho').value="";
			
			document.getElementById('drprepres').value="0";
			//drpcity.SelectedValue="0";
			
			document.getElementById('txtsugagencyho').value="";


			
			
			
			document.getElementById('txtstatus2').value="";
			
			document.getElementById('txtalias').value="";
			//txtagname.Text="";
			
			document.getElementById('txtalert').value="";
			
			document.getElementById('txtremarks').value="";
			
			
			document.getElementById('txtagenname').value="";
			
			
			//Pankaj Gupta
			document.getElementById('txtadd').value="";
			document.getElementById('txtaddress1').value="";
			document.getElementById('txtaddress2').value="";
			//Complete
			document.getElementById('txtstreet').value="";
			
			document.getElementById('txtdistrict').value="";
			
			document.getElementById('txtcountry').value="0";
			document.getElementById('drpzone').value="0";
			
			document.getElementById('txtphone2').value="";
			
			document.getElementById('drpcurtyp').value="0";
			
			document.getElementById('txtmail').value="";
			
			document.getElementById('txttan').value="";
			
				document.getElementById('txtpan').value="";
			//			drprepres.disabled=true;
			//			drpstatus.disabled=true;
			
			document.getElementById('txtbill').value="0";
			
			
			//			drpsageo.disabled=true;
			
			document.getElementById('txtpincode').value="";
			
			document.getElementById('txtstate').value="";
			//string zip="246763";
			
			document.getElementById('txtfax').value="";
			
			document.getElementById('txtenrolldate').value="";
			
			document.getElementById('txtnoofvts').value="";
			
			//document.getElementById('txtstatusdate').value="";
			//			drpcity.disabled=true;
			//string url="www.4cplus.com";
			
			document.getElementById('txtbusineedate').value="";
			
			document.getElementById('txtmryrefno').value="";
			
			document.getElementById('txtcredit').value="";
			
			document.getElementById('txtstacno').value="";
			document.getElementById('drpcity').value="0";
			document.getElementById('drptaluka').value="0";
			document.getElementById('drpregion').value="0";
			document.getElementById('drpparent').value="0";
			document.getElementById('txtsugagencyho').value="";
			document.getElementById('getagsubcode').value="";
			document.getElementById('drprate').value="0";
			document.getElementById("chkvat").checked=false;
			
			document.getElementById('drprate').disabled=true;
			document.getElementById('biltodrp').value="0";
			document.getElementById('biltodrp').disabled=true;
			document.getElementById('drpparent').disabled=true;
			
			
			document.getElementById('drpagecate').disabled=true;
			
			document.getElementById('txtagencode').disabled=true;
			
			
			document.getElementById('txtsagencycode').disabled=true;
			
			document.getElementById('txtagenname').disabled=true;
			
			
			document.getElementById('drpagescat').disabled=true;
			
			
			document.getElementById('drpagecate').disabled=true;
			
			document.getElementById('txtagencode').disabled=true;
			
			
			document.getElementById('txtsagencycode').disabled=true;
			
			document.getElementById('txtagenname').disabled=true;
			
			
			document.getElementById('drpagescat').disabled=true;
			
			
			document.getElementById('txtstatus2').disabled=true;
			
			document.getElementById('txtalias').disabled=true;
			
			
			document.getElementById('mrvregion').disabled=true;
			
			
			
			document.getElementById('drpregion').disabled=true;
			
			
			
			document.getElementById('txtphone1').disabled=true;
			
			
			//txtagname.ReadOnly=false;
			
			document.getElementById('txtalert').disabled=true;
			
			document.getElementById('txtremarks').disabled=true;
		
			document.getElementById('txtagenname').disabled=true;
			
			
			//Pankaj Gupta
			document.getElementById('txtadd').disabled=true;
			document.getElementById('txtaddress1').disabled=true;
			document.getElementById('txtaddress2').disabled=true;
			//End
			
			
			document.getElementById('txtstreet').disabled=true;
			
			document.getElementById('txtdistrict').disabled=true;
			
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;
			
			document.getElementById('txtmail').disabled=true;
			document.getElementById('drpcurtyp').disabled=true;
			document.getElementById('txttan').disabled=true;
			document.getElementById('txtpan').disabled=true;
			
			document.getElementById('drprepres').disabled=true;
			//drpstatus.disabled=true;
			document.getElementById('txtbill').disabled=true;
			
			document.getElementById('drpagetyp').disabled=true;
			//drpsageo.disabled=true;
			document.getElementById('txtpincode').disabled=true;
			document.getElementById('txtstate').disabled=true;
			//string zip="246763";
			document.getElementById('txtfax').disabled=true;
			document.getElementById('txtfax1').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtnoofvts').disabled=true;
			//document.getElementById('txtstatusdate').disabled=false;
			
			document.getElementById('drpcity').disabled=true;
			document.getElementById('drptaluka').disabled=true;
			
			//string url="www.4cplus.com";
			document.getElementById('txtbusineedate').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtmryrefno').disabled=true;
			document.getElementById('txtcredit').disabled=true;
			document.getElementById('txtstacno').disabled=true;
			document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabledd);
			//document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabled);
			document.getElementById('txturl').disabled=true;
			document.getElementById('txturl').disabled=true;
			document.getElementById('txtphone2').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			//string paymode=bank;
			
			document.getElementById('btnSave').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			
			
			
			
			document.getElementById('drpregion').disabled=true;
			//drpcity.SelectedItem.Text="--Select City--";
			//drpregion.disabled=false;
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			
			
			
			
			document.getElementById('txtalias').disabled=true;
			document.getElementById('drpagetyp').disabled=true;
			document.getElementById('drpcity').disabled=true;
			document.getElementById('drptaluka').disabled=true;
			document.getElementById('txtstatus').disabled=true;
			document.getElementById('txtstatusdate').disabled=true;
			document.getElementById('txtalert').disabled=true;
			
			document.getElementById('btnModify').disabled=true;
			document.getElementById('btnQuery').disabled=false;
			document.getElementById('btnfirst').disabled=true;
			document.getElementById('btnprevious').disabled=true;
			document.getElementById('btnnext').disabled=true;
			document.getElementById('btnlast').disabled=true;
			document.getElementById('btnCancel').disabled=false;
			document.getElementById('btnNew').disabled=false;
			document.getElementById('btnSave').disabled=true;
			document.getElementById('btnExecute').disabled=true;
			document.getElementById('btnDelete').disabled=true;
			
			
			
			
			
			
			
			document.getElementById('hiddensaurabh').value="0";
			if(document.getElementById('hiddenpermission').value=="1")
			{
			document.getElementById('btnQuery').disabled=true;
			//document.getElementById('btnQuery').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			
			
			
			
			return false;
			
			
}

function openbillto()
{

document.getElementById('fillbill').style.visibility="visible";
document.getElementById('txtbill').value="";

return false;
}

function puttotext()

{

document.getElementById('txtbill').value=document.getElementById('txtbill').value;
document.getElementById('fillbill').style.visibility="hidden";
return false;
}


function fillsubho(ab)

{
        //var subagencode=document.getElementById('txtbill').value;
        var subagencode=ab;
        var compcode=document.getElementById('hiddencompcode').value;
        var userid=document.getElementById('hiddenuserid').value;
        Agent_master.subho(subagencode,compcode,userid,callfillsubho)
return false;
}

function callfillsubho(res)
{
 ds = res.value;
 
 //alert(res.vlaue.Tables[0].Rows[0].city_name);
 if(ds.Tables[0].Rows.length!=0)
 {
 //if(ds.Tables[0].Rows[0].city_name!="undefined")
document.getElementById("txtsugagencyho").value=ds.Tables[0].Rows[0].city_name
}
else
{
document.getElementById("txtsugagencyho").value=cityselected;
}
return false;
}

function setfocus()
{
//document.getElementById('drpagetyp').focus();
}

function billtodrpcall(response)
{
var ds=response.value;
//if(document.getElementById('selectagencode').style.visibility == "visible")
//document.getElementById('selectcode').focus();
var bill = document.getElementById("biltodrp");
 
                
            if(hiddentext=="new")
                        {
            if(document.getElementById('drpparent').value=="C")
            {
            bill.options.length = 1;
            
             if(document.getElementById('txtdesg').value=="")
            {
            bill.options[0]=new Option(document.getElementById('txtagenname').value+"("+document.getElementById('txtsagencycode').value+")",document.getElementById('txtsagencycode').value)
            }
            
            else
            {
            
            
             bill.options[0]=new Option(document.getElementById('txtdesg').value.toUpperCase()+", "+document.getElementById('txtagenname').value+"("+document.getElementById('txtsagencycode').value+")",document.getElementById('txtsagencycode').value)
            
            }
            if(ds.Tables[0].Rows.length <= 0)
            {
            
              if(document.getElementById('txtdesg').value=="")
            {
            
            
                bill.options[bill.options.length] = new Option(document.getElementById('txtagenname').value+"("+document.getElementById('txtsagencycode').value+")",document.getElementById('txtsagencycode').value);
               }
               
               else
               {
                 bill.options[bill.options.length] = new Option(document.getElementById('txtdesg').value.toUpperCase()+", "+document.getElementById('txtagenname').value+"("+document.getElementById('txtsagencycode').value+")",document.getElementById('txtsagencycode').value);
               }
                bill.options.length;
                return false;

            }
            else
                {
                    for (var i = 0  ; i < ds.Tables[0].Rows.length; ++i)
                            {
                            if(document.getElementById('txtdesg').value=="")
                            {
                               bill.options[bill.options.length] = new Option(ds.Tables[0].Rows[i].Agency_Name+"("+ds.Tables[0].Rows[i].SUB_Agency_Code+")"+"("+ds.Tables[0].Rows[i].CITY_NAME+")",ds.Tables[0].Rows[i].SUB_Agency_Code);
                            }
                            else{
                            
                                    bill.options[bill.options.length] = new Option(document.getElementById('txtdesg').value.toUpperCase()+", "+ds.Tables[0].Rows[i].Agency_Name+"("+ds.Tables[0].Rows[i].SUB_Agency_Code+")"+"("+ds.Tables[0].Rows[i].CITY_NAME+")",ds.Tables[0].Rows[i].SUB_Agency_Code);
                                    
                                }    
                                    bill.options.length;
                            }
                }
            }
            else
            {
            if(document.getElementById('txtdesg').value=="")
            {
             bill.options[0]=new Option(document.getElementById('txtagenname').value+"("+document.getElementById('txtsagencycode').value+")",document.getElementById('txtsagencycode').value)
            }
            else
            {
         
            bill.options[0]=new Option(document.getElementById('txtdesg').value.toUpperCase()+", "+document.getElementById('txtagenname').value+"("+document.getElementById('txtsagencycode').value+")",document.getElementById('txtsagencycode').value)

            }

            }
        return false;
        }
        else
        {
        bill.options.length = 0;
        for (var i = 0  ; i < ds.Tables[0].Rows.length; ++i)
                            {
                            
                            
                             if(document.getElementById('txtdesg').value=="")
            {
                
                 bill.options[bill.options.length] = new Option(ds.Tables[0].Rows[i].Agency_Name+"("+ds.Tables[0].Rows[i].SUB_Agency_Code+")",ds.Tables[0].Rows[i].SUB_Agency_Code);
                
                            
               }
               
               else
               
               {             
               
                 bill.options[bill.options.length] = new Option(document.getElementById('txtdesg').value.toUpperCase()+"--"+ds.Tables[0].Rows[i].Agency_Name+"("+ds.Tables[0].Rows[i].SUB_Agency_Code+")",ds.Tables[0].Rows[i].SUB_Agency_Code);
                                  
                       }           
                                  
                                    bill.options.length;
                            }
                   document.getElementById("biltodrp").value=biltovar;
                  
                            return false;
        }
      }
      
      
      
      
  function f1()
  {
      alert("You have not entered Commission Detail.Please Enter!!!");
  }    
  function f2()
  {
      alert("This Agency Name is already been enroled");
  }
  function f3()
  {
      alert("This Sub Agency Code already exist");
  }    
  function f4()
  {
      alert("This Agency code already Exist");
  }
  function f5()
  {
      alert("Business Start date must be greater than Enrollment date");
  }
  function f6()
  {
      alert("Please select City");
  }
  function fco()
  {
      alert("Please select Country");
  }
  function f7()
  {
    alert("Please enter Parent Agency Code");
  }
  function f8()
  {
      alert("Please enter Alias");
  }
  function f9()
  {
      alert("Please enter the Agent Sub Category.");
  }
  function f10()
  {
      alert("Please enter Agency Category.");
  }
  function f11()
  {
      alert("Please select Agency Type.");
  }
  function f12()
  {
      alert("Please enter Agency Name");
  }
  function f13()
  {
      alert("Please enter Type ");
  }   
   function fbh()
   {
    alert("Please enter Parent Agency Sub Code");
   }
  function fp()
  {   
      alert("You have not entered Pay Mode Detail.Please Enter!!!");
  }
  function fsv()
  {   
    show="0";
   var saurabh="2";
    alert("Data Updated Successfully");
  }
  function ftal()
  {
     alert("Please Enter Taluka");
  }
  function fzone()
  {
    alert("Please Enter Zone");
  }
  
  function ff()
  {
    alert('Data Saved Successfully');
  }
  function usercode()
  {
    alert("Please Choose another UserId. One agency is already assigned to this User");
  }
  function f14()
  {
   alert("Please Enter the Agency Name");
   }
 function f15()
  {
   alert("Please Enter the Branch Name");
   }
    function frgc()
  {
   alert("Please Enter the Rate Group");
   }
  function regalert()
  {
     alert("Please enter Region Name");
  }  
  function RateGroupalert()
  {
     alert("Please select Rate Group");
  }    
  
  function mrvrefno()
  {
  alert("Please select MRV Reference No. ");
  }
  function extracd()
  {
  alert("Please select extra code. ");
  }
function eventcalling(event)
{
if( document.activeElement!=null && document.activeElement.id!="txtmail") //
{
if(event.keyCode==97) 
    event.keyCode= 65;
if(event.keyCode==98) 
    event.keyCode= 66;
if(event.keyCode==99) 
    event.keyCode= 67;
if(event.keyCode==100) 
    event.keyCode= 68;
if(event.keyCode==101) 
    event.keyCode= 69;
if(event.keyCode==102) 
    event.keyCode= 70;
if(event.keyCode==103) 
    event.keyCode= 71;
if(event.keyCode==104) 
    event.keyCode= 72;
if(event.keyCode==105) 
    event.keyCode= 73;
if(event.keyCode==106) 
    event.keyCode= 74;
if(event.keyCode==107) 
    event.keyCode= 75;
if(event.keyCode==108) 
    event.keyCode= 76;
if(event.keyCode==109) 
    event.keyCode= 77;
if(event.keyCode==110) 
    event.keyCode= 78;
if(event.keyCode==111) 
    event.keyCode= 79;
if(event.keyCode==112) 
    event.keyCode= 80;
if(event.keyCode==113) 
    event.keyCode= 81;
if(event.keyCode==114) 
    event.keyCode= 82;
if(event.keyCode==115) 
    event.keyCode= 83;
if(event.keyCode==116) 
    event.keyCode= 84;
if(event.keyCode==117) 
    event.keyCode= 85;
if(event.keyCode==118) 
    event.keyCode= 86;
if(event.keyCode==119) 
    event.keyCode= 87;
if(event.keyCode==120) 
    event.keyCode= 88;
if(event.keyCode==121) 
    event.keyCode= 89;
if(event.keyCode==122) 
    event.keyCode= 90;
}
}

//********This Function is used to check the duplicate code in user defined mode*******By Manish Verma
function chkUserCode()
{
    document.getElementById('txtagencode').value=document.getElementById('txtagencode').value.toUpperCase();
     var compcode=document.getElementById('hiddencompcode').value;
//     var userid=document.getElementById('hiddenuserid').value;
    if(document.getElementById('hiddenauto').value!=1 && (hiddentext=="new"))
    {
      var res=Agent_master.chkDupUser(document.getElementById('txtagencode').value,compcode);
      if(res.value!=null)
      {
        if(res.value.Tables[0].Rows.length>0)
        {
              f4();
              if(document.getElementById('txtagencode').disabled==false)
    	            document.getElementById('txtagencode').focus();
    	        return false;
        }
      }
      
    }
    
    
}
//******************************************************************************************************

function chkbindbillto()
{

   document.getElementById('txtsagencycode').value=document.getElementById('txtsagencycode').value.toUpperCase();
   document.getElementById('getagsubcode').value=document.getElementById('txtsagencycode').value;
   var compcode=document.getElementById('hiddencompcode').value;
     var userid=document.getElementById('hiddenuserid').value;
    if(document.getElementById('hiddenauto').value!=1)
    {
      //dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 
Agent_master.bindbillto(document.getElementById('txtsagencycode').value,compcode,userid,call_billto);
      Agent_master.bindbillto(document.getElementById('txtsagencycode').value,compcode,userid,billtodrpcall);
    }

}


/////////////emp code/////////


function F2fillempcode(event) {

    if (event.keyCode == 113) {
        if (document.activeElement.id == "txtemcode") {

            var compcode = document.getElementById('hiddencomcode').value;
            var empname = document.getElementById('txtemcode').value;
            //    document.getElementById("divempcode").style.display = "block";
            document.getElementById("lstempcode").style.display = "block";
            //     document.getElementById('divempcode').style.top = 278 + "px";
            //     document.getElementById('divempcode').style.left = 580 + "px";
            document.getElementById('lstempcode').focus();
            var ds = contact_detail.empcodebind(compcode, empname);
            bindempcode_callbackb(ds);
        }
    }

}

function bindempcode_callbackb(res) {
    ds_AccName = res.value;

    if (ds_AccName != null) {
        var pkgitem = document.getElementById("lstempcode");
        pkgitem.options.length = 0;
        pkgitem.options[0] = new Option("-Select Employe Name-", "0");
        pkgitem.options.length = 1;
        for (var i = 0; i < ds_AccName.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds_AccName.Tables[0].Rows[i].NAME + '(' + ds_AccName.Tables[0].Rows[i].EMP_CODE + ')' + '/' + ds_AccName.Tables[0].Rows[i].FATHER_NAME + '/' + ds_AccName.Tables[0].Rows[i].BRANCH_NAME + '/' + ds_AccName.Tables[0].Rows[i].ADDR1 + '/' + ds_AccName.Tables[0].Rows[i].PIN + '/' + ds_AccName.Tables[0].Rows[i].EMAIL + '/' + ds_AccName.Tables[0].Rows[i].PHONE + '/' + ds_AccName.Tables[0].Rows[i].DATE_OF_BIRTH + '/' + ds_AccName.Tables[0].Rows[i].DESIG, ds_AccName.Tables[0].Rows[i].EMP_CODE);
            pkgitem.options.length;
        }
    }
    document.getElementById("lstempcode").value = "0";
    // document.getElementById("divempcode").value = "";
    document.getElementById('lstempcode').focus();

    return false;

}

function Clickrempcode_ret(event) {


    if (event.keyCode == 13 || event.type == "click") {
        if (document.activeElement.id == "lstempcode") {
            if (document.getElementById('lstempcode').value == "0") {
                alert("Please select Employe Name");
                return false;
            }

            var page = document.getElementById('lstempcode').value;
            agencycode = page;
            for (var k = 0; k <= document.getElementById('lstempcode').length - 1; k++) {
                if (document.getElementById('lstempcode').options[k].value == page) {
                    if (browser != "Microsoft Internet Explorer") {
                        var abc = document.getElementById('lstempcode').options[k].textContent;


                    }
                    else {
                        var abc = document.getElementById('lstempcode').options[k].innerText;
                    }
                    abc = abc.split("/");
                    abc = abc[0];

                    document.getElementById('txtemcode').value = abc;

                    document.getElementById('hdempcode').value = page;
                    document.getElementById('txtcontactperson').value = fndnull(ds_AccName.Tables[0].Rows[k - 1].NAME)
                    //    document.getElementById('txtaddress').value=  ds_AccName.Tables[0].Rows[k-1].ADDR1+ds_AccName.Tables[0].Rows[k-1].ADDR2+ds_AccName.Tables[0].Rows[k-1].ADDR3;
                    document.getElementById('txtdesignation').value = fndnull(ds_AccName.Tables[0].Rows[k - 1].DESIG)
                    document.getElementById('TextBox2').value = fndnull(ds_AccName.Tables[0].Rows[k - 1].EMAIL)
                    document.getElementById('txtphoneno').value = fndnull(ds_AccName.Tables[0].Rows[k - 1].MOBILE)
                    document.getElementById('txtdob').value = fndnull(ds_AccName.Tables[0].Rows[k - 1].DATE_OF_BIRTH)
                    //   document.getElementById('drpbranch1').value=  ds_AccName.Tables[0].Rows[k-1].BRAN_CODE




                    //         document.getElementById("divempcode").style.display = "none";
                    document.getElementById("lstempcode").style.display = "none";
                    document.getElementById('txtemcode').focus();
                    return false;

                }

            }


        }

    }
    else if (event.keyCode == 27) {

        //      document.getElementById("divempcode").style.display = "none";
        document.getElementById("lstempcode").style.display = "none";
        document.getElementById('txtemcode').focus();
        return false;
    }

}

function fndnull(val) {
    if (val == null || val == "") {
        val = "";
        return val;
    }
    else
        return val;


}


function numeric(event) {



    var charCode = (event.which) ? event.which : event.keyCode
    if ((charCode == 32 || charCode == 8 || charCode == 43 || charCode == 9) || (charCode >= 48 && charCode <= 57))
        return true;
    else
        return false;
    return false;
}


function mobileno(id) {
 //  if (document.getElementById('hdnmobiledetail').value == "Nambibia") {

        var aa = document.getElementById(id).value;
    
        
 var n=aa.indexOf("+"); 
        if (aa.length>=14 && aa.length <= 18) {



            var MyNumbers = ("" + aa).split("");
            var p = 0;
            for (var i = 0; i < aa.length; i++) {
              
                if (MyNumbers[i] == "+") {

                    p++;
                }

            }

            if (p > 1) {

                alert('Please Enter Correct no ');
                document.getElementById(id).value="";
                return false;
            }

            if (MyNumbers[0] == "+") {


            }
            else {
                alert("Please Fill Correct No")
                document.getElementById(id).focus();
                document.getElementById(id).value = ""
                return false;
            }



           


  
            
            
            

            if (MyNumbers[4] == " ") {


            }
            else {
                alert("Please Fill Correct No");
                document.getElementById(id).focus();
                document.getElementById(id).value = ""
                return false;
            }




            if (MyNumbers[5] != "+") {


            }
            else {
                alert("Please Fill Correct No")
                document.getElementById(id).focus();
                document.getElementById(id).value = ""
                return false;
            }



            if (MyNumbers[6] != "+" || MyNumbers[1] != "+" || MyNumbers[3] != "+" || MyNumbers[7] != "+" || MyNumbers[8] != "+" || MyNumbers[9] != "+" || MyNumbers[10] != "+" || MyNumbers[11] != "+" || MyNumbers[12] != "+" || MyNumbers[13] != "+" || MyNumbers[14] != "+" || MyNumbers[15] != "+" || MyNumbers[16] != "+") {


            }
            else {
                alert("Please Fill Correct No")
                document.getElementById(id).focus();
                document.getElementById(id).value = ""
                return false;
            }

            if (MyNumbers[7] == " ") {


            }
            else {
                alert("Please Fill Correct No");
                document.getElementById(id).focus();
                document.getElementById(id).value = "";
                return false;
            }





         




            //}
        }
        else {
            alert("Please Fill Correct No");
            document.getElementById(id).focus();
            document.getElementById(id).value = "";
            return false;
        }

    }


//    else 
//    
//    {
//        var aa = document.getElementById(id).value;
//        if (aa.length == 10) {
//        }
//        else {

//            alert("Please Enter Correct Mobile No")
//            document.getElementById(id).value = "";
//            return false;
//        }


//    }
//}





    function emailidvalidation() {

        if (document.getElementById('drpemail').value == "Y") {
            if (document.getElementById('txtmail').value == "") {

                alert("Please Enter Email Id");
                document.getElementById('txtmail').focus();
                return false;
            }


        }
    }




    function alertforagency(val) {


        if (document.getElementById('drpparent').value == 'P') {
            if (val.Tables[0].Rows.length > 0) {
                alert("Agency Code Already Exist with Type Parent");
                return false;
            }

            if (val.Tables[1].Rows.length > 0) {
                alert("Agency Subcode Already Exist");
                return false;
            }
        }
        else if (document.getElementById('drpparent').value == 'C') {

            if (val.Tables[1].Rows.length > 0) {
                alert("Agency Subcode Already Exist");
                return false;
            }
        }

    }


    function checkcommnull(dl) {
        if (dl == "commnull") {
            alert("Please Fill Commission Pop Up");
            return false;
        }


        if (dl == "paymodenull") {
            alert("Please Fill Pay Mode Pop Up");
            return false;
        }

    }



    function ClientisNumberforcompany(event) {
        var browser = navigator.appName;
        //alert(event.which);
        if (event.shiftKey == true)
            return false;
        if (browser != "Microsoft Internet Explorer") {
            if ((event.which >= 48 && event.which <= 57) || (event.which == 9) || (event.which == 0) || (event.which == 8) || (event.which == 11) || (event.which == 13) || (event.which == 44)) {

                return true;
            }
            else {
                return false;
            }
        }
        else {
            if ((event.keyCode >= 48 && event.keyCode <= 57) || (event.keyCode == 9) || (event.keyCode == 11) || (event.keyCode == 13) || (event.keyCode == 44)) {

                return true;
            }
            else {
                return false;
            }
        }

    }


    function check_mendetory(id) {
        var label_text = jq('#' + id).text();
        return label_text;
    }
    function MenditoryField() {
        if (check_mendetory('lblgstatus').indexOf('*') >= 0) {
            if (document.getElementById('drpgstatus').value == "") {
                alert("Please Select GST Applicable.")
                document.getElementById('drpgstatus').focus();
                return false;
            }
        }
        if (check_mendetory('lblgstus').indexOf('*') >= 0) {
            if (document.getElementById('drpgstus').value == "") {
                alert("Please Select GST Registration")
                document.getElementById('drpgstus').focus();
                return false;
            }
        }
        if (check_mendetory('lblgstdt').indexOf('*') >= 0) {
            if (document.getElementById('txtgstdt').value == "") {
                alert("Please Fill GST Reg. Date")
                document.getElementById('txtgstdt').focus();
                return false;
            }
        }
        if (check_mendetory('lblgst').indexOf('*') >= 0) {
            if (document.getElementById('txtgstin').value == "") {
                alert("Please Fill GSTIN")
                document.getElementById('txtgstin').focus();
                return false;
            }
        }
        if (check_mendetory('lblgstclty').indexOf('*') >= 0) {
            if (document.getElementById('txtgstclty').value == "") {
                alert("Please Select Client Type")
                document.getElementById('txtgstclty').focus();
                return false;
            }
        }
        if (check_mendetory('lblarnno').indexOf('*') >= 0) {
            if (document.getElementById('txtarno').value == "") {
                alert("Please Fill ARN No.")
                document.getElementById('txtarnno').focus();
                return false;
            }
        }
        if (check_mendetory('lblgstprovid').indexOf('*') >= 0) {
            if (document.getElementById('txtgstprovid').value == "") {
                alert("Please Fill GST Provisional Id")
                document.getElementById('txtgstprovid').focus();
                return false;
            }
        }
    }
