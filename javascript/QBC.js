// JScript File
var roundoff = "";
var paivar = "";
var fmgInsert = "";
var fmgsize = "";
var fmgcolor = "";
var sharepub = "";
var mainbookingid = "";
var clientfromconfig = "";
var chkbtnStatus = "";
var hidcopy = "";
////add for category
var hidcopymodicategory = "";
var ALLOWBOOKINGGST="";
//////////////////////
var tradedisc = "";
var removepkg = "";
var arrEdition_Item = '';
var adR = 0;
var executequery;
var rownumEx = 0;
var xmlDoc1 = null;
var xmlObj1 = null;
var req1 = null;
var httpRequest1 = null;
var validuse = "";
var ds_rol;
var alrt34 = "0";
var flagmode = "";
var glob_area = "";
var cyop_code = "";
var cyop_desc = "";
var objadscat;
var totor = 0;
var che_flag = 0;
var check_or = "0";
var flagins = "";
var originserts = "";
var fal = 0;
//***********************by Manish Verma*******************************************************
var modifyMatter = "0";
var prevcioidformatter = "";
//*********************************************************************************************
var inserttimeflag = "0";
var flag_line = "";
var tempins;
var pkgcode;
var ds_adon;
var ds_sch;
var che_flag = 0;
var check_or = "0";
var txtbillarea = "";
var flagrate;
var idfocus = "";
var globfromline = "";
var globtoline = "";
var globextrarate = "";
////////////////
var suboradd;
var glbcardamt = "";
var noofinsert = "";
var noofinsertlo = "";
var rowwhenupdate = "";
var fillinsert = "";
var insertval = "";
var subtractrow;
var objadscat;
var globalgross;
var globalbill;
var boxpercen = "";
var boxgamt;
var boxbill;
var glspedisc = "0";
var glspadisc = "0";
var glspeccharge = "0";
var glpre = "0";
var savtotid;
var getid = "";
var countgridloop = "";
var schemediscount = "";
var gbdataset;
var globalschemedisc = "";
var globalschemefrom = "";
var gldisctyp = "";
var insdatetemp;
var perbox = "";
var retrows = "";
var browser = navigator.appName;
var browserversion = msieversion();
var idnew = 0;
var previnsertion = "0";
var repeatdate = "0";
var req = "";
/*new change ankur 23 feb*/
var gblogowithmatter = "";
//var xmlDoc = new ActiveXObject("Microsoft.XMLDOM"); 
//var xmlObj;


function msieversion() {
    var ua = window.navigator.userAgent
    var msie = ua.indexOf("MSIE ")

    if (msie > 0)      // If Internet Explorer, return version number
        return parseInt(ua.substring(msie + 5, ua.indexOf(".", msie)))
    else                 // If another browser, return 0
        return 0

}







function holdbooking() {
    if (document.getElementById('bookdiv') != null) {
        var count1 = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
        for (var a1 = 0; a1 < count1; a1++) {
            if (document.getElementById('inssta' + a1).value == "booked")
                document.getElementById('inssta' + a1).value = "hold";
        }
        checkValidation();
        return false;
    }
    //    if (flagmode == "Query") {
    //    var cioid = document.getElementById('txtciobookid').value;

    //    var compcode = document.getElementById('hiddencompcode').value;
    //    var res = QBC.showgridforexe(cioid, compcode);

    //    var ds = res.value;


    //    for (var a1 = 0; a1 < ds.Tables[0].Rows.length; a1++) {

    //        if (ds.Tables[0].Rows[a1].Insert_status == "booked") {
    //            document.getElementById('inssta' + a1).value = "hold";
    //            var instdate = showDate(ds.Tables[0].Rows[a1].Insert_date);
    //            QBC.updatehold(compcode, "hold", cioid, ds.Tables[0].Rows[a1].Edition, instdate);
    //            
    //            
    //        }

    //    }

    //}

    //else {

    //    for (var a1 = 0; a1 < document.getElementById('hiddenrowcount').value; a1++) {



    //        if (document.getElementById('inssta' + a1).value == "booked") {
    //            document.getElementById('inssta' + a1).value = "hold";
    //              
    //        }
    //    }
    //    
    //    
    //    if (document.getElementById('hdndepo').value == "depo") {
    //            checkValidation();
    //         }
    //    
    //    }

    //    return false;

}

function showDate(datevalue) {
    var dateformate = document.getElementById("hiddendateformat").value;
    var datev = new Date(datevalue);
    var dd = datev.getDate();
    var mm = datev.getMonth() + 1;
    var yy = datev.getFullYear();

    if (dd < 10)


        dd = "0" + dd;

    if (mm < 10)
        mm = "0" + mm;

    var returndate = "";

    if (dateformate == "dd/mm/yyyy") {
        returndate = dd + "/" + mm + "/" + yy;
    }
    else if (dateformate == "mm/dd/yyyy") {
        returndate = mm + "/" + dd + "/" + yy;
    }
    else if (dateformate == "yyyy/mm/dd") {
        returndate = yy + "/" + mm + "/" + dd;
    }
    return returndate;
}











function setBillVal(client_val) {
    document.getElementById('drpbillto_qbc').options[1] = new Option(client_val, client_val);
    document.getElementById('drpbillto_qbc').value = client_val;
    ocument.getElementById('hiddenbillto').value = document.getElementById('drpbillto_qbc').value
}
function loadXML(xmlFile) {
    var httpRequest = null;

    if (browser != "Microsoft Internet Explorer") {

        req = new XMLHttpRequest();
        //alert(req);
        req.onreadystatechange = getMessage;
        req.open("GET", xmlFile, true);
        req.send('');

    }
    else {
        xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
        xmlDoc.async = "false";
        xmlDoc.onreadystatechange = verify;
        xmlDoc.load(xmlFile);
        xmlObj = xmlDoc.documentElement;
        // alert(xmlObj.childNodes(0).childNodes(0).text);
    }

}

function getMessage() {
    var response = "";
    //alert(req.readyState);
    if (req.readyState == 4) {
        //alert(req.status);
        if (req.status == 200) {
            response = req.responseText;
            //alert(response);
        }
    }

    var parser = new DOMParser();
    xmlDoc = parser.parseFromString(response, "text/xml");
    xmlObj = xmlDoc.documentElement;
}

loadXML('xml/billcycle.xml');

function verify() {
    // 0 Object is not initialized 
    // 1 Loading object is loading data 
    // 2 Loaded object has loaded data 
    // 3 Data from object can be worked with 
    // 4 Object completely initialized 
    if (xmlDoc.readyState != 4) {
        return false;
    }
}


////////////////////this is the function to bind the ad s cat on change of ad cat from main form


function filladsubcatmain() {
    var chmandat = "";
    if (document.getElementById('txtagency').value == "" && document.getElementById("divagencymain").style.display == "none") {
        alert("Please Select Agency by Pressing F2");
        document.getElementById("drpadcategory").value = "0";
        document.getElementById('drpadsubcategory').style.backgroundColor = "#FFFFFF";
        document.getElementById('txtagency').focus();
        return false;
    }
    // for mobile no
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbmobileno').textContent;
    }
    else {
        chmandat = document.getElementById('lbmobileno').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtMobile').value == "") {
            alert("Please Enter Mobile No.");
            document.getElementById("drpadcategory").value = "0";
            //            document.getElementById('txtMobile').style.backgroundColor = "#0000FF";
            document.getElementById('txtMobile').focus();
            return false;
        }
        else if (document.getElementById('txtMobile').value.length < 10) {
            alert("Mobile Length is 10 digit.");
            document.getElementById("drpadcategory").value = "0";
            document.getElementById('txtMobile').focus();
            return false;
        }
    }
    /*mysql*/
    document.getElementById('txtcardrate').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    var compcode = document.getElementById('hiddencompcode').value;
    var adcategory = document.getElementById('drpadcategory').value;
    if (document.getElementById('drpadtype').value == "0") {
        alert("Please select the Ad type");
        if (document.getElementById('drpadtype').disabled == false) {
            document.getElementById('drpadtype').focus();
        }
        return false;

    }

    if (adcategory == "0") {
        //alert("Please select the value");
        /*2may*/
        document.getElementById('drpadsubcategory').options.length = 0;
        document.getElementById('hiddenad_subcat').value = "";
        document.getElementById('drpadcat3').options.length = 0;
        document.getElementById('hiddenadscat3').value = "";
        document.getElementById('drpadcat4').options.length = 0;
        document.getElementById('hiddenadscat4').value = "";
        document.getElementById('drpadcat5').options.length = 0;
        document.getElementById('hiddenadscat5').value = "";
        return false;
    }

    /*new change ankur 9 feb*/
    document.getElementById('drpcolortype').value = "0";
    document.getElementById('drpadsubcategory').options.length = 0;
    document.getElementById('hiddenad_subcat').value = "";
    document.getElementById('drpadcat3').options.length = 0;
    document.getElementById('hiddenadscat3').value = "";
    document.getElementById('drpadcat4').options.length = 0;
    document.getElementById('hiddenadscat4').value = "";
    document.getElementById('drpadcat5').options.length = 0;
    document.getElementById('hiddenadscat5').value = "";

    //var pkgitem=document.getElementById('drpbgcolor');
    //pkgitem.options[0]=new Option("-Select Bg color-","0");
    //////////////////////////////
    bindPackage_CategoryChange();
    /*new change 15 feb*/
    document.getElementById('hiddencatcode').value = document.getElementById('drpadcategory').value
    ////////////////////////

    /* change    */
    //document.getElementById('drpcolor').value="0";
    document.getElementById('drpadcat3').options.length = 0;
    document.getElementById('drpadcat4').options.length = 0;
    document.getElementById('drpadcat5').options.length = 0;
    if (document.getElementById('drpadcategory').value == "CI0") {
        var objSelect = document.getElementById("drpuom");
        document.getElementById("drpuom").value = "ROW";
        gettheuomdesc();
        //Set selected
        //  setSelectedValue(objSelect, "ROW");
    } else

        if (document.getElementById('drpadcategory').value == "DI0") {
            var objSelect = document.getElementById("drpuom");
            document.getElementById("drpuom").value = "SQ0";
            gettheuomdesc();
            //Set selected
            //setSelectedValue(objSelect, "SQ0");
        } else {
            document.getElementById("drpuom").value = "0";
        }




    ////////////////////////////////////////////
    objadscat = document.getElementById('drpadsubcategory');
    QBC.getadsubcat(compcode, adcategory, call_filladscat);
    //////this is to chk that whether grid is visible than on change of ad cat from main it effects into the grid also

    if (document.getElementById('tblinsert').innerHTML != "" && document.getElementById(len) != null) {
        var len = "bookdiv";
        var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
        var k;
        var adcat;
        var i = 0;

        for (k = 0; k < y - 1; k++) {

            while (document.getElementById("card" + i) == null) {
                i = i + savtotid;

            }
            adcat = "adcat" + i;
            if (document.getElementById(adcat) != null) {
                document.getElementById(adcat).value = document.getElementById('drpadcategory').value;
            }
            //
            adscat3id = "adscat3" + i;
            if (document.getElementById(adscat3id) != null) {
                var adscat3 = document.getElementById(adscat3id);
                adscat3.value = "";
            }

            adscat4id = "adscat4" + i;
            if (document.getElementById(adscat4id) != null) {
                var adscat4 = document.getElementById(adscat4id);
                adscat4.value = "";
            }

            adscat5id = "adscat5" + i;
            if (document.getElementById(adscat5id) != null) {
                var adscat5 = document.getElementById(adscat5id);
                adscat5.value = "";
            }
            //
            i = parseInt(i) + 1;

        }


    }
    //this is to bind the fontcolor drpdown,bgcolordrpdown and bullet  dropdown
    if (document.getElementById('drppackagecopy').options.length > 0) {
        bindbgandfont()
    }
    //////////////////

    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    bindrategroupvode(adcategory);
    return false;

}
function bindPackage_CategoryChange() {
    var res = QBC.bindpackage_category(document.getElementById('hiddencompcode').value, document.getElementById('drpadtype').value, document.getElementById('drpadcategory').value);
    var ds = res.value;


    if (ds != null) {
        var Parent = document.getElementById("test_grid");
        var gridlength = document.getElementById("test_grid").rows.length;
        while (parseInt(gridlength) >= 1) {
            Parent.deleteRow(gridlength - 1);
            gridlength = parseInt(gridlength) - 1;
        }
    }
    var pkg = document.getElementById('drppackage');
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {

        pkg.options[0] = new Option("-Select package-", "0");

        pkg.options.length = 1;

        var j = "";
        var test_grid_var = document.getElementById("test_grid");
        for (var i = 0; i < res.value.Tables[0].Rows.length; ++i) {
            j = parseInt(i, 10) + 2;
            if (j.toString().length == 1) {

                j = "0" + j.toString();
            }

            var GridViewNewRow = test_grid_var.insertRow(i);
            var cell1 = GridViewNewRow.insertCell(0);
            if (browser != "Microsoft Internet Explorer") {
                cell1.appendChild(document.createElement('test_grid'));
                test_grid_var.rows[i].cells[0].innerHTML = "<INPUT id=test_grid_ctl" + j + "_test_chk type=checkbox name=test_grid$ctl" + j + "$test_chk> <SPAN class=multichk id=test_grid_ctl" + j + "_test_lbl>" + res.value.Tables[0].Rows[i].Package_Name + "</SPAN> <SPAN id=test_grid_ctl" + j + "_pack_id style=\"DISPLAY: none\">" + res.value.Tables[0].Rows[i].pck_code + "</SPAN>";
            }
            else {
                //   cell1.appendChild(test_grid_var);
                test_grid_var.rows[i].cells[0].innerHTML = "<INPUT id=test_grid_ctl" + j + "_test_chk type=checkbox name=test_grid$ctl" + j + "$test_chk> <SPAN class=multichk id=test_grid_ctl" + j + "_test_lbl>" + res.value.Tables[0].Rows[i].Package_Name + "</SPAN> <SPAN id=test_grid_ctl" + j + "_pack_id style=\"DISPLAY: none\">" + res.value.Tables[0].Rows[i].pck_code + "</SPAN>";
            }
            pkg.options[pkg.options.length] = new Option(res.value.Tables[0].Rows[i].Package_Name, res.value.Tables[0].Rows[i].pck_code);

            pkg.options.length;

        }
    }
    else {

        pkg.options.length = 0;
        pkg.options[0] = new Option("-Select package-", "0");
    }
}
function call_filladscat(res) {
    var ds = res.value;
    objadscat.options.length = 0;
    objadscat.options[0] = new Option("-Select-", "0");
    //alert(pkgitem.options.length);
    objadscat.options.length = 1;
    for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
        objadscat.options[objadscat.options.length] = new Option(ds.Tables[0].Rows[i].Adv_Subcat_Name, ds.Tables[0].Rows[i].Adv_Subcat_Code);
        objadscat.options.length;

    }
}

/*
This is the function to bind ad cat3 on the change of ad s cat drop down and also the value changes of ad s cat in 
the grid also
*/
///////////this is the function which fills into grid on change of ad s cat when grid is visibile
function filladscatingrid() {
    document.getElementById('txtcardrate').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    var matter_textstring;
    if (browser != "Microsoft Internet Explorer") {
        matter_textstring = document.getElementById('tblinsert').textContent;
    }
    else {
        matter_textstring = document.getElementById('tblinsert').innerHTML
    }
    document.getElementById('hiddenad_subcat').value = document.getElementById('drpadsubcategory').value
    document.getElementById('hiddenadscat3').value = "";
    document.getElementById('hiddenadscat4').value = "";
    document.getElementById('hiddenadscat5').value = "";
    bindadscat3();
    if (matter_textstring != "") {
        var len = "bookdiv";
        var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
        var k;
        var adsubcat;
        var i = 0;
        var adsubcat_var = document.getElementById('drpadsubcategory');
        for (k = 0; k < y - 1; k++) {

            adsubcat = "ads" + i;
            var adsubcat_vari = document.getElementById(adsubcat);
            var par1 = (adsubcat_vari.parentNode).parentNode;
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById(adsubcat).value = adsubcat_var.value

                //
                adscat3id = "adscat3" + i;
                if (document.getElementById(adscat3id) != null) {
                    var adscat3 = document.getElementById(adscat3id);
                    adscat3.value = "";
                    //adscat3.options.length=0;
                    //adscat3.options[adscat3.options.length] = new Option("Select","0");
                }

                adscat4id = "adscat4" + i;
                if (document.getElementById(adscat4id) != null) {
                    var adscat4 = document.getElementById(adscat4id);
                    adscat4.value = "";
                    //  adscat4.options.length=0;
                    // adscat4.options[adscat4.options.length] = new Option("Select","0");
                }

                adscat5id = "adscat5" + i;
                if (document.getElementById(adscat5id) != null) {
                    var adscat5 = document.getElementById(adscat5id);
                    adscat5.value = "";
                    // adscat5.options.length=0;
                    // adscat5.options[adscat5.options.length] = new Option("Select","0");
                }
            }
            else {
                par1.all[adsubcat].value = adsubcat_var.value

                //
                adscat3id = "adscat3" + i;
                if (par1.all[adscat3id] != null) {
                    var adscat3 = par1.all[adscat3id];
                    adscat3.value = "";
                    //adscat3.options.length=0;
                    //adscat3.options[adscat3.options.length] = new Option("Select","0");
                }

                adscat4id = "adscat4" + i;
                if (par1.all[adscat4id] != null) {
                    var adscat4 = par1.all[adscat4id];
                    adscat4.value = "";
                    //  adscat4.options.length=0;
                    // adscat4.options[adscat4.options.length] = new Option("Select","0");
                }

                adscat5id = "adscat5" + i;
                if (par1.all[adscat5id] != null) {
                    var adscat5 = document.getElementById(adscat5id);
                    adscat5.value = "";
                    // adscat5.options.length=0;
                    // adscat5.options[adscat5.options.length] = new Option("Select","0");
                }
            }
            //

            i = parseInt(i) + 1;

        }


    }
    var compcode = document.getElementById('hiddencompcode').value;
    //QBC.bindadcat3(document.getElementById('drpadsubcategory').value,compcode,"0",fillscat3); 
    QBC.bindadcat3(document.getElementById('drpadsubcategory').value, compcode, "0");
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    //alert(document.getElementById('tblinsert').innerHTML)

    /////////this is to bind the ad cat3 drop down
    // filladscatingrid();

}

/////////this is to bind the ad s cat3 drpdown on change of ad sub cat drop down

function bindadscat3() {

    var adscat = document.getElementById('drpadsubcategory').value;
    var compcode = document.getElementById('hiddencompcode').value;
    ///if 0 than it is to bind ad cat3 drp down
    QBC.bindadcat3(adscat, compcode, "0", call_bindadcat3);
    return false;


}

function call_bindadcat3(res) {
    var ds = res.value;
    var pkgitem = document.getElementById("drpadcat3");
    pkgitem.options.length = 0;
    pkgitem.options[0] = new Option("-Select ad s cat-", "0");
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {

        pkgitem.options.length = 1;
        for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].catname, ds.Tables[0].Rows[i].catcode);

            pkgitem.options.length;

        }

    }
    document.getElementById('hiddenadscat3').value = document.getElementById("drpadcat3").value;
    document.getElementById("drpadcat4").value = "0";
    document.getElementById("drpadcat4").options.length = 1;
    document.getElementById("drpadcat5").value = "0";
    document.getElementById("drpadcat5").options.length = 1;
}
///this is to bind the adcat 4 drop down on change of adcat 3 dropdown

function bindadscat4() {
    document.getElementById('txtcardrate').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    var adscat = document.getElementById('drpadcat3').value;
    document.getElementById('hiddenadscat3').value = document.getElementById("drpadcat3").value;
    /*2may*/
    document.getElementById('hiddenadscat4').value = "";
    document.getElementById('hiddenadscat5').value = "";
    var compcode = document.getElementById('hiddencompcode').value;
    /* change */
    document.getElementById('drpadcat5').options.length = 0;

    //

    var compcode = document.getElementById("hiddencompcode").value;
    var res = QBC.bindadcat3(adscat, compcode, "1");
    call_bindadcat4(res);
    if (document.getElementById("bookdiv") != null) {
        bindadcat4(res.value, "main");
    }
    //

    ///if 1 than it is to bind ad cat4 drp down
    //QBC.bindadcat3(adscat,compcode,"1",call_bindadcat4);
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    return false;


}
function call_bindadcat4(res) {
    var ds = res.value;
    var pkgitem = document.getElementById("drpadcat4");
    pkgitem.options.length = 0;
    pkgitem.options[0] = new Option("-Select ad s cat-", "0");
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {

        pkgitem.options.length = 1;
        for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].Cat_Name, ds.Tables[0].Rows[i].Cat_Code);

            pkgitem.options.length;

        }

    }
    document.getElementById('hiddenadscat4').value = document.getElementById("drpadcat4").value;
}
///////this is to bind the adcat 5 drop down on change of adcat 4 drop down

function bindadcat5() {
    document.getElementById('txtcardrate').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    var adscat = document.getElementById('drpadcat4').value;
    document.getElementById('hiddenadscat4').value = document.getElementById("drpadcat4").value;
    document.getElementById('hiddenadscat5').value = "";
    var compcode = document.getElementById('hiddencompcode').value;

    //

    var compcode = document.getElementById("hiddencompcode").value;
    var res = QBC.bindadcat3(document.getElementById("drpadcat4").value, compcode, "2");
    if (document.getElementById("bookdiv") != null) {
        bindadcatgrid5(res.value, "main");
    }
    //

    ///if 2 than it is to bind ad cat5 drp down 
    call_bindadcat5(res);
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    //QBC.bindadcat3(adscat,compcode,"2",call_bindadcat5);
    return false;

}

function call_bindadcat5(res) {
    var ds = res.value;
    var pkgitem = document.getElementById("drpadcat5");
    pkgitem.options.length = 0;
    pkgitem.options[0] = new Option("-Select ad s cat-", "0");
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {

        pkgitem.options.length = 1;
        for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].Cat_Name, ds.Tables[0].Rows[i].Cat_Code);

            pkgitem.options.length;

        }

    }
    document.getElementById('hiddenadscat5').value = document.getElementById("drpadcat5").value;

}

function getcat5val() {
    document.getElementById('txtcardrate').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    document.getElementById('hiddenadscat5').value = document.getElementById("drpadcat5").value;
    //

    if (document.getElementById("bookdiv") != null) {
        var len = document.getElementById("bookdiv").getElementsByTagName('table')[0].rows.length;

        for (var i = 0; i < len - 1; i++) {
            adscat5id = "adscat5" + i;
            if (document.getElementById(adscat5id) != null) {
                document.getElementById(adscat5id).value = document.getElementById("drpadcat5").value;
            }
        }
    }
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    //
}

//////////////////this functrion is to get the selected bullet premium

function getbullpremium() {
    var len = "bookdiv";
    if (document.getElementById('drpbullet').value == "BO1" || document.getElementById('drpbullet').value == "CO0" || document.getElementById('drpbullet').value == "SB0") {
        document.getElementById('drpbgcolor').disabled = false;
    }
    else {

        document.getElementById('drpbgcolor').value = "0";
        document.getElementById('drpbgcolor').disabled = true;
    }
    if (document.getElementById(len) != null) {
        var c = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
        for (var k = 0; k < c - 1; k++) {
            var siz = "siz" + k;
            var filename = "fil" + i;
            document.getElementById(siz).value = "";

        }
    }
    document.getElementById('txttotalarea').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    document.getElementById('txtcardrate').value = "";
    var bulletcode = document.getElementById('drpbullet').value;
    var compcode = document.getElementById('hiddencompcode').value;
    var userid = document.getElementById('hiddenuserid').value;
    if (bulletcode != "0") {
        QBC.getbullprem(compcode, bulletcode, userid, "", "", call_getbullprem);
    }
    else {
        document.getElementById('lbbullprem').value = "";
        document.getElementById('hiddenbullprem').value = "";
        if (document.getElementById('txtgrossamt').value != "") {
            //gettherate();
        }
    }
    document.getElementById('hiddenbullet').value = document.getElementById('drpbullet').value;

    return false;



}
function call_getbullprem(res) {
    var ds = res.value;
    if (ds.Tables[0].Rows.length > 0) {
        document.getElementById('lbbullprem').value = ds.Tables[0].Rows[0].bullet_charges
        document.getElementById('hiddenbullprem').value = ds.Tables[0].Rows[0].bullet_charges
        document.getElementById('hiddenbulletpremtype').value = ds.Tables[0].Rows[0].Bullet_Charges_Type
        if (document.getElementById('txtgrossamt').value != "") {
            // gettherate();
        }

    }
    //////////////////////////////modify category
    if (hidcopymodicategory == "copy") {
        QBC.onchangebg(call_bindbgcolor);
    }


}
function eventcalling(event) {

    if (event.keyCode == 97)
        event.keyCode = 65;
    if (event.keyCode == 98)
        event.keyCode = 66;
    if (event.keyCode == 99)
        event.keyCode = 67;
    if (event.keyCode == 100)
        event.keyCode = 68;
    if (event.keyCode == 101)
        event.keyCode = 69;
    if (event.keyCode == 102)
        event.keyCode = 70;
    if (event.keyCode == 103)
        event.keyCode = 71;
    if (event.keyCode == 104)
        event.keyCode = 72;
    if (event.keyCode == 105)
        event.keyCode = 73;
    if (event.keyCode == 106)
        event.keyCode = 74;
    if (event.keyCode == 107)
        event.keyCode = 75;
    if (event.keyCode == 108)
        event.keyCode = 76;
    if (event.keyCode == 109)
        event.keyCode = 77;
    if (event.keyCode == 110)
        event.keyCode = 78;
    if (event.keyCode == 111)
        event.keyCode = 79;
    if (event.keyCode == 112)
        event.keyCode = 80;
    if (event.keyCode == 113)
        event.keyCode = 81;
    if (event.keyCode == 114)
        event.keyCode = 82;
    if (event.keyCode == 115)

        event.keyCode = 83;
    if (event.keyCode == 116)
        event.keyCode = 84;
    if (event.keyCode == 117)
        event.keyCode = 85;
    if (event.keyCode == 118)
        event.keyCode = 86;
    if (event.keyCode == 119)
        event.keyCode = 87;
    if (event.keyCode == 120)
        event.keyCode = 88;
    if (event.keyCode == 121)
        event.keyCode = 89;
    if (event.keyCode == 122)
        event.keyCode = 90;

}
////this is the function if execute tahn it shifted the selected pkg into the other listbox

function addpkgname() {
    /*new change ankur 15 feb*/
    document.getElementById('txtcardrate').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    ////////////////////////////add by anuja tab
    if (fal == 0) {
        if (document.activeElement.id == "btncopy") {
            fal = 1;
            /////////////////////getway
            if (document.getElementById('hdndepo').value != "depo") {
                if (document.getElementById("txtagency").value == "" || document.getElementById("hiddenagencynew").value == "") {
                    if (document.getElementById("txtagency").disabled == false) {
                        alert("Please Select Agency Using By F2");
                        document.getElementById("txtagency").focus();
                        return false;
                    }
                }
                else {
                    if (document.getElementById("txtMobile").disabled == false) {
                        document.getElementById("txtMobile").focus();
                        return false;
                    }
                }
            }
        }
    }
    ///////////////////////////////
    if (document.getElementById('drpadcategory').value == "0") {
        if (document.getElementById("drpadcategory").disabled == false) {
            alert("Please select the category");
            document.getElementById('drpadcategory').focus();
            return false;
        }
    }
    if (document.getElementById('drpuom').value == "0") {
        if (document.getElementById("drpuom").disabled == false) {
            alert("Please select uom");
            document.getElementById('drpuom').focus();
            return false;
        }

    }

    /////////

    if (document.getElementById('drppackage').value == "0" || document.getElementById('drppackage').value == "") {
        alert("Please select the package");
        document.getElementById('drppackage').focus();
        return false;
    }
    var dCheck = openSelectionEdiionDiv();
    if (dCheck == false)
        return false;
    var obj = document.getElementById('drppackagecopy');
    subtractrow = "";
    for (var x = 0; x < obj.options.length; x++) {
        if (document.getElementById('drppackage').value == obj[x].value.substring(0, obj[x].value.lastIndexOf('('))) {
            // alert("This package is already shifted");
            var insertCount = 1;
            if (obj[x].value.indexOf('(') >= 0) {
                insertCount = obj[x].value.substring(obj[x].value.lastIndexOf('(') + 1, obj[x].value.length - 1);
            }
            var _val = getInsert(obj[x].value.substring(0, obj[x].value.lastIndexOf('@')));
            if (_val != "" && _val != null && _val != "0")
                insertCount = parseInt(insertCount) + parseInt(_val);
            else
                insertCount = parseInt(insertCount) + 1;
            obj[x].value = obj[x].value.substring(0, obj[x].value.lastIndexOf('(')) + '(' + insertCount + ')';
            obj[x].text = obj[x].text.substring(0, obj[x].text.lastIndexOf('(')) + '(' + insertCount + ')';
            onInsertionChange();
            return false;
        }
    }
    if (document.getElementById('hidmultisel').value == "N" && obj.options.length == 1) {
        alert("You can't take Muliple Package");
        return false;
    }
    var strid = document.getElementById('drppackage').value;
    var compcode = document.getElementById('hiddencompcode').value;
    var strid1 = strid.split('@');
    var pkgid = strid1[0];
    var pkgname = strid1[1];
    glpkgname = pkgname;
    var value = "0";
    var dateday = "";
    var strtext = "";
    var code = "";
    var desc = "";


    if (browser != "Microsoft Internet Explorer") {
        var httpRequest = null;
        httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml');
        }

        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };
        var adcat = document.getElementById('drpadcategory').value;
        var pkgname1 = "";
        if (pkgname.length < 1024)
            pkgname1 = pkgname;
        httpRequest.open("GET", "packagename.aspx?adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + value + "&pkgname=" + pkgname1 + "&dateday=" + dateday, false);
        httpRequest.send('');
        //alert(httpRequest.readyState);
        if (httpRequest.readyState == 4) {
            //alert(httpRequest.status);
            if (httpRequest.status == 200) {
                strtext = httpRequest.responseText;
            }
            else {
                alert('There was a problem with the request.');
            }
        }
    }
    else {
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        var adcat = document.getElementById('drpadcategory').value;
        var pkgname1 = "";
        if (pkgname.length < 1024)
            pkgname1 = pkgname;
        xml.Open("GET", "packagename.aspx?adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + value + "&pkgname=" + pkgname1 + "&dateday=" + dateday, false);
        xml.Send();
        strtext = xml.responseText;
    }
    document.getElementById('pkgname').value = strtext;
    if (document.getElementById('drppackagecopy').options.length == 0) {
        che_flag = 0;
    }
    if (che_flag == 1) {
        alert("Can't select multiple Package");
        return false;
    }
    else if ((document.getElementById('drppackagecopy').options.length > 0) && (pkgname.indexOf(" or ") >= 0)) {
        alert("Can't select this Package");
        return false;
    }
    else {
        if (pkgname.indexOf(" or ") >= 0) {
            che_flag = 1;
            QBC.bindTable(pkgname, bindTable_callback);
            check_or = "1";

            //window.open('selectEdition.aspx?pkgname='+pkgname,'','width=200px,height=200px,resizable=1,left=0,top=0,scrollbars=yes');

            //alert("l");
        }



        //////////////////////////////////////////////////////////////////

        /*change ankur*/
        //////this to chk if the package is selected than we have to see in the combination master that ,that package has how many
        //////insertion 
        var val_ = "";
        var agencytype = document.getElementById('drpadtype').value;
        if (browser != "Microsoft Internet Explorer") {
            var httpRequest = null; ;
            httpRequest = new XMLHttpRequest();
            if (httpRequest.overrideMimeType) {
                httpRequest.overrideMimeType('text/xml');
            }

            httpRequest.onreadystatechange = function () { alertContents(httpRequest) };
            var glpkgname1 = "";
            if (glpkgname.length < 1024)
                glpkgname1 = glpkgname;
            httpRequest.open("GET", "gettheinsertionfromcombin.aspx?desc=" + glpkgname1 + "&code=" + pkgid + "&agencytype=" + agencytype, false);
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) {
                    val_ = httpRequest.responseText;
                }
                else {
                    alert('There was a problem with the request.');
                }
            }
        }
        else {
            var xml = new ActiveXObject("Microsoft.XMLHTTP");
            var glpkgname1 = "";
            if (glpkgname.length < 1024)
                glpkgname1 = glpkgname;
            xml.Open("GET", "gettheinsertionfromcombin.aspx?desc=" + glpkgname1 + "&code=" + pkgid + "&agencytype=" + agencytype, false);
            xml.Send();
            val_ = xml.responseText;

        }
        /////////////////////////////
        var insertO = document.getElementById('txtinsertion').value;
        document.getElementById('tempinsert').value = document.getElementById('txtinsertion').value;
        if (document.getElementById('tempinsert').value == "")
            document.getElementById('tempinsert').value = 1;
        if (insertO == "")
            insertO = 1;
        if (val_ != "" && val_ != "0" && val_ != null) {
            document.getElementById('txtinsertion').value = val_;


        }
        ////////////////////////

        document.getElementById('txtinsertion').value = insertO;

        if (che_flag == 0) {
            if (strtext != "0") {
                // AddItem(document.getElementById('drppackagecopy'), strtext, strid,val_);
                AddItem(document.getElementById('drppackagecopy'), strtext, strid, val_);
            }
            document.getElementById('btndel').focus();
        }

        //  document.getElementById('txtinsertion').value=insertO;
    }
    /* var adcat=document.getElementById('drpadcategory').value;
    var adscat=document.getElementById('drpadsubcategory').value;
    var uomchk=document.getElementById('drpuom').value;
    var linesword=document.getElementById('txttotalarea').value;
    var curr=document.getElementById('hiddencurrency').value;
    var ratecode=document.getElementById('txtratecode').value;
    var insertsno=document.getElementById('txtinsertion').value;
    //////////////this code is to split the code as well as ites description 
    
    var objpack=document.getElementById('drppackagecopy');
                            
                                
    if(objpack.options.length>0 && adcat!="0" && adscat!="0" && uomchk!="0" && linesword!="" && curr!="0" && ratecode!="0" && insertsno!="")
    {
    gettherate();
                  
    }  */


    if (document.getElementById('drpstyle').disabled == false) {

        document.getElementById('drpstyle').focus();

    }

    else {


        document.getElementById('txtdummydate').focus();
    }
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    return false;
}

function bindTable_callback(response) {
    var ds = response.value.split("+");


    var output = "";
    output = "<table cellpadding=0 cellspacing=0 border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\"><td align=center>Select</td><td align=center width=\"100px\">Edition</td></tr>";
    for (var i = 0; i < ds.length; i++) {
        output = output + "<tr><td class=\"dtGrid\" align=center><input type=checkbox onclick=\"checkCount('chk" + i + "','" + ds.length + "');\" value='" + ds.length + "' id=chk" + i + " /></td><td align=center class=\"dtGrid\" width=\"100px\" id=td" + i + ">" + ds[0] + "</td></tr>";
    }
    output = output + "<tr><td></td><td align=right><input type='button' class=\"buttonsmall\" value='Ok' onClick=\"okClick();\"><input type='button' class=\"buttonsmall\" value='Cancel' onClick=\"cancelClick();\"></td></tr>";
    output = output + "</table>";
    document.getElementById('divpkg').innerHTML = output;
    document.getElementById('divpkg').style.display = "block";
    document.getElementById('divpkg').style.top = parseInt(document.getElementById('txtpaid').offsetTop) + parseInt(document.getElementById('OuterTable').offsetTop) + 180;
    document.getElementById('divpkg').style.left = parseInt(document.getElementById('txtpaid').offsetLeft) + 200;
}

function okClick() {
    //   alert("Ok");
    var temp = "";
    temp = document.getElementById('hidval').value.split(",");
    //alert(temp.length);
    if (temp.length < parseInt(document.getElementById('hidcount').value)) {
        alert("Please select " + document.getElementById('hidcount').value + " Edition in this Package");
        return false;
    }
    document.getElementById('divpkg').style.display = "none";
    var strid = document.getElementById('drppackage').value;
    AddItem(document.getElementById('drppackagecopy'), document.getElementById('pkgname').value, strid, "0");
}

function cancelClick() {
    document.getElementById('divpkg').style.display = "none";

}

function checkCount(id, count) {
    //  alert(count);
    //alert(document.getElementById('tdtable').getElementsByTagName('table')[0].rows.length-1); 


    document.getElementById('hidcount').value = count;
    var i = 0;
    var tot = 0;
    document.getElementById('hidval').value = "";
    for (i = 0; i < document.getElementById('divpkg').getElementsByTagName('table')[0].rows.length - 2; i++) {
        if (document.getElementById('chk' + i).checked == true) {
            tot = tot + 1;
            if (tot > count) {
                alert("Can't select more Edition");
                document.getElementById(id).checked = false;
                return false;
            }
            else {
                if (document.getElementById('hidval').value == "") {
                    if (browser != "Microsoft Internet Explorer") {
                        document.getElementById('hidval').value = document.getElementById('td' + i).textContent;
                    }
                    else {
                        document.getElementById('hidval').value = document.getElementById('td' + i).innerText;
                    }
                }
                else {
                    if (browser != "Microsoft Internet Explorer") {
                        document.getElementById('hidval').value = document.getElementById('hidval').value + "," + document.getElementById('td' + i).textContent;
                    }
                    else {
                        document.getElementById('hidval').value = document.getElementById('hidval').value + "," + document.getElementById('td' + i).innerText;
                    }
                }
            }
        }
    }
}

//////this function adds the package into the other list box and grid bind

function AddItem(objListBox, strText, strId, val_) {
    suboradd = "1";
    previnsertion = "0";
    getid = "";
    if (strText.lastIndexOf('(') < 0) {
        strText = strText + '(1)';
        strId = strId + '(1)';
    }
    objListBox.options[objListBox.options.length] = new Option(strText, strId);
    objListBox.options.length;
    if (val_ != "" && val_ != "0" && val_ != null) {
        var obj = document.getElementById('drppackagecopy');
        for (var x = 0; x < obj.options.length; x++) {
            if (document.getElementById('drppackage').value == obj[x].value.substring(0, obj[x].value.lastIndexOf('('))) {
                // alert("This package is already shifted");
                var insertCount = val_;
                var insertCount1 = 0;
                if (obj[x].value.indexOf('(') >= 0) {
                    insertCount1 = obj[x].value.substring(obj[x].value.lastIndexOf('(') + 1, obj[x].value.length - 1);
                    insertCount1 = parseInt(insertCount1) - 1;
                }
                insertCount = parseInt(insertCount) + parseInt(insertCount1);
                obj[x].value = obj[x].value.substring(0, obj[x].value.lastIndexOf('(')) + '(' + insertCount + ')';
                obj[x].text = obj[x].text.substring(0, obj[x].text.lastIndexOf('(')) + '(' + insertCount + ')';
                x = obj.options.length;
            }
        }
    }
    //     
    document.getElementById('hiddencalendar').value = "0";
    document.getElementById('txtrepeatingdate').value = "";
    if (document.getElementById('txtrepeatingdate').value != "") {
        document.getElementById('btnshdl').disabled = false;
    }
    else {
        document.getElementById('btnshdl').disabled = true;
    }
    insertLinedrop();
    /*new change ankur 15 feb */
    /////this is to bind the fontcolor drpdown,bgcolordrpdown and bullet  dropdown

    // bindbgandfont()
    //sbinduomonedition();
    //////////////////

    /*new change ankur 27 feb*/
    /////this is to bind the uom drop down  on the behalf of edition selected and if pkg than on the edition perirority




}
function removepkgname() {
    //debugger;
    if (document.getElementById('drppackagecopy').options.length == 0) {
        alert("There is no item to delete");
        arrEdition_Item = '';
        return false;

    }

    else if (document.getElementById('drppackagecopy').value == "") {
        alert("Please select the package for delete");

        //document.getElementById('chktfn').focus();
        return false;
    }
    /*change ankur*/
    if (document.getElementById('drppackagecopy').options.length == 1) {
        //document.getElementById('txtinsertion').value="";
    }
    var strId = document.getElementById('drppackagecopy').value;

    if (document.getElementById('drppackagecopy').options.length != 0) {
        document.getElementById('drppackage').value = document.getElementById('drppackagecopy').value;
        RemoveItem(document.getElementById('drppackagecopy'), strId);
        document.getElementById('hiddencalendar').value = "0";
        removepkg = "delete";
        insertLinedrop();
        var pkgcopy = document.getElementById('drppackagecopy').value;
    }
    else {
        document.getElementById('tblinsert').innerHTML = "";
        document.getElementById('hiddencalendar').value = "0";
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txttotalamt').value = "";
        document.getElementById('txtdealrate').value = "";
        document.getElementById('txtdummydate').value = "";
        dummydate = "";
        document.getElementById('txtcardrate').value = "";
        document.getElementById('txtpaid').value = "";
        document.getElementById('txttotalarea').value = "";
        document.getElementById('drpuom').value = "0";
        document.getElementById('txtinsertion').value = "";
        globalschemedisc = "";
        check_or = "0";
        cali = "0";
        arrEdition_Item = "";
        noofinsertlo = 0;
        caldate = null;
        caldate = new Array();
        caldatemonth = null;
        caldatemonth = new Array();
        caldateyear = null;
        caldateyear = new Array();
    }
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    if (document.getElementById('drppackagecopy').options.length == 0) {
        cali = 0;
        caldate = null;
        caldate = new Array();
        caldatemonth = null;
        caldatemonth = new Array();
        caldateyear = null;
        caldateyear = new Array();
        sharepub = "";
        arrEdition_Item = '';
        document.getElementById('txttotalarea').value = "";
        document.getElementById('txtinsertion').value = "";
    }
    return false;
}
function RemoveItem(objListBox, strId) {
    var intIndex = GetItemIndex(objListBox, strId);
    if (strId.indexOf('(') >= 0) {
        var no = strId.substring(strId.lastIndexOf('(') + 1, strId.lastIndexOf(')'));
        var pkgcode = strId.substring(0, strId.lastIndexOf('@'));
        if (parseInt(no) != 1) {
            var _val = getInsert(pkgcode);
            if (_val != "" && _val != "0" && _val != null) {
                no = parseInt(no) - parseInt(_val);
            }
            else
                no = parseInt(no) - 1;
            if (no == 0) {
                if (intIndex != -1)
                    objListBox.remove(intIndex);
            }
            else {
                objListBox.options[intIndex].value = objListBox.options[intIndex].value.substring(0, objListBox.options[intIndex].value.indexOf('(')) + '(' + no + ')';
                objListBox.options[intIndex].text = objListBox.options[intIndex].text.substring(0, objListBox.options[intIndex].text.indexOf('(')) + '(' + no + ')';
            }
        }
        else {
            if (intIndex != -1)
                objListBox.remove(intIndex);
        }
    }
    else {
        if (intIndex != -1)
            objListBox.remove(intIndex);
    }
    /*new change ankur 27 feb*/
    if (document.getElementById('drppackagecopy').options.length == 0) {
        binduomonedition();
    }
}

function GetItemIndex(objListBox, strId) {
    if (browser != "Microsoft Internet Explorer") {
        for (var i = 0; i < objListBox.options.length; i++) {
            var strCurrentValueId = objListBox.options[i].value;
            if (strId == strCurrentValueId) {
                return i;
            }
        }
    }
    else {
        for (var i = 0; i < objListBox.children.length; i++) {
            var strCurrentValueId = objListBox.children[i].value;
            if (strId == strCurrentValueId) {
                return i;
            }
        }
    }
    return -1;
}
///////////////to bind the insertion grid

function onInsertionChange() {
    if (document.getElementById('txtinsertion').value == "" || document.getElementById('txtinsertion').value == "0") {
        alert("Insertion can't be 0 OR blank");
        return false;
    }
    bindrategroupvode(document.getElementById("drpadcategory").value);
    if (document.getElementById('txtinsertion').value == "" || document.getElementById('bookdiv') == null || document.getElementById('txtinsertion').value == "0") {

    }
    else {
        if (document.activeElement.id == "txtinsertion")
            subtractrow = "show";

        if (document.getElementById('hiddensavemod').value == "01") {
            if (parseInt(document.getElementById('hiddenmodifyinsert').value) > parseInt(document.getElementById('txtinsertion').value)) {
                alert('You Cannot Decrease insertions(Please Cancel Booking..)!');
                return false;
            }
        }
        document.getElementById('txtgrossamt').value = '';
        document.getElementById('txttotalamt').value = "";
        document.getElementById('txtscheme').value = "";
        var adcat3 = document.getElementById('drpadcat3').value;
        var adcat4 = document.getElementById('drpadcat4').value;
        var adcat5 = document.getElementById('drpadcat5').value;
        var clientname = document.getElementById('txtclient').value;
        var client_split;
        if (clientname.indexOf("(") >= 0) {
            clientname = clientname.split("(");
            client_split = clientname[1];
            client_split = client_split.replace(")", "");
            clientname = client_split;

        }
        //////////////this code is to split the code as well as ites description 

        ///////this is to get the value into paid ins. text b0x
        if (document.getElementById('txtpaid').value != "") {
            var paidno = document.getElementById('txtpaid').value;
            var valinsert = document.getElementById('txtinsertion').value;
            document.getElementById('txtpaid').value = (parseInt(valinsert) - parseInt(paidno)) + parseInt(paidno);
        }

        var objpack = document.getElementById('drppackagecopy');
        var temp = "";
        var tempcode = "";
        var tempval = "";
        var tempvalcode = "";
        var desc = "";
        var code = "";
        var i = objpack.options.length;
        var j;

        for (j = 0; j < i; j++) {
            if (parseInt(i) > 0) {
                tempval = objpack[j].value;

                //tempvalcode=objpack[j].value;
                if (temp != "") {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    code = tempvalcode + "," + code;
                    desc = tempcode + "," + desc;


                }
                else {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    code = tempvalcode;
                    desc = tempcode;
                }
            }

        }



        if (document.getElementById('txtrepeatingdate').value != "") {
            document.getElementById('btnshdl').disabled = false;
            var insertval = document.getElementById('txtinsertion').value
            if (parseInt(document.getElementById('txtinsertion').value) == 1) {
                //alert("In case of Insertion 1Repeating Day can't be greater than 1")
                if (document.getElementById('drppackagecopy').options.length > 0) {
                    for (var insertCou = 0; insertCou < document.getElementById('drppackagecopy').options.length; insertCou++) {
                        if (document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') >= 0) {
                            var tinsert = document.getElementById('drppackagecopy').options[insertCou].value.substring(document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') + 1, document.getElementById('drppackagecopy').options[insertCou].value.indexOf(')'));
                            if (tinsert > 1)
                                break;
                        }
                    }
                }
                if (tinsert <= 1) {
                    document.getElementById('txtrepeatingdate').value = "";

                    document.getElementById('btnshdl').disabled = true;

                    //return false;
                }
            }

            repeatdate = "1";
            suboradd = "1";
        }
        else {
            repeatdate = "0";
            suboradd = "1";
        }
        if (parseInt(previnsertion) > parseInt(document.getElementById('txtinsertion').value)) {
            repeatdate = "1";
            suboradd = "0";
        }
        if (repeatdate == "1") {
            //document.getElementById('tblinsert').innerHTML="";
            subtractrow = "";
        }
        if (parseInt(document.getElementById('txtinsertion').value) > parseInt(previnsertion)) {
            suboradd = "1";
        }

        var insert = document.getElementById('hiddeninserts').value;
        var class_insert = document.getElementById('txtinsertion').value;

        var center = "0";
        if (document.getElementById("chkall").checked != true) {
            center = document.getElementById('hiddencenter').value;
        }
        var lines_to;
        if (document.getElementById('txtadsize1').disabled == false) {
            lines_to = "";
        }
        else {
            lines_to = document.getElementById('txttotalarea').value;
        }
        //if(document.getElementById('tblinsert').innerHTML=="")
        if (subtractrow == "") {
            //Classified_Booking.getData_fill(document.getElementById('drppackage').value,document.getElementById('txtinsertion').value,document.getElementById('txtrepeatingdate').value,document.getElementById('txtdummydate').value,document.getElementById('hiddendateformat').value,document.getElementById('hiddencompcode').value,insertLinedrop_callback);    
            if (suboradd == "1") {
                //var prod=document.getElementById('droratecode').value
                //QBC.getData_fill(desc,document.getElementById('txtinsertion').value,document.getElementById('txtrepeatingdate').value,document.getElementById('txtdummydate').value,document.getElementById('hiddendateformat').value,document.getElementById('hiddencompcode').value,document.getElementById('drpadcategory').value,document.getElementById('drpadsubcategory').value,document.getElementById('drpcolor').value,document.getElementById('drpadtype').value,document.getElementById('hiddencurrency').value,document.getElementById('txtratecode').value,document.getElementById('hiddenclickdate').value,insert,code,document.getElementById('txtcardrate').value,document.getElementById('drpuom').value,document.getElementById('txtdealrate').value,check_or,class_insert,lines_to,adcat3,adcat4,adcat5,clientname,insertLinedrop_callback);
                /////////// if(parseInt(document.getElementById('txtinsertion').value)>parseInt(previnsertion) && document.getElementById('hiddensavemod').value=="01")
                if (parseInt(document.getElementById('txtinsertion').value) > parseInt(previnsertion) && chkbtnStatus != "new") {
                    /////comment by anuja for no issue date
                    //                    var repeatdate_vari = "";
                    //                    if (document.getElementById('txtrepeatingdate').value == "" && parseInt(document.getElementById('txtinsertion').value, 10) > 1)
                    //                        repeatdate_vari = "1";
                    //                    else
                    //                        repeatdate_vari = document.getElementById('txtrepeatingdate').value;


                    ////////////////////////////////end
                    QBC.getData_fill(desc, document.getElementById('txtinsertion').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, document.getElementById('drpadtype').value, document.getElementById('hiddencurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname, document.getElementById('hiddenuserid').value, center, insertLine_callback);
                }

                else {
                    document.getElementById('tblinsert').innerHTML == ""
                    if (che_flag == 1) {
                        desc = document.getElementById('hidval').value;
                    }
                    // previnsertion=document.getElementById('txtinsertion').value;
                    var repeatdate_vari = "";
                    if (document.getElementById('txtrepeatingdate').value == "" && parseInt(document.getElementById('txtinsertion').value, 10) > 1) {
                        document.getElementById('btnshdl').disabled = true;
                        repeatdate_vari = "1";
                    }
                    else {
                        document.getElementById('btnshdl').disabled = false;
                        repeatdate_vari = document.getElementById('txtrepeatingdate').value;
                    }
                    var ds_drop = QBC.getData_fill(desc, document.getElementById('txtinsertion').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, document.getElementById('drpadtype').value, document.getElementById('hiddencurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname, document.getElementById('hiddenuserid').value, center);
                    // var ds_drop = QBC.getData(desc, document.getElementById('txtinsertion').value, repeatdate_vari, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, "CL0", document.getElementById('drpcurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname);
                    insertLinedrop_callback(ds_drop);
                    //QBC.getData_fill(desc, document.getElementById('txtinsertion').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, document.getElementById('drpadtype').value, document.getElementById('hiddencurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname, document.getElementById('hiddenuserid').value, center, insertLine_callback);
                }
                //////////                     else
                //////////                    QBC.getData_fill(desc,document.getElementById('txtinsertion').value,document.getElementById('txtrepeatingdate').value,document.getElementById('txtdummydate').value,document.getElementById('hiddendateformat').value,document.getElementById('hiddencompcode').value,document.getElementById('drpadcategory').value,document.getElementById('drpadsubcategory').value,document.getElementById('drpcolor').value,document.getElementById('drpadtype').value,document.getElementById('hiddencurrency').value,document.getElementById('txtratecode').value,document.getElementById('hiddenclickdate').value,insert,code,document.getElementById('txtcardrate').value,document.getElementById('drpuom').value,document.getElementById('txtdealrate').value,check_or,class_insert,lines_to,adcat3,adcat4,adcat5,clientname,document.getElementById('hiddenuserid').value,center,insertLinedrop_callback);

            }
            else {
                if (che_flag == 1) {
                    desc = document.getElementById('hidval').value;
                }

                //document.getElementById('droratecode').value
                //QBC.getData_fill(desc,document.getElementById('txtinsertion').value,document.getElementById('txtrepeatingdate').value,document.getElementById('txtdummydate').value,document.getElementById('hiddendateformat').value,document.getElementById('hiddencompcode').value,document.getElementById('drpadcategory').value,document.getElementById('drpadsubcategory').value,document.getElementById('drpcolor').value,document.getElementById('drpadtype').value,document.getElementById('hiddencurrency').value,document.getElementById('txtratecode').value,document.getElementById('hiddenclickdate').value,insert,code,document.getElementById('txtcardrate').value,document.getElementById('drpuom').value,document.getElementById('txtdealrate').value,check_or,class_insert,lines_to,adcat3,adcat4,adcat5,clientname,insertLinesubtract_callback);
                //QBC.getData_fill(desc,document.getElementById('txtinsertion').value,document.getElementById('txtrepeatingdate').value,document.getElementById('txtdummydate').value,document.getElementById('hiddendateformat').value,document.getElementById('hiddencompcode').value,document.getElementById('drpadcategory').value,document.getElementById('drpadsubcategory').value,document.getElementById('drpcolor').value,document.getElementById('drpadtype').value,document.getElementById('hiddencurrency').value,document.getElementById('txtratecode').value,document.getElementById('hiddenclickdate').value,insert,code,document.getElementById('txtcardrate').value,document.getElementById('drpuom').value,document.getElementById('txtdealrate').value,check_or,class_insert,lines_to,adcat3,adcat4,adcat5,clientname,document.getElementById('hiddenuserid').value,center,insertLinesubtract_callback);
                /* if(document.getElementById('hiddensavemod').value!="01")
                {*/
                insertLinesubtract_callback("", 'main');
                /* }
                else
                {
                alert("You can't decrease Insertion in Modify Mode");
                document.getElementById('txtinsertion').value=previnsertion;
                return false;
                }  */
            }
        }
        else {
            //Classified_Booking.getData_fill(document.getElementById('drppackage').value,parseInt(document.getElementById('txtinsertion').value),document.getElementById('txtrepeatingdate').value,document.getElementById('txtdummydate').value,document.getElementById('hiddendateformat').value,document.getElementById('hiddencompcode').value,insertLine_callback);
            if (che_flag == 1) {
                desc = document.getElementById('hidval').value;
            }

            //document.getElementById('droratecode').value
            //new change ankur 27 feb*/
            if (document.getElementById('configclient').value == "BHASKAR") {
                if (document.getElementById('hiddensavemod').value != "01")
                //QBC.getData_fill(desc,document.getElementById('txtinsertion').value,document.getElementById('txtrepeatingdate').value,document.getElementById('txtdummydate').value,document.getElementById('hiddendateformat').value,document.getElementById('hiddencompcode').value,document.getElementById('drpadcategory').value,document.getElementById('drpadsubcategory').value,document.getElementById('drpcolor').value,document.getElementById('drpadtype').value,document.getElementById('hiddencurrency').value,document.getElementById('txtratecode').value,document.getElementById('hiddenclickdate').value,insert,code,document.getElementById('txtcardrate').value,document.getElementById('drpuom').value,document.getElementById('txtdealrate').value,check_or,class_insert,lines_to,adcat3,adcat4,adcat5,clientname,document.getElementById('hiddenuserid').value,center,insertLinedrop_callback);
                    QBC.getData_fill(desc, document.getElementById('txtinsertion').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, document.getElementById('drpadtype').value, document.getElementById('hiddencurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname, document.getElementById('hiddenuserid').value, center, insertLine_callback);
                else
                    QBC.getData_fill(desc, document.getElementById('txtinsertion').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, document.getElementById('drpadtype').value, document.getElementById('hiddencurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname, document.getElementById('hiddenuserid').value, center, insertLinedrop_callback);
            }

            else {
                if (chkbtnStatus == "new") {
                    // document.getElementById('tblinsert').innerHTML = "";
                    //////////////////////comment by anuja for no issue date
                    //                    if (document.getElementById('txtrepeatingdate').value == "" && parseInt(document.getElementById('txtinsertion').value, 10) > 1)
                    //                        repeatdate_vari = "1";
                    //                    else
                    //                        repeatdate_vari = document.getElementById('txtrepeatingdate').value;
                    //var ds_drop1 = QBC.getData_fill(desc, document.getElementById('txtinsertion').value, repeatdate_vari, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, document.getElementById('drpadtype').value, document.getElementById('hiddencurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname, document.getElementById('hiddenuserid').value, center);

                    //////////////////////////end
                    inserttimeflag = "1";
                    var ds_drop1 = QBC.getData_fill(desc, document.getElementById('txtinsertion').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, document.getElementById('drpadtype').value, document.getElementById('hiddencurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname, document.getElementById('hiddenuserid').value, center);
                    insertLine_callback(ds_drop1);
                    inserttimeflag = "0";
                }
                else {
                    ///add by anuja for no issue date
                    checkflag = "2"; //add by anuja no issue date
                    var repeatdate_vari = "";
                    if (document.getElementById('txtrepeatingdate').value == "" && parseInt(document.getElementById('txtinsertion').value, 10) > 1) {
                        repeatdate_vari = "1";
                        document.getElementById('btnshdl').disabled = true;
                    }
                    else {
                        repeatdate_vari = document.getElementById('txtrepeatingdate').value;
                        document.getElementById('btnshdl').disabled = false;
                    }
                    var ds_linedrop = QBC.getData_fill(desc, document.getElementById('txtinsertion').value, repeatdate_vari, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, document.getElementById('drpadtype').value, document.getElementById('hiddencurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname, document.getElementById('hiddenuserid').value, center);
                    insertLine_callback(ds_linedrop);
                }
            }
            //QBC.getData_fill(desc,document.getElementById('txtinsertion').value,document.getElementById('txtrepeatingdate').value,document.getElementById('txtdummydate').value,document.getElementById('hiddendateformat').value,document.getElementById('hiddencompcode').value,document.getElementById('drpadcategory').value,document.getElementById('drpadsubcategory').value,document.getElementById('drpcolor').value,document.getElementById('drpadtype').value,document.getElementById('hiddencurrency').value,document.getElementById('txtratecode').value,document.getElementById('hiddenclickdate').value,insert,code,document.getElementById('txtcardrate').value,document.getElementById('drpuom').value,document.getElementById('txtdealrate').value,check_or,class_insert,lines_to,adcat3,adcat4,adcat5,clientname,insertLine_callback);
        }
    }
    /////////////////////
    /* if(document.getElementById('txtgrossamt').value!="")
    {
    gettherate()
    }*/




}

function insertLine() {


    //////////////this code is to split the code as well as ites description 
    //alert(document.getElementById('tblinsert').innerHTML);
    var objpack = document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var code = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (temp != "") {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode + "," + code;
                desc = tempcode + "," + desc;


            }
            else {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode;
                desc = tempcode;
            }
        }

    }

    //////////////////////////////////////////////////////////////////

    var insert = document.getElementById('hiddeninserts').value;
    var class_insert = document.getElementById('txtinsertion').value;
    var lines_to;
    if (document.getElementById('txtadsize1').disabled == false) {
        lines_to = "";
    }
    else {
        lines_to = document.getElementById('txttotalarea').value;
    }
    if (checkflag == 1) {
        document.getElementById('txtinsertion').value = parseInt(document.getElementById('txtinsertion').value) + 1;
        document.getElementById('txtpaid').value = document.getElementById('txtinsertion').value;
    }
    //Classified_Booking.getData_fill(document.getElementById('drppackage').value,document.getElementById('txtinsertion').value,document.getElementById('txtrepeatingdate').value,document.getElementById('txtdummydate').value,document.getElementById('hiddendateformat').value,document.getElementById('hiddencompcode').value,insertLine_callback);
    if (che_flag == 1) {
        desc = document.getElementById('hidval').value;
    }
    var adcat3 = document.getElementById('drpadcat3').value;
    var adcat4 = document.getElementById('drpadcat4').value;
    var adcat5 = document.getElementById('drpadcat5').value;
    var clientname = document.getElementById('txtclient').value;
    var client_split;
    if (clientname.indexOf("(") >= 0) {
        clientname = clientname.split("(");
        client_split = clientname[1];
        client_split = client_split.replace(")", "");
        clientname = client_split;

    }
    var center = "0";
    if (document.getElementById("chkall").checked != true) {
        center = document.getElementById('hiddencenter').value;
    }
    //document.getElementById('droratecode').value      
    //new change ankur 27feb*/

    QBC.getData_fill(desc, document.getElementById('txtinsertion').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, document.getElementById('drpadtype').value, document.getElementById('hiddencurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname, document.getElementById('hiddenuserid').value, center, insertLine_callback);
    //QBC.getData_fill(desc,document.getElementById('txtinsertion').value,document.getElementById('txtrepeatingdate').value,document.getElementById('txtdummydate').value,document.getElementById('hiddendateformat').value,document.getElementById('hiddencompcode').value,document.getElementById('drpadcategory').value,document.getElementById('drpadsubcategory').value,document.getElementById('drpcolor').value,document.getElementById('drpadtype').value,document.getElementById('hiddencurrency').value,document.getElementById('txtratecode').value,document.getElementById('hiddenclickdate').value,insert,code,document.getElementById('txtcardrate').value,document.getElementById('drpuom').value,document.getElementById('txtdealrate').value,check_or,class_insert,lines_to,adcat3,adcat4,adcat5,clientname,insertLine_callback);


}


function insertLinedrop() {

    //if(document.getElementById('hiddensavemod').value!="1" && document.getElementById('drppackage').value!="0")
    if (document.getElementById('drppackage').value != "0") {

        /*change ankur*/
        if (document.getElementById('txtinsertion').value == "") {
            document.getElementById('txtinsertion').value = "1";
        }
        document.getElementById('txtpaid').value = "1";
        //document.getElementById('txtratecode').value="0";
        //"0"="";
        //document.getElementById('txtcardamt').value="";
        //document.getElementById('txtagreedrate').value="";
        //document.getElementById('txtagreedamt').value="";
        //document.getElementById('txtdiscount').value="";
        //document.getElementById('txtdiscpre').value="";
        //document.getElementById('txtspedisc').value="";
        //document.getElementById('txtspediscper').value="";
        //document.getElementById('txtspacedisc').value="";
        //document.getElementById('txtspadiscper').value="";
        //document.getElementById('txtextracharges').value="";
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txttotalamt').value = "";
        //document.getElementById('txtbillamt').value="";

        document.getElementById('txtdealrate').value = "";
        //document.getElementById('txtdeviation').value="";
        if (document.getElementById('drppackagecopy').options.length == 0) {
            document.getElementById('txtdummydate').value = "";
        }

        //////////////this funtion is to open the deal type on package change when prefeerrence is set to yes





        //////////////////////////////////////////////////////////////////////////////////////////////////////

        var objpack = document.getElementById('drppackagecopy');
        var temp = "";
        var tempcode = "";
        var tempval = "";
        var tempvalcode = "";
        var desc = "";
        var code = "";
        var i = objpack.options.length;
        var j;
        var insertnO = document.getElementById('txtinsertion').value;
        for (j = 0; j < i; j++) {
            if (parseInt(i) > 0) {
                tempval = objpack[j].value;

                //tempvalcode=objpack[j].value;
                if (temp != "") {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    //                                            var _no=getInsert(tempvalcode);
                    //                                            if(_no!="" && _no!="0" && _no!=null)
                    //                                            {
                    //                                                insertnO=insertnO-no;
                    //                                                 tempcode=temp[1];
                    //                                                 if(temp[1].indexOf("(")>=0)
                    //                                                 {
                    //                                                    var ins=temp[1].substring(temp[1].lastIndexOf("(")+1,temp[1].length-1);
                    //                                                    tempcode=temp[1].substring(0,temp[1].lastIndexOf("(")) + insertnO + ")";
                    //                                                 }
                    //                                            }
                    //                                            else{
                    tempcode = temp[1];
                    //}
                    cyop_code = tempvalcode + "^" + cyop_code;
                    cyop_desc = tempcode + "^" + cyop_desc;
                    code = tempvalcode + "," + code;
                    desc = tempcode + "," + desc;


                }
                else {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    // var _no=getInsert(tempvalcode);
                    //                                            if(_no!="" && _no!="0" && _no!=null)
                    //                                            {
                    //                                                insertnO=insertnO-no;
                    //                                                 tempcode=temp[1];
                    //                                                 if(temp[1].indexOf("(")>=0)
                    //                                                 {
                    //                                                    var ins=temp[1].substring(temp[1].lastIndexOf("(")+1,temp[1].length-1);
                    //                                                    tempcode=temp[1].substring(0,temp[1].lastIndexOf("(")) + insertnO + ")";
                    //                                                 }
                    //                                            }
                    //                                            else
                    //                                            {
                    tempcode = temp[1];
                    //  }
                    code = tempvalcode;
                    desc = tempcode;
                    cyop_code = tempvalcode;
                    cyop_desc = tempcode;
                }
            }

        }

        document.getElementById('hiddenpackage').value = code;
        var insert = document.getElementById('hiddeninserts').value;
        //if(document.getElementById('drppackage').value!="0")
        //{
        if (che_flag == 1) {
            desc = document.getElementById('hidval').value;
        }
        var class_insert = document.getElementById('txtinsertion').value;
        var lines_to;
        if (document.getElementById('txtadsize1').disabled == false) {
            lines_to = "";
        }
        else {
            lines_to = document.getElementById('txttotalarea').value;
        }


        var adcat3 = document.getElementById('drpadcat3').value;
        var adcat4 = document.getElementById('drpadcat4').value;
        var adcat5 = document.getElementById('drpadcat5').value;

        var clientname = document.getElementById('txtclient').value;
        var client_split;
        if (clientname.indexOf("(") >= 0) {
            clientname = clientname.split("(");
            client_split = clientname[1];
            client_split = client_split.replace(")", "");
            clientname = client_split;

        }
        //document.getElementById('hiddenuserid').value 
        //new change ankur 27 feb*/  
        //alert(desc);alert(document.getElementById('txtinsertion').value);alert(document.getElementById('txtrepeatingdate').value);
        //alert(document.getElementById('txtdummydate').value);alert(document.getElementById('hiddendateformat').value);alert(document.getElementById('drpadcategory').value);
        //alert(document.getElementById('hiddenclickdate').value) 
        if (document.getElementById('txtinsertion').value == null || document.getElementById('txtinsertion').value == "null") {
            document.getElementById('txtinsertion').value = "1";
        }
        if (document.getElementById('tempinsert').value == null || document.getElementById('tempinsert').value == "null") {
            document.getElementById('tempinsert').value = "1";
        }
        var center = "0";
        if (document.getElementById("chkall").checked != true) {
            center = document.getElementById('hiddencenter').value;
        }
        //alert("test");
        document.getElementById('tempinsert').value = document.getElementById('txtinsertion').value;
        if (document.getElementById('tempinsert').value == "")
            document.getElementById('tempinsert').value = 1;
        if (document.getElementById('configclient').value == "BHASKAR" && removepkg == "" && document.getElementById('gridtab') != null && document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows.length > 1) {
            QBC.getData_fill(desc, document.getElementById('tempinsert').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, document.getElementById('drpadtype').value, document.getElementById('hiddencurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname, document.getElementById('hiddenuserid').value, center, insertLine_callback);
        }
        else {
            //alert("test1");
            QBC.getData_fill(desc, document.getElementById('tempinsert').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, document.getElementById('drpadtype').value, document.getElementById('hiddencurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname, document.getElementById('hiddenuserid').value, center, insertLinedrop_callback);
            removepkg = "";
        }

        //QBC.getData_fill(desc,document.getElementById('txtinsertion').value,document.getElementById('txtrepeatingdate').value,document.getElementById('txtdummydate').value,document.getElementById('hiddendateformat').value,document.getElementById('hiddencompcode').value,document.getElementById('drpadcategory').value,document.getElementById('drpadsubcategory').value,document.getElementById('drpcolor').value,document.getElementById('drpadtype').value,document.getElementById('hiddencurrency').value,document.getElementById('txtratecode').value,document.getElementById('hiddenclickdate').value,insert,code,document.getElementById('txtcardrate').value,document.getElementById('drpuom').value,document.getElementById('txtdealrate').value,check_or,class_insert,lines_to,adcat3,adcat4,adcat5,clientname,insertLinedrop_callback);
        //}   
        return;
    }
    return;
}

///////////this call back function is when there is alert do you want to insert more lines then this function executes
//////////////////////////////////////////////////



function fillStyle() {
    document.getElementById('hidstyle').value = document.getElementById('drpstyle').value;
    return false;
}

function insertLine_callback(response) {
    // alert("chd");
    var insprev = 0;
    document.getElementById('drpbullet').value = document.getElementById('hiddenbullet').value;
    document.getElementById('drpbgcolor').value = document.getElementById("hiddenbgcolor").value;
    document.getElementById('drpstyle').value = document.getElementById('hidstyle').value;
    previnsertion = document.getElementById('txtinsertion').value;
    var ds = response.value;
    var adsubcat_var = document.getElementById('drpadsubcategory');
    var color_var = document.getElementById('drpcolor');
    var drpuom_var = document.getElementById('drpuom');
    var hiddenuom_var = document.getElementById('hiddenuomdesc');
    var adsize1_var = document.getElementById('txtadsize1');
    var adsize2_var = document.getElementById('txtadsize2');
    var column_var = document.getElementById('txtcolum');
    var matsta_var = document.getElementById('drpmatstat');
    var adcat_var = document.getElementById('drpadcategory');
    var drpadsubcat_var = document.getElementById('drpadcategory');
    var totalarea_var = document.getElementById('txttotalarea');
    var adcat3_var = document.getElementById('drpadcat3');
    var adcat4_var = document.getElementById('drpadcat4');
    var adcat5_var = document.getElementById('drpadcat5');
    var adtype_vari = document.getElementById('hiddenadtype');
    var compcode_vari = document.getElementById('hiddencompcode');
    var chkall_vari = document.getElementById('chkall');
    var center_vari = document.getElementById('hiddencenter');
    var dateformat_vari = document.getElementById('hiddendateformat');

    //alert(ds);
    if (ds != null) {
        fillinsert = ds.Tables[0].Rows.length;
        var i = 0;
        var str = "";
        var date = new Array();
        var sizecop = new Array();
        var heightcop = new Array();
        var widthcop = new Array();
        var filecopy = new Array();
        str = document.getElementById('tblinsert').innerHTML;
        //str=str.replace("</TABLE>","");
        //alert(document.getElementById('tblinsert').innerHTML);



        document.getElementById('txtrepeatingdate').disabled = false;
        if (browser != "Microsoft Internet Explorer") {
            var len = "bookdiv";
            var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
            var k;
            for (k = 0; k < y - 1; k++) {
                date[k] = document.getElementById("Text" + k).value;
                sizecop[k] = document.getElementById("siz" + k).value;
                heightcop[k] = document.getElementById("hei" + k).value;
                widthcop[k] = document.getElementById("wid" + k).value;
                filecopy[k] = document.getElementById("fil" + k).value;
            }
            str = str.replace("</tbody></table>", "");
        }
        else {
            str = str.replace("</TBODY></TABLE>", "");
        }
        str = str.replace("</div>", "");

        var dat = "mm+" / "+" / "+dd+" / "+yyyy";
        var j = 0;
        var k = 0;
        var l = 0;
        var m = 0;
        var n = 0;
        var o = 0;
        var p = 0;
        var premid;
        var premper;
        var colid;
        var height;
        var width;
        var size;
        var late;
        var adtypid;
        var uomid;
        var cardid;
        var premper1;
        var prem1id;
        var name;
        var inserts;
        var pagepost;
        var preall;
        var adcat;
        var adsubcat;
        var matsta;
        var filename;
        var discrate;
        var insertsta;
        var billstat;
        var editid;
        var repeat;
        var picfieldl;
        var colid;
        var paid;
        var agrred;
        var solo;
        var gross;
        var s;
        var count;
        var len = "bookdiv";
        var pageno_inserts;
        var remark_inserts;
        var page;
        var pageprem;
        var noofcol;
        var billamt;
        var billrate;
        var pagstr = "";
        /*new change ankur 23 feb*/
        var logoH = "";
        var logoW = "";
        var logonam = "";
        var dcat1 = "";
        var dcol = "";
        var dinsert = "";
        var dstatus = "";
        var dposition = "";
        var dprem1 = "";
        var dpre = "";
        var dmcat = "";
        var dbill = "";
        var dadcat3 = "";
        var dadcat4 = "";
        var dadcat5 = "";
        var dpaid = "";
        var dcou = "";

        var pkgcodegrid = "";

        //////////////////

        //str="<table width=\"300px\" border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\"><td>Edition</td><td>Date</td></tr>";
        // 
        if (document.getElementById('hiddensavemod').value != "0") {
            count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
            idnew = parseInt(count);
            dcou = count;
            document.getElementById('hiddenrowcount').value = count;
            //insertval=count;
            if (document.getElementById('hiddeninsertion').value != "") {
                gridItemCount = parseInt(count) / parseInt(document.getElementById('hiddeninsertion').value);
                insertval = document.getElementById('hiddeninsertion').value;
                tempins = document.getElementById('hiddeninsertion').value;
                count = parseInt(ds.Tables[0].Rows.length, 10) / parseInt(document.getElementById('txtinsertion').value, 10);
                count = parseInt(count) * parseInt(document.getElementById('hiddeninsertion').value);
                document.getElementById('hiddeninsertion').value = "";

            }
            // count = parseInt(ds.Tables[0].Rows.length,10) / parseInt(document.getElementById('txtinsertion').value,10);
        }
        else {
            count = document.getElementById('hiddenrowcount').value;
            dcou = count;
            document.getElementById('hiddenrowcount').value = ds.Tables[0].Rows.length;
        }

        /* if(document.getElementById('txtrepeatingdate').value!="")
        {
        count=0;
        dcou=count;
        }*/
        //var idnew=document.getElementById('hiddenrowcount').value - parseInt(document.getElementById('txtinsertion').value);
        var temp = idnew;
        //i=count;
        i = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
        for (var pai = 0; pai < i; pai++) {
            var paid = "pai" + pai;
            if (document.getElementById(paid) != null)
                document.getElementById(paid).value = "Y";
        }
        dcat1 = "";
        dcol = "";
        dinsert = "";
        dstatus = "";
        dposition = "";
        dprem1 = "";
        dpre = "";
        dmcat = "";
        dbill = "";
        dadcat3 = "";
        dadcat4 = "";
        dadcat5 = "";
        dpaid = "";
        for (s = count; s < ds.Tables[0].Rows.length; s++) {
            var vvalue = "";
            //
            if (checkflag == 1) {
                caldate[cali] = dateSelected;
                caldatemonth[cali] = parseInt(monthSelected) + 1;
                caldateyear[cali] = yearSelected;

                //    cali=cali+1;
            }
            var dCheck = checkValidEdition(ds.Tables[0].Rows[s].Edition_Name);  ///uncomment by anuja for no issue date
            //dCheck = true;//comment by anuja for no issue date
            if (dCheck == true) {
                var id = "Text" + i;
                uomid = "uom" + i;
                inserts = "ins" + i;
                editid = "edit" + i;
                colid = "col" + i;
                agrred = "agr" + i;
                //str=str + "<tr ><td class=\"dtGrid\">"+ds.Tables[0].Rows[i].Edition_Name+"</td><td><input class=\"Textbox1\" type=\"text\" value='"+ds.Tables[0].Rows[i].Date+"' id="+id+"></td></tr>";


                //str=str + "<tr ><td class=\"dtGrid\">"+ds.Tables[0].Rows[i].Edition_Name+"</td><td><input class=\"btextforbook\" type=\"text\" id="+id+" value="+ds.Tables[0].Rows[i].Date+"><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1."+id+", Form1."+id+", "+dat+");\" height=\"14\" width=\"14\" /></td><td><select id="+colid+" class=\"dropdownforbook\">";
                //str=str+"<table id=\"gridtab\" width=\"300px\" border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\"><td align=\"center\">Edition</td><td align=\"center\">Date</td><td align=\"center\">Color</td><td align=\"center\">UOM</td><td align=\"center\">Height</td><td align=\"center\">Width</td><td align=\"center\">Size</td><td align=\"center\">Premium</td><td align=\"center\">Premium(%)</td><td align=\"center\">Ad Sub Cat.</td><td align=\"center\">Latest By</td><td align=\"center\">Repeating</td><td>Status Material</td><td align=\"center\">File Name</td><td align=\"center\">Card Rate</td><td align=\"center\">Disc. Rate</td><td align=\"center\">Status Of Insertion</td><td>Bill Status</td></tr>";

                insertval = parseInt(ds.Tables[0].Rows[s].IDNUM) + 1;
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[1].childNodes[0].nodeValue == "enable") {
                        if (insprev != insertval) {
                            insprev = insertval;
                            str = str + "<tr ><td align=\"center\" id=" + inserts + " title='Edit Insert'  class=\"TextField\">" + insertval + "</td>";
                        }
                        else {
                            str = str + "<tr ><td align=\"center\" id=" + inserts + "  class=\"TextField\">" + insertval + "</td>";
                        }
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(0).text == "enable") {
                        if (insprev != insertval) {
                            insprev = insertval;
                            str = str + "<tr ><td align=\"center\" id=" + inserts + " title='Edit Insert'  class=\"TextField\">" + insertval + "</td>";
                        }
                        else {
                            str = str + "<tr ><td align=\"center\" id=" + inserts + "  class=\"TextField\">" + insertval + "</td>";
                        }
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                if (inserttimeflag == "1") {
                    var dat_ed = ""; // = dateSelected +'/'+(parseInt(monthSelected) + 1)+ '/'+ yearSelected;

                    if (ds.Tables[0].Rows[s].Date == null) {
                        dat_ed = "";
                    }
                    else {
                        dat_ed = ds.Tables[0].Rows[s].Date;
                    }
                }
                else {

                    var mmM = parseInt(monthSelected, 10) + 1;
                    var dd = dateSelected.toString();
                    mmM = mmM.toString();
                    if (mmM.length == 1 && dd.length == 1) {
                        mmM = "0" + mmM.toString();
                        dd = "0" + dd.toString();
                        var dat_ed = dd + '/' + mmM + '/' + yearSelected;
                    }
                    else if (mmM.length == 1) {
                        mmM = "0" + mmM.toString();
                        var dat_ed = dateSelected + '/' + mmM + '/' + yearSelected;
                    }
                    else if (dd.length == 1) {
                        dd = "0" + dd.toString();
                        var dat_ed = dd + '/' + mmM + '/' + yearSelected;
                    }

                    else {
                        var dat_ed = dateSelected + '/' + (parseInt(monthSelected) + 1) + '/' + yearSelected;
                    }
                }
                // Edition 
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[3].childNodes[0].nodeValue == "enable") {
                        str = str + "<td class=\"dtGrid\" ><input class=\"btextforgridedition\" type=\"text\" disabled id=" + editid + " value='" + ds.Tables[0].Rows[s].Edition_Name + "'></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(1).text == "enable") {
                        str = str + "<td class=\"dtGrid\" ><input class=\"btextforgridedition\" type=\"text\" disabled id=" + editid + " value='" + ds.Tables[0].Rows[s].Edition_Name + "'></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                // Date
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[5].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgriddate\" type=\"text\" id=" + id + " value='" + dat_ed + "' ></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(2).text == "enable") {
                        str = str + "<td><input class=\"btextforgriddate\" type=\"text\" id=" + id + " value='" + dat_ed + "' >";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }




                ////this is to bind the Ad sub cat drop down

                adsubcat = "ads" + i;

                // Ad Sub Cat
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[7].childNodes[0].nodeValue == "enable") {
                        if (adsubcat_var.value != '0') {
                            str = str + "<td><input class=\"btextforgrid\" type=\"text\"  id=" + adsubcat + " value=" + adsubcat_var.value + "></td>";
                        }
                        else {
                            str = str + "<td><input class=\"btextforgrid\" type=\"text\"  id=" + adsubcat + " value=''></td>";
                        }
                        //                   if(dcat1=="")
                        //                   {
                        //                        dcat1=dcat1+"<td><select id="+adsubcat+" class=\"dropdownforgridqbc\" onchange=\"getvalueintoinserts("+adsubcat+","+inserts+","+insertval+");\">";
                        //                        // this is to bind adv sub cat drop down
                        //                        dcat1=dcat1+"<option value=\"0\" selected=\"true\">select</option>";
                        //                        for(l=0;l<=ds.Tables[3].Rows.length-1;l++)
                        //                        {
                        //                            if(ds.Tables[3].Rows[l].Adv_Subcat_Code==document.getElementById('drpadsubcategory').value && document.getElementById('drpadsubcategory').value!="0")
                        //                            {
                        //                                dcat1=dcat1+"<option value="+ds.Tables[3].Rows[l].Adv_Subcat_Code+" selected="+document.getElementById('drpadsubcategory').value+">"+ds.Tables[3].Rows[l].Adv_Subcat_Code+"</option>";
                        //                            }
                        //                            else
                        //                            {
                        //                                dcat1=dcat1+"<option value="+ds.Tables[3].Rows[l].Adv_Subcat_Code+">"+ds.Tables[3].Rows[l].Adv_Subcat_Code+"</option>";
                        //                            }
                        //                        }

                        //                        dcat1=dcat1+"</select></td>";
                        //                        str=str+dcat1;
                        //                    }
                        //                    else
                        //                        str=str+dcat1.replace("ads"+dcou,adsubcat);
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(3).text == "enable") {
                        if (adsubcat_var.value != '0') {
                            str = str + "<td><input class=\"btextforgrid\" type=\"text\"  id=" + adsubcat + " value=" + adsubcat_var.value + "></td>";
                        }
                        else {
                            str = str + "<td><input class=\"btextforgrid\" type=\"text\"  id=" + adsubcat + " value=''></td>";
                        }
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                // Color
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[9].childNodes[0].nodeValue == "enable") {
                        if (color_var.value != '0') {
                            str = str + "<td><input class=\"btextsmallsize\" type=\"text\" disabled  id=" + colid + " value=" + color_var.value + "></td>";
                        }
                        else {
                            str = str + "<td><input class=\"btextsmallsize\" type=\"text\" disabled  id=" + colid + " value=''></td>";
                        }
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(4).text == "enable") {
                        if (color_var.value != '0') {
                            str = str + "<td><input class=\"btextsmallsize\" type=\"text\" disabled  id=" + colid + " value=" + color_var.value + "></td>";
                        }
                        else {
                            str = str + "<td><input class=\"btextsmallsize\" type=\"text\" disabled  id=" + colid + " value=''></td>";
                        }
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }


                premid = "prem" + i;
                prem1id = "premone" + i;
                height = "hei" + i;
                width = "wid" + i;
                size = "siz" + i;
                pagepost = "pagpos" + i;
                noofcol = "nocol" + i;
                //////// on change function is there to calculate the size 
                //str=str+"</select></td><td><input class=\"btextforbook\" id="+height+" type=\"text\"  value=\"\"></td><td><input class=\"btextforbook\" id="+width+" onchange=\"return gettotalsize("+height+","+width+","+i+");\" type=\"text\"  value=\"\"></td><td><input class=\"btextforbook\" disabled id="+size+" type=\"text\"  value=\"\"></td><td><select id="+premid+" class=\"dropdownforbook\" onchange=\"return getpercenprem("+premid+","+i+");\"  >";

                // Heigth Width Column
                if (drpuom_var.value != "0" && hiddenuom_var.value != "CD") {
                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[11].childNodes[0].nodeValue == "enable") {
                            str = str + "<td><input class=\"btextsmallsizeH\" style=\"background-color: Gray;\" readonly=true id=" + height + "  type=\"text\"  ></td><td><input class=\"btextsmallsizeH\" style=\"background-color: Gray;\" readonly=true id=" + width + " type=\"text\"  ></td><td><input class=\"btextsmallsizeH\" style=\"background-color: Gray;\" readonly=true id=" + noofcol + "  type=\"text\"  ></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(5).text == "enable") {
                            str = str + "<td><input class=\" btextsmallsizeH\" style=\"background-color: Gray;\" readonly=true id=" + height + "   type=\"text\"  ></td><td><input class=\"btextsmallsizeH\" style=\"background-color: Gray;\" readonly=true id=" + width + "  type=\"text\"  ></td><td><input class=\"btextsmallsizeH\" style=\"background-color: Gray;\" readonly=true id=" + noofcol + "  type=\"text\"  ></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }

                }
                else {
                    if (document.getElementById('txtcolum').disabled == true) {
                        if (browser != "Microsoft Internet Explorer") {
                            if (xmlObj.childNodes[23].childNodes[11].childNodes[0].nodeValue == "enable") {
                                str = str + "<td><input class=\"btextsmallsizeH\" style=\" background-color: White;\" id=" + height + "  type=\"text\"  ></td><td><input class=\"btextsmallsizeH\" id=" + width + " style=\"background-color:White;\" type=\"text\"  ></td><td><input class=\"btextsmallsizeH\" readonly=true id=" + noofcol + "  type=\"text\"  ></td>";
                            }
                            else {
                                str = str + "<td style=\"display:none;\"></td>";
                            }
                        }
                        else {
                            if (xmlObj.childNodes(11).childNodes(5).text == "enable") {
                                str = str + "<td><input class=\"btextsmallsizeH\" style=\" background-color: White;\" id=" + height + "  type=\"text\"  ></td><td><input class=\"btextsmallsizeH\" id=" + width + " style=\"background-color:White;\"  type=\"text\"  ></td><td><input class=\"btextsmallsizeH\" readonly=true id=" + noofcol + " type=\"text\"  ></td>";
                            }
                            else {
                                str = str + "<td style=\"display:none;\"></td>";
                            }
                        }

                    }
                    else {
                        if (browser != "Microsoft Internet Explorer") {
                            if (xmlObj.childNodes[23].childNodes[11].childNodes[0].nodeValue == "enable") {
                                str = str + "<td><input class=\"btextsmallsizeH\" style=\" background-color: White;\" id=" + height + "  type=\"text\"  ></td><td><input class=\"btextsmallsizeH\"  id=" + width + " style=\"background-color:White;\"  type=\"text\"  ></td><td><input class=\"btextsmallsizeH\"  id=" + noofcol + "  type=\"text\"  ></td>";
                            }
                            else {
                                str = str + "<td style=\"display:none;\"></td>";
                            }
                        }
                        else {
                            if (xmlObj.childNodes(11).childNodes(5).text == "enable") {
                                str = str + "<td><input class=\"btextsmallsizeH\" style=\" background-color: White;\" id=" + height + "  type=\"text\"  ></td><td><input class=\"btextsmallsizeH\"  id=" + width + " style=\"background-color:White;\"  type=\"text\"  ></td><td><input class=\"btextsmallsizeH\"  id=" + noofcol + "  type=\"text\"  ></td>";
                            }
                            else {
                                str = str + "<td style=\"display:none;\"></td>";
                            }
                        }

                    }
                }

                insertsta = "inssta" + i;

                ////////this is to bind the status of insertion drop down  agrred

                if (browser != "Microsoft Internet Explorer") {

                    if (xmlObj.childNodes[23].childNodes[13].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\"  type=\"text\" id=" + insertsta + "  value='booked'></td>";

                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    //    var xmlDoc = new ActiveXObject("Microsoft.XMLDOM"); 

                    //    loadXML('xml/billcycle.xml');
                    if (xmlObj.childNodes(11).childNodes(6).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\"  type=\"text\" id=" + insertsta + "  value='booked'></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                ////this loop is to bind the page position
                pagstr = "fir";

                /////////////this is to bind the status material drop down
                matsta = "mat" + i;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[15].childNodes[0].nodeValue == "enable") {
                        if (matsta_var.value != "0") {
                            str = str + "<td><input class=\"btextforgrid\"  id=" + matsta + " type=\"text\"  value=" + matsta_var.value + "></td>";
                        }
                        else {
                            str = str + "<td><input class=\"btextforgrid\"  id=" + matsta + " type=\"text\"></td>";
                        }

                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(7).text == "enable") {
                        if (matsta_var.value != "0") {
                            str = str + "<td><input class=\"btextforgrid\"  id=" + matsta + " type=\"text\"  value=" + matsta_var.value + "></td>";
                        }
                        else {
                            str = str + "<td><input class=\"btextforgrid\"  id=" + matsta + " type=\"text\"></td>";
                        }

                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }


                cardid = "card" + i;

                //this is the function cretaed to get the solo edition rate break up with referrence  to the package selected 
                /////////////////////////////////////////////////////////////////////////////////////////////////////////////
                //
                /////////////////////////////////////////////////////////////////////////////////////////////////////////////
                /////////////////////////////////////////////////////////////////////////////////////////////////////////////

                picfield = "pic" + i;
                filename = "fil" + i;

                // File Name
                //str=str+"</select></td><td><input class=\"btextforgrid\" type=\"text\" id="+filename+" disabled  value=\"\"></td>";
                var filiname_var = document.getElementById(filename);
                if (filiname_var != null) {
                    if (filiname_var.value != "") {
                        if (browser != "Microsoft Internet Explorer") {
                            if (xmlObj.childNodes[23].childNodes[17].childNodes[0].nodeValue == "enable") {
                                str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled value=" + filiname_var.value + " ></td>";
                            }
                            else {
                                str = str + "<td style=\"display:none;\"></td>";
                            }
                        }
                        else {
                            if (xmlObj.childNodes(11).childNodes(8).text == "enable") {
                                str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled value=" + filiname_var.value + " ></td>";
                            }
                            else {
                                str = str + "<td style=\"display:none;\"></td>";
                            }
                        }

                    }
                    else {
                        if (browser != "Microsoft Internet Explorer") {
                            if (xmlObj.childNodes[23].childNodes[17].childNodes[0].nodeValue == "enable") {
                                str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled value=\"\" ></td>";
                            }
                            else {
                                str = str + "<td style=\"display:none;\"></td>";
                            }
                        }
                        else {
                            if (xmlObj.childNodes(11).childNodes(8).text == "enable") {
                                str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled value=\"\" ></td>";
                            }
                            else {
                                str = str + "<td style=\"display:none;\"></td>";
                            }
                        }
                    }
                }
                else {
                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[17].childNodes[0].nodeValue == "enable") {
                            str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled value=\"\" ></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(8).text == "enable") {
                            str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled value=\"\" ></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }
                }

                // Upload Button
                var upl = "upload" + i;
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[19].childNodes[0].nodeValue == "enable") {
                        str = str + "<td width=\"50px\"><input  class=\"button1\" type=\"button\" id=" + upl + " Value=\"Attachment\" ></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(9).text == "enable") {
                        str = str + "<td width=\"50px\"><input  class=\"button1\" type=\"button\" id=" + upl + " Value=\"Attachment\" ></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                //// split Button
                var splt = "splt" + i;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[75].childNodes[0].nodeValue == "enable" && document.getElementById('hiddenuomdesc').value == "CD" && ds.Tables[0].Rows[s].PRIORITY != '1' && ds.Tables[0].Rows[s].SPLIT == 'Y')//ds.Tables[0].Rows[s].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                    {
                        str = str + "<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" Value=\"Split\" id=" + splt + " ></td>"; //onclick=\"return opensplitedition('"+ds.Tables[0].Rows[s].Edition_Name+"','"+i+"');\" 
                    }
                    else {
                        str = str + "<td ></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(37).text == "enable" && document.getElementById('hiddenuomdesc').value == "CD" && ds.Tables[0].Rows[s].PRIORITY != '1' && ds.Tables[0].Rows[s].SPLIT == 'Y')//ds.Tables[0].Rows[s].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                    {
                        str = str + "<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" Value=\"Split\" id=" + splt + " ></td>";
                    }
                    else {
                        str = str + "<td ></td>";
                    }
                }
                //// sub edition detail Button
                var subedi = "subedi" + i;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[73].childNodes[0].nodeValue == "enable")//ds.Tables[0].Rows[s].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                    {
                        str = str + "<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" Value=\"Detail\" id=" + subedi + "></td>";
                    }
                    else {
                        str = str + "<td ></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(36).text == "enable")//ds.Tables[0].Rows[s].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                    {
                        str = str + "<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" Value=\"Detail\" id=" + subedi + " ></td>";
                    }
                    else {
                        str = str + "<td ></td>";
                    }
                }

                // Page Position

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[21].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input type=\"text\" id=" + pagepost + " class=\"dropdownforgridqbc\" ></td>";

                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(10).text == "enable") {
                        str = str + "<td><input type=\"text\" id=" + pagepost + " class=\"dropdownforgridqbc\" ></td>";

                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                ////////////this is to for larest date

                late = "lat" + i;

                repeat = "rep" + i;
                var dat = "mm+" / "+" / "+dd+" / "+yyyy";

                // Latest By
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[23].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + late + "  value=\"\" ></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(11).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + late + "  value=\"\" ></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[25].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + repeat + "  value=\"\"  ></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(12).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + repeat + "  value=\"\" ></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }



                namecode = "one";
                //str=str+"<td><select id="+premid+" class=\"dropdownforgrid\" onchange=\"return getpercenprem("+premid+","+i+",'"+namecode+"');\"  >";

                ///this is to bind the premium drop down
                //str=str+"<option value=\"0\" selected=\"true\">select</option>";
                //for(k=0;k<=ds.Tables[2].Rows.length-1;k++)
                //{
                ////////on click function is there to get the prem % on premium drop down change
                //    str=str+"  <option value="+ds.Tables[2].Rows[k].Premiumcode+">"+ds.Tables[2].Rows[k].premiumname+"</option>"
                //}

                premper = "premper" + i;
                premper1 = "premperone" + i;
                adtypid = "adtyp" + i;
                namecode = "two";
                preall = "preall" + i;
                adcat = "adcat" + i;
                page = "pgpre" + i;
                pageprem = "pagper" + i;
                //str=str+"</select></td><td><input class=\"btextsmallsize\" disabled type=\"text\" id="+premper+" value=\"\"></td><td><select id="+prem1id+" class=\"dropdownforgrid\" onchange=\"return getpercenprem("+prem1id+","+i+",'"+namecode+"');\"  >";
                /////this is to bind the premium 2 drop down
                //str=str+"<option value=\"0\" selected=\"true\">select</option>";
                //for(k=0;k<=ds.Tables[2].Rows.length-1;k++)
                //{
                ////////on click function is there to get the prem % on premium drop down change
                //    str=str+"  <option value="+ds.Tables[2].Rows[k].Premiumcode+">"+ds.Tables[2].Rows[k].premiumname+"</option>"
                // }

                //str=str+"</select></td><td><input disabled class=\"btextsmallsize\" type=\"text\" id="+premper1+" value=\"\"></td>"
                //
                pagstr = "sec"
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[27].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input type=\"text\" id=" + page + " class=\"dropdownforgridqbc\" ></td>";
                        //                    if(dprem1=="")
                        //                    {
                        //                            dprem1=dprem1+"<td><select id="+page+" class=\"dropdownforgridqbc\" onchange=\"return getpageprem("+page+","+i+",'"+pagstr+"');\"  >";
                        //                            /////this is to bind the premium 2 drop down
                        //                            dprem1=dprem1+"  <option value=\"0\" selected=\"true\">Select</option>";
                        //                            var h;
                        //                            for(h=0;h<=ds.Tables[7].Rows.length-1;h++)
                        //                            {
                        //                                ////////on click function is there to get the prem % on premium drop down change
                        //                                dprem1=dprem1+"  <option value="+ds.Tables[7].Rows[h].pos_type_code+">"+ds.Tables[7].Rows[h].pos_type_code+"</option>"
                        //                            }
                        //                            
                        //                            dprem1=dprem1+"</select></td>";
                        //                            str=str+dprem1;
                        //                      }
                        //                      else
                        //                            str=str+dprem1.replace("pgpre"+dcou,page);     
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(13).text == "enable") {
                        str = str + "<td><input type=\"text\" id=" + page + " class=\"dropdownforgridqbc\" ></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                ////this is to bind the per for page premium
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[29].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id=" + pageprem + " value=\"\"></td>"
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(14).text == "enable") {
                        str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id=" + pageprem + " value=\"\"></td>"
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                ///////////////////////////////////////////////

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[31].childNodes[0].nodeValue == "enable") {
                        if (dpre == "") {
                            dpre = dpre + "<td><select id=" + preall + " class=\"dropdownforgrid\">";
                            //////////////this is to bind the drop down for accepting the premium

                            dpre = dpre + "<option value=\"0\">Select</option>";
                            dpre = dpre + "<option value=\"1\">Yes</option>";
                            dpre = dpre + "<option value=\"2\">No</option>";

                            dpre = dpre + "</td></select>";
                            str = str + dpre;
                        }
                        else
                            str = str + dpre.replace("preall" + dcou, preall);
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(15).text == "enable") {
                        if (dpre == "") {
                            dpre = dpre + "<td><select id=" + preall + " class=\"dropdownforgrid\">";
                            //////////////this is to bind the drop down for accepting the premium

                            dpre = dpre + "<option value=\"0\">Select</option>";
                            dpre = dpre + "<option value=\"1\">Yes</option>";
                            dpre = dpre + "<option value=\"2\">No</option>";

                            dpre = dpre + "</td></select>";
                            str = str + dpre;
                        }
                        else
                            str = str + dpre.replace("preall" + dcou, preall);
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[33].childNodes[0].nodeValue == "enable") {
                        if (adcar_var.value == "0") {
                            str = str + "<td><input type=\"type=text\" id=" + adcat + " class=\"dropdownforgridqbc\" ></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\" id=" + adcat + "  class=\"dropdownforgridqbc\" ></td>";
                        }


                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(16).text == "enable") {
                        if (drpadsubcat_var.value == "0") {
                            str = str + "<td><input type=\"type=text\" id=" + adcat + " class=\"dropdownforgridqbc\" ></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\" id=" + adcat + "  class=\"dropdownforgridqbc\"  value=" + drpadsubcat_var.value + "></td>";
                        }

                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }


                billstat = "bill" + i;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[35].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input type=\"type=text\" id=" + billstat + " class=\"dropdownforgridqbc\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(17).text == "enable") {
                        str = str + "<td><input type=\"type=text\" id=" + billstat + " class=\"dropdownforgridqbc\" ></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                paid = "pai" + i;
                solo = "sol" + i;
                gross = "gro" + i;
                ///////////////this is to bind the drop down for paid/free insertion

                if (ds.Tables[9].Rows[0].Paid_permission == "0") {
                    if (browser != "Microsoft Internet Explorer") {

                        if (xmlObj.childNodes[23].childNodes[37].childNodes[0].nodeValue == "enable") {
                            if (dpaid == "") {
                                dpaid = dpaid + "<td><select id=" + paid + " class=\"dropdownforgridsmallP\" disabled >";
                                dpaid = dpaid + "<option value=\"Y\">Yes</option>";
                                dpaid = dpaid + "<option value=\"N\">No</option>";
                                dpaid = dpaid + "<option value=\"P\">Paid</option>";

                                dpaid = dpaid + "</select></td>";
                                str = str + dpaid;
                            }
                            else
                                str = str + dpaid.replace("pai" + dcou, paid);
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(18).text == "enable") {
                            if (dpaid == "") {
                                dpaid = dpaid + "<td><select id=" + paid + " class=\"dropdownforgridsmallP\" disabled >";
                                dpaid = dpaid + "<option value=\"Y\">Yes</option>";
                                dpaid = dpaid + "<option value=\"N\">No</option>";
                                dpaid = dpaid + "<option value=\"P\">Paid</option>";
                                dpaid = dpaid + "</select></td>";
                                str = str + dpaid;
                            }
                            else
                                str = str + dpaid.replace("pai" + dcou, paid);
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }
                }
                else {
                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[37].childNodes[0].nodeValue == "enable") {
                            if (dpaid == "") {
                                dpaid = dpaid + "<td><select id=" + paid + " class=\"dropdownforgridsmallP\" >";
                                dpaid = dpaid + "<option value=\"Y\">Yes</option>";
                                dpaid = dpaid + "<option value=\"N\">No</option>";
                                dpaid = dpaid + "<option value=\"P\">Paid</option>";
                                dpaid = dpaid + "</select></td>";
                                str = str + dpaid;
                            }
                            else
                                str = str + dpaid.replace("pai" + dcou, paid);
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(18).text == "enable") {
                            if (dpaid == "") {
                                dpaid = dpaid + "<td><select id=" + paid + " class=\"dropdownforgridsmallP\" >";
                                dpaid = dpaid + "<option value=\"Y\">Yes</option>";
                                dpaid = dpaid + "<option value=\"N\">No</option>";
                                dpaid = dpaid + "<option value=\"P\">Paid</option>";
                                dpaid = dpaid + "</select></td>";
                                str = str + dpaid;
                            }
                            else
                                str = str + dpaid.replace("pai" + dcou, paid);
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }
                }
                //str=str+"<option value=\"0\">Select</option>";


                //this is to upload the image

                billamt = "ba" + i;

                // Solo Rate

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[39].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + solo + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(19).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + solo + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                // Gross Amount
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[41].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + gross + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(20).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + gross + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                ////
                pageno_inserts = "pagno" + i;
                remark_inserts = "rem" + i;
                billrate = "br" + i;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[43].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input  class=\"btextforinsertright\"   type=\"text\" id=" + pageno_inserts + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(21).text == "enable") {
                        str = str + "<td><input  class=\"btextforinsertright\"   type=\"text\" id=" + pageno_inserts + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[45].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input  class=\"btextforgridedition\"    type=\"text\" id=" + remark_inserts + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(22).text == "enable") {
                        str = str + "<td><input  class=\"btextforgridedition\"    type=\"text\" id=" + remark_inserts + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }


                ///
                // Bill Amount

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[47].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforinsertright\" disabled type=\"text\" id=" + billamt + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(23).text == "enable") {
                        str = str + "<td><input class=\"btextforinsertright\" disabled type=\"text\" id=" + billamt + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                //Bill Rate

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[49].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + billrate + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(24).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + billrate + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                // card rate
                var cs = 0;
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[51].childNodes[0].nodeValue == "enable") {
                        str = str + "<td>";
                        str = str + "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cardid + " value=\"\">";
                        str = str + "</td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(25).text == "enable") {
                        str = str + "<td>";
                        str = str + "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cardid + " value=\"\">";
                        str = str + "</td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                ///////////////////////
                discrate = "disrat" + i;

                // Discount Rate

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[53].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + discrate + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(26).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + discrate + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                // Agreed Rate

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[55].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + agrred + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(27).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + agrred + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }



                if (document.getElementById('hiddenuomdesc').value != "CD") {
                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[57].childNodes[0].nodeValue == "enable") {
                            str = str + "<td><input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  ></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(28).text == "enable") {
                            str = str + "<td><input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\" ></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }

                }
                else {
                    if (document.getElementById('txtcolum').disabled == true) {
                        if (browser != "Microsoft Internet Explorer") {
                            if (xmlObj.childNodes[23].childNodes[57].childNodes[0].nodeValue == "enable") {
                                str = str + "<td><input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\" ></td>";
                            }
                            else {
                                str = str + "<td style=\"display:none;\"></td>";
                            }
                        }
                        else {
                            if (xmlObj.childNodes(11).childNodes(28).text == "enable") {
                                str = str + "<td><input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  ></td>";
                            }
                            else {
                                str = str + "<td style=\"display:none;\"></td>";
                            }
                        }

                    }
                    else {
                        if (browser != "Microsoft Internet Explorer") {
                            if (xmlObj.childNodes[23].childNodes[57].childNodes[0].nodeValue == "enable") {
                                str = str + "<td><input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  ></td>";
                            }
                            else {
                                str = str + "<td style=\"display:none;\"></td>";
                            }
                        }
                        else {
                            if (xmlObj.childNodes(11).childNodes(28).text == "enable") {
                                str = str + "<td><input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\" ></td>";
                            }
                            else {
                                str = str + "<td style=\"display:none;\"></td>";
                            }
                        }

                    }
                }
                /////////////////////////////////////////////////// 03 July ///////////////////////////

                ////this is to bind the Ad sub cat3 drop down

                adsubcat3 = "adscat3" + i;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[59].childNodes[0].nodeValue == "enable") {
                        if (adcat3_var.value == "0") {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat3 + " class=\"dropdownforgridqbc\" ></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat3 + "  class=\"dropdownforgridqbc\"  value=" + adcat3_var.value + "></td>";
                        }


                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(29).text == "enable") {
                        if (adcat3_var.value == "0") {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat3 + " class=\"dropdownforgridqbc\"></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat3 + " class=\"dropdownforgridqbc\"   value=" + adcat3_var.value + "></td>";
                        }

                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                    }
                }

                ////this is to bind the Ad sub cat4 drop down

                adsubcat4 = "adscat4" + i;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[61].childNodes[0].nodeValue == "enable") {
                        if (adcat4_var.value == "0") {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat4 + " class=\"dropdownforgridqbc\" ></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat4 + "  class=\"dropdownforgridqbc\"  value=" + adcat4_var.value + "></td>";
                        }

                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(30).text == "enable") {
                        if (adcat4_var.value == "0") {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat4 + " class=\"dropdownforgridqbc\" ></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat4 + "  class=\"dropdownforgridqbc\"  value=" + adcat4_var.value + "></td>";
                        }

                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                    }
                }

                ////this is to bind the Ad sub cat5 drop down

                adsubcat5 = "adscat5" + i;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[63].childNodes[0].nodeValue == "enable") {
                        if (adcat5_var.value == "0")
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat5 + " class=\"dropdownforgridqbc\"></td>";
                        else
                            str = str + "<td><input type=\"type=text\"  id=" + adsubcat5 + "  class=\"dropdownforgridqbc\" value=" + adcat5_var.value + "></td>";

                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(31).text == "enable") {
                        if (adcat5_var.value == "0")
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat5 + " class=\"dropdownforgridqbc\"></td>";
                        else
                            str = str + "<td><input type=\"type=text\"  id=" + adsubcat5 + " class=\"dropdownforgridqbc\" value=" + adcat5_var.value + " ></td>";

                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                    }
                }

                // for logo
                var logohei = "logohei" + i;
                var logowid = "logowid" + i;
                var logonam = "logonam" + i;
                //make_td=document.createElement("td");
                // make_td.align="center";
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[65].childNodes[0].nodeValue == "enable") {
                        str += "<td><input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logohei + " Value=\"\" ></td>";
                        str += "<td><input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logowid + " Value=\"\" ></td>";
                        str += "<td><input  class=\"dropdownforgrid\" disabled type=\"text\" id=" + logonam + " Value=\"\" ></td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">logoh</td>";
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">logow</td>";
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">logon</td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(32).text == "enable") {
                        str += "<td><input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logohei + " Value=\"\" ></td>";
                        str += "<td><input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logowid + " Value=\"\" ></td>";
                        str += "<td><input  class=\"dropdownforgrid\" disabled type=\"text\" id=" + logonam + " Value=\"\" ></td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">logoh</td>";
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">logow</td>";
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">logon</td>";
                    }
                }
                // for bold charcter count
                var splboldsize = "splboldsize" + i;
                //  make_td=document.createElement("td");
                //  make_td.align="center";
                str += "<td><input  class=\"btextsmallsize\" disabled type=\"text\" id=" + splboldsize + " Value=\"\" ></td>";
                // Make_Row.appendChild(make_td);
                //  make_td.innerHTML="<input  class=\"btextsmallsize\" disabled type=\"text\" id="+logohei+" Value=\"\" >";
                // Make_Row.appendChild(make_td);


                // make_td=document.createElement("td");
                //  make_td.align="center";
                //  make_td.innerHTML="<input  class=\"btextsmallsize\" disabled type=\"text\" id="+logowid+" Value=\"\" >";
                //  Make_Row.appendChild(make_td);


                //make_td=document.createElement("td");
                //make_td.align="center";

                //  make_td.innerHTML="<input  class=\"dropdownforgrid\" disabled type=\"text\" id="+logonam+" Value=\"\" >";
                //Make_Row.appendChild(make_td);

                // for logo

                pkgcodegrid = 'hiddenpckcode' + i;
                //This is a hidden field in the insertion grid which holds the Package Code for internal processing only
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkgcodegrid + "' value=" + ds.Tables[0].Rows[s].EDITION_CODE + "></td>";
                ////////////////////////////////////////////////// 03 July ///////////////////////////
                var pubcode = 'pubcode' + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + pubcode + "' value='" + ds.Tables[0].Rows[s].PUBCODE + "'></td>";

                var pkg_ins = 'pkg_ins' + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_ins + "' value=''></td>";

                pkg_alias = 'pkg_alias' + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_alias + "' value='" + ds.Tables[0].Rows[s].PKGNAME + "'></td>";


                //new change ankur 23 feb
                //new change ankur 23 feb
                logoH = "lh" + i;
                logoW = "lw" + i;
                logonam = "lnam" + i
                var tdsln = "tdsln" + i;
                var tdslh = "tdslh" + i;
                var tdslw = "tdslw" + i;
                var tdslup = "tdslup" + i;
                if (gblogowithmatter == "yes") {
                    str = str + "<td id=" + tdsln + "  ><input class=\"btextforgrid\" disabled type=\"text\" id=" + logonam + "  value=\"\"></td>";
                    str = str + "<td id=" + tdslh + " ><input class=\"btextforgrid\" disabled onchange=\"return gettotalsize_logo(" + logoH + "," + logoW + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" type=\"text\" id=" + logoH + "  value=" + document.getElementById('txtlogohei').value + "></td>";
                    str = str + "<td id=" + tdslw + " ><input class=\"btextforgrid\" disabled onchange=\"return gettotalsize_logo(" + logoH + "," + logoW + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" type=\"text\" id=" + logoW + "  value=" + document.getElementById('txtlogowid').value + "></td>";
                    str = str + "<td id=" + tdslup + "  width=\"50px\"><input  class=\"button1\" type=\"button\" Value=\"Logo Upload\" onclick=\"uploadimagelogo('" + ds.Tables[0].Rows[s].Edition_Name + "','" + picfield + "','" + insertval + "','" + editid + "','" + logonam + "','" + i + "')\"></td>";

                }
                else {
                    str = str + "<td id=" + tdsln + " style=\"display:none;\" ><input class=\"btextforgrid\" disabled type=\"text\" id=" + logonam + "  value=\"\"></td>";
                    str = str + "<td id=" + tdslh + " style=\"display:none;\"><input class=\"btextforgrid\" disabled type=\"text\" id=" + logoH + "  value=\"\"></td>";
                    str = str + "<td id=" + tdslw + " style=\"display:none;\"><input class=\"btextforgrid\" disabled type=\"text\" id=" + logoW + "  value=\"\"></td>";
                    str = str + "<td id=" + tdslup + " style=\"display:none;\" width=\"50px\"><input  class=\"button1\" type=\"button\" Value=\"Logo Upload\" onclick=\"uploadimage('" + ds.Tables[0].Rows[s].Edition_Name + "','" + picfield + "','" + insertval + "','" + editid + "','" + logonam + "','" + i + "')\"></td>";
                }
                ////////////

                ////////////

                var spltdata = "spltdata" + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + spltdata + "' value=\"\"></td>";

                var subedidata = "subedidata" + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + subedidata + "' value=\"\"></td>";


                var vat = "vat" + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + vat + "' value=\"\"></td>";

                var vat_inc = "vat_inc" + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + vat_inc + "' value=\"\"></td>";
                /////////////////////////////////////anuja eyecather
                var eye_cather = "eye_cather" + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + eye_cather + "' value=\"\"></td>";
                ////////////////////day wise premium
                var hdnday_prim = "hdnday_prim" + i;
                str = str + "<td><input disabled class=\"btextsmallsize\"  style=\"display:none;\" type=\"text\" id='" + hdnday_prim + "' value=\"\"></td>";

                var clicatamt = "clicatamt" + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + clicatamt + "' value=\"\"></td>";
                
                var GSTAMT = "GSTAMT" + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + GSTAMT + "' value=\"\"></td>";
                
                 var GSTGD = "GSTGD" + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + GSTGD + "' value=\"\"></td>";
                ////////////////////////////////////////

                str = str + "</tr>";

                //                ////////add by anuja for no issue date
                //                if (ds.Tables[0].Rows[s].Date != "")///add by anuja
                //                {
                //                    ///add by anuja
                //                    var date_res = dropDateCheck(ds.Tables[0].Rows[s].Date, document.getElementById(id), ds.Tables[0].Rows[s].EDITION_CODE, ds.Tables[0].Rows[s].PKGNAME, ds.Tables[0].Rows[s].Edition_Name);
                //                    if (date_res == false) {
                //                    }
                //                    ///end by anuja                 
                //                } 
                //                ///////////////////////////end

                // idnew = parseInt(idnew) + 1;

                //document.getElementById(id).value=vvalue;
                //i = parseInt(i) + 1; //comment by anuja for no issuedate
                i = parseInt(i, 10) + 1; ////////////add

            }

        }
        str = str + "</tbody></table></div>";
        idnew = ds.Tables[0].Rows.length;
        var temp = idnew;
        document.getElementById('tblinsert').innerHTML = str;

        for (var countpkg = 0; countpkg < document.getElementById('drppackagecopy').length; countpkg++) {
            var pkgcopy = document.getElementById('drppackagecopy').options[countpkg].value;
            var arrpkgcopy = pkgcopy.split('@')
            var pkgcopycode = arrpkgcopy[0];
            var arr_pkg_ins_value = arrpkgcopy[1].split('(');
            var pkg_ins_value = arr_pkg_ins_value[1].replace(')', '');
            for (var gridcount = 0; gridcount < document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1; gridcount++) {
                var old_pkgcodegrid = 'hiddenpckcode' + gridcount;
                var old_pkg_ins = 'pkg_ins' + gridcount;
                if (pkgcopycode == document.getElementById(old_pkgcodegrid).value) {
                    document.getElementById(old_pkg_ins).value = pkg_ins_value;
                }
            }
        }
        var dateformat = document.getElementById('hiddendateformat');
        var dummydate = document.getElementById('txtdummydate');
        var tblinsert_var = document.getElementById('tblinsert');
        if (browser != "Microsoft Internet Explorer") {
            var len = "bookdiv";
            var y = date.length;
            var k;
            for (k = 0; k < y; k++) {
                document.getElementById("Text" + k).value = date[k];
            }
        }
        if (browserversion > 6) {
            $(".dropdownforgridsmall").change(function () {
                if (document.activeElement.id.indexOf("pai") >= 0) {
                    blankGross();
                }
            });
            $(".btextsmallsizeH").change(function () {
                if (document.activeElement.id.indexOf("pgpre") >= 0 || document.activeElement.id.indexOf("nocol") >= 0 || document.activeElement.id.indexOf("hei") >= 0 || document.activeElement.id.indexOf("wid") >= 0 || document.activeElement.id.indexOf("ins") >= 0) {
                    var i;
                    if (document.activeElement.id.indexOf("pgpre") >= 0) {
                        i = document.activeElement.id.substring(5, document.activeElement.id.length + 1);
                        var page = "pgpre" + i;
                        var pagstr = "sec";
                        var f = getpageprem(page, i, pagstr);
                        if (f == false)
                            return false;
                    }
                    else {
                        if (document.activeElement.id.indexOf("nocol") >= 0) {
                            i = document.activeElement.id.substring(5, document.activeElement.id.length + 1);

                        }
                        else {
                            i = document.activeElement.id.substring(3, document.activeElement.id.length + 1);

                        }
                        var height = "hei" + i;
                        var width = "wid" + i;
                        var inserts = "ins" + i;
                        var insertval = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(i, 10) + 1].cells[0].innerHTML;
                        var noofcol = "nocol" + i;
                        var f = gettotalsize(height, width, i, inserts, insertval, noofcol);
                        if (f == false)
                            return false;
                    }
                }
            });
            $(".btextforgriddate").change(function () {
                if (document.activeElement.id.indexOf("Text") >= 0) {
                    var f = chkDateforGrid();
                    if (f == false)
                        return false;
                }
                else if (document.activeElement.id.indexOf("rep") >= 0 || document.activeElement.id.indexOf("lat") >= 0) {
                    checkdate(document.getElementById(document.activeElement.id));
                }
            });

            //////add by anuja
            for (i = 0; i < document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows.length - 1; i++) {

                if (repeatdate == "0" || repeatdate == "1") {
                    var id = "Text" + i;

                    vvalue = document.getElementById('Text' + i).value;
                    if (dateSelected != undefined && dateSelected != "") {
                        if (browser != "Microsoft Internet Explorer") {
                            var pkgfullname = document.getElementById('pkg_alias' + i).value;
                            var pkgid = document.getElementById('hiddenpckcode' + i).value;
                            var pkgname = document.getElementById('pkg_alias' + i).value;
                            var compcode = compcode_vari.value;

                            dateday = vvalue;

                            document.getElementById('Text' + i).value = vvalue;
                        }
                        else {
                            var pkgfullname = document.getElementById('pkg_alias' + i).value;
                            var pkgid = document.getElementById('hiddenpckcode' + i).value;
                            var pkgname = document.getElementById('pkg_alias' + i).value;
                            var compcode = compcode_vari.value;
                            dateday = vvalue;

                            document.getElementById('Text' + i).value = vvalue;
                        }
                        if (browser != "Microsoft Internet Explorer") {
                            var httpRequest = null; ;
                            httpRequest = new XMLHttpRequest();
                            if (httpRequest.overrideMimeType) {
                                httpRequest.overrideMimeType('text/xml');
                            }

                            httpRequest.onreadystatechange = function () { alertContents(httpRequest) };
                            var adcat = adcat_var.value;
                            var center = '';
                            if (center_vari != null) {
                                center = center_vari.value;
                                if (chkall_vari != null) {
                                    if (chkall_vari.checked == true) {
                                        center = '0';
                                    }
                                }
                                else {
                                    center = '0';
                                }
                            }
                            httpRequest.open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
                            httpRequest.send('');
                            //alert(httpRequest.readyState);
                            if (httpRequest.readyState == 4) {
                                //alert(httpRequest.status);
                                if (httpRequest.status == 200) {
                                    strtext = httpRequest.responseText;
                                }
                                else {
                                    alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                                }
                            }
                        }
                        else {
                            validuse = "";
                            var xml = new ActiveXObject("Microsoft.XMLHTTP");
                            var adcat = adcat_var.value;
                            var center = '';
                            if (center_vari != null) {
                                center = center_vari.value;
                                if (chkall_vari != null) {
                                    if (chkall_vari.checked == true) {
                                        center = '0';
                                    }
                                }
                                else {
                                    center = '0';
                                }
                            }
                            xml.Open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
                            xml.Send();
                            strtext = xml.responseText;
                        }
                        if (strtext == "NOT A VALID DATE") {
                            alert("NOT A VALID DATE");
                            document.getElementById(id).value = "";
                            return false;
                        }
                        if (strtext == "0") {
                            //alert("Day is not the publishing day");
                            document.getElementById(id).value = "";
                            return false;
                        }
                        else {
                            if (strtext == "1")
                                document.getElementById(id).value = vvalue;
                            else {
                                if (strtext != "") {
                                    if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                                        var txt = strtext;
                                        var txt1 = txt.split("/");
                                        var dd = txt1[0];
                                        var mm1 = txt1[1];
                                        var mm = txt1[1]; //getMonthNo(mm1);
                                        var yy = txt1[2];
                                        caldate[cali] = dd;
                                        caldatemonth[cali] = mm;
                                        caldateyear[cali] = yy;
                                        cali = parseInt(cali, 10) + 1;
                                    }
                                    else if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                                        var txt = strtext;
                                        var txt1 = txt.split("/");
                                        var dd = txt1[1];
                                        var mm1 = txt1[0];
                                        var mm = txt1[0]; //getMonthNo(mm1);
                                        var yy = txt1[2];
                                        caldate[cali] = dd;
                                        caldatemonth[cali] = mm;
                                        caldateyear[cali] = yy;
                                        cali = parseInt(cali, 10) + 1;
                                    }
                                    else if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
                                        var txt = strtext;
                                        var txt1 = txt.split("/");
                                        var dd = txt1[2];
                                        var mm1 = txt1[1];
                                        var mm = txt1[1]; //getMonthNo(mm1);
                                        var yy = txt1[0];
                                        caldate[cali] = dd;
                                        caldatemonth[cali] = mm;
                                        caldateyear[cali] = yy;
                                        cali = parseInt(cali, 10) + 1;
                                    }
                                }
                                document.getElementById(id).value = strtext;
                                if (vvalue != strtext) {
                                    alert(vvalue + " Date is no issue date of edition " + pkgname);
                                    document.getElementById(id).value = "";
                                   
                                    
                                    cali = cali - 1;
                                }
                            }
                        }
                    }
                }
                temp = parseInt(temp) + 1;
            }
            ////////end by anuja
        }
        else {
            for (var i = count; i < document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows.length - 1; i++) {
                var height = "hei" + i;
                var width = "wid" + i;
                var noofcol = "nocol" + i;
                var id = "Text" + i;
                var adsubcat3 = "adscat3" + i;
                var adsubcat4 = "adscat4" + i;
                var inserts = "ins" + i;
                var adcat = "adcat" + i;
                var adsubcat = "ads" + i;
                var paid = "pai" + i;
                var page = "pgpre" + i;
                var pagstr = "sec"
                var paid = "pai" + i;
                var insertval = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(i, 10) + 1].cells[0].innerHTML;
                var height_vari = document.getElementById(height);
                var par1 = (height_vari.parentNode).parentNode;
                if (browser != "Microsoft Internet Explorer") {
                    document.getElementById(height).onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                    document.getElementById(width).onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                    document.getElementById(noofcol).onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                    document.getElementById(id).onchange = new Function("return chkDateforGrid(this);");
                    //par1.all[adsubcat3].onchange=new Function("getadsubcat4("+adsubcat3+","+i+");");
                    //par1.all[adsubcat4].onchange=new Function("getadsubcat5("+adsubcat4+","+i+");");
                    // if(par1.all[adcat]!=undefined && par1.all[adcat]!="undefined" && par1.all[adcat]!=null)
                    //   par1.all[adcat].onchange=new Function("filladsubgrid("+adcat+","+adsubcat+");");
                    if (document.getElementById(paid) != undefined && document.getElementById(paid) != "undefined" && document.getElementById(paid) != null)
                        document.getElementById(paid).onchange = new Function("return blankGross();");

                    if (document.getElementById(page) != undefined && document.getElementById(page) != "undefined" && document.getElementById(page) != null)
                        document.getElementById(page).onchange = new Function("return getpageprem(" + page + "," + i + ",'" + pagstr + "');");
                }
                else {
                    par1.all[height].onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                    par1.all[width].onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                    par1.all[noofcol].onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                    par1.all[id].onchange = new Function("return chkDateforGrid(this);");
                    //par1.all[adsubcat3].onchange=new Function("getadsubcat4("+adsubcat3+","+i+");");
                    //par1.all[adsubcat4].onchange=new Function("getadsubcat5("+adsubcat4+","+i+");");
                    // if(par1.all[adcat]!=undefined && par1.all[adcat]!="undefined" && par1.all[adcat]!=null)
                    //   par1.all[adcat].onchange=new Function("filladsubgrid("+adcat+","+adsubcat+");");
                    if (par1.all[paid] != undefined && par1.all[paid] != "undefined" && par1.all[paid] != null)
                        par1.all[paid].onchange = new Function("return blankGross();");
                    if (par1.all[page] != undefined && par1.all[page] != "undefined" && par1.all[page] != null)
                        par1.all[page].onchange = new Function("return getpageprem(" + page + "," + i + ",'" + pagstr + "');");
                }
                //////add by anuja
                if (repeatdate == "0" || repeatdate == "1") {
                    var id = "Text" + i;
                    //    if(caldatemonth.length>=i && caldatemonth[i]!=undefined)
                    //  {
                    // var mmM=caldatemonth[i].toString();
                    //}
                    //else{
                    var mmM = parseInt(monthSelected, 10) + 1;
                    mmM = mmM.toString();
                    //}
                    if (mmM.toString().length == 1)
                        mmM = "0" + mmM.toString();
                    if (dateformat_vari.value == "mm/dd/yyyy") {
                        vvalue = mmM + "/" + dateSelected + "/" + yearSelected;
                    }
                    else if (dateformat_vari.value == "dd/mm/yyyy") {
                        vvalue = dateSelected + "/" + mmM + "/" + yearSelected; ;
                    }
                    else if (dateformat_vari.value = "yyyy/mm/dd") {
                        vvalue = yearSelected + "/" + mmM + "/" + dateSelected; ;
                    }
                    vvalue = document.getElementById('Text' + i).value;

                    if (dateSelected != undefined && dateSelected != "") {
                        if (browser != "Microsoft Internet Explorer") {
                            var pkgfullname = document.getElementById('pkg_alias' + i).value;
                            var pkgid = document.getElementById('hiddenpckcode' + i).value;
                            var pkgname = document.getElementById('pkg_alias' + i).value;
                            var compcode = compcode_vari.value;

                            dateday = vvalue;

                            document.getElementById('Text' + i).value = vvalue;
                        }
                        else {
                            var pkgfullname = par1.all['pkg_alias' + i].value;
                            var pkgid = par1.all['hiddenpckcode' + i].value;
                            var pkgname = par1.all['pkg_alias' + i].value;
                            var compcode = compcode_vari.value;
                            dateday = vvalue;

                            par1.all['Text' + i].value = vvalue;
                        }
                        if (browser != "Microsoft Internet Explorer") {
                            var httpRequest = null; ;
                            httpRequest = new XMLHttpRequest();
                            if (httpRequest.overrideMimeType) {
                                httpRequest.overrideMimeType('text/xml');
                            }

                            httpRequest.onreadystatechange = function () { alertContents(httpRequest) };
                            var adcat = adcat_var.value;
                            httpRequest.open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
                            httpRequest.send('');
                            //alert(httpRequest.readyState);
                            if (httpRequest.readyState == 4) {
                                //alert(httpRequest.status);
                                if (httpRequest.status == 200) {
                                    strtext = httpRequest.responseText;
                                }
                                else {
                                    alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                                }
                            }
                        }
                        else {
                            validuse = "";
                            var xml = new ActiveXObject("Microsoft.XMLHTTP");
                            var adcat = adcat_var.value;
                            var center = '';
                            if (center_vari != null) {
                                center = center_vari.value;
                                if (chkall_vari != null) {
                                    if (chkall_vari.checked == true) {
                                        center = '0';
                                    }
                                }
                                else {
                                    center = '0';
                                }
                            }
                            xml.Open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
                            xml.Send();
                            strtext = xml.responseText;
                        }
                        if (strtext == "NOT A VALID DATE") {
                            alert("NOT A VALID DATE");
                            document.getElementById(id).value = "";
                            document.getElementById(id).focus();
                            return false;
                        }
                        if (strtext == "0") {
                            //alert("Day is not the publishing day");
                            document.getElementById(id).value = "";
                            return false;
                        }
                        else {
                            if (strtext == "1")
                                document.getElementById(id).value = vvalue;
                            else {
                                if (strtext != "") {
                                    if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                                        var txt = strtext;
                                        var txt1 = txt.split("/");
                                        var dd = txt1[0];
                                        var mm1 = txt1[1];
                                        var mm = txt1[1]; //getMonthNo(mm1);
                                        var yy = txt1[2];
                                        caldate[cali] = dd;
                                        caldatemonth[cali] = mm;
                                        caldateyear[cali] = yy;
                                        cali = parseInt(cali, 10) + 1;
                                    }
                                    else if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                                        var txt = strtext;
                                        var txt1 = txt.split("/");
                                        var dd = txt1[1];
                                        var mm1 = txt1[0];
                                        var mm = txt1[0]; //getMonthNo(mm1);
                                        var yy = txt1[2];
                                        caldate[cali] = dd;
                                        caldatemonth[cali] = mm;
                                        caldateyear[cali] = yy;
                                        cali = parseInt(cali, 10) + 1;
                                    }
                                    else if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
                                        var txt = strtext;
                                        var txt1 = txt.split("/");
                                        var dd = txt1[2];
                                        var mm1 = txt1[1];
                                        var mm = txt1[1]; //getMonthNo(mm1);
                                        var yy = txt1[0];
                                        caldate[cali] = dd;
                                        caldatemonth[cali] = mm;
                                        caldateyear[cali] = yy;
                                        cali = parseInt(cali, 10) + 1;
                                    }
                                }
                                document.getElementById(id).value = strtext;
                                if (vvalue != strtext) {
                                    alert(vvalue + " Date is no issue date of edition " + pkgname);
                                    document.getElementById(id).value = "";
                                    cali = cali - 1;
                                }
                            }
                        }
                    }
                }
                temp = parseInt(temp) + 1;
                //////end by anuja
            }
            checkflag = "1";     //add by anuja for no issue date
        }


        checkflag = "0";
        //alert(str);
        //document.getElementById('tblinsert').innerHTML=str;
        fillcopyfilename()
    }
    if (browser != "Microsoft Internet Explorer") {
        var len = "bookdiv";
        var v = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
        var c;

        var y = date.length;
        var k;
        for (k = 0; k < y; k++) {
            document.getElementById("Text" + k).value = date[k];


        }
        for (c = 0; c < v - 1; c++) {
            if (sizecop[c] != undefined && sizecop[c] != "") {
                document.getElementById("siz" + c).value = sizecop[c];
            }
            else {
                document.getElementById("siz" + c).value = sizecop[0];
            }
            if (heightcop[c] != undefined && heightcop[c] != "") {
                document.getElementById("hei" + c).value = heightcop[c];
            }
            else {
                document.getElementById("hei" + c).value = heightcop[0];
            }
            if (widthcop[v] != undefined && widthcop[c] != "") {
                document.getElementById("wid" + c).value = widthcop[c];
            }
            else {
                document.getElementById("wid" + c).value = widthcop[0];
            }

            if (filecopy[c] != undefined && filecopy[c] != "") {
                document.getElementById("fil" + c).value = filecopy[c];
            }
            else {
                document.getElementById("fil" + c).value = filecopy[0];
            }


        }
    }
    constructCalendar();
    noissueflag = false;
    document.getElementById('txtrepeatingdate').focus();


    return false;
}
function insertLinedrop_callback(response) {
    //alert(response.error);
    caldate = null;
    caldate = new Array();
    caldatemonth = null;
    caldatemonth = new Array();
    caldateyear = null;
    caldateyear = new Array();
    previnsertion = document.getElementById('txtinsertion').value;
    var adsubcatM = document.getElementById('drpadsubcategory').value;
    var colM = document.getElementById('drpcolor').value;
    var uomDesc = document.getElementById('hiddenuomdesc').value;
    var uomM = document.getElementById('drpuom').value;
    var adsizeM = document.getElementById('txtadsize1').value;
    var adsizeM2 = document.getElementById('txtadsize2').value;
    var columnM = document.getElementById('txtcolum').value;
    var matstaM = document.getElementById('drpmatstat').value;
    var adcatM = document.getElementById('drpadcategory').value;
    var adcat_vari = document.getElementById('drpadcategory');
    var totM = document.getElementById('txttotalarea').value;
    var adcat3M = document.getElementById('drpadcat3').value;
    var adcat4M = document.getElementById('drpadcat4').value;
    var adcat5M = document.getElementById('drpadcat5').value;
    var center_vari = document.getElementById('hiddencenter');
    var ds = response.value;
    if (ds == null) {
        alert(response.error.description);
        return false;
    }
    if (document.getElementById('tblinsert') != null)
        document.getElementById('hiddengriddata').value = document.getElementById('tblinsert').innerHTML;
    if (ds != null && ds.Tables.length > 0) {

        noofinsert = ds.Tables[0].Rows.length;
        noofinsertlo = ds.Tables[0].Rows.length;
        gridItemCount = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value);
        fillinsert = ds.Tables[0].Rows.length;
        var getinsval = document.getElementById('txtinsertion').value;
        var totval = parseInt(noofinsert) / parseInt(getinsval);

        var dat = "mm+" / "+" / "+dd+" / "+yyyy";
        var i = 0;
        var j = 0;
        var k = 0;
        var l = 0;
        var m = 0;
        var n = 0;
        var o = 0;
        var p = 0;

        var premid;
        var premper;
        var colid;
        var height;
        var width;
        var size;
        var late;
        var uomid;
        var adtypid;
        var cardid;
        var editid;
        var solorate;
        var premper1;
        var prem1id;
        var namecode;
        var inserts;
        var pagepost;
        var preall;
        var adcat;
        var adsubcat;
        var matsta;
        var filename;
        var discrate;
        var insertsta;
        var billstat;
        var repeat;
        var picfield;
        var colid;
        var paid;
        var agrred;
        var solo;
        var gross;
        var pageno_inserts;
        var remark_inserts;
        var page;
        var pageprem;
        var noofcol;
        var billamt;
        var billrate;
        var pkgcodegrid = "";
        var pagstr = "";

        /*new change ankur 23 feb*/
        var logoH = "";
        var logoW = "";
        var logonam = "";

        var pkg_alias = "";
        //////////////////

        //str="<div id=\"bookdiv\" runat=\"server\" style=\"OVERFLOW: auto; WIDTH: 896px; HEIGHT: 100px; \"><table cellpadding=\"1\" cellspacing=\"1\" id=\"gridtab\" width=\"1000px\" border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\"><td align=\"center\" valign=\"top\" >No.</td><td align=\"center\" valign=\"top\" >Edition</td><td valign=\"top\" align=\"center\">Date</td><td align=\"center\" valign=\"top\">Color</td><td align=\"center\" valign=\"top\">Height</td><td align=\"center\" valign=\"top\">Width</td><td align=\"center\" valign=\"top\">Size</td><td align=\"center\" valign=\"top\">Page Position</td><td align=\"center\" valign=\"top\">Premium</td><td align=\"center\" valign=\"top\">Pre(%)</td><td align=\"center\" valign=\"top\">Premium 1</td><td align=\"center\" valign=\"top\">Pre(%)</td><td align=\"center\" valign=\"top\">Pre Allowed</td><td align=\"center\" valign=\"top\">Adv Cat.</td><td align=\"center\" valign=\"top\">Ad Sub Cat.</td><td align=\"center\" valign=\"top\">Latest By</td><td align=\"center\" valign=\"top\">Repeating</td><td valign=\"top\">Status Material</td><td align=\"center\" valign=\"top\">File Name</td><td align=\"center\" valign=\"top\">Card Rate</td><td valign=\"top\" align=\"center\">Disc. Rate</td><td align=\"center\" valign=\"top\">Insertion Sta.</td><td valign=\"top\">Bill Status</td><td valign=\"top\">Upload</td></tr>";
        //str="<div id=\"bookdiv\" runat=\"server\" style=\"OVERFLOW: auto; WIDTH: 896px; HEIGHT: 100px; \"><table cellpadding=\"1\" cellspacing=\"1\" id=\"gridtab\" width=\"1000px\" border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\"><td align=\"center\" valign=\"top\" >No.</td><td align=\"center\" valign=\"top\" >Edition</td><td valign=\"top\" align=\"center\">Date</td><td align=\"center\" valign=\"top\">Ad Sub Cat.</td><td align=\"center\" valign=\"top\">Color</td><td align=\"center\" valign=\"top\">Height</td><td align=\"center\" valign=\"top\">Width</td><td align=\"center\" valign=\"top\">Size</td><td align=\"center\" valign=\"top\">Page Position</td><td valign=\"top\">Status Material</td><td align=\"center\" valign=\"top\">File Name</td><td align=\"center\" valign=\"top\">Card Rate</td><td valign=\"top\" align=\"center\">Disc. Rate</td><td valign=\"top\" align=\"center\">Agreed Rate</td><td align=\"center\" valign=\"top\">Insertion Sta.</td><td align=\"center\" valign=\"top\">Latest By</td><td align=\"center\" valign=\"top\">Repeating</td><td align=\"center\" valign=\"top\">Premium</td><td align=\"center\" valign=\"top\">Pre(%)</td><td align=\"center\" valign=\"top\">Premium 1</td><td align=\"center\" valign=\"top\">Pre(%)</td><td align=\"center\" valign=\"top\">Pre Allowed</td><td align=\"center\" valign=\"top\">Adv Cat.</td><td valign=\"top\">Bill Status</td><td valign=\"top\">Paid Ins.</td><td valign=\"top\" >Solo Rate</td><td valign=\"top\" >Gross Amt</td><td valign=\"top\">Upload</td></tr>";
        //str="<div id=\"bookdiv\" runat=\"server\" style=\"OVERFLOW: auto; WIDTH: 896px; HEIGHT: 160px; \"><table cellpadding=\"1\" cellspacing=\"1\" id=\"gridtab\" width=\"1000px\" border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\"><td align=\"center\" valign=\"top\" >No.</td><td align=\"center\" valign=\"top\" >Edition</td><td valign=\"top\" align=\"center\">Date</td><td align=\"center\" valign=\"top\">Ad Sub Cat.</td><td align=\"center\" valign=\"top\">Color</td><td align=\"center\" valign=\"top\">Height</td><td align=\"center\" valign=\"top\">Width</td><td align=\"center\" valign=\"top\">Col.</td><td align=\"center\" valign=\"top\" id=\"siz\">Size</td><td align=\"center\" valign=\"top\">Page Position</td><td valign=\"top\">Status Material</td><td align=\"center\" valign=\"top\">File Name</td><td align=\"center\" valign=\"top\">Card Rate</td><td valign=\"top\" align=\"center\">Disc. Rate</td><td valign=\"top\" align=\"center\">Agreed Rate</td><td align=\"center\" valign=\"top\">Insertion Sta.</td><td align=\"center\" valign=\"top\">Latest By</td><td align=\"center\" valign=\"top\">Repeating</td><td align=\"center\" valign=\"top\">Premium</td><td align=\"center\" valign=\"top\">Pre(%)</td><td align=\"center\" valign=\"top\">Premium 1</td><td align=\"center\" valign=\"top\">Pre(%)</td><td align=\"center\" valign=\"top\">Premium 2</td><td align=\"center\" valign=\"top\">Pre(%)</td><td align=\"center\" valign=\"top\">Pre Allowed</td><td align=\"center\" valign=\"top\">Adv Cat.</td><td valign=\"top\">Bill Status</td><td valign=\"top\">Paid Ins.</td><td valign=\"top\" >Solo Rate</td><td valign=\"top\" >Gross Amt</td><td valign=\"top\" >Page No.</td><td valign=\"top\" >Remarks</td><td valign=\"top\" >Bill Amt</td><td valign=\"top\" >Bill Rate</td><td valign=\"top\" style=\"cursor:hand;color:red;\" onclick=\"uploadimageall()\">Upload</td></tr>";
        str = "<div id=\"bookdiv\" runat=\"server\" style=\"OVERFLOW: auto; WIDTH: 827px; HEIGHT: 325px;border:gray 1px Groove; \"><table cellpadding=\"1\" cellspacing=\"1\" id=\"gridtab\" width=\"920px\" border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\">";

        // No.

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[1].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\" >No.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">No.</td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(0).text == "enable") {
                str += "<td align=\"center\" valign=\"top\" >No.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">No.</td>";
            }
        }

        //Edition
        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[3].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\" >Edition</td>"
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Edition</td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(1).text == "enable") {
                str += "<td align=\"center\" valign=\"top\" >Edition</td>"
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Edition</td>";
            }
        }

        // Date
        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[5].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\" align=\"center\">Date</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Date</td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(2).text == "enable") {
                str += "<td valign=\"top\" align=\"center\">Date</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Date</td>";
            }
        }

        //Ad Sub Cat

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[7].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Ad Sub Cat.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(3).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Ad Sub Cat.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
            }
        }

        //Color
        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[9].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Color</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Color</td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(4).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Color</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Color</td>";
            }
        }

        // Height Width Column

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[11].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Height</td>";
                str += "<td align=\"center\" valign=\"top\">Width</td>";
                str += "<td align=\"center\" valign=\"top\">Col.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Height</td>";
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Width</td>";
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Col.</td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(5).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Height</td>";
                str += "<td align=\"center\" valign=\"top\">Width</td>";
                str += "<td align=\"center\" valign=\"top\">Col.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Height</td>";
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Width</td>";
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Col.</td>";
            }
        }

        // Insertion State

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[13].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Insertion Sta.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Insertion Sta.</td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(6).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Insertion Sta.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Insertion Sta.</td>";
            }
        }

        // Status Materaial

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[15].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\">Status Material</td>";
            }
            else {
                str += "<td valign=\"top\" style=\"display:none;\">Status Material</td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(7).text == "enable") {
                str += "<td valign=\"top\">Status Material</td>";
            }
            else {
                str += "<td valign=\"top\" style=\"display:none;\">Status Material</td>";
            }
        }

        //File Name

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[17].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">File Name</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">File Name</td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(8).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">File Name</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">File Name</td>";
            }
        }

        // Upload

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[19].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\" id='uploadA' onclick=\"return uploadimageQBCAll();\" style=\"cursor:hand;cursor:pointer;color:red;\" >Upload</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(9).text == "enable") {
                str += "<td valign=\"top\" id='uploadA' onclick=\"return uploadimageQBCAll();\" style=\"cursor:hand;cursor:pointer;color:red;\">Upload</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        //for split button

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[73].childNodes[0].nodeValue == "enable" && document.getElementById('hiddenuomdesc').value == "CD") {
                str += "<td align=\"center\" valign=\"top\"></td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" ></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(36).text == "enable" && document.getElementById('hiddenuomdesc').value == "CD") {
                str += "<td align=\"center\" valign=\"top\"></td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" ></td>";
            }
        }
        //for sub edition detail button

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[75].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\"></td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" ></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(37).text == "enable") {
                str += "<td align=\"center\" valign=\"top\"></td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" ></td>";
            }
        }
        // Page Position

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[21].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Page Position</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(10).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Page Position</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Latest By

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[23].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Latest By</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(11).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Latest By</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Repeating

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[25].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Repeating</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(12).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Repeating</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        //Premium 1

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[27].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Premium 1</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(13).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Premium 1</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Premium Percent

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[29].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Pre(%)</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(14).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Pre(%)</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Premium Allowed

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[31].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Pre Allowed</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(15).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Pre Allowed</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Adv Cat.

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[33].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Adv Cat.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(16).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Adv Cat.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Bill Status

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[35].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\">Bill Status</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(17).text == "enable") {
                str += "<td valign=\"top\">Bill Status</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Paid Insertions

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[37].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\">Paid Ins.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(18).text == "enable") {
                str += "<td valign=\"top\">Paid Ins.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Solo Rate

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[39].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\" >Solo Rate</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(19).text == "enable") {
                str += "<td valign=\"top\" >Solo Rate</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Gross Amount

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[41].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\" >Gross Amt</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(20).text == "enable") {
                str += "<td valign=\"top\" >Gross Amt</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Page Number

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[43].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\" >Page No.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(21).text == "enable") {
                str += "<td valign=\"top\" >Page No.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Remarks

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[45].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\" >Caption</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(22).text == "enable") {
                str += "<td valign=\"top\" >Caption</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Bill Amount

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[47].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\" >Bill Amt</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(23).text == "enable") {
                str += "<td valign=\"top\" >Bill Amt</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Bill RAte

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[49].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\" >Bill Rate</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(24).text == "enable") {
                str += "<td valign=\"top\" >Bill Rate</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Card Rate

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[51].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Card Rate</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(25).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Card Rate</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Discount Rate

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[53].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\" align=\"center\">Disc. Rate</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(26).text == "enable") {
                str += "<td valign=\"top\" align=\"center\">Disc. Rate</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        //Agreed Rate

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[55].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\" align=\"center\">Agreed Rate</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(27).text == "enable") {
                str += "<td valign=\"top\" align=\"center\">Agreed Rate</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Size

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[57].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\" id=\"siz\">Size</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(28).text == "enable") {
                str += "<td align=\"center\" valign=\"top\" id=\"siz\">Size</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Ad Sub Cat3
        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[59].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Ad Sub Cat3</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(29).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Ad Sub Cat3</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Ad Sub Cat4
        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[61].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Ad Sub Cat4</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(30).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Ad Sub Cat4</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Ad Sub Cat5
        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[63].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Ad Sub Cat5</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(31).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Ad Sub Cat5</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        // for logo

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[65].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Logo H</td><td align=\"center\" valign=\"top\">Logo W</td><td align=\"center\" valign=\"top\">Logo Name</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td><td align=\"center\" valign=\"top\" style=\"display:none;\"></td><td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(32).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Logo H</td><td align=\"center\" valign=\"top\">Logo W</td><td align=\"center\" valign=\"top\">Logo Name</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td><td align=\"center\" valign=\"top\" style=\"display:none;\"></td><td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        str = str + "<td align=\"center\" id=\"tdlpckcode\" style=\"display:none;\" valign=\"top\">PKG CODE</td>";

        str = str + "<td align=\"center\" id=\"tdlinserts\" style=\"display:none;\" valign=\"top\">INSERTS</td>";
        /*new change ankur 23 feb*/

        str = str + "<td align=\"center\" id=\"tdlogoname\" style=\"display:none;\" valign=\"top\">Logo Name</td>";
        str = str + "<td valign=\"top\" id=\"tdlogoh\" style=\"display:none;\" align=\"center\">Logo H</td>";
        str = str + "<td valign=\"top\" id=\"tdlogow\" style=\"display:none;\" align=\"center\">Logo W</td>";
        str = str + "<td valign=\"top\" id=\"tdlogoup\" style=\"display:none;\" align=\"center\">Logo Upload</td>";
        ///////////////add by anuja eyecather

        //str = str + "<td valign=\"top\" id=\"tdeyecather\" style=\" align=\"center\">Eyecather</td>";


        str = str + "</tr>";

        //str="<table id=\"gridtab\" width=\"550px\" border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\"><td align=\"center\" width=\"115px\">Edition</td><td align=\"center\">Date</td><td align=\"center\">Color</td><td align=\"center\">Height</td><td align=\"center\">Width</td><td align=\"center\">Size</td><td align=\"center\">Premium</td><td align=\"center\">Premium(%)</td><td align=\"center\">Ad Sub Cat.</td><td align=\"center\">Latest By</td><td align=\"center\">Repeating</td><td>Status Material</td><td align=\"center\">File Name</td><td align=\"center\">Card Rate</td><td align=\"center\">Disc. Rate</td></tr>";
        document.getElementById('hiddenrowcount').value = ds.Tables[0].Rows.length;
        countGridElement = ds.Tables[0].Rows.length;
        var insC = document.getElementById('txtinsertion').value;
        if (insC == "") {
            insC = "1";
        }
        retrows = parseInt(ds.Tables[0].Rows.length) / parseInt(insC);
        //   for ( i = 0; i < ds.Tables[0].Rows.length; i++)
        //   {

        //   
        //   var id="Text" + i;
        //    str=str + "<tr ><td class=\"dtGrid\">"+ds.Tables[0].Rows[i].Edition_Name+"</td><td><input class=\"btextforbook\" type=\"text\" id="+id+" value="+ds.Tables[0].Rows[i].Date+"></td><td><select id=\"Select1\" class=\"dropdownforbook\"><option></option></select></td><td><input class=\"btextforbook\" type=\"text\" id="+id+" value=\"\"></td><td><select id=\"Select1\" class=\"dropdownforbook\"><option></option></select></td><td><select id=\"Select1\" class=\"dropdownforbook\"><option></option></select></td><td><input class=\"btextforbook\" type=\"text\" id="+id+" value=\"\"></td><td><select id=\"Select1\" class=\"dropdownforbook\"><option></option></select></td><td><input class=\"btextforbook\" type=\"text\" id="+id+" value=\"\"></td><td><input class=\"btextforbook\" type=\"text\" id="+id+" value=\"\"></td><td><input class=\"btextforbook\" type=\"text\" id="+id+" value=\"\"></td><td><input class=\"btextforbook\" type=\"text\" id="+id+" value=\"\"></td></tr>";
        //    
        //   }
        insertval = 1;
        colid = "col" + i;
        var arrC = new Array();
        var inew = 0;
        var insprev = 0;
        var date = new Array();
        var size = new Array();
        var height = new Array();
        var width = new Array();





        if (browser != "Microsoft Internet Explorer") {
            var len = "bookdiv";
            if (document.getElementById(len) != null) {
                var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
                var k;
                for (k = 0; k < y - 1; k++) {
                    date[k] = document.getElementById("Text" + k).value;
                    size[k] = document.getElementById("siz" + k).value;
                    height[k] = document.getElementById("hei" + k).value;
                    width[k] = document.getElementById("wid" + k).value;
                }
            }

        }
        for (inew = 0; inew < ds.Tables[0].Rows.length; inew++) {

            var dCheck = true;
            var dCheck = checkValidEdition(ds.Tables[0].Rows[inew].Edition_Name);
            if (dCheck == false)
                countGridElement = parseInt(countGridElement, 10) - 1;
            if (dCheck == true) {
                /*new change ankur 23 feb*/
                logoH = "lh" + i;
                logoW = "lw" + i;
                ////////////////
                uomid = "uom" + i;
                var id = "Text" + i;
                editid = "edit" + i;

                inserts = "ins" + i;
                colid = "col" + i;
                agrred = "agr" + i;
                noofcol = "nocol" + i;

                str = str + "<tr >";

                if (i % noofinsert == 0 || i % totval == 0) {
                    if (i == 0) {
                        insertval = i + 1;
                    }
                    else {
                        insertval = parseInt(insertval) + 1;
                    }
                    insertval = parseInt(ds.Tables[0].Rows[inew].IDNUM) + 1;
                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[1].childNodes[0].nodeValue == "enable") {
                            if (insprev != insertval) {
                                insprev = insertval;
                                str = str + "<td align=\"center\" id=" + inserts + " title='Edit Insert' class=\"TextField\" >" + insertval + "</td>";
                            }
                            else {
                                str = str + "<td align=\"center\" id=" + inserts + " class=\"TextField\" >" + insertval + "</td>";
                            }
                            //str=str+"<td align=\"center\" id="+inserts+" class=\"TextField\" >"+insertval+"</td>";
                        }
                        else {
                            str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">No.</td>";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(0).text == "enable") {
                            if (insprev != insertval) {
                                insprev = insertval;
                                str = str + "<td align=\"center\" id=" + inserts + " title='Edit Insert' class=\"TextField\" >" + insertval + "</td>";
                            }
                            else {
                                str = str + "<td align=\"center\" id=" + inserts + " class=\"TextField\" >" + insertval + "</td>";
                            }
                        }
                        else {
                            str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">No.</td>";
                        }
                    }

                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[3].childNodes[0].nodeValue == "enable") {
                            str = str + "<td class=\"dtGrid\" ><input class=\"btextforgridedition\" type=\"text\" disabled id=" + editid + " value='" + ds.Tables[0].Rows[inew].Edition_Name + "'></td>";
                        }
                        else {
                            str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Edition</td>";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(1).text == "enable") {
                            str = str + "<td class=\"dtGrid\" ><input class=\"btextforgridedition\" type=\"text\" disabled id=" + editid + " value='" + ds.Tables[0].Rows[inew].Edition_Name + "'></td>";
                        }
                        else {
                            str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Edition</td>";
                        }
                    }
                }
                else {
                    insertval = parseInt(ds.Tables[0].Rows[inew].IDNUM) + 1;
                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[1].childNodes[0].nodeValue == "enable") {
                            str = str + "<td align=\"center\" id=" + inserts + " class=\"TextField\" >" + insertval + "</td>";
                        }
                        else {
                            str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">No.</td>";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(0).text == "enable") {
                            str = str + "<td align=\"center\" id=" + inserts + " class=\"TextField\" >" + insertval + "</td>";
                        }
                        else {
                            str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">No.</td>";
                        }
                    }

                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[3].childNodes[0].nodeValue == "enable") {
                            str = str + "<td class=\"dtGrid\" ><input class=\"btextforgridedition\" type=\"text\" disabled id=" + editid + " value='" + ds.Tables[0].Rows[inew].Edition_Name + "'></td>";
                        }
                        else {
                            str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Edition</td>";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(1).text == "enable") {
                            str = str + "<td class=\"dtGrid\" ><input class=\"btextforgridedition\" type=\"text\" disabled id=" + editid + " value='" + ds.Tables[0].Rows[inew].Edition_Name + "'></td>";
                        }
                        else {
                            str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Edition</td>";
                        }
                    }

                }
                var insdate = ds.Tables[0].Rows[inew].Date;
                if (insdate == null)
                    insdate = "";

                /*this is to chk the valid date in case of repeating date*/

                if (insdate != "" && insdate != null && document.getElementById('txtrepeatingdate').value != "" && document.getElementById('txtrepeatingdate').value != null) {
                    document.getElementById('btnshdl').disabled = false;
                    var localCount = parseInt(ds.Tables[0].Rows.length) / parseInt(document.getElementById('txtinsertion').value);
                    var dateformat = document.getElementById('hiddendateformat').value;
                    if (i >= localCount) {
                        var l = i - localCount;
                        var lT = "Text" + l;
                        var lText = arrC[l];
                        var lTextC;
                        var insdateC;
                        if (lText != "") {
                            if (dateformat == "dd/mm/yyyy") {
                                var txt1 = lText;
                                var txt2 = txt1.split("/");
                                var dd = txt2[0];
                                if (dd.toString().length == 1)
                                    dd = "0" + dd;
                                var mm = txt2[1];
                                if (mm.toString().length == 1)
                                    mm = "0" + mm;
                                var yy = txt2[2];
                                //selecdate=mm+'/'+dd+'/'+yy;
                                lTextC = mm + '/' + dd + '/' + yy;
                            }
                            else if (dateformat == "yyyy/mm/dd") {
                                var txt1 = lText;
                                var txt2 = txt1.split("/");
                                var dd = txt2[2];
                                if (dd.toString().length == 1)
                                    dd = "0" + dd;
                                var mm = txt2[1];
                                if (mm.toString().length == 1)
                                    mm = "0" + mm;
                                var yy = txt2[0];
                                //selecdate=mm+'/'+dd+'/'+yy;
                                lTextC = mm + '/' + dd + '/' + yy;
                            }
                            else {
                                lTextC = lText;
                            }
                            if (dateformat == "dd/mm/yyyy") {
                                var txt1 = insdate;
                                var txt2 = txt1.split("/");
                                var dd = txt2[0];
                                if (dd.toString().length == 1)
                                    dd = "0" + dd;
                                var mm = txt2[1];
                                if (mm.toString().length == 1)
                                    mm = "0" + mm;
                                var yy = txt2[2];
                                //selecdate=mm+'/'+dd+'/'+yy;
                                insdateC = mm + '/' + dd + '/' + yy;
                            }
                            else if (dateformat == "yyyy/mm/dd") {
                                var txt1 = insdate;
                                var txt2 = txt1.split("/");
                                var dd = txt2[2];
                                if (dd.toString().length == 1)
                                    dd = "0" + dd;
                                var mm = txt2[1];
                                if (mm.toString().length == 1)
                                    mm = "0" + mm;
                                var yy = txt2[0];
                                //selecdate=mm+'/'+dd+'/'+yy;
                                insdateC = mm + '/' + dd + '/' + yy;
                            }
                            else {
                                insdateC = insdate;
                            }
                            var tdate = new Date(lTextC);
                            var cdate = new Date(insdateC);
                            var y = tdate.getYear();
                            var m = tdate.getMonth() + 1;
                            var d = tdate.getDate() + parseInt(document.getElementById('txtrepeatingdate').value);
                            tdate = m + "/" + d + "/" + y;
                            var tdate1 = new Date(tdate);
                            if (tdate1 > cdate && document.getElementById('txtrepeatingdate').value != "0") {
                                var y = tdate1.getYear();
                                var m = tdate1.getMonth() + 1;
                                if (m.toString().length == 1)
                                    m = "0" + m;
                                var d = tdate1.getDate();
                                if (d.toString().length == 1)
                                    d = "0" + d;
                                if (dateformat == "dd/mm/yyyy") {
                                    insdate = d + "/" + m + "/" + y;
                                }
                                else if (dateformat == "mm/dd/yyyy") {
                                    insdate = m + "/" + d + "/" + y;
                                }
                                else if (dateformat == "yyyy/mm/dd") {
                                    insdate = y + "/" + m + "/" + d;
                                }
                            }
                        }
                    }
                    var val_ue = "1";
                    var pkg_id = "0";

                    pkg_id = ds.Tables[0].Rows[inew].EDITION_CODE;
                    var pkgalias = ds.Tables[0].Rows[inew].PKGNAME;
                    var pkgname = ds.Tables[0].Rows[inew].Edition_Name;
                    pkgname = pkgname.replace("+", "^");
                    if (browser != "Microsoft Internet Explorer") {
                        var httpRequest = null; ;
                        httpRequest = new XMLHttpRequest();
                        if (httpRequest.overrideMimeType) {
                            httpRequest.overrideMimeType('text/xml');
                        }

                        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };
                        var adcat = document.getElementById('drpadcategory').value;

                        httpRequest.open("GET", "packagename.aspx?pkgalias=" + pkgalias + "&adcat=" + adcat + "&pkgid=" + pkg_id + "&compcode=" + document.getElementById('hiddencompcode').value + "&value=" + val_ue + "&dateday=" + insdate + "&pkgname=" + ds.Tables[0].Rows[inew].Edition_Name, false);
                        httpRequest.send('');
                        //alert(httpRequest.readyState);
                        if (httpRequest.readyState == 4) {
                            //alert(httpRequest.status);
                            if (httpRequest.status == 200) {
                                strtext = httpRequest.responseText;
                            }
                            else {
                                alert('There was a problem with the request.');
                            }
                        }
                    }
                    else {
                        validuse = "";
                        var xml = new ActiveXObject("Microsoft.XMLHTTP");
                        var adcat = document.getElementById('drpadcategory').value;
                        xml.Open("GET", "packagename.aspx?pkgalias=" + pkgalias + "&adcat=" + adcat + "&pkgid=" + pkg_id + "&compcode=" + document.getElementById('hiddencompcode').value + "&value=" + val_ue + "&dateday=" + insdate + "&pkgname=" + ds.Tables[0].Rows[inew].Edition_Name, false);
                        xml.Send();
                        strtext = xml.responseText;
                    }
                    if (strtext == "NOT A VALID DATE") {
                        alert("NOT A VALID DATE");
                        document.getElementById('txtdummydate').value = "";
                        return false;
                    }
                    if (strtext == "0") {
                        alert("Day is not the publishing day");
                        if (document.getElementById("Text0") != null) {
                            if (document.getElementById("Text0").value == "") {
                                document.getElementById('txtdummydate').value = "";
                            }
                        }
                        dummydate = "";
                        //break;
                        return false;
                    }
                    else {
                        if (strtext != "" && strtext != "1" && strtext != "0" && strtext != null) {
                            insdate = strtext;
                        }
                    }

                }

                /* if(document.getElementById(id)!=null)
                {
                if(document.getElementById(id).value!="")
                {
                insdate=document.getElementById(id).value;
                }
                
                if(browser!="Microsoft Internet Explorer")
                {
                if(xmlObj.childNodes[23].childNodes[5].childNodes[0].nodeValue=="enable")
                {
                str=str + "<td><input class=\"btextforgrid\" type=\"text\" id="+id+"  value="+insdate+" ><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1."+id+", Form1."+id+", "+dat+");\" height=\"14\" width=\"14\" /></td>";
                }
                else
                {
                str+="<td align=\"center\" valign=\"top\" style=\"display:none;\">Date</td>";
                }     
                }
                else
                {
                if(xmlObj.childNodes(11).childNodes(2).text=="enable")
                {
                str=str + "<td><input class=\"btextforgrid\" type=\"text\" id="+id+"  value="+insdate+" ><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1."+id+", Form1."+id+", "+dat+");\" height=\"14\" width=\"14\" /></td>";
                }
                else
                {
                str+="<td align=\"center\" valign=\"top\" style=\"display:none;\">Date</td>";
                } 
                }
                }
                else
                {
                */
                //new change---1 july 2009
                var lenL = "tblinsert";
                if (document.getElementById('tblinsert').getElementsByTagName('table').length > 0) {
                    var yL = document.getElementById(lenL).getElementsByTagName('table')[0].rows.length;
                    for (var c = 0; c < yL - 1; c++) {
                        if (document.getElementById(inserts) != null) {
                            if (browser != "Microsoft Internet Explorer") {
                                if (insertval == document.getElementById("ins" + c).textContent) {
                                    if (document.getElementById("edit" + c) != null) {
                                        if (ds.Tables[0].Rows[inew].Edition_Name == document.getElementById("edit" + c).value) {
                                            if (document.getElementById("Text" + c) != null) {
                                                document.getElementById("Text" + c).value = insdate;
                                                insdate = document.getElementById("Text" + c).value;

                                            }
                                            c = lenL;
                                        }
                                        else {
                                            document.getElementById("Text" + c).value = insdate;
                                            insdate = document.getElementById("Text" + c).value;

                                        }
                                    }
                                }
                            }
                            else {
                                if (insertval == document.getElementById("ins" + c).innerText) {
                                    if (document.getElementById("edit" + c) != null) {
                                        if (ds.Tables[0].Rows[inew].Edition_Name == document.getElementById("edit" + c).value) {
                                            if (document.getElementById("Text" + c) != null) {
                                                document.getElementById("Text" + c).value = insdate;
                                                insdate = document.getElementById("Text" + c).value;

                                            }
                                            c = lenL;
                                        }
                                        else {
                                            document.getElementById("Text" + c).value = insdate;
                                            insdate = document.getElementById("Text" + c).value;

                                        }
                                    }
                                }
                            }

                        }
                    }
                }
                if (ds.Tables[0].Rows[inew].Date == null) {
                    ds.Tables[0].Rows[inew].Date = "";
                }

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[5].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgriddate\" type=\"text\" id=" + id + "  value='" + ds.Tables[0].Rows[inew].Date + "' ></td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Date</td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(2).text == "enable") {
                        str = str + "<td><input class=\"btextforgriddate\" type=\"text\" id=" + id + "  value='" + ds.Tables[0].Rows[inew].Date + "'></td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Date</td>";
                    }
                }


                // }
                arrC[i] = insdate;

                ////this is to bind the Ad sub cat drop down

                adsubcat = "ads" + i;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[7].childNodes[0].nodeValue == "enable") {
                        if (document.getElementById('drpadsubcategory').value != '0') {
                            if (i == 0) {
                                str = str + "<td><input class=\"btextforgrid\" type=\"text\"  id=" + adsubcat + " value=" + adsubcatM + "><div id='agdiv' Width=100px Height=50px style='position:absolute;display: none;'><select name='aglist' onClick=\"FillSubCatinGrid();\"  id='aglist' CssClass='btextlist' size=4 Width=100px Height=50px></select></div></td>";
                            }
                            else {
                                str = str + "<td><input class=\"btextforgrid\" type=\"text\"  id=" + adsubcat + " value=" + adsubcatM + "></td>";
                            }
                        }
                        else {
                            if (i == 0) {
                                str = str + "<td><input class=\"btextforgrid\" type=\"text\"  id=" + adsubcat + " value=''><div id='agdiv' style='position:absolute;display: none;' Width=100px Height=50px><select name='aglist' id='aglist' onClick=\"FillSubCatinGrid();\"  class='btextlist' size=4 Width=100px Height=50px></select></div></td>";
                            }
                            else {
                                str = str + "<td><input class=\"btextforgrid\" type=\"text\"  id=" + adsubcat + " value=''></td>";
                            }
                        }
                        //                    str=str+"<td>";
                        //                    str=str+"<select id="+adsubcat+" class=\"dropdownforgridqbc\" onchange=\"getvalueintoinserts("+adsubcat+","+inserts+","+insertval+");\">";
                        //                    // this is to bind adv sub cat drop down
                        //                    str=str+"<option value=\"0\" selected=\"true\">-select-</option>";
                        //                    for(l=0;l<=ds.Tables[3].Rows.length-1;l++)
                        //                    {
                        //                        if(ds.Tables[3].Rows[l].Adv_Subcat_Code==document.getElementById('drpadsubcategory').value && document.getElementById('drpadsubcategory').value!="0")
                        //                        {
                        //                            str=str+"<option value="+ds.Tables[3].Rows[l].Adv_Subcat_Code+" selected="+document.getElementById('drpadsubcategory').value+">"+ds.Tables[3].Rows[l].Adv_Subcat_Code+"</option>";
                        //                        }
                        //                        else
                        //                        {
                        //                            str=str+"<option value="+ds.Tables[3].Rows[l].Adv_Subcat_Code+">"+ds.Tables[3].Rows[l].Adv_Subcat_Code+"</option>";
                        //                        }
                        //                    }

                        //                    str=str+"</select></td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(3).text == "enable") {
                        if (document.getElementById('drpadsubcategory').value != '0') {
                            if (i == 0) {
                                str = str + "<td><input class=\"btextforgrid\" type=\"text\"  id=" + adsubcat + " value=" + adsubcatM + "><div id='agdiv' Width=100px Height=50px style='position:absolute;display: none;'><select name='aglist' onClick=\"FillSubCatinGrid();\"   id='aglist' CssClass='btextlist' size=4 Width=100px Height=50px></select></div></td>";
                            }
                            else {
                                str = str + "<td><input class=\"btextforgrid\" type=\"text\"  id=" + adsubcat + " value=" + adsubcatM + "></td>";
                            }
                        }
                        else {
                            if (i == 0) {
                                str = str + "<td><input class=\"btextforgrid\" type=\"text\"  id=" + adsubcat + " value=''><div id='agdiv' style='position:absolute;display: none;' Width=100px Height=50px><select name='aglist' onClick=\"FillSubCatinGrid();\" id='aglist'  class='btextlist' size=4 Width=100px Height=50px></select></div></td>";
                            }
                            else {
                                str = str + "<td><input class=\"btextforgrid\" type=\"text\"  id=" + adsubcat + " value=''></td>";
                            }
                        }
                        //                    str=str+"<td>";
                        //                    str=str+"<select id="+adsubcat+" class=\"dropdownforgridqbc\" onchange=\"getvalueintoinserts("+adsubcat+","+inserts+","+insertval+");\">";
                        //                    // this is to bind adv sub cat drop down
                        //                    str=str+"<option value=\"0\" selected=\"true\">-select-</option>";
                        //                    for(l=0;l<=ds.Tables[3].Rows.length-1;l++)
                        //                    {
                        //                        if(ds.Tables[3].Rows[l].Adv_Subcat_Code==document.getElementById('drpadsubcategory').value && document.getElementById('drpadsubcategory').value!="0")
                        //                        {
                        //                            str=str+"<option value="+ds.Tables[3].Rows[l].Adv_Subcat_Code+" selected="+document.getElementById('drpadsubcategory').value+">"+ds.Tables[3].Rows[l].Adv_Subcat_Code+"</option>";
                        //                        }
                        //                        else
                        //                        {
                        //                            str=str+"<option value="+ds.Tables[3].Rows[l].Adv_Subcat_Code+">"+ds.Tables[3].Rows[l].Adv_Subcat_Code+"</option>";
                        //                        }
                        //                    }

                        //                    str=str+"</select></td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                    }
                }

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[9].childNodes[0].nodeValue == "enable") {
                        if (document.getElementById('drpcolor').value != '0') {
                            str += "<td><input class=\"btextsmallsize\" type=\"text\" disabled  id=" + colid + " value=" + colM + "></td>";
                        }
                        else {
                            str += "<td><input class=\"btextsmallsize\" type=\"text\" disabled  id=" + colid + " value=''></td>";
                        }
                        //                    str=str+"<td><select id="+colid+" class=\"dropdownforgridqbc\" onchange=\"getvalueintoinsertsforcolor("+colid+","+inserts+","+insertval+");\">";

                        //                    //this is to bind the color drop down
                        //                    str=str + "<option value=\"0\" selected=\"true\">-select-</option>";
                        //                    for(j=0;j<=ds.Tables[1].Rows.length-1;j++)
                        //                    {        
                        //                        if(ds.Tables[1].Rows[j].col_Code==document.getElementById('drpcolor').value && document.getElementById('drpcolor').value!="0")
                        //                        {
                        //                            str=str + "<option value="+ds.Tables[1].Rows[j].col_Code+" selected="+document.getElementById('drpcolor').value+">"+ds.Tables[1].Rows[j].col_Code+"</option>";    
                        //                        }
                        //                        else
                        //                        {
                        //                            str=str + "<option value="+ds.Tables[1].Rows[j].col_Code+">"+ds.Tables[1].Rows[j].col_Code+"</option>";    
                        //                        }
                        //                    }
                        //                    
                        //                    str=str+"</select></td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Color</td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(4).text == "enable") {
                        if (document.getElementById('drpcolor').value != '0') {
                            str += "<td><input class=\"btextsmallsize\" type=\"text\" disabled  id=" + colid + " value=" + colM + "></td>";
                        }
                        else {
                            str += "<td><input class=\"btextsmallsize\" type=\"text\" disabled  id=" + colid + " value=''></td>";
                        }
                        //                    str=str+"<td><select id="+colid+" class=\"dropdownforgridqbc\" onchange=\"getvalueintoinsertsforcolor("+colid+","+inserts+","+insertval+");\">";

                        //                    //this is to bind the color drop down
                        //                    str=str + "<option value=\"0\" selected=\"true\">-select-</option>";
                        //                    for(j=0;j<=ds.Tables[1].Rows.length-1;j++)
                        //                    {        
                        //                        if(ds.Tables[1].Rows[j].col_Code==document.getElementById('drpcolor').value && document.getElementById('drpcolor').value!="0")
                        //                        {
                        //                            str=str + "<option value="+ds.Tables[1].Rows[j].col_Code+" selected="+document.getElementById('drpcolor').value+">"+ds.Tables[1].Rows[j].col_Code+"</option>";    
                        //                        }
                        //                        else
                        //                        {
                        //                            str=str + "<option value="+ds.Tables[1].Rows[j].col_Code+">"+ds.Tables[1].Rows[j].col_Code+"</option>";    
                        //                        }
                        //                    }
                        //                    
                        //                    str=str+"</select></td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Color</td>";
                    }
                }



                premid = "prem" + i;
                prem1id = "premone" + i;
                height = "hei" + i;
                width = "wid" + i;
                size = "siz" + i;
                pagepost = "pagpos" + i;
                //////// on change function is there to calculate the size 
                //str=str+"</select></td><td><input class=\"btextforbook\" id="+height+" type=\"text\"  value=\"\"></td><td><input class=\"btextforbook\" id="+width+" onchange=\"return gettotalsize("+height+","+width+","+i+");\" type=\"text\"  value=\"\"></td><td><input class=\"btextforbook\" disabled id="+size+" type=\"text\"  value=\"\"></td><td><select id="+premid+" class=\"dropdownforbook\" onchange=\"return getpercenprem("+premid+","+i+");\"  >";
                //str=str+"</select></td><td><input class=\"btextsmallsize\" id="+height+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+");\" onkeypress=\"javascript:return rateenter();\" type=\"text\"  value="+document.getElementById('txtadsize1').value+"></td><td><input class=\"btextsmallsize\" id="+width+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+");\" onkeypress=\"javascript:return rateenter();\" type=\"text\"  value="+document.getElementById('txtadsize2').value+"></td><td><input class=\"btextsmallsize\" disabled id="+size+" type=\"text\"  value="+document.getElementById('txttotalarea').value+"></td>";

                if (uomDesc != "CD" && uomM != "0") {
                    //Height Width Columns
                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[11].childNodes[0].nodeValue == "enable") {
                            str = str + "<td><input class=\" btextsmallsizeH\" style=\"background-color: Gray;\" readonly=true id=" + height + "  type=\"text\"  ></td>";
                            str = str + "<td><input class=\"btextsmallsizeH\" style=\"background-color: Gray;\" readonly=true id=" + width + "  type=\"text\"  ></td>";
                            str = str + "<td><input class=\"btextsmallsizeH\" readonly=true id=" + noofcol + "  type=\"text\"  ></td>";
                        }
                        else {
                            str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Height</td>";
                            str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Width</td>";
                            str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Col.</td>";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(5).text == "enable") {
                            str = str + "<td><input class=\" btextsmallsizeH\" style=\"background-color: Gray;\" readonly=true id=" + height + "  type=\"text\"  ></td>";
                            str = str + "<td><input class=\"btextsmallsizeH\" style=\"background-color: Gray;\" readonly=true id=" + width + "  type=\"text\"  ></td>";
                            str = str + "<td><input class=\"btextsmallsizeH\" readonly=true id=" + noofcol + "  type=\"text\"  ></td>";
                        }
                        else {
                            str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Height</td>";
                            str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Width</td>";
                            str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Col.</td>";
                        }
                    }
                }
                else {
                    if (document.getElementById('txtcolum').disabled == true) {
                        if (browser != "Microsoft Internet Explorer") {
                            if (xmlObj.childNodes[23].childNodes[11].childNodes[0].nodeValue == "enable") {
                                str = str + "<td><input class=\"btextsmallsizeH\" style=\" background-color: White;\" id=" + height + " type=\"text\"  ></td><td><input class=\"btextsmallsizeH\" id=" + width + " style=\"background-color:White;\" type=\"text\"  ></td><td><input class=\"btextsmallsizeH\" readonly=true id=" + noofcol + "  type=\"text\"  ></td>";
                            }
                            else {
                                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Height</td>";
                                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Width</td>";
                                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Col.</td>";
                            }
                        }
                        else {
                            if (xmlObj.childNodes(11).childNodes(5).text == "enable") {
                                str = str + "<td><input class=\"btextsmallsizeH\" style=\" background-color: White;\" id=" + height + "  type=\"text\"  ></td><td><input class=\"btextsmallsizeH\" id=" + width + " style=\"background-color:White;\" type=\"text\" ></td><td><input class=\"btextsmallsizeH\" readonly=true id=" + noofcol + "  type=\"text\"  ></td>";
                            }
                            else {
                                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Height</td>";
                                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Width</td>";
                                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Col.</td>";
                            }
                        }
                    }
                    else {
                        if (browser != "Microsoft Internet Explorer") {
                            if (xmlObj.childNodes[23].childNodes[11].childNodes[0].nodeValue == "enable") {
                                str = str + "<td><input class=\"btextsmallsizeH\" style=\" background-color: White;\" id=" + height + "  type=\"text\"  ></td><td><input class=\"btextsmallsizeH\" readonly=true id=" + width + " style=\"background-color:White;\"  type=\"text\"  ></td><td><input class=\"btextsmallsizeH\"  id=" + noofcol + "  type=\"text\"  ></td>";
                            }
                            else {
                                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Height</td>";
                                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Width</td>";
                                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Col.</td>";
                            }
                        }
                        else {
                            if (xmlObj.childNodes(11).childNodes(5).text == "enable") {
                                str = str + "<td><input class=\"btextsmallsizeH\" style=\" background-color: White;\" id=" + height + "  type=\"text\"  ></td><td><input class=\"btextsmallsizeH\" readonly=true id=" + width + " style=\"background-color:White;\"  type=\"text\" ></td><td><input class=\"btextsmallsizeH\"  id=" + noofcol + "  type=\"text\"  ></td>";
                            }
                            else {
                                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Height</td>";
                                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Width</td>";
                                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Col.</td>";
                            }
                        }
                    }
                }
                pagstr = "fir"
                insertsta = "inssta" + i;

                ////////this is to bind the status of insertion drop down  agrred
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[13].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\"  type=\"text\" id=" + insertsta + "  value='booked'></td>";
                        //                    str=str+"<td><select id="+insertsta+" class=\"dropdownforgrid\" onchange=\"javascript:return chkpublishdate('"+insertsta+"','"+id+"');\">";
                        //                    var b=0;    
                        //                    //setTimeout("Func1()", 3000);
                        //                    //alert(xmlObj);
                        //                    for(b=1;b<=xmlObj.childNodes[19].childNodes.length-2;)
                        //                    {
                        //                         
                        //                        if(xmlObj.childNodes[19].childNodes[b].childNodes[0].nodeValue=="Booked" || xmlObj.childNodes[19].childNodes[b].childNodes[0].nodeValue=="booked")
                        //                        {
                        //                            str=str+"<option value="+xmlObj.childNodes[19].childNodes[b+2].childNodes[0].nodeValue+" selected=\"true\">"+xmlObj.childNodes[19].childNodes[b].childNodes[0].nodeValue+"</option>";
                        //                        }
                        //                        else
                        //                        {
                        //                            str=str+"<option value="+xmlObj.childNodes[19].childNodes[b+2].childNodes[0].nodeValue+">"+xmlObj.childNodes[19].childNodes[b].childNodes[0].nodeValue+"</option>";                                
                        //                        }                                    
                        //                        b=b+4;
                        //                    }
                        //                    
                        //                    str=str+"</select></td>"; 
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(6).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\"  type=\"text\" id=" + insertsta + "  value='booked'></td>";
                        //                    str=str+"<td><select id="+insertsta+" class=\"dropdownforgrid\" onchange=\"javascript:return chkpublishdate('"+insertsta+"','"+id+"');\">";
                        //                    
                        //                    var b=0;
                        //                    if(str.indexOf("</table></div>")>=0)
                        //                    {
                        //                        return false;
                        //                    }
                        //                    for(b=0;b<=xmlObj.childNodes(9).childNodes.length-1;b++)
                        //                    {
                        //                        if(xmlObj.childNodes(9).childNodes(b+1).text=="Booked" || xmlObj.childNodes(9).childNodes(b+1).text=="booked")
                        //                        {
                        //                            str=str+"<option value="+xmlObj.childNodes(9).childNodes(b+1).text+" selected=\"true\">"+xmlObj.childNodes(9).childNodes(b).text+"</option>";
                        //                        }
                        //                        else
                        //                        {
                        //                            str=str+"<option value="+xmlObj.childNodes(9).childNodes(b+1).text+">"+xmlObj.childNodes(9).childNodes(b).text+"</option>";
                        //                        }
                        //                        b=b+1;
                        //                    } 
                        //                    str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }



                /////////////this is to bind the status material drop down
                matsta = "mat" + i;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[15].childNodes[0].nodeValue == "enable") {
                        if (document.getElementById('drpmatstat').value != "0") {
                            str = str + "<td><input class=\"btextforgrid\"  id=" + matsta + " type=\"text\"  value=" + matstaM + "></td>";
                        }
                        else {
                            str = str + "<td><input class=\"btextforgrid\"  id=" + matsta + " type=\"text\"></td>";
                        }
                        //                    str=str+"<td><select id="+matsta+" class=\"dropdownforgrid\">";
                        //                    /////this is to bind the status material dropdown

                        //                    if(document.getElementById('drpmatstat').value="0")
                        //                    {
                        //                        str=str+"<option value=\"0\" selected="+document.getElementById('drpmatstat').value+">Select</option>";
                        //                    }
                        //                    else
                        //                    {
                        //                        str=str+"<option value=\"0\">Select</option>";
                        //                    }
                        //                    if(document.getElementById('drpmatstat').value="hardcopy")
                        //                    {
                        //                        str=str+"<option value=\"hardcopy\" selected="+document.getElementById('drpmatstat').value+">Hard Copy</option>";
                        //                    }
                        //                    else
                        //                    {
                        //                        str=str+"<option value=\"hardcopy\">Hard Copy</option>";
                        //                    }
                        //                    if(document.getElementById('drpmatstat').value="softcopy")
                        //                    {
                        //                        str=str+"<option value=\"softcopy\" selected="+document.getElementById('drpmatstat').value+">Soft Copy</option>";
                        //                    }
                        //                    else
                        //                    {
                        //                        str=str+"<option value=\"softcopy\">Soft Copy</option>";
                        //                    }
                        //                    if(document.getElementById('drpmatstat').value="cd")
                        //                    {
                        //                        str=str+"<option value=\"cd\" selected="+document.getElementById('drpmatstat').value+">CD</option>";
                        //                    }
                        //                    else
                        //                    {
                        //                        str=str+"<option value=\"cd\">CD</option>";
                        //                    }
                        //                    if(document.getElementById('drpmatstat').value="other")
                        //                    { 
                        //                        str=str+"<option value=\"other\" selected="+document.getElementById('drpmatstat').value+">Others</option>";
                        //                    }
                        //                    else
                        //                    {
                        //                        str=str+"<option value=\"other\">Others</option>";
                        //                    }
                        //                    
                        //                    str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(7).text == "enable") {
                        if (document.getElementById('drpmatstat').value != "0") {
                            str = str + "<td><input class=\"btextforgrid\"  id=" + matsta + " type=\"text\"  value=" + matstaM + "></td>";
                        }
                        else {
                            str = str + "<td><input class=\"btextforgrid\"  id=" + matsta + " type=\"text\"></td>";
                        }
                        //                    str=str+"<td><select id="+matsta+" class=\"dropdownforgrid\">";
                        //                    /////this is to bind the status material dropdown

                        //                    if(document.getElementById('drpmatstat').value="0")
                        //                    {
                        //                        str=str+"<option value=\"0\" selected="+document.getElementById('drpmatstat').value+">Select</option>";
                        //                    }
                        //                    else
                        //                    {
                        //                        str=str+"<option value=\"0\">Select</option>";
                        //                    }
                        //                    if(document.getElementById('drpmatstat').value="hardcopy")
                        //                    {
                        //                        str=str+"<option value=\"hardcopy\" selected="+document.getElementById('drpmatstat').value+">Hard Copy</option>";
                        //                    }
                        //                    else
                        //                    {
                        //                        str=str+"<option value=\"hardcopy\">Hard Copy</option>";
                        //                    }
                        //                    if(document.getElementById('drpmatstat').value="softcopy")
                        //                    {
                        //                        str=str+"<option value=\"softcopy\" selected="+document.getElementById('drpmatstat').value+">Soft Copy</option>";
                        //                    }
                        //                    else
                        //                    {
                        //                        str=str+"<option value=\"softcopy\">Soft Copy</option>";
                        //                    }
                        //                    if(document.getElementById('drpmatstat').value="cd")
                        //                    {
                        //                        str=str+"<option value=\"cd\" selected="+document.getElementById('drpmatstat').value+">CD</option>";
                        //                    }
                        //                    else
                        //                    {
                        //                        str=str+"<option value=\"cd\">CD</option>";
                        //                    }
                        //                    if(document.getElementById('drpmatstat').value="other")
                        //                    { 
                        //                        str=str+"<option value=\"other\" selected="+document.getElementById('drpmatstat').value+">Others</option>";
                        //                    }
                        //                    else
                        //                    {
                        //                        str=str+"<option value=\"other\">Others</option>";
                        //                    }
                        //                    
                        //                    str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }


                cardid = "card" + i;

                //this is the function cretaed to get the solo edition rate break up with referrence  to the package selected 
                /////////////////////////////////////////////////////////////////////////////////////////////////////////////
                //
                /////////////////////////////////////////////////////////////////////////////////////////////////////////////
                /////////////////////////////////////////////////////////////////////////////////////////////////////////////


                filename = "fil" + i;
                //str=str+"</select></td><td><input class=\"btextforgrid\" type=\"text\" id="+filename+" disabled  value="+total+"></td><td>";
                if (document.getElementById(filename) != null) {
                    var f = document.getElementById(filename).value;
                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[17].childNodes[0].nodeValue == "enable") {
                            str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled  value=" + f + "></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(8).text == "enable") {
                            str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled  value=" + f + "></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }

                }
                else {
                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[17].childNodes[0].nodeValue == "enable") {
                            str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled  value=\"\"></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(8).text == "enable") {
                            str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled  value=\"\"></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }
                }

                //// Upload Button
                var upl = "upload" + i;
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[19].childNodes[0].nodeValue == "enable") {
                        str = str + "<td width=\"50px\"><input  class=\"button1\" type=\"button\" Value=\"Attachment\" id=" + upl + " ></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(9).text == "enable") {
                        str = str + "<td width=\"50px\"><input  class=\"button1\" type=\"button\" Value=\"Attachment\" id=" + upl + " ></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                //// split Button

                var splt = "splt" + i;
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[73].childNodes[0].nodeValue == "enable" && document.getElementById('hiddenuomdesc').value == "CD" && ds.Tables[0].Rows[inew].PRIORITY != '1' && ds.Tables[0].Rows[inew].SPLIT == 'Y')//ds.Tables[0].Rows[inew].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                    {
                        str = str + "<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" Value=\"Split\" id=" + splt + "  ></td>"; //onclick=\"return opensplitedition('"+ds.Tables[0].Rows[inew].Edition_Name+"','"+i+"');\"
                    }
                    else {
                        str = str + "<td ></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(36).text == "enable" && document.getElementById('hiddenuomdesc').value == "CD" && ds.Tables[0].Rows[inew].PRIORITY != '1' && ds.Tables[0].Rows[inew].SPLIT == 'Y')// ds.Tables[0].Rows[inew].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                    {
                        str = str + "<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" Value=\"Split\" id=" + splt + " ></td>";
                    }
                    else {
                        str = str + "<td></td>";
                    }
                }
                //// subedition detail Button

                var subedi = "subedi" + i;
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[75].childNodes[0].nodeValue == "enable")//ds.Tables[0].Rows[inew].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                    {
                        str = str + "<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" Value=\"Detail\" id=" + subedi + "  ></td>";
                    }
                    else {
                        str = str + "<td ></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(37).text == "enable")// ds.Tables[0].Rows[inew].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                    {
                        str = str + "<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" Value=\"Detail\" id=" + subedi + "  ></td>";
                    }
                    else {
                        str = str + "<td></td>";
                    }
                }
                ////this loop is to bind the page position

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[21].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input type=\"text\" id=" + pagepost + " class=\"dropdownforgridqbc\" ></td>";
                        //                    str=str+"<td><select id="+pagepost+" class=\"dropdownforgridqbc\" onchange=\"return getpageprem("+pagepost+","+i+",'"+pagstr+"');\">";
                        //                    str=str+"<option value=\"0\" selected=\"true\">-select-</option>";
                        //                    for(p=0;p<=ds.Tables[7].Rows.length-1;p++)
                        //                    {
                        //                        if(ds.Tables[7].Rows[p].pos_type_code==document.getElementById('Hiddendrppageposition').value && document.getElementById('Hiddendrppageposition').value!="0")
                        //                        {
                        //                            str=str+"<option value="+ds.Tables[7].Rows[p].pos_type_code+" selected="+document.getElementById('Hiddendrppageposition').value+">"+ds.Tables[7].Rows[p].pos_type_code+"</option>";
                        //                        }
                        //                        else
                        //                        {
                        //                            str=str+"<option value="+ds.Tables[7].Rows[p].pos_type_code+">"+ds.Tables[7].Rows[p].pos_type_code+"</option>";
                        //                        }
                        //                    }
                        //                    
                        //                    str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(10).text == "enable") {
                        str = str + "<td><input type=\"text\" id=" + pagepost + " class=\"dropdownforgridqbc\" ></td>";
                        //                    str=str+"<td><select id="+pagepost+" class=\"dropdownforgridqbc\" onchange=\"return getpageprem("+pagepost+","+i+",'"+pagstr+"');\">";
                        //                    str=str+"<option value=\"0\" selected=\"true\">-select-</option>";
                        //                    for(p=0;p<=ds.Tables[7].Rows.length-1;p++)
                        //                    {
                        //                        if(ds.Tables[7].Rows[p].pos_type_code==document.getElementById('Hiddendrppageposition').value && document.getElementById('Hiddendrppageposition').value!="0")
                        //                        {
                        //                            str=str+"<option value="+ds.Tables[7].Rows[p].pos_type_code+" selected="+document.getElementById('Hiddendrppageposition').value+">"+ds.Tables[7].Rows[p].pos_type_code+"</option>";
                        //                        }
                        //                        else
                        //                        {
                        //                            str=str+"<option value="+ds.Tables[7].Rows[p].pos_type_code+">"+ds.Tables[7].Rows[p].pos_type_code+"</option>";
                        //                        }
                        //                    }
                        //                    
                        //                    str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }


                ////////////this is to for larest date

                late = "lat" + i;

                repeat = "rep" + i;
                var dat = "mm+" / "+" / "+dd+" / "+yyyy";

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[23].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + late + "  value=\"\" ></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(11).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + late + "  value=\"\" ></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }


                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[25].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + repeat + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(12).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + repeat + "  value=\"\" ></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                namecode = "one";
                //str=str+"<td><select id="+premid+" class=\"dropdownforgrid\" onchange=\"return getpercenprem("+premid+","+i+",'"+namecode+"');\"  >";

                ///this is to bind the premium drop down
                //str=str+"  <option value=\"0\" selected=\"true\">select</option>";
                //for(k=0;k<=ds.Tables[2].Rows.length-1;k++)
                //{
                ////////on click function is there to get the prem % on premium drop down change
                // str=str+"  <option value="+ds.Tables[2].Rows[k].Premiumcode+">"+ds.Tables[2].Rows[k].premiumname+"</option>"
                //}

                premper = "premper" + i;
                premper1 = "premperone" + i;
                adtypid = "adtyp" + i;
                namecode = "two";
                preall = "preall" + i;
                adcat = "adcat" + i;
                page = "pgpre" + i;
                pageprem = "pagper" + i;
                var h;
                //str=str+"</select></td><td><input class=\"btextsmallsize\" type=\"text\" id="+premper+" value=\"\"></td>"
                //str=str+"<td><select id="+prem1id+" class=\"dropdownforgrid\" onchange=\"return getpercenprem("+prem1id+","+i+",'"+namecode+"');\"  >";
                /////this is to bind the premium 2 drop down
                //str=str+"  <option value=\"0\" selected=\"true\">Select</option>";
                //for(k=0;k<=ds.Tables[2].Rows.length-1;k++)
                //  {
                ////////on click function is there to get the prem % on premium drop down change
                //   str=str+"  <option value="+ds.Tables[2].Rows[k].Premiumcode+">"+ds.Tables[2].Rows[k].premiumname+"</option>"
                //  }

                //str=str+"</select></td><td><input class=\"btextsmallsize\" type=\"text\" id="+premper1+" value=\"\"></td>"
                ///this is to bind the page prem 2 drp down
                pagstr = "sec"

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[27].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input type=\"text\" id=" + page + " class=\"dropdownforgridqbc\"></td>";
                        //                    str=str+"<td><select id="+page+" class=\"dropdownforgridqbc\" onchange=\"return getpageprem("+page+","+i+",'"+pagstr+"');\"  >";
                        //                    /////this is to bind the premium 2 drop down
                        //                    str=str+"  <option value=\"0\" selected=\"true\">Select</option>";
                        //                    for(h=0;h<=ds.Tables[7].Rows.length-1;h++)
                        //                    {
                        //                        ////////on click function is there to get the prem % on premium drop down change
                        //                        str=str+"  <option value="+ds.Tables[7].Rows[h].pos_type_code+">"+ds.Tables[7].Rows[h].pos_type_code+"</option>"    
                        //                    }
                        //                    
                        //                    str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(13).text == "enable") {
                        str = str + "<td><input type=\"text\" id=" + page + " class=\"dropdownforgridqbc\" ></td>";
                        //                    str=str+"<td><select id="+page+" class=\"dropdownforgridqbc\" onchange=\"return getpageprem("+page+","+i+",'"+pagstr+"');\"  >";
                        //                    /////this is to bind the premium 2 drop down
                        //                    str=str+"  <option value=\"0\" selected=\"true\">Select</option>";
                        //                    for(h=0;h<=ds.Tables[7].Rows.length-1;h++)
                        //                    {
                        //                        ////////on click function is there to get the prem % on premium drop down change
                        //                        str=str+"  <option value="+ds.Tables[7].Rows[h].pos_type_code+">"+ds.Tables[7].Rows[h].pos_type_code+"</option>"    
                        //                    }
                        //                    
                        //                    str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                ////this is to bind the per for page premium
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[29].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id=" + pageprem + " value=\"\"></td>"
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(14).text == "enable") {
                        str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id=" + pageprem + " value=\"\"></td>"
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                ///////////////////////////////////////////////

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[31].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><select id=" + preall + " class=\"dropdownforgrid\">";
                        //////////////this is to bind the drop down for accepting the premium

                        str = str + "<option value=\"0\">Select</option>";
                        str = str + "<option value=\"1\">Yes</option>";
                        str = str + "<option value=\"2\">No</option>";

                        str = str + "</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(15).text == "enable") {
                        str = str + "<td><select id=" + preall + " class=\"dropdownforgrid\">";
                        //////////////this is to bind the drop down for accepting the premium

                        str = str + "<option value=\"0\">Select</option>";
                        str = str + "<option value=\"1\">Yes</option>";
                        str = str + "<option value=\"2\">No</option>";

                        str = str + "</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[33].childNodes[0].nodeValue == "enable") {
                        if (document.getElementById('drpadcategory').value == "0") {
                            str = str + "<td><input type=\"type=text\" id=" + adcat + " class=\"dropdownforgridqbc\" ></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\" id=" + adcat + " class=\"dropdownforgridqbc\"  value=" + adcatM + " ></td>";
                        }
                        //                    str=str+"<td><select id="+adcat+" class=\"dropdownforgridqbc\" onchange=\"filladsubgrid("+adcat+","+adsubcat+")\">";
                        //                    
                        //                    ///this loop is to bind the ad category
                        //                    str=str+"  <option value=\"0\" selected=\"true\">-select-</option>";
                        //                    for(o=0;o<=ds.Tables[6].Rows.length-1;o++)
                        //                    {
                        //                        if(ds.Tables[6].Rows[o].adv_cat_code==document.getElementById('drpadcategory').value && document.getElementById('drpadcategory').value!="0")
                        //                        {
                        //                            str=str+"<option value="+ds.Tables[6].Rows[o].adv_cat_code+" selected="+document.getElementById('drpadcategory').value+">"+ds.Tables[6].Rows[o].adv_cat_code+"</option>";
                        //                        }
                        //                        else
                        //                        {
                        //                            str=str+"<option value="+ds.Tables[6].Rows[o].adv_cat_code+">"+ds.Tables[6].Rows[o].adv_cat_code+"</option>";
                        //                        }
                        //                    }   

                        //                    str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(16).text == "enable") {
                        if (document.getElementById('drpadcategory').value == "0") {
                            str = str + "<td><input type=\"type=text\" id=" + adcat + " class=\"dropdownforgridqbc\"></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\" id=" + adcat + "  class=\"dropdownforgridqbc\"  value=" + adcatM + "></td>";
                        }
                        //                    str=str+"<td><select id="+adcat+" class=\"dropdownforgridqbc\" onchange=\"filladsubgrid("+adcat+","+adsubcat+")\">";
                        //                    
                        //                    ///this loop is to bind the ad category
                        //                    str=str+"  <option value=\"0\" selected=\"true\">-select-</option>";
                        //                    for(o=0;o<=ds.Tables[6].Rows.length-1;o++)
                        //                    {
                        //                        if(ds.Tables[6].Rows[o].adv_cat_code==document.getElementById('drpadcategory').value && document.getElementById('drpadcategory').value!="0")
                        //                        {
                        //                            str=str+"<option value="+ds.Tables[6].Rows[o].adv_cat_code+" selected="+document.getElementById('drpadcategory').value+">"+ds.Tables[6].Rows[o].adv_cat_code+"</option>";
                        //                        }
                        //                        else
                        //                        {
                        //                            str=str+"<option value="+ds.Tables[6].Rows[o].adv_cat_code+">"+ds.Tables[6].Rows[o].adv_cat_code+"</option>";
                        //                        }
                        //                    }   

                        //                    str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                //str=str+"</td></select><td><select id="+adcat+" class=\"dropdownforgridqbc\" onchange=\"filladsubgrid("+adcat+","+adsubcat+")\">";

                billstat = "bill" + i;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[35].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input type=\"type=text\" id=" + billstat + " class=\"dropdownforgridqbc\"></td>";
                        //                    str=str+"<td><select id="+billstat+" class=\"dropdownforgrid\">";

                        //                    /////////////this function is to bind the bill status dropdown
                        //                    
                        //                    var c=0;
                        //                    for(c=1;c<=xmlObj.childNodes[3].childNodes.length-1;c=c+4)
                        //                    {   
                        //                        str=str+"<option value="+xmlObj.childNodes[3].childNodes[c+2].childNodes[0].nodeValue+">"+xmlObj.childNodes[3].childNodes[c].childNodes[0].nodeValue+"</option>";
                        //                    }
                        //                    str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(17).text == "enable") {
                        str = str + "<td><input type=\"type=text\" id=" + billstat + " class=\"dropdownforgridqbc\"></td>";
                        //                    str=str+"<td><select id="+billstat+" class=\"dropdownforgrid\">";

                        //                    /////////////this function is to bind the bill status dropdown
                        //                    
                        //                    //var xmlDoc = new ActiveXObject("Microsoft.XMLDOM"); 
                        //                    //loadXML('xml/billcycle.xml');

                        //                    var c=0;

                        //                    for(c=0;c<=xmlObj.childNodes(1).childNodes.length-1;c++)
                        //                    {
                        //                        str=str+"<option value="+xmlObj.childNodes(1).childNodes(c+1).text+">"+xmlObj.childNodes(1).childNodes(c).text+"</option>";
                        //                        c=c+1;
                        //                    } 
                        //                    
                        //                    
                        //                    str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }



                paid = "pai" + i;
                solo = "sol" + i;
                gross = "gro" + i;
                ///////////////this is to bind the drop down for paid/free insertion

                //str=str+"</select></td><td><select id="+paid+" class=\"dropdownforgridsmall\" onchange=\"putpaidintoinsert("+paid+","+inserts+","+insertval+");\">";
                if (ds.Tables[9].Rows[0].Paid_permission == "0" || ds.Tables[9].Rows[0].Paid_permission == null) {
                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[37].childNodes[0].nodeValue == "enable") {
                            str = str + "<td><select id=" + paid + " class=\"dropdownforgridsmallP\" >";
                            str = str + "<option value=\"Y\">Yes</option>";
                            str = str + "<option value=\"N\">No</option>";
                            str = str + "<option value=\"P\">Paid</option>";
                            str = str + "</select></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(18).text == "enable") {
                            str = str + "<td><select id=" + paid + " class=\"dropdownforgridsmallP\" >";
                            str = str + "<option value=\"Y\">Yes</option>";
                            str = str + "<option value=\"N\">No</option>";
                            str = str + "<option value=\"P\">Paid</option>";
                            str = str + "</select></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }

                }
                else {
                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[37].childNodes[0].nodeValue == "enable") {
                            str = str + "<td><select id=" + paid + " class=\"dropdownforgridsmallP\">";
                            str = str + "<option value=\"Y\">Yes</option>";
                            str = str + "<option value=\"N\">No</option>";
                            str = str + "<option value=\"P\">Paid</option>";
                            str = str + "</select></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(18).text == "enable") {
                            str = str + "<td><select id=" + paid + " class=\"dropdownforgridsmallP\">";
                            str = str + "<option value=\"Y\">Yes</option>";
                            str = str + "<option value=\"N\">No</option>";
                            str = str + "<option value=\"P\">Paid</option>";
                            str = str + "</select></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }

                }
                //str=str+"<option value=\"0\">Select</option>";



                //this is to upload the image

                picfield = "pic" + i;
                pageno_inserts = "pagno" + i; ;
                remark_inserts = "rem" + i;
                billamt = "ba" + i;
                billrate = "br" + i;

                // Solo Rate

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[39].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + solo + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(19).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + solo + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                // Gross Amount

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[41].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + gross + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(20).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + gross + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                // Page No.

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[43].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforinsertright\"  type=\"text\" id=" + pageno_inserts + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(21).text == "enable") {
                        str = str + "<td><input class=\"btextforinsertright\"   type=\"text\" id=" + pageno_inserts + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                // Remarks Inserts

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[45].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgridedition\"    type=\"text\" id=" + remark_inserts + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(22).text == "enable") {
                        str = str + "<td><input class=\"btextforgridedition\"    type=\"text\" id=" + remark_inserts + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                // Bill Amount

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[47].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforinsertright\"  disabled  type=\"text\" id=" + billamt + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(23).text == "enable") {
                        str = str + "<td><input class=\"btextforinsertright\"  disabled  type=\"text\" id=" + billamt + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                // Bill Rate

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[49].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\"  disabled  type=\"text\" id=" + billrate + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(24).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\"  disabled  type=\"text\" id=" + billrate + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                // Card Rate

                var cs = 0;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[51].childNodes[0].nodeValue == "enable") {
                        str = str + "<td>";
                        if (ds.Tables[8] != null) {


                            for (cs = 0; cs <= ds.Tables[8].Rows.length - 1; cs++) {
                                if (ds.Tables[0].Rows[inew].Edition_Name != undefined) {
                                    if (ds.Tables[0].Rows[inew].Edition_Name == ds.Tables[8].Rows[cs].Edition_Name) {
                                        str = str + "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cardid + " value=" + ds.Tables[8].Rows[cs].weekrate + ">";
                                    }
                                }

                            }

                            ///////////////////////

                            if (ds.Tables[8].Rows.length == "0") {
                                str = str + "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cardid + " value=\"\">";
                            }
                        }
                        str = str + "</td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(25).text == "enable") {
                        str = str + "<td>";
                        if (ds.Tables[8] != null) {


                            for (cs = 0; cs <= ds.Tables[8].Rows.length - 1; cs++) {
                                if (ds.Tables[0].Rows[inew].Edition_Name != undefined) {
                                    if (ds.Tables[0].Rows[inew].Edition_Name == ds.Tables[8].Rows[cs].Edition_Name) {
                                        str = str + "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cardid + " value=" + ds.Tables[8].Rows[cs].weekrate + ">";
                                    }
                                }

                            }

                            ///////////////////////

                            if (ds.Tables[8].Rows.length == "0") {
                                str = str + "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cardid + " value=\"\">";
                            }
                        }
                        str = str + "</td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                // Discount Rate

                ///////////////////////
                discrate = "disrat" + i;
                //insertsta="inssta"+i;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[53].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + discrate + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(26).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + discrate + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                // Agrred Rate

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[55].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + agrred + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(27).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + agrred + "  value=\"\"></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                // Size

                if (document.getElementById('hiddenuomdesc').value != "CD") {
                    //    str=str+"<td><input class=\"btextsmallsize\" disabled id="+size+" type=\"text\" onchange=\"return getsoloextrarate("+adsubcat+","+colid+","+editid+","+size+","+adcat+","+gross+","+i+");\"  value="+document.getElementById('txttotalarea').value+"></td>";

                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[57].childNodes[0].nodeValue == "enable") {
                            str = str + "<td><input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"   ></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(28).text == "enable") {
                            str = str + "<td><input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  ></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }
                }
                else {
                    if (document.getElementById('txtcolum').disabled == true) {
                        if (browser != "Microsoft Internet Explorer") {
                            if (xmlObj.childNodes[23].childNodes[57].childNodes[0].nodeValue == "enable") {
                                str = str + "<td><input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  ></td>";
                            }
                            else {
                                str = str + "<td style=\"display:none;\"></td>";
                            }
                        }
                        else {
                            if (xmlObj.childNodes(11).childNodes(28).text == "enable") {
                                str = str + "<td><input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  ></td>";
                            }
                            else {
                                str = str + "<td style=\"display:none;\"></td>";
                            }
                        }

                    }
                    else {
                        if (browser != "Microsoft Internet Explorer") {
                            if (xmlObj.childNodes[23].childNodes[57].childNodes[0].nodeValue == "enable") {
                                str = str + "<td><input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  ></td>";
                            }
                            else {
                                str = str + "<td style=\"display:none;\"></td>";
                            }
                        }
                        else {
                            if (xmlObj.childNodes(11).childNodes(28).text == "enable") {
                                str = str + "<td><input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  ></td>";
                            }
                            else {
                                str = str + "<td style=\"display:none;\"></td>";
                            }
                        }

                    }
                }


                ////this is to bind the Ad sub cat3 drop down

                adsubcat3 = "adscat3" + i;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[59].childNodes[0].nodeValue == "enable") {
                        if (document.getElementById('drpadcat3').value == "0") {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat3 + " class=\"dropdownforgridqbc\" ></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat3 + "  class=\"dropdownforgridqbc\"  value=" + adcat3M + "></td>";
                        }
                        //                    str=str+"<td>";
                        //                    str=str+"<select id="+adsubcat3+" class=\"dropdownforgridqbc\" onchange=\"getadsubcat4("+adsubcat3+","+i+");\">";
                        //                    // this is to bind adv sub cat drop down
                        //                    str=str+"<option value=\"0\" selected=\"true\">-select-</option>";
                        //                    if(ds.Tables[10].Rows.length>0)
                        //                    {
                        //                        for(l=0;l<=ds.Tables[10].Rows.length-1;l++)
                        //                        {
                        //                            if(ds.Tables[10].Rows[l].catcode==document.getElementById('drpadcat3').value && document.getElementById('drpadcat3').value!="0")
                        //                            {
                        //                                str=str+"<option value="+ds.Tables[10].Rows[l].catcode+" selected="+document.getElementById('drpadcat3').value+">"+ds.Tables[10].Rows[l].catcode+"</option>";
                        //                            }
                        //                            else
                        //                            {
                        //                                str=str+"<option value="+ds.Tables[10].Rows[l].catcode+">"+ds.Tables[10].Rows[l].catcode+"</option>";
                        //                            }
                        //                        }
                        //                    }

                        //                    str=str+"</select></td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(29).text == "enable") {
                        //                    str=str+"<td>";
                        //                    str=str+"<select id="+adsubcat3+" class=\"dropdownforgridqbc\" onchange=\"getadsubcat4("+adsubcat3+","+i+");\">";
                        //                    // this is to bind adv sub cat drop down
                        //                    str=str+"<option value=\"0\" selected=\"true\">-select-</option>";
                        //                    if(ds.Tables[10].Rows.length>0)
                        //                    {
                        //                        for(l=0;l<=ds.Tables[10].Rows.length-1;l++)
                        //                        {
                        //                            if(ds.Tables[10].Rows[l].catcode==document.getElementById('drpadcat3').value && document.getElementById('drpadcat3').value!="0")
                        //                            {
                        //                                str=str+"<option value="+ds.Tables[10].Rows[l].catcode+" selected="+document.getElementById('drpadcat3').value+">"+ds.Tables[10].Rows[l].catcode+"</option>";
                        //                            }
                        //                            else
                        //                            {
                        //                                str=str+"<option value="+ds.Tables[10].Rows[l].catcode+">"+ds.Tables[10].Rows[l].catcode+"</option>";
                        //                            }
                        //                        }
                        //                    }

                        //                    str=str+"</select></td>";
                        if (document.getElementById('drpadcat3').value == "0") {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat3 + " class=\"dropdownforgridqbc\" ></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat3 + "  class=\"dropdownforgridqbc\" value=" + adcat3M + "></td>";
                        }

                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                    }
                }

                ////this is to bind the Ad sub cat4 drop down

                adsubcat4 = "adscat4" + i;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[61].childNodes[0].nodeValue == "enable") {
                        if (document.getElementById('drpadcat4').value == "0") {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat4 + " class=\"dropdownforgridqbc\"></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat4 + "  class=\"dropdownforgridqbc\" value=" + adcat4M + "></td>";
                        }
                        //                    str=str+"<td>";
                        //                    str=str+"<select id="+adsubcat4+" class=\"dropdownforgridqbc\" onchange=\"getadsubcat5("+adsubcat4+","+i+");\">";
                        //                    // this is to bind adv sub cat drop down
                        //                    str=str+"<option value=\"0\" selected=\"true\">-select-</option>";
                        //                    if(ds.Tables[11].Rows.length>0)
                        //                    {
                        //                        for(l=0;l<=ds.Tables[11].Rows.length-1;l++)
                        //                        {
                        //                            if(ds.Tables[11].Rows[l].Adv_Subcat_Code==document.getElementById('drpadcat4').value && document.getElementById('drpadcat4').value!="0")
                        //                            {
                        //                                str=str+"<option value="+ds.Tables[11].Rows[l].Cat_Code+" selected="+document.getElementById('drpadcat4').value+">"+ds.Tables[11].Rows[l].Cat_Code+"</option>";
                        //                            }
                        //                            else
                        //                            {
                        //                                str=str+"<option value="+ds.Tables[11].Rows[l].Cat_Code+">"+ds.Tables[11].Rows[l].Cat_Code+"</option>";
                        //                            }
                        //                        }
                        //                    }
                        //                    str=str+"</select></td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(30).text == "enable") {
                        if (document.getElementById('drpadcat4').value == "0") {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat4 + " class=\"dropdownforgridqbc\"></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat4 + "  class=\"dropdownforgridqbc\" value=" + adcat4M + "></td>";
                        }
                        //                    str=str+"<td>";
                        //                    str=str+"<select id="+adsubcat4+" class=\"dropdownforgridqbc\" onchange=\"getadsubcat5("+adsubcat4+","+i+");\">";
                        //                    // this is to bind adv sub cat drop down
                        //                    str=str+"<option value=\"0\" selected=\"true\">-select-</option>";
                        //                    if(ds.Tables[11].Rows.length>0)
                        //                    {
                        //                        for(l=0;l<=ds.Tables[11].Rows.length-1;l++)
                        //                        {
                        //                            if(ds.Tables[11].Rows[l].Cat_Code==document.getElementById('drpadcat4').value && document.getElementById('drpadcat4').value!="0")
                        //                            {
                        //                                str=str+"<option value="+ds.Tables[11].Rows[l].Cat_Code+" selected="+document.getElementById('drpadcat4').value+">"+ds.Tables[11].Rows[l].Cat_Code+"</option>";
                        //                            }
                        //                            else
                        //                            {
                        //                                str=str+"<option value="+ds.Tables[11].Rows[l].Cat_Code+">"+ds.Tables[11].Rows[l].Cat_Code+"</option>";
                        //                            }
                        //                        }
                        //                    }

                        //                    str=str+"</select></td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                    }
                }

                ////this is to bind the Ad sub cat5 drop down

                adsubcat5 = "adscat5" + i;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[63].childNodes[0].nodeValue == "enable") {
                        if (document.getElementById('drpadcat5').value != "0") {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat5 + " class=\"dropdownforgridqbc\"></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\"  id=" + adsubcat5 + " class=\"dropdownforgridqbc\" value=" + adcat5M + "></td>";
                        }
                        //                    str=str+"<td>";
                        //                    str=str+"<select id="+adsubcat5+" class=\"dropdownforgridqbc\" \>";// onchange=\"getadsubcat5("+adsubcat4+","+i+");\">";
                        //                    // this is to bind adv sub cat drop down
                        //                    str=str+"<option value=\"0\" selected=\"true\">-select-</option>";
                        //                    if(ds.Tables[12].Rows.length>0)
                        //                    {
                        //                        for(l=0;l<=ds.Tables[12].Rows.length-1;l++)
                        //                        {
                        //                            if(ds.Tables[12].Rows[l].Cat_Code==document.getElementById('drpadcat5').value && document.getElementById('drpadcat5').value!="0")
                        //                            {
                        //                                str=str+"<option value="+ds.Tables[12].Rows[l].Cat_Code+" selected="+document.getElementById('drpadcat5').value+">"+ds.Tables[12].Rows[l].Cat_Code+"</option>";
                        //                            }
                        //                            else
                        //                            {
                        //                                str=str+"<option value="+ds.Tables[12].Rows[l].Cat_Code+">"+ds.Tables[12].Rows[l].Cat_Code+"</option>";
                        //                            }
                        //                        }
                        //                    }

                        //                    str=str+"</select></td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(31).text == "enable") {
                        if (document.getElementById('drpadcat5').value == "0") {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat5 + " class=\"dropdownforgridqbc\"></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\"  id=" + adsubcat5 + " class=\"dropdownforgridqbc\" value=" + adcat5M + "></td>";
                        }
                        //                    str=str+"<td>";
                        //                    str=str+"<select id="+adsubcat5+" class=\"dropdownforgridqbc\" \>";// onchange=\"getadsubcat5("+adsubcat4+","+i+");\">";
                        //                    // this is to bind adv sub cat drop down
                        //                    str=str+"<option value=\"0\" selected=\"true\">-select-</option>";
                        //                    if(ds.Tables[12].Rows.length>0)
                        //                    {
                        //                        for(l=0;l<=ds.Tables[12].Rows.length-1;l++)
                        //                        {
                        //                            if(ds.Tables[12].Rows[l].Cat_Code==document.getElementById('drpadcat5').value && document.getElementById('drpadcat5').value!="0")
                        //                            {
                        //                                str=str+"<option value="+ds.Tables[12].Rows[l].Cat_Code+" selected="+document.getElementById('drpadcat5').value+">"+ds.Tables[12].Rows[l].Cat_Code+"</option>";
                        //                            }
                        //                            else
                        //                            {
                        //                                str=str+"<option value="+ds.Tables[12].Rows[l].Cat_Code+">"+ds.Tables[12].Rows[l].Cat_Code+"</option>";
                        //                            }
                        //                        }
                        //                    }

                        //                    str=str+"</select></td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                    }
                }


                // for logo
                var logohei = "logohei" + i;
                var logowid = "logowid" + i;
                var logonam = "logonam" + i;
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[65].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logohei + " Value=\"\" ></td>";

                        str = str + "<td><input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logowid + " Value=\"\" ></td>";


                        str = str + "<td><input  class=\"dropdownforgrid\" disabled type=\"text\" id=" + logonam + " Value=\"\" ></td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">logoH</td>";
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">logoW</td>";
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">logoN</td>";
                    }

                }
                else {
                    if (xmlObj.childNodes(11).childNodes(32).text == "enable") {
                        str = str + "<td><input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logohei + " Value=\"\" ></td>";

                        str = str + "<td><input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logowid + " Value=\"\" ></td>";


                        str = str + "<td><input  class=\"dropdownforgrid\" disabled type=\"text\" id=" + logonam + " Value=\"\" ></td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">logoH</td>";
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">logoW</td>";
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">logoN</td>";
                    }
                }

                // for bold charcter count
                var splboldsize = "splboldsize" + i;

                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + splboldsize + "' Value=\"\" ></td>";



                //   make_td.innerHTML="<input  class=\"dropdownforgrid\" disabled type=\"text\" id="+logonam+" Value=\"\" >";
                // Make_Row.appendChild(make_td);

                // for logo
                //This is a hidden field in the insertion grid which holds the Package Code for internal processing only
                pkgcodegrid = 'hiddenpckcode' + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkgcodegrid + "' value=" + ds.Tables[0].Rows[inew].EDITION_CODE + "></td>";

                var pubcode = 'pubcode' + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + pubcode + "' value='" + ds.Tables[0].Rows[inew].PUBCODE + "'></td>";


                //This below code for  puting the number of uccorance of packages into grid
                var pkg_ins = 'pkg_ins' + i;
                for (var countpkg = 0; countpkg < document.getElementById('drppackagecopy').length; countpkg++) {
                    var pkgcopy = document.getElementById('drppackagecopy').options[countpkg].value;
                    var arrpkgcopy = pkgcopy.split('@')
                    var pkgcopycode = arrpkgcopy[0];
                    var arr_pkg_ins_value = arrpkgcopy[1].split('(');
                    var pkg_ins_value = arr_pkg_ins_value[1].replace(')', '');
                    if (pkgcopycode == ds.Tables[0].Rows[i].EDITION_CODE) {
                        str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_ins + "' value=" + pkg_ins_value + "></td>";
                    }
                }

                pkg_alias = 'pkg_alias' + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_alias + "' value='" + ds.Tables[0].Rows[inew].PKGNAME + "'></td>";

                /*new change ankur 23 feb*/
                logonam = "lnam" + i
                var tdsln = "tdsln" + i;
                var tdslh = "tdslh" + i;
                var tdslw = "tdslw" + i;
                var tdslup = "tdslup" + i;

                /*22april*/

                if (gblogowithmatter == "yes") {
                    if (eval(document.getElementById(logonam)) != null && document.getElementById('hiddenuomdesc').value == "ROD") {
                        if (document.getElementById(logonam).value != "") {
                            str = str + "<td id=" + tdsln + "  ><input class=\"btextforgrid\" disabled type=\"text\" id=" + logonam + "  value=" + document.getElementById(logonam).value + "></td>";
                        }
                        else {
                            str = str + "<td id=" + tdsln + "  ><input class=\"btextforgrid\" disabled type=\"text\" id=" + logonam + "  value=\"\"></td>";
                        }
                    }
                    else {
                        str = str + "<td id=" + tdsln + "  ><input class=\"btextforgrid\" disabled type=\"text\" id=" + logonam + "  value=\"\"></td>";
                    }
                    str = str + "<td id=" + tdslh + " ><input class=\"btextforgrid\" disabled  type=\"text\" id=" + logoH + "  value=" + document.getElementById('txtlogohei').value + "></td>";
                    str = str + "<td id=" + tdslw + " ><input class=\"btextforgrid\" disabled  type=\"text\" id=" + logoW + "  value=" + document.getElementById('txtlogowid').value + "></td>";
                    str = str + "<td id=" + tdslup + "  width=\"50px\"><input  class=\"button1\" type=\"button\" Value=\"Logo Upload\" ></td>";

                }
                else {
                    str = str + "<td id=" + tdsln + " style=\"display:none;\" ><input class=\"btextforgrid\" disabled type=\"text\" id=" + logonam + "  value=\"\"></td>";
                    str = str + "<td id=" + tdslh + " style=\"display:none;\"><input class=\"btextforgrid\" disabled type=\"text\" id=" + logoH + "  value=\"\"></td>";
                    str = str + "<td id=" + tdslw + " style=\"display:none;\"><input class=\"btextforgrid\" disabled type=\"text\" id=" + logoW + "  value=\"\"></td>";
                    str = str + "<td id=" + tdslup + " style=\"display:none;\" width=\"50px\"><input  class=\"button1\" type=\"button\" Value=\"Logo Upload\" ></td>";
                }

                var spltdata = "spltdata" + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + spltdata + "' value=\"\"></td>";

                var subedidata = "subedidata" + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + subedidata + "' value=\"\"></td>";

                var vat = "vat" + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + vat + "' value=\"\"></td>";

                var vat_inc = "vat_inc" + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + vat_inc + "' value=\"\"></td>";
                /////////////////////////////////////anuja eyecather
                var eye_cather = "eye_cather" + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + eye_cather + "' value=\"\"></td>";
                ////////////////////day wise premium
                var hdnday_prim = "hdnday_prim" + i;
                str = str + "<td><input disabled class=\"btextsmallsize\"  style=\"display:none;\" type=\"text\" id='" + hdnday_prim + "' value=\"\"></td>";
                var clicatamt = "clicatamt" + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + clicatamt + "' value=\"\"></td>";
                
                var GSTAMT = "GSTAMT" + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + GSTAMT + "' value=\"\"></td>";
                
                 var GSTGD = "GSTGD" + i;
                str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + GSTGD + "' value=\"\"></td>";
                ////////////////////////////////////////
                str = str + "</tr>";
                i = parseInt(i, 10) + 1;
            }
        }




        str = str + "</table></div>";

        //alert(str);
        idnew = ds.Tables[0].Rows.length;
        //////add by anuja
        var dateformat_vari = document.getElementById('hiddendateformat');
        var compcode_vari = document.getElementById('hiddencompcode');
        var center_vari = document.getElementById('hiddencenter');
        var adtype_vari = document.getElementById('hiddenadtype');
        var chkall_vari = document.getElementById('chkall');
        //subtractrow="show";
        var temp = idnew;
        /////end by anuja for noissuedate
        document.getElementById('tblinsert').innerHTML = str;
        //  subtractrow="show";
        for (var i = 0; i < parseInt(document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows.length - 1); i++) {
            var height = "hei" + i;
            var width = "wid" + i;
            var noofcol = "nocol" + i;
            var id = "Text" + i;
            var adsubcat3 = "adscat3" + i;
            var adsubcat4 = "adscat4" + i;
            var inserts = "ins" + i;
            var adcat = "adcat" + i;
            var adsubcat = "ads" + i;
            var paid = "pai" + i;
            var page = "pgpre" + i;
            var pagstr = "sec"
            var paid = "pai" + i;
            var insertval = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(i, 10) + 1].cells[0].innerHTML;
            var height_vari = document.getElementById(height);
            var par1 = (height_vari.parentNode).parentNode;
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById(height).onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                document.getElementById(width).onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                document.getElementById(noofcol).onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                document.getElementById(id).onchange = new Function("return chkDateforGrid(this);");
                if (document.getElementById(paid) != undefined && document.getElementById(paid) != "undefined" && document.getElementById(paid) != null)
                    document.getElementById(paid).onchange = new Function("return blankGross();");
                if (document.getElementById(page) != undefined && document.getElementById(page) != "undefined" && document.getElementById(page) != null)
                    document.getElementById(page).onchange = new Function("return getpageprem(" + page + "," + i + ",'" + pagstr + "');");
            }
            else {
                par1.all[height].onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                par1.all[width].onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                par1.all[noofcol].onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                par1.all[id].onchange = new Function("return chkDateforGrid(this);");
                if (par1.all[paid] != undefined && par1.all[paid] != "undefined" && par1.all[paid] != null)
                    par1.all[paid].onchange = new Function("return blankGross();");
                if (par1.all[page] != undefined && par1.all[page] != "undefined" && par1.all[page] != null)
                    par1.all[page].onchange = new Function("return getpageprem(" + page + "," + i + ",'" + pagstr + "');");
            }
            //////add by anuja for noissuedate
            if (repeatdate == "0" || repeatdate == "1") {
                var id = "Text" + i;
                //    if(caldatemonth.length>=i && caldatemonth[i]!=undefined)
                //  {
                // var mmM=caldatemonth[i].toString();
                //}
                //else{
                var mmM = parseInt(monthSelected, 10) + 1;
                mmM = mmM.toString();
                //}
                if (mmM.toString().length == 1)
                    mmM = "0" + mmM.toString();
                if (dateformat_vari.value == "mm/dd/yyyy") {
                    vvalue = mmM + "/" + dateSelected + "/" + yearSelected;
                }
                else if (dateformat_vari.value == "dd/mm/yyyy") {
                    vvalue = dateSelected + "/" + mmM + "/" + yearSelected; ;
                }
                else if (dateformat_vari.value = "yyyy/mm/dd") {
                    vvalue = yearSelected + "/" + mmM + "/" + dateSelected; ;
                }
                vvalue = document.getElementById('Text' + i).value;

                if (dateSelected != undefined && dateSelected != "") {
                    if (browser != "Microsoft Internet Explorer") {
                        var pkgfullname = document.getElementById('pkg_alias' + i).value;
                        var pkgid = document.getElementById('hiddenpckcode' + i).value;
                        var pkgname = document.getElementById('pkg_alias' + i).value;
                        var compcode = compcode_vari.value;

                        dateday = vvalue;

                        document.getElementById('Text' + i).value = vvalue;
                    }
                    else {
                        var pkgfullname = par1.all['pkg_alias' + i].value;
                        var pkgid = par1.all['hiddenpckcode' + i].value;
                        var pkgname = par1.all['pkg_alias' + i].value;
                        var compcode = compcode_vari.value;
                        dateday = vvalue;

                        par1.all['Text' + i].value = vvalue;
                    }
                    if (browser != "Microsoft Internet Explorer") {
                        var httpRequest = null; ;
                        httpRequest = new XMLHttpRequest();
                        if (httpRequest.overrideMimeType) {
                            httpRequest.overrideMimeType('text/xml');
                        }

                        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };
                        var adcat = adcat_vari.value;
                        var center = '';
                        if (center_vari != null) {
                            center = center_vari.value;
                            if (chkall_vari != null) {
                                if (chkall_vari.checked == true) {
                                    center = '0';
                                }
                            }
                            else {
                                center = '0';
                            }
                        }
                        httpRequest.open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
                        httpRequest.send('');
                        //alert(httpRequest.readyState);
                        if (httpRequest.readyState == 4) {
                            //alert(httpRequest.status);
                            if (httpRequest.status == 200) {
                                strtext = httpRequest.responseText;
                            }
                            else {
                                alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
                            }
                        }
                    }
                    else {
                        validuse = "";
                        var xml = new ActiveXObject("Microsoft.XMLHTTP");
                        var adcat = adcat_vari;
                        var center = '';
                        if (center_vari != null) {
                            center = center_vari.value;
                            if (chkall_vari != null) {
                                if (chkall_vari.checked == true) {
                                    center = '0';
                                }
                            }
                            else {
                                center = '0';
                            }
                        }
                        xml.Open("GET", "packagename.aspx?center=" + center + "&adtype=" + adtype_vari.value + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + pkgid + "&dateday=" + dateday + "&pkgname=" + pkgfullname + "&pkgalias=" + pkgname, false);
                        xml.Send();
                        strtext = xml.responseText;
                    }
                    if (strtext == "NOT A VALID DATE") {
                        alert("NOT A VALID DATE");
                        document.getElementById(id).value = "";
                        document.getElementById(id).focus();
                        return false;
                    }
                    if (strtext == "0") {
                        //alert("Day is not the publishing day");
                        document.getElementById(id).value = "";
                        return false;
                    }
                    else {
                        if (strtext == "1")
                            document.getElementById(id).value = vvalue;
                        else {
                            if (strtext != "") {
                                if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                                    var txt = strtext;
                                    var txt1 = txt.split("/");
                                    var dd = txt1[0];
                                    var mm1 = txt1[1];
                                    var mm = txt1[1]; //getMonthNo(mm1);
                                    var yy = txt1[2];
                                    caldate[cali] = dd;
                                    caldatemonth[cali] = mm;
                                    caldateyear[cali] = yy;
                                    cali = parseInt(cali, 10) + 1;
                                }
                                else if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                                    var txt = strtext;
                                    var txt1 = txt.split("/");
                                    var dd = txt1[1];
                                    var mm1 = txt1[0];
                                    var mm = txt1[0]; //getMonthNo(mm1);
                                    var yy = txt1[2];
                                    caldate[cali] = dd;
                                    caldatemonth[cali] = mm;
                                    caldateyear[cali] = yy;
                                    cali = parseInt(cali, 10) + 1;
                                }
                                else if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
                                    var txt = strtext;
                                    var txt1 = txt.split("/");
                                    var dd = txt1[2];
                                    var mm1 = txt1[1];
                                    var mm = txt1[1]; //getMonthNo(mm1);
                                    var yy = txt1[0];
                                    caldate[cali] = dd;
                                    caldatemonth[cali] = mm;
                                    caldateyear[cali] = yy;
                                    cali = parseInt(cali, 10) + 1;
                                }
                            }
                            document.getElementById(id).value = strtext;
                            if (vvalue != strtext) {
                                if (alrt34 == "0") {
                                    alrt34 = "1";
                                    alert(vvalue + " Date is no issue date of edition " + pkgname);
                                }
                                document.getElementById(id).value = "";
                                cali = cali - 1;
                            }
                        }
                    }
                }
            }
            temp = parseInt(temp) + 1;
            //////end by anuja
        }
    }
    fillcopyfilename();
    noissueflag = false; ///add by anuja
    //   disablegriddrp();
    return false;
}



/////////this function get the rate of the selected package and fill into the grid

////////////////this is the function to open the div for deal div

function showdealvalue() {

    /*new change ankur 24 feb*/
    if (document.getElementById('txtagency').value == "") {
        alert("Please Enter Agency");
        return false;

    }
    if (document.getElementById('hiddenprint_rec').value == "Y") {
        if (document.getElementById('txtclient').value == "") {
            alert("Please Fill the Client Name");

            document.getElementById('txtclient').focus();
            return false;
        }
    }
    document.getElementById('hiddenclientname').value = document.getElementById('txtclient').value;
    document.getElementById('hiddenclientaddress').value = document.getElementById('txtclientadd').value;
    document.getElementById('hiddenreceiptno1').value = document.getElementById('txtreceipt').value;

    if (document.getElementById('drpuom').value == "0") {
        alert("Please select the uom");
        document.getElementById('drpuom').focus();
        return false;

    }
    if (gblogowithmatter == "yes") {
        if (document.getElementById('txtlogohei').value == "") {
            alert("Please enter the logo height");
            //document.getElementById('drpuom').focus();
            return false;

        }
        //		    else if(document.getElementById('txtlogowid').value=="")
        //		    {
        //		        alert("Please enter the logo width");
        //		        //document.getElementById('drpuom').focus();
        //		        return false;
        //		    
        //		    }
    }


    if (document.getElementById('hiddensavemod').value != "1") {
        if (document.getElementById('drppackagecopy').options.length == 0) {
            alert("Please select the package");

            // document.getElementById('txtratecode').value="0";
            // changepackage();
            document.getElementById('drppackage').focus();
            return false;

        }
        //
        if (document.getElementById('txtadsize1').value == "" && document.getElementById('txtadsize1').disabled == false) {
            alert("Please select the Height");
            //document.getElementById('txtratecode').value="0"
            //changediv1();
            document.getElementById('txtadsize1').focus();
            return false;

        }
        if (document.getElementById('txtadsize2').value == "" && document.getElementById('txtadsize2').disabled == false) {
            alert("Please select the width ");
            //document.getElementById('txtratecode').value="0"
            //changediv1();
            document.getElementById('txtadsize2').focus();
            return false;

        }
        //  if(document.getElementById('txtadsize2').disabled==true && document.getElementById('txttotalarea').value=="")
        if (document.getElementById('txtadsize2').disabled == true) {
            var i = 0;
            if (document.getElementById('txttotalarea').value == "") {
                for (i = 0; i < document.getElementById('txtinsertion').value; i++) {
                    var size = "siz" + i;
                    var height = "hei" + i;
                    var width = "wid" + i;
                    if (document.getElementById(size).value == '' && (document.getElementById(height).value == '' && document.getElementById(width).value == '')) {
                        var msg = i + 1;
                        alert("Please Enter No. Of Lines for Insertion No." + msg);
                        return false;
                    }
                }
            }

            var flagc = 0;
            for (i = 0; i < document.getElementById('txtinsertion').value; i++) {
                var size = "siz" + i;
                if (document.getElementById(size).value != '') {
                    flagc = 1;
                    if (document.getElementById('txttotalarea').value != '') {
                        if (parseInt(document.getElementById('txttotalarea').value) < parseInt(document.getElementById(size).value)) {
                            document.getElementById('txttotalarea').value = document.getElementById(size).value;
                        }
                    }
                    else {
                        document.getElementById('txttotalarea').value = document.getElementById(size).value;
                    }
                }

            }
            if (flagc == 0 && document.getElementById('txttotalarea').value == "") {
                alert("Please select no. of lines");
                return false;
            }
            //document.getElementById('txtratecode').value="0"
            //changediv1();
            /*new change ankur 18 feb*/
            //document.getElementById('txttotalarea').focus();

        }

        if (document.getElementById('drpuom').value == "0") {
            alert("Please select the Uom ");
            // document.getElementById('txtratecode').value="0"
            //changediv();
            document.getElementById('drpuom').focus();
            return false;

        }
        if (document.getElementById('txtdummydate').value == "") {
            alert("Please get  the booking date ");
            // document.getElementById('txtratecode').value="0"
            //changediv();
            document.getElementById('txtdummydate').focus();
            return false;

        }
    }

    // var dealtype=document.getElementById('hiddentype').value
    var agency = document.getElementById('txtagency').value
    var agencyarr = agency.split("(");
    var agencysplit = agencyarr[1];
    agencysplit = agencysplit.replace(")", "");
    //  var subagency=document.getElementById('drpagscode').value;
    var client = document.getElementById('txtclient').value;
    var clientarr = client.split("(");
    var clientsplit = clientarr[1];
    if (clientsplit != undefined) {
        clientsplit = clientsplit.replace(")", "");
    }
    else {
        clientsplit = "0";
    }
    var bookingdate = document.getElementById('txtdummydate').value;
    var color = document.getElementById('drpcolor').value;
    var curr = document.getElementById('hiddencurrency').value;
    var adcat = document.getElementById('drpadcategory').value;
    var compcode = document.getElementById('hiddencompcode').value
    //new change ankur 26 feb*/
    var prod = document.getElementById('txtratecode').value
    //var prod="qbc";
    var col = document.getElementById('drpcolor').value
    //var pkg_code=document.getElementById('drpcolor').value

    var objpack = document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var code = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (temp != "") {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode + "," + code;
                desc = tempcode + "," + desc;


            }
            else {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode;
                desc = tempcode;
            }
        }

    }
    var rate_cod = "0";
    var adtype = document.getElementById('drpadtype').value;
    bindFinalRate();

    //when value is 0 than we bind the list box and when it is 1 than we calculate the discount
    // QBC.binddealtype(compcode,agencysplit,"0",bookingdate,color,curr,adcat,clientsplit,prod,col,code,rate_cod,adtype,call_binddealtype);

    return false;

}
function call_binddealtype(res) {
    var ds = res.value;
    if (ds != null) {
        if (ds.Tables[0] != undefined && ds.Tables[0].Rows.length > 0 && document.getElementById('chkcontract').checked == true) {
            if (ds.Tables[0].Rows[0].contractname == "undefined" || ds.Tables[0].Rows[0].contractname == undefined) {
                document.getElementById('txtcontractname').value = ""
                document.getElementById('txtdealrate').value = "";

            }
            else {
                document.getElementById('txtcontractname').value = ds.Tables[0].Rows[0].contractname
                document.getElementById('txtdealrate').value = ds.Tables[0].Rows[0].deal_rate
            }
            document.getElementById('txtcontractname').disabled = false;

        }
        else {
            document.getElementById('chkcontract').checked = false;

            document.getElementById('txtcontractname').value = "";
            document.getElementById('txtdealrate').value = "";

        }
    }
    ////this is to get the pkg rate into the form 
    gettherate();




}
///////////this is to blank the rate
function blankcontractrate() {
    if (document.getElementById('txtcontractname').value == "") {
        document.getElementById('txtdealrate').value = "";
        //flagins="0"
        if (document.getElementById('txtcardrate').value != "") {
            //   fillrateintogrid();
        }
        return false;
    }

}
function enablecontract() {
    if (document.getElementById('chkcontract').checked == true) {
        document.getElementById('chkcontract').checked = true;
        showdealvalue();
    }
    else if (document.getElementById('chkcontract').checked == false) {
        document.getElementById('chkcontract').checked = false;
        document.getElementById('txtcontractname').value = "";
        document.getElementById('txtdealrate').value = "";
        gettherate();
    }
    return;

}
/*new change ankur 17 feb*/
function gettheuomdesc() {





    document.getElementById('txtcardrate').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    /*mysql*/
    if (document.getElementById('hiddentypedatabase').value == "mysql") {
        document.getElementById('chkattach').checked = true;
        document.getElementById('chkattach').disabled = true;
    }

    if (document.getElementById('drpuom').value == "SQ0") {
        document.getElementById('drpbgcolor').disabled = true;
        document.getElementById('drpstyle').disabled = true;
        document.getElementById('drpdesign').disabled = true;
        document.getElementById('drplogoprem').disabled = true;
        document.getElementById('drpboxcodenew').disabled = true;
        document.getElementById('drpbullet').disabled = true;

    }

    else if (document.getElementById('drpuom').value == "ROW") {


        document.getElementById('drpbgcolor').disabled = false;
        document.getElementById('drpstyle').disabled = false;
        document.getElementById('drpdesign').disabled = false;
        document.getElementById('drplogoprem').disabled = false;
        document.getElementById('drpboxcodenew').disabled = false;
        document.getElementById('drpbullet').disabled = false;



    }
    /////////////////

    /*new change ankur 24 feb*/
    //////                if(document.getElementById('tblinsert').innerHTML=="")
    //////                {
    //////                    alert("Please select the package");
    //////                    document.getElementById('drpuom').value="0";
    //////                    return false;
    //////                }
    //////////////
    var uom_cod = document.getElementById('drpuom').value;
    var compcode = document.getElementById('hiddencompcode').value
    /*new change ankur for agency*/
    if (uom_cod != "0") {
        QBC.gettheuom_desc(compcode, uom_cod, changesizetoline);
    }
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    bindrategroupvode(document.getElementById('drpadcategory').value);
}
function changesizetoline(res) {

    var ds = res.value;
    document.getElementById('hiddenuomdesc').value = ds.Tables[0].Rows[0].uom_desc
    document.getElementById('hiddenlogocode').value = ds.Tables[0].Rows[0].Logo
    document.getElementById('hiddenuomstylesheet').value = ds.Tables[0].Rows[0].stylesheetname
    if (document.getElementById('drpadtype').value == "0") {
        alert("Please select the Ad type");
        return false;
    }
    document.getElementById('hiddenuomcode').value = document.getElementById('drpuom').value;
    var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value);
    if (document.getElementById('hiddenuomdesc').value == "ROC" || document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROW" || document.getElementById('hiddenuomdesc').value == "ROD") {
        document.getElementById('drpboxcodenew').disabled = false;
        document.getElementById('drpbullet').disabled = false;
        document.getElementById('drplogoprem').disabled = false;
        document.getElementById('drpdesign').disabled = false;
        document.getElementById('txteyecathval').disabled = true;

        document.getElementById('txtadsize1').value = ""
        document.getElementById('txtadsize1').disabled = true;
        document.getElementById('txtadsize1').style.backgroundColor = "Gray";
        document.getElementById('txtadsize2').value = ""
        document.getElementById('txtadsize2').disabled = true;
        document.getElementById('txtadsize2').style.backgroundColor = "Gray";
        document.getElementById('txtcolum').value = ""
        document.getElementById('txtcolum').disabled = true;
        document.getElementById('chkattach').disabled = true;
        document.getElementById('chkattach').checked = true;
        document.getElementById('txtcolum').style.backgroundColor = "Gray";
        document.getElementById('txttotalarea').value = "";
        //document.getElementById('drpboxcodenew').focus();
        if (document.getElementById('txttotalarea').value == "") {
            document.getElementById('txttotalarea').value = "";
        }
        if (document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "CD") {
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById('Label1').textContent = "No. Of Lines";
            }
            else {
                document.getElementById('Label1').innerText = "No. Of Lines";
            }
        }
        else if (document.getElementById('hiddenuomdesc').value == "ROW") {
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById('Label1').textContent = "No. Of Words";
            }
            else {
                document.getElementById('Label1').innerText = "No. Of Words";
            }
        }
        else if (document.getElementById('hiddenuomdesc').value == "ROC") {
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById('Label1').textContent = "No. Of Char";
            }
            else {
                document.getElementById('Label1').innerText = "No. Of Char";
            }
        }

    }
    else if (document.getElementById('hiddenuomdesc').value == "CD" || document.getElementById('hiddenuomdesc').value != "ROL" || document.getElementById('hiddenuomdesc').value != "ROW" || document.getElementById('hiddenuomdesc').value != "ROD" || document.getElementById('hiddenuomdesc').value != "ROC") {
        document.getElementById('txtadsize1').value = ""
        document.getElementById('txtadsize1').disabled = false;
        document.getElementById('txtadsize1').style.backgroundColor = "White";
        document.getElementById('txtadsize2').value = ""
        document.getElementById('txtadsize2').disabled = false;
        document.getElementById('txtadsize2').style.backgroundColor = "White";
        document.getElementById('txtcolum').value = ""
        document.getElementById('txtcolum').disabled = false;
        document.getElementById('chkattach').disabled = false;
        document.getElementById('drpboxcodenew').disabled = true;
        document.getElementById('drpboxcodenew').value = 0;
        document.getElementById('drpbullet').value = 0;
        document.getElementById('drplogoprem').value = 0;
        document.getElementById('drpdesign').value = 0;
        document.getElementById('txtboxnonew').value = "";
        document.getElementById('txtboxchrg').value = "";
        document.getElementById('txtboxadd').value = "";
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txttotalamt').value = "";
        document.getElementById('txttotalarea').value = "";
        document.getElementById('hiddenLineCount').value = "";
        document.getElementById('drpbullet').disabled = true;
        document.getElementById('drplogoprem').disabled = true;
        document.getElementById('drpdesign').disabled = true;
        document.getElementById('txteyecathval').disabled = true;
        document.getElementById('chkattach').checked = true;

        if (document.getElementById('hiddentypedatabase').value == "mysql") {
            document.getElementById('chkattach').checked = true;
            document.getElementById('chkattach').disabled = true;
        }
        document.getElementById('txtcolum').style.backgroundColor = "White";
        if (browser != "Microsoft Internet Explorer") {
            document.getElementById('Label1').textContent = "Total Area";
        }
        else {
            document.getElementById('Label1').innerText = "Total Area";
        }
        document.getElementById('txttotalarea').value = ""
        if (document.getElementById('txttotalarea').value == "") {
            document.getElementById('txttotalarea').value = "";
        }
    }
    /////if there is insertion grid than on ROL change size to line and gray out height and width
    if (document.getElementById('tblinsert').innerHTML != null) {
        if (document.getElementById('hiddenuomdesc').value == "ROC" || document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROW" || document.getElementById('hiddenuomdesc').value == "ROD") {

            if (document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROD") {
                if (document.getElementById('siz') != null) {
                    if (browser != "Microsoft Internet Explorer") {
                        document.getElementById('siz').textContent = "Lines";
                    }
                    else {
                        document.getElementById('siz').innerText = "Lines";
                    }
                }
            }
            else if (document.getElementById('hiddenuomdesc').value == "ROW") {
                if (document.getElementById('siz') != null) {
                    if (browser != "Microsoft Internet Explorer") {
                        document.getElementById('siz').textContent = "Words";
                    }
                    else {
                        document.getElementById('siz').innerText = "Words";
                    }
                }
            }
            else if (document.getElementById('hiddenuomdesc').value == "ROC") {
                if (document.getElementById('siz') != null) {
                    if (browser != "Microsoft Internet Explorer") {
                        document.getElementById('siz').textContent = "Char";
                    }
                    else {
                        document.getElementById('siz').innerText = "Char";
                    }
                }
            }
            ////////////////////////////this is to gray out the height and width of insertion grid on rol and row
            var len = "bookdiv";
            if (document.getElementById(len) != null) {

                var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
                var i = 0;
                var k;
                var height;
                var width;
                var size;
                var filename;
                for (k = 0; i < y - 1; k++) {

                    height = "hei" + i;
                    width = "wid" + i;
                    size = "siz" + i;
                    noofcol = "nocol" + i;
                    filename = "fil" + i;
                    var height_vari = document.getElementById(height);
                    var par1 = (height_vari.parentNode).parentNode;
                    if (browser != "Microsoft Internet Explorer") {
                        document.getElementById(height).style.backgroundColor = "Gray";
                        document.getElementById(noofcol).style.backgroundColor = "Gray";
                        document.getElementById(noofcol).readOnly = true;
                        document.getElementById(noofcol).value = "";
                        //document.getElementById(height).style.color="white";
                        document.getElementById(height).readOnly = true;
                        document.getElementById(height).value = "";
                        document.getElementById(width).style.backgroundColor = "Gray";
                        //document.getElementById(width).style.color="white";
                        document.getElementById(width).readOnly = true;
                        document.getElementById(width).value = "";
                        document.getElementById(size).value = "";
                        document.getElementById(size).readOnly = false;
                        if (document.getElementById(filename) != null)
                            document.getElementById(filename).value = "";
                    }
                    else {
                        par1.all[height].style.backgroundColor = "Gray";
                        par1.all[noofcol].style.backgroundColor = "Gray";
                        par1.all[noofcol].readOnly = true;
                        par1.all[noofcol].value = "";
                        par1.all[height].readOnly = true;
                        par1.all[height].value = "";
                        par1.all[width].style.backgroundColor = "Gray";
                        par1.all[width].readOnly = true;
                        par1.all[width].value = "";
                        par1.all[size].value = "";
                        par1.all[size].readOnly = false;
                        if (document.getElementById(filename) != null)
                            document.getElementById(filename).value = "";
                    }
                    i++;

                }
            }
        }
        else if (document.getElementById('hiddenuomdesc').value == "CD" || document.getElementById('hiddenuomdesc').value != "ROC" || document.getElementById('hiddenuomdesc').value != "ROL" || document.getElementById('hiddenuomdesc').value != "ROW" || document.getElementById('drpuom').value == "0" || document.getElementById('hiddenuomdesc').value == "ROD" || document.getElementById('hiddenuomdesc').value == "CD") {
            if (document.getElementById('siz') != null) {
                if (browser != "Microsoft Internet Explorer") {
                    document.getElementById('siz').textContent = "Size";
                }
                else {
                    document.getElementById('siz').innerText = "Size";
                }
            }
            ////////////////////////////this is to White out the height and width of insertion grid on rol and row
            var len = "bookdiv";
            if (document.getElementById(len) != null) {
                var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
                var i = 0;
                var k;
                var height;
                var width;
                var size;
                var filename;
                for (k = 0; i < y - 1; k++) {

                    height = "hei" + i;
                    width = "wid" + i;
                    size = "siz" + i;
                    filename = "fil" + i;
                    var height_vari = document.getElementById(height);
                    var par1 = (height_vari.parentNode).parentNode;
                    if (browser != "Microsoft Internet Explorer") {
                        document.getElementById(height).style.backgroundColor = "white";
                        document.getElementById(height).readOnly = false;
                        document.getElementById(width).style.backgroundColor = "white";
                        document.getElementById(width).readOnly = false;
                        document.getElementById(size).readOnly = true;
                        if (document.getElementById(filename) != null)
                            document.getElementById(filename).value = "";
                    }
                    else {
                        par1.all[height].style.backgroundColor = "white";
                        par1.all[height].readOnly = false;
                        par1.all[width].style.backgroundColor = "white";
                        par1.all[width].readOnly = false;
                        par1.all[size].readOnly = true;
                        if (document.getElementById(filename) != null)
                            document.getElementById(filename).value = "";
                    }
                    i++;

                }
            }
        }




    }
}

function changesizetoline1(res) {

    var ds = res.value;
    document.getElementById('hiddenuomdesc').value = ds.Tables[0].Rows[0].uom_desc
    document.getElementById('hiddenlogocode').value = ds.Tables[0].Rows[0].Logo
    document.getElementById('hiddenuomstylesheet').value = ds.Tables[0].Rows[0].stylesheetname
    /*new change ankur 11 feb*/
    if (document.getElementById('drpadtype').value == "0") {
        alert("Please select the Ad type");
        //document.getElementById('drpadtype').focus();
        return false;
    }
    /*new change ankur 15 feb*/
    document.getElementById('hiddenuomcode').value = document.getElementById('drpuom').value

    /////////////////////
    var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
    /////////if uom is rol or row than disable ad size hei and width and no of collumns also gray out
    //RO0-- ROL
    //RO1-- ROw
    //RO2--ROD
    //RO3-- CD
    /*new change ankur 16 feb*/
    if (document.getElementById('hiddenuomdesc').value == "ROC" || document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROW" || document.getElementById('hiddenuomdesc').value == "ROD") {
        document.getElementById('drpboxcodenew').disabled = false;
        document.getElementById('drpbullet').disabled = false;
        document.getElementById('drplogoprem').disabled = false;
        document.getElementById('drpdesign').disabled = false;
        document.getElementById('txteyecathval').disabled = true;

        document.getElementById('txtadsize1').value = ""
        document.getElementById('txtadsize1').disabled = true;
        document.getElementById('txtadsize1').style.backgroundColor = "Gray";
        document.getElementById('txtadsize2').value = ""
        document.getElementById('txtadsize2').disabled = true;
        document.getElementById('txtadsize2').style.backgroundColor = "Gray";
        document.getElementById('txtcolum').value = ""
        document.getElementById('txtcolum').disabled = true;
        document.getElementById('chkattach').disabled = true;
        document.getElementById('chkattach').checked = true;
        document.getElementById('txtcolum').style.backgroundColor = "Gray";
        document.getElementById('txttotalarea').value = "";
        if (document.getElementById('txttotalarea').value == "") {
            document.getElementById('txttotalarea').value = "";
        }
        if (document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "CD") {
            //document.getElementById('Label1').innerText="No. Of Lines";
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById('Label1').textContent = "No. Of Lines";
            }
            else {
                document.getElementById('Label1').innerText = "No. Of Lines";
            }
        }
        else if (document.getElementById('hiddenuomdesc').value == "ROW") {
            //document.getElementById('Label1').innerText="No. Of Words";
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById('Label1').textContent = "No. Of Words";
            }
            else {
                document.getElementById('Label1').innerText = "No. Of Words";
            }
        }
        else if (document.getElementById('hiddenuomdesc').value == "ROC") {
            //document.getElementById('Label1').innerText="No. Of Char";
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById('Label1').textContent = "No. Of Char";
            }
            else {
                document.getElementById('Label1').innerText = "No. Of Char";
            }
        }




    }
    else if (document.getElementById('hiddenuomdesc').value == "CD" || document.getElementById('hiddenuomdesc').value != "ROL" || document.getElementById('hiddenuomdesc').value != "ROW" || document.getElementById('hiddenuomdesc').value != "ROD" || document.getElementById('hiddenuomdesc').value != "ROC") {
        document.getElementById('txtadsize1').value = ""
        document.getElementById('txtadsize1').disabled = false;
        document.getElementById('txtadsize1').style.backgroundColor = "White";
        document.getElementById('txtadsize2').value = ""
        document.getElementById('txtadsize2').disabled = false;
        document.getElementById('txtadsize2').style.backgroundColor = "White";
        document.getElementById('txtcolum').value = ""
        document.getElementById('txtcolum').disabled = false;
        document.getElementById('chkattach').disabled = false;
        document.getElementById('drpboxcodenew').disabled = true;
        document.getElementById('drpboxcodenew').value = 0;
        document.getElementById('drpbullet').value = 0;
        document.getElementById('drplogoprem').value = 0;
        document.getElementById('drpdesign').value = 0;
        document.getElementById('txtboxnonew').value = "";
        document.getElementById('txtboxchrg').value = "";
        document.getElementById('txtboxadd').value = "";
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txttotalamt').value = "";
        document.getElementById('txttotalarea').value = "";
        document.getElementById('hiddenLineCount').value = "";
        document.getElementById('drpbullet').disabled = true;
        document.getElementById('drplogoprem').disabled = true;
        document.getElementById('drpdesign').disabled = true;
        document.getElementById('txteyecathval').disabled = true;
        document.getElementById('chkattach').checked = true;

        /*mysql*/
        if (document.getElementById('hiddentypedatabase').value == "mysql") {
            document.getElementById('chkattach').checked = true;
            document.getElementById('chkattach').disabled = true;
        }

        document.getElementById('txtcolum').style.backgroundColor = "White";
        //document.getElementById('Label1').innerText="Total Area";
        if (browser != "Microsoft Internet Explorer") {
            document.getElementById('Label1').textContent = "Total Area";
        }
        else {
            document.getElementById('Label1').innerText = "Total Area";
        }
        document.getElementById('txttotalarea').value = ""
        if (document.getElementById('txttotalarea').value == "") {
            document.getElementById('txttotalarea').value = "";
        }
    }

    /////if there is insertion grid than on ROL change size to line and gray out height and width
    if (document.getElementById('tblinsert').innerHTML != null) {
        if (document.getElementById('hiddenuomdesc').value == "ROC" || document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROW" || document.getElementById('hiddenuomdesc').value == "ROD") {

            if (document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROD") {
                if (document.getElementById('siz') != null) {
                    //document.getElementById('siz').innerText="Lines";
                    if (browser != "Microsoft Internet Explorer") {
                        document.getElementById('siz').textContent = "Lines";
                    }
                    else {
                        document.getElementById('siz').innerText = "Lines";
                    }
                }
            }
            else if (document.getElementById('hiddenuomdesc').value == "ROW") {
                if (document.getElementById('siz') != null) {
                    //document.getElementById('siz').innerText="Words";
                    if (browser != "Microsoft Internet Explorer") {
                        document.getElementById('siz').textContent = "Words";
                    }
                    else {
                        document.getElementById('siz').innerText = "Words";
                    }
                }
            }
            else if (document.getElementById('hiddenuomdesc').value == "ROC") {
                if (document.getElementById('siz') != null) {
                    //document.getElementById('siz').innerText="Char";
                    if (browser != "Microsoft Internet Explorer") {
                        document.getElementById('siz').textContent = "Char";
                    }
                    else {
                        document.getElementById('siz').innerText = "Char";
                    }
                }
            }
            ////////////////////////////this is to gray out the height and width of insertion grid on rol and row
            var len = "bookdiv";
            if (document.getElementById(len) != null) {

                var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
                var i = 0;
                var k;
                var height;
                var width;
                var size;
                var filename;
                for (k = 0; i < y - 1; k++) {

                    height = "hei" + i;
                    width = "wid" + i;
                    size = "siz" + i;
                    noofcol = "nocol" + i;
                    filename = "fil" + i;
                    var height_vari = document.getElementById(height);
                    var par1 = (height_vari.parentNode).parentNode;
                    if (browser != "Microsoft Internet Explorer") {
                        document.getElementById(height).style.backgroundColor = "Gray";
                        document.getElementById(noofcol).style.backgroundColor = "Gray";
                        document.getElementById(noofcol).disabled = true;
                        document.getElementById(noofcol).value = "";
                        //document.getElementById(height).style.color="white";
                        document.getElementById(height).disabled = true;
                        document.getElementById(height).value = "";
                        document.getElementById(width).style.backgroundColor = "Gray";
                        //document.getElementById(width).style.color="white";
                        document.getElementById(width).disabled = true;
                        document.getElementById(width).value = "";
                        document.getElementById(size).value = "";
                        document.getElementById(size).disabled = false;
                        if (document.getElementById(filename) != null)
                            document.getElementById(filename).value = "";
                    }
                    else {
                        par1.all[height].style.backgroundColor = "Gray";
                        par1.all[noofcol].style.backgroundColor = "Gray";
                        par1.all[noofcol].disabled = true;
                        par1.all[noofcol].value = "";
                        par1.all[height].disabled = true;
                        par1.all[height].value = "";
                        par1.all[width].style.backgroundColor = "Gray";
                        par1.all[width].disabled = true;
                        par1.all[width].value = "";
                        par1.all[size].value = "";
                        par1.all[size].disabled = false;
                        if (document.getElementById(filename) != null)
                            document.getElementById(filename).value = "";
                    }
                    i++;

                }
            }
        }
        else if (document.getElementById('hiddenuomdesc').value == "CD" || document.getElementById('hiddenuomdesc').value != "ROC" || document.getElementById('hiddenuomdesc').value != "ROL" || document.getElementById('hiddenuomdesc').value != "ROW" || document.getElementById('drpuom').value == "0" || document.getElementById('hiddenuomdesc').value == "ROD" || document.getElementById('hiddenuomdesc').value == "CD") {
            if (document.getElementById('siz') != null) {
                if (browser != "Microsoft Internet Explorer") {
                    document.getElementById('siz').textContent = "Size";
                }
                else {
                    document.getElementById('siz').innerText = "Size";
                }
            }
            ////////////////////////////this is to White out the height and width of insertion grid on rol and row
            var len = "bookdiv";
            if (document.getElementById(len) != null);
            {
                var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
                var i = 0;
                var k;
                var height;
                var width;
                var size;
                var filename;
                for (k = 0; i < y - 1; k++) {

                    height = "hei" + i;
                    width = "wid" + i;
                    size = "siz" + i;
                    filename = "fil" + i;
                    var height_vari = document.getElementById(height);
                    var par1 = (height_vari.parentNode).parentNode;
                    if (browser != "Microsoft Internet Explorer") {
                        document.getElementById(height).style.backgroundColor = "white";
                        document.getElementById(height).disabled = false;
                        document.getElementById(width).style.backgroundColor = "white";
                        document.getElementById(width).disabled = false;
                        document.getElementById(size).disabled = true;
                        if (document.getElementById(filename) != null)
                            document.getElementById(filename).value = "";
                    }
                    else {
                        par1.all[height].style.backgroundColor = "white";
                        par1.all[height].disabled = false;
                        par1.all[width].style.backgroundColor = "white";
                        par1.all[width].disabled = false;
                        par1.all[size].disabled = true;
                        if (document.getElementById(filename) != null)
                            document.getElementById(filename).value = "";
                    }
                    i++;

                }
            }
        }




    }
    /*new change ankur 22 feb*/
    /*this to fill the logo uom fields*/
    gblogowithmatter = ds.Tables[0].Rows[0].Logo;
    gblogowithmatter = "no";
    ////////////////////////////////////

    document.getElementById('txtcardrate').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    //return false;


}


////this function fills the rate into grid




function formatDecimal(argvalue, addzero, decimaln) {
    var numOfDecimal = (decimaln == null) ? 2 : decimaln;
    var number = 1;

    number = Math.pow(10, numOfDecimal);

    argvalue = Math.round(parseFloat(argvalue) * number) / number;
    // If you're using IE3.x, you will get error with the following line.
    // argvalue = argvalue.toString();
    // It works fine in IE4.
    argvalue = "" + argvalue;

    if (argvalue.indexOf(".") == 0)
        argvalue = "0" + argvalue;

    if (addzero == true) {
        if (argvalue.indexOf(".") == -1)
            argvalue = argvalue + ".";

        while ((argvalue.indexOf(".") + 1) > (argvalue.length - numOfDecimal))
            argvalue = argvalue + "0";
    }

    return argvalue;
}

/////this is to fill the rol or row into the insertion grid if it is visibile
function fillnooflineintogrid() {

    //////if uom is cd and booking is on no. of column and total area in that case if the user fill only no of column and 
    //////total area than hei and wid comes automatically
    if (document.getElementById('drpuom').value == "0") {
        alert("Please select uom");
        document.getElementById('drpuom').focus();
        return false;

    }
    if (document.getElementById('hiddenuomdesc').value == "CD") {



        if (glob_area != "") {
            if (parseFloat(document.getElementById('txttotalarea').value) > parseFloat(glob_area)) {
                alert("Total area exceeds with edition area");
                return false;
            }
        }


        if (document.getElementById('txtcolum').value != "") {
            var totare = document.getElementById('txttotalarea').value
            var wid = document.getElementById('txtadsize2').value
            document.getElementById('txtadsize1').value = formatDecimal(parseFloat(totare) / parseFloat(wid), true, 2);
        }
        else if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtadsize2').value == "") {
            var h_ = document.getElementById('txtadsize1').value
            var area_ = document.getElementById('txttotalarea').value
            document.getElementById('txtadsize2').value = formatDecimal(parseFloat(area_) / parseFloat(h_), true, 2);
        }
        else if (document.getElementById('txtadsize2').value != "" && document.getElementById('txtadsize1').value == "") {
            var w_ = document.getElementById('txtadsize2').value
            var area_ = document.getElementById('txttotalarea').value
            document.getElementById('txtadsize1').value = formatDecimal(parseFloat(area_) / parseFloat(w_), true, 2);
        }

    }

    var len = "bookdiv";
    if (document.getElementById('tblinsert').innerHTML != "") {
        var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
    }
    var k;
    var i = 0;
    var width;
    var noofcol;
    var height;
    var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
    if (document.getElementById('tblinsert').innerHTML != "") {
        for (k = 0; k < y; k++) {


            while (document.getElementById("card" + i) == null) {
                i = i + totid;

            }

            size = "siz" + i;
            width = "wid" + i;
            noofcol = "nocol" + i;
            height = "hei" + i;
            document.getElementById(size).value = document.getElementById('txttotalarea').value;
            document.getElementById(width).value = document.getElementById('txtadsize2').value;
            document.getElementById(height).value = document.getElementById('txtadsize1').value;
            document.getElementById(noofcol).value = document.getElementById('txtcolum').value;

            i++;

        }


    }
    var adcat = document.getElementById('drpadcategory').value;
    var adscat = document.getElementById('drpadsubcategory').value;
    var uomchk = document.getElementById('drpuom').value;
    var linesword = document.getElementById('txttotalarea').value;
    var curr = document.getElementById('hiddencurrency').value;
    //document.getElementById('droratecode').value
    //new change ankur 27 feb*/
    var ratecode = document.getElementById('txtratecode').value;
    //var ratecode=document.getElementById('txtratecode').value;
    var insertsno = document.getElementById('txtinsertion').value;
    //////////////this code is to split the code as well as ites description 

    var objpack = document.getElementById('drppackagecopy');


    if (document.getElementById('txtgrossamt').value != "") {
        // gettherate();

    }

}

///this is to calculate the 


function getpageamt() {
    var pagename = document.getElementById('Hiddendrppageposition').value;
    var compcode = document.getElementById('hiddencompcode').value;
    if (pagename == "0") {
        //
        document.getElementById('Hiddentxtpageamt').value = "";
    }
    QBC.getpageamount(pagename, compcode, call_getpageamt);

}

function call_getpageamt(res) {
    var ds = res.value;
    if (ds.Tables[0].Rows.length > 0) {
        document.getElementById('Hiddentxtpageamt').value = ds.Tables[0].Rows[0].Amount



    }
    if (document.getElementById('tblinsert').innerHTML != "") {
        flagins = "0";
    }
    if (document.getElementById('txtgrossamt').value != "") {
        //   gettherate();
    }

}

///////this function is to get the auto generated code 
function getboxno() {
    if (document.getElementById('drpboxcodenew').value == "0") {
        document.getElementById('txtboxnonew').value = "";
        document.getElementById('txtboxchrg').value = "";
        document.getElementById('txtboxadd').value = "";
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txttotalamt').value = "";
        document.getElementById('txttotalarea').value = "";
        document.getElementById('hiddenLineCount').value = "";
        //        document.getElementById('txtkeyno').value = "";
        var len = "bookdiv";
        var c = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
        for (var k = 0; k < c - 1; k++) {
            var siz = "siz" + k;
            var filename = "fil" + i;
            document.getElementById(siz).value = "";

        }
        return false;
    }
    document.getElementById('txttotalarea').value = "";
    document.getElementById('hiddenLineCount').value = "";
    if (document.getElementById('drppackagecopy').options.length <= 0) {
        alert("Please select the package");
        document.getElementById('drpboxcodenew').value = "0";
        document.getElementById('drppackage').focus();
        return false;
    }
    var branchname = document.getElementById('hiddenbranch').value;
    if (branchname == "") {
        branchname = document.getElementById('txtagency').value;
    }
    branchname = branchname.substring(0, 2)
    var branch = document.getElementById('drpboxcodenew').value;

    if (branch == "0" && boxpercen != "") {

        //            document.getElementById('txtbillamt').value=parseFloat(amtbill)-(parseFloat(amtbill)*parseFloat(boxpercen))/100
        document.getElementById('txtboxno').value = "";
        //getagrredamou();

    }

    if (branch != "0" && branch != "") {
        QBC.getboxnovalue(document.getElementById('hiddencompcode').value, branchname, branch, "A", call_getvalbox);
    }
    return false;

}
function call_getvalbox(res) {
    var ds = res.value;
    var count = "0";
    var branchname = document.getElementById('hiddenbranch').value;
    if (branchname == "") {
        branchname = document.getElementById('txtagency').value;
    }
    branchname = branchname.substring(0, 2)
    if (ds.Tables[0].Rows.length > 0 && ds.Tables[0].Rows[0].boxno != null && ds.Tables[0].Rows[0].boxno != "") {
        var boxval = ds.Tables[0].Rows[0].boxno;
        var cou = parseInt(boxval);
        cou++;
        document.getElementById('txtboxnonew').value = boxval;
        document.getElementById('hiddenboxno').value = boxval;
        //boxgamt=globalgross;
        //boxbill=globalbill;

    }
    else {
        document.getElementById('txtboxnonew').value = branchname + count;
        document.getElementById('hiddenboxno').value = branchname + cou;
    }
    if (document.getElementById('txtkeyno').value == "")
        document.getElementById('txtkeyno').value = document.getElementById('txtboxnonew').value;
    if (ds.Tables[2].Rows.length > 0) {
        if (ds.Tables[2].Rows[0].BOXADDRESS != "" && ds.Tables[2].Rows[0].BOXADDRESS != null) {
            document.getElementById('txtboxadd').value = ds.Tables[2].Rows[0].BOXADDRESS;
            document.getElementById('hiddenboxadd').value = ds.Tables[2].Rows[0].BOXADDRESS;
        }
        else {
            document.getElementById('txtboxadd').value = document.getElementById('hiddenboxadd').value
        }
    }


    //var amtbill=document.getElementById('txtcardrate').value
    //var per=ds.Tables[1].Rows[0].Box_Charges_Native;
    //perbox=ds.Tables[1].Rows[0].Box_Charges_Native;
    document.getElementById('txtboxchrg').value = ds.Tables[1].Rows[0].Box_Charges_Native;
    document.getElementById('hiddenboxchrgtype').value = ds.Tables[1].Rows[0].Box_Charges_Type;
    // document.getElementById('txtgrossamt').value=parseFloat(amtgross)+(parseFloat(amtgross)*parseFloat(per))/100
    // document.getElementById('txtbillamt').value=parseFloat(amtbill)+(parseFloat(amtbill)*parseFloat(per))/100
    //getagrredamou();
    var amtgross = document.getElementById('txtgrossamt').value;
    if (amtgross != "") {
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txttotalamt').value = "";
    }
    if (document.getElementById('txtgrossamt').value == "NaN") {
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txttotalamt').value = "";
    }




    var len = "bookdiv";
    var c = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    for (var k = 0; k < c - 1; k++) {
        var siz = "siz" + k;
        var filename = "fil" + i;
        document.getElementById(siz).value = "";

    }
    //boxpercen=ds.Tables[1].Rows[0].Box_Charges_Native;



}


//this is to save the insertion lines into the database

function saveinsertion() {
    var len = "bookdiv";
    var insertno;
    var premid;
    var premper;
    var colid;
    var heightid;
    var widthid;
    var size;
    var late;
    //var uomid;
    //var adtypid;
    var cardid;
    var editid;
    var solorate;
    var premper1;
    var prem1id;
    var namecode;
    var inserts;
    var pagepost;
    var preall;
    var adcat;
    var adsubcat;
    var matsta;
    var filename;
    var discrate;
    var insertsta;
    var billstat;
    var id;
    var repeat;
    var i = 0;
    var paid;
    var agrred;
    var solo;
    var gross;
    var insert = "0";
    var pageno_inserts;
    var remark_inserts;
    var page;
    var pageprem;
    var noofcol;
    var billamt;
    var billrate;
    var pkginsgrid_value;
    var pkg_alias_value;
    var clicatamtval;
    var GSTAMT;
    var GSTGD;
    var compcode = document.getElementById('hiddencompcode').value;
    var userid = document.getElementById('hiddenuserid').value;
    var cioid = document.getElementById('hiddencioid').value;
    //var y=document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
    //var y=parseInt(noofinsert)   
    /*new change ankur 23 feb8*/
    //if the uom is logo than we have to save this also otherwise it goes blank  gblogowithmatter
    var logo_h;
    var logo_w;
    var logo_name;
    var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;

    var k;
    var dateformat = document.getElementById('hiddendateformat').value;
    var adcat4 = document.getElementById("hiddenadscat4");
    var adcat5 = document.getElementById("hiddenadscat5");
    var adcat3 = document.getElementById("hiddenadscat3");
    var subcat = document.getElementById("hiddenad_subcat");
    var catcode = document.getElementById("hiddencatcode");
    var uomdesc = document.getElementById('hiddenuomdesc');

    for (k = 0; k < y; k++) {



        var splboldsize = "splboldsize" + i;
        var splboldsizevalue = "";
        id = "Text" + i;
        var spltdata = "spltdata" + i;
        var subedi = "subedidata" + i;
        var id_vari = document.getElementById(id);
        var par1 = (id_vari.parentNode).parentNode;
        editid = "edit" + i;
        // premid="prem"+i;
        // prem1id="premone"+i;
        colid = "col" + i;
        heightid = "hei" + i;
        widthid = "wid" + i;
        size = "siz" + i;
        pagepost = "pagpos" + i;
        namecode = "one";
        // premper="premper"+i;
        //  premper1="premperone"+i;
        //adtypid="adtyp"+i;
        namecode = "two";
        preall = "preall" + i;
        adcat = "adcat" + i;
        late = "lat" + i;
        matsta = "mat" + i;
        cardid = "card" + i;
        filename = "fil" + i;
        discrate = "disrat" + i;
        insertsta = "inssta" + i;
        billstat = "bill" + i;
        adsubcat = "ads" + i;
        repeat = "rep" + i;
        insertno = "ins" + i;
        paid = "pai" + i
        agrred = "agr" + i;
        solo = "sol" + i;
        gross = "gro" + i;
        pageno_inserts = "pagno" + i; ;
        remark_inserts = "rem" + i;
        page = "pgpre" + i;
        pageprem = "pagper" + i;
        noofcol = "nocol" + i;
        billamt = "ba" + i;
        billrate = "br" + i;
        adcat3 = "adscat3" + i;
        adcat4 = "adscat4" + i;
        adcat5 = "adscat5" + i;
        /*new change ankur 23 feb*/
        logo_h = "lh" + i;
        logo_w = "lw" + i;
        logo_name = "lnam" + i;
        clicatamtval = "clicatamt" + i;
        var pkgcodegrid = "hiddenpckcode" + i;

        var pkg_ins = "pkg_ins" + i;

        var pkg_alias = "pkg_alias" + i;
        GSTAMT = "GSTAMT" + i;
        GSTGD = "GSTGD" + i;
        /*new change ankur 23 feb*/
        var logohei = "";
        var logowid = "";
        var logonam = "";
        var gstamount="";
        var gstgrid="";
        gblogowithmatter = "no";
        if (gblogowithmatter == "yes" || uomdesc.value == "ROD") {
            if (browser != "Microsoft Internet Explorer") {
                logohei = document.getElementById(logo_h).value;
                logowid = document.getElementById(logo_w).value;
                logonam = document.getElementById(logo_name).value;
            }
            else {
                logohei = par1.all[logo_h].value;
                logowid = par1.all[logo_w].value;
                logonam = par1.all[logo_name].value;
            }
        }

        /////////////////////////////
        var insernum = "";
        var insertdate = "";
        var edition = "";
        var height = "";
        var width = "";
        var color = "";
        var premallow = "";
        var adcategory = "";
        var latestdate = "";
        var material = "";
        var cardrate = "";
        var filenamevalue = "";
        var discrate = "";
        var insertstatus = "";
        var billstatus = "";
        var adsubcat = "";
        var repdate = "";
        var paidins = "";
        var insagreedrate = "";
        var inssolo = "";
        var grossrate = "";
        var insert_pageno = "";
        var insert_remark = "";
        var page_code = "";
        var page_per = "";
        var no_ofcol = "";
        var bill_amt = "";
        var bill_rate = "";
        var splitdata = "";
        var subedidata = "";
        var pkgcodegrid_value = "";
        if (browser != "Microsoft Internet Explorer") {
            splboldsizevalue = document.getElementById(splboldsize).value;
            if (document.getElementById(spltdata) != null) {
                splitdata = document.getElementById(spltdata).value;
            }
            if (document.getElementById(subedi) != null) {
                subedidata = document.getElementById(subedi).value;
            }
            if (document.getElementById(insertno) != null) {
                insernum = document.getElementById(insertno).innerHTML;
            }
            if (document.getElementById(id) != null) {
                insertdate = document.getElementById(id).value;
            }
            if (document.getElementById(editid) != null) {
                edition = document.getElementById(editid).value;
            }
            var premium1 = "0"//document.getElementById(premid).value;
            var premium2 = "0"//document.getElementById(prem1id).value;
            if (document.getElementById(heightid) != null) {
                height = document.getElementById(heightid).value;
            }
            if (document.getElementById(widthid) != null) {
                width = document.getElementById(widthid).value;
            }
            var totalsize = document.getElementById(size).value;
            //var pagepost=0;
            if (document.getElementById(pagepost) != null) {
                pagepost = document.getElementById(pagepost).value;
            }
            else {
                pagepost = "0";
            }
            if (document.getElementById(colid) != null) {
                color = document.getElementById(colid).value;
            }
            else {
                color = document.getElementById('drpcolor').value;
            }
            var premper11 = "0"//document.getElementById(premper).value;
            var premper2 = "0"//document.getElementById(premper1).value;
            if (document.getElementById(preall) != null) {
                premallow = document.getElementById(preall).value;
            }
            if (document.getElementById(adcat) != null) {
                adcategory = document.getElementById(adcat).value;
            }
            else {
                adcategory = catcode.value
            }
            if (document.getElementById(late) != null) {
                latestdate = document.getElementById(late).value;
            }
            if (document.getElementById(matsta) != null) {
                material = document.getElementById(matsta).value;
            }
            if (document.getElementById(cardid).value != null) {
                cardrate = document.getElementById(cardid).value;
            }
            if (document.getElementById(filename) != null) {
                filenamevalue = document.getElementById(filename).value;
            }
            if (document.getElementById(discrate) != null) {
                discrate = document.getElementById(discrate).value;
            }
            if (document.getElementById(insertsta) != null) {
                insertstatus = document.getElementById(insertsta).value;
            }
            if (document.getElementById(billstat) != null) {
                billstatus = document.getElementById(billstat).value;
            }
            if (document.getElementById(adsubcat) != null) {
                adsubcat = document.getElementById(adsubcat).value;
            }
            else {
                adsubcat = subcat.value;
            }
            if (document.getElementById(repeat) != null) {
                repdate = document.getElementById(repeat).value;
            }
            if (document.getElementById(paid) != null) {
                paidins = document.getElementById(paid).value;
            }
            if (document.getElementById(agrred) != null) {
                insagreedrate = document.getElementById(agrred).value;
            }
            if (document.getElementById(solo) != null) {
                inssolo = document.getElementById(solo).value;
            }
            if (document.getElementById(gross) != null) {
                grossrate = document.getElementById(gross).value;
            }
            if (document.getElementById(pageno_inserts) != null) {
                insert_pageno = document.getElementById(pageno_inserts).value;
            }
            if (document.getElementById(remark_inserts) != null) {
                insert_remark = document.getElementById(remark_inserts).value;
            }
            if (document.getElementById(page) != null) {
                page_code = document.getElementById(page).value;
            }
            if (document.getElementById(pageprem) != null) {
                page_per = document.getElementById(pageprem).value;
            }
            if (document.getElementById(noofcol) != null) {
                no_ofcol = document.getElementById(noofcol).value;
            }
            if (document.getElementById(billamt) != null) {
                bill_amt = document.getElementById(billamt).value;
            }
            if (document.getElementById(billrate) != null) {
                bill_rate = document.getElementById(billrate).value;
            }

            var adcat3value = "";
            var adcat4value = "";
            var adcat5value = "";

            if (document.getElementById(adcat3) != null) {
                adcat3value = document.getElementById(adcat3).value;
            }
            else {
                adcat3value = document.getElementById('drpadcat3').value;
            }

            if (document.getElementById(adcat4) != null) {
                adcat4value = document.getElementById(adcat4).value;
            }
            else {
                adcat4value = document.getElementById('drpadcat4').value;
            }

            if (document.getElementById(adcat5) != null) {
                adcat5value = document.getElementById(adcat5).value;
            }
            else {
                adcat5value = document.getElementById('drpadcat5').value;
            }

            if (document.getElementById(pkgcodegrid) != null) {
                pkgcodegrid_value = document.getElementById(pkgcodegrid).value;
            }

            if (document.getElementById(pkg_ins) != null) {
                pkginsgrid_value = document.getElementById(pkg_ins).value;
            }

            if (document.getElementById(pkg_alias) != null) {
                pkg_alias_value = document.getElementById(pkg_alias).value;
            }
            var clicatamt = document.getElementById(clicatamtval).value;
            if (document.getElementById(GSTAMT) != null) {
                gstamount = document.getElementById(GSTAMT).value;
            }
            if (document.getElementById(GSTGD) != null) {
                gstgrid = document.getElementById(GSTGD).value;
            }
        }
        else {
            splboldsizevalue = par1.all[splboldsize].value;
            if (par1.all[spltdata] != null) {
                splitdata = par1.all[spltdata].value;
            }
            if (par1.all[subedi] != null) {
                subedidata = par1.all[subedi].value;
            }

            if (par1.all[insertno] != null) {
                insernum = par1.all[insertno].innerHTML;
            }
            if (par1.all[id] != null) {
                insertdate = par1.all[id].value;
            }
            if (par1.all[editid] != null) {
                edition = par1.all[editid].value;
            }
            var premium1 = "0"//document.getElementById(premid).value;
            var premium2 = "0"//document.getElementById(prem1id).value;
            if (par1.all[heightid] != null) {
                height = par1.all[heightid].value;
            }
            if (par1.all[widthid] != null) {
                width = par1.all[widthid].value;
            }
            var totalsize = par1.all[size].value;
            //var pagepost=0;
            if (par1.all[pagepost] != null) {
                pagepost = par1.all[pagepost].value;
            }
            else {
                pagepost = "0";
            }
            if (par1.all[colid] != null) {
                color = par1.all[colid].value;
            }
            var premper11 = "0"//document.getElementById(premper).value;
            var premper2 = "0"//document.getElementById(premper1).value;
            if (par1.all[preall] != null) {
                premallow = par1.all[preall].value;
            }
            if (par1.all[adcat] != null) {
                adcategory = par1.all[adcat].value;
            }
            else {
                adcategory = catcode.value
            }
            if (par1.all[late] != null) {
                latestdate = par1.all[late].value;
            }
            if (par1.all[matsta] != null) {
                material = par1.all[matsta].value;
            }
            if (par1.all[cardid].value != null) {
                cardrate = par1.all[cardid].value;
            }
            if (par1.all[filename] != null) {
                filenamevalue = par1.all[filename].value;
            }
            if (par1.all[discrate] != null) {
                discrate = par1.all[discrate].value;
            }
            if (par1.all[insertsta] != null) {
                insertstatus = par1.all[insertsta].value;
            }
            if (par1.all[billstat] != null) {
                billstatus = par1.all[billstat].value;
            }
            if (par1.all[adsubcat] != null) {
                adsubcat = par1.all[adsubcat].value;
            }
            else {
                adsubcat = subcat.value;
            }
            if (par1.all[repeat] != null) {
                repdate = par1.all[repeat].value;
            }
            if (par1.all[paid] != null) {
                paidins = par1.all[paid].value;
            }
            if (par1.all[agrred] != null) {
                insagreedrate = par1.all[agrred].value;
            }
            if (par1.all[solo] != null) {
                inssolo = par1.all[solo].value;
            }
            if (par1.all[gross] != null) {
                grossrate = par1.all[gross].value;
            }
            if (par1.all[pageno_inserts] != null) {
                insert_pageno = par1.all[pageno_inserts].value;
            }
            if (par1.all[remark_inserts] != null) {
                insert_remark = par1.all[remark_inserts].value;
            }
            if (par1.all[page] != null) {
                page_code = par1.all[page].value;
            }
            if (par1.all[pageprem] != null) {
                page_per = par1.all[pageprem].value;
            }
            if (par1.all[noofcol] != null) {
                no_ofcol = par1.all[noofcol].value;
            }
            if (par1.all[billamt] != null) {
                bill_amt = par1.all[billamt].value;
            }
            if (par1.all[billrate] != null) {
                bill_rate = par1.all[billrate].value;
            }

            var adcat3value = "";
            var adcat4value = "";
            var adcat5value = "";

            if (par1.all[adcat3] != null) {
                adcat3value = par1.all[adcat3].value;
            }
            else {
                adcat3value = document.getElementById('drpadcat3').value;
            }

            if (par1.all[adcat4] != null) {
                adcat4value = par1.all[adcat4].value;
            }
            else {
                adcat4value = document.getElementById('drpadcat4').value;
            }

            if (par1.all[adcat5] != null) {
                adcat5value = par1.all[adcat5].value;
            }
            else {
                adcat5value = document.getElementById('drpadcat5').value;
            }

            if (par1.all[pkgcodegrid] != null) {
                pkgcodegrid_value = par1.all[pkgcodegrid].value;
            }

            if (par1.all[pkg_ins] != null) {
                pkginsgrid_value = par1.all[pkg_ins].value;
            }

            if (par1.all[pkg_alias] != null) {
                pkg_alias_value = par1.all[pkg_alias].value;
            }
            var clicatamt = par1.all[clicatamtval].value;
            if (par1.all[GSTAMT] != null) {
                gstamount = par1.all[GSTAMT].value;
            }
            if (par1.all[GSTGD] != null) {
                gstgrid = par1.all[GSTGD].value;
            }
        }

        /*new change ankur 23 feb*/
        // for logo
        var logohei = "";
        var logowid = "";
        var logonam = "";
        if (document.getElementById('logohei' + i) != null)
            logohei = document.getElementById('logohei' + i).value;
        if (document.getElementById('logowid' + i) != null)
            logowid = document.getElementById('logowid' + i).value;
        if (document.getElementById('logonam' + i) != null)
            logonam = document.getElementById('logonam' + i).value;
        if (cioid == "") {
            alert("Booking Id can't be blank");
            return false;
        }
        /////////////////////add anuja eyecather
        var eyecath = "";
        if (document.getElementById('eye_cather' + i) != null) {
            eyecath = document.getElementById('eye_cather' + i).value;
        }
        ////////////////////day wise premium
        var dayprim = "";
        if (document.getElementById('hdnday_prim' + i) != null) {
            dayprim = document.getElementById('hdnday_prim' + i).value;
        }
        //        if (filenamevalue != "")
        //            filenamevalue = filenamevalue.replace(cioid, document.getElementById('txtreceipt').value);
        var res = QBC.insertinsertion(insertdate, edition, premium1, premium2, premallow, adcategory, latestdate, material, cardrate, filenamevalue, discrate, insertstatus, billstatus, adsubcat, compcode, userid, cioid, height, width, totalsize, pagepost, premper11, premper2, color, repdate, insernum, paidins, insagreedrate, inssolo, grossrate, insert, insert_pageno, insert_remark, page_code, page_per, no_ofcol, bill_amt, bill_rate, logohei, logowid, logonam, dateformat, adcat3value, adcat4value, adcat5value, pkgcodegrid_value, pkginsgrid_value, pkg_alias_value, splitdata, subedidata, splboldsizevalue, document.getElementById('vat' + i).value, document.getElementById('vat_inc' + i).value, clicatamt, "", "", "", "", eyecath, dayprim,gstamount,gstgrid);
        if (res.error != null) {
            alert(res.error.description);
            QBC.rollback(cioid);
            return false;
        }
        if (res.value != "") {
            alert(res.value.toString());
            QBC.rollback(cioid);
            return false;
        }
        i = i + 1;
    }
    var sta = "";
    var pcentname = document.getElementById('hiddencenter').value;
    pcentname = pcentname.substring(0, 3);
    var idformat = document.getElementById('hiddencioidformat').value;
    var adtype1 = document.getElementById('drpadtype').value;
    ///////////////add for payment gateway
    if (document.activeElement.id == "btnpaygateway") {
    if(document.getElementById('hdndepo').value=="depo")
    {
        var paymentflag = document.getElementById('hdndepo').value;
    }
    }
else {
    var paymentflag ="";
    }
var ressta = QBC.commit(document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1, cioid, compcode, pcentname, userid, idformat, adtype1, paymentflag);

    if (ressta.error != null) {
        alert(ressta.error.description);
        //Booking_master.rollback(cioid);
        return false;
    }

    if (document.getElementById('hdndepo').value == "center") {

        //document.getElementById('txtagency').value = "";

    }
    else {
        document.getElementById('txtagency').value = document.getElementById('hidagencyname').value;
    }
    //       return false;
    //       
    sta = ressta.value.split('$~$')[0];
    mainbookingid = ressta.value.split('$~$')[1];
    QBC.savelogin_dj(mainbookingid);
    document.getElementById('tblinsert').innerHTML = ""


    //    
    //        document.getElementById('tblrate').style.display="none";
    //		document.getElementById('tblbill').style.display="none";
    //		//document.getElementById('tblsize').style.display="none";
    //		document.getElementById('addetails').style.display="none";
    //		document.getElementById('pagedetail').style.display="none";
    //		document.getElementById('tblpackage').style.display="none";   
    //		document.getElementById('tbbox').style.display="none";
    //		document.getElementById('txtciobookid').value="";
    document.getElementById('txtciobookid').value = mainbookingid;
    document.getElementById('hiddencioid').value = mainbookingid;
    //		document.getElementById('LinkButton1').disabled=true;
    //		document.getElementById('LinkButton2').disabled=true;
    //		document.getElementById('LinkButton3').disabled=true;
    //		document.getElementById('LinkButton4').disabled=true;
    //		document.getElementById('LinkButton5').disabled=true;
    //		document.getElementById('LinkButton6').disabled=true;
    //		document.getElementById('LinkButton7').disabled=true;
    var flagrate;
    ////////////////

    noofinsert = "";
    noofinsertlo = "";
    rowwhenupdate = "";
    fillinsert = "";
    insertval = "";
    boxpercen = "";
    boxgamt;
    boxbill;
    glspedisc = "0";
    glspadisc = "0";
    glspeccharge = "0";
    glpre = "0";
    savtotid;
    getid = "";
    countgridloop = "";
    schemediscount = "";
    subtractrow = "0";
    //if (prevcioidformatter == "" || prevcioidformatter == null)
    var curr_cio_id = mainbookingid;
    //else
    //    var curr_cio_id = prevcioidformatter;
    //*********************************By Manish Verma****************************************
    if (browser != "Microsoft Internet Explorer") {
        var httpRequest = null; ;
        httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml');
        }

        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

        httpRequest.open("GET", "insertMatter.aspx?FORMNAME=QBC&receipt=" + document.getElementById('hiddenreceiptno').value + "&tempbkid=" + cioid + "&modify=0&currcioid=" + curr_cio_id, false); //document.getElementById('hiddenreceiptno').value
        httpRequest.send('');
        //alert(httpRequest.readyState);
        if (httpRequest.readyState == 4) {
            //alert(httpRequest.status);
            if (httpRequest.status == 200) {
                //strtext=httpRequest.responseText;
            }
            else {
                alert('There was a problem with the request.');
            }
        }
    }
    else {

        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        xml.Open("GET", "insertMatter.aspx?FORMNAME=QBC&receipt=" + document.getElementById('hiddenreceiptno').value + "&tempbkid=" + cioid + "&modify=0&currcioid=" + curr_cio_id, false);
        xml.Send();
    }

    /////////////////add by anuja payment type
    if (document.getElementById('hdndepo').value != "depo") {
        var res = QBC.getreciept(document.getElementById('hiddencompcode').value, document.getElementById('txtciobookid').value);
        if (res.error != null) {
            alert(res.error.description);
        }
        if (res.value.Tables[0].Rows[0].Receipt_no != null && res.value.Tables[0].Rows[0].Receipt_no != "null")
            var reciept11 = res.value.Tables[0].Rows[0].Receipt_no;
        else
            reciept11 = "";
        printreceiptQBC(reciept11, document.getElementById('txtciobookid').value);
        //insertcashdetailQBC(document.getElementById('txtciobookid').value, "btnsavepay", document.getElementById('drppaymenttype').value);
    }
    /////////////////////end
    if (document.getElementById("hdnbutton").value == "btnsavepay") {
        var btnsave1 = "btnsavepay";
        var cioid = document.getElementById('txtciobookid').value;
        window.open('cash_rcptformult.aspx?paymode=' + document.getElementById('drppaymenttype').value + '&filename=bookdiv' + "&ciobookid123=" + cioid + "&idofbutton=" + document.getElementById("hdnbutton").value, '', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=0,left=0,width=1000px,height=900px');


    }




    document.getElementById('txtreceipt').value = "";
    if (document.getElementById('configclient').value == "SP") {
        message = "Data Saved Successfully with Reference ID " + document.getElementById('txtciobookid').value;
    }

    else {
        ///////////////////add for getway//////////////
        if (document.getElementById('hdndepo').value == "depo") {
            message = "Data Saved Successfully with RO No " + document.getElementById('hiddenreceiptno').value + "and Continue the payment getway";
        }
        else {
        ////////////////////////////modify category
            if (hidcopymodicategory == "copy") {
                if (document.getElementById('configclient').value == "LOKMAT") {
                    message = "Data Saved Successfully with RO No " + document.getElementById('hdnrecnomod').value + "";
                }
                else {
                    message = "Data Saved Successfully with RO No " + document.getElementById('hiddenreceiptno').value + "";
                }
            }
            else {
                message = "Data Saved Successfully with RO No " + document.getElementById('hiddenreceiptno').value + "";
            }
        }
    }

    // message = "Value saved";
    alert(message);
    ///////////////////add for getway//////////////
    if (document.getElementById('hdndepo').value == "depo") {
//        var Ro_no = document.getElementById('hiddenreceiptno').value;
//        var netamount = document.getElementById('txtgrossamt').value;
//        var name = document.getElementById('txtclient').value;
//        var adderess = document.getElementById('txtclientadd').value;
//        var city = ""; //document.getElementById('txtclientadd').value;
//        var state = ""; // document.getElementById('txtclientadd').value;
//        var country = ""; //  document.getElementById('txtclientadd').value;
//        var mobile = document.getElementById('txtMobile').value;
//        var email = ""; //  document.getElementById('txtMobile').value;
//        QBC.setSessionmis_paymenygetway(Ro_no,netamount,name,adderess,city,state,country,mobile,email)
        window.open('payment_gatewayprev.aspx');
    }


    //****************************************************************************************   
    // return false;


}

function checkValidation(idofbutton) {
    document.getElementById("hdnbutton").value = idofbutton;

    var chmandat = "";

    //    if (browser != "Microsoft Internet Explorer") {
    //        chmandat = document.getElementById('lbrono').textContent;
    //    }
    //    else {
    //        chmandat = document.getElementById('lbrono').innerText;
    //    }
    //    if (chmandat.indexOf('*') >= 0) {
    //       setvalueintorodate();
    //        }
    /*if (document.getElementById("drpbgcolor").value != "0" && (document.getElementById("Hiddendrppageposition").value == "" || document.getElementById("Hiddendrppageposition").value == "0")) {
    alert("Please Select Premium by clicking on Discount/Premium Button");
    document.getElementById("btndiscount").focus();
    return false;
    }*/
    /*if(document.getElementById("drpbgcolor").value!="0" && document.getElementById("drpbullet").value=="0")
    {
    alert("Please Select Eye Catcher Color") ;
    document.getElementById("drpbullet").focus();
    return false;
    
    }*/
    if (clientfromconfig == "RP") {
        if (document.getElementById("drpbullet").value == "EY7" || document.getElementById("drpbullet").value == "BO3" || document.getElementById("drpbullet").value == "EY6" || document.getElementById("drpbullet").value == "EY5" || document.getElementById("drpbullet").value == "OU1" || document.getElementById("drpbullet").value == "BO2" || document.getElementById("drpbullet").value == "EY3" || document.getElementById("drpbullet").value == "CO0")
            if (document.getElementById("drpbgcolor").value == "0") {
                alert("Please Select Background Color for Colored Eye Catcher");
                document.getElementById("drpbgcolor").focus();
                return false;
            }
    }
    if (document.getElementById('txtbranch').value == "" || document.getElementById('txtbranch').value == "0") {
        alert("Please Select Branch");
        document.getElementById('txtbranch').focus();
        return false;
    }
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbagency').textContent;
    }
    else {
        chmandat = document.getElementById('lbagency').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtagency').value == "") {
            alert("Please Fill The Agency");
            document.getElementById('txtagency').focus();
            return false;
        }
    }
    var res = chkmaincodeAgency("agency");
    if (res == false)
        return false;
    // for client

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbclient').textContent;
    }
    else {
        chmandat = document.getElementById('lbclient').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtclient').value == "" || document.getElementById('txtclient').value == "0") {
            alert("Please Enter Client");
            document.getElementById('txtclient').focus();
            return false;
        }
    }
    // for mobile no
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbmobileno').textContent;
    }
    else {
        chmandat = document.getElementById('lbmobileno').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtMobile').value == "") {
            alert("Please Enter Mobile No.");
            document.getElementById('txtMobile').focus();
            return false;
        }
        else if (document.getElementById('txtMobile').value.length < 10) {
            alert("Mobile Length is 10 digit.");
            document.getElementById('txtMobile').focus();
            return false;
        }
    }
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbrono').textContent;
    }
    else {
        chmandat = document.getElementById('lbrono').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtrono').value == "") {
            alert("Please Enter RO NO.");
            document.getElementById('txtrono').focus();
            return false;
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbrodate').textContent;
    }
    else {
        chmandat = document.getElementById('lbrodate').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtrodate').value == "") {
            alert("Please Enter RO Date.");
            //            document.getElementById('txtrodate').focus();
            return false;
        }
    }
    // for adcategory
    if (document.getElementById('drpadcategory').value == "0") {
        alert("Please Select Ad Categories");
        document.getElementById('drpadcategory').focus();
        return false;
    }
    // for subcategory
    //if (document.getElementById('drpadsubcategory').options.length > 1 && document.getElementById('drpadsubcategory').value == "0") {
    //    alert("Please Select 2nd level Category");
    //    document.getElementById('drpadsubcategory').focus();
    //    return false;
    //}
    //// for 3rd levle category
    //if (document.getElementById('drpadcat3').options.length > 1 && document.getElementById('drpadcat3').value == "0") {
    //    alert("Please Select 3rd level Category");
    //    document.getElementById('drpadcat3').focus();
    //    return false;
    //}   
    if (document.getElementById('drpadtype').value == "0" || document.getElementById('drpadtype').value == "") {
        alert("Please Select Ad Type");
        if (document.getElementById('drpadtype').disabled == false)
            document.getElementById('drpadtype').focus();
        return false;
    }
    // package and UOm
    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbpackage').textContent;
    }
    else {
        chmandat = document.getElementById('lbpackage').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {

        if (document.getElementById('drppackagecopy').options.length == 0) {
            alert('Please Enter Package Details');
            document.getElementById('drppackage').focus();
            return false;
        }


    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbuom').textContent;
    }
    else {
        chmandat = document.getElementById('lbuom').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drpuom').value == "0") {
            alert('Please Enter UOM');

            document.getElementById('drpuom').focus();
            return false;
        }


    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbcolor').textContent;
    }
    else {
        chmandat = document.getElementById('lbcolor').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drpcolor').value == "0") {
            //alert('Please Enter '+(chmandat.replace('*', "")));
            alert('Please Enter color');

            document.getElementById('drpcolor').focus();
            return false;
        }

    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbselectdate').textContent;
    }
    else {
        chmandat = document.getElementById('lbselectdate').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtdummydate').value == "") {
            alert('Please Enter Date');


            document.getElementById('txtdummydate').focus();
            return false;
        }


    }

    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('lbnoofins').textContent;
    }
    else {
        chmandat = document.getElementById('lbnoofins').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('txtinsertion').value == "") {
            alert('Please Enter ' + (chmandat.replace('*', "")));


            document.getElementById('txtinsertion').focus();
            return false;
        }


    }

    if (document.getElementById('drpboxcodenew').value != "0" && document.getElementById('txtboxadd').value == "") {
        alert("Please fill Box Address");
        document.getElementById('txtboxadd').focus();
        return false;
    }


    if (browser != "Microsoft Internet Explorer") {
        chmandat = document.getElementById('drprostatus').textContent;
    }
    else {
        chmandat = document.getElementById('drprostatus').innerText;
    }
    if (chmandat.indexOf('*') >= 0) {
        if (document.getElementById('drprostatus').value == "0") {
            alert("Please Fill ro status");
            document.getElementById('drprostatus').focus();
            return false;
        }
    }

    if (document.getElementById('txtrono').value != "") {
        if (document.getElementById('txtrodate').value == "") {
            alert("Please fill RO date");
            document.getElementById('txtrodate').focus();
            return false;
        }


    }

    if (document.getElementById('txtrono').value != "") {
        if (document.getElementById('drprostatus').value == "0") {
            alert("Please Fill ro status");
            document.getElementById('drprostatus').focus();
            return false;
        }

    }

    if (document.getElementById('txtrodate').value != "") {
        if (document.getElementById('txtrono').value == "") {
            // alert("Please fill RO no");
            //document.getElementById('txtrono').focus();
            //return false;

        }


    }








    if (document.getElementById('hiddenuomdesc').value == "CD") {
        if (document.getElementById('txtadsize1').value == "") {
            alert('Please enter height');

            // document.getElementById('txtadsize1').focus();
            return false;
        }
        if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtadsize2').value == "") {
            if (document.getElementById('txtadsize2').value == "" || document.getElementById('txtcolum').value == "") {
                alert('Please enter width');

                // document.getElementById('txtadsize1').focus();
                return false;

            }
        }
    }
    else {
        if (document.getElementById('txttotalarea').value == "") {
            // alert('Please Enter Number of lines');
            alert("Please Upload Material");

            // document.getElementById('txtadsize1').focus();
            return false;
        }

    }


    if (document.getElementById('txtadsize1').disabled == true) {
        if (document.getElementById('txttotalarea').value == "") {
            alert('Please Enter Number of lines');

            // document.getElementById('txtadsize1').focus();
            return false;
        }
    }









    //


    if (document.getElementById('drpcoutype').value != "0" && document.getElementById('drpcoutype').value != "" && document.getElementById('txtcouno').value == "") {
        alert("Please Enter CPN No.");
        document.getElementById('txtcouno').focus();
        return false;
    }
    var rescou = QBC.chkCoupan(document.getElementById('hiddencompcode').value, document.getElementById('hiddencenter').value, document.getElementById('txtcouno').value);
    var dscou = rescou.value;
    if (dscou != null && dscou.Tables.length > 0 && dscou.Tables[0].Rows.length > 0 && chkbtnStatus == "new") {
        alert("Coupan Already Used With Reference No. " + dscou.Tables[0].Rows[0].CIO_BOOKING_ID);
        return false;
    }
    /////////////add by anuja for payment type
    if (document.getElementById('drppaymenttype').value == null || document.getElementById('drppaymenttype').value == "null" || document.getElementById('drppaymenttype').value == "" || document.getElementById('drppaymenttype').value == "0" || document.getElementById('drppaymenttype').value == "-Select-") {
        alert("Please Select Payment Type");
        document.getElementById('drppaymenttype').focus();
        return false;
    }
    //////////////////////////end
    if (c == "0") {
        alert("Please get the original rate");
        return false;
    }

    if (document.getElementById('txtcardrate').value == "" || document.getElementById('txtcardrate').value == "0") {
        alert("Please get the card rate");
        return false;
    }

    if (document.getElementById('txtgrossamt').value == "") {
        alert("Please get the gross amount");
        return false;
    }


    /////////////////////////this check is used to check from the main values that this pck exists or not
    var adtype = document.getElementById('drpadtype').value;
    var color = document.getElementById('drpcolor').value;
    var adcat = document.getElementById('drpadcategory').value;
    var adsucat = document.getElementById('drpadsubcategory').value;
    var currency = document.getElementById('hiddencurrency').value;
    //document.getElementById('droratecode').value
    //new change ankur 27 feb*/
    //       var ratecode = document.getElementById('txtratecode').value;
    var ratecode = document.getElementById('txtratecode').value;
    var package1 = document.getElementById('drppackage').value;
    var dateformat = document.getElementById('hiddendateformat').value;
    var uomvalue = document.getElementById('drpuom').value;
    var selecdate;
    if (document.getElementById('txtdummydate').value != "") {
        if (document.getElementById('hiddentypedatabase').value == "mysql") {
            if (dateformat == "mm/dd/yyyy") {

                var txt1 = document.getElementById('txtdummydate').value;
                var txt2 = txt1.split("/");
                var mm = txt2[0];
                var dd = txt2[1];
                var yy = txt2[2];
                selecdate = yy + '/' + mm + '/' + dd;
            }
            if (dateformat == "dd/mm/yyyy") {
                var txt1 = document.getElementById('txtdummydate').value;
                var txt2 = txt1.split("/");
                var dd = txt2[0];
                var mm = txt2[1];
                var yy = txt2[2];
                selecdate = yy + '/' + mm + '/' + dd;
            }
            if (dateformat == "yyyy/mm/dd") {

                selecdate = document.getElementById('txtdummydate').value;

            }
        }
        else if (document.getElementById('hiddentypedatabase').value == "orcl") {
            if (dateformat == "mm/dd/yyyy") {

                /* var txt1=document.getElementById('txtdummydate').value;
                var txt2=txt1.split("/");
                var mm=txt2[0];
                var dd=txt2[1];
                var yy=txt2[2];
                selecdate=dd+'/'+mm+'/'+yy;*/
                selecdate = document.getElementById('txtdummydate').value;
            }
            if (dateformat == "dd/mm/yyyy") {
                var txt1 = document.getElementById('txtdummydate').value;
                var txt2 = txt1.split("/");
                var dd = txt2[0];
                var mm = txt2[1];
                var yy = txt2[2];
                selecdate = dd + '/' + mm + '/' + yy;
            }
            if (dateformat == "yyyy/mm/dd") {

                //selecdate=document.getElementById('txtdummydate').value;
                var txt1 = document.getElementById('txtdummydate').value;
                var txt2 = txt1.split("/");
                var yy = txt2[0];
                var mm = txt2[1];
                var dd = txt2[2];
                selecdate = yy + '/' + mm + '/' + dd;

            }



        }
    }
    else {
        selecdate = "";
    }

    var objpack = document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var code = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (temp != "") {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode + "," + code;
                desc = tempcode + "," + desc;


            }
            else {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode;
                desc = tempcode;
            }
        }

    }


    // var xml = new ActiveXObject("Microsoft.XMLHTTP");
    var prem_insert = document.getElementById('Hiddendrppageposition').value;

    var insert = document.getElementById('txtinsertion').value;

    var clientname = document.getElementById('txtclient').value;
    var client_split;
    if (clientname.indexOf("(") >= 0) {
        clientname = clientname.split("(");
        client_split = clientname[1];
        client_split = client_split.replace(")", "");
        clientname = client_split;

    }
    var val = "";
    var adcat3 = document.getElementById('drpadcat3').value;
    var adcat4 = document.getElementById('drpadcat4').value;
    var adcat5 = document.getElementById('drpadcat5').value;
    var noof_ins = document.getElementById('txtinsertion').value
    /*new change ankur 17 feb*/
    var uomdesc = document.getElementById('hiddenuomdesc').value
    var line = document.getElementById('txttotalarea').value;
    if (uomdesc == "CD") {
        line = "";
    }

    /*new change ankur 24 feb*/
    //var uom_code=document.getElementById('drpuom').value
    gblogowithmatter = "no";
    if (gblogowithmatter == "yes" && document.getElementById('trlogouom').style.display == "block") {
        uomvalue = document.getElementById('txtlogouomcode').value
    }
    //////////
    /*new change ankur for agency*/
    /* var agency_code=document.getElementById('hiddenagencycodeforrate').value
          
    if(browser!="Microsoft Internet Explorer")
    {
    var  httpRequest =null;;
    httpRequest= new XMLHttpRequest();
    if (httpRequest.overrideMimeType) {
    httpRequest.overrideMimeType('text/xml'); 
    }
            
    httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
    //new change ankur 11 feb
    var qbc_="qbc";
    //*new change ankur for agency
 
    httpRequest.open( "GET","chkpackageforbook.aspx?adtype="+adtype+"&color="+color+"&adcat="+adcat+"&adsucat="+adsucat+"&currency="+currency+"&ratecode="+ratecode+"&package1="+code+"&selecdate="+selecdate+"&uomvalue="+uomvalue+"&prem_insert="+prem_insert+"&line="+line+"&insert="+insert+"&clientname="+clientname+"&adcat3="+adcat3+"&adcat4="+adcat4+"&adcat5="+adcat5+"&noof_ins="+noof_ins+"&qbc_="+qbc_+"&uomdesc="+uomdesc+"&agency_code="+agency_code, false );
    httpRequest.send('');
    //alert(httpRequest.readyState);
    if (httpRequest.readyState == 4) 
    {
    //alert(httpRequest.status);
    if (httpRequest.status == 200) 
    {
    val=httpRequest.responseText;
    }
    else 
    {
    alert('There was a problem with the request.');
    }
    }
    }
    else 
          
    {
    //new change ankur 17 feb
    var uomdesc=document.getElementById('hiddenuomdesc').value
    //new change ankur 11 feb
         
    var qbc_="qbc";
    xml.Open( "GET","chkpackageforbook.aspx?adtype="+adtype+"&color="+color+"&adcat="+adcat+"&adsucat="+adsucat+"&currency="+currency+"&ratecode="+ratecode+"&package1="+code+"&selecdate="+selecdate+"&uomvalue="+uomvalue+"&prem_insert="+prem_insert+"&line="+line+"&insert="+insert+"&clientname="+clientname+"&adcat3="+adcat3+"&adcat4="+adcat4+"&adcat5="+adcat5+"&noof_ins="+noof_ins+"&qbc_="+qbc_+"&uomdesc="+uomdesc+"&agency_code="+agency_code, false );
    xml.Send();
    val=xml.responseText;
    } 
    if(val=="2")
    {
    alert("Your Session Expires");
    window.close();
    return false;
    }
    if(val=="0")
    {
    alert("This package doesnot exists");
    return false;
    }
     
    //////////////////////////////////////////////////////////////////////////////////////////////////////
     
        
    */


    if (document.getElementById('tblinsert').innerHTML == "") {
        alert("Please Fill the grid");
        return false;
    }
    ////////////////this is to chk the mandatory field of grid whether they are selected or fill or not
    var len = "bookdiv";
    var id;
    var height;
    var width;
    var pagepost;
    var matsta;
    var insertsta;
    var editdate;
    var size;
    var inserts;
    var logonam = "lnam" + i;
    var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
    savtotid = totid
    var y;
    if (countgridloop == "") {
        //y=parseInt(noofinsert) 
        y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    }
    else {
        //y=parseInt(countgridloop)  
        y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    }
    var cardid;
    var editid;
    //var y=document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    var i;
    var k = 0;
    var i = 0;
    var d1 = "";
    var d2;
    d2 = document.getElementById('txtdatetime').value;
    var dateformat = document.getElementById('hiddendateformat').value;
    if (dateformat == "dd/mm/yyyy") {
        if (d2 != "") {

            var txt = d2;
            var txt1 = txt.split("/");
            var dd = txt1[0];
            var mm1 = txt1[1];
            var mm = txt1[1]; //getMonthNo(mm1);
            var yy = txt1[2];
            d2 = mm + '/' + dd + '/' + yy;

        }
        else {
            d2 = d2;
        }

    }

    if (dateformat == "yyyy/mm/dd") {
        if (d2 != "") {
            var txt = d2;
            var txt1 = txt.split("/");
            var yy = txt1[0];
            var mm = txt1[1];
            var dd = txt1[2];
            d2 = mm + '/' + dd + '/' + yy;
        }
        else {
            d2 = d2;
        }
    }
    for (k = 0; k < y - 1; k++) {

        while (document.getElementById("card" + i) == null && k < y - 1) {
            i = i + totid;

        }
        if (k >= y - 1) {
            break;
        }

        id = "Text" + i;
        height = "hei" + i;
        width = "wid" + i;
        pagepost = "pagpos" + i;
        matsta = "mat" + i;
        insertsta = "inssta" + i;
        cardid = "card" + i;
        editid = "edit" + i;
        editdate = "Text" + i;
        size = "siz" + i;
        inserts = "ins" + i;
        var file_nam = "fil" + i;
        var logonam = "lnam" + i;
        if (document.getElementById(id).value == "") {
            alert("Please Fill the insertion date for " + document.getElementById('txtrepeatingdate').value + " Insertion");
            document.getElementById(id).focus();
            return false;
        }
        d1 = document.getElementById(id).value;
        if (dateformat == "dd/mm/yyyy") {
            if (d1 != "") {

                var txt = d1;
                var txt1 = txt.split("/");
                var dd = txt1[0];
                var mm1 = txt1[1];
                var mm = txt1[1]; //getMonthNo(mm1);
                var yy = txt1[2];
                d1 = mm + '/' + dd + '/' + yy;

            }
            else {
                d1 = d1;
            }

        }

        if (dateformat == "yyyy/mm/dd") {
            if (d1 != "") {
                var txt = d1;
                var txt1 = txt.split("/");
                var yy = txt1[0];
                var mm = txt1[1];
                var dd = txt1[2];
                d1 = mm + '/' + dd + '/' + yy;
            }
            else {
                d1 = d1;
            }
        }
        if (d1 != "") {
            var days = days_between(d1, d2);
            if (days > parseInt(document.getElementById('hiddenmaxdays').value) && document.getElementById('hiddenmaxdays').value != "0") {
                alert("User can not take the publish date more than the " + document.getElementById('hiddenmaxdays').value + " days from booking date");
                return false;
            }
        }
        // for free and paid schemes
        //        var idno=i;
        //		if(document.getElementById("pai"+idno)!=null)
        //		{
        //		    if(document.getElementById("pai"+idno).value=="N")
        //		    {
        //		        for(var start=0;start<parseInt(y)-1;start++)
        //		        {
        //		             if(document.getElementById("pai"+start).value!="N")
        //		             {
        //		                if(document.getElementById("Text"+start).value!="")
        //		                {
        //		                    	var currdate=document.getElementById("Text"+idno).value;
        //		                    var fromdate=document.getElementById("Text"+start).value;
        //		                    var todate=currdate;
        //		                    //For From Date Converssion 
        //                            if(dateformat=="dd/mm/yyyy")
        //                            {
        //                                if(fromdate != "")
        //                                {
        //                                    var txt=fromdate;
        //                                     var txt1;
        //                                    if(txt.indexOf("-")>=0)
        //                                    {
        //                                         txt1=txt.split("-");
        //                                    }
        //                                    else{
        //                                        txt1=txt.split("/");
        //                                    }
        //                                   
        //                                    var dd=txt1[0];
        //                                    var mm1=txt1[1];
        //                                    var mm;
        //                                     if(txt.indexOf("-")>=0)
        //                                     {
        //                                         mm = getMonthNo(mm1);
        //                                    }
        //                                    else
        //                                    {
        //                                        mm=mm1;
        //                                    }
        //                                    var yy=txt1[2];
        //                                    fromdate=mm+'/'+dd+'/'+yy;
        //                                }
        //                                else
        //                                {
        //                                    fromdate=fromdate;
        //                                }

        //                            }
        //                            
        //                            if(dateformat=="yyyy/mm/dd")
        //                            {
        //                                if(fromdate!="")
        //                                {
        //                                    var txt=fromdate;
        //                                    var txt1=txt.split("/");
        //                                    var yy=txt1[0];
        //                                    var mm=txt1[1];
        //                                    var dd=txt1[2];
        //                                    fromdate=mm+'/'+dd+'/'+yy;
        //                                }
        //                                else
        //                                {
        //                                    fromdate=fromdate;
        //                                }
        //                            }
        //                            
        //                            if(dateformat=="mm/dd/yyyy")
        //                            {
        //                                fromdate=fromdate;
        //                            }
        //                            
        //                            //For From Date Converssion /************************************************************/
        //                            if(dateformat=="dd/mm/yyyy")
        //                            {
        //                                if(todate != "")
        //                                {
        //                                    var txt=todate;
        //                                    var txt1=txt.split("/");
        //                                    var dd=txt1[0];
        //                                    var mm=txt1[1];
        //                                    var yy=txt1[2];
        //                                    todate=mm+'/'+dd+'/'+yy;
        //                                }
        //                                else
        //                                {
        //                                    todate=todate;
        //                                }

        //                            }
        //                            
        //                            if(dateformat=="yyyy/mm/dd")
        //                            {
        //                                if(todate!="")
        //                                {
        //                                    var txt=todate;
        //                                    var txt1=txt.split("/");
        //                                    var yy=txt1[0];
        //                                    var mm=txt1[1];
        //                                    var dd=txt1[2];
        //                                    todate=mm+'/'+dd+'/'+yy;
        //                                }
        //                                else
        //                                {
        //                                    todate=todate;
        //                                }
        //                            }
        //                            
        //                            if(dateformat=="mm/dd/yyyy")
        //                            {
        //                                todate=todate;
        //                            }
        //		                    //
        //                    		
        //                    		
        //                    		
        //		                    var fdate=new Date(fromdate);
        //		                    var tdate=new Date(todate);
        //		                    if(tdate<fdate)
        //		                    {
        //		                        alert("Free Schemes Date can't be greater than Paid Schemes Date");
        //		                        document.getElementById("Text"+idno).value="";
        //		                        document.getElementById("Text"+idno).focus();
        //		                        return false;
        //		                    }
        //		                }
        //		             }    
        //		        }
        //		    }
        //		    else
        //		    {
        //		        for(var start=0;start<parseInt(y)-1;start++)
        //		        {
        //		             if(document.getElementById("pai"+start).value=="N")
        //		             {
        //		                if(document.getElementById("Text"+start).value!="")
        //		                {
        //		                    var currdate=document.getElementById("Text"+idno).value;
        //		                    var fromdate=document.getElementById("Text"+start).value;
        //		                    var todate=currdate;
        //		                    //For From Date Converssion 
        //                            if(dateformat=="dd/mm/yyyy")
        //                            {
        //                                if(fromdate != "")
        //                                {
        //                                    var txt=fromdate;
        //                                     var txt1;
        //                                    if(txt.indexOf("-")>=0)
        //                                    {
        //                                         txt1=txt.split("-");
        //                                    }
        //                                    else{
        //                                        txt1=txt.split("/");
        //                                    }
        //                                   
        //                                    var dd=txt1[0];
        //                                    var mm1=txt1[1];
        //                                    var mm;
        //                                     if(txt.indexOf("-")>=0)
        //                                     {
        //                                         mm = getMonthNo(mm1);
        //                                    }
        //                                    else
        //                                    {
        //                                        mm=mm1;
        //                                    }
        //                                    var yy=txt1[2];
        //                                    fromdate=mm+'/'+dd+'/'+yy;
        //                                }
        //                                else
        //                                {
        //                                    fromdate=fromdate;
        //                                }

        //                            }
        //                            
        //                            if(dateformat=="yyyy/mm/dd")
        //                            {
        //                                if(fromdate!="")
        //                                {
        //                                    var txt=fromdate;
        //                                    var txt1=txt.split("/");
        //                                    var yy=txt1[0];
        //                                    var mm=txt1[1];
        //                                    var dd=txt1[2];
        //                                    fromdate=mm+'/'+dd+'/'+yy;
        //                                }
        //                                else
        //                                {
        //                                    fromdate=fromdate;
        //                                }
        //                            }
        //                            
        //                            if(dateformat=="mm/dd/yyyy")
        //                            {
        //                                fromdate=fromdate;
        //                            }
        //                            
        //                            //For From Date Converssion /************************************************************/
        //                            if(dateformat=="dd/mm/yyyy")
        //                            {
        //                                if(todate != "")
        //                                {
        //                                    var txt=todate;
        //                                    var txt1=txt.split("/");
        //                                    var dd=txt1[0];
        //                                    var mm=txt1[1];
        //                                    var yy=txt1[2];
        //                                    todate=mm+'/'+dd+'/'+yy;
        //                                }
        //                                else
        //                                {
        //                                    todate=todate;
        //                                }

        //                            }
        //                            
        //                            if(dateformat=="yyyy/mm/dd")
        //                            {
        //                                if(todate!="")
        //                                {
        //                                    var txt=todate;
        //                                    var txt1=txt.split("/");
        //                                    var yy=txt1[0];
        //                                    var mm=txt1[1];
        //                                    var dd=txt1[2];
        //                                    todate=mm+'/'+dd+'/'+yy;
        //                                }
        //                                else
        //                                {
        //                                    todate=todate;
        //                                }
        //                            }
        //                            
        //                            if(dateformat=="mm/dd/yyyy")
        //                            {
        //                                todate=todate;
        //                            }
        //		                    //
        //                    		
        //                    		
        //                    		
        //		                    var fdate=new Date(fromdate);
        //		                    var tdate=new Date(todate);
        //		                    if(tdate>fdate)
        //		                    {
        //		                        alert("For Item Line "+(idno+1).toString()+"Paid Schemes Date can't be less than Free Schemes Date");
        //		                        document.getElementById("Text"+idno).value="";
        //		                        return false;
        //		                    }
        //		                }
        //		             }    
        //		        }
        //		    }
        //}
        if (document.getElementById(height).value == "" && document.getElementById('txtadsize1').disabled == false) {

            alert("Please fill height into grid");
            //document.getElementById(height).focus();
            return false;


        }
        else if (document.getElementById(width).value == "" && document.getElementById('txtadsize2').disabled == false) {
            alert("Please fill width into grid");
            //document.getElementById(width).focus();
            return false;


        }
        else if (document.getElementById(size).value == "" && document.getElementById('txtadsize2').disabled == true) {

            alert("Please fill size into grid");
            //document.getElementById(width).focus();
            return false;


        }
        //                if ((document.getElementById('drpbooktype').value == "2" || document.getElementById('drpbooktype').value == "6")) {
        //                    if (fmgsize != size.value) {
        //                        alert("Booking size shoould be same as  FMG Booking");
        //                        return false;
        //                    }
        //                    if (fmgcolor != col.value) {
        //                        alert("Booking Color shoould be same as  FMG Booking");
        //                        return false;
        //                    }
        //                }  
        //                else if(document.getElementById(file_nam).value=="" && (document.getElementById('hiddenuomdesc').value=="ROL"  ||  document.getElementById('hiddenuomdesc').value=="ROD" || document.getElementById('hiddenuomdesc').value=="ROC")  )
        //                {
        //                   // alert("Please get file name");
        //                   var is=i + 1;
        //                   alert("Please upload Material for Insertion " + is);
        //                    //document.getElementById(file_nam).focus();
        //                    return false;
        //                }
        //                 else if(document.getElementById('hiddenuomdesc').value=="ROD" && document.getElementById(logonam).value=="")
        //               {
        //                  // alert("Please get logo name");
        //                   alert("Please upload Logo for Insertion " + is);
        //                   //document.getElementById(file_nam).focus();
        //                   return false;
        //               }

        if (document.getElementById(matsta) != null) {
            if (document.getElementById(matsta).value == "" || document.getElementById(matsta).value == "0") {
                alert("Please select material status");
                document.getElementById(matsta).focus();
                return false;

            }
        }
        if (document.getElementById(cardid).value == "") {
            alert("Please get the card rate");

            return false;

        }
        else if (document.getElementById(insertsta).value == "" || document.getElementById(insertsta).value == "0") {
            alert("Please select insertion status");
            document.getElementById(insertsta).focus();
            return false;

        }
        //                else if(document.getElementById(adcat)!=null && (document.getElementById(adcat).value=="" || document.getElementById(adcat).value=="0"))
        //                {
        //                    alert("Please select Ad Category");
        //                    document.getElementById(adcat).focus();
        //                    
        //                    return false;
        //                }
        var adsubcat = "ads" + i;
        var adcat = "adcat" + i;
        var colid = "col" + i;
        /////////////this is the page constructed to know whether the package exists or not on the basis of grid
        //values

        /* these are the values from which we get that existing package exists or not*/


        var adtype = document.getElementById('drpadtype').value;
        var color = document.getElementById(colid).value;
        if (document.getElementById(adcat) != null) {
            var adcat = document.getElementById(adcat).value;
        }
        var adsucat = document.getElementById(adsubcat).value;
        var currency = document.getElementById('hiddencurrency').value;
        //document.getElementById('droratecode').value
        //new change ankur 27 feb*/
        //var ratecode = document.getElementById('txtratecode').value;
        var ratecode = document.getElementById('txtratecode').value;
        var package1 = document.getElementById('drppackage').value;
        var dateformat = document.getElementById('hiddendateformat').value;
        var uomvalue = document.getElementById('drpuom').value;
        var selecdate;
        if (document.getElementById('txtdummydate').value != "") {
            if (dateformat == "mm/dd/yyyy") {

                var txt1 = document.getElementById('txtdummydate').value;
                var txt2 = txt1.split("/");
                var mm = txt2[0];
                var dd = txt2[1];
                var yy = txt2[2];
                selecdate = yy + '/' + mm + '/' + dd;
            }
            if (dateformat == "dd/mm/yyyy") {
                var txt1 = document.getElementById('txtdummydate').value;
                var txt2 = txt1.split("/");
                var dd = txt2[0];
                var mm = txt2[1];
                var yy = txt2[2];
                selecdate = yy + '/' + mm + '/' + dd;
            }
            if (dateformat == "yyyy/mm/dd") {
                selecdate = document.getElementById('txtdummydate').value;

            }
        }
        else {
            selecdate = "";
        }

        //////////////this code is to split the code as well as ites description 

        if (document.getElementById('hiddensavemod').value == "0") {

            var objpack = document.getElementById('drppackagecopy');
            var temp = "";
            var tempcode = "";
            var tempval = "";
            var tempvalcode = "";
            var desc = "";
            var code = "";
            var c = objpack.options.length;
            var j;

            for (j = 0; j < c; j++) {
                if (parseInt(c) > 0) {
                    tempval = objpack[j].value;
                    //tempvalcode=objpack[j].value;
                    if (temp != "") {
                        temp = tempval.split("@");
                        tempvalcode = temp[0];
                        tempcode = temp[1];
                        code = tempvalcode + "," + code;
                        desc = tempcode + "," + desc;


                    }
                    else {
                        temp = tempval.split("@");
                        tempvalcode = temp[0];
                        tempcode = temp[1];
                        code = tempvalcode;
                        desc = tempcode;
                    }
                }

            }



        }
        else {

            var objpack = document.getElementById('drppackagecopy');
            var temp = "";
            var tempcode = "";
            var tempval = "";
            var tempvalcode = "";
            var desc = "";
            var code = "";
            var c = objpack.options.length;
            var j;

            for (j = 0; j < c; j++) {
                if (parseInt(c) > 0) {
                    tempval = objpack[j].value;
                    //tempvalcode=objpack[j].value;
                    if (temp != "") {
                        temp = tempval.split("@");
                        tempvalcode = temp[0];
                        tempcode = temp[1];
                        code = tempvalcode + "," + code;
                        desc = tempcode + "," + desc;


                    }
                    else {
                        temp = tempval.split("@");
                        tempvalcode = temp[0];
                        tempcode = temp[1];
                        code = tempvalcode;
                        desc = tempcode;
                    }
                }

            }





        }
        //////////////////////////////////////////////////////////////////




        var prem_insert = document.getElementById('Hiddendrppageposition').value;
        var line = document.getElementById('txttotalarea').value;
        var insert = document.getElementById('txtinsertion').value;

        var clientname = document.getElementById('txtclient').value;
        var client_split;
        if (clientname.indexOf("(") >= 0) {
            clientname = clientname.split("(");
            client_split = clientname[1];
            client_split = client_split.replace(")", "");
            clientname = client_split;

        }

        var adcat3 = document.getElementById('drpadcat3').value;
        var adcat4 = document.getElementById('drpadcat4').value;
        var adcat5 = document.getElementById('drpadcat5').value;
        var noof_ins = document.getElementById('txtinsertion').value
        /*new change ankur 17 feb*/
        var uomdesc = document.getElementById('hiddenuomdesc').value
        var val = "";
        /*new change ankur 24 feb*/
        //var uom_code=document.getElementById('drpuom').value
        gblogowithmatter = "no";
        if (gblogowithmatter == "yes" && document.getElementById('trlogouom').style.display == "block") {
            uomvalue = document.getElementById('txtlogouomcode').value
        }
        //////////
        /*new change ankur for agency*/
        /* var agency_code=document.getElementById('hiddenagencycodeforrate').value
        if(browser!="Microsoft Internet Explorer")
        {
        var  httpRequest =null;;
        httpRequest= new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
        httpRequest.overrideMimeType('text/xml'); 
        }
            
        httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
        //new change ankur 11 feb
        var qbc_="qbc";
        //new change ankur for agency
        httpRequest.open( "GET","chkpackageforbook.aspx?adtype="+adtype+"&color="+color+"&adcat="+adcat+"&adsucat="+adsucat+"&currency="+currency+"&ratecode="+ratecode+"&package1="+code+"&selecdate="+selecdate+"&uomvalue="+uomvalue+"&prem_insert="+prem_insert+"&line="+line+"&insert="+insert+"&clientname="+clientname+"&adcat3="+adcat3+"&adcat4="+adcat4+"&adcat5="+adcat5+"&noof_ins="+noof_ins+"&qbc_="+qbc_+"&uomdesc="+uomdesc+"&agency_code="+agency_code, false );
        httpRequest.send('');
        //alert(httpRequest.readyState);
        if (httpRequest.readyState == 4) 
        {
        //alert(httpRequest.status);
        if (httpRequest.status == 200) 
        {
        val=httpRequest.responseText;
        }
        else 
        {
        alert('There was a problem with the request.');
        }
        }
        }
        else
        {
        //new change ankur 17 feb
        var uomdesc=document.getElementById('hiddenuomdesc').value
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        //new change ankur 11 feb
        var qbc_="qbc";
        //new change ankur for agency
        xml.Open( "GET","chkpackageforbook.aspx?adtype="+adtype+"&color="+color+"&adcat="+adcat+"&adsucat="+adsucat+"&currency="+currency+"&ratecode="+ratecode+"&package1="+code+"&selecdate="+selecdate+"&uomvalue="+uomvalue+"&prem_insert="+prem_insert+"&line="+line+"&insert="+insert+"&clientname="+clientname+"&adcat3="+adcat3+"&adcat4="+adcat4+"&adcat5="+adcat5+"&noof_ins="+noof_ins+"&qbc_="+qbc_+"&uomdesc="+uomdesc+"&agency_code="+agency_code, false );
        xml.Send();
        val=xml.responseText;
        }
        if(val=="2")
        {
        alert("Your Session Expires");
        window.close();
        return false;
        }
        if(val=="0")
        {
        alert("This package doesnot exists");
        return false;
        }*/

        /////////////this is to chk that the publication has a vlaid day for that date and it matcahes with the selected date day
        /*   var strtext="";
        var compcode=document.getElementById('hiddencompcode').value;
        //var strid1=strid.split('@');
        var pkgid="";
        var pkgname=document.getElementById(editid).value;
        pkgname=pkgname.replace("+","^");
        var value="1";
        var dateday=document.getElementById(editdate).value;
                  
        if(browser!="Microsoft Internet Explorer")
        {
        var  httpRequest =null;;
        httpRequest= new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
        httpRequest.overrideMimeType('text/xml'); 
        }
                    
        httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
        var adcat=document.getElementById('drpadcategory').value;
        httpRequest.open( "GET","packagename.aspx?adcat="+adcat+"&pkgid="+pkgid+"&compcode="+compcode+"&value="+value+"&dateday="+dateday+"&pkgname="+pkgname, false );
        httpRequest.send('');
        //alert(httpRequest.readyState);
        if (httpRequest.readyState == 4) 
        {
        //alert(httpRequest.status);
        if (httpRequest.status == 200) 
        {
        strtext=httpRequest.responseText;
        }
        else 
        {
        alert('There was a problem with the request.');
        }
        }
        }
        else
        { 
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        var adcat=document.getElementById('drpadcategory').value;
        xml.Open( "GET","packagename.aspx?adcat="+adcat+"&pkgid="+pkgid+"&compcode="+compcode+"&value="+value+"&dateday="+dateday+"&pkgname="+pkgname, false );
        xml.Send();
        strtext=xml.responseText;   
        }
        if(strtext=="0")
        {
        alert("Publication day doesnot match with day");
        document.getElementById(editid).style.backgroundColor="#FFFF80";
        return false;
        }     
                
        ///////////////this is to match the RO date time for edition and supplement if current time is greater 
        ///////////////than the selected edition or supplement time than booking is not to save
        */
        /////to get the time of the client
        var currenttime = new Date();
        var clienttime = new Date(currenttime);
        var rohours = clienttime.getHours();
        var romin = clienttime.getMinutes();
        var h = document.getElementById(height).value;
        var w = document.getElementById(width).value;
        ///////////we will check from the preferrences if in the prefeerrences the category is selected for
        ////that category we will not check the ro date and time
        ////////////////////this page is call through xml object to check the ro time
        /////if in preferrences it is yes is selected in rodatetime drop down than only check rodatetime
        ///if it is 0 than having no permission anf if 1 than vice versa
        /*    if(document.getElementById('hiddenrodatetime').value=="yes" || document.getElementById('hiddenroperm').value=="1")
        {
        if(document.getElementById('hiddenroadcat').value.indexOf(document.getElementById('drpadcategory').value)>=0)
        {}
        else
        {    
        var ro_time="";
                    
        if(browser!="Microsoft Internet Explorer")
        {
        var  httpRequest =null;;
        httpRequest= new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
        httpRequest.overrideMimeType('text/xml'); 
        }
                            
        httpRequest.onreadystatechange = function() {alertContents(httpRequest) };

        httpRequest.open( "GET","checkrotime.aspx?rohours="+rohours+"&compcode="+compcode+"&romin="+romin+"&dateday="+dateday+"&pkgname="+pkgname+"&h="+h+"&w="+w, false );
        httpRequest.send('');
        //alert(httpRequest.readyState);
        if (httpRequest.readyState == 4) 
        {
        //alert(httpRequest.status);
        if (httpRequest.status == 200) 
        {
        ro_time=httpRequest.responseText;
        }
        else 
        {
        alert('There was a problem with the request.');
        }
        }
        }
        else
        {
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        xml.Open( "GET","checkrotime.aspx?rohours="+rohours+"&compcode="+compcode+"&romin="+romin+"&dateday="+dateday+"&pkgname="+pkgname+"&h="+h+"&w="+w, false );
        xml.Send();
        ro_time=xml.responseText; 
        }     
        if(ro_time=="1" || ro_time=="2")
        {
        if(ro_time=="1" )
        {   
        alert("Ro Time or production is greater");
        document.getElementById(editid).style.backgroundColor="#FFFF80";
        }
        else
        {
        alert("Height or Width should be less");
        document.getElementById(editid).style.backgroundColor="#FFFF80";
                                    
        }
        return false; 
                                        
                                
        }
        }
        }
                
        */
        //////////////////////////////////////////////////////////////////////////////////     

        i = i + 1;


    }

    if (document.getElementById("hdnbutton").value == "btnsavepay") {
    }

    else {

        if (document.getElementById('agnlogin').value == "N" && document.getElementById('drppaymenttype').value != "CA0" && document.getElementById('drppaymenttype').value != "CR1") {///add by anuja
            // if (document.getElementById('hdnproofread').value == "") {///add by anuja
            if (confirm("Do You Want To Print The Receipt")) {
                if (document.getElementById('txtclient').value == "") {
                    alert("Please Fill the Client Name");
                    document.getElementById('txtclient').focus();
                    return false;
                }
                document.getElementById('hiddenprint_rec').value = "Y";
            }
            //}///add by anuja
            else {
                document.getElementById('hiddenprint_rec').value = "";
            }
        } ///add by anuja

    }




    //var res=QBC.getRec(document.getElementById('txtagency').value);
    //getRec_callback1(res);
    if (document.getElementById('hiddencopy').value == "copy") {
        change_fileName();
    }
    document.getElementById("hiddencardrate").value = document.getElementById("txtcardrate").value;
    document.getElementById("hiddenboxchrg").value = document.getElementById("txtboxchrg").value;
    document.getElementById("hiddengrossamt").value = document.getElementById("txtgrossamt").value;
    document.getElementById("hiddenpaidins").value = document.getElementById("txtpaid").value;
    document.getElementById("hiddentotalarea").value = document.getElementById("txttotalarea").value;
    saveClick();
    return false;

}

function getmodifygrid() {


    var len = "bookdiv";
    var insertno;
    var premid;
    var premper;
    var colid;
    var heightid;
    var widthid;
    var size;
    var late;
    //var uomid;
    //var adtypid;
    var cardid;
    var editid;
    var solorate;
    var premper1;
    var prem1id;
    var namecode;
    var inserts;
    var pagepost;
    var preall;
    var adcat;
    var adsubcat;
    var matsta;
    var filename;
    var discrate;
    var insertsta;
    var billstat;
    var id;
    var repeat;
    var i = 0;
    var paid;
    var agrred;
    var solo;
    var gross;
    var showid;
    var pageno_inserts;
    var remark_inserts;
    var page;
    var pageprem;
    var noofcol;
    var billamt;
    var billrate;
    var pkg_alias_value;
    var clicatamtval;
    var GSTAMT;
    var GSTGD;
    var compcode = document.getElementById('hiddencompcode').value;
    var userid = document.getElementById('hiddenuserid').value;
    if (document.getElementById('txtciobookid').value == "") {
        document.getElementById('txtciobookid').value = document.getElementById('hiddencioid').value
    }
    var cioid = document.getElementById('txtciobookid').value;
    /*new change ankur 23 feb*/
    var logo_h;
    var logo_w;
    var logo_name;


    var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
    //var y=parseInt(noofinsert)   
    var k;

    for (k = 0; k < y - 1; k++) {



        showid = "sho" + i;
        id = "Text" + i;
        editid = "edit" + i;
        // premid="prem"+i;
        // prem1id="premone"+i;
        colid = "col" + i;
        heightid = "hei" + i;
        widthid = "wid" + i;
        size = "siz" + i;
        pagepost = "pagpos" + i;
        namecode = "one";
        // premper="premper"+i;
        //  premper1="premperone"+i;
        //adtypid="adtyp"+i;
        namecode = "two";
        preall = "preall" + i;
        adcat = "adcat" + i;
        late = "lat" + i;
        matsta = "mat" + i;
        cardid = "card" + i;
        filename = "fil" + i;
        discrate = "disrat" + i;
        insertsta = "inssta" + i;
        billstat = "bill" + i;
        adsubcat = "ads" + i;
        repeat = "rep" + i;
        insertno = "ins" + i;
        paid = "pai" + i
        agrred = "agr" + i;
        solo = "sol" + i;
        gross = "gro" + i;
        pageno_inserts = "pagno" + i; ;
        remark_inserts = "rem" + i;
        page = "pgpre" + i;
        pageprem = "pagper" + i;
        noofcol = "nocol" + i;
        billamt = "ba" + i;
        billrate = "br" + i;

        adcat3 = "adscat3" + i;
        adcat4 = "adscat4" + i;
        adcat5 = "adscat5" + i;
        GSTAMT = "GSTAMT" + i;
        GSTGD = "GSTGD" + i;
        /*new change ankur 23 feb*/
        logo_h = "logohei" + i;
        logo_w = "logowid" + i;
        logo_name = "logonam" + i;

        var pkgcodegrid = "hiddenpckcode" + i;
        var pkg_ins = "pkg_ins" + i;

        var pkg_alias = "pkg_alias" + i;
        clicatamtval = "clicatamt" + i;
        /*new change ankur 23 feb*/
        var logohei = "";
        var logowid = "";
        var logonam = "";
        gblogowithmatter = "no";
        if (gblogowithmatter == "yes" || document.getElementById('hiddenuomdesc').value == "ROD") {



            logohei = document.getElementById(logo_h).value;
            logowid = document.getElementById(logo_w).value;
            logonam = document.getElementById(logo_name).value;
        }

        /////////////////////////////

        var insernum = "";
        var insertdate = "";
        var edition = "";
        var premium1 = "";
        var premium2 = "";
        var height = "";
        var width = "";
        var totalsize = "";
        /////

        var color = "";
        var premallow = "";
        var adcategory = "";
        var latestdate = "";
        var material = "";
        var cardrate = "";
        var filenamevalue = "";

        var insertstatus = "";
        var billstatus = "";

        var repdate = "";
        var paidins = "";
        var insagreedrate = "";
        var inssolo = "";
        var grossrate = "";
        var insert_pageno = "";
        var insert_remark = "";
        var page_code = "";
        var page_per = "";
        var no_ofcol = "";
        var bill_amt = "";
        var bill_rate = "";
        var adcat3value = "";
        var adcat4value = "";
        var adcat5value = "";
        var gstamount="";
        var gstgrid="";
        //To update subedition detail table
        var subedi = "subedidata" + i;
        var subedidata = "";

        var pkgcodegrid_value = "";
        /////

        if (document.getElementById(insertno) != null) {
            insernum = document.getElementById(insertno).innerHTML;
        }

        if (document.getElementById(id) != null) {
            insertdate = document.getElementById(id).value;
        }

        if (document.getElementById(editid) != null) {
            edition = document.getElementById(editid).value;
        }


        premium1 = "0"//document.getElementById(premid).value;
        premium2 = "0"//document.getElementById(prem1id).value;

        if (document.getElementById(heightid) != null) {
            height = document.getElementById(heightid).value;
        }
        if (document.getElementById(widthid) != null) {
            width = document.getElementById(widthid).value;
        }

        if (document.getElementById(size) != null) {
            totalsize = document.getElementById(size).value;
        }

        if (document.getElementById(pagepost) != null) {
            pagepost = document.getElementById(pagepost).value;
        }
        if (document.getElementById(colid) != null) {
            color = document.getElementById(colid).value;
        }

        var premper11 = "0"//document.getElementById(premper).value;
        var premper2 = "0"//document.getElementById(premper1).value;

        if (document.getElementById(preall) != null) {
            premallow = document.getElementById(preall).value;
        }

        if (document.getElementById(adcat) != null) {
            adcategory = document.getElementById(adcat).value;
        }
        else {
            adcategory = document.getElementById("hiddencatcode").value;
        }

        if (document.getElementById(late) != null) {
            latestdate = document.getElementById(late).value;
        }

        if (document.getElementById(matsta) != null) {
            material = document.getElementById(matsta).value;
        }

        if (document.getElementById(cardid) != null) {
            cardrate = document.getElementById(cardid).value;
        }

        if (document.getElementById(filename) != null) {
            filenamevalue = document.getElementById(filename).value;
        }

        if (document.getElementById(discrate) != null) {
            discrate = document.getElementById(discrate).value;
        }

        if (document.getElementById(insertsta) != null) {
            insertstatus = document.getElementById(insertsta).value;
        }

        if (document.getElementById(billstat) != null) {
            billstatus = document.getElementById(billstat).value;
        }

        if (document.getElementById(adsubcat) != null) {
            adsubcat = document.getElementById(adsubcat).value;
        }
        else {
            adsubcat = document.getElementById("hiddenad_subcat").value;
        }

        if (document.getElementById(repeat) != null) {
            repdate = document.getElementById(repeat).value;
        }

        if (document.getElementById(paid) != null) {
            paidins = document.getElementById(paid).value;
        }

        if (document.getElementById(agrred) != null) {
            insagreedrate = document.getElementById(agrred).value;
        }

        if (document.getElementById(solo) != null) {
            inssolo = document.getElementById(solo).value;
        }

        if (document.getElementById(gross) != null) {
            grossrate = document.getElementById(gross).value;
        }

        if (document.getElementById(pageno_inserts) != null) {
            insert_pageno = document.getElementById(pageno_inserts).value;
            if (insert_pageno == "") {
                insert_pageno = "0";
            }
        }

        if (document.getElementById(remark_inserts) != null) {
            insert_remark = document.getElementById(remark_inserts).value;
        }

        if (document.getElementById(page) != null) {
            page_code = document.getElementById(page).value;
        }

        if (document.getElementById(pageprem) != null) {
            page_per = document.getElementById(pageprem).value;
        }

        if (document.getElementById(noofcol) != null) {
            no_ofcol = document.getElementById(noofcol).value;
        }

        if (document.getElementById(billamt) != null) {
            bill_amt = document.getElementById(billamt).value;
        }

        if (document.getElementById(billrate) != null) {
            bill_rate = document.getElementById(billrate).value;
        }


        if (document.getElementById(adcat3) != null) {
            adcat3value = document.getElementById(adcat3).value;
        }
        else {
            adcat3value = document.getElementById("hiddenadscat3").value;
        }

        if (document.getElementById(adcat4) != null) {
            adcat4value = document.getElementById(adcat4).value;
        }
        else {
            adcat4value = document.getElementById("hiddenadscat4").value;
        }

        if (document.getElementById(adcat5) != null) {
            adcat5value = document.getElementById(adcat5).value;
        }
        else {
            adcat5value = document.getElementById("hiddenadscat5").value;
        }

        /*new change ankur 23 feb*/

        var dateformat = document.getElementById('hiddendateformat').value

        if (document.getElementById(pkgcodegrid) != null) {
            pkgcodegrid_value = document.getElementById(pkgcodegrid).value;
        }

        if (document.getElementById(pkg_ins) != null) {
            pkginsgrid_value = document.getElementById(pkg_ins).value;
        }

        if (document.getElementById(pkg_alias) != null) {
            pkg_alias_value = document.getElementById(pkg_alias).value;
        }

        if (document.getElementById(subedi) != null) {
            subedidata = document.getElementById(subedi).value;
        }
        var clicatamt = document.getElementById(clicatamtval).value;
        var splboldsize = "splboldsize" + i;
        var splboldsizevalue = "";
        splboldsizevalue = document.getElementById(splboldsize).value;
        // for logo
        var logohei = "";
        var logowid = "";
        var logonam = "";
        if (document.getElementById('logohei' + i) != null)
            logohei = document.getElementById('logohei' + i).value;
        if (document.getElementById('logowid' + i) != null)
            logowid = document.getElementById('logowid' + i).value;
        if (document.getElementById('logonam' + i) != null)
            logonam = document.getElementById('logonam' + i).value;
        var insertid = '0';
        var insert_id = "sho" + i;
        if (document.getElementById(insert_id) != null)
            insertid = document.getElementById(insert_id).value;
        /////////////////////add anuja eyecather
        var eyecath = "";
        if (document.getElementById('eye_cather' + i) != null) {
            eyecath = document.getElementById('eye_cather' + i).value;
        }
        ////////////////////day wise premium
        var dayprim = "";
        if (document.getElementById('hdnday_prim' + i) != null) {
            dayprim = document.getElementById('hdnday_prim' + i).value;
        }
        if (document.getElementById(GSTAMT) != null) {
                gstamount = document.getElementById(GSTAMT).value;
        }
        if (document.getElementById(GSTGD) != null) {
            gstgrid = document.getElementById(GSTGD).value;
        }
        //Classified_Booking.modifygridinsert(insertdate,edition,premium1,premium2,premallow,adcategory,latestdate,material,cardrate,filename,discrate,insertstatus,billstatus,adsubcat,compcode,userid,cioid,height,width,totalsize,pagepost,premper11,premper2,color,repdate,insernum,paidins,insagreedrate,inssolo,grossrate,modid);
        //if (filenamevalue != "" && document.getElementById('txtreceipt').value != "")
        //   filenamevalue = filenamevalue.replace(cioid, document.getElementById('txtreceipt').value);
        QBC.modifygridinsert(insertdate, edition, premium1, premium2, premallow, adcategory, latestdate, material, cardrate, filenamevalue, discrate, insertstatus, billstatus, adsubcat, compcode, userid, cioid, height, width, totalsize, pagepost, premper11, premper2, color, repdate, insernum, paidins, insagreedrate, inssolo, grossrate, insert_pageno, insert_remark, page_code, page_per, no_ofcol, bill_amt, bill_rate, logohei, logowid, logonam, dateformat, adcat3value, adcat4value, adcat5value, pkgcodegrid_value, pkginsgrid_value, pkg_alias_value, insertid, splboldsizevalue, document.getElementById('vat' + i).value, document.getElementById('vat_inc' + i).value, subedidata, clicatamt, "", "", "", eyecath, dayprim,gstamount,gstgrid);
        i = i + 1;
    }

    if (document.getElementById('hiddensavemod').value == "0") {
        document.getElementById('tblinsert').innerHTML = "";
        if (document.getElementById('tblrate') != null) {
            document.getElementById('tblrate').style.display = "none";
        }
        if (document.getElementById('tblbill') != null) {
            document.getElementById('tblbill').style.display = "none";
        }
        //document.getElementById('tblsize').style.display="none";
        if (document.getElementById('addetails') != null) {
            document.getElementById('addetails').style.display = "none";
        }
        if (document.getElementById('pagedetail') != null) {
            document.getElementById('pagedetail').style.display = "none";
        }
        if (document.getElementById('tblpackage') != null) {
            document.getElementById('tblpackage').style.display = "none";
        }
        if (document.getElementById('tbbox') != null) {
            document.getElementById('tbbox').style.display = "none";
        }
        document.getElementById('txtciobookid').value = "";
        if (document.getElementById('LinkButton1') != null) {
            document.getElementById('LinkButton1').disabled = true;
        }
        if (document.getElementById('LinkButton2') != null) {
            document.getElementById('LinkButton2').disabled = true;
        }
        if (document.getElementById('LinkButton3') != null) {
            document.getElementById('LinkButton3').disabled = true;
        }
        if (document.getElementById('LinkButton4') != null) {
            document.getElementById('LinkButton4').disabled = true;
        }
        if (document.getElementById('LinkButton5') != null) {
            document.getElementById('LinkButton5').disabled = true;
        }
        if (document.getElementById('LinkButton6') != null) {
            document.getElementById('LinkButton6').disabled = true;
        }
        if (document.getElementById('LinkButton7') != null) {
            document.getElementById('LinkButton7').disabled = true;
        }
    }
    var curr_cio_id = prevcioidformatter;
    //**************By Manish Verma***************************************************


    if (browser != "Microsoft Internet Explorer") {
        var httpRequest = null; ;
        httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml');
        }

        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

        httpRequest.open("GET", "insertMatter.aspx?FORMNAME=QBC&receipt=" + document.getElementById('hiddenreceiptno').value + "&modify=" + modifyMatter + "&currcioid=" + curr_cio_id, false);
        httpRequest.send('');
        //alert(httpRequest.readyState);
        if (httpRequest.readyState == 4) {
            //alert(httpRequest.status);
            if (httpRequest.status == 200) {
                //ro_time=httpRequest.responseText;
            }
            else {
                alert('There was a problem with the request.');
            }
        }
    }
    else {
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        xml.Open("GET", "insertMatter.aspx?FORMNAME=QBC&receipt=" + document.getElementById('hiddenreceiptno').value + "&modify=" + modifyMatter + "&currcioid=" + curr_cio_id, false);
        xml.Send();
    }
    //********************************************************************************

    return false;


}


//this is the function to show the grid during execution mode

function showgridexecute() {
    var msg = checkSession();
    if (msg == false) {
        window.location.href = "login.aspx";
        return false;
    }
    /*new change ankur 24 feb*/
    document.getElementById('hiddenlogomatter').value = "no";
    if (document.getElementById('hiddenlogomatter').value == "yes") {

        //document.getElementById('trbtnlogo').style.display="block";
        //document.getElementById('btnlogoupload').disabled=false;
        document.getElementById('trlogouoload').style.display = "block";
        document.getElementById('trlogouom').style.display = "block";

        /*new change ankur mar*/
        document.getElementById('trlogouoload').style.display = "block";
        document.getElementById('trlogouoload1').style.display = "block";
        document.getElementById('trlogouoload2').style.display = "block";
        document.getElementById('trlogouoload3').style.display = "block";
        document.getElementById('trlogouoload4').style.display = "block";
        document.getElementById('trlogouoload5').style.display = "block";

        document.getElementById('trlogouom').style.display = "block";
        document.getElementById('trlogouom1').style.display = "block";

    }
    else {
        //document.getElementById('btnlogoupload').disabled=true;
        document.getElementById('trbtnlogo').style.display = "none";
        document.getElementById('trlogouoload').style.display = "none";
        document.getElementById('trlogouom').style.display = "none";

        /*new change ankur mar*/
        document.getElementById('trlogouoload').style.display = "none";
        document.getElementById('trlogouoload1').style.display = "none";
        document.getElementById('trlogouoload2').style.display = "none";
        document.getElementById('trlogouoload3').style.display = "none";
        document.getElementById('trlogouoload4').style.display = "none";
        document.getElementById('trlogouoload5').style.display = "none";

        document.getElementById('trlogouom').style.display = "none";
        document.getElementById('trlogouom1').style.display = "none";
    }
    /////////////////

    /*new change ankur 10 feb*/
    var cioid = "";
    if (document.getElementById('hiddencopy').value == "copy" && document.getElementById('hiddendummycioid').value != "") {
        cioid = document.getElementById('hiddendummycioid').value;
    }
    else {
        cioid = document.getElementById('txtciobookid').value;
    }
    var compcode = document.getElementById('hiddencompcode').value;

    QBC.showgridforexe(cioid, compcode, call_showgrid);
    return false;


}

function call_showgrid(res) {
    var ds = res.value;
    var str = "";
    var editid;
    var inserts;
    var adsubcat;
    var dat = "mm+" / "+dd+" / "+yyyy";
    var l;
    var j;
    var colid;
    var premid;
    var prem1id;
    var height;
    var width;
    var size;
    var pagepost;
    var p;
    var cardid;
    var matsta;
    var filename;
    var discrate;
    var insertsta;
    var billstat;
    var late;
    var repeat;
    var premid;
    var premper;
    var premper1;
    var adtypid;
    var namecode;
    var preall;
    var adcat;
    var picfield;
    var agrred;
    var paid;
    var solo;
    var gross;
    var showid;
    var pageno_inserts;
    var remark_inserts;
    var page;
    var pageprem;
    var billamt;
    var billrate;
    var pagstr = "";
    /*new change ankur 24 feb*/
    /*new change ankur 23 feb*/
    var logoH = "";
    var logoW = "";
    var logonam = "";
    //////////////////

    var pkgcodegrid = "";

    var showordisable = document.getElementById('hiddensavemod').value;
    var copydata = document.getElementById('hiddencopy').value;
    var noinsertgrid = document.getElementById('txtinsertion').value;
    previnsertion = document.getElementById('txtinsertion').value;
    noofinsertlo = parseInt(ds.Tables[0].Rows.length) / parseInt(noinsertgrid)
    rowwhenupdate = ds.Tables[0].Rows.length;

    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {
        //this is the for loop we are implementing so that the rows appear the same as the rows in tbl_booking_insert table
        var count = ds.Tables[0].Rows.length - 1;
        countgridloop = ds.Tables[0].Rows.length;
        retrows = ds.Tables[0].Rows.length - 1;
        var i = 0;
        //str="<div id=\"bookdiv\" runat=\"server\" style=\"OVERFLOW: auto; WIDTH: 896px; HEIGHT: 100px; \"><table cellpadding=\"1\" cellspacing=\"1\" id=\"gridtab\" width=\"1000px\" border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\"><td align=\"center\" valign=\"top\" >No.</td><td align=\"center\" valign=\"top\" >Edition</td><td valign=\"top\" align=\"center\">Date</td><td align=\"center\" valign=\"top\">Ad Sub Cat.</td><td align=\"center\" valign=\"top\">Color</td><td align=\"center\" valign=\"top\">Height</td><td align=\"center\" valign=\"top\">Width</td><td align=\"center\" valign=\"top\">Size</td><td align=\"center\" valign=\"top\">Page Position</td><td valign=\"top\">Status Material</td><td align=\"center\" valign=\"top\">File Name</td><td align=\"center\" valign=\"top\">Card Rate</td><td valign=\"top\" align=\"center\">Disc. Rate</td><td valign=\"top\" align=\"center\">Agrred Rate</td><td align=\"center\" valign=\"top\">Insertion Sta.</td><td align=\"center\" valign=\"top\">Latest By</td><td align=\"center\" valign=\"top\">Repeating</td><td align=\"center\" valign=\"top\">Premium</td><td align=\"center\" valign=\"top\">Pre(%)</td><td align=\"center\" valign=\"top\">Premium 1</td><td align=\"center\" valign=\"top\">Pre(%)</td><td align=\"center\" valign=\"top\">Pre Allowed</td><td align=\"center\" valign=\"top\">Adv Cat.</td><td valign=\"top\">Bill Status</td><td valign=\"top\">Paid Ins.</td><td valign=\"top\" >Solo Rate</td><td valign=\"top\" >Gross Amt</td><td valign=\"top\">Upload</td><td valign=\"top\" style=\"display:none;\">id</td></tr>";
        /*new change ankur 10 feb*/
        str = "<div id=\"bookdiv\" runat=\"server\" style=\"OVERFLOW: auto; WIDTH: 827px; HEIGHT: 325px;border:gray 1px Groove; \">";
        str = str + "<table cellpadding=\"1\" cellspacing=\"1\" id=\"gridtab\" width=\"1000px\" border=1>";
        str = str + "<tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\">";

        // No.

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[1].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\" >No.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">No.</td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(0).text == "enable") {
                str += "<td align=\"center\" valign=\"top\" >No.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">No.</td>";
            }
        }

        //Edition
        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[3].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\" >Edition</td>"
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Edition</td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(1).text == "enable") {
                str += "<td align=\"center\" valign=\"top\" >Edition</td>"
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Edition</td>";
            }
        }

        // Date
        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[5].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\" align=\"center\">Date</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Date</td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(2).text == "enable") {
                str += "<td valign=\"top\" align=\"center\">Date</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Date</td>";
            }
        }

        //Ad Sub Cat

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[7].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Ad Sub Cat.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(3).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Ad Sub Cat.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
            }
        }

        //Color
        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[9].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Color</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Color</td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(4).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Color</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Color</td>";
            }
        }

        // Height Width Column

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[11].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Height</td>";
                str += "<td align=\"center\" valign=\"top\">Width</td>";
                str += "<td align=\"center\" valign=\"top\">Col.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Height</td>";
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Width</td>";
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Col.</td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(5).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Height</td>";
                str += "<td align=\"center\" valign=\"top\">Width</td>";
                str += "<td align=\"center\" valign=\"top\">Col.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Height</td>";
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Width</td>";
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Col.</td>";
            }
        }

        // Insertion State

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[13].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Insertion Sta.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Insertion Sta.</td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(6).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Insertion Sta.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Insertion Sta.</td>";
            }
        }

        // Status Materaial

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[15].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\">Status Material</td>";
            }
            else {
                str += "<td valign=\"top\" style=\"display:none;\">Status Material</td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(7).text == "enable") {
                str += "<td valign=\"top\">Status Material</td>";
            }
            else {
                str += "<td valign=\"top\" style=\"display:none;\">Status Material</td>";
            }
        }

        //File Name

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[17].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">File Name</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">File Name</td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(8).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">File Name</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">File Name</td>";
            }
        }

        ////////////////////////
        // Upload

        if (showordisable == "1") {
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[19].childNodes[0].nodeValue == "enable") {
                    str = str + "<td valign=\"top\" id=\"uploadA\" onclick=\"return uploadimageQBCAll();\" disabled >Upload</td>";
                }
                else {
                    str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(9).text == "enable") {
                    str = str + "<td valign=\"top\" id=\"uploadA\" onclick=\"return uploadimageQBCAll();\" disabled>Upload</td>";
                }
                else {
                    str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
                }
            }

        }
        else {
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[19].childNodes[0].nodeValue == "enable") {
                    str = str + "<td valign=\"top\" id='uploadA' onclick=\"return uploadimageQBCAll();\" style=\"cursor:pointer;color:red;\">Upload</td>";
                }
                else {
                    str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(9).text == "enable") {
                    str = str + "<td valign=\"top\" id='uploadA' onclick=\"return uploadimageQBCAll();\" style=\"cursor:pointer;color:red;\">Upload</td>";
                }
                else {
                    str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
                }
            }
        }

        // split button

        if (showordisable == "1") {
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[73].childNodes[0].nodeValue == "enable" && document.getElementById('hiddenuomdesc').value == "CD") {
                    str = str + "<td valign=\"top\" ></td>";
                }
                else {
                    str += "<td align=\"center\" valign=\"top\" ></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(36).text == "enable" && document.getElementById('hiddenuomdesc').value == "CD") {
                    str = str + "<td valign=\"top\" ></td>";
                }
                else {
                    str += "<td align=\"center\" valign=\"top\"></td>";
                }
            }

        }
        else {
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[73].childNodes[0].nodeValue == "enable" && document.getElementById('hiddenuomdesc').value == "CD") {
                    str = str + "<td valign=\"top\">Split</td>";
                }
                else {
                    str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(36).text == "enable" && document.getElementById('hiddenuomdesc').value == "CD") {
                    str = str + "<td valign=\"top\">Split</td>";
                }
                else {
                    str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
                }
            }
        }
        // SUB EDITION DETAIL button

        if (showordisable == "1") {
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[75].childNodes[0].nodeValue == "enable") {
                    str = str + "<td valign=\"top\" ></td>";
                }
                else {
                    str += "<td align=\"center\" valign=\"top\" ></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(37).text == "enable") {
                    str = str + "<td valign=\"top\" ></td>";
                }
                else {
                    str += "<td align=\"center\" valign=\"top\"></td>";
                }
            }

        }
        else {
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[75].childNodes[0].nodeValue == "enable") {
                    str = str + "<td valign=\"top\">Split</td>";
                }
                else {
                    str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(37).text == "enable") {
                    str = str + "<td valign=\"top\">Split</td>";
                }
                else {
                    str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
                }
            }
        }
        /*new change ankur 10 feb*/

        // Page Position

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[21].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Page Position</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(10).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Page Position</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Latest By

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[23].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Latest By</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(11).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Latest By</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Repeating

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[25].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Repeating</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(12).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Repeating</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        //Premium 1

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[27].childNodes[0].nodeValue == "enable") {
                str = str + "<td align=\"center\" valign=\"top\">Premium 2</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(13).text == "enable") {
                str = str + "<td align=\"center\" valign=\"top\">Premium 2</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Premium Percent

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[29].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Pre(%)</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(14).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Pre(%)</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Premium Allowed

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[31].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Pre Allowed</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(15).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Pre Allowed</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Adv Cat.

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[33].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Adv Cat.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(16).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Adv Cat.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Bill Status

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[35].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\">Bill Status</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(17).text == "enable") {
                str += "<td valign=\"top\">Bill Status</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Paid Insertions

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[37].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\">Paid Ins.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(18).text == "enable") {
                str += "<td valign=\"top\">Paid Ins.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Solo Rate

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[39].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\" >Solo Rate</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(19).text == "enable") {
                str += "<td valign=\"top\" >Solo Rate</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Gross Amount

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[41].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\" >Gross Amt</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(20).text == "enable") {
                str += "<td valign=\"top\" >Gross Amt</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Page Number

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[43].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\" >Page No.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(21).text == "enable") {
                str += "<td valign=\"top\" >Page No.</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Remarks

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[45].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\" >Caption</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(22).text == "enable") {
                str += "<td valign=\"top\" >Caption</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Bill Amount

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[47].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\" >Bill Amt</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(23).text == "enable") {
                str += "<td valign=\"top\" >Bill Amt</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Bill RAte

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[49].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\" >Bill Rate</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(24).text == "enable") {
                str += "<td valign=\"top\" >Bill Rate</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Card Rate

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[51].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Card Rate</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(25).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Card Rate</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Discount Rate

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[53].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\" align=\"center\">Disc. Rate</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(26).text == "enable") {
                str += "<td valign=\"top\" align=\"center\">Disc. Rate</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        //Agreed Rate

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[55].childNodes[0].nodeValue == "enable") {
                str += "<td valign=\"top\" align=\"center\">Agreed Rate</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(27).text == "enable") {
                str += "<td valign=\"top\" align=\"center\">Agreed Rate</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Size

        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[57].childNodes[0].nodeValue == "enable") {
                str = str + "<td align=\"center\" valign=\"top\">Size</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(28).text == "enable") {
                str = str + "<td align=\"center\" valign=\"top\">Size</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Ad Sub Cat3
        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[59].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Ad Sub Cat3</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(29).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Ad Sub Cat3</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Ad Sub Cat4
        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[61].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Ad Sub Cat4</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(30).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Ad Sub Cat4</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // Ad Sub Cat5
        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[63].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Ad Sub Cat5</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(31).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Ad Sub Cat5</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }

        // for logo
        if (browser != "Microsoft Internet Explorer") {
            if (xmlObj.childNodes[23].childNodes[65].childNodes[0].nodeValue == "enable") {
                str += "<td align=\"center\" valign=\"top\">Logo H</td><td align=\"center\" valign=\"top\">Logo W</td><td align=\"center\" valign=\"top\">Logo Name</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td><td align=\"center\" valign=\"top\" style=\"display:none;\"></td><td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }
        else {
            if (xmlObj.childNodes(11).childNodes(32).text == "enable") {
                str += "<td align=\"center\" valign=\"top\">Logo H</td><td align=\"center\" valign=\"top\">Logo W</td><td align=\"center\" valign=\"top\">Logo Name</td>";
            }
            else {
                str += "<td align=\"center\" valign=\"top\" style=\"display:none;\"></td><td align=\"center\" valign=\"top\" style=\"display:none;\"></td><td align=\"center\" valign=\"top\" style=\"display:none;\"></td>";
            }
        }



        str = str + "<td align=\"center\" id=\"tdlpckcode\" style=\"display:none;\" valign=\"top\">PKG CODE</td>";

        str = str + "<td align=\"center\" id=\"tdlinserts\" style=\"display:none;\" valign=\"top\">INSERTS</td>";
        //str=str+"<td align=\"center\" valign=\"top\">Size</td>";
        ////////////////////  
        if (document.getElementById('hiddenlogomatter').value == "yes") {
            str = str + "<td align=\"center\" id=\"tdlogoname\" style=\"display:block;\" valign=\"top\">Logo Name</td><td valign=\"top\" id=\"tdlogoh\" style=\"display:block;\" align=\"center\">Logo H</td><td valign=\"top\" id=\"tdlogow\" style=\"display:block;\" align=\"center\">Logo W</td><td valign=\"top\" id=\"tdlogoup\" style=\"display:block;\" align=\"center\">Logo Upload</td>";
        }
        else {
            str = str + "<td align=\"center\" id=\"tdlogoname\" style=\"display:none;\" valign=\"top\">Logo Name</td><td valign=\"top\" id=\"tdlogoh\" style=\"display:none;\" align=\"center\">Logo H</td><td valign=\"top\" id=\"tdlogow\" style=\"display:none;\" align=\"center\">Logo W</td><td valign=\"top\" id=\"tdlogoup\" style=\"display:none;\" align=\"center\">Logo Upload</td>";
        }



        str = str + "</tr>";
        var insprev = 0;
        for (i = 0; i <= count; i++) {
            var id = "Text" + i;
            editid = "edit" + i;
            inserts = "ins" + i;

            str = str + "<tr>";
            //////this is to bind the no of inserts and edition
            ///////////////////////// when we chk i.e. ds.Tables[0].Rows[i].Insert_status=="billed" it means that whoes inser
            ////////////////// status is booking only that insertion line we can change
            //  if(ds.Tables[0].Rows[i].no_insert=="1")
            // {
            if (arrEdition_Item == "")
                arrEdition_Item = ds.Tables[0].Rows[i].Edition;
            else
                arrEdition_Item = arrEdition_Item + "," + ds.Tables[0].Rows[i].Edition;
            // }
            if (ds.Tables[0].Rows[i].Insert_status == "billed") {
                // No.
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[1].childNodes[0].nodeValue == "enable") {
                        if (insprev != ds.Tables[0].Rows[i].no_insert) {
                            insprev = ds.Tables[0].Rows[i].no_insert;
                            str = str + "<td align=\"center\" id=" + inserts + " title='Edit Insert' class=\"TextField\" >" + ds.Tables[0].Rows[i].no_insert + "</td>";
                        }
                        else
                            str = str + "<td align=\"center\" id=" + inserts + " class=\"TextField\" >" + ds.Tables[0].Rows[i].no_insert + "</td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">No.</td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(0).text == "enable") {
                        if (insprev != ds.Tables[0].Rows[i].no_insert) {
                            insprev = ds.Tables[0].Rows[i].no_insert;
                            str = str + "<td align=\"center\" id=" + inserts + " title='Edit Insert' class=\"TextField\" >" + ds.Tables[0].Rows[i].no_insert + "</td>";
                        }
                        else
                            str = str + "<td align=\"center\" id=" + inserts + " class=\"TextField\" >" + ds.Tables[0].Rows[i].no_insert + "</td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">No.</td>";
                    }
                }

                // Edition
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[3].childNodes[0].nodeValue == "enable") {
                        str = str + "<td class=\"dtGrid\" ><input class=\"btextforgridedition\" type=\"text\" disabled id=" + editid + " value='" + ds.Tables[0].Rows[i].Edition + "'></td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">No.</td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(1).text == "enable") {
                        str = str + "<td class=\"dtGrid\" ><input class=\"btextforgridedition\" type=\"text\" disabled id=" + editid + " value='" + ds.Tables[0].Rows[i].Edition + "'></td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">No.</td>";
                    }
                }


            }
            else {
                // No.
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[1].childNodes[0].nodeValue == "enable") {
                        str = str + "<td align=\"center\" id=" + inserts + " class=\"TextField\" >" + ds.Tables[0].Rows[i].no_insert + "</td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">No.</td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(0).text == "enable") {
                        str = str + "<td align=\"center\" id=" + inserts + " class=\"TextField\" >" + ds.Tables[0].Rows[i].no_insert + "</td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">No.</td>";
                    }
                }

                // Edition
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[3].childNodes[0].nodeValue == "enable") {
                        str = str + "<td class=\"dtGrid\" ><input class=\"btextforgridedition\" type=\"text\" disabled id=" + editid + " value='" + ds.Tables[0].Rows[i].Edition + "'></td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">No.</td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(1).text == "enable") {
                        str = str + "<td class=\"dtGrid\" ><input class=\"btextforgridedition\" type=\"text\" disabled id=" + editid + " value='" + ds.Tables[0].Rows[i].Edition + "'></td>";
                    }
                    else {
                        str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">No.</td>";
                    }
                }

            }
            //////this is to bind the insertion date   publish
            var mode = "1";
            var insdat = ds.Tables[0].Rows[i].Insert_date

            //            if(document.getElementById('hiddendateformat').value=="mm/dd/yyyy")
            //            {
            //                calselect=ds.Tables[0].Rows[i].Insert_date.split("/");
            //                caldate[i]=calselect[1];
            //                caldatemonth[i]=calselect[0];
            //                caldateyear[i]=calselect[2];
            //                  
            //            }

            var getdateforexe = savedateinto(ds.Tables[0].Rows[i].Insert_date, mode);
            if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[5].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgriddate\" type=\"text\" disabled id=" + id + " value='" + getdateforexe + "' ></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(2).text == "enable") {
                        str = str + "<td><input class=\"btextforgriddate\" type=\"text\" disabled id=" + id + " value='" + getdateforexe + "' ></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

            }
            else {
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[5].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgriddate\" type=\"text\" disabled id=" + id + " value=" + getdateforexe + " ></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(2).text == "enable") {
                        str = str + "<td><input class=\"btextforgriddate\" type=\"text\" disabled id=" + id + " value=" + getdateforexe + " ></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
            }
            ////this is to bind the Ad sub cat drop down

            adsubcat = "ads" + i;
            if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[7].childNodes[0].nodeValue == "enable") {
                        if (ds.Tables[0].Rows[i].Ad_sub_cat != null) {
                            if (i == 0) {
                                str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\"  id=" + adsubcat + " value=" + ds.Tables[0].Rows[i].Ad_sub_cat + "><div id='agdiv' Width=100px Height=50px style='position:absolute;display: none;'><select name='aglist' onClick=\"FillSubCatinGrid();\"  id='aglist' CssClass='btextlist' size=4 Width=100px Height=50px></select></div></td>";
                            }
                            else {
                                str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\"  id=" + adsubcat + " value=" + ds.Tables[0].Rows[i].Ad_sub_cat + "></td>";
                            }
                        }
                        else {
                            if (i == 0) {
                                str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\"  id=" + adsubcat + " ><div id='agdiv' Width=100px Height=50px style='position:absolute;display: none;'><select name='aglist' onClick=\"FillSubCatinGrid();\"  id='aglist' CssClass='btextlist' size=4 Width=100px Height=50px></select></div></td>";
                            }
                            else {
                                str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\"  id=" + adsubcat + " ></td>";
                            }
                        }
                        //                        str=str+"<td><select disabled id="+adsubcat+" class=\"dropdownforgridqbc\" >";
                        //                        // this is to bind adv sub cat drop down  
                        //                        if(ds.Tables[0].Rows[i].Ad_sub_cat=="0")
                        //                        {  
                        //                            str=str+"<option value=\"0\" selected=\"true\">select</option>";
                        //                        }
                        //                        else
                        //                        {
                        //                            str=str+"<option value=\"0\" >select</option>";
                        //                        }
                        //                               
                        //                        for(l=0;l<=ds.Tables[3].Rows.length-1;l++)
                        //                        {
                        //                            if(ds.Tables[3].Rows[l].Adv_Subcat_Code==ds.Tables[0].Rows[i].Ad_sub_cat && ds.Tables[0].Rows[i].Ad_sub_cat!="0")
                        //                            {
                        //                                str=str+"<option value="+ds.Tables[3].Rows[l].Adv_Subcat_Code+" selected="+ds.Tables[0].Rows[i].Ad_sub_cat+">"+ds.Tables[3].Rows[l].Adv_Subcat_Code+"</option>";
                        //                            }
                        //                            else 
                        //                            {
                        //                                str=str+"<option value="+ds.Tables[3].Rows[l].Adv_Subcat_Code+">"+ds.Tables[3].Rows[l].Adv_Subcat_Code+"</option>";
                        //                            }
                        //                        }
                        //                        
                        //                        str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(3).text == "enable") {
                        if (ds.Tables[0].Rows[i].Ad_sub_cat != null) {
                            if (i == 0) {
                                str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\"  id=" + adsubcat + " value=" + ds.Tables[0].Rows[i].Ad_sub_cat + "><div id='agdiv' Width=100px Height=50px style='position:absolute;display: none;'><select name='aglist' onClick=\"FillSubCatinGrid();\"   id='aglist' CssClass='btextlist' size=4 Width=100px Height=50px></select></div></td>";
                            }
                            else {
                                str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\"  id=" + adsubcat + " value=" + ds.Tables[0].Rows[i].Ad_sub_cat + "></td>";
                            }
                        }
                        else {
                            if (i == 0) {
                                str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\"  id=" + adsubcat + " ><div id='agdiv' Width=100px Height=50px style='position:absolute;display: none;'><select name='aglist' onClick=\"FillSubCatinGrid();\"  id='aglist' CssClass='btextlist' size=4 Width=100px Height=50px></select></div></td>";
                            }
                            else {
                                str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\"  id=" + adsubcat + " ></td>";
                            }
                        }
                        //                        str=str+"<td><select disabled id="+adsubcat+" class=\"dropdownforgridqbc\" >";
                        //                        // this is to bind adv sub cat drop down  
                        //                        if(ds.Tables[0].Rows[i].Ad_sub_cat=="0")
                        //                        {  
                        //                            str=str+"<option value=\"0\" selected=\"true\">select</option>";
                        //                        }
                        //                        else
                        //                        {
                        //                            str=str+"<option value=\"0\" >select</option>";
                        //                        }
                        //                               
                        //                        for(l=0;l<=ds.Tables[3].Rows.length-1;l++)
                        //                        {
                        //                            if(ds.Tables[3].Rows[l].Adv_Subcat_Code==ds.Tables[0].Rows[i].Ad_sub_cat && ds.Tables[0].Rows[i].Ad_sub_cat!="0")
                        //                            {
                        //                                str=str+"<option value="+ds.Tables[3].Rows[l].Adv_Subcat_Code+" selected="+ds.Tables[0].Rows[i].Ad_sub_cat+">"+ds.Tables[3].Rows[l].Adv_Subcat_Code+"</option>";
                        //                            }
                        //                            else 
                        //                            {
                        //                                str=str+"<option value="+ds.Tables[3].Rows[l].Adv_Subcat_Code+">"+ds.Tables[3].Rows[l].Adv_Subcat_Code+"</option>";
                        //                            }
                        //                        }
                        //                        
                        //                        str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
            }
            else {
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[7].childNodes[0].nodeValue == "enable") {
                        if (ds.Tables[0].Rows[i].Ad_sub_cat != null) {
                            if (i == 0) {
                                str = str + "<td><input class=\"btextforgrid\"  type=\"text\" disabled  id=" + adsubcat + " value=" + ds.Tables[0].Rows[i].Ad_sub_cat + "><div id='agdiv' Width=100px Height=50px style='position:absolute;display: none;'><select name='aglist' onClick=\"FillSubCatinGrid();\"  id='aglist' CssClass='btextlist' size=4 Width=100px Height=50px></select></div></td>";
                            }
                            else {
                                str = str + "<td><input class=\"btextforgrid\" type=\"text\" disabled  id=" + adsubcat + " value=" + ds.Tables[0].Rows[i].Ad_sub_cat + "></td>";
                            }
                        }
                        else {
                            if (i == 0) {
                                str = str + "<td><input class=\"btextforgrid\"  type=\"text\"  disabled id=" + adsubcat + " ><div id='agdiv' Width=100px Height=50px style='position:absolute;display: none;'><select name='aglist' onClick=\"FillSubCatinGrid();\" id='aglist' CssClass='btextlist' size=4 Width=100px Height=50px></select></div></td>";
                            }
                            else {
                                str = str + "<td><input class=\"btextforgrid\" type=\"text\" disabled  id=" + adsubcat + "></td>";
                            }
                        }
                        //                        str=str+"<td><select id="+adsubcat+" class=\"dropdownforgridqbc\" onchange=\"getvalueintoinserts("+adsubcat+","+inserts+","+ds.Tables[0].Rows[i].no_insert+");\">";
                        //                        // this is to bind adv sub cat drop down  
                        //                        if(ds.Tables[0].Rows[i].Ad_sub_cat=="0")
                        //                        {  
                        //                            str=str+"<option value=\"0\" selected=\"true\">select</option>";
                        //                        }
                        //                        else
                        //                        {
                        //                            str=str+"<option value=\"0\" >select</option>";
                        //                        }
                        //                               
                        //                        for(l=0;l<=ds.Tables[3].Rows.length-1;l++)
                        //                        {
                        //                            if(ds.Tables[3].Rows[l].Adv_Subcat_Code==ds.Tables[0].Rows[i].Ad_sub_cat && ds.Tables[0].Rows[i].Ad_sub_cat!="0")
                        //                            {
                        //                                str=str+"<option value="+ds.Tables[3].Rows[l].Adv_Subcat_Code+" selected="+ds.Tables[0].Rows[i].Ad_sub_cat+">"+ds.Tables[3].Rows[l].Adv_Subcat_Code+"</option>";
                        //                            }
                        //                            else 
                        //                            {
                        //                                str=str+"<option value="+ds.Tables[3].Rows[l].Adv_Subcat_Code+">"+ds.Tables[3].Rows[l].Adv_Subcat_Code+"</option>";
                        //                            }
                        //                        }
                        //                        
                        //                        str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(3).text == "enable") {
                        if (ds.Tables[0].Rows[i].Ad_sub_cat != null) {
                            if (i == 0) {
                                str = str + "<td><input class=\"btextforgrid\" disabled  type=\"text\"  id=" + adsubcat + " value=" + ds.Tables[0].Rows[i].Ad_sub_cat + "><div id='agdiv' Width=100px Height=50px style='position:absolute;display: none;'><select name='aglist' onClick=\"FillSubCatinGrid();\"  id='aglist' CssClass='btextlist' size=4 Width=100px Height=50px></select></div></td>";
                            }
                            else {
                                str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\"  id=" + adsubcat + " value=" + ds.Tables[0].Rows[i].Ad_sub_cat + "></td>";
                            }
                        }
                        else {
                            if (i == 0) {
                                str = str + "<td><input class=\"btextforgrid\" disabled  type=\"text\"  id=" + adsubcat + " ><div id='agdiv' Width=100px Height=50px style='position:absolute;display: none;'><select name='aglist' id='aglist' onClick=\"FillSubCatinGrid();\" CssClass='btextlist' size=4 Width=100px Height=50px></select></div></td>";
                            }
                            else {
                                str = str + "<td><input class=\"btextforgrid\"  disabled type=\"text\"  id=" + adsubcat + "></td>";
                            }
                        }
                        //                        str=str+"<td><select id="+adsubcat+" class=\"dropdownforgridqbc\" onchange=\"getvalueintoinserts("+adsubcat+","+inserts+","+ds.Tables[0].Rows[i].no_insert+");\">";
                        //                        // this is to bind adv sub cat drop down  
                        //                        if(ds.Tables[0].Rows[i].Ad_sub_cat=="0")
                        //                        {  
                        //                            str=str+"<option value=\"0\" selected=\"true\">select</option>";
                        //                        }
                        //                        else
                        //                        {
                        //                            str=str+"<option value=\"0\" >select</option>";
                        //                        }
                        //                               
                        //                        for(l=0;l<=ds.Tables[3].Rows.length-1;l++)
                        //                        {
                        //                            if(ds.Tables[3].Rows[l].Adv_Subcat_Code==ds.Tables[0].Rows[i].Ad_sub_cat && ds.Tables[0].Rows[i].Ad_sub_cat!="0")
                        //                            {
                        //                                str=str+"<option value="+ds.Tables[3].Rows[l].Adv_Subcat_Code+" selected="+ds.Tables[0].Rows[i].Ad_sub_cat+">"+ds.Tables[3].Rows[l].Adv_Subcat_Code+"</option>";
                        //                            }
                        //                            else 
                        //                            {
                        //                                str=str+"<option value="+ds.Tables[3].Rows[l].Adv_Subcat_Code+">"+ds.Tables[3].Rows[l].Adv_Subcat_Code+"</option>";
                        //                            }
                        //                        }
                        //                        
                        //                        str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
            }



            colid = "col" + i;
            noofcol = "nocol" + i;
            if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[9].childNodes[0].nodeValue == "enable") {
                        str += "<td><input class=\"btextsmallsize\" disabled type=\"text\"  id=" + colid + " value=" + ds.Tables[0].Rows[i].Col_code + "></td>";
                        //                        str=str+"<td><select disabled id="+colid+" class=\"dropdownforgridqbc\" >";
                        //                        //this is to bind the color drop down
                        //                        str=str+"<option value=\"0\" selected=\"true\">select</option>";
                        //                        for(j=0;j<=ds.Tables[1].Rows.length-1;j++)
                        //                        {
                        //                            if(ds.Tables[1].Rows[j].col_Code==ds.Tables[0].Rows[i].Col_code && ds.Tables[0].Rows[i].Col_code!="0")
                        //                            {
                        //                                str=str + "<option value="+ds.Tables[1].Rows[j].col_Code+" selected="+ds.Tables[0].Rows[i].Col_code+">"+ds.Tables[1].Rows[j].col_Code+"</option>";    
                        //                            }
                        //                            else
                        //                            {
                        //                                str=str + "<option value="+ds.Tables[1].Rows[j].col_Code+">"+ds.Tables[1].Rows[j].col_Code+"</option>";    
                        //                            }
                        //                        }
                        //                        
                        //                        str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(4).text == "enable") {
                        str += "<td><input class=\"btextsmallsize\" disabled type=\"text\"  id=" + colid + " value=" + ds.Tables[0].Rows[i].Col_code + "></td>";
                        //                        str=str+"<td><select disabled id="+colid+" class=\"dropdownforgridqbc\" >";
                        //                        //this is to bind the color drop down
                        //                        str=str+"<option value=\"0\" selected=\"true\">select</option>";
                        //                        for(j=0;j<=ds.Tables[1].Rows.length-1;j++)
                        //                        {
                        //                            if(ds.Tables[1].Rows[j].col_Code==ds.Tables[0].Rows[i].Col_code && ds.Tables[0].Rows[i].Col_code!="0")
                        //                            {
                        //                                str=str + "<option value="+ds.Tables[1].Rows[j].col_Code+" selected="+ds.Tables[0].Rows[i].Col_code+">"+ds.Tables[1].Rows[j].col_Code+"</option>";    
                        //                            }
                        //                            else
                        //                            {
                        //                                str=str + "<option value="+ds.Tables[1].Rows[j].col_Code+">"+ds.Tables[1].Rows[j].col_Code+"</option>";    
                        //                            }
                        //                        }
                        //                        
                        //                        str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
            }
            else {
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[9].childNodes[0].nodeValue == "enable") {
                        str += "<td><input class=\"btextsmallsize\" disabled  type=\"text\"  id=" + colid + " value=" + ds.Tables[0].Rows[i].Col_code + "></td>";
                        //                        str=str+"<td><select id="+colid+" class=\"dropdownforgridqbc\" onchange=\"getvalueintoinsertsforcolor("+colid+","+inserts+","+ds.Tables[0].Rows[i].no_insert+")\";>";
                        //                        //this is to bind the color drop down
                        //                        str=str+"<option value=\"0\" selected=\"true\">select</option>";
                        //                        for(j=0;j<=ds.Tables[1].Rows.length-1;j++)
                        //                        {
                        //                            if(ds.Tables[1].Rows[j].col_Code==ds.Tables[0].Rows[i].Col_code && ds.Tables[0].Rows[i].Col_code!="0")
                        //                            {
                        //                                str=str + "<option value="+ds.Tables[1].Rows[j].col_Code+" selected="+ds.Tables[0].Rows[i].Col_code+">"+ds.Tables[1].Rows[j].col_Code+"</option>";    
                        //                            }
                        //                            else
                        //                            {
                        //                                str=str + "<option value="+ds.Tables[1].Rows[j].col_Code+">"+ds.Tables[1].Rows[j].col_Code+"</option>";    
                        //                            }
                        //                        }
                        //                        
                        //                        str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(4).text == "enable") {
                        str += "<td><input class=\"btextsmallsize\" disabled  type=\"text\"  id=" + colid + " value=" + ds.Tables[0].Rows[i].Col_code + "></td>";
                        //                        str=str+"<td><select id="+colid+" class=\"dropdownforgridqbc\" onchange=\"getvalueintoinsertsforcolor("+colid+","+inserts+","+ds.Tables[0].Rows[i].no_insert+")\";>";
                        //                        //this is to bind the color drop down
                        //                        str=str+"<option value=\"0\" selected=\"true\">select</option>";
                        //                        for(j=0;j<=ds.Tables[1].Rows.length-1;j++)
                        //                        {
                        //                            if(ds.Tables[1].Rows[j].col_Code==ds.Tables[0].Rows[i].Col_code && ds.Tables[0].Rows[i].Col_code!="0")
                        //                            {
                        //                                str=str + "<option value="+ds.Tables[1].Rows[j].col_Code+" selected="+ds.Tables[0].Rows[i].Col_code+">"+ds.Tables[1].Rows[j].col_Code+"</option>";    
                        //                            }
                        //                            else
                        //                            {
                        //                                str=str + "<option value="+ds.Tables[1].Rows[j].col_Code+">"+ds.Tables[1].Rows[j].col_Code+"</option>";    
                        //                            }
                        //                        }
                        //                        
                        //                        str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
            }


            premid = "prem" + i;
            prem1id = "premone" + i;
            insertsta = "inssta" + i;
            height = "hei" + i;
            width = "wid" + i;
            size = "siz" + i;
            pagepost = "pagpos" + i;
            var class_hei = ds.Tables[0].Rows[i].Height;
            var class_wid = ds.Tables[0].Rows[i].Width;
            var class_noofcol;
            if (ds.Tables[0].Rows[i].Height == null) {
                class_hei = "";
            }
            if (ds.Tables[0].Rows[i].Width == null) {
                class_wid = "";
            }
            if (ds.Tables[0].Rows[i].No_ofcolumn == null) {
                class_noofcol = "";
            }
            else {
                class_noofcol = ds.Tables[0].Rows[i].No_ofcolumn
            }
            //////// on change function is there to calculate the size 
            //str=str+"</select></td><td><input class=\"btextforbook\" id="+height+" type=\"text\"  value=\"\"></td><td><input class=\"btextforbook\" id="+width+" onchange=\"return gettotalsize("+height+","+width+","+i+");\" type=\"text\"  value=\"\"></td><td><input class=\"btextforbook\" disabled id="+size+" type=\"text\"  value=\"\"></td><td><select id="+premid+" class=\"dropdownforbook\" onchange=\"return getpercenprem("+premid+","+i+");\"  >";

            if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[11].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextsmallsizeH\" disabled id=" + height + " type=\"text\"  value=" + class_hei + "></td><td><input class=\"btextsmallsizeH\" disabled id=" + width + "  type=\"text\"  value=" + class_wid + "></td><td><input class=\"btextsmallsizeH\" disabled id=" + noofcol + " type=\"text\"  value=" + class_noofcol + "></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(5).text == "enable") {
                        str = str + "<td><input class=\"btextsmallsizeH\" disabled id=" + height + " type=\"text\"  value=" + class_hei + "></td><td><input class=\"btextsmallsizeH\" disabled id=" + width + "  type=\"text\"  value=" + class_wid + "></td><td><input class=\"btextsmallsizeH\" disabled id=" + noofcol + " type=\"text\"  value=" + class_noofcol + "></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
            }
            else {
                if (document.getElementById('hiddenuomdesc').value == "CD" && document.getElementById('txtcolum').value == "") {
                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[11].childNodes[0].nodeValue == "enable") {
                            str = str + "<td><input class=\"btextsmallsizeH\" style=\"background-color: White;\" id=" + height + "  type=\"text\"  value=" + class_hei + "></td><td><input class=\"btextsmallsizeH\" style=\"background-color: White;\" id=" + width + " type=\"text\"  value=" + class_wid + "></td><td><input class=\"btextsmallsizeH\" disabled style=\"background-color: Gray;\" id=" + noofcol + " type=\"text\"  value=" + class_noofcol + "></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(5).text == "enable") {
                            str = str + "<td><input class=\"btextsmallsizeH\" style=\"background-color: White;\" id=" + height + "  type=\"text\"  value=" + class_hei + "></td><td><input class=\"btextsmallsizeH\" style=\"background-color: White;\" id=" + width + "  type=\"text\"  value=" + class_wid + "></td><td><input class=\"btextsmallsizeH\" disabled style=\"background-color: Gray;\" id=" + noofcol + " type=\"text\"  value=" + class_noofcol + "></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }
                }
                else if (document.getElementById('hiddenuomdesc').value == "CD" && document.getElementById('txtcolum').value != "") {
                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[11].childNodes[0].nodeValue == "enable") {
                            str = str + "<td><input class=\"btextsmallsizeH\" style=\"background-color: White;\" id=" + height + "  type=\"text\"  value=" + class_hei + "></td><td><input class=\"btextsmallsizeH\" disabled style=\"background-color: Gray;\" id=" + width + "  type=\"text\"  value=" + class_wid + "></td><td><input class=\"btextsmallsizeH\" style=\"background-color: White;\"  id=" + noofcol + " type=\"text\"  value=" + class_noofcol + "></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(5).text == "enable") {
                            str = str + "<td><input class=\"btextsmallsizeH\" style=\"background-color: White;\" id=" + height + " type=\"text\"  value=" + class_hei + "></td><td><input class=\"btextsmallsizeH\" disabled style=\"background-color: Gray;\" id=" + width + "  type=\"text\"  value=" + class_wid + "></td><td><input class=\"btextsmallsizeH\" style=\"background-color: White;\"  id=" + noofcol + " type=\"text\"  value=" + class_noofcol + "></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }
                }
                else {
                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[11].childNodes[0].nodeValue == "enable") {
                            str = str + "<td><input class=\"btextsmallsizeH\" disabled style=\"background-color: Gray;\" id=" + height + "  type=\"text\"  value=" + class_hei + "></td><td><input class=\"btextsmallsizeH\" disabled style=\"background-color: Gray;\" disabled id=" + width + " type=\"text\"  value=" + class_wid + "></td><td><input class=\"btextsmallsizeH\" disabled style=\"background-color: Gray;\" id=" + noofcol + " type=\"text\"  value=" + class_noofcol + "></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(5).text == "enable") {
                            str = str + "<td><input class=\"btextsmallsizeH\" disabled style=\"background-color: Gray;\" id=" + height + "  type=\"text\"  value=" + class_hei + "></td><td><input class=\"btextsmallsizeH\" disabled style=\"background-color: Gray;\" disabled id=" + width + " type=\"text\"  value=" + class_wid + "></td><td><input class=\"btextsmallsizeH\" disabled style=\"background-color: Gray;\" id=" + noofcol + " type=\"text\"  value=" + class_noofcol + "></td>";
                        }
                        else {
                            str = str + "<td style=\"display:none;\"></td>";
                        }
                    }
                }

            }



            ////////this is to bind the status of insertion drop down


            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[13].childNodes[0].nodeValue == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        // str=str+"<td><select disabled id="+insertsta+" class=\"dropdownforgrid\">";
                        str = str + "<td><input class=\"btextforgrid\" disabled  type=\"text\" id=" + insertsta + " value=" + ds.Tables[0].Rows[i].Insert_status + " ></td>";
                    }
                    else {
                        //str=str+"<td><select id="+insertsta+" class=\"dropdownforgrid\" onchange=\"javascript:return chkpublishdate('"+insertsta+"','"+id+"')\">";
                        str = str + "<td><input class=\"btextforgrid\"   type=\"text\" id=" + insertsta + " value=" + ds.Tables[0].Rows[i].Insert_status + "></td>";
                    }
                    //                    var b=0;
                    //                    for(b=1;b<=xmlObj.childNodes[19].childNodes.length-1;)
                    //                    {//xmlObj.childNodes[19].childNodes[1].childNodes[0].nodeValue
                    //                    /*new change ankur 10 feb*/
                    //                        if(xmlObj.childNodes[19].childNodes[b].childNodes[0].nodeValue==ds.Tables[0].Rows[i].Insert_status && copydata!="copy")
                    //                        {
                    //                            str=str+"<option value="+xmlObj.childNodes[19].childNodes[b+2].childNodes[0].nodeValue+" selected="+ds.Tables[0].Rows[i].Insert_status+">"+xmlObj.childNodes[19].childNodes[b].childNodes[0].nodeValue+"</option>";
                    //                        }
                    //                        else if(copydata=="copy" && xmlObj.childNodes[19].childNodes[b].childNodes[0].nodeValue=="Booked" || xmlObj.childNodes[19].childNodes[b].childNodes[0].nodeValue=="booked")
                    //                        {
                    //                            str=str+"<option value="+xmlObj.childNodes[19].childNodes[b+2].childNodes[0].nodeValue+" selected="+xmlObj.childNodes[19].childNodes[b+2].childNodes[0].nodeValue+">"+xmlObj.childNodes[19].childNodes[b].childNodes[0].nodeValue+"</option>";
                    //                        }
                    //                        else
                    //                        {
                    //                            str=str+"<option value="+xmlObj.childNodes[19].childNodes[b+2].childNodes[0].nodeValue+">"+xmlObj.childNodes[19].childNodes[b].childNodes[0].nodeValue+"</option>";                                
                    //                        }                                    
                    //                        b=b+4;
                    //                    }
                    //                    str=str+"</select></td>";
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(0).text == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        // str=str+"<td><select disabled id="+insertsta+" class=\"dropdownforgrid\">";
                        str = str + "<td><input class=\"btextforgrid\" disabled  type=\"text\" id=" + insertsta + " value=" + ds.Tables[0].Rows[i].Insert_status + " ></td>";
                    }
                    else {
                        // str=str+"<td><select id="+insertsta+" class=\"dropdownforgrid\" onchange=\"javascript:return chkpublishdate('"+insertsta+"','"+id+"')\">";
                        str = str + "<td><input class=\"btextforgrid\" disabled   type=\"text\" id=" + insertsta + " value=" + ds.Tables[0].Rows[i].Insert_status + "  ></td>";
                    }
                    //                    var b=0;

                    //                    for(b=0;b<=xmlObj.childNodes(9).childNodes.length-1;b++)
                    //                    {
                    //                    /*new change ankur 10 feb*/
                    //                        if(xmlObj.childNodes(9).childNodes(b+1).text==ds.Tables[0].Rows[i].Insert_status && copydata!="copy")
                    //                        {
                    //                            str=str+"<option value="+xmlObj.childNodes(9).childNodes(b+1).text+" selected="+ds.Tables[0].Rows[i].Insert_status+">"+xmlObj.childNodes(9).childNodes(b).text+"</option>";
                    //                        }
                    //                        else if(copydata=="copy" && xmlObj.childNodes(9).childNodes(b+1).text=="Booked" || xmlObj.childNodes(9).childNodes(b+1).text=="booked")
                    //                        {
                    //                            str=str+"<option value="+xmlObj.childNodes(9).childNodes(b+1).text+" selected="+xmlObj.childNodes(9).childNodes(b+1).text+">"+xmlObj.childNodes(9).childNodes(b).text+"</option>";
                    //                        }
                    //                        else
                    //                        {
                    //                            str=str+"<option value="+xmlObj.childNodes(9).childNodes(b+1).text+">"+xmlObj.childNodes(9).childNodes(b).text+"</option>";                                
                    //                        }                                    
                    //                        b=b+1;
                    //                    }
                    //                    str=str+"</select></td>";
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }


            /////////////this is to bind the status material drop down
            matsta = "mat" + i;
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[15].childNodes[0].nodeValue == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        //str=str+"<td><select disabled id="+matsta+" class=\"dropdownforgrid\" >";
                        str = str + "<td><input class=\"btextforgrid\" disabled  id=" + matsta + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Status_material + "></td>";
                    }
                    else {
                        //str=str+"<td><select id="+matsta+" class=\"dropdownforgrid\">";
                        str = str + "<td><input class=\"btextforgrid\" disabled   id=" + matsta + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Status_material + "></td>";
                    }
                    /////this is to bind the status material dropdown
                    //                    if(ds.Tables[0].Rows[i].Status_material=="0")
                    //                    {
                    //                        str=str+"<option value=\"0\" selected="+ds.Tables[0].Rows[i].Status_material+">Select</option>";
                    //                    }
                    //                    else
                    //                    {
                    //                         str=str+"<option value=\"0\">Select</option>";
                    //                    }
                    //                    if(ds.Tables[0].Rows[i].Status_material=="hardcopy")
                    //                    {
                    //                        str=str+"<option value=\"hardcopy\" selected="+ds.Tables[0].Rows[i].Status_material+">Hard Copy</option>";
                    //                    }
                    //                    else
                    //                    {
                    //                        str=str+"<option value=\"hardcopy\">Hard Copy</option>";
                    //                    }
                    //                    if(ds.Tables[0].Rows[i].Status_material=="softcopy")
                    //                    {
                    //                        str=str+"<option value=\"softcopy\" selected="+ds.Tables[0].Rows[i].Status_material+">Soft Copy</option>";
                    //                    }
                    //                    else
                    //                    {
                    //                        str=str+"<option value=\"softcopy\">Soft Copy</option>";
                    //                    }
                    //                    if(ds.Tables[0].Rows[i].Status_material=="cd")
                    //                    {
                    //                        str=str+"<option value=\"cd\" selected="+ds.Tables[0].Rows[i].Status_material+">CD</option>";
                    //                    }
                    //                    else
                    //                    {
                    //                         str=str+"<option value=\"cd\">CD</option>";
                    //                    }
                    //                    if(ds.Tables[0].Rows[i].Status_material=="other")
                    //                    {
                    //                        str=str+"<option value=\"other\" selected="+ds.Tables[0].Rows[i].Status_material+">Others</option>";
                    //                    }
                    //                    else
                    //                    {
                    //                        str=str+"<option value=\"other\">Others</option>";
                    //                    }
                    //                    
                    //                    str=str+"</select></td>";
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(7).text == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        //str=str+"<td><select disabled id="+matsta+" class=\"dropdownforgrid\" >";
                        str = str + "<td><input class=\"btextforgrid\" disabled  id=" + matsta + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Status_material + "></td>";
                    }
                    else {
                        // str=str+"<td><select id="+matsta+" class=\"dropdownforgrid\">";
                        str = str + "<td><input class=\"btextforgrid\" disabled   id=" + matsta + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Status_material + "></td>";
                    }
                    /////this is to bind the status material dropdown
                    //                    if(ds.Tables[0].Rows[i].Status_material=="0")
                    //                    {
                    //                        str=str+"<option value=\"0\" selected="+ds.Tables[0].Rows[i].Status_material+">Select</option>";
                    //                    }
                    //                    else
                    //                    {
                    //                         str=str+"<option value=\"0\">Select</option>";
                    //                    }
                    //                    if(ds.Tables[0].Rows[i].Status_material=="hardcopy")
                    //                    {
                    //                        str=str+"<option value=\"hardcopy\" selected="+ds.Tables[0].Rows[i].Status_material+">Hard Copy</option>";
                    //                    }
                    //                    else
                    //                    {
                    //                        str=str+"<option value=\"hardcopy\">Hard Copy</option>";
                    //                    }
                    //                    if(ds.Tables[0].Rows[i].Status_material=="softcopy")
                    //                    {
                    //                        str=str+"<option value=\"softcopy\" selected="+ds.Tables[0].Rows[i].Status_material+">Soft Copy</option>";
                    //                    }
                    //                    else
                    //                    {
                    //                        str=str+"<option value=\"softcopy\">Soft Copy</option>";
                    //                    }
                    //                    if(ds.Tables[0].Rows[i].Status_material=="cd")
                    //                    {
                    //                        str=str+"<option value=\"cd\" selected="+ds.Tables[0].Rows[i].Status_material+">CD</option>";
                    //                    }
                    //                    else
                    //                    {
                    //                         str=str+"<option value=\"cd\">CD</option>";
                    //                    }
                    //                    if(ds.Tables[0].Rows[i].Status_material=="other")
                    //                    {
                    //                        str=str+"<option value=\"other\" selected="+ds.Tables[0].Rows[i].Status_material+">Others</option>";
                    //                    }
                    //                    else
                    //                    {
                    //                        str=str+"<option value=\"other\">Others</option>";
                    //                    }
                    //                    
                    //                    str=str+"</select></td>";
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }
            cardid = "card" + i;
            //////////// for file name
            filename = "fil" + i;
            var fname = "";
            if (ds.Tables[0].Rows[i].File_name != null) {
                fname = ds.Tables[0].Rows[i].File_name;
            }
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[17].childNodes[0].nodeValue == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        str = str + "<td><input class=\"btextforgrid\" type=\"text\" disabled id=" + filename + " disabled  value='" + fname + "'></td>";
                    }
                    else {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + filename + " disabled  value='" + fname + "'></td>";
                    }
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(8).text == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        str = str + "<td><input class=\"btextforgrid\" type=\"text\" disabled id=" + filename + " disabled  value='" + fname + "'></td>";
                    }
                    else {
                        str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled  value='" + fname + "'></td>";
                    }
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }

            //this is to upload the image

            picfield = "pic" + i;
            var upl = "upload" + i;
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[19].childNodes[0].nodeValue == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        str = str + "<td width=\"50px\"><input disabled  class=\"button1\" type=\"button\" id=" + upl + " Value=\"Attachment\" ></td>";
                    }
                    else {
                        str = str + "<td width=\"50px\"><input  class=\"button1\" type=\"button\" id=" + upl + " Value=\"Attachment\" ></td>";
                    }
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(9).text == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        str = str + "<td width=\"50px\"><input disabled  class=\"button1\" type=\"button\" id=" + upl + " Value=\"Attachment\" ></td>";
                    }
                    else {
                        str = str + "<td width=\"50px\"><input  class=\"button1\" type=\"button\" id=" + upl + " Value=\"Attachment\" ></td>";
                    }
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }

            // for split button

            var splt = "splt" + i;
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[73].childNodes[0].nodeValue == "enable" && document.getElementById('hiddenuomdesc').value == "CD" && ds.Tables[0].Rows[i].PRIORITY != '1' && ds.Tables[0].Rows[i].PRIORITY != null && ds.Tables[0].Rows[i].SPLIT == 'Y')// ds.Tables[0].Rows[i].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        str = str + "<td width=\"50px\"><input   class=\"buttonsplit\" type=\"button\" id=" + splt + " Value=\"Split\" ></td>"; //onclick=\"return opensplitedition('"+ds.Tables[0].Rows[i].Edition+"','"+i+"');\"
                    }
                    else {
                        str = str + "<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" id=" + splt + " Value=\"Split\" ></td>";
                    }
                }
                else {
                    str = str + "<td ></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(36).text == "enable" && document.getElementById('hiddenuomdesc').value == "CD" && ds.Tables[0].Rows[i].PRIORITY != '1' && ds.Tables[0].Rows[i].PRIORITY != null && ds.Tables[0].Rows[i].SPLIT == 'Y')// ds.Tables[0].Rows[i].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        str = str + "<td width=\"50px\"><input   class=\"buttonsplit\" type=\"button\" id=" + splt + " Value=\"Split\"  ></td>";
                    }
                    else {
                        str = str + "<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" id=" + splt + " Value=\"Split\" ></td>";
                    }
                }
                else {
                    str = str + "<td ></td>";
                }
            }
            // for sub edition detail button

            var subedi = "subedi" + i;
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[75].childNodes[0].nodeValue == "enable")// ds.Tables[0].Rows[i].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        str = str + "<td width=\"50px\"><input   class=\"buttonsplit\" type=\"button\" id=" + subedi + " Value=\"Detail\"></td>";
                    }
                    else {
                        str = str + "<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" id=" + subedi + " Value=\"Detail\"></td>";
                    }
                }
                else {
                    str = str + "<td ></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(37).text == "enable")// ds.Tables[0].Rows[i].PUBCODE!=document.getElementById('hiddenqbcpub').value && document.getElementById('hiddenqbcpub').value!="0")
                {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        str = str + "<td width=\"50px\"><input   class=\"buttonsplit\" type=\"button\" id=" + subedi + " Value=\"Detail\"></td>";
                    }
                    else {
                        str = str + "<td width=\"50px\"><input  class=\"buttonsplit\" type=\"button\" id=" + subedi + " Value=\"Detail\" ></td>";
                    }
                }
                else {
                    str = str + "<td ></td>";
                }
            }
            ////this loop is to bind the page position
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[21].childNodes[0].nodeValue == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        //  str=str+"<td><select disabled id="+pagepost+" class=\"dropdownforgrid\">";
                        str = str + "<td><input type=\"text\" disabled id=" + pagepost + " class=\"dropdownforgridqbc\" ></td>";
                    }
                    else {
                        pagstr = "fir"
                        // str=str+"<td><select id="+pagepost+" class=\"dropdownforgrid\" onchange=\"return getpageprem("+pagepost+","+i+",'"+pagstr+"');\">";
                        str = str + "<td><input type=\"text\" disabled id=" + pagepost + " class=\"dropdownforgridqbc\" ></td>";
                    }

                    //                    str=str+"<option value=\"0\" selected=\"true\">select</option>";
                    //                    for(p=0;p<=ds.Tables[7].Rows.length-1;p++)
                    //                    {
                    //                        if(ds.Tables[7].Rows[p].pos_type_code==ds.Tables[0].Rows[i].Page_post && ds.Tables[0].Rows[i].Page_post!="0")
                    //                        {
                    //                            str=str+"<option value="+ds.Tables[7].Rows[p].pos_type_code+" selected="+ds.Tables[0].Rows[i].Page_post+">"+ds.Tables[7].Rows[p].pos_type_code+"</option>";
                    //                        }
                    //                        else
                    //                        {
                    //                            str=str+"<option value="+ds.Tables[7].Rows[p].pos_type_code+">"+ds.Tables[7].Rows[p].pos_type_code+"</option>";
                    //                        }
                    //                    }
                    //                    
                    //                    str=str+"</select></td>";
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(10).text == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        // str=str+"<td><select disabled id="+pagepost+" class=\"dropdownforgrid\">";
                        str = str + "<td><input type=\"text\" disabled id=" + pagepost + " class=\"dropdownforgridqbc\" ></td>";
                    }
                    else {
                        pagstr = "fir"
                        // str=str+"<td><select id="+pagepost+" class=\"dropdownforgrid\" onchange=\"return getpageprem("+pagepost+","+i+",'"+pagstr+"');\">";
                        str = str + "<td><input type=\"text\" disabled  id=" + pagepost + " class=\"dropdownforgridqbc\" ></td>";
                    }

                    //                    str=str+"<option value=\"0\" selected=\"true\">select</option>";
                    //                    for(p=0;p<=ds.Tables[7].Rows.length-1;p++)
                    //                    {
                    //                        if(ds.Tables[7].Rows[p].pos_type_code==ds.Tables[0].Rows[i].Page_post && ds.Tables[0].Rows[i].Page_post!="0")
                    //                        {
                    //                            str=str+"<option value="+ds.Tables[7].Rows[p].pos_type_code+" selected="+ds.Tables[0].Rows[i].Page_post+">"+ds.Tables[7].Rows[p].pos_type_code+"</option>";
                    //                        }
                    //                        else
                    //                        {
                    //                            str=str+"<option value="+ds.Tables[7].Rows[p].pos_type_code+">"+ds.Tables[7].Rows[p].pos_type_code+"</option>";
                    //                        }
                    //                    }
                    //                    
                    //                    str=str+"</select></td>";
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }


            /////this for the latest date
            ////////////this is to for larest date
            late = "lat" + i;
            repeat = "rep" + i;
            var latdate;
            var repeatdat;
            if (ds.Tables[0].Rows[i].Latest_by == null) {
                latdate = "";
            }
            else {
                latdate = ds.Tables[0].Rows[i].Latest_by;
            }
            if (ds.Tables[0].Rows[i].Repeating_date == null) {
                repeatdat = ""
            }
            else {
                repeatdat = ds.Tables[0].Rows[i].Repeating_date
            }


            if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[23].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" type=\"text\" disabled id=" + late + "  value=" + latdate + "></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(11).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" type=\"text\" disabled id=" + late + "  value=" + latdate + "></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[25].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" type=\"text\" disabled id=" + repeat + "  value=" + repeatdat + "></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(12).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" type=\"text\" disabled id=" + repeat + "  value=" + repeatdat + "></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

            }
            else {
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[23].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + late + "  value='" + latdate + "'  ></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(11).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + late + "  value='" + latdate + "'  ></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[25].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + repeat + "  value='" + repeatdat + "'></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(12).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" type=\"text\" id=" + repeat + "  value='" + repeatdat + "' ></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
            }
            namecode = "one";

            // if(showordisable=="1" || ds.Tables[0].Rows[i].Insert_status=="billed" || ds.Tables[0].Rows[i].Insert_status=="publish")
            //  { 
            //      str=str+"<td><select disabled id="+premid+" class=\"dropdownforgrid\" onchange=\"return getpercenprem("+premid+","+i+",'"+namecode+"');\"  >";
            //  }
            //  else
            //   {
            //       str=str+"<td><select id="+premid+" class=\"dropdownforgrid\" onchange=\"return getpercenprem("+premid+","+i+",'"+namecode+"');\"  >";
            //   }    
            //     var k;
            //      ///this is to bind the premium drop down
            //      str=str+"<option value=\"0\" selected=\"true\">select</option>";
            //       for(k=0;k<=ds.Tables[2].Rows.length-1;k++)
            //        {
            ////////on click function is there to get the prem % on premium drop down change
            //            if(ds.Tables[2].Rows[k].Premiumcode==ds.Tables[0].Rows[i].Premium1 && ds.Tables[0].Rows[i].Premium1!="0")
            //            {
            //                   str=str+"  <option value="+ds.Tables[2].Rows[k].Premiumcode+" selected="+ds.Tables[0].Rows[i].Premium1+">"+ds.Tables[2].Rows[k].premiumname+"</option>"
            //       }   
            //        else
            //        {
            //str=str+"  <option value="+ds.Tables[2].Rows[k].Premiumcode+">"+ds.Tables[2].Rows[k].premiumname+"</option>"
            //        }                                         
            //    }

            premper = "premper" + i;
            premper1 = "premperone" + i;
            adtypid = "adtyp" + i;
            namecode = "two";
            preall = "preall" + i;
            adcat = "adcat" + i;
            paid = "pai" + i;
            page = "pgpre" + i;
            pageprem = "pagper" + i;

            //                            
            var h;
            if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                //str=str+"</select></td><td><input class=\"btextsmallsize\" type=\"text\" disabled id="+premper1+" value="+prempercentage2+"></td>"
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[27].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input type=\"text\" id=" + page + " disabled class=\"dropdownforgridqbc\"></td>";
                        //                        str=str+"<td><select id="+page+" class=\"dropdownforgridqbc\" disabled  >";
                        //                        /////this is to bind the premium 2 drop down
                        //                        str=str+"  <option value=\"0\" selected=\"true\">Select</option>";
                        //                        for(h=0;h<=ds.Tables[7].Rows.length-1;h++)
                        //                        {
                        //                            ////////on click function is there to get the prem % on premium drop down change
                        //                            if(ds.Tables[7].Rows[h].pos_type_code==ds.Tables[0].Rows[i].Page_prem && ds.Tables[0].Rows[i].Page_prem!="0")
                        //                            {
                        //                                str=str+"  <option value="+ds.Tables[7].Rows[h].pos_type_code+" selected="+ds.Tables[0].Rows[i].Page_prem+">"+ds.Tables[7].Rows[h].pos_type_code+"</option>"
                        //                            }
                        //                            else
                        //                            {
                        //                                str=str+"  <option value="+ds.Tables[7].Rows[h].pos_type_code+">"+ds.Tables[7].Rows[h].pos_type_code+"</option>"
                        //                            }
                        //                        }
                        //                        str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(13).text == "enable") {
                        str = str + "<td><input type=\"text\" id=" + page + " disabled class=\"dropdownforgridqbc\"></td>";
                        //                        str=str+"<td><select id="+page+" class=\"dropdownforgridqbc\" disabled  >";
                        //                        /////this is to bind the premium 2 drop down
                        //                        str=str+"  <option value=\"0\" selected=\"true\">Select</option>";
                        //                        for(h=0;h<=ds.Tables[7].Rows.length-1;h++)
                        //                        {
                        //                            ////////on click function is there to get the prem % on premium drop down change
                        //                            if(ds.Tables[7].Rows[h].pos_type_code==ds.Tables[0].Rows[i].Page_prem && ds.Tables[0].Rows[i].Page_prem!="0")
                        //                            {
                        //                                str=str+"  <option value="+ds.Tables[7].Rows[h].pos_type_code+" selected="+ds.Tables[0].Rows[i].Page_prem+">"+ds.Tables[7].Rows[h].pos_type_code+"</option>"
                        //                            }
                        //                            else
                        //                            {
                        //                                str=str+"  <option value="+ds.Tables[7].Rows[h].pos_type_code+">"+ds.Tables[7].Rows[h].pos_type_code+"</option>"
                        //                            }
                        //                        }
                        //                        str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                ////this is to bind the per for page premium

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[29].childNodes[0].nodeValue == "enable") {
                        //str=str+"<td><input disabled class=\"btextsmallsize\" type=\"text\" id="+pageprem+" value="+ds.Tables[0].Rows[i].page_per+"></td>"
                        str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id=" + pageprem + " value=\"\"></td>"
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(14).text == "enable") {
                        // str=str+"<td><input disabled class=\"btextsmallsize\" type=\"text\" id="+pageprem+" value="+ds.Tables[0].Rows[i].page_per+"></td>"
                        str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id=" + pageprem + " value=\"\"></td>"
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                /////////////////////////////////////////////// 

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[31].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><select disabled id=" + preall + " class=\"dropdownforgrid\">";
                        //////////////this is to bind the drop down for accepting the premium

                        str = str + "<option value=\"0\">Select</option>";
                        str = str + "<option value=\"1\">Yes</option>";
                        str = str + "<option value=\"2\">No</option>";

                        str = str + "</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(15).text == "enable") {
                        str = str + "<td><select disabled id=" + preall + " class=\"dropdownforgrid\">";
                        //////////////this is to bind the drop down for accepting the premium

                        str = str + "<option value=\"0\">Select</option>";
                        str = str + "<option value=\"1\">Yes</option>";
                        str = str + "<option value=\"2\">No</option>";

                        str = str + "</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

            }
            else {
                pagstr = "sec"
                //str=str+"</select></td><td><input class=\"btextsmallsize\" type=\"text\" id="+premper1+" value="+prempercentage2+"></td>"

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[27].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input type=\"text\" id=" + page + "  class=\"dropdownforgridqbc\"></td>";
                        //                        str=str+"<td><select id="+page+" class=\"dropdownforgridqbc\" onchange=\"return getpageprem("+page+","+i+",'"+pagstr+"');\"  >";
                        //                        /////this is to bind the premium 2 drop down
                        //                        str=str+"  <option value=\"0\" selected=\"true\">Select</option>";
                        //                        for(h=0;h<=ds.Tables[7].Rows.length-1;h++)
                        //                        {
                        //                            ////////on click function is there to get the prem % on premium drop down change
                        //                            if(ds.Tables[7].Rows[h].pos_type_code==ds.Tables[0].Rows[i].Page_prem && ds.Tables[0].Rows[i].Page_prem!="0")
                        //                            {
                        //                                str=str+"  <option value="+ds.Tables[7].Rows[h].pos_type_code+" selected="+ds.Tables[0].Rows[i].Page_prem+">"+ds.Tables[7].Rows[h].pos_type_code+"</option>"
                        //                            }
                        //                            else
                        //                            {
                        //                                str=str+"  <option value="+ds.Tables[7].Rows[h].pos_type_code+">"+ds.Tables[7].Rows[h].pos_type_code+"</option>"
                        //                            }
                        //                        }
                        //                        str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(13).text == "enable") {
                        str = str + "<td><input type=\"text\" id=" + page + "  class=\"dropdownforgridqbc\"></td>";
                        //                        str=str+"<td><select id="+page+" class=\"dropdownforgridqbc\" onchange=\"return getpageprem("+page+","+i+",'"+pagstr+"');\"  >";
                        //                        /////this is to bind the premium 2 drop down
                        //                        str=str+"  <option value=\"0\" selected=\"true\">Select</option>";
                        //                        for(h=0;h<=ds.Tables[7].Rows.length-1;h++)
                        //                        {
                        //                            ////////on click function is there to get the prem % on premium drop down change
                        //                            if(ds.Tables[7].Rows[h].pos_type_code==ds.Tables[0].Rows[i].Page_prem && ds.Tables[0].Rows[i].Page_prem!="0")
                        //                            {
                        //                                str=str+"  <option value="+ds.Tables[7].Rows[h].pos_type_code+" selected="+ds.Tables[0].Rows[i].Page_prem+">"+ds.Tables[7].Rows[h].pos_type_code+"</option>"
                        //                            }
                        //                            else
                        //                            {
                        //                                str=str+"  <option value="+ds.Tables[7].Rows[h].pos_type_code+">"+ds.Tables[7].Rows[h].pos_type_code+"</option>"
                        //                            }
                        //                        }
                        //                        str=str+"</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                ////this is to bind the per for page premium
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[29].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id=" + pageprem + " value=" + ds.Tables[0].Rows[i].page_per + "></td>"
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(14).text == "enable") {
                        str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id=" + pageprem + " value=" + ds.Tables[0].Rows[i].page_per + "></td>"
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                ///////////////////////////////////////////////    

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[31].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><select id=" + preall + " class=\"dropdownforgrid\">";
                        //////////////this is to bind the drop down for accepting the premium

                        str = str + "<option value=\"0\">Select</option>";
                        str = str + "<option value=\"1\">Yes</option>";
                        str = str + "<option value=\"2\">No</option>";

                        str = str + "</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(15).text == "enable") {
                        str = str + "<td><select id=" + preall + " class=\"dropdownforgrid\">";
                        //////////////this is to bind the drop down for accepting the premium

                        str = str + "<option value=\"0\">Select</option>";
                        str = str + "<option value=\"1\">Yes</option>";
                        str = str + "<option value=\"2\">No</option>";

                        str = str + "</select></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
            }

            //

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[33].childNodes[0].nodeValue == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        // str=str+"<td><select disabled id="+adcat+" class=\"dropdownforgridqbc\">";
                        str = str + "<td><input type=\"type=text\" id=" + adcat + " disabled class=\"dropdownforgridqbc\"></td>";
                    }
                    else {
                        //str=str+"<td><select id="+adcat+" class=\"dropdownforgridqbc\">";    
                        str = str + "<td><input type=\"type=text\" id=" + adcat + "  class=\"dropdownforgridqbc\"></td>";
                    }
                    //                    var o;
                    //                    ///this loop is to bind the ad category
                    //                    str=str+"<option value=\"0\" selected=\"true\">select</option>";
                    //                    for(o=0;o<=ds.Tables[6].Rows.length-1;o++)
                    //                    {
                    //                        if(ds.Tables[6].Rows[o].adv_cat_code==ds.Tables[0].Rows[i].Ad_cat && ds.Tables[0].Rows[i].Ad_cat!="0")
                    //                        {
                    //                            str=str+"<option value="+ds.Tables[6].Rows[o].adv_cat_code+" selected="+ds.Tables[0].Rows[i].Ad_cat+">"+ds.Tables[6].Rows[o].adv_cat_code+"</option>";
                    //                        }
                    //                        else
                    //                        {
                    //                            str=str+"<option value="+ds.Tables[6].Rows[o].adv_cat_code+">"+ds.Tables[6].Rows[o].adv_cat_code+"</option>";
                    //                        }
                    //                    }

                    //                    str=str+"</select></td>";
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(16).text == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        //str=str+"<td><select disabled id="+adcat+" class=\"dropdownforgridqbc\">";
                        str = str + "<td><input type=\"type=text\" id=" + adcat + " disabled class=\"dropdownforgridqbc\" ></td>";
                    }
                    else {
                        //str=str+"<td><select id="+adcat+" class=\"dropdownforgridqbc\">";    
                        str = str + "<td><input type=\"type=text\" id=" + adcat + "  class=\"dropdownforgridqbc\" ></td>";
                    }
                    //                    var o;
                    //                    ///this loop is to bind the ad category
                    //                    str=str+"<option value=\"0\" selected=\"true\">select</option>";
                    //                    for(o=0;o<=ds.Tables[6].Rows.length-1;o++)
                    //                    {
                    //                        if(ds.Tables[6].Rows[o].adv_cat_code==ds.Tables[0].Rows[i].Ad_cat && ds.Tables[0].Rows[i].Ad_cat!="0")
                    //                        {
                    //                            str=str+"<option value="+ds.Tables[6].Rows[o].adv_cat_code+" selected="+ds.Tables[0].Rows[i].Ad_cat+">"+ds.Tables[6].Rows[o].adv_cat_code+"</option>";
                    //                        }
                    //                        else
                    //                        {
                    //                            str=str+"<option value="+ds.Tables[6].Rows[o].adv_cat_code+">"+ds.Tables[6].Rows[o].adv_cat_code+"</option>";
                    //                        }
                    //                    }

                    //                    str=str+"</select></td>";
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }

            ////////////////////////
            billstat = "bill" + i;



            /////////////this function is to bind the bill status dropdown
            //debugger;
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[35].childNodes[0].nodeValue == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        //str=str+"<td><select disabled id="+billstat+" class=\"dropdownforgrid\">";
                        str = str + "<td><input type=\"type=text\" disabled id=" + billstat + " class=\"dropdownforgridqbc\" value=" + ds.Tables[0].Rows[i].Bill_status + "></td>";
                    }
                    else {
                        //str=str+"<td><select id="+billstat+" class=\"dropdownforgrid\">";
                        str = str + "<td><input type=\"type=text\"  id=" + billstat + " class=\"dropdownforgridqbc\" value=" + ds.Tables[0].Rows[i].Bill_status + "></td>";
                    }
                    var c = 0;
                    //                    for(c=1;c<=xmlObj.childNodes[3].childNodes.length-1;)
                    //                    {
                    //                        if(xmlObj.childNodes[3].childNodes[c].childNodes[0].nodeValue==ds.Tables[0].Rows[i].Bill_status)
                    //                          {
                    //                                str=str+"<option value="+xmlObj.childNodes[3].childNodes[c+2].childNodes[0].nodeValue+" selected="+ds.Tables[0].Rows[i].Bill_status+">"+xmlObj.childNodes[3].childNodes[c].childNodes[0].nodeValue+"</option>"; 
                    //                          }
                    //                          else
                    //                          {
                    //                               str=str+"<option value="+xmlObj.childNodes[3].childNodes[c+2].childNodes[0].nodeValue+">"+xmlObj.childNodes[3].childNodes[c].childNodes[0].nodeValue+"</option>";   
                    //                          }
                    //                          c=c+4;
                    //                    }
                    //                    str=str+"</select></td>";
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(17).text == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        //str=str+"<td><select disabled id="+billstat+" class=\"dropdownforgrid\">";
                        str = str + "<td><input type=\"type=text\" disabled id=" + billstat + " class=\"dropdownforgridqbc\" value=" + ds.Tables[0].Rows[i].Bill_status + "></td>";
                    }
                    else {
                        //  str=str+"<td><select id="+billstat+" class=\"dropdownforgrid\">";
                        str = str + "<td><input type=\"type=text\"  id=" + billstat + " class=\"dropdownforgridqbc\" value=" + ds.Tables[0].Rows[i].Bill_status + "></td>";
                    }

                    //                    var c=0;

                    //                    for(c=0;c<=xmlObj.childNodes(1).childNodes.length-1;c++)
                    //                    {
                    //                        if(xmlObj.childNodes(1).childNodes(c+1).text==ds.Tables[0].Rows[i].Bill_status)
                    //                          {
                    //                                str=str+"<option value="+xmlObj.childNodes(1).childNodes(c+1).text+" selected="+ds.Tables[0].Rows[i].Bill_status+">"+xmlObj.childNodes(1).childNodes(c).text+"</option>";
                    //                                
                    //                          }
                    //                          else
                    //                          {
                    //                                str=str+"<option value="+xmlObj.childNodes(1).childNodes(c+1).text+">"+xmlObj.childNodes(1).childNodes(c).text+"</option>";
                    //                                
                    //                          }
                    //                          c=c+1;
                    //                    }
                    //                    str=str+"</select></td>";
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }


            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[37].childNodes[0].nodeValue == "enable") {
                    if (ds.Tables[8].Rows.length > 0) {
                        if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[8].Rows[0].Paid_permission == "0") {
                            str = str + "<td><select disabled id=" + paid + " class=\"dropdownforgridsmallP\" >";
                        }
                        else {
                            if (ds.Tables[8].Rows[0].Paid_permission == "0") {
                                str = str + "<td><select id=" + paid + " disabled class=\"dropdownforgridsmallP\" >";
                            }
                            else {
                                str = str + "<td><select id=" + paid + " class=\"dropdownforgridsmallP\" >";
                            }
                        }
                    }
                    else {
                        str = str + "<td><select id=" + paid + " disabled class=\"dropdownforgridsmallP\" >";
                    }
                    //str=str+"<option value=\"0\">Select</option>";


                    if (ds.Tables[0].Rows[i].Pai_free_ins == "Y") {
                        str = str + "<option value=\"Y\" selected=" + ds.Tables[0].Rows[i].Pai_free_ins + ">Yes</option>";
                    }
                    else {
                        str = str + "<option value=\"Y\" >Yes</option>";
                    }
                    if (ds.Tables[0].Rows[i].Pai_free_ins == "N") {
                        str = str + "<option value=\"N\" selected=" + ds.Tables[0].Rows[i].Pai_free_ins + ">No</option>";
                    }
                    else {
                        str = str + "<option value=\"N\">No</option>";
                    }
                    if (ds.Tables[0].Rows[i].Pai_free_ins == "P") {
                        str = str + "<option value=\"P\" selected=" + ds.Tables[0].Rows[i].Pai_free_ins + ">Paid</option>";
                    }
                    else {
                        str = str + "<option value=\"P\" >Paid</option>";
                    }
                    str = str + "</select></td>";
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(18).text == "enable") {
                    if (ds.Tables[8].Rows.length > 0) {
                        if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish" || ds.Tables[8].Rows[0].Paid_permission == "0") {
                            str = str + "<td><select disabled id=" + paid + " class=\"dropdownforgridsmallP\" >";
                        }
                        else {
                            if (ds.Tables[8].Rows[0].Paid_permission == "0") {
                                str = str + "<td><select id=" + paid + " disabled class=\"dropdownforgridsmallP\" >";
                            }
                            else {
                                str = str + "<td><select id=" + paid + " class=\"dropdownforgridsmallP\" >";
                            }
                        }
                    }
                    else {
                        str = str + "<td><select id=" + paid + " disabled class=\"dropdownforgridsmallP\">";
                    }
                    //str=str+"<option value=\"0\">Select</option>";


                    if (ds.Tables[0].Rows[i].Pai_free_ins == "Y") {
                        str = str + "<option value=\"Y\" selected=" + ds.Tables[0].Rows[i].Pai_free_ins + ">Yes</option>";
                    }
                    else {
                        str = str + "<option value=\"Y\" >Yes</option>";
                    }
                    if (ds.Tables[0].Rows[i].Pai_free_ins == "N") {
                        str = str + "<option value=\"N\" selected=" + ds.Tables[0].Rows[i].Pai_free_ins + ">No</option>";
                    }
                    else {
                        str = str + "<option value=\"N\">No</option>";
                    }
                    if (ds.Tables[0].Rows[i].Pai_free_ins == "P") {
                        str = str + "<option value=\"P\" selected=" + ds.Tables[0].Rows[i].Pai_free_ins + ">Paid</option>";
                    }
                    else {
                        str = str + "<option value=\"P\">Paid</option>";
                    }
                    str = str + "</select></td>";
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }
            ///////////////////////////////////////////////////////


            //this is to upload the image


            //str=str+"</select></td>";

            solo = "sol" + i;
            gross = "gro" + i;
            if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[39].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" disabled id=" + solo + "  value=" + ds.Tables[0].Rows[i].Solo_rate + "></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(19).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" disabled id=" + solo + "  value=" + ds.Tables[0].Rows[i].Solo_rate + "></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[41].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" disabled id=" + gross + "  value=" + ds.Tables[0].Rows[i].Gross_rate + "></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(20).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" disabled id=" + gross + "  value=" + ds.Tables[0].Rows[i].Gross_rate + "></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

            }
            else {
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[39].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + solo + "  value=" + ds.Tables[0].Rows[i].Solo_rate + "></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(19).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + solo + "  value=" + ds.Tables[0].Rows[i].Solo_rate + "></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }


                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[41].childNodes[0].nodeValue == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + gross + "  value=" + ds.Tables[0].Rows[i].Gross_rate + "></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(20).text == "enable") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + gross + "  value=" + ds.Tables[0].Rows[i].Gross_rate + "></td>";
                    }
                    else {
                        str = str + "<td style=\"display:none;\"></td>";
                    }
                }

            }

            pageno_inserts = "pagno" + i; ;
            remark_inserts = "rem" + i;
            billamt = "ba" + i;


            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[43].childNodes[0].nodeValue == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        str = str + "<td><input class=\"btextforgrid\" disabled class=\"btextsmallsize\"   type=\"text\" id=" + pageno_inserts + "  value=" + ds.Tables[0].Rows[i].Page_no + "></td>";
                    }
                    else {
                        str = str + "<td><input class=\"btextforgrid\" class=\"btextsmallsize\"  type=\"text\" id=" + pageno_inserts + "  value=" + ds.Tables[0].Rows[i].Page_no + "></td>";
                    }
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(21).text == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        str = str + "<td><input class=\"btextforgrid\" disabled class=\"btextsmallsize\"  type=\"text\" id=" + pageno_inserts + "  value=" + ds.Tables[0].Rows[i].Page_no + "></td>";
                    }
                    else {
                        str = str + "<td><input class=\"btextforgrid\" class=\"btextsmallsize\"  type=\"text\" id=" + pageno_inserts + "  value=" + ds.Tables[0].Rows[i].Page_no + "></td>";
                    }
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }

            var remark_text = ds.Tables[0].Rows[i].Remarks;
            if (remark_text == null || remark_text == "null")
                remark_text = ""

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[45].childNodes[0].nodeValue == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        str = str + "<td><input class=\"btextforgridedition\" disabled class=\"btextsmallsize\"  type=\"text\" id=" + remark_inserts + "   title='" + remark_text + "' value='" + remark_text + "'></td>";
                    }
                    else {
                        str = str + "<td><input  class=\"btextforgridedition\"   type=\"text\" id=" + remark_inserts + "  title='" + remark_text + "' value=" + remark_text + "></td>";
                    }
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(22).text == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        str = str + "<td><input class=\"btextforgridedition\" disabled class=\"btextsmallsize\"  type=\"text\" id=" + remark_inserts + " title='" + remark_text + "'  value='" + remark_text + "'></td>";
                    }
                    else {
                        str = str + "<td><input  class=\"btextforgridedition\"   type=\"text\" id=" + remark_inserts + " title='" + remark_text + "'  value=" + remark_text + "></td>";
                    }
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }

            billrate = "br" + i;
            var grid_billamt = ds.Tables[0].Rows[i].Bill_Amt;
            var grid_billrate = ds.Tables[0].Rows[i].Bill_rate;
            if (grid_billamt == null) {
                grid_billamt = "";
            }
            if (grid_billrate == null) {
                grid_billrate = "";
            }

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[47].childNodes[0].nodeValue == "enable") {
                    str = str + "<td><input class=\"btextforinsertright\" disabled class=\"btextsmallsize\" type=\"text\" id=" + billamt + "  value=" + grid_billamt + "></td>";
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(23).text == "enable") {
                    str = str + "<td><input class=\"btextforinsertright\" disabled class=\"btextsmallsize\"  type=\"text\" id=" + billamt + "  value=" + grid_billamt + "></td>";
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[49].childNodes[0].nodeValue == "enable") {
                    str = str + "<td><input class=\"btextforinsertright\" disabled class=\"btextsmallsize\" type=\"text\" id=" + billrate + "  value=" + grid_billrate + "></td>";
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(24).text == "enable") {
                    str = str + "<td><input class=\"btextforinsertright\" disabled class=\"btextsmallsize\"  type=\"text\" id=" + billrate + "  value=" + grid_billrate + "></td>";
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }


            ////agreedrate


            //this is to fill card rate

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[51].childNodes[0].nodeValue == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" disabled id=" + cardid + " value=" + ds.Tables[0].Rows[i].Card_rate + ">";
                    }
                    else {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + cardid + " value=" + ds.Tables[0].Rows[i].Card_rate + ">";
                    }
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(25).text == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" disabled id=" + cardid + " value=" + ds.Tables[0].Rows[i].Card_rate + ">";
                    }
                    else {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + cardid + " value=" + ds.Tables[0].Rows[i].Card_rate + ">";
                    }
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }


            //// this is for the discount rate
            discrate = "disrat" + i;
            agrred = "agr" + i;
            if (ds.Tables[0].Rows[i].Disc_rate == null || ds.Tables[0].Rows[i].Disc_rate == "null")
                ds.Tables[0].Rows[i].Disc_rate = "";
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[53].childNodes[0].nodeValue == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        str = str + "</td><td><input class=\"btextforgrid\" type=\"text\" disabled id=" + discrate + "  value=" + ds.Tables[0].Rows[i].Disc_rate + "></td>";
                    }
                    else {
                        str = str + "</td><td><input class=\"btextforgrid\" type=\"text\" disabled id=" + discrate + "  value=" + ds.Tables[0].Rows[i].Disc_rate + "></td>";
                    }
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(26).text == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        str = str + "</td><td><input class=\"btextforgrid\" type=\"text\" disabled id=" + discrate + "  value=" + ds.Tables[0].Rows[i].Disc_rate + "></td>";
                    }
                    else {
                        str = str + "</td><td><input class=\"btextforgrid\" type=\"text\" disabled id=" + discrate + "  value=" + ds.Tables[0].Rows[i].Disc_rate + "></td>";
                    }
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }


            if (ds.Tables[0].Rows[i].Agreed_rate == null || ds.Tables[0].Rows[i].Agreed_rate == "null")
                ds.Tables[0].Rows[i].Agreed_rate = "";
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[55].childNodes[0].nodeValue == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" disabled id=" + agrred + "  value=" + ds.Tables[0].Rows[i].Agreed_rate + "></td>";
                    }
                    else {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + agrred + "  value=" + ds.Tables[0].Rows[i].Agreed_rate + "></td>";
                    }
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(27).text == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" disabled id=" + agrred + "  value=" + ds.Tables[0].Rows[i].Agreed_rate + "></td>";
                    }
                    else {
                        str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + agrred + "  value=" + ds.Tables[0].Rows[i].Agreed_rate + "></td>";
                    }
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }


            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[57].childNodes[0].nodeValue == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        str = str + "<td><input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Size_book + "></td>";
                    }

                    else {
                        if (document.getElementById('hiddenuomdesc').value == "CD" && document.getElementById('txtcolum').value == "") {
                            str = str + "<td><input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Size_book + "></td>";
                        }
                        else if (document.getElementById('hiddenuomdesc').value == "CD" && document.getElementById('txtcolum').value != "") {
                            str = str + "<td><input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Size_book + "></td>";
                        }
                        else {
                            str = str + "<td><input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Size_book + "></td>";
                        }

                    }
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(28).text == "enable") {
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        str = str + "<td><input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Size_book + "></td>";
                    }

                    else {
                        if (document.getElementById('hiddenuomdesc').value == "CD" && document.getElementById('txtcolum').value == "") {
                            str = str + "<td><input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Size_book + "></td>";
                        }
                        else if (document.getElementById('hiddenuomdesc').value == "CD" && document.getElementById('txtcolum').value != "") {
                            str = str + "<td><input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Size_book + "></td>";
                        }
                        else {
                            str = str + "<td><input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\"  value=" + ds.Tables[0].Rows[i].Size_book + "></td>";
                        }

                    }
                }
                else {
                    str = str + "<td style=\"display:none;\"></td>";
                }
            }

            ////this is to bind the Ad sub cat3 drop down

            adsubcat3 = "adscat3" + i;

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[59].childNodes[0].nodeValue == "enable") {
                    //str=str+"<td>";
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        //str=str+"<select id="+adsubcat3+" class=\"dropdownforgridqbc\" disabled onchange=\"getadsubcat4("+adsubcat3+","+i+");\">";
                        if (ds.Tables[0].Rows[i].AD_SUBCAT3 != null) {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat3 + " disabled class=\"dropdownforgridqbc\"  value=" + ds.Tables[0].Rows[i].AD_SUBCAT3 + "></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat3 + " disabled class=\"dropdownforgridqbc\" ></td>";
                        }
                    }
                    else {
                        //str=str+"<select id="+adsubcat3+" class=\"dropdownforgridqbc\" onchange=\"getadsubcat4("+adsubcat3+","+i+");\">";
                        if (ds.Tables[0].Rows[i].AD_SUBCAT3 != null) {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat3 + "  class=\"dropdownforgridqbc\" value=" + ds.Tables[0].Rows[i].AD_SUBCAT3 + "></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat3 + "  class=\"dropdownforgridqbc\"></td>";
                        }
                    }
                    // this is to bind adv sub cat drop down
                    //                    str=str+"<option value=\"0\" selected=\"true\">-select-</option>";
                    //                    if(ds.Tables[10].Rows.length>0)
                    //                    {
                    //                        for(l=0;l<=ds.Tables[10].Rows.length-1;l++)
                    //                        {
                    //                            if(ds.Tables[10].Rows[l].catcode==null)
                    //                                ds.Tables[10].Rows[l].catcode="";
                    //                            if(ds.Tables[0].Rows[i].AD_SUBCAT3==ds.Tables[10].Rows[l].catcode)
                    //                            {
                    //                                str=str+"<option value="+ds.Tables[10].Rows[l].catcode+" selected="+ds.Tables[10].Rows[l].catcode+">"+ds.Tables[10].Rows[l].catcode+"</option>";
                    //                            }
                    //                            else
                    //                            {
                    //                                str=str+"<option value="+ds.Tables[10].Rows[l].catcode+">"+ds.Tables[10].Rows[l].catcode+"</option>";
                    //                            }
                    //                        }
                    //                    }

                    //                    str=str+"</select></td>";
                }
                else {
                    str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(29).text == "enable") {
                    // str=str+"<td>";

                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        //str=str+"<select id="+adsubcat3+" class=\"dropdownforgridqbc\" disabled onchange=\"getadsubcat4("+adsubcat3+","+i+");\">";
                        if (ds.Tables[0].Rows[i].AD_SUBCAT3 != null) {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat3 + " disabled class=\"dropdownforgridqbc\" VALUE=" + ds.Tables[0].Rows[i].AD_SUBCAT3 + " ></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat3 + " disabled class=\"dropdownforgridqbc\" ></td>";
                        }
                    }
                    else {
                        // str=str+"<select id="+adsubcat3+" class=\"dropdownforgridqbc\" onchange=\"getadsubcat4("+adsubcat3+","+i+");\">";
                        if (ds.Tables[0].Rows[i].AD_SUBCAT3 != null) {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat3 + "  class=\"dropdownforgridqbc\" VALUE=" + ds.Tables[0].Rows[i].AD_SUBCAT3 + " ></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat3 + "  class=\"dropdownforgridqbc\"></td>";
                        }
                    }


                    // this is to bind adv sub cat drop down
                    //                    str=str+"<option value=\"0\" selected=\"true\">-select-</option>";
                    //                    if(ds.Tables[10].Rows.length>0)
                    //                    {
                    //                        for(l=0;l<=ds.Tables[10].Rows.length-1;l++)
                    //                        {
                    //                            if(ds.Tables[10].Rows[l].catcode==null)
                    //                                ds.Tables[10].Rows[l].catcode="";
                    //                            if(ds.Tables[0].Rows[i].AD_SUBCAT3==ds.Tables[10].Rows[l].catcode)
                    //                            {
                    //                                str=str+"<option value="+ds.Tables[10].Rows[l].catcode+" selected="+ds.Tables[10].Rows[l].catcode+">"+ds.Tables[10].Rows[l].catcode+"</option>";
                    //                            }
                    //                            else
                    //                            {
                    //                                str=str+"<option value="+ds.Tables[10].Rows[l].catcode+">"+ds.Tables[10].Rows[l].catcode+"</option>";
                    //                            }
                    //                            
                    //                        }
                    //                    }

                    //                    str=str+"</select></td>";
                }
                else {
                    str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                }
            }


            ////this is to bind the Ad sub cat4 drop down

            adsubcat4 = "adscat4" + i;

            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[61].childNodes[0].nodeValue == "enable") {
                    // str=str+"<td>";

                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        //   str=str+"<select id="+adsubcat4+" class=\"dropdownforgridqbc\" disabled onchange=\"getadsubcat5("+adsubcat4+","+i+");\">";
                        if (ds.Tables[0].Rows[i].AD_SUBCAT4 != null) {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat4 + " class=\"dropdownforgridqbc\" disabled value=" + ds.Tables[0].Rows[i].AD_SUBCAT4 + "></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat4 + " class=\"dropdownforgridqbc\" disabled ></td>";
                        }
                    }
                    else {
                        // str=str+"<select id="+adsubcat4+" class=\"dropdownforgridqbc\" onchange=\"getadsubcat5("+adsubcat4+","+i+");\" >";
                        if (ds.Tables[0].Rows[i].AD_SUBCAT4 != null) {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat4 + " class=\"dropdownforgridqbc\" value=" + ds.Tables[0].Rows[i].AD_SUBCAT4 + "></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat4 + " class=\"dropdownforgridqbc\" ></td>";
                        }
                    }
                    // this is to bind adv sub cat drop down
                    //                    str=str+"<option value=\"0\" selected=\"true\">-select-</option>";
                    //                    if(ds.Tables[11].Rows.length>0)
                    //                    {
                    //                        for(l=0;l<=ds.Tables[11].Rows.length-1;l++)
                    //                        {
                    //                            if(ds.Tables[11].Rows[l].Cat_Code==null)
                    //                                ds.Tables[11].Rows[l].Cat_Code="";
                    //                            if(ds.Tables[0].Rows[i].AD_SUBCAT4==ds.Tables[11].Rows[l].Cat_Code)
                    //                            {
                    //                                str=str+"<option value="+ds.Tables[11].Rows[l].Cat_Code+" selected="+ds.Tables[11].Rows[l].Cat_Code+">"+ds.Tables[11].Rows[l].Cat_Code+"</option>";
                    //                            }
                    //                            else
                    //                            {
                    //                                str=str+"<option value="+ds.Tables[11].Rows[l].Cat_Code+">"+ds.Tables[11].Rows[l].Cat_Code+"</option>";
                    //                            }
                    //                        }
                    //                    }
                    //                    str=str+"</select></td>";
                }
                else {
                    str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(30).text == "enable") {
                    // str=str+"<td>";
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        //   str=str+"<select id="+adsubcat4+" class=\"dropdownforgridqbc\" disabled onchange=\"getadsubcat5("+adsubcat4+","+i+");\">";
                        if (ds.Tables[0].Rows[i].AD_SUBCAT4 != null) {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat4 + " class=\"dropdownforgridqbc\" disabled value=" + ds.Tables[0].Rows[i].AD_SUBCAT4 + "></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat4 + " class=\"dropdownforgridqbc\" disabled></td>";
                        }
                    }
                    else {
                        //  str=str+"<select id="+adsubcat4+" class=\"dropdownforgridqbc\" onchange=\"getadsubcat5("+adsubcat4+","+i+");\">";
                        if (ds.Tables[0].Rows[i].AD_SUBCAT4 != null) {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat4 + " class=\"dropdownforgridqbc\"  value=" + ds.Tables[0].Rows[i].AD_SUBCAT4 + "></td>";
                        }
                        else {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat4 + " class=\"dropdownforgridqbc\" ></td>";
                        }
                    }
                    // this is to bind adv sub cat drop down
                    //                    str=str+"<option value=\"0\" selected=\"true\">-select-</option>";
                    //                    if(ds.Tables[11].Rows.length>0)
                    //                    {
                    //                        for(l=0;l<=ds.Tables[11].Rows.length-1;l++)
                    //                        {
                    //                            if(ds.Tables[11].Rows[l].Cat_Code==null)
                    //                                ds.Tables[11].Rows[l].Cat_Code="";
                    //                            if(ds.Tables[0].Rows[i].AD_SUBCAT4==ds.Tables[11].Rows[l].Cat_Code)
                    //                            {
                    //                                str=str+"<option value="+ds.Tables[11].Rows[l].Cat_Code+" selected="+ds.Tables[11].Rows[l].Cat_Code+">"+ds.Tables[11].Rows[l].Cat_Code+"</option>";
                    //                            }
                    //                            else
                    //                            {
                    //                                str=str+"<option value="+ds.Tables[11].Rows[l].Cat_Code+">"+ds.Tables[11].Rows[l].Cat_Code+"</option>";
                    //                            }
                    //                        }
                    //                    }

                    //                    str=str+"</select></td>";
                }
                else {
                    str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                }
            }


            ////this is to bind the Ad sub cat5 drop down

            adsubcat5 = "adscat5" + i;
            if (ds.Tables[0].Rows[i].AD_SUBCAT5 == null)
                ds.Tables[0].Rows[i].AD_SUBCAT5 = "";
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[63].childNodes[0].nodeValue == "enable") {
                    //str=str+"<td>";
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        //str=str+"<select id="+adsubcat5+" class=\"dropdownforgridqbc\" disabled \>";// onchange=\"getadsubcat5("+adsubcat4+","+i+");\">";
                        if (ds.Tables[0].Rows[i].AD_SUBCAT5 != null) {
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat5 + " class=\"dropdownforgridqbc\" disabled value=" + ds.Tables[0].Rows[i].AD_SUBCAT5 + "></td>";
                        }
                        else
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat5 + " class=\"dropdownforgridqbc\" disabled></td>";
                    }
                    else {
                        //str=str+"<select id="+adsubcat5+" class=\"dropdownforgridqbc\" \>";// onchange=\"getadsubcat5("+adsubcat4+","+i+");\">";
                        if (ds.Tables[0].Rows[i].AD_SUBCAT5 != null)
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat5 + " class=\"dropdownforgridqbc\" value=" + ds.Tables[0].Rows[i].AD_SUBCAT5 + "></td>";
                        else
                            str = str + "<td><input type=\"type=text\" id=" + adsubcat5 + " class=\"dropdownforgridqbc\" ></td>";
                    }
                    // this is to bind adv sub cat drop down
                    //                    str=str+"<option value=\"0\" selected=\"true\">-select-</option>";
                    //                    if(ds.Tables[12].Rows.length>0)
                    //                    {
                    //                        for(l=0;l<=ds.Tables[12].Rows.length-1;l++)
                    //                        {
                    //                            if(ds.Tables[12].Rows[l].Cat_Code==null)
                    //                                ds.Tables[12].Rows[l].Cat_Code="";
                    //                            if(ds.Tables[0].Rows[i].AD_SUBCAT5==ds.Tables[12].Rows[l].Cat_Code)
                    //                            {
                    //                                str=str+"<option value="+ds.Tables[12].Rows[l].Cat_Code+" selected="+ds.Tables[12].Rows[l].Cat_Code+">"+ds.Tables[12].Rows[l].Cat_Code+"</option>";
                    //                            }
                    //                            else
                    //                            {
                    //                                str=str+"<option value="+ds.Tables[12].Rows[l].Cat_Code+">"+ds.Tables[12].Rows[l].Cat_Code+"</option>";
                    //                            }
                    //                        }
                    //                    }

                    //                    str=str+"</select></td>";
                }
                else {
                    str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(31).text == "enable") {
                    //  str=str+"<td>";
                    if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                        // str=str+"<select id="+adsubcat5+" class=\"dropdownforgridqbc\" disabled \>";// onchange=\"getadsubcat5("+adsubcat4+","+i+");\">";
                        str = str + "<td><input type=\"type=text\" id=" + adsubcat5 + " class=\"dropdownforgridqbc\" disabled value=" + ds.Tables[0].Rows[i].AD_SUBCAT5 + "></td>";
                    }
                    else {
                        //                        str=str+"<select id="+adsubcat5+" class=\"dropdownforgridqbc\" \>";// onchange=\"getadsubcat5("+adsubcat4+","+i+");\">";
                        str = str + "<td><input type=\"type=text\" id=" + adsubcat5 + " class=\"dropdownforgridqbc\"  value=" + ds.Tables[0].Rows[i].AD_SUBCAT5 + "></td>";
                    }
                    // this is to bind adv sub cat drop down
                    //                    str=str+"<option value=\"0\" selected=\"true\">-select-</option>";
                    //                    if(ds.Tables[12].Rows.length>0)
                    //                    {
                    //                        for(l=0;l<=ds.Tables[12].Rows.length-1;l++)
                    //                        {
                    //                            if(ds.Tables[12].Rows[l].Cat_Code==null)
                    //                                ds.Tables[12].Rows[l].Cat_Code="";
                    //                            if(ds.Tables[0].Rows[i].AD_SUBCAT5==ds.Tables[12].Rows[l].Cat_Code)
                    //                            {
                    //                                str=str+"<option value="+ds.Tables[12].Rows[l].Cat_Code+" selected="+ds.Tables[12].Rows[l].Cat_Code+">"+ds.Tables[12].Rows[l].Cat_Code+"</option>";
                    //                            }
                    //                            else
                    //                            {
                    //                                str=str+"<option value="+ds.Tables[12].Rows[l].Cat_Code+">"+ds.Tables[12].Rows[l].Cat_Code+"</option>";
                    //                            }
                    //                        }
                    //                    }

                    //                    str=str+"</select></td>";
                }
                else {
                    str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                }
            }

            // for logo
            var logohei = "logohei" + i;
            var logowid = "logowid" + i;
            var logonam = "logonam" + i;
            if (browser != "Microsoft Internet Explorer") {
                if (xmlObj.childNodes[23].childNodes[65].childNodes[0].nodeValue == "enable") {
                    if (ds.Tables[0].Rows[i].Logo_H != null)
                        str += "<td><input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logohei + " Value=" + ds.Tables[0].Rows[i].Logo_H + " ></td>";
                    else
                        str += "<td><input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logohei + " Value=\"\" ></td>";

                    if (ds.Tables[0].Rows[i].Logo_W != null)
                        str += "<td><input  class=\"btextsmallsize\"  disabled type=\"text\" id=" + logowid + " Value=" + ds.Tables[0].Rows[i].Logo_W + " ></td>";
                    else
                        str += "<td><input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logowid + " Value=\"\" ></td>";

                    if (ds.Tables[0].Rows[i].Logo_name != null)
                        str += "<td><input  class=\"dropdownforgrid\" disabled type=\"text\" id=" + logonam + " Value=" + ds.Tables[0].Rows[i].Logo_name + " ></td>";
                    else
                        str += "<td><input  class=\"dropdownforgrid\" disabled type=\"text\" id=" + logonam + " Value=\"\" ></td>";
                }
                else {
                    str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">logoH</td>";
                    str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">logoW</td>";
                    str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">logoN</td>";
                }
            }
            else {
                if (xmlObj.childNodes(11).childNodes(32).text == "enable") {
                    if (ds.Tables[0].Rows[i].Logo_H != null)
                        str += "<td><input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logohei + " Value=" + ds.Tables[0].Rows[i].Logo_H + " ></td>";
                    else
                        str += "<td><input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logohei + " Value=\"\" ></td>";

                    if (ds.Tables[0].Rows[i].Logo_W != null)
                        str += "<td><input  class=\"btextsmallsize\"  disabled type=\"text\" id=" + logowid + " Value=" + ds.Tables[0].Rows[i].Logo_W + " ></td>";
                    else
                        str += "<td><input  class=\"btextsmallsize\" disabled type=\"text\" id=" + logowid + " Value=\"\" ></td>";

                    if (ds.Tables[0].Rows[i].Logo_name != null)
                        str += "<td><input  class=\"dropdownforgrid\" disabled type=\"text\" id=" + logonam + " Value=" + ds.Tables[0].Rows[i].Logo_name + " ></td>";
                    else
                        str += "<td><input  class=\"dropdownforgrid\" disabled type=\"text\" id=" + logonam + " Value=\"\" ></td>";
                }
                else {
                    str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">logoH</td>";
                    str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">logoW</td>";
                    str += "<td align=\"center\" valign=\"top\" style=\"display:none;\">logoN</td>";
                }
            }
            // for bold charcter count
            var splboldsize = "splboldsize" + i;
            if (ds.Tables[0].Rows[i].SPECIAL_SIZE1 != null)
                str += "<td><input  class=\"btextsmallsize\" disabled type=\"text\" id=" + splboldsize + " Value=" + ds.Tables[0].Rows[i].SPECIAL_SIZE1 + "></td>";
            else
                str += "<td><input  class=\"btextsmallsize\" disabled type=\"text\" id=" + splboldsize + " Value=\"\" ></td>";
            //   Make_Row.appendChild(make_td);   
            // make_td=document.createElement("td");
            // make_td.align="center";

            //   Make_Row.appendChild(make_td);


            // make_td=document.createElement("td");
            //   make_td.align="center";

            // make_td.innerHTML="<input  class=\"btextsmallsize\" disabled type=\"text\" id="+logowid+" Value=\"\" >";
            // Make_Row.appendChild(make_td);


            //  make_td=document.createElement("td");
            //make_td.align="center";

            // make_td.innerHTML="<input  class=\"dropdownforgrid\" disabled type=\"text\" id="+logonam+" Value=\"\" >";
            //  Make_Row.appendChild(make_td);

            // for logo


            pkgcodegrid = 'hiddenpckcode' + i;
            //This is a hidden field in the insertion grid which holds the Package Code for internal processing only
            str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkgcodegrid + "' value='" + ds.Tables[0].Rows[i].PACKAGE_CODE + "'></td>";
            var pubcode = 'pubcode' + i;
            str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + pubcode + "' value='" + ds.Tables[0].Rows[i].PUBCODE + "'></td>";


            var pkg_ins = 'pkg_ins' + i;
            str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_ins + "' value='" + ds.Tables[0].Rows[i].INSERTS + "'></td>";

            pkg_alias = 'pkg_alias' + i;
            str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_alias + "' value='" + ds.Tables[0].Rows[i].PKG_ALIAS + "'></td>";

            /*new change ankur 24 feb*/
            logonam = "lnam" + i
            var tdsln = "tdsln" + i;
            var tdslh = "tdslh" + i;
            var tdslw = "tdslw" + i;
            var tdslup = "tdslup" + i;

            logoH = "lh" + i;
            logoW = "lw" + i;
            ////////////////
            if (document.getElementById('hiddenlogomatter').value == "yes") {
                if (showordisable == "1" || ds.Tables[0].Rows[i].Insert_status == "billed" || ds.Tables[0].Rows[i].Insert_status == "publish") {
                    str = str + "<td id=" + tdsln + "  ><input class=\"btextforgrid\" disabled type=\"text\" id=" + logonam + "  value=" + ds.Tables[0].Rows[i].Logo_name + "></td>";
                    str = str + "<td id=" + tdslh + " ><input class=\"btextforgrid\" disabled  type=\"text\" id=" + logoH + "  value=" + ds.Tables[0].Rows[i].Logo_H + "></td>";
                    str = str + "<td id=" + tdslw + " ><input class=\"btextforgrid\" disabled   type=\"text\" id=" + logoW + "  value=" + ds.Tables[0].Rows[i].Logo_W + "></td>";
                    str = str + "<td id=" + tdslup + "  width=\"50px\"><input  class=\"button1\" disabled type=\"button\" Value=\"Logo Upload\"></td>";
                }
                else {
                    str = str + "<td id=" + tdsln + "  ><input class=\"btextforgrid\" disabled type=\"text\" id=" + logonam + "  value=" + ds.Tables[0].Rows[i].Logo_name + "></td>";
                    str = str + "<td id=" + tdslh + " ><input class=\"btextforgrid\"   type=\"text\" id=" + logoH + "  value=" + ds.Tables[0].Rows[i].Logo_H + "></td>";
                    str = str + "<td id=" + tdslw + " ><input class=\"btextforgrid\"   type=\"text\" id=" + logoW + "  value=" + ds.Tables[0].Rows[i].Logo_W + "></td>";
                    str = str + "<td id=" + tdslup + "  width=\"50px\"><input  class=\"button1\"  type=\"button\" Value=\"Logo Upload\" ></td>";
                }
            }
            ////////////

            showid = "sho" + i;
            str = str + "<td><input class=\"btextforgrid\" style=\"display:none;\" type=\"text\" id=" + showid + "  value=" + ds.Tables[0].Rows[i].insert_id + "></td>";

            var spltdata = "spltdata" + i;
            str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + spltdata + "' value=\"\"></td>";

            var subedidata = "subedidata" + i;
            str = str + "<td><input disabled class=\"btextsmallsize\" type=\"text\" id='" + subedidata + "' value=\"\"></td>";

            var vat = "vat" + i;
            str = str + "<td><input class=\"btextforgrid\" disabled  type=\"text\" id=" + vat + "  value=" + ds.Tables[0].Rows[i].VATAMT + "></td>";

            var vat_inc = "vat_inc" + i;
            if (ds.Tables[0].Rows[i].VAT_INC != "null" && ds.Tables[0].Rows[i].VAT_INC != null)
                str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + vat_inc + "  value=" + ds.Tables[0].Rows[i].VAT_INC + "></td>";
            else
                str = str + "<td><input class=\"btextforgrid\" disabled  type=\"text\" id=" + vat_inc + "  value=''></td>";
            /////////////////////////////add anuja eyecather

            var eye_cather = "eye_cather" + i;
            if (ds.Tables[0].Rows[i].EYECATHER != "null" && ds.Tables[0].Rows[i].EYECATHER != null)
                str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + eye_cather + "  value=" + ds.Tables[0].Rows[i].EYECATHER + "></td>";
            else
                str = str + "<td><input class=\"btextforgrid\" disabled  type=\"text\" id=" + eye_cather + "  value=''></td>";
            ///day wise prem.
            var hdnday_prim = "hdnday_prim" + i;
            if (ds.Tables[0].Rows[i].DAY_WISE_PREM != "null" && ds.Tables[0].Rows[i].DAY_WISE_PREM != null)
                str = str + "<td><input class=\"btextforgrid\"  style=\"display:none;\" disabled type=\"text\" id=" + hdnday_prim + "  value=" + ds.Tables[0].Rows[i].DAY_WISE_PREM + "></td>";
            else
                str = str + "<td><input class=\"btextforgrid\" style=\"display:none;\" disabled  type=\"text\" id=" + hdnday_prim + "  value=''></td>";
            var clicatamt = "clicatamt" + i;
            if (ds.Tables[0].Rows[i].CLIENT_CAT_D_AMT != "null" && ds.Tables[0].Rows[i].CLIENT_CAT_D_AMT != null)
                str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + clicatamt + "  value=" + ds.Tables[0].Rows[i].CLIENT_CAT_D_AMT + "></td>";
            else
                str = str + "<td><input class=\"btextforgrid\" disabled  type=\"text\" id=" + clicatamt + "  value=''></td>";
            str = str + "</tr>";
            
            var GSTAMT = "GSTAMT" + i;
            if (ds.Tables[0].Rows[i].GSTAMT != "null" && ds.Tables[0].Rows[i].GSTAMT != null)
                str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + GSTAMT + "  value=" + ds.Tables[0].Rows[i].GSTAMT + "></td>";
            else
                str = str + "<td><input class=\"btextforgrid\" disabled  type=\"text\" id=" + GSTAMT + "  value=''></td>";
            str = str + "</tr>";
            
            var GSTGD = "GSTGD" + i;
            if (ds.Tables[0].Rows[i].GSTGD != "null" && ds.Tables[0].Rows[i].GSTGD != null)
                str = str + "<td><input class=\"btextforgrid\" disabled type=\"text\" id=" + GSTGD + "  value=" + ds.Tables[0].Rows[i].GSTGD + "></td>";
            else
                str = str + "<td><input class=\"btextforgrid\" disabled  type=\"text\" id=" + GSTGD + "  value=''></td>";
            str = str + "</tr>";
            ///////////////////////


        }

        str = str + "</table></div>";
        document.getElementById('tblinsert').innerHTML = str;

        for (var i = 0; i < ds.Tables[0].Rows.length; i++) {
            var height = "hei" + i;
            var width = "wid" + i;
            var noofcol = "nocol" + i;
            var id = "Text" + i;
            var adsubcat3 = "adscat3" + i;
            var adsubcat4 = "adscat4" + i;
            var inserts = "ins" + i;
            var adcat = "adcat" + i;
            var adsubcat = "ads" + i;
            var paid = "pai" + i;
            var page = "pgpre" + i;
            var pagstr = "sec"
            var paid = "pai" + i;
            var insertval = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[parseInt(i, 10) + 1].cells[0].innerHTML;
            var height_vari = document.getElementById(height);
            var par1 = (height_vari.parentNode).parentNode;
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById(height).onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                document.getElementById(width).onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                document.getElementById(noofcol).onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                document.getElementById(id).onchange = new Function("return chkDateforGrid(this);");
                if (document.getElementById(paid) != undefined && document.getElementById(paid) != "undefined" && document.getElementById(paid) != null)
                    document.getElementById(paid).onchange = new Function("return blankGross();");
                if (document.getElementById(page) != undefined && document.getElementById(page) != "undefined" && document.getElementById(page) != null)
                    document.getElementById(page).onchange = new Function("return getpageprem(" + page + "," + i + ",'" + pagstr + "');");
            }
            else {
                par1.all[height].onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                par1.all[width].onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                par1.all[noofcol].onchange = new Function("return gettotalsize('" + height + "','" + width + "'," + i + ",'" + inserts + "'," + insertval + ",'" + noofcol + "');");
                par1.all[id].onchange = new Function("return chkDateforGrid(this);");
                if (par1.all[paid] != undefined && par1.all[paid] != "undefined" && par1.all[paid] != null)
                    par1.all[paid].onchange = new Function("return blankGross();");
                if (par1.all[page] != undefined && par1.all[page] != "undefined" && par1.all[page] != null)
                    par1.all[page].onchange = new Function("return getpageprem(" + page + "," + i + ",'" + pagstr + "');");
            }
        }
        arrangeArrayItems();
    }

}
//////////////this is the function for dateformat as the dateformat likewise the date will be shown if id==1and if it is 0 than will return the 
///////date in mm/dd/yyyy format

function savedateinto(dat, id) {
    var sadate = dat;
    var setdate;
    var dateformat = document.getElementById('hiddendateformat').value;
    if (id == "0") {
        if (sadate != "") {


            if (dateformat == "mm/dd/yyyy") {
                return setdate = sadate;
            }
            if (dateformat == "dd/mm/yyyy") {
                var txt1 = sadate;
                var txt2 = txt1.split("/");
                var dd = txt2[0];
                var mm = txt2[1];
                var yy = txt2[2];
                return setdate = mm + '/' + dd + '/' + yy;
            }
            if (dateformat == "yyyy/mm/dd") {
                var txt1 = sadate;
                var txt2 = txt1.split("/");
                var yy = txt2[0];
                var mm = txt2[1];
                var dd = txt2[2];
                return setdate = mm + '/' + dd + '/' + yy;

            }
        }
    }
    if (id == "1") {
        var currdate = new Date(sadate);


        var dd = currdate.getDate();
        if (dd.toString().length == 1)
            dd = "0" + dd;
        var mm = currdate.getMonth() + 1;
        if (mm.toString().length == 1)
            mm = "0" + mm;
        var yyyy = currdate.getFullYear();

        var currdate1 = mm + '/' + dd + '/' + yyyy;
        var currda = dd + '/' + mm + '/' + yyyy;
        var curryear = yyyy + '/' + mm + '/' + dd;

        if (dateformat == "mm/dd/yyyy") {
            return currdate1;

        }
        else if (dateformat == "dd/mm/yyyy") {
            return currda;

        }
        if (dateformat == "yyyy/mm/dd") {
            return curryear;

        }



    }


}

function exitbook() {
    if (confirm("Do You Want To Skip This Page")) {
        window.close();
    }
    return false;

}

////this is the function cretaed when we select the ad sub cat from the iserts line than it will effect on its item lines
/////and also chk tahat whether taht package is cretaed 

function getvalueintoinserts(id, insval, no) {
    var idval = id.value;
    var getint = id.id.split("ads");
    var z = getint[1];
    var adsubcat;
    var inserts;
    var tot = parseInt(fillinsert) / parseInt(document.getElementById('txtinsertion').value);
    var i = z;
    var k;
    var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
    //    
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    if (z % noofinsertlo == 0) {
        var x = parseInt(z) + parseInt(noofinsertlo);
        i = z;
        for (k = 0; k < noofinsertlo; k++) {

            while (document.getElementById("card" + i) == null && i <= noofinsertlo) {
                i = parseInt(i) + parseInt(totid);

            }
            if (i >= noofinsertlo) {
                break;
            }

            adsubcat = "ads" + i;
            document.getElementById(adsubcat).value = idval;
            i = parseInt(i) + 1;

        }
    }
    else if (z >= noofinsertlo) {
        var x = parseInt(z) + parseInt(noofinsertlo);
        var modval = z % noofinsertlo;
        var totmod = parseInt(z) - parseInt(modval);
        i = totmod;
        //            var tomax=parseInt(totmod)+parseInt(noofinsertlo);



        for (k = 0; k < noofinsertlo; k++) {
            while (document.getElementById("card" + i) == null && i <= noofinsertlo) {
                i = parseInt(i) + parseInt(totid);

            }
            if (i >= noofinsertlo) {
                break;
            }

            adsubcat = "ads" + i;
            document.getElementById(adsubcat).value = idval;
            i = parseInt(i) + 1;
        }

    }
    else if (z < noofinsertlo) {
        //i=0
        //var modval=noofinsert%z;
        //var totmod=parseInt(z)-parseInt(modval);
        //i=totmod;
        var modval = noofinsertlo % z;
        var totmod = parseInt(z) - parseInt(modval);
        i = totmod;


        for (k = 0; k < noofinsertlo; k++) {
            while (document.getElementById("card" + i) == null && i <= noofinsertlo) {
                i = parseInt(i) + parseInt(totid);

            }
            if (i >= noofinsertlo) {
                break;
            }


            adsubcat = "ads" + i;
            document.getElementById(adsubcat).value = idval;
            i = parseInt(i) + 1;
        }

    }
    var compcode = document.getElementById("hiddencompcode").value;

    //QBC.bindadcat3(idval,compcode,"0",fillscat3);
    QBC.bindadcat3(idval, compcode, "0");

}

///// this is to fill the color into the inserts line

//function getvalueintoinsertsforcolor(id,insval,no)
//{
//       
//         var idval=id.value;
//         var colid;
//    var getint=id.id.split("col");
//    var z=getint[1];
//    var adsubcat;
//    var inserts;
//    var tot=parseInt(fillinsert)/parseInt(document.getElementById('txtinsertion').value);
//    var i=0;
//    var k;
//    var i=z;
//    var k;
//    var totid=parseInt(noofinsert)/parseInt(document.getElementById('txtinsertion').value)
////    
//   document.getElementById('txtgrossamt').value="";
//   document.getElementById('txttotalamt').value="";
//        if(z%noofinsertlo==0)
//        {
//                 var x=parseInt(z)+parseInt(noofinsertlo);
//                i=z;
//                for (k=0;k<noofinsertlo;k++)
//                {
//                
//                        while(document.getElementById("card"+i)==null && i<=noofinsertlo)
//                         {
//                            i=parseInt(i)+parseInt(totid);
//       
//                         }
//                         if(i>=noofinsertlo)
//                         {
//                         break;
//                         }
//               
//                
//                        colid="col"+i;
//                        document.getElementById(colid).value=idval;
//                        i=parseInt(i)+1;
//                    
//                }       
//        }
//        else if(z>=noofinsertlo)
//        {
//             var x=parseInt(z)+parseInt(noofinsertlo);
//              var modval=z%noofinsertlo;
//              var totmod=parseInt(z)-parseInt(modval);
//              i=totmod;
////            var tomax=parseInt(totmod)+parseInt(noofinsertlo);
//               
//              
//                
//            for(k=0;k<noofinsertlo;k++)
//            {
//                        while(document.getElementById("card"+i)==null && i<=noofinsertlo)
//                         {
//                            i=parseInt(i)+parseInt(totid);
//       
//                         }
//                         if(i>=noofinsertlo)
//                         {
//                         break;
//                         }
//                         
//                colid="col"+i;
//                document.getElementById(colid).value=idval;
//                 i=parseInt(i)+1;
//            }
//        
//        }
//        else if(z<noofinsertlo)
//        {
//             var modval=noofinsertlo%z;
//             var totmod=parseInt(z)-parseInt(modval);
//             i=totmod;
//           
//         
//             for(k=0;k<noofinsertlo;k++)
//            {
//                while(document.getElementById("card"+i)==null && i<=noofinsertlo)
//                         {
//                            i=parseInt(i)+parseInt(totid);
//       
//                         }
//                         if(i>=noofinsertlo)
//                         {
//                         break;
//                         }
//                         
//               colid="col"+i;
//                document.getElementById(colid).value=idval;
//                 i=parseInt(i)+1;
//            }
//        
//        }

//}
function getvalueintoinsertsforcolor(id, insval, no) {
    var idval = id.value;
    var colid;
    var getint = id.id.split("col");
    var z = getint[1];
    var adsubcat;
    var inserts;
    var tot = parseInt(fillinsert) / parseInt(document.getElementById('txtinsertion').value);
    var i = 0;
    var k;
    var i = z;
    var k;
    var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
    if (z % noofinsertlo == 0) {
        var x = parseInt(z) + parseInt(noofinsertlo);
        i = z;
        for (k = 0; k < noofinsertlo; k++) {
            while (document.getElementById("card" + i) == null) {
                i = parseInt(i) + parseInt(totid);
            }
            colid = "col" + i;
            document.getElementById(colid).value = idval;
            i = parseInt(i) + 1;
        }
    }
    else if (z >= noofinsertlo) {
        var x = parseInt(z) + parseInt(noofinsertlo);
        var modval = z % noofinsertlo;
        var totmod = parseInt(z) - parseInt(modval);
        i = totmod;
        for (k = 0; k < noofinsertlo; k++) {
            while (document.getElementById("card" + i) == null) {
                i = parseInt(i) + parseInt(totid);
            }
            colid = "col" + i;
            document.getElementById(colid).value = idval;
            i = parseInt(i) + 1;
        }

    }
    else if (z < noofinsertlo) {
        var modval = noofinsertlo % z;
        var totmod = parseInt(z) - parseInt(modval);
        //i=totmod;
        i = 0;
        for (k = 0; k < noofinsertlo; k++) {
            while (document.getElementById("card" + i) == null) {
                i = parseInt(i) + parseInt(totid);
            }
            colid = "col" + i;
            document.getElementById(colid).value = idval;
            i = parseInt(i) + 1;
        }
    }

}
//////this function is to get the total size on change of grids width textbox
//////this function is to get the total size on change of grids width textbox
function gettotalsize(h, w, id, ins, insval, c) {

    var cardid = "card" + id;
    document.getElementById("fil" + id).value = "";
    document.getElementById("txtgrossamt").value = "";
    if (document.getElementById(cardid).value == "") {
        alert("Please get the card rate in the insertion grid");
        document.getElementById(h).value = "";
        document.getElementById(w).value = "";
        document.getElementById(c).value = "";
        //changedivrate();
        document.getElementById('btnshgrid').focus();
        return false;

    }

    ////this is to chk the vlid numeric entery in h and w and c
    //alert("hi");
    chkamount(h);
    chkamount(w);
    chkamount(c);

    h = h;

    if (document.getElementById(h).value == "") {
        alert("Please Enter the height");
        document.getElementById(h).focus();
        return false;
    }

    w = w;
    c = c;

    var height = document.getElementById(h).value;
    var width = document.getElementById(w).value;
    var column = document.getElementById(c).value;

    var size = "siz" + id;
    if (column == "" || column == "NaN") {
        document.getElementById(size).value = parseFloat(height) * parseFloat(width);
    }
    else {
        document.getElementById(size).value = parseFloat(height) * parseFloat(column);
    }
    //getgrossamt(w,ins,insval);

    //                        agreed="agr"+id;
    //                        gross="gro"+id;
    //                        totarea="siz"+id;
    //                         solo="sol"+id;
    //                        //var totgross=parseFloat(document.getElementById(totarea).value)*parseFloat(document.getElementById(agreed).value)
    //                        //document.getElementById(gross).value=totgross.toFixed(2);
    //                 if(document.getElementById('txtcardrate').value==document.getElementById('txtcardrate').value)
    //                 {
    //                        var soagr=document.getElementById(solo).value;
    //                      //document.getElementById(gross).value=(parseFloat(agr)*parseFloat(totsiz)).toFixed(2);
    //                      var totareawithrate=parseFloat(soagr)*parseFloat(document.getElementById(totarea).value)
    //                      var totamt=parseFloat(totareawithrate)+parseFloat(glpre)-parseFloat(glspedisc)-parseFloat(glspadisc)+parseFloat(glspeccharge)
    //                      document.getElementById(gross).value=(parseFloat(totamt)).toFixed(2);
    //                 }
    //                 else
    //                 {
    //                    var totgross=parseFloat(document.getElementById(totarea).value)*parseFloat(document.getElementById(agreed).value)
    //                    document.getElementById(gross).value=totgross.toFixed(2);
    //                 }
    //            var y;
    //            var totid;
    //            if(noofinsert!="")
    //            {                 
    //                  y=parseInt(noofinsert)   
    //                   totid=parseInt(noofinsert)/parseInt(document.getElementById('txtinsertion').value)
    //            }
    //            else
    //            {
    //                y=rowwhenupdate;
    //                totid=parseInt(rowwhenupdate)/parseInt(document.getElementById('txtinsertion').value)
    //            }
    //                
    //                 var k;
    //                 var adgross
    //                 var totgross;   
    //                 var paid;
    //                 var grossamt="";
    //                 for(k=0;k<y;k++)
    //                    {
    //                         
    //                           
    //                            adgross="gro"+i;
    //                            paid="pai"+i;
    //                            
    //                            totgross=document.getElementById(adgross).value 
    //                        if(document.getElementById(paid).value=="Y") 
    //                        {
    //                            if(grossamt!="")
    //                            {
    //                            grossamt=parseFloat(totgross)+parseFloat(grossamt);
    //                            }
    //                            else
    //                            {
    //                            grossamt=parseFloat(totgross);
    //                            }
    //                            
    //                        }
    //                        i=parseInt(i)+1;   
    //                    }
    //                    if(grossamt!="")
    //                 {
    //                    document.getElementById('txtgrossamt').value=grossamt.toFixed(2);
    //                    //document.getElementById('txtbillamt').value=parseFloat(grossamt)-parseFloat(grossamt)*parseFloat(document.getElementById('txttradedisc').value)/100;
    //                 }
    //                 if(document.getElementById('txtgrossamt').value=="NaN")
    //                 {
    //                    document.getElementById('txtgrossamt').value="";
    //                 
    //                 }


}

/////////////////this is to get the page premium

function getpageprem(premid, id, str) {

    premid = premid.id;

    ///////////this page is created to get the value of selected premium
    var page = document.getElementById(premid).value;

    var val = "";

    if (browser != "Microsoft Internet Explorer") {
        var httpRequest = null; ;
        httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml');
        }

        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

        httpRequest.open("GET", "getpremium.aspx?page=" + page, false);
        httpRequest.send('');
        //alert(httpRequest.readyState);
        if (httpRequest.readyState == 4) {
            //alert(httpRequest.status);
            if (httpRequest.status == 200) {
                val = httpRequest.responseText;
            }
            else {
                alert('There was a problem with the request.');
            }
        }
    }
    else {
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        xml.Open("GET", "getpremium.aspx?page=" + page, false);
        xml.Send();
        val = xml.responseText;
    }
    val = val.split("^");
    val = val[1];
    var premper = "pagper" + id;
    var cardid = "card" + id;
    var solo = "sol" + id;
    var agrred = "agr" + id;
    var discrate = "disrat" + i;
    var gross = "gro" + id;
    if (document.getElementById(cardid).value == "") {
        alert("Please get the card rate");
        return false;

    }
    if (str != "fir") {
        if (val == null || val == "null") {
            document.getElementById(premper).value = "0";
            val = "0";
        }
        else {
            document.getElementById(premper).value = val;
        }
    }
    if (val == null || val == "null") {
        val = "0";
    }

    //when we change the premium than card effects automatically only when card rate and agreed are equal
    if (parseFloat(document.getElementById('txtcardrate').value) == parseFloat(document.getElementById('txtcardrate').value)) {
        //                     
        var soloins = document.getElementById(solo).value
        var totalvalue = parseFloat(soloins) + parseFloat(soloins) * (parseFloat(val)) / 100;
        document.getElementById(gross).value = totalvalue.toFixed(2);
        // document.getElementById(agrred).value=document.getElementById(cardid).value;
        //  document.getElementById(discrate).value="0";



    }


    var len = "bookdiv";
    var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1


    var d;
    for (k = 0; k < y; k++) {

        while (document.getElementById("card" + i) == null && i <= y) {
            i = i + totid;

        }
        if (i >= y) {
            break;
        }
        var gross1 = "gro" + i;
        totor = parseFloat(totor) + parseFloat(document.getElementById(gross1).value);




        i = i + 1;
    }

    var grossamt;

    if (document.getElementById('hiddenvat').value == "grossamount" || document.getElementById('hiddenvat').value == "netamount") {
        var strtext = "";
        if (browser != "Microsoft Internet Explorer") {
            var httpRequest = null; ;
            httpRequest = new XMLHttpRequest();
            if (httpRequest.overrideMimeType) {
                httpRequest.overrideMimeType('text/xml');
            }

            httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

            httpRequest.open("GET", "getvatrate.aspx?grossamt=" + totor, false);
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) {
                    strtext = httpRequest.responseText;
                }
                else {
                    alert('There was a problem with the request.');
                }
            }
        }
        else {
            var xml = new ActiveXObject("Microsoft.XMLHTTP");
            xml.Open("GET", "getvatrate.aspx?grossamt=" + totor, false);
            xml.Send();
            strtext = xml.responseText;
        }
        document.getElementById('txtgrossamt').value = formatDecimal(parseFloat(strtext), true, 2)
        //  var trdisc=document.getElementById('txttradedisc').value
        // var billval=parseFloat(document.getElementById('txtgrossamt').value)-(parseFloat(document.getElementById('txtgrossamt').value)*parseFloat(trdisc)/100);
        //  document.getElementById('txtbillamt').value=formatDecimal(billval,true,2);
        totor = 0;
    }
    //                     else if(document.getElementById('hiddenvat').value=="netamount")
    //                     {
    //                     
    //                     
    //                            document.getElementById('txtgrossamt').value=formatDecimal(parseFloat(totor),true,2)
    //                            var trdisc=document.getElementById('txttradedisc').value
    //                            var billval=parseFloat(document.getElementById('txtgrossamt').value)-(parseFloat(document.getElementById('txtgrossamt').value)*parseFloat(trdisc)/100);
    //                            var xml = new ActiveXObject("Microsoft.XMLHTTP");
    //                        
    //                            xml.Open( "GET","getvatrate.aspx?grossamt="+billval, false );
    //                            xml.Send();
    //                            var strtext=xml.responseText;   
    //                            
    //                            document.getElementById('txtbillamt').value=formatDecimal(strtext,true,2);
    //                            totor=0;
    //                     
    //                     }
    else if (document.getElementById('hiddenvat').value == "no") {
        document.getElementById('txtgrossamt').value = formatDecimal(parseFloat(totor), true, 2)
        //var trdisc=document.getElementById('txttradedisc').value
        //var billval=parseFloat(document.getElementById('txtgrossamt').value)-(parseFloat(document.getElementById('txtgrossamt').value)*parseFloat(trdisc)/100);
        //document.getElementById('txtbillamt').value=formatDecimal(totor,true,2);
        totor = 0;

    }
}

///////////////////////////////////////////////////////////////////////////////////////////
//this function is called to fill the ad s cat for grid on change of ad cat

function filladsubgrid(adcat, adsubcat) {
    var len = "bookdiv";
    var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    var i;
    var compcode = document.getElementById('hiddencompcode').value;
    var adcategory = adcat.value;
    if (adcategory == "0") {
        //alert("Please select the value");
        adsubcat.options.length = 0;

        return false;
    }
    objadscat = adsubcat;
    QBC.getadsubcat(compcode, adcategory, call_filladscat)
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";

}
function call_filladscat(res) {
    var ds = res.value;
    objadscat.options.length = 0;
    objadscat.options[0] = new Option("-Select-", "0");
    //alert(pkgitem.options.length);
    objadscat.options.length = 1;
    for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
        objadscat.options[objadscat.options.length] = new Option(ds.Tables[0].Rows[i].Adv_Subcat_Name, ds.Tables[0].Rows[i].Adv_Subcat_Code);

        objadscat.options.length;

    }
    //////////////////this is to bind the ad s cat  of grid on change of ad category
    if (document.getElementById('tblinsert').innerHTML != "" && document.getElementById(len) != null) {
        var len = "bookdiv";
        var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
        var k;
        var adsubcat;
        var i = 0;

        for (k = 0; k < y - 1; k++) {


            adsubcat = "ads" + i;
            var gridadscat = document.getElementById(adsubcat)
            gridadscat.value = "";
            //alert(gridadscat.options.length);


            i = parseInt(i) + 1;

        }


    }

}




function setvalueintorodate() {
    if (flagmode != "Query") {
        if (document.getElementById('txtagency').value != "") {
            if (document.getElementById('txtrono').value != "") {
                document.getElementById('txtrodate').value = document.getElementById('txtdatetime').value;
                var agencycode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.length + document.getElementById('txtagency').value.lastIndexOf('('));
                agencycode = agencycode.replace(")", "");

                var resp = QBC.chkrono(document.getElementById("hiddencompcode").value, document.getElementById("hiddenuserid").value, agencycode, document.getElementById("txtrono").value)
                ds_rol = resp.value;
                if (ds_rol.Tables[0].Rows.length > 0) {
                    alert("This RO No. Is Already Present In Database")
                    document.getElementById("txtrono").value = "";
                    document.getElementById("txtrono").focus();
                    return false;
                }

                if (ds_rol.Tables[1].Rows[0].RES == "Y") {
                    alert("The RO No. Is Not In RO Range")
                    document.getElementById("txtrono").value = "";
                    document.getElementById("txtrono").focus();
                    return false;
                }

                if (ds_rol.Tables[1].Rows[0].RES == "Y") {
                    return;
                }
                return;

            }
            else {
                document.getElementById('txtrodate').value = "";
                return;

            }
        }
        else {
            alert("Please Select The Agency")
            document.getElementById("txtrono").value = "";
            document.getElementById("txtagency").focus();
            return false;
        }
    }
    else {

        return false;
    }
}

///////////this is the function to check whether the ro date is greater than bookind date if it than give alert

function chkratedate() {
    var bookingdate = document.getElementById('txtdatetime').value;
    var rodate = document.getElementById('txtrodate').value;
    dateformat = document.getElementById('hiddendateformat').value;
    //For Booking Date
    if (dateformat == "dd/mm/yyyy") {
        var txt = bookingdate;
        var txt1 = txt.split("/");
        var dd = txt1[0];
        var mm = txt1[1];
        var yy = txt1[2];
        bookingdate = mm + '/' + dd + '/' + yy;
    }
    else if (dateformat == "yyyy/mm/dd") {
        var txt = bookingdate;
        var txt1 = txt.split("/");
        var dd = txt1[0];
        var mm = txt1[1];
        var yy = txt1[2];
        bookingdate = mm + '/' + dd + '/' + yy;
    }

    //For RO Date

    if (dateformat == "dd/mm/yyyy") {
        var txt = rodate;
        var txt1 = txt.split("/");
        var dd = txt1[0];
        var mm = txt1[1];
        var yy = txt1[2];
        rodate = mm + '/' + dd + '/' + yy;
    }
    else if (dateformat == "yyyy/mm/dd") {
        var txt = rodate;
        var txt1 = txt.split("/");
        var dd = txt1[0];
        var mm = txt1[1];
        var yy = txt1[2];
        rodate = mm + '/' + dd + '/' + yy;
    }

    var bookdate = new Date(bookingdate);
    var rdate = new Date(rodate);

    if (rdate > bookdate) {
        alert("RO date should be lesser or equal to Booking date");
        document.getElementById('txtrodate').value = "";
        document.getElementById('txtrodate').focus();
        return false;
    }



}

function chkratefromgrid(id) {


}
///////////////this is the function created to chk taht insert date should be greater than current date and
/////////////./when late by data is selected than it should be grater 
///////////////than select date

function chkdateforbook(id, val12) {
    if (id == undefined) {
        return false;
    }
    //
    var dateformat = document.getElementById('hiddendateformat').value;
    if (document.getElementById('tblinsert').innerHTML != "") {

        var idval = id.value;
        if (id.id.indexOf("Text") >= 0) {
            var bookingdate = document.getElementById('txtdatetime').value;
            var rodate = id.value;
            var txt2;
            if (bookingdate.indexOf("-") >= 0) {
                txt2 = bookingdate.split("-");
            }
            else {
                txt2 = bookingdate.split("/");
            }
            if (dateformat == "dd/mm/yyyy") {
                // var txt2=bookingdate.split("/");
                var dd = txt2[0];
                var mm;
                if (bookingdate.indexOf("-") >= 0) {
                    mm = getMonthNo(txt2[1]);
                }
                else {
                    mm = txt2[1];
                }

                var yy = txt2[2];
                bookingdate = mm + '/' + dd + '/' + yy;
            }
            else if (dateformat == "yyyy/mm/dd") {
                // var txt2=bookingdate.split("/");
                var dd = txt2[2];
                var mm; //=txt2[1];
                if (bookingdate.indexOf("-") >= 0) {
                    mm = getMonthNo(txt2[1]);
                }
                else {
                    mm = txt2[1];
                }
                var yy = txt2[0];
                bookingdate = mm + '/' + dd + '/' + yy;
            }
            else if (dateformat == "mm/dd/yyyy") {
                // var txt2=bookingdate.split("/");
                var dd = txt2[1];
                var mm; //=txt2[1];
                if (bookingdate.indexOf("-") >= 0) {
                    mm = getMonthNo(txt2[0]);
                }
                else {
                    mm = txt2[0];
                }
                var yy = txt2[2];
                bookingdate = mm + '/' + dd + '/' + yy;
            }
            if (dateformat == "dd/mm/yyyy") {
                var txt2 = rodate.split("/");
                var dd = txt2[0];
                var mm = txt2[1];
                var yy = txt2[2];
                rodate = mm + '/' + dd + '/' + yy;
            }
            else if (dateformat == "yyyy/mm/dd") {
                var txt2 = rodate.split("/");
                var dd = txt2[2];
                var mm = txt2[1];
                var yy = txt2[0];
                rodate = mm + '/' + dd + '/' + yy;
            }
            var bookdate = new Date(bookingdate);
            var rdate = new Date(rodate);

            if (rdate < bookdate && (document.getElementById('hiddenbackdatebook').value == "0" || document.getElementById('hiddenbackdatebook').value == "N")) {
                alert("Insertion date should be greater than Publish date");
                id.value = val12;

                id.focus();
                return false;
            }


        }
        else if (id.id.indexOf("lat") >= 0) {
            var editid = id.id.replace("lat", "Text");
            var editdate = document.getElementById(editid).value;
            var latdate = idval;
            if (dateformat == "dd/mm/yyyy") {
                var txt2 = editdate.split("/");
                var dd = txt2[0];
                var mm = txt2[1];
                var yy = txt2[2];
                editdate = mm + '/' + dd + '/' + yy;
            }
            else if (dateformat == "yyyy/mm/dd") {
                var txt2 = editdate.split("/");
                var dd = txt2[2];
                var mm = txt2[1];
                var yy = txt2[0];
                editdate = mm + '/' + dd + '/' + yy;
            }
            if (dateformat == "dd/mm/yyyy") {
                var txt2 = latdate.split("/");
                var dd = txt2[0];
                var mm = txt2[1];
                var yy = txt2[2];
                latdate = mm + '/' + dd + '/' + yy;
            }
            else if (dateformat == "yyyy/mm/dd") {
                var txt2 = latdate.split("/");
                var dd = txt2[2];
                var mm = txt2[1];
                var yy = txt2[0];
                latdate = mm + '/' + dd + '/' + yy;
            }

            var ldate = new Date(latdate);
            var edate = new Date(editdate);
            if (latdate != "") {
                if (ldate > edate)
                { }
                else {
                    alert("Latest Date Should Be Greater Than Edition Date");
                    //document.getElementById(late).value="";
                    id.value = val12;
                    return false;
                }
            }

        }

    }

}

function checkdateInsert() {
    if (document.getElementById('txtdummydate').value == "") {
        alert("Please Select Publish date first");
        document.getElementById('txtdummydate').focus();
        return false;
    }
    else if (document.getElementById('txtrepeatingdate').value != "") {
        document.getElementById('btnshdl').disabled = false;
        return false;
    }

}

//this is the function to open the upload pop up when the image is uploaded for all
function uploadimageall() {
    document.getElementById('txtgrossamt').value = '';
    document.getElementById('txttotalamt').value = "";

    if (document.getElementById('drpuom').value == "" || document.getElementById('drpuom').value == "0") {
        alert("Please select the uom");
        if (document.getElementById('drpuom').disabled == false) {
            document.getElementById('drpuom').focus();
        }
        return false;
    }
    if (document.getElementById('drpcolor').value == "" || document.getElementById('drpcolor').value == "0") {
        alert("Please select the color");
        if (document.getElementById('drpcolor').disabled == false) {
            document.getElementById('drpcolor').focus();
        }
        return false;
    }
    //if (document.getElementById('drpbullet').value == "BO1" || document.getElementById('drpbullet').value == "CO0" || document.getElementById('drpbullet').value == "SP0") {
    if (document.getElementById('drpbullet').value == "BO1" || document.getElementById('drpbullet').value == "CO0") {
        if (document.getElementById('drpbgcolor').value == "" || document.getElementById('drpbgcolor').value == "0") {
            alert("Please select background color");
            if (document.getElementById('drpbgcolor').disabled == false) {
                document.getElementById('drpbgcolor').focus();
            }
            return false;
        }
    }
    if (document.getElementById('txtdummydate').value == "" || document.getElementById('txtdummydate').value == "0") {
        alert("Please select the date");
        if (document.getElementById('txtdummydate').disabled == false) {
            document.getElementById('txtdummydate').focus();
        }
        return false;
    }


    if (document.getElementById('drpuom').value != "0") {

        /*change*/
        var hei = "txtadsize1";
        var wid = "txtadsize2";
        var tot_area = "txttotalarea"
        var ins_id = "All";
        var eyecatch = document.getElementById('drpbullet').value;
        var bgcolor = document.getElementById('drpbgcolor').value;
        var eyecatchlength = document.getElementById('txteyecathval').value;
        var width = document.getElementById('txtadsize2').value;
        //width="3.8";

        /*change*/

        var objpack = document.getElementById('drppackagecopy');
        var temp = "";
        var tempcode = "";
        var tempval = "";
        var tempvalcode = "";
        var desc = "";
        var code = "";
        var i = objpack.options.length;
        var j;

        for (j = 0; j < i; j++) {
            if (parseInt(i) > 0) {
                tempval = objpack[j].value;
                //tempvalcode=objpack[j].value;
                if (temp != "") {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    /*new change ankur for agency*/
                    code = tempvalcode + "+" + code;
                    desc = tempcode + "+" + desc;


                }
                else {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    code = tempvalcode;
                    desc = tempcode;
                }
            }

        }
        width = desc;
        while (width.indexOf('+') >= 0) {
            width = width.replace("+", "^");
        }

        ////////////////////////////////
        ///////////add by anuja

        var packagecode = document.getElementById('hiddenpackage').value;
        //////////////////////end

        var uom = document.getElementById('drpuom').value;
        ////////////// 
        var uom_desc_ = document.getElementById('hiddenuomdesc').value;



        //      var ins_id=ival;
        /*new change ankur for matter*/

        var name_logo = "All";
        ///////////////////
        name_logo = document.getElementById('logonam0').value



        if (eyecatchlength == "") {
            eyecatchlength = "0";
        }
        if (bgcolor == "0" || bgcolor == "") {
            bgcolor = "White";
        }

        var insertid = "no";
        var fil0value = "";
        //////////////////////////add by anuja
        var fil0value22 = "";
        var fil0value221 = "";
        var getfilename = parseInt(document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1);
        var insg = "";
        for (var a = 0; a < getfilename; a++) {
            if (browser != "Microsoft Internet Explorer") {
                insg = document.getElementById('ins' + a).textContent;
            }
            else {
                insg = document.getElementById('ins' + a).innerText;
            }
            fil0value22 = document.getElementById('fil' + a).value;
            if (insg == "1" && (fil0value.indexOf(fil0value22) == -1 || fil0value22 == "")) {
                if (fil0value == "") {
                    fil0value = fil0value22;
                    fil0value221 = fil0value22;
                }
                else {
                    fil0value = fil0value + "," + fil0value22;

                }
            }
        }
        //        if(document.getElementById('fil0').value!="")
        //        {
        //            fil0value=document.getElementById('fil0').value;
        //        }
        /*new change ankur 9 feb*/
        var coltype = document.getElementById('drpcolortype').value;
        ///////////////////
        /*new change ankur 15 feb*/
        if (coltype == "" || coltype == "0") {
            coltype = "Black";
        }

        //        var insertionLine="";
        //        if(document.getElementById('txtinsertion').value!="")
        //        {
        //            insertionLine=document.getElementById('txtinsertion').value;
        //        }
        //var insertNo=document.getElementById('ins'+ival).innerHTML;
        var logoprem = document.getElementById('drplogoprem').value;
        //  var logohei=document.getElementById('txtlogohei').value;
        // var logowid = document.getElementById('txtlogowid').value;

        logohei = document.getElementById('logohei0').value;
        logowid = document.getElementById('logowid0').value;



        var receiptno = document.getElementById('txtreceipt').value;
        if (document.getElementById('hiddenuomdesc').value == "ROC" || document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROW" || document.getElementById('hiddenuomdesc').value == "ROD") {
            /*new change ankur 9 feb*/
            /*new change ankur for matter*/
            /*change for oracle*/
            var index = document.getElementById('drpcolor').selectedIndex;
            var textcolor = document.getElementById('drpcolor').options[index].text;
            if (textcolor.indexOf("COLOR") >= 0) {
                if (document.getElementById('drpbgcolor').value == "0") {
                    alert("Please Select Background Color");
                    document.getElementById('drpbgcolor').focus();
                    return false;
                }
            }
            var prevcioid = document.getElementById('hiddendummycioid').value;

            var no = "no"
            var al = "yes"
            var eyecatchtype = "";
            eyecatchtype = document.getElementById('hiddenbulletpremtype').value;
            var bPrem = document.getElementById('hiddenbullprem').value;
            var agency_vari = document.getElementById('txtagency');
            if (agency_vari.value != "") {
                agencycode = agency_vari.value.substring(agency_vari.value.lastIndexOf("(") + 1, agency_vari.value.lastIndexOf(")"));
            }
            if (width.length > 1024)
                width = "";
            if (clientfromconfig == "SP" || clientfromconfig == "RP") {
                document.getElementById('txttotalarea').disabled = true;

                window.open('editor_new.aspx?formname=QBC&agencycode=' + agencycode + '&bPrem=' + bPrem + '&eyecatchtype=' + eyecatchtype + '&modify=' + modifyMatter + '&insertNo=0&filename=' + fil0value + '&srno=All&edition=All&cioid=' + document.getElementById('txtciobookid').value + '&eyecatch=' + eyecatch + '&bgcolor=' + bgcolor + '&eyecatchlength=' + eyecatchlength + '&width=' + width + '&uom=' + uom + '&insertid=' + insertid + '&insertsta=' + document.getElementById('inssta' + 0).value + '&coltype=' + coltype + '&uom_desc_=' + uom_desc_ + '&name_logo=' + name_logo + '&logohei=' + logohei + '&logo=' + document.getElementById('hiddenlogocode').value + '&logowid=' + logowid + '&prevcioid=' + prevcioid + '&all=' + al + '&HH=' + no + '&receiptno=' + receiptno + '&logoprem=' + logoprem, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0,scrollbars=yes');
            }
            else {
                document.getElementById('txttotalarea').disabled = true;

                window.open('editor.aspx?agencycode=' + agencycode + '&bPrem=' + bPrem + '&eyecatchtype=' + eyecatchtype + '&modify=' + modifyMatter + '&insertNo=0&filename=' + fil0value + '&srno=All&edition=All&cioid=' + document.getElementById('txtciobookid').value + '&eyecatch=' + eyecatch + '&bgcolor=' + bgcolor + '&eyecatchlength=' + eyecatchlength + '&width=' + width + '&uom=' + uom + '&insertid=' + insertid + '&coltype=' + coltype + '&uom_desc_=' + uom_desc_ + '&name_logo=' + name_logo + '&logohei=' + logohei + '&logowid=' + logowid + '&prevcioid=' + prevcioid + '&all=' + al + '&HH=' + no + '&receiptno=' + receiptno + '&packagecode=' + packagecode, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0,scrollbars=yes');

            }
            //////////
        }
        else {

            /*mysql*/
            //if(document.getElementById('chkattach').checked==false && document.getElementById('hiddentypedatabase').value!="mysql")
            if (document.getElementById('chkad').checked == true)
            ////////////////
            {
                var ins = "0";
                var ins = "0";
                var edit = "All";
                var ciobookid = document.getElementById('txtciobookid').value;
                var fileid = "bookdiv";
                window.open('adtaker.aspx?uom=' + document.getElementById('hiddenuom1').value + '&hei=' + hei + '&wid=' + wid + '&ins=' + ins + '&edition=' + edit + '&ciobookid=' + ciobookid + '&fileid=' + fileid + '&tot_area=' + tot_area + '&ins_id=' + ins_id, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0');
            }
            else {
                var ins = "0";
                var edit = "All";
                var ciobookid = document.getElementById('txtciobookid').value;
                var fileid = "bookdiv";
                if (document.getElementById('txtadsize1').value == '') {
                    alert("Please enter Ad Height");
                    document.getElementById('txtadsize1').focus();
                    return false;
                }
                else if (document.getElementById('txtadsize2').value == '') {
                    alert("Please enter Ad Width");
                    document.getElementById('txtadsize2').focus();
                    return false;
                }
                /*new change ankur 23 feb*/
                var logo = "logonot";
                //var receipt=document.getElementById("txtreceipt").value;
                var receipt = document.getElementById('txtciobookid').value;
                //  var resno=QBC.getCategoryTemplate(document.getElementById('drpadcategory').value);
                var cou = 0;
                // if(resno.value!=null)
                //   cou=resno.value;
                if (cou == 0)
                    window.open('default3.aspx?color=' + document.getElementById('drpcolor').value + '&adheight=' + document.getElementById('txtadsize1').value + '&adwidth=' + document.getElementById('txtadsize2').value + '&ins=' + ins + '&edition=' + edit + '&ciobookid=' + receipt + '&fileid=' + fileid + '&logo=' + logo + '&receipt=' + receipt + '&filename=' + fil0value221, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=244,left=210,width=350px,height=300px');
                else
                    window.open('adtaker.aspx?hei=' + document.getElementById('txtadsize1').value + '&wid=' + document.getElementById('txtadsize2').value, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0');
            }
        }

    }
    else {
        alert("Please select uom");

    }
    return false;
}

////this is when we open the matter item line wise
/*change*/
function uploadimage(edition1, id, ins, edition, fileid, ival) {

    document.getElementById('txtgrossamt').value = '';
    document.getElementById('txttotalamt').value = "";
    var receiptno = document.getElementById("txtreceipt");
    var ed = edition1;
    if (document.getElementById('drpuom').value != "0") {
        /*change*/
        var width = edition1;
        var hei = document.getElementById('txtadsize1').value;
        var wid = document.getElementById('txtadsize2').value;
        edition1 = edition
        var eyecatch = document.getElementById('drpbullet').value;
        var bgcolor = document.getElementById('drpbgcolor').value;
        var eyecatchlength = document.getElementById('txteyecathval').value;
        //  var width=document.getElementById('txtadsize2').value;
        //width="3.8";
        var uom = document.getElementById('drpuom').value;
        /*new change ankur sharma*/
        var uom_desc_ = document.getElementById('hiddenuomdesc').value;
        //                 /*new change ankur for matter*/
        //        if(uom_desc_=="ROD")
        //        {
        //            uom=document.getElementById('txtlogouomcode').value;
        //        
        //        }
        var insertid = ival;

        if (eyecatchlength == "") {
            eyecatchlength = "0";
        }
        /*new change ankur 9 feb*/
        if (bgcolor == "0" || bgcolor == "") {
            bgcolor = "White";
        }
        var insertid = ival;
        //alert(document.getElementById('txtinsertion').value);
        var insertNo = document.getElementById('ins' + ival).innerHTML;
        var adheight = "hei" + ival;
        var adwidth = "wid" + ival;
        var tot_area = "siz" + ival;
        var ins_id = ival;
        /*new change ankur for matter*/
        var name_logo;
        if (uom_desc_ == "ROD") {


            name_logo = document.getElementById('logonam' + ival).value


        }
        else {


            name_logo = "";
        }
        ///////////////////

        /*new change ankur 9 feb*/
        var coltype = document.getElementById('drpcolortype').value;
        ///////////////////
        if (coltype == "" || coltype == "0") {
            coltype = "Black";
        }


        /*new change ankur for matter*/
        var objpack = document.getElementById('drppackagecopy');
        var temp = "";
        var tempcode = "";
        var tempval = "";
        var tempvalcode = "";
        var desc = "";
        var code = "";
        var i = objpack.options.length;
        var j;

        for (j = 0; j < i; j++) {
            if (parseInt(i) > 0) {
                tempval = objpack[j].value;
                //tempvalcode=objpack[j].value;
                if (temp != "") {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    /*new change ankur for agency*/
                    code = tempvalcode + "+" + code;
                    desc = tempcode + "+" + desc;


                }
                else {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    code = tempvalcode;
                    desc = tempcode;
                }
            }

        }
        var width = desc.replace("+", "^");
        while (width.indexOf('+') >= 0) {
            width = width.replace("+", "^");
        }
        ////////////////////////////////



        //////////////////////////////



        //                 var insertionLin e="";
        //                if(document.getElementById('txtinsertion').value!="")
        //                {
        //                    insertionLine=document.getElementById('txtinsertion').value;
        //                }
        var logoprem = document.getElementById('drplogoprem').value;
        var logohei = document.getElementById('logohei' + ival).value;
        var logowid = document.getElementById('logowid' + ival).value;
        ///////////add by anuja

        var packagecode = document.getElementById('hiddenpackage').value;
        //////////////////////end
        /*change for oracle*/
        var prevcioid = document.getElementById('hiddendummycioid').value;
        if (document.getElementById('hiddenuomdesc').value == "ROC" || document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROW" || document.getElementById('hiddenuomdesc').value == "ROD") {
            var index = document.getElementById('drpcolor').selectedIndex;
            var textcolor = document.getElementById('drpcolor').options[index].text;
            if (textcolor.indexOf("COLOR") >= 0) {
                if (document.getElementById('drpbgcolor').value == "0") {
                    alert("Please Select Background Color");
                    document.getElementById('drpbgcolor').focus();
                    return false;
                }
            }
            if (document.getElementById('fil' + ival).value == "") {
                /*new change ankur for matter*/
                ed = ed.split("-");
                if (ed[0].substring(0, 2) == "HH") {
                    edi = "yes"
                }
                else {
                    edi = "no"
                }
                var no = "no"

                /*new change ankur for matter*/
                eyecatchtype = document.getElementById('hiddenbulletpremtype').value;
                var bPrem = document.getElementById('hiddenbullprem').value;
                var agency_vari = document.getElementById('txtagency');

                if (agency_vari.value != "") {
                    agencycode = agency_vari.value.substring(agency_vari.value.lastIndexOf("(") + 1, agency_vari.value.lastIndexOf(")"));
                }
                if (width.length > 1024)
                    width = "";
                if (clientfromconfig == "SP" || clientfromconfig == "RP") {
                    document.getElementById('txttotalarea').disabled = true;

                    window.open('editor_new.aspx?formname=QBC&agencycode=' + agencycode + '&bPrem=' + bPrem + '&eyecatchtype=' + eyecatchtype + '&modify=' + modifyMatter + '&insertNo=' + insertNo + '&filename=' + document.getElementById('fil' + ival).value + '&srno=' + ival + '&edition=' + edition + '&cioid=' + document.getElementById('txtciobookid').value + '&logo=' + document.getElementById('hiddenlogocode').value + '&eyecatch=' + eyecatch + '&bgcolor=' + bgcolor + '&eyecatchlength=' + eyecatchlength + '&width=' + width + '&uom=' + uom + '&insertid=' + insertid + '&insertsta=' + document.getElementById('inssta' + 0).value + '&coltype=' + coltype + '&uom_desc_=' + uom_desc_ + '&name_logo=' + name_logo + '&logohei=' + logohei + '&logowid=' + logowid + '&prevcioid=' + prevcioid + '&all=' + no + '&HH=' + edi + '&receiptno=' + receiptno + '&logoprem=' + logoprem, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0,scrollbars=yes');
                }
                else {
                    document.getElementById('txttotalarea').disabled = true;

                    window.open('editor.aspx?agencycode=' + agencycode + '&bPrem=' + bPrem + '&eyecatchtype=' + eyecatchtype + '&modify=' + modifyMatter + '&insertNo=' + insertNo + '&filename=' + document.getElementById('fil' + ival).value + '&srno=' + ival + '&edition=' + edition + '&cioid=' + document.getElementById('txtciobookid').value + '&eyecatch=' + eyecatch + '&bgcolor=' + bgcolor + '&eyecatchlength=' + eyecatchlength + '&width=' + width + '&uom=' + uom + '&insertid=' + insertid + '&coltype=' + coltype + '&uom_desc_=' + uom_desc_ + '&name_logo=' + name_logo + '&logohei=' + logohei + '&logowid=' + logowid + '&prevcioid=' + prevcioid + '&all=' + no + '&HH=' + edi + '&receiptno=' + receiptno + '&packagecode=' + packagecode, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0,scrollbars=yes');
                }
            }
            else {
                /*new change ankur for matter*/
                ed = ed.split("-");
                if (ed[0].substring(0, 2) == "HH") {
                    edi = "yes"
                }
                else {
                    edi = "no"
                }
                var no = "no"

                /*new change ankur for matter*/
                eyecatchtype = document.getElementById('hiddenbulletpremtype').value;
                var bPrem = document.getElementById('hiddenbullprem').value;
                var agency_vari = document.getElementById('txtagency');
                if (agency_vari.value != "") {
                    agencycode = agency_vari.value.substring(agency_vari.value.lastIndexOf("(") + 1, agency_vari.value.lastIndexOf(")"));
                }
                if (width.length > 1024)
                    width = "";
                if (clientfromconfig == "SP" || clientfromconfig == "RP") {
                    document.getElementById('txttotalarea').disabled = true;



                    window.open('editor_new.aspx?formname=QBC&agencycode=' + agencycode + '&bPrem=' + bPrem + '&eyecatchtype=' + eyecatchtype + '&modify=' + modifyMatter + '&insertNo=' + insertNo + '&filename=' + document.getElementById('fil' + ival).value + '&srno=' + ival + '&edition=' + document.getElementById(edition).value + '&cioid=' + document.getElementById('txtciobookid').value + '&eyecatch=' + eyecatch + '&bgcolor=' + bgcolor + '&logo=' + document.getElementById('hiddenlogocode').value + '&eyecatchlength=' + eyecatchlength + '&width=' + width + '&uom=' + uom + '&insertid=' + insertid + '&insertsta=' + document.getElementById('inssta' + 0).value + '&coltype=' + coltype + '&uom_desc_=' + uom_desc_ + '&name_logo=' + name_logo + '&logohei=' + logohei + '&logowid=' + logowid + '&prevcioid=' + prevcioid + '&all=' + no + '&HH=' + edi + '&receiptno=' + receiptno + '&logoprem=' + logoprem, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0,scrollbars=yes');
                }
                else {
                    document.getElementById('txttotalarea').disabled = true;

                    window.open('editor.aspx?agencycode=' + agencycode + '&bPrem=' + bPrem + '&eyecatchtype=' + eyecatchtype + '&modify=' + modifyMatter + '&insertNo=' + insertNo + '&filename=' + document.getElementById('fil' + ival).value + '&srno=' + ival + '&edition=' + document.getElementById(edition).value + '&cioid=' + document.getElementById('txtciobookid').value + '&eyecatch=' + eyecatch + '&bgcolor=' + bgcolor + '&eyecatchlength=' + eyecatchlength + '&width=' + width + '&uom=' + uom + '&insertid=' + insertid + '&coltype=' + coltype + '&uom_desc_=' + uom_desc_ + '&name_logo=' + name_logo + '&logohei=' + logohei + '&logowid=' + logowid + '&prevcioid=' + prevcioid + '&all=' + no + '&HH=' + edi + '&receiptno=' + receiptno + '&packagecode=' + packagecode, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0,scrollbars=yes');
                }
            }
        }
        else {
            /*mysql*/
            //if(document.getElementById('chkattach').checked==false && document.getElementById('hiddentypedatabase').value!="mysql" )
            //////////////
            if (document.getElementById('chkad').checked == true) {

                var edit = document.getElementById(edition).value;
                var ciobookid = document.getElementById('txtciobookid').value;
                //var fileid="bookdiv";
                window.open('adtaker.aspx?uom=' + document.getElementById('hiddenuom1').value + '&hei=' + adheight + '&wid=' + adwidth + '&ins=' + insertNo + '&edition=' + edit + '&ciobookid=' + ciobookid + '&fileid=' + fileid + '&tot_area=' + tot_area + '&ins_id=' + ins_id, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0');

                // window.open('adtaker.aspx?hei='+hei+'&wid='+wid,'','width='+screen.availWidth+',height='+screen.availHeight+',resizable=1,left=0,top=0');
            }
            else {
                var edit = document.getElementById(edition).value;
                var ciobookid = document.getElementById('txtciobookid').value;
                if (adheight == '') {
                    alert("Please enter Ad Height");
                    document.getElementById('hei' + ival).focus();
                    return false;
                }
                else if (adwidth == '') {
                    alert("Please enter Ad Width");
                    document.getElementById('wid' + ival).focus();
                    return false;
                }
                /*new change ankur 23 feb*/
                var logo = "logonot";
                if (document.getElementById(adheight).value == "") {
                    alert("Please Enter Ad Height");
                    return false;
                }
                else if (document.getElementById(adwidth).value == "") {
                    alert("Please Enter Ad Width");
                    return false;
                }
                //    var resno=QBC.getCategoryTemplate(document.getElementById('drpadcategory').value);
                var cou = 0;
                //if(resno.value!=null)
                //  cou=resno.value;

                if (cou == 0) {
                    //  var receipt=document.getElementById('txtreceipt').value;
                    var receipt = document.getElementById('txtciobookid').value;
                    window.open('default3.aspx?color=' + document.getElementById('drpcolor').value + '&adheight=' + document.getElementById(adheight).value + '&adwidth=' + document.getElementById(adwidth).value + '&no=' + insertid + '&ins=' + ins + '&edition=' + edit + '&ciobookid=' + receipt + '&fileid=' + fileid + '&logo=' + logo, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=244,left=210,width=350px,height=300px');
                }
                else
                    window.open('adtaker.aspx?hei=' + document.getElementById(adheight).value + '&wid=' + document.getElementById(adwidth).value, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0');


            }
        }
    }
    else {
        alert("Please select uom");

    }
    return false;


}





/*******************code for cut************/
function CutToClipboard() {
    document.execCommand("Cut");
    document.getElementById('editordiv').focus;
    //      document.getElementById('pasteT').disabled=false;
    //      document.getElementById('paste').disabled=false;
    //      document.getElementById('rightpaste').disabled=false;
    //      document.getElementById('paste').src="icons/paste.jpg"; 


}
function CopyToClipboard() {
    document.execCommand("Copy");
    document.getElementById('editordiv').focus;
    //    /*opener.*/document.getElementById('pasteT').disabled=false;
    //    document.getElementById('paste').disabled=false;
    //    document.getElementById('rightpaste').disabled=false;
    //    document.getElementById('paste').src="icons/paste.jpg"; 

}

function PasteFromClipboard() {
    try {

        document.getElementById('editordiv').focus();
        document.execCommand("Paste");

        var ab = document.getElementById('editordiv').innerHTML;
        var ab1 = ab.split("<DIV");
        for (var i = 2; i < ab1.length; i++) {
            var ab2 = ab1[i].split("id=");
            var ab3 = ab2[1].split(" ");
            document.getElementById(ab3[0]).id = i;
        }
        document.getElementById('ctrval').value = i + 1;
        document.getElementById('editordiv').focus();
    }
    catch (er) { }
}

/******************************************************font_name***************************/
function fontName1() {
    editordiv.style.fontFamily = document.getElementById('fnt_fntname').value;
    //prediv.style.fontFamily=document.getElementById('fnt_fntname').value;
    return false;
}





/***********************************************font_toolbar***********************************************/
function disabled() {
    document.getElementById('italic').disabled = true;
    document.getElementById('italic').src = "Images/italic_d.jpg";

    document.getElementById('bold').disabled = true;
    document.getElementById('bold').src = "Images/bold_d.jpg";

    document.getElementById('underline').disabled = true;
    document.getElementById('underline').src = "Images/underline_d.jpg";

}



/*****************************************/


//fontoolbar//
function getid(obj) {
    currentid = obj.id; document.getElementById('current_id').value = currentid;
}
function roll_over(img_name, img_src) { document[img_name].src = img_src; }


//////////////////////get the size

function getsize() {
    var size = document.getElementById('fnt_fntsize').value
    document.execCommand("FontSize", 0, size);
    return false;

}



/*************************************count_charactor******************************/

function countchar() {
    if (browser != "Microsoft Internet Explorer") {
        var tempvar = document.getElementById('editordiv').textContent;
    }
    else {
        var tempvar = document.getElementById('editordiv').innerText;
    }
    //var  tempvar=document.getElementById('editordiv').innerText;

    document.getElementById('txtbox1').value = tempvar.length;

}


/*******************************line_spacing***********************/

function linespacing() {
    var temp = document.getElementById('fnt_txtline').value;
    document.getElementById('editordiv').style.lineHeight = temp;
}


/*****************************************************************Engfonts*************************/

function getFonts() {
    //alert("hi");
    var nFontLen = dlgHelper.fonts.count;
    var rgFonts = new Array();

    for (var i = 1; i < nFontLen + 1; i++) {
        rgFonts[i] = dlgHelper.fonts(i);
    }
    rgFonts.sort();
    //alert(document.getElementById('fonttoolbar_fntname'))
    var objfont = document.getElementById('fnt_fntname');
    objfont.options.length = 0;
    // var obj2font=document.getElementById('fnt_fntname');
    //objfont.options.length=0;
    // for ( var j = 0; j < nFontLen; j++ )
    //{
    //objfont.options[0] = new Option("Bhaskar","Bhaskar");
    // obj2font.options[j] = new Option(rgFonts[j],rgFonts[j]);
    //}
    if (document.getElementById('fnt_alignment').value == "Hindi") {
        document.getElementById('KM').style.display = "block";
        objfont.options[0] = new Option("Bhaskar", "Bhaskar");
    }
    else {
        document.getElementById('KM').style.display = "none";
        for (var j = 0; j < nFontLen; j++) {
            objfont.options[j] = new Option(rgFonts[j], rgFonts[j]);
            //obj2font.options[j] = new Option(rgFonts[j],rgFonts[j]);
        }
    }
}



/*****************************************preview*************************************/

function privewchar() {
    //  if(document.getElementById('editordiv').
    var tempvar = document.getElementById('editordiv').innerHTML;
    //   var tempvar= tempvar.replace("size=7","size=1");
    //   var tempvar= tempvar.replace("size=6","size=1");
    //   var tempvar= tempvar.replace("size=5","size=1");
    //   var tempvar= tempvar.replace("size=4","size=1");
    //   var tempvar= tempvar.replace("size=3","size=1");
    //   var tempvar= tempvar.replace("size=2","size=1");
    //   document.getElementById('prediv').innerHTML=tempvar;
    //   //prehight();
}

/*******************************************decreaseFontSize***************/


function decreaseFontSize() {
    var tempab = document.getElementById('editordiv').innerHTML;
    //   var tempab= tempab.replace("size=7","size=1");
    //   var tempab= tempab.replace("size=6","size=1");
    //   var tempab= tempab.replace("size=5","size=1");
    //   var tempab= tempab.replace("size=4","size=1");
    //   var tempab= tempab.replace("size=3","size=1");
    //   var tempab= tempab.replace("size=2","size=1");
}

function getheight() {
    getwidth();
    if (document.getElementById('drppackagecopy').options.length == 0) {
        alert("Please select the package");
        document.getElementById('drppackage').focus();
        return false;

    }

    if (document.getElementById('drpuom').value == "0") {
        alert("Please select uom");
        document.getElementById('txtadsize1').value = ""
        document.getElementById('txtadsize2').value = ""
        document.getElementById('drpuom').focus();
        return false;

    }


    var value = chkamount('txtadsize1');
    if (value == "f") {
        return false;
    }
    if (parseFloat(document.getElementById('txtadsize1').value) == 0 || parseFloat(document.getElementById('txtadsize2').value) == 0) {
        alert("0 is not accepted");
        var idrem = document.activeElement.id;
        //document.getElementById(idrem).value="";

        return false;


    }

    if (document.getElementById('txtcardrate').value != "") {
        document.getElementById('txtcardrate').value = ""
        document.getElementById('txtgrossamt').value = ""
        document.getElementById('txttotalamt').value = "";
    }


    var objpack = document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var code = "";
    var codesplit = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (temp != "") {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                desc = tempcode + "+" + desc;


            }
            else {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                desc = tempcode;

            }
        }

    }
    if (document.getElementById('txtcolum').value != "") {
        QBC.getwidthforcoll(desc, document.getElementById('txtcolum').value, document.getElementById('hiddencompcode').value, call_getheight);
    }
    else {
        if (document.getElementById('txtadsize2').value != "" && document.getElementById('txtadsize1').value != "") {
            var height = parseFloat(document.getElementById('txtadsize1').value);
            var width = parseFloat(document.getElementById('txtadsize2').value);
            var totarval = 0;
            if (document.getElementById('txtcolum').value != '') {
                totarval = height * parseInt(document.getElementById('txtcolum').value);

            }
            else {
                totarval = height * width;
            }
            document.getElementById('txttotalarea').value = totarval.toFixed(2);
        }
        else if (document.getElementById('txtadsize1').value != "" && document.getElementById('txttotalarea').value != "") {
            var h_ = document.getElementById('txtadsize1').value;
            var area_ = document.getElementById('txttotalarea').value;
            document.getElementById('txtadsize2').value = formatDecimal(parseFloat(area_) / parseFloat(h_), true, 2);
        }


        if (document.getElementById('tblinsert').innerHTML != "") {
            var hei = document.getElementById('txtadsize1').value
            var wid = document.getElementById('txtadsize2').value
            getpageareaintogrid(hei, wid);
        }

    }


    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";


}

function call_getheight(res) {
    var ds = res.value;
    if (ds == null)
        return false;
    if (ds.Tables[1].Rows.length > 0) {
        var height_ = document.getElementById('txtadsize1').value;
        var ds_height = ds.Tables[1].Rows[0].size_height;
        if (parseFloat(height_) > parseFloat(ds_height)) {
            alert("Height exceeds with edition total height");
            document.getElementById('txtadsize1').value = "";
            document.getElementById('txtadsize1').focus();
            return false;
        }
        if (ds.Tables[1].Rows.length > 0) {
            glob_area = ds.Tables[1].Rows[0].edition_area;
        }

    }

    if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtadsize2').value != "") {
        var h_ = document.getElementById('txtadsize1').value;
        var w_ = document.getElementById('txtadsize2').value;
        if (document.getElementById('txtcolum').value != '') {
            document.getElementById('txttotalarea').value = formatDecimal(parseFloat(h_) * parseInt(document.getElementById('txtcolum').value), true, 2);
        }
        else {
            document.getElementById('txttotalarea').value = formatDecimal(parseFloat(h_) * parseFloat(w_), true, 2);
        }

    }
    else if (document.getElementById('txtadsize1').value != "" && document.getElementById('txttotalarea').value != "") {
        var h_ = document.getElementById('txtadsize1').value;
        var area_ = document.getElementById('txttotalarea').value;
        document.getElementById('txtadsize2').value = formatDecimal(parseFloat(area_) / parseFloat(h_), true, 2);
    }

    if (document.getElementById('tblinsert').innerHTML != "") {
        var hei = document.getElementById('txtadsize1').value
        var wid = document.getElementById('txtadsize2').value
        getpageareaintogrid(hei, wid);
    }


}

function chkwidth() {

    if (document.getElementById('drppackagecopy').options.length == 0) {
        alert("Please select the package");
        document.getElementById('drppackage').focus();
        return false;

    }

    if (document.getElementById('drpuom').value == "0") {
        alert("Please select uom");
        document.getElementById('txtadsize1').value = ""
        document.getElementById('txtadsize2').value = ""
        document.getElementById('drpuom').focus();
        return false;

    }

    var value = chkamount('txtadsize2');
    if (value == "f") {
        return false;
    }

    if (parseFloat(document.getElementById('txtadsize2').value) == 0) {
        alert("0 is not accepted");
        var idrem = document.activeElement.id;
        //document.getElementById(idrem).value="";

        return false;


    }

    if (document.getElementById('txtcardrate').value != "") {
        document.getElementById('txtcardrate').value = ""
        document.getElementById('txtgrossamt').value = ""
        document.getElementById('txttotalamt').value = "";
    }

    var objpack = document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var code = "";
    var codesplit = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (temp != "") {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                desc = tempcode + "+" + desc;


            }
            else {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                desc = tempcode;

            }
        }

    }
    if (document.getElementById('txtcolum').value != "") {
        QBC.getwidthforcoll(desc, document.getElementById('txtcolum').value, document.getElementById('hiddencompcode').value, call_chkwidth);

    }
    else {
        if (document.getElementById('txtadsize2').value != "" && document.getElementById('txtadsize1').value != "") {
            var height = parseFloat(document.getElementById('txtadsize1').value);
            var width = parseFloat(document.getElementById('txtadsize2').value);
            var totarval = 0;
            if (document.getElementById('txtcolum').value != "") {
                totarval = height * parseInt(document.getElementById('txtcolum').value);
            }
            else {
                totarval = height * width;
            }
            document.getElementById('txttotalarea').value = totarval.toFixed(2);
        }
        if (document.getElementById('txtadsize2').value != "" && document.getElementById('txttotalarea').value != "") {
            var width = document.getElementById('txtadsize2').value;
            var area_ = document.getElementById('txttotalarea').value
            document.getElementById('txtadsize1').value = formatDecimal(parseFloat(area_) / parseFloat(width), true, 2);
        }


        if (document.getElementById('tblinsert').innerHTML != "") {
            var hei = document.getElementById('txtadsize1').value
            var wid = document.getElementById('txtadsize2').value
            getpageareaintogrid(hei, wid);
        }



    }
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";

}

function call_chkwidth(res) {
    var ds = res.value;
    if (ds.Tables[1].Rows.length > 0) {
        var width_ = document.getElementById('txtadsize2').value;
        var ds_height = ds.Tables[1].Rows[0].size_width;
        if (parseFloat(width_) > parseFloat(ds_height)) {
            document.getElementById('txtadsize2').focus();
            alert("Width exceeds with edition total width");
            document.getElementById('txtadsize2').value = "";
            return false;
        }
        if (ds.Tables[1].Rows.length > 0) {
            glob_area = ds.Tables[1].Rows[0].edition_area;
        }

    }
    if (document.getElementById('txtadsize2').value != "" && document.getElementById('txtadsize1').value != "") {
        var height = parseFloat(document.getElementById('txtadsize1').value);
        var width = parseFloat(document.getElementById('txtadsize2').value);
        var totarval = 0;
        if (document.getElementById('txtcolum').value != "") {
            totarval = height * parseInt(document.getElementById('txtcolum').value);
        }
        else {
            totarval = height * width;
        }
        document.getElementById('txttotalarea').value = totarval.toFixed(2);
    }
    if (document.getElementById('txtadsize2').value != "" && document.getElementById('txttotalarea').value != "") {
        var width = document.getElementById('txtadsize2').value;
        var area_ = document.getElementById('txttotalarea').value
        document.getElementById('txtadsize1').value = formatDecimal(parseFloat(area_) / parseFloat(width), true, 2);
    }
    if (document.getElementById('tblinsert').innerHTML != "") {
        var hei = document.getElementById('txtadsize1').value
        var wid = document.getElementById('txtadsize2').value
        getpageareaintogrid(hei, wid);
    }


}

function getpageareaintogrid(h, w) {
    var len = "bookdiv";
    var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    var i = 0;
    var k;
    var height;
    var width;
    var coll;
    var size;
    var column_var = document.getElementById('txtcolum');
    for (k = 0; i < y - 1; k++) {
        height = "hei" + i;
        var height_vari = document.getElementById(height);
        var par1 = (height_vari.parentNode).parentNode;

        width = "wid" + i;
        size = "siz" + i;
        coll = "nocol" + i;
        if (browser != "Microsoft Internet Explorer") {
            document.getElementById(height).value = h;
            document.getElementById(width).value = w;
            document.getElementById(coll).value//=document.getElementById('txtcolum').value
            if (column_var.value != "") {
                document.getElementById(size).value = parseFloat(h) * parseFloat(document.getElementById(coll).value)
            }
            else if (w != "") {
                document.getElementById(size).value = parseFloat(h) * parseFloat(w);
            }
            else if (w == "" && document.getElementById(coll).value != "") {
                document.getElementById(size).value = parseFloat(h) * parseFloat(document.getElementById(coll).value)
            }
            if (document.getElementById(size).value == "NaN") {
                document.getElementById(size).value = "";
            }
        }
        else {
            par1.all[height].value = h;
            par1.all[width].value = w;
            par1.all[coll].value//=document.getElementById('txtcolum').value
            if (column_var.value != "") {
                par1.all[size].value = parseFloat(h) * parseFloat(par1.all[coll].value)
            }
            else if (w != "") {
                par1.all[size].value = parseFloat(h) * parseFloat(w);
            }
            else if (w == "" && par1.all[coll].value != "") {
                par1.all[size].value = parseFloat(h) * parseFloat(par1.all[coll].value)
            }
            if (par1.all[size].value == "NaN") {
                par1.all[size].value = "";
            }
        }

        i++;

    }

} //

/////
function chkamount(e) {
    var flag = "";
    //return allamount121(e);
    e = document.getElementById(e); //.value;
    //alert(e);
    //alert(e.value);
    //var fld=e.value;
    var fld = e.value;
    if (fld != "") {
        //var expression= ^-{0,1}\d*\.{0,1}\d+$;
        if (fld.match(/^\d+(\.\d{1,2})?$/i)) {
            //return true;
            //checkpackagerate();
            flag = "t";
            return flag;
        }
        else {
            alert("Input Error")
            //alert(e.id);
            var str = e.id;
            e.value = "";
            document.getElementById(str).focus();
            flag = "f";
            //e.id.focus();
            return flag;
        }
    }

}



function chkcasualclient() {
    var client = document.getElementById('txtclient').value;

    if (client.indexOf('(') >= 0) {
        return false;
    }
    if (document.getElementById('txtclient').value != "") {

        var arrclient;
        if (client.indexOf('(') >= 0) {
            arrclient = client.split('(');
            client = arrclient[0];
        }
        var compcode = document.getElementById('hiddencompcode').value;
        QBC.chkcasualcli(client, compcode, call_chkcasualcli);
        return false;
    }

}

function call_chkcasualcli(res) {
    var ds = res.value;
    if (ds.Tables[0] != undefined && ds.Tables[0].Rows[0].custname != undefined) {
        if (ds.Tables[0].Rows.length > 0 && ds.Tables[0].Rows[0].custname != "0") {

            document.getElementById('divclient').style.display = "block";
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById('divclient').style.top = parseInt(document.getElementById('txtclient').offsetTop) + parseInt(document.getElementById('sectd').offsetTop) + parseInt(document.getElementById('tdclient').offsetTop) + parseInt(document.getElementById('tbl1').offsetTop) + parseInt(document.getElementById('tbl2').offsetTop) + parseInt(document.getElementById('tbl3').offsetTop) + parseInt(document.getElementById('OuterTable').offsetTop - 6) + "px";
                document.getElementById('divclient').style.left = parseInt(document.getElementById('txtclient').offsetLeft) + parseInt(document.getElementById('sectd').offsetLeft) + parseInt(document.getElementById('tdclient').offsetLeft) + parseInt(document.getElementById('tbl1').offsetLeft) + parseInt(document.getElementById('tbl2').offsetLeft) + parseInt(document.getElementById('tbl3').offsetLeft) + parseInt(document.getElementById('OuterTable').offsetLeft) + 3 + "px";
            }
            else {
                document.getElementById('divclient').style.top = parseInt(document.getElementById('txtclient').offsetTop) + parseInt(document.getElementById('sectd').offsetTop) + parseInt(document.getElementById('tdclient').offsetTop) + parseInt(document.getElementById('tbl1').offsetTop) + parseInt(document.getElementById('tbl2').offsetTop) + parseInt(document.getElementById('tbl3').offsetTop) + parseInt(document.getElementById('OuterTable').offsetTop) + 6 + "px";
                document.getElementById('divclient').style.left = parseInt(document.getElementById('txtclient').offsetLeft) + parseInt(document.getElementById('sectd').offsetLeft) + parseInt(document.getElementById('tdclient').offsetLeft) + parseInt(document.getElementById('tbl1').offsetLeft) + parseInt(document.getElementById('tbl2').offsetLeft) + parseInt(document.getElementById('tbl3').offsetLeft) + parseInt(document.getElementById('OuterTable').offsetLeft) + 9 + "px";
            }
            var pkgitem = document.getElementById("lstclient");
            pkgitem.options.length = 0;
            //pkgitem.options[0]=new Option("-Select Client-","0");
            pkgitem.options[pkgitem.options.length] = new Option('Casual', 'c');
            pkgitem.options.length = 1
            pkgitem.options[1] = new Option('Register', 'r');

            var add2 = "";

            pkgitem.options.length = 2;
            for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
                if (ds.Tables[0].Rows[i].add1 != null) {
                    add2 = ds.Tables[0].Rows[i].add1;
                }
                else {
                    add2 = "";
                }
                pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].Cust_Name + "+" + add2, ds.Tables[0].Rows[i].Cust_Code);

                pkgitem.options.length;

            }


            document.getElementById('hiddenClient').value = document.getElementById('txtclient').value;
            document.getElementById('txtclient').value = "";
            document.getElementById("lstclient").value = "c";
            document.getElementById("lstclient").focus();

        }
        /*   else if(ds.Tables[0].Rows[0].custname!="0")
        {
        document.getElementById('txtclient').value=ds.Tables[0].Rows[0].custname;
        var clientstreet="";
        if(ds.Tables[0].Rows[0].Stree!=null)
        {
        clientstreet=ds.Tables[0].Rows[0].Stree;
        }
        document.getElementById('txtclientadd').value=ds.Tables[0].Rows[0].add1+" "+ ds.Tables[0].Rows[0].Stree;
        }*/
        else {

            ///change /////
            //for online it is to chk that whether to register the   client and on offline no need to chk/////
            if (document.getElementById('hiddenregClient').value != "no") {
                if (confirm('Do you want to register this client?')) {
                    var frombooking = "1";
                    var clientname = document.getElementById('txtclient').value;
                    window.open('ClientMaster.aspx?frombooking=' + frombooking + '&clientname=' + clientname, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0,scrollbars=yes');

                }
            }

        }
    }
    else {

        ///change /////
        //for online it is to chk that whether to register the casual client and on offline no need to chk/////
        //if(document.getElementById('hiddentypedatabase').value!="mysql")
        //{   
        if (confirm('Do you want to register this client?')) {
            var frombooking = "1";
            var clientname = document.getElementById('txtclient').value;
            window.open('ClientMaster.aspx?frombooking=' + frombooking + '&clientname=' + clientname, '', 'width=' + screen.availWidth + ',height=' + screen.availHeight + ',resizable=1,left=0,top=0,scrollbars=yes');

        }
        //}

    }

    /*chaNge */
    ////this is to add the client in the drop down of billto////
    var lenofbillto = document.getElementById('drpbillto_qbc').options.length;
    //var lenofbillto=parseInt(lenofbillto)+1;
    var client_val = document.getElementById('txtclient').value
    document.getElementById('drpbillto_qbc').options[1] = new Option(client_val, client_val);
    /*new change ankur 9 feb*/
    /*mysql*/
    if (document.getElementById('hiddentypedatabase').value == "mysql") {
        document.getElementById('drpbillto_qbc').value = client_val;
    }
    /////////////////
    ///////////////////////////////////////////////////

}


///this is the function which changes the background color on focus
function changebackcolor(e) {
    var idfoc = e.id;
    if (idfocus != "") {
        document.getElementById(idfocus).style.backgroundColor = "";
    }
    document.getElementById(idfoc).style.backgroundColor = "#FFFF80";
    idfocus = e.id;
}
//////////////////////this is for davp ad where user enter height and collumn and width comes automatically from 
//////lay out x table and from that total area comes
function getwidth() {
    if (parseInt(document.getElementById('txtcolum').value) == 0) {
        alert("No. of Columns can't be 0");
        return false;
    }

    //        if(parseInt(document.getElementById('txtcolum').value)>8)
    //        {
    //            document.getElementById('txtadsize2').disabled=true;
    //        }


    document.getElementById('txtgrossamt').value = ""
    document.getElementById('txttotalamt').value = "";
    if (document.getElementById('txtcolum').value != "") {
        document.getElementById('txtadsize2').disabled = true;
    }
    else {
        document.getElementById('txtadsize2').value = "";
        document.getElementById('txttotalarea').value = "";
        document.getElementById('txtadsize2').disabled = false;


        if (document.getElementById('tblinsert').innerHTML != "") {
            var size;
            var len = "bookdiv";
            var width;
            var noofcol;
            var i = 0;
            var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
            var y_ = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
            for (k_ = 0; k_ < y_; k_++) {
                size = "siz" + i;
                width = "wid" + i;
                noofcol = "nocol" + i;

                document.getElementById(size).value = "";
                document.getElementById(width).value = "";
                document.getElementById(noofcol).value = "";


                i++;

            }


        }


    }

    var objpack = document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var code = "";
    var codesplit = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (temp != "") {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                desc = tempcode.substr(0, tempcode.lastIndexOf("(")) + "+" + desc;

            }
            else {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                desc = tempcode.substr(0, tempcode.lastIndexOf("("));

            }
        }

    }
    //                                if(document.getElementById('Hiddendrppageposition')!=null)
    //                                {
    //                                    if(document.getElementById('Hiddendrppageposition').disabled==false)
    //                                    {
    //                                        document.getElementById('Hiddendrppageposition').focus();
    //                                    }
    //                                }
    QBC.getwidthforcoll(desc, document.getElementById('txtcolum').value, document.getElementById('hiddencompcode').value, call_getwidthforcoll);



}
function call_getwidthforcoll(res) {

    var ds = res.value

    if (ds != null) {
        if (ds.Tables[0].Rows.length > 0) {

            if (ds.Tables[0].Rows[0].col_cc == null) {
                document.getElementById('txtadsize2').value = "";
                document.getElementById('txttotalarea').value = "";
            }
            else
                document.getElementById('txtadsize2').value = ds.Tables[0].Rows[0].col_cc
            if (document.getElementById('txtadsize1').value != "") {
                if (document.getElementById('txtcolum').value != '') {
                    document.getElementById('txttotalarea').value = parseFloat(document.getElementById('txtadsize1').value) * parseFloat(document.getElementById('txtcolum').value);
                }
                else if (document.getElementById('txtadsize2').value != "") {
                    document.getElementById('txttotalarea').value = parseFloat(document.getElementById('txtadsize1').value) * parseFloat(document.getElementById('txtadsize2').value);
                }
            }
            if (ds.Tables[1].Rows.length > 0) {
                glob_area = ds.Tables[1].Rows[0].edition_area;
            }


        }
        else {
            alert("Booking not be possible");
            return false;

        }

        if (document.getElementById('tblinsert').innerHTML != "") {
            var size;
            var len = "bookdiv";
            var width;
            var noofcol;
            var i = 0;
            var totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
            y = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
            for (k = 0; k < y; k++) {


                while (document.getElementById("card" + i) == null && k < y - 1) {
                    i = i + totid;

                }

                if (k >= y) {
                    break;
                }

                size = "siz" + i;
                width = "wid" + i;
                noofcol = "nocol" + i;

                document.getElementById(size).value = document.getElementById('txttotalarea').value;
                document.getElementById(width).value = document.getElementById('txtadsize2').value;
                document.getElementById(noofcol).value = document.getElementById('txtcolum').value;


                i++;

            }


        }


    }
    return false;
}

///////////this is the function which fills into grid on change of color when grid is visibile
function fillcoloringrid() {
    //alert(noofinsertlo)

    /*mysql*/
    var index = document.getElementById('drpcolor').selectedIndex;
    var textcolor = document.getElementById('drpcolor').options[index].text;
    //			if(textcolor.indexOf("COLOR")>=0)
    //			{
    //			    document.getElementById('drpbgcolor').disabled=false;
    //			}
    //			else
    //			{
    //			    document.getElementById('drpbgcolor').value="0";
    //			    document.getElementById('drpbgcolor').disabled=true;
    //			}
    document.getElementById('txtcardrate').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    document.getElementById('txttotalarea').value = "";

    ////////////////////////////
    if (document.getElementById("hiddenuomdesc").value == "CD") {
        document.getElementById("txtcolum").value = "";
        document.getElementById("txtadsize1").value = "";
        document.getElementById("txtadsize2").value = "";
    }
    /////////////////////////////

    var len = "bookdiv";
    if (document.getElementById('tblinsert').innerHTML != "") {
        //var y=parseInt(noofinsertlo)   
        var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
        var k;
        var colid;
        var i = 0;

        for (k = 0; k < y - 1; k++) {

            while (document.getElementById("card" + i) == null) {
                i = i + savtotid;

            }
            colid = "col" + i;
            document.getElementById(colid).value = document.getElementById('drpcolor').value



            document.getElementById("siz" + k).value = "";

            if (browser != "Microsoft Internet Explorer") {
                var na = "B";
                var dan = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows[i + 1].cells[4].innerHTML; //document.getElementById(colid).innerHTML;
                dan = dan.replace("selected=\"true\"", "");
                dan = dan.replace("value=\"" + na + "\"", "value=\"" + document.getElementById('drpcolor').value + "\"");
                na = "CO0";
                dan = dan.replace("value=\"" + na + "\"", "value=\"" + document.getElementById('drpcolor').value + "\"");
                na = "0";
                dan = dan.replace("value=\"" + na + "\"", "value=\"" + document.getElementById('drpcolor').value + "\"");
                document.getElementById('bookdiv').getElementsByTagName('table')[0].rows[i + 1].cells[4].innerHTML = dan;
                // document.getElementById(colid).innerHTML = dan;
            }
            i = parseInt(i) + 1;
        }
    }
    chklevelofcategory();
    //alert(document.getElementById('tblinsert').innerHTML);
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    return false;
}

////////this is the function which is to calculate the solo extra line rate for the per insertion line		
function getsoloextrarateforqbc(adscat, color, edit, size, adcat1, grid_gross, gridid) {
    ////this is the page which we call to chk whether the no. of lines or words falls in the to inserts and from 
    /////than package rate is to be taken and if it e<divxceeds than extra rate of solo  is to be added ih the break up gross amt  

    if (document.getElementById('hiddenuomdesc').value == "ROC" || document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROW" || document.getElementById('hiddenuomdesc').value == "ROD" || document.getElementById('hiddenuomdesc').value == "CD") {
        var gridfromline;
        var gridtoline;
        var gridextrarate
        if (ds_sch != null) {
            if (ds_sch.Tables[1].Rows.length > 0) {
                gridfromline = ds_sch.Tables[1].Rows[0].Size_from;
                gridtoline = ds_sch.Tables[1].Rows[0].Size_to;
                gridextrarate = ds_sch.Tables[1].Rows[0].extrarate;
                var rol = size
                var totcardrate = document.getElementById('txtcardrate').value

                if (parseInt(rol) > parseInt(gridtoline)) {
                    var totline = parseInt(rol) - parseInt(gridtoline)
                    var totrate = parseFloat(gridextrarate) * parseInt(totline);
                    var tot_rat = parseFloat(document.getElementById("gro" + gridid).value) + parseFloat(totrate);
                    document.getElementById("gro" + gridid).value = formatDecimal(tot_rat, true, 2);

                    var len = "bookdiv";
                    var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
                    var i = 0;
                    var k;
                    var gross;
                    var tot_gross = 0;
                    for (k = 0; i < y - 1; k++) {
                        while (document.getElementById("card" + i) == null && k < y - 1) {
                            i = i + totid;

                        }
                        if (k >= y - 1) {
                            break;
                        }
                        gross = "gro" + i;
                        tot_gross = parseFloat(document.getElementById(gross).value) + tot_gross;

                        i++;

                    }
                    document.getElementById('txtgrossamt').value = formatDecimal(parseFloat(tot_gross), true, 2);

                }




            }
        }
    }



}

///////////////////////////////////////this is the call back function to bind the grid when we subtract the insertion date

//function insertLinesubtract_callback(packagename,check)
//{
//                        // get No of Insertion
//                    var finsert=1;    
//                    var insertion=document.getElementById('txtinsertion').value;
//                    if(check=='main')
//                    {
//                        if(document.getElementById('drppackagecopy').options.length>0)
//                        {
//                            for(var insertCou=0;insertCou<document.getElementById('drppackagecopy').options.length;insertCou++)
//                            {
//                                if(document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(')>=0)
//                                {
//                                    tinsert=document.getElementById('drppackagecopy').options[insertCou].value.substring(document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(')+1,document.getElementById('drppackagecopy').options[insertCou].value.indexOf(')'));
//                                }    
//                                var dInsert=(parseInt(previnsertion) * parseInt(tinsert))-(parseInt(insertion) * parseInt(tinsert));
//                                var insid="";
//                                for(var d=parseInt(document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length)-2;d>=0;d--)
//                                {
//                                    if(insid!="")
//                                    {
//                                        if(insid!=document.getElementById("ins"+d).innerHTML)
//                                        {
//                                             dInsert=parseInt(dInsert)-1;
//                                        }
//                                     }   
//                                    if(dInsert==0)
//                                        break;
//                                     var strid = document.getElementById('drppackagecopy').options[insertCou].value;
//                                     var strid1=strid.split('@');
//                                     var pkgid=strid1[0];
//                                     var pkgcodegrid=document.getElementById("hiddenpckcode"+d).value;
//                                     if(pkgcodegrid == pkgid)
//                                     {
//                                         insid=document.getElementById("ins"+d).innerHTML;
//                                        document.getElementById('gridtab').deleteRow(d+1);
//                                       
//                                     }
//                                }
//                            }
//                        } 
//                        
//                    }
//                    else
//                    {
//                        if(packagename!="")
//                        {
//                           // for(var insertCou=0;insertCou<=document.getElementById('drppackagecopy').options.length;insertCou++)
//                            //{
//                                if(packagename.indexOf('(')>=0)
//                                {
//                                    tinsert=packagename.substring(packagename.indexOf('(')+1,packagename.indexOf(')'));
//                                }    
//                                var prevtinsert = tinsert;
//                                //if(packagename==document.getElementById('drppackagecopy').options[insertCou].value)
//                                //{
//                                    prevtinsert=parseInt(tinsert) + 1;
//                               // }
//                                var dInsert=(parseInt(previnsertion) * parseInt(prevtinsert))-(parseInt(insertion) * parseInt(tinsert));
//                                var insid="";
//                                for(var d=parseInt(document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length)-2;d>=0;d--)
//                                {
//                                    if(insid!="")
//                                    {
//                                        if(insid!=document.getElementById("ins"+d).innerHTML)
//                                        {
//                                             dInsert=parseInt(dInsert)-1;
//                                        }
//                                     }   
//                                    if(dInsert==0)
//                                        break;
//                                     var strid = packagename;
//                                     var strid1=strid.split('@');
//                                     var pkgid=strid1[0];
//                                     if(document.getElementById("hiddenpckcode"+d)==null)
//                                     {
//                                        d=parseInt(d)+1;
//                                     }
//                                     var pkgcodegrid=document.getElementById("hiddenpckcode"+d).value;
//                                     if(pkgcodegrid == pkgid)
//                                     {
//                                         insid=document.getElementById("ins"+d).innerHTML;
//                                        document.getElementById('gridtab').deleteRow(d+1);
//                                       
//                                     }
//                                }
//                           // }
//                        } 
//                    }
//                    previnsertion=document.getElementById('txtinsertion').value;
//                    document.getElementById('hiddenrowcount').value=parseInt(document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length) - 1;
//                   return false;

//}
function insertLinesubtract_callback(packagename, check) {
    // get No of Insertion
    var rowCount = parseInt(document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length);
    for (var pai = 0; pai < parseInt(rowCount) - 1; pai++) {
        var paid = "pai" + pai;
        if (document.getElementById(paid) != null)
            document.getElementById(paid).value = "Y";
    }
    var finsert = 1;
    var insertion = document.getElementById('txtinsertion').value;
    if (check == 'main') {
        if (document.getElementById('drppackagecopy').options.length > 0) {
            for (var insertCou = 0; insertCou < document.getElementById('drppackagecopy').options.length; insertCou++) {
                rowCount = parseInt(document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length);
                if (document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') >= 0) {
                    tinsert = document.getElementById('drppackagecopy').options[insertCou].value.substring(document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') + 1, document.getElementById('drppackagecopy').options[insertCou].value.indexOf(')'));
                }
                /* if(parseInt(tinsert)>parseInt(finsert))
                {
                finsert=tinsert;
                }
                insertion = parseInt(insertion) * parseInt(tinsert);
                                    
                else
                {
                insertion = parseInt(document.getElementById('txtinsertion').value);
                }*/
                //var dInsert=(parseInt(previnsertion) * parseInt(tinsert) * parseInt(document.getElementById('drppackagecopy').options[insertCou].value.split('+').length))-(parseInt(insertion) * parseInt(tinsert) *  parseInt(document.getElementById('drppackagecopy').options[insertCou].value.split('+').length));
                var dInsert = (parseInt(previnsertion) * parseInt(tinsert)) - (parseInt(insertion) * parseInt(tinsert));
                var insid = "";
                for (var d = parseInt(rowCount) - 2; d >= 0; d--) {
                    var id = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[d + 1].cells[0].id.substr(3, document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[d + 1].cells[0].id.length - 3);

                    if (insid != "") {
                        if (insid != document.getElementById("ins" + id).innerHTML) {
                            dInsert = parseInt(dInsert) - 1;
                        }
                    }
                    if (dInsert == 0)
                        break;
                    var strid = document.getElementById('drppackagecopy').options[insertCou].value;
                    var strid1 = strid.split('@');
                    var pkgid = strid1[0];
                    var pkgcodegrid = document.getElementById("hiddenpckcode" + id).value;
                    insid = document.getElementById("ins" + id).innerHTML;
                    if (pkgcodegrid == pkgid) {

                        document.getElementById('gridtab').deleteRow(d + 1);

                    }
                }
            }
        }

    }
    else {
        if (document.getElementById('drppackagecopy').options.length > 0) {
            for (var insertCou = 0; insertCou < document.getElementById('drppackagecopy').options.length; insertCou++) {
                rowCount = parseInt(document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length);
                if (document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') >= 0) {
                    tinsert = document.getElementById('drppackagecopy').options[insertCou].value.substring(document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') + 1, document.getElementById('drppackagecopy').options[insertCou].value.indexOf(')'));
                }
                //                                   /* if(parseInt(tinsert)>parseInt(finsert))
                //                                    {
                //                                        finsert=tinsert;
                //                                    }
                //                                    insertion = parseInt(insertion) * parseInt(tinsert);
                //                                    
                //                                else
                //                                {
                //                                     insertion = parseInt(document.getElementById('txtinsertion').value);
                //                                     
                //                                }*/
                //                                var prevtinsert = tinsert;
                if (packagename == document.getElementById('drppackagecopy').options[insertCou].value) {
                    var prevtinsert = parseInt(tinsert) + 1;
                    var insid = "";
                    var dInsert = (parseInt(previnsertion) * parseInt(prevtinsert)) - (parseInt(insertion) * parseInt(tinsert));
                    for (n = 0; n < dInsert; n++) {
                        for (var d = parseInt(rowCount) - 2; d >= 0; d--) {
                            var strid = document.getElementById('drppackagecopy').options[insertCou].value;
                            var strid1 = strid.split('@');
                            var pkgid = strid1[0];
                            var id = document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[d + 1].cells[0].id.substr(3, document.getElementById('gridtab').getElementsByTagName("tbody")[0].rows[d + 1].cells[0].id.length - 3);
                            var pkgcodegrid = document.getElementById("hiddenpckcode" + id).value;
                            if (insid != "") {

                                if (insid != document.getElementById("ins" + id).innerHTML && n == dInsert - 1) {
                                    return false;
                                }
                            }
                            if (pkgcodegrid == pkgid) {
                                if (insid != "") {
                                    if (insid != document.getElementById("ins" + id).innerHTML) {
                                        n = parseInt(n, 10) + 1;
                                    }
                                }
                                insid = document.getElementById("ins" + id).innerHTML;
                                document.getElementById('gridtab').deleteRow(d + 1);
                            }
                        }
                    }
                }

            }
        }
    }
    previnsertion = document.getElementById('txtinsertion').value;
    document.getElementById('hiddenrowcount').value = parseInt(document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length) - 1;
    return false;

}

function chkbookingdate() {
    /*   if(document.getElementById('txtdummydate').value=="")
    {
    alert("Please get the booking date");
    document.getElementById('txtdummydate').focus();
    return false;
    }
    */
}

/*     change          */
function chklevelofcategory() {
    if (document.getElementById('drpadcategory').value == "0") {
        //document.getElementById('drpcolor').value="0";
        alert("Please select the Category");
        document.getElementById('drpadcategory').focus();
        return false;
    }
    /* if(document.getElementById('drpadsubcategory').options.length>1)
    {
    if(document.getElementById('drpadsubcategory').value=="0" || document.getElementById('drpadsubcategory').value=="")
    {
    //document.getElementById('drpcolor').value="0";
    alert("Please select the sub category");
    document.getElementById('drpadsubcategory').focus();
    return false;
           
    }
    }
    if(document.getElementById('drpadcat3').options.length>1)
    {
    if(document.getElementById('drpadcat3').value=="0" || document.getElementById('drpadcat3').value=="")
    {
    //document.getElementById('drpcolor').value="0";
    alert("Please select the sub category 2");
    document.getElementById('drpadcat3').focus();
    return false;
           
    }
    }
    if(document.getElementById('drpadcat4').options.length>1)
    {
    if(document.getElementById('drpadcat4').value=="0" || document.getElementById('drpadcat4').value=="")
    {
    //document.getElementById('drpcolor').value="0";
    alert("Please select the sub category 3");
    document.getElementById('drpadcat4').focus();
    return false;
           
    }
    }
    if(document.getElementById('drpadcat5').options.length>1)
    {
    if(document.getElementById('drpadcat5').value=="0" || document.getElementById('drpadcat5').value=="")
    {
    //document.getElementById('drpcolor').value="0";
    alert("Please select the sub category 4");
    document.getElementById('drpadcat5').focus();
    return false;
           
    }
    }
    */

}

/*change*  this is to calculated the rate when h and w is retrurn from ad taker*/

function getrate_adtaker(h, w, id, ins, insval, c) {

    var cardid = "card" + id;

    if (document.getElementById(cardid).value == "") {
        alert("Please get the card rate in the insertion grid");
        document.getElementById(h.id).value = "";
        document.getElementById(w.id).value = "";
        document.getElementById(c.id).value = "";
        //changedivrate();
        document.getElementById('btnshgrid').focus();
        return false;

    }



    if (document.getElementById(h).value == "") {
        alert("Please Enter the height");
        document.getElementById(h).focus();
        return false;
    }




    var height = document.getElementById(h).value;
    var width = document.getElementById(w).value;
    var column = document.getElementById(c).value;

    var size = "siz" + id;
    if (column == "" || column == "NaN") {
        document.getElementById(size).value = parseFloat(height) * parseFloat(width);
    }
    else {
        document.getElementById(size).value = parseFloat(height) * parseFloat(column);
    }
    //getgrossamt(w,ins,insval);

    agreed = "agr" + id;
    gross = "gro" + id;
    totarea = "siz" + id;
    solo = "sol" + id;
    //var totgross=parseFloat(document.getElementById(totarea).value)*parseFloat(document.getElementById(agreed).value)
    //document.getElementById(gross).value=totgross.toFixed(2);
    if (document.getElementById('txtcardrate').value == document.getElementById('txtcardrate').value) {
        var soagr = document.getElementById(solo).value;
        //document.getElementById(gross).value=(parseFloat(agr)*parseFloat(totsiz)).toFixed(2);
        var totareawithrate = parseFloat(soagr) * parseFloat(document.getElementById(totarea).value)
        var totamt = parseFloat(totareawithrate) + parseFloat(glpre) - parseFloat(glspedisc) - parseFloat(glspadisc) + parseFloat(glspeccharge)
        document.getElementById(gross).value = (parseFloat(totamt)).toFixed(2);
    }
    else {
        var totgross = parseFloat(document.getElementById(totarea).value) * parseFloat(document.getElementById(agreed).value)
        document.getElementById(gross).value = totgross.toFixed(2);
    }
    var y;
    var totid;
    if (noofinsert != "") {
        y = parseInt(noofinsert)
        totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
    }
    else {
        y = rowwhenupdate;
        totid = parseInt(rowwhenupdate) / parseInt(document.getElementById('txtinsertion').value)
    }

    var k;
    var adgross
    var totgross;
    var paid;
    var grossamt = "";
    for (k = 0; k < y; k++) {

        while (document.getElementById("card" + i) == null && i < y) {
            i = i + totid;

        }

        if (i >= y) {
            break;
        }

        adgross = "gro" + i;
        paid = "pai" + i;

        totgross = document.getElementById(adgross).value
        if (document.getElementById(paid).value == "Y") {
            if (grossamt != "") {
                grossamt = parseFloat(totgross) + parseFloat(grossamt);
            }
            else {
                grossamt = parseFloat(totgross);
            }

        }
        i = parseInt(i) + 1;
    }
    if (grossamt != "") {
        document.getElementById('txtgrossamt').value = grossamt.toFixed(2);
        //document.getElementById('txtbillamt').value=parseFloat(grossamt)-parseFloat(grossamt)*parseFloat(document.getElementById('txttradedisc').value)/100;
    }
    if (document.getElementById('txtgrossamt').value == "NaN") {
        document.getElementById('txtgrossamt').value = "";

    }


}

/*change ankur*/
function billtochange() {
    document.getElementById('hiddenbillto').value = document.getElementById('drpbillto_qbc').value;
    return false;
}
/*new change ankur 15 feb*/
function fillbgcolor() {
    if (document.getElementById('drpadcategory').value == "0") {
        alert("Please select category");
        document.getElementById('drpadcategory').focus();
        document.getElementById('drpcolortype').value = "0";
        var pkgitem = document.getElementById('drpbgcolor');
        //pkgitem.options[0]=new Option("-Select Bg color-","0");
        return false;

    }

    document.getElementById('hiddencolortype').value = document.getElementById('drpcolortype').value

    //    var category=document.getElementById('drpadcategory').value
    //    var colortype=document.getElementById('drpcolortype').value
    //   document.getElementById('hiddenbgcolor').value=document.getElementById("drpbgcolor").value;
    //    QBC.fillbgcolor(category,colortype,call_bindbgcolor);



}
function call_bindbgcolor(res) {
    var ds = res.value
    var pkgitem = document.getElementById("drpbgcolor");


    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {
        var pkgitem = document.getElementById('drpbgcolor');
        pkgitem.options[0] = new Option("-Select Bg color-", "0");

        //var pkgitem = document.getElementById("drpcity");
        //alert(pkgitem);
        pkgitem.options.length = 1;
        //alert(pkgitem.options.length);
        for (var i = 0; i < res.value.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(res.value.Tables[0].Rows[i].Bgname, res.value.Tables[0].Rows[i].Bgid);

            pkgitem.options.length;

        }
    }
    else {

        pkgitem.options.length = 0;
        pkgitem.options[0] = new Option("-Select bg color-", "0");
    }
    document.getElementById('hiddenbgcolor').value = document.getElementById("drpbgcolor").value;
    return false
}

function fillintohiddenbg() {

    document.getElementById('hiddenbgcolor').value = document.getElementById("drpbgcolor").value;

}
/*new change ankur 10 feb*/

function datacopy() {
    if (document.getElementById('hiddenaudit').value == "" && document.getElementById('hiddencopyrate').value == 'y') {
        if (confirm("Do you want to copy the data ?")) {

            document.getElementById('hiddencopy').value = "copy";

        }
        else {
            document.getElementById('hiddencopy').value = "";
        }
    }
    executeClick();
    return false;



}
/*new change ankur 10 feb*/
function chkpublishdate(idval, iddat) {
    var pub = document.getElementById(idval).value;

    if (document.getElementById(iddat).value == "") {
        alert("Please get the insertion date");
        document.getElementById(idval).value = "Booked";
        return false;
    }
    if (pub == "publish") {
        var pubdate = new Date(document.getElementById(iddat).value);
        var currdate = new Date();
        if (currdate < pubdate) {
            alert("to publish current date should be less");
            document.getElementById(idval).value = "Booked";



        }
    }

    //
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    return false;
}

/*new change ankur 11 feb*/

function bindadcategory() {

    if (document.getElementById('drpadtype').value == "DI0") {
        document.getElementById('drpstyle').disabled = true;
        document.getElementById('drpdesign').disabled = true;
        document.getElementById('drplogoprem').disabled = true;
        document.getElementById('drpbgcolor').disabled = true;





    }

    else if (document.getElementById('drpadtype').value == "CL0") {

        document.getElementById('drpstyle').disabled = false;
        document.getElementById('drpdesign').disabled = false;
        document.getElementById('drplogoprem').disabled = false;
        document.getElementById('drpbgcolor').disabled = false;


    }


    if (document.getElementById('drpadtype').value == "0") {
        alert("Please select the ad type");
        //document.getElementById('drpadtype').focus();
        //document.getElementById('drpcolor').value="0";
        document.getElementById('drpadcat3').options.length = 0;
        document.getElementById('drpadcat4').options.length = 0;
        document.getElementById('drpadcat5').options.length = 0;
        ////////////////////////////////////////////
        //document.getElementById('drpadsubcategory').value=;
        return false;

    }
    ////this is to get the field blank on change of ad type
    //document.getElementById('drpcolor').value="0";

    document.getElementById('drpadcategory').options[0] = new Option("-Select Ad category-", "0");
    document.getElementById('drpadsubcategory').options.length = 0;
    document.getElementById('drpadcat3').options.length = 0;
    document.getElementById('drpadcat4').options.length = 0;
    document.getElementById('drpadcat5').options.length = 0;
    document.getElementById('drppackagecopy').options.length = 0;
    document.getElementById('tblinsert').innerHTML = "";
    document.getElementById('txtadsize1').value = "";
    document.getElementById('txtadsize2').value = "";
    document.getElementById('txttotalarea').value = "";
    document.getElementById('txtcolum').value = "";
    document.getElementById('txtcardrate').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    document.getElementById('hiddenadtype').value = document.getElementById('drpadtype').value;
    var compcode = document.getElementById('hiddencompcode').value;
    var res = QBC.bindcate(document.getElementById('drpadtype').value, compcode)
    call_bindcat(res);
    return false;


}

function call_bindcat(res) {
    var ds = res.value
    var pkgitem = document.getElementById("drpadcategory");
    var uom = document.getElementById("drpuom");
    var pkg = document.getElementById("drppackage");
    uom.options.length = 0;

    ///to bind ad cate
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {
        var pkgitem = document.getElementById('drpadcategory');
        pkgitem.options[0] = new Option("-Select Ad category-", "0");

        //var pkgitem = document.getElementById("drpcity");
        //alert(pkgitem);
        pkgitem.options.length = 1;
        //alert(pkgitem.options.length);
        for (var i = 0; i < res.value.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(res.value.Tables[0].Rows[i].Adv_Cat_Name, res.value.Tables[0].Rows[i].Adv_Cat_Code);

            pkgitem.options.length;

        }
    }
    else {

        pkgitem.options.length = 0;
        pkgitem.options[0] = new Option("-Select Ad category-", "0");
    }
    ////to bind uom
    if (ds != null && typeof (ds) == "object" && ds.Tables[1].Rows.length > 0) {
        var uom = document.getElementById('drpuom');
        uom.options[0] = new Option("-Select Uom-", "0");

        //var pkgitem = document.getElementById("drpcity");
        //alert(pkgitem);
        uom.options.length = 1;
        //uom(pkgitem.options.length);
        for (var i = 0; i < res.value.Tables[1].Rows.length; ++i) {
            uom.options[uom.options.length] = new Option(res.value.Tables[1].Rows[i].Uom_Name, res.value.Tables[1].Rows[i].Uom_Code);

            uom.options.length;

        }
    }
    else {

        uom.options.length = 0;
        uom.options[0] = new Option("-Select uom-", "0");
    }
    if (document.getElementById('drpadtype').value == "CL0") {
        document.getElementById('drpuom').value = "RO0"
    }
    ////to bind package
    /*       if(ds!= null && typeof(ds) == "object" && ds.Tables[2].Rows.length > 0) 
    {
    var pkg=document.getElementById('drppackage');
    pkg.options[0]=new Option("-Select package-","0");
                 
    //var pkgitem = document.getElementById("drpcity");
    //alert(pkgitem);
    pkg.options.length = 1; 
    //uom(pkgitem.options.length);
    for (var i = 0  ; i < res.value.Tables[2].Rows.length; ++i)
    {
    pkg.options[pkg.options.length] = new Option(res.value.Tables[2].Rows[i].Package_Name,res.value.Tables[2].Rows[i].pck_code);
                    
    pkg.options.length;
                   
    }  
    } 
    else
    {
                        
    pkg.options.length=0;
    pkg.options[0]=new Option("-Select package-","0");
    }
    */
    return false;


}

/*new change ankur 15 feb*/
function bindbgandfont() {
    var objpack = document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var code = "";
    var codesplit = "";
    var i = objpack.options.length;
    var j;
    if (i > 0) {
        for (j = 0; j < i; j++) {
            if (parseInt(i) > 0) {
                tempval = objpack[j].value;
                //tempvalcode=objpack[j].value;
                if (temp != "") {
                    temp = tempval.split("@");
                    tempvalcode = temp[0] + "+" + tempvalcode;
                    tempcode = temp[1];
                    desc = tempcode + "+" + desc;


                }
                else {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    desc = tempcode;

                }
            }

        }

        var categ = document.getElementById('drpadcategory').value;
        var categ2 = document.getElementById('drpadsubcategory').value;
        if (categ2 == "")
            categ2 = "0";
        var categ3 = document.getElementById('drpadcat3').value;
        if (categ3 == "")
            categ3 = "0";
        var categ4 = document.getElementById('drpadcat4').value;
        if (categ4 == "")
            categ4 = "0";
        var categ5 = document.getElementById('drpadcat5').value;
        if (categ5 == "")
            categ5 = "0";
        QBC.bindbgcolorandfont(categ, categ2, categ3, categ4, categ5, desc, call_binddropdown);
    }
    return false;


}
function call_binddropdown(res) {
    var ds = res.value;

    var pkgitem = document.getElementById("drpcolortype");
    var bg = document.getElementById("drpbgcolor");
    var bull = document.getElementById("drpbullet");
    //uom.options.length=0;

    ///to bind colortype
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {
        var pkgitem = document.getElementById('drpcolortype');
        pkgitem.options[0] = new Option("-Select Color type-", "0");

        //var pkgitem = document.getElementById("drpcity");
        //alert(pkgitem);
        pkgitem.options.length = 1;
        //alert(pkgitem.options.length);
        for (var i = 0; i < res.value.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(res.value.Tables[0].Rows[i].colortype_name, res.value.Tables[0].Rows[i].colortype_code);

            pkgitem.options.length;

        }
    }
    else {

        pkgitem.options.length = 0;
        pkgitem.options[0] = new Option("-Select Color type-", "0");
    }

    ///to bind bgcolor
    if (document.getElementById('hiddenEyeBasedOnEdition').value == 'yes') {
        if (ds != null && typeof (ds) == "object" && ds.Tables[1].Rows.length > 0) {
            var bg = document.getElementById('drpbgcolor');
            bg.options[0] = new Option("-Select Bg Color-", "0");

            //var pkgitem = document.getElementById("drpcity");
            //alert(pkgitem);
            bg.options.length = 1;
            //alert(pkgitem.options.length);
            for (var i = 0; i < res.value.Tables[1].Rows.length; ++i) {
                bg.options[bg.options.length] = new Option(res.value.Tables[1].Rows[i].bgname, res.value.Tables[1].Rows[i].bgid);

                bg.options.length;

            }
        }
        else {

            bg.options.length = 0;
            bg.options[0] = new Option("-Select Bg Color-", "0");
        }
    }

    ///to bind eye catcher
    if (document.getElementById('hiddenEyeBasedOnEdition').value == 'yes') {
        if (ds != null && typeof (ds) == "object" && ds.Tables[2].Rows.length > 0) {
            var bull = document.getElementById('drpbullet');
            bull.options[0] = new Option("-Select Eye catcher-", "0");

            //var pkgitem = document.getElementById("drpcity");
            //alert(pkgitem);
            bull.options.length = 1;
            //alert(pkgitem.options.length);
            for (var i = 0; i < res.value.Tables[2].Rows.length; ++i) {
                bull.options[bull.options.length] = new Option(res.value.Tables[2].Rows[i].bullet_desc, res.value.Tables[2].Rows[i].bullet_code);

                bull.options.length;

            }
        }
        else {

            bull.options.length = 0;
            bull.options[0] = new Option("-Select Eye catcher-", "0");
        }
    }



}

/*new change ankur 22 feb8*/

function showlogodetails() {


    document.getElementById('trbtnlogo').style.display = "none";
    document.getElementById('trlogouoload').style.display = "block";
    document.getElementById('trlogouom').style.display = "block";

    /*new change ankur mar*/
    document.getElementById('trlogouoload').style.display = "block";
    document.getElementById('trlogouoload1').style.display = "block";
    document.getElementById('trlogouoload2').style.display = "block";
    document.getElementById('trlogouoload3').style.display = "block";
    document.getElementById('trlogouoload4').style.display = "block";
    document.getElementById('trlogouoload5').style.display = "block";

    document.getElementById('trlogouom').style.display = "block";
    document.getElementById('trlogouom1').style.display = "block";

    /*this is to fill the W and H from the selected uom stylesheet */
    if (browser != "Microsoft Internet Explorer") {
        //var xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
        var style_name = document.getElementById('hiddenuomstylesheet').value;
        req1 = new XMLHttpRequest();
        //alert(req);
        req1.onreadystatechange = getMessage12;
        req1.open("GET", 'xml/' + style_name + '.xml', true);
        req1.send('');



        //                var style_name=document.getElementById('hiddenuomstylesheet').value;
        //                loadXML('xml/'+style_name+'.xml');
        //                document.getElementById('txtlogohei').disabled=true;
        //                 document.getElementById('txtlogowid').disabled=true

        //              
        //                document.getElementById('txtlogohei').value=xmlObj.childNodes[2].childNodes[3].text;
        //                document.getElementById('txtlogowid').value=xmlObj.childNodes[2].childNodes[1].text;


    }
    else {
        var xmlDoc = new ActiveXObject("Microsoft.XMLDOM");

        //loadXML('xml/billcycle.xml');
        var style_name = document.getElementById('hiddenuomstylesheet').value;
        loadXML('xml/' + style_name + '.xml');

        document.getElementById('txtlogohei').disabled = true;
        document.getElementById('txtlogowid').disabled = true
        if (xmlObj.childNodes[2] != null) {
            if (xmlObj.childNodes[2].baseName == "picture") {
                document.getElementById('txtlogohei').value = xmlObj.childNodes[2].childNodes[3].text
                document.getElementById('txtlogowid').value = xmlObj.childNodes[2].childNodes[1].text
            }
            else {
                document.getElementById('trlogouoload').style.display = "none";
                document.getElementById('trlogouom').style.display = "none";

                document.getElementById('trlogouoload').style.display = "none";
                document.getElementById('trlogouoload1').style.display = "none";
                document.getElementById('trlogouoload2').style.display = "none";
                document.getElementById('trlogouoload3').style.display = "none";
                document.getElementById('trlogouoload4').style.display = "none";
                document.getElementById('trlogouoload5').style.display = "none";

                document.getElementById('trlogouom').style.display = "none";
                document.getElementById('trlogouom1').style.display = "none";
                alert("No Hiegth, Width and Picture needed");
            }
        }
        else {
            document.getElementById('trlogouoload').style.display = "none";
            document.getElementById('trlogouom').style.display = "none";

            document.getElementById('trlogouoload').style.display = "none";
            document.getElementById('trlogouoload1').style.display = "none";
            document.getElementById('trlogouoload2').style.display = "none";
            document.getElementById('trlogouoload3').style.display = "none";
            document.getElementById('trlogouoload4').style.display = "none";
            document.getElementById('trlogouoload5').style.display = "none";

            document.getElementById('trlogouom').style.display = "none";
            document.getElementById('trlogouom1').style.display = "none";
            alert("No Hiegth, Width and Picture needed");
        }

    }

    if (document.getElementById('txtlogowid').value != "" && document.getElementById('txtlogohei').value != "") {
        var len = "bookdiv";
        var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
        var i = 0;
        var k;
        var height;
        var width;
        var coll;
        var size;
        for (k = 0; i < y - 1; k++) {
            while (document.getElementById("card" + i) == null && k < y - 1) {
                i = i + totid;

            }
            if (k >= y - 1) {
                break;
            }


            height = "lh" + i;
            wid = "lw" + i;

            document.getElementById(wid).value = document.getElementById('txtlogowid').value;


            document.getElementById(height).value = document.getElementById('txtlogohei').value;


            i++;

        }
    }

    return false;

}
function getMessage12() {
    var response1 = "";
    if (req1.readyState == 4) {
        if (req1.status == 200) {
            response1 = req1.responseText;
            //alert(response1);
        }
    }
    xmlDoc1 = null;
    xmlObj1 = null;
    var parser = new DOMParser();
    xmlDoc1 = parser.parseFromString(response1, "text/xml");
    xmlObj1 = xmlDoc1.documentElement;

    if (response1 != "") {
        if (xmlObj1.childNodes[5] != undefined) {
            if (xmlObj1.childNodes[5].localName == "picture") {
                //alert(xmlObj1.childNodes[5].nodeValue);
                document.getElementById('txtlogohei').value = xmlObj1.childNodes[5].childNodes[7].childNodes[0].nodeValue;
                document.getElementById('txtlogowid').value = xmlObj1.childNodes[5].childNodes[3].childNodes[0].nodeValue;
            }
            else {
                document.getElementById('trlogouoload').style.display = "none";
                document.getElementById('trlogouom').style.display = "none";

                document.getElementById('trlogouoload').style.display = "none";
                document.getElementById('trlogouoload1').style.display = "none";
                document.getElementById('trlogouoload2').style.display = "none";
                document.getElementById('trlogouoload3').style.display = "none";
                document.getElementById('trlogouoload4').style.display = "none";
                document.getElementById('trlogouoload5').style.display = "none";

                document.getElementById('trlogouom').style.display = "none";
                document.getElementById('trlogouom1').style.display = "none";
                alert("No Hiegth, Width and Picture needed");
            }
        }
        else {
            document.getElementById('trlogouoload').style.display = "none";
            document.getElementById('trlogouom').style.display = "none";

            document.getElementById('trlogouoload').style.display = "none";
            document.getElementById('trlogouoload1').style.display = "none";
            document.getElementById('trlogouoload2').style.display = "none";
            document.getElementById('trlogouoload3').style.display = "none";
            document.getElementById('trlogouoload4').style.display = "none";
            document.getElementById('trlogouoload5').style.display = "none";

            document.getElementById('trlogouom').style.display = "none";
            document.getElementById('trlogouom1').style.display = "none";
            alert("No Hiegth, Width and Picture needed");
        }
    }
    //debugger;
    //alert(xmlObj);  
    //alert(xmlObj.childNodes[1].childNodes[5].childNodes[0].nodeValue);
}
/*new change ankur 23 feb*/
/*new change ankur 23 feb*/
function uoloadlogoall() {
    var hei = document.getElementById('txtlogohei').value;
    var wid = document.getElementById('txtlogowid').value;
    var tot_area = "txttotalarea"
    var ins_id = "All";
    var eyecatch = document.getElementById('drpbullet').value;
    var bgcolor = document.getElementById('drpbgcolor').value;
    var eyecatchlength = document.getElementById('txteyecathval').value;
    var width = document.getElementById('txtadsize2').value;
    //width="3.8";

    /*change*/

    var objpack = document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var code = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (temp != "") {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode + "," + code;
                desc = tempcode + "," + desc;


            }
            else {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode;
                desc = tempcode;
            }
        }

    }
    var pubedit = desc.replace("+", "^");
    width = desc.replace("+", "^");


    var ins = "0";
    var edit = "All";
    var ciobookid = document.getElementById('txtciobookid').value;
    var fileid = "bookdiv";
    var logo = "logo";
    var valh = "0";
    window.open('logoupload.aspx?adheight=' + hei + '&adwidth=' + wid + '&ins=' + ins + '&edition=' + edit + '&ciobookid=' + ciobookid + '&fileid=' + fileid + '&logo=' + logo + '&pubedit=' + pubedit, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=244,left=210,width=350px,height=95px');
    //window.open('temupload.aspx?adheight='+hei+'&adwidth='+wid+'&ins='+ins+'&edition='+edit+'&ciobookid='+ciobookid+'&fileid='+fileid+'&logo='+logo+'&pubedit='+pubedit,'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=244,left=210,width=350px,height=95px');
    return false;


}

function uploadimagelogo(edition1, id, ins, edition, fileid, ival) {

    var pubedit = edition1;
    var width = edition1
    var hei = document.getElementById('txtadsize1').value;
    var wid = document.getElementById('txtadsize2').value;
    edition1 = edition

    //  var width=document.getElementById('txtadsize2').value;
    //width="3.8";
    var uom = document.getElementById('drpuom').value;
    var insertid = ival;


    var insertid = ival;
    //alert(document.getElementById('txtinsertion').value);
    var insertNo = document.getElementById('ins' + ival).innerHTML;
    var adheight = document.getElementById("lh" + ival).value;
    var adwidth = document.getElementById("lw" + ival).value;
    var tot_area = "siz" + ival;
    var ins_id = ival;
    var logo = "logo";
    var valh = "0";
    var edit = document.getElementById(edition).value;
    var ciobookid = document.getElementById('txtciobookid').value;
    window.open('logoupload.aspx?adheight=' + adheight + '&adwidth=' + adwidth + '&no=' + insertid + '&ins=' + ins + '&edition=' + edit + '&ciobookid=' + ciobookid + '&fileid=' + fileid + '&logo=' + logo + '&pubedit=' + pubedit, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=244,left=210,width=350px,height=95px');
    //window.open('temupload.aspx?adheight='+adheight+'&adwidth='+adwidth+'&no='+insertid+'&ins='+ins+'&edition='+edit+'&ciobookid='+ciobookid+'&fileid='+fileid+'&logo='+logo+'&pubedit='+pubedit,'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=244,left=210,width=350px,height=95px');



}

function filllogohei() {

    if (document.getElementById('drppackagecopy').options.length == 0) {
        alert("Please select the package");
        document.getElementById('drppackage').focus();
        return false;

    }

    if (document.getElementById('drpuom').value == "0") {
        alert("Please select uom");
        document.getElementById('txtadsize1').value = ""
        document.getElementById('txtadsize2').value = ""
        document.getElementById('drpuom').focus();
        return false;

    }


    var value = chkamount('txtlogohei');
    if (value == "f") {
        return false;
    }
    if (parseFloat(document.getElementById('txtlogohei').value) == 0) {
        alert("0 is not accepted");
        var idrem = document.activeElement.id;
        //document.getElementById(idrem).value="";

        return false;


    }

    var len = "bookdiv";
    var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    var i = 0;
    var k;
    var height;
    var width;
    var coll;
    var size;
    for (k = 0; i < y - 1; k++) {
        while (document.getElementById("card" + i) == null && k < y - 1) {
            i = i + totid;

        }
        if (k >= y - 1) {
            break;
        }


        height = "lh" + i;


        document.getElementById(height).value = document.getElementById('txtlogohei').value;


        i++;

    }



}


function filllogowidth() {

    if (document.getElementById('drppackagecopy').options.length == 0) {
        alert("Please select the package");
        document.getElementById('drppackage').focus();
        return false;

    }

    if (document.getElementById('drpuom').value == "0") {
        alert("Please select uom");
        document.getElementById('txtadsize1').value = ""
        document.getElementById('txtadsize2').value = ""
        document.getElementById('drpuom').focus();
        return false;

    }


    var value = chkamount('txtlogowid');
    if (value == "f") {
        return false;
    }
    if (parseFloat(document.getElementById('txtlogowid').value) == 0) {
        alert("0 is not accepted");
        var idrem = document.activeElement.id;
        //document.getElementById(idrem).value="";

        return false;


    }

    var len = "bookdiv";
    var y = document.getElementById(len).getElementsByTagName('table')[0].rows.length;
    var i = 0;
    var k;
    var height;
    var width;
    var coll;
    var size;
    for (k = 0; i < y - 1; k++) {
        while (document.getElementById("card" + i) == null && k < y - 1) {
            i = i + totid;

        }
        if (k >= y - 1) {
            break;
        }


        wid = "lw" + i;


        document.getElementById(wid).value = document.getElementById('txtlogowid').value;


        i++;

    }



}


/*this is the function use when we change the logo height and width insertion wise*/
function gettotalsize_logo(h, w, id, ins, insval, c) {

    var cardid = "card" + id;

    if (document.getElementById(cardid).value == "") {
        alert("Please get the card rate in the insertion grid");
        document.getElementById(h.id).value = "";
        document.getElementById(w.id).value = "";
        document.getElementById(c.id).value = "";
        //changedivrate();
        document.getElementById('btnshgrid').focus();
        return false;

    }

    h = h.id;

    if (document.getElementById(h).value == "") {
        alert("Please Enter the height");
        document.getElementById(h).focus();
        return false;
    }

    w = w.id;
    c = c.id;

    var height = document.getElementById(h).value;
    var width = document.getElementById(w).value;
    //var column=document.getElementById(c).value;

    //var size="siz"+id;

    //getgrossamt(w,ins,insval);

    agreed = "agr" + id;
    gross = "gro" + id;
    totarea = "siz" + id;
    solo = "sol" + id;
    //var totgross=parseFloat(document.getElementById(totarea).value)*parseFloat(document.getElementById(agreed).value)
    //document.getElementById(gross).value=totgross.toFixed(2);
    if (document.getElementById('txtcardrate').value == document.getElementById('txtcardrate').value) {
        var soagr = document.getElementById(solo).value;
        //document.getElementById(gross).value=(parseFloat(agr)*parseFloat(totsiz)).toFixed(2);
        var totareawithrate = parseFloat(soagr) * parseFloat(height) * parseFloat(width)
        var totamt = parseFloat(totareawithrate) + parseFloat(glpre) - parseFloat(glspedisc) - parseFloat(glspadisc) + parseFloat(glspeccharge)

        document.getElementById(gross).value = (parseFloat(totamt)).toFixed(2);
    }
    else {
        var totgross = parseFloat(document.getElementById(totarea).value) * parseFloat(document.getElementById(agreed).value)
        document.getElementById(gross).value = totgross.toFixed(2);
    }
    var y;
    var totid;
    if (noofinsert != "") {
        y = parseInt(noofinsert)
        totid = parseInt(noofinsert) / parseInt(document.getElementById('txtinsertion').value)
    }
    else {
        y = rowwhenupdate;
        totid = parseInt(rowwhenupdate) / parseInt(document.getElementById('txtinsertion').value)
    }

    var k;
    var adgross
    var totgross;
    var paid;
    var grossamt = "";
    for (k = 0; k < y; k++) {

        while (document.getElementById("card" + i) == null && i < y) {
            i = i + totid;

        }

        if (i >= y) {
            break;
        }

        adgross = "gro" + i;
        paid = "pai" + i;

        totgross = document.getElementById(adgross).value
        if (document.getElementById(paid).value == "Y") {
            if (grossamt != "") {
                grossamt = parseFloat(totgross) + parseFloat(grossamt);
            }
            else {
                grossamt = parseFloat(totgross);
            }

        }
        i = parseInt(i) + 1;
    }
    if (grossamt != "") {
        document.getElementById('txtgrossamt').value = grossamt.toFixed(2);
        //document.getElementById('txtbillamt').value=parseFloat(grossamt)-parseFloat(grossamt)*parseFloat(document.getElementById('txttradedisc').value)/100;
    }
    if (document.getElementById('txtgrossamt').value == "NaN") {
        document.getElementById('txtgrossamt').value = "";

    }


}

/*new changes ankur 26 feb*/
function printreceipt(paymodeN) {

    /*  if(document.getElementById('hiddensavemod').value=="0")
    {
    alert("You can print the receipt only in Modify or Execute Mode");
    return false;
    }*/

    var billamt = document.getElementById('txtgrossamt').value
    var cli = document.getElementById('txtclient').value;
    var curr = document.getElementById('hiddencurrency').value;
    var packagedetail = document.getElementById('hiddencurrency').value;
    var objpack = document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var code = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (temp != "") {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode + "," + code;
                desc = tempcode + "," + desc;


            }
            else {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode;
                desc = tempcode;
            }
        }

    }
    ///////////////this is to call the print page to print the receipt no
    //  if(document.getElementById('txtclient').value=="")
    // {
    // alert("Please Fill the Client Name");
    //  return false;
    // }
    //  if(billamt!="")
    // {
    //window.open('printreceipt.aspx?billamt='+billamt+'&cli='+cli+'&curr='+curr+'&desc='+desc,'','width=500px,height=500px,resizable=1,left=0,top=0,scrollbars=yes');
    var cioid = document.getElementById('hiddencioid').value;
    var client = "";
    if (document.getElementById('hiddenclientname').value == "") {
        client = document.getElementById('txtclient').value;
    }
    else {
        client = document.getElementById('hiddenclientname').value;
    }
    var clientadd = "";
    if (document.getElementById('hiddenclientaddress').value == "") {
        document.getElementById('hiddenclientaddress').value = document.getElementById('txtclientadd').value;
    }
    clientadd = document.getElementById('hiddenclientaddress').value;
    var receiptno = document.getElementById('hiddenreceiptno').value;
    if (document.getElementById('txtreceipt').value != "") {
        document.getElementById('hiddenreceiptno1').value = receiptno = document.getElementById('txtreceipt').value;
        receiptno = document.getElementById('hiddenreceiptno1').value;
    }
    var res = QBC.getreciept(document.getElementById('hiddencompcode').value, document.getElementById('txtciobookid').value);
    if (res.error != null) {
        alert(res.error.description);
    }
    if (res.value.Tables[0].Rows[0].Receipt_no != null && res.value.Tables[0].Rows[0].Receipt_no != "null")
        var reciept11 = res.value.Tables[0].Rows[0].Receipt_no;
    else
        reciept11 = "";
    printreceiptQBC(reciept11, document.getElementById('txtciobookid').value);
    //window.open("Receipt_Ht_Jab.aspx?cioid=" + cioid + "&clientname=" + client + "&clientadd=" + clientadd + "&receiptno=" + receiptno); //,'','width=1000px,height=550px,resizable=1,left=0,top=0,scrollbars=yes');
    /////////////////////add by anuja
    // window.open('cash_rcptformult.aspx?paymode=' + document.getElementById('drppaymenttype').value + '&filename=bookdiv' + "&ciobookid123=" + cioid + "&idofbutton=" + document.getElementById("hdnbutton").value, '', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=0,left=0,width=1000px,height=900px');
   // insertcashdetailQBC(document.getElementById('txtciobookid').value, "btnsavepay", document.getElementById('drppaymenttype').value);
    // window.open('cash_rcptformult.aspx?paymode=' + paymodeN + '&filename=bookdiv' + "&ciobookid123=" + cioid + "&idofbutton=" + document.getElementById("hdnbutton").value, '', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=0,left=0,width=1000px,height=900px');
    return false;
    //  }    
    //  else
    //  {
    //   alert("Please get the  amount");
    //    return false;
    //}


}

/*new change ankur 27 feb*/
function binduomonedition() {
    var billamt = document.getElementById('txtgrossamt').value
    var cli = document.getElementById('txtclient').value;
    var curr = document.getElementById('hiddencurrency').value;
    var packagedetail = document.getElementById('hiddencurrency').value;
    var objpack = document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var code = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (temp != "") {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode + "," + code;
                desc = tempcode + "+" + desc;


            }
            else {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode;
                desc = tempcode;
            }
        }

    }
    /////////////////////////////////////////
    ////this is to bind the uom dropdown
    var compcode = document.getElementById('hiddencompcode').value;
    if (document.getElementById('drppackagecopy').options.length > 0) {
        QBC.binduomaccedition(document.getElementById('drpadtype').value, desc, compcode, call_binduomaccedition)
    }
    else {
        var uom = document.getElementById('drpuom');
        uom.options[0] = new Option("-Select Uom-", "0");
    }
    return false;

}

function call_binduomaccedition(res) {
    var ds = res.value;
    var uom = document.getElementById("drpuom");

    uom.options.length = 0;
    ////to bind uom
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {
        var uom = document.getElementById('drpuom');
        uom.options[0] = new Option("-Select Uom-", "0");

        //var pkgitem = document.getElementById("drpcity");
        //alert(pkgitem);
        uom.options.length = 1;
        //uom(pkgitem.options.length);
        for (var i = 0; i < res.value.Tables[0].Rows.length; ++i) {
            uom.options[uom.options.length] = new Option(res.value.Tables[0].Rows[i].UOM_Name, res.value.Tables[0].Rows[i].UOM_Code);

            uom.options.length;

        }
    }
    else {

        uom.options.length = 0;
        uom.options[0] = new Option("-Select uom-", "0");
    }



}
/////////////

/*this is to disabled the text box oflogo's*/
/*change for oracle*/
function disabledlogoinfo() {
    document.getElementById('trbtnlogo').style.display = "none";
    document.getElementById('trlogouoload').style.display = "none";
    document.getElementById('trlogouom').style.display = "none";

    /*new change ankur mar*/
    document.getElementById('trlogouoload').style.display = "none";
    document.getElementById('trlogouoload1').style.display = "none";
    document.getElementById('trlogouoload2').style.display = "none";
    document.getElementById('trlogouoload3').style.display = "none";
    document.getElementById('trlogouoload4').style.display = "none";
    document.getElementById('trlogouoload5').style.display = "none";

    document.getElementById('trlogouom').style.display = "none";
    document.getElementById('trlogouom1').style.display = "none";



}


function change_fileName() {
    count = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
    for (i = 0; i < count; i++) {
        var filename = "fil" + i;
        var currcioid = document.getElementById('txtciobookid').value;
        var value = document.getElementById(filename).value.replace(prevcioidformatter, currcioid);
        document.getElementById(filename).value = value;

    }
    prevcioidformatter = currcioid;
}

function getprevcioid() {
    var res = QBC.getpaystatus(document.getElementById("txtreceipt").value);
    var ds = res.value;
    if (ds != null && ds.Tables[0].Rows.length > 0 && ds.Tables[0].Rows[0].Bill_pay == "1") {
        alert("You can not modify this ad because payment has been made");
        if (document.getElementById('drprostatus').value == "2") {
            document.getElementById('btnconfirm').disabled = false;
        }
        return false;
    }
    //        if(document.getElementById('drprostatus').value=="1")
    //        {
    //            alert("You can not modify confirmed ad");
    //            return false;
    //        }

    if (document.getElementById("txtagency").value == "") {
        document.getElementById("txtagency").value = document.getElementById("hdnagencyname").value;
    }
    else {
        document.getElementById("hdnagencyname").value = document.getElementById("txtagency").value;
    }

    prevcioidformatter = document.getElementById('txtciobookid').value;
    modifyClick();
    setButtonImages();
    return false;
}
function fillcopyfilename() {
    //logonam="lnam"+i
    var cioid_var = document.getElementById("txtciobookid");
    if (document.getElementById("fil0") != null && document.getElementById("fil0").value != "") {
        count = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
        itemlinecnt = parseInt(count) / parseInt(document.getElementById('txtinsertion').value);
        count = parseInt(count) - parseInt(itemlinecnt);
        filid = itemlinecnt;
        var filemidid = 2;
        //var filelastid=parseInt(itemlinecnt)+1;
        for (var i = 1; i <= count; i = i + itemlinecnt) {
            for (var j = 0; j < parseInt(itemlinecnt); j++) {
                var filid_var = document.getElementById("fil" + filid);
                var filj_var = document.getElementById("fil" + j);
                if (filid_var.value == "") {
                    var arrfile = filj_var.value.split('-');
                    if (arrfile.length > 3)//if(arrfile.length>2)
                    {
                        //var cioid=arrfile[0];
                        var cioid = cioid_var.value;
                        var filenamenew = arrfile[0] + "-" + arrfile[1];
                        var foldername = arrfile[0] + "-" + arrfile[1];
                        filenamenew += "-" + filemidid;
                        var filelastid = filid + 1;
                        filenamenew += "-" + filelastid + ".xtg";
                        filid_var.value = filenamenew;


                        if (browser != "Microsoft Internet Explorer") {
                            var httpRequest = null; ;
                            httpRequest = new XMLHttpRequest();
                            if (httpRequest.overrideMimeType) {
                                httpRequest.overrideMimeType('text/xml');
                            }

                            httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

                            httpRequest.open("GET", "copyMatter.aspx?filename=" + filj_var.value + "&copyfilename=" + filenamenew + "&cioid=" + cioid + "&folder=" + foldername, false);
                            httpRequest.send('');
                            //alert(httpRequest.readyState);
                            if (httpRequest.readyState == 4) {
                                //alert(httpRequest.status);
                                if (httpRequest.status == 200) {
                                    val_ = httpRequest.responseText;
                                }
                                else {
                                    alert('There was a problem with the request.');
                                }
                            }
                        }
                        else {
                            var xml = new ActiveXObject("Microsoft.XMLHTTP");
                            xml.Open("GET", "copyMatter.aspx?filename=" + filj_var.value + "&copyfilename=" + filenamenew + "&cioid=" + cioid + "&folder=" + foldername, false);
                            xml.Send();
                            strtext = xml.responseText;
                        }
                    }
                    else {
                        filid_var.value = document.getElementById("fil" + j).value;

                    }

                }
                filid = filid + 1;
            }
            filemidid = filemidid + 1;
        }

    }
    if (document.getElementById('hiddenuomdesc').value == "ROD" && document.getElementById("lnam0") != null && document.getElementById("lnam0").value != "") {
        count = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
        itemlinecnt = parseInt(count) / parseInt(document.getElementById('txtinsertion').value);
        count = count - itemlinecnt;
        filid = itemlinecnt;
        var filemidid = 2;
        for (var i = 1; i <= count; i = i + itemlinecnt) {
            for (var j = 0; j < itemlinecnt; j++) {
                if (document.getElementById('hiddenuomdesc').value == "ROD" && document.getElementById("lnam0").value != "") {
                    document.getElementById("lnam" + filid).value = document.getElementById("lnam" + j).value;
                }
                else {
                    if (document.getElementById('hiddenuomdesc').value == "ROD" && document.getElementById("lnam0").value != "") {
                        document.getElementById("lnam" + filid).value = document.getElementById("lnam" + j).value;
                    }
                }
                filid = filid + 1;
            }
            filemidid = filemidid + 1;
        }

    }

}
function chkfillagency() {
    if (document.getElementById('txtagency').value == "") {
        alert('Please select Agency')
        document.getElementById('txtagency').focus();
        return false;
    }
    else {
        return true;
    }
}

function getmulpackage() {
    if (document.getElementById('drpadcategory').value == "0") {
        alert("Please select the category");
        if (document.getElementById('drpadcategory').disabled == false) {
            document.getElementById('drpadcategory').focus();
        }
        return false;
    }
    //document.getElementById('aaaa').value="ankue";
    document.getElementById('drppackagecopy').style.display = "none";
    var compcode = document.getElementById('hiddencompcode').value;
    document.getElementById('dvmainpackage').style.display = "block";
    document.getElementById('dvpackage').style.display = "block";
    document.getElementById('dvpackage').style.filter = "alpha(opacity=30)";
    //document.getElementById('dvpackage').style.width = screen.Width;
    document.getElementById('dvpackage').style.height = screen.height + screen.height;
    document.getElementById('dvpackage').style.position = "absolute";
    document.getElementById('dvpackage').style.top = "50px";

    return false;
    //QBC.getpackagename(compcode,call_package);       
}
function submitpack() {
    var flag = 0;
    var teatval = ""
    var selectval = "";
    if (browser != "Microsoft Internet Explorer") {
        var lslength = document.getElementById('test_grid').innerHTML.split("<tr>")
    }
    else {
        var lslength = document.getElementById('test_grid').innerHTML.split("<TR>")

    }
    for (i = 2; i < lslength.length; i++) {

        var status = "";
        if (i <= 9) {
            teatval = "0" + i
        }
        else if (i > 9 && i < 99) {
            teatval = i
        }
        else {
            teatval = i
        }

        if (document.getElementById('test_grid_ctl' + teatval + '_test_chk').checked == true) {

            //                   if(document.getElementById('drppackagecopy').options.length>0)
            //                   {
            //                        var len=document.getElementById('drppackagecopy').options.length;
            //                        for(ik=0;ik<len;ik++)
            //                        {
            //                            if(document.getElementById('drppackagecopy').options[ik].value==document.getElementById('test_grid_ctl'+teatval+'_pack_id').innerText)
            //                            {
            //                                status="false"
            //                            }
            //                        }
            //                   }
            if (browser != "Microsoft Internet Explorer") {

                var text = document.getElementById('test_grid_ctl' + teatval + '_test_lbl').textContent;
                if (text.toString().lastIndexOf(")") >= 0) {
                    text = document.getElementById('test_grid_ctl' + teatval + '_test_lbl').innerText.toString().substring(0, document.getElementById('test_grid_ctl' + teatval + '_test_lbl').innerText.toString().indexOf("("));
                }

                document.getElementById('drppackage').value = document.getElementById('test_grid_ctl' + teatval + '_pack_id').textContent
                // AddItem(document.getElementById('drppackagecopy'), text, document.getElementById('test_grid_ctl'+teatval+'_pack_id').textContent,"0");
                addpkgname();
            }
            else {
                var text = document.getElementById('test_grid_ctl' + teatval + '_test_lbl').innerText;
                if (text.toString().lastIndexOf(")") >= 0) {
                    text = document.getElementById('test_grid_ctl' + teatval + '_test_lbl').innerText.toString().substring(0, document.getElementById('test_grid_ctl' + teatval + '_test_lbl').innerText.toString().indexOf("("));
                }
                document.getElementById('drppackage').value = document.getElementById('test_grid_ctl' + teatval + '_pack_id').innerText
                //AddItem(document.getElementById('drppackagecopy'), text, document.getElementById('test_grid_ctl'+teatval+'_pack_id').innerText,"0");
                addpkgname();
            }

        }

        //               if(status!="false")
        //               {
        //               }


    }
    if (browser != "Microsoft Internet Explorer") {
        var lslength = document.getElementById('test_grid').innerHTML.split("<tr>")
    }
    else {
        var lslength = document.getElementById('test_grid').innerHTML.split("<TR>")

    }
    for (i = 2; i < lslength.length; i++) {
        var status = "";
        if (i <= 9) {
            teatval = "0" + i
        }
        else if (i > 9 && i < 99) {
            teatval = i
        }
        else {
            teatval = i
        }

        document.getElementById('test_grid_ctl' + teatval + '_test_chk').checked = false;


    }
    document.getElementById('dvmainpackage').style.display = "none";
    document.getElementById('dvpackage').style.display = "none";
    document.getElementById('drppackagecopy').style.display = "block";
}


function cancelpack() {
    document.getElementById('dvmainpackage').style.display = "none";
    document.getElementById('dvpackage').style.display = "none";
    document.getElementById('drppackagecopy').style.display = "block";
}

function find_package(a) {
    if (document.getElementById('drppackagecopy').options.length > 0) {
        for (i = 0; i < document.getElementById('drppackagecopy').options.length; i++) {

            var an = a.split("_")[02].replace("ctl", "")
            if (browser != "Microsoft Internet Explorer") {
                if (document.getElementById('drppackagecopy').options[i].value == document.getElementById('test_grid_ctl' + an + '_pack_id').textContent) {
                    alert("This package is already shifted")
                    document.getElementById(a).checked = false;
                    return false
                }
            }
            else {
                if (document.getElementById('drppackagecopy').options[i].value == document.getElementById('test_grid_ctl' + an + '_pack_id').innerText) {
                    alert("This package is already shifted")
                    document.getElementById(a).checked = false;
                    return false
                }
            }

        }
    }
}

function noblank() {
    //    if (document.getElementById('txtagency').value == "" || document.getElementById('hiddenagencynew').value == "" ) {
    //        alert("Please select agency using by F2");
    //        document.getElementById('txtagency').focus();
    //        return false;
    //    }
    if (document.getElementById('txtinsertion').value == "") {
        alert("Please enter no. of insertions");
        document.getElementById('txtinsertion').focus();
        return false;
    }
}


function blanckclientadd() {
    document.getElementById('txtclientadd').value = "";
}
function notchar2(event) {

    var charCode = (event.which) ? event.which : event.keyCode
    //            if(document.activeElement.id=="txtinsertion")
    //            {
    //                if((document.getElementById('txtinsertion').value.length==0 || document.getElementById('txtinsertion').value.length==1))
    //                {
    //                    return false;
    //                }
    //            }
    //alert(charCode);
    // return false;
    if ((charCode >= 48 && charCode <= 57) || (charCode == 127) || (charCode == 8) || (charCode == 9) || (charCode == 99)) {
        return true;
    }
    else {
        return false;
    }


}


function fillscat3(res) {
    var dscat3 = res.value;
    if (dscat3 != null && dscat3.Tables[0].Rows.length > 0) {
        if (document.getElementById("bookdiv") != null) {
            var len = document.getElementById("bookdiv").getElementsByTagName('table')[0].rows.length;
            var adscat3 = "";
            for (a = 0; a < len - 1; a++) {
                var adscat3id = "adscat3" + a;
                var adsubcat = "ads" + a;
                if (document.getElementById(adscat3id) != null) {
                    var adscat3 = document.getElementById(adscat3id);
                    adscat3.options.length = 0;
                    adscat3.options[adscat3.options.length] = new Option("Select", "0");
                    for (i = 0; i < dscat3.Tables[0].Rows.length; i++) {
                        adscat3.options[adscat3.options.length] = new Option(dscat3.Tables[0].Rows[i].catcode, dscat3.Tables[0].Rows[i].catcode);
                        adscat3.options.length;
                    }
                }
                if (document.getElementById(adsubcat) != null) {
                    document.getElementById(adsubcat).disabled = true;
                }
            }
        }
    }
    else {
        if (document.getElementById("bookdiv") != null) {
            var len = document.getElementById("bookdiv").getElementsByTagName('table')[0].rows.length;
            var adscat3 = "";
            for (a = 0; a < len - 1; a++) {
                var adscat3id = "adscat3" + a;
                var adsubcat = "ads" + a;
                if (document.getElementById(adscat3id) != null) {
                    var adscat3 = document.getElementById(adscat3id);
                    adscat3.options.length = 0;
                    adscat3.options[adscat3.options.length] = new Option("Select", "0");
                }
                if (document.getElementById(adsubcat) != null) {
                    document.getElementById(adsubcat).disabled = false;
                }
            }
        }
    }
}


function getadsubcat4(adcat3, i) {
    var compcode = document.getElementById("hiddencompcode").value;
    var adcat3value = document.getElementById(adcat3.id).value;
    var res = QBC.bindadcat3(adcat3value, compcode, "1");
    bindadcat4(res.value, "grid");
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";

}

function bindadcat4(dscat4, callfrom) {
    if (dscat4 != null && dscat4.Tables[0].Rows.length > 0) {
        if (document.getElementById("bookdiv") != null) {
            var len = document.getElementById("bookdiv").getElementsByTagName('table')[0].rows.length;
            var adscat4 = "";
            for (a = 0; a < len - 1; a++) {
                adscat3id = "adscat3" + a;
                document.getElementById(adscat3id).disabled = true;
                if (document.getElementById(adscat3id) != null && callfrom == "main") {
                    document.getElementById(adscat3id).value = document.getElementById("drpadcat3").value;
                }

                var adscat4id = "adscat4" + a;
                if (document.getElementById(adscat4id) != null) {
                    var adscat4 = document.getElementById(adscat4id);
                    adscat4.value = "";
                    //  adscat4.options.length=0;
                    // adscat4.options[adscat4.options.length] = new Option("Select","0");
                    //                    for(i=0;i<dscat4.Tables[0].Rows.length;i++)
                    //                    {
                    //                        adscat4.options[adscat4.options.length] = new Option(dscat4.Tables[0].Rows[i].Cat_Code,dscat4.Tables[0].Rows[i].Cat_Code);
                    //                        adscat4.options.length;
                    //                    }
                }

                adscat5id = "adscat5" + a;
                if (document.getElementById(adscat5id) != null) {
                    var adscat5 = document.getElementById(adscat5id);
                    adscat5.value = "";
                    //  adscat5.options.length=0;
                    //adscat5.options[adscat5.options.length] = new Option("Select","0");
                }
            }
        }
    }
    else {
        if (document.getElementById("bookdiv") != null) {
            var len = document.getElementById("bookdiv").getElementsByTagName('table')[0].rows.length;
            var adscat4 = "";
            for (a = 0; a < len - 1; a++) {
                adscat3id = "adscat3" + a;

                if (document.getElementById(adscat3id) != null && callfrom == "main") {
                    document.getElementById(adscat3id).value = document.getElementById("drpadcat3").value;
                    document.getElementById(adscat3id).disabled = false;
                }

                var adscat4id = "adscat4" + a;
                if (document.getElementById(adscat4id) != null) {
                    var adscat4 = document.getElementById(adscat4id);
                    adscat4.value = "";
                    //  adscat4.options.length=0;
                    //adscat4.options[adscat4.options.length] = new Option("Select","0");
                }

                adscat5id = "adscat5" + a;
                if (document.getElementById(adscat5id) != null) {
                    var adscat5 = document.getElementById(adscat5id);
                    adscat5.value = "";
                    // adscat5.options.length=0;
                    // adscat5.options[adscat5.options.length] = new Option("Select","0");
                }
            }
        }
    }
}


function getadsubcat5(adcat4, i) {
    var compcode = document.getElementById("hiddencompcode").value;
    var adcat4value = document.getElementById(adcat4.id).value;
    var res = QBC.bindadcat3(adcat4value, compcode, "1");
    bindadcatgrid5(res.value, "grid");
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
}


function bindadcatgrid5(dscat5, callfrom) {
    if (dscat5 != null && dscat5.Tables[0].Rows.length > 0) {
        if (document.getElementById("bookdiv") != null) {
            var len = document.getElementById("bookdiv").getElementsByTagName('table')[0].rows.length;
            var adscat5 = "";
            for (a = 0; a < len - 1; a++) {
                adscat3id = "adscat3" + a;
                adscat4id = "adscat4" + a;
                document.getElementById(adscat3id).disabled = true;
                document.getElementById(adscat4id).disabled = true;
                if (document.getElementById(adscat4id) != null && callfrom == "main") {
                    document.getElementById(adscat4id).value = document.getElementById("drpadcat4").value;
                }

                var adscat5id = "adscat5" + a;
                if (document.getElementById(adscat4id) != null) {
                    var adscat5 = document.getElementById(adscat5id);
                    document.getElementById(adscat5id).value = document.getElementById("drpadcat5").value;
                    // adscat5.options.length=0;
                    //  adscat5.options[adscat5.options.length] = new Option("Select","0");
                    //  for(i=0;i<dscat5.Tables[0].Rows.length;i++)
                    //  {
                    //adscat5.options[adscat5.options.length] = new Option(dscat5.Tables[0].Rows[i].Cat_Code,dscat5.Tables[0].Rows[i].Cat_Code);
                    // adscat5.options.length;
                    // }
                }
            }
        }
    }
    else {
        if (document.getElementById("bookdiv") != null) {
            var len = document.getElementById("bookdiv").getElementsByTagName('table')[0].rows.length;
            var adscat5 = "";
            for (a = 0; a < len - 1; a++) {
                adscat4id = "adscat4" + a;
                document.getElementById(adscat4id).disabled = false;
                if (document.getElementById(adscat4id) != null && callfrom == "main") {
                    document.getElementById(adscat4id).value = document.getElementById("drpadcat4").value;
                }

                var adscat5id = "adscat5" + a;
                if (document.getElementById(adscat4id) != null) {
                    var adscat5 = document.getElementById(adscat5id);
                    adscat5.value = '';
                    //adscat5.options.length=0;
                    // adscat5.options[adscat5.options.length] = new Option("Select","0");
                }
            }
        }
    }
}

function defaultuom() {
    if (document.getElementById('drpuom').value != "" && document.getElementById('drpuom').value != "0") {
        var uom_cod = document.getElementById('drpuom').value;
        var compcode = document.getElementById('hiddencompcode').value;
        if (uom_cod != "0") {
            QBC.gettheuom_desc(compcode, uom_cod, changesizetoline);
        }
    }
}

function openpaygetway() {
    ///////////////////payment getway/////////////////////////////

    if (document.getElementById('hdndepo').value == "depo") {
        if (document.getElementById('txtcardrate').value == "" || document.getElementById('txtcardrate').value == "0") {
            alert("Please get the card rate");
            return false;
        }
        checkValidation("btnsave");
       // saveClick();
        return false;

    }

    /////////////////////////////////
    //    var agencycode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.length + document.getElementById('txtagency').value.lastIndexOf('('));
    //    agencycode = agencycode.replace(")", "");
    //    var res = QBC.getPaymentFlag(agencycode);
    //    if (res.value == "1")
    //        window.open("https://ht.4cplus.com/adbooking/login.asp");
    //    else {
    //        window.open('qbc_offlinepayment.aspx?dateformat=' + document.getElementById('hiddendateformat').value + '&chkbtnStatus=' + chkbtnStatus + '&receiptno=' + document.getElementById('txtreceipt').value, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=144,left=210,width=560px,height=300px');
    //    }
    //return false;
}

function adsaveconfirm() {
    var compcode = document.getElementById("hiddencompcode").value;
    var cioid = document.getElementById("hiddencioid").value;
    var userid = document.getElementById("hiddenuserid").value;
    QBC.confirmsave(compcode, cioid, userid);
    //    if(document.getElementById("hiddenprint_rec").value=="Y")
    //    {
    //        printreceipt();
    //    }
}


function disablegriddrp() {
    if (document.getElementById("bookdiv") == null)
        return false;
    var divlen1 = document.getElementById("bookdiv").getElementsByTagName('table')[0].rows.length;
    var divrowcnt = 0;
    var cat2enable = 1;
    var cat3enable = 1;
    var cat4enable = 1;
    if (document.getElementById("drpadcat3").options.length > 1) {
        cat2enable = 0;
    }
    if (document.getElementById("drpadcat4").options.length > 1) {
        cat3enable = 0;
    }
    if (document.getElementById("drpadcat5").options.length > 1) {
        cat4enable = 0;
    }
    for (divrowcnt = 0; divrowcnt < divlen1 - 1; divrowcnt++) {
        if (cat2enable == 0) {
            if (document.getElementById("ads" + divrowcnt) != null)
                document.getElementById("ads" + divrowcnt).disabled = true;
        }
        if (cat3enable == 0) {
            if (document.getElementById("adscat3" + divrowcnt) != null)
                document.getElementById("adscat3" + divrowcnt).disabled = true;
        }
        if (cat4enable == 0) {
            if (document.getElementById("adscat4" + divrowcnt) != null)
                document.getElementById("adscat4" + divrowcnt).disabled = true;
        }
    }
}
function bindFinalRate() {
    var schemecheck = "N";
    //    var discprem = document.getElementById('drpdiscountprem').value;
    //    var spediscper = document.getElementById('txtspediscper').value;
    //    var pospremdisc = document.getElementById('txtpospremdisc').value;
    //    if (pospremdisc == "")
    //        pospremdisc = "0";
    if (document.getElementById('drppaymenttype').value == "" || document.getElementById('drppaymenttype').value == "0") {
        alert("Please Select Payment type");
        return false;
    }
    if (document.getElementById('drppaymenttype').value == "PR0" || document.getElementById('drppaymenttype').value == "PR1") {
        if (document.getElementById('hiddenexecname').value == "0" || document.getElementById('hiddenexecname').value == "") {
            alert("Please Select Executive Name");
            return false;
        }
    }
    if (document.getElementById('drppaymenttype').value == "CH0" || document.getElementById('drppaymenttype').value == "PR0" || document.getElementById('drppaymenttype').value == "DD0" || document.getElementById('drppaymenttype').value == "SW0" || document.getElementById('drppaymenttype').value == "ON0") {
        if (document.getElementById('hdnflagdetail').value == "true") {
        }
        else {
            alert("Please Fill Cheque Detail");
            return false;
        }
    }
    if (document.getElementById('drpratecode').style.display != "none" && document.getElementById('drpratecode').value == "0") {
        alert("Please Select Rate Code");
        document.getElementById('drpratecode').focus();
        return false;
    }
    else if (document.getElementById('drpratecode').style.display != "none" && document.getElementById('drpratecode').value != "0") {
        document.getElementById('txtratecode').value = document.getElementById('drpratecode').value;
    }
    if (document.getElementById('drpbullet').value == "BO1" || document.getElementById('drpbullet').value == "CO0" || document.getElementById('drpbullet').value == "SB0") {
        if (document.getElementById('drpbgcolor').value == "" || document.getElementById('drpbgcolor').value == "0") {
            alert("Please select background color");
            if (document.getElementById('drpbgcolor').disabled == false) {
                document.getElementById('drpbgcolor').focus();
            }
            return false;
        }
    }
    var bullet_var = document.getElementById('drpbullet');
    var scheme_var = document.getElementById('txtscheme');
    var scheme_var_n = "";
    var noofinsertion = document.getElementById('txtinsertion').value;
    var compcode = document.getElementById('hiddencompcode').value;
    var uom = document.getElementById('drpuom').value;
    var adtype = document.getElementById('drpadtype').value;
    var currency = document.getElementById('hiddencurrency').value;
    var ratecode = document.getElementById('txtratecode').value;
    var clientcode = ""; //getclientcode();
    var uomdesc = document.getElementById('hiddenuomdesc').value;
    var agencycode = document.getElementById('hiddenagency').value;
    var agency_vari = document.getElementById('txtagency');
    var drppackage_vari = document.getElementById('drppackagecopy');
    if (agency_vari.value != "") {
        agencycode = agency_vari.value.substring(agency_vari.value.lastIndexOf("(") + 1, agency_vari.value.lastIndexOf(")"));
    }
    //        var center="0";//document.getElementById('hiddencenter').value;
    //        if(document.getElementById('chkall').checked==true)
    //        {
    //            center="0";
    //        }
    //        else
    //        {
    //            center=document.getElementById('hiddencenter').value;
    //                }
    var center = document.getElementById('hiddencenter').value;
    var ratepremtype = document.getElementById('hiddenratepremtype').value;
    var dateformat = document.getElementById('hiddendateformat').value;
    var eyecatchtype = '';
    if (document.getElementById('hiddenbulletpremtype') != null)
        eyecatchtype = document.getElementById('hiddenbulletpremtype').value;
    var bPrem = '';
    if (document.getElementById('hiddenbullprem') != null)
        bPrem = document.getElementById('hiddenbullprem').value;
    var boxchargeInsertionwise = document.getElementById('hiddeninsertwise').value;
    var boxcharge = 0;
    var boxcharge_tot = 0;
    if (document.getElementById('txtboxchrg') != null)
        boxpercen = document.getElementById('txtboxchrg').value;
    if (boxpercen != null && boxpercen != "" && boxpercen != "0") {
        boxcharge = parseInt(boxpercen);
        boxcharge_tot = parseInt(boxpercen);
    }
    flagins = "1";
    var grossamtfinal = 0;
    var grossamtfinal_TOT = 0;
    var newcode = "";
    var cardamt = 0;
    var cardrateSum = 0;
    var res = null;
    len = "bookdiv";
    var query = '';
    var rowcount = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
    var editionname = '';
    var pkgcode = '';
    var color = '';
    var cat1 = '';
    var cat2 = '';
    var cat3 = '';
    var cat4 = '';
    var cat5 = '';
    var line = '';
    var insert_date = '';
    var ratecheck_date = '';

    var k = 0;
    var cntrfill = 0;
    var counter = 0;
    var counterT = 0;
    var cardrate = 0;
    var finsert = 1;
    var tinsert = 0;
    var pkg_insertion = '';
    var ad_width = '';
    var pkg_alias = '';
    var pagepost = '';
    var premiumno = '';
    //var paidCount=document.getElementById('txtinsertion').value;
    var paidCount = 0;
    var finsertF = 0;
    finsertF = 0;
    if (drppackage_vari.options.length > 0) {
        for (var insertCou = 0; insertCou < drppackage_vari.options.length; insertCou++) {
            if (drppackage_vari.options[insertCou].value.indexOf('(') >= 0) {
                tinsert = drppackage_vari.options[insertCou].value.substring(drppackage_vari.options[insertCou].value.lastIndexOf('(') + 1, drppackage_vari.options[insertCou].value.lastIndexOf(')'));
                if (parseInt(tinsert) > parseInt(finsert)) {
                    finsert = tinsert;

                }
                finsertF = parseInt(finsertF) + parseInt(tinsert);
                paidCount = parseInt(paidCount) + (parseInt(tinsert) * parseInt(document.getElementById('txtinsertion').value));
            }
        }
    }
    document.getElementById('txtpaid').value = paidCount;
    if (document.getElementById('configclient').value == "BHASKAR") {
        finsert = parseInt(finsertF) * parseInt(document.getElementById('txtinsertion').value);
    }
    else {
        finsert = parseInt(finsert) * parseInt(document.getElementById('txtinsertion').value);
    }
    var gridItemCount = parseInt(rowcount) / parseInt(finsertF);
    var freeIns = "N";
    var paid_var = document.getElementById('txtpaid');
    var color_vari = document.getElementById('drpcolor');
    var drpadcat_vari = document.getElementById('drpadcategory');
    var drpadsubcat_vari = document.getElementById('drpadsubcategory');
    var drpadcat3_vari = document.getElementById('drpadcat3');
    var drpadcat4_vari = document.getElementById('drpadcat4');
    var drpadcat5_vari = document.getElementById('drpadcat5');
    var totalarea_vari = document.getElementById('txttotalarea');

    var hiddenbox_vari = document.getElementById('hiddenboxchrgtype');
    var splboldspecialsize1 = "";
    // for consumption period
    var fDate = '';
    var lDate = '';
    if (rowcount > 0) {
        fDate = date_frmt_orcl(dateformat, document.getElementById('Text0').value);
        lDate = date_frmt_orcl(dateformat, document.getElementById('Text' + (rowcount - 1)).value);
    }
    for (var i = 0; i < parseInt(finsert); i++) {
        if (freeIns == "Y") {
            paid_var.value = parseInt(paid_var.value) - 1;
        }
        freeIns = "N";
        counterT = counter;
        editionname = '';
        pkgcode = '';
        color = '';
        cat1 = '';
        cat2 = '';
        cat3 = '';
        cat4 = '';
        cat5 = '';
        pkg_insertion = '';
        ad_width = '';
        line = '';
        insert_date = '';
        ratecheck_date = '';
        splboldspecialsize1 = '';
        pkg_alias = '';
        ad_width = '';
        pagepost = '';
        premiumno = '';
        var tCount = 0;
        var insval;
        var ins_vari = document.getElementById('ins' + counterT);
        if (ins_vari != null) {
            while (parseInt(ins_vari.innerHTML) == parseInt(i) + 1) {
                tCount = parseInt(tCount) + 1;
                counterT = parseInt(counterT) + 1;
                ins_vari = document.getElementById('ins' + counterT);
                if (ins_vari == null)
                    break;
            }
        }
        gridItemCount = tCount;  //get gridcount
        var pfdate;
        var pldate;
        var pkgcode_p;
        for (var j = 0; j < parseInt(gridItemCount); j++) {
            var par1;
            var edit_vari = document.getElementById('edit' + k);
            par1 = (edit_vari.parentNode).parentNode;
            //var col_vari=document.getElementById('col'+k);

            if (browser != "Microsoft Internet Explorer") {
                var splboldsize = document.getElementById("splboldsize" + k);
                var col_vari = document.getElementById('col' + k);
                var adcat_vari = document.getElementById('adcat' + k);
                var cat2_vari = document.getElementById('ads' + k);
                var cat3_vari = document.getElementById('adscat3' + k);
                var cat4_vari = document.getElementById('adscat4' + k);
                var cat5_vari = document.getElementById('adscat5' + k);
                //            var adcat_vari=document.getElementById('adcat'+k);
                //            var cat2_vari=document.getElementById('ads'+k);
                //            var cat3_vari=document.getElementById('adscat3'+k);
                //            var cat4_vari=document.getElementById('adscat4'+k);
                //            var cat5_vari=document.getElementById('adscat5'+k);
                var siz_vari;
                siz_vari = document.getElementById('siz' + k);

                var text_vari;
                text_vari = document.getElementById('Text' + k);
                var pmdate = text_vari.value;
                if (j != 0) {
                    pfdate = getBigDate(pfdate, pmdate, document.getElementById('hiddendateformat').value, "min");
                    pldate = getBigDate(pldate, pmdate, document.getElementById('hiddendateformat').value, "max");
                }
                if (j == 0) {
                    pfdate = text_vari.value;
                    pldate = text_vari.value;
                }
                //  var pkgins_vari=document.getElementById('pkg_ins'+k);
                var pkgins_vari = document.getElementById('pkg_ins' + k);
                var wid_vari;
                wid_vari = document.getElementById('wid' + k);

                var pkgalias_vari = document.getElementById('pkg_alias' + k);
                var pgpre_vari = document.getElementById('pgpre' + k);
                var prem_vari = document.getElementById('prem' + k);
                var hiddenpck_vari = document.getElementById('hiddenpckcode' + k);
            }
            else {
                var splboldsize = par1.all["splboldsize" + k];
                var col_vari = par1.all['col' + k];
                var adcat_vari = par1.all['adcat' + k];
                var cat2_vari = par1.all['ads' + k];
                var cat3_vari = par1.all['adscat3' + k];
                var cat4_vari = par1.all['adscat4' + k];
                var cat5_vari = par1.all['adscat5' + k];
                //            var adcat_vari=document.getElementById('adcat'+k);
                //            var cat2_vari=document.getElementById('ads'+k);
                //            var cat3_vari=document.getElementById('adscat3'+k);
                //            var cat4_vari=document.getElementById('adscat4'+k);
                //            var cat5_vari=document.getElementById('adscat5'+k);
                var siz_vari;
                siz_vari = par1.all['siz' + k];

                var text_vari;
                text_vari = par1.all['Text' + k];
                var pmdate = text_vari.value;
                if (j != 0) {
                    pfdate = getBigDate(pfdate, pmdate, document.getElementById('hiddendateformat').value, "min");
                    pldate = getBigDate(pldate, pmdate, document.getElementById('hiddendateformat').value, "max");
                }
                if (j == 0) {
                    pfdate = text_vari.value;
                    pldate = text_vari.value;
                }
                //  var pkgins_vari=document.getElementById('pkg_ins'+k);
                var pkgins_vari = par1.all['pkg_ins' + k];
                var wid_vari;
                wid_vari = par1.all['wid' + k];

                var pkgalias_vari = par1.all['pkg_alias' + k];
                var pgpre_vari = par1.all['pgpre' + k];
                var prem_vari = par1.all['prem' + k];
                var hiddenpck_vari = par1.all['hiddenpckcode' + k];
            }
            //            var pkgalias_vari=document.getElementById('pkg_alias'+k);
            //            var pgpre_vari=document.getElementById('pgpre'+k);
            //            var prem_vari=document.getElementById('prem'+k);
            //            var hiddenpck_vari=document.getElementById('hiddenpckcode'+k);
            //   pldate=text_vari.value;
            pkgcode_p = hiddenpck_vari.value;
            if (edit_vari != null) {
                if (editionname == '') {
                    editionname = edit_vari.value;
                }
                else {
                    editionname = editionname + ',' + edit_vari.value;
                }

                if (pkgcode == '') {
                    pkgcode = hiddenpck_vari.value;
                }
                else {
                    pkgcode = pkgcode + ',' + hiddenpck_vari.value;
                }

                if (color == '') {
                    if (col_vari != null) {
                        if (col_vari.value != "")
                            color = col_vari.value;
                        else
                            color = "0";
                    }
                    else
                        color = color_vari.value;
                }
                else {
                    if (col_vari != null) {
                        if (col_vari.value != "")
                            color = color + ',' + col_vari.value;
                        else
                            color = color + ',' + "0";
                    }
                    else
                        color = color + ',' + col_vari.value;
                }

                if (cat1 == '') {
                    if (adcat_vari != null) {
                        if (adcat_vari.value != "")
                            cat1 = adcat_vari.value;
                        else
                            cat1 = "0";
                    }
                    else
                        cat1 = drpadcat_vari.value;
                }
                else {
                    if (adcat_vari != null) {
                        if (adcat_vari.value != "")
                            cat1 = cat1 + ',' + adcat_vari.value;
                        else
                            cat1 = cat1 + ',' + "0";
                    }
                    else
                        cat1 = cat1 + ',' + drpadcat_vari.value;
                }

                if (cat2 == '') {
                    if (cat2_vari != null) {
                        if (cat2_vari.value != '') {
                            cat2 = cat2_vari.value;
                        }
                        else {
                            cat2 = "0";
                        }
                    }
                    else {
                        if (drpadsubcat_vari.value == "") {
                            cat2 = "0";
                        }
                        else {
                            cat2 = drpadsubcat_vari.value;
                        }
                    }
                }
                else {
                    if (cat2_vari != null) {
                        if (cat2_vari.value != '') {
                            cat2 = cat2 + ',' + cat2_vari.value;
                        }
                        else {
                            cat2 = cat2 + ',' + "0";
                        }

                    }
                    else {
                        if (drpadsubcat_vari.value == "") {
                            cat2 = cat2 + ',' + "0";
                        }
                        else {
                            cat2 = cat2 + ',' + drpadsubcat_vari.value;
                        }
                    }
                }

                if (cat3 == '') {
                    if (cat3_vari != null) {
                        if (cat3_vari.value == '') {
                            cat3 = "0";
                        }
                        else {
                            cat3 = cat3_vari.value;
                        }
                    }
                    else {
                        if (drpadcat3_vari.value == "") {
                            cat3 = "0";
                        }
                        else {
                            cat3 = drpadcat3_vari.value;
                        }
                    }
                }
                else {
                    if (cat3_vari != null) {
                        if (cat3_vari.value == '') {
                            cat3 = cat3 + ',' + "0";
                        }
                        else {
                            cat3 = cat3 + ',' + cat3_vari.value;
                        }
                    }

                    else {
                        if (drpadcat3_vari.value == "") {
                            cat3 = cat3 + ',' + "0";
                        }
                        else {
                            cat3 = cat3 + ',' + drpadcat3_vari.value;
                        }
                    }
                }

                if (cat4 == '') {
                    if (cat4_vari != null) {
                        if (cat4_vari.value == "") {
                            cat4 = "0";
                        }
                        else {
                            cat4 = cat4_vari.value;
                        }
                    }

                    else {
                        if (drpadcat4_vari.value == "") {
                            cat4 = "0";
                        }
                        else {
                            cat4 = drpadcat4_vari.value;
                        }
                    }
                }
                else {
                    if (cat4_vari != null) {
                        if (cat4_vari.value == "") {
                            cat4 = cat4 + ',' + "0";
                        }
                        else {
                            cat4 = cat4 + ',' + cat4_vari.value;
                        }

                    }
                    else {
                        if (drpadcat4_vari.value == "") {
                            cat4 = cat4 + ',' + "0";
                        }
                        else {
                            cat4 = cat4 + ',' + drpadcat4_vari.value;
                        }
                    }
                }

                if (cat5 == '') {
                    if (cat5_vari != null) {
                        if (cat5_vari.value == "") {
                            cat5 = "0";
                        }
                        else {
                            cat5 = cat5_vari.value;
                        }
                    }

                    else {
                        if (drpadcat5_vari.value == "") {
                            cat5 = "0";
                        }
                        else {
                            cat5 = drpadcat5_vari.value;
                        }
                    }
                }
                else {
                    if (cat5_vari != null) {
                        if (cat5_vari.value == "") {
                            cat5 = cat5 + ',' + "0";
                        }
                        else {
                            cat5 = cat5 + ',' + cat5_vari.value;
                        }
                    }

                    else {
                        if (drpadcat5_vari.value == "") {
                            cat5 = cat5 + ',' + "0";
                        }
                        else {
                            cat5 = cat5 + ',' + drpadcat5_vari.value;
                        }
                    }
                }

                if (line == '') {
                    if (siz_vari != null)
                        line = siz_vari.value;
                    else
                        line = totalarea_vari.value;
                }
                else {
                    if (siz_vari != null)
                        line = line + ',' + siz_vari.value;
                    else
                        line = line + ',' + totalarea_vari.value;
                }

                if (insert_date == '') {
                    insert_date = date_frmt_orcl(dateformat, text_vari.value);
                }
                else {
                    var datestr = date_frmt_orcl(dateformat, text_vari.value);
                    insert_date = insert_date + ',' + datestr;
                }

                if (document.getElementById('hiddenratecheckdate').value == 'i') {
                    if (ratecheck_date == '') {
                        ratecheck_date = date_frmt_orcl(dateformat, text_vari.value);
                    }
                    else {
                        var datestr = date_frmt_orcl(dateformat, text_vari.value);
                        ratecheck_date = ratecheck_date + ',' + datestr;

                    }
                }
                else {
                    if (ratecheck_date == '') {
                        //ratecheck_date=mySqlDate(document.getElementById('txtdatetime').value);
                        ratecheck_date = date_frmt_orcl(dateformat, document.getElementById('txtdatetime').value);
                    }
                    else {
                        //  var datestr=mySqlDate(document.getElementById('txtdatetime').value);
                        var datestr = date_frmt_orcl(dateformat, document.getElementById('txtdatetime').value);
                        ratecheck_date = ratecheck_date + ',' + datestr;

                    }
                }
                if (pkg_insertion == '') {
                    if (pkgins_vari.value == "") {
                        pkg_insertion = "1";
                    }
                    else {
                        pkg_insertion = pkgins_vari.value;
                    }
                }
                else {
                    if (pkgins_vari.value == "") {
                        pkg_insertion = pkg_insertion + ',' + "0";
                    }
                    else {
                        pkg_insertion = pkg_insertion + ',' + pkgins_vari.value;
                    }
                }
                if (ad_width == '') {
                    if (wid_vari.value == '') {
                        ad_width = '0';
                    }
                    else {
                        ad_width = wid_vari.value;
                    }
                }
                else {
                    if (wid_vari.value == '') {
                        ad_width = ad_width + ',' + '0';
                    }
                    else {
                        ad_width = ad_width + ',' + wid_vari.value;
                    }
                }
                if (pkg_alias == '') {
                    pkg_alias = pkgalias_vari.value;
                }
                else {
                    pkg_alias = pkg_alias + ',' + pkgalias_vari.value;
                }

                if (pagepost == '') {
                    if (document.getElementById('Hiddendrppageposition').value != "") {
                        pagepost = document.getElementById('Hiddendrppageposition').value;
                    }
                    else {
                        pagepost = '0';
                    }
                }
                else {
                    if (document.getElementById('Hiddendrppageposition').value != "") {
                        pagepost = pagepost + ',' + document.getElementById('Hiddendrppageposition').value;
                    }
                    else {
                        pagepost = pagepost + ',' + '0';
                    }
                }
                //for premium if any
                if (prem_vari != null && prem_vari.value == '')
                    prem_vari.value = "0";
                if (document.getElementById('hiddendrppageprem').value == "")
                    document.getElementById('hiddendrppageprem').value = "0";
                if (premiumno == '') {
                    if (prem_vari != null && prem_vari.value != '') {
                        premiumno = prem_vari.value;
                    }
                    else {
                        premiumno = document.getElementById('hiddendrppageprem').value; //'0';
                    }
                }
                else {
                    if (prem_vari != null && prem_vari.value != '') {
                        premiumno = premiumno + ',' + prem_vari.value;
                    }
                    else {
                        // premiumno=premiumno + ',' + '0';
                        premiumno = premiumno + ',' + document.getElementById('hiddendrppageprem').value;
                    }
                }

                // for bold character
                if (splboldspecialsize1 == '') {
                    if (splboldsize != null) {
                        if (splboldsize.value != "")
                            splboldspecialsize1 = splboldsize.value;
                        else
                            splboldspecialsize1 = "0";
                    }
                    else
                        splboldspecialsize1 = "0";
                }
                else {
                    if (splboldsize != null) {
                        if (splboldsize.value != "")
                            splboldspecialsize1 = splboldspecialsize1 + ',' + splboldsize.value;
                        else
                            splboldspecialsize1 = splboldspecialsize1 + ',' + "0";
                    }
                    else
                        splboldspecialsize1 = splboldspecialsize1 + ',' + "0";
                }
            }
            k++;
        } // end of first loop
        var resT = QBC.getPackageConsumption(pkgcode_p, pfdate, pldate, document.getElementById('hiddendateformat').value);
        if (resT.value == null) {
            alert(resT.error.description);
            return false;
        }
        if (resT.value.Tables[0].Rows.length > 0) {
            if (resT.value.Tables[0].Rows[0].MSG != 'A') {
                alert(resT.value.Tables[0].Rows[0].MSG);
                return false;
            }
        }
        newcode = editionname + "$" + pkgcode + "$" + color + "$" + cat1 + "$" + cat2 + "$" + cat3 + "$" + cat4 + "$" + cat5 + "$" + line + "$" + insert_date + "$" + ratecheck_date + "$" + pkg_insertion + "$" + ad_width + "$" + pkg_alias + "$" + pagepost + "$" + premiumno + "$" + splboldspecialsize1;
        cardamt = 0;
        //    alert(newcode);
        var style_p = document.getElementById('drpstyle').value;
        if (style_p == "") {
            style_p = "0";
        }
        style_p = style_p + "~" + document.getElementById('drpbgcolor').value;
        var logoprem_p = document.getElementById('drplogoprem').value;
        logoprem_p = logoprem_p + "~" + document.getElementById('drpbullet').value;
        res = QBC.get_rate(noofinsertion, dateformat, compcode, uom, adtype, currency, ratecode, clientcode, uomdesc, agencycode, newcode, center, ratepremtype, '0', document.getElementById('hiddenschemetype').value, fDate, lDate, parseInt(i) + 1, document.getElementById('drpdesign').value, logoprem_p, style_p);
        cntrfill = 0;
        document.getElementById('btnholding').disabled = false;
        var ds = res.value;
        if (ds == null) {
            alert(res.error.description);
            return false;
        }
        // for reset paid insertion
        if (ds.Tables[2].Rows.length > 0 && schemecheck == "N")
            schemecheck = "Y";

        // for commission
        var COMM_RATE = 0;
        if (ds.Tables[3].Rows.length > 0) {

            if (ds.Tables[3].Rows[0].COMM_RATE != undefined && ds.Tables[3].Rows[0].COMM_RATE != "undefined") {
                if (document.getElementById('chktrade').checked == true) {
                    COMM_RATE = ds.Tables[3].Rows[0].COMM_RATE;
                    tradedisc = COMM_RATE;
                    document.getElementById('lbltrade').innerHTML = "TD: " + tradedisc.toString() + "%";
                }
                else {
                    COMM_RATE = 0;
                    tradedisc = 0;
                    document.getElementById('lbltrade').innerHTML = "";
                }
                //grossamtfinal=parseFloat(grossamtfinal) - (parseFloat(grossamtfinal) * COMM_RATE/100);
            }

        }
        var chkscheme_Type = 0;
        var gridItemTotal = 0;
        for (; cntrfill < parseInt(gridItemCount); cntrfill++) {
            if (schemecheck == "Y") {
                //            for ( var s_name = 0; s_name < rowcount; s_name++)
                //            {
                var pai_vari = document.getElementById('pai' + counter);
                if (pai_vari != null) {
                    // pai_vari.value='Y';
                }
                //            }
            }
            var pkgcode = document.getElementById("hiddenpckcode" + counter);
            if (pkgcode == null)
                break;

            if (ds.Tables[0].Rows.length <= 0) {
                var par1;
                cardid = document.getElementById("card" + counter);
                par1 = (cardid.parentNode).parentNode;
                if (browser != "Microsoft Internet Explorer") {
                    solo = document.getElementById("sol" + counter);
                    gross = document.getElementById("gro" + counter);
                    var paidno = document.getElementById("pai" + counter);
                    var agrred = document.getElementById("agr" + counter);
                    var insertsta = document.getElementById("inssta" + counter); //"inssta"+counter;    
                    var eyecatchRate = 0;
                    var eyecatchRate_tot = 0;
                    var billv = document.getElementById("ba" + counter);
                    var pkgalias = document.getElementById("pkg_alias" + counter);
                    var editioncomp = document.getElementById("edit" + counter);
                    var vat_inc = document.getElementById("vat_inc" + counter);
                    //////////////////////////////anuja eyecather
                    var eye_cather = document.getElementById("eye_cather " + counter);
                    ////////daywise prem
                    var hdnday_prim = document.getElementById("hdnday_prim " + counter);
                }
                else {
                    solo = par1.all["sol" + counter];
                    gross = par1.all["gro" + counter];
                    var paidno = par1.all["pai" + counter];
                    var agrred = par1.all["agr" + counter];
                    var insertsta = par1.all["inssta" + counter]; //"inssta"+counter;    
                    var eyecatchRate = 0;
                    var eyecatchRate_tot = 0;
                    var billv = par1.all["ba" + counter];
                    var pkgalias = par1.all["pkg_alias" + counter];
                    var editioncomp = par1.all["edit" + counter];
                    var vat_inc = par1.all["vat_inc" + counter];
                    //////////////////////////////anuja eyecather
                    var eye_cather = par1.all["eye_cather " + counter];
                    ////////daywise prem
                    var hdnday_prim = par1.all["hdnday_prim " + counter];
                }
                if (insertsta.value != "billed") {
                    vat_inc.value = ds.Tables[1].Rows[cntrfill].VAT_INC;
                    billv.value = "0";
                }
                // NEW CHANGE 19 NOV 09
                if (pkgcode.value == ds.Tables[1].Rows[cntrfill].PCODE && LTrim(RTrim(pkgalias.value)) == LTrim(RTrim(ds.Tables[1].Rows[cntrfill].PKG_ALIAS))) {
                    //alert(ds.Tables[1].Rows[cntrfill].PCODE);  
                    var scheme = "";
                    var edicount = cntrfill;
                    //----3-----------
                    chkscheme_Type = 1;
                    for (var scicount = 0; scicount < ds.Tables[2].Rows.length; scicount++) {       //----4-----------
                        var edipac = '';
                        if (ds.Tables[2].Rows[scicount].VAL == 'P')
                            edipac = pkgcode.value;
                        else
                            edipac = editioncomp.value;
                        if (edipac == ds.Tables[2].Rows[scicount].PKG_CODE && (parseInt(i) + 1 >= ds.Tables[2].Rows[scicount].FROM_INSERT && parseInt(i) + 1 <= ds.Tables[2].Rows[scicount].TO_INS) && paidno.value != "P") {           //----5-----------
                            chkscheme_Type = 0;
                            document.getElementById('hiddenscheme').value = ds.Tables[2].Rows[scicount].SCHEMEID;
                            if (uomdesc == 'CD') {

                                cardid.value = ds.Tables[1].Rows[edicount].CARDRATE;
                                solo.value = ds.Tables[1].Rows[edicount].CARDRATE;
                            }
                            else {
                                cardid.value = ds.Tables[1].Rows[edicount].CARDRATE;
                                solo.value = ds.Tables[1].Rows[edicount].CARDRATE;

                            }
                            var gridgross = gross.value = ds.Tables[1].Rows[edicount].FCARDRATE;
                            var gridgross_tot = gross.value = ds.Tables[1].Rows[edicount].FCARDRATE;
                            cardamt = parseFloat(cardamt) + parseFloat(ds.Tables[1].Rows[edicount].FCARDRATE);
                            ////////                                        if(gross.value!="")
                            ////////                                        {
                            ////////                                            gross.value=parseFloat(gross.value) - (parseFloat(gross.value) * COMM_RATE/100);
                            ////////                                            var ADD_COMM_RATE=0;
                            ////////                                            if(ds.Tables[3].Rows.length>0 && ds.Tables[3].Rows[0].ADD_COMM_RATE!=undefined && ds.Tables[3].Rows[0].ADD_COMM_RATE!="undefined")
                            ////////                                            {
                            ////////                                              ADD_COMM_RATE=ds.Tables[3].Rows[0].ADD_COMM_RATE;
                            ////////                                            } 
                            ////////                                            if(ADD_COMM_RATE!=undefined && ADD_COMM_RATE!="undefined")
                            ////////                                            {
                            ////////                                               gross.value=parseFloat(gross.value) - (parseFloat(gross.value) * ADD_COMM_RATE/100);
                            ////////                                            }  
                            ////////                                            gridgross=gross.value;
                            ////////                                        }

                            scheme_var_n = ds.Tables[2].Rows[scicount].SCHEMENAME;
                            if (ds.Tables[1].Rows[edicount].BULLET != undefined && ds.Tables[1].Rows[edicount].BULLET != "undefined" && ds.Tables[1].Rows[edicount].BULLET != null && ds.Tables[1].Rows[edicount].BULLET != "0") {
                                bPrem = ds.Tables[1].Rows[edicount].BULLET;
                            }
                            ///////add by anuja
                            var dayrateprem = 0;
                            if (ds.Tables[1].Rows[edicount].CARDRATE_WOUT_PREM != null && ds.Tables[1].Rows[edicount].CARDRATE_WOUT_PREM != "0") {
                                dayrateprem = ds.Tables[1].Rows[edicount].CARDRATE_WOUT_PREM;
                                document.getElementById("hdnday_prim" + counter).value = ds.Tables[1].Rows[edicount].CARDRATE_WOUT_PREM;
                            }
                            var solbu = solo.value;
                            if (ds.Tables[1].Rows[edicount].MINWORD != null && parseInt(document.getElementById('siz' + counter).value) > parseInt(ds.Tables[1].Rows[edicount].MINWORD)) {
                                solbu = parseFloat(solbu) + parseFloat(ds.Tables[1].Rows[edicount].FEXTRARATE);
                            }
                            //////////////////////end
                            if (bullet_var != null && bullet_var.value != '0') {
                                if (eyecatchtype != 'S') {
                                    if (eyecatchtype == 'P') {
                                        if (bPrem.indexOf('%') > 0)
                                            bPrem = bPrem.split('%')[0];
                                        /////////////////////add anuja eyecather
                                        if (ds.Tables[1].Rows[edicount].BULLET != null) {
                                            document.getElementById("eye_cather" + counter).value = ds.Tables[1].Rows[edicount].BULLET;
                                        }
                                        eyecatchRate = (parseFloat(solbu - dayrateprem) * parseFloat(bPrem)) / 100;
                                        eyecatchRate_tot = (parseFloat(solbu - dayrateprem) * parseFloat(bPrem)) / 100;
                                        if (document.getElementById('hiddeneyecatchpubwise').value == "Y") {
                                            var pkgcodegrid_n = 'hiddenpckcode' + counter;
                                            var ediname_n = 'edit' + counter;
                                            var res = QBC.getEditionCount(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid_n).value, document.getElementById(ediname_n).value);
                                            var edi_cou = res.value;
                                            eyecatchRate = parseFloat(eyecatchRate);// / parseFloat(edi_cou);
                                            eyecatchRate_tot = parseFloat(eyecatchRate_tot) ;/// parseFloat(edi_cou);
                                        }
                                        grossamtfinal = parseFloat(grossamtfinal) + parseFloat(eyecatchRate);
                                        gross.value = parseFloat(gross.value) + parseFloat(eyecatchRate);


                                        grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) + parseFloat(eyecatchRate_tot);
                                    }
                                    else if (eyecatchtype == 'F') {
                                        if (bPrem.indexOf('%') > 0)
                                            bPrem = bPrem.split('%')[0];
                                        eyecatchRate = parseFloat(bPrem); //parseFloat(grossamtfinal) + parseFloat(bPrem);
                                        eyecatchRate_tot = parseFloat(bPrem);
                                        /////////////////////add anuja eyecather
                                        if (ds.Tables[1].Rows[edicount].BULLET != null) {
                                            document.getElementById("eye_cather" + counter).value = ds.Tables[1].Rows[edicount].BULLET;
                                        }
                                        if (document.getElementById('hiddeneyecatchpubwise').value == "Y") {
                                            var pkgcodegrid_n = 'hiddenpckcode' + counter;
                                            var ediname_n = 'edit' + counter;
                                            var res = QBC.getEditionCount(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid_n).value, document.getElementById(ediname_n).value);
                                            var edi_cou = res.value;
                                            eyecatchRate = parseFloat(eyecatchRate) / parseFloat(edi_cou);
                                            eyecatchRate_tot = parseFloat(eyecatchRate_tot) / parseFloat(edi_cou);
                                        }

                                        grossamtfinal = parseFloat(grossamtfinal) + eyecatchRate;
                                        grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) + eyecatchRate_tot;
                                        gross.value = parseFloat(gross.value) + parseFloat(eyecatchRate);
                                    }
                                }
                            }
                            // for insertion wise box charges
                            //                                         if(boxchargeInsertionwise=='yes')
                            //                                    {
                            //                                     var tboxcharge=0;
                            //                                           tboxcharge=boxcharge;
                            //                                        if(hiddenbox_vari.value=='2')
                            //                                        {
                            //                                             tboxcharge=(parseFloat(gridgross) * parseFloat(boxcharge))/100;
                            //                                             boxcharge_tot=(parseFloat(gridgross_tot) * parseFloat(boxcharge_tot))/100;
                            //                                        }  
                            //                                        grossamtfinal=parseFloat(grossamtfinal) + tboxcharge;
                            //                                        grossamtfinal_TOT=parseFloat(grossamtfinal_TOT) + boxcharge_tot;
                            //                                        gross.value = parseFloat(gross.value) + parseFloat(tboxcharge);
                            //                                    }
                            gridgross = gross.value;
                            gridgross_tot = gross.value;
                            if (ds.Tables[2].Rows[scicount].TYPE == "per") {
                                if (document.getElementById('hidschememin').value == "Y" && ds.Tables[1].Rows[edicount].MINWORD != null && parseInt(document.getElementById('siz' + counter).value) > parseInt(ds.Tables[1].Rows[edicount].MINWORD)) {
                                    var exrate = ds.Tables[1].Rows[edicount].FEXTRARATE;
                                    gridgross = parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) - (parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) * parseFloat(ds.Tables[2].Rows[scicount].AMT) / 100);
                                    gridgross = parseFloat(gridgross) + parseFloat(exrate);
                                }
                                else {
                                    gridgross = parseFloat(gridgross) - (parseFloat(gridgross) * parseFloat(ds.Tables[2].Rows[scicount].AMT) / 100);
                                }
                                gridgross_tot = parseFloat(gridgross_tot) - (parseFloat(gridgross_tot) * parseFloat(ds.Tables[2].Rows[scicount].AMT) / 100);
                                if (parseInt(gridgross) == 0) {
                                    freeIns = "Y";
                                    grossamtfinal = parseFloat(grossamtfinal) + parseFloat(gridgross + dayrateprem); //+gridgross;
                                    grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) + parseFloat(gridgross_tot + dayrateprem); //+gridgross;
                                    gridgross = parseFloat(gridgross + dayrateprem);
                                    gridgross_tot = parseFloat(gridgross_tot + dayrateprem);
                                }
                                else {
                                    grossamtfinal = parseFloat(grossamtfinal) + parseFloat(gridgross); //+gridgross;
                                    grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) + parseFloat(gridgross_tot); //+gridgross;
                                }
                                //agreed rate
                                gross.value = gridgross.toFixed(2);
                            }
                            else {
                                var schratio = 0;
                                if (gridItemTotal == 0) {
                                    for (var f = 0; f < ds.Tables[1].Rows.length; f++) {
                                        if (pkgcode.value == ds.Tables[1].Rows[f].PCODE)
                                            gridItemTotal = gridItemTotal + ds.Tables[1].Rows[f].FCARDRATE;
                                    }

                                }
                                schratio = (parseFloat(ds.Tables[2].Rows[scicount].AMT) / parseFloat(gridItemTotal)) * parseFloat(ds.Tables[1].Rows[edicount].FCARDRATE);
                                grossamtfinal = parseFloat(grossamtfinal) + (parseFloat(gridgross) - parseFloat(schratio));
                                grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) + (parseFloat(gridgross_tot) - parseFloat(schratio));
                                // grossamtfinal=parseFloat(grossamtfinal) + (parseFloat(gridgross) - parseFloat(ds.Tables[2].Rows[scicount].AMT)) ;

                                //grossamtfinal_TOT=parseFloat(grossamtfinal_TOT) + (parseFloat(gridgross_tot) - parseFloat(ds.Tables[2].Rows[scicount].AMT)) ;
                                if (document.getElementById('hidschememin').value == "Y" && ds.Tables[1].Rows[edicount].MINWORD != null && parseInt(document.getElementById('siz' + counter).value) > parseInt(ds.Tables[1].Rows[edicount].MINWORD)) {
                                    var exrate = ds.Tables[1].Rows[edicount].FEXTRARATE;
                                    gross.value = parseFloat(gridgross) - parseFloat(schratio);
                                    gridgross = parseFloat(gross.value) + parseFloat(exrate);
                                }
                                else {
                                    gross.value = parseFloat(gridgross) - parseFloat(schratio);
                                }
                                gridItemTotal = 0;
                            }
                            if (paidno != null && ds.Tables[2].Rows[scicount].TYPE == "per" && ds.Tables[2].Rows[scicount].AMT == "100") {
                                if (paidno.value != "P")
                                    paidno.value = 'N';
                            }
                            else if (paidno != null) {
                                paidno.value = 'Y';
                            }
                            scheme = 'Y';
                            edicount = gridItemCount;
                            if (i == 0) {
                                if (uomdesc == 'CD') {
                                    cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].CARDRATE);
                                }
                                else {
                                    cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[cntrfill].CARDRATE);
                                }
                            }
                            break;
                        }  //----5-----------

                    }    //----4-----------   
                    //----3-----------  
                    if (scheme == '') {
                        if (uomdesc == 'CD') {

                            cardid.value = ds.Tables[1].Rows[cntrfill].CARDRATE;
                            solo.value = ds.Tables[1].Rows[cntrfill].CARDRATE;

                        }
                        else {

                            cardid.value = ds.Tables[1].Rows[cntrfill].CARDRATE;
                            solo.value = ds.Tables[1].Rows[cntrfill].CARDRATE;

                        }
                        var gridgross = 0;
                        var gridgross_tot = 0;
                        cardamt = parseFloat(cardamt) + parseFloat(ds.Tables[1].Rows[cntrfill].FCARDRATE);
                        gridgross = gross.value = ds.Tables[1].Rows[cntrfill].FCARDRATE;
                        gridgross_tot = gross.value = ds.Tables[1].Rows[cntrfill].FCARDRATE;
                        ////////                                    if(gross.value!="")
                        ////////                                    {
                        ////////                                        gross.value=parseFloat(gross.value) - (parseFloat(gross.value) * COMM_RATE/100);
                        ////////                                        var ADD_COMM_RATE=0;
                        ////////                                        if(ds.Tables[3].Rows.length>0 && ds.Tables[3].Rows[0].ADD_COMM_RATE!=undefined && ds.Tables[3].Rows[0].ADD_COMM_RATE!="undefined")
                        ////////                                        {
                        ////////                                         ADD_COMM_RATE=ds.Tables[3].Rows[0].ADD_COMM_RATE;
                        ////////                                        }
                        ////////                                        if(ADD_COMM_RATE!=undefined && ADD_COMM_RATE!="undefined")
                        ////////                                        {
                        ////////                                           gross.value=parseFloat(gross.value) - (parseFloat(gross.value) * ADD_COMM_RATE/100);
                        ////////                                        }  
                        ////////                                        gridgross=gross.value;
                        ////////                                    }   
                        grossamtfinal = parseFloat(grossamtfinal) + parseFloat(gridgross);
                        grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) + parseFloat(gridgross_tot);
                        if (ds.Tables[1].Rows[cntrfill].BULLET != undefined && ds.Tables[1].Rows[cntrfill].BULLET != "undefined" && ds.Tables[1].Rows[cntrfill].BULLET != null && ds.Tables[1].Rows[cntrfill].BULLET != "0") {
                            bPrem = ds.Tables[1].Rows[cntrfill].BULLET;
                        }
                        ///////////add by anuja
                        var dayrateprem = 0;
                        if (ds.Tables[1].Rows[cntrfill].CARDRATE_WOUT_PREM != null && ds.Tables[1].Rows[cntrfill].CARDRATE_WOUT_PREM != "0") {
                            dayrateprem = ds.Tables[1].Rows[cntrfill].CARDRATE_WOUT_PREM;
                            document.getElementById("hdnday_prim" + counter).value = ds.Tables[1].Rows[cntrfill].CARDRATE_WOUT_PREM;
                        }
                        var solbu = solo.value;
                        if (ds.Tables[1].Rows[cntrfill].MINWORD != null && parseInt(document.getElementById('siz' + counter).value) > parseInt(ds.Tables[1].Rows[cntrfill].MINWORD)) {
                            solbu = parseFloat(solbu) + parseFloat(ds.Tables[1].Rows[cntrfill].FEXTRARATE);
                        }
                        /////////////////////////////end   
                        if (bullet_var != null && bullet_var.value != '0') {
                            if (eyecatchtype != 'S') {
                                if (eyecatchtype == 'P') {
                                    if (bPrem.indexOf('%') > 0)
                                        bPrem = bPrem.split('%')[0]
                                    /////////////////////add anuja eyecather
                                    if (ds.Tables[1].Rows[cntrfill].BULLET != null) {
                                        document.getElementById("eye_cather" + counter).value = ds.Tables[1].Rows[cntrfill].BULLET;
                                    }
                                    eyecatchRate = (parseFloat(solbu - dayrateprem) * parseFloat(bPrem)) / 100;
                                    eyecatchRate_tot = (parseFloat(solbu - dayrateprem) * parseFloat(bPrem)) / 100;
                                    if (document.getElementById('hiddeneyecatchpubwise').value == "Y") {
                                        var pkgcodegrid_n = 'hiddenpckcode' + counter;
                                        var ediname_n = 'edit' + counter;
                                        var res = QBC.getEditionCount(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid_n).value, document.getElementById(ediname_n).value);
                                        var edi_cou = res.value;
                                        eyecatchRate = parseFloat(eyecatchRate) / parseFloat(edi_cou);
                                        eyecatchRate_tot = parseFloat(eyecatchRate_tot) / parseFloat(edi_cou);
                                    }
                                    gross.value = parseFloat(gross.value) + parseFloat(eyecatchRate);
                                    grossamtfinal = parseFloat(grossamtfinal) + parseFloat(eyecatchRate);


                                    grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) + parseFloat(eyecatchRate_tot);
                                }
                                else if (eyecatchtype == 'F') {
                                    if (bPrem.indexOf('%') > 0)
                                        bPrem = bPrem.split('%')[0]
                                    eyecatchRate = parseFloat(bPrem); //parseFloat(gridgross) + parseFloat(bPrem);
                                    eyecatchRate_tot = parseFloat(bPrem); //parseFloat(gridgross) + parseFloat(bPrem);
                                    /////////////////////add anuja eyecather
                                    if (ds.Tables[1].Rows[cntrfill].BULLET != null) {
                                        document.getElementById("eye_cather" + counter).value = ds.Tables[1].Rows[cntrfill].BULLET;
                                    }
                                    if (document.getElementById('hiddeneyecatchpubwise').value == "Y") {
                                        var pkgcodegrid_n = 'hiddenpckcode' + counter;
                                        var ediname_n = 'edit' + counter;
                                        var res = QBC.getEditionCount(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid_n).value, document.getElementById(ediname_n).value);
                                        var edi_cou = res.value;
                                        eyecatchRate = parseFloat(eyecatchRate) / parseFloat(edi_cou);
                                        eyecatchRate_tot = parseFloat(eyecatchRate_tot) / parseFloat(edi_cou);
                                    }

                                    grossamtfinal = parseFloat(grossamtfinal) + eyecatchRate;
                                    grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) + eyecatchRate_tot;
                                    gross.value = parseFloat(gross.value) + parseFloat(eyecatchRate);
                                }
                            }
                        }
                        // for insertion wise Box Charges 
                        //                                    if(boxchargeInsertionwise=='yes')
                        //                                    {
                        //                                     var tboxcharge=0;
                        //                                           tboxcharge=boxcharge;
                        //                                        if(hiddenbox_vari.value=='2')
                        //                                        {
                        //                                             tboxcharge=(parseFloat(gridgross) * parseFloat(boxcharge))/100;
                        //                                             boxcharge_tot=(parseFloat(gridgross_tot) * parseFloat(boxcharge_tot))/100;
                        //                                        }  
                        //                                        grossamtfinal=parseFloat(grossamtfinal) + tboxcharge;
                        //                                        grossamtfinal_TOT=parseFloat(grossamtfinal_TOT) + boxcharge_tot;
                        //                                        gross.value = parseFloat(gross.value) + parseFloat(tboxcharge);
                        //                                    }

                        edicount = gridItemCount;
                        if (i == 0) {
                            if (uomdesc == 'CD') {
                                cardrate = parseFloat(cardrate) + ds.Tables[1].Rows[cntrfill].CARDRATE;
                            }
                            else {
                                cardrate = parseFloat(cardrate) + ds.Tables[1].Rows[cntrfill].CARDRATE;
                            }
                        }
                        var grossValue = parseFloat(gross.value);
                        gross.value = grossValue.toFixed(2);
                        // break;

                    }
                    if (insertsta.value == 'cancel') {
                        gross.value = 0;
                        freeIns = "Y";
                        if (boxchargeInsertionwise == 'yes') {
                            grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(gridgross) + parseFloat(eyecatchRate) + parseFloat(boxcharge));
                            grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) - (parseFloat(gridgross_tot) + parseFloat(eyecatchRate_tot) + parseFloat(boxcharge_tot));
                        }
                        else {
                            grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(gridgross) + parseFloat(eyecatchRate));
                            grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) - (parseFloat(gridgross_tot) + parseFloat(eyecatchRate_tot));
                        }
                        //  var paidno= "pai"+counter;
                        if (paidno != null) {
                            paidno.value = 'N';
                        }
                    }
                    else if (paidno != null) {
                        if (paidno.value == 'N') {
                            //if (document.getElementById('hidschememin').value != "Y")
                            //gross.value = 0;
                            if (boxchargeInsertionwise == 'yes') {
                                grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(eyecatchRate) + parseFloat(boxcharge));
                                grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) - (parseFloat(eyecatchRate_tot) + parseFloat(boxcharge_tot));
                            }
                            else {
                                grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(eyecatchRate));
                                grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) - (parseFloat(eyecatchRate_tot));
                            }
                        }
                    }
                    if (paidno.value != 'N')
                        cardrateSum = parseFloat(cardrateSum) + parseFloat(cardid.value);
                    else if (insertsta.value == 'cancel')
                        cardrateSum = parseFloat(cardrateSum) + parseFloat(cardid.value);
                    if (gross.value != "" && billv != null) {
                        if (document.getElementById('chktrade').checked == true)
                            billv.value = parseFloat(gross.value) - (parseFloat(gross.value) * COMM_RATE / 100);
                        else
                            billv.value = parseFloat(gross.value);
                        var ADD_COMM_RATE = 0;
                        if (ds.Tables[3].Rows.length > 0 && ds.Tables[3].Rows[0].ADD_COMM_RATE != undefined && ds.Tables[3].Rows[0].ADD_COMM_RATE != "undefined") {
                            ADD_COMM_RATE = ds.Tables[3].Rows[0].ADD_COMM_RATE;
                        }
                        if (ADD_COMM_RATE != undefined && ADD_COMM_RATE != "undefined") {
                            billv.value = parseFloat(billv.value) - (parseFloat(billv.value) * ADD_COMM_RATE / 100);
                        }
                        if (document.getElementById('hiddenbooktype').value == "2" || document.getElementById('hiddenbooktype').value == "4" || document.getElementById('hiddenbooktype').value == "5") {
                            billv.value = "0";
                        }

                    }
                    counter++;

                }
                else {
                    //if(pkgcode.value==ds.Tables[1].Rows[cntrfill].PCODE && LTrim(RTrim(pkgalias.value))==LTrim(RTrim(ds.Tables[1].Rows[cntrfill].PKG_ALIAS)))
                    for (var edicount = 0; edicount < parseInt(gridItemCount); edicount++) {               //----1-----------

                        if (pkgcode.value == ds.Tables[1].Rows[edicount].PCODE && LTrim(RTrim(pkgalias.value)) == LTrim(RTrim(ds.Tables[1].Rows[edicount].PKG_ALIAS))) {           //----2-----------
                            var scheme = "";
                            //----3-----------
                            for (var scicount = 0; scicount < ds.Tables[2].Rows.length; scicount++) {       //----4-----------
                                var edipac = '';
                                if (ds.Tables[2].Rows[scicount].VAL == 'P')
                                    edipac = pkgcode.value;
                                else
                                    edipac = editioncomp.value;
                                if (edipac == ds.Tables[2].Rows[scicount].PKG_CODE && (parseInt(i) + 1 >= ds.Tables[2].Rows[scicount].FROM_INSERT && parseInt(i) + 1 <= ds.Tables[2].Rows[scicount].TO_INS) && paidno.value != "P") {           //----5-----------
                                    document.getElementById('hiddenscheme').value = ds.Tables[2].Rows[scicount].SCHEMEID;
                                    if (uomdesc == 'CD') {

                                        cardid.value = ds.Tables[1].Rows[edicount].CARDRATE;
                                        solo.value = ds.Tables[1].Rows[edicount].CARDRATE;

                                    }
                                    else {

                                        cardid.value = ds.Tables[1].Rows[edicount].CARDRATE;
                                        solo.value = ds.Tables[1].Rows[edicount].CARDRATE;

                                    }
                                    cardamt = parseFloat(cardamt) + parseFloat(ds.Tables[1].Rows[edicount].FCARDRATE);
                                    var gridgross = gross.value = ds.Tables[1].Rows[edicount].FCARDRATE;
                                    var gridgross_tot = gross.value = ds.Tables[1].Rows[edicount].FCARDRATE;
                                    ////////                                        if(gross.value!="")
                                    ////////                                        {
                                    ////////                                            gross.value=parseFloat(gross.value) - (parseFloat(gross.value) * COMM_RATE/100);
                                    ////////                                            var ADD_COMM_RATE=0;
                                    ////////                                            if(ds.Tables[3].Rows.length>0 && ds.Tables[3].Rows[0].ADD_COMM_RATE!=undefined && ds.Tables[3].Rows[0].ADD_COMM_RATE!="undefined")
                                    ////////                                            {
                                    ////////                                                 ADD_COMM_RATE=ds.Tables[3].Rows[0].ADD_COMM_RATE;
                                    ////////                                            }     
                                    ////////                                            if(ADD_COMM_RATE!=undefined && ADD_COMM_RATE!="undefined")
                                    ////////                                            {
                                    ////////                                               gross.value=parseFloat(gross.value) - (parseFloat(gross.value) * ADD_COMM_RATE/100);
                                    ////////                                            }  
                                    ////////                                            gridgross=gross.value;
                                    ////////                                        }

                                    scheme_var_n = ds.Tables[2].Rows[scicount].SCHEMENAME;
                                    if (ds.Tables[1].Rows[edicount].BULLET != undefined && ds.Tables[1].Rows[edicount].BULLET != "undefined" && ds.Tables[1].Rows[edicount].BULLET != null && ds.Tables[1].Rows[edicount].BULLET != "0") {
                                        bPrem = ds.Tables[1].Rows[edicount].BULLET;
                                    }
                                    /////////add by anuja
                                    var dayrateprem = 0;
                                    if (ds.Tables[1].Rows[edicount].CARDRATE_WOUT_PREM != null && ds.Tables[1].Rows[edicount].CARDRATE_WOUT_PREM != "0") {
                                        dayrateprem = ds.Tables[1].Rows[edicount].CARDRATE_WOUT_PREM;
                                        document.getElementById("hdnday_prim" + counter).value = ds.Tables[1].Rows[edicount].CARDRATE_WOUT_PREM;
                                    }
                                    var solbu = solo.value;
                                    if (ds.Tables[1].Rows[edicount].MINWORD != null && parseInt(document.getElementById('siz' + counter).value) > parseInt(ds.Tables[1].Rows[edicount].MINWORD)) {
                                        solbu = parseFloat(solbu) + parseFloat(ds.Tables[1].Rows[edicount].FEXTRARATE);
                                    }
                                    ////////////////////////end    
                                    if (bullet_var.value != '0') {
                                        if (eyecatchtype != 'S') {
                                            if (eyecatchtype == 'P') {
                                                if (bPrem.indexOf('%') > 0)
                                                    bPrem = bPrem.split('%')[0];
                                                /////////////////////add anuja eyecather
                                                if (ds.Tables[1].Rows[edicount].BULLET != null) {
                                                    document.getElementById("eye_cather" + counter).value = ds.Tables[1].Rows[edicount].BULLET;
                                                }
                                                eyecatchRate = (parseFloat(solbu - dayrateprem) * parseFloat(bPrem)) / 100;
                                                eyecatchRate_tot = (parseFloat(solbu - dayrateprem) * parseFloat(bPrem)) / 100;
                                                if (document.getElementById('hiddeneyecatchpubwise').value == "Y") {
                                                    var pkgcodegrid_n = 'hiddenpckcode' + counter;
                                                    var ediname_n = 'edit' + counter;
                                                    var res = QBC.getEditionCount(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid_n).value, document.getElementById(ediname_n).value);
                                                    var edi_cou = res.value;
                                                    eyecatchRate = parseFloat(eyecatchRate);// / parseFloat(edi_cou);
                                                    eyecatchRate_tot = parseFloat(eyecatchRate_tot);// / parseFloat(edi_cou);
                                                }
                                                grossamtfinal = parseFloat(grossamtfinal) + parseFloat(eyecatchRate);


                                                grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) + parseFloat(eyecatchRate_tot);

                                                gross.value = parseFloat(gross.value) + parseFloat(eyecatchRate);
                                            }
                                            else if (eyecatchtype == 'F') {
                                                if (bPrem.indexOf('%') > 0)
                                                    bPrem = bPrem.split('%')[0];
                                                eyecatchRate = parseFloat(bPrem); //parseFloat(grossamtfinal) + parseFloat(bPrem);
                                                eyecatchRate_tot = parseFloat(bPrem); //parseFloat(grossamtfinal) + parseFloat(bPrem);
                                                /////////////////////add anuja eyecather
                                                if (ds.Tables[1].Rows[edicount].BULLET != null) {
                                                    document.getElementById("eye_cather" + counter).value = ds.Tables[1].Rows[edicount].BULLET;
                                                }
                                                if (document.getElementById('hiddeneyecatchpubwise').value == "Y") {
                                                    var pkgcodegrid_n = 'hiddenpckcode' + counter;
                                                    var ediname_n = 'edit' + counter;
                                                    var res = QBC.getEditionCount(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid_n).value, document.getElementById(ediname_n).value);
                                                    var edi_cou = res.value;
                                                    eyecatchRate = parseFloat(eyecatchRate) / parseFloat(edi_cou);
                                                    eyecatchRate_tot = parseFloat(eyecatchRate_tot) / parseFloat(edi_cou);
                                                }
                                                grossamtfinal = parseFloat(grossamtfinal) + eyecatchRate;


                                                grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) + eyecatchRate_tot;
                                                gross.value = parseFloat(gross.value) + parseFloat(eyecatchRate);
                                            }
                                        }
                                    }
                                    // for insertion wise box charges
                                    //                                          if(boxchargeInsertionwise=='yes')
                                    //                                            {
                                    //                                             var tboxcharge=0;
                                    //                                                   tboxcharge=boxcharge;
                                    //                                                if(hiddenbox_vari.value=='2')
                                    //                                                {
                                    //                                                     tboxcharge=(parseFloat(gridgross) * parseFloat(boxcharge))/100;
                                    //                                                     boxcharge_tot=(parseFloat(gridgross_tot) * parseFloat(boxcharge_tot))/100;
                                    //                                                }  
                                    //                                                grossamtfinal=parseFloat(grossamtfinal) + tboxcharge;
                                    //                                                grossamtfinal_TOT=parseFloat(grossamtfinal_TOT) + boxcharge_tot;
                                    //                                                gross.value = parseFloat(gross.value) + parseFloat(tboxcharge);
                                    //                                            }
                                    gridgross = gross.value;
                                    gridgross_tot = gross.value;
                                    if (ds.Tables[2].Rows[scicount].TYPE == "per") {
                                        if (document.getElementById('hidschememin').value == "Y" && ds.Tables[1].Rows[edicount].MINWORD != null && parseInt(document.getElementById('siz' + counter).value) > parseInt(ds.Tables[1].Rows[edicount].MINWORD)) {
                                            var exrate = ds.Tables[1].Rows[edicount].FEXTRARATE;
                                            gridgross = parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) - (parseFloat(ds.Tables[1].Rows[edicount].CARDRATE) * parseFloat(ds.Tables[2].Rows[scicount].AMT) / 100);
                                            gridgross = parseFloat(gridgross) + parseFloat(exrate);
                                        }
                                        else {
                                            gridgross = parseFloat(gridgross) - (parseFloat(gridgross) * parseFloat(ds.Tables[2].Rows[scicount].AMT) / 100);
                                        }
                                        gridgross_tot = parseFloat(gridgross_tot) - (parseFloat(gridgross_tot) * parseFloat(ds.Tables[2].Rows[scicount].AMT) / 100);
                                        if (parseInt(gridgross) == 0) {
                                            freeIns = "Y";
                                            grossamtfinal = parseFloat(grossamtfinal) + parseFloat(gridgross + dayrateprem); //+gridgross;
                                            grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) + parseFloat(gridgross_tot + dayrateprem); //+gridgross;
                                            gridgross = parseFloat(gridgross + dayrateprem);
                                            gridgross_tot = parseFloat(gridgross_tot + dayrateprem);
                                        }
                                        else {
                                            grossamtfinal = parseFloat(grossamtfinal) + parseFloat(gridgross); //+gridgross;
                                            grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) + parseFloat(gridgross_tot); //+gridgross;
                                        }
                                        //agreed rate
                                        gross.value = gridgross.toFixed(2);
                                    }
                                    else {
                                        var schratio = 0;
                                        if (gridItemTotal == 0) {
                                            for (var f = 0; f < ds.Tables[1].Rows.length; f++) {
                                                if (pkgcode.value == ds.Tables[1].Rows[f].PCODE)
                                                    gridItemTotal = gridItemTotal + ds.Tables[1].Rows[f].FCARDRATE;
                                            }

                                        }
                                        schratio = (parseFloat(ds.Tables[2].Rows[scicount].AMT) / parseFloat(gridItemTotal)) * parseFloat(ds.Tables[1].Rows[edicount].FCARDRATE);
                                        grossamtfinal = parseFloat(grossamtfinal) + (parseFloat(gridgross) - parseFloat(schratio));
                                        grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) + (parseFloat(gridgross_tot) - parseFloat(schratio));
                                        if (document.getElementById('hidschememin').value == "Y" && ds.Tables[1].Rows[edicount].MINWORD != null && parseInt(document.getElementById('siz' + counter).value) > parseInt(ds.Tables[1].Rows[edicount].MINWORD)) {
                                            var exrate = ds.Tables[1].Rows[edicount].FEXTRARATE;
                                            gross.value = parseFloat(gridgross) - parseFloat(schratio);
                                            gross.value = parseFloat(gross.value) + parseFloat(exrate);
                                        }
                                        else {
                                            gross.value = parseFloat(gridgross) - parseFloat(schratio);
                                        }
                                        gridItemTotal = 0;
                                    }

                                    if (paidno != null && ds.Tables[2].Rows[scicount].TYPE == "per" && ds.Tables[2].Rows[scicount].AMT == "100") {
                                        if (paidno.value != "P")
                                            paidno.value = 'N';
                                    }
                                    else if (paidno != null) {
                                        paidno.value = 'Y';
                                    }
                                    scheme = 'Y';
                                    edicount = gridItemCount;
                                    if (i == 0) {
                                        if (uomdesc == 'CD') {
                                            cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[edicount].CARDRATE);
                                        }
                                        else {
                                            cardrate = parseFloat(cardrate) + parseFloat(ds.Tables[1].Rows[edicount].CARDRATE);
                                        }
                                    }
                                    break;
                                }  //----5-----------

                            }    //----4-----------   
                            //----3-----------  
                            if (scheme == '') { //////////////////////////////////////////anuja////////
                                if (uomdesc == 'CD') {
                                    cardid.value = ds.Tables[1].Rows[edicount].CARDRATE;
                                    solo.value = ds.Tables[1].Rows[edicount].CARDRATE;
                                }
                                else {
                                    cardid.value = ds.Tables[1].Rows[edicount].CARDRATE;
                                    solo.value = ds.Tables[1].Rows[edicount].CARDRATE;
                                }
                                var gridgross = 0;
                                var gridgross_tot = 0;
                                cardamt = parseFloat(cardamt) + parseFloat(ds.Tables[1].Rows[edicount].FCARDRATE);
                                gridgross = gross.value = ds.Tables[1].Rows[edicount].FCARDRATE;
                                gridgross_tot = gross.value = ds.Tables[1].Rows[edicount].FCARDRATE;
                                //////                                    if(gross.value!="")
                                //////                                    {
                                //////                                        gross.value=parseFloat(gross.value) - (parseFloat(gross.value) * COMM_RATE/100);
                                //////                                        var ADD_COMM_RATE=0;
                                //////                                        if(ds.Tables[3].Rows.length>0 && ds.Tables[3].Rows[0].ADD_COMM_RATE!=undefined && ds.Tables[3].Rows[0].ADD_COMM_RATE!="undefined")
                                //////                                        {
                                //////                                         ADD_COMM_RATE=ds.Tables[3].Rows[0].ADD_COMM_RATE;
                                //////                                        } 
                                //////                                        if(ADD_COMM_RATE!=undefined && ADD_COMM_RATE!="undefined")
                                //////                                        {
                                //////                                           gross.value=parseFloat(gross.value) - (parseFloat(gross.value) * ADD_COMM_RATE/100);
                                //////                                        }  
                                //////                                        gridgross=gross.value;
                                //////                                    }   
                                grossamtfinal = parseFloat(grossamtfinal) + parseFloat(gridgross);
                                grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) + parseFloat(gridgross_tot);
                                if (ds.Tables[1].Rows[edicount].BULLET != undefined && ds.Tables[1].Rows[edicount].BULLET != "undefined" && ds.Tables[1].Rows[edicount].BULLET != null && ds.Tables[1].Rows[edicount].BULLET != "0") {
                                    bPrem = ds.Tables[1].Rows[edicount].BULLET;
                                }
                                /////////////////add by anuja
                                var dayrateprem = 0;
                                if (ds.Tables[1].Rows[edicount].CARDRATE_WOUT_PREM != null && ds.Tables[1].Rows[edicount].CARDRATE_WOUT_PREM != "0") {
                                    dayrateprem = ds.Tables[1].Rows[edicount].CARDRATE_WOUT_PREM;
                                    document.getElementById("hdnday_prim" + counter).value = ds.Tables[1].Rows[edicount].CARDRATE_WOUT_PREM;
                                }
                                var solbu = solo.value;
                                if (ds.Tables[1].Rows[edicount].MINWORD != null && parseInt(document.getElementById('siz' + counter).value) > parseInt(ds.Tables[1].Rows[edicount].MINWORD)) {
                                    solbu = parseFloat(solbu) + parseFloat(ds.Tables[1].Rows[edicount].FEXTRARATE);
                                }
                                /////////////////////////end 
                                if (bullet_var.value != '0') {
                                    if (eyecatchtype != 'S') {
                                        if (eyecatchtype == 'P') {
                                            if (bPrem.indexOf('%') > 0)
                                                bPrem = bPrem.split('%')[0]
                                            eyecatchRate = (parseFloat(solbu - dayrateprem) * parseFloat(bPrem)) / 100;
                                            eyecatchRate_tot = (parseFloat(solbu - dayrateprem) * parseFloat(bPrem)) / 100;
                                            /////////////////////add anuja eyecather
                                            if (ds.Tables[1].Rows[edicount].BULLET != null) {
                                                document.getElementById("eye_cather" + counter).value = ds.Tables[1].Rows[edicount].BULLET;
                                            }
                                            if (document.getElementById('hiddeneyecatchpubwise').value == "Y") {
                                                var pkgcodegrid_n = 'hiddenpckcode' + counter;
                                                var ediname_n = 'edit' + counter;
                                                var res = QBC.getEditionCount(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid_n).value, document.getElementById(ediname_n).value);
                                                var edi_cou = res.value;
                                                eyecatchRate = parseFloat(eyecatchRate);// / parseFloat(edi_cou);
                                                eyecatchRate_tot = parseFloat(eyecatchRate_tot);// / parseFloat(edi_cou);
                                            }

                                            gross.value = parseFloat(gross.value) + parseFloat(eyecatchRate);
                                            grossamtfinal = parseFloat(grossamtfinal) + parseFloat(eyecatchRate);
                                            grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) + parseFloat(eyecatchRate_tot);
                                        }
                                        else if (eyecatchtype == 'F') {
                                            if (bPrem.indexOf('%') > 0)
                                                bPrem = bPrem.split('%')[0]
                                            eyecatchRate = parseFloat(bPrem); //parseFloat(gridgross) + parseFloat(bPrem);
                                            eyecatchRate_tot = parseFloat(bPrem); //parseFloat(gridgross) + parseFloat(bPrem);
                                            /////////////////////add anuja eyecather
                                            if (ds.Tables[1].Rows[edicount].BULLET != null) {
                                                document.getElementById("eye_cather" + counter).value = ds.Tables[1].Rows[edicount].BULLET;
                                            }
                                            if (document.getElementById('hiddeneyecatchpubwise').value == "Y") {
                                                var pkgcodegrid_n = 'hiddenpckcode' + counter;
                                                var ediname_n = 'edit' + counter;
                                                var res = QBC.getEditionCount(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid_n).value, document.getElementById(ediname_n).value);
                                                var edi_cou = res.value;
                                                eyecatchRate = parseFloat(eyecatchRate) / parseFloat(edi_cou);
                                                eyecatchRate_tot = parseFloat(eyecatchRate_tot) / parseFloat(edi_cou);
                                            }

                                            grossamtfinal = parseFloat(grossamtfinal) + eyecatchRate;
                                            grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) + eyecatchRate_tot;
                                            gross.value = parseFloat(gross.value) + parseFloat(eyecatchRate);
                                        }
                                    }
                                }
                                // for insertion wise Box Charges 
                                //                                     if(boxchargeInsertionwise=='yes')
                                //                                    {
                                //                                     var tboxcharge=0;
                                //                                           tboxcharge=boxcharge;
                                //                                        if(hiddenbox_vari.value=='2')
                                //                                        {
                                //                                             tboxcharge=(parseFloat(gridgross) * parseFloat(boxcharge))/100;
                                //                                             boxcharge_tot=(parseFloat(gridgross_tot) * parseFloat(boxcharge_tot))/100;
                                //                                        }  
                                //                                        grossamtfinal=parseFloat(grossamtfinal) + tboxcharge;
                                //                                        grossamtfinal_TOT=parseFloat(grossamtfinal_TOT) + boxcharge_tot;
                                //                                        gross.value = parseFloat(gross.value) + parseFloat(tboxcharge);
                                //                                    }
                                //                                    

                                if (i == 0) {
                                    if (uomdesc == 'CD') {
                                        cardrate = parseFloat(cardrate) + ds.Tables[1].Rows[edicount].CARDRATE;
                                    }
                                    else {
                                        cardrate = parseFloat(cardrate) + ds.Tables[1].Rows[edicount].CARDRATE;
                                    }
                                }
                                var grossValue = parseFloat(gross.value);
                                gross.value = grossValue.toFixed(2);
                                edicount = gridItemCount;
                                // break;

                            }
                            if (insertsta.value == 'cancel') {
                                gross.value = 0;
                                freeIns = "Y";
                                if (boxchargeInsertionwise == 'yes') {
                                    grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(gridgross) + parseFloat(eyecatchRate) + parseFloat(boxcharge));
                                    grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) - (parseFloat(gridgross_tot) + parseFloat(eyecatchRate_tot) + parseFloat(boxcharge_tot));
                                }
                                else {
                                    grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(gridgross) + parseFloat(eyecatchRate));
                                    grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) - (parseFloat(gridgross_tot) + parseFloat(eyecatchRate_tot));
                                }
                                var paidno = "pai" + counter;
                                if (paidno != null) {
                                    paidno.value = 'N';
                                }
                            }
                            else if (paidno != null) {
                                if (paidno.value == 'N') {
                                    //                                    if (document.getElementById('hidschememin').value != "Y")
                                    //                                        gross.value = 0;
                                    if (boxchargeInsertionwise == 'yes') {
                                        grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(eyecatchRate) + parseFloat(boxcharge));
                                        grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) - (parseFloat(eyecatchRate_tot) + parseFloat(boxcharge_tot));
                                    }
                                    else {
                                        grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(eyecatchRate));
                                        grossamtfinal_TOT = parseFloat(grossamtfinal_TOT) - (parseFloat(eyecatchRate_tot));
                                    }
                                }
                            }
                            if (paidno.value != 'N')
                                cardrateSum = parseFloat(cardrateSum) + parseFloat(cardid.value);
                            else if (insertsta.value == 'cancel')
                                cardrateSum = parseFloat(cardrateSum) + parseFloat(cardid.value);
                            if (gross.value != "" && billv != null) {
                                if (document.getElementById('chktrade').checked == true)
                                    billv.value = parseFloat(gross.value) - (parseFloat(gross.value) * COMM_RATE / 100);
                                else
                                    billv.value = parseFloat(gross.value);
                                var ADD_COMM_RATE = 0;
                                if (ds.Tables[3].Rows.length > 0 && ds.Tables[3].Rows[0].ADD_COMM_RATE != undefined && ds.Tables[3].Rows[0].ADD_COMM_RATE != "undefined") {
                                    ADD_COMM_RATE = ds.Tables[3].Rows[0].ADD_COMM_RATE;
                                }
                                if (ADD_COMM_RATE != undefined && ADD_COMM_RATE != "undefined") {
                                    billv.value = parseFloat(billv.value) - (parseFloat(billv.value) * ADD_COMM_RATE / 100);
                                }
                                if (document.getElementById('hiddenbooktype').value == "2" || document.getElementById('hiddenbooktype').value == "4" || document.getElementById('hiddenbooktype').value == "5") {
                                    billv.value = "0";
                                }
                            }
                            counter++;
                        }

                    }
                }
                // END


            }
            else {
                alert(ds.Tables[0].Rows[0].MESSAGE);
                return false;
            }

        }

    }
    if (scheme_var_n != "" && scheme_var.value == "") {
        scheme_var.value = scheme_var_n;
    }
    if (freeIns == "Y") {
        document.getElementById('txtpaid').value = parseInt(document.getElementById('txtpaid').value) - 1;
    }
    //    if(hiddenbox_vari!=null)
    //    {
    //        if(boxchargeInsertionwise=='no')
    //        {
    //          if(hiddenbox_vari.value=='2')
    //          {
    //              boxcharge=(parseFloat(grossamtfinal) * parseFloat(boxcharge))/100;
    //              boxcharge_tot=(parseFloat(grossamtfinal_TOT) * parseFloat(boxcharge_tot))/100;
    //          }
    //           grossamtfinal=parseFloat(grossamtfinal) + parseFloat(boxcharge);   
    //           grossamtfinal_TOT=parseFloat(grossamtfinal_TOT) + parseFloat(boxcharge_tot);   
    //        }
    //     }
    document.getElementById('hiddencardamt').value = cardamt.toFixed(2); ;
    document.getElementById('hiddengross').value = grossamtfinal_TOT.toFixed(2);
    document.getElementById('txttotalamt').value = document.getElementById('hiddengross').value;
    if (ds.Tables[3].Rows.length > 0) {
        var COMM_RATE = ds.Tables[3].Rows[0].COMM_RATE;
        if (COMM_RATE != undefined && COMM_RATE != "undefined" && document.getElementById('chktrade').checked == true) {
            grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(grossamtfinal) * COMM_RATE / 100);
        }
        var ADD_COMM_RATE = ds.Tables[3].Rows[0].ADD_COMM_RATE;
        if (ADD_COMM_RATE != undefined && ADD_COMM_RATE != "undefined") {
            grossamtfinal = parseFloat(grossamtfinal) - (parseFloat(grossamtfinal) * ADD_COMM_RATE / 100);
        }
    }
    document.getElementById('txtgrossamt').value = grossamtfinal.toFixed(2);

    // for agreed amount ration
    getAgreedRation(cardrateSum);
    if (document.getElementById('configclient').value == "BHASKAR")
        roundTotal();
    if (document.getElementById('hiddenbooktype').value == "2" || document.getElementById('hiddenbooktype').value == "4" || document.getElementById('hiddenbooktype').value == "5") {
        document.getElementById('txtgrossamt').value = "0";
    }
    document.getElementById('hiddengross').value = document.getElementById('txttotalamt').value;
    document.getElementById('txtcardrate').value = cardrate.toFixed(2);

    // Bill Calculation
    // return false;
}

function getAgreedRation(cardrateSum) {
    if (document.getElementById('hiddenagreedamt').value != '' && document.getElementById('hiddenagreedamt').value != '0') {
        var grossTot = 0;
        billamount = 0;
        var cancelAmount = 0;
        var cancelBillAmount = 0;

        var rowcount = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
        for (k1 = 0; k1 < rowcount; k1++) {
            var cardid = "card" + k1;
            var insertsta = document.getElementById("inssta" + k1);
            var paidno = document.getElementById("pai" + k1);
            var insertsta = document.getElementById("inssta" + k1);
            var billrate = document.getElementById("ba" + k1);
            if (paidno.value != 'N' && insertsta.value != 'cancel') {
                var gross = (parseFloat(document.getElementById(cardid).value) / parseFloat(cardrateSum)) * parseFloat(document.getElementById('hiddenagreedamt').value);
                var diff = (parseFloat(document.getElementById('hiddenagreedamt').value) - parseFloat(cancelAmount)) - (parseFloat(grossTot) + parseFloat(gross));
                diff = (parseFloat(diff)).toFixed(2);
                if (parseFloat(diff) < 1 && parseFloat(diff) >= 0) {
                    if (insertsta.value != "billed")
                        document.getElementById("gro" + k1).value = ((parseFloat(document.getElementById('hiddenagreedamt').value) - parseFloat(cancelAmount)) - parseFloat(grossTot)).toFixed(2);
                    grossTot = parseFloat(grossTot) + parseFloat(document.getElementById("gro" + k1).value);
                }
                else if (k1 == parseInt(rowcount) - 1) {
                    if (insertsta.value != "billed")
                        document.getElementById("gro" + k1).value = ((parseFloat(document.getElementById('hiddenagreedamt').value) - parseFloat(cancelAmount)) - parseFloat(grossTot)).toFixed(2);
                    grossTot = parseFloat(grossTot) + parseFloat(document.getElementById("gro" + k1).value);
                }
                else {
                    if (document.getElementById(cardid) != null) {
                        if (insertsta.value != "billed")
                            document.getElementById("gro" + k1).value = (gross).toFixed(2);
                        grossTot = parseFloat(grossTot) + parseFloat(document.getElementById("gro" + k1).value);
                    }
                }
                // for billing calculation
                var tradisc = tradedisc;
                if (document.getElementById('chktrade').checked == false)
                    tradisc = 0;
                if (tradisc == "")
                    tradisc = 0;
                var trdisc1 = tradisc;
                var addcomm = 0;

                if (addcomm == "") {
                    addcomm = "0";
                }
                if (addcomm != "0") {
                    trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                }
                var billamt = 0;
                var agncomm_seq_com = 'S';
                if (agncomm_seq_com != "S")
                    billamt = parseFloat(document.getElementById("gro" + k1).value) - (parseFloat(document.getElementById("gro" + k1).value) * parseFloat(trdisc1) / 100);
                else {
                    billamt = parseFloat(document.getElementById("gro" + k1).value) - parseFloat(document.getElementById("gro" + k1).value) * parseFloat(tradisc) / 100;
                    if (addcomm != "0" && addcomm != "") {
                        billamt = parseFloat(billamt) - parseFloat(billamt) * parseFloat(addcomm) / 100;
                    }
                }

                if (insertsta.value != "billed")
                    billrate.value = billamt.toFixed(2);

                //  if(billrate.value!="" &&  counter !=parseInt(rowcount)-1)
                /// {
                billamount = parseFloat(billamount) + parseFloat(billrate.value);
                //  }   
                if (document.getElementById('hiddenbooktype').value == "2" || document.getElementById('hiddenbooktype').value == "4" || document.getElementById('hiddenbooktype').value == "5") {
                    if (insertsta.value != "billed")
                        billrate.value = 0;
                }
            }
            else {
                if (insertsta.value == 'cancel') {
                    cancelAmount = parseFloat(cancelAmount) + ((parseFloat(document.getElementById(cardid).value) / parseFloat(cardrateSum)) * parseFloat(document.getElementById('hiddenagreedamt').value));
                }
                if (insertsta.value != "billed") {
                    document.getElementById("gro" + k1).value = 0;
                    billrate.value = 0;
                }
            }
        }
        document.getElementById('txttotalamt').value = parseFloat(grossTot).toFixed(2);
        document.getElementById('txtgrossamt').value = parseFloat(billamount).toFixed(2);
    }
}
function getclientcode() {
    var clientname = document.getElementById('txtclient').value;
    var client_split;
    if (clientname.indexOf("(") >= 0) {
        clientname = clientname.split("(");
        client_split = clientname[1];
        client_split = client_split.replace(")", "");
        clientname = client_split;
    }
    return clientname;
}

function date_frmt_orcl(dateformat, value1) {
    var dd = "";
    var mm = "";
    var yy = "";
    var newdate = "";
    var dateformat = document.getElementById('hiddendateformat').value;
    if (dateformat == "dd/mm/yyyy") {
        var arrvalue1 = value1.split('/');
        dd = arrvalue1[0];
        mm = arrvalue1[1];
        yy = arrvalue1[2];
    }
    else if (dateformat == "mm/dd/yyyy") {
        var arrvalue1 = value1.split('/');
        dd = arrvalue1[1];
        mm = arrvalue1[0];
        yy = arrvalue1[2];
    }
    else if (dateformat == "yyyy/mm/dd") {
        var arrvalue1 = value1.split('/');
        dd = arrvalue1[2];
        mm = arrvalue1[1];
        yy = arrvalue1[0];
    }

    if (document.getElementById('hiddenconnect').value == "orcl") {
        mm = getmonthstr(mm);
        newdate = dd + "-" + mm + "-" + yy;
    }
    else
        newdate = yy + "-" + mm + "-" + dd;

    return newdate;
}

function mySqlDate(value1) {
    var dateformat = document.getElementById('hiddendateformat').value;
    var newdate = value1;
    if (dateformat == "dd/mm/yyyy") {
        var arrvalue1 = newdate.split('/');
        dd = arrvalue1[0];
        mm = arrvalue1[1];
        yy = arrvalue1[2];
    }
    else if (dateformat == "mm/dd/yyyy") {
        var arrvalue1 = newdate.split('/');
        dd = arrvalue1[1];
        mm = arrvalue1[0];
        yy = arrvalue1[2];
    }
    else if (dateformat == "yyyy/mm/dd") {
        var arrvalue1 = newdate.split('/');
        dd = arrvalue1[2];
        mm = arrvalue1[1];
        yy = arrvalue1[0];
    }
    if (document.getElementById('hiddenconnect').value == "mysql") {
        /* var arrvalue1=value1.split('-');
        dd=arrvalue1[0];
        mm=arrvalue1[1];
        yy=arrvalue1[2];  */
        //mm=getmonthstrNumber(mm);
        //  newdate=yy + "-" + mm + "-" + dd;
        newdate = yy + "/" + mm + "/" + dd;
    }
    return newdate;
}


function getmonthstrNumber(m_value) {
    var month = "";
    switch (m_value) {
        case "Jan":
            month = "01";
            break;

        case "Feb":
            month = "02";
            break;

        case "Mar":
            month = "03";
            break;

        case "Apr":
            month = "04";
            break;

        case "May":
            month = "05";
            break;

        case "Jun":
            month = "06";
            break;

        case "Jul":
            month = "07";
            break;

        case "Aug":
            month = "08";
            break;

        case "Sep":
            month = "09";
            break;

        case "Oct":
            month = "10";
            break;

        case "Nov":
            month = "11";
            break;

        case "Dec":
            month = "12";
            break;

        ////////////////      


    }

    return month;
}
function getmonthstr(m_value) {
    var month = "";
    switch (m_value) {
        case "1":
            month = "JAN";
            break;

        case "2":
            month = "FEB";
            break;

        case "3":
            month = "MAR";
            break;

        case "4":
            month = "APR";
            break;

        case "5":
            month = "MAY";
            break;

        case "6":
            month = "JUN";
            break;

        case "7":
            month = "JUL";
            break;

        case "8":
            month = "AUG";
            break;

        case "9":
            month = "SEP";
            break;

        case "10":
            month = "OCT";
            break;

        case "11":
            month = "NOV";
            break;

        case "12":
            month = "DEC";
            break;

        ////////////////      

        case "01":
            month = "JAN";
            break;

        case "02":
            month = "FEB";
            break;

        case "03":
            month = "MAR";
            break;

        case "04":
            month = "APR";
            break;

        case "05":
            month = "MAY";
            break;

        case "06":
            month = "JUN";
            break;

        case "07":
            month = "JUL";
            break;

        case "08":
            month = "AUG";
            break;

        case "09":
            month = "SEP";
            break;
    }

    return month;
}
function buttonprevQBC() {
    document.getElementById('btnok').disabled = true;
    //alert(document.getElementById('editordiv').value);
    //**********************By Manish Verma***********************************************************
    //alert(document.getElementById('editordiv').innerText);
    //alert(document.getElementById('editordiv').length);if(browser
    //debugger;
    //alert("HI");
    /*change ankur*/
    //////for rol only no 2 white spaces allowed

    if (browser != "Microsoft Internet Explorer") {
        //document.getElementById('editordiv').value=trim(document.getElementById('editordiv').value);
        if (document.getElementById('editordiv').value == "") {
            alert("Please type the matter");
            document.getElementById('editordiv').focus();
            return false;
        }
    }
    else {
        //document.getElementById('editordiv').innerText=trim(document.getElementById('editordiv').innerText);
        if (document.getElementById('editordiv').innerText == "") {
            alert("Please type the matter");
            document.getElementById('editordiv').focus();
            return false;
        }
    }



    /*new change ankur sharma*/
    var temp = "@";
    var orignal_text = "@";
    var matter_textstring = "";
    if (document.getElementById('hiddenuom_desc').value == "ROL") {
        if (browser != "Microsoft Internet Explorer") {
            matter_textstring = document.getElementById('editordiv').value;

        }
        else {
            matter_textstring = document.getElementById('editordiv').innerText;

        }
        // matter_textstring=matter_textstring.replace("&","^");
        //                     matter_textstring=matter_textstring.split(" ");
        //                     var ij;
        //                     
        //                     var orignal_len
        //                     for(ij=0;ij < matter_textstring.length;ij++)
        //                     {
        //                        orignal_len=orignal_text.split(" ");
        //                        if(matter_textstring[ij]=="" && orignal_text.length>0)
        //                        {
        //                            if(orignal_len[orignal_len.length-1]=="")
        //                            {
        //                            
        //                            }
        //                            else
        //                            {
        //                                //orignal_text=orignal_text+" "+matter_textstring[ij];
        //                                if(orignal_text=="@")
        //                                {
        //                                orignal_text="";
        //                                }
        //                                orignal_text=orignal_text+" "+matter_textstring[ij];
        //                            }
        //                            
        //                        }
        //                        else
        //                        {
        //                            if(orignal_text!="@")
        //                            {
        //                                    if(matter_textstring[ij-1]!="")
        //                                    {
        //                                        orignal_text=orignal_text+" "+matter_textstring[ij];
        //                                    }    
        //                                    else
        //                                    {
        //                                        orignal_text=orignal_text+matter_textstring[ij];
        //                                    }
        //                            }
        //                            else
        //                            {
        //                                orignal_text=matter_textstring[ij];
        //                            }
        //                        }

        //} 
        //matter_textstring=matter_textstring.replace("  ","");

        /*if(browser!="Microsoft Internet Explorer")
        {
        document.getElementById('editordiv').value=orignal_text;
             
        }
        else
        {
        document.getElementById('editordiv').innerText=orignal_text;
             
        }*/
    }

    if (browser != "Microsoft Internet Explorer") {
        if (document.getElementById('editordiv').value == "") {
            alert("Please Enter Matter");
            document.getElementById('editordiv').disabled = false;
            return false;
        }
    }
    else {
        if (document.getElementById('editordiv').innerText == "") {
            alert("Please Enter Matter");
            document.getElementById('editordiv').disabled = false;
            return false;
        }
    }
    //************************************************************************************************

    var hiddenwidth = document.getElementById('hiddenwidth').value;
    var hiddenuom = document.getElementById('hiddenuom').value;


    var matterText = ""

    if (browser != "Microsoft Internet Explorer") {
        matterText = document.getElementById('editordiv').value;
    }
    else {
        matterText = document.getElementById('editordiv').innerText;
    }
    /*new change ankur for prev*/
    //    if(matter_textstring!="")
    //    {
    //             matterText=matter_textstring;
    //    }
    var str = document.getElementById('editordiv').innerHTML;
    //var str=matterText;
    //matterText=matterText.replace("&","^");
    //////////////////

    var hiddeninsert = document.getElementById('hiddeninsert').value;
    str = str.replace("#", "^");
    //str=str.replace("&","?");

    /*new change ankur 9 feb*/
    var coltype = document.getElementById('hiddencoltype').value;
    /*new change ankur for matter*/
    var logo_name = document.getElementById('hiddenlogoname').value;
    var modify_logo = document.getElementById('hiddenmodify').value;
    ///////////////
    /*new chagne this to save the matter in session using ajax*/

    //window.open('matterpreview.aspx?insertNo='+document.getElementById('hiddenInsertNo').value+'&srno='+document.getElementById('hiddensrno').value+'&edition='+document.getElementById('hiddenedition').value+'&cioid='+document.getElementById('cioid').value+'&hiddeninsert='+hiddeninsert+'&hiddenuom='+hiddenuom+'&hiddenwidth='+hiddenwidth+'&eyecatchlen='+document.getElementById('hiddeneyecatchlength').value+'&fontsize='+document.getElementById('fnt_fntsize').value+'&fontname='+document.getElementById('fnt_fntname').value+'&eyecatch='+document.getElementById('hiddeneyecatcher').value+'&bgcolor='+document.getElementById('hiddenbgcolor').value+'&matter='+str+'&matterText='+matterText+'&coltype='+coltype+'&logo_name='+logo_name+'&modify_logo='+modify_logo,'Preview','width=250px,height=300,resizable=0,left=200,top=0,scrollbars=yes');
    /*change for oracle*/

    ////////////////
    if (clientfromconfig == "SP" || clientfromconfig == "RP") {
        editor_new.savethematterinsession(str, matterText, call_openmatterpreview);
    }
    else
        matter.savethematterinsession(str, matterText, call_openmatterpreviewQBC);

    return false;
}
function call_openmatterpreviewQBC(res) {
    var hiddeninsert = document.getElementById('hiddeninsert').value;
    var hiddenwidth = document.getElementById('hiddenwidth').value;
    var hiddenuom = document.getElementById('hiddenuom').value;
    var coltype = document.getElementById('hiddencoltype').value;
    /*new change ankur for matter*/
    var logo_name = document.getElementById('hiddenlogoname').value;
    var modify_logo = document.getElementById('hiddenmodify').value;

    var logohei = document.getElementById('hiddenlogohei').value;
    var logowid = document.getElementById('hiddenlogowid').value;
    /*mysql*/
    var previd = document.getElementById('hiddenpreviousid').value;
    var index = window.opener.document.getElementById('drpcolor').selectedIndex;
    var textcolor = '';
    if (index != -1)
        textcolor = window.opener.document.getElementById('drpcolor').options[index].text;
    var language = '';
    var fntname = '';
    if (document.getElementById('CmbLanguage') != null) {
        language = document.getElementById('CmbLanguage').value
        fntname = document.getElementById('KEYBORD').value
    }
    if (window.opener.document.getElementById('drpboxcodenew') != null) {
        var boxcode = window.opener.document.getElementById('drpboxcodenew').value;
    }
    var boxno = window.opener.document.getElementById('txtboxnonew').value;

    // var boxno=window.opener.document.getElementById('txtreceipt').value
    var eyecatchtype = document.getElementById('hiddeneyecatchval').value;
    var bPrem = document.getElementById('hiddenbPrem').value;
    if (clientfromconfig == "SP") {
        if (logo_name == "") {
            var rono1 = window.opener.document.getElementById('txtrono').value;
            var agencycode1 = window.opener.document.getElementById('txtagency').value.substring(window.opener.document.getElementById('txtagency').value.lastIndexOf('(') + 1, window.opener.document.getElementById('txtagency').value.length + window.opener.document.getElementById('txtagency').value.lastIndexOf('('));
            agencycode1 = agencycode1.replace(")", "");
            window.open('matterprev.aspx?bPrem=' + bPrem + '&eyecatchtype=' + eyecatchtype + '&insertNo=' + document.getElementById('hiddenInsertNo').value + '&srno=' + document.getElementById('hiddensrno').value + '&edition=' + document.getElementById('hiddenedition').value + '&cioid=' + document.getElementById('cioid').value + '&hiddeninsert=' + hiddeninsert + '&hiddenuom=' + hiddenuom + '&hiddenwidth=' + hiddenwidth + '&eyecatchlen=' + document.getElementById('hiddeneyecatchlength').value + '&eyecatch=' + document.getElementById('hiddeneyecatcher').value + '&bgcolor=' + document.getElementById('hiddenbgcolor').value + '&coltype=' + coltype + '&logo_name=' + logo_name + '&modify_logo=' + modify_logo + '&logohei=' + logohei + '&logowid=' + logowid + '&previd=' + previd + '&txtcolor=' + textcolor + '&language=' + language + '&fntname=' + fntname + '&boxcode=' + boxcode + '&boxno=' + boxno + '&rono1=' + rono1 + '&agencycode1=' + agencycode1, 'Preview', 'width=40000px,height=300,resizable=0,left=200,top=0,scrollbars=yes');

        }
        else {
            window.open('matterprev_new.aspx?bPrem=' + bPrem + '&eyecatchtype=' + eyecatchtype + '&insertNo=' + document.getElementById('hiddenInsertNo').value + '&srno=' + document.getElementById('hiddensrno').value + '&edition=' + document.getElementById('hiddenedition').value + '&cioid=' + document.getElementById('cioid').value + '&hiddeninsert=' + hiddeninsert + '&hiddenuom=' + hiddenuom + '&hiddenwidth=' + hiddenwidth + '&eyecatchlen=' + document.getElementById('hiddeneyecatchlength').value + '&eyecatch=' + document.getElementById('hiddeneyecatcher').value + '&bgcolor=' + document.getElementById('hiddenbgcolor').value + '&coltype=' + coltype + '&logo_name=' + logo_name + '&modify_logo=' + modify_logo + '&logohei=' + logohei + '&logowid=' + logowid + '&previd=' + previd + '&txtcolor=' + textcolor + '&language=' + language + '&fntname=' + fntname + '&boxcode=' + boxcode + '&boxno=' + boxno, 'Preview', 'width=40000px,height=300px,resizable=0,left=200,top=0,scrollbars=yes');
        }
    }
    else {
        window.open('matterprev.aspx?bPrem=' + bPrem + '&eyecatchtype=' + eyecatchtype + '&insertNo=' + document.getElementById('hiddenInsertNo').value + '&srno=' + document.getElementById('hiddensrno').value + '&edition=' + document.getElementById('hiddenedition').value + '&cioid=' + document.getElementById('cioid').value + '&hiddeninsert=' + hiddeninsert + '&hiddenuom=' + hiddenuom + '&hiddenwidth=' + hiddenwidth + '&eyecatchlen=' + document.getElementById('hiddeneyecatchlength').value + '&eyecatch=' + document.getElementById('hiddeneyecatcher').value + '&bgcolor=' + document.getElementById('hiddenbgcolor').value + '&coltype=' + coltype + '&logo_name=' + logo_name + '&modify_logo=' + modify_logo + '&logohei=' + logohei + '&logowid=' + logowid + '&previd=' + previd + '&txtcolor=' + textcolor + '&language=' + language + '&fntname=' + fntname + '&boxcode=' + boxcode + '&boxno=' + boxno, 'Preview', 'width=25000px,height=300,resizable=0,left=200,top=0,scrollbars=yes');
    }
    // window.open('matterprev.aspx?insertNo='+document.getElementById('hiddenInsertNo').value+'&srno='+document.getElementById('hiddensrno').value+'&edition='+document.getElementById('hiddenedition').value+'&cioid='+document.getElementById('cioid').value+'&hiddeninsert='+hiddeninsert+'&hiddenuom='+hiddenuom+'&hiddenwidth='+hiddenwidth+'&eyecatchlen='+document.getElementById('hiddeneyecatchlength').value+'&eyecatch='+document.getElementById('hiddeneyecatcher').value+'&bgcolor='+document.getElementById('hiddenbgcolor').value+'&coltype='+coltype+'&logo_name='+logo_name+'&modify_logo='+modify_logo+'&logohei='+logohei+'&logowid='+logowid+'&previd='+previd+'&txtcolor='+textcolor+'&language='+language+'&fntname='+fntname,'Preview','width=250px,height=300,resizable=0,left=200,top=0,scrollbars=yes');

    // window.open('matterprev.aspx?insertNo='+document.getElementById('hiddenInsertNo').value+'&srno='+document.getElementById('hiddensrno').value+'&edition='+document.getElementById('hiddenedition').value+'&cioid='+document.getElementById('cioid').value+'&hiddeninsert='+hiddeninsert+'&hiddenuom='+hiddenuom+'&hiddenwidth='+hiddenwidth+'&eyecatchlen='+document.getElementById('hiddeneyecatchlength').value+'&eyecatch='+document.getElementById('hiddeneyecatcher').value+'&bgcolor='+document.getElementById('hiddenbgcolor').value+'&coltype='+coltype+'&logo_name='+logo_name+'&modify_logo='+modify_logo+'&logohei='+logohei+'&logowid='+logowid+'&previd='+previd+'&txtcolor='+textcolor,'Preview','width=250px,height=300,resizable=0,left=200,top=0,scrollbars=yes');

}
function checkGridDate_Validation() {
    if (document.getElementById('bookdiv') == null)
        return false;
    var rowcount = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
    var len = "bookdiv";
    var id;
    var height;
    var width;
    var pagepost;
    var matsta;
    var insertsta;
    var editdate;
    var size;
    var inserts;
    var idNum = 0;
    var adsize1_var = document.getElementById('txtadsize1');
    var adsize2_var = document.getElementById('txtadsize2');
    var gross_var = document.getElementById('txtgrossamt');
    var ratecode_var = document.getElementById("txtratecode");
    var dateformat = document.getElementById("hiddendateformat").value;

    for (var itemCount = 0; itemCount < parseInt(rowcount); itemCount++) {
        id = "Text" + idNum;
        height = "hei" + idNum;
        width = "wid" + idNum;
        pagepost = "pagpos" + idNum;
        matsta = "mat" + idNum;
        insertsta = "inssta" + idNum;
        cardid = "card" + idNum;
        editid = "edit" + idNum;
        editdate = "Text" + idNum;
        size = "siz" + idNum;
        inserts = "ins" + idNum;
        var file_nam = "fil" + idNum;
        var noofcol = "nocol" + idNum;
        var alertLine = parseInt(itemCount) + 1;
        var id_var;
        var height_var;
        var width_var;
        var noofcol_var;
        var size_var;
        var insertsta_var;
        var par1;
        id_var = document.getElementById(id);
        par1 = (id_var.parentNode).parentNode;
        if (browser != "Microsoft Internet Explorer") {


            //height_var=document.getElementById(height);
            height_var = document.getElementById(height);



            //width_var=document.getElementById(width);
            width_var = document.getElementById(width);


            //noofcol_var=document.getElementById(noofcol);
            noofcol_var = document.getElementById(noofcol);


            //size_var=document.getElementById(size);
            size_var = document.getElementById(size);


            //insertsta_var=document.getElementById(insertsta);
            insertsta_var = document.getElementById(insertsta);

        }
        else {
            height_var = par1.all[height];



            //width_var=document.getElementById(width);
            width_var = par1.all[width];


            //noofcol_var=document.getElementById(noofcol);
            noofcol_var = par1.all[noofcol];


            //size_var=document.getElementById(size);
            size_var = par1.all[size];


            //insertsta_var=document.getElementById(insertsta);
            insertsta_var = par1.all[insertsta];
        }



        if (id_var.value == "") {
            alert("Please Fill the insertion date for Item Line " + alertLine);
            id_var.focus();
            gross_var.value = '';
            return false;
        }
        else if (id_var.value != "") {
            var c = chkDateforGrid_QBC(id);
            if (c == false) {

                alert(" Please Fill The Date In " + dateformat + " Format");
                document.getElementById(id).value = "";
                document.getElementById(id).focus();
                return false;
            }



        }
        if (height_var.value == "" && adsize1_var.disabled == false) {
            alert("Please fill height for Item Line " + alertLine);
            return false;
            if (ratecode_var.value == "0") {
                alert("Please Select RateCode");
                return false;
            }
        }
        else if (insertsta_var.value == "" || insertsta_var.value == "0") {
            alert("Please select insertion status for  Item Line " + alertLine);
            insertsta_var.focus();
            return false;

        }
        else if ((width_var.value == "" && noofcol_var.value == "") && adsize2_var.disabled == false) {
            alert("Please fill width or Columns for Item Line " + alertLine);
            gross_var.value = '';
            return false;
        }
        else if (size_var.value == "") {
            alert("Please fill size for Item Line " + alertLine);
            gross_var.value = '';
            document.getElementById("txttotalarea").focus();
            return false;
        }
        idNum = idNum + 1;
    }
    //changePkgCode();
    if (document.getElementById('configclient').value == "BHASKAR") {
        var res = checkContiniuity();
        if (res == false)
            return false;
    }
    if (document.getElementById('drpcoutype').value != "0" && document.getElementById('drpcoutype').value != "" && document.getElementById('txtcouno').value == "") {
        alert("Please Enter CPN No.");
        document.getElementById('txtcouno').focus();
        return false;
    }
    var rescou = QBC.chkCoupan(document.getElementById('hiddencompcode').value, document.getElementById('hiddencenter').value, document.getElementById('txtcouno').value);
    var dscou = rescou.value;
    if (dscou != null && dscou.Tables.length > 0 && dscou.Tables[0].Rows.length > 0 && chkbtnStatus == "new") {
        alert("Coupan Already Used With Reference No. " + dscou.Tables[0].Rows[0].CIO_BOOKING_ID);
        return false;
    }
    var res1 = bindFinalRate();
    if (res1 == false)
        return false;
    getpackagediscount();
    getsplcharge();
    if (document.getElementById('hiddenagreedamt').value == "") {
        getspecialdisc();
        if (roundoff == "rowise") {
            var billamt = document.getElementById('txtgrossamt').value;
            var billamtA = parseFloat(document.getElementById('txtgrossamt').value) + .01;
            billamtA = Math.round(billamtA);
            var diff = parseFloat(billamtA) - parseFloat(billamt);
            document.getElementById('txtgrossamt').value = billamtA;
        }
        //return false;
    }
    else {
        document.getElementById('hiddenspedisc').value = "";
        document.getElementById('hiddenspediscper').value = "";
    }
    bindShareDisc();
    if (document.getElementById('chkcontract').checked == true && document.getElementById('txtdealrate').value != '') {
        bindContractRate();
    }
    bindVAT();
    if (ALLOWBOOKINGGST=='Y'){
        var billamttot = 0;
        var agencycodesubcode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.lastIndexOf(')'));
        var client = document.getElementById('txtclient').value.substring(document.getElementById('txtclient').value.lastIndexOf('(') + 1, document.getElementById('txtclient').value.lastIndexOf(')'));
        var res_gst = QBC.getgstcode(document.getElementById('hiddencompcode').value,agencycodesubcode,client,document.getElementById('drpuom').value,document.getElementById('hdnf2').value,document.getElementById('drpadcategory').value,document.getElementById('txtdatetime').value,"","","","","");
        var ds_GST = res_gst.value;
        if (ds_GST == null) {
            alert(res_gst.error.description);
            return false;
        }       
        var gststr="";        
        if (ds_GST.Tables.length > 0 && ds_GST.Tables[0].Rows.length > 0) {
             var SAC_CODE="" 
             var SUB_SAC_CODE="";
             var RATEDETCODE="";
             var GST_DESC_CODE="";
             var RATE="";
             var ON_AMOUNT="";
             var GST_STATE_CODE="";             
            if (ds_GST.Tables[0].Rows[0].MSG!="" && ds_GST.Tables[0].Rows[0].MSG!="NULL"  && ds_GST.Tables[0].Rows[0].MSG!=null && ds_GST.Tables[0].Rows[0].MSG!="null"){
                alert(ds_GST.Tables[0].Rows[0].MSG);
                return false;
            }
            else{
                for (var n = 0; n < document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1; n++) {
                var gstamt=0;
                var gstamt1=0;
                var gstgd1="";
                var onamt=0;
                    var billid = document.getElementById('ba' + n);
                    //var billidlocal = document.getElementById('balocal' + n);
                    var GSTAMT = document.getElementById('GSTAMT' + n);
                    var GSTGD = document.getElementById('GSTGD' + n);
                    var insertsta=document.getElementById('inssta' + n);
                    if ((insertsta.value != 'billed' || document.getElementById('hiddensupplimentflag').value != "") && insertsta.value != 'cancel'){
                     for (var n1 = 0; n1 < ds_GST.Tables[0].Rows.length; n1++) {
                        if (ds_GST.Tables[0].Rows[n1].ON_AMOUNT=='Ch')
                        {
                            onamt=parseFloat(gstamt);
                            gstamt1=((parseFloat(gstamt) * parseFloat(ds_GST.Tables[0].Rows[n1].RATE)) / 100).toFixed(2);
                            gstamt =(parseFloat(gstamt)+parseFloat(gstamt1)).toFixed(2);
                        }
                        else{
                            onamt=parseFloat(billid.value);
                            gstamt1=((parseFloat(billid.value) * parseFloat(ds_GST.Tables[0].Rows[n1].RATE)) / 100).toFixed(2);
                            gstamt =(parseFloat(gstamt)+parseFloat(gstamt1)).toFixed(2);                       
                        }
                        if (gstgd1==""){
                        gstgd1=document.getElementById('txtciobookid').value+'~'+"I"+'~'+ds_GST.Tables[0].Rows[n1].SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].SUB_SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATEDETCODE+'~'+ds_GST.Tables[0].Rows[n1].GST_DESC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATE+'~'+onamt+'~'+gstamt1+'~'+ds_GST.Tables[0].Rows[n1].GST_STATE_CODE+'~'+ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE;
                        }else{
                        gstgd1=gstgd1+'$'+document.getElementById('txtciobookid').value+'~'+"I"+'~'+ds_GST.Tables[0].Rows[n1].SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].SUB_SAC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATEDETCODE+'~'+ds_GST.Tables[0].Rows[n1].GST_DESC_CODE+'~'+ds_GST.Tables[0].Rows[n1].RATE+'~'+onamt+'~'+gstamt1+'~'+ds_GST.Tables[0].Rows[n1].GST_STATE_CODE+'~'+ds_GST.Tables[0].Rows[n1].GST_RATE_TYPE;
                        }
                     }
                     billid.value= (parseFloat(billid.value)+parseFloat(gstamt)).toFixed(2);
                     //billidlocal.value= parseFloat(billidlocal.value)+parseFloat(gstamt);
                     GSTAMT.value = parseFloat(gstamt);
                     GSTGD.value=gstgd1;
                     billamttot = (parseFloat(billamttot) + parseFloat(billid.value)).toFixed(2);
                }
                }
            }
        }
        document.getElementById('txtgrossamt').value = (parseFloat(billamttot)).toFixed(2);
    }
    /////bhanu start
    var billamt = document.getElementById('txtgrossamt').value;
    var billamtA = parseFloat(document.getElementById('txtgrossamt').value) + .01;
    billamtA = Math.round(billamtA);
    var diff = parseFloat(billamtA) - parseFloat(billamt);
    document.getElementById('txtgrossamt').value = billamtA;
    var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
    billamtA = 0;
    var f = false;

    for (var i1 = 0; i1 < count; i1++) {

        if (document.getElementById('ba' + i1).value != 0 && document.getElementById('inssta' + i1).value == "booked" && f == false) {
            document.getElementById('ba' + i1).value = parseFloat(document.getElementById('ba' + i1).value) + parseFloat(diff);
            document.getElementById('ba' + i1).value = parseFloat(document.getElementById('ba' + i1).value).toFixed(2);
            // i1=count;
            f = true;
            if (document.getElementById('hiddenboxchrgtype') != null && document.getElementById('txtboxchrg') != null && document.getElementById('txtboxchrg').value != "" && document.getElementById('txtboxchrg').value != "0") //for on gross box charges
            {
                f = true;
            }
            //     else{
            // i1=parseInt(count,10)-1;
            //  }
        }

        if (document.getElementById('drpcoutype').value != "0" && document.getElementById('drpcoutype').value != "") {
            deductCoupan(count);
        }
        if (document.getElementById('hiddenboxchrgtype') != null && (document.getElementById('txtboxchrg') != null && document.getElementById('txtboxchrg').value != "" && document.getElementById('txtboxchrg').value != "0") || (document.getElementById('drpboxcode').value != "" && document.getElementById('drpboxcode').value != "0")) //for on gross box charges
        {
            if (document.getElementById('hiddeninsertwise').value == 'no' && i1 == 0) {
                var boxcharge = 0;

                if (document.getElementById('txtboxchrg') != null)
                    boxpercen = document.getElementById('txtboxchrg').value;
                if (boxpercen != null && boxpercen != "" && boxpercen != "0") {
                    boxcharge = parseInt(boxpercen);
                }
                if (document.getElementById('hiddenboxchrgtype').value == '2') {
                    boxcharge = (parseFloat(document.getElementById('txtgrossamt').value) * parseFloat(boxcharge)) / 100;
                }
                document.getElementById('txtgrossamt').value = parseFloat(document.getElementById('txtgrossamt').value) + parseFloat(boxcharge);
                if (document.getElementById("ba0") != null && document.getElementById("ba0").value != "") {
                    document.getElementById("ba0").value = parseFloat(document.getElementById("ba0").value) + parseFloat(boxcharge);
                    //document.getElementById("boxc0").value = boxcharge;
                }
            }
        }
        if (document.getElementById('hiddenboxchrgtype') != null) //for on gross box charges
        {
            if (document.getElementById('hiddeninsertwise').value == 'yes') {
                var boxcharge = 0;

                if (document.getElementById('txtboxchrg') != null)
                    boxpercen = document.getElementById('txtboxchrg').value;

                if (boxpercen != null && boxpercen != "" && boxpercen != "0") {
                    boxcharge = parseInt(boxpercen);
                }
                if (document.getElementById('pai' + i1).value == "N" || document.getElementById('inssta' + i1).value == "cancel") {
                    boxcharge = 0;
                }
                if (document.getElementById('hiddenboxchrgtype').value == '2') {
                    boxcharge = (parseFloat(document.getElementById('gro' + i1).value) * parseFloat(boxcharge)) / 100;
                }
                if (document.getElementById('inssta' + i1).value == "booked") {
                    document.getElementById('ba' + i1).value = parseFloat(document.getElementById('ba' + i1).value) + parseFloat(boxcharge);
                    document.getElementById('ba' + i1).value = parseFloat(document.getElementById('ba' + i1).value).toFixed(2);
                    //document.getElementById("boxc" + i1).value = boxcharge;
                }

            }
        }
        document.getElementById('ba' + i1).value = parseFloat(document.getElementById('ba' + i1).value).toFixed(2);
        billamtA = parseFloat(billamtA) + parseFloat(document.getElementById('ba' + i1).value)
        //document.getElementById("grolocal" + i1).value = document.getElementById("gro" + i1).value;
        //document.getElementById("balocal" + i1).value = document.getElementById("ba" + i1).value;
    }
    if (document.getElementById('hiddenboxchrgtype') != null && document.getElementById('txtboxchrg') != null && document.getElementById('txtboxchrg').value != "" && document.getElementById('txtboxchrg').value != "0") //for on gross box charges
        document.getElementById('txtgrossamt').value = parseFloat(billamtA).toFixed(2);
    else
        document.getElementById('txtgrossamt').value = parseFloat(document.getElementById('txtgrossamt').value);
    document.getElementById('txtgrossamt').value = parseFloat(document.getElementById('txtgrossamt').value).toFixed(2);
    //document.getElementById('txtgrossamtlocal').value = document.getElementById('txtgrossamt').value;
    //document.getElementById('txtgrossamtlocal').value = document.getElementById('txtgrossamt').value;
    if (roundoff == "rowise") {
        var billamt = document.getElementById('txtgrossamt').value;
        var billamtA = parseFloat(document.getElementById('txtgrossamt').value) + .01;
        billamtA = Math.round(billamtA);
        var diff = parseFloat(billamtA) - parseFloat(billamt);
        document.getElementById('txtgrossamt').value = billamtA;
    }
    ///bhanu end
    return false;
}
function deductCoupan(count) {
    var res = QBC.getCouAmount(document.getElementById('hiddencompcode').value, document.getElementById('hiddencenter').value, document.getElementById('drpcoutype').value);
    var ds = res.value;
    var dedamt = 0;
    if (ds != null && ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0) {
        var amt = ds.Tables[0].Rows[0].AMOUNT;
        count = parseInt(count, 10) - 1;
        for (var i = count; i >= 0; i--) {
            if (amt > 0) {
                var billvar = document.getElementById('ba' + i);
                var grossvar = document.getElementById('gro' + i);
                var paidvar = document.getElementById('pai' + i).value;
                var insertsta = document.getElementById('inssta' + i).value;
                if (insertsta != null && insertsta != 'cancel' && insertsta != 'billed' && paidvar != null && paidvar != 'N') {
                    if (parseFloat(amt) > parseFloat(grossvar.value)) {
                        amt = parseFloat(amt) - parseFloat(grossvar.value);
                        dedamt = parseFloat(dedamt) + parseFloat(billvar.value);
                        billvar.value = 0;
                    }
                    else {

                        var tamt = parseFloat(grossvar.value) - parseFloat(amt);
                        var tradisc = tradedisc;
                        var mainbill = billvar.value;
                        if (document.getElementById('chktrade').checked == false)
                            tradisc = 0;
                        if (tradisc == "")
                            tradisc = 0;
                        var trdisc1 = tradisc;

                        var billamount = 0;
                        billamount = parseFloat(tamt) - (parseFloat(tamt) * trdisc1 / 100);
                        billvar.value = billamount;
                        dedamt = parseFloat(dedamt) + (parseFloat(mainbill) - parseFloat(billamount));
                        amt = 0;
                    }
                }
            }
        }
    }
    document.getElementById('txtgrossamt').value = parseFloat(document.getElementById('txtgrossamt').value) - parseFloat(dedamt);
}
function bindVAT() {
    var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
    var billamttot = 0;
    var gridgrosstot = 0;
    for (var i = 0; i < count; i++) {
        var billrate = document.getElementById("ba" + i);
        var grossrate = document.getElementById("gro" + i);
        var vat = document.getElementById("vat" + i);
        var pubcode = document.getElementById("pubcode" + i);
        var inssta = document.getElementById("inssta" + i);
        var edition = document.getElementById("edit" + i);
        var vat_inc = document.getElementById("vat_inc" + i);
        var vatprec = 0;
        if (vat != null && (vat.value == "" || vat.value == null || vat.value == "null")) {
            var resvat = QBC.getVTSRate(pubcode.value, edition.value, document.getElementById('hiddencompcode').value);
            if (resvat.error != null) {
                alert(resvat.error.description);
                return false;
            }
            var dsvat = resvat.value;
            if (dsvat != null && dsvat.Tables.length > 0 && dsvat.Tables[0].Rows.length > 0) {
                if (dsvat.Tables[0].Rows[0].VATPREC != null) {
                    vatprec = dsvat.Tables[0].Rows[0].VATPREC;
                    vat.value = vatprec;
                }
            }
        }
        else if (vat != null && vat.value != "" && vat.value != null && vat.value != "null") {
            vatprec = vat.value;
        }
        if (vatprec != "" && vatprec != 0 && vat_inc.value != "1") {
            billrate.value = parseFloat(billrate.value) + ((parseFloat(billrate.value) * parseFloat(vatprec)) / 100);

        }
        else if (vatprec != "" && vatprec != 0 && vat_inc.value == "1") {
            var cal = ((parseFloat(billrate.value) * 100)) / (100 + parseFloat(vatprec));
            grossrate.value = (parseFloat(cal)).toFixed(2);
        }
        billamttot = parseFloat(billamttot) + parseFloat(billrate.value);
        gridgrosstot = parseFloat(gridgrosstot) + parseFloat(grossrate.value);

    }
    document.getElementById('txtgrossamt').value = (parseFloat(billamttot)).toFixed(2);
    document.getElementById('txttotalamt').value = (parseFloat(gridgrosstot)).toFixed(2);
}
function bindShareDisc() {
    var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
    var billamttot = 0;
    var gridgrosstot = 0;
    var arrshare;
    var dspub;
    if (sharepub != "") {
        arrshare = sharepub.split("$");
        var packagecode = '';
        var obj = document.getElementById('drppackagecopy');
        for (var x = 0; x < obj.options.length; x++) {

            var insertCount1 = 0;
            if (obj[x].value.indexOf('(') >= 0) {
                insertCount1 = obj[x].value.substring(obj[x].value.lastIndexOf('(') + 1, obj[x].value.length - 1);
                //  insertCount1=parseInt(insertCount1)-1;
            }
            for (x1 = 0; x1 < insertCount1; x1++) {
                if (packagecode == '')
                    packagecode = obj[x].value.substring(0, obj[x].value.lastIndexOf('@'));
                else
                    packagecode = packagecode + ',' + obj[x].value.substring(0, obj[x].value.lastIndexOf('@'));

            }


        }
        var respub = QBC.getpubcount(document.getElementById('hiddencompcode').value, document.getElementById('txtinsertion').value, packagecode, document.getElementById('txtciobookid').value);
        if (respub.error == null) {
            dspub = respub.value;
        }
    }
    var maingross = document.getElementById('txtgrossamt').value;
    for (var i = 0; i < count; i++) {
        var billrate = document.getElementById("ba" + i);
        var billrate = document.getElementById("ba" + i);
        var grossrate = document.getElementById("gro" + i);
        var pubcode = document.getElementById("pubcode" + i);
        var inssta = document.getElementById("inssta" + i);
        var pai_var = document.getElementById("pai" + i);

        // FOR SHARING PUBLICATION WISE
        if (arrshare != undefined && arrshare.length > 0) {
            var tCount = 0;
            var counterT = 0;
            var ins_vari = document.getElementById('ins' + counterT);
            if (ins_vari != null) {
                while (parseInt(ins_vari.innerHTML) == "1") {
                    tCount = parseInt(tCount) + 1;
                    counterT = parseInt(counterT) + 1;
                    ins_vari = document.getElementById('ins' + counterT);
                    if (ins_vari == null)
                        break;
                }
            }
            var gridItemCount = tCount;
            for (var ishare = 0; ishare < arrshare.length; ishare++) {
                var strSp = arrshare[ishare].split("~");

                if (strSp[0] == pubcode.value && strSp[1] != "") {
                    ishare = arrshare.length;
                    var div = 1;
                    if (dspub != undefined && dspub != null && dspub.Tables[0].Rows.length > 0) {
                        for (var in1 = 0; in1 < dspub.Tables[0].Rows.length; in1++) {
                            if (dspub.Tables[0].Rows[in1].PUBLICATION == pubcode.value) {
                                div = dspub.Tables[0].Rows[in1].COUNTPUB;
                                if (dspub.Tables[0].Rows.length == 1 && div != "" && document.getElementById('txtpaid').value != "" && parseInt(div) > (parseInt(document.getElementById('txtpaid').value) * parseInt(gridItemCount))) {
                                    var d = parseInt(div) - parseInt(document.getElementById('txtpaid').value);
                                    div = parseInt(div) - parseInt(d);
                                }
                            }
                        }
                    }
                    if (inssta.value != 'cancel' && inssta.value != 'billed' && inssta.value != 'publish' && pai_var.value != "N") {
                        if (strSp[2] == "F") {
                            grossrate.value = parseFloat(strSp[1]) / parseFloat(div);
                        }
                        else {
                            grossrate.value = ((parseFloat(maingross) * parseFloat(strSp[1]) / 100)) / parseFloat(div);
                        }
                        //calculate trade discount
                        var tradisc = tradedisc;
                        if (document.getElementById('chktrade').checked == false)
                            tradisc = 0;
                        if (tradisc == "")
                            tradisc = 0;
                        var trdisc1 = tradisc;

                        var billamount = 0;
                        billamount = parseFloat(grossrate.value) - (parseFloat(grossrate.value) * trdisc1 / 100);
                        billrate.value = billamount;
                    }
                }
            }
        }
        gridgrosstot = parseFloat(gridgrosstot) + parseFloat(grossrate.value);
        billamttot = parseFloat(billamttot) + parseFloat(billrate.value);
        // END    
    }
    document.getElementById('txtgrossamt').value = (parseFloat(billamttot)).toFixed(2);
    document.getElementById('txttotalamt').value = (parseFloat(gridgrosstot)).toFixed(2);
}
function novalue(evt) {
    var charCode = (evt.which) ? evt.which : event.keyCode
    //alert(event.keyCode)
    if (charCode >= 0 && charCode <= 200)
        return false;
}
//testing for fast speed 1oct09
function insertLine_callback_1(response) {
    // alert("chd");
    previnsertion = document.getElementById('txtinsertion').value;
    var ds = response.value;
    //alert(ds);
    if (ds != null) {
        fillinsert = ds.Tables[0].Rows.length;
        var i = 0;
        var str = "";

        //str=str.replace("</TABLE>","");
        //alert(document.getElementById('tblinsert').innerHTML);
        document.getElementById('txtrepeatingdate').disabled = false;
        var dat = "mm+" / "+" / "+dd+" / "+yyyy";
        var j = 0;
        var k = 0;
        var l = 0;
        var m = 0;
        var n = 0;
        var o = 0;
        var p = 0;
        var premid;
        var premper;
        var colid;
        var height;
        var width;
        var size;
        var late;
        var adtypid;
        var uomid;
        var cardid;
        var premper1;
        var prem1id;
        var name;
        var inserts;
        var pagepost;
        var preall;
        var adcat;
        var adsubcat;
        var matsta;
        var filename;
        var discrate;
        var insertsta;
        var billstat;
        var editid;
        var repeat;
        var picfieldl;
        var colid;
        var paid;
        var agrred;
        var solo;
        var gross;
        var s;
        var count;
        var len = "bookdiv";
        var pageno_inserts;
        var remark_inserts;
        var page;
        var pageprem;
        var noofcol;
        var billamt;
        var billrate;
        var pagstr = "";
        /*new change ankur 23 feb*/
        var logoH = "";
        var logoW = "";
        var logonam = "";
        var dcat1 = "";
        var dcol = "";
        var dinsert = "";
        var dstatus = "";
        var dposition = "";
        var dprem1 = "";
        var dpre = "";
        var dmcat = "";
        var dbill = "";
        var dadcat3 = "";
        var dadcat4 = "";
        var dadcat5 = "";
        var dpaid = "";
        var dcou = "";

        var pkgcodegrid = "";

        if (document.getElementById('hiddensavemod').value != "0") {
            count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
            idnew = parseInt(count);
            dcou = count;
            document.getElementById('hiddenrowcount').value = count;
            //insertval=count;
            if (document.getElementById('hiddeninsertion').value != "") {
                gridItemCount = parseInt(count) / parseInt(document.getElementById('hiddeninsertion').value);
                insertval = document.getElementById('hiddeninsertion').value;
                tempins = document.getElementById('hiddeninsertion').value;
                document.getElementById('hiddeninsertion').value = ""
            }
        }
        else {
            count = document.getElementById('hiddenrowcount').value;
            dcou = count;
            document.getElementById('hiddenrowcount').value = ds.Tables[0].Rows.length;
        }

        if (document.getElementById('txtrepeatingdate').value != "") {
            document.getElementById('btnshdl').disabled = false;
            count = 0;
            dcou = count;
        }
        //var idnew=document.getElementById('hiddenrowcount').value - parseInt(document.getElementById('txtinsertion').value);
        var temp = idnew;
        i = count;

        dcat1 = "";
        dcol = "";
        dinsert = "";
        dstatus = "";
        dposition = "";
        dprem1 = "";
        dpre = "";
        dmcat = "";
        dbill = "";
        dadcat3 = "";
        dadcat4 = "";
        dadcat5 = "";
        dpaid = "";
        for (s = count; s < ds.Tables[0].Rows.length; s++) {
            var vvalue = "";
            //
            if (checkflag == 1) {
                caldate[cali] = dateSelected;
                caldatemonth[cali] = parseInt(monthSelected) + 1;
                caldateyear[cali] = yearSelected;
                //////comment by anujafor publication grid
                // cali = cali + 1;
            }
            //////////// add  by anuja for pub grid
            var dCheck = checkValidEdition(ds.Tables[0].Rows[s].Edition_Name);
            if (dCheck == true) {
                /////////////////////////////////////end
                var id = "Text" + i;
                uomid = "uom" + i;
                inserts = "ins" + i;
                editid = "edit" + i;
                colid = "col" + i;
                agrred = "agr" + i;
                str = "";
                if (s == count) {
                    insertval = parseInt(ds.Tables[0].Rows[s].IDNUM) + 1;
                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[1].childNodes[0].nodeValue == "enable") {
                            //   str=str+"<tr ><td align=\"center\" id="+inserts+"  class=\"TextField\">"+insertval+"</td>";
                            Make_Row = document.createElement("tr");
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            make_td.setAttribute("class", "TextField");
                            make_td.innerHTML = insertval;
                            make_td.id = inserts;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            Make_Row = document.createElement("tr");
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            make_td.setAttribute("class", "TextField");
                            make_td.style.display = "none";
                            make_td.innerHTML = insertval;
                            make_td.id = inserts;
                            Make_Row.appendChild(make_td);
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(0).text == "enable") {
                            //str=str+"<tr ><td align=\"center\" id="+inserts+"  class=\"TextField\">"+insertval+"</td>";
                            Make_Row = document.createElement("tr");
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            make_td.setAttribute("class", "TextField");
                            make_td.innerHTML = insertval;
                            make_td.id = inserts;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            Make_Row = document.createElement("tr");
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            make_td.setAttribute("class", "TextField");
                            make_td.style.display = "none";
                            make_td.innerHTML = insertval;
                            make_td.id = inserts;
                            Make_Row.appendChild(make_td);
                        }
                    }

                }
                //else if(i%noofinsert==0)
                else if (i % gridItemCount == 0) {
                    insertval = parseInt(ds.Tables[0].Rows[s].IDNUM) + 1;
                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[1].childNodes[0].nodeValue == "enable") {
                            //str=str+"<tr ><td align=\"center\" id="+inserts+" class=\"TextField\">"+insertval+"</td>";
                            Make_Row = document.createElement("tr");
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            make_td.setAttribute("class", "TextField");
                            make_td.innerHTML = insertval;
                            make_td.id = inserts;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            // str=str+"<td style=\"display:none;\"></td>";
                            Make_Row = document.createElement("tr");
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            make_td.setAttribute("class", "TextField");
                            make_td.style.display = "none";
                            make_td.innerHTML = insertval;
                            make_td.id = inserts;
                            Make_Row.appendChild(make_td);
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(0).text == "enable") {
                            //str=str+"<tr ><td align=\"center\" id="+inserts+" class=\"TextField\">"+insertval+"</td>";
                            Make_Row = document.createElement("tr");
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            make_td.setAttribute("class", "TextField");
                            make_td.innerHTML = insertval;
                            make_td.id = inserts;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            //str=str+"<td style=\"display:none;\"></td>";
                            Make_Row = document.createElement("tr");
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            make_td.setAttribute("class", "TextField");
                            make_td.style.display = "none";
                            make_td.innerHTML = insertval;
                            make_td.id = inserts;
                            Make_Row.appendChild(make_td);
                        }
                    }

                }
                else {
                    insertval = parseInt(ds.Tables[0].Rows[s].IDNUM) + 1;
                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[1].childNodes[0].nodeValue == "enable") {
                            //  str=str+"<tr ><td align=\"center\" id="+inserts+" class=\"TextField\">"+insertval+"</td>";
                            Make_Row = document.createElement("tr");
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            make_td.setAttribute("class", "TextField");
                            make_td.innerHTML = insertval;
                            make_td.id = inserts;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            // str=str+"<td style=\"display:none;\"></td>";
                            Make_Row = document.createElement("tr");
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            make_td.setAttribute("class", "TextField");
                            make_td.style.display = "none";
                            make_td.innerHTML = insertval;
                            make_td.id = inserts;
                            Make_Row.appendChild(make_td);
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(0).text == "enable") {
                            //str=str+"<tr ><td align=\"center\" id="+inserts+" class=\"TextField\">"+insertval+"</td>";
                            Make_Row = document.createElement("tr");
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            make_td.setAttribute("class", "TextField");
                            make_td.innerHTML = insertval;
                            make_td.id = inserts;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            // str=str+"<td style=\"display:none;\"></td>";
                            Make_Row = document.createElement("tr");
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            make_td.setAttribute("class", "TextField");
                            make_td.style.display = "none";
                            make_td.innerHTML = insertval;
                            make_td.id = inserts;
                            Make_Row.appendChild(make_td);
                        }
                    }

                }
                var dat_ed = ""
                if (ds.Tables[0].Rows[s].Date == null) {
                    dat_ed = "";
                }
                else {
                    dat_ed = ds.Tables[0].Rows[s].Date;
                }

                // Edition 
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[3].childNodes[0].nodeValue == "enable") {
                        // str=str + "<td class=\"dtGrid\" ><input class=\"btextforgridedition\" type=\"text\" disabled id="+editid+" value='"+ds.Tables[0].Rows[s].Edition_Name+"'></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        make_td.setAttribute("class", "dtGrid");
                        str = "<input class=\"btextforgridedition\" type=\"text\" disabled id=" + editid + " value=" + ds.Tables[0].Rows[s].Edition_Name + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(1).text == "enable") {
                        // str=str + "<td class=\"dtGrid\" ><input class=\"btextforgridedition\" type=\"text\" disabled id="+editid+" value='"+ds.Tables[0].Rows[s].Edition_Name+"'></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        make_td.setAttribute("class", "dtGrid");
                        str = "<input class=\"btextforgridedition\" type=\"text\" disabled id=" + editid + " value=" + ds.Tables[0].Rows[s].Edition_Name + ">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        // str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }

                // Date
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[5].childNodes[0].nodeValue == "enable") {
                        //  str=str + "<td><input class=\"btextforgrid\" type=\"text\" id="+id+" value='"+dat_ed+"' onfocus=\"popUpCalendar(Form1."+id+", Form1."+id+", "+dat+");\" onkeydown=\"javascript:return novalue(event)\" ><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1."+id+", Form1."+id+", "+dat+");\" height=\"14\" width=\"14\" /></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextforgrid\" type=\"text\" id=" + id + "   onfocus=\"popUpCalendar(Form1." + id + ", Form1." + id + ", " + dat + ");\"  onkeydown=\"return nodateentry(event);\" value=" + dat_ed + " ><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1." + id + ", Form1." + id + ", " + dat + ");\" height=\"14\" width=\"14\" />";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(2).text == "enable") {
                        //str=str + "<td><input class=\"btextforgrid\" type=\"text\" id="+id+" value='"+dat_ed+"' onfocus=\"popUpCalendar(Form1."+id+", Form1."+id+", "+dat+");\" onkeydown=\"javascript:return novalue(event)\" ><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1."+id+", Form1."+id+", "+dat+");\" height=\"14\" width=\"14\" /></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextforgrid\" type=\"text\" id=" + id + "   onfocus=\"popUpCalendar(Form1." + id + ", Form1." + id + ", " + dat + ");\"  onkeydown=\"return nodateentry(event);\" value=" + dat_ed + " ><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1." + id + ", Form1." + id + ", " + dat + ");\" height=\"14\" width=\"14\" />";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        //str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        make_td.style.display = "none";
                        Make_Row.appendChild(make_td);
                    }
                }




                ////this is to bind the Ad sub cat drop down

                adsubcat = "ads" + i;

                // Ad Sub Cat
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[7].childNodes[0].nodeValue == "enable") {
                        if (dcat1 == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dcat1 = dcat1 + "<select id=" + adsubcat + " class=\"dropdownforgridqbc\" onchange=\"getvalueintoinserts(" + adsubcat + "," + inserts + "," + insertval + ");\">";
                            // this is to bind adv sub cat drop down
                            dcat1 = dcat1 + "<option value=\"0\" selected=\"true\">select</option>";
                            for (l = 0; l <= ds.Tables[3].Rows.length - 1; l++) {
                                if (ds.Tables[3].Rows[l].Adv_Subcat_Code == document.getElementById('drpadsubcategory').value && document.getElementById('drpadsubcategory').value != "0") {
                                    dcat1 = dcat1 + "<option value=" + ds.Tables[3].Rows[l].Adv_Subcat_Code + " selected=" + document.getElementById('drpadsubcategory').value + ">" + ds.Tables[3].Rows[l].Adv_Subcat_Code + "</option>";
                                }
                                else {
                                    dcat1 = dcat1 + "<option value=" + ds.Tables[3].Rows[l].Adv_Subcat_Code + ">" + ds.Tables[3].Rows[l].Adv_Subcat_Code + "</option>";
                                }
                            }

                            dcat1 = dcat1 + "</select>";
                            //str=str+dcat1;
                            make_td.innerHTML = dcat1;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dcat1.replace("ads" + dcou, adsubcat);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                            //str=str+dcat1.replace("ads"+dcou,adsubcat);
                        }
                    }
                    else {
                        // str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(3).text == "enable") {
                        if (dcat1 == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dcat1 = dcat1 + "<select id=" + adsubcat + " class=\"dropdownforgridqbc\" onchange=\"getvalueintoinserts(" + adsubcat + "," + inserts + "," + insertval + ");\">";
                            // this is to bind adv sub cat drop down
                            dcat1 = dcat1 + "<option value=\"0\" selected=\"true\">select</option>";
                            for (l = 0; l <= ds.Tables[3].Rows.length - 1; l++) {
                                if (ds.Tables[3].Rows[l].Adv_Subcat_Code == document.getElementById('drpadsubcategory').value && document.getElementById('drpadsubcategory').value != "0") {
                                    dcat1 = dcat1 + "<option value=" + ds.Tables[3].Rows[l].Adv_Subcat_Code + " selected=" + document.getElementById('drpadsubcategory').value + ">" + ds.Tables[3].Rows[l].Adv_Subcat_Code + "</option>";
                                }
                                else {
                                    dcat1 = dcat1 + "<option value=" + ds.Tables[3].Rows[l].Adv_Subcat_Code + ">" + ds.Tables[3].Rows[l].Adv_Subcat_Code + "</option>";
                                }
                            }

                            dcat1 = dcat1 + "</select>";
                            //  str=str+dcat1;
                            make_td.innerHTML = dcat1;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            //str=str+dcat1.replace("ads"+dcou,adsubcat);
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dcat1.replace("ads" + dcou, adsubcat);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                        }
                    }
                    else {
                        //str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }

                // Color
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[9].childNodes[0].nodeValue == "enable") {
                        if (dcol == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dcol = dcol + "<select id=" + colid + " class=\"dropdownforgridqbc\" onchange=\"getvalueintoinsertsforcolor(" + colid + "," + inserts + "," + insertval + ");\">";

                            //this is to bind the color drop down
                            dcol = dcol + "<option value=\"0\" selected=\"true\">select</option>";
                            for (j = 0; j <= ds.Tables[1].Rows.length - 1; j++) {

                                if (ds.Tables[1].Rows[j].col_Code == document.getElementById('drpcolor').value && document.getElementById('drpcolor').value != "0") {
                                    dcol = dcol + "<option value=" + ds.Tables[1].Rows[j].col_Code + " selected=" + document.getElementById('drpcolor').value + ">" + ds.Tables[1].Rows[j].col_Code + "</option>";
                                }
                                else {
                                    dcol = dcol + "<option value=" + ds.Tables[1].Rows[j].col_Code + ">" + ds.Tables[1].Rows[j].col_Code + "</option>";
                                }
                            }

                            dcol = dcol + "</select>";
                            //str=str+dcol;
                            make_td.innerHTML = dcol;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dcol.replace("col" + dcou, colid);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                            //str=str+dcol.replace("col"+dcou,colid);
                        }
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(4).text == "enable") {
                        if (dcol == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dcol = dcol + "<select id=" + colid + " class=\"dropdownforgridqbc\" onchange=\"getvalueintoinsertsforcolor(" + colid + "," + inserts + "," + insertval + ");\">";

                            //this is to bind the color drop down
                            dcol = dcol + "<option value=\"0\" selected=\"true\">select</option>";
                            for (j = 0; j <= ds.Tables[1].Rows.length - 1; j++) {

                                if (ds.Tables[1].Rows[j].col_Code == document.getElementById('drpcolor').value && document.getElementById('drpcolor').value != "0") {
                                    dcol = dcol + "<option value=" + ds.Tables[1].Rows[j].col_Code + " selected=" + document.getElementById('drpcolor').value + ">" + ds.Tables[1].Rows[j].col_Code + "</option>";
                                }
                                else {
                                    dcol = dcol + "<option value=" + ds.Tables[1].Rows[j].col_Code + ">" + ds.Tables[1].Rows[j].col_Code + "</option>";
                                }
                            }

                            dcol = dcol + "</select>";
                            //str=str+dcol;
                            make_td.innerHTML = dcol;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dcol.replace("col" + dcou, colid);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                            //     str=str+dcol.replace("col"+dcou,colid);
                        }
                    }
                    else {
                        // str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }


                premid = "prem" + i;
                prem1id = "premone" + i;
                height = "hei" + i;
                width = "wid" + i;
                size = "siz" + i;
                pagepost = "pagpos" + i;
                noofcol = "nocol" + i;
                //////// on change function is there to calculate the size 
                //str=str+"</select></td><td><input class=\"btextforbook\" id="+height+" type=\"text\"  value=\"\"></td><td><input class=\"btextforbook\" id="+width+" onchange=\"return gettotalsize("+height+","+width+","+i+");\" type=\"text\"  value=\"\"></td><td><input class=\"btextforbook\" disabled id="+size+" type=\"text\"  value=\"\"></td><td><select id="+premid+" class=\"dropdownforbook\" onchange=\"return getpercenprem("+premid+","+i+");\"  >";

                // Heigth Width Column
                if (document.getElementById('drpuom').value != "0" && document.getElementById('hiddenuomdesc').value != "CD") {
                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[11].childNodes[0].nodeValue == "enable") {
                            // str=str+"<td><input class=\" btextsmallsize\" style=\"background-color: Gray;\" disabled id="+height+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(Form1."+height+");\" type=\"text\"  value="+document.getElementById('txtadsize1').value+"></td><td><input class=\"btextsmallsize\" style=\"background-color: Gray;\" disabled id="+width+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(Form1."+width+");\" type=\"text\"  value="+document.getElementById('txtadsize2').value+"></td><td><input class=\"btextsmallsize\" disabled id="+noofcol+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(Form1."+noofcol+");\" type=\"text\"  value="+document.getElementById('txtcolum').value+"></td>";
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = "<input class=\" btextsmallsize\" style=\"background-color: Gray;\" disabled id=" + height + " onchange=\"return gettotalsize(" + height + "," + width + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" onkeypress=\"javascript:return rateenter(Form1." + height + ");\" type=\"text\"  value=" + document.getElementById('txtadsize1').value + ">";
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);

                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = "<input class=\"btextsmallsize\" style=\"background-color: Gray;\" disabled id=" + width + " onchange=\"return gettotalsize(" + height + "," + width + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" onkeypress=\"javascript:return rateenter(Form1." + width + ");\" type=\"text\"  value=" + document.getElementById('txtadsize2').value + ">";
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);

                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = "<input class=\"btextsmallsize\" disabled id=" + noofcol + " onchange=\"return gettotalsize(" + height + "," + width + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" onkeypress=\"javascript:return rateenter(Form1." + noofcol + ");\" type=\"text\"  value=" + document.getElementById('txtcolum').value + ">";
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            //str=str+"<td style=\"display:none;\"></td>";
                            make_td = document.createElement("td");
                            make_td.style.display = "none";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(5).text == "enable") {
                            //str=str+"<td><input class=\" btextsmallsize\" style=\"background-color: Gray;\" disabled id="+height+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(Form1."+height+");\" type=\"text\"  value="+document.getElementById('txtadsize1').value+"></td><td><input class=\"btextsmallsize\" style=\"background-color: Gray;\" disabled id="+width+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(Form1."+width+");\" type=\"text\"  value="+document.getElementById('txtadsize2').value+"></td><td><input class=\"btextsmallsize\" disabled id="+noofcol+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(Form1."+noofcol+");\" type=\"text\"  value="+document.getElementById('txtcolum').value+"></td>";
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = "<input class=\" btextsmallsize\" style=\"background-color: Gray;\" disabled id=" + height + " onchange=\"return gettotalsize(" + height + "," + width + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" onkeypress=\"javascript:return rateenter(Form1." + height + ");\" type=\"text\"  value=" + document.getElementById('txtadsize1').value + ">";
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);

                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = "<input class=\"btextsmallsize\" style=\"background-color: Gray;\" disabled id=" + width + " onchange=\"return gettotalsize(" + height + "," + width + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" onkeypress=\"javascript:return rateenter(Form1." + width + ");\" type=\"text\"  value=" + document.getElementById('txtadsize2').value + ">";
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);

                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = "<input class=\"btextsmallsize\" disabled id=" + noofcol + " onchange=\"return gettotalsize(" + height + "," + width + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" onkeypress=\"javascript:return rateenter(Form1." + noofcol + ");\" type=\"text\"  value=" + document.getElementById('txtcolum').value + ">";
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            //str=str+"<td style=\"display:none;\"></td>";
                            make_td = document.createElement("td");
                            make_td.style.display = "none";
                        }
                    }

                }
                else {
                    if (document.getElementById('txtcolum').disabled == true) {
                        if (browser != "Microsoft Internet Explorer") {
                            if (xmlObj.childNodes[23].childNodes[11].childNodes[0].nodeValue == "enable") {
                                // str=str+"<td><input class=\"btextsmallsize\" style=\" background-color: White;\" id="+height+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(Form1."+height+");\" type=\"text\"  value="+document.getElementById('txtadsize1').value+"></td><td><input class=\"btextsmallsize\" id="+width+" style=\"background-color:White;\" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(Form1."+width+");\" type=\"text\"  value="+document.getElementById('txtadsize2').value+"></td><td><input class=\"btextsmallsize\" disabled id="+noofcol+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(Form1."+noofcol+");\" type=\"text\"  value="+document.getElementById('txtcolum').value+"></td>";
                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = "<input class=\" btextsmallsize\" style=\"background-color: Gray;\" disabled id=" + height + " onchange=\"return gettotalsize(" + height + "," + width + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" onkeypress=\"javascript:return rateenter(Form1." + height + ");\" type=\"text\"  value=" + document.getElementById('txtadsize1').value + ">";
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);

                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = "<input class=\"btextsmallsize\" style=\"background-color: Gray;\" disabled id=" + width + " onchange=\"return gettotalsize(" + height + "," + width + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" onkeypress=\"javascript:return rateenter(Form1." + width + ");\" type=\"text\"  value=" + document.getElementById('txtadsize2').value + ">";
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);

                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = "<input class=\"btextsmallsize\" disabled id=" + noofcol + " onchange=\"return gettotalsize(" + height + "," + width + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" onkeypress=\"javascript:return rateenter(Form1." + noofcol + ");\" type=\"text\"  value=" + document.getElementById('txtcolum').value + ">";
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);
                            }
                            else {
                                // str=str+"<td style=\"display:none;\"></td>";
                                make_td = document.createElement("td");
                                make_td.style.display = "none";
                            }
                        }
                        else {
                            if (xmlObj.childNodes(11).childNodes(5).text == "enable") {
                                // str=str+"<td><input class=\"btextsmallsize\" style=\" background-color: White;\" id="+height+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(Form1."+height+");\" type=\"text\"  value="+document.getElementById('txtadsize1').value+"></td><td><input class=\"btextsmallsize\" id="+width+" style=\"background-color:White;\" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(Form1."+width+");\" type=\"text\"  value="+document.getElementById('txtadsize2').value+"></td><td><input class=\"btextsmallsize\" disabled id="+noofcol+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(Form1."+noofcol+");\" type=\"text\"  value="+document.getElementById('txtcolum').value+"></td>";
                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = "<input class=\" btextsmallsize\" style=\"background-color: Gray;\" disabled id=" + height + " onchange=\"return gettotalsize(" + height + "," + width + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" onkeypress=\"javascript:return rateenter(Form1." + height + ");\" type=\"text\"  value=" + document.getElementById('txtadsize1').value + ">";
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);

                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = "<input class=\"btextsmallsize\" style=\"background-color: Gray;\" disabled id=" + width + " onchange=\"return gettotalsize(" + height + "," + width + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" onkeypress=\"javascript:return rateenter(Form1." + width + ");\" type=\"text\"  value=" + document.getElementById('txtadsize2').value + ">";
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);

                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = "<input class=\"btextsmallsize\" disabled id=" + noofcol + " onchange=\"return gettotalsize(" + height + "," + width + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" onkeypress=\"javascript:return rateenter(Form1." + noofcol + ");\" type=\"text\"  value=" + document.getElementById('txtcolum').value + ">";
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);
                            }
                            else {
                                //str=str+"<td style=\"display:none;\"></td>";
                                make_td = document.createElement("td");
                                make_td.style.display = "none";
                            }
                        }

                    }
                    else {
                        if (browser != "Microsoft Internet Explorer") {
                            if (xmlObj.childNodes[23].childNodes[11].childNodes[0].nodeValue == "enable") {
                                //str=str+"<td><input class=\"btextsmallsize\" style=\" background-color: White;\" id="+height+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(Form1."+height+");\" type=\"text\"  value="+document.getElementById('txtadsize1').value+"></td><td><input class=\"btextsmallsize\"  id="+width+" style=\"background-color:White;\" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(Form1."+width+");\" type=\"text\"  value="+document.getElementById('txtadsize2').value+"></td><td><input class=\"btextsmallsize\"  id="+noofcol+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(Form1."+noofcol+");\" type=\"text\"  value="+document.getElementById('txtcolum').value+"></td>";
                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = "<input class=\" btextsmallsize\" style=\"background-color: Gray;\" disabled id=" + height + " onchange=\"return gettotalsize(" + height + "," + width + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" onkeypress=\"javascript:return rateenter(Form1." + height + ");\" type=\"text\"  value=" + document.getElementById('txtadsize1').value + ">";
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);

                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = "<input class=\"btextsmallsize\" style=\"background-color: Gray;\" disabled id=" + width + " onchange=\"return gettotalsize(" + height + "," + width + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" onkeypress=\"javascript:return rateenter(Form1." + width + ");\" type=\"text\"  value=" + document.getElementById('txtadsize2').value + ">";
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);

                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = "<input class=\"btextsmallsize\"  disabled id=" + noofcol + " onchange=\"return gettotalsize(" + height + "," + width + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" onkeypress=\"javascript:return rateenter(Form1." + noofcol + ");\" type=\"text\"  value=" + document.getElementById('txtcolum').value + ">";
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);
                            }
                            else {
                                //str=str+"<td style=\"display:none;\"></td>";
                                make_td = document.createElement("td");
                                make_td.style.display = "none";
                            }
                        }
                        else {
                            if (xmlObj.childNodes(11).childNodes(5).text == "enable") {
                                // str=str+"<td><input class=\"btextsmallsize\" style=\" background-color: White;\" id="+height+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(Form1."+height+");\" type=\"text\"  value="+document.getElementById('txtadsize1').value+"></td><td><input class=\"btextsmallsize\"  id="+width+" style=\"background-color:White;\" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(Form1."+width+");\" type=\"text\"  value="+document.getElementById('txtadsize2').value+"></td><td><input class=\"btextsmallsize\"  id="+noofcol+" onchange=\"return gettotalsize("+height+","+width+","+i+","+inserts+","+insertval+","+noofcol+");\" onkeypress=\"javascript:return rateenter(Form1."+noofcol+");\" type=\"text\"  value="+document.getElementById('txtcolum').value+"></td>";
                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = "<input class=\" btextsmallsize\" style=\"background-color: Gray;\" disabled id=" + height + " onchange=\"return gettotalsize(" + height + "," + width + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" onkeypress=\"javascript:return rateenter(Form1." + height + ");\" type=\"text\"  value=" + document.getElementById('txtadsize1').value + ">";
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);

                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = "<input class=\"btextsmallsize\" style=\"background-color: Gray;\" disabled id=" + width + " onchange=\"return gettotalsize(" + height + "," + width + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" onkeypress=\"javascript:return rateenter(Form1." + width + ");\" type=\"text\"  value=" + document.getElementById('txtadsize2').value + ">";
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);

                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = "<input class=\"btextsmallsize\" disabled id=" + noofcol + " onchange=\"return gettotalsize(" + height + "," + width + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" onkeypress=\"javascript:return rateenter(Form1." + noofcol + ");\" type=\"text\"  value=" + document.getElementById('txtcolum').value + ">";
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);
                            }
                            else {
                                //str=str+"<td style=\"display:none;\"></td>";
                                make_td = document.createElement("td");
                                make_td.style.display = "none";
                            }
                        }

                    }
                }

                insertsta = "inssta" + i;

                ////////this is to bind the status of insertion drop down  agrred

                if (browser != "Microsoft Internet Explorer") {

                    if (xmlObj.childNodes[23].childNodes[13].childNodes[0].nodeValue == "enable") {
                        if (dinsert == "") {
                            var b = 0;
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dinsert = dinsert + "<select id=" + insertsta + " class=\"dropdownforgrid\" onchange=\"javascript:return chkpublishdate('" + insertsta + "','" + id + "')\">";
                            for (b = 1; b <= xmlObj.childNodes[19].childNodes.length - 1; ) {

                                if (xmlObj.childNodes[19].childNodes[b].childNodes[0].nodeValue == "Booked" || xmlObj.childNodes[19].childNodes[b].childNodes[0].nodeValue == "booked") {
                                    dinsert = dinsert + "<option value=" + xmlObj.childNodes[19].childNodes[b + 2].childNodes[0].nodeValue + " selected=\"true\">" + xmlObj.childNodes[19].childNodes[b].childNodes[0].nodeValue + "</option>";
                                }
                                else {
                                    dinsert = dinsert + "<option value=" + xmlObj.childNodes[19].childNodes[b + 2].childNodes[0].nodeValue + ">" + xmlObj.childNodes[19].childNodes[b].childNodes[0].nodeValue + "</option>";
                                }
                                b = b + 4;
                            }
                            dinsert = dinsert + "</select>";
                            //str=str+dinsert;
                            make_td.innerHTML = dinsert;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            //   str=str+dinsert.replace("inssta"+dcou,insertsta);
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dinsert.replace("inssta" + dcou, insertsta);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                        }

                    }
                    else {
                        //str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    //    var xmlDoc = new ActiveXObject("Microsoft.XMLDOM"); 

                    //    loadXML('xml/billcycle.xml');
                    if (xmlObj.childNodes(11).childNodes(6).text == "enable") {
                        if (dinsert == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dinsert = dinsert + "<select id=" + insertsta + " class=\"dropdownforgrid\" onchange=\"javascript:return chkpublishdate('" + insertsta + "','" + id + "')\">";
                            var b = 0;

                            for (b = 0; b <= xmlObj.childNodes(9).childNodes.length - 1; b++) {

                                if (xmlObj.childNodes(9).childNodes(b + 1).text == "Booked" || xmlObj.childNodes(9).childNodes(b + 1).text == "booked") {
                                    dinsert = dinsert + "<option value=" + xmlObj.childNodes(9).childNodes(b + 1).text + " selected=\"true\">" + xmlObj.childNodes(9).childNodes(b).text + "</option>";
                                }
                                else {
                                    dinsert = dinsert + "<option value=" + xmlObj.childNodes(9).childNodes(b + 1).text + ">" + xmlObj.childNodes(9).childNodes(b).text + "</option>";
                                }
                                b = b + 1;
                            }
                            dinsert = dinsert + "</select>";
                            //str=str + dinsert;
                            make_td.innerHTML = dinsert;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            //   str=str+dinsert.replace("inssta"+dcou,insertsta);
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dinsert.replace("inssta" + dcou, insertsta);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                        }
                    }
                    else {
                        //  str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }

                ////this loop is to bind the page position
                pagstr = "fir";

                /////////////this is to bind the status material drop down
                matsta = "mat" + i;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[15].childNodes[0].nodeValue == "enable") {
                        if (dstatus == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dstatus = dstatus + "<select id=" + matsta + " class=\"dropdownforgrid\">";
                            /////this is to bind the status material dropdown
                            if (document.getElementById('drpmatstat').value = "0") {
                                dstatus = dstatus + "<option value=\"0\" selected=" + document.getElementById('drpmatstat').value + ">Select</option>";
                            }
                            else {
                                dstatus = dstatus + "<option value=\"0\">Select</option>";
                            }
                            if (document.getElementById('drpmatstat').value = "hardcopy") {
                                dstatus = dstatus + "<option value=\"hardcopy\" selected=" + document.getElementById('drpmatstat').value + ">Hard Copy</option>";
                            }
                            else {
                                dstatus = dstatus + "<option value=\"hardcopy\">Hard Copy</option>";
                            }
                            if (document.getElementById('drpmatstat').value = "softcopy") {
                                dstatus = dstatus + "<option value=\"softcopy\" selected=" + document.getElementById('drpmatstat').value + ">Soft Copy</option>";
                            }
                            else {
                                dstatus = dstatus + "<option value=\"softcopy\">Soft Copy</option>";
                            }
                            if (document.getElementById('drpmatstat').value = "cd") {
                                dstatus = dstatus + "<option value=\"cd\" selected=" + document.getElementById('drpmatstat').value + ">CD</option>";
                            }
                            else {
                                dstatus = dstatus + "<option value=\"cd\">CD</option>";
                            }
                            if (document.getElementById('drpmatstat').value = "other") {
                                dstatus = dstatus + "<option value=\"other\" selected=" + document.getElementById('drpmatstat').value + ">Others</option>";
                            }
                            else {
                                dstatus = dstatus + "<option value=\"other\">Others</option>";
                            }

                            dstatus = dstatus + "</select>";
                            //str=str+dstatus;
                            make_td.innerHTML = dstatus;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dstatus.replace("mat" + dcou, matsta);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);

                            // str=str+dstatus.replace("mat"+dcou,matsta);
                        }
                    }
                    else {
                        //str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(7).text == "enable") {
                        if (dstatus == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dstatus = dstatus + "<select id=" + matsta + " class=\"dropdownforgrid\">";
                            /////this is to bind the status material dropdown
                            if (document.getElementById('drpmatstat').value = "0") {
                                dstatus = dstatus + "<option value=\"0\" selected=" + document.getElementById('drpmatstat').value + ">Select</option>";
                            }
                            else {
                                dstatus = dstatus + "<option value=\"0\">Select</option>";
                            }
                            if (document.getElementById('drpmatstat').value = "hardcopy") {
                                dstatus = dstatus + "<option value=\"hardcopy\" selected=" + document.getElementById('drpmatstat').value + ">Hard Copy</option>";
                            }
                            else {
                                dstatus = dstatus + "<option value=\"hardcopy\">Hard Copy</option>";
                            }
                            if (document.getElementById('drpmatstat').value = "softcopy") {
                                dstatus = dstatus + "<option value=\"softcopy\" selected=" + document.getElementById('drpmatstat').value + ">Soft Copy</option>";
                            }
                            else {
                                dstatus = dstatus + "<option value=\"softcopy\">Soft Copy</option>";
                            }
                            if (document.getElementById('drpmatstat').value = "cd") {
                                dstatus = dstatus + "<option value=\"cd\" selected=" + document.getElementById('drpmatstat').value + ">CD</option>";
                            }
                            else {
                                dstatus = dstatus + "<option value=\"cd\">CD</option>";
                            }
                            if (document.getElementById('drpmatstat').value = "other") {
                                dstatus = dstatus + "<option value=\"other\" selected=" + document.getElementById('drpmatstat').value + ">Others</option>";
                            }
                            else {
                                dstatus = dstatus + "<option value=\"other\">Others</option>";
                            }

                            dstatus = dstatus + "</select>";
                            //str=str+dstatus;
                            make_td.innerHTML = dstatus;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dstatus.replace("mat" + dcou, matsta);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                            // str=str+dstatus.replace("mat"+dcou,matsta);    
                        }
                    }
                    else {
                        //str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }


                cardid = "card" + i;

                //this is the function cretaed to get the solo edition rate break up with referrence  to the package selected 
                /////////////////////////////////////////////////////////////////////////////////////////////////////////////
                //
                /////////////////////////////////////////////////////////////////////////////////////////////////////////////
                /////////////////////////////////////////////////////////////////////////////////////////////////////////////

                picfield = "pic" + i;
                filename = "fil" + i;

                // File Name
                //str=str+"</select></td><td><input class=\"btextforgrid\" type=\"text\" id="+filename+" disabled  value=\"\"></td>";
                if (eval(document.getElementById(filename)) != null) {
                    if (document.getElementById(filename).value != "") {
                        if (browser != "Microsoft Internet Explorer") {
                            if (xmlObj.childNodes[23].childNodes[17].childNodes[0].nodeValue == "enable") {
                                //str=str+"<td><input class=\"btextforgrid\" type=\"text\" id="+filename+" disabled value="+document.getElementById(filename).value+" ></td>";
                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = "<input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled  value=" + document.getElementById(filename).value + ">";
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);
                            }
                            else {
                                // str=str+"<td style=\"display:none;\"></td>";
                                make_td = document.createElement("td");
                                make_td.style.display = "none";
                            }
                        }
                        else {
                            if (xmlObj.childNodes(11).childNodes(8).text == "enable") {
                                //str=str+"<td><input class=\"btextforgrid\" type=\"text\" id="+filename+" disabled value="+document.getElementById(filename).value+" ></td>";
                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = "<input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled  value=" + document.getElementById(filename).value + ">";
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);
                            }

                            else {
                                //  str=str+"<td style=\"display:none;\"></td>";
                                make_td = document.createElement("td");
                                make_td.style.display = "none";
                            }
                        }

                    }
                    else {
                        if (browser != "Microsoft Internet Explorer") {
                            if (xmlObj.childNodes[23].childNodes[17].childNodes[0].nodeValue == "enable") {
                                // str=str+"<td><input class=\"btextforgrid\" type=\"text\" id="+filename+" disabled value=\"\" ></td>";
                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = "<input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled  value=\"\">";
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);
                            }
                            else {
                                // str=str+"<td style=\"display:none;\"></td>";
                                make_td = document.createElement("td");
                                make_td.style.display = "none";
                            }
                        }
                        else {
                            if (xmlObj.childNodes(11).childNodes(8).text == "enable") {
                                //str=str+"<td><input class=\"btextforgrid\" type=\"text\" id="+filename+" disabled value=\"\" ></td>";
                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = "<input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled  value=\"\">";
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);
                            }
                            else {
                                //                            str=str+"<td style=\"display:none;\"></td>";
                                make_td = document.createElement("td");
                                make_td.style.display = "none";
                            }
                        }
                    }
                }
                else {
                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[17].childNodes[0].nodeValue == "enable") {
                            // str=str+"<td><input class=\"btextforgrid\" type=\"text\" id="+filename+" disabled value=\"\" ></td>";
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = "<input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled  value=\"\">";
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            // str=str+"<td style=\"display:none;\"></td>";
                            make_td = document.createElement("td");
                            make_td.style.display = "none";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(8).text == "enable") {
                            //  str=str+"<td><input class=\"btextforgrid\" type=\"text\" id="+filename+" disabled value=\"\" ></td>";
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = "<input class=\"btextforgrid\" type=\"text\" id=" + filename + " disabled  value=\"\">";
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            //str=str+"<td style=\"display:none;\"></td>";
                            make_td = document.createElement("td");
                            make_td.style.display = "none";
                        }
                    }
                }

                // Upload Button
                var upl = "upload" + i;
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[19].childNodes[0].nodeValue == "enable") {
                        // str=str+"<td width=\"50px\"><input  class=\"button1\" type=\"button\" Value=\"Attachment\" onclick=\"uploadimage('"+ds.Tables[0].Rows[i].Edition_Name+"','"+picfield+"','"+insertval+"','"+editid+"','"+filename+"','"+i+"')\"></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<td width=\"50px\"><input  class=\"button1\" type=\"button\" id=" + upl + " Value=\"Attachment\" onclick=\"uploadimage('" + ds.Tables[0].Rows[i].Edition_Name + "','" + picfield + "','" + insertval + "','" + editid + "','" + filename + "','" + i + "')\"></td>";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);

                    }
                    else {
                        //str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(9).text == "enable") {
                        //str=str+"<td width=\"50px\"><input  class=\"button1\" type=\"button\" Value=\"Attachment\" onclick=\"uploadimage('"+ds.Tables[0].Rows[i].Edition_Name+"','"+picfield+"','"+insertval+"','"+editid+"','"+filename+"','"+i+"')\"></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<td width=\"50px\"><input  class=\"button1\" type=\"button\" id=" + upl + " Value=\"Attachment\" onclick=\"uploadimage('" + ds.Tables[0].Rows[i].Edition_Name + "','" + picfield + "','" + insertval + "','" + editid + "','" + filename + "','" + i + "')\"></td>";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        //   str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }

                // Page Position

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[21].childNodes[0].nodeValue == "enable") {
                        if (dposition == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dposition = dposition + "<select id=" + pagepost + " class=\"dropdownforgridqbc\" onchange=\"return getpageprem(" + pagepost + "," + i + ",'" + pagstr + "');\">";
                            dposition = dposition + "<option value=\"0\" selected=\"true\">select</option>";
                            for (p = 0; p <= ds.Tables[7].Rows.length - 1; p++) {
                                if (ds.Tables[7].Rows[p].pos_type_code == document.getElementById('Hiddendrppageposition').value && document.getElementById('Hiddendrppageposition').value != "0") {
                                    dposition = dposition + "<option value=" + ds.Tables[7].Rows[p].pos_type_code + " selected=" + document.getElementById('Hiddendrppageposition').value + ">" + ds.Tables[7].Rows[p].pos_type_code + "</option>";
                                }
                                else {
                                    dposition = dposition + "<option value=" + ds.Tables[7].Rows[p].pos_type_code + ">" + ds.Tables[7].Rows[p].pos_type_code + "</option>";
                                }
                            }
                            dposition = dposition + "</select>";
                            //str=str+dposition;
                            make_td.innerHTML = dposition;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dposition.replace("pagpos" + dcou, pagepost);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                            //str=str+dposition.replace("pagpos"+dcou,pagepost);      
                        }
                    }
                    else {
                        //   str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(10).text == "enable") {
                        if (dposition == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dposition = dposition + "<td><select id=" + pagepost + " class=\"dropdownforgridqbc\" onchange=\"return getpageprem(" + pagepost + "," + i + ",'" + pagstr + "');\">";
                            dposition = dposition + "<option value=\"0\" selected=\"true\">select</option>";
                            for (p = 0; p <= ds.Tables[7].Rows.length - 1; p++) {
                                if (ds.Tables[7].Rows[p].pos_type_code == document.getElementById('Hiddendrppageposition').value && document.getElementById('Hiddendrppageposition').value != "0") {
                                    dposition = dposition + "<option value=" + ds.Tables[7].Rows[p].pos_type_code + " selected=" + document.getElementById('Hiddendrppageposition').value + ">" + ds.Tables[7].Rows[p].pos_type_code + "</option>";
                                }
                                else {
                                    dposition = dposition + "<option value=" + ds.Tables[7].Rows[p].pos_type_code + ">" + ds.Tables[7].Rows[p].pos_type_code + "</option>";
                                }
                            }
                            dposition = dposition + "</select>";
                            // str=str+dposition;
                            make_td.innerHTML = dposition;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dposition.replace("pagpos" + dcou, pagepost);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                            //     str=str+dposition.replace("pagpos"+dcou,pagepost);
                        }
                    }
                    else {
                        //  str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }

                ////////////this is to for larest date

                late = "lat" + i;

                repeat = "rep" + i;
                var dat = "mm+" / "+" / "+dd+" / "+yyyy";

                // Latest By
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[23].childNodes[0].nodeValue == "enable") {
                        //str=str+"<td><input class=\"btextforgrid\" type=\"text\" id="+late+"  value=\"\" onchange=\"javascript:return checkdate(Form1."+late+");\" onkeypress=\"return dateenter();\"><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1."+late+", Form1."+late+", "+dat+");\" height=\"14\" width=\"14\" /> </td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextforgrid\" type=\"text\" id=" + late + "  value=\"\" onchange=\"javascript:return checkdate(Form1." + late + ");\" onkeypress=\"return dateenter();\"><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1." + late + ", Form1." + late + ", " + dat + ");\" height=\"14\" width=\"14\" />";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        //str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(11).text == "enable") {
                        //str=str+"<td><input class=\"btextforgrid\" type=\"text\" id="+late+"  value=\"\" onchange=\"javascript:return checkdate(Form1."+late+");\" onkeypress=\"return dateenter();\"><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1."+late+", Form1."+late+", "+dat+");\" height=\"14\" width=\"14\" /> </td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextforgrid\" type=\"text\" id=" + late + "  value=\"\" onchange=\"javascript:return checkdate(Form1." + late + ");\" onkeypress=\"return dateenter();\"><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1." + late + ", Form1." + late + ", " + dat + ");\" height=\"14\" width=\"14\" />";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        // str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[25].childNodes[0].nodeValue == "enable") {
                        //  str=str+"<td><input class=\"btextforgrid\" type=\"text\" id="+repeat+"  value=\"\"  onchange=\"javascript:return checkdate(Form1."+repeat+");\" onkeypress=\"return dateenter();\"><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1."+repeat+", Form1."+repeat+", "+dat+");\" height=\"14\" width=\"14\" /></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextforgrid\" type=\"text\" id=" + repeat + "  value=\"\"  onchange=\"javascript:return checkdate(Form1." + repeat + ");\" onkeypress=\"return dateenter();\"><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1." + repeat + ", Form1." + repeat + ", " + dat + ");\" height=\"14\" width=\"14\" />";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        // str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(12).text == "enable") {
                        //  str=str+"<td><input class=\"btextforgrid\" type=\"text\" id="+repeat+"  value=\"\"  onchange=\"javascript:return checkdate(Form1."+repeat+");\" onkeypress=\"return dateenter();\"><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1."+repeat+", Form1."+repeat+", "+dat+");\" height=\"14\" width=\"14\" /></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextforgrid\" type=\"text\" id=" + repeat + "  value=\"\"  onchange=\"javascript:return checkdate(Form1." + repeat + ");\" onkeypress=\"return dateenter();\"><img src=\"Images/cal1.gif\"  onclick=\"popUpCalendar(Form1." + repeat + ", Form1." + repeat + ", " + dat + ");\" height=\"14\" width=\"14\" />";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        //str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }



                namecode = "one";
                //str=str+"<td><select id="+premid+" class=\"dropdownforgrid\" onchange=\"return getpercenprem("+premid+","+i+",'"+namecode+"');\"  >";

                ///this is to bind the premium drop down
                //str=str+"<option value=\"0\" selected=\"true\">select</option>";
                //for(k=0;k<=ds.Tables[2].Rows.length-1;k++)
                //{
                ////////on click function is there to get the prem % on premium drop down change
                //    str=str+"  <option value="+ds.Tables[2].Rows[k].Premiumcode+">"+ds.Tables[2].Rows[k].premiumname+"</option>"
                //}

                premper = "premper" + i;
                premper1 = "premperone" + i;
                adtypid = "adtyp" + i;
                namecode = "two";
                preall = "preall" + i;
                adcat = "adcat" + i;
                page = "pgpre" + i;
                pageprem = "pagper" + i;
                //str=str+"</select></td><td><input class=\"btextsmallsize\" disabled type=\"text\" id="+premper+" value=\"\"></td><td><select id="+prem1id+" class=\"dropdownforgrid\" onchange=\"return getpercenprem("+prem1id+","+i+",'"+namecode+"');\"  >";
                /////this is to bind the premium 2 drop down
                //str=str+"<option value=\"0\" selected=\"true\">select</option>";
                //for(k=0;k<=ds.Tables[2].Rows.length-1;k++)
                //{
                ////////on click function is there to get the prem % on premium drop down change
                //    str=str+"  <option value="+ds.Tables[2].Rows[k].Premiumcode+">"+ds.Tables[2].Rows[k].premiumname+"</option>"
                // }

                //str=str+"</select></td><td><input disabled class=\"btextsmallsize\" type=\"text\" id="+premper1+" value=\"\"></td>"
                //
                pagstr = "sec"
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[27].childNodes[0].nodeValue == "enable") {
                        if (dprem1 == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dprem1 = dprem1 + "<select id=" + page + " class=\"dropdownforgridqbc\" onchange=\"return getpageprem(" + page + "," + i + ",'" + pagstr + "');\"  >";
                            /////this is to bind the premium 2 drop down
                            dprem1 = dprem1 + "  <option value=\"0\" selected=\"true\">Select</option>";
                            var h;
                            for (h = 0; h <= ds.Tables[7].Rows.length - 1; h++) {
                                ////////on click function is there to get the prem % on premium drop down change
                                dprem1 = dprem1 + "  <option value=" + ds.Tables[7].Rows[h].pos_type_code + ">" + ds.Tables[7].Rows[h].pos_type_code + "</option>"
                            }

                            dprem1 = dprem1 + "</select>";
                            //str=str+dprem1;
                            make_td.innerHTML = dprem1;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dprem1.replace("pgpre" + dcou, page);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                        }
                    }
                    else {
                        //  str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(13).text == "enable") {
                        if (dprem1 == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dprem1 = dprem1 + "<select id=" + page + " class=\"dropdownforgridqbc\" onchange=\"return getpageprem(" + page + "," + i + ",'" + pagstr + "');\"  >";
                            /////this is to bind the premium 2 drop down
                            dprem1 = dprem1 + "  <option value=\"0\" selected=\"true\">Select</option>";
                            var h;
                            for (h = 0; h <= ds.Tables[7].Rows.length - 1; h++) {
                                ////////on click function is there to get the prem % on premium drop down change
                                dprem1 = dprem1 + "  <option value=" + ds.Tables[7].Rows[h].pos_type_code + ">" + ds.Tables[7].Rows[h].pos_type_code + "</option>"
                            }

                            dprem1 = dprem1 + "</select>";
                            // str=str+dprem1;
                            make_td.innerHTML = dprem1;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dprem1.replace("pgpre" + dcou, page);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                        }
                    }
                    else {
                        //str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }

                ////this is to bind the per for page premium
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[29].childNodes[0].nodeValue == "enable") {
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextsmallsize\" type=\"text\" id=" + pageprem + " value=\"\">"
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                        // str=str+"<td><input disabled class=\"btextsmallsize\" type=\"text\" id="+pageprem+" value=\"\"></td>"
                    }
                    else {
                        // str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(14).text == "enable") {
                        //  str=str+"<td><input disabled class=\"btextsmallsize\" type=\"text\" id="+pageprem+" value=\"\"></td>"
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input disabled class=\"btextsmallsize\" type=\"text\" id=" + pageprem + " value=\"\">"
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        // str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }

                ///////////////////////////////////////////////

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[31].childNodes[0].nodeValue == "enable") {
                        if (dpre == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dpre = dpre + "<select id=" + preall + " class=\"dropdownforgrid\">";
                            //////////////this is to bind the drop down for accepting the premium

                            dpre = dpre + "<option value=\"0\">Select</option>";
                            dpre = dpre + "<option value=\"1\">Yes</option>";
                            dpre = dpre + "<option value=\"2\">No</option>";

                            dpre = dpre + "</select>";
                            //str=str+dpre;
                            make_td.innerHTML = dpre;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dpre.replace("preall" + dcou, preall);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                            //str=str+dpre.replace("preall"+dcou,preall);
                        }
                    }
                    else {
                        // str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(15).text == "enable") {
                        if (dpre == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dpre = dpre + "<select id=" + preall + " class=\"dropdownforgrid\">";
                            //////////////this is to bind the drop down for accepting the premium

                            dpre = dpre + "<option value=\"0\">Select</option>";
                            dpre = dpre + "<option value=\"1\">Yes</option>";
                            dpre = dpre + "<option value=\"2\">No</option>";

                            dpre = dpre + "</select>";
                            //str=str+dpre;
                            make_td.innerHTML = dpre;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dpre.replace("preall" + dcou, preall);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                            //      str=str+dpre.replace("preall"+dcou,preall);
                        }
                    }
                    else {
                        // str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[33].childNodes[0].nodeValue == "enable") {
                        if (dmcat == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dmcat = dmcat + "<select id=" + adcat + " class=\"dropdownforgridqbc\" onchange=\"filladsubgrid(" + adcat + "," + adsubcat + ")\">";

                            ///this loop is to bind the ad category
                            dmcat = dmcat + "<option value=\"0\" selected=\"true\">select</option>";
                            for (o = 0; o <= ds.Tables[6].Rows.length - 1; o++) {
                                if (ds.Tables[6].Rows[o].adv_cat_code == document.getElementById('drpadcategory').value && document.getElementById('drpadcategory').value != "0") {
                                    dmcat = dmcat + "<option value=" + ds.Tables[6].Rows[o].adv_cat_code + " selected=" + document.getElementById('drpadcategory').value + ">" + ds.Tables[6].Rows[o].adv_cat_code + "</option>";
                                }
                                else {
                                    dmcat = dmcat + "<option value=" + ds.Tables[6].Rows[o].adv_cat_code + ">" + ds.Tables[6].Rows[o].adv_cat_code + "</option>";
                                }
                            }

                            dmcat = dmcat + "</select>";
                            //str=str+dmcat;
                            make_td.innerHTML = dmcat;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dmcat.replace("adcat" + dcou, adcat);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                            //     str=str+dmcat.replace("adcat"+dcou,adcat);
                        }

                    }
                    else {
                        //str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(16).text == "enable") {
                        if (dmcat == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dmcat = dmcat + "<select id=" + adcat + " class=\"dropdownforgridqbc\" onchange=\"filladsubgrid(" + adcat + "," + adsubcat + ")\">";

                            ///this loop is to bind the ad category
                            dmcat = dmcat + "<option value=\"0\" selected=\"true\">select</option>";
                            for (o = 0; o <= ds.Tables[6].Rows.length - 1; o++) {
                                if (ds.Tables[6].Rows[o].adv_cat_code == document.getElementById('drpadcategory').value && document.getElementById('drpadcategory').value != "0") {
                                    dmcat = dmcat + "<option value=" + ds.Tables[6].Rows[o].adv_cat_code + " selected=" + document.getElementById('drpadcategory').value + ">" + ds.Tables[6].Rows[o].adv_cat_code + "</option>";
                                }
                                else {
                                    dmcat = dmcat + "<option value=" + ds.Tables[6].Rows[o].adv_cat_code + ">" + ds.Tables[6].Rows[o].adv_cat_code + "</option>";
                                }
                            }

                            dmcat = dmcat + "</select>";
                            // str=str+dmcat;
                            make_td.innerHTML = dmcat;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dmcat.replace("adcat" + dcou, adcat);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                            //     str=str+dmcat.replace("adcat"+dcou,adcat);    
                        }
                    }
                    else {
                        // str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }


                billstat = "bill" + i;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[35].childNodes[0].nodeValue == "enable") {
                        if (dbill == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dbill = dbill + "<select id=" + billstat + " class=\"dropdownforgrid\">";

                            /////////////this function is to bind the bill status dropdown

                            var c = 0;
                            for (c = 1; c <= xmlObj.childNodes[3].childNodes.length - 1; c = c + 4) {
                                dbill = dbill + "<option value=" + xmlObj.childNodes[3].childNodes[c + 2].childNodes[0].nodeValue + ">" + xmlObj.childNodes[3].childNodes[c].childNodes[0].nodeValue + "</option>";
                            }
                            dbill = dbill + "</select>";
                            //str=str+dbill;
                            make_td.innerHTML = dbill;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dbill.replace("bill" + dcou, billstat);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);

                            //     str=str+dbill.replace("bill"+dcou,billstat);          
                        }
                    }
                    else {
                        // str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(17).text == "enable") {
                        if (dbill == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dbill = dbill + "<select id=" + billstat + " class=\"dropdownforgrid\">";

                            /////////////this function is to bind the bill status dropdown

                            //var xmlDoc = new ActiveXObject("Microsoft.XMLDOM"); 
                            //loadXML('xml/billcycle.xml');

                            var c = 0;

                            for (c = 0; c <= xmlObj.childNodes(1).childNodes.length - 1; c++) {
                                dbill = dbill + "<option value=" + xmlObj.childNodes(1).childNodes(c + 1).text + ">" + xmlObj.childNodes(1).childNodes(c).text + "</option>";
                                c = c + 1;
                            }


                            dbill = dbill + "</select>";
                            //str=str+dbill;   
                            make_td.innerHTML = dbill;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dbill.replace("bill" + dcou, billstat);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                            //     str=str+dbill.replace("bill"+dcou,billstat);               
                        }
                    }
                    else {
                        //str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }

                paid = "pai" + i;
                solo = "sol" + i;
                gross = "gro" + i;
                ///////////////this is to bind the drop down for paid/free insertion

                if (ds.Tables[9].Rows[0].Paid_permission == "0") {
                    if (browser != "Microsoft Internet Explorer") {

                        if (xmlObj.childNodes[23].childNodes[37].childNodes[0].nodeValue == "enable") {
                            if (dpaid == "") {
                                make_td = document.createElement("td");
                                make_td.align = "center";
                                dpaid = dpaid + "<td><select id=" + paid + " class=\"dropdownforgridsmall\" disabled >";
                                dpaid = dpaid + "<option value=\"Y\">Yes</option>";
                                dpaid = dpaid + "<option value=\"N\">No</option>";
                                dpaid = dpaid + "<option value=\"P\">Paid</option>";
                                dpaid = dpaid + "</select></td>";
                                //str=str+dpaid; 
                                make_td.innerHTML = dpaid;
                                Make_Row.appendChild(make_td);
                            }
                            else {
                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = dpaid.replace("pai" + dcou, paid);
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);

                                //   str=str+dpaid.replace("pai"+dcou,paid);     
                            }
                        }
                        else {
                            // str=str+"<td style=\"display:none;\"></td>";
                            make_td = document.createElement("td");
                            make_td.style.display = "none";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(18).text == "enable") {
                            if (dpaid == "") {
                                make_td = document.createElement("td");
                                make_td.align = "center";
                                dpaid = dpaid + "<td><select id=" + paid + " class=\"dropdownforgridsmall\" disabled >";
                                dpaid = dpaid + "<option value=\"Y\">Yes</option>";
                                dpaid = dpaid + "<option value=\"N\">No</option>";
                                dpaid = dpaid + "<option value=\"P\">Paid</option>";
                                dpaid = dpaid + "</select></td>";
                                //str=str+dpaid; 
                                make_td.innerHTML = dpaid;
                                Make_Row.appendChild(make_td);
                            }
                            else {
                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = dpaid.replace("pai" + dcou, paid);
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);
                                //   str=str+dpaid.replace("pai"+dcou,paid);  
                            }
                        }
                        else {
                            //str=str+"<td style=\"display:none;\"></td>";
                            make_td = document.createElement("td");
                            make_td.style.display = "none";
                        }
                    }
                }
                else {
                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[37].childNodes[0].nodeValue == "enable") {
                            if (dpaid == "") {
                                make_td = document.createElement("td");
                                make_td.align = "center";
                                dpaid = dpaid + "<td><select id=" + paid + " class=\"dropdownforgridsmall\" disabled >";
                                dpaid = dpaid + "<option value=\"Y\">Yes</option>";
                                dpaid = dpaid + "<option value=\"N\">No</option>";
                                dpaid = dpaid + "<option value=\"P\">Paid</option>";
                                dpaid = dpaid + "</select></td>";
                                //str=str+dpaid; 
                                make_td.innerHTML = dpaid;
                                Make_Row.appendChild(make_td);
                            }
                            else {
                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = dpaid.replace("pai" + dcou, paid);
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);
                                //str=str+dpaid.replace("pai"+dcou,paid);   
                            }
                        }
                        else {
                            // str=str+"<td style=\"display:none;\"></td>";
                            make_td = document.createElement("td");
                            make_td.style.display = "none";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(18).text == "enable") {
                            if (dpaid == "") {
                                make_td = document.createElement("td");
                                make_td.align = "center";
                                dpaid = dpaid + "<td><select id=" + paid + " class=\"dropdownforgridsmall\" disabled >";
                                dpaid = dpaid + "<option value=\"Y\">Yes</option>";
                                dpaid = dpaid + "<option value=\"N\">No</option>";
                                dpaid = dpaid + "<option value=\"P\">Paid</option>";
                                dpaid = dpaid + "</select></td>";
                                //str=str+dpaid; 
                                make_td.innerHTML = dpaid;
                                Make_Row.appendChild(make_td);
                            }
                            else {
                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = dpaid.replace("pai" + dcou, paid);
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);
                                //     str=str+dpaid.replace("pai"+dcou,paid); 
                            }
                        }
                        else {
                            //str=str+"<td style=\"display:none;\"></td>";
                            make_td = document.createElement("td");
                            make_td.style.display = "none";
                        }
                    }
                }
                //str=str+"<option value=\"0\">Select</option>";


                //this is to upload the image

                billamt = "ba" + i;

                // Solo Rate

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[39].childNodes[0].nodeValue == "enable") {
                        //str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+solo+"  value=\"\"></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + solo + "  value=\"\">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        //str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(19).text == "enable") {
                        //str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+solo+"  value=\"\"></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + solo + "  value=\"\">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        // str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }

                // Gross Amount
                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[41].childNodes[0].nodeValue == "enable") {
                        //str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+gross+"  value=\"\"></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + gross + "  value=\"\">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        //str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(20).text == "enable") {
                        // str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+gross+"  value=\"\"></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + gross + "  value=\"\">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        // str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }

                ////
                pageno_inserts = "pagno" + i; ;
                remark_inserts = "rem" + i;
                billrate = "br" + i;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[43].childNodes[0].nodeValue == "enable") {
                        // str=str+"<td><input  class=\"btextforinsertright\" onkeypress=\"javascript:return rateenter(Form1."+pageno_inserts+");\"   type=\"text\" id="+pageno_inserts+"  value=\"\"></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input  class=\"btextforinsertright\" onkeypress=\"javascript:return rateenter(Form1." + pageno_inserts + ");\"   type=\"text\" id=" + pageno_inserts + "  value=\"\">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        // str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(21).text == "enable") {
                        //str=str+"<td><input  class=\"btextforinsertright\" onkeypress=\"javascript:return rateenter(Form1."+pageno_inserts+");\"   type=\"text\" id="+pageno_inserts+"  value=\"\"></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input  class=\"btextforinsertright\" onkeypress=\"javascript:return rateenter(Form1." + pageno_inserts + ");\"   type=\"text\" id=" + pageno_inserts + "  value=\"\">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        //str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[45].childNodes[0].nodeValue == "enable") {
                        // str=str+"<td><input  class=\"btextforgrid\"    type=\"text\" id="+remark_inserts+"  value=\"\"></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input  class=\"btextforgridedition\"    type=\"text\" id=" + remark_inserts + "  value=\"\">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        // str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(22).text == "enable") {
                        //str=str+"<td><input  class=\"btextforgrid\"    type=\"text\" id="+remark_inserts+"  value=\"\"></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input  class=\"btextforgridedition\"    type=\"text\" id=" + remark_inserts + "  value=\"\">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        //str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }


                ///
                // Bill Amount

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[47].childNodes[0].nodeValue == "enable") {
                        // str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+billamt+"  value=\"\"></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextforinsertright\" disabled type=\"text\" id=" + billamt + "  value=\"\">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        //str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(23).text == "enable") {
                        // str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+billamt+"  value=\"\"></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextforinsertright\" disabled type=\"text\" id=" + billamt + "  value=\"\">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        // str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }

                //Bill Rate

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[49].childNodes[0].nodeValue == "enable") {
                        // str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+billrate+"  value=\"\"></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + billrate + "  value=\"\">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        //str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(24).text == "enable") {
                        // str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+billrate+"  value=\"\"></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + billrate + "  value=\"\">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        // str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }

                // card rate
                var cs = 0;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[51].childNodes[0].nodeValue == "enable") {
                        // str=str+"<td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        for (cs = 0; cs <= ds.Tables[8].Rows.length - 1; cs++) {
                            if (ds.Tables[0].Rows[i].Edition_Name != undefined) {
                                if (ds.Tables[0].Rows[i].Edition_Name == ds.Tables[8].Rows[cs].Edition_Name) {
                                    str = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cardid + " value=" + ds.Tables[8].Rows[cs].weekrate + ">";
                                }
                            }

                        }
                        ///////////////////////

                        if (ds.Tables[8].Rows.length == 0) {
                            str = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cardid + " value=\"\">";
                        }
                        // str=str+"</td>";
                    }
                    else {
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(25).text == "enable") {
                        // str=str+"<td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        for (cs = 0; cs <= ds.Tables[8].Rows.length - 1; cs++) {
                            if (ds.Tables[0].Rows[i].Edition_Name != undefined) {
                                if (ds.Tables[0].Rows[i].Edition_Name == ds.Tables[8].Rows[cs].Edition_Name) {
                                    str = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cardid + " value=" + ds.Tables[8].Rows[cs].weekrate + ">";
                                }
                            }

                        }
                        ///////////////////////

                        if (ds.Tables[8].Rows.length == 0) {
                            str = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + cardid + " value=\"\">";
                        }
                        //str=str+"</td>";
                    }
                    else {
                        // str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
                ///////////////////////
                discrate = "disrat" + i;

                // Discount Rate

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[53].childNodes[0].nodeValue == "enable") {
                        //str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+discrate+"  value=\"\"></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + discrate + "  value=\"\">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        //str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(26).text == "enable") {
                        // str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+discrate+"  value=\"\"></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + discrate + "  value=\"\">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        //  str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }

                // Agreed Rate

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[55].childNodes[0].nodeValue == "enable") {
                        // str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+agrred+"  value=\"\"></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agrred + "  value=\"\">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        //str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(27).text == "enable") {
                        // str=str+"<td><input class=\"btextforgrid\" disabled type=\"text\" id="+agrred+"  value=\"\"></td>";
                        make_td = document.createElement("td");
                        make_td.align = "center";
                        str = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + agrred + "  value=\"\">";
                        make_td.innerHTML = str;
                        Make_Row.appendChild(make_td);
                    }
                    else {
                        //str=str+"<td style=\"display:none;\"></td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }



                if (document.getElementById('hiddenuomdesc').value != "CD") {
                    if (browser != "Microsoft Internet Explorer") {
                        if (xmlObj.childNodes[23].childNodes[57].childNodes[0].nodeValue == "enable") {
                            //str=str+"<td><input class=\"btextsmallsize\" disabled id="+size+" type=\"text\" onchange=\"return getsoloextrarateforqbc("+adsubcat+","+colid+","+editid+","+size+","+adcat+","+gross+","+i+");\"  value="+document.getElementById('txttotalarea').value+"></td>";
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = "<input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\" onchange=\"return getsoloextrarateforqbc(" + adsubcat + "," + colid + "," + editid + "," + size + "," + adcat + "," + gross + "," + i + ");\"  value=" + document.getElementById('txttotalarea').value + ">";
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            // str=str+"<td style=\"display:none;\"></td>";
                            make_td = document.createElement("td");
                            make_td.style.display = "none";
                        }
                    }
                    else {
                        if (xmlObj.childNodes(11).childNodes(28).text == "enable") {
                            //str=str+"<td><input class=\"btextsmallsize\" disabled id="+size+" type=\"text\" onchange=\"return getsoloextrarateforqbc("+adsubcat+","+colid+","+editid+","+size+","+adcat+","+gross+","+i+");\"  value="+document.getElementById('txttotalarea').value+"></td>";
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = "<input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\" onchange=\"return getsoloextrarateforqbc(" + adsubcat + "," + colid + "," + editid + "," + size + "," + adcat + "," + gross + "," + i + ");\"  value=" + document.getElementById('txttotalarea').value + ">";
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            //str=str+"<td style=\"display:none;\"></td>";
                            make_td = document.createElement("td");
                            make_td.style.display = "none";
                        }
                    }

                }
                else {
                    if (document.getElementById('txtcolum').disabled == true) {
                        if (browser != "Microsoft Internet Explorer") {
                            if (xmlObj.childNodes[23].childNodes[57].childNodes[0].nodeValue == "enable") {
                                //str=str+"<td><input class=\"btextsmallsize\" disabled id="+size+" type=\"text\"  value="+document.getElementById('txttotalarea').value+"></td>";
                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = "<input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\" value=" + document.getElementById('txttotalarea').value + ">";
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);
                            }
                            else {
                                //str=str+"<td style=\"display:none;\"></td>";
                                make_td = document.createElement("td");
                                make_td.style.display = "none";
                            }
                        }
                        else {
                            if (xmlObj.childNodes(11).childNodes(28).text == "enable") {
                                // str=str+"<td><input class=\"btextsmallsize\" disabled id="+size+" type=\"text\"  value="+document.getElementById('txttotalarea').value+"></td>";
                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = "<input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\" value=" + document.getElementById('txttotalarea').value + ">";
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);
                            }
                            else {
                                //str=str+"<td style=\"display:none;\"></td>";
                                make_td = document.createElement("td");
                                make_td.style.display = "none";
                            }
                        }

                    }
                    else {
                        if (browser != "Microsoft Internet Explorer") {
                            if (xmlObj.childNodes[23].childNodes[57].childNodes[0].nodeValue == "enable") {
                                // str=str+"<td><input class=\"btextsmallsize\" disabled id="+size+" type=\"text\"  value="+document.getElementById('txttotalarea').value+"></td>";
                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = "<input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\" value=" + document.getElementById('txttotalarea').value + ">";
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);
                            }
                            else {
                                //str=str+"<td style=\"display:none;\"></td>";
                                make_td = document.createElement("td");
                                make_td.style.display = "none";
                            }
                        }
                        else {
                            if (xmlObj.childNodes(11).childNodes(28).text == "enable") {
                                // str=str+"<td><input class=\"btextsmallsize\" disabled id="+size+" type=\"text\"  value="+document.getElementById('txttotalarea').value+"></td>";
                                make_td = document.createElement("td");
                                make_td.align = "center";
                                str = "<input class=\"btextsmallsize\" disabled id=" + size + " type=\"text\" value=" + document.getElementById('txttotalarea').value + ">";
                                make_td.innerHTML = str;
                                Make_Row.appendChild(make_td);
                            }
                            else {
                                //str=str+"<td style=\"display:none;\"></td>";
                                make_td = document.createElement("td");
                                make_td.style.display = "none";
                            }
                        }

                    }
                }
                /////////////////////////////////////////////////// 03 July ///////////////////////////

                ////this is to bind the Ad sub cat3 drop down

                adsubcat3 = "adscat3" + i;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[59].childNodes[0].nodeValue == "enable") {
                        if (dadcat3 == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";

                            dadcat3 = dadcat3 + "<select id=" + adsubcat3 + " class=\"dropdownforgridqbc\" onchange=\"getadsubcat4(" + adsubcat3 + "," + i + ");\">";
                            // this is to bind adv sub cat drop down
                            dadcat3 = dadcat3 + "<option value=\"0\" selected=\"true\">-select-</option>";
                            if (ds.Tables[9].Rows.length > 0) {
                                for (l = 0; l <= ds.Tables[9].Rows.length - 1; l++) {
                                    if (ds.Tables[9].Rows[l].catcode == document.getElementById('drpadcat3').value && document.getElementById('drpadcat3').value != "0") {
                                        dadcat3 = dadcat3 + "<option value=" + ds.Tables[9].Rows[l].catcode + " selected=" + document.getElementById('drpadcat3').value + ">" + ds.Tables[3].Rows[l].catcode + "</option>";
                                    }
                                    else {
                                        dadcat3 = dadcat3 + "<option value=" + ds.Tables[9].Rows[l].catcode + ">" + ds.Tables[9].Rows[l].catcode + "</option>";
                                    }
                                }
                            }

                            dadcat3 = dadcat3 + "</select>";
                            //str=str+dadcat3;
                            make_td.innerHTML = dadcat3;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            //     str=str+dadcat3.replace("adscat3"+dcou,adsubcat3);
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dadcat3.replace("adscat3" + dcou, adsubcat3);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                        }
                    }
                    else {
                        //str+="<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(29).text == "enable") {
                        if (dadcat3 == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";

                            dadcat3 = dadcat3 + "<select id=" + adsubcat3 + " class=\"dropdownforgridqbc\" onchange=\"getadsubcat4(" + adsubcat3 + "," + i + ");\">";
                            // this is to bind adv sub cat drop down
                            dadcat3 = dadcat3 + "<option value=\"0\" selected=\"true\">-select-</option>";
                            if (ds.Tables[10].Rows.length > 0) {
                                for (l = 0; l <= ds.Tables[10].Rows.length - 1; l++) {
                                    if (ds.Tables[10].Rows[l].catcode == document.getElementById('drpadcat3').value && document.getElementById('drpadcat3').value != "0") {
                                        dadcat3 = dadcat3 + "<option value=" + ds.Tables[10].Rows[l].catcode + " selected=" + document.getElementById('drpadcat3').value + ">" + ds.Tables[10].Rows[l].catcode + "</option>";
                                    }
                                    else {
                                        dadcat3 = dadcat3 + "<option value=" + ds.Tables[10].Rows[l].catcode + ">" + ds.Tables[10].Rows[l].catcode + "</option>";
                                    }
                                }
                            }

                            dadcat3 = dadcat3 + "</select>";
                            //str=str+dadcat3;  
                            make_td.innerHTML = dadcat3;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dadcat3.replace("adscat3" + dcou, adsubcat3);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                            //    str=str+dadcat3.replace("adscat3"+dcou,adsubcat3);       
                        }
                    }
                    else {
                        // str+="<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }

                ////this is to bind the Ad sub cat4 drop down

                adsubcat4 = "adscat4" + i;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[61].childNodes[0].nodeValue == "enable") {
                        if (dadcat4 == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dadcat4 = dadcat4 + "<select id=" + adsubcat4 + " class=\"dropdownforgridqbc\" onchange=\"getadsubcat5(" + adsubcat4 + "," + i + ");\">";
                            // this is to bind adv sub cat drop down
                            dadcat4 = dadcat4 + "<option value=\"0\" selected=\"true\">-select-</option>";
                            if (ds.Tables[11].Rows.length > 0) {
                                for (l = 0; l <= ds.Tables[11].Rows.length - 1; l++) {
                                    if (ds.Tables[11].Rows[l].Adv_Subcat_Code == document.getElementById('drpadcat4').value && document.getElementById('drpadcat4').value != "0") {
                                        dadcat4 = dadcat4 + "<option value=" + ds.Tables[11].Rows[l].Cat_Code + " selected=" + document.getElementById('drpadcat4').value + ">" + ds.Tables[11].Rows[l].Cat_Code + "</option>";
                                    }
                                    else {
                                        dadcat4 = dadcat4 + "<option value=" + ds.Tables[11].Rows[l].Cat_Code + ">" + ds.Tables[11].Rows[l].Cat_Code + "</option>";
                                    }
                                }
                            }
                            dadcat4 = dadcat4 + "</select></td>";
                            //str=str+dadcat4;
                            make_td.innerHTML = dadcat4;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dadcat4.replace("adscat4" + dcou, adsubcat4);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                            //    str=str+dadcat4.replace("adscat4"+dcou,adsubcat4);
                        }
                    }
                    else {
                        //str+="<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(30).text == "enable") {
                        if (dadcat4 == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dadcat4 = dadcat4 + "<select id=" + adsubcat4 + " class=\"dropdownforgridqbc\" onchange=\"getadsubcat5(" + adsubcat4 + "," + i + ");\">";
                            // this is to bind adv sub cat drop down
                            dadcat4 = dadcat4 + "<option value=\"0\" selected=\"true\">-select-</option>";
                            if (ds.Tables[11].Rows.length > 0) {
                                for (l = 0; l <= ds.Tables[11].Rows.length - 1; l++) {
                                    if (ds.Tables[11].Rows[l].Cat_Code == document.getElementById('drpadcat4').value && document.getElementById('drpadcat4').value != "0") {
                                        dadcat4 = dadcat4 + "<option value=" + ds.Tables[11].Rows[l].Cat_Code + " selected=" + document.getElementById('drpadcat4').value + ">" + ds.Tables[11].Rows[l].Cat_Code + "</option>";
                                    }
                                    else {
                                        dadcat4 = dadcat4 + "<option value=" + ds.Tables[11].Rows[l].Cat_Code + ">" + ds.Tables[11].Rows[l].Cat_Code + "</option>";
                                    }
                                }
                            }

                            dadcat4 = dadcat4 + "</select>";
                            make_td.innerHTML = dadcat4;
                            Make_Row.appendChild(make_td);
                            // str=str+dadcat4;
                        }
                        else {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dadcat4.replace("adscat4" + dcou, adsubcat4);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                            //   str=str+dadcat4.replace("adscat4"+dcou,adsubcat4);   
                        }
                    }
                    else {
                        //str+="<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }

                ////this is to bind the Ad sub cat5 drop down

                adsubcat5 = "adscat5" + i;

                if (browser != "Microsoft Internet Explorer") {
                    if (xmlObj.childNodes[23].childNodes[63].childNodes[0].nodeValue == "enable") {
                        if (dadcat5 == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dadcat5 = dadcat5 + "<select id=" + adsubcat5 + " class=\"dropdownforgridqbc\" \>"; // onchange=\"getadsubcat5("+adsubcat4+","+i+");\">";
                            // this is to bind adv sub cat drop down
                            dadcat5 = dadcat5 + "<option value=\"0\" selected=\"true\">-select-</option>";
                            if (ds.Tables[12].Rows.length > 0) {
                                for (l = 0; l <= ds.Tables[12].Rows.length - 1; l++) {
                                    if (ds.Tables[12].Rows[l].Cat_Code == document.getElementById('drpadcat5').value && document.getElementById('drpadcat5').value != "0") {
                                        dadcat5 = dadcat5 + "<option value=" + ds.Tables[12].Rows[l].Cat_Code + " selected=" + document.getElementById('drpadcat5').value + ">" + ds.Tables[12].Rows[l].Cat_Code + "</option>";
                                    }
                                    else {
                                        dadcat5 = dadcat5 + "<option value=" + ds.Tables[12].Rows[l].Cat_Code + ">" + ds.Tables[12].Rows[l].Cat_Code + "</option>";
                                    }
                                }
                            }

                            dadcat5 = dadcat5 + "</select>";
                            //str=str+dadcat5;
                            make_td.innerHTML = dadcat5;
                            Make_Row.appendChild(make_td);
                        }
                        else {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dadcat5.replace("adscat5" + dcou, adsubcat5);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                            //    str=str+dadcat5.replace("adscat5"+dcou,adsubcat5);   
                        }
                    }
                    else {
                        // str+="<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }
                else {
                    if (xmlObj.childNodes(11).childNodes(31).text == "enable") {
                        if (dadcat5 == "") {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            dadcat5 = dadcat5 + "<select id=" + adsubcat5 + " class=\"dropdownforgridqbc\" \>"; // onchange=\"getadsubcat5("+adsubcat4+","+i+");\">";
                            // this is to bind adv sub cat drop down
                            dadcat5 = dadcat5 + "<option value=\"0\" selected=\"true\">-select-</option>";
                            if (ds.Tables[12].Rows.length > 0) {
                                for (l = 0; l <= ds.Tables[12].Rows.length - 1; l++) {
                                    if (ds.Tables[12].Rows[l].Cat_Code == document.getElementById('drpadcat5').value && document.getElementById('drpadcat5').value != "0") {
                                        dadcat5 = dadcat5 + "<option value=" + ds.Tables[12].Rows[l].Cat_Code + " selected=" + document.getElementById('drpadcat5').value + ">" + ds.Tables[12].Rows[l].Cat_Code + "</option>";
                                    }
                                    else {
                                        dadcat5 = dadcat5 + "<option value=" + ds.Tables[12].Rows[l].Cat_Code + ">" + ds.Tables[12].Rows[l].Cat_Code + "</option>";
                                    }
                                }
                            }

                            dadcat5 = dadcat5 + "</select>";
                            make_td.innerHTML = dadcat5;
                            Make_Row.appendChild(make_td);
                            //str=str+dadcat5;  
                        }
                        else {
                            make_td = document.createElement("td");
                            make_td.align = "center";
                            str = dadcat5.replace("adscat5" + dcou, adsubcat5);
                            make_td.innerHTML = str;
                            Make_Row.appendChild(make_td);
                            //    str=str+dadcat5.replace("adscat5"+dcou,adsubcat5);       
                        }
                    }
                    else {
                        // str+="<td align=\"center\" valign=\"top\" style=\"display:none;\">Ad Sub Cat.</td>";
                        make_td = document.createElement("td");
                        make_td.style.display = "none";
                    }
                }

                pkgcodegrid = 'hiddenpckcode' + i;
                //This is a hidden field in the insertion grid which holds the Package Code for internal processing only
                make_td = document.createElement("td");
                make_td.align = "center";
                //  make_td.id=pkgcodegrid
                str = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkgcodegrid + "' value=" + ds.Tables[0].Rows[i].EDITION_CODE + ">";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
                //str=str+"<td><input disabled class=\"btextsmallsize\" type=\"text\" id='"+pkgcodegrid+"' value="+ds.Tables[0].Rows[i].EDITION_CODE+"></td>";
                ////////////////////////////////////////////////// 03 July ///////////////////////////

                var pkg_ins = 'pkg_ins' + i;
                make_td = document.createElement("td");
                make_td.align = "center";
                //   make_td.id=pkg_ins
                str = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_ins + "' value=''>";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
                //str=str+"<td><input disabled class=\"btextsmallsize\" type=\"text\" id='"+pkg_ins+"' value=''></td>";

                pkg_alias = 'pkg_alias' + i;
                make_td = document.createElement("td");
                make_td.align = "center";
                //   make_td.id=pkg_alias
                str = "<input disabled class=\"btextsmallsize\" type=\"text\" id='" + pkg_alias + "' value='" + ds.Tables[0].Rows[i].PKGNAME + "'>";
                make_td.innerHTML = str;
                Make_Row.appendChild(make_td);
                //str=str+"<td><input disabled class=\"btextsmallsize\" type=\"text\" id='"+pkg_alias+"' value='"+ds.Tables[0].Rows[i].PKGNAME+"'></td>";
                //}

                //new change ankur 23 feb
                //new change ankur 23 feb
                logoH = "lh" + i;
                logoW = "lw" + i;
                logonam = "lnam" + i
                var tdsln = "tdsln" + i;
                var tdslh = "tdslh" + i;
                var tdslw = "tdslw" + i;
                var tdslup = "tdslup" + i;
                gblogowithmatter = "no";
                if (gblogowithmatter == "yes") {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.id = tdsln
                    str = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + logonam + "  value=\"\">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.id = tdslh
                    str = "<input class=\"btextforgrid\" disabled onchange=\"return gettotalsize_logo(" + logoH + "," + logoW + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" type=\"text\" id=" + logoH + "  value=" + document.getElementById('txtlogohei').value + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.id = tdslw
                    str = "<input class=\"btextforgrid\" disabled onchange=\"return gettotalsize_logo(" + logoH + "," + logoW + "," + i + "," + inserts + "," + insertval + "," + noofcol + ");\" type=\"text\" id=" + logoW + "  value=" + document.getElementById('txtlogowid').value + ">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.id = tdslup
                    str = "<input  class=\"button1\" type=\"button\" Value=\"Logo Upload\" onclick=\"uploadimagelogo('" + ds.Tables[0].Rows[i].Edition_Name + "','" + picfield + "','" + insertval + "','" + editid + "','" + logonam + "','" + i + "')\">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                }
                else {
                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.id = tdsln
                    make_td.style.display = "none";
                    str = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + logonam + "  value=\"\">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.id = tdslh
                    make_td.style.display = "none";
                    str = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + logoH + "  value=\"\">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.id = tdslw
                    make_td.style.display = "none";
                    str = "<input class=\"btextforgrid\" disabled type=\"text\" id=" + logoW + "  value=\"\">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);

                    make_td = document.createElement("td");
                    make_td.align = "center";
                    make_td.id = tdslup
                    make_td.style.display = "none";
                    str = "<input  class=\"button1\" type=\"button\" Value=\"Logo Upload\" onclick=\"uploadimage('" + ds.Tables[0].Rows[i].Edition_Name + "','" + picfield + "','" + insertval + "','" + editid + "','" + logonam + "','" + i + "')\">";
                    make_td.innerHTML = str;
                    Make_Row.appendChild(make_td);
                }
                ////////////



                ////////////


                str = str + "</tr>";












                //  if(browser!="Microsoft Internet Explorer")
                //          {
                //                      
                //	                                      var a1="id=\""+id+"\" value=\"\"";
                //	                                      var string;
                //	                                      string=document.getElementById('tblinsert').innerHTML;
                //	                                      alert(string.indexOf(a1));
                //	                                      alert(dat_ed);
                //	                                     document.getElementById('tblinsert').innerHTML=document.getElementById('tblinsert').innerHTML.replace(a1,"id=\"\""+id+"\" value=\""+dat_ed+"\"");
                //	                                   //alert(document.getElementById('tblinsert').innerHTML);
                //	                                   
                //	  }  

                document.getElementById('gridtab').getElementsByTagName("tbody")[0].appendChild(Make_Row);
                idnew = parseInt(idnew) + 1;

                //document.getElementById(id).value=vvalue;
                i = parseInt(i) + 1;

            } ////add by anuja
        }
        //  str= str + "</table></div>";

        //  document.getElementById('tblinsert').innerHTML=str;

        for (var countpkg = 0; countpkg < document.getElementById('drppackagecopy').length; countpkg++) {
            var pkgcopy = document.getElementById('drppackagecopy').options[countpkg].value;
            var arrpkgcopy = pkgcopy.split('@')
            var pkgcopycode = arrpkgcopy[0];
            var arr_pkg_ins_value = arrpkgcopy[1].split('(');
            var pkg_ins_value = arr_pkg_ins_value[1].replace(')', '');
            for (var gridcount = 0; gridcount < document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1; gridcount++) {
                var old_pkgcodegrid = 'hiddenpckcode' + gridcount;
                var old_pkg_ins = 'pkg_ins' + gridcount;
                if (document.getElementById(old_pkgcodegrid) != null) {
                    if (pkgcopycode == document.getElementById(old_pkgcodegrid).value) {
                        document.getElementById(old_pkg_ins).value = pkg_ins_value;
                    }
                }
            }
        }

        for (i = count; i < ds.Tables[0].Rows.length; i++) {
            if (repeatdate == "0") {
                var id = "Text" + temp;
                var edit_ = "edit" + i;
                var m = parseInt(monthSelected) + 1;

                if (validuse != "validdateselection") {
                    if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                        vvalue = m + "/" + dateSelected + "/" + yearSelected;
                    }
                    else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                        vvalue = dateSelected + "/" + m + "/" + yearSelected; ;
                    }
                    else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
                        vvalue = yearSelected + "/" + m + "/" + dateSelected; ;
                    }
                }
                else {
                    var splitaliddate = document.getElementById('txtdummydate').value.split("/");
                    if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                        caldate[cali] = splitaliddate[1];
                        caldatemonth[cali] = splitaliddate[0];
                        caldateyear[cali] = splitaliddate[2];
                        vvalue = caldatemonth[cali] + "/" + caldate[cali] + "/" + caldateyear[cali];
                    }
                    else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                        caldate[cali] = splitaliddate[0];
                        caldatemonth[cali] = splitaliddate[1];
                        caldateyear[cali] = splitaliddate[2];
                        vvalue = caldate[cali] + "/" + caldatemonth[cali] + "/" + caldateyear[cali]; ;
                    }
                    else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
                        caldate[cali] = splitaliddate[2];
                        caldatemonth[cali] = splitaliddate[1];
                        caldateyear[cali] = splitaliddate[0];
                        vvalue = caldateyear[cali] + "/" + caldatemonth[cali] + "/" + caldate[cali]; ;
                    }



                }

                if (dateSelected != undefined && checkflag == 1) {

                    if (validuse == "validdateselection" && gbincinsds != "") {
                        for (var jk = 0; jk <= gbincinsds.Tables[1].Rows.length - 1; jk++) {
                            if (gbincinsds.Tables[1].Rows[jk].Edition_code == document.getElementById(edit_).value) {
                                if (gbincinsds.Tables[1].Rows[jk].date_noissue != null) {
                                    splitaliddate = gbincinsds.Tables[1].Rows[jk].date_noissue.split("/");
                                    if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                                        caldate[cali] = splitaliddate[1];
                                        caldatemonth[cali] = splitaliddate[0];
                                        caldateyear[cali] = splitaliddate[2];
                                        mond = parseInt(splitaliddate[0]);
                                        vvalue = caldatemonth[cali] + "/" + caldate[cali] + "/" + caldateyear[cali];
                                    }

                                    else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                                        caldate[cali] = splitaliddate[0];
                                        caldatemonth[cali] = splitaliddate[1];
                                        caldateyear[cali] = splitaliddate[2];
                                        mond = parseInt(splitaliddate[1]);
                                        vvalue = caldate[cali] + "/" + caldatemonth[cali] + "/" + caldateyear[cali]; ;
                                    }
                                    else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
                                        caldate[cali] = splitaliddate[2];
                                        caldatemonth[cali] = splitaliddate[1];
                                        caldateyear[cali] = splitaliddate[0];
                                        mond = parseInt(splitaliddate[1]);
                                        vvalue = caldateyear[cali] + "/" + caldatemonth[cali] + "/" + caldate[cali];
                                    }
                                }
                                break;
                            }
                        }

                        if (browser != "Microsoft Internet Explorer") {
                            //var a1="id=\"Text"+temp+"\" value=\"\"";
                            //document.getElementById('tblinsert').innerHTML=document.getElementById('tblinsert').innerHTML.replace(a1,"id=\"Text\""+temp+"\" value=\""+vvalue+"\"");
                            document.getElementById('Text' + temp).value = vvalue;

                        }
                        else {
                            document.getElementById('Text' + temp).value = vvalue;
                        }
                    }
                    else {
                        if (browser != "Microsoft Internet Explorer") {
                            // var a1="id=\"Text"+temp+"\" value=\"\"";
                            //document.getElementById('tblinsert').innerHTML=document.getElementById('tblinsert').innerHTML.replace(a1,"id=\"Text\""+temp+"\" value=\""+vvalue+"\"");
                            document.getElementById('Text' + temp).value = vvalue;
                            //alert(document.getElementById('tblinsert').innerHTML);              
                        }
                        else {
                            document.getElementById('Text' + temp).value = vvalue;
                        }
                    }
                }
            }
            temp = parseInt(temp) + 1;
        }


        checkflag = "0";
        //alert(str);
        //document.getElementById('tblinsert').innerHTML=str;
        fillcopyfilename()
    }
    return false;
}


// 5oct09
function onRepeatingDate() {
    if (document.getElementById('txtrepeatingdate').value != "") {
        document.getElementById('btnshdl').disabled = false;
        if (document.getElementById('txtinsertion').value == "0") {
            alert("Insertion can't be 0");
            return false;
        }
        document.getElementById('txtgrossamt').value = '';
        document.getElementById('txttotalamt').value = '';
        var adcat3 = document.getElementById('drpadcat3').value;
        var adcat4 = document.getElementById('drpadcat4').value;
        var adcat5 = document.getElementById('drpadcat5').value;
        var clientname = document.getElementById('txtclient').value;
        var client_split;
        if (clientname.indexOf("(") >= 0) {
            clientname = clientname.split("(");
            client_split = clientname[1];
            client_split = client_split.replace(")", "");
            clientname = client_split;

        }
        //////////////this code is to split the code as well as ites description 

        ///////this is to get the value into paid ins. text b0x
        if (document.getElementById('txtpaid').value != "") {
            var paidno = document.getElementById('txtpaid').value;
            var valinsert = document.getElementById('txtinsertion').value;
            document.getElementById('txtpaid').value = (parseInt(valinsert) - parseInt(paidno)) + parseInt(paidno);
        }

        var objpack = document.getElementById('drppackagecopy');
        var temp = "";
        var tempcode = "";
        var tempval = "";
        var tempvalcode = "";
        var desc = "";
        var code = "";
        var i = objpack.options.length;
        var j;

        for (j = 0; j < i; j++) {
            if (parseInt(i) > 0) {
                tempval = objpack[j].value;

                //tempvalcode=objpack[j].value;
                if (temp != "") {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    code = tempvalcode + "," + code;
                    desc = tempcode + "," + desc;


                }
                else {
                    temp = tempval.split("@");
                    tempvalcode = temp[0];
                    tempcode = temp[1];
                    code = tempvalcode;
                    desc = tempcode;
                }
            }

        }



        if (document.getElementById('txtrepeatingdate').value != "") {
            document.getElementById('btnshdl').disabled = false;
            var insertval = document.getElementById('txtinsertion').value
            if (parseInt(document.getElementById('txtinsertion').value) == 1) {
                //alert("In case of Insertion 1Repeating Day can't be greater than 1")
                if (document.getElementById('drppackagecopy').options.length > 0) {
                    for (var insertCou = 0; insertCou < document.getElementById('drppackagecopy').options.length; insertCou++) {
                        if (document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') >= 0) {
                            var tinsert = document.getElementById('drppackagecopy').options[insertCou].value.substring(document.getElementById('drppackagecopy').options[insertCou].value.indexOf('(') + 1, document.getElementById('drppackagecopy').options[insertCou].value.indexOf(')'));
                            if (tinsert > 1)
                                break;
                        }
                    }
                }
                if (tinsert <= 1) {
                    document.getElementById('txtrepeatingdate').value = "";
                    document.getElementById('btnshdl').disabled = true;
                    return false;
                }
            }

            repeatdate = "1";
            suboradd = "1";
        }
        else {
            repeatdate = "0";
            suboradd = "1";
        }
        if (parseInt(previnsertion) > parseInt(document.getElementById('txtinsertion').value)) {
            repeatdate = "1";
            suboradd = "0";
        }
        if (repeatdate == "1") {
            //document.getElementById('tblinsert').innerHTML="";
            subtractrow = "";
        }
        if (parseInt(document.getElementById('txtinsertion').value) > parseInt(previnsertion)) {
            suboradd = "1";
        }

        var insert = document.getElementById('hiddeninserts').value;
        var class_insert = document.getElementById('txtinsertion').value;

        var center = "0";
        if (document.getElementById("chkall").checked != true) {
            center = document.getElementById('hiddencenter').value;
        }
        var lines_to;
        if (document.getElementById('txtadsize1').disabled == false) {
            lines_to = "";
        }
        else {
            lines_to = document.getElementById('txttotalarea').value;
        }
        //if(document.getElementById('tblinsert').innerHTML=="")


        QBC.getData_fill(desc, document.getElementById('txtinsertion').value, document.getElementById('txtrepeatingdate').value, document.getElementById('txtdummydate').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value, document.getElementById('drpcolor').value, document.getElementById('drpadtype').value, document.getElementById('hiddencurrency').value, document.getElementById('txtratecode').value, document.getElementById('hiddenclickdate').value, insert, code, document.getElementById('txtcardrate').value, document.getElementById('drpuom').value, document.getElementById('txtdealrate').value, check_or, class_insert, lines_to, adcat3, adcat4, adcat5, clientname, document.getElementById('hiddenuserid').value, center, callback_repeatingdan);
    }
    //document.getElementById('txttotalarea').focus();
}

function callback_repeatingdan(res) {
    var ds = res.value;
    var i = 0;
    if (ds == null) {
        return false;
    }
    var dateformat_vari = document.getElementById("hiddendateformat");
    var compcode_vari = document.getElementById('hiddencompcode');
    var adcat = document.getElementById('drpadcategory').value;
    var inew = 0;
    for (inew = 0; inew < ds.Tables[0].Rows.length; inew++) {
        var dCheck = checkValidEdition(ds.Tables[0].Rows[inew].Edition_Name);
        if (dCheck == true) {
            var val_ue = "1";
            var pkg_id = "0";
            var strtext = "";
            pkg_id = document.getElementById('hiddenpckcode' + i);
            var pkgalias = document.getElementById('pkg_alias' + i);
            var pkgname = document.getElementById("edit" + i).value;
            pkgname = pkgname.replace("+", "^");
            if (browser != "Microsoft Internet Explorer") {
                var httpRequest = null; ;
                httpRequest = new XMLHttpRequest();
                if (httpRequest.overrideMimeType) {
                    httpRequest.overrideMimeType('text/xml');
                }

                httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

                httpRequest.open("GET", "packagename.aspx?pkgalias=" + pkgalias.value + "&adcat=" + adcat + "&pkgid=" + pkg_id.value + "&compcode=" + compcode_vari.value + "&value=" + val_ue + "&dateday=" + ds.Tables[0].Rows[inew].Date + "&pkgname=" + ds.Tables[0].Rows[inew].Edition_Name, false);
                httpRequest.send('');
                //alert(httpRequest.readyState);
                if (httpRequest.readyState == 4) {
                    //alert(httpRequest.status);
                    if (httpRequest.status == 200) {
                        strtext = httpRequest.responseText;
                    }
                    else {
                        alert('There was a problem with the request.');
                    }
                }
            }
            else {
                validuse = "";
                var xml = new ActiveXObject("Microsoft.XMLHTTP");
                var adcat = document.getElementById('drpadcategory').value;
                xml.Open("GET", "packagename.aspx?pkgalias=" + pkgalias.value + "&adcat=" + adcat + "&pkgid=" + pkg_id.value + "&compcode=" + compcode_vari.value + "&value=" + val_ue + "&dateday=" + ds.Tables[0].Rows[inew].Date + "&pkgname=" + ds.Tables[0].Rows[inew].Edition_Name, false);
                xml.Send();
                strtext = xml.responseText;
            }
            if (strtext == "NOT A VALID DATE") {
                alert("NOT A VALID DATE");
                text_var.value = "";
                return false;
            }
            var text_var = document.getElementById("Text" + i);
            if (strtext != "" && strtext != "1" && strtext != "0" && strtext != null) {

                if (text_var != null) {
                    text_var.value = strtext;
                }
                for (y = i + 1; y < ds.Tables[0].Rows.length; y++) {
                    if (ds.Tables[0].Rows[y].Edition_Name == ds.Tables[0].Rows[inew].Edition_Name) {
                        if (dateformat_vari.value == "dd/mm/yyyy") {
                            var dk1 = ds.Tables[0].Rows[y].Date.split("/")
                            dt = new Date(dk1[1] + '/' + dk1[0] + '/' + dk1[2]);
                            dt.setDate(dt.getDate() + 1);
                            var d = dt.getDate();
                            if (d.toString().length == 1)
                                d = "0" + d;
                            var mm = dt.getMonth() + 1;
                            if (mm.toString().length == 1)
                                mm = "0" + mm;
                            ds.Tables[0].Rows[y].Date = d + '/' + (mm) + '/' + dt.getFullYear();
                        }
                        if (dateformat_vari.value == "mm/dd/yyyy") {
                            dt = new Date(ds.Tables[0].Rows[y].Date);
                            dt.setDate(dt.getDate() + 1);
                            var d = dt.getDate();
                            if (d.toString().length == 1)
                                d = "0" + d;
                            var mm = dt.getMonth() + 1;
                            if (mm.toString().length == 1)
                                mm = "0" + mm;
                            ds.Tables[0].Rows[y].Date = (mm) + '/' + d + '/' + dt.getFullYear();
                        }
                        if (dateformat_vari.value == "yyyy/mm/dd") {
                            // var dk1=ds.Tables[0].Rows[y].Date.split("/")
                            //dt=new Date(dk1[2] + '/' + dk1[1] + '/' + dk1[0]   );
                            dt = new Date(ds.Tables[0].Rows[y].Date);
                            dt.setDate(dt.getDate() + 1);
                            var d = dt.getDate();
                            if (d.toString().length == 1)
                                d = "0" + d;
                            var mm = dt.getMonth() + 1;
                            if (mm.toString().length == 1)
                                mm = "0" + mm;
                            ds.Tables[0].Rows[y].Date = dt.getFullYear() + '/' + (mm) + '/' + d;
                        }


                    }
                }

            }
            else {
                if (text_var != null)
                    text_var.value = ds.Tables[0].Rows[inew].Date;
            }
            i = parseInt(i, 10) + 1;
        }
    }
}

function checknumeric(evt) {
    var charCode = event.keyCode

    if ((charCode >= 48 && charCode <= 57) || (charCode >= 96 && charCode <= 105) || (charCode == 127) || (charCode == 8) || (charCode == 9) || (charCode == 46)) {
        return true;
    }
    else {
        return false;
    }
    if (document.getElementById('txtrepeatingdate').value != "") {
        document.getElementById('btnshdl').disabled = false;
        return false;
    }
}
function FillSubCatinGrid() {
    if (activeid.indexOf("inssta") == 0) {
        if (document.getElementById(activeid) != null) {
            if (document.getElementById(activeid).value == "hold" && document.getElementById('aglist').value == "booked") {
                document.getElementById('txtgrossamt').value = document.getElementById('txtgrossamt').value;
                //-- document.getElementById('txttotalamt').value=document.getElementById('txtbillamt').value;
            }
            else if (document.getElementById(activeid).value == "booked" && document.getElementById('aglist').value == "hold") {
                document.getElementById('txtgrossamt').value = document.getElementById('txtgrossamt').value;
                //--  document.getElementById('txttotalamt').value=document.getElementById('txtbillamt').value;
            }
            else {
                document.getElementById('txtgrossamt').value = "";
                document.getElementById('txttotalamt').value = "";
            }
            //  if(document.getElementById(activeid).value!="hold")
            // {
            // document.getElementById('txtgrossamt').value="";
            // document.getElementById('txtbillamt').value="";
            //}
            // document.getElementById(document.activeElement.id).value="Y";
        }
        var id = activeid.replace("inssta", "pai");
        if (document.getElementById(id) != null) {
            document.getElementById(id).value = "Y";
        }
        if (document.getElementById('aglist').value != "")
            document.getElementById(activeid).value = document.getElementById('aglist').value;
        document.getElementById(activeid).style.backgroundColor = "#FFFFFF";
        document.getElementById('agdiv').style.display = "none";
    }
    else {
        if (activeid.indexOf("adcat") == 0) {
            var id = activeid.replace("adcat", "ads");
            document.getElementById(id).value = "";
        }
        if (activeid.indexOf("inssta") == 0) {
            var id = activeid.replace("inssta", "pai");
            if (document.getElementById(id) != null) {
                document.getElementById(id).value = "Y";
            }
        }

        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txttotalamt').value = "";

        //         if(activeid.indexOf("col")==0)
        //	    {
        //	    getvalueintoinsertsforcolor(document.getElementById(activeid),"","");
        //	    }
        document.getElementById(activeid).style.backgroundColor = "#FFFFFF";
        if (activeid.indexOf("adsdiv") == 0 || activeid.indexOf("coldiv") == 0 || activeid.indexOf("divinssta") == 0) {
            document.getElementById(activeid).value = document.getElementById('aglistpop').value;
            document.getElementById('agdivpop').style.display = "none";
        }
        else {
            document.getElementById(activeid).value = document.getElementById('aglist').value;
            document.getElementById('agdiv').style.display = "none";
        }
    }
}


function showDate(datevalue) {
    var dateformate = document.getElementById("hiddendateformat").value;
    var datev = new Date(datevalue);
    var dd = datev.getDate() + 1;
    var mm = datev.getMonth() + 1;
    var yy = datev.getFullYear();

    if (dd < 10)


        dd = "0" + dd;

    if (mm < 10)
        mm = "0" + mm;

    var returndate = "";

    if (dateformate == "dd/mm/yyyy") {
        returndate = dd + "/" + mm + "/" + yy;
    }
    else if (dateformate == "mm/dd/yyyy") {
        returndate = mm + "/" + dd + "/" + yy;
    }
    else if (dateformate == "yyyy/mm/dd") {
        returndate = yy + "/" + mm + "/" + dd;
    }
    return returndate;
}


function newClick() {

    prevcioidformatter = "";
    var today = new Date();
    fal = 0;
    var dt = showDate(today);
    // document.getElementById('txtdummydate').value = dt;
    //document.write(today);
    document.getElementById('txttotalarea').disabled = false;
    document.getElementById('lblbooking').style.display = "none";
    flagmode = "NEW";
    chkbtnStatus = "new";
    // constructCalendar();
    caldate.length = 0;
    /////////////////add for chequedetailflag
    document.getElementById('hdnflagdetail').value = "false";
    document.getElementById('txtciobookid').value = "";
    ////add by anuja for payment type////
    if (document.getElementById('agnlogin').value == "N") {
        document.getElementById('drppaymenttype').disabled = false;
    }
    else {
        lstagencymain1();
        document.getElementById('drppaymenttype').value = "CA0";
    }
    ///////////////end
    //document.getElementById("hiddenuomdesc").value="CD";
    if (document.getElementById('drpratecode').style.display != "none") {
        document.getElementById('drpratecode').disabled = false;
    }
    if (document.getElementById('hiddenqbcadtype') != null && document.getElementById('hiddenqbcadtype').value == "ENABLE") {
        document.getElementById('drpadtype').disabled = false;
    }
    else {
        document.getElementById('drpadtype').disabled = true;
    }
    document.getElementById('drpadtype').value = "CL0";
    document.getElementById('drpuom').value = "RO0";
    document.getElementById('btndiscount').disabled = false;
    var msg = checkSession();
    if (msg == false) {
        window.location.href = "login.aspx";
        return false;
    }
    if (document.getElementById("txtagency").value != "") {
        bindagencybillto_btnnew(document.getElementById("txtagency").value);
    }
    if (document.getElementById('hiddencutofftime').value == "y") {
        var res = QBC.getCurTime(document.getElementById('hiddencompcode').value);
        var ds = res.value;
        if (ds == null) {
            alert(res.error.description);
            return false;
        }
        if (ds.Tables[0].Rows.length > 0) {
            if (ds.Tables[0].Rows[0].T == "Y") {
                var curdate = document.getElementById('currdate').value;
                var fromdate = "";
                if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                    fromdate = curdate.split('/')[1] + '/' + curdate.split('/')[0] + '/' + curdate.split('/')[2];
                    var fdate = new Date(fromdate);
                    fdate.setDate(fdate.getDate() + 1);
                    document.getElementById('txtdatetime').value = (parseInt(fdate.getDate(), 10)) + '/' + (parseInt(fdate.getMonth(), 10) + 1) + '/' + fdate.getYear();
                }
                else if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                    fromdate = curdate;
                    var fdate = new Date(fromdate);
                    fdate.setDate(fdate.getDate() + 1);
                    document.getElementById('txtdatetime').value = (parseInt(fdate.getMonth(), 10) + 1) + '/' + (parseInt(fdate.getDate(), 10)) + '/' + fdate.getYear();
                }
                else if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
                    fromdate = curdate.split('/')[1] + '/' + curdate.split('/')[2] + '/' + curdate.split('/')[0];
                    var fdate = new Date(fromdate);
                    fdate.setDate(fdate.getDate() + 1);
                    document.getElementById('txtdatetime').value = fdate.getYear() + '/' + (parseInt(fdate.getMonth(), 10) + 1) + '/' + (parseInt(fdate.getDate(), 10));
                }
            }
            else {
                document.getElementById('txtdatetime').value = document.getElementById('currdate').value;
            }
        }
    }
    else {
        document.getElementById('txtdatetime').value = document.getElementById('currdate').value;
    }
    if (document.getElementById('hiddenbooktype').value == "2")
        document.getElementById('btnfmg').disabled = false;
    else
        document.getElementById('btnfmg').disabled = true;
    document.getElementById('btnsharing').disabled = false;
    document.getElementById('chktrade').disabled = false;
    document.getElementById('chktrade').checked = true;
    document.getElementById('chkage').disabled = false;
    document.getElementById('chkclie').disabled = false;
    document.getElementById('chkage').checked = false;
    document.getElementById('chkclie').checked = false;
    document.getElementById('txtkeyno').disabled = false;
    document.getElementById('drpadsubcategory').options.length = 0;
    document.getElementById('drpadcat3').options.length = 0;
    document.getElementById('drpadcat4').options.length = 0;
    document.getElementById('drpadcat5').options.length = 0;
    document.getElementById('hiddenbgcolor').value = "";
    document.getElementById('txtreceipt').readOnly = true;
    document.getElementById('drpboxcodenew').disabled = false;
    document.getElementById('txtprintremark').disabled = false;
    document.getElementById('chkad').disabled = false;
    document.getElementById('btndeal').disabled = false;
    //txtboxadd.Enabled = true;
    document.getElementById('hiddenscheme').value = "";
    document.getElementById('drpboxcodenew').value = "0";
    document.getElementById('txtboxnonew').value = "";
    document.getElementById('txtboxadd').value = "";
    document.getElementById('txtboxchrg').value = "";
    document.getElementById('drpcoutype').disabled = false;
    document.getElementById('drpstate').disabled = false;
    document.getElementById('txtcouno').disabled = false;
    document.getElementById('txtkeyno').value = "";
    document.getElementById('txtcouno').value = "";
    document.getElementById('drpcoutype').value = "0";
    document.getElementById('drpstate').value = "0";
    /*change ankur*/
    document.getElementById('hiddenbillto').value = document.getElementById('drpbillto_qbc').value;
    document.getElementById('drpbillto_qbc').disabled = false;

    document.getElementById('hiddenprevamt').value = "";
    ////////////////////////////////////////
    /*new change ankur 9feb*/
    if (document.getElementById('chkhindu') != null) {
        document.getElementById('chkhindu').checked = false;
        document.getElementById('chkhindi').checked = false;
        document.getElementById('chkhindu').disabled = false;
        document.getElementById('chkhindi').disabled = false;
        document.getElementById('chkhindi').disabled = true;
        document.getElementById('chkhindu').disabled = true;
    }

    document.getElementById('txtMobile').disabled = false;
    document.getElementById('drpcolortype').disabled = true;
    document.getElementById('txtagencyaddress').disabled = true;
    document.getElementById('btnpaygateway').disabled = false;
    //document.getElementById('hiddensavemod.Value = saveormodify;

    document.getElementById('txtciobookid').readOnly = true;
    document.getElementById('chkcontract').checked = true;
    document.getElementById('chkcontract').disabled = true;
    document.getElementById('txtrono').disabled = false;
    document.getElementById('txtrodate').disabled = false;
    document.getElementById('btncopy').disabled = false;
    document.getElementById('btndel').disabled = true;

    document.getElementById('drprostatus').disabled = false;
    //txtagency.Enabled = true;
    document.getElementById('txtclient').disabled = false;
    if (document.getElementById('hiddenchkf2').value != "yes") {
        document.getElementById('txtagency').readOnly = true;
        document.getElementById('txtbranch').disabled = true;
    }
    else {
        document.getElementById('txtagency').readOnly = false;
        document.getElementById('txtbranch').disabled = true;

    }

    if (document.getElementById('hdndepo').value == "depo") {
        document.getElementById('txtbranch').disabled = true;

    }

    else {
        document.getElementById('txtbranch').disabled = false;
        document.getElementById('txtagencyaddress').value = "";
    }
    // txtagencyaddress.Enabled = true;
    document.getElementById('txtclientadd').disabled = false;

    //        txtprintremark.Enabled = true;
    document.getElementById('drppackage').disabled = false;
    document.getElementById('txtinsertion').disabled = false;
    document.getElementById('txtdummydate').disabled = false;
    document.getElementById('txtrepeatingdate').disabled = false;

    document.getElementById('drpadcategory').disabled = false;
    document.getElementById('chkall').disabled = false;
    document.getElementById('drpadsubcategory').disabled = false;
    document.getElementById('drpcolor').disabled = false;
    document.getElementById('drpuom').disabled = false;
    //document.getElementById('Hiddendrppageposition').disabled = true;

    // txtadsizetypeheight.Enabled = true;
    //txtadsizetypewidth.Enabled = true;


    document.getElementById('txtdatetime').readOnly = true;
    document.getElementById('txtrepeatingdate').disabled = false;


    document.getElementById('txtadsize2').disabled = false;
    document.getElementById('txtadsize1').disabled = false;
    //txttotalarea.Enabled = false;
    document.getElementById('txttotalarea').readOnly = false;
    // drpvarient.Enabled = true;

    document.getElementById('drpregion').disabled = true;


    //txtgrossamt.Enabled = false;
    document.getElementById('txtgrossamt').readOnly = true;
    document.getElementById('txttotalamt').readOnly = true;
    //   drpboxcode.Enabled = true;



    document.getElementById('txtinsertion').disabled = false;
    document.getElementById('txtcolum').disabled = false;



    document.getElementById('drpadcat3').disabled = false;
    document.getElementById('drpadcat4').disabled = false;
    document.getElementById('drpbgcolor').disabled = true;
    document.getElementById('drpadcat5').disabled = false;

    document.getElementById('drpbullet').disabled = false;
    document.getElementById('drplogoprem').disabled = false;
    document.getElementById('drpdesign').disabled = false;

    document.getElementById('txtreceiptdate').readOnly = true;

    document.getElementById('drpmatstat').disabled = true;
    document.getElementById('get_pacakge_new').disabled = false;
    document.getElementById('btnschme').disabled = false;
    /*new change ankur 11 feb*/
    //   document.getElementById('drpadtype').disabled = true;

    document.getElementById('txteyecathval').disabled = true;



    document.getElementById('drpadtype').value = document.getElementById('drpadtype').value;

    /*new changes ankur 26 feb*/


    //////////////////
    //btndel.Enabled = true;


    document.getElementById('txtcontractname').value = "";

    /*new changes ankur*/
    document.getElementById('drpvarient').value = "0";


    //////////////////////////////
    document.getElementById('drpadcat5').options.length = 0;
    document.getElementById('drpbgcolor').value = "0";
    document.getElementById('drpbullet').value = "0";
    document.getElementById('drplogoprem').value = "0";
    document.getElementById('drpdesign').value = "0";
    document.getElementById('txtreceiptdate').value = "";
    document.getElementById('drpadcat3').options.length = 0;
    document.getElementById('drpadcat4').options.length = 0;
    document.getElementById('drpmatstat').value = "0";

    //     drpschemepck.SelectedValue = "0";



    document.getElementById('drpcolortype').value = "0";
    /////////////////////////////////////

    saveormodify = "0";
    document.getElementById('txtcolum').value = "";


    document.getElementById('txtrono').value = "";
    document.getElementById('txtrodate').value = document.getElementById('HDN_server_date').value;


    document.getElementById('drprostatus').value = "0";

    document.getElementById('txtclient').value = "";

    document.getElementById('txtclientadd').value = "";

    //  drppackage.SelectedValue = "0";
    document.getElementById('txtinsertion').value = "";
    //document.getElementById('txtdummydate').value = "";
    document.getElementById('txtrepeatingdate').value = "";

    document.getElementById('drpadcategory').value = "0";
    document.getElementById('drpadsubcategory').value = "0";
    // document.getElementById('drpcolor').value = "B";
    if (document.getElementById('drpcolor').options.length > 1)
        document.getElementById('drpcolor').selectedIndex = 1;
    else
        document.getElementById('drpcolor').value = "0";
    //  document.getElementById('drpbgcolor').disabled=true;
    //drpuom.SelectedValue = "0";
    document.getElementById('Hiddendrppageposition').value = "0";

    //txtadsizetypeheight.Text = "";
    //txtadsizetypewidth.Text = "";
    //txtratecode.SelectedValue = "0";



    document.getElementById('txtadsize2').value = "";
    document.getElementById('txtadsize1').value = "";
    document.getElementById('txttotalarea').value = "";
    //   drpboxcode.SelectedValue = "0";
    // txtboxno.Text = "";


    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    document.getElementById('drppackage').value = "0";
    document.getElementById('drppackagecopy').options.length = 0;


    //  drpboxcode.SelectedValue = "0";

    /*new change ankur 24 feb*/
    document.getElementById('txtlogohei').disabled = false;
    document.getElementById('txtlogohei').value = "";
    document.getElementById('txtlogoname').value = "";
    document.getElementById('drplogocolor').disabled = false;
    document.getElementById('drplogocolor').value = "0";

    /////////////////////////////////



    document.getElementById('txtinsertion').value = "";


    document.getElementById('hiddenbranch').value = document.getElementById('hdnf2').value;
    // saveormodify = "0";
    /*new change ankur 23 feb*/
    document.getElementById('hiddensavemod').value = "0";
    /////////////////////////////

    /*change for oracle*/
    document.getElementById('hiddendummycioid').value = "";


    //autogenerated("0");
    autogeneratedtempid();
    //   autogenerated("3");

    rownumEx = 0;
    document.getElementById('drppackagecopy').disabled = false;
    if (document.getElementById('hiddenbookstatus').value == "Booked") {
        document.getElementById('drprostatus').value = "1";
    }
    else if (document.getElementById('hiddenbookstatus').value == "Unconfirmed") {
        document.getElementById('drprostatus').value = "2";
        document.getElementById('drprostatus').disabled = true;
    }

    /*new change ankur 22 feb*/
    document.getElementById('txtlogohei').value = "";
    document.getElementById('txtlogohei').disabled = false;
    document.getElementById('txtlogowid').disabled = false;
    document.getElementById('txtlogowid').Text = "";
    document.getElementById('txtlogouomcode').Text = "";
    //txtlogouomcode.Enabled=true;
    document.getElementById('drplogocolor').disabled = false;
    document.getElementById('drplogocolor').value = "0";
    document.getElementById('btnlogo').disabled = false;
    ///////////////////////////////



    //bindpackage();
    //DateTime dt = DateTime.Now;
    var dt = new Date();
    var year = dt.getFullYear();
    var month = dt.getMonth() + 1;
    var day = dt.getDate();
    //string serdate = Convert.ToString(month + "/" + day + "/" + year);

    var serdate = "";
    /*change for oracle*/
    if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
        serdate = day + "/" + month + "/" + year;
    }
    else if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
        serdate = month + "/" + day + "/" + year;
    }
    else if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd") {
        serdate = year + "/" + month + "/" + day;
    }

    //        datesave getdatechk = new datesave();
    //        dateinsert getdateshow = new dateinsert();
    //txtrodate.Text = getdateshow.getDate(Session["dateformat"].ToString(), serdate);
    res = QBC.getDate(document.getElementById('hiddendateformat').value, serdate);
    document.getElementById('txtreceiptdate').value = res.value;


    chkstatus(document.getElementById('hiddenbuttonidcheck').value);
    document.getElementById('btnSave').disabled = false;
    document.getElementById('btnSaveConfirm').disabled = false;
    document.getElementById('btnNew').disabled = true;
    document.getElementById('btnQuery').disabled = true;
    //    if (document.getElementById('txtagency').value == "") {
    //        document.getElementById('txtagency').focus();
    //    }
    //    else {
    document.getElementById('txtclient').focus();
    // }
    document.getElementById('btndel').disabled = false;
    document.getElementById('btnshgrid').disabled = false;
    getid = "";
    gblogowithmatter = "";
    //*****************By Manish Verma********************************************************
    modifyMatter = 0;
    //****************************************************************************************
    /*change for oracle*/
    disabledlogoinfo();
    defaultuom();
    // for agency balance//////add outstanding
    // if (document.getElementById('HDNAGNOUTSTANDING').value = "Y") {
    if (document.getElementById('txtagency').value != "") {
        var res = QBC.getBalance(document.getElementById('hiddencompcode').value, document.getElementById('txtagency').value)
        var ds = res.value;
        if (ds != null && ds.Tables[0].Rows.length > 0) {
            if (ds.Tables[0].Rows[0].BALANCE == "0")
                document.getElementById('txtagencybalance').value = "0";
            else {
                if (ds.Tables[0].Rows[0].AMOUNT != null)
                    document.getElementById('txtagencybalance').value = ds.Tables[0].Rows[0].AMOUNT;
            }
        }
        else
            document.getElementById('txtagencybalance').value = "0";
    }
    //}
    //    else {
    //     getpayandstatus();
    //    }
    //        if(document.getElementById('txtagency').value!="")
    //        {
    //            QBC.getRec(document.getElementById('txtagency').value,getRec_callback);
    //        }


    document.getElementById('btnholding').disabled = false;
    document.getElementById('drpstyle').disabled = false;
    document.getElementById('drpstyle').value = "0";
    document.getElementById('btnsavepay').disabled = false;


    setButtonImages();
    bindUomNew();


    if (document.getElementById('hdndepo').value == "depo") {


        document.getElementById('btnsavepay').disabled = true;
        document.getElementById('btndiscount').disabled = true;
        document.getElementById('chktrade').checked = true;
        document.getElementById('lbltrade').style.display = "none"
        document.getElementById('chktrade').style.display = "none"

    }
    document.getElementById('txtrepeatingdate').value = "1";
    if (document.getElementById('txtrepeatingdate').value != "") {
        document.getElementById('btnshdl').disabled = false;
    }
    else {
        document.getElementById('btnshdl').disabled = true;
    }
    return false;
}
function bindUomNew() {
    var res = QBC.binduomAjax();
    var ds = res.value;
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {
        var uom = document.getElementById('drpuom');
        uom.options[0] = new Option("-Select Uom-", "0");

        //var pkgitem = document.getElementById("drpcity");
        //alert(pkgitem);
        uom.options.length = 1;
        //uom(pkgitem.options.length);
        for (var i = 0; i < res.value.Tables[0].Rows.length; ++i) {
            uom.options[uom.options.length] = new Option(res.value.Tables[0].Rows[i].Uom_Name, res.value.Tables[0].Rows[i].Uom_Code);

            uom.options.length;

        }
    }
    else {

        uom.options.length = 0;
        uom.options[0] = new Option("-Select uom-", "0");
    }
}
function bindagencybillto_btnnew(agency) {
    document.getElementById('drpbillto_qbc').options.length = 0;
    var arr_agency = agency.split('(');
    document.getElementById('drpbillto_qbc').options[document.getElementById('drpbillto_qbc').options.length] = new Option(arr_agency[0], arr_agency[1].toString().replace(")", ""));
    document.getElementById('drpbillto_qbc').options.length;
}
function autogenerated(no) {
    if (no == "0") {
        var dt = new Date()
        var auto = "";
        var cen = document.getElementById('hiddencenter').value;
        cen = cen.substring(0, 3);

        var year = dt.getFullYear();
        var zeros = "";
        ////this to chk from the preferrences if from the preferrences it is  1 than generate id as center + year + 8 digit no.
        ////and if it is 2 than center + yrar + uid + 8 digit no.
        if (document.getElementById('hiddencioidformat').value == "1") {
            auto = cen + year;
        }
        else if (document.getElementById('hiddencioidformat').value == "2") {
            auto = cen + year + document.getElementById('hiddenuserid').value;
        }
        else if (document.getElementById('hiddencioidformat').value == "3") {
            auto = "";
        }

        var autogen = auto + "0";
        var res = QBC.getBookingIdNo(document.getElementById('hiddencompcode').value, auto, no, document.getElementById('txtciobookid').value);
        var da = res.value;
        if (da == null) {
            alert(res.error.description);
            return false;
        }
        if (da.Tables[0].Rows.length > 0 && da.Tables[0].Rows[0].ID != "") {
            var ab = da.Tables[0].Rows[0].ID;
            var cou1 = parseInt(ab, 10);
            year = da.Tables[0].Rows[0].YEAR1;
            if (document.getElementById('hiddencioidformat').value == "1") {
                auto = cen + year;
            }
            else if (document.getElementById('hiddencioidformat').value == "2") {
                auto = cen + year + document.getElementById('hiddenuserid').value;
            }
            else if (document.getElementById('hiddencioidformat').value == "3") {
                auto = "";
            }
            //cou1++;
            var countlen = cou1.toString().length;
            if (countlen == 1) {
                zeros = "0000000" + cou1;

            }
            else if (countlen == 2) {
                zeros = "000000" + cou1;

            }
            else if (countlen == 3) {
                zeros = "00000" + cou1;
            }
            else if (countlen == 4) {
                zeros = "0000" + cou1;
            }
            else if (countlen == 5) {
                zeros = "000" + cou1;
            }
            else if (countlen == 6) {
                zeros = "00" + cou1;
            }
            else if (countlen == 7) {
                zeros = "0" + cou1;
            }
            else if (countlen == 8) {
                zeros = "0" + cou1;
            }


            document.getElementById('txtciobookid').value = auto + zeros;
        }
        else {
            document.getElementById('txtciobookid').value = autogen;

        }
    }
    else if (no == "1") {
        var auto = "DN";
        var autogen = auto + "0";
        var res = QBC.getBookingIdNo(document.getElementById('hiddencompcode').value, auto, no, document.getElementById('txtciobookid').value);
        var da = res.value;
        if (da == null) {
            alert(res.error.description);
            return false;
        }
        if (da.Tables[0].Rows.length > 0 && da.Tables[0].Rows[0].ID != "") {
            var ab = da.Tables[0].Rows[0].ID;
            var cou1 = parseInt(ab, 10);
            cou1++;

            document.getElementById('txtdockitno1').value = auto + cou1;
        }
        else {
            document.getElementById('txtdockitno1').value = autogen;

        }


    }

    else if (no == "2") {
        var auto = "BN";
        var autogen = auto + "0";
        var res = QBC.getBookingIdNo(document.getElementById('hiddencompcode').value, auto, no, document.getElementById('txtciobookid').value);
        var da = res.value;
        if (da == null) {
            alert(res.error.description);
            return false;
        }
        if (da.Tables[0].Rows.length > 0 && da.Tables[0].Rows[0].boxno != "" && da.Tables[0].Rows[0].boxno != undefined) {
            var ab = da.Tables[0].Rows[0].boxno;
            var cou1 = parseInt(ab, 10);
            cou1++;

            document.getElementById('txtboxno').value = auto + cou1;
        }
        else {
            document.getElementById('txtboxno').value = autogen;

        }


    }

    //get max receipt number 
    // else if (no == "3")
    //{
    //                var auto='';
    //             var res=Classified_Booking.getBookingIdNo(document.getElementById('hiddencompcode').value,auto,no,document.getElementById('txtciobookid').value);
    //            var da=res.value;
    //            //***************************************
    //            if(da==null)
    //            {
    //                alert(res.error.description);
    //                return false;
    //             }   
    //            var max_number = "0";
    //            if (da.Tables[0].Rows[0].recno.toString().length == 1)
    //                max_number = "000" + da.Tables[0].Rows[0].recno;
    //            else if (da.Tables[0].Rows[0].recno.toString().length == 2)
    //                max_number = "00" + da.Tables[0].Rows[0].recno;
    //            else if (da.Tables[0].Rows[0].recno.toString().length == 3)
    //                max_number = "0" + da.Tables[0].Rows[0].recno;
    //            else
    //                max_number = da.Tables[0].Rows[0].recno;

    //            if (document.getElementById('hiddenpaymode').value == "CASH")
    //            {
    //                document.getElementById('txtreceipt').value = "R/" + document.getElementById('hiddenhidReceipt').value + max_number;
    //                document.getElementById('hiddenreceiptno').value = document.getElementById('txtreceipt').value;
    //            }
    //            else
    //            {
    //                document.getElementById('txtreceipt').value = document.getElementById('hiddenhidReceipt').value + max_number;
    //                document.getElementById('hiddenreceiptno').value = document.getElementById('txtreceipt').value;
    //            }
    //   }
    else if (no == "3") {
        //  DataSet datasetrecinc = new DataSet();
        var datasetrecinc;
        if (document.getElementById('hiddenreceiptnoformat').value == "4") {


            var agencycode = "";
            if (document.getElementById('txtagency').value != "") {
                agencycode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.indexOf("(") + 1, document.getElementById('txtagency').value.length - document.getElementById('txtagency').value.indexOf("(") - 2);
            }
            //NewAdbooking.classesoracle.BookingMaster rec = new NewAdbooking.classesoracle.BookingMaster();
            res = null
            res = QBC.getReciptNo(agencycode);
            datasetrecinc = res.value;
        }
        var cou1 = 0;

        var auto = "";
        var zeros = "";
        /*change ankur*/
        if (document.getElementById('hiddenchkf2').value == "yes" && document.getElementById('hdnf2').value != "") {
            if (document.getElementById('hiddenreceiptnoformat').value == "4") {
                if (datasetrecinc.Tables[0].Rows.length > 0) {
                    auto = datasetrecinc.Tables[0].Rows[0].depocode + "-";
                }
                else {
                    auto = document.getElementById('hdnagencyname').value.substring(0, 2) + "-";
                }


            }
            else if (document.getElementById('hiddenreceiptnoformat').value == "1" && document.getElementById('hiddencioidformat').value == "1") {
                if (document.getElementById('txtbranch').value == "Branch" || document.getElementById('txtbranch').value == "") {
                    auto = document.getElementById('hdnagencyname').value.substring(0, 3) + year;
                }
                else {
                    auto = document.getElementById('txtbranch').value.substring(0, 3) + year;
                }
            }
            else if (document.getElementById('hiddenreceiptnoformat').value == "1" && document.getElementById('hiddencioidformat').value == "2") {
                if (document.getElementById('txtbranch').value == "Branch" || document.getElementById('txtbranch').value == "") {
                    auto = document.getElementById('hdnagencyname').value.substring(0, 3) + year + document.getElementById('hiddenuserid').value;
                }
                else {
                    auto = document.getElementById('txtbranch').value.substring(0, 3) + year + document.getElementById('hiddenuserid').value;
                }

            }
            else if (document.getElementById('hiddenreceiptnoformat').value == "2" && document.getElementById('hiddencioidformat').value == "1") {
                auto = document.getElementById('hdnagencyname').value.substring(0, 3) + year;
            }
            else if (document.getElementById('hiddenreceiptnoformat').value == "2" && document.getElementById('hiddencioidformat').value == "2") {
                auto = document.getElementById('hdnagencyname').value.substring(0, 3) + year + document.getElementById('hiddenuserid').value;
            }
            // string autogen = auto + cou;
            var da1 = QBC.getBookingIdNo(document.getElementById('hiddencompcode').value, auto, no, document.getElementById('txtciobookid').value);
            da = da1.value;
            if (document.getElementById('hiddenreceiptnoformat').value == "4") {
                if (datasetrecinc.Tables[0].Rows.length > 0) {
                    var ab = datasetrecinc.Tables[0].Rows[0].recno;
                    cou1 = parseInt(ab);
                    zeros = cou1.toString();
                    //cou1++;
                    if (cou1.toString().length == 1) {
                        zeros = "000" + cou1;
                    }
                    if (cou1.toString().length == 2) {
                        zeros = "00" + cou1;
                    }
                    if (cou1.toString().Length == 3) {
                        zeros = "0" + cou1;
                    }
                    if (cou1.toString().length == 4) {
                        zeros = cou1.toString();
                    }



                    document.getElementById('hdnagencyname').value = auto + zeros;
                }
                else {
                    if (da.Tables[0].Rows.length > 0 && da.Tables[0].Rows[0].recno != "") {
                        var ab = da.Tables[0].Rows[0].recno;
                        cou1 = parseInt(ab);
                        zeros = cou1.toString();
                        //cou1++;
                        if (cou1.toString().length == 1) {
                            zeros = "000" + cou1;
                        }
                        if (cou1.toString().length == 2) {
                            zeros = "00" + cou1;
                        }
                        if (cou1.toString().length == 3) {
                            zeros = "0" + cou1;
                        }
                        if (cou1.toString().length == 4) {
                            zeros = cou1.toString();
                        }



                        document.getElementById('hdnagencyname').value = auto + zeros;
                        //txtreceipt.Text = auto + zeros;

                    }
                }
            }
            else {
                if (da.Tables[0].Rows.length > 0 && da.Tables[0].Rows[0].recno != "") {
                    var ab = da.Tables[0].Rows[0].recno;
                    cou1 = parseInt(ab);
                    //cou1++;
                    if (cou1.toString().length == 1) {
                        zeros = "00000" + cou1;
                    }
                    if (cou1.toString().length == 2) {
                        zeros = "0000" + cou1;
                    }
                    if (cou1.toString().length == 3) {
                        zeros = "000" + cou1;
                    }
                    if (cou1.toString().length == 4) {
                        zeros = "00" + cou1;
                    }
                    if (cou1.toString().length == 5) {
                        zeros = "00" + cou1;
                    }
                    if (cou1.toString().length == 6) {
                        zeros = "0" + cou1;
                    }


                    document.getElementById('hdnagencyname').value = auto + zeros;
                    if (document.getElementById('hiddenreceiptnoformat').value == "3") {
                        document.getElementById('hdnagencyname').value = "";
                        document.getElementById('hdnagencyname').value = document.getElementById('hiddenprefix').value + zeros + document.getElementById('hiddensufix').value;
                    }
                }

                else {
                    document.getElementById('hdnagencyname').value = auto + "000000";

                }
            }
            document.getElementById('hdnagencyname').value = parseInt(cou1);
            document.getElementById('hiddenreceiptno').value = document.getElementById('hdnagencyname').value;
        }
        else {
            if (document.getElementById('hiddenreceiptnoformat').value == "4") {
                if (datasetrecinc.Tables[0].Rows.length > 0) {
                    if (datasetrecinc.Tables[0].Rows[0].recno == "") {
                        auto = document.getElementById('txtagency').value.substring(0, 2) + "-";
                    }
                    else {
                        auto = datasetrecinc.Tables[0].Rows[0].recno + "-";
                    }
                }
                else {
                    auto = document.getElementById('txtagency').value.substring(0, 2) + "-";
                }


            }
            else if (document.getElementById('hiddenreceiptnoformat').value == "1" && document.getElementById('hiddencioidformat').value == "1") {
                if (document.getElementById('txtbranch').value == "Branch" || document.getElementById('txtbranch').value == "") {
                    auto = document.getElementById('txtagency').value.substring(0, 3) + year;
                }
                else {
                    auto = document.getElementById('txtbranch').value.substring(0, 3) + year;
                }
            }
            else if (document.getElementById('hiddenreceiptnoformat').value == "1" && document.getElementById('hiddencioidformat').value == "2") {
                if (document.getElementById('txtbranch').value == "Branch" || document.getElementById('txtbranch').value == "") {
                    auto = document.getElementById('txtagency').value.substring(0, 3) + year + document.getElementById('hiddenuserid').value;
                }
                else {
                    auto = document.getElementById('txtbranch').value.substring(0, 3) + year + document.getElementById('hiddenuserid').value;
                }

            }
            else if (document.getElementById('hiddenreceiptnoformat').value == "2" && document.getElementById('hiddencioidformat').value == "1") {
                auto = document.getElementById('txtagency').value.substring(0, 3) + year;
            }
            else if (document.getElementById('hiddenreceiptnoformat').value == "2" && document.getElementById('hiddencioidformat').value == "2") {
                auto = document.getElementById('txtagency').value.substring(0, 3) + year + document.getElementById('hiddenuserid').value;
            }
            // string autogen = auto + cou;
            var da = QBC.getBookingIdNo(document.getElementById('hiddencompcode').value, auto, no, document.getElementById('txtciobookid').value);

            if (document.getElementById('hiddenreceiptnoformat').value == "4") {
                if (datasetrecinc.Tables[0].Rows.length > 0) {
                    var ab = datasetrecinc.Tables[0].Rows[0].recno;
                    cou1 = parseInt(ab);
                    zeros = cou1.toString();
                    //cou1++;
                    if (cou1.toString().length == 1) {
                        zeros = "000" + cou1;
                    }
                    if (cou1.toString().length == 2) {
                        zeros = "00" + cou1;
                    }
                    if (cou1.toString().length == 3) {
                        zeros = "0" + cou1;
                    }
                    if (cou1.toString().length == 4) {
                        zeros = cou1.toString();
                    }



                    document.getElementById('txtreceipt').value = auto + zeros;
                }
                else {
                    da = da.value;
                    if (da.Tables[0].Rows.length > 0 && da.Tables[0].Rows[0].recno != "") {
                        var ab = da.Tables[0].Rows[0].recno;
                        cou1 = parseInt(ab);
                        zeros = cou1.toString();
                        //cou1++;
                        if (cou1.toString().length == 1) {
                            zeros = "000" + cou1;
                        }
                        if (cou1.toString().length == 2) {
                            zeros = "00" + cou1;
                        }
                        if (cou1.toString().length == 3) {
                            zeros = "0" + cou1;
                        }
                        if (cou1.toString().length == 4) {
                            zeros = cou1.toString();
                        }



                        document.getElementById('txtreceipt').value = auto + zeros;
                    }
                }
            }
            else {
                if (da.Tables[0].Rows.length > 0 && da.Tables[0].Rows[0].recno != "") {
                    var ab = da.Tables[0].Rows[0].recno;
                    cou1 = parseInt(ab);
                    //cou1++;
                    if (cou1.toString().length == 1) {
                        zeros = "00000" + cou1;
                    }
                    if (cou1.toString().length == 2) {
                        zeros = "0000" + cou1;
                    }
                    if (cou1.toString().length == 3) {
                        zeros = "000" + cou1;
                    }
                    if (cou1.ToString().length == 4) {
                        zeros = "00" + cou1;
                    }
                    if (cou1.toString().length == 5) {
                        zeros = "00" + cou1;
                    }
                    if (cou1.toString().length == 6) {
                        zeros = "0" + cou1;
                    }


                    document.getElementById('txtreceipt').value = auto + zeros;
                    if (document.getElementById('hiddenreceiptnoformat').value == "3") {
                        document.getElementById('txtreceipt').value = "";
                        document.getElementById('txtreceipt').value = document.getElementById('hiddenprefix').value + zeros + document.getElementById('hiddensufix').value;
                    }
                }

                else {
                    document.getElementById('txtreceipt').value = auto + "000000";

                }
            }
            document.getElementById('hiddenreceiptno').value = document.getElementById('txtreceipt').value;

        }
    }


}

function clearClick() {
    var msg = checkSession();
    if (msg == false) {
        window.location.href = "login.aspx";
        return false;
    }

    QBC.clearSession();
    ////bhanu////
    /////////////////////modify    
    document.getElementById('lblbooking').style.display = "none";
    document.getElementById('hiddencardamt').value = "";
    document.getElementById('hidstyle').value = "0";
    document.getElementById('drpcoutype').value = "0";
    document.getElementById('drpstate').value = "0";
    document.getElementById('txtcouno').value = "";
    document.getElementById('drpcoutype').disabled = true;
    document.getElementById('drpstate').disabled = true;
    document.getElementById('txtcouno').disabled = true;
    document.getElementById('hiddenbullet').value = "";
    document.getElementById('hiddenbullprem').value = "";
    if (browser != "Microsoft Internet Explorer") {
        var httpRequest = null; ;
        httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml');
        }

        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

        //  httpRequest.open("GET", "insertMatter.aspx?FORMNAME=QBC&receipt=" + document.getElementById('hiddenreceiptno').value + "&tempbkid=" + cioid + "&modify=0&currcioid=" + curr_cio_id + "&mattertype=" + mattertype + "&unftamptype=" + document.getElementById("hdntamptype").value, false); //document.getElementById('hiddenreceiptno').value
        httpRequest.open("GET", "logout1.aspx?FORMNAME=QBC", false); //document.getElementById('hiddenreceiptno').value
        httpRequest.send('');
        //alert(httpRequest.readyState);
        if (httpRequest.readyState == 4) {
            //alert(httpRequest.status);
            if (httpRequest.status == 200) {
                //strtext=httpRequest.responseText;
            }
            else {
                alert('There was a problem with the request.');
            }
        }
    }
    else {

        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        // xml.Open("GET", "insertMatter.aspx?FORMNAME=QBC&receipt=" + document.getElementById('hiddenreceiptno').value + "&tempbkid=" + cioid + "&modify=0&currcioid=" + curr_cio_id + "&mattertype=" + mattertype + "&unftamptype=" + document.getElementById("hdntamptype").value, false);
        xml.Open("GET", "logout1.aspx?FORMNAME=logout1", false);
        xml.Send();
    }
    //////bhanu end////
    document.getElementById('Hiddentxtpageamt').value = "";
    document.getElementById('lbltrade').innerHTML = "";
    sharepub = "";
    hideCalendar();
    hidcopy = "";
   
    chkbtnStatus = "";
    flagmode = "";
    //**************************************************************
    cali = 0;
    removepkg = "";
    arrEdition_Item = '';
    tradedisc = "";
    ///////////////add by anuja
    document.getElementById('drppaymenttype').options.length = 0;
    document.getElementById('drppaymenttype').disabled = false;
    ///////////////////////////////end
    document.getElementById('divcopyinsertion').style.display = "none";
    document.getElementById('btnfmg').disabled = true;
    document.getElementById('drpadtype').value = "0";
    document.getElementById('drpadtype').disabled = true;
    document.getElementById('btndiscount').disabled = true;
    if (document.getElementById('drpratecode').style.display != "none") {
        document.getElementById('drpratecode').disabled = true;
    }
    document.getElementById('btnsharing').disabled = true;
    document.getElementById('drpratecode').value = "0";
    document.getElementById('chktrade').disabled = true;
    document.getElementById('chktrade').checked = true;
    document.getElementById('hiddenexecname').value = "";
    document.getElementById('hiddenproduct').value = "";
    document.getElementById('hidattach1').value = "";
    document.getElementById('attachment1').src = "Images/index.jpeg"
    document.getElementById('hiddendrppageprem').value = "";
    document.getElementById('hiddentxtpremper').value = "";
    document.getElementById('hiddenagreedamt').value = "";
    document.getElementById('hiddenspediscper').value = "";
    document.getElementById('hiddenspedisc').value = "";
    document.getElementById('hiddenretainer').value = "";
    document.getElementById('hiddenretainercomm').value = "";
    document.getElementById('hiddenspecharges').value = "";
    document.getElementById('hiddenpay').value = "";
    document.getElementById('hiddenzone').value = "";
    document.getElementById('txtbookedby').value = document.getElementById('hiddenusername').value;
    document.getElementById('hiddenbooktype').value = document.getElementById('hiddenbooktypeOrig').value;
    document.getElementById('hiddenbgcolor').value = "";
    document.getElementById('showselectedition').style.display = 'none';
    /*new change ankur 17feb*/
    document.getElementById('divagencymain').style.visibility = "hidden";
    document.getElementById('drpvarient').disabled = true;
    document.getElementById('drpvarient').value = "0";
    document.getElementById('drpmatstat').value = "0";
    document.getElementById('drpmatstat').disabled = true;
    document.getElementById('hiddenscheme').value = "";
    //////
    document.getElementById('txtdatetime').value = document.getElementById('currdate').value;

    /*new change 14 feb*/
    if (document.getElementById('chkhindu') != null) {
        document.getElementById('chkhindu').checked = false;
        document.getElementById('chkhindi').checked = false;
        document.getElementById('chkhindu').disabled = true;
        document.getElementById('chkhindi').disabled = true;
    }
    document.getElementById('drpadtype').value = "0";
    document.getElementById('drpadtype').disabled = true;
    /////////////////////
    document.getElementById('txtclientcatdisc').value = "";
    document.getElementById('txtclientcatam').value = "";
    document.getElementById('txtflatfreqdisc').value = "";
    document.getElementById('txtflatfreqamt').value = "";
    document.getElementById('txtcatdisc').value = "";
    document.getElementById('txtcatamt').value = "";
    document.getElementById('hdnclientcatdistype').value = "";
    document.getElementById('hdnflatfreqdisctype').value = "";
    document.getElementById('hdncatdisctype').value = "";
    /*change ankur*/
    document.getElementById('drpadsubcategory').options.length = 0;
    document.getElementById('drpadcat3').options.length = 0;
    document.getElementById('drpadcat4').options.length = 0;
    document.getElementById('drpadcat5').options.length = 0;
    document.getElementById('drpbillto_qbc').options.length = 0;
    document.getElementById('drpbillto_qbc').disabled = true;
    ///////////////////////////////////
    if (document.getElementById('hdnf2') != null && document.getElementById('hdnf2').value != "")
        document.getElementById('txtbranch').value = document.getElementById('hdnf2').value;
    document.getElementById('hiddencalendar').value = "0";
    document.getElementById('txtagencybalance').value = "";
    document.getElementById('hiddensavemod').value = "0";
    /*new change ankur 10 feb*/
    //document.getElementById('hiddencopy').value = "";
    document.getElementById('hiddendummycioid').value = "";
    //////////////
    document.getElementById('drpboxcodenew').disabled = true;
    //txtboxadd.Enabled = false;
    document.getElementById('drpboxcodenew').value = "0";
    document.getElementById('txtboxnonew').value = "";
    document.getElementById('txtboxadd').value = "";
    document.getElementById('txtboxchrg').value = "";

    document.getElementById('btnlogo').disabled = true;
    // btnupload.Enabled = false;

    document.getElementById('txtciobookid').disabled = true;
    // txtappby.Enabled = false;
    // txtaudit.Enabled = false;
    document.getElementById('txtMobile').disabled = true;
    document.getElementById('txtMobile').value = "";
    document.getElementById('txtkeyno').disabled = true;
    document.getElementById('txtkeyno').value = "";
    document.getElementById('txtrono').disabled = true;
    document.getElementById('txtrodate').disabled = true;
    //document.getElementById('txteyecathval').value="";
    document.getElementById('txteyecathval').disabled = true;
    document.getElementById('drprostatus').disabled = true;
    document.getElementById('txtagency').readOnly = true;
    document.getElementById('txtbranch').disabled = true;
    document.getElementById('txtclient').disabled = true;
    document.getElementById('btnSaveConfirm').disabled = true;
    document.getElementById('txtprintremark').disabled = true;
    document.getElementById('drppackage').disabled = true;
    document.getElementById('txtinsertion').disabled = true;
    document.getElementById('txtdummydate').disabled = true;
    document.getElementById('txtrepeatingdate').disabled = true;
    document.getElementById('btndeal').disabled = true;
    document.getElementById('drpadcategory').disabled = true;
    document.getElementById('chkall').disabled = true;
    document.getElementById('drpadsubcategory').disabled = true;
    document.getElementById('drpcolor').disabled = true;
    document.getElementById('drpuom').disabled = true;
    // document.getElementById('Hiddendrppageposition').disabled =true;
    document.getElementById("get_pacakge_new").disabled = true;
    document.getElementById('btnpaygateway').disabled = false;
    document.getElementById('txtclientadd').disabled = true;
    document.getElementById('txtagencyaddress').disabled = true;
    document.getElementById('txtreceiptdate').disabled = true;
    // txtadsizetypeheight.Enabled = false;
    //txtadsizetypewidth.Enabled = false;
    document.getElementById('chkage').disabled = true;
    document.getElementById('chkclie').disabled = true;
    document.getElementById('chkage').checked = false;
    document.getElementById('chkclie').checked = false;
    document.getElementById('txtdatetime').readOnly = true;
    document.getElementById('txtrepeatingdate').disabled = true;


    document.getElementById('txtadsize1').disabled = true;
    document.getElementById('txtadsize2').disabled = true;
    //txttotalarea.Enabled = false;
    document.getElementById('txttotalarea').readOnly = true;
    //txtcardrate.Enabled = false;
    document.getElementById('txtcardrate').readOnly = true;



    document.getElementById('drpregion').disabled = true;

    document.getElementById('txtinsertion').disabled = true;

    document.getElementById('txtcolum').disabled = true;



    ///////////////////////
    document.getElementById('txtcontractname').disabled = true;

    document.getElementById('btncopy').disabled = true;
    document.getElementById('btndel').disabled = true;

    document.getElementById('drpadcat3').disabled = true;
    document.getElementById('drpadcat4').disabled = true;
    document.getElementById('drpadcat3').options.length = 0;
    document.getElementById('drpadcat4').options.length = 0;

    document.getElementById('drpbgcolor').disabled = true;
    document.getElementById('drpadcat5').disabled = true;

    document.getElementById('drpadcat5').options.length = 0;

    document.getElementById('btnpaygateway').disabled = true;

    /*new change ankur 9 feb*/
    document.getElementById('drpcolortype').value = "0";
    document.getElementById('drpcolortype').disabled = true;


    document.getElementById('drpbullet').disabled = true;
    document.getElementById('drplogoprem').disabled = true;
    document.getElementById('drpdesign').disabled = true;
    document.getElementById('drpbullet').value = "0";
    document.getElementById('drplogoprem').value = "0";
    document.getElementById('drpdesign').value = "0";

    document.getElementById('drpmatstat').value = "0";

    document.getElementById('chkcontract').checked = true;
    document.getElementById('chkcontract').disabled = true;

    document.getElementById('txtcontractname').value = "";

    //////////////////////////////

    document.getElementById('txtcolum').value = "";
    document.getElementById('txtreceipt').value = "";
    document.getElementById('hiddenreceiptno').value = "";

    document.getElementById('txtciobookid').value = "";
    // txtappby.Text = "";
    // txtaudit.Text = "";
    document.getElementById('txtrono').value = "";
    document.getElementById('txtrodate').value = document.getElementById('HDN_server_date').value;


    document.getElementById('drprostatus').value = "0";

    if (document.getElementById('hiddenchkf2').value != "yes") {
        document.getElementById('txtagency').readOnly = true;
        document.getElementById('txtbranch').disabled = true;
        document.getElementById('txtagency').value = document.getElementById('hidagencyname').value;
    }
    else {
        document.getElementById('txtagency').value = "";
        document.getElementById('hidagencyname').value = "";
    }
    document.getElementById('txtclient').value = "";

    document.getElementById('txtclientadd').value = "";
    //document.getElementById('txtagencyaddress').value = "";
    document.getElementById('txtprintremark').value = "";
    //drppackage.SelectedValue = "0";
    //drppackage.Items.Clear();
    ///////////on the click of clear button bind the grid again to uncheck
    document.getElementById('txtinsertion').value = "";
    document.getElementById('txtdummydate').value = "";
    document.getElementById('txtrepeatingdate').value = "";
    if (document.getElementById('txtrepeatingdate').value != "") {
        document.getElementById('btnshdl').disabled = false;
    }
    else {
        document.getElementById('btnshdl').disabled = true;
    }
    document.getElementById('drpadcategory').value = "0";
    document.getElementById('drpadsubcategory').value = "0";
    document.getElementById('drpcolor').value = "0";
    //drpcolor.SelectedValue = "0";

    document.getElementById('drpuom').value = document.getElementById('hiddenuom1').value;

    document.getElementById('Hiddendrppageposition').value = "0";

    //  txtadsizetypeheight.Text = "";
    //txtadsizetypewidth.Text = "";

    document.getElementById('txtadsize1').value = "";
    document.getElementById('txtadsize2').value = "";
    document.getElementById('txttotalarea').value = "";
    document.getElementById('txtcardrate').value = "";
    document.getElementById('txtreceiptdate').value = "";
    document.getElementById('txtdealrate').value = "";
    document.getElementById('txtpaid').value = "";
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    document.getElementById('txtsapid').value = "";

    //2april
    document.getElementById('txtlogohei').value = "";
    document.getElementById('txtlogowid').value = "";
    document.getElementById('txtlogouomcode').value = "";
    //2april
    // drpboxcode.SelectedValue = "0";
    document.getElementById('drpuom').value = "0";
    document.getElementById('txtinsertion').value = "";
    document.getElementById('drpbgcolor').value = "0";
    document.getElementById('drpbullet').value = "0";
    document.getElementById('drplogoprem').value = "0";
    document.getElementById('drpdesign').value = "0";
    document.getElementById('drpboxcodenew').value = "0";
    document.getElementById('drppackage').value = "0";
    document.getElementById('drppackagecopy').options.length = 0;
    document.getElementById('drppackage').options.length = 0;
    document.getElementById('drpratecode').options.length = 0;
    document.getElementById('btndel').disabled = true;
    document.getElementById('tblinsert').innerHTML = '';
    document.getElementById('btnshgrid').disabled = true;
    getid = "";
    gblogowithmatter = "";
    /*new change ankur 24 feb*/
    document.getElementById('trbtnlogo').style.display = "none";
    document.getElementById('trlogouoload').style.display = "none";
    document.getElementById('trlogouom').style.display = "none";
    document.getElementById('divclient').style.display = "none";
    document.getElementById('divagencymain').style.display = "none";
    ////////////////////////////////////////////////////////////////

    //ScriptManager.RegisterClientScriptBlock(this, typeof(Classified_Booking), "zt", "document.getElementById('tblrate').style.display='none'", true);
    //ScriptManager.RegisterClientScriptBlock(this, typeof(Classified_Booking), "zt1", "document.getElementById('tblbill').style.display='none'", true);
    //ScriptManager.RegisterClientScriptBlock(this, typeof(Classified_Booking), "zt2", "document.getElementById('addetails').style.display='none'", true);
    //ScriptManager.RegisterClientScriptBlock(this, typeof(Classified_Booking), "zt3", "document.getElementById('pagedetail').style.display='none'", true);
    //ScriptManager.RegisterClientScriptBlock(this, typeof(Classified_Booking), "zt4", "document.getElementById('tblpackage').style.display='none'", true);
    //ScriptManager.RegisterClientScriptBlock(this, typeof(Classified_Booking), "zt5", "document.getElementById('tbbox').style.display='none'", true);
    //ScriptManager.RegisterClientScriptBlock(this, typeof(Classified_Booking), "zt7", "disablelistbox();", true);
    disabledlogoinfo();

    document.getElementById('hiddensavemod').value = "01";

    getbuttoncheck(document.getElementById('hiddenbuttonidcheck').value);
    if (document.getElementById('btnNew').disabled == false) {
        document.getElementById('btnNew').focus();
    }
    //2april
    document.getElementById('btnconfirm').disabled = true;


    document.getElementById('lbreceipt').disabled = true;

    document.getElementById('drpstyle').disabled = true;
    document.getElementById('drpstyle').value = "0";
    document.getElementById('btnholding').disabled = true;
    document.getElementById('btnsavepay').disabled = true;
    /////////////////add for chequedetailflag
    document.getElementById('hdnflagdetail').value = "";
    setButtonImages();
    return false;
}
function getbuttoncheck(id) {
    if (id == "0" || id == "8") {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnQuery").disabled = true;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnCancel").disabled = true;
        document.getElementById("btnExit").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnModify").disabled = true;

        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnModify").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

    }
    if (id == "1" || id == "9") {
        document.getElementById("btnNew").disabled = false;
        document.getElementById("btnQuery").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnExit").disabled = false;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnExecute").disabled = true;

        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnModify").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

    }
    if (id == "2" || id == "10") {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnQuery").disabled = false;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnExit").disabled = false;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnModify").disabled = false;

        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnfirst").disabled = false;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;
        document.getElementById("btnExit").disabled = false;
    }
    if (id == "3" || id == "11") {
        document.getElementById("btnNew").disabled = false;
        document.getElementById("btnQuery").disabled = false;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnModify").disabled = true;
        document.getElementById("btnCancel").disabled = true;
        document.getElementById("btnExit").disabled = true;
        document.getElementById("btnDelete").disabled = true;


        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

    }
    if (id == "4" || id == "12") {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnQuery").disabled = false;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnExit").disabled = false;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;
        document.getElementById("btnExecute").disabled = true;

        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnExit").disabled = false;


        document.getElementById("btnModify").disabled = true;

        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

    }
    if (id == "5" || id == "13") {
        document.getElementById("btnNew").disabled = false;
        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnQuery").disabled = false;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnExit").disabled = false;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnModify").disabled = true;

    }
    if (id == "6" || id == "14") {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnQuery").disabled = false;
        document.getElementById("btnModify").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnExit").disabled = false;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;
        document.getElementById("btnExecute").disabled = true;
    }
    if (id == "7" || id == "15") {
        document.getElementById("btnNew").disabled = false;
        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnQuery").disabled = false;
        document.getElementById("btnModify").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnExit").disabled = false;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;
        document.getElementById("btnExecute").disabled = true;
    }
}
function queryClick() {
    clearClick();
    /////////////////add for chequedetailflag
    document.getElementById('hdnflagdetail').value = "false";
    document.getElementById("hiddensavemod").value = "1";
    rownumEx = 0;
    //2april
    document.getElementById("btnshgrid").disabled = true;
    //2april
    /*new change 14 feb*/
    document.getElementById("drpadtype").value = document.getElementById('drpadtype').value;
    document.getElementById("get_pacakge_new").disabled = true;
    document.getElementById("drpadtype").disabled = true;
    /////////////////////

    /*change ankur*/
    document.getElementById("drpbillto_qbc").disabled = true;
    //////////////////////////
    document.getElementById("btnlogo").disabled = true;
    // btnupload.Enabled = false;
    document.getElementById("chkcontract").disabled = true;
    document.getElementById("chkcontract").checked = true;
    document.getElementById("txtciobookid").value = "";
    document.getElementById('txtkeyno').value = "";
    //  txtappby.Text = "";
    //txtaudit.Text = "";
    document.getElementById("txtrono").value = "";
    document.getElementById("txtrodate").value = "";


    document.getElementById("drprostatus").value = "0";
    if (document.getElementById('hdnf2').value != "") {
        // document.getElementById('txtagency').value = "";
    }
    document.getElementById('txtclient').value = "";

    document.getElementById('txtclientadd').value = "";
    // document.getElementById('txtagencyaddress').value = "";

    document.getElementById('txtprintremark').value = "";
    // drppackage.SelectedValue = "0";
    document.getElementById('txtinsertion').value = "";
    document.getElementById('txtdummydate').value = "";
    document.getElementById('txtrepeatingdate').value = "";
    if (document.getElementById('txtrepeatingdate').value != "") {
        document.getElementById('btnshdl').disabled = false;
    }
    else {
        document.getElementById('btnshdl').disabled = true;
    }
    document.getElementById('drpadcategory').value = "0";
    document.getElementById('drpadsubcategory').value = "0";
    //drpcolor.SelectedValue = "0";
    document.getElementById('drpuom').value = "0";
    document.getElementById('Hiddendrppageposition').value = "0";
    document.getElementById('drpboxcodenew').value = "0";
    document.getElementById('txtboxnonew').value = "";
    document.getElementById('txtboxadd').value = "";
    document.getElementById('txtboxchrg').value = "";

    document.getElementById('txtcolum').value = "";
    //txtbillcolumn.Text = "";
    ////txtbillarea.Text = "" = "";
    document.getElementById('drpmatstat').disabled = true;
    document.getElementById('drpmatstat').value = "0";


    document.getElementById('txtcontractname').value = "";


    document.getElementById('drppackage').value = "0";
    document.getElementById('drppackagecopy').options.length = 0;

    document.getElementById('drpadcat3').disabled = true;
    document.getElementById('drpadcat4').disabled = true;
    document.getElementById('drpadcat3').options.length = 0;
    document.getElementById('drpadcat4').options.length = 0;
    document.getElementById('drpbgcolor').disabled = true;
    /*new change ankur 9 feb*/
    document.getElementById('drpcolortype').value = "0";
    document.getElementById('drpcolortype').disabled = true;
    //////////////////////////

    document.getElementById('drpadcat5').disabled = true;
    document.getElementById('drpadcat5').options.length = 0;
    document.getElementById('drpbgcolor').value = 0;

    document.getElementById('drpbullet').disabled = true;
    document.getElementById('drpbullet').value = "0";
    document.getElementById('drplogoprem').disabled = true;
    document.getElementById('drpdesign').disabled = true;
    document.getElementById('drplogoprem').value = "0";
    document.getElementById('drpdesign').value = "0";
    document.getElementById('txtrono').disabled = true;
    //txtagency.Enabled = true;
    document.getElementById('txtagency').readOnly = true;
    document.getElementById('txtclient').disabled = false;

    document.getElementById('btnlogo').disabled = true;
    //btnupload.Enabled = false;

    document.getElementById('txtciobookid').disabled = false;
    document.getElementById('txtciobookid').readOnly = false;
    document.getElementById('txtrono').disabled = false;
    /*new change ankur 24 feb*/
    document.getElementById('txtlogohei').disabled = true;
    document.getElementById('txtlogohei').value = "";
    document.getElementById('txtlogoname').value = "";
    document.getElementById('drplogocolor').disabled = true;
    document.getElementById('drplogocolor').value = "0";

    /////////////////////////////////

    document.getElementById("hiddensavemod").value = "01";
    chkstatus(document.getElementById('hiddenbuttonidcheck').value);

    document.getElementById('btnQuery').disabled = true;
    document.getElementById('btnExecute').disabled = false;
    document.getElementById('btnSave').disabled = true;
    document.getElementById('btnSaveConfirm').disabled = true;
    document.getElementById('txtkeyno').disabled = false;

    document.getElementById('txtreceipt').disabled = false;
    document.getElementById('txtreceipt').readOnly = false;
    document.getElementById('tblinsert').innerHTML = '';
    document.getElementById("get_pacakge_new").disabled = true;
    if (document.getElementById('hiddenchkf2').value != "yes") {
        document.getElementById('txtagency').readOnly = true;
        document.getElementById('txtbranch').disabled = true;
        document.getElementById('txtagency').value = document.getElementById('hidagencyname').value;
    }
    else {
        document.getElementById('txtagency').value = "";
    }
    setButtonImages();
    flagmode = "Query";


    document.getElementById('btnholding').disabled = true;
    document.getElementById('btnsavepay').disabled = true;


    if (document.getElementById('hdndepo').value == "depo") {

        document.getElementById('btnsavepay').disabled = true;
        document.getElementById('btndiscount').disabled = true;
        document.getElementById('lbltrade').style.display = "none"
        document.getElementById('chktrade').style.display = "none"
        document.getElementById('txtagency').value = document.getElementById('hidagencyname').value;
    } else { document.getElementById('txtagency').value = ""; }



    return false;
}
function chkstatus(FlagStatus) {
    if (FlagStatus == 0 || FlagStatus == 8) {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnQuery").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnCancel").disabled = true;
        document.getElementById("btnModify").disabled = true;

        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;
        document.getElementById("btnExit").disabled = true;



    }
    if (FlagStatus == 1 || FlagStatus == 9) {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnQuery").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnSave").disabled = false;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnModify").disabled = true;

        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;
        document.getElementById("btnExit").disabled = false;

    }
    if (FlagStatus == 2 || FlagStatus == 10) {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnQuery").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnModify").disabled = true;

        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

        document.getElementById("btnExit").disabled = false;

    }

    if (FlagStatus == 3 || FlagStatus == 11) {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnQuery").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnSave").disabled = false;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnModify").disabled = true;

        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

        document.getElementById("btnExit").disabled = false;
    }

    if (FlagStatus == 4 || FlagStatus == 12) {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnQuery").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnModify").disabled = true;

        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

        document.getElementById("btnExit").disabled = false;
    }
    if (FlagStatus == 5 || FlagStatus == 13) {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnQuery").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnModify").disabled = true;

        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

        document.getElementById("btnExit").disabled = false;
    }
    if (FlagStatus == 6 || FlagStatus == 14) {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnQuery").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnSave").disabled = true;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnModify").disabled = true;

        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

        document.getElementById("btnExit").disabled = false;
    }
    if (FlagStatus == 7 || FlagStatus == 15) {
        document.getElementById("btnNew").disabled = true;
        document.getElementById("btnQuery").disabled = true;
        document.getElementById("btnDelete").disabled = true;
        document.getElementById("btnSave").disabled = false;
        document.getElementById("btnExecute").disabled = true;
        document.getElementById("btnCancel").disabled = false;
        document.getElementById("btnModify").disabled = true;

        document.getElementById("btnfirst").disabled = true;
        document.getElementById("btnnext").disabled = true;
        document.getElementById("btnprevious").disabled = true;
        document.getElementById("btnlast").disabled = true;

        document.getElementById("btnExit").disabled = false;
    }


}
function executeClick() {
    document.getElementById('lblbooking').style.display = "block";
    var msg = checkSession();
    if (msg == false) {
        window.location.href = "login.aspx";
        return false;
    }


    if (document.activeElement.id == "btnExecute") {
    ///////////////add for modify category
        if (document.getElementById('hdnmodifycateg').value == "Y") {
            hidcopymodicategory = "copy";
            document.getElementById('drprostatus').value = "2";
//            document.getElementById('btnfirst').disabled = true;
//            document.getElementById('btnprevious').disabled = true;
//            document.getElementById('btnnext').disabled = true;
//            document.getElementById('btnlast').disabled = true;
        }
        else {
            if (document.getElementById('hiddencopy').value == "y") {
                if (confirm("Do you want to copy the data ?")) {
                    hidcopy = "copy";
                    document.getElementById('drprostatus').value = "2";
                }
                else {
                    hidcopy = "";
                }
            }
        }
    }
    ///////////////add for modify category
    if (document.getElementById('hdnmodifycateg').value == "Y") {
        hidcopymodicategory = "copy";
        document.getElementById('drprostatus').value = "2";
//        document.getElementById('btnfirst').disabled = true;
//        document.getElementById('btnprevious').disabled = true;
//        document.getElementById('btnnext').disabled = true;
//        document.getElementById('btnlast').disabled = true;
    }
    else {
        hidcopymodicategory = ""
    }
    chkbtnStatus = "EXECUTE";
    ////////add by anuja///////////////////
    document.getElementById('drppaymenttype').options.length = 0;
    ////////////////////////////////////////////
    document.getElementById('btndiscount').disabled = false;
    document.getElementById('btnlogoupload').disabled = true;
    document.getElementById('tblinsert').innerHTML = '';
    document.getElementById('hiddensavemod').value = "1";
    /*change ankur*/
    document.getElementById('drpbillto_qbc').disabled = true;
    ///////////////////////////////////

    //////////////////////////////////////////////////////////////////////////
    document.getElementById('btnlogoupload').disabled = true;
    document.getElementById('btnlogo').disabled = true;
    document.getElementById('chkcontract').disabled = true;
    document.getElementById('chkcontract').disabled = true;
    //btnupload.Enabled = false;

    document.getElementById('txtreceipt').readOnly = true;
    document.getElementById('txtciobookid').readOnly = true;
    // txtappby.Enabled = true;
    //txtaudit.Enabled = true;
    document.getElementById('txtrono').disabled = true;
    document.getElementById('txtrodate').disabled = true;


    document.getElementById('drprostatus').disabled = true;
    document.getElementById('txtagency').readOnly = true;
    document.getElementById('txtclient').disabled = true;
    // txtagencyaddress.Enabled = true;
    document.getElementById('txtclientadd').disabled = true;

    document.getElementById('txtprintremark').disabled = true;
    document.getElementById('drppackage').disabled = true;
    document.getElementById('txtinsertion').disabled = true;
    document.getElementById('txtdummydate').disabled = true;
    document.getElementById('txtkeyno').disabled = true;
    document.getElementById('txtrepeatingdate').disabled = true;

    document.getElementById('drpadcategory').disabled = true;
    document.getElementById('chkall').disabled = true;
    document.getElementById('drpadsubcategory').disabled = true;
    document.getElementById('drpcolor').disabled = true;
    document.getElementById('drpuom').disabled = true;
    // document.getElementById('Hiddendrppageposition').disabled = true;

    document.getElementById('drpboxcodenew').disabled = true;
    //txtboxadd.Enabled = false;

    document.getElementById('txtdatetime').readOnly = true;
    document.getElementById('txtrepeatingdate').disabled = true;

    document.getElementById('txtadsize2').disabled = true;
    document.getElementById('txtadsize1').disabled = true;
    //txttotalarea.Enabled = false;
    document.getElementById('txttotalarea').readOnly = true;


    //   drpboxcode.Enabled = false;


    //txtgrossamt.Enabled = false;
    document.getElementById('txtgrossamt').readOnly = true;
    document.getElementById('txttotalamt').readOnly = true;

    document.getElementById('drpregion').disabled = true;

    document.getElementById('txtinsertion').disabled = true;

    document.getElementById('txtcolum').disabled = true;

    // txtboxno.Enabled = false;

    ///////////////////////
    document.getElementById('txtcontractname').disabled = true;


    document.getElementById('btncopy').disabled = true;
    document.getElementById('btndel').disabled = true;
    document.getElementById('btnlogo').disabled = true;

    document.getElementById('drpmatstat').disabled = true;
    document.getElementById('txtreceiptdate').disabled = true;

    document.getElementById('drppaymenttype').disabled = true;


    ///////////////////////////////////////////////////////////////////////////

    if (document.getElementById('hiddenaudit').value != "") {
        document.getElementById('txtciobookid').value = document.getElementById('hiddenaudit').value;
    }






    var ciobookid = document.getElementById('txtciobookid').value;


    gciobookid = ciobookid;
    var docno = "";
    gdockitno = docno;
    var keyno = document.getElementById('txtkeyno').value;
    gkeyno = keyno;
    var rono = document.getElementById('txtrono').value;
    grono = rono;

    var agencycode = document.getElementById('txtagency').value;

    //var agencycode = "";
    if (agencycode != "") {
        agencycode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.length + document.getElementById('txtagency').value.lastIndexOf('('));
        agencycode = agencycode.replace(")", "");
    }
    gagencyscode = agencycode;

    /*new change ankur 15 feb*/
    document.getElementById('drpvarient').disabled = false;
    document.getElementById('drpadtype').disabled = true;
    document.getElementById("get_pacakge_new").disabled = true;
    ///////////////////////////

    ////for client

    ////////////////////////////////////


    var clientcode = document.getElementById('txtclient').value;
    var client = "";
    ///this is to split and get the client code

    if (clientcode.indexOf("(".toString()) > 0 && clientcode != "") {
        //clientcode.IndexOf(
        //var splitterclie = { '(' };
        var myarray1 = clientcode.split('(');
        client = myarray1[1];
        client = client.replace(")", '');

        /////this is to chk whether this code exixts in the database if exists than it is a register client else
        ///it is walkinn client
        ///
        var res = QBC.chkwalkinClient(client, document.getElementById('hiddencompcode').value);
        var dcl = res.value;
        if (dcl == null) {
            alert(res.error.description);
            return false;
        }
        if (dcl.Tables[0].Rows.length > 0) {

        }
        else {
            client = clientcode;
        }

    }
    else {
        client = clientcode;
    }
    gclient = client;


    var ciobookid

    if (document.getElementById('hdnprcioid').value != "") {
        ciobookid = document.getElementById('hdnprcioid').value;
    }

    else {



        ciobookid = document.getElementById('txtreceipt').value

    }



    ////////////////////////////////////////////////////////////////////////////////////////
    var res1 = QBC.executeBooking(document.getElementById('hiddencompcode').value, ciobookid, docno, keyno, rono, agencycode, client, document.getElementById('drpadtype').value, document.getElementById('hiddendateformat').value, document.getElementById('hiddenuserid').value);
    executequery = res1.value;
    if (executequery == null) {
        alert(res1.error.description);
        return false;
    }
    rownumEx = 0;

    fillDATA();
    return false;
    //dateinsert getdatechk = new dateinsert();


}
function updateStatus() {
    chkstatus(document.getElementById('hiddenbuttonidcheck').value);
    if (document.getElementById('hiddenbuttonidcheck').value == 2 || document.getElementById('hiddenbuttonidcheck').value == 3) {
        document.getElementById('btnQuery').disabled = false;
        document.getElementById('btnExecute').disabled = true;
        document.getElementById('btnSave').disabled = true;
        document.getElementById('btnModify').disabled = false;
        document.getElementById('btnfirst').disabled = false;
//        if (hidcopymodicategory == "copy") {
//            document.getElementById('btnfirst').disabled = true;
//            document.getElementById('btnnext').disabled = true;
//            document.getElementById('btnprevious').disabled = true;
//            document.getElementById('btnlast').disabled = true;
//        }
//        else {
            document.getElementById('btnfirst').disabled = false;
            document.getElementById('btnnext').disabled = false;
            document.getElementById('btnprevious').disabled = false;
            document.getElementById('btnlast').disabled = false;
      //  }
       

    }
    if (document.getElementById('hiddenbuttonidcheck').value == 4) {
        document.getElementById('btnDelete').disabled = false;
        document.getElementById('btnExecute').disabled = true;
        document.getElementById('btnSave').disabled = true;
        document.getElementById('btnQuery').disabled = false;
        document.getElementById('btnModify').disabled = true;
//        if (hidcopymodicategory == "copy") {
//            document.getElementById('btnfirst').disabled = true;
//            document.getElementById('btnnext').disabled = true;
//            document.getElementById('btnprevious').disabled = true;
//            document.getElementById('btnlast').disabled = true;
//        }
//        else {
            document.getElementById('btnfirst').disabled = false;
            document.getElementById('btnnext').disabled = false;
            document.getElementById('btnprevious').disabled = false;
            document.getElementById('btnlast').disabled = false;
       // }
      


    }
    if (document.getElementById('hiddenbuttonidcheck').value == 5) {
        document.getElementById('btnDelete').disabled = false;
        document.getElementById('btnExecute').disabled = true;
        document.getElementById('btnSave').disabled = true;
        document.getElementById('btnQuery').disabled = false;
        document.getElementById('btnModify').disabled = true;
//        if (hidcopymodicategory == "copy") {
//            document.getElementById('btnfirst').disabled = true;
//            document.getElementById('btnnext').disabled = true;
//            document.getElementById('btnprevious').disabled = true;
//            document.getElementById('btnlast').disabled = true;
//        }
//        else {
            document.getElementById('btnfirst').disabled = false;
            document.getElementById('btnnext').disabled = false;
            document.getElementById('btnprevious').disabled = false;
            document.getElementById('btnlast').disabled = false;
       // }
      


    }
    if (document.getElementById('hiddenbuttonidcheck').value == 6 || document.getElementById('hiddenbuttonidcheck').value == 7 || document.getElementById('hiddenbuttonidcheck').value == 15) {
        document.getElementById('btnDelete').disabled = false;
        document.getElementById('btnExecute').disabled = true;
        document.getElementById('btnSave').disabled = true;
        document.getElementById('btnQuery').disabled = false;
        document.getElementById('btnModify').disabled = false;
//        if (hidcopymodicategory == "copy") {
//            document.getElementById('btnfirst').disabled = true;
//            document.getElementById('btnnext').disabled = true;
//            document.getElementById('btnprevious').disabled = true;
//            document.getElementById('btnlast').disabled = true;
//        }
//        else {
            document.getElementById('btnfirst').disabled = false;
            document.getElementById('btnnext').disabled = false;
            document.getElementById('btnprevious').disabled = false;
            document.getElementById('btnlast').disabled = false;
        //}
        

    }

}
function fillDATA() {

    document.getElementById("drpadtype").value = document.getElementById('drpadtype').value;
    document.getElementById("hiddensavemod").value = "1";
    if (executequery.Tables[0].Rows.length > 0) {
        if (executequery.Tables[0].Rows[rownumEx].prev_booking != null && executequery.Tables[0].Rows[rownumEx].prev_booking != "") {
            var res = QBC.checkCIOIDReference(document.getElementById('hiddencompcode').value, executequery.Tables[0].Rows[rownumEx].cio_booking_id);
            if (res.value != null) {
                if (executequery.Tables[0].Rows[rownumEx].Receipt_no != null && executequery.Tables[0].Rows[rownumEx].Receipt_no != res.value) {
                    alert("Receipt No. " + executequery.Tables[0].Rows[rownumEx].Receipt_no + " has been ReScheduled to New Receipt No. " + res.value);
                    //return false;
                }
            }
        }
        if (executequery.Tables[0].Rows[rownumEx].CHKTRADE != null) {
            if (executequery.Tables[0].Rows[rownumEx].CHKTRADE == "1") {
                document.getElementById('chktrade').checked = true;
                if (executequery.Tables[0].Rows[rownumEx].Trade_disc != null)
                    document.getElementById('lbltrade').innerHTML = "TD: " + executequery.Tables[0].Rows[rownumEx].Trade_disc + "%";
            }
            else {
                document.getElementById('chktrade').checked = false;
                document.getElementById('lbltrade').innerHTML = "";
            }
        }
        ////////add by anuja
        if (executequery.Tables[0].Rows[rownumEx].cio_booking_id != null) {
            document.getElementById('lblbooking').innerHTML = executequery.Tables[0].Rows[rownumEx].cio_booking_id;
        }
        if (executequery.Tables[0].Rows[rownumEx].Bullet_code != null) {
            document.getElementById('drpbullet').innerHTML = executequery.Tables[0].Rows[rownumEx].Bullet_code;
            var resd = QBC.bindcatcher(executequery.Tables[0].Rows[rownumEx].Ad_cat_code, document.getElementById('hiddencompcode').value);
            var ds = resd.value;
            var pkgitem = document.getElementById("drpbullet");
            pkgitem.options.length = 0;
            pkgitem.options[0] = new Option("-Select", "0");
            if (ds != null && typeof (ds) == "object" && ds.Tables[1].Rows.length > 0) {
                pkgitem.options.length = 1;
                for (var i = 0; i < ds.Tables[1].Rows.length; ++i) {
                    pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[1].Rows[i].Bullet_Desc, ds.Tables[1].Rows[i].Bullet_Code);

                    pkgitem.options.length;
                }

            }
        }

        ///////////////////////////////////////
        if (executequery.Tables[0].Rows[rownumEx].STYLE != null) {
            document.getElementById('drpstyle').value = executequery.Tables[0].Rows[rownumEx].STYLE;
        }

        if (executequery.Tables[0].Rows[rownumEx].CPN_CODE != null) {
            document.getElementById('drpcoutype').value = executequery.Tables[0].Rows[rownumEx].CPN_CODE;
        }
        else {
            document.getElementById('drpcoutype').value = "0";
        }
        if (executequery.Tables[0].Rows[rownumEx].STATE != null) {
            document.getElementById('drpstate').value = executequery.Tables[0].Rows[rownumEx].STATE;
        }
        else {
            document.getElementById('drpstate').value = "0";
        }
        if (executequery.Tables[0].Rows[rownumEx].CPN_NAME != null) {
            document.getElementById('txtcouno').value = executequery.Tables[0].Rows[rownumEx].CPN_NAME;
        }
        else {
            document.getElementById('txtcouno').value = "";
        }

        if (executequery.Tables[0].Rows[rownumEx].Ad_type_code != null) {
            document.getElementById('drpadtype').value = executequery.Tables[0].Rows[rownumEx].Ad_type_code;
        }
        bindadcategory();
        if (executequery.Tables[0].Rows[rownumEx].MOBILENO != null) {
            document.getElementById('txtMobile').value = executequery.Tables[0].Rows[rownumEx].MOBILENO;
        }
        if (executequery.Tables[0].Rows[rownumEx].Booking_type != null) {
            document.getElementById('hiddenbooktype').value = executequery.Tables[0].Rows[rownumEx].Booking_type;
        }
        if (executequery.Tables[0].Rows[rownumEx].branch != null) {
            document.getElementById('txtbranch').value = executequery.Tables[0].Rows[rownumEx].branch;
        }
        if (executequery.Tables[0].Rows[rownumEx].booked_by != null) {
            document.getElementById('txtbookedby').value = executequery.Tables[0].Rows[rownumEx].booked_by;
        }
        if (executequery.Tables[0].Rows[rownumEx].prev_booking != null) {
            document.getElementById('txtprevbook').value = executequery.Tables[0].Rows[rownumEx].prev_booking;
        }
        var datetime = executequery.Tables[0].Rows[rownumEx].DATE_TIME;
        //                if(datetime!=null)
        //                {
        //                    document.getElementById('txtdatetime').value = date_frmt_orcl(document.getElementById('hiddendateformat').value,datetime);//getdatechk.getDate(dateformat, datetime);
        //                 }   
        if (executequery.Tables[0].Rows[rownumEx].cio_booking_id != null) {
            document.getElementById('txtciobookid').value = executequery.Tables[0].Rows[rownumEx].cio_booking_id;
        }
        /*     if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy" && document.getElementById('txtdatetime').value != "")
        {
        var arr = document.getElementById('txtdatetime').value.split('/');
        var dd = arr[0];
        var mm = arr[1];
        var yy = arr[2];
        document.getElementById('txtdatetime').value = mm + "/" + dd + "/" + yy;
        }*/
        /************************* ad by rinki ****************************/
        var dd = "";
        var mm = "";
        var yy = "";
        var newdate = "";
        var dateformat = document.getElementById('hiddendateformat').value;
        if (dateformat == "dd/mm/yyyy") {
            var arrvalue1 = datetime.split('/');
            dd = arrvalue1[0];
            mm = arrvalue1[1];
            yy = arrvalue1[2];
            document.getElementById('txtdatetime').value = dd + "/" + mm + "/" + yy;
        }
        else if (dateformat == "mm/dd/yyyy") {
            var arrvalue1 = datetime.split('/');
            dd = arrvalue1[1];
            mm = arrvalue1[0];
            yy = arrvalue1[2];
            document.getElementById('txtdatetime').value = dd + "/" + mm + "/" + yy;
        }
        else if (dateformat == "yyyy/mm/dd") {
            var arrvalue1 = datetime.split('/');
            dd = arrvalue1[2];
            mm = arrvalue1[1];
            yy = arrvalue1[0];
            document.getElementById('txtdatetime').value = dd + "/" + mm + "/" + yy;
        }


        document.getElementById('hiddencioid').value = document.getElementById('txtciobookid').value;
        //txtappby.Text = executequery.Tables[0].Rows[rownumEx].ItemArray[5].ToString();
        // txtaudit.Text = executequery.Tables[0].Rows[rownumEx].ItemArray[6].ToString();
        if (executequery.Tables[0].Rows[rownumEx].RO_No != null) {
            document.getElementById('txtrono').value = executequery.Tables[0].Rows[rownumEx].RO_No;
            /////////////////////////modify category
            document.getElementById('hdnronomodify').value = executequery.Tables[0].Rows[rownumEx].RO_No;
        }
        var ro_date = executequery.Tables[0].Rows[rownumEx].RO_Date;

        if (ro_date == "1900/1/1" || ro_date == "1900/01/01" || ro_date == "" || ro_date == "01/01/1900" || ro_date == "1/1/1900" || ro_date == null) {
            document.getElementById('txtrodate').value = "";
        }
        else {
            document.getElementById('txtrodate').value = ro_date; // getdatechk.getDate(dateformat, ro_date);
        }

        if (executequery.Tables[0].Rows[rownumEx].ro_status != null) {
            document.getElementById('drprostatus').value = executequery.Tables[0].Rows[rownumEx].ro_status;
        }
        else {
            if (document.getElementById('hiddencopy').value == "copy") {
                document.getElementById('drprostatus').value = "2";
            }
            else {
                document.getElementById('drprostatus').value = executequery.Tables[0].Rows[rownumEx].ro_status;
            }
        }
        if (executequery.Tables[0].Rows[rownumEx].AgencyName != null) {
            document.getElementById('txtagency').value = executequery.Tables[0].Rows[rownumEx].AgencyName;
        }
        /////////////add by anuja
        //var codesubcode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.indexOf('(') + 1, document.getElementById('txtagency').value.length - 1);
        var codesubcode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.lastIndexOf(')'));
        var respaymode = QBC.bindPaymentMode_e(codesubcode, document.getElementById('hiddencompcode').value);
        if (respaymode.value != null && respaymode.value.Tables[0].Rows.length > 0)
            bindpayM(respaymode.value)
        document.getElementById('drppaymenttype').value = executequery.Tables[0].Rows[rownumEx].Agency_pay;
        ////////////////////////////end
        // FOR AGENCY BALANCE////////////add outstanding
        //   if (document.getElementById('HDNAGNOUTSTANDING').value = "Y") {
        if (document.getElementById('txtagency').value != "") {
            var res = QBC.getBalance(document.getElementById('hiddencompcode').value, document.getElementById('txtagency').value)
            var ds = res.value;
            if (ds != null && ds.Tables[0].Rows.length > 0) {
                if (ds.Tables[0].Rows[0].BALANCE == "0")
                    document.getElementById('txtagencybalance').value = "0";
                else {
                    if (ds.Tables[0].Rows[0].AMOUNT != null)
                        document.getElementById('txtagencybalance').value = ds.Tables[0].Rows[0].AMOUNT;
                }
            }
            else
                document.getElementById('txtagencybalance').value = "0";
        }
        //        }
        //        else{
        //        getpayandstatus();
        //       }
        document.getElementById('hiddenagencynew').value = document.getElementById('txtagency').value;
        //drpagency_SelectedIndexChanged(sender, e);

        ///////////////this is to bind the subagency drop down


        //////////////////////////////////////////////////////
        //2april
        if (executequery.Tables[0].Rows[rownumEx].Client == null || executequery.Tables[0].Rows[rownumEx].Client == "" || (executequery.Tables[0].Rows[rownumEx].Client == executequery.Tables[0].Rows[rownumEx].Client_code)) {
            document.getElementById('txtclient').value = executequery.Tables[0].Rows[rownumEx].Client_code;
        }
        else {

            document.getElementById('txtclient').value = executequery.Tables[0].Rows[rownumEx].Client + "(" + executequery.Tables[0].Rows[rownumEx].Client_code + ")";
        }

        if (executequery.Tables[0].Rows[rownumEx].Agency_address != null) {
            document.getElementById('txtagencyaddress').value = executequery.Tables[0].Rows[rownumEx].Agency_address;
        }
        document.getElementById('txtagencyaddress').title = document.getElementById('txtagencyaddress').value;
        //2april
        if (executequery.Tables[0].Rows[rownumEx].Client_address != null) {
            document.getElementById('txtclientadd').value = executequery.Tables[0].Rows[rownumEx].Client_address;
        }

        ////////////////////////////////////////////////////////////////////////////////
        if (executequery.Tables[0].Rows[rownumEx].Key_no != null) {
            document.getElementById('txtkeyno').value = executequery.Tables[0].Rows[rownumEx].Key_no;
        }

        if (executequery.Tables[0].Rows[rownumEx].Print_remark != null) {
            document.getElementById('txtprintremark').value = executequery.Tables[0].Rows[rownumEx].Print_remark;
        }
        var listpck = executequery.Tables[0].Rows[rownumEx].Package_code;
        document.getElementById('hiddenpackage').value = listpck;
        //////////////////this is to bind the package grid on what the value is saved in the database





        if (executequery.Tables[0].Rows[rownumEx].Package_code != null) {
            var listpck = executequery.Tables[0].Rows[rownumEx].Package_code;
            document.getElementById('hiddenpackage').value = listpck;
            //////////////////this is to bind the package grid on what the value is saved in the database


            res2 = null;
            res2 = QBC.bindpacforexe(document.getElementById('hiddencompcode').value, listpck);
            var dsexecut = res2.value;
            if (dsexecut == null) {
                alert(res2.error.description);
                return false;
            }




            document.getElementById('drppackagecopy').options.length = 0;
            for (i = 0; i <= dsexecut.Tables[0].Rows.length - 1; i++) {
                if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "") {
                    if (dsexecut.Tables[0].Rows[i].pck_code.toString() != "0") {
                        var arrfor_uom = dsexecut.Tables[0].Rows[i].pck_code.toString().split('@');
                        var res3 = QBC.getPackageInsert(arrfor_uom[0].toString(), document.getElementById('txtciobookid').value);
                        var dsinsert = res3.value;
                        if (dsinsert == null) {
                            alert(res3.error.description);
                            return false;
                        }
                        var T = dsexecut.Tables[0].Rows[i].Package_Name + "(" + dsinsert.Tables[0].Rows[0].inserts + ")";
                        var V = dsexecut.Tables[0].Rows[i].pck_code + "(" + dsinsert.Tables[0].Rows[0].inserts + ")";
                        document.getElementById('drppackagecopy').options[document.getElementById('drppackagecopy').options.length] = new Option(T, V);

                        document.getElementById('drppackagecopy').options.length;

                        //                        ListItem li;
                        //                        li = new ListItem();
                        //                        li.Text = dsexecut.Tables[0].Rows[i].ItemArray[1].ToString() + "(" + dsinsert.Tables[0].Rows[0].ItemArray[0].ToString() + ")";
                        //                        li.Value = dsexecut.Tables[0].Rows[i].ItemArray[2].ToString() + "(" + dsinsert.Tables[0].Rows[0].ItemArray[0].ToString() + ")"; ;
                        //                        //state = ds.Tables[0].Rows[i].ItemArray[2].ToString();
                        //                        drppackagecopy.Items.Add(li);

                    }
                }
            }

        }


        if (executequery.Tables[0].Rows[rownumEx].No_of_insertion != null) {
            document.getElementById('txtinsertion').value = executequery.Tables[0].Rows[rownumEx].No_of_insertion;
            document.getElementById('hiddeninsertion').value = executequery.Tables[0].Rows[rownumEx].No_of_insertion;
        }
        if (executequery.Tables[0].Rows[rownumEx].ATTACHMENT1 != null && executequery.Tables[0].Rows[rownumEx].ATTACHMENT1 != "") {
            document.getElementById('hidattach1').value = executequery.Tables[0].Rows[rownumEx].ATTACHMENT1;
            document.getElementById('attachment1').src = "Images/indexred.jpg";
        }
        var start_date = executequery.Tables[0].Rows[rownumEx].Insertion_date;
        if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy" && start_date != "") {
            var arr = start_date.split('/');
            var dd = arr[0];
            var mm = arr[1];
            var yy = arr[2];
            document.getElementById('txtdummydate').value = mm + "/" + dd + "/" + yy;


        }
        else if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd" && start_date != "") {
            var arr = start_date.split('/');
            var dd = arr[0];
            var mm = arr[1];
            var yy = arr[2];
            document.getElementById('txtdummydate').value = yy + "/" + mm + "/" + dd;


        }
        else {
            document.getElementById('txtdummydate').value = start_date; //getDate1(dateformat, start_date);
        }

        if (executequery.Tables[0].Rows[rownumEx].Repeating_day != null) {
            document.getElementById('txtrepeatingdate').value = executequery.Tables[0].Rows[rownumEx].Repeating_day;
        }
        /*new change ankur 15 feb*/
        //advcat(Session["compcode"].ToString());
        //binduom();
        if (executequery.Tables[0].Rows[rownumEx].Ad_cat_code != null) {
            document.getElementById('drpadcategory').value = executequery.Tables[0].Rows[rownumEx].Ad_cat_code;
            document.getElementById('hiddencatcode').value = document.getElementById('drpadcategory').value
        }
        bindPackage_CategoryChange();
        //            if (drpadcategory.Items.FindByValue(executequery.Tables[0].Rows[rownumEx].ItemArray[30].ToString()) != null)
        //            {
        //                hiddencatcode.Value = drpadcategory.SelectedValue = executequery.Tables[0].Rows[rownumEx].ItemArray[30].ToString();
        //            }
        //            else
        //            {
        //                hiddencatcode.Value = drpadcategory.SelectedValue = "0";
        //            }
        ///////////////////////
        /*change ankur*/
        res2 = null;
        res2 = QBC.getadsubcat(document.getElementById('hiddencompcode').value, document.getElementById('drpadcategory').value);
        var dx = res2.value;
        if (dx == null) {
            alert(res.error.description);
            return false;
        }


        document.getElementById('drpadsubcategory').options.length = 0;
        document.getElementById('drpadsubcategory').options[0] = new Option("-Select-", "0");
        document.getElementById('drpadsubcategory').options.length = 1;

        for (var i = 0; i < dx.Tables[0].Rows.length; ++i) {
            document.getElementById('drpadsubcategory').options[document.getElementById('drpadsubcategory').options.length] = new Option(dx.Tables[0].Rows[i].Adv_Subcat_Name, dx.Tables[0].Rows[i].Adv_Subcat_Code);

            document.getElementById('drpadsubcategory').options.length;
        }


        //  }



        ////////////////////////////////////////////////////////////////







        if (executequery.Tables[0].Rows[rownumEx].STYLE != null) {
            document.getElementById('drpstyle').value = executequery.Tables[0].Rows[rownumEx].STYLE;
        }

        if (executequery.Tables[0].Rows[rownumEx].Ad_sub_cat_code != null) {
            document.getElementById('hiddenad_subcat').value = document.getElementById('drpadsubcategory').value = executequery.Tables[0].Rows[rownumEx].Ad_sub_cat_code;
        }
        if (executequery.Tables[0].Rows[rownumEx].Color_code != null) {
            document.getElementById('drpcolor').value = executequery.Tables[0].Rows[rownumEx].Color_code;
        }

        for_uom = "";
        foruom_temp = "";

        ///////////////////
        /*new change ankur 15 feb*/
        if (executequery.Tables[0].Rows[rownumEx].Uom_code != null) {
            document.getElementById('drpuom').value = executequery.Tables[0].Rows[rownumEx].Uom_code;
            document.getElementById('hiddenuomcode').value = document.getElementById('drpuom').value;
        }
        //hiddenuomcode.Value = drpuom.SelectedValue = executequery.Tables[0].Rows[rownumEx].ItemArray[33].ToString();

        ////////
        if (executequery.Tables[0].Rows[rownumEx].Page_position_code != null) {
            document.getElementById('Hiddendrppageposition').value = executequery.Tables[0].Rows[rownumEx].Page_position_code;
        }

        //string adtype=drpadstype.SelectedValue;
        if (executequery.Tables[0].Rows[rownumEx].Ad_size_height != null) {
            document.getElementById('txtadsize1').value = executequery.Tables[0].Rows[rownumEx].Ad_size_height;
        }
        if (executequery.Tables[0].Rows[rownumEx].Ad_size_width != null) {
            document.getElementById('txtadsize2').value = executequery.Tables[0].Rows[rownumEx].Ad_size_width;
        }

        //       drpschemepck.SelectedValue = executequery.Tables[0].Rows[rownumEx].ItemArray[41].ToString();


        if (executequery.Tables[0].Rows[rownumEx].Total_area != null) {
            document.getElementById('txttotalarea').value = executequery.Tables[0].Rows[rownumEx].Total_area;
        }
        if (executequery.Tables[0].Rows[rownumEx].Card_rate != null) {
            document.getElementById('txtcardrate').value = executequery.Tables[0].Rows[rownumEx].Card_rate;
        }

        if (executequery.Tables[0].Rows[rownumEx].Card_amount != null) {
            document.getElementById('hiddencardamt').value = executequery.Tables[0].Rows[0].Card_amount;
        }
        //Inserting in hidden field to compare new and  Previous amount
        if (executequery.Tables[0].Rows[rownumEx].Bill_amount != null) {
            document.getElementById('hiddenprevamt').value = executequery.Tables[0].Rows[rownumEx].Bill_amount;
        }




        if (executequery.Tables[0].Rows[rownumEx].Gross_amount != null) {
            document.getElementById('txtgrossamt').value = executequery.Tables[0].Rows[rownumEx].Bill_amount;
            document.getElementById('hiddengrossamt').value = document.getElementById('txtgrossamt').value;
            document.getElementById('txttotalamt').value = executequery.Tables[0].Rows[rownumEx].Gross_amount;
            document.getElementById('hiddengross').value = document.getElementById('txttotalamt').value;
            document.getElementById('hiddenprevamt').value = document.getElementById('txtgrossamt').value
        }
        //hiddenprevamt.Value = executequery.Tables[0].Rows[rownumEx].ItemArray[75].ToString();


        //  if (drpboxcodenew.Items.FindByValue(executequery.Tables[0].Rows[rownumEx].ItemArray[77].ToString()) != null)
        // {
        document.getElementById('drpboxcodenew').value = executequery.Tables[0].Rows[rownumEx].Box_code;
        // }
        //            else
        //            {
        //                drpboxcodenew.SelectedValue = "0";
        //            }
        if (executequery.Tables[0].Rows[rownumEx].Box_no != null) {
            document.getElementById('txtboxnonew').value = executequery.Tables[0].Rows[rownumEx].Box_no;
        }
        if (executequery.Tables[0].Rows[rownumEx].Box_agency.toString() == "1") {
            document.getElementById('chkage').checked = true;
        }
        else {
            document.getElementById('chkage').checked = false;
        }
        if (executequery.Tables[0].Rows[rownumEx].Box_client.toString() == "1") {
            document.getElementById('chkclie').checked = true;
        }
        else {
            document.getElementById('chkclie').checked = false;
        }
        if (executequery.Tables[0].Rows[rownumEx].Box_address != null) {
            document.getElementById('txtboxadd').value = executequery.Tables[0].Rows[rownumEx].Box_address;
        }
        if (executequery.Tables[0].Rows[rownumEx].boxchrg != null) {
            document.getElementById('txtboxchrg').value = executequery.Tables[0].Rows[rownumEx].boxchrg;
        }
        if (executequery.Tables[0].Rows[rownumEx].SAPID != null) {
            document.getElementById('txtsapid').value = executequery.Tables[0].Rows[rownumEx].SAPID;
        }
        else {
            document.getElementById('txtsapid').value = "";
        }

        //  drpboxcode.SelectedValue = executequery.Tables[0].Rows[rownumEx].ItemArray[77].ToString();
        // txtboxno.Text = executequery.Tables[0].Rows[rownumEx].ItemArray[78].ToString();
        if (executequery.Tables[0].Rows[rownumEx].CLIENT_CAT_DISC != null) {
            document.getElementById('txtclientcatdisc').value = executequery.Tables[0].Rows[rownumEx].CLIENT_CAT_DISC;
        }
        else {
            document.getElementById('txtclientcatdisc').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CLIENT_CAT_D_AMT != null) {
            document.getElementById('txtclientcatam').value = executequery.Tables[0].Rows[rownumEx].CLIENT_CAT_D_AMT;
        }
        else {
            document.getElementById('txtclientcatam').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CLIENT_CAT_D_TYP != null) {
            document.getElementById('hdnclientcatdistype').value = executequery.Tables[0].Rows[rownumEx].CLIENT_CAT_D_TYP;
        }
        else {
            document.getElementById('hdnclientcatdistype').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].FLAT_FEQ_DISC != null) {
            document.getElementById('txtflatfreqdisc').value = executequery.Tables[0].Rows[rownumEx].FLAT_FEQ_DISC;
        }
        else {
            document.getElementById('txtflatfreqdisc').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].FLAT_FEQ_D_AMT != null) {
            document.getElementById('txtflatfreqamt').value = executequery.Tables[0].Rows[rownumEx].FLAT_FEQ_D_AMT;
        }
        else {
            document.getElementById('txtflatfreqamt').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].FLAT_FEQ_D_TYP != null) {
            document.getElementById('hdnflatfreqdisctype').value = executequery.Tables[rownumEx].Rows[0].FLAT_FEQ_D_TYP;
        }
        else {
            document.getElementById('hdnflatfreqdisctype').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CAT_DISC != null) {
            document.getElementById('txtcatdisc').value = executequery.Tables[0].Rows[rownumEx].CAT_DISC;
        }
        else {
            document.getElementById('txtcatdisc').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CAT_D_AMT != null) {
            document.getElementById('txtcatamt').value = executequery.Tables[0].Rows[rownumEx].CAT_D_AMT;
        }
        else {
            document.getElementById('txtcatamt').value = "";
        }
        if (executequery.Tables[0].Rows[rownumEx].CAT_D_TYP != null) {
            document.getElementById('hdncatdisctype').value = executequery.Tables[0].Rows[rownumEx].CAT_D_TYP;
        }
        else {
            document.getElementById('hdncatdisctype').value = "";
        }

        if (executequery.Tables[0].Rows[rownumEx].Ad_size_column != null) {
            document.getElementById('txtcolum').value = executequery.Tables[0].Rows[rownumEx].Ad_size_column;
        }

        if (executequery.Tables[0].Rows[rownumEx].Paid_ins != null) {
            document.getElementById('txtpaid').value = executequery.Tables[0].Rows[rownumEx].Paid_ins;
        }
        if (executequery.Tables[0].Rows[rownumEx].Contract_rate != null) {
            document.getElementById('txtdealrate').value = executequery.Tables[0].Rows[rownumEx].Contract_rate;
        }


        if (executequery.Tables[0].Rows[rownumEx].Contract_name != null) {
            document.getElementById('txtcontractname').value = executequery.Tables[0].Rows[rownumEx].Contract_name;
        }
        if (document.getElementById('txtcontractname').value == "") {
            document.getElementById('chkcontract').checked = false;
        }
        else {
            document.getElementById('chkcontract').checked = true;
        }


        if (executequery.Tables[0].Rows[rownumEx].Receipt_no != null) {
            document.getElementById('hiddenreceiptno').value = document.getElementById('txtreceipt').value = executequery.Tables[0].Rows[rownumEx].Receipt_no;
            ////modify category
             document.getElementById('hdnrecnomod').value= executequery.Tables[0].Rows[rownumEx].Receipt_no;

        }
        if (executequery.Tables[0].Rows[rownumEx].Material_status != null) {
            document.getElementById('drpmatstat').value = executequery.Tables[0].Rows[rownumEx].Material_status;
        }
        if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy" && executequery.Tables[0].Rows[rownumEx].Receipt_date != null) {
            var arr = executequery.Tables[0].Rows[rownumEx].Receipt_date.split('/');
            var dd = arr[0];
            var mm = arr[1];
            var yy = arr[2];
            document.getElementById('txtreceiptdate').value = mm + "/" + dd + "/" + yy;


        }
        else if (document.getElementById('hiddendateformat').value == "yyyy/mm/dd" && executequery.Tables[0].Rows[rownumEx].Receipt_date != "" && executequery.Tables[0].Rows[rownumEx].Receipt_date != null) {
            var arr = executequery.Tables[0].Rows[rownumEx].Receipt_date.split('/');
            var dd = arr[0];
            var mm = arr[1];
            var yy = arr[2];
            document.getElementById('txtreceiptdate').value = yy + "/" + mm + "/" + dd;


        }
        else {
            if (executequery.Tables[0].Rows[rownumEx].Receipt_date != null) {
                document.getElementById('txtreceiptdate').value = executequery.Tables[0].Rows[rownumEx].Receipt_date; //getDate1(dateformat, executequery.Tables[0].Rows[rownumEx].ItemArray[121].ToString());
            }
        }
        // txtreceiptdate.Text = executequery.Tables[0].Rows[rownumEx].ItemArray[121].ToString();//getDate1(dateformat, executequery.Tables[0].Rows[rownumEx].ItemArray[121].ToString());

        ////this is to bind the adscat3 drpdown



        if (executequery.Tables[0].Rows[rownumEx].Ad_Subcat3 == "null" || executequery.Tables[0].Rows[rownumEx].Ad_Subcat3 == null || executequery.Tables[0].Rows[rownumEx].Ad_Subcat3.toString() == "") {
            document.getElementById('drpadcat3').options.length = 0;
            document.getElementById('hiddenadscat3').value = "";

        }
        else {
            res3 = null;
            res3 = QBC.getvalfromadcat3(executequery.Tables[0].Rows[rownumEx].Ad_sub_cat_code, document.getElementById('hiddencompcode').value, "0");
            var dacat = res3.value;
            if (dacat == null) {
                alert(dacat.error.description);
                return false;
            }


            ////////////////////////////////////////////////////////////////
            document.getElementById('drpadcat3').options.length = 0;
            document.getElementById('drpadcat3').options[0] = new Option("Select", "0");
            for (var k = 0; k < dacat.Tables[0].Rows.length; k++) {
                document.getElementById('drpadcat3').options[document.getElementById('drpadcat3').options.length] = new Option(dacat.Tables[0].Rows[k].catname, dacat.Tables[0].Rows[k].catcode);

                document.getElementById('drpadcat3').options.length;
            }


        }

        if (executequery.Tables[0].Rows[rownumEx].Ad_Subcat3 != null) {
            document.getElementById('hiddenadscat3').value = document.getElementById('drpadcat3').value = executequery.Tables[0].Rows[rownumEx].Ad_Subcat3;
        }
        ////////////////////this is to bind the adcat4 drp down
        if (executequery.Tables[0].Rows[rownumEx].Ad_Subcat4 == null || executequery.Tables[0].Rows[rownumEx].Ad_Subcat4.toString() == "") {
            document.getElementById('drpadcat4').options.length = 0;
            document.getElementById('hiddenadscat4').value = "";

        }
        else {
            ////////////when 1 than bind the adscat4 drp down
            res3 = null;
            res3 = QBC.getvalfromadcat3(executequery.Tables[0].Rows[rownumEx].Ad_Subcat3, document.getElementById('hiddencompcode').value, "1");
            var dacat = res3.value;
            if (dacat == null) {
                alert(dacat.error.description);
                return false;
            }


            ////////////////////////////////////////////////////////////////
            document.getElementById('drpadcat4').options.length = 0;
            document.getElementById('drpadcat4').options[0] = new Option("Select", "0");
            for (var k = 0; k < dacat.Tables[0].Rows.length; k++) {
                document.getElementById('drpadcat4').options[document.getElementById('drpadcat4').options.length] = new Option(dacat.Tables[0].Rows[k].Cat_Name, dacat.Tables[0].Rows[k].Cat_Code);

                document.getElementById('drpadcat4').options.length;
            }

        }

        document.getElementById('hiddenadscat4').value = document.getElementById('drpadcat4').value = executequery.Tables[0].Rows[rownumEx].Ad_Subcat4;




        ///bind adcat5 drpdown
        if (executequery.Tables[0].Rows[rownumEx].Ad_subcat5 == null || executequery.Tables[0].Rows[rownumEx].Ad_subcat5.toString() == "" || executequery.Tables[0].Rows[rownumEx].Ad_subcat5.toString() == "0") {
            document.getElementById('drpadcat5').options.length = 0;
            document.getElementById('hiddenadscat5').value = "";
        }
        else {
            ////////////when 1 than bind the adscat4 drp down
            if (executequery.Tables[0].Rows[rownumEx].Ad_Subcat4 != null || executequery.Tables[0].Rows[rownumEx].Ad_Subcat4 != "" || executequery.Tables[0].Rows[rownumEx].Ad_Subcat4 != "0") {
                res3 = null;
                res3 = QBC.getvalfromadcat3(executequery.Tables[0].Rows[rownumEx].Ad_Subcat4, document.getElementById('hiddencompcode').value, "2");
                var dacat = res3.value;
                if (dacat == null) {
                    alert(dacat.error.description);
                    return false;
                }


                ////////////////////////////////////////////////////////////////
                document.getElementById('drpadcat5').options.length = 0;
                document.getElementById('drpadcat5').options[0] = new Option("Select", "0");
                for (var k = 0; k < dacat.Tables[0].Rows.length; k++) {
                    document.getElementById('drpadcat5').options[document.getElementById('drpadcat5').options.length] = new Option(dacat.Tables[0].Rows[k].Cat_Name, dacat.Tables[0].Rows[k].Cat_Code);

                    document.getElementById('drpadcat5').options.length;
                }
            }
        }
        document.getElementById('hiddenadscat5').value = document.getElementById('drpadcat5').value = executequery.Tables[0].Rows[rownumEx].Ad_subcat5;



        //////bind the bg color drp down 

        /*new change ankur 15 feb*/
        var combin_name = "";

        if (executequery.Tables[0].Rows[rownumEx].Bg_color != null) {
            document.getElementById('drpbgcolor').value = executequery.Tables[0].Rows[rownumEx].Bg_color;
        }
        if (executequery.Tables[0].Rows[rownumEx].DESIGN_BOX != null) {
            document.getElementById('drpdesign').value = executequery.Tables[0].Rows[rownumEx].DESIGN_BOX;
        }
        if (executequery.Tables[0].Rows[rownumEx].LOGOTYPE_PREM != null) {
            document.getElementById('drplogoprem').value = executequery.Tables[0].Rows[rownumEx].LOGOTYPE_PREM;
        }
        // }
        if (executequery.Tables[0].Rows[rownumEx].Bullet_code != null) {
            document.getElementById('drpbullet').value = executequery.Tables[0].Rows[rownumEx].Bullet_code;
        }
        document.getElementById('hiddencolortype').value = document.getElementById('drpcolortype').value;
        document.getElementById('hiddenbgcolor').value = document.getElementById('drpbgcolor').value;
        document.getElementById('hiddenbullet').value = document.getElementById('drpbullet').value;
        ////////////////////////////////////////////////////////////////
        if (document.getElementById('drpbullet').value != "0" && document.getElementById('drpbullet').value != "") {
            var eds = QBC.getbullprem(document.getElementById('hiddencompcode').value, document.getElementById('drpbullet').value, document.getElementById('hiddenuserid').value, "", "");
            if (eds != null && eds.value.Tables[0].Rows.length > 0) {

                document.getElementById('hiddenbullprem').value = eds.value.Tables[0].Rows[0].bullet_charges
                document.getElementById('hiddenbulletpremtype').value = eds.value.Tables[0].Rows[0].Bullet_Charges_Type
            }
        }

        //drpbgcolor.SelectedValue = executequery.Tables[0].Rows[rownumEx].ItemArray[107].ToString();

        /*   change  */
        if (executequery.Tables[0].Rows[rownumEx].Region != null) {
            document.getElementById('drpregion').value = executequery.Tables[0].Rows[rownumEx].Region;
        }
        if (executequery.Tables[0].Rows[rownumEx].Variant != null) {
            document.getElementById('drpvarient').value = executequery.Tables[0].Rows[rownumEx].Variant;
        }
        /*change ankur*/
        ///////this is to bind the bill to dropdown as agency and client////////

        bindbillto();
        if (executequery.Tables[0].Rows[rownumEx].Bill_to != null) {
            document.getElementById('drpbillto_qbc').value = executequery.Tables[0].Rows[rownumEx].Bill_to;

        }
        ///////////////////////////////////////////////////////////////////////////
        document.getElementById('hiddenbillto').value = document.getElementById('drpbillto_qbc').value;
        /*new change ankur 18 feb*/
        document.getElementById('hiddenuomdesc').value = executequery.Tables[0].Rows[rownumEx].uom_desc;
        if (document.getElementById('hiddenuomdesc').value == "ROL") {
            //document.getElementById('Label1').innerText="No. Of Lines";
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById('Label1').textContent = "No. Of Lines";
            }
            else {
                document.getElementById('Label1').innerText = "No. Of Lines";
            }
        }
        else if (document.getElementById('hiddenuomdesc').value == "CD") {
            //document.getElementById('Label1').innerText="Total Area";
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById('Label1').textContent = "Total Area";
            }
            else {
                document.getElementById('Label1').innerText = "Total Area";
            }
        }
        else if (document.getElementById('hiddenuomdesc').value == "ROW") {
            //document.getElementById('Label1').innerText="No. Of Words";
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById('Label1').textContent = "No. Of Words";
            }
            else {
                document.getElementById('Label1').innerText = "No. Of Words";
            }
        }
        else if (document.getElementById('hiddenuomdesc').value == "ROC") {
            //document.getElementById('Label1').innerText="No. Of Char";
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById('Label1').textContent = "No. Of Char";
            }
            else {
                document.getElementById('Label1').innerText = "No. Of Char";
            }
        }
        /*new change ankur 24 feb*/
        document.getElementById('hiddenlogomatter').value = executequery.Tables[0].Rows[rownumEx].logo;
        document.getElementById('txtlogohei').value = executequery.Tables[0].Rows[rownumEx].Logo_H;
        document.getElementById('txtlogowid').value = executequery.Tables[0].Rows[rownumEx].Logo_W;
        document.getElementById('drplogocolor').value = executequery.Tables[0].Rows[rownumEx].Logo_color;
        document.getElementById('txtlogouomcode').value = executequery.Tables[0].Rows[rownumEx].Logo_Uom;
        document.getElementById('hiddenlogocode').value = executequery.Tables[0].Rows[rownumEx].logo;
        ////////////////////////////
        if (executequery.Tables[0].Rows[rownumEx].Rate_code != null) {
            if (document.getElementById('drpratecode').options.length > 0)
                document.getElementById('drpratecode').value = executequery.Tables[0].Rows[rownumEx].Rate_code;
            else
                document.getElementById('drpratecode').options[0] = new Option(executequery.Tables[0].Rows[rownumEx].Rate_code, executequery.Tables[0].Rows[rownumEx].Rate_code);
        }
        getSharing();
        if (document.getElementById('hiddenbooktype').value == "2")
            getFMGRef();
        /*new change 15 feb*/

        // bindpackage();


        ///

    }

    else {
        alert("Your Search Produces No Result");
        clearClick();

        return false; ;
    }

    updateStatus();
    // bindrategroupvode(document.getElementById('drpadcategory').value);
    document.getElementById('btnfirst').disabled = true;
    document.getElementById('btnprevious').disabled = true;


    if (executequery.Tables[0].Rows.length - 1 == 0) {
        document.getElementById('btnfirst').disabled = true;
        document.getElementById('btnprevious').disabled = true;
        document.getElementById('btnnext').disabled = true;
        document.getElementById('btnlast').disabled = true;
    }
    ////// we have called a javascript function to show the grid during execution mode
    //ScriptManager.RegisterClientScriptBlock(this, typeof(Classified_Booking), "cc", "bindpackage()", true);
    document.getElementById('btndel').disabled = true;
    //  ScriptManager.RegisterClientScriptBlock(this, typeof(Classified_Booking), "ca", "showcardinfo('" + executequery.Tables[0].Rows[rownumEx].ItemArray[61].ToString() + "')", true);
    showgridexecute();

    if (document.getElementById('hiddenuomdesc').value == "CD") {
        if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtcolum').value != "") {
            document.getElementById('txtadsize2').disabled = false;
            document.getElementById('txtadsize1').style.backgroundColor = "#FFFFFF";
            document.getElementById('txtadsize2').style.backgroundColor = "#FFFFFF";
            document.getElementById('txtcolum').style.backgroundColor = "#FFFFFF";

        }
        else if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtadsize2').value != "") {
            document.getElementById('txtcolum').disabled = false;
            document.getElementById('txtadsize1').style.backgroundColor = "#FFFFFF";
            document.getElementById('txtadsize2').style.backgroundColor = "#FFFFFF";
            document.getElementById('txtcolum').style.backgroundColor = "#FFFFFF";

        }


    }
    else if (document.getElementById('hiddenuomdesc').value != "CD") {
        document.getElementById('txtadsize1').disabled = true;
        document.getElementById('txtadsize2').disabled = true;
        if (document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROD") {
            document.getElementById('Label1').innetHTML = "No. Of Lines";
            document.getElementById('txtadsize1').style.backgroundColor = "Gray";
            document.getElementById('txtadsize2').style.backgroundColor = "Gray";
            document.getElementById('txtcolum').style.backgroundColor = "Gray";
            document.getElementById('txtcolum').disabled = true;


        }
        else if (document.getElementById('hiddenuomdesc').value == "ROW") {
            document.getElementById('Label1').innerHTML = "No. Of Words";
            document.getElementById('txtadsize1').style.backgroundColor = "Gray";
            document.getElementById('txtadsize2').style.backgroundColor = "Gray";
            document.getElementById('txtcolum').style.backgroundColor = "Gray";
            document.getElementById('txtcolum').disabled = true;
        }
        else if (document.getElementById('hiddenuomdesc').value == "ROC") {
            document.getElementById('Label1').innerHTML = "No. Of Words";
            document.getElementById('txtadsize1').style.backgroundColor = "Gray";
            document.getElementById('txtadsize2').style.backgroundColor = "Gray";
            document.getElementById('txtcolum').style.backgroundColor = "Gray";
            document.getElementById('txtcolum').disabled = true;
        }

    }
    document.getElementById('txtlogowid').disabled = true;
    document.getElementById('btnlogoupload').disabled = true;
    if (document.getElementById('hiddenadsearch').value == "true") {
        document.getElementById('btnNew').disabled = true;
        document.getElementById('btnQuery').disabled = true;
        document.getElementById('btnCancel').disabled = true;
        document.getElementById('btnExecute').disabled = true;
        document.getElementById('btnModify').disabled = true;
        document.getElementById('btnSave').disabled = true;
        document.getElementById('btnSaveConfirm').disabled = true;
        document.getElementById('btnDelete').disabled = true;
    }
    if (document.getElementById('hiddenconfirm_Permission').value == "1" && document.getElementById('drprostatus').value == "2") {

        document.getElementById('btnconfirm').disabled = false;
    }
    document.getElementById('lbreceipt').disabled = false;
    document.getElementById('drppaymenttype').disabled = true;
    fillQBCDetailPopUp();
    setButtonImages();
//   if(hidcopymodicategory == "copy"){
//            
//            document.getElementById('btnfirst').disabled = true;
//            document.getElementById('btnprevious').disabled = true;
//            document.getElementById('btnnext').disabled = true;
//            document.getElementById('btnlast').disabled = true;
//        }
    return false;
}
function fillQBCDetailPopUp() {
    document.getElementById('hiddenexecname').value = "";
    document.getElementById('hiddenproduct').value = "";
    document.getElementById('hiddendrppageprem').value = "";
    document.getElementById('hiddentxtpremper').value = "";
    document.getElementById('hiddenagreedamt').value = "";
    document.getElementById('hiddenspediscper').value = "";
    document.getElementById('hiddenspedisc').value = "";
    document.getElementById('hiddenretainer').value = "";
    document.getElementById('hiddenpay').value = "";
    document.getElementById('hiddenzone').value = "";
    document.getElementById('hiddenretainercomm').value = "";
    document.getElementById('hiddenspecharges').value = "";
    var res = QBC.fetchData(document.getElementById('hiddencompcode').value, document.getElementById('txtciobookid').value);
    if (res.value != null) {
        var ds = res.value;
        if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0) {
            if (ds.Tables[0].Rows[0].execname != null)
                document.getElementById('hiddenexecname').value = ds.Tables[0].Rows[0].execname;
            if (ds.Tables[0].Rows[0].product != null)
                document.getElementById('hiddenproduct').value = ds.Tables[0].Rows[0].product;
            if (ds.Tables[0].Rows[0].Page_prem != null)
                document.getElementById('hiddendrppageprem').value = ds.Tables[0].Rows[0].Page_prem;
            if (ds.Tables[0].Rows[0].Prem_per != null)
                document.getElementById('hiddentxtpremper').value = ds.Tables[0].Rows[0].Prem_per;
            if (ds.Tables[0].Rows[0].Agreed_amount != null)
                document.getElementById('hiddenagreedamt').value = ds.Tables[0].Rows[0].Agreed_amount;
            if (ds.Tables[0].Rows[0].Special_disc_per != null)
                document.getElementById('hiddenspediscper').value = ds.Tables[0].Rows[0].Special_disc_per;
            if (ds.Tables[0].Rows[0].Special_discount != null)
                document.getElementById('hiddenspedisc').value = ds.Tables[0].Rows[0].Special_discount;
            if (ds.Tables[0].Rows[0].RETAINER1 != null)
                document.getElementById('hiddenretainer').value = ds.Tables[0].Rows[0].RETAINER1;
            if (ds.Tables[0].Rows[0].Agency_pay != null)
                document.getElementById('hiddenpay').value = ds.Tables[0].Rows[0].Agency_pay;
            if (ds.Tables[0].Rows[0].Executive_zone != null)
                document.getElementById('hiddenzone').value = ds.Tables[0].Rows[0].Executive_zone;
            if (ds.Tables[0].Rows[0].RETAINER_COMM != null)
                document.getElementById('hiddenretainercomm').value = ds.Tables[0].Rows[0].RETAINER_COMM;
            if (ds.Tables[0].Rows[0].Special_charges != null)
                document.getElementById('hiddenspecharges').value = ds.Tables[0].Rows[0].Special_charges;
        }
    }
}
function firstClick() {
    clearClick();
    if (document.getElementById('hdnmodifycateg').value == "Y") {
        hidcopymodicategory = "copy";
    }
    rownumEx = 0;
    fillDATA();
    document.getElementById('btnfirst').disabled = true;
    document.getElementById('btnprevious').disabled = true;
    setButtonImages();
    return false;
}
function lastClick() {
    clearClick();
    if (document.getElementById('hdnmodifycateg').value == "Y") {
        hidcopymodicategory = "copy";
    }
    var count = executequery.Tables[0].Rows.length - 1;
    rownumEx = count;
    fillDATA();
    document.getElementById('btnfirst').disabled = false;
    document.getElementById('btnprevious').disabled = false;
    document.getElementById('btnlast').disabled = true;
    document.getElementById('btnnext').disabled = true;
    setButtonImages();
    return false;
}
function prevClick() {
    clearClick();
    if (document.getElementById('hdnmodifycateg').value == "Y") {
        hidcopymodicategory = "copy";
    }
    rownumEx = parseInt(rownumEx) - 1;
    fillDATA();
    document.getElementById('btnnext').disabled = false;
    document.getElementById('btnlast').disabled = false;
    if (rownumEx == 0) {
        document.getElementById('btnfirst').disabled = true;
        document.getElementById('btnprevious').disabled = true;
    }
    else {
        document.getElementById('btnfirst').disabled = false;
        document.getElementById('btnprevious').disabled = false;
    }
    setButtonImages();
    return false;
}
function nextClick() {
    clearClick();
    if (document.getElementById('hdnmodifycateg').value == "Y") {
        hidcopymodicategory = "copy";
    }
    rownumEx = parseInt(rownumEx) + 1;
    var count = executequery.Tables[0].Rows.length - 1;
    fillDATA();
    document.getElementById('btnprevious').disabled = false;
    document.getElementById('btnfirst').disabled = false;
    if (rownumEx == count) {
        document.getElementById('btnlast').disabled = true;
        document.getElementById('btnnext').disabled = true;
    }
    else {
        document.getElementById('btnlast').disabled = false;
        document.getElementById('btnnext').disabled = false;
    }
    setButtonImages();
    return false;
}
function modifyClick() {
    document.getElementById('lblbooking').style.display = "none";
    //    if (document.getElementById("drprostatus").value == "1" && document.getElementById('hideditagency').value != "Y") {
    //        alert("You can not modify confirm Ad");
    //        return false;
    //    }
    if (document.getElementById("drprostatus").value == "1" && document.getElementById('hideditagency').value == "Y") {
        chkbtnStatus = "modify";
        document.getElementById('hiddensavemod').value = "01";
        document.getElementById('txtagency').readOnly = false;
    }
    chkbtnStatus = "modify";
    document.getElementById('txtreceipt').readOnly = true;
    if (document.getElementById('txtagency').value == "") {
        document.getElementById('txtagency').value = document.getElementById('hdnagencyname').value;
    }

    document.getElementById("get_pacakge_new").disabled = true;
    document.getElementById('hiddenmodifyinsert').value = document.getElementById('txtinsertion').value;

    if (document.getElementById('chkhindu') != null) {
        document.getElementById("chkhindu").disabled = false;
        document.getElementById("chkhindi").disabled = false;
        document.getElementById('chkhindi').disabled = true;
        document.getElementById('chkhindu').disabled = true;
    }
    document.getElementById('btnlogoupload').disabled = false;
    document.getElementById('hiddensavemod').value = "01";

    /*change ankur*/
    document.getElementById('drpbillto_qbc').disabled = false;

    ///////////////////////////////////////
    /*new change ankur 10 feb*/
    //        if (document.getElementById('hiddencopy').value == "copy")
    //        {
    //            //ScriptManager.RegisterClientScriptBlock(this, typeof(QBC), "getprevid", "prevcioidformatter=document.getElementById('txtciobookid').value;", true);
    //            // btnNew_Click(sender, e);
    //            document.getElementById('hiddendummycioid').value = document.getElementById('txtciobookid').value;
    //            forcopydate();
    //            insertstatus = "0";
    //            document.getElementById('hiddensavemod').value = "01";

    //            DataSet dsmatter = new DataSet();
    //            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
    //            {
    //                NewAdbooking.Classes.BookingMaster getData = new NewAdbooking.Classes.BookingMaster();

    //                dsmatter = getData.getMatter(hiddendummycioid.Value, "copy");
    //                Session["copy_matter"] = dsmatter;
    //            }
    //            else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
    //            {
    //                NewAdbooking.classesoracle.BookingMaster getData = new NewAdbooking.classesoracle.BookingMaster();

    //                dsmatter = getData.getMatter(hiddendummycioid.Value, "copy");
    //                Session["copy_matter"] = dsmatter;
    //            }
    //            else
    //            {
    //                NewAdbooking.classmysql.BookingMaster getData = new NewAdbooking.classmysql.BookingMaster();

    //                dsmatter = getData.getMatter(hiddendummycioid.Value, "copy");
    //                Session["copy_matter"] = dsmatter;
    //            }

    //            category

    //        }

    document.getElementById('chkcontract').disabled = true;

    modifyMatter = 1;

    /////if in the insertion grid record insertion status is publish or hold or cancel than the main form except the
    ////insert grid record cannot modify
    res = null;
    res = QBC.fetchdataforexe(document.getElementById('txtciobookid').value, document.getElementById('hiddencompcode').value);
    var dex = res.value;
    if (dex == null) {
        alert(res.error.description);
        return false;
    }


    for (var j = 0; j <= dex.Tables[0].Rows.length - 1; j++) {


        if (dex.Tables[0].Rows[j].Insert_status == "publish") {
            insertstatus = "2";
            break;
        }
        else if (dex.Tables[0].Rows[j].Insert_status == "billed") {
            insertstatus = "1";
            document.getElementById('hiddensavemod').value = "1";
            break;
        }
        else {
            insertstatus = "0";
        }
    }
    if (document.getElementById('hiddenbooktype').value == "2")
        document.getElementById('btnfmg').disabled = false;
    else
        document.getElementById('btnfmg').disabled = true;
    if (insertstatus == "2") {
        if (document.getElementById('drpratecode').style.display != "none") {
            document.getElementById('drpratecode').disabled = true;
        }
        document.getElementById('drpboxcodenew').disabled = true;
        //txtboxadd.Enabled = true;
        document.getElementById('btnlogo').disabled = true;
        //btnupload.Enabled = false;
        document.getElementById('btnsharing').disabled = true;
        document.getElementById('txtciobookid').disabled = true;
        // txtappby.Enabled = true;
        //txtaudit.Enabled = true;
        document.getElementById('txtrono').disabled = true;
        document.getElementById('txtrodate').disabled = true;

        document.getElementById('btnholding').disabled = false;
        document.getElementById('drprostatus').disabled = true;
        //txtagency.Enabled = true;
        document.getElementById('txtagency').readOnly = true;
        document.getElementById('txtclient').disabled = false;
        document.getElementById('txtbranch').disabled = true;
        // txtagencyaddress.Enabled = true;
        document.getElementById('txtclientadd').disabled = false;
        document.getElementById('btndeal').disabled = false;
        //txtprintremark.Enabled = true;
        document.getElementById('txtMobile').disabled = false;
        document.getElementById('txtprintremark').disabled = true;
        document.getElementById('drppackage').disabled = true;
        document.getElementById('txtinsertion').disabled = true;
        document.getElementById('txtdummydate').disabled = true;
        document.getElementById('txtrepeatingdate').disabled = true;

        document.getElementById('drpadcategory').disabled = true;
        document.getElementById('chktrade').disabled = true;

        document.getElementById('chkall').disabled = true;
        document.getElementById('drpadsubcategory').disabled = true;
        document.getElementById('drpcolor').disabled = true;
        document.getElementById('drpuom').disabled = true;
        document.getElementById('Hiddendrppageposition').disabled = true;
        document.getElementById('txtkeyno').disabled = false;

        // txtadsizetypeheight.Enabled = true;
        //txtadsizetypewidth.Enabled = true;

        //txtdatetime.Enabled = false;
        document.getElementById('txtdatetime').readOnly = true;
        document.getElementById('txtrepeatingdate').disabled = true;


        document.getElementById('txtadsize2').disabled = true;
        document.getElementById('txtadsize1').disabled = true;
        //txttotalarea.Enabled = false;
        document.getElementById('txttotalarea').readOnly = true;

        document.getElementById('drpregion').disabled = true;
        //txtboxno.Enabled = true;

        //txtgrossamt.Enabled = false;
        document.getElementById('txtgrossamt').readOnly = true;
        document.getElementById('txttotalamt').readOnly = true;
        document.getElementById('drpregion').disabled = true;

        document.getElementById('txtinsertion').disabled = true;
        document.getElementById('txtcolum').disabled = true;
        document.getElementById('drpmatstat').disabled = true;

        ///////////////////////
        document.getElementById('txtcontractname').disabled = true;

        document.getElementById('btnlogo').disabled = true;
        document.getElementById('drpcolortype').disabled = true;

        /*new change ankur 24 feb*/
        document.getElementById('txtlogohei').disabled = true;
        //txtlogohei.Text = "";
        //txtlogoname.Text = "";
        document.getElementById('drplogocolor').disabled = true;
        //drplogocolor.SelectedValue = "0";

        document.getElementById('txteyecathval').disabled = true;
        ///add by anuja
        if (document.getElementById('drppaymenttype').value == "CH0" || document.getElementById('drppaymenttype').value == "PR0" || document.getElementById('drppaymenttype').value == "DD0" || document.getElementById('drppaymenttype').value == "SW0" || document.getElementById('drppaymenttype').value == "ON0") {

            document.getElementById('chequedetailbox').disabled = false;
        }

        document.getElementById('drppaymenttype').disabled = true;

        /////////////////////////////////

    }
    else if (insertstatus == "1") {
        document.getElementById('btnsharing').disabled = true;
        document.getElementById('drpboxcodenew').disabled = true;
        //txtboxadd.Enabled = false;
        document.getElementById('txtciobookid').disabled = true;
        // txtappby.Enabled = true;
        //txtaudit.Enabled = true;
        document.getElementById('txtrono').disabled = true;
        document.getElementById('txtrodate').disabled = true;

        document.getElementById('txtMobile').disabled = true;
        document.getElementById('drprostatus').disabled = true;
        //txtagency.Enabled = false;
        document.getElementById('txtagency').readOnly = true;
        document.getElementById('txtclient').disabled = true;
        document.getElementById('txtbranch').disabled = true;
        // txtagencyaddress.Enabled = true;
        document.getElementById('txtclientadd').disabled = true;

        document.getElementById('txtprintremark').disabled = true;
        document.getElementById('drppackage').disabled = true;
        document.getElementById('chktrade').disabled = true;
        document.getElementById('txtkeyno').disabled = true;

        document.getElementById('txtinsertion').disabled = true;
        document.getElementById('txtdummydate').disabled = true;
        document.getElementById('txtrepeatingdate').disabled = true;

        document.getElementById('drpadcategory').disabled = true;
        document.getElementById('chkall').disabled = true;
        document.getElementById('drpadsubcategory').disabled = true;
        document.getElementById('drpcolor').disabled = true;
        document.getElementById('drpuom').disabled = true;
        document.getElementById('Hiddendrppageposition').disabled = true;

        // txtadsizetypeheight.Enabled = true;
        //txtadsizetypewidth.Enabled = true;

        document.getElementById('txtdatetime').readOnly = true;
        //txtdatetime.Enabled = false;
        document.getElementById('txtrepeatingdate').disabled = true;


        //txtcardrate.Enabled = false;
        document.getElementById('txtcardrate').readOnly = true;

        document.getElementById('txtadsize2').disabled = true;
        document.getElementById('txtadsize1').disabled = true;
        //txttotalarea.Enabled = false;
        document.getElementById('txttotalarea').readOnly = true;

        document.getElementById('drpregion').disabled = true;
        //txtboxno.Enabled = true;


        //txtgrossamt.Enabled = false;
        document.getElementById('txtgrossamt').readOnly = true;
        document.getElementById('txttotalamt').readOnly = true;

        document.getElementById('drpregion').disabled = true;

        document.getElementById('txtinsertion').disabled = true;

        document.getElementById('txtcolum').disabled = true;

        // txtboxno.Enabled = false;
        document.getElementById('drpmatstat').disabled = true;


        ///////////////////////
        document.getElementById('txtcontractname').disabled = true;

        document.getElementById('btnlogo').disabled = true;
        /*new change ankur 9 feb*/
        document.getElementById('drpcolortype').disabled = true;

        /*new change ankur 24 feb*/
        document.getElementById('txtlogohei').disabled = true;
        //txtlogohei.Text = "";
        //txtlogoname.Text = "";
        document.getElementById('drplogocolor').disabled = true;
        ///add by anuja
        if (document.getElementById('drppaymenttype').value == "CH0" || document.getElementById('drppaymenttype').value == "PR0" || document.getElementById('drppaymenttype').value == "DD0" || document.getElementById('drppaymenttype').value == "SW0" || document.getElementById('drppaymenttype').value == "ON0") {
            document.getElementById('chequedetailbox').disabled = false;
        }

        document.getElementById('drppaymenttype').disabled = true;

        // document.getElementById('drppaymenttype').disabled = true;

        ///////////////end
        if (document.getElementById('drpratecode').style.display != "none") {
            document.getElementById('drpratecode').disabled = true;
        }
        //drplogocolor.SelectedValue = "0";

        /////////////////////////////////


    }
    else if (insertstatus == "0") {

        if (document.getElementById('drpratecode').style.display != "none") {
            document.getElementById('drpratecode').disabled = false;
        }
        document.getElementById('btnsharing').disabled = false;
        document.getElementById('drpboxcodenew').disabled = false;
        document.getElementById('txtprintremark').disabled = true;
        //txtboxadd.Enabled = true;
        /*new change 14 feb*/
        //drpadtype.SelectedValue = "0";
        document.getElementById('drpadtype').disabled = true;
        /////////////////////
        document.getElementById('btnlogo').disabled = false;
        //btnupload.Enabled = true;
        ///add by anuja
        if (document.getElementById('drppaymenttype').value == "CH0" || document.getElementById('drppaymenttype').value == "PR0" || document.getElementById('drppaymenttype').value == "DD0" || document.getElementById('drppaymenttype').value == "SW0" || document.getElementById('drppaymenttype').value == "ON0") {

            document.getElementById('chequedetailbox').disabled = false;
        }

        document.getElementById('drppaymenttype').disabled = true;

        // document.getElementById('drppaymenttype').disabled = true;
        ///////////////////////end
        document.getElementById('txtciobookid').disabled = true;
        // txtappby.Enabled = true;
        //txtaudit.Enabled = true;
        document.getElementById('txtrono').disabled = false;
        document.getElementById('txtrodate').disabled = true;
        document.getElementById('txtMobile').disabled = false;
        document.getElementById('chktrade').disabled = false;
        document.getElementById('txtkeyno').disabled = false;

        document.getElementById('drprostatus').disabled = true;
        //txtagency.Enabled = true;
        document.getElementById('txtagency').readOnly = true;
        document.getElementById('txtclient').disabled = false;
        document.getElementById('txtbranch').disabled = false;
        // txtagencyaddress.Enabled = true;
        document.getElementById('txtclientadd').disabled = false;

        //            txtprintremark.Enabled = true;
        document.getElementById('drppackage').disabled = false;
        document.getElementById('txtinsertion').disabled = false;
        document.getElementById('txtdummydate').disabled = false;
        document.getElementById('txtrepeatingdate').disabled = false;

        document.getElementById('drpadcategory').disabled = false;
        document.getElementById('chkall').disabled = false;
        document.getElementById('drpadsubcategory').disabled = false;
        document.getElementById('drpcolor').disabled = false;
        document.getElementById('drpuom').disabled = false;
        document.getElementById('Hiddendrppageposition').disabled = true;

        // txtadsizetypeheight.Enabled = true;
        //txtadsizetypewidth.Enabled = true;

        document.getElementById('txtdatetime').readOnly = true;
        //txtdatetime.Enabled = false;
        document.getElementById('txtrepeatingdate').disabled = false;


        document.getElementById('txtadsize2').disabled = false;
        document.getElementById('txtadsize1').disabled = false;
        //txttotalarea.Enabled = false;
        document.getElementById('txttotalarea').readOnly = false;

        document.getElementById('drpregion').disabled = true;
        //txtboxno.Enabled = true;


        //txtgrossamt.Enabled = false;
        document.getElementById('txtgrossamt').readOnly = true;
        document.getElementById('txttotalamt').readOnly = true;
        document.getElementById('drpregion').disabled = true;

        document.getElementById('txtinsertion').disabled = false;
        document.getElementById('txtcolum').disabled = false;
        document.getElementById('drpmatstat').disabled = true;



        ///////////////////////
        document.getElementById('txtcontractname').disabled = true;

        document.getElementById('btncopy').disabled = true;
        document.getElementById('btndel').disabled = true;
        document.getElementById('btnlogo').disabled = false;
        /*new change ankur 9 feb*/
        document.getElementById('drpcolortype').disabled = true;
        /*new change ankur 15 feb*/
        document.getElementById('drpbgcolor').disabled = false;
        document.getElementById('drpbullet').disabled = false;
        document.getElementById('drplogoprem').disabled = false;
        document.getElementById('drpdesign').disabled = false;
        document.getElementById('drppackagecopy').disabled = false;
        //            drpvarient.Enabled = true;
        document.getElementById('drpadcat3').disabled = false;
        document.getElementById('drpadcat4').disabled = false;
        document.getElementById('drpadcat5').disabled = false;
        document.getElementById('drprostatus').disabled = false;
        //////////////////////////////
        /*new change ankur 24 feb*/
        document.getElementById('txtlogohei').disabled = false;
        //txtlogohei.Text = "";
        //txtlogoname.Text = "";
        document.getElementById('drplogocolor').disabled = false;
        //drplogocolor.SelectedValue = "0";
        document.getElementById('btnlogoupload').disabled = false;
        /////////////////////////////////


        document.getElementById('btndel').disabled = true;
        document.getElementById('btnpaygateway').disabled = false;
    }



    if (document.getElementById('hiddenuomdesc').value == "CD") {
        document.getElementById('drpboxcodenew').disabled = true;
        document.getElementById('drpbullet').disabled = true;
        document.getElementById('drplogoprem').disabled = true;
        document.getElementById('drpdesign').disabled = true;
        if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtcolum').value != "") {
            document.getElementById('txtadsize2').disabled = true;
            document.getElementById('txtadsize1').style.backgroundColor = "#FFFFFF";
            document.getElementById('txtadsize2').style.backgroundColor = "#FFFFFF";
            document.getElementById('txtcolum').style.backgroundColor = "#FFFFFF";

        }
        else if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtadsize2').value != "") {
            document.getElementById('txtcolum').disabled = true;
            document.getElementById('txtadsize1').style.backgroundColor = "#FFFFFF";
            document.getElementById('txtadsize2').style.backgroundColor = "#FFFFFF";
            document.getElementById('txtcolum').style.backgroundColor = "#FFFFFF";

        }


    }
    else if (document.getElementById('hiddenuomdesc').value != "CD") {
        document.getElementById('txtadsize1').disabled = true;
        document.getElementById('txtadsize2').disabled = true;
        if (document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROD") {
            document.getElementById('Label1').innerHTML = "No. Of Lines";
            document.getElementById('txtadsize1').style.backgroundColor = "Gray";
            document.getElementById('txtadsize2').style.backgroundColor = "Gray";
            document.getElementById('txtcolum').style.backgroundColor = "Gray";
            document.getElementById('txtcolum').disabled = true;


        }
        else if (document.getElementById('hiddenuomdesc').value == "ROW") {
            document.getElementById('Label1').innerHTML = "No. Of Words";
            document.getElementById('txtadsize1').style.backgroundColor = "Gray";
            document.getElementById('txtadsize2').style.backgroundColor = "Gray";
            document.getElementById('txtcolum').style.backgroundColor = "Gray";
            document.getElementById('txtcolum').disabled = false;
        }
        else if (document.getElementById('hiddenuomdesc').value == "ROC") {
            document.getElementById('Label1').innerHTML = "No. Of Words";
            document.getElementById('txtadsize1').style.backgroundColor = "Gray";
            document.getElementById('txtadsize2').style.backgroundColor = "Gray";
            document.getElementById('txtcolum').style.backgroundColor = "Gray";
            document.getElementById('txtcolum').disabled = true;
        }

    }
    //2april
    document.getElementById('txtlogohei').disabled = true;
    document.getElementById('txtlogowid').disabled = true;
    document.getElementById('txtlogouomcode').disabled = true;
    //2april
    document.getElementById('txtreceiptdate').disabled = true;

    //saveormodify = "01";

    //ScriptManager.RegisterClientScriptBlock(this, typeof(Classified_Booking), "c1", "bindgridpkg('" + listpck + "')", true);           
    // showgridexecute();
    var index = document.getElementById('drpcolor').selectedIndex;
    var textcolor = document.getElementById('drpcolor').options[index].text;
    if (textcolor.indexOf("COLOR") < 0) {
        document.getElementById('drpbgcolor').disabled = true;
    }
    enableGridItems();
    if (hidcopy == "copy") {
        document.getElementById('hiddendummycioid').value = document.getElementById('txtciobookid').value;
        document.getElementById('hiddensavemod').value = "0";
        saveormodify = "0";
        //autogenerated("0");
        autogeneratedtempid();
    }
    ////////////////add for modify category
    if (hidcopymodicategory == "copy") {
        document.getElementById('hiddendummycioid').value = document.getElementById('txtciobookid').value;
        document.getElementById('hiddensavemod').value = "0";
        document.getElementById('hiddenagreedamt').value = document.getElementById('txttotalamt').value;
        saveormodify = "0";
        //autogenerated("0");
        autogeneratedtempid();
    }
    chkstatus(document.getElementById('hiddenbuttonidcheck').value);
    //2april
    document.getElementById('btnconfirm').disabled = false;
    document.getElementById('btnshgrid').disabled = false;
    //2april
    document.getElementById('btnSave').disabled = false;
    document.getElementById('btnSaveConfirm').disabled = false;
    document.getElementById('btnQuery').disabled = true;

    document.getElementById('drpstyle').disabled = false;

    document.getElementById('btnholding').disabled = false;

    if (document.getElementById('hdndepo').value == "depo") {

        document.getElementById('btnsavepay').disabled = true;
        document.getElementById('btndiscount').disabled = true;
        document.getElementById('lbltrade').style.display = "none"
        document.getElementById('chktrade').style.display = "none"


    }
    document.getElementById('txtrono').disabled = true;

    document.getElementById('txttotalarea').disabled = false;



    setButtonImages();
    return false;
}
function saveClick() {
    var msg = checkSession();

    if (msg == false) {
        window.location.href = "login.aspx";
        return false;
    }
    if (document.getElementById('drppaymenttype').value == "CH0" || document.getElementById('drppaymenttype').value == "PR0" || document.getElementById('drppaymenttype').value == "DD0" || document.getElementById('drppaymenttype').value == "SW0" || document.getElementById('drppaymenttype').value == "ON0") {
        if (document.getElementById('hdnflagdetail').value == "false") {
            alert('Please Fill Cheque Details');
            return false;
        }
    }
    if (document.getElementById('hiddenorigbranch').value != document.getElementById('txtbranch').value) {
        alert("Booking Modification can't be done by diffrenet branch");
        return false;
    }
    /////////////////outstanding
    if (document.getElementById('drppaymenttype').value == "CR0") {
        if (document.getElementById('txttotalamt').value != "") {

            var cioid212 = "";
            var modflg212 = "";
            if (document.getElementById('hiddensavemod').value == "01") {
                cioid212 = document.getElementById('txtciobookid').value;
                modflg212 = "M";
            }
            else {
                cioid212 = "";
                modflg212 = "N";
            }
        }
        if (document.getElementById('txtagencyoutstand').value != "" && document.getElementById('txtagencyoutstand').value != "0" && document.getElementById('txttotalamt').value != "") {
            var datetimecredit = document.getElementById('txtdatetime').value;
            var dateformat = document.getElementById('hiddendateformat').value
            var agcodeforcreadit = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.lastIndexOf(')'));
            var credit = QBC.CHECKBOOKINGCREDITLIMIT(document.getElementById('hiddencompcode').value, agcodeforcreadit, document.getElementById('txtagencyoutstand').value, document.getElementById('txttotalamt').value, datetimecredit, dateformat, cioid212, modflg212);
            var creditda = credit.value;
            if (creditda == null) {
                alert(credit.error.description);
                return false;
            }
            if (creditda.Tables[0].Rows[0].Message1 == "FALSE") {
                alert("Creadit Limit Exceeded");
                return false;
            }
        }
    }
    ///////////////add for getway
    if (document.getElementById('hdndepo').value == "depo") {
        if (document.activeElement.id == "btnSave") {
            alert("please click on payment getway")
            document.getElementById('btnpaygateway').focus();
            return false;
        }
    }

    // for receipt number
    document.getElementById('lblbooking').style.display = "none";
    if (document.getElementById('hiddensavemod').value == "0") {
        var response = QBC.getRec(document.getElementById('txtagency').value);
        var ds = response.value;
        if (ds != null && typeof (ds) == "object" && ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0) {
            var cou1 = ds.Tables[0].Rows[0].recno;
            var zeros = '';
            if (cou1.toString().length == 1) {
                zeros = "000" + cou1.toString();
            }
            else if (cou1.toString().length == 2) {
                zeros = "00" + cou1.toString();
            }
            else if (cou1.toString().length == 3) {
                zeros = "0" + cou1.toString();
            }
            else {
                zeros = cou1.toString();
            }


            var agencyinitial = "";
            if (ds.Tables[0].Rows[0].depocode == null) {
                agencyinitial = document.getElementById('txtagency').value.substr(0, 2);
            }
            else {
                agencyinitial = ds.Tables[0].Rows[0].depocode;
            }
            // 


            if (document.getElementById('configclient').value == "SP") {
                document.getElementById('txtreceipt').value = "";
            }

            else {

                document.getElementById('txtreceipt').value = agencyinitial + "-" + zeros;
            }
            document.getElementById('hiddenreceiptno').value = document.getElementById('txtreceipt').value;
        }
    }
    //
    var prev_cioid = "";
    var prev_receipt = "";
    var prev_ga = 0;
    /*new change ankur 10 feb*/
    var auditstatus = "";

    if (hidcopy == "copy") {
        prev_cioid = document.getElementById('hiddendummycioid').value;
    }

   

    if (document.getElementById('hiddenaudit').value != "") {
        if (document.getElementById('hiddenaudit').value == "n") {
            //if (txtcardamt.Text != txtagreedamt.Text)
            //    auditstatus = "Not Approved";
            //else
            //    auditstatus = "Approved";
            auditstatus = "Approved";
        }
        else {
            auditstatus = "Not Approved";
        }
    }
    else {
        auditstatus = "Approved";
    }
    ////////////////////////////////////////
    /*new change ankur 10 feb*/
    if (document.getElementById('hiddencopy').value == "copy") {
        document.getElementById('hiddensavemod').value = "0";

    }

    var srtcancel = "0";

    ////////////////////modify category
    if (hidcopymodicategory == "copy") {
        prev_cioid = document.getElementById('hiddendummycioid').value;
        srtcancel = "1";
        document.getElementById('hiddensavemod').value = "0";
    }
    if (chkbtnStatus == "modify" && document.getElementById('txtreceipt').value != "") {
        if (document.getElementById('hiddenprevamt').value != "" && document.getElementById('hiddenprevamt').value != null) {
            if (parseFloat(document.getElementById('hiddenprevamt').value) != parseFloat(document.getElementById('txtgrossamt').value)) {

                if (parseFloat(document.getElementById('hiddenprevamt').value) > parseFloat(document.getElementById('txtgrossamt').value)) {
                    doctype = "CA";
                }
                prev_cioid = document.getElementById('txtciobookid').value;
                prev_receipt = document.getElementById('txtreceipt').value;
                prev_receipt = document.getElementById('hiddenreceiptno').value;
                prev_ga = (parseFloat(document.getElementById('txtgrossamt').value) - parseFloat(document.getElementById('hiddenprevamt').value));
                document.getElementById('hiddensavemod').value = "0";
                // autogenerated("0");
                autogeneratedtempid();
                // if(document.getElementById('hiddenprint_rec').value == "Y")
                //                   if (document.getElementById('txtagencypaymode').value == "CA0" || (document.getElementById('txtagencypaymode').value == "CR1" && document.getElementById('creditreceipt_allow').value == "Y")) // for credit 
                //                       autogenerated("3");
                srtcancel = "1";
                modifyMatter = 0;
            }
        }

    }









    // datesave getdatechk = new datesave();
    var branch = document.getElementById('txtbranch').value;
    var booked_by = document.getElementById('txtbookedby').value;
    var prevbook = document.getElementById('txtprevbook').value;
    var date_time = document.getElementById('txtdatetime').value; // = getdatechk.getDate(dateformat, txtdatetime.Text);
    var ciobookid = document.getElementById('txtciobookid').value;
    document.getElementById('hiddencioid').value = ciobookid;
    var receiptno1 = document.getElementById('txtreceipt').value;

    var approvedby = "";
    var audit = "";
    var rono = document.getElementById('txtrono').value;
    var rodate = "";
    if (document.getElementById('txtrodate').value != "") {
        //rodate = txtrodate.Text = getdatechk.getDate(dateformat, txtrodate.Text);
        rodate = document.getElementById('txtrodate').value;
    }
    else {
        rodate = "";
    }
    var rostatus;
    var billstatus = "0";
    if (rodate != "" && rono != "" && document.getElementById('hiddensepcashier').value != "Y")
        var rostatus = "1";
    else
        rostatus = "2";
    if (document.getElementById('drppaymenttype').value == "CR0") {
        rostatus = "2";
    }
    else {
        rostatus = "1";
    }
    if (document.getElementById('txtagency').value == "") {
        document.getElementById('txtagency').value = document.getElementById('hiddenagencynew').value;
    }
    var agencycod = document.getElementById('txtagency').value;
    // char[] splitter = { '(' };
    //        var myarray = agencycod.split('(');
    //        var agencycode = myarray[1];
    //        agencycode = agencycode.replace(")", "");
    //        document.getElementById('hiddenagency').value = agencycode;
    agencycode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.length + document.getElementById('txtagency').value.lastIndexOf('('));
    //alert(agencycode);
    agencycode = agencycode.replace(")", "");
    document.getElementById('hiddenagency').value = agencycode;
    var clientcode = document.getElementById('txtclient').value;
    var client;

    if (clientcode.indexOf("(".toString()) > 0) {
        //  char[] splitterclie = { '(' };
        var myarray1 = clientcode.split('(');

        client = myarray1[1];
        client = client.replace(")", '');

        /////this is to chk whether this code exixts in the database if exists than it is a register client else
        ///it is walkinn client
        ///
        res = null;
        res = QBC.chkwalkinClient(client, document.getElementById('hiddencompcode').value);
        var dcl = res.value;
        if (dcl == null) {
            alert(res.error.description);
            return false;
        }
        if (dcl.Tables[0].Rows.length > 0) {

        }
        else {
            client = clientcode;
        }

    }
    else {

        client = clientcode;
    }
    /////////////////////////////////////////////
    var agencyaddress = document.getElementById('txtagencyaddress').value;
    var clientaddresses = document.getElementById('txtclientadd').value;
    var agency = "0";
    agency = document.getElementById('hiddenagencycodeforsave').value;
    if (agency == "" || agency == null) {
        res = null;
        res = QBC.getAgencyCode(document.getElementById('hiddencompcode').value, agencycode);
        agency = res.value;
    }

    var dockitno = "";
    var execnamecode = "";
    //execnamecode = hiddenzone.Value;

    //char[] splitterex = { '(' };
    var myarrayex = execnamecode.split('(');
    var execname = "";

    var execzone = "";
    execzone = document.getElementById('hiddenzone').value;
    var execnamecode = document.getElementById('hiddenexecname').value;

    var execname = "";
    execname = document.getElementById('hiddenexecname').value;
    if (execnamecode != "" && execnamecode.indexOf("(") >= 0) {
        var myarrayex = execnamecode.split('(');
        execname = myarrayex[1];
        execname = execname.replace(")", "");
    }

    var productcode = "";
    var myarraypr;
    var product;

    product = "";
    productcode = document.getElementById('hiddenproduct').value;
    var myarraypr;
    if (productcode != "") {
        myarraypr = productcode.split('(');
        product = myarraypr[1];
        product = product.replace(")", "");
    }
    else {
        product = "";
    }

    var brand = "0";
    brand = "0";
    var keyno = document.getElementById('txtkeyno').value;
    var billremark = "";
    var printremark = document.getElementById('txtprintremark').value;
    var package; //=drppackage.SelectedValue;
    package = document.getElementById('hiddenpackage').value;
    var insertion = document.getElementById('txtinsertion').value;
    var startdate = document.getElementById('txtdummydate').value; // = getdatechk.getDate(dateformat, txtdummydate.Text);
    var repeatdate = document.getElementById('txtrepeatingdate').value;
    //string adtype=drpbooktype.SelectedValue;
    var adtype = document.getElementById('drpadtype').value;
    var bookingtype = document.getElementById('hiddenbooktype').value;
    var adcategory = document.getElementById('drpadcategory').value;
    /*new change ankur 15 feb*/
    adcategory = document.getElementById('hiddencatcode').value;
    /////////
    var subcategory = document.getElementById('drpadsubcategory').value;
    subcategory = document.getElementById('hiddenad_subcat').value;
    var color = document.getElementById('drpcolor').value;
    var uom = document.getElementById('drpuom').value;
    /*new change ankur 15 feb */
    uom = document.getElementById('hiddenuomcode').value;
    /////////
    var pageposition = document.getElementById('Hiddendrppageposition').value;
    //string pagetype = drppagetype.SelectedValue;
    var pagetype = "";
    //string pageno = txtpageno.Text;
    var pageno = "";
    //string adtype=drpadstype.SelectedValue;
    var adsizheight = document.getElementById('txtadsize1').value; // txtadsizetypeheight.Text;
    var adsizwidth = document.getElementById('txtadsize2').value; // txtadsizetypewidth.Text;
    var ratecode = "";
    ratecode = document.getElementById('drpratecode').value;
    var scheme = document.getElementById('hiddenscheme').value;

    var currency = document.getElementById('hiddencurrency').value;
    var agreedrate = "";
    var agreedamt = document.getElementById('hiddenagreedamt').value;
    var spedisc = document.getElementById('hiddenspedisc').value;
    var spacedisx = "";
    //string adsizetype = drpadstype.SelectedValue;
    var adsizetype = "0";
    var specialcharges = document.getElementById('hiddenspecharges').value;
    /////new
    var agencytype = "";
    var agencystatus = "";
    agencystatus = document.getElementById('hiddenstatus').value;
    var paymode = "0";
    ///add and comment by anuja for payment type////
    //        paymode = document.getElementById('hiddenpay').value;// = "0";
    paymode = document.getElementById('drppaymenttype').value; // = "0";
    ////////////////////end///////////////////
    //        if(paymode =="" || paymode == null)
    //        paymode="CA0";
    var agencredit = "";
    var cardrate = document.getElementById('hiddencardrate').value; // txtcardrate.Text;
    var cardamount = "";
    cardamount = document.getElementById('hiddencardamt').value;
    var discount = "";
    var discountper = "";
    var billaddress = "";
    var totarea = document.getElementById('hiddentotalarea').value; //txttotalarea.Text;
    var billcycle = "0";
    var revenuecenter = "0";
    var billpay = "0";
    ///add and comment by anuja for paymenttype///
    //billpay = document.getElementById('hiddenbillpay').value = "0";
    billpay = document.getElementById('drppaymenttype').value; // = "0";
    ///////////////////////////end////////////
    //        if (billpay == "" || billpay == null)
    //            billpay = "CA0";
    var billheight = "";
    var billwidth = "";
    var billto = document.getElementById('drpbillto_qbc').value;
    billto = document.getElementById('hiddenbillto').value;
    var invoices = "";
    var vts = "";

    var agencyout = "";
    // string boxcode = drpboxcode.SelectedValue;
    var boxcode = document.getElementById('drpboxcodenew').value; //drpboxcode.Value;
    var boxno = document.getElementById('txtboxnonew').value;
    var boxaddress = document.getElementById('txtboxadd').value; //"";
    //        if(document.getElementById('drpboxcodenew').value!="0")
    //            boxaddress = document.getElementById('hiddenboxadd').value;
    var boxagency;
    var boxclient;
    var tfn;
    var coupan = "";

    var bill_amt = "";
    //string pageprem = drppageprem.SelectedValue;
    var pageprem = "0";
    pageprem = document.getElementById('hiddendrppageprem').value;
    var pageamt = document.getElementById('Hiddentxtpageamt').value;
    var premper = document.getElementById('hiddentxtpremper').value;
    var grossamt = document.getElementById('txttotalamt').value; //document.getElementById('hiddengross').value;//document.getElementById('hiddengrossamt').value;// txtgrossamt.Text;
    bill_amt = document.getElementById('hiddengrossamt').value;
    var adsizcolumn = document.getElementById('txtcolum').value;
    var billcolumn = "";
    var billarea;

    billarea = "0";

    var specdiscper = document.getElementById('hiddenspediscper').value;
    var spacediscper = "";
    var paidins = document.getElementById('hiddenpaidins').value; // txtpaid.Text;
    var dealrate = document.getElementById('txtdealrate').value;
    var deviation = document.getElementById('txtdeviation').value;
    var varient = "";

    var contractname = document.getElementById('txtcontractname').value;
    var dealtyp = document.getElementById('txtcontracttype').value;
    var cardname = "";
    var cardtype = "0";
    var cardmonth = "0";
    var cardyear = "0";
    var cardno = "";
    var receiptno = "";
    var caption = "";
    var campaign = "";
    
    var adscat3 = document.getElementById('drpadcat3').value;
    // adscat3 = document.getElementById('hiddenadscat3').value;
    var adscat4 = document.getElementById('drpadcat4').value;
    //adscat4 = document.getElementById('hiddenadscat4').value;
    var adscat5 = document.getElementById('drpadcat5').value;
    //adscat5 = document.getElementById('hiddenadscat5').value;
    var bgcolor = document.getElementById('drpbgcolor').value;
    /*new change ankur 9 feb*/
    //    bgcolor = document.getElementById('hiddenbgcolor').value;
    var coltype = document.getElementById('drpcolortype').value;
    ///////////////////////////////
    var bulletcode = document.getElementById('drpbullet').value;
    /*new change ankur 15 feb*/
    bulletcode = document.getElementById('hiddenbullet').value;
    coltype = document.getElementById('hiddencolortype').value;

    //////////////////////
    var bulletprm = document.getElementById('lbbullprem').value;
    if (document.getElementById('lbbullprem').value == "" || document.getElementById('lbbullprem').value == null) {
        bulletprm = "0";
    }
    bulletprm = document.getElementById('hiddenbullprem').value;
    var material = document.getElementById('drpmatstat').value;
    var receiptdate = document.getElementById('txtreceiptdate').value;
    //receiptdate = getdatechk.getDate(dateformat, txtreceiptdate.Text);
    /*   change  */
    var region = document.getElementById('drpregion').value;
    var variant_name = document.getElementById('drpvarient').value;

    if (document.getElementById('chkage').checked == true) {
        boxagency = "1";
    }
    else {
        boxagency = "0";
    }
    if (document.getElementById('chkclie').checked == true) {
        boxclient = "1";
    }
    else {
        boxclient = "0";
    }
    tfn = "0";
    /*new change ankur 23 feb */
    /////this is the change is done for the logo */
    var logo_hei = document.getElementById('txtlogohei').value;
    var logo_wid = document.getElementById('txtlogowid').value;
    var logo_color = document.getElementById('drplogocolor').value;
    var logo_uom = document.getElementById('txtlogouomcode').value;



    var style = document.getElementById('drpstyle').value;
    ////////////////////////////////
    var retainer = document.getElementById('hiddenretainer').value;
    var retainercomm = document.getElementById('hiddenretainercomm').value;

    document.getElementById('hiddencioid').value = document.getElementById('txtciobookid').value;
    var nchkno = document.getElementById('hiddenchequeno').value;
    var nchkdate = document.getElementById('hiddenchequedate').value;
    var nchkamt = "";
    var nchkbankname = document.getElementById('hiddenbankname').value;
    var nourbank = "";
    ////        nchkno=document.getElementById('ttextchqno').value;
    ////        nchkdate=document.getElementById('ttextchqdate').value;
    ////        nchkamt=document.getElementById('ttextchqamt').value;
    ////        nchkbankname=document.getElementById('ttextbankname').value;
    ////        nourbank=document.getElementById('drpourbank').value;

    if (document.getElementById('hiddensavemod').value == "0") {
        ///////if 0 than autogenerate the cio booking id and if 1 than autogenerate dockit no.
        //autogenerated("0");
        ciobookid = document.getElementById('txtciobookid').value;
        res = null;
        res = QBC.bookidchk(document.getElementById('hiddencompcode').value, document.getElementById('txtciobookid').value, agency, agencycode, rono, "0");
        var dck = res.value;
        if (dck == null) {
            alert(res.error.description);
            return false;
        }

        if (dck.Tables[0].Rows.length >= 1) {
            message = "This Booking Id Has Been Assigned";
            alert(message);
            clearClick();
            return false;

        }
        document.getElementById('oldboxno').value = boxno;
        if (boxno != null && boxno != "") {

            var branchname1 = document.getElementById('hiddenbranch').value;
            branchname1 = branchname1.substring(0, 2)
            var branch1 = document.getElementById('drpboxcode').value;
            if (branch1 != "0") {
                var resb = QBC.getboxnovalue(document.getElementById('hiddencompcode').value, branchname1, branch1, "S");
            }
            var dsb = resb.value;
            if (dsb == null) {
                alert(resb.error.description)
                return false;
            }
            var count1 = "0";
            var branchname12 = document.getElementById('hiddenbranch').value;
            branchname12 = branchname12.substring(0, 2)
            if (dsb.Tables[0].Rows.length > 0 && dsb.Tables[0].Rows[0].boxno != null && dsb.Tables[0].Rows[0].boxno != "") {
                var boxval1 = dsb.Tables[0].Rows[0].boxno;
                var cou = boxval1;
                document.getElementById('txtboxno').value = cou;

            }
            else {
                document.getElementById('txtboxno').value = branchname12 + count1;

            }
            if (boxno != document.getElementById('txtboxno').value) {
                boxno = document.getElementById('txtboxno').value;
            }

        }
        res = null;
        ///////////////modify category
        if (hidcopymodicategory == "copy") {
            if (document.getElementById('configclient').value == "LOKMAT") {
                receiptno = document.getElementById('hdnrecnomod').value;
                rono = document.getElementById('hdnronomodify').value;
            }
            else {
                receiptno = document.getElementById('hiddenreceiptno').value;
                rono = document.getElementById('txtrono').value;
            }
        }
        else {
            receiptno = document.getElementById('hiddenreceiptno').value;
            rono = document.getElementById('txtrono').value;
        }
        var chktradeval = "1";
        if (document.getElementById('chktrade').checked == true)
            chktradeval = "1";
        else
            chktradeval = "0";
        //alert(adsizetype + '&&' + branch +'&&'+  booked_by+ '&&' + prevbook+ '&&' + date_time+ '&&' + ciobookid+ '&&' + approvedby+ '&&' + audit+ '&&' + rono+ '&&' + rodate+ '&&' + caption+ '&&' + billstatus+ '&&' + rostatus+ '&&' + agency+ '&&' + client+ '&&' + agencyaddress+ '&&' + clientaddresses+ '&&' + agencycode+ '&&' + dockitno+ '&&' + execname+ '&&' + execzone+ '&&' + product+ '&&' + brand+ '&&' + keyno+ '&&' + billremark+ '&&' + printremark+ '&&' + package+ '&&' + insertion+ '&&' + startdate+ '&&' + repeatdate+ '&&' + adtype+ '&&' + adcategory+ '&&' + subcategory+ '&&' + color+ '&&' + uom+ '&&' + pageposition+ '&&' + pagetype+ '&&' + pageno+ '&&' + adsizheight+ '&&' + adsizwidth+ '&&' + ratecode+ '&&' + scheme, currency+ '&&' + agreedrate+ '&&' + agreedamt+ '&&' + spedisc+ '&&' + spacedisx+ '&&' + document.getElementById('hiddencompcode').value+ '&&' + document.getElementById('hiddenuserid').value+ '&&' + specialcharges+ '&&' + agencytype+ '&&' + agencystatus+ '&&' + paymode+ '&&' + agencredit+ '&&' + cardrate+ '&&' + cardamount+ '&&' + discount+ '&&' + discountper+ '&&' + billaddress+ '&&' + totarea, billcycle+ '&&' + revenuecenter + '&&' + billpay+ '&&' + billheight+ '&&' + billwidth+ '&&' + billto+ '&&' + invoices+ '&&' + vts+ '&&' + tradedisc+ '&&' + agencyout+ '&&' + boxcode+ '&&' + boxno+ '&&' + boxaddress+ '&&' + boxagency+ '&&' + boxclient+ '&&' + bookingtype+ '&&' + tfn+ '&&' + coupan+ '&&' + campaign+ '&&' + bill_amt+ '&&' + pageprem+ '&&' + pageamt+ '&&' + premper+ '&&' + grossamt+ '&&' + adsizcolumn+ '&&' + billcolumn+ '&&' + billarea+ '&&' + specdiscper+ '&&' + spacediscper+ '&&' + paidins+ '&&' + dealrate+ '&&' + deviation+ '&&' + varient+ '&&' + contractname+ '&&' + dealtyp+ '&&' + cardname+ '&&' + cardtype+ '&&' + cardmonth+ '&&' + cardyear+ '&&' + cardno+ '&&' + receiptno+ '&&' + adscat3+ '&&' + adscat4+ '&&' + adscat5+ '&&' + bgcolor+ '&&' + bulletcode+ '&&' + bulletprm+ '&&' + material+ '&&' + receiptdate+ '&&' + prev_cioid+ '&&' + prev_receipt+ '&&' + prev_ga+ '&&' + region+ '&&' + variant_name+ '&&' + coltype+ '&&' + logo_hei+ '&&' + logo_wid+ '&&' + logo_color+ '&&' + logo_uom+ '&&' + document.getElementById('hiddendateformat').value+ '&&' +""+ '&&' +"")
        if (ciobookid == "") {
            alert("Booking Id can't be blank");
            return false;
        }
        var fmgreasons = "";
        var clientcatdisc = document.getElementById('txtclientcatdisc').value;
        var clientcatamt = document.getElementById('txtclientcatam').value;
        var clientcatdistype = document.getElementById('hdnclientcatdistype').value;
        res = QBC.insertBookingQBC(adsizetype, branch, booked_by, prevbook, date_time, ciobookid, approvedby, audit, rono, rodate, caption, billstatus, rostatus, agency, client, agencyaddress, clientaddresses, agencycode, dockitno, execname, execzone, product, brand, keyno, billremark, printremark, package, insertion, startdate, repeatdate, adtype, adcategory, subcategory, color, uom, pageposition, pagetype, pageno, adsizheight, adsizwidth, ratecode, scheme, currency, agreedrate, agreedamt, spedisc, spacedisx, document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value, specialcharges, agencytype, agencystatus, paymode, agencredit, cardrate, cardamount, discount, discountper, billaddress, totarea, billcycle, revenuecenter, billpay, billheight, billwidth, billto, invoices, vts, tradedisc, agencyout, boxcode, boxno, boxaddress, boxagency, boxclient, bookingtype, tfn, coupan, campaign, bill_amt, pageprem, pageamt, premper, grossamt, adsizcolumn, billcolumn, billarea, specdiscper, spacediscper, paidins, dealrate, deviation, varient, contractname, dealtyp, cardname, cardtype, cardmonth, cardyear, cardno, receiptno, adscat3, adscat4, adscat5, bgcolor, bulletcode, bulletprm, material, receiptdate, prev_cioid, prev_receipt, prev_ga, region, variant_name, coltype, logo_hei, logo_wid, logo_color, logo_uom, document.getElementById('hiddendateformat').value, retainer, retainercomm, document.getElementById('txtMobile').value, chktradeval, sharepub, fmgInsert, nchkno, nchkdate, nchkamt, nchkbankname, nourbank, document.getElementById('hidattach1').value, fmgreasons, document.getElementById('drplogoprem').value, document.getElementById('drpdesign').value, style, srtcancel, document.getElementById('drpcoutype').value, document.getElementById('txtcouno').value, document.getElementById('drpstate').value, clientcatdisc, clientcatamt, clientcatdistype, "", "", "", "", "", "", "", "");
        ///  var dins;
        //  dins=res.value;
        // if(dins==null)
        // {
        //    alert(res.error.description);
        //    return false;
        // }
        if (res.value != "") {
            alert(res.value.toString());
            return false;
        }
        var resR = saveinsertion();
        if (resR == false) {
            return false;
        }
        if (document.activeElement.id == "btnSaveConfirm")
            adsaveconfirm();
        /*this is to save the image in the case of CD*/
        var savename = "";
        //////////////////////add by anuja
        var agval = document.getElementById('txtagency').value;
        var paymodeN = document.getElementById('drppaymenttype').value;
        ////////////////////////////////////////end
        //message = objDataSetxml1.Tables[0].Rows[0].ItemArray[0].ToString();
        clearClick();
        //////////////////////add by anuja
        if (document.getElementById('hdndepo').value == "depo") {


        }

        else {
            if (confirm("Do You Want To Continue with Existing Agency")) {
                document.getElementById('txtagency').value = agval;
                //var codesubcode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.indexOf('(') + 1, document.getElementById('txtagency').value.length - 1);
                var codesubcode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.lastIndexOf(')'));
                var respaymode = QBC.bindPaymentMode(codesubcode, document.getElementById('hiddencompcode').value);
                if (respaymode.value != null && respaymode.value.Tables[0].Rows.length > 0)
                    bindpayM(respaymode.value)
            }
            else {
                document.getElementById('txtagency').value = "";
                document.getElementById('hidagencyname').value = "";
            }
        }
        ////////////////////////////////////////end

        getbuttoncheck(document.getElementById('hiddenbuttonidcheck').value);
        document.getElementById('tblinsert').innerHTML = '';
        disabledlogoinfo();

        //  if (document.activeElement.id == "btnSave")
        // {
        if (document.getElementById('hiddenprint_rec').value == "Y" && document.getElementById('agnlogin').value == "N") {

            if (document.getElementById("hdnbutton").value == "btnsavepay") {
            }

            else {
                if (paymodeN != "CA0" && paymodeN != "CR1")
                    printreceipt(paymodeN);

            }


        }
        //  }
        clearClick();
    }
    else {
        if (parseInt(document.getElementById('hiddenmodifyinsert').value) > parseInt(document.getElementById('txtinsertion').value)) {
            alert('You Cannot Decrease insertions(Please Cancel Booking..)!');
            document.getElementById('txtinsertion').focus();
            return false;
        }

        var chktradeval = "1";
        if (document.getElementById('chktrade').checked == true)
            chktradeval = "1";
        else
            chktradeval = "0";

        var fmgreasons = "";
        var clientcatdisc = document.getElementById('txtclientcatdisc').value;
        var clientcatamt = document.getElementById('txtclientcatam').value;
        var clientcatdistype = document.getElementById('hdnclientcatdistype').value;
        res = QBC.updatebooking(adsizetype, branch, booked_by, prevbook, date_time, ciobookid, approvedby, audit, rono, rodate, caption, billstatus, rostatus, agency, client, agencyaddress, clientaddresses, agencycode, dockitno, execname, execzone, product, brand, keyno, billremark, printremark, package, insertion, startdate, repeatdate, adtype, adcategory, subcategory, color, uom, pageposition, pagetype, pageno, adsizheight, adsizwidth, ratecode, scheme, currency, agreedrate, agreedamt, spedisc, spacedisx, document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value, specialcharges, agencytype, agencystatus, paymode, agencredit, cardrate, cardamount, discount, discountper, billaddress, totarea, billcycle, revenuecenter, billpay, billheight, billwidth, billto, invoices, vts, tradedisc, agencyout, boxcode, boxno, boxaddress, boxagency, boxclient, bookingtype, tfn, coupan, campaign, bill_amt, pageprem, pageamt, premper, grossamt, adsizcolumn, billcolumn, billarea, specdiscper, spacediscper, paidins, dealrate, deviation, varient, contractname, dealtyp, cardname, cardtype, cardmonth, cardyear, cardno, receiptno, adscat3, adscat4, adscat5, bgcolor, bulletcode, bulletprm, material, region, variant_name, coltype, logo_hei, logo_wid, logo_color, logo_uom, auditstatus, document.getElementById('hiddendateformat').value, retainer, retainercomm, document.getElementById('txtMobile').value, chktradeval, sharepub, fmgInsert, nchkno, nchkdate, nchkamt, nchkbankname, nourbank, document.getElementById('hidattach1').value, fmgreasons, document.getElementById('drplogoprem').value, document.getElementById('drpdesign').value, document.getElementById('drpstyle').value, document.getElementById('drpcoutype').value, document.getElementById('txtcouno').value, document.getElementById('drpstate').value, clientcatdisc, clientcatamt, clientcatdistype, "", "", "", "", "", "", "", "");

        var dup = res.value;
        if (dup == null) {
            alert(res.error.description);
            return false;
        }
        //   QBC.deletefromtemp(document.getElementById('txtciobookid').value,document.getElementById('hiddencompcode').value);          

        document.getElementById('hiddencioid').value = ciobookid;
        getmodifygrid();
        if (document.activeElement.id == "btnSaveConfirm")
            adsaveconfirm();
        var savename = "";


        document.getElementById('hiddencalendar').value = "0";

        if (document.getElementById('hiddenaudit').value != "") {
            document.getElementById('hiddenaudit').value = "";
            window.close();
            return;
        }

        //////////////////////comment//////////////////
        //            if (document.getElementById('hiddenprint_rec').value == "Y")
        //                {
        //                    printreceipt();

        //                }
        //////////////////////////////////
        //////////////add by anuja
        if (document.getElementById('hiddenprint_rec').value == "Y" && document.getElementById('agnlogin').value == "N") {
            if (document.getElementById("hdnbutton").value == "btnsavepay") {
            }

            else {
                if (document.getElementById('drppaymenttype').value != "CA0" && document.getElementById('drppaymenttype').value != "CR1" && chkbtnStatus == "new")
                    printreceipt(document.getElementById('drppaymenttype').value);

            }

        }
        ////////////////////end
        document.getElementById('txtciobookid').disabled = true;
        // txtappby.Enabled = true;
        //txtaudit.Enabled = true;
        document.getElementById('txtrono').disabled = true;
        document.getElementById('txtrodate').disabled = true;


        document.getElementById('drprostatus').disabled = true;
        document.getElementById('txtagency').readOnly = true;
        document.getElementById('txtbranch').disabled = true;
        document.getElementById('txtclient').disabled = true;
        document.getElementById('drpboxcodenew').disabled = true;
        //txtboxadd.Enabled = false;
        // txtagencyaddress.Enabled = true;
        document.getElementById('txtclientadd').disabled = true;

        document.getElementById('txtprintremark').disabled = true;
        document.getElementById('drppackage').disabled = true;
        document.getElementById('txtinsertion').disabled = true;
        document.getElementById('txtdummydate').disabled = true;
        document.getElementById('txtrepeatingdate').disabled = true;

        document.getElementById('drpadcategory').disabled = true;
        document.getElementById('chkall').disabled = true;
        document.getElementById('drpadsubcategory').disabled = true;
        document.getElementById('drpcolor').disabled = true;
        document.getElementById('drpuom').disabled = true;
        //document.getElementById('Hiddendrppageposition').disabled = true;


        document.getElementById('txtdatetime').readOnly = true;
        document.getElementById('txtrepeatingdate').disabled = true;


        //txtcardrate.Enabled = false;
        document.getElementById('txtcardrate').readOnly = true;

        document.getElementById('txtadsize2').disabled = true;
        document.getElementById('txtadsize1').disabled = true;
        //txttotalarea.Enabled = false;
        document.getElementById('txttotalarea').readOnly = true;


        document.getElementById('drpregion').disabled = true;


        //txtgrossamt.Enabled = false;
        document.getElementById('txtgrossamt').readOnly = true;
        document.getElementById('txttotalamt').readOnly = true;
        document.getElementById('drpregion').disabled = true;

        document.getElementById('txtinsertion').disabled = true;

        document.getElementById('txtcolum').disabled = true;
        document.getElementById('txtMobile').disabled = true;

        //new change 14 feb
        //drpadtype.SelectedValue = "0";
        document.getElementById('drpadtype').disabled = true;
        /////////////////////

        //  txtboxno.Enabled = false;

        //new change ankur 24 feb
        document.getElementById('txtlogohei').disabled = false;
        // txtlogohei.Text = "";
        document.getElementById('txtlogoname').value = "";
        document.getElementById('drplogocolor').disabled = false;
        document.getElementById('drplogocolor').value = "0";

        /////////////////////////////////

        ///////////////////////////////////////////////////////////////////////////

        document.getElementById('txtciobookid').readOnly = true;
        document.getElementById('drpmatstat').disabled = true;

        saveormodify = "0";

        //            DataSet objDataSetxml = new DataSet();
        //            // Read in the XML file
        //            objDataSetxml.ReadXml(Server.MapPath("XML/errorMessage.xml"));
        message = "Data Updated Successfully";




        updateStatus();
        // message = "Value saved";
        alert(message);

        document.getElementById('hiddensavemod').value = "1";
        clearClick();
        //ScriptManager.RegisterClientScriptBlock(this, typeof(QBC), "ca", "showcardinfo('" + executequery.Tables[0].Rows[0].ItemArray[61].ToString() + "')", true);
        //  ScriptManager.RegisterClientScriptBlock(this, typeof(QBC), "cc", "showgridexecute()", true);


        if (rownumEx == 0) {
            document.getElementById('btnfirst').disabled = true;
            document.getElementById('btnprevious').disabled = true;

        }

        if (rownumEx == executequery.Tables[0].Rows.length - 1) {
            document.getElementById('btnlast').disabled = true;
            document.getElementById('btnnext').disabled = true;

        }
        if (executequery.Tables[0].Rows.length == 0) {
            document.getElementById('btnfirst').disabled = true;
            document.getElementById('btnnext').disabled = true;
            document.getElementById('btnprevious').disabled = true;
            document.getElementById('btnlast').disabled = true;
        }
        //getbuttoncheck(formname);
        //return;
        document.getElementById('drpadcat3').disabled = true;
        document.getElementById('drpvarient').disabled = true;
        document.getElementById('drplogocolor').disabled = true;
        document.getElementById('btnshgrid').disabled = true;
        document.getElementById('btnconfirm').disabled = true;
        document.getElementById('drpbillto_qbc').disabled = true;
        document.getElementById('txtlogohei').disabled = true;
        document.getElementById('btncopy').disabled = true;
        document.getElementById('btndel').disabled = true;
        document.getElementById('drppackagecopy').disabled = true;
        document.getElementById('drpbullet').disabled = true;
        document.getElementById('drplogoprem').disabled = true;
        document.getElementById('drpdesign').disabled = true;
        document.getElementById('btnlogoupload').disabled = true;
        clearClick();
    }
    if (document.getElementById('hiddenuomdesc').value == "CD") {
        if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtcolum').value != "") {
            document.getElementById('txtadsize2').disabled = true;
            document.getElementById('txtadsize1').style.backgroundColor = "#FFFFFF";
            document.getElementById('txtadsize2').style.backgroundColor = "#FFFFFF";
            document.getElementById('txtcolum').style.backgroundColor = "#FFFFFF";

        }
        else if (document.getElementById('txtadsize1').value != "" && document.getElementById('txtadsize2').value != "") {
            document.getElementById('txtcolum').disabled = true;
            document.getElementById('txtadsize1').style.backgroundColor = "#FFFFFF";
            document.getElementById('txtadsize2').style.backgroundColor = "#FFFFFF";
            document.getElementById('txtcolum').style.backgroundColor = "#FFFFFF";

        }


    }
    else if (document.getElementById('hiddenuomdesc').value != "CD") {
        document.getElementById('txtadsize1').disabled = false;
        document.getElementById('txtadsize2').disabled = false;
        if (document.getElementById('hiddenuomdesc').value == "ROL" || document.getElementById('hiddenuomdesc').value == "ROD") {
            document.getElementById('Label1').innerHTML = "No. Of Lines";
            document.getElementById('txtadsize1').style.backgroundColor = "Gray";
            document.getElementById('txtadsize2').style.backgroundColor = "Gray";
            document.getElementById('txtcolum').style.backgroundColor = "Gray";
            document.getElementById('txtcolum').disabled = true;


        }
        else if (document.getElementById('hiddenuomdesc').value == "ROW") {
            document.getElementById('Label1').innerHTML = "No. Of Words";
            document.getElementById('txtadsize1').style.backgroundColor = "Gray";
            document.getElementById('txtadsize2').style.backgroundColor = "Gray";
            document.getElementById('txtcolum').style.backgroundColor = "Gray";
            document.getElementById('txtcolum').disabled = true;
        }
        else if (document.getElementById('hiddenuomdesc').value == "ROC") {
            document.getElementById('Label1').innerHTML = "No. Of Words";
            document.getElementById('txtadsize1').style.backgroundColor = "Gray";
            document.getElementById('txtadsize2').style.backgroundColor = "Gray";
            document.getElementById('txtcolum').style.backgroundColor = "Gray";
            document.getElementById('txtcolum').disabled = true;
        }

    }
    setButtonImages();
    return false;
}
function bindbillto() {
    var arragency = document.getElementById('txtagency').value.split('(');
    var agencycode = arragency[1].replace(")", "");
    var agencyname = arragency[0];

    document.getElementById('drpbillto_qbc').options.length = 0;
    document.getElementById('drpbillto_qbc').options[0] = new Option(agencyname, agencycode);
    document.getElementById('drpbillto_qbc').options.length;
    document.getElementById('drpbillto_qbc').options[1] = new Option(document.getElementById('txtclient').value, document.getElementById('txtclient').value);
    document.getElementById('drpbillto_qbc').options.length


}
function deleteCheck() {
    if (document.getElementById('txtciobookid').value == "") {
        alert("Please Enter Booking Id");
        return false;
    }
    if (confirm("Do You Want To Cancel the Booking")) {
        QBC.deleteBooking(document.getElementById('txtciobookid').value);
        alert("Booking Cancelled Successfully");
        clearClick();
        return false;
    }
    else {
        return false;
    }
}

function enableGridItems() {

    var count1 = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
    var insvar = 0;
    for (var i = 0; i < count1; i++) {
        var noofcol = "nocol" + i;
        var height = "hei" + i;
        var width = "wid" + i;
        var late = "lat" + i;
        var repeat = "rep" + i;
        var paid = "pai" + i;
        var page = "pgpre" + i;
        var pagstr = "sec";
        var adcat = "adcat" + i;
        var adsubcat = "ads" + i;
        var matsta = "mat" + i;
        var insertsta = "inssta" + i;
        var colid = "col" + i;
        adscat3id = "adscat3" + i;
        adscat4id = "adscat4" + i;
        adscat5id = "adscat4" + i;
        var textid = "Text" + i;
        var upl = "upload" + i;
        var splt = "splt" + i;
        var subedi = "subedi" + i;
        remark_inserts = "rem" + i;
        if (insertstatus == "0") {
            document.getElementById('uploadA').style.color = "red";
            document.getElementById('uploadA').style.cursor = "pointer";
            document.getElementById('uploadA').disabled = false;

        }
        if (insvar != document.getElementById('ins' + i).innerHTML && document.getElementById('inssta' + i).value == 'booked' || document.getElementById('inssta' + i).value == 'hold') {
            document.getElementById('ins' + i).title = "Edit Insert";
            insvar = document.getElementById('ins' + i).innerHTML;
        }
        if (document.getElementById('inssta' + i).value == 'booked' || document.getElementById('inssta' + i).value == 'hold') {
            if (document.getElementById(textid) != null)
                document.getElementById(textid).disabled = false;
            if (document.getElementById(subedi) != null)
                document.getElementById(subedi).disabled = false;
            if (document.getElementById(remark_inserts) != null)
                document.getElementById(remark_inserts).disabled = false;
            document.getElementById(upl).disabled = false;
            if (document.getElementById(splt) != null)
                document.getElementById(splt).disabled = false;
            // document.getElementById(colid).disabled=false;
            if (document.getElementById(adcat) != null)
                document.getElementById(adcat).disabled = false;
            document.getElementById(adsubcat).disabled = false;
            if (document.getElementById(adscat3id) != null)
                document.getElementById(adscat3id).disabled = false;
            if (document.getElementById(adscat4id) != null)
                document.getElementById(adscat4id).disabled = false;
            if (document.getElementById(adscat5id) != null)
                document.getElementById(adscat5id).disabled = false;
            if (document.getElementById(matsta) != null)
                document.getElementById(matsta).disabled = false;
            document.getElementById(insertsta).disabled = false;

            document.getElementById(paid).disabled = false;
            if (document.getElementById('drpuom').value != "0" && document.getElementById('hiddenuomdesc').value != "CD") {
                document.getElementById(height).disabled = true;
                document.getElementById(width).disabled = true;
                document.getElementById(noofcol).disabled = true;

            }
            else {
                if (document.getElementById('txtcolum').disabled == true) {
                    document.getElementById(height).disabled = false;
                    document.getElementById(width).disabled = false;
                    document.getElementById(noofcol).disabled = true;
                }
                else {
                    document.getElementById(height).disabled = false;
                    document.getElementById(width).disabled = false;
                    document.getElementById(noofcol).disabled = false;
                }
            }
        }
    }

}
function confirmClick1() {
    if (document.getElementById('txtagency').value == "") {
        document.getElementById('txtagency').value = document.getElementById('hiddenagency').value;
    }
    document.getElementById('drprostatus').value = "1";
    QBC.confirmClick(document.getElementById('txtciobookid').value, document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value);
    document.getElementById('btnconfirm').disabled = true;
    alert("Ad Confirmed Successfully");
    clearClick();
    return false;
}
function chkDateforGrid(txtid) {
    document.getElementById('txtgrossamt').value = "";

    if ((txtid.id.indexOf("Text") == 0 && txtid.id != "") || (document.activeElement.id.indexOf("Text") == 0 && document.activeElement.id.value != "")) {
        var validformat = '';
        var dateformat = document.getElementById('hiddendateformat').value;
        if (dateformat == "mm/dd/yyyy") {
            validformat = /^\d{2}\/\d{2}\/\d{4}$/ //Basic check for format validity
        }
        if (dateformat == "yyyy/mm/dd") {
            validformat = /^\d{4}\/\d{2}\/\d{2}$/ //Basic check for format validity
        }
        if (dateformat == "dd/mm/yyyy") {
            validformat = /^\d{2}\/\d{2}\/\d{4}$/ //Basic check for format validity
        }

        var activeID = document.activeElement.id;

        if (activeID == "")
            activeID = txtid.id;

        //==================To enter Date Without "/" ============================//
        var dateInitial = "20";
        var dateenter = document.getElementById(activeID).value;
        // if(dateenter!=""){
        if (dateenter.indexOf('/') < 0) {
            var date12 = "";
            if (dateformat == "mm/dd/yyyy") {
                if (dateenter.length >= "8")
                    date12 = dateenter.substring(0, 2) + "/" + dateenter.substring(2, 4) + "/" + dateenter.substring(4, 8);
                else if (dateenter.length >= "6")
                    date12 = dateenter.substring(0, 2) + "/" + dateenter.substring(2, 4) + "/" + dateInitial + dateenter.substring(4, 6);
                else
                    date12 = dateenter;
            }
            if (dateformat == "yyyy/mm/dd") {
                if (dateenter.length >= "8")
                    date12 = dateenter.substring(0, 4) + "/" + dateenter.substring(4, 6) + "/" + dateenter.substring(6, 8);
                else if (dateenter.length >= "6")
                    date12 = dateInitial + dateenter.substring(0, 2) + "/" + dateenter.substring(2, 4) + "/" + dateenter.substring(4, 6);
                else
                    date12 = dateenter;
            }
            if (dateformat == "dd/mm/yyyy") {
                if (dateenter.length >= "8")
                    date12 = dateenter.substring(0, 2) + "/" + dateenter.substring(2, 4) + "/" + dateenter.substring(4, 8);
                else if (dateenter.length >= "6")
                    date12 = dateenter.substring(0, 2) + "/" + dateenter.substring(2, 4) + "/" + dateInitial + dateenter.substring(4, 6);
                else
                    date12 = dateenter;
            }
            document.getElementById(activeID).value = date12;
        }
        //==============================================================================//
        var currdate = document.getElementById(activeID).value;
        var fromdate = document.getElementById('txtdatetime').value;
        var todate = currdate;
        if (!validformat.test(currdate)) {
            alert(" Please Fill The Date In " + dateformat + " Format");
            document.getElementById(activeID).value = "";
            // document.getElementById(activeID).focus();
            return false;
        }
        else {
            if (dateformat == "yyyy/mm/dd") {
                var yearfield = currdate.split("/")[0]
                var monthfield = currdate.split("/")[1]
                var dayfield = currdate.split("/")[2]

                var dayobj = new Date(yearfield, monthfield - 1, dayfield)
            }
            if (dateformat == "mm/dd/yyyy") {
                var yearfield = currdate.split("/")[2]
                var monthfield = currdate.split("/")[0]
                var dayfield = currdate.split("/")[1]
                //var dayobj = new Date(monthfield-1, dayfield, yearfield)
                var dayobj = new Date(yearfield, monthfield - 1, dayfield)

            }
            if (dateformat == "dd/mm/yyyy") {
                var yearfield = currdate.split("/")[2]
                var monthfield = currdate.split("/")[1]
                var dayfield = currdate.split("/")[0]
                //var dayobj = new Date(dayfield, monthfield-1, yearfield)
                var dayobj = new Date(yearfield, monthfield - 1, dayfield)
            }
            var abcd = dayobj.getMonth() + 1;

            var date1 = dayobj.getDate();
            var year1 = dayobj.getFullYear();
            if ((abcd != monthfield) || (date1 != dayfield) || (year1 != yearfield)) {
                alert(" Please Fill The Date In " + dateformat + " Format");
                document.getElementById(activeID).value = "";
                // document.getElementById(activeID).focus();
                return false;
            }
        }
        //

        //For From Date Converssion 
        if (dateformat == "dd/mm/yyyy") {
            if (fromdate != "") {
                var txt = fromdate;
                var txt1;
                if (txt.indexOf("-") >= 0) {
                    txt1 = txt.split("-");
                }
                else {
                    txt1 = txt.split("/");
                }

                var dd = txt1[0];
                var mm1 = txt1[1];
                var mm;
                if (txt.indexOf("-") >= 0) {
                    mm = getMonthNo(mm1);
                }
                else {
                    mm = mm1;
                }
                var yy = txt1[2];
                fromdate = mm + '/' + dd + '/' + yy;
            }
            else {
                fromdate = fromdate;
            }

        }

        if (dateformat == "yyyy/mm/dd") {
            if (fromdate != "") {
                var txt = fromdate;
                var txt1 = txt.split("/");
                var yy = txt1[0];
                var mm = txt1[1];
                var dd = txt1[2];
                fromdate = mm + '/' + dd + '/' + yy;
            }
            else {
                fromdate = fromdate;
            }
        }

        if (dateformat == "mm/dd/yyyy") {
            fromdate = fromdate;
        }

        //For From Date Converssion /************************************************************/
        if (dateformat == "dd/mm/yyyy") {
            if (todate != "") {
                var txt = todate;
                var txt1 = txt.split("/");
                var dd = txt1[0];
                var mm = txt1[1];
                var yy = txt1[2];
                todate = mm + '/' + dd + '/' + yy;
            }
            else {
                todate = todate;
            }

        }

        if (dateformat == "yyyy/mm/dd") {
            if (todate != "") {
                var txt = todate;
                var txt1 = txt.split("/");
                var yy = txt1[0];
                var mm = txt1[1];
                var dd = txt1[2];
                todate = mm + '/' + dd + '/' + yy;
            }
            else {
                todate = todate;
            }
        }

        if (dateformat == "mm/dd/yyyy") {
            todate = todate;
        }
        //



        var fdate = new Date(fromdate);
        var tdate = new Date(todate);
        if (tdate < fdate && (document.getElementById('hiddenbackdatebook').value == "0" || document.getElementById('hiddenbackdatebook').value == "N")) {
            document.getElementById(activeID).value = "";
            alert("Published Date can't Be Less than Current Date");
            dummydate = tempdate;
            document.getElementById(activeID).focus();
            return false;
        }
        var idno = document.activeElement.id.replace("Text", "");
        var len = 'bookdiv';
        //		if(document.getElementById("pai"+idno)!=null)
        //		{
        //		    if(document.getElementById("pai"+idno).value=="N")
        //		    {
        //		        for(var start=0;start<parseInt(document.getElementById(len).getElementsByTagName('table')[0].rows.length)-1;start++)
        //		        {
        //		             if(document.getElementById("pai"+start).value!="N")
        //		             {
        //		                if(document.getElementById("Text"+start).value!="")
        //		                {
        //		                    	var currdate=document.getElementById(document.activeElement.id).value;
        //		                    var fromdate=document.getElementById("Text"+start).value;
        //		                    var todate=currdate;
        //		                    //For From Date Converssion 
        //                            if(dateformat=="dd/mm/yyyy")
        //                            {
        //                                if(fromdate != "")
        //                                {
        //                                    var txt=fromdate;
        //                                     var txt1;
        //                                    if(txt.indexOf("-")>=0)
        //                                    {
        //                                         txt1=txt.split("-");
        //                                    }
        //                                    else{
        //                                        txt1=txt.split("/");
        //                                    }
        //                                   
        //                                    var dd=txt1[0];
        //                                    var mm1=txt1[1];
        //                                    var mm;
        //                                     if(txt.indexOf("-")>=0)
        //                                     {
        //                                         mm = getMonthNo(mm1);
        //                                    }
        //                                    else
        //                                    {
        //                                        mm=mm1;
        //                                    }
        //                                    var yy=txt1[2];
        //                                    fromdate=mm+'/'+dd+'/'+yy;
        //                                }
        //                                else
        //                                {
        //                                    fromdate=fromdate;
        //                                }

        //                            }
        //                            
        //                            if(dateformat=="yyyy/mm/dd")
        //                            {
        //                                if(fromdate!="")
        //                                {
        //                                    var txt=fromdate;
        //                                    var txt1=txt.split("/");
        //                                    var yy=txt1[0];
        //                                    var mm=txt1[1];
        //                                    var dd=txt1[2];
        //                                    fromdate=mm+'/'+dd+'/'+yy;
        //                                }
        //                                else
        //                                {
        //                                    fromdate=fromdate;
        //                                }
        //                            }
        //                            
        //                            if(dateformat=="mm/dd/yyyy")
        //                            {
        //                                fromdate=fromdate;
        //                            }
        //                            
        //                            //For From Date Converssion /************************************************************/
        //                            if(dateformat=="dd/mm/yyyy")
        //                            {
        //                                if(todate != "")
        //                                {
        //                                    var txt=todate;
        //                                    var txt1=txt.split("/");
        //                                    var dd=txt1[0];
        //                                    var mm=txt1[1];
        //                                    var yy=txt1[2];
        //                                    todate=mm+'/'+dd+'/'+yy;
        //                                }
        //                                else
        //                                {
        //                                    todate=todate;
        //                                }

        //                            }
        //                            
        //                            if(dateformat=="yyyy/mm/dd")
        //                            {
        //                                if(todate!="")
        //                                {
        //                                    var txt=todate;
        //                                    var txt1=txt.split("/");
        //                                    var yy=txt1[0];
        //                                    var mm=txt1[1];
        //                                    var dd=txt1[2];
        //                                    todate=mm+'/'+dd+'/'+yy;
        //                                }
        //                                else
        //                                {
        //                                    todate=todate;
        //                                }
        //                            }
        //                            
        //                            if(dateformat=="mm/dd/yyyy")
        //                            {
        //                                todate=todate;
        //                            }
        //		                    //
        //                    		
        //                    		
        //                    		
        //		                    var fdate=new Date(fromdate);
        //		                    var tdate=new Date(todate);
        //		                    if(tdate<fdate)
        //		                    {
        //		                         alert("Free Schemes Date can't be greater than Paid Schemes Date");
        //		                        document.getElementById(document.activeElement.id).value="";
        //		                        return false;
        //		                    }
        //		                }
        //		             }    
        //		        }
        //		    }
        //		    else
        //		    {
        //		        for(var start=0;start<parseInt(document.getElementById(len).getElementsByTagName('table')[0].rows.length)-1;start++)
        //		        {
        //		             if(document.getElementById("pai"+start).value=="N")
        //		             {
        //		                if(document.getElementById("Text"+start).value!="")
        //		                {
        //		                    var currdate=document.getElementById(document.activeElement.id).value;
        //		                    var fromdate=document.getElementById("Text"+start).value;
        //		                    var todate=currdate;
        //		                    //For From Date Converssion 
        //                            if(dateformat=="dd/mm/yyyy")
        //                            {
        //                                if(fromdate != "")
        //                                {
        //                                    var txt=fromdate;
        //                                     var txt1;
        //                                    if(txt.indexOf("-")>=0)
        //                                    {
        //                                         txt1=txt.split("-");
        //                                    }
        //                                    else{
        //                                        txt1=txt.split("/");
        //                                    }
        //                                   
        //                                    var dd=txt1[0];
        //                                    var mm1=txt1[1];
        //                                    var mm;
        //                                     if(txt.indexOf("-")>=0)
        //                                     {
        //                                         mm = getMonthNo(mm1);
        //                                    }
        //                                    else
        //                                    {
        //                                        mm=mm1;
        //                                    }
        //                                    var yy=txt1[2];
        //                                    fromdate=mm+'/'+dd+'/'+yy;
        //                                }
        //                                else
        //                                {
        //                                    fromdate=fromdate;
        //                                }

        //                            }
        //                            
        //                            if(dateformat=="yyyy/mm/dd")
        //                            {
        //                                if(fromdate!="")
        //                                {
        //                                    var txt=fromdate;
        //                                    var txt1=txt.split("/");
        //                                    var yy=txt1[0];
        //                                    var mm=txt1[1];
        //                                    var dd=txt1[2];
        //                                    fromdate=mm+'/'+dd+'/'+yy;
        //                                }
        //                                else
        //                                {
        //                                    fromdate=fromdate;
        //                                }
        //                            }
        //                            
        //                            if(dateformat=="mm/dd/yyyy")
        //                            {
        //                                fromdate=fromdate;
        //                            }
        //                            
        //                            //For From Date Converssion /************************************************************/
        //                            if(dateformat=="dd/mm/yyyy")
        //                            {
        //                                if(todate != "")
        //                                {
        //                                    var txt=todate;
        //                                    var txt1=txt.split("/");
        //                                    var dd=txt1[0];
        //                                    var mm=txt1[1];
        //                                    var yy=txt1[2];
        //                                    todate=mm+'/'+dd+'/'+yy;
        //                                }
        //                                else
        //                                {
        //                                    todate=todate;
        //                                }

        //                            }
        //                            
        //                            if(dateformat=="yyyy/mm/dd")
        //                            {
        //                                if(todate!="")
        //                                {
        //                                    var txt=todate;
        //                                    var txt1=txt.split("/");
        //                                    var yy=txt1[0];
        //                                    var mm=txt1[1];
        //                                    var dd=txt1[2];
        //                                    todate=mm+'/'+dd+'/'+yy;
        //                                }
        //                                else
        //                                {
        //                                    todate=todate;
        //                                }
        //                            }
        //                            
        //                            if(dateformat=="mm/dd/yyyy")
        //                            {
        //                                todate=todate;
        //                            }
        //		                    //
        //                    		
        //                    		
        //                    		
        //		                    var fdate=new Date(fromdate);
        //		                    var tdate=new Date(todate);
        //		                    if(tdate>fdate)
        //		                    {
        //		                        alert("Paid Schemes Date can't be less than Free Schemes Date");
        //		                        document.getElementById(document.activeElement.id).value="";
        //		                        return false;
        //		                    }
        //		                }
        //		             }    
        //		        }
        //		    }
        //		}

        // check valid date for grid item line
        validDate_Grid(activeID);
    }

    //	return false;
}

function validDate_Grid(name) {
    var compcode = document.getElementById('hiddencompcode').value;
    //var strid1=strid.split('@');
    var gtid = name.substring(4, name.length);
    editid = "edit" + gtid;
    var pkgid = document.getElementById('hiddenpckcode' + gtid).value;
    var pkgalias = document.getElementById('pkg_alias' + gtid).value;
    var pkgname = document.getElementById(editid).value;
    pkgname = pkgname.replace("+", "^");
    var value = "1";
    var dateday = document.getElementById(name).value;

    var strtext = "";
    center = '0';
    if (document.getElementById('chkall') != null) {
        if (document.getElementById('chkall').checked == false) {
            center = document.getElementById('hiddencenter').value;
        }
        else {
            center = '0';
        }
    }

    if (browser != "Microsoft Internet Explorer") {
        var httpRequest = null; ;
        httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml');
        }

        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };
        var adcat = document.getElementById('drpadcategory').value;
        var pkgname1 = "";
        if (pkgname.length < 1024)
            pkgname1 = pkgname;
        httpRequest.open("GET", "packagename.aspx?center=" + center + "&adtype=" + document.getElementById('hiddenadtype').value + "&pkgalias=" + pkgalias + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + value + "&dateday=" + dateday + "&pkgname=" + pkgname1, false);
        httpRequest.send('');
        //alert(httpRequest.readyState);
        if (httpRequest.readyState == 4) {
            //alert(httpRequest.status);
            if (httpRequest.status == 200) {
                strtext = httpRequest.responseText;
            }
            else {
                alert('There was a problem with the request.');
            }
        }
    }
    else {
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        var adcat = document.getElementById('drpadcategory').value;
        var pkgname1 = "";
        if (pkgname.length < 1024)
            pkgname1 = pkgname;
        xml.Open("GET", "packagename.aspx?center=" + center + "&adtype=" + document.getElementById('hiddenadtype').value + "&pkgalias=" + pkgalias + "&adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + value + "&dateday=" + dateday + "&pkgname=" + pkgname1, false);
        xml.Send();
        strtext = xml.responseText;
    }
    if (strtext == "NOT A VALID DATE") {
        alert("NOT A VALID DATE");
        document.getElementById(name).value = "";
        return false;
    }
    if (strtext == "0") {
        //alert("Publication day doesnot match with day for Edition " + pkgname);
        //document.getElementById(name).value = tempdate;

    }
    if (strtext != "1" && strtext != "0") {
        document.getElementById(name).value = strtext;
    }
}
function bgcolor_blur() {
    var index = document.getElementById('drpcolor').selectedIndex;
    var textcolor = document.getElementById('drpcolor').options[index].text;
    if (document.getElementById('hiddenuomdesc').value != "CD") {
        if (textcolor.indexOf("COLOR") >= 0) {
            if (document.getElementById('drpbgcolor').value == "0") {
                alert("Please Select Background Color");
                document.getElementById('drpbgcolor').focus();
                return false;
            }
        }
    }
}

function chkDateforGrid_QBC(activeID) {

    var validformat = '';
    var dateformat = document.getElementById('hiddendateformat').value;
    if (dateformat == "mm/dd/yyyy") {
        validformat = /^\d{2}\/\d{2}\/\d{4}$/ //Basic check for format validity
    }
    if (dateformat == "yyyy/mm/dd") {
        validformat = /^\d{4}\/\d{2}\/\d{2}$/ //Basic check for format validity
    }
    if (dateformat == "dd/mm/yyyy") {
        validformat = /^\d{2}\/\d{2}\/\d{4}$/ //Basic check for format validity
    }

    // var activeID=document.activeElement.id;
    var currdate = document.getElementById(activeID).value;
    var fromdate = document.getElementById('txtdatetime').value;
    var todate = currdate;
    var bool_chk = true;
    if (!validformat.test(currdate)) {
        bool_chk = false;
    }
    else {
        if (dateformat == "yyyy/mm/dd") {
            var yearfield = currdate.split("/")[0]
            var monthfield = currdate.split("/")[1]
            var dayfield = currdate.split("/")[2]
            var dayobj = new Date(yearfield, monthfield - 1, dayfield)
        }
        if (dateformat == "mm/dd/yyyy") {
            var yearfield = currdate.split("/")[2]
            var monthfield = currdate.split("/")[0]
            var dayfield = currdate.split("/")[1]
            //var dayobj = new Date(monthfield-1, dayfield, yearfield)
            var dayobj = new Date(yearfield, monthfield - 1, dayfield)

        }
        if (dateformat == "dd/mm/yyyy") {
            var yearfield = currdate.split("/")[2]
            var monthfield = currdate.split("/")[1]
            var dayfield = currdate.split("/")[0]
            //var dayobj = new Date(dayfield, monthfield-1, yearfield)
            var dayobj = new Date(yearfield, monthfield - 1, dayfield)
        }
        var abcd = dayobj.getMonth() + 1;

        var date1 = dayobj.getDate();
        var year1 = dayobj.getFullYear();
        if ((abcd != monthfield) || (date1 != dayfield) || (year1 != yearfield)) {
            bool_chk = false;
        }
    }
    return bool_chk;

}
function openSelectionEdiionDiv() {
    //alert(document.getElementById('drppackage').left);
    //arrEdition_Item='';
    document.getElementById('showselectedition').innerHTML = "";
    var pkg_edi = document.getElementById('drppackage').value.split('@')[1].split('+');
    var res = QBC.getPkgEdition(document.getElementById('hiddencompcode').value, document.getElementById('drppackage').value.split('@')[0]);
    var str = "";
    var dFlag = true;
    if (res.value != null && res.value != "") {
        document.getElementById('hiddenpkgedition').value = res.value;
        if (parseInt(res.value) != pkg_edi.length) {
            str = "<table width=120%>";
            for (var i = 0; i < parseInt(pkg_edi.length); i++) {
                document.getElementById('showselectedition').style.left = 510;
                document.getElementById('showselectedition').style.top = 240;
                str = str + "<tr><td><input type=checkbox id='chk" + i + "' onClick='editionClick(chk" + i + ")'></td><td id='tdname" + i + "'>" + pkg_edi[i] + "</td></tr>";

            }
            str = str + "<tr valign=bottom><td ><input type=button value='OK' class='topbutton' style='width:30px' onClick='okEditionClick();'></td><td><input type=button class=topbutton value='Cancel' onClick='closeClick();'></td></tr></table>";
            document.getElementById('showselectedition').innerHTML = str;
            document.getElementById('showselectedition').style.display = "block";
            dFlag = false;
        }
        else {
            for (var i = 0; i < parseInt(pkg_edi.length); i++) {
                if (arrEdition_Item != "") {
                    arrEdition_Item = arrEdition_Item + "," + pkg_edi[i];
                }
                else {
                    arrEdition_Item = pkg_edi[i];
                }
            }
        }
    }
    return dFlag;
}
function editionClick(activeid) {
    var i = 0;
    var count = 0;
    for (i = 0; i < document.getElementById('showselectedition').getElementsByTagName("TBODY")[0].rows.length - 1; i++) {
        if (document.getElementById('chk' + i).checked == true)
            count = parseInt(count, 10) + 1;
    }
    if (count > parseInt(document.getElementById('hiddenpkgedition').value)) {
        alert("You Can't Select More Editions");
        activeid.checked = false;
        return false;

    }
    //document.getElementById('showselectedition').getElementsByTagName("tbody")[0].appendChild(Make_Row);
}
function closeClick() {
    document.getElementById('showselectedition').style.display = 'none';
}
function okEditionClick() {
    var i = 0;
    var count = 0;
    //  arrEdition_Item='';
    for (i = 0; i < document.getElementById('showselectedition').getElementsByTagName("TBODY")[0].rows.length - 1; i++) {
        if (document.getElementById('chk' + i).checked == true) {
            count = parseInt(count, 10) + 1;
            if (arrEdition_Item == '')
                arrEdition_Item = trim(document.getElementById('tdname' + i).innerHTML); //+ "~" + document.getElementById('drppackage').value.split('@')[0];
            else
                arrEdition_Item = trim(arrEdition_Item) + ',' + trim(document.getElementById('tdname' + i).innerHTML); // + "~" + document.getElementById('drppackage').value.split('@')[0];
        }
    }
    if (count > parseInt(document.getElementById('hiddenpkgedition').value) || count < parseInt(document.getElementById('hiddenpkgedition').value)) {
        alert("Please Select " + document.getElementById('hiddenpkgedition').value + " Editions.");
        return false;

    }
    bindGrid_Edition();
    document.getElementById('showselectedition').style.display = 'none';
}
function bindGrid_Edition() {
    var obj = document.getElementById('drppackagecopy');
    for (var x = 0; x < obj.options.length; x++) {
        if (document.getElementById('drppackage').value == obj[x].value.substring(0, obj[x].value.indexOf('('))) {
            // alert("This package is already shifted");
            var insertCount = 1;
            if (obj[x].value.indexOf('(') >= 0) {
                insertCount = obj[x].value.substring(obj[x].value.indexOf('(') + 1, obj[x].value.length - 1);
            }
            insertCount = parseInt(insertCount) + 1;
            obj[x].value = obj[x].value.substring(0, obj[x].value.indexOf('(')) + '(' + insertCount + ')';
            obj[x].text = obj[x].text.substring(0, obj[x].text.indexOf('(')) + '(' + insertCount + ')';
            onInsertionChange();
            return false;
        }
    }
    var strid = document.getElementById('drppackage').value;
    var compcode = document.getElementById('hiddencompcode').value;
    var strid1 = strid.split('@');
    var pkgid = strid1[0];
    var pkgname = strid1[1];
    glpkgname = pkgname;
    var value = "0";
    var dateday = "";
    var strtext = "";
    var code = "";
    var desc = "";


    if (browser != "Microsoft Internet Explorer") {
        var httpRequest = null;
        httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml');
        }

        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };
        var adcat = document.getElementById('drpadcategory').value;
        var pkgname1 = "";
        if (pkgname.length < 1024)
            pkgname1 = pkgname;
        httpRequest.open("GET", "packagename.aspx?adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + value + "&pkgname=" + pkgname1 + "&dateday=" + dateday, false);
        httpRequest.send('');
        //alert(httpRequest.readyState);
        if (httpRequest.readyState == 4) {
            //alert(httpRequest.status);
            if (httpRequest.status == 200) {
                strtext = httpRequest.responseText;
            }
            else {
                alert('There was a problem with the request.');
            }
        }
    }
    else {
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        var adcat = document.getElementById('drpadcategory').value;
        var pkgname1 = "";
        if (pkgname.length < 1024)
            pkgname1 = pkgname;
        xml.Open("GET", "packagename.aspx?adcat=" + adcat + "&pkgid=" + pkgid + "&compcode=" + compcode + "&value=" + value + "&pkgname=" + pkgname1 + "&dateday=" + dateday, false);
        xml.Send();
        strtext = xml.responseText;
    }
    if (strtext == "NOT A VALID DATE") {
        alert("NOT A VALID DATE");
        return false;
    }
    document.getElementById('pkgname').value = strtext;
    if (document.getElementById('drppackagecopy').options.length == 0) {
        che_flag = 0;
    }
    if (che_flag == 1) {
        alert("Can't select multiple Package");
        return false;
    }
    else if ((document.getElementById('drppackagecopy').options.length > 0) && (pkgname.indexOf(" or ") >= 0)) {
        alert("Can't select this Package");
        return false;
    }
    else {
        if (pkgname.indexOf(" or ") >= 0) {
            che_flag = 1;
            QBC.bindTable(pkgname, bindTable_callback);
            check_or = "1";
        }
        var val_ = "";
        var agencytype = document.getElementById('drpadtype').value;
        if (browser != "Microsoft Internet Explorer") {
            var httpRequest = null; ;
            httpRequest = new XMLHttpRequest();
            if (httpRequest.overrideMimeType) {
                httpRequest.overrideMimeType('text/xml');
            }

            httpRequest.onreadystatechange = function () { alertContents(httpRequest) };
            var glpkgname1 = "";
            if (glpkgname.length < 1024)
                glpkgname1 = glpkgname;
            httpRequest.open("GET", "gettheinsertionfromcombin.aspx?desc=" + glpkgname1 + "&code=" + pkgid + "&agencytype=" + agencytype, false);
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) {
                    val_ = httpRequest.responseText;
                }
                else {
                    alert('There was a problem with the request.');
                }
            }
        }
        else {
            var xml = new ActiveXObject("Microsoft.XMLHTTP");
            var glpkgname1 = "";
            if (glpkgname.length < 1024)
                glpkgname1 = glpkgname;

            xml.Open("GET", "gettheinsertionfromcombin.aspx?desc=" + glpkgname1 + "&code=" + pkgid + "&agencytype=" + agencytype, false);
            xml.Send();
            val_ = xml.responseText;

        }
        /////////////////////////////
        var insertO = document.getElementById('txtinsertion').value;
        document.getElementById('tempinsert').value = document.getElementById('txtinsertion').value;
        if (document.getElementById('tempinsert').value == "")
            document.getElementById('tempinsert').value = 1;
        if (insertO == "")
            insertO = 1;
        if (val_ != "" && val_ != "0" && val_ != null) {
            document.getElementById('txtinsertion').value = val_;


        }
        else {
            document.getElementById('tempinsert').value = document.getElementById('txtinsertion').value;
        }
        ////////////////////////



        if (che_flag == 0) {
            if (strtext != "0") {
                AddItem(document.getElementById('drppackagecopy'), strtext, strid, val_);
            }
            document.getElementById('btndel').focus();
        }
    }
    //        if(val_!="" && val_!="0" && val_!=null)
    //        {
    //             var objn=document.getElementById('drppackagecopy');
    //           
    //                for(var x=0;x<objn.options.length;x++)
    //                {
    //                    if(document.getElementById('drppackage').value==obj[x].value.substring(0,obj[x].value.indexOf('(')))
    //                    {
    //                       // alert("This package is already shifted");
    //                       var insertCount = val_;
    //                        var insertCount1 = 0;
    //                       if(obj[x].value.indexOf('(')>=0)
    //                       {
    //                            insertCount1=obj[x].value.substring(obj[x].value.lastIndexOf('(')+1,obj[x].value.length-1);
    //                            insertCount1=parseInt(insertCount1)-1;
    //                       }
    //                       insertCount=parseInt(insertCount) + parseInt(insertCount1);
    //                       obj[x].value = obj[x].value.substring(0,obj[x].value.indexOf('(')) + '('+insertCount+')';
    //                       obj[x].text =  obj[x].text.substring(0,obj[x].text.indexOf('(')) + '('+insertCount+')';
    //                       x=objn.options.length;
    //                    }
    //                }
    //        }
    document.getElementById('txtinsertion').value = insertO;
    document.getElementById('drpuom').focus();
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
    return false;
}
function checkValidEdition(editionName)// FOR CHECKING EXISTING EDITION
{
    var bFlag = false;
    //    if (arrEdition_Item != "") {
    //        var arr_split = arrEdition_Item.split(',');
    //        for (var i = 0; i < arr_split.length; i++) {
    //            var narr_split = trim(arr_split[i]).split('~');
    //            if (trim(narr_split[0]) == trim(editionName) && trim(narr_split[1]) == trim(pkgcode)) {
    //                bFlag = true;
    //                break;
    //            }
    //        }
    //    }
    if (arrEdition_Item != "") {
        var arr_split = arrEdition_Item.split(',');
        for (var i = 0; i < arr_split.length; i++) {
            if (trim(arr_split[i]) == trim(editionName)) {
                bFlag = true;
                break;
            }
        }
    }
    else
        bFlag = true;
    return bFlag;
}
function checkPub() {
    if (document.getElementById('chkhindu') != null) {
        if (document.activeElement.id == "chkhindi") {
            if (document.getElementById("chkHindi").checked == true)
                document.getElementById("chkHindu").checked = false;
        }
        else if (document.activeElement.id == "chkhindu") {
            if (document.getElementById("chkHindu").checked == true)
                document.getElementById("chkHindi").checked = false;
        }
    }
    bindpackage_cen();
}
function checkContiniuity() {
    if (document.getElementById('tblinsert').innerHTML != "") {
        var y = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length;
        var dt1;
        var boold;
        for (var i = 0; i < y - 1; i++) {
            var pkgcodegrid = 'hiddenpckcode' + i;
            if (document.getElementById(pkgcodegrid) != null) {
                if (document.getElementById(pkgcodegrid).value == 'DB42' || document.getElementById(pkgcodegrid).value == 'DB66' || document.getElementById(pkgcodegrid).value == 'DB60' || document.getElementById(pkgcodegrid).value == 'DB63' || document.getElementById(pkgcodegrid).value == 'DB45' || document.getElementById(pkgcodegrid).value == 'DB51' || document.getElementById(pkgcodegrid).value == 'DB54' || document.getElementById(pkgcodegrid).value == 'DB48' || document.getElementById(pkgcodegrid).value == 'DB57' || document.getElementById(pkgcodegrid).value == 'DB36' || document.getElementById(pkgcodegrid).value == 'DB33' || document.getElementById(pkgcodegrid).value == 'DB28' || document.getElementById(pkgcodegrid).value == 'DB22')// 3insertion
                {
                    boold = false;
                    for (x = i; x < i + 3; x++) {
                        var dateC = document.getElementById('Text' + x).value;
                        var splitaliddate = dateC.split("/");
                        if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[0] + "/" + splitaliddate[1];
                        }
                        else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[1] + "/" + splitaliddate[0];
                        }
                        else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
                            dateC = splitaliddate[0] + "/" + splitaliddate[1] + "/" + splitaliddate[2];
                        }
                        if (x == i)
                            dt1 = new Date(dateC);
                        else {
                            var dt2 = new Date(dateC);
                            var ddiff = daysDiff(dt2, dt1);
                            if (ddiff == 1) {
                                dt1 = new Date(dateC);
                            }
                            else {
                                if (ddiff < 1) {
                                    alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                    return false;
                                }
                                var fdate = (dt1.getMonth() + 1).toString() + "/" + dt1.getDate().toString() + "/" + dt1.getYear().toString();
                                var tdate = (dt2.getMonth() + 1).toString() + "/" + dt2.getDate().toString() + "/" + dt2.getYear().toString();
                                var res = QBC.checkNoIssueBhaskar(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid).value, fdate, tdate);
                                if (res.value == null) {
                                    alert(res.error.description);
                                    return false;
                                }
                                else {
                                    if (res.value.Tables[0].Rows.length > 0) {
                                        if (parseInt(res.value.Tables[0].Rows[0].countname) <= 0 || ddiff > 2) {
                                            alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                            return false;
                                        }
                                        else {
                                            dt1 = new Date(dateC);
                                        }
                                    }
                                    else {
                                        dt1 = new Date(dateC);
                                    }
                                }
                                //                                        alert("Please Take Continuous Date for Item Line No. "+(parseInt(x)+1));
                                //                                        return false;
                            }
                        }
                    }
                    i = parseInt(i) + 2;
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB41' || document.getElementById(pkgcodegrid).value == 'DB56' || document.getElementById(pkgcodegrid).value == 'DB62' || document.getElementById(pkgcodegrid).value == 'DB65' || document.getElementById(pkgcodegrid).value == 'DB44' || document.getElementById(pkgcodegrid).value == 'DB47' || document.getElementById(pkgcodegrid).value == 'DB53' || document.getElementById(pkgcodegrid).value == 'DB50' || document.getElementById(pkgcodegrid).value == 'DB59' || document.getElementById(pkgcodegrid).value == 'DB35' || document.getElementById(pkgcodegrid).value == 'DB32' || document.getElementById(pkgcodegrid).value == 'DB21' || document.getElementById(pkgcodegrid).value == 'DB27')// for 2 cont. insert date
                {
                    boold = false;
                    for (x = i; x < i + 2; x++) {
                        var dateC = document.getElementById('Text' + x).value;
                        var splitaliddate = dateC.split("/");
                        if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[0] + "/" + splitaliddate[1];
                        }
                        else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[1] + "/" + splitaliddate[0];
                        }
                        else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
                            dateC = splitaliddate[0] + "/" + splitaliddate[1] + "/" + splitaliddate[2];
                        }
                        if (x == i)
                            dt1 = new Date(dateC);
                        else {
                            var dt2 = new Date(dateC);
                            var ddiff = daysDiff(dt2, dt1);
                            if (ddiff == 1)
                                dt1 = new Date(dateC);
                            else {
                                if (ddiff < 1) {
                                    alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                    return false;
                                }
                                var fdate = (dt1.getMonth() + 1).toString() + "/" + dt1.getDate().toString() + "/" + dt1.getYear().toString();
                                var tdate = (dt2.getMonth() + 1).toString() + "/" + dt2.getDate().toString() + "/" + dt2.getYear().toString();
                                var res = QBC.checkNoIssueBhaskar(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid).value, fdate, tdate);
                                if (res.value == null) {
                                    alert(res.error.description);
                                    return false;
                                }
                                else {
                                    if (res.value.Tables[0].Rows.length > 0) {
                                        if (parseInt(res.value.Tables[0].Rows[0].countname) <= 0 || ddiff > 2) {
                                            alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                            return false;
                                        }
                                        else {
                                            dt1 = new Date(dateC);
                                        }
                                    }
                                    else {
                                        dt1 = new Date(dateC);
                                    }
                                }
                                //                                        alert("Please Take Continuous Date for Item Line No. "+(parseInt(x)+1));
                                //                                        return false;
                            }
                        }
                    }
                    i = parseInt(i) + 1;
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB29')// for 7 cont. insert date
                {
                    boold = false;
                    for (x = i; x < i + 7; x++) {
                        var dateC = document.getElementById('Text' + x).value;
                        var splitaliddate = dateC.split("/");
                        if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[0] + "/" + splitaliddate[1];
                        }
                        else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[1] + "/" + splitaliddate[0];
                        }
                        else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
                            dateC = splitaliddate[0] + "/" + splitaliddate[1] + "/" + splitaliddate[2];
                        }
                        if (x == i)
                            dt1 = new Date(dateC);
                        else {
                            var dt2 = new Date(dateC);
                            var ddiff = daysDiff(dt2, dt1);
                            if (ddiff == 1)
                                dt1 = new Date(dateC);
                            else {
                                if (ddiff < 1) {
                                    alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                    return false;
                                }
                                var fdate = (dt1.getMonth() + 1).toString() + "/" + dt1.getDate().toString() + "/" + dt1.getYear().toString();
                                var tdate = (dt2.getMonth() + 1).toString() + "/" + dt2.getDate().toString() + "/" + dt2.getYear().toString();
                                var res = QBC.checkNoIssueBhaskar(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid).value, fdate, tdate);
                                if (res.value == null) {
                                    alert(res.error.description);
                                    return false;
                                }
                                else {
                                    if (res.value.Tables[0].Rows.length > 0) {
                                        if (parseInt(res.value.Tables[0].Rows[0].countname) <= 0 || ddiff > 2) {
                                            alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                            return false;
                                        }
                                        else {
                                            dt1 = new Date(dateC);
                                        }
                                    }
                                    else {
                                        dt1 = new Date(dateC);
                                    }
                                }
                                //                                        alert("Please Take Continuous Date for Item Line No. "+(parseInt(x)+1));
                                //                                        return false;
                            }
                        }
                    }
                    i = parseInt(i) + 6;

                }
                else if (document.getElementById(pkgcodegrid).value == 'DB30')// for 15 cont. insert date
                {
                    boold = false;
                    for (x = i; x < i + 15; x++) {
                        var dateC = document.getElementById('Text' + x).value;
                        var splitaliddate = dateC.split("/");
                        if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[0] + "/" + splitaliddate[1];
                        }
                        else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[1] + "/" + splitaliddate[0];
                        }
                        else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
                            dateC = splitaliddate[0] + "/" + splitaliddate[1] + "/" + splitaliddate[2];
                        }
                        if (x == i)
                            dt1 = new Date(dateC);
                        else {
                            var dt2 = new Date(dateC);
                            var ddiff = daysDiff(dt2, dt1);
                            if (ddiff == 1)
                                dt1 = new Date(dateC);
                            else {
                                if (ddiff < 1) {
                                    alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                    return false;
                                }
                                var fdate = (dt1.getMonth() + 1).toString() + "/" + dt1.getDate().toString() + "/" + dt1.getYear().toString();
                                var tdate = (dt2.getMonth() + 1).toString() + "/" + dt2.getDate().toString() + "/" + dt2.getYear().toString();
                                var res = QBC.checkNoIssueBhaskar(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid).value, fdate, tdate);
                                if (res.value == null) {
                                    alert(res.error.description);
                                    return false;
                                }
                                else {
                                    if (res.value.Tables[0].Rows.length > 0) {
                                        if (parseInt(res.value.Tables[0].Rows[0].countname) <= 0 || ddiff > 2) {
                                            alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                            return false;
                                        }
                                        else {
                                            dt1 = new Date(dateC);
                                        }
                                    }
                                    else {
                                        dt1 = new Date(dateC);
                                    }
                                }
                                //                                        alert("Please Take Continuous Date for Item Line No. "+(parseInt(x)+1));
                                //                                        return false;
                            }
                        }
                    }
                    i = parseInt(i) + 14;
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB43' || document.getElementById(pkgcodegrid).value == 'DB58' || document.getElementById(pkgcodegrid).value == 'DB64' || document.getElementById(pkgcodegrid).value == 'DB67' || document.getElementById(pkgcodegrid).value == 'DB46' || document.getElementById(pkgcodegrid).value == 'DB52' || document.getElementById(pkgcodegrid).value == 'DB55' || document.getElementById(pkgcodegrid).value == 'DB49' || document.getElementById(pkgcodegrid).value == 'DB61' || document.getElementById(pkgcodegrid).value == 'DB37' || document.getElementById(pkgcodegrid).value == 'DB34' || document.getElementById(pkgcodegrid).value == 'DB31' || document.getElementById(pkgcodegrid).value == 'DB23')// for 30 cont. insert date
                {
                    boold = false;
                    for (x = i; x < i + 30; x++) {
                        var dateC = document.getElementById('Text' + x).value;
                        var splitaliddate = dateC.split("/");
                        if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[0] + "/" + splitaliddate[1];
                        }
                        else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[1] + "/" + splitaliddate[0];
                        }
                        else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
                            dateC = splitaliddate[0] + "/" + splitaliddate[1] + "/" + splitaliddate[2];
                        }
                        if (x == i)
                            dt1 = new Date(dateC);
                        else {
                            var dt2 = new Date(dateC);
                            var ddiff = daysDiff(dt2, dt1);
                            if (ddiff == 1)
                                dt1 = new Date(dateC);
                            else {
                                if (ddiff < 1) {
                                    alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                    return false;
                                }
                                var fdate = (dt1.getMonth() + 1).toString() + "/" + dt1.getDate().toString() + "/" + dt1.getYear().toString();
                                var tdate = (dt2.getMonth() + 1).toString() + "/" + dt2.getDate().toString() + "/" + dt2.getYear().toString();
                                var res = QBC.checkNoIssueBhaskar(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid).value, fdate, tdate);
                                if (res.value == null) {
                                    alert(res.error.description);
                                    return false;
                                }
                                else {
                                    if (res.value.Tables[0].Rows.length > 0) {
                                        if (parseInt(res.value.Tables[0].Rows[0].countname) <= 0 || ddiff > 2) {
                                            alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                            return false;
                                        }
                                        else {
                                            dt1 = new Date(dateC);
                                        }
                                    }
                                    else {
                                        dt1 = new Date(dateC);
                                    }
                                }
                                //                                        alert("Please Take Continuous Date for Item Line No. "+(parseInt(x)+1));
                                //                                        return false;
                            }
                        }
                    }
                    i = parseInt(i) + 29;
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB38' || document.getElementById(pkgcodegrid).value == 'DB24')// for 90 cont. insert date
                {
                    boold = false;
                    for (x = i; x < i + 90; x++) {
                        var dateC = document.getElementById('Text' + x).value;
                        var splitaliddate = dateC.split("/");
                        if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[0] + "/" + splitaliddate[1];
                        }
                        else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[1] + "/" + splitaliddate[0];
                        }
                        else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
                            dateC = splitaliddate[0] + "/" + splitaliddate[1] + "/" + splitaliddate[2];
                        }
                        if (x == i)
                            dt1 = new Date(dateC);
                        else {
                            var dt2 = new Date(dateC);
                            var ddiff = daysDiff(dt2, dt1);
                            if (ddiff == 1)
                                dt1 = new Date(dateC);
                            else {
                                if (ddiff < 1) {
                                    alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                    return false;
                                }
                                var fdate = (dt1.getMonth() + 1).toString() + "/" + dt1.getDate().toString() + "/" + dt1.getYear().toString();
                                var tdate = (dt2.getMonth() + 1).toString() + "/" + dt2.getDate().toString() + "/" + dt2.getYear().toString();
                                var res = QBC.checkNoIssueBhaskar(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid).value, fdate, tdate);
                                if (res.value == null) {
                                    alert(res.error.description);
                                    return false;
                                }
                                else {
                                    if (res.value.Tables[0].Rows.length > 0) {
                                        if (parseInt(res.value.Tables[0].Rows[0].countname) <= 0 || ddiff > 2) {
                                            alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                            return false;
                                        }
                                        else {
                                            dt1 = new Date(dateC);
                                        }
                                    }
                                    else {
                                        dt1 = new Date(dateC);
                                    }
                                }
                                //                                        alert("Please Take Continuous Date for Item Line No. "+(parseInt(x)+1));
                                //                                        return false;
                            }
                        }
                    }
                    i = parseInt(i) + 89;
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB39' || document.getElementById(pkgcodegrid).value == 'DB25')// for 180 cont. insert date
                {
                    boold = false;
                    for (x = i; x < i + 180; x++) {
                        var dateC = document.getElementById('Text' + x).value;
                        var splitaliddate = dateC.split("/");
                        if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[0] + "/" + splitaliddate[1];
                        }
                        else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[1] + "/" + splitaliddate[0];
                        }
                        else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
                            dateC = splitaliddate[0] + "/" + splitaliddate[1] + "/" + splitaliddate[2];
                        }
                        if (x == i)
                            dt1 = new Date(dateC);
                        else {
                            var dt2 = new Date(dateC);
                            var ddiff = daysDiff(dt2, dt1);
                            if (ddiff == 1)
                                dt1 = new Date(dateC);
                            else {
                                if (ddiff < 1) {
                                    alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                    return false;
                                }
                                var fdate = (dt1.getMonth() + 1).toString() + "/" + dt1.getDate().toString() + "/" + dt1.getYear().toString();
                                var tdate = (dt2.getMonth() + 1).toString() + "/" + dt2.getDate().toString() + "/" + dt2.getYear().toString();
                                var res = QBC.checkNoIssueBhaskar(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid).value, fdate, tdate);
                                if (res.value == null) {
                                    alert(res.error.description);
                                    return false;
                                }
                                else {
                                    if (res.value.Tables[0].Rows.length > 0) {
                                        if (parseInt(res.value.Tables[0].Rows[0].countname) <= 0 || ddiff > 2) {
                                            alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                            return false;
                                        }
                                        else {
                                            dt1 = new Date(dateC);
                                        }
                                    }
                                    else {
                                        dt1 = new Date(dateC);
                                    }
                                }
                                //                                        alert("Please Take Continuous Date for Item Line No. "+(parseInt(x)+1));
                                //                                        return false;
                            }
                        }
                    }
                    i = parseInt(i) + 179;
                }

                else if (document.getElementById(pkgcodegrid).value == 'DB40' || document.getElementById(pkgcodegrid).value == 'DB26')// for 365 cont. insert date
                {
                    boold = false;
                    for (x = i; x < i + 365; x++) {
                        var dateC = document.getElementById('Text' + x).value;
                        var splitaliddate = dateC.split("/");
                        if (document.getElementById('hiddendateformat').value == "mm/dd/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[0] + "/" + splitaliddate[1];
                        }
                        else if (document.getElementById('hiddendateformat').value == "dd/mm/yyyy") {
                            dateC = splitaliddate[2] + "/" + splitaliddate[1] + "/" + splitaliddate[0];
                        }
                        else if (document.getElementById('hiddendateformat').value = "yyyy/mm/dd") {
                            dateC = splitaliddate[0] + "/" + splitaliddate[1] + "/" + splitaliddate[2];
                        }
                        if (x == i)
                            dt1 = new Date(dateC);
                        else {
                            var dt2 = new Date(dateC);
                            var ddiff = daysDiff(dt2, dt1);
                            if (ddiff == 1)
                                dt1 = new Date(dateC);
                            else {
                                if (ddiff < 1) {
                                    alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                    return false;
                                }
                                var fdate = (dt1.getMonth() + 1).toString() + "/" + dt1.getDate().toString() + "/" + dt1.getYear().toString();
                                var tdate = (dt2.getMonth() + 1).toString() + "/" + dt2.getDate().toString() + "/" + dt2.getYear().toString();
                                var res = QBC.checkNoIssueBhaskar(document.getElementById('hiddencompcode').value, document.getElementById(pkgcodegrid).value, fdate, tdate);
                                if (res.value == null) {
                                    alert(res.error.description);
                                    return false;
                                }
                                else {
                                    if (res.value.Tables[0].Rows.length > 0) {
                                        if (parseInt(res.value.Tables[0].Rows[0].countname) <= 0 || ddiff > 2) {
                                            alert("Please Take Continuous Date for Item Line No. " + (parseInt(x) + 1));
                                            return false;
                                        }
                                        else {
                                            dt1 = new Date(dateC);
                                        }
                                    }
                                    else {
                                        dt1 = new Date(dateC);
                                    }
                                }
                                //                                        alert("Please Take Continuous Date for Item Line No. "+(parseInt(x)+1));
                                //                                        return false;
                            }
                        }
                    }
                    i = parseInt(i) + 364;
                }

            }
        }
    }
}


function daysDiff(day1, day2) {
    var diff = Date.parse(day1) - Date.parse(day2);
    var daysDiff = Math.floor(diff / 1000 / 60 / 60 / 24);
    return daysDiff;
}
function getInsert(code) {
    if (browser != "Microsoft Internet Explorer") {
        var httpRequest = null; ;
        httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml');
        }

        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

        httpRequest.open("GET", "gettheinsertionfromcombin.aspx?desc=&code=" + code + "&agencytype=" + document.getElementById('drpadtype').value, false);
        httpRequest.send('');
        //alert(httpRequest.readyState);
        if (httpRequest.readyState == 4) {
            //alert(httpRequest.status);
            if (httpRequest.status == 200) {
                val_ = httpRequest.responseText;
            }
            else {
                alert('There was a problem with the request.');
            }
        }
    }
    else {
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        xml.Open("GET", "gettheinsertionfromcombin.aspx?desc=&code=" + code + "&agencytype=" + document.getElementById('drpadtype').value, false);
        xml.Send();
        val_ = xml.responseText;

    }
    return val_;
}


function roundTotal() {
    if (document.getElementById('tblinsert').innerHTML != "") {
        var y = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length;
        var dt1;
        var boold;
        var gridGross = 0;
        var netAMt = 0;
        for (var i = 0; i < y - 1; i++) {
            var pkgcodegrid = 'hiddenpckcode' + i;
            if (document.getElementById(pkgcodegrid) != null) {
                if (document.getElementById(pkgcodegrid).value == 'DB42' || document.getElementById(pkgcodegrid).value == 'DB66' || document.getElementById(pkgcodegrid).value == 'DB60' || document.getElementById(pkgcodegrid).value == 'DB63' || document.getElementById(pkgcodegrid).value == 'DB45' || document.getElementById(pkgcodegrid).value == 'DB51' || document.getElementById(pkgcodegrid).value == 'DB54' || document.getElementById(pkgcodegrid).value == 'DB48' || document.getElementById(pkgcodegrid).value == 'DB57' || document.getElementById(pkgcodegrid).value == 'DB36' || document.getElementById(pkgcodegrid).value == 'DB33' || document.getElementById(pkgcodegrid).value == 'DB28' || document.getElementById(pkgcodegrid).value == 'DB22')// 3insertion
                {
                    for (x = i; x < i + 3; x++) {
                        var gross = "gro" + x;
                        if (document.getElementById(gross) != null && document.getElementById(gross).value != '') {
                            netAMt = parseFloat(netAMt) + parseFloat(document.getElementById(gross).value);
                        }
                        if (document.getElementById("card" + x) != null && document.getElementById("card" + x) != "" && document.getElementById(gross).value != '0') {
                            gridGross = parseFloat(gridGross) + parseFloat(document.getElementById("card" + x).value);
                        }
                    }
                    i = parseInt(i) + 2;

                    var diff1 = Math.round(gridGross) - parseFloat(gridGross);
                    if (parseFloat(gridGross) > Math.round(gridGross))
                        diff1 = parseFloat(gridGross) - Math.round(gridGross);
                    if (diff1 > 0) {
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value) + parseFloat(diff1);
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value).toFixed(2)
                    }
                    netAMt = Math.round(netAMt);
                    gridGross = Math.round(gridGross);
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB41' || document.getElementById(pkgcodegrid).value == 'DB56' || document.getElementById(pkgcodegrid).value == 'DB62' || document.getElementById(pkgcodegrid).value == 'DB65' || document.getElementById(pkgcodegrid).value == 'DB44' || document.getElementById(pkgcodegrid).value == 'DB47' || document.getElementById(pkgcodegrid).value == 'DB53' || document.getElementById(pkgcodegrid).value == 'DB50' || document.getElementById(pkgcodegrid).value == 'DB59' || document.getElementById(pkgcodegrid).value == 'DB35' || document.getElementById(pkgcodegrid).value == 'DB32' || document.getElementById(pkgcodegrid).value == 'DB21' || document.getElementById(pkgcodegrid).value == 'DB27')// for 2 cont. insert date
                {
                    for (x = i; x < i + 2; x++) {
                        var gross = "gro" + x;
                        if (document.getElementById(gross) != null && document.getElementById(gross).value != '') {
                            netAMt = parseFloat(netAMt) + parseFloat(document.getElementById(gross).value);
                        }
                        if (document.getElementById("card" + x) != null && document.getElementById("card" + x) != "" && document.getElementById(gross).value != '0') {
                            gridGross = parseFloat(gridGross) + parseFloat(document.getElementById("card" + x).value);
                        }
                    }
                    i = parseInt(i) + 1;

                    var diff1 = Math.round(gridGross) - parseFloat(gridGross);
                    if (parseFloat(gridGross) > Math.round(gridGross))
                        diff1 = parseFloat(gridGross) - Math.round(gridGross);
                    if (diff1 > 0) {
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value) + parseFloat(diff1);
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value).toFixed(2)
                    }
                    netAMt = Math.round(netAMt);
                    gridGross = Math.round(gridGross);
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB29')// for 7 cont. insert date
                {
                    for (x = i; x < i + 7; x++) {
                        var gross = "gro" + x;
                        if (document.getElementById(gross) != null && document.getElementById(gross).value != '') {
                            netAMt = parseFloat(netAMt) + parseFloat(document.getElementById(gross).value);
                        }
                        if (document.getElementById("card" + x) != null && document.getElementById("card" + x) != "" && document.getElementById(gross).value != '0') {
                            gridGross = parseFloat(gridGross) + parseFloat(document.getElementById("card" + x).value);
                        }
                    }
                    i = parseInt(i) + 6;

                    var diff1 = Math.round(gridGross) - parseFloat(gridGross);
                    if (parseFloat(gridGross) > Math.round(gridGross))
                        diff1 = parseFloat(gridGross) - Math.round(gridGross);
                    if (diff1 > 0) {
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value) + parseFloat(diff1);
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value).toFixed(2)
                    }
                    netAMt = Math.round(netAMt);
                    gridGross = Math.round(gridGross);
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB30')// for 15 cont. insert date
                {
                    for (x = i; x < i + 15; x++) {
                        var gross = "gro" + x;
                        if (document.getElementById(gross) != null && document.getElementById(gross).value != '') {
                            netAMt = parseFloat(netAMt) + parseFloat(document.getElementById(gross).value);
                        }
                        if (document.getElementById("card" + x) != null && document.getElementById("card" + x) != "" && document.getElementById(gross).value != '0') {
                            gridGross = parseFloat(gridGross) + parseFloat(document.getElementById("card" + x).value);
                        }
                    }
                    i = parseInt(i) + 14;

                    var diff1 = Math.round(gridGross) - parseFloat(gridGross);
                    if (parseFloat(gridGross) > Math.round(gridGross))
                        diff1 = parseFloat(gridGross) - Math.round(gridGross);
                    if (diff1 > 0) {
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value) + parseFloat(diff1);
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value).toFixed(2)
                    }
                    netAMt = Math.round(netAMt);
                    gridGross = Math.round(gridGross);
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB43' || document.getElementById(pkgcodegrid).value == 'DB58' || document.getElementById(pkgcodegrid).value == 'DB64' || document.getElementById(pkgcodegrid).value == 'DB67' || document.getElementById(pkgcodegrid).value == 'DB46' || document.getElementById(pkgcodegrid).value == 'DB52' || document.getElementById(pkgcodegrid).value == 'DB55' || document.getElementById(pkgcodegrid).value == 'DB49' || document.getElementById(pkgcodegrid).value == 'DB61' || document.getElementById(pkgcodegrid).value == 'DB37' || document.getElementById(pkgcodegrid).value == 'DB34' || document.getElementById(pkgcodegrid).value == 'DB31' || document.getElementById(pkgcodegrid).value == 'DB23')// for 30 cont. insert date
                {
                    for (x = i; x < i + 30; x++) {
                        var gross = "gro" + x;
                        if (document.getElementById(gross) != null && document.getElementById(gross).value != '') {
                            netAMt = parseFloat(netAMt) + parseFloat(document.getElementById(gross).value);
                        }
                        if (document.getElementById("card" + x) != null && document.getElementById("card" + x) != "" && document.getElementById(gross).value != '0') {
                            gridGross = parseFloat(gridGross) + parseFloat(document.getElementById("card" + x).value);
                        }
                    }
                    i = parseInt(i) + 29;

                    var diff1 = Math.round(gridGross) - parseFloat(gridGross);
                    if (parseFloat(gridGross) > Math.round(gridGross))
                        diff1 = parseFloat(gridGross) - Math.round(gridGross);
                    if (diff1 > 0) {
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value) + parseFloat(diff1);
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value).toFixed(2)
                    }
                    netAMt = Math.round(netAMt);
                    gridGross = Math.round(gridGross);
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB38' || document.getElementById(pkgcodegrid).value == 'DB24')// for 90 cont. insert date
                {
                    for (x = i; x < i + 90; x++) {
                        var gross = "gro" + x;
                        if (document.getElementById(gross) != null && document.getElementById(gross).value != '') {
                            netAMt = parseFloat(netAMt) + parseFloat(document.getElementById(gross).value);
                        }
                        if (document.getElementById("card" + x) != null && document.getElementById("card" + x) != "" && document.getElementById(gross).value != '0') {
                            gridGross = parseFloat(gridGross) + parseFloat(document.getElementById("card" + x).value);
                        }
                    }
                    i = parseInt(i) + 89;

                    var diff1 = Math.round(gridGross) - parseFloat(gridGross);
                    if (parseFloat(gridGross) > Math.round(gridGross))
                        diff1 = parseFloat(gridGross) - Math.round(gridGross);
                    if (diff1 > 0) {
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value) + parseFloat(diff1);
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value).toFixed(2)
                    }
                    netAMt = Math.round(netAMt);
                    gridGross = Math.round(gridGross);
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB39' || document.getElementById(pkgcodegrid).value == 'DB25')// for 180 cont. insert date
                {
                    for (x = i; x < i + 180; x++) {
                        var gross = "gro" + x;
                        if (document.getElementById(gross) != null && document.getElementById(gross).value != '') {
                            netAMt = parseFloat(netAMt) + parseFloat(document.getElementById(gross).value);
                        }
                        if (document.getElementById("card" + x) != null && document.getElementById("card" + x) != "" && document.getElementById(gross).value != '0') {
                            gridGross = parseFloat(gridGross) + parseFloat(document.getElementById("card" + x).value);
                        }
                    }
                    i = parseInt(i) + 179;

                    var diff1 = Math.round(gridGross) - parseFloat(gridGross);
                    if (parseFloat(gridGross) > Math.round(gridGross))
                        diff1 = parseFloat(gridGross) - Math.round(gridGross);
                    if (diff1 > 0) {
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value) + parseFloat(diff1);
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value).toFixed(2)
                    }
                    netAMt = Math.round(netAMt);
                    gridGross = Math.round(gridGross);
                }
                else if (document.getElementById(pkgcodegrid).value == 'DB40' || document.getElementById(pkgcodegrid).value == 'DB26')// for 365 cont. insert date
                {
                    for (x = i; x < i + 365; x++) {
                        var gross = "gro" + x;
                        if (document.getElementById(gross) != null && document.getElementById(gross).value != '') {
                            netAMt = parseFloat(netAMt) + parseFloat(document.getElementById(gross).value);
                        }
                        if (document.getElementById("card" + x) != null && document.getElementById("card" + x) != "" && document.getElementById(gross).value != '0') {
                            gridGross = parseFloat(gridGross) + parseFloat(document.getElementById("card" + x).value);
                        }
                    }
                    i = parseInt(i) + 364;

                    var diff1 = Math.round(gridGross) - parseFloat(gridGross);
                    if (parseFloat(gridGross) > Math.round(gridGross))
                        diff1 = parseFloat(gridGross) - Math.round(gridGross);
                    if (diff1 > 0) {
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value) + parseFloat(diff1);
                        document.getElementById("card" + i).value = parseFloat(document.getElementById("card" + i).value).toFixed(2)
                    }
                    netAMt = Math.round(netAMt);
                    gridGross = Math.round(gridGross);
                }
                else {
                    var gross = "gro" + i;
                    if (document.getElementById(gross) != null && document.getElementById(gross).value != '') {
                        netAMt = parseFloat(netAMt) + parseFloat(document.getElementById(gross).value);
                    }
                    if (document.getElementById("card" + i) != null && document.getElementById("card" + i) != "" && document.getElementById(gross).value != '0') {
                        gridGross = parseFloat(gridGross) + parseFloat(document.getElementById("card" + i).value);
                    }
                }
            }
        }
        document.getElementById('txttotalamt').value = Math.round(netAMt);
        //  document.getElementById('txttotalamt').value=gridGross;   
        if (tradedisc != null && tradedisc != "" && document.getElementById('chktrade').checked == false)
            document.getElementById('txtgrossamt').value = parseFloat(document.getElementById('txttotalamt').value) - (parseFloat(document.getElementById('txttotalamt').value) * parseFloat(tradedisc) / 100);
        document.getElementById('txtgrossamt').value == Math.round(document.getElementById('txtgrossamt').value);

    }
}
function daysInMonth(iMonth, iYear) {
    return 32 - new Date(iYear, iMonth, 32).getDate();
}
function blankGross() {
    document.getElementById('txtgrossamt').value = "";
    if (paivar == "Y") {
        document.getElementById(document.activeElement.id).value = "Y";
    }
}
function chkmaincodeAgency(name) {
    if (name == "agency") {
        if (document.getElementById('txtagency').value.indexOf("(") > 0) {
            var code = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.lastIndexOf(')'));
            var res = QBC.chkCodeMain("agency", code, document.getElementById('hiddencompcode').value);
            if (res.value != null) {
                if (res.value == false) {
                    alert("Please Enter Valid Agency");
                    // document.getElementById('txtagency').value="";
                    document.getElementById('txtagency').focus();
                    return false;
                }
            }

        }
        else if (document.getElementById('txtagency').value != "") {
            alert("Please Enter Valid Agency");
            return false;
        }
    }


}


function keySort(dropdownlist, caseSensitive) {
    // check the keypressBuffer attribute is defined on the dropdownlist 
    var undefined;
    if (dropdownlist.keypressBuffer == undefined) {
        dropdownlist.keypressBuffer = '';
    }
    // get the key that was pressed 
    var key = String.fromCharCode(window.event.keyCode);
    dropdownlist.keypressBuffer += key;
    if (!caseSensitive) {
        // convert buffer to lowercase
        dropdownlist.keypressBuffer = dropdownlist.keypressBuffer.toLowerCase();
    }
    // find if it is the start of any of the options 
    var optionsLength = dropdownlist.options.length;
    for (var n = 0; n < optionsLength; n++) {
        var optionText = dropdownlist.options[n].text;
        if (!caseSensitive) {
            optionText = optionText.toLowerCase();
        }
        if (optionText.indexOf(dropdownlist.keypressBuffer, 0) == 0) {
            dropdownlist.selectedIndex = n;
            return false; // cancel the default behavior since 
            // we have selected our own value 
        }
    }
    // reset initial key to be inline with default behavior 
    dropdownlist.keypressBuffer = key;
    return true; // give default behavior 
}

function fillRemarks() {
    var count1 = document.getElementById('bookdiv').getElementsByTagName('table')[0].rows.length - 1;
    for (var i = 0; i < count1; i++) {
        if (document.getElementById('inssta' + i).value == 'booked' || document.getElementById('inssta' + i).value == 'hold') {
            if (document.getElementById("rem" + i) != null && document.getElementById("txtprintremark") != null) {
                document.getElementById("rem" + i).value = document.getElementById("txtprintremark").value;
            }
        }
    }
}
function chkagency() {
    //	alert(document.getElementById('divagencymain').style.display);
    agency = document.getElementById('txtagency').value;
    if (agency != "" && agency.indexOf('(') < 0 && agency.indexOf(')') < 0 && document.getElementById('divagencymain').style.display == "none") {
        alert('This Agency doesnt exists');
        document.getElementById('txtagency').value = "";
        document.getElementById('txtagency').focus();
        return false;
    }
    agency = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.length + document.getElementById('txtagency').value.lastIndexOf('('));
    agency = agency.replace(")", "");

    if (agency != "" && document.getElementById('divagencymain').style.display == "none") {
        var res = QBC.chkagencycode(agency, document.getElementById("hiddencompcode").value, "0", "0", "0");
        var ds = res.value;
        if (ds == null)
            return false;
        if (ds.Tables.length > 0 && ds.Tables[0].Rows.length > 0)
        { }
        else {
            alert('This name doesnt exists');
            document.getElementById('txtagency').value = "";
            document.getElementById('txtagency').focus();
            return false;
        }

    }
}
function openDiscDetail() {
    var agencycode = "";
    document.getElementById('txtgrossamt').value = "";
    if (document.getElementById('txtagency').value == "") {
        alert("Please Enter Agency");
        document.getElementById('txtagency').focus();
        return false;

    }
    //	else if (document.getElementById('txtcardrate').value == "")
    //	{
    ////	   alert("Please Firstly Get Card Rate");
    ////		//document.getElementById('txtcardrate').focus();
    ////	   return false;

    //	}
    else {
        agencycode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.length + document.getElementById('txtagency').value.lastIndexOf('('));
        agencycode = agencycode.replace(")", "");
        win = window.open('QBCDETAIL.aspx?cardrate=' + document.getElementById('txtcardrate').value + '&Special_charges=' + document.getElementById('hiddenspecharges').value + '&RETAINER_COMM=' + document.getElementById('hiddenretainercomm').value + '&Executive_zone=' + document.getElementById('hiddenzone').value + '&Agency_pay=' + document.getElementById('hiddenpay').value + '&RETAINER1=' + document.getElementById('hiddenretainer').value + '&Special_discount=' + document.getElementById('hiddenspedisc').value + '&Special_disc_per=' + document.getElementById('hiddenspediscper').value + '&Agreed_amount=' + document.getElementById('hiddenagreedamt').value + '&Prem_per=' + document.getElementById('hiddentxtpremper').value + '&Page_prem=' + document.getElementById('hiddendrppageprem').value + '&product=' + document.getElementById('hiddenproduct').value + '&execname=' + document.getElementById('hiddenexecname').value + '&cioid=' + document.getElementById('txtciobookid').value + '&status=' + chkbtnStatus + '&agency=' + agencycode + '&pageposition=' + document.getElementById('Hiddendrppageposition').value + '&pageamt=' + document.getElementById('Hiddentxtpageamt').value + '&txtclientcatdisc=' + document.getElementById('txtclientcatdisc').value + '&txtclientcatam=' + document.getElementById('txtclientcatam').value, 'Ankur1', 'toolbar=0,resizable=0,top=244,left=210,scrollbars=yes,width=580px,height=300px');
        win.focus();
        return false;
    }

}
function getsplcharge() {
    if (document.getElementById('hiddenspecharges').value != "") {
        var billamt = 0;
        var grossamtTotal = 0;
        var grossamt_var = document.getElementById('txttotalamt');
        var br_spcharge = 0;
        var splcharges = document.getElementById('hiddenspecharges').value;
        var grossAmt = grossamt_var.value;
        var len = "bookdiv";
        var ratio = 0;
        var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
        for (var s = 0; s < count; s++) {
            var gross_var = document.getElementById('gro' + s);
            var bill_var = document.getElementById('ba' + s);
            var insertsta = document.getElementById("inssta" + s);
            if (gross_var != null) {
                if (s == count - 1) {
                    if (insertsta.value != "billed")
                        gross_var.value = (parseFloat(gross_var.value) + (parseFloat(splcharges) - parseFloat(br_spcharge))).toFixed(2);
                    // bill_var.value = (parseFloat(bill_var.value) + (parseFloat(splcharges)-parseFloat(br_spcharge))).toFixed(2);
                    // trade disc
                    var tradisc = tradedisc;
                    if (document.getElementById('chktrade').checked == false)
                        tradisc = 0;
                    if (tradisc == "")
                        tradisc = 0;
                    var trdisc1 = tradisc;
                    var addcomm = 0;

                    if (addcomm != "0") {
                        trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                    }
                    if (insertsta.value != "billed")
                        bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);
                    if (parseFloat(gross_var.value) < 0) {
                        if (document.getElementById('gro0') != null && document.getElementById('gro0').value != "") {
                            if (document.getElementById('inssta0').value != "billed")
                                document.getElementById('gro0').value = (parseFloat(document.getElementById('gro0').value) + parseFloat(gross_var.value)).toFixed(2); ;
                        }
                        if (insertsta.value != "billed")
                            gross_var.value = 0;
                    }
                    if (document.getElementById('inssta' + s).value == "cancel" || document.getElementById('pai' + s).value == "N") {
                        if (insertsta.value != "billed")
                            gross_var.value = 0;
                    }
                    if (parseFloat(bill_var.value) < 0) {
                        if (document.getElementById('ba0') != null && document.getElementById('ba0').value != "") {
                            if (document.getElementById('inssta0').value != "billed")
                                document.getElementById('ba0').value = (parseFloat(document.getElementById('ba0').value) + parseFloat(bill_var.value)).toFixed(2);
                        }
                        if (insertsta.value != "billed")
                            bill_var.value = 0;
                    }

                    if (document.getElementById('hiddenbooktype').value == "2" || document.getElementById('hiddenbooktype').value == "4" || document.getElementById('hiddenbooktype').value == "5" || document.getElementById('inssta' + s).value == "cancel" || document.getElementById('pai' + s).value == "N") {
                        if (insertsta.value != "billed")
                            bill_var.value = 0;
                    }
                    billamt = parseFloat(billamt) + parseFloat(bill_var.value);
                    billamt = parseFloat(billamt).toFixed(2)
                    grossamtTotal = parseFloat(grossamtTotal) + parseFloat(gross_var.value);
                    grossamtTotal = parseFloat(grossamtTotal).toFixed(2)
                }
                else {
                    ratio = (parseFloat(gross_var.value) * parseFloat(splcharges)) / parseFloat(grossAmt)
                    gross_var.value = (parseFloat(gross_var.value) + parseFloat(ratio)).toFixed(2);
                    //  bill_var.value = (parseFloat(bill_var.valuse) + parseFloat(ratio)).toFixed(2);
                    // trade disc
                    var tradisc = tradedisc;
                    if (document.getElementById('chktrade').checked == false)
                        tradisc = 0;
                    if (tradisc == "")
                        tradisc = 0;
                    var trdisc1 = tradisc;
                    var addcomm = 0;

                    if (addcomm == "") {
                        addcomm = "0";
                    }
                    if (addcomm != "0") {
                        trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                    }
                    if (insertsta.value != "billed")
                        bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);
                    if (document.getElementById('inssta' + s).value == "cancel" || document.getElementById('pai' + s).value == "N") {
                        if (insertsta.value != "billed") {
                            gross_var.value = 0;
                            bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);
                        }
                    }
                    if (document.getElementById('hiddenbooktype').value == "2" || document.getElementById('hiddenbooktype').value == "4" || document.getElementById('hiddenbooktype').value == "5" || document.getElementById('inssta' + s).value == "cancel" || document.getElementById('pai' + s).value == "N") {
                        if (insertsta.value != "billed")
                            bill_var.value = 0;
                    }
                    billamt = parseFloat(billamt) + parseFloat(bill_var.value);
                    billamt = parseFloat(billamt).toFixed(2);
                    grossamtTotal = parseFloat(grossamtTotal) + parseFloat(gross_var.value);
                    grossamtTotal = parseFloat(grossamtTotal).toFixed(2)
                    br_spcharge = (parseFloat(br_spcharge) + parseFloat(ratio)).toFixed(2);
                    //                if(splcharges!="" && splcharges!="0" && document.getElementById('inssta'+s).value=="cancel" && br_spcharge==0)
                    //               {
                    //                   var br_spcharge1 = parseFloat(splcharges)/parseFloat(count);
                    //                   splcharges=parseFloat(splcharges) - parseFloat(br_spcharge1);
                    //                }
                }
            }
        }
        grossamt_var.value = (parseFloat(grossamt_var.value) + parseFloat(splcharges)).toFixed(2);
        if (billamt != "" && billamt != "0")
            document.getElementById('txtgrossamt').value = parseFloat(billamt).toFixed(2);
        if (grossamtTotal != "" && grossamtTotal != "0")
            document.getElementById('txttotalamt').value = parseFloat(grossamtTotal).toFixed(2);
    }

}

function getspecialdisc() {
    var spacedisc = document.getElementById('hiddenspediscper').value;
    if (document.getElementById('hiddenuserdisc').value != "" && document.getElementById('hiddenuserdisc').value != "0") {
        if (parseFloat(spacedisc) > parseFloat(document.getElementById('hiddenuserdisc').value)) {
            alert("User Allowed special Discount can't be greater than " + document.getElementById('hiddenuserdisc').value);
            //            document.getElementById('txtspediscper').value = document.getElementById('txtbillamtlocal').value "";
            //            document.getElementById('txtspedisc').value = "";
            document.getElementById('txttotalamt').value = "";
            document.getElementById('txtgrossamt').value = "";
            //document.getElementById('txtgrossamtlocal').value = "";
            //document.getElementById('txtbillamtlocal').value = "";
            return false;
        }

    }
    var totalarea_var = document.getElementById('txttotalarea').value;
    br_spcharge = 0;
    var billAmount = 0;
    var pkg_copy = document.getElementById('drppackagecopy');
    var cardrate = document.getElementById('txtcardrate').value;

    if (document.getElementById('hiddenspedisc').value != "" || document.getElementById('hiddenspediscper').value != "") {
        var paidCount = document.getElementById('txtinsertion').value;
        var finsert = 1;
        var tinsert = 0;
        var br_spcharge = 0;
        //document.getElementById('txtgrossamt').value = "";
        if (pkg_copy.options.length > 0) {
            for (var insertCou = 0; insertCou < pkg_copy.options.length; insertCou++) {
                if (pkg_copy.options[insertCou].value.indexOf('(') >= 0) {
                    tinsert = pkg_copy.options[insertCou].value.substring(pkg_copy.options[insertCou].value.indexOf('(') + 1, pkg_copy.options[insertCou].value.indexOf(')'));
                    if (parseInt(tinsert) > parseInt(finsert)) {
                        finsert = tinsert;
                    }
                    paidCount = parseInt(paidCount) * parseInt(tinsert);
                }
            }
        }
        var splcharges = document.getElementById('hiddenspedisc').value;
        var grossAmt = (parseFloat(cardrate) - parseFloat(splcharges)) * parseInt(paidCount, 10) * parseFloat(document.getElementById('txttotalarea').value);
        if (document.getElementById('hiddenspedisc').value != "") {
            var len = "bookdiv";
            var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
            for (var s = 0; s < count; s++) {
                var gross_var = document.getElementById('gro' + s);
                var bill_var = document.getElementById('ba' + s);
                var insertsta = document.getElementById("inssta" + s);
                var splcharges_grid = (parseFloat(document.getElementById('card' + s).value) / parseFloat(document.getElementById('txtcardrate').value)) * splcharges;
                if (gross_var != null && document.getElementById("inssta" + s).value != "cancel" && document.getElementById("pai" + s).value != "N") {
                    if (insertsta.value != "billed")
                        gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid))).toFixed(2);
                    //  gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid)*parseFloat(totalarea_var))).toFixed(2);    
                    //  bill_var.value = (parseFloat(bill_var.value) - (parseFloat(splcharges_grid)*parseFloat(totalarea_var))).toFixed(2);                      
                    // trade disc
                    var tradisc = tradedisc;
                    if (document.getElementById('chktrade').checked == false)
                        tradisc = 0;
                    if (tradisc == "")
                        tradisc = 0;
                    var trdisc1 = tradisc;
                    var addcomm = 0;

                    if (addcomm == "") {
                        addcomm = "0";
                    }
                    if (addcomm != "0") {
                        trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                    }
                    if (insertsta.value != "billed")
                        bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);

                    br_spcharge = (parseFloat(br_spcharge) + parseFloat(gross_var.value)).toFixed(2);
                    billAmount = (parseFloat(billAmount) + parseFloat(bill_var.value)).toFixed(2);
                }
            }
        }


        /*if (document.getElementById('hiddenspediscper').value != "") {
        //  var br_spcharge=0;
        var splcharges = document.getElementById('hiddenspediscper').value;
        var grossAmt = document.getElementById('txtgrossamt').value;
        var len = "bookdiv";
        var ratio = 0;
        var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
        for (var s = 0; s < count; s++) {
        var gross_var = document.getElementById('gro' + s);
        var bill_var = document.getElementById('ba' + s);
        var insertsta = document.getElementById("inssta" + s);
        if (gross_var != null && document.getElementById("inssta" + s).value != "cancel") {
        //                    if(s==count-1)
        //                    {
        //                        document.getElementById('gro'+s).value = (parseFloat(document.getElementById('gro'+s).value) - ((parseFloat(splcharges)*parseFloat(cardrate)/100)-parseFloat(br_spcharge))).toFixed(2);
        //                    }
        //                    else
        //                    {
        //                       ratio = (parseFloat(document.getElementById('gro'+s).value) * (parseFloat(splcharges)*parseFloat(cardrate)*parseFloat(document.getElementById('txttotalarea').value)/100) / parseFloat(grossAmt))
        //if (document.getElementById('txtclientcatam').value == "" || document.getElementById('txtclientcatam').value == "0" || document.getElementById('txtclientcatam').value == 0) {
        //    var splcharges_grid = (parseFloat(document.getElementById('card' + s).value) * splcharges) / 100;
        //}
        //else {
        splcharges_grid = (parseFloat(document.getElementById('gro' + s).value) * splcharges) / 100;
        //}
        if (gross_var != null && document.getElementById("inssta" + s).value != "cancel" && document.getElementById("pai" + s).value != "N") {
        if (insertsta.value != "billed") {
        var uom_cod = document.getElementById('drpuom').value;
        if (uom_cod == "CL0") {
        gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid) * parseFloat(totalarea_var))).toFixed(2);

        }
        else {
        gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid))).toFixed(2);
        }
        //bill_var.value = (parseFloat(bill_var.value) - (parseFloat(splcharges_grid)*parseFloat(totalarea_var))).toFixed(2);
        // trade disc
        }
        var tradisc = tradedisc; //document.getElementById('txttradedisc').value;
        if (document.getElementById('chktrade').checked == false)
        tradisc = 0;
        if (tradisc == "")
        tradisc = 0;
        var trdisc1 = tradisc;
        var addcomm = 0;

        if (addcomm == "") {
        addcomm = "0";
        }
        if (addcomm != "0") {
        trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
        }
        if (insertsta.value != "billed")
        bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);

        br_spcharge = (parseFloat(br_spcharge) + parseFloat(gross_var.value)).toFixed(2);
        billAmount = (parseFloat(billAmount) + parseFloat(bill_var.value)).toFixed(2);
        }
        //                    }  
        }
        }
        }*/
        /*if (br_spcharge == 0 && grossAmt != "" && grossAmt != NaN)
        br_spcharge = grossAmt;
        document.getElementById('txttotalamt').value = parseFloat(br_spcharge);
        if (document.activeElement.id == "txtspedisc" || document.activeElement.id == "txtspediscper")
        document.getElementById('txtgrossamt').value = "";
        //  if(billAmount!=0)
        document.getElementById('txtgrossamt').value = parseFloat(billAmount).toFixed(2);*/

    }


}
function bindrategroupvode(adcat) {
    QBC.bindratecodecenterwise(adcat, document.getElementById('hiddencompcode').value, document.getElementById('txtbranch').value, document.getElementById('txtdatetime').value, document.getElementById('hiddendateformat').value, document.getElementById('drpuom').value, call_bindrategroupvode);
    // QBC.bindratecode(adcat, document.getElementById('hiddencompcode').value, document.getElementById('txtinsertion').value, call_bindrategroupvode);
    return false;
}
function call_bindrategroupvode(response) {
    var ds = response.value;
    var pkgitem = document.getElementById("drpratecode");
    pkgitem.options.length = 0;
    pkgitem.options[0] = new Option("-Select", "0");
    if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {


        //alert(pkgitem);


        //alert(pkgitem.options.length);
        pkgitem.options.length = 1;
        for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].rate_mast_code, ds.Tables[0].Rows[i].rate_mast_code);

            pkgitem.options.length;

        }
        pkgitem.value = ds.Tables[0].Rows[0].rate_mast_code;
    }
    var resd = QBC.bindcatcher(document.getElementById("drpadcategory").value, document.getElementById('hiddencompcode').value);
    var ds = resd.value;
    var pkgitem = document.getElementById("drpbullet");
    pkgitem.options.length = 0;
    pkgitem.options[0] = new Option("-Select", "0");
    if (ds != null && typeof (ds) == "object" && ds.Tables[1].Rows.length > 0) {
        pkgitem.options.length = 1;
        for (var i = 0; i < ds.Tables[1].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[1].Rows[i].Bullet_Desc, ds.Tables[1].Rows[i].Bullet_Code);

            pkgitem.options.length;
        }

    }
    if (document.getElementById("drpratecode").options.length == 2)
        document.getElementById("drpratecode").options[1].selected = true;
    document.getElementById('hiddenratecode').value = document.getElementById("drpratecode").value;

}
function rateRefresh() {
    document.getElementById('txtgrossamt').value = "";
    document.getElementById('txttotalamt').value = "";
}
function setButtonImages() {
    if (document.getElementById('btnNew').disabled == true)
        document.getElementById('btnNew').src = "btimages/new-off.jpg";
    else
        document.getElementById('btnNew').src = "btimages/new.jpg";

    if (document.getElementById('btnSave').disabled == true)
        document.getElementById('btnSave').src = "btimages/save-off.jpg";
    else
        document.getElementById('btnSave').src = "btimages/save.jpg";

    if (document.getElementById('btnModify').disabled == true)
        document.getElementById('btnModify').src = "btimages/modify-off.jpg";
    else
        document.getElementById('btnModify').src = "btimages/modify.jpg";

    if (document.getElementById('btnQuery').disabled == true)
        document.getElementById('btnQuery').src = "btimages/query-off.jpg";
    else
        document.getElementById('btnQuery').src = "btimages/query.jpg";

    if (document.getElementById('btnExecute').disabled == true)
        document.getElementById('btnExecute').src = "btimages/execute-off.jpg";
    else
        document.getElementById('btnExecute').src = "btimages/execute.jpg";

    if (document.getElementById('btnCancel').disabled == true)
        document.getElementById('btnCancel').src = "btimages/clear-off.jpg";
    else
        document.getElementById('btnCancel').src = "btimages/clear.jpg";

    if (document.getElementById('btnfirst').disabled == true)
        document.getElementById('btnfirst').src = "btimages/first-off.jpg";
    else
        document.getElementById('btnfirst').src = "btimages/first.jpg";

    if (document.getElementById('btnprevious').disabled == true)
        document.getElementById('btnprevious').src = "btimages/previous-off.jpg";
    else
        document.getElementById('btnprevious').src = "btimages/previous.jpg";

    if (document.getElementById('btnnext').disabled == true)
        document.getElementById('btnnext').src = "btimages/next-off.jpg";
    else
        document.getElementById('btnnext').src = "btimages/next.jpg";

    if (document.getElementById('btnlast').disabled == true)
        document.getElementById('btnlast').src = "btimages/last-off.jpg";
    else
        document.getElementById('btnlast').src = "btimages/last.jpg";

    if (document.getElementById('btnDelete').disabled == true)
        document.getElementById('btnDelete').src = "btimages/delete-off.jpg";
    else
        document.getElementById('btnDelete').src = "btimages/delete.jpg";

    if (document.getElementById('btnExit').disabled == true)
        document.getElementById('btnExit').src = "btimages/exit-off.jpg";
    else
        document.getElementById('btnExit').src = "btimages/exit.jpg";
}
function opensplitedition(edition, idnum) {
    var size = "siz" + idnum;
    var insertsta = "inssta" + idnum;
    showid = "sho" + idnum;
    var showidval = "";
    if (document.getElementById(showid) != null)
        showidval = document.getElementById(showid).value;
    if (showidval == "") {
        showid = "spltdata" + idnum;
        showidval = document.getElementById(showid).value;
    }
    if (document.getElementById(size) != null && document.getElementById(size).value != "") {
        window.open('spliteditionsize.aspx?cioid=' + document.getElementById('txtciobookid').value + '&showid=' + showidval + '&insertstatus=' + document.getElementById(insertsta).value + '&chkbtnStatus=' + chkbtnStatus + '&totalarea=' + document.getElementById(size).value + '&idnum=' + idnum + '&dateformat=' + document.getElementById('hiddendateformat').value + '&edition=' + edition + '&receiptno=' + document.getElementById('txtreceipt').value, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=144,left=210,width=560px,height=300px');
    }
    else {
        alert("ToTal Area can't be blank");
        return false;
    }
}
function getfocusPackage(obj) {
    var idfoc = obj.id;
    if (idfocus != "") {
        document.getElementById(idfocus).style.backgroundColor = "";
    }
    document.getElementById(idfoc).style.backgroundColor = "#FFFF80";

    idfocus = obj.id;
    with (obj.style) {
        left = obj.offsetLeft;
        top = obj.offsetTop;
        width = "280px"
        // position="absolute";

    }
}
function lostfocusPackage(obj) {
    with (obj.style) {
        left = obj.offsetLeft;
        top = obj.offsetTop;
        width = "180px"
        // position="absolute";

    }
}
function openPubPrecentage() {
    var objpack = document.getElementById('drppackagecopy');
    var temp = "";
    // var tempcode="";
    var tempval = "";
    ///  var tempvalcode="";
    //var desc="";
    var code = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (code != "") {
                temp = tempval.split("@");
                //tempvalcode=temp[0];
                //tempcode=temp[1];
                code = temp[0] + "," + code;
                // desc=tempcode+","+desc;
            }
            else {
                temp = tempval.split("@");
                // tempvalcode=temp[0];
                //tempcode=temp[1];
                code = temp[0];
                //desc=tempcode;
            }
        }
    }
    code = code.replace("+", "~");
    var insertstatus = 0;
    if (document.getElementById('drpratecode').disabled == true)
        insertstatus = 1;
    window.open('booking_sharepub.aspx?agreedamt=0&sharepub=' + sharepub + '&insertstatus=' + insertstatus + '&package=' + code + '&cioid=' + document.getElementById('txtciobookid').value + '&compcode=' + document.getElementById('hiddencompcode').value, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=144,left=210,width=300px,height=300px');

    return false;
}
function getSharing() {
    sharepub = "";
    var res = QBC.getPubSharing("", document.getElementById('hiddencompcode').value, document.getElementById('txtciobookid').value);
    if (res.error != null) {
        alert(res.error.description);
        return false;
    }
    var ds = res.value;
    if (ds != null) {
        for (var i = 0; i < ds.Tables[0].Rows.length; i++) {
            if (sharepub == "")
                sharepub = ds.Tables[0].Rows[i].PUBLICATION + "~" + ds.Tables[0].Rows[i].SHARING + "~" + ds.Tables[0].Rows[i].TYPE;
            else
                sharepub = sharepub + "$" + ds.Tables[0].Rows[i].PUBLICATION + "~" + ds.Tables[0].Rows[i].SHARING + "~" + ds.Tables[0].Rows[i].TYPE;
        }
    }
}
function getFMGRef() {
    fmgInsert = "";
    fmgsize = "";
    fmgInsert = "";
    var res = QBC.fetchFMGrefID(document.getElementById('txtciobookid').value);
    if (res.error != null) {
        alert(res.error.description);
        return false;
    }
    var ds = res.value;
    if (ds != null) {
        for (var i = 0; i < ds.Tables[0].Rows.length; i++) {
            if (fmgInsert == "")
                fmgInsert = ds.Tables[0].Rows[i].INSERTID;
            else
                fmgInsert = fmgInsert + "$" + ds.Tables[0].Rows[i].INSERTID;

            if (fmgsize == "")
                fmgsize = ds.Tables[0].Rows[i].Size_Book;
            //        else
            // fmgsize = fmgsize + "$" + ds.Tables[0].Rows[i].Size_Book;

            if (fmgcolor == "")
                fmgcolor = ds.Tables[0].Rows[i].Col_Code;
            //        else
            // fmgcolor = fmgcolor + "$" + ds.Tables[0].Rows[i].Col_Code;     
        }
    }
}
function openFMGRef() {
    var agencycode = "";
    if (document.getElementById('txtagency').value != "")
        agencycode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf("(") + 1, document.getElementById('txtagency').value.lastIndexOf(")"));
    var win = window.open('fmg_transaction.aspx?fmgInsert=' + fmgInsert + '&agencycode=' + agencycode, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=144,left=210,width=600px,height=600px');
    win.focus();
    return false;
}
function days_between(date11, date22) {

    // The number of milliseconds in one day
    var date1 = new Date(date11);
    var date2 = new Date(date22);
    var ONE_DAY = 1000 * 60 * 60 * 24

    // Convert both dates to milliseconds
    var date1_ms = date1.getTime()
    var date2_ms = date2.getTime()

    // Calculate the difference in milliseconds
    var difference_ms = Math.abs(date1_ms - date2_ms)

    // Convert back to days and return
    return Math.round(difference_ms / ONE_DAY)

}
function getBigDate(pfdate, pldate, dateformat, flag) {
    var pfdate1 = pfdate;
    var pldate1 = pldate;
    if (dateformat == "dd/mm/yyyy") {
        if (pfdate != "") {
            var txt = pfdate;
            var txt1;

            txt1 = txt.split("/");


            var dd = txt1[0];
            var mm1 = txt1[1];
            var mm;
            mm = mm1;
            var yy = txt1[2];
            pfdate = mm + '/' + dd + '/' + yy;
        }
        else {
            pfdate = pfdate;
        }

    }

    if (dateformat == "yyyy/mm/dd") {
        if (pfdate != "") {
            var txt = pfdate;
            var txt1 = txt.split("/");
            var yy = txt1[0];
            var mm = txt1[1];
            var dd = txt1[2];
            pfdate = mm + '/' + dd + '/' + yy;
        }
        else {
            pfdate = pfdate;
        }
    }

    if (dateformat == "mm/dd/yyyy") {
        pfdate = pfdate;
    }

    //For From Date Converssion /************************************************************/
    if (dateformat == "dd/mm/yyyy") {
        if (pldate != "") {
            var txt = pldate;
            var txt1 = txt.split("/");
            var dd = txt1[0];
            var mm = txt1[1];
            var yy = txt1[2];
            pldate = mm + '/' + dd + '/' + yy;
        }
        else {
            pldate = pldate;
        }

    }

    if (dateformat == "yyyy/mm/dd") {
        if (pldate != "") {
            var txt = pldate;
            var txt1 = txt.split("/");
            var yy = txt1[0];
            var mm = txt1[1];
            var dd = txt1[2];
            pldate = mm + '/' + dd + '/' + yy;
        }
        else {
            pldate = pldate;
        }
    }

    if (dateformat == "mm/dd/yyyy") {
        pldate = pldate;
    }
    var date1 = new Date(pfdate);
    var date2 = new Date(pldate);
    if (flag == "min") {
        if (date1 < date2) {
            return pfdate1;
        }
        else {
            return pldate1;
        }
    }
    else {
        if (date1 > date2) {
            return pfdate1;
        }
        else {
            return pldate1;
        }
    }
    //
}
function autogeneratedtempid() {

    // var res = Booking_master.getBookingIdNo(document.getElementById('hiddencompcode').value, auto, no, document.getElementById('txtciobookid').value);
    var res = QBC.gettempBookingIdNo(document.getElementById('hiddencompcode').value);
    var da = res.value;
    if (da == null) {
        alert(res.error.description);
        return false;
    }
    if (da.Tables[0].Rows.length > 0 && da.Tables[0].Rows[0].ID != "") {
        var ab = da.Tables[0].Rows[0].ID;
        var cou1 = parseInt(ab, 10);
        var countlen = cou1.toString().length;
        if (countlen == 1) {
            zeros = "0000000" + cou1;
        }
        else if (countlen == 2) {
            zeros = "000000" + cou1;
        }
        else if (countlen == 3) {
            zeros = "00000" + cou1;
        }
        else if (countlen == 4) {
            zeros = "0000" + cou1;
        }
        else if (countlen == 5) {
            zeros = "000" + cou1;
        }
        else if (countlen == 6) {
            zeros = "00" + cou1;
        }
        else if (countlen == 7) {
            zeros = "0" + cou1;
        }
        else if (countlen == 8) {
            zeros = "0" + cou1;
        }

        document.getElementById('txtciobookid').value = zeros;
    }

}

function openattach1() {
    if (document.getElementById('txtclient').disabled == false)
        window.open('approvalAttachment.aspx?filename=' + document.getElementById('hidattach1').value, 'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=144,left=210,width=350px,height=300px');
    return false;
}
///this function is to chk or unchk the cliend and agency address chk box in the box details tab
function agencychk() {
    if (document.getElementById('chkage').checked == true) {
        document.getElementById('chkclie').checked = false;
        document.getElementById('txtboxadd').value = "";
        document.getElementById('txtboxadd').value = document.getElementById('txtagencyaddress').value;
        //document.getElementById('txtboxaddress').disabled=true;
    }
    if (document.getElementById('chkage').checked == false) {
        document.getElementById('txtboxadd').value = "";
        //document.getElementById('txtboxaddress').disabled=false;
    }


}
function clientchk() {
    if (document.getElementById('chkclie').checked == true) {
        document.getElementById('chkage').checked = false;
        document.getElementById('txtboxadd').value = "";
        document.getElementById('txtboxadd').value = document.getElementById('txtclientadd').value;
    }
    if (document.getElementById('chkclie').checked == false) {
        document.getElementById('txtboxadd').value = "";
    }

}

function showdealvalue() {

    //    if (document.getElementById('drpscheme').value != "") {
    //        alert("Scheme or contract can be choosen");
    //        return false;
    //    }
    if (document.getElementById('txtagency').value == "") {
        alert("Please Select The Agency")
        return false;
    }
    var dealtype = document.getElementById('hiddentype').value
    var agency = document.getElementById('txtagency').value
    var agencysplit = "";
    if (agency != "") {
        var agencyarr = agency.split("(");
        agencysplit = agencyarr[1];
        agencysplit = agencysplit.replace(")", "");
    }

    var res = null;
    res = QBC.getAgencyCode(document.getElementById('hiddencompcode').value, agencysplit);
    var subagency = res.value;

    //    var subagency = document.getElementById('drpagscode').value;
    var client = document.getElementById('txtclient').value;
    var clientsplit = "";
    if (client != "") {
        var clientarr = client.split("(");
        clientsplit = clientarr[1];
        if (clientsplit != undefined) {
            clientsplit = clientsplit.replace(")", "");
        }
        else {
            clientsplit = "0";
        }
    }
    var bookingdate = document.getElementById('txtdummydate').value;
    var color = document.getElementById('drpcolor').value;
    var curr = document.getElementById('hiddencurrency').value;
    var adcat = document.getElementById('drpadcategory').value;
    var compcode = document.getElementById('hiddencompcode').value

    var product = "";
    var clientarr = product.split("(");
    var prod = clientarr[1];
    if (prod != undefined) {
        prod = prod.replace(")", "");
    }
    else {
        prod = "0";
    }
    var col = document.getElementById('drpcolor').value
    var adtype = document.getElementById('drpadtype').value;
    //var pkg_code=document.getElementById('drpcolor').value

    var objpack = document.getElementById('drppackagecopy');
    var temp = "";
    var tempcode = "";
    var tempval = "";
    var tempvalcode = "";
    var desc = "";
    var code = "";
    var i = objpack.options.length;
    var j;

    for (j = 0; j < i; j++) {
        if (parseInt(i) > 0) {
            tempval = objpack[j].value;
            //tempvalcode=objpack[j].value;
            if (temp != "") {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode + "," + code;
                desc = tempcode + "," + desc;


            }
            else {
                temp = tempval.split("@");
                tempvalcode = temp[0];
                tempcode = temp[1];
                code = tempvalcode;
                desc = tempcode;
            }
        }

    }
    var rate_cod = "0";

    //alert(document.getElementById('drpcurrency').style.visibility);
    document.getElementById('divdeal').innerHTML = "";
    //tdpck

    //  document.getElementById('divdeal').style.top=parseInt(document.getElementById('txtpaid').offsetTop) +  parseInt(document.getElementById('tdpck').offsetTop)+ parseInt(document.getElementById('OuterTable').offsetTop) + 328;
    //   document.getElementById('divdeal').style.left=parseInt(document.getElementById('txtpaid').offsetLeft) +   parseInt(document.getElementById('tdpck').offsetLeft) +12;
    aTag = eval(document.getElementById("txttotalarea"))
    var btag;
    var leftpos = 0;
    var toppos = 0;
    do {
        aTag = eval(aTag.offsetParent);
        leftpos += aTag.offsetLeft;
        toppos += aTag.offsetTop;
        btag = eval(aTag)
    } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
    document.getElementById('divdeal').style.top = document.getElementById("txttotalarea").offsetTop + toppos + "px";
    // document.getElementById('divdeal').style.left=document.getElementById("drppackage").offsetLeft + leftpos+"px";
    document.getElementById('divdeal').style.left = document.getElementById("txttotalarea").offsetLeft + (leftpos + 186) + "px";
    //when value is 0 than we bind the list box and when it is 1 than we calculate the discount
    QBC.binddealtype(compcode, agencysplit, subagency, bookingdate, color, curr, adcat, clientsplit, prod, col, code, rate_cod, adtype, document.getElementById('hiddendateformat').value, call_binddealtype);

    return false;

}

function call_binddealtype(res) {
    var ds = res.value;
    var dealstr;
    var str;

    if (ds.Tables[0] != undefined && ds != null && ds.Tables[0].Rows.length > 0) {


        document.getElementById("divdeal").style.display = "block";
        //                    document.getElementById('lbcoupan').style.visibility="hidden";
        //                    document.getElementById('chkcoupan').style.visibility="hidden";
        //                    document.getElementById('drppackage').style.visibility="hidden";
        //                    document.getElementById('lbpackage').style.visibility="hidden";
        //                    document.getElementById('drppackage').style.visibility="hidden";
        //                    document.getElementById('drppackagecopy').style.visibility="hidden";
        //                    document.getElementById('btncopy').style.visibility="hidden";
        //                    document.getElementById('btndel').style.visibility="hidden";
        //                    document.getElementById('Img3').style.visibility="hidden";
        //                    ///document.getElementById('dealdivscroll').style.display="none"; 
        //                    document.getElementById('lbselectdate').style.visibility="hidden";
        //                    document.getElementById('txtdummydate').style.visibility="hidden";
        //                    document.getElementById('lbad').style.visibility="hidden";
        //                    document.getElementById('chktfn').style.visibility="hidden";
        //                      document.getElementById('lbcurrency').style.visibility="hidden";
        //                    document.getElementById('drpcurrency').style.visibility="hidden";
        //                 //   document.getElementById('drppackage').style.visibility="hidden";
        //                    document.getElementById('drppackagecopy').style.visibility="hidden";
        //                    document.getElementById('drpcurrency').style.visibility="hidden";
        ///////////////////////////////////////////////////////////////////
        var srcimg = "Images\\close.gif";
        dealstr = "<div style=\"OVERFLOW: auto; Position: absolute; WIDTH: 465px; HEIGHT: 100px;\"><table cellpadding=\"0\" cellspacing=\"0\" id=\"griddeal\" width=\"440px\" border=1><tr bgcolor=\"#7DAAE3\" class=\"dtGridHd12\"><td align=\"center\" valign=\"top\" ><img id=\"close\" src=" + srcimg + " style=\"cursor:pointer;\" onclick=\"javascript:return closedeal();\"/></td><td align=\"center\" valign=\"top\" >Code</td><td valign=\"top\" align=\"center\" width=\"100px\">Contract Code</td><td align=\"center\" valign=\"top\" width=\"100px\">Deal Rate</td><td align=\"center\" valign=\"top\" width=\"100px\">Deal Name</td><td align=\"center\" valign=\"top\" width=\"100px\">Contract Name</td><td align=\"center\" valign=\"top\">Valid Till</td></tr>";
        for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
            if (ds.Tables[0].Rows[i].code != null) {
                str = "chk" + i;
                dealstr = dealstr + "<tr bgcolor=\"#f3f6fd\"><td id=" + ds.Tables[0].Rows[i].code + " class=\"TextField\"><input type='checkbox' style=\"top:0px\" width='5px' id=" + str + "  onclick=\"javascript:return getdealrate(" + ds.Tables[0].Rows[i].code + ",'" + ds.Tables[0].Rows[i].dealname + "','" + ds.Tables[0].Rows[i].contractname + "');\"  /></td><td class=\"TextField\">" + ds.Tables[0].Rows[i].code + "</td><td class=\"TextField\">" + ds.Tables[0].Rows[i].contractcode + "</td><td class=\"TextField\">" + ds.Tables[0].Rows[i].deal_rate + "</td>";
                dealstr = dealstr + "<td class=\"TextField\">" + ds.Tables[0].Rows[i].dealname + "</td><td class=\"TextField\">" + ds.Tables[0].Rows[i].contractname + "</td><td class=\"TextField\">" + ds.Tables[0].Rows[i].todate + "</td>";
            }

        }

        dealstr = dealstr + "</tr></table></div>";
        document.getElementById('divdeal').innerHTML = dealstr;





    }
    else {
        alert("On this Contract Rate doesnot exists");
        document.getElementById("divdeal").style.display = "none";
        //        document.getElementById('lbcoupan').style.visibility = "visible";
        //        document.getElementById('chkcoupan').style.visibility = "visible";
        //        document.getElementById('drppackage').style.visibility = "visible";
        //        document.getElementById('lbpackage').style.visibility = "visible";
        //        document.getElementById('drppackage').style.visibility = "visible";
        //        document.getElementById('drppackagecopy').style.visibility = "visible";
        //        document.getElementById('btncopy').style.visibility = "visible";
        //        document.getElementById('btndel').style.visibility = "visible";
        //        document.getElementById('Img3').style.visibility = "visible";
        //        //  document.getElementById('dealdivscroll').style.display="block";
        //        document.getElementById('lbselectdate').style.visibility = "visible";
        //        document.getElementById('txtdummydate').style.visibility = "visible";
        //        document.getElementById('lbad').style.visibility = "visible";
        //        document.getElementById('chktfn').style.visibility = "visible";
        //        document.getElementById('lbcurrency').style.visibility = "visible";
        //        document.getElementById('lbrptcurrency').style.visibility = "visible";
        //        document.getElementById('drpcurrency').style.visibility = "visible";
        //        document.getElementById('drprptcurrency').style.visibility = "visible";
        //document.getElementById('tblpackage').style.display="block";
        return false;

    }
    //   fillrateintogrid();



}
function closedeal() {
    document.getElementById("divdeal").style.display = "none";
    //    document.getElementById('lbcoupan').style.visibility = "visible";
    //    document.getElementById('chkcoupan').style.visibility = "visible";
    //    document.getElementById('drppackage').style.visibility = "visible";
    //    document.getElementById('lbpackage').style.visibility = "visible";
    //    document.getElementById('drppackage').style.visibility = "visible";
    //    document.getElementById('drppackagecopy').style.visibility = "visible";
    //    document.getElementById('btncopy').style.visibility = "visible";
    //    document.getElementById('btndel').style.visibility = "visible";
    //    document.getElementById('Img3').style.visibility = "visible";
    //    //    document.getElementById('dealdivscroll').style.display="block";
    //    document.getElementById('lbselectdate').style.visibility = "visible";
    //    document.getElementById('txtdummydate').style.visibility = "visible";
    //    document.getElementById('lbad').style.visibility = "visible";
    //    document.getElementById('chktfn').style.visibility = "visible";
    //    document.getElementById('lbcurrency').style.visibility = "visible";
    ////    document.getElementById('drpcurrency').style.visibility = "visible";
    //    document.getElementById('drprptcurrency').style.visibility = "visible";
    //document.getElementById('tblpackage').style.display="block";
    return false;
}
function getdealrate(val, detyp, conneme) {
    //document.getElementById('txtdealrate').value=document.getElementById('lstdealtype').value;
    hidcontract = val;
    document.getElementById('txtcontracttype').value = detyp;
    document.getElementById('txtcontractname').value = conneme;
    document.getElementById("divdeal").style.display = "none";
    //		  document.getElementById('lbcoupan').style.visibility="visible";
    //            document.getElementById('chkcoupan').style.visibility="visible";
    //            document.getElementById('drppackage').style.visibility="visible";
    //            document.getElementById('lbpackage').style.visibility="visible";
    //              document.getElementById('drppackage').style.visibility="visible";
    //            document.getElementById('drppackagecopy').style.visibility="visible";
    //            document.getElementById('btncopy').style.visibility="visible";
    //            document.getElementById('btndel').style.visibility="visible";
    //            document.getElementById('Img3').style.visibility="visible";
    //        //    document.getElementById('dealdivscroll').style.display="block";
    //            document.getElementById('lbselectdate').style.visibility="visible";
    //            document.getElementById('txtdummydate').style.visibility="visible";
    //            document.getElementById('lbad').style.visibility="visible";
    //            document.getElementById('chktfn').style.visibility="visible";
    //              document.getElementById('lbcurrency').style.visibility="visible";
    //            document.getElementById('drpcurrency').style.visibility="visible";

    var agency = document.getElementById('txtagency').value
    var agencyarr = agency.split("(");
    var agencysplit = agencyarr[1];
    agencysplit = agencysplit.replace(")", "");

    var res = null;
    res = QBC.getAgencyCode(document.getElementById('hiddencompcode').value, agencysplit);
    var subagency = res.value;
    var compcode = document.getElementById('hiddencompcode').value
    var dealcode = val;
    /////
    var client = document.getElementById('txtclient').value;
    var clientarr = client.split("(");
    var clientsplit = clientarr[1];
    if (clientsplit != undefined) {
        clientsplit = clientsplit.replace(")", "");
    }
    else {
        clientsplit = "0";
    }
    ///////

    QBC.allowdisc(dealcode, compcode, agencysplit, subagency, clientsplit, call_allowdisc);

    return false;

}
function call_allowdisc(res) {
    var ds = res.value;
    //
    if (ds.Tables[0].Rows.length > 0) {

        document.getElementById('txtdealrate').value = ds.Tables[0].Rows[0].resul
        document.getElementById('txtdeviation').value = ds.Tables[0].Rows[0].deviation;


        if (document.getElementById('txtcardrate').value != "") {
            document.getElementById('txtdeviation').value = parseFloat(document.getElementById('txtcardrate').value) - parseFloat(document.getElementById('txtdealrate').value);
        }
        //		                if(document.getElementById('txtgrossamt').value!="")
        //		                {
        //		                    getagrredamou();
        //		                }
        if (document.getElementById('tblinsert').innerHTML != "") {
            flagins = "0";
        }
        document.getElementById('txtgrossamt').value = "";


        //}
    }
    else {
        alert("On this Contract Rate doesnot exists");
        document.getElementById("divdeal").style.display = "none";
        return false;


    }


}


function bindContractRate() {
    var res = QBC.getDealP(document.getElementById('hiddencompcode').value, hidcontract);
    var ds = res.value;
    if (ds == null) {
        alert(res.error.description);
        return false;
    }
    var commallow = "";
    var dealstart = "";
    var dealagency = "";
    var dealclient = "";
    var dealamt = 0;
    var volbilled = "0";
    var voldisc = "0";
    var disctype = "";
    var discper = "0";
    var valuefrom = "";
    var valueto = "";
    var finalbil = 0;
    var finalgrs = 0;
    var insertion = "";
    var insertiondeal = 0;
    if (ds != null && ds.Tables[0].Rows.length > 0) {

        if (ds.Tables[0].Rows[0].COMMITION_ALLOW != null)
            commallow = ds.Tables[0].Rows[0].COMMITION_ALLOW;
        if (ds.Tables[0].Rows[0].DEAL_START != null)
            dealstart = ds.Tables[0].Rows[0].DEAL_START;
        if (ds.Tables[0].Rows[0].CODESUBCODE != null)
            dealagency = ds.Tables[0].Rows[0].CODESUBCODE;
        if (ds.Tables[0].Rows[0].CLIENTCODE != null)
            dealclient = ds.Tables[0].Rows[0].CLIENTCODE;
        if (ds.Tables[0].Rows[0].AMT != null)
            dealamt = ds.Tables[0].Rows[0].AMT;
        if (ds.Tables[0].Rows[0].VOLUMEBILLED != null)
            volbilled = ds.Tables[0].Rows[0].VOLUMEBILLED;
        if (ds.Tables[0].Rows[0].VOLUMEDISC != null)
            voldisc = ds.Tables[0].Rows[0].VOLUMEDISC;
        if (ds.Tables[0].Rows[0].DISCTYPE != null)
            disctype = ds.Tables[0].Rows[0].DISCTYPE;
        if (ds.Tables[0].Rows[0].DISCPER != null)
            discper = ds.Tables[0].Rows[0].DISCPER;
        if (ds.Tables[0].Rows[0].DISCPER != null)
            valuefrom = ds.Tables[0].Rows[0].VALUEFROM;
        if (ds.Tables[0].Rows[0].DISCPER != null)
            valueto = ds.Tables[0].Rows[0].VALUETO;
        if (ds.Tables[0].Rows[0].INSERTION != null)
            insertion = ds.Tables[0].Rows[0].INSERTION;
    }

    // if(disctype=="0")
    //  {
    var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
    var res1 = QBC.getDealAmt(document.getElementById('txtcontracttype').value, dealagency, dealclient, document.getElementById('hiddencompcode').value, hidcontract);
    var ds1 = res1.value;
    if (ds1 == null) {
        alert(res1.error.description);
        return false;
    }
    if (valuefrom != "" && valuefrom != "0" && valueto != "" && valueto != "0") {
        if (document.getElementById('txtcontracttype').value == "VALUE") {
            var amt = ds1.Tables[0].Rows[0].AMT;
            if (ds != null && ds.Tables[0].Rows.length > 0) {
                for (var i = 0; i < ds.Tables[0].Rows.length; i++) {
                    if (parseFloat(amt) >= parseFloat(ds.Tables[0].Rows[i].VALUEFROM) && parseFloat(amt) <= parseFloat(ds.Tables[0].Rows[i].VALUETO)) {
                        discper = ds.Tables[0].Rows[i].DISCPER;
                    }
                }
            }
        }
        else if (document.getElementById('txtcontracttype').value == "VALUE") {
            var amt = ds1.Tables[0].Rows[0].SIZEBOOK;
            if (ds != null && ds.Tables[0].Rows.length > 0) {
                for (var i = 0; i < ds.Tables[0].Rows.length; i++) {
                    if (parseFloat(amt) >= parseFloat(ds.Tables[0].Rows[i].VALUEFROM) && parseFloat(amt) <= parseFloat(ds.Tables[0].Rows[i].VALUETO)) {
                        discper = ds.Tables[0].Rows[i].DISCPER;
                    }
                }
            }
        }
    }
    if (ds1.Tables[0].Rows[0].INS != "0")
        insertiondeal = ds1.Tables[0].Rows[0].INS;
    var totsizeBook = 0;
    var MtotsizeBook = 0;
    if (ds1 != null && ds1.Tables[0].Rows.length > 0) {
        totsizeBook = ds1.Tables[0].Rows[0].SIZEBOOK;
        MtotsizeBook = totsizeBook;
    }
    if (parseFloat(MtotsizeBook) <= (parseFloat(volbilled) + parseFloat(voldisc)) || volbilled == "0") {
        if (dealstart == "A")// a means after target acheived and b means from starting
        {

            if (ds1 != null && ds1.Tables[0].Rows.length > 0) {
                if (parseFloat(dealamt) <= parseFloat(ds1.Tables[0].Rows[0].AMT)) {
                    dealstart = "B";
                }
            }
        }
        if (dealstart == "B" || dealstart == "") {
            var cspace = 0;
            var finsert = 1;
            var tinsert = 0;
            var paidCount = 0;
            var drppackage_vari = document.getElementById('drppackagecopy');
            if (drppackage_vari.options.length > 0) {
                for (var insertCou = 0; insertCou < drppackage_vari.options.length; insertCou++) {
                    if (drppackage_vari.options[insertCou].value.indexOf('(') >= 0) {
                        tinsert = drppackage_vari.options[insertCou].value.substring(drppackage_vari.options[insertCou].value.lastIndexOf('(') + 1, drppackage_vari.options[insertCou].value.lastIndexOf(')'));
                        if (parseInt(tinsert) > parseInt(finsert)) {
                            finsert = tinsert;
                        }
                        //paidCount = parseInt(paidCount) * parseInt(tinsert);
                        paidCount = parseInt(paidCount) + (parseInt(tinsert) * parseInt(document.getElementById('txtinsertion').value));
                    }
                }
            }
            finsert = parseInt(finsert) * parseInt(document.getElementById('txtinsertion').value);
            //            if ((finsert > insertion) || (insertiondeal >= insertion) || ((insertiondeal + parseFloat(finsert)) > insertion)) {
            //////                alert("Insertion is not match with Deal");
            //                document.getElementById('txtgrossamt').value = "";
            //                document.getElementById('txttotalamt').value = "";
            //                return false;
            //            }

            for (var i = 0; i < count; i++) {
                var billrate = document.getElementById("ba" + i);
                var grossrate = document.getElementById("gro" + i);
                var size = document.getElementById("siz" + i);
                var freespace = 0;
                totsizeBook = parseFloat(totsizeBook) + parseFloat(size.value);
                if (volbilled != "" && voldisc != "" && totsizeBook != '0' && volbilled != "0" && voldisc != "0") {

                    if (totsizeBook > volbilled) {
                        freespace = parseFloat(freespace) + (parseFloat(totsizeBook) - parseFloat(volbilled));
                    }
                }
                //            if (dealamt <= (parseFloat((parseFloat(document.getElementById('txtdealrate').value) * parseFloat(size.value))) - parseFloat((parseFloat(document.getElementById('txtdealrate').value) * parseFloat(size.value))) * parseFloat(discper) / 100)) {
                //                alert("Insertion is not match with Deal");
                //                document.getElementById('txtbillamt').value = "";
                //                document.getElementById('txtgrossamt').value = "";
                //                return false;
                //            }
                if (document.getElementById('txtdealrate').value != "" && document.getElementById('txtdealrate').value != "0") {
                    if (parseFloat(freespace) > parseFloat(volbilled) || parseFloat(freespace) == 0 || parseFloat(cspace) >= parseFloat(voldisc)) {
                        grossrate.value = parseFloat((parseFloat(document.getElementById('txtdealrate').value) * parseFloat(size.value)) / parseFloat(count / finsert));
                    }
                    else {
                        if (parseFloat(voldisc) == parseFloat(freespace))
                            grossrate.value = "0";
                        else {
                            if (parseFloat(freespace) > parseFloat(voldisc)) {
                                var sizeM = parseFloat(freespace) - parseFloat(voldisc);
                                cspace = parseFloat(cspace) + (parseFloat(size.value) - parseFloat(sizeM));
                                grossrate.value = parseFloat(document.getElementById('txtdealrate').value) * parseFloat(sizeM);
                            }
                            else {
                                var sizeM = parseFloat(size.value) - parseFloat(freespace);
                                cspace = parseFloat(cspace) + (parseFloat(size.value) - parseFloat(sizeM));
                                grossrate.value = parseFloat(document.getElementById('txtdealrate').value) * parseFloat(sizeM);
                            }
                        }
                    }
                }
                if (commallow == "N") {
                    if (disctype == "1" && discper != "" && discper != "0") {
                        var gross = parseFloat(grossrate.value);
                        gross = parseFloat(gross) - (parseFloat(gross) * parseFloat(discper) / 100);
                        billrate.value = gross;
                    }
                    else {
                        billrate.value = grossrate.value;
                    }
                }
                else {
                    var tradisc = tradedisc;
                    if (document.getElementById('chktrade').checked == false)
                        tradisc = 0;
                    if (tradisc == "")
                        tradisc = 0;
                    var trdisc1 = tradisc;
                    var addcomm = 0;
                    if (addcomm != null) {
                        if (document.getElementById('hiddenagcommflag').value != "1")
                            addcomm = addcomm;
                    }
                    if (addcomm == "") {
                        addcomm = "0";
                    }
                    if (addcomm != "0") {
                        trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                    }

                    var billamount = 0;
                    var gross = parseFloat(grossrate.value);
                    if ((disctype == "1" || disctype == "2") && discper != "" && discper != "0") {
                        gross = parseFloat(gross) - (parseFloat(gross) * parseFloat(discper) / 100);
                    }
                    billamount = parseFloat(gross) - (parseFloat(gross) * trdisc1 / 100);
                    billrate.value = billamount;
                }
                if (finalbil == 0)
                    finalbil = parseFloat(billrate.value);
                else
                    finalbil = parseFloat(finalbil) + parseFloat(billrate.value);
                if (finalgrs == 0)
                    finalgrs = parseFloat(gross);
                else
                    finalgrs = parseFloat(finalgrs) + parseFloat(gross);
            }
        }
    }
    //  }
    document.getElementById('txtgrossamt').value = finalbil;

    document.getElementById('txttotalamt').value = finalgrs;
}

function opentooltipratecode(event) {
    var compcode = document.getElementById('hiddencompcode').value;
    var ratecode = document.getElementById("drpratecode").value;

    var res = QBC.tolltipforratecode(compcode, ratecode);
    var ds = res.value;
    if (ds.Tables[0].Rows.length > 0) {
        document.getElementById("drpratecode").title = ds.Tables[0].Rows[0].REMARKS;
    }
    return false;
}
function alertContents(httpRequest) {

    if (httpRequest.readyState == 4) {
        if (httpRequest.status == 200) {
            //alert(httpRequest.responseText);
            s = httpRequest.responseText;
        } else {
            alert('There was a problem with the request.');
        }
    }

}




function scmename() {

    var adcat = document.getElementById('drpadcategory').value;

    var color = document.getElementById('drpcolor').value;
    var uom = document.getElementById('drpuom').value;
    //   var pkg = document.getElementById('drppackage').value;
    var pkg = document.getElementById('drppackagecopy').value;
    var strid1 = pkg.split('@');
    var pkgid = strid1[0];
    var pkgname = strid1[1];
    var bookingdate = "";
    document.getElementById('view19').innerHTML = "";
    document.getElementById("Divgrid1").style.display = "block";
    // $('tdback').style.display="block";
    var activeid = "btnschme";

    var divid = "Divgrid1";
    var id = activeid;
    aTag = eval(document.getElementById(activeid))
    var btag;
    var leftpos = 0;
    var toppos = 0;
    do {
        aTag = eval(aTag.offsetParent);
        leftpos += aTag.offsetLeft;
        toppos += aTag.offsetTop;
        btag = eval(aTag)
    } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");


    document.getElementById(divid).style.display = "block";
    document.getElementById(divid).style.top = document.getElementById(id).offsetHeight + toppos + "px";
    document.getElementById(divid).style.left = document.getElementById(id).offsetLeft + leftpos + "px";

    //    document.getElementById('Divgrid1').style.top = 250 + "px";
    //    document.getElementById('Divgrid1').style.left = 330 + "px";
    //    document.getElementById('Divgrid1').style.BackColor = "Ivory";

    //QBC.btnschme_Click(document.getElementById("hiddencompcode").value, document.getElementById("txtagenname").value.toUpperCase(), document.getElementById("hiddenuserid").value, document.getElementById("hiddendateformat").value, callback_allview)

    QBC.btnschme_Click(adcat, uom, pkgid, color, bookingdate, callback_allview)
    return false;
}
var valueType;
var rec_page_val = 5
var rec_shw_oth_val = 10
var check = true;
var next = 0;
var tot_page = 4


function callback_allview(res) {
    viewcolname = "";
    valueType;

    srt_count_0ther = 1;
    next = 0;
    dsexe = "";
    modiflag = 0;
    srt_count = 1
    record_show1 = 1
    record_show = rec_page_val
    record_show1_other1 = rec_shw_oth_val;
    record_show_other = rec_shw_oth_val;
    extra_record_other = 0;
    srt_count_0ther = 1;
    divres = "";

    if (res.error != null && res.error != undefined) {
        catch_error(1, 2)
        return false;
    }

    if (check == true) {
        var srt_count = 0
        if (res.value != undefined) {
            ds18 = res.value;
            dsexe = res.value;
        }
        else {
            ds18 = res;
            dsexe = res
        }
        check = false;

    }
    else {
        var srt_count = 0
        ds18 = "";

        if (res.value != undefined) {
            ds18 = res.value;
            dsexe = res.value;
        }
        else {
            ds18 = res;
            dsexe = res
        }
    }
    if (ds18 == null || ds18 == undefined || ds18.Tables[0] == null || ds18.Tables[0] == undefined) {
        catch_error(1, 2)
        return false;
    }
    row_count = ds18.Tables[0].Rows.length;
    var valnextval = 2
    pagenext(valnextval);

    var hdsview = "";
    var j = 1;
    var i = 0;

    if (ds18 != null && ds18.Tables[0].Rows.length > 0) {
        try {
            hdsview += "<table Width='435px' style='border:1px solid #7DAAE3;margin-top:0px;margin-bottom:1px;' cellpadding='0' cellspacing='0'>"
            hdsview += "<tr style='background-color:#7DAAE3'><td class='tabsHeaders1' >SNo</td>";
            hdsview += "<td id='view11' class='tabsHeaders1'  >Scheme Name</td>";
            hdsview += "<td id='view12' class='tabsHeaders1'  >Discount</td></tr>";
            //    hdsview += "<td id='view12' class='tabsHeaders1' >City</td></tr>";

            for (srt_count; srt_count < rec_shw_oth_val; srt_count++) {
                hdsview += "<tr>"
                hdsview += "<td width='30px' align='right' style='border:1px solid #7DAAE3;padding-right:3px;'>"
                hdsview += "<font style='font-size:10px;vertical-align:middle;padding-top:4px;padding-right:3px;padding-bottom:2px;text-align:left' >" + j; "</font>"
                hdsview += "</td>"

                var ds_view_code = ds18.Tables[0].Rows[srt_count].Scheme_Name
                if (ds_view_code != null) {
                    hdsview += "<td  id=td_cost_code" + j + " align='center' width='135px'style='border:1px solid #7DAAE3;padding-right:1px;' >"
                    hdsview += "<font width='135px'class='gridview'>" + ds18.Tables[0].Rows[srt_count].Scheme_Name.substring(0, 20) + "</font>"
                    hdsview += "</td>"
                }
                else {
                    hdsview += "<td width='135px' align='right' style='border:1px solid #7DAAE3;padding-right:1px;'>&nbsp;"
                    hdsview += "</td>"
                }

                var ds_view_code = ds18.Tables[0].Rows[srt_count].Discount
                if (ds_view_code != null) {
                    hdsview += "<td  id=td_cost_code" + j + " align='center' width='135px'style='border:1px solid #7DAAE3;padding-right:1px;' >"
                    hdsview += "<font width='135px'class='gridview'>" + ds18.Tables[0].Rows[srt_count].Discount + "</font>"
                    hdsview += "</td>"
                }
                else {
                    hdsview += "<td width='135px' align='right' style='border:1px solid #7DAAE3;padding-right:1px;'>&nbsp;"
                    hdsview += "</td>"
                }


                //                var ds_views_str = ds18.Tables[0].Rows[srt_count].Add1
                //                var lmdesc = fndnull(ds18.Tables[0].Rows[srt_count].Add1)
                //                if ((lmdesc != null) && (lmdesc != "")) {
                //                    var aa11 = "\"" + repalcestr2quote(lmdesc) + "\"";
                //                    hdsview += "<td width='135px' style='border:1px solid #7DAAE3;text-align:left;padding-left:2px;'>"
                //                    hdsview += "<font width='135px' class='gridview' title=" + aa11 + ">" + repalcestr2quote(lmdesc).substring(0, 20) + "</font>"
                //                    hdsview += "</td>"
                //                }
                //                else {
                //                    hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                //                    hdsview += "</td>"
                //                }


                //                var ds_views_str = ds18.Tables[0].Rows[srt_count].CITYNAME
                //                var lmdesc = fndnull(ds18.Tables[0].Rows[srt_count].CITYNAME)
                //                if ((lmdesc != null) && (lmdesc != "")) {
                //                    var aa11 = "\"" + repalcestr2quote(lmdesc) + "\"";
                //                    hdsview += "<td width='135px' style='border:1px solid #7DAAE3;text-align:left;padding-left:2px;'>"
                //                    hdsview += "<font width='135px' class='gridview' title=" + aa11 + ">" + repalcestr2quote(lmdesc).substring(0, 20) + "</font>"
                //                    hdsview += "</td>"
                //                }
                //                else {
                //                    hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                //                    hdsview += "</td>"
                //                }
                hdsview += "</tr>"
                document.getElementById('view19').innerHTML = hdsview;
                j++
            }
            hdsview += "</table>"

        }
        catch (er)
                 { }
        finally { }
    }
    else {

        hdsview += "<table width='300px;'>"
        hdsview += "<tr>"
        hdsview += "<td width='250px'>"
        hdsview += "<font Style='font-family:arial;font-weight:bold;font-size:18px;'>You have no detail </font></strong>"
        hdsview += "</td>"
        hdsview += "</tr>"
        hdsview += "</table>"
        hdsview = hdsview + "<BR>"

        document.getElementById('view19').innerHTML = hdsview;
        flg_req = "no"
        return false;
    }
    document.getElementById('view19').style.display = 'block';
    document.getElementById('pagingtab').style.display = 'block';
    //    document.getElementById('nextpage').style.display = 'block';
    //    document.getElementById('next1').style.display = 'block';
    flg_req = "no"
    return false;
}

function repalcesinglequote(val) {
    if (val.indexOf("'") >= 0) {
        while (val.indexOf("'") >= 0) {
            val = val.replace("'", "^");
        }
    }
    return val;
}



function repalcestr2quote(val) {
    if (val.indexOf("^") >= 0) {
        while (val.indexOf("^") >= 0) {
            val = val.replace("^", "'");
        }
    }
    return val;
}

function fndnull(myval) {
    if (myval == "undefined") {
        myval = "";
    }
    else if (myval == null) {
        myval = "";
    }
    return myval
}

function pageprev(valpre) {
    var bb = "";
    var hdspage;
    var dfg = "0"
    var End_pnt = "0"
    if (preval <= tot_page) {
        dfg = 1
        End_pnt = tot_page
    }
    else {
        dfg = preval - tot_page;
        End_pnt = dfg + tot_page;
    }
    if (preval <= tot_page) {
        return false;
    }
    else {
        document.getElementById('next1').innerHTML = "";
        if (End_pnt < 1 || dfg < 1) {
            var res = catch_error(dfg, End_pnt);
            return false;
        }
        document.getElementById('next1').innerHTML = "";
        for (srt_count = dfg; srt_count < End_pnt; srt_count++) {
            if (srt_count != 0) {
                if (srt_count != End_pnt - 1) {
                    document.getElementById('next1').innerHTML += "<span onclick=pagenumber(" + srt_count + ",this.id) class='paggingColor' id=nextnumber_" + srt_count + " runat='server'>" + srt_count + "</span>";
                    bb = "bb";
                }
                else {
                    document.getElementById('next1').innerHTML += "<span onclick=pagenumber(" + srt_count + ",this.id) class='paggingColorChange' id=nextnumber_" + srt_count + " runat='server'>" + srt_count + "</span>";
                    bb = "bb";
                    pagenumber(srt_count, this.id)
                }
            }
            else {
                bb = "";
                break;
            }
        }
        if (bb != "") {
            record_show = record_show1
            record_show1 = record_show - tot_page
        }
        preval = preval - tot_page
    }
    var page_html = document.getElementById("next1").innerHTML;
    if (page_html.indexOf("onclick=pagenumber") < 0) {
        //    alert(page_html);
        //var res = catch_error(dfg, End_pnt);
        return false;
    }
    return false;
}


function pagenext(valnext) {
    var nextPageNumberColor = true
    divres = row_count / rec_shw_oth_val;
    if (divres.valueOf(".") >= "0") {
        divres = divres + 1;
    }
    else {
        divres;
    }
    var hdspage;
    var aa = "";
    if ((parseInt(record_show1) * rec_shw_oth_val) - rec_shw_oth_val >= row_count) {
        return false;
    }
    else {
        document.getElementById('next1').innerHTML = "";
        if (record_show < 1 || record_show1 < 1) {
            var res = catch_error(record_show, record_show1);
            return false;
        }
        document.getElementById('next1').innerHTML = "";
        for (srt_count = record_show1; srt_count < record_show; srt_count++) {
            if (srt_count < divres) {

                if (srt_count == 1 || nextPageNumberColor == true) {
                    document.getElementById('next1').innerHTML += "<span onclick=pagenumber(" + srt_count + ",this.id) class='paggingColorChange'  id=nextnumber_" + srt_count + " runat='server'>" + srt_count + "</span>"
                    nextPageNumberColor = false;
                    pagenumber(srt_count, this.id)
                }
                else {
                    document.getElementById('next1').innerHTML += "<span onclick=pagenumber(" + srt_count + ",this.id) class='paggingColor'  id=nextnumber_" + srt_count + " runat='server'>" + srt_count + "</span>"

                }
                aa = "aa";
            }
            else {
                aa = "";
            }
        }
        if (aa != "") {
            record_show1 = record_show;
            preval = record_show1 - tot_page
            record_show = record_show1 + tot_page;
            nextPageNumberColor = true;
        }
        else {
            record_show1 = record_show;
            preval = record_show1 - tot_page
            record_show = record_show1 + tot_page;
        }
    }

    var page_html = document.getElementById("next1").innerHTML;
    if (page_html.indexOf("onclick=pagenumber") < 0) {
        //    alert(page_html);
        //var res = catch_error(dfg, End_pnt);
        return false;
    }
    return false;
}

function pagenumber(valnextvalue, hdsg) {

    if (ds18 == null || ds18 == undefined || ds18.Tables[0] == null || ds18.Tables[0] == undefined) {
        catch_error(1, 2)
        return false;
    }
    hdsharma = hdsg
    if (hdsg != undefined) {
        while (document.getElementById('next1').innerHTML.indexOf('paggingColorChange') > 0) {
            document.getElementById('next1').innerHTML = document.getElementById('next1').innerHTML.replace('paggingColorChange', 'paggingColor');
        }
        document.getElementById(hdsg).className = 'paggingColorChange';
    }
    var flag = "IN";
    var flags = "pre";
    forlen_other = valnextvalue;
    extra_record_other = row_count % rec_shw_oth_val;
    var finalval = (forlen_other * record_show_other) - extra_record_other;
    hdsview = "";
    if (finalval != row_count && extra_record_other != 0 && extra_record_other != 1) {
        hdsview += "<table Width='435px' style='border:1px solid #7DAAE3;margin-top:0px;margin-bottom:1px;' cellpadding='0' cellspacing='0'>"
        hdsview += "<tr style='background-color:#7DAAE3'><td class='tabsHeaders2' >SNo</td>";
        hdsview += "<td id='view11' class='tabsHeaders1'  >Agency Name</td>";
        hdsview += "<td id='view12' class='tabsHeaders1'  >Address</td></tr>";
        // hdsview += "<td id='view12' class='tabsHeaders1' >City</td>

        for (srt_count_0ther = (forlen_other * record_show_other) - record_show_other; srt_count_0ther < (forlen_other * record_show_other); srt_count_0ther++) {
            if (row_count > srt_count_0ther) {
                hdsview += "<tr>"
                var srt_count_0ther_sr = parseInt(srt_count_0ther) + 1

                hdsview += "<td width='30px' align='right' style='border:1px solid #7DAAE3;'>"
                hdsview += "<font style='font-size:10px;vertical-align:middle;padding-top:4px;padding-right:3px;padding-bottom:2px;text-align:left' >" + srt_count_0ther_sr; "</font>"
                hdsview += "</td>"

                var ds_view_code = ds18.Tables[0].Rows[srt_count_0ther].Scheme_Name
                if (ds_view_code != null) {
                    hdsview += "<td  id=td_cost_code" + srt_count_0ther_sr + " align='center' width='135px'style='border:1px solid #7DAAE3;padding-right:1px;' >"
                    hdsview += "<font width='135px'class='gridview'>" + ds18.Tables[0].Rows[srt_count_0ther].Scheme_Name.substring(0, 20) + "</font>"
                    hdsview += "</td>"
                }
                else {
                    hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                    hdsview += "</td>"
                }


                var ds_view_code = ds18.Tables[0].Rows[srt_count_0ther].Discount
                if (ds_view_code != null) {
                    hdsview += "<td  id=td_cost_code" + srt_count_0ther_sr + " align='center' width='135px'style='border:1px solid #7DAAE3;padding-right:1px;' >"
                    hdsview += "<font width='135px'class='gridview'>" + ds18.Tables[0].Rows[srt_count_0ther].Discount + "</font>"
                    hdsview += "</td>"
                }
                else {
                    hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                    hdsview += "</td>"
                }

                //                var ds_views_str = ds18.Tables[0].Rows[srt_count_0ther].Add1
                //                var lmndesc = fndnull(ds18.Tables[0].Rows[srt_count_0ther].Add1)
                //                if ((lmndesc != null) && (lmndesc != "")) {

                //                    var aa11 = "\"" + repalcestr2quote(lmndesc) + "\"";
                //                    hdsview += "<td width='135px' style='border:1px solid #7DAAE3;text-align:left;padding-left:2px;'>"
                //                    hdsview += "<font width='135px'  class='gridview' title=" + aa11 + ">" + repalcestr2quote(lmndesc).substring(0, 20) + "</font>"
                //                    hdsview += "</td>"

                //                }
                //                else {
                //                    hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                //                    hdsview += "</td>"
                //                }
                //                var ds_views_str = ds18.Tables[0].Rows[srt_count_0ther].CITYNAME
                //                var lmndesc = fndnull(ds18.Tables[0].Rows[srt_count_0ther].CITYNAME)
                //                if ((lmndesc != null) && (lmndesc != "")) {

                //                    var aa11 = "\"" + repalcestr2quote(lmndesc) + "\"";
                //                    hdsview += "<td width='135px' style='border:1px solid #7DAAE3;text-align:left;padding-left:2px;'>"
                //                    hdsview += "<font width='135px'  class='gridview' title=" + aa11 + ">" + repalcestr2quote(lmndesc).substring(0, 20) + "</font>"
                //                    hdsview += "</td>"

                //                }
                //                else {
                //                    hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                //                    hdsview += "</td>"
                //                }
                hdsview += "</tr>"
                document.getElementById('view19').innerHTML = hdsview;
                srt_count_0ther_sr++
            }
        }
    }
    else if (finalval == row_count) {
        hdsview += "<table document.getElementById style='border:1px solid #7DAAE3;margin-top:0px;margin-bottom:1px;margin-left:4px;' cellpadding='0' cellspacing='0' Width='435px'>"
        hdsview += "<tr style='background-color:#7DAAE3'><td class='tabsHeaders2' >SNo</td>";
        hdsview += "<td id='view11' class='tabsHeaders1'  >Agency Name</td>";
        hdsview += "<td id='view12' class='tabsHeaders1'  >Address</td></tr>";
        //  hdsview += "<td id='view12' class='tabsHeaders1' >City</td>

        for (srt = (forlen_other * record_show_other) - record_show_other; srt < row_count; srt++) {
            var srt_count_0ther_sr = parseInt(srt) + 1
            hdsview += "<tr>"
            hdsview += "<td width='30px' style='border:1px solid #7DAAE3; padding-right:3px;' align='right'>"
            hdsview += "<font style='font-size:10px;font-weight:bold;vertical-align:middle;' align='right'>" + srt_count_0ther_sr + "</font>"
            hdsview += "</td>"

            var ds_view_code = ds18.Tables[0].Rows[srt].Scheme_Name
            if (ds_view_code != null) {
                hdsview += "<td id=td_cost_code" + srt + " align='center'width='135px' style='border:1px solid #7DAAE3;padding-right:1px;'  >"
                hdsview += "<font width='135px' class='gridview'>" + ds18.Tables[0].Rows[srt].Scheme_Name.substring(0, 20) + "</font>"
                hdsview += "</td>"
            }
            else {
                hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                hdsview += "</td>"
            }

            var ds_view_code = ds18.Tables[0].Rows[srt].Discount
            if (ds_view_code != null) {
                hdsview += "<td id=td_cost_code" + srt + " align='center'width='135px' style='border:1px solid #7DAAE3;padding-right:1px;'  >"
                hdsview += "<font width='135px' class='gridview'>" + ds18.Tables[0].Rows[srt].Discount + "</font>"
                hdsview += "</td>"
            }
            else {
                hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                hdsview += "</td>"
            }



            //            var ds_views_str = ds18.Tables[0].Rows[srt].Add1
            //            var nrtndesc = fndnull(ds18.Tables[0].Rows[srt].Add1)
            //            if ((nrtndesc != null) && (nrtndesc != "")) {
            //                var aa11 = "\"" + repalcestr2quote(nrtndesc) + "\"";
            //                hdsview += "<td width='135px' style='border:1px solid #7DAAE3;text-align:left;padding-left:2px;'>"
            //                hdsview += "<font width='135px'class='gridview' title=" + aa11 + ">" + repalcestr2quote(nrtndesc).substring(0, 20) + "</font>"
            //                hdsview += "</td>"
            //            }
            //            else {
            //                hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
            //                hdsview += "</td>"
            //            }

            //            var ds_views_str = ds18.Tables[0].Rows[srt].CITYNAME
            //            var nrtndesc = fndnull(ds18.Tables[0].Rows[srt].CITYNAME)
            //            if ((nrtndesc != null) && (nrtndesc != "")) {
            //                var aa11 = "\"" + repalcestr2quote(nrtndesc) + "\"";
            //                hdsview += "<td width='135px' style='border:1px solid #7DAAE3;text-align:left;padding-left:2px;'>"
            //                hdsview += "<font width='135px'class='gridview' title=" + aa11 + ">" + repalcestr2quote(nrtndesc).substring(0, 20) + "</font>"
            //                hdsview += "</td>"
            //            }
            //            else {
            //                hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
            //                hdsview += "</td>"
            //            }
            hdsview += "</tr>"
            document.getElementById('view19').innerHTML = hdsview;
            srt_count_0ther_sr++
        }
        hdsview += "</table>"

    }
    else {
        var finalval_other = finalval - extra_record_other;
        if (flag == "IN") {
            hdsview += "<table Width='435px' style='border:1px solid #7DAAE3;margin-top:0px;margin-bottom:1px;' cellpadding='0' cellspacing='0'>"
            hdsview += "<tr style='background-color:#7DAAE3'><td class='tabsHeaders2' >SNo</td>";
            hdsview += "<td id='view11' class='tabsHeaders1'  >Agency Name</td>";
            hdsview += "<td id='view12' class='tabsHeaders1'  >Address</td></tr>";
            // hdsview += "<td id='view12' class='tabsHeaders1' >City</td>

            for (srt = (forlen_other * record_show_other) - record_show_other; srt < (forlen_other * record_show_other); srt++) {
                if (srt != row_count) {
                    if (srt > row_count) {
                        return false;
                    }
                    hdsview += "<tr>"
                    var srt_count_0ther_sr = parseInt(srt) + 1
                    hdsview += "<td width='30px' style='border:1px solid #7DAAE3; padding-right:3px;' align='right'>"
                    hdsview += "<font style='font-size:10px;font-weight:bold;vertical-align:middle;' align='right'>" + srt_count_0ther_sr + "</font>"
                    hdsview += "</td>"
                    var ds_view_code = ds18.Tables[0].Rows[srt].Scheme_Name
                    if (ds_view_code != null) {
                        hdsview += "<td id=td_cost_code" + srt + " align='center'width='135px' style='border:1px solid #7DAAE3;padding-right:1px;' >"
                        hdsview += "<font width='135px' class='gridview'>" + ds18.Tables[0].Rows[srt].Scheme_Name.substring(0, 20) + "</font>"
                        hdsview += "</td>"
                    }
                    else {
                        hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                        hdsview += "</td>"
                    }

                    var ds_view_code = ds18.Tables[0].Rows[srt].Discount
                    if (ds_view_code != null) {
                        hdsview += "<td id=td_cost_code" + srt + " align='center'width='135px' style='border:1px solid #7DAAE3;padding-right:1px;' >"
                        hdsview += "<font width='135px' class='gridview'>" + ds18.Tables[0].Rows[srt].Discount + "</font>"
                        hdsview += "</td>"
                    }
                    else {
                        hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                        hdsview += "</td>"
                    }

                    //                    var ds_views_str = ds18.Tables[0].Rows[srt].Add1
                    //                    var nrtndesc = fndnull(ds18.Tables[0].Rows[srt].Add1)
                    //                    if ((nrtndesc != null) && (nrtndesc != "")) {
                    //                        var aa11 = "\"" + repalcestr2quote(nrtndesc) + "\"";
                    //                        hdsview += "<td width='135px' style='border:1px solid #7DAAE3;text-align:left;padding-left:5px;'>"
                    //                        hdsview += "<font width='135px'  class='gridview' title=" + aa11 + ">" + repalcestr2quote(nrtndesc).substring(0, 20) + "</font>"
                    //                        hdsview += "</td>"
                    //                    }
                    //                    else {
                    //                        hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                    //                        hdsview += "</td>"
                    //                    }

                    //                    var ds_views_str = ds18.Tables[0].Rows[srt].CITYNAME
                    //                    var nrtndesc = fndnull(ds18.Tables[0].Rows[srt].CITYNAME)
                    //                    if ((nrtndesc != null) && (nrtndesc != "")) {
                    //                        var aa11 = "\"" + repalcestr2quote(nrtndesc) + "\"";
                    //                        hdsview += "<td width='135px' style='border:1px solid #7DAAE3;text-align:left;padding-left:5px;'>"
                    //                        hdsview += "<font width='135px'  class='gridview' title=" + aa11 + ">" + repalcestr2quote(nrtndesc).substring(0, 20) + "</font>"
                    //                        hdsview += "</td>"
                    //                    }
                    //                    else {
                    //                        hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                    //                        hdsview += "</td>"
                    //                    }
                    hdsview += "</tr>"
                    document.getElementById('view19').innerHTML = hdsview;
                    srt_count_0ther_sr++
                }
            }
            hdsview += "</table>"
        }
        flag = "OUT";
    }

    return false;
}

function close1() {

    document.getElementById("Divgrid1").style.display = "none";
    document.getElementById('view19').innerHTML = "";
    return false;
}



/////////////////////add by anuja/////
function alertforcatuom() {
    var i;
    var comcode = document.getElementById('hiddencompcode').value;
    var agencycode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.length + document.getElementById('txtagency').value.lastIndexOf('('));
    agencycode = agencycode.replace(")", "");

    var uom = document.getElementById('drpuom').value;
    var cate = document.getElementById('drpadcategory').value;
    var res = QBC.alert(comcode, agencycode, uom, cate)
    var ds = res.value;
    if (ds != null) {
        if (ds.Tables[1].Rows.length == 0) {
        }
        else if (ds.Tables[0].Rows.length > 0) {
            if (ds.Tables[0].Rows[0].UOM_NAME == 0) {
                if (document.getElementById('drpuom').value != "" && document.getElementById('drpuom').value != "0") {
                    if (document.getElementById('hdndepo').value == "depo") {
                        alert('Can not booking of this category and uom');
                        document.getElementById('drpuom').value = "0";
                        document.getElementById('drpadcategory').value = "0";
                        return false;
                    }
                }
            }
        }

    }
}

////////////////add by anuja
function paymodechange() {
    if (document.getElementById('drppaymenttype').value == "PR0" || document.getElementById('drppaymenttype').value == "PR1") {
        document.getElementById('txtgrossamt').value = "";
        document.getElementById('txttotalamt').value
    }
    if (document.getElementById('drppaymenttype').value == "CH0" || document.getElementById('drppaymenttype').value == "PR0" || document.getElementById('drppaymenttype').value == "DD0" || document.getElementById('drppaymenttype').value == "SW0" || document.getElementById('drppaymenttype').value == "ON0") {
        chequedetail();
        document.getElementById('hdnflagdetail').value = "false";
        document.getElementById('hiddenchequeno').value = "";
        document.getElementById('hiddenchequedate').value = "";
        document.getElementById('hiddenbankname').value = "";
    }
    /////////////////outstanding
    if (document.getElementById('drppaymenttype').value == "CR0") {
        document.getElementById('txtagencybalance').value = document.getElementById('txtagencyoutstand').value;
    }
    else {
        document.getElementById('txtagencybalance').value = "";
    }
    return false;
}


function chequedetail() {
    if (document.getElementById('drppaymenttype').value == "CH0" || document.getElementById('drppaymenttype').value == "PR0" || document.getElementById('drppaymenttype').value == "DD0" || document.getElementById('drppaymenttype').value == "SW0" || document.getElementById('drppaymenttype').value == "ON0") {
        var ciobookid = document.getElementById('txtciobookid').value;


        gciobookid = ciobookid;
        var docno = "";
        gdockitno = docno;
        var keyno = document.getElementById('txtkeyno').value;
        gkeyno = keyno;
        var rono = document.getElementById('txtrono').value;
        grono = rono;

        var agencycode = document.getElementById('txtagency').value;

        //var agencycode = "";
        if (agencycode != "") {
            agencycode = document.getElementById('txtagency').value.substring(document.getElementById('txtagency').value.lastIndexOf('(') + 1, document.getElementById('txtagency').value.length + document.getElementById('txtagency').value.lastIndexOf('('));
            agencycode = agencycode.replace(")", "");
        }
        gagencyscode = agencycode;

        /*new change ankur 15 feb*/
        document.getElementById('drpvarient').disabled = false;
        document.getElementById('drpadtype').disabled = true;
        document.getElementById("get_pacakge_new").disabled = true;
        ///////////////////////////

        ////for client

        ////////////////////////////////////


        var clientcode = document.getElementById('txtclient').value;
        var client = "";
        ///this is to split and get the client code

        if (clientcode.indexOf("(".toString()) > 0 && clientcode != "") {
            //clientcode.IndexOf(
            //var splitterclie = { '(' };
            var myarray1 = clientcode.split('(');
            client = myarray1[1];
            client = client.replace(")", '');

            /////this is to chk whether this code exixts in the database if exists than it is a register client else
            ///it is walkinn client
            ///
            var res = QBC.chkwalkinClient(client, document.getElementById('hiddencompcode').value);
            var dcl = res.value;
            if (dcl == null) {
                alert(res.error.description);
                return false;
            }
            if (dcl.Tables[0].Rows.length > 0) {

            }
            else {
                client = clientcode;
            }

        }
        else {
            client = clientcode;
        }
        gclient = client;


        var ciobookid

        if (document.getElementById('hdnprcioid').value != "") {
            ciobookid = document.getElementById('hdnprcioid').value;
        }

        else {



            ciobookid = document.getElementById('txtreceipt').value

        }
        var paymode = document.getElementById('drppaymenttype').value;
        window.open('qbc_chequedetail.aspx??comcode=' + document.getElementById('hiddencompcode').value + '&ciobookid=' + ciobookid + '&docno=' + docno + '&keyno=' + keyno + '&rono=' + rono + '&agencycode=' + agencycode + '&client=' + client + '&drtype=' + document.getElementById('drpadtype').value + '&dateformate=' + document.getElementById('hiddendateformat').value + '&userid=' + document.getElementById('hiddenuserid').value + '&paymode=' + paymode, "MatterPreview", 'width=400px,height=300,resizable=0,left=200,top=0,scrollbars=yes')
        return false;
    }

}


function dropDateCheck(ddate, text_var, pkg_id, pkg_alias, pkgname) {
    var dateformat_vari = document.getElementById("hiddendateformat");
    var compcode_vari = document.getElementById('hiddencompcode');
    var adcat = document.getElementById('drpadcategory').value;
    var val_ue = "1";
    if (browser != "Microsoft Internet Explorer") {
        var httpRequest = null; ;
        httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml');
        }

        httpRequest.onreadystatechange = function () { alertContents(httpRequest) };

        httpRequest.open("GET", "packagename.aspx?pkgalias=" + pkg_alias + "&adcat=" + adcat + "&pkgid=" + pkg_id + "&compcode=" + compcode_vari.value + "&value=" + val_ue + "&dateday=" + ddate + "&pkgname=" + pkgname, false);
        httpRequest.send('');
        //alert(httpRequest.readyState);
        if (httpRequest.readyState == 4) {
            //alert(httpRequest.status);
            if (httpRequest.status == 200) {
                strtext = httpRequest.responseText;
            }
            else {
                alert('Session TimeOut. Unable To Process Your Request. Please Login Again.');
            }
        }
    }
    else {
        validuse = "";
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        var adcat = document.getElementById('drpadcategory').value;
        xml.Open("GET", "packagename.aspx?pkgalias=" + pkg_alias + "&adcat=" + adcat + "&pkgid=" + pkg_id + "&compcode=" + compcode_vari.value + "&value=" + val_ue + "&dateday=" + ddate + "&pkgname=" + pkgname, false);
        xml.Send();
        strtext = xml.responseText;
    }

    //var text_var=document.getElementById("Text" + i);//comment by anuja
    if (strtext != "" && strtext != "1" && strtext != "0" && strtext != null && strtext != "NOT A VALID DATE") {

        if (text_var != null) {
            text_var.value = strtext;
        }
        return false; ///add by anuja
    }
    else {
        if (text_var != null)
            text_var.value = ddate;
        return false; ///add by anuja
    }
}

function shdulebutton() {
    var hdsview = "";
    hdsview += ("<table id='ItemMfgTable' Width=20%' style='overflow:scroll;border:0px solid #7DAAE3;margin-top:1px;margin-bottom:1px;' cellpadding='0' cellspacing='1'  border='0'><tr style='height:20px;'>")
    hdsview += ("<tr>");
    hdsview += ("<td style='background-color:#7DAAE3;' style='width:15%;align:center;'><label style='font-size:10px;font-weight:bold;font-family:Arial, Helvetica, sans-serif;color:black;cursor:pointer;vertical-align:top;'>S</label></td>");
    hdsview += ("<td style='background-color:#7DAAE3;' style='width:15%;align:center;'><label style='font-size:10px;font-weight:bold;font-family:Arial, Helvetica, sans-serif;color:black;cursor:pointer;vertical-align:top;'>M</label></td>");
    hdsview += ("<td style='background-color:#7DAAE3;' style='width:15%;align:center;'><label style='font-size:10px;font-weight:bold;font-family:Arial, Helvetica, sans-serif;color:black;cursor:pointer;vertical-align:top;'>T</label></td>");
    hdsview += ("<td style='background-color:#7DAAE3;' style='width:15%;align:center;'><label style='font-size:10px;font-weight:bold;font-family:Arial, Helvetica, sans-serif;color:black;cursor:pointer;vertical-align:top;'>W</label></td>");
    hdsview += ("<td style='background-color:#7DAAE3;' style='width:15%;align:center;'><label style='font-size:10px;font-weight:bold;font-family:Arial, Helvetica, sans-serif;color:black;cursor:pointer;vertical-align:top;'>T</label></td>");
    hdsview += ("<td style='background-color:#7DAAE3;' style='width:15%;align:center;'><label style='font-size:10px;font-weight:bold;font-family:Arial, Helvetica, sans-serif;color:black;cursor:pointer;vertical-align:top;'>F</label></td>");
    hdsview += ("<td style='background-color:#7DAAE3;' style='width:15%;align:center;'><label style='font-size:10px;font-weight:bold;font-family:Arial, Helvetica, sans-serif;color:black;cursor:pointer;vertical-align:top;'>S</label></td>");
    // hdsview += ("<td style='background-color:#7DAAE3;' style='width:15%;align:center;'><label style='font-size:10px;font-weight:bold;font-family:Arial, Helvetica, sans-serif;color:black;cursor:pointer;vertical-align:top;'>A</label></td>");
    hdsview += ("</tr>");
    return hdsview;
}
function CreateMfgDetail(id) {
    var hdsview = "";
    document.getElementById('daysdiv').innerHTML = "";
    var activeid = document.activeElement.id;
    hdsview += shdulebutton();
    hdsview += ("<tr>")
    hdsview += ("<td><input type='checkbox' id='checkbox_1' ></td>")
    hdsview += ("<td><input type='checkbox' id='checkbox_2' ></td>")
    hdsview += ("<td><input type='checkbox' id='checkbox_3' ></td>")
    hdsview += ("<td><input type='checkbox' id='checkbox_4' ></td>")
    hdsview += ("<td><input type='checkbox' id='checkbox_5' ></td>")
    hdsview += ("<td><input type='checkbox' id='checkbox_6' ></td>")
    hdsview += ("<td><input type='checkbox' id='checkbox_7' ></td>")
    //hdsview += ("<td><input type='checkbox' id='checkbox_8' ></td>")
    hdsview += ("</tr>")
    hdsview += ("<tr>")
    hdsview += ("</table>")
    hdsview += ("<table  Width='20%' style='overflow:scroll;border:0px solid #7DAAE3;margin-top:1px;margin-bottom:1px;'>")
    hdsview += ("<td><input type='button' id='btnsub' value='Ok' onClick=\"binddate();\" ></td>")
    hdsview += ("<td><input type='button' id='btnclear' value='Clear' onClick=\"clearmgf();\"></td>")
    hdsview += ("<tr>")
    hdsview += ("</table>")
    jq('#daysdiv').append(hdsview.toString());
    document.getElementById('daysdiv4').style.display = "block";
    document.getElementById('daysdiv').style.display = "block";
    offset("btnshdl", "daysdiv4");

    return false;
}
function clearmgf() {
    document.getElementById('daysdiv4').style.display = "none";
    document.getElementById('daysdiv').style.display = "none";
    //document.getElementById('daysdiv4').innerHTML = "";
    return false;
}
function offset(activeid, divid) {
    aTag = eval(document.getElementById(activeid))
    var btag;
    var leftpos = 0;
    var toppos = 0;
    do {
        aTag = eval(aTag.offsetParent);
        leftpos += aTag.offsetLeft;
        toppos += aTag.offsetTop;
        btag = eval(aTag)
    } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
    var tot = document.getElementById(divid).scrollLeft;
    var scrolltop = document.getElementById(divid).scrollTop;
    document.getElementById(divid).style.left = document.getElementById(activeid).offsetLeft + leftpos - tot + "px";
    document.getElementById(divid).style.top = document.getElementById(activeid).offsetTop + toppos - scrolltop + "px";
    document.getElementById(divid).style.display = "block";

    return false;
}
function shdulerepdays() {
    if (document.getElementById('txtrepeatingdate').value != "") {
        document.getElementById('btnshdl').disabled = false;
    }
    return false;
}

function getpackagediscount() {
    if (document.getElementById('chkdistype').checked == false) {
        document.getElementById('hdnclientcatdistype').value = "N";
        if (document.getElementById('hiddenspediscper').value != "") {
            //  var br_spcharge=0;
            var splcharges = document.getElementById('hiddenspediscper').value;
            var grossAmt = document.getElementById('txtgrossamt').value;
            var len = "bookdiv";
            var ratio = 0;
            var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
            for (var s = 0; s < count; s++) {
                var gross_var = document.getElementById('gro' + s);
                var bill_var = document.getElementById('ba' + s);
                var insertsta = document.getElementById("inssta" + s);
                if (gross_var != null && document.getElementById("inssta" + s).value != "cancel") {
                    splcharges_grid = (parseFloat(document.getElementById('gro' + s).value) * splcharges) / 100;
                    if (gross_var != null && document.getElementById("inssta" + s).value != "cancel" && document.getElementById("pai" + s).value != "N") {
                        if (insertsta.value != "billed") {
                            var uom_cod = document.getElementById('drpuom').value;
                            if (uom_cod == "CL0") {
                                gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid) * parseFloat(totalarea_var))).toFixed(2);

                            }
                            else {
                                gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid))).toFixed(2);
                            }
                        }
                        var tradisc = tradedisc; //document.getElementById('txttradedisc').value;
                        if (document.getElementById('chktrade').checked == false)
                            tradisc = 0;
                        if (tradisc == "")
                            tradisc = 0;
                        var trdisc1 = tradisc;
                        var addcomm = 0;

                        if (addcomm == "") {
                            addcomm = "0";
                        }
                        if (addcomm != "0") {
                            trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                        }
                        if (insertsta.value != "billed")
                            bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);

                        br_spcharge = (parseFloat(br_spcharge) + parseFloat(gross_var.value)).toFixed(2);
                        billAmount = (parseFloat(billAmount) + parseFloat(bill_var.value)).toFixed(2);
                    }

                }

            }
            if (br_spcharge == 0 && grossAmt != "")
                br_spcharge = grossAmt;
            document.getElementById('txttotalamt').value = parseFloat(br_spcharge);
            if (document.activeElement.id == "txtspedisc" || document.activeElement.id == "txtspediscper")
                document.getElementById('txtgrossamt').value = "";
            //  if(billAmount!=0)
            document.getElementById('txtgrossamt').value = parseFloat(billAmount).toFixed(2);
        }

    }
    else {
        var dspub;
        var packagecode = '';
        var billAmount = 0;
        var br_spcharge = 0;
        var obj = document.getElementById('drppackagecopy');
        for (var x = 0; x < obj.options.length; x++) {

            var insertCount1 = 0;
            if (obj[x].value.indexOf('(') >= 0) {
                insertCount1 = obj[x].value.substring(obj[x].value.lastIndexOf('(') + 1, obj[x].value.length - 1);
                //  insertCount1=parseInt(insertCount1)-1;
            }
            for (x1 = 0; x1 < insertCount1; x1++) {
                if (packagecode == '')
                    packagecode = obj[x].value.substring(0, obj[x].value.lastIndexOf('@'));
                else
                    packagecode = packagecode + ',' + obj[x].value.substring(0, obj[x].value.lastIndexOf('@'));

            }


        }
        var respub1 = QBC.getpubcountdis(document.getElementById('hiddencompcode').value, packagecode, document.getElementById('drpadcategory').value, document.getElementById('drpadsubcategory').value);
        if (respub1.error != null) {
            alert(respub1.error.description);
        }
        var dsresdate = respub1.value;
        if (dsresdate != null && dsresdate.Tables[0].Rows.length > 0) {
            if (dsresdate.Tables[0].Rows[0].MSG == "FALSE") {
                if (document.getElementById('hiddenspediscper').value != "") {
                    //  var br_spcharge=0;
                    var splcharges = document.getElementById('hiddenspediscper').value;
                    var grossAmt = document.getElementById('txtgrossamt').value;
                    var len = "bookdiv";
                    var ratio = 0;
                    var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
                    for (var s = 0; s < count; s++) {
                        var gross_var = document.getElementById('gro' + s);
                        var bill_var = document.getElementById('ba' + s);
                        var insertsta = document.getElementById("inssta" + s);
                        if (gross_var != null && document.getElementById("inssta" + s).value != "cancel") {
                            splcharges_grid = (parseFloat(document.getElementById('gro' + s).value) * splcharges) / 100;
                            if (gross_var != null && document.getElementById("inssta" + s).value != "cancel" && document.getElementById("pai" + s).value != "N") {
                                if (insertsta.value != "billed") {
                                    var uom_cod = document.getElementById('drpuom').value;
                                    if (uom_cod == "CL0") {
                                        gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid) * parseFloat(totalarea_var))).toFixed(2);

                                    }
                                    else {
                                        gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid))).toFixed(2);
                                    }
                                }
                                var tradisc = tradedisc; //document.getElementById('txttradedisc').value;
                                if (document.getElementById('chktrade').checked == false)
                                    tradisc = 0;
                                if (tradisc == "")
                                    tradisc = 0;
                                var trdisc1 = tradisc;
                                var addcomm = 0;

                                if (addcomm == "") {
                                    addcomm = "0";
                                }
                                if (addcomm != "0") {
                                    trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                                }
                                if (insertsta.value != "billed")
                                    bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);

                                br_spcharge = (parseFloat(br_spcharge) + parseFloat(gross_var.value)).toFixed(2);
                                billAmount = (parseFloat(billAmount) + parseFloat(bill_var.value)).toFixed(2);
                            }

                        }

                    }
                    if (br_spcharge == 0 && grossAmt != "")
                        br_spcharge = grossAmt;
                    document.getElementById('txttotalamt').value = parseFloat(br_spcharge);
                    if (document.activeElement.id == "txtspedisc" || document.activeElement.id == "txtspediscper")
                        document.getElementById('txtgrossamt').value = "";
                    //  if(billAmount!=0)
                    document.getElementById('txtgrossamt').value = parseFloat(billAmount).toFixed(2);
                }
                return false;
            }
            else {
                if (dsresdate.Tables[0].Rows[0].MSG == "TRUE" && dsresdate.Tables[0].Rows[0].DISCOUNT_TYPE != "" && dsresdate.Tables[0].Rows[0].DISCOUNT_PER != "") {
                    document.getElementById('txtclientcatdisc').value = dsresdate.Tables[0].Rows[0].DISCOUNT_PER;
                    document.getElementById('hdnclientcatdistype').value = dsresdate.Tables[0].Rows[0].DISCOUNT_TYPE;
                    var splcharges = dsresdate.Tables[0].Rows[0].DISCOUNT_PER;
                    if (document.getElementById('hiddenspediscper').value != "") {
                        splcharges = parseFloat(splcharges) + parseFloat(document.getElementById('hiddenspediscper').value);
                    }
                    var grossAmt = document.getElementById('txtgrossamt').value;
                    var len = "bookdiv";
                    var ratio = 0;
                    var splcharges_grid_val = 0;
                    var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
                    for (var s = 0; s < count; s++) {
                        var gross_var = document.getElementById('gro' + s);
                        var bill_var = document.getElementById('ba' + s);
                        var insertsta = document.getElementById("inssta" + s);
                        if (gross_var != null && document.getElementById("inssta" + s).value != "cancel") {
                            //                    if(s==count-1)
                            //                    {
                            //                        document.getElementById('gro'+s).value = (parseFloat(document.getElementById('gro'+s).value) - ((parseFloat(splcharges)*parseFloat(cardrate)/100)-parseFloat(br_spcharge))).toFixed(2);
                            //                    }
                            //                    else
                            //                    {
                            //                       ratio = (parseFloat(document.getElementById('gro'+s).value) * (parseFloat(splcharges)*parseFloat(cardrate)*parseFloat(document.getElementById('txttotalarea').value)/100) / parseFloat(grossAmt))
                            //var splcharges_grid = (parseFloat(document.getElementById('card' + s).value) * splcharges) / 100;
                            var splcharges_grid = (parseFloat(document.getElementById('gro' + s).value) * splcharges) / 100;
                            splcharges_grid_val = parseFloat(splcharges_grid_val) + parseFloat(splcharges_grid)
                            if (gross_var != null && document.getElementById("inssta" + s).value != "cancel") {
                                if (insertsta.value != "billed") {
                                    var uom_cod = document.getElementById('drpuom').value;
                                    if (uom_cod == "CL0") {
                                        gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid) * parseFloat(totalarea_var))).toFixed(2);

                                    }
                                    else {
                                        gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid))).toFixed(2);
                                        document.getElementById("clicatamt" + s).value = (parseFloat(splcharges_grid)).toFixed(2);
                                    }
                                    //bill_var.value = (parseFloat(bill_var.value) - (parseFloat(splcharges_grid)*parseFloat(totalarea_var))).toFixed(2);
                                    // trade disc
                                }
                                var tradisc = tradedisc; //document.getElementById('txttradedisc').value;
                                if (document.getElementById('chktrade').checked == false)
                                    tradisc = 0;
                                if (tradisc == "")
                                    tradisc = 0;
                                var trdisc1 = tradisc;
                                var addcomm = 0;

                                if (addcomm == "") {
                                    addcomm = "0";
                                }
                                if (addcomm != "0") {
                                    trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                                }
                                if (insertsta.value != "billed")
                                    bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);

                                br_spcharge = (parseFloat(br_spcharge) + parseFloat(gross_var.value)).toFixed(2);
                                billAmount = (parseFloat(billAmount) + parseFloat(bill_var.value)).toFixed(2);
                            }

                        }
                    }
                    document.getElementById('txtclientcatam').value = parseFloat(splcharges_grid_val).toFixed(2);
                    document.getElementById('txttotalamt').value = parseFloat(br_spcharge);
                    document.getElementById('txtgrossamt').value = parseFloat(billAmount).toFixed(2);

                }
            }
        }
        else {
            if (document.getElementById('hiddenspediscper').value != "") {
                //  var br_spcharge=0;
                var splcharges = document.getElementById('hiddenspediscper').value;
                var grossAmt = document.getElementById('txtgrossamt').value;
                var len = "bookdiv";
                var ratio = 0;
                var count = document.getElementById(len).getElementsByTagName('table')[0].rows.length - 1;
                for (var s = 0; s < count; s++) {
                    var gross_var = document.getElementById('gro' + s);
                    var bill_var = document.getElementById('ba' + s);
                    var insertsta = document.getElementById("inssta" + s);
                    if (gross_var != null && document.getElementById("inssta" + s).value != "cancel") {
                        splcharges_grid = (parseFloat(document.getElementById('gro' + s).value) * splcharges) / 100;
                        if (gross_var != null && document.getElementById("inssta" + s).value != "cancel" && document.getElementById("pai" + s).value != "N") {
                            if (insertsta.value != "billed") {
                                var uom_cod = document.getElementById('drpuom').value;
                                if (uom_cod == "CL0") {
                                    gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid) * parseFloat(totalarea_var))).toFixed(2);

                                }
                                else {
                                    gross_var.value = (parseFloat(gross_var.value) - (parseFloat(splcharges_grid))).toFixed(2);
                                }
                            }
                            var tradisc = tradedisc; //document.getElementById('txttradedisc').value;
                            if (document.getElementById('chktrade').checked == false)
                                tradisc = 0;
                            if (tradisc == "")
                                tradisc = 0;
                            var trdisc1 = tradisc;
                            var addcomm = 0;

                            if (addcomm == "") {
                                addcomm = "0";
                            }
                            if (addcomm != "0") {
                                trdisc1 = parseFloat(tradisc) + parseFloat(addcomm);
                            }
                            if (insertsta.value != "billed")
                                bill_var.value = (parseFloat(gross_var.value) - (parseFloat(gross_var.value) * parseFloat(trdisc1) / 100)).toFixed(2);

                            br_spcharge = (parseFloat(br_spcharge) + parseFloat(gross_var.value)).toFixed(2);
                            billAmount = (parseFloat(billAmount) + parseFloat(bill_var.value)).toFixed(2);
                        }

                    }

                }
                if (br_spcharge == 0 && grossAmt != "")
                    br_spcharge = grossAmt;
                document.getElementById('txttotalamt').value = parseFloat(br_spcharge);
                if (document.activeElement.id == "txtspedisc" || document.activeElement.id == "txtspediscper")
                    document.getElementById('txtgrossamt').value = "";
                //  if(billAmount!=0)
                document.getElementById('txtgrossamt').value = parseFloat(billAmount).toFixed(2);
            }
        }
    }
}


