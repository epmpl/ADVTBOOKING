// JScript File

var show="0";
var z=0;
var hiddentext;
// this variable is used foe storing value of autogenerated for session
var auto="";
var global_ds;
var row_num=0;
var glcompcode; 
var glpubcode;
var glcentercode; 
var gleditioncode;
var glsuppcode; 
var glpageno;
var glnoofpages; 
var glddlpgcolor;
var hid_gau_cent;
var hid_gau_edi;
var hid_gau_pub;
var hid_gau_sup;




function fillcentercode(pub)
{

     document.getElementById("ddlEdition").options.length=1;
     document.getElementById("ddlEdition").value="0";
     document.getElementById("ddlSupplement").options.length=1;
     document.getElementById("ddlSupplement").value="0";
 if(typeof(pub)=="object")
    {
       var pubcode=pub.value;
    }
    else
    {
      var pubcode=pub;
    }
    if(pubcode !="0")
    {
        var compcode=document.getElementById('hiddencompcode').value;
        var userid=document.getElementById('hiddenuserid').value;
        DefaultPageConfigurationMaster.addcentercode(compcode,userid,callbindcentercode); 
    }
    else
    {
      document.getElementById("ddlCenter").options.length=1;
      document.getElementById("ddlCenter").value="0";
    } 
}

function callbindcentercode(res)
{

var ds=res.value;
var pkgitem = document.getElementById("ddlCenter");
 
if(ds!= null && typeof(ds) == "object" && ds.Tables[0].Rows.length > 0) 
{
        var pkgitem=document.getElementById('ddlCenter');
         pkgitem.options[0]=new Option("------Select Center------","0");
     
//var pkgitem = document.getElementById("drpcity");
//alert(pkgitem);
    pkgitem.options.length = 1; 
    //alert(pkgitem.options.length);
    for (var i = 0  ; i < res.value.Tables[0].Rows.length; ++i)
    {
        pkgitem.options[pkgitem.options.length] = new Option(res.value.Tables[0].Rows[i].Pub_Cent_Name,res.value.Tables[0].Rows[i].Pub_Cent_Code);
        
       pkgitem.options.length;
       
    }
      if(hid_gau_cent==undefined || hid_gau_cent=="")
    {
      document.getElementById("ddlCenter").value="0";
    }
    else
    {
      document.getElementById("ddlCenter").value=hid_gau_cent;
      hid_gau_cent="";
    }
   //filledition();
}
return false;
}

function filledition(cent)
{
   
        var compcode=document.getElementById('hiddencompcode').value;
        document.getElementById("ddlSupplement").options.length=1;
        document.getElementById("ddlSupplement").value="0";
   
     if(typeof(cent)=="object")
    {
       var centercode=cent.value;
    }
    else
    {
      var centercode=cent;
    }
     if(centercode!="0")
    {
   
        var pubcode=document.getElementById('ddlPublication').value;
        var userid=document.getElementById('hiddenuserid').value;
        DefaultPageConfigurationMaster.addeditioncode(centercode,compcode,pubcode,callbind); 
    }
    else
    { 
      document.getElementById("ddlEdition").value="0";
      document.getElementById("ddlEdition").options.length="1";
    }

}

function callbind(res)
{

var ds=res.value;
var pkgitem = document.getElementById("ddlEdition");
 
if(ds!= null && typeof(ds) == "object" && ds.Tables[0].Rows.length > 0) 
{
        var pkgitem=document.getElementById('ddlEdition');
         pkgitem.options[0]=new Option("------Select Edititon------","0");
     

    pkgitem.options.length = 1; 
    
    for (var i = 0  ; i < res.value.Tables[0].Rows.length; ++i)
    {
        pkgitem.options[pkgitem.options.length] = new Option(res.value.Tables[0].Rows[i].Edition_alias,res.value.Tables[0].Rows[i].edition_code);
        
       pkgitem.options.length;
       
    }
    
      if(hid_gau_edi==undefined || hid_gau_edi=="")
    {
      document.getElementById("ddlEdition").value="0";
    }
    else
    {
      document.getElementById("ddlEdition").value=hid_gau_edi;
      
      hid_gau_edi="";
    }
 
}
   else
   {
    alert("There is No Matching value Found");
    pkgitem.options.length=1;
    return false;
   }

return false;
}



/*function filledition()
{
    var centercode=document.getElementById('ddlCenter').value;
    var pubcode=document.getElementById('ddlPublication').value;
    var userid=document.getElementById('hiddenuserid').value;
    var compcode=document.getElementById('hiddencompcode').value;
     if(centercode=="0")
    {
      centercode=hid_gau_cent;
    }
     DefaultPageConfigurationMaster.addeditioncode(centercode,compcode,pubcode,callbind); 
}

function callbind(res)
{

var ds=res.value;
var pkgitem = document.getElementById("ddlEdition");
 
if(ds!= null && typeof(ds) == "object" && ds.Tables[0].Rows.length > 0) 
{
        var pkgitem=document.getElementById('ddlEdition');
         pkgitem.options[0]=new Option("------Select Edititon------","0");
     

    pkgitem.options.length = 1; 
   
    for (var i = 0  ; i < res.value.Tables[0].Rows.length; ++i)
    {
        pkgitem.options[pkgitem.options.length] = new Option(res.value.Tables[0].Rows[i].Edition_alias,res.value.Tables[0].Rows[i].edition_code);
        
       pkgitem.options.length;
       
    }
 
}

if(global_ds !=null)
{
           document.getElementById('ddlPublication').value=global_ds.Tables[0].Rows[row_num].pri_pub;
           document.getElementById('ddlPublication').disabled=true; 
           document.getElementById('ddlCenter').value=global_ds.Tables[0].Rows[row_num].pub_center;
           document.getElementById('ddlCenter').disabled=true;
          
           document.getElementById('ddlEdition').value=global_ds.Tables[0].Rows[row_num].edition_code;
           document.getElementById('ddlEdition').disabled=true;
           fillsupp();

}
return false;
}*/


function fillsupp(edi)
{
      document.getElementById('ddlSupplement').value="0";
      document.getElementById('ddlSupplement').options.length="1";
      var flag;
     if(document.getElementById('Rdbt1').checked == true)
       flag="MAIN";
     else 
        flag="Supplement";
    if(typeof(edi)=="object")
    {
      
       var editioncode=edi.value;
    }
    else
    {
      var editioncode=edi;
    }
    if(editioncode !="0")
    {
        var compcode=document.getElementById('hiddencompcode').value;
      
        var userid=document.getElementById('hiddenuserid').value;
       DefaultPageConfigurationMaster.addsecpubcode(compcode,userid,editioncode,flag,callbindsecpubcode); 
    }
    else
    {
       document.getElementById('ddlSupplement').value="0";
       document.getElementById('ddlSupplement').options.length="1";
    }
   
}


function callbindsecpubcode(res)
{

    var ds=res.value;
    var pkgitem = document.getElementById("ddlSupplement");
     
    if(ds!= null && typeof(ds) == "object" && ds.Tables[0].Rows.length > 0) 
    {
         var pkgitem=document.getElementById('ddlSupplement');
         pkgitem.options[0]=new Option("------Select Supplement------","0");
         pkgitem.options.length = 1; 
         
        if(ds.Tables[0].Rows[0].Edition_Type !=null && ds.Tables[0].Rows[0].Edition_Type == "Main Edition")
        {
            pkgitem.options[pkgitem.options.length] = new Option("MAIN","MN");
            pkgitem.options.length;
        }
        else if(ds.Tables[0].Rows[0].Edition_Type !=null && ds.Tables[0].Rows[0].Edition_Type == "Edition")
        {
            pkgitem.options[pkgitem.options.length] = new Option("MAIN","MN");
            pkgitem.options.length;   
        }
        else
        {
             for (var i = 0  ; i < res.value.Tables[0].Rows.length; ++i)
            {
                pkgitem.options[pkgitem.options.length] = new Option(res.value.Tables[0].Rows[i].Supp_Name,res.value.Tables[0].Rows[i].Supp_Code);
                pkgitem.options.length;
            }
        }
        if(hid_gau_sup == undefined || hid_gau_sup=="")
         {
             document.getElementById('ddlSupplement').value="0";
         
         }
         else
         {
              document.getElementById('ddlSupplement').value=hid_gau_sup;
              hid_gau_sup="";
         }  
 
}

return false;
}



/*function fillsupp()
{
    var compcode=document.getElementById('hiddencompcode').value;
    var editioncode=document.getElementById('ddlEdition').value;
    var userid=document.getElementById('hiddenuserid').value;
    DefaultPageConfigurationMaster.addsecpubcode(compcode,userid,editioncode,callbindsecpubcode); 
}

function callbindsecpubcode(res)
{

var ds=res.value;
var pkgitem = document.getElementById("ddlSupplement");
 
if(ds!= null && typeof(ds) == "object" && ds.Tables[0].Rows.length > 0) 
{
     var pkgitem=document.getElementById('ddlSupplement');
     pkgitem.options[0]=new Option("------Select Supplement------","0");
  
     pkgitem.options.length = 1; 
     for (var i = 0  ; i < res.value.Tables[0].Rows.length; ++i)
    {
        pkgitem.options[pkgitem.options.length] = new Option(res.value.Tables[0].Rows[i].Supp_Name,res.value.Tables[0].Rows[i].Supp_Code);
        pkgitem.options.length;
       
    }
 
}
else
{
    pkgitem.options[0]=new Option("MAIN","MN");
    pkgitem.options.length=1;
    return false;
}
if(global_ds !=null)
{
   document.getElementById('ddlSupplement').value=global_ds.Tables[0].Rows[row_num].sub_pub;
   document.getElementById('ddlSupplement').disabled=true;
}
return false;
}*/


function queryclick()
{
    show="0";
    
    hiddentext="query";
    z=0;
    
    document.getElementById('hiddenstatuslabel').value="show";
    
            document.getElementById('ddlPublication').value="0";
			
			document.getElementById('ddlCenter').value="0";
			
			document.getElementById('ddlEdition').value="0";			
			
	        document.getElementById('ddlSupplement').value="0";				
			
			document.getElementById('ddlAdFilling').value="0";

			document.getElementById('ddlNoofPage').value="0";
			
			document.getElementById('txtCategory').value="0";
		
			//document.getElementById('txtSubcategory').value="";
			
			//document.getElementById('txtPageno').value=0;
			document.getElementById('txtPageno').value="";
			document.getElementById('ddlPageHeading').value="";
			//drpregion.SelectedValue="0";
			
			document.getElementById('ddlPageColor').value="0";
			
			document.getElementById('txtPageVolume').value="";
			
		//	document.getElementById('txtPageHeight').value="0";
			document.getElementById('txtPageHeight').value="";
			//document.getElementById('txtPageWidth').value="0";
			document.getElementById('txtPageWidth').value="";
			document.getElementById('ddlPremiumRequired').value="0";
			//document.getElementById('ddlPaginationCode').value="";
	
			//document.getElementById('txtStartingRow').value="0";
			document.getElementById('txtStartingRow').value="";
			//document.getElementById('txtStartingCol').value="0";
			document.getElementById('txtStartingCol').value="";
			//document.getElementById('txtMadAdAllow').value="0";
			document.getElementById('txtMadAdAllow').value="";
			document.getElementById('txtSharepageStatus').value="0";
			
			document.getElementById('txtSharePageno').value="";


			document.getElementById('txtValidateDateFrom').value="";
			document.getElementById('txtValidateDateTo').value="";
			document.getElementById('ddlHouseAdRequired').value="0";
			//////////////////////////
       
        document.getElementById('ddlPublication').disabled = false;
        document.getElementById('ddlCenter').disabled = false;
        document.getElementById('ddlEdition').disabled = false;
        document.getElementById('ddlSupplement').disabled = false;
        document.getElementById('ddlAdFilling').disabled = false;
        document.getElementById('ddlNoofPage').disabled = false;
        document.getElementById('txtPageno').disabled = false;
        document.getElementById('ddlPageColor').disabled = false;
        document.getElementById('ddlPremiumRequired').disabled = false;
        document.getElementById('txtCategory').disabled=false
        document.getElementById('txtMadAdAllow').disabled=false;
        document.getElementById('txtPageHeight').disabled=false;
        document.getElementById('txtPageWidth').disabled=false;
        document.getElementById('txtPageVolume').disabled=false;
        document.getElementById('txtSharePageno').disabled=false;
        document.getElementById('txtSharepageStatus').disabled=false;
        document.getElementById('txtStartingCol').disabled=false;
        document.getElementById('txtStartingRow').disabled=false;
   //     document.getElementById('txtSubcategory').disabled=false;
        document.getElementById('txtValidateDateFrom').disabled=false;
        document.getElementById('txtValidateDateTo').disabled=false;
        document.getElementById('ddlHouseAdRequired').disabled=false;
       ////////////////////////////////////////////////////////////////////
			
			document.getElementById('btnNew').disabled=true;
			document.getElementById('btnSave').disabled=true;
			document.getElementById('btnQuery').disabled=true;						
			
			document.getElementById('btnModify').disabled=true;
			
			document.getElementById('btnfirst').disabled=true;
			
			document.getElementById('btnprevious').disabled=true;
			document.getElementById('btnnext').disabled=true;
			document.getElementById('btnlast').disabled=true;
			document.getElementById('btnDelete').disabled=true;
			document.getElementById('btnExecute').disabled=false;
			
			document.getElementById('btnExit').disabled=false;
			setButtonImages();
			return false;
}


    function cancelClick()
    {
        hiddentext="cancel";
        row_num=0;
            		
		document.getElementById('ddlPublication').value="0";			
		document.getElementById('ddlCenter').value="0";			
		document.getElementById('ddlEdition').value="0";
	    document.getElementById('ddlSupplement').value="0";
		document.getElementById('ddlAdFilling').value="0";
		document.getElementById('ddlNoofPage').value="0";			
		document.getElementById('txtCategory').value="0";		
		//document.getElementById('txtSubcategory').value="";			
		document.getElementById('txtPageno').value="";
			
		document.getElementById('ddlPageHeading').value="";						
		document.getElementById('ddlPageColor').value="0";			
		document.getElementById('txtPageVolume').value="";			
		document.getElementById('txtPageHeight').value="";			
		document.getElementById('txtPageWidth').value="";
		document.getElementById('ddlPremiumRequired').value="0";
		//document.getElementById('ddlPaginationCode').value="";
	
		document.getElementById('txtStartingRow').value="";
		document.getElementById('txtMadAdAllow').value="";
		document.getElementById('txtMaxAdSize').value="";		
		document.getElementById('txtStartingCol').value="";
			
		document.getElementById('txtSharepageStatus').value="0";
			
		document.getElementById('txtSharePageno').value="";

		document.getElementById('txtValidateDateFrom').value="";
		document.getElementById('txtValidateDateTo').value="";
		document.getElementById('ddlHouseAdRequired').value="0";
		
		//////////////////////////
       
        document.getElementById('ddlPublication').disabled = true;
        document.getElementById('ddlCenter').disabled = true;
        document.getElementById('ddlEdition').disabled = true;
        document.getElementById('ddlSupplement').disabled = true;
        document.getElementById('ddlAdFilling').disabled = true;
        document.getElementById('ddlNoofPage').disabled = true;
        document.getElementById('txtPageno').disabled = true;
        document.getElementById('ddlPageColor').disabled = true;
        document.getElementById('ddlPremiumRequired').disabled = true;
        document.getElementById('txtCategory').disabled=true
        document.getElementById('txtMadAdAllow').disabled=true;
        document.getElementById('txtPageHeight').disabled=true;
        document.getElementById('txtPageWidth').disabled=true;
        document.getElementById('txtPageVolume').disabled=true;
        document.getElementById('txtSharePageno').disabled=true;
        document.getElementById('txtSharepageStatus').disabled=true;
        document.getElementById('txtStartingCol').disabled=true;
        document.getElementById('txtStartingRow').disabled=true;
     //   document.getElementById('txtSubcategory').disabled=true;
        document.getElementById('txtValidateDateFrom').disabled=true;
        document.getElementById('txtValidateDateTo').disabled=true;
        document.getElementById('ddlHouseAdRequired').disabled=true;
        document.getElementById('ddlPageHeading').disabled = true;
         document.getElementById('txtMaxAdSize').disabled=true;
       ////////////////////////////////////////////////////////////////////
        
		
		//document.getElementById('hiddentxt').value="";
        document.getElementById('btnNew').disabled=false;        
        document.getElementById('btnSave').disabled=true;        
        document.getElementById('btnQuery').disabled=false;		
					
		document.getElementById('btnModify').disabled=true;			
		document.getElementById('btnExecute').disabled=true;
		
		document.getElementById('btnfirst').disabled=true;
			
		document.getElementById('btnprevious').disabled=true;
		document.getElementById('btnnext').disabled=true;
		document.getElementById('btnlast').disabled=true;
		//////////////////////////////////////////////////////////////////
		setButtonImages();	
		return false;
    }
    
    function newClick()
    {
       global_ds=null;
        show="1";
                
        //document.getElementById('hiddenexecute').value="";
       //////////////////////////
//        document.getElementById('Rdbt1').disabled = false;
//        document.getElementById('Rdbt2').disabled = false;
        document.getElementById('ddlPublication').disabled = false;
        document.getElementById('ddlCenter').disabled = false;
        document.getElementById('ddlEdition').disabled = false;
        document.getElementById('ddlSupplement').disabled = false;
        document.getElementById('ddlAdFilling').disabled = false;
        document.getElementById('ddlNoofPage').disabled = false;
        document.getElementById('txtPageno').disabled = false;
        document.getElementById('ddlPageColor').disabled = false;
        document.getElementById('ddlPageHeading').disabled = false;
        document.getElementById('ddlPremiumRequired').disabled = false;
        document.getElementById('txtCategory').disabled=false
        document.getElementById('txtMadAdAllow').disabled=false;
        document.getElementById('txtPageHeight').disabled=false;
        document.getElementById('txtPageWidth').disabled=false;
        document.getElementById('txtPageVolume').disabled=false;
        document.getElementById('txtSharePageno').disabled=false;
        document.getElementById('txtSharepageStatus').disabled=false;
        document.getElementById('txtStartingCol').disabled=false;
        document.getElementById('txtStartingRow').disabled=false;
     //   document.getElementById('txtSubcategory').disabled=false;
        document.getElementById('txtValidateDateFrom').disabled=false;
        document.getElementById('txtValidateDateTo').disabled=false;
       document.getElementById('ddlHouseAdRequired').disabled=false;
       document.getElementById('txtMaxAdSize').disabled=false;
        

       ////////////////////////////////////////////////////////////////////
      
        document.getElementById('ddlHouseAdRequired').value="0";
        document.getElementById('ddlPublication').value="0";
			
		document.getElementById('ddlCenter').value="0";
			
		document.getElementById('ddlEdition').value="0";			
			
	    document.getElementById('ddlSupplement').value="0";				
			
		document.getElementById('ddlAdFilling').value="0";

		document.getElementById('ddlNoofPage').value="0";
			
		document.getElementById('txtCategory').value="0";
		
		//document.getElementById('txtSubcategory').value="";
			
		document.getElementById('txtPageno').value="";
			
		document.getElementById('ddlPageHeading').value="";
						
		document.getElementById('ddlPageColor').value="0";
			
		document.getElementById('txtPageVolume').value="";
			
		document.getElementById('txtPageHeight').value="";
			
		document.getElementById('txtPageWidth').value="";
		document.getElementById('ddlPremiumRequired').value="0";
		//document.getElementById('ddlPaginationCode').value="";
	
		document.getElementById('txtStartingRow').value="";
		document.getElementById('txtMadAdAllow').value="";
		document.getElementById('txtMaxAdSize').value="";	
		document.getElementById('txtStartingCol').value="";
			
		document.getElementById('txtSharepageStatus').value="0";
			
		document.getElementById('txtSharePageno').value="";

		document.getElementById('txtValidateDateFrom').value="";
		document.getElementById('txtValidateDateTo').value="";
		
		//document.getElementById('hiddentxt').value="";
        document.getElementById('btnNew').disabled=true;
        
        document.getElementById('btnSave').disabled=false;
        
        document.getElementById('btnQuery').disabled=true;
			
		document.getElementById('btnNew').disabled=true;
			
		document.getElementById('btnModify').disabled=true;
			
		document.getElementById('btnExecute').disabled=true;
			
		hiddentext="new";
		setButtonImages();	
		return false;
		
    }
    
    
       
//save click for save value in pagestatus master
function saveclick()
{
     auto=document.getElementById('hiddenauto').value;
  
    if(document.getElementById('ddlPublication').value=="" || document.getElementById('ddlPublication').value=="0")
     {
        alert("Please Select Publication ");
        document.getElementById('ddlPublication').focus();
        return false;
     }

     if(document.getElementById('ddlCenter').value =="" || document.getElementById('ddlCenter').value =="0")
     {
         alert("Please Select Printing Center");
         document.getElementById('ddlCenter').focus();
         return(false);
     }

     if(document.getElementById('ddlEdition').value == "" || document.getElementById('ddlEdition').value == "0")
     {
         alert("Please Select Edition");
         document.getElementById('ddlEdition').focus();
         return(false);
     }
           
     if(document.getElementById('ddlSupplement').value == "" || document.getElementById('ddlSupplement').value == "0")
     {
         alert("Please Select Supplement");
         document.getElementById('ddlSupplement').focus();
         return(false);
     }
     if(document.getElementById('ddlAdFilling').value =="" || document.getElementById('ddlAdFilling').value =="0")
     {
         alert("Please Select Page Flow ");
         document.getElementById('ddlAdFilling').focus();
         return(false);
     }
           

     if(document.getElementById('txtPageno').value == "0")
     {
         alert("Please enter the page number.");
         document.getElementById('txtPageno').focus();
         return(false);
     }

     if(document.getElementById('ddlNoofPage').value =="" || document.getElementById('ddlNoofPage').value =="0")
     {
         alert("Please Select No. of pages");
         document.getElementById('ddlNoofPage').focus();
         return(false);
     }

     if(document.getElementById('ddlPageColor').value =="" || document.getElementById('ddlPageColor').value =="0")
     {
         alert("Please Select Page Color");
         document.getElementById('ddlPageColor').focus();
         return(false);
     } 
      
     if(document.getElementById('ddlPageHeading').value =="" || document.getElementById('ddlPageHeading').value =="0")
     {
         alert("Please Enter PageHeading");
         document.getElementById('ddlPageHeading').focus();
         return(false);
     }
        
//        if(document.getElementById('ddlHouseAdRequired').value =="" || document.getElementById('ddlHouseAdRequired').value =="0")
//     {
//         alert("Please Select HouseAd");
//         document.getElementById('ddlHouseAdRequired').focus();
//         return(false);
//     }
             
     if(document.getElementById('txtPageHeight').value =="0")
     {
         alert("Please Enter Page height");
         document.getElementById('txtPageHeight').focus();
         return(false);
     }
            
     if(document.getElementById('txtPageWidth').value =="0")
     {
         alert("Please Enter Page width");
         document.getElementById('txtPageWidth').focus();
         return(false);
     }
            
     if(document.getElementById('txtStartingRow').value =="0")
     {
         alert("Please Enter Start Row");
         document.getElementById('txtStartingRow').focus();
         return(false);
     }
            
     if(document.getElementById('txtStartingCol').value =="0")
     {
         alert("Please Enter Start Col");
         document.getElementById('txtStartingCol').focus();
         return(false);
     }
            
     if(document.getElementById('txtValidateDateFrom').value =="")
     {
          alert("Please Enter Date From");
          document.getElementById('txtValidateDateFrom').focus();
          return(false);
     }
            
     if(document.getElementById('txtValidateDateTo').value =="")
     {
           alert("Please Enter Date To");
           document.getElementById('txtValidateDateTo').focus();
           return(false);
     }
    
       if(document.getElementById('txtValidateDateFrom').value > document.getElementById('txtValidateDateTo').value)
     {
       alert("FromDate Can Not Be Greater Than ToDate");
       return(false);
     }
     
        //dan
     var strtextd="";
     var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('Session Expired ! Please Login Again.');
       window.location.href="Login.aspx";
       return false;
       }      
            
			/*
			if(dateformat=="mm/dd/yyyy")
			{
			    var txtenrolldate=document.getElementById('txtenrolldate').value;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			    var txt=document.getElementById('txtenrolldate').value;
			    var txt1=txt.split("/");
			    var dd=txt1[0];
			    var mm=txt1[1];
			    var yy=txt1[2];
			    var txtenrolldate=mm+'/'+dd+'/'+yy;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			    var txt=document.getElementById('txtenrolldate').value;
			    var txt1=txt.split("/");
			    var yy=txt1[0];
			    var mm=txt1[1];
			    var dd=txt1[2];
			    var txtenrolldate=mm+'/'+dd+'/'+yy;
			}
			if(dateformat==null || dateformat=="" || dateformat=="undefined")
			{
			var txtenrolldate=document.getElementById('txtenrolldate').value;
			}
			
			
			if(dateformat=="mm/dd/yyyy")
			{
			var txtbussinessdate=document.getElementById('txtbusineedate').value;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			var txt=document.getElementById('txtbusineedate').value;
			var txt1=txt.split("/");
			var dd=txt1[0];
			var mm=txt1[1];
			var yy=txt1[2];
			var txtbussinessdate=mm+'/'+dd+'/'+yy;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			var txt=document.getElementById('txtbusineedate').value;
			var txt1=txt.split("/");
			var yy=txt1[0];
			var mm=txt1[1];
			var dd=txt1[2];
			var txtbussinessdate=mm+'/'+dd+'/'+yy;
			}
			if(dateformat==null || dateformat=="" || dateformat=="undefined")
			{
			var txtbussinessdate=document.getElementById('txtbusineedate').value;
			}
			*/
						
			/*
			if(document.getElementById('hiddenpermission').value=="5")
			{
			document.getElementById('btnQuery').disabled=true;
			document.getElementById('btnDelete').disabled=false;
			}
			else
			{
			}
			
			if(document.getElementById('hiddenpermission').value=="1")
			{
			document.getElementById('btnQuery').disabled=true;
			}
			else
			{
			
			}
			
			document.getElementById('btnDelete').disabled=true;
			if(document.getElementById('hiddenpermission').value=="2")
			{			
			    document.getElementById('btnDelete').disabled=true;			
			}
			else
			{
			
			}*/
			
			if(hiddentext=="modify")
			{
			    var compcode=document.getElementById('hiddencompcode').value;
                var pub=document.getElementById('ddlPublication').value;
                var pubcenter=document.getElementById('ddlCenter').value;
                var edition=document.getElementById('ddlEdition').value;
                var supp=document.getElementById('ddlSupplement').value;
                var ladder=document.getElementById('ddlAdFilling').value;
                var pgnumber=document.getElementById('txtpageno').value;
                var category=document.getElementById('txtCategory').value;
              // var subcategory=document.getElementById('txtSubcategory').value;
                var pageset=document.getElementById('ddlNoofPage').value;
                var pagecolor=document.getElementById('ddlPageColor').value;

                var pageheading=document.getElementById('ddlPageHeading').value;
                var pagevolume=document.getElementById('txtPageVolume').value;
                var pageheight=document.getElementById('txtPageHeight').value;
                var pagewidth=document.getElementById('txtPagewidth').value;
                var maxad=document.getElementById('txtMadAdAllow').value;
                var strow=document.getElementById('txtStartingRow').value;
                var stcol=document.getElementById('txtStartingCol').value;
                //document.getElementById('txtSharepageStatus').value;
                //document.getElementById('txtSharePageno').value;
                var dt_from=document.getElementById('txtValidateDateFrom').value;
                var dt_to=document.getElementById('txtValidateDateTo').value;
                var dateformat=document.getElementById('hiddendateformat').value;
                var ddlPremiumRequired=document.getElementById('ddlPremiumRequired').value;
                
			    DefaultPageConfigurationMaster.ModifyRecord(compcode,pub,pubcenter,edition,supp,ladder,pgnumber,category,pageset,pagecolor,pageheading,pageheight,pagewidth,maxad,strow,stcol,dt_from,dt_to,pagevolume,dateformat,ddlPremiumRequired); 
			     alert('Update Records successfully.');
			     
			    document.getElementById('ddlPublication').disabled = true;
                document.getElementById('ddlCenter').disabled = true;
                document.getElementById('ddlEdition').disabled = true;
                document.getElementById('ddlSupplement').disabled = true;
                document.getElementById('ddlAdFilling').disabled = true;
                document.getElementById('ddlNoofPage').disabled = true;
                document.getElementById('txtPageno').disabled = true;
                document.getElementById('ddlPageColor').disabled = true;
                document.getElementById('ddlPremiumRequired').disabled = true;
                document.getElementById('txtCategory').disabled=true
                document.getElementById('txtMadAdAllow').disabled=true;
                document.getElementById('txtPageHeight').disabled=true;
                document.getElementById('txtPageWidth').disabled=true;
                document.getElementById('txtPageVolume').disabled=true;
                document.getElementById('txtSharePageno').disabled=true;
                document.getElementById('txtSharepageStatus').disabled=true;
                document.getElementById('txtStartingCol').disabled=true;
                document.getElementById('txtStartingRow').disabled=true;
             //   document.getElementById('txtSubcategory').disabled=true;
                document.getElementById('txtValidateDateFrom').disabled=true;
                document.getElementById('txtValidateDateTo').disabled=true;
                document.getElementById('ddlHouseAdRequired').disabled=true;
                document.getElementById('ddlPageHeading').disabled = true;
               ////////////////////////////////////////////////////////////////////
                
            	
	            document.getElementById('btnDelete').disabled=false;
                document.getElementById('btnNew').disabled=true;        
                document.getElementById('btnSave').disabled=true;        
                document.getElementById('btnQuery').disabled=false;		
            				
	            document.getElementById('btnModify').disabled=false;			
	            document.getElementById('btnExecute').disabled=true;
		
		 if(global_ds.Tables[0].Rows.length==1)
         {
            //document.getElementById('btnModify').disabled=false;
            document.getElementById('btnFirst').disabled=true;
            document.getElementById('btnPrevious').disabled=true;
            document.getElementById('btnNext').disabled=true;
            document.getElementById('btnLast').disabled=true;
         }
         else
         {
             if(row_num==0)
             {
               // document.getElementById('btnModify').disabled=false;
                document.getElementById('btnFirst').disabled=true;
                document.getElementById('btnPrevious').disabled=true;
                document.getElementById('btnNext').disabled=false;
                document.getElementById('btnLast').disabled=false;
             }
             else if(row_num==global_ds.Tables[0].Rows.length)
            {
                document.getElementById('btnfirst').disabled=false;
                document.getElementById('btnprevious').disabled=false;
                document.getElementById('btnnext').disabled=true;
                document.getElementById('btnlast').disabled=true;
            }
            
            else
            {
                document.getElementById('btnfirst').disabled=false;
                document.getElementById('btnprevious').disabled=false;
                document.getElementById('btnnext').disabled=false;
                document.getElementById('btnlast').disabled=false;
            }
          }
			     setButtonImages();
			    return false;
			}
			
			checkExistingRecord();
			document.getElementById('btnSave').disabled=false;
			return false;
			
}


//check for entry
    function checkExistingRecord()
    {
        if(hiddentext=="new")
        {        
            var compcode=document.getElementById('hiddencompcode').value;
            var userid=document.getElementById('hiddenuserid').value;
            var pubcode=document.getElementById('ddlPublication').value;
            var centercode=document.getElementById('ddlCenter').value;
            var editioncode=document.getElementById('ddlEdition').value;
            var suppcode=document.getElementById('ddlSupplement').value;
            var pageno=document.getElementById('txtPageno').value;
            var noofpages=document.getElementById('ddlNoofPage').value;
            DefaultPageConfigurationMaster.bkunit(compcode,pubcode,centercode,editioncode,suppcode,pageno,noofpages,callbackEntryexists);            
        }

       // return false;
    }
    
    function callbackEntryexists(response)
    {
        var ds_1=response.value;
        if(ds_1==null)
            return false;
        if(ds_1.Tables[0].Rows.length!=0)
        {
            alert('Record already exists.');
            return false;
        }
        else
        {
            var compcode=document.getElementById('hiddencompcode').value;
            var userid=document.getElementById('hiddenuserid').value;
            
            var ddlpubcode=document.getElementById('ddlPublication').value;
            var ddlpubname=document.getElementById('ddlPublication').options[document.getElementById('ddlPublication').selectedIndex].text;
            
			var ddlcentercode=document.getElementById('ddlCenter').value;
			var ddlcentername=document.getElementById('ddlCenter').options[document.getElementById('ddlCenter').selectedIndex].text;
			
			var ddleditioncode=document.getElementById('ddlEdition').value;
			var ddleditionname=document.getElementById('ddlEdition').options[document.getElementById('ddlEdition').selectedIndex].text;
			
			var ddlsuppcode=document.getElementById('ddlSupplement').value;		
			var ddlsuppname=document.getElementById('ddlSupplement').options[document.getElementById('ddlSupplement').selectedIndex].text;
						
			var ddlpgno=document.getElementById('txtPageno').value;
			var ddlladder=document.getElementById('ddlAdFilling').value;
			var ddlIssuePage=document.getElementById('ddlNoofPage').value;
			
			var txtadctg=document.getElementById('txtCategory').value;
			//document.getElementById('txtSubcategory').value=document.getElementById('txtSubcategory').value.toUpperCase();
			//var txtadsubctg=document.getElementById('txtSubcategory').value;
			document.getElementById('ddlPageHeading').value=document.getElementById('ddlPageHeading').value.toUpperCase();
			var ddlpgheading=document.getElementById('ddlPageHeading').value;
			var ddlpgcolor=document.getElementById('ddlPageColor').value;
			
			var txtpgheight=document.getElementById('txtPageHeight').value;			
			var txtpgwidth=document.getElementById('txtPageWidth').value;
			var txtstrow=document.getElementById('txtStartingRow').value;
			var txtstcol=document.getElementById('txtStartingCol').value;
			
			var txtpgvolume=document.getElementById('txtPageVolume').value;
			var txtmaxadallow=document.getElementById('txtMadAdAllow').value;
			//var txtMaxAdSize=document.getElementById('txtMadAdAllow').value;
			var txtsharepgstatus=document.getElementById('txtSharePageStatus').value;
			var ddlPremiumRequired=document.getElementById('ddlPremiumRequired').value;
			var txtsharepgno=document.getElementById('txtSharePageNo').value;
			var txtvalidfromdate=document.getElementById('txtValidateDateFrom').value;
			var txtvalidtodate=document.getElementById('txtValidateDateTo').value;
			var dateformat=document.getElementById('hiddendateformat').value;
			var ddlHouseAdRequired=document.getElementById('ddlHouseAdRequired').value;
			var txtadsubctg="0";
			
			DefaultPageConfigurationMaster.SavenewRecord(compcode,userid,ddlpubcode,ddlcentercode,ddleditioncode,ddlsuppcode,ddlpgno,ddlladder,ddlIssuePage,txtadctg,txtadsubctg,ddlpgheading,ddlpgcolor,txtpgheight,txtpgwidth,txtstrow,txtstcol,txtpgvolume,txtsharepgstatus,txtsharepgno,txtmaxadallow,txtvalidfromdate,txtvalidtodate,dateformat,ddlPremiumRequired,ddlHouseAdRequired);
		    alert('Records Saved Successfully.');
		    cancelClick();	
            return false;
		  	
        }
    
    }
    
    
       function Executeclick()
    {
        if(hiddentext="query")
        {
           if(document.getElementById('Rdbt1').checked == true)
           flag="MAIN";
           else 
           flag="Supplement";
            var dateformat=document.getElementById('hiddendateformat').value;      
            var compcode=document.getElementById('hiddencompcode').value;           
            var pubcode=document.getElementById('ddlPublication').value;
            var centercode=document.getElementById('ddlCenter').value;
            var editioncode=document.getElementById('ddlEdition').value;
            var suppcode=document.getElementById('ddlSupplement').value;
            var pageno=document.getElementById('txtPageno').value;
            var noofpages=document.getElementById('ddlNoofPage').value;
            var ddlpgcolor=document.getElementById('ddlPageColor').value;
            var ddlPremiumRequired=document.getElementById('ddlPremiumRequired').value;
           	var ddlHouseAdRequired=document.getElementById('ddlHouseAdRequired').value;
            
            glcompcode=document.getElementById('hiddencompcode').value; 
            glpubcode=document.getElementById('ddlPublication').value; 
            glcentercode=document.getElementById('ddlCenter').value; 
            gleditioncode=document.getElementById('ddlEdition').value; 
            glsuppcode=document.getElementById('ddlSupplement').value; 
            glpageno=document.getElementById('txtPageno').value;
            glnoofpages=document.getElementById('ddlNoofPage').value; 
            glddlpgcolor=document.getElementById('ddlPageColor').value;
            glddlPremiumRequired=document.getElementById('ddlPremiumRequired').value;
           // ddlHouseAdRequired=document.getElementById('ddlHouseAdRequired').value;
              //dan
     var strtextd="";
     var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('Session Expired ! Please Login Again.');
       window.location.href="Login.aspx";
       return false;
       }      
            
            DefaultPageConfigurationMaster.ExecuteRecord(compcode,pubcode,centercode,editioncode,suppcode,pageno,noofpages,ddlpgcolor,ddlPremiumRequired, flag, dateformat, callbackExecuteRecord);
            return false;
        }
    }
    
    //execute record's store in global dataset
    function callbackExecuteRecord(response)
    {
        global_ds=response.value;
        if(global_ds==null)
            return false;
            
        if(global_ds.Tables[0].Rows.length==0)
        {
            alert("This Search Criteria Does Not Exist.");
            return false;
        }
         if(global_ds.Tables[0].Rows.length!=0)
         {
           document.getElementById('btnExecute').disabled=true;
           document.getElementById('btnModify').disabled=false;
           document.getElementById('btnDelete').disabled=false;
           
           document.getElementById('ddlPublication').value=global_ds.Tables[0].Rows[0].pri_pub;
           document.getElementById('ddlPublication').disabled=true;
           hid_gau_pub=global_ds.Tables[0].Rows[0].pri_pub; 
           hid_gau_cent=global_ds.Tables[0].Rows[0].pub_center;
           hid_gau_edi=global_ds.Tables[0].Rows[0].edition_code;
           hid_gau_sup=global_ds.Tables[0].Rows[0].sub_pub;
           //fillcentercode(hid_gau_pub);
           fillcentercode(global_ds.Tables[0].Rows[0].pri_pub);
           //document.getElementById('ddlCenter').value=global_ds.Tables[0].Rows[0].pub_center;
           document.getElementById('ddlCenter').disabled=true;
           filledition(global_ds.Tables[0].Rows[0].pub_center);
           //document.getElementById('ddlEdition').value=global_ds.Tables[0].Rows[0].edition_code;
           document.getElementById('ddlEdition').disabled=true;
           fillsupp(global_ds.Tables[0].Rows[0].edition_code);
           //document.getElementById('ddlSupplement').value=global_ds.Tables[0].Rows[0].sub_pub;
           document.getElementById('ddlSupplement').disabled=true;
          
           document.getElementById('ddlAdFilling').value=global_ds.Tables[0].Rows[0].ladder_status;
           document.getElementById('ddlAdFilling').disabled=true;
           document.getElementById('txtpageno').value=global_ds.Tables[0].Rows[0].page_no;
           document.getElementById('txtpageno').disabled=true;
           document.getElementById('txtCategory').value=global_ds.Tables[0].Rows[0].priadctg;
           document.getElementById('txtCategory').disabled=true;
           if((global_ds.Tables[0].Rows[0].secadctg!="") &&(global_ds.Tables[0].Rows[0].secadctg!=null))
           {
             //document.getElementById('txtSubcategory').value=global_ds.Tables[0].Rows[0].secadctg;
           }
           else
           {
             //document.getElementById('txtSubcategory').value="";
           }
           //document.getElementById('txtSubcategory').disabled=true;
           document.getElementById('ddlNoofPage').value=global_ds.Tables[0].Rows[0].no_of_pages;
           document.getElementById('ddlNoofPage').disabled=true;
           document.getElementById('ddlPageColor').value=global_ds.Tables[0].Rows[0].page_colour;
           document.getElementById('ddlPageColor').disabled=true;
          
           document.getElementById('ddlPageHeading').value=global_ds.Tables[0].Rows[0].page_heading;
           document.getElementById('ddlPageHeading').disabled=true;
           if((global_ds.Tables[0].Rows[0].ad_volume!="") && (global_ds.Tables[0].Rows[0].ad_volume!=null))
           {
             document.getElementById('txtPageVolume').value=global_ds.Tables[0].Rows[0].ad_volume;
           }
           else
           {
             document.getElementById('txtPageVolume').value="";
           }
           
           document.getElementById('txtPageVolume').disabled=true;
           document.getElementById('txtPageHeight').value=global_ds.Tables[0].Rows[0].max_row;
           document.getElementById('txtPageHeight').disabled=true;
           document.getElementById('txtPagewidth').value=global_ds.Tables[0].Rows[0].max_col;
           document.getElementById('txtPagewidth').disabled=true;
           if(global_ds.Tables[0].Rows[0].max_ad==null)
           { 
               document.getElementById('txtMadAdAllow').value="";
               document.getElementById('txtMadAdAllow').disabled=true;
           }
           else
           {
               document.getElementById('txtMadAdAllow').value=global_ds.Tables[0].Rows[0].max_ad;
               document.getElementById('txtMadAdAllow').disabled=true;
           }
           document.getElementById('txtStartingRow').value=global_ds.Tables[0].Rows[0].starting_row;
           document.getElementById('txtStartingRow').disabled=true;
           document.getElementById('txtStartingCol').value=global_ds.Tables[0].Rows[0].starting_col;
           document.getElementById('txtStartingCol').disabled=true;
           if((global_ds.Tables[0].Rows[0].share_page_status!="") &&(global_ds.Tables[0].Rows[0].share_page_status!=null))
           {
             document.getElementById('txtSharepageStatus').value=global_ds.Tables[0].Rows[0].share_page_status;
           }
           else
           {
             document.getElementById('txtSharepageStatus').value="";
           }
           document.getElementById('txtSharepageStatus').disabled=true;
           if((global_ds.Tables[0].Rows[0].share_page_no=="")||(global_ds.Tables[0].Rows[0].share_page_no==null))
           {
              document.getElementById('txtSharePageno').value="";
           }
           else
           {
             document.getElementById('txtSharePageno').value=global_ds.Tables[0].Rows[0].share_page_no;
            
           }
           
           document.getElementById('txtSharePageno').disabled=true;
           document.getElementById('txtValidateDateFrom').value=global_ds.Tables[0].Rows[0].valid_date_from;
           document.getElementById('txtValidateDateFrom').disabled=true;
           document.getElementById('txtValidateDateTo').value=global_ds.Tables[0].Rows[0].valid_date_to;  
           document.getElementById('txtValidateDateTo').disabled=true;   
           document.getElementById('ddlPremiumRequired').value=global_ds.Tables[0].Rows[0].premium; 
           document.getElementById('ddlPremiumRequired').disabled=true;  
           document.getElementById('ddlHouseAdRequired').value=global_ds.Tables[0].Rows[0].HouseAd; 
           document.getElementById('ddlHouseAdRequired').disabled=true;       
         }
         
         if(global_ds.Tables[0].Rows.length==1)
         {
            //document.getElementById('btnModify').disabled=false;
            document.getElementById('btnFirst').disabled=true;
            document.getElementById('btnPrevious').disabled=true;
            document.getElementById('btnNext').disabled=true;
            document.getElementById('btnLast').disabled=true;
         }
         else
         {
             if(row_num==0)
             {
               // document.getElementById('btnModify').disabled=false;
                document.getElementById('btnFirst').disabled=true;
                document.getElementById('btnPrevious').disabled=true;
                document.getElementById('btnNext').disabled=false;
                document.getElementById('btnLast').disabled=false;
             }
             else if(row_num==global_ds.Tables[0].Rows.length)
            {
                document.getElementById('btnfirst').disabled=false;
                document.getElementById('btnprevious').disabled=false;
                document.getElementById('btnnext').disabled=true;
                document.getElementById('btnlast').disabled=true;
            }
            
            else
            {
                document.getElementById('btnfirst').disabled=false;
                document.getElementById('btnprevious').disabled=false;
                document.getElementById('btnnext').disabled=false;
                document.getElementById('btnlast').disabled=false;
            }
          }
    setButtonImages();         
    }
    
    function bind_controls()
    {
           document.getElementById('ddlPublication').value=global_ds.Tables[0].Rows[row_num].pri_pub; 
               hid_gau_pub=global_ds.Tables[0].Rows[row_num].pri_pub; 
               hid_gau_cent=global_ds.Tables[0].Rows[row_num].pub_center;
               hid_gau_edi=global_ds.Tables[0].Rows[row_num].edition_code;
               hid_gau_sup=global_ds.Tables[0].Rows[row_num].sub_pub;
               fillcentercode(global_ds.Tables[0].Rows[row_num].pri_pub);
           
           //document.getElementById('ddlCenter').value=global_ds.Tables[0].Rows[row_num].pub_center;
           filledition(global_ds.Tables[0].Rows[row_num].pub_center);
           fillsupp(global_ds.Tables[0].Rows[row_num].edition_code);
//         document.getElementById('ddlEdition').value=global_ds.Tables[0].Rows[row_num].edition_code;
//         document.getElementById('ddlSupplement').value=global_ds.Tables[0].Rows[row_num].sub_pub;
           document.getElementById('ddlAdFilling').value=global_ds.Tables[0].Rows[row_num].ladder_status;
           document.getElementById('txtpageno').value=global_ds.Tables[0].Rows[row_num].page_no;
           document.getElementById('txtCategory').value=global_ds.Tables[0].Rows[row_num].priadctg;
            if((global_ds.Tables[0].Rows[row_num].secadctg!="") &&(global_ds.Tables[0].Rows[row_num].secadctg!=null))
           {
             //document.getElementById('txtSubcategory').value=global_ds.Tables[0].Rows[row_num].secadctg;;
           }
           else
           {
            // document.getElementById('txtSubcategory').value="";
           }
           
           document.getElementById('ddlNoofPage').value=global_ds.Tables[0].Rows[row_num].no_of_pages;
           document.getElementById('ddlPageColor').value=global_ds.Tables[0].Rows[row_num].page_colour;
          
           document.getElementById('ddlPageHeading').value=global_ds.Tables[0].Rows[row_num].page_heading;
            if((global_ds.Tables[0].Rows[row_num].ad_volume!="") && (global_ds.Tables[0].Rows[row_num].ad_volume!=null))
           {
             document.getElementById('txtPageVolume').value=global_ds.Tables[0].Rows[row_num].ad_volume;
           }
           else
           {
             document.getElementById('txtPageVolume').value="";
           }
           
           document.getElementById('txtPageHeight').value=global_ds.Tables[0].Rows[row_num].max_row;
           document.getElementById('txtPagewidth').value=global_ds.Tables[0].Rows[row_num].max_col;
            if(global_ds.Tables[0].Rows[row_num].max_ad==null)
              document.getElementById('txtMadAdAllow').value="";
            else
               document.getElementById('txtMadAdAllow').value=global_ds.Tables[0].Rows[row_num].max_ad;
                  
           document.getElementById('txtMadAdAllow').disabled=true;
          
           
           document.getElementById('txtStartingRow').value=global_ds.Tables[0].Rows[row_num].starting_row;
           document.getElementById('txtStartingCol').value=global_ds.Tables[0].Rows[row_num].starting_col;
            if((global_ds.Tables[0].Rows[row_num].share_page_status!="") &&(global_ds.Tables[0].Rows[row_num].share_page_status!=null))
           {
              document.getElementById('txtSharepageStatus').value=global_ds.Tables[0].Rows[row_num].share_page_status;
           }
           else
           {
             document.getElementById('txtSharepageStatus').value="";
           }
           document.getElementById('txtSharepageStatus').value=global_ds.Tables[0].Rows[row_num].share_page_status;
            if((global_ds.Tables[0].Rows[row_num].share_page_no=="")||(global_ds.Tables[0].Rows[row_num].share_page_no==null))
           {
             document.getElementById('txtSharePageno').value="";
           }
           else
           {
             document.getElementById('txtSharePageno').value=global_ds.Tables[0].Rows[row_num].share_page_no;
           }
           
           document.getElementById('txtValidateDateFrom').value=global_ds.Tables[0].Rows[row_num].valid_date_from;
           document.getElementById('txtValidateDateTo').value=global_ds.Tables[0].Rows[row_num].valid_date_to;
           document.getElementById('ddlPremiumRequired').value=global_ds.Tables[0].Rows[row_num].premium; 
           document.getElementById('ddlHouseAdRequired').value=global_ds.Tables[0].Rows[row_num].HouseAd; 
            
    }
    
 //****************Navigate to first record*****************************   
function adFirst()
{
    document.getElementById('btnfirst').disabled=true;
    document.getElementById('btnprevious').disabled=true;
    document.getElementById('btnnext').disabled=false;
    document.getElementById('btnlast').disabled=false;
    
    row_num=0;    

    bind_controls(); 
    setButtonImages();   
}

//****************Navigate to last record *****************************
function adLast()
{
    document.getElementById('btnfirst').disabled=false;
    document.getElementById('btnprevious').disabled=false;
    document.getElementById('btnnext').disabled=true;
    document.getElementById('btnlast').disabled=true;
    
    row_num=global_ds.Tables[0].Rows.length-1;    

    bind_controls();  
    setButtonImages();  
}

//****************Navigate to previous record *****************************
function adPrevious()
{
    row_num=row_num-1;
    
    document.getElementById('btnnext').disabled=false;
    document.getElementById('btnlast').disabled=false;

    if(row_num>=0)
       bind_controls();     
   
    
    row_num=row_num-1;
    if(row_num>=0)
    {
        row_num=row_num+1;
        setButtonImages();
        return false;
    }
    else
    {
        document.getElementById('btnprevious').disabled=true;
        document.getElementById('btnfirst').disabled=true;
        row_num=row_num+1;
    }
    setButtonImages();
    return false;   
}

//****************Navigate to next record******************************
function adNext()
{
    row_num=row_num+1;
    
    document.getElementById('btnprevious').disabled=false;
    document.getElementById('btnfirst').disabled=false;
    
    if(row_num<global_ds.Tables[0].Rows.length)
       bind_controls();
    
    row_num=row_num+1;
    if(row_num<global_ds.Tables[0].Rows.length)
    {
        row_num=row_num-1;
        setButtonImages();
        return false;
    }
    else
    {
        document.getElementById('btnnext').disabled=true;
        document.getElementById('btnlast').disabled=true;
        row_num=row_num-1;
    }
    setButtonImages();
    return false;
}

function ModifyClick()
{
        hiddentext="modify";
	    document.getElementById('ddlPublication').disabled=true;
	    document.getElementById('ddlCenter').disabled=true;
	    document.getElementById('ddlEdition').disabled=true;
	    document.getElementById('ddlSupplement').disabled=true;
        document.getElementById('ddlAdFilling').disabled=false;
        document.getElementById('txtpageno').disabled=true;
        document.getElementById('txtCategory').disabled=false;
       // document.getElementById('txtSubcategory').disabled=false;
//		var pcity=trim(document.getElementById('drpcity').value);
        document.getElementById('ddlNoofPage').disabled=false;
        document.getElementById('ddlPageColor').disabled=false;
        document.getElementById('ddlPageHeading').disabled=false;
        document.getElementById('txtPageVolume').disabled=false;
        document.getElementById('txtPageHeight').disabled=false;
        document.getElementById('txtPagewidth').disabled=false;
        document.getElementById('txtMadAdAllow').disabled=false;
        document.getElementById('txtStartingRow').disabled=false;
        document.getElementById('txtStartingCol').disabled=false;
        document.getElementById('txtSharepageStatus').disabled=true;
        document.getElementById('txtValidateDateFrom').disabled=false;
        document.getElementById('txtValidateDateTo').disabled=false;
        document.getElementById('ddlPremiumRequired').disabled=false;
		

			
		document.getElementById('btnSave').disabled = false;	
		document.getElementById('btnNew').disabled = true;	
		document.getElementById('btnQuery').disabled=true;
		document.getElementById('btnCancel').disabled = false;	
		document.getElementById('btnExit').disabled = false;	
		document.getElementById('btnModify').disabled=true;
		document.getElementById('btnfirst').disabled = true;	
		document.getElementById('btnnext').disabled = true;	
		document.getElementById('btnlast').disabled=true;
		document.getElementById('btnprevious').disabled=true;
		document.getElementById('btnDelete').disabled=true;
		document.getElementById('btnExecute').disabled=true;
setButtonImages();
        return false;   
}

function DeleteClick()
{
    var compcode=document.getElementById('hiddencompcode').value;
    var pub=document.getElementById('ddlPublication').value;
    var pubcenter=document.getElementById('ddlCenter').value;
    var edition=document.getElementById('ddlEdition').value;
    var supp=document.getElementById('ddlSupplement').value;    
    var pgnumber=document.getElementById('txtpageno').value;
    var ddlPremiumRequired=document.getElementById('ddlPremiumRequired').value;
    var dateformat=document.getElementById('hiddendateformat').value;
      //dan
     var strtextd="";
     var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('Session Expired ! Please Login Again.');
       window.location.href="Login.aspx";
       return false;
       }      
     
    if(confirm('Are You sure ! Do you want delete this record ?.'))
    {
       DefaultPageConfigurationMaster.DeleteRecord(compcode,pub,pubcenter,edition,supp,pgnumber)
        alert('Record deleted successfully.');
 
       DefaultPageConfigurationMaster.ExecuteRecord(glcompcode,glpubcode,glcentercode,gleditioncode,glsuppcode,glpageno,glnoofpages,glddlpgcolor,glddlPremiumRequired, flag, dateformat, delcall);
    }
    else
	{
	   return false;
	}

    cancelClick();
    return false;
    
    
}

  function delcall(res)
{
	 global_ds=res.value;
	len=global_ds.Tables[0].Rows.length;
	var userid=document.getElementById('hiddenuserid').value;
	
	if(global_ds.Tables[0].Rows.length==0)
	{
		alert("No More Data is here to be deleted");
        document.getElementById('hiddencompcode').value="";
        document.getElementById('ddlPublication').value="";
        document.getElementById('ddlCenter').value="";
        document.getElementById('ddlEdition').value="";
        document.getElementById('ddlSupplement').value=""; 
        document.getElementById('ddlAdFilling').value="";     
        document.getElementById('txtpageno').value="";
        document.getElementById('txtCategory').value="";
       // document.getElementById('txtSubcategory').value="";
	    document.getElementById('ddlNoofPage').value="";
	    document.getElementById('ddlPageColor').value="";
	    document.getElementById('ddlPageHeading').value="";
	    document.getElementById('txtPageVolume').value="";
        document.getElementById('txtPageHeight').value="";
        document.getElementById('txtPagewidth').value="";
        document.getElementById('txtMadAdAllow').value="";
        document.getElementById('txtStartingRow').value="";
        document.getElementById('txtStartingCol').value="";
        document.getElementById('txtSharepageStatus').value="";
        document.getElementById('txtSharePageno').value="";
        document.getElementById('txtValidateDateFrom').value="";
        document.getElementById('txtValidateDateTo').value="";  
        document.getElementById('ddlPremiumRequired').value="";
	     
          setButtonImages();
	    return false;
	}
	else if(z>=len || z==-1)
	{
		   document.getElementById('ddlPublication').value=global_ds.Tables[0].Rows[0].pri_pub;
           document.getElementById('ddlPublication').disabled=true; 
           document.getElementById('ddlCenter').value=global_ds.Tables[0].Rows[0].pub_center;
           document.getElementById('ddlCenter').disabled=true;
             //***************************************************************************************//
            var res =DefaultPageConfigurationMaster.addeditioncode(global_ds.Tables[0].Rows[0].pub_center,userid,global_ds.Tables[0].Rows[0].pri_pub); 
            var ds=res.value;
            var pkgitem = document.getElementById("ddlEdition");
             
            if(ds!= null && typeof(ds) == "object" && ds.Tables[0].Rows.length > 0) 
            {
                    var pkgitem=document.getElementById('ddlEdition');
                    pkgitem.options[0]=new Option("------Select Edititon------","0");
                    pkgitem.options.length = 1; 
                    
                    for (var i = 0  ; i < res.value.Tables[0].Rows.length; ++i)
                   {
                       pkgitem.options[pkgitem.options.length] = new Option(res.value.Tables[0].Rows[i].edition_name,res.value.Tables[0].Rows[i].edition_code);
                       pkgitem.options.length;
                   }
             
            }
           //****************************************************//
           document.getElementById('ddlEdition').value=global_ds.Tables[0].Rows[0].edition_code;
           document.getElementById('ddlEdition').disabled=true;
           document.getElementById('ddlSupplement').value=global_ds.Tables[0].Rows[0].sub_pub;
           document.getElementById('ddlSupplement').disabled=true;
          
           document.getElementById('ddlAdFilling').value=global_ds.Tables[0].Rows[0].ladder_status;
           document.getElementById('ddlAdFilling').disabled=true;
           document.getElementById('txtpageno').value=global_ds.Tables[0].Rows[0].page_no;
           document.getElementById('txtpageno').disabled=true;
           document.getElementById('txtCategory').value=global_ds.Tables[0].Rows[0].priadctg;
           document.getElementById('txtCategory').disabled=true;
           //document.getElementById('txtSubcategory').value=global_ds.Tables[0].Rows[0].secadctg;
           document.getElementById('txtSubcategory').disabled=true;
           document.getElementById('ddlNoofPage').value=global_ds.Tables[0].Rows[0].no_of_pages;
           document.getElementById('ddlNoofPage').disabled=true;
           document.getElementById('ddlPageColor').value=global_ds.Tables[0].Rows[0].page_colour;
           document.getElementById('ddlPageColor').disabled=true;
          
           document.getElementById('ddlPageHeading').value=global_ds.Tables[0].Rows[0].page_heading;
           document.getElementById('ddlPageHeading').disabled=true;
           document.getElementById('txtPageVolume').value=global_ds.Tables[0].Rows[0].ad_volume;
           document.getElementById('txtPageVolume').disabled=true;
           document.getElementById('txtPageHeight').value=global_ds.Tables[0].Rows[0].max_row;
           document.getElementById('txtPageHeight').disabled=true;
           document.getElementById('txtPagewidth').value=global_ds.Tables[0].Rows[0].max_col;
           document.getElementById('txtPagewidth').disabled=true;
           document.getElementById('txtMadAdAllow').value=global_ds.Tables[0].Rows[0].max_ad;
           document.getElementById('txtMadAdAllow').disabled=true;
           document.getElementById('txtStartingRow').value=global_ds.Tables[0].Rows[0].starting_row;
           document.getElementById('txtStartingRow').disabled=true;
           document.getElementById('txtStartingCol').value=global_ds.Tables[0].Rows[0].starting_col;
           document.getElementById('txtStartingCol').disabled=true;
           document.getElementById('txtSharepageStatus').value=global_ds.Tables[0].Rows[0].share_page_status;
           document.getElementById('txtSharepageStatus').disabled=true;
           document.getElementById('txtSharePageno').value=global_ds.Tables[0].Rows[0].share_page_no;
           document.getElementById('txtSharePageno').disabled=true;
           document.getElementById('txtValidateDateFrom').value=global_ds.Tables[0].Rows[0].valid_date_from;
           document.getElementById('txtValidateDateFrom').disabled=true;
           document.getElementById('txtValidateDateTo').value=global_ds.Tables[0].Rows[0].valid_date_to;  
           document.getElementById('txtValidateDateTo').disabled=true; 
           document.getElementById('ddlPremiumRequired').value=global_ds.Tables[0].Rows[0].premium;    
	       document.getElementById('ddlPremiumRequired').disabled=true; 
    }
    else
	{
		   document.getElementById('ddlPublication').value=global_ds.Tables[0].Rows[z].pri_pub;
           document.getElementById('ddlPublication').disabled=true; 
           document.getElementById('ddlCenter').value=global_ds.Tables[0].Rows[z].pub_center;
           document.getElementById('ddlCenter').disabled=true;
             //***************************************************************************************//
            var res =DefaultPageConfigurationMaster.addeditioncode(global_ds.Tables[0].Rows[z].pub_center,userid,global_ds.Tables[0].Rows[z].pri_pub); 
            var ds=res.value;
            var pkgitem = document.getElementById("ddlEdition");
             
            if(ds!= null && typeof(ds) == "object" && ds.Tables[0].Rows.length > 0) 
            {
                    var pkgitem=document.getElementById('ddlEdition');
                    pkgitem.options[0]=new Option("------Select Edititon------","0");
                    pkgitem.options.length = 1; 
                    
                    for (var i = 0  ; i < res.value.Tables[0].Rows.length; ++i)
                   {
                       pkgitem.options[pkgitem.options.length] = new Option(res.value.Tables[0].Rows[i].edition_name,res.value.Tables[0].Rows[i].edition_code);
                       pkgitem.options.length;
                   }
             
            }
           //****************************************************//
           document.getElementById('ddlEdition').value=global_ds.Tables[0].Rows[z].edition_code;
           document.getElementById('ddlEdition').disabled=true;
           document.getElementById('ddlSupplement').value=global_ds.Tables[0].Rows[z].sub_pub;
           document.getElementById('ddlSupplement').disabled=true;
          
           document.getElementById('ddlAdFilling').value=global_ds.Tables[0].Rows[z].ladder_status;
           document.getElementById('ddlAdFilling').disabled=true;
           document.getElementById('txtpageno').value=global_ds.Tables[0].Rows[z].page_no;
           document.getElementById('txtpageno').disabled=true;
           document.getElementById('txtCategory').value=global_ds.Tables[0].Rows[z].priadctg;
           document.getElementById('txtCategory').disabled=true;
          // document.getElementById('txtSubcategory').value=global_ds.Tables[0].Rows[z].secadctg;
           //document.getElementById('txtSubcategory').disabled=true;
           document.getElementById('ddlNoofPage').value=global_ds.Tables[0].Rows[z].no_of_pages;
           document.getElementById('ddlNoofPage').disabled=true;
           document.getElementById('ddlPageColor').value=global_ds.Tables[0].Rows[z].page_colour;
           document.getElementById('ddlPageColor').disabled=true;
          
           document.getElementById('ddlPageHeading').value=global_ds.Tables[0].Rows[z].page_heading;
           document.getElementById('ddlPageHeading').disabled=true;
           document.getElementById('txtPageVolume').value=global_ds.Tables[0].Rows[z].ad_volume;
           document.getElementById('txtPageVolume').disabled=true;
           document.getElementById('txtPageHeight').value=global_ds.Tables[0].Rows[z].max_row;
           document.getElementById('txtPageHeight').disabled=true;
           document.getElementById('txtPagewidth').value=global_ds.Tables[0].Rows[z].max_col;
           document.getElementById('txtPagewidth').disabled=true;
           document.getElementById('txtMadAdAllow').value=global_ds.Tables[0].Rows[z].max_ad;
           document.getElementById('txtMadAdAllow').disabled=true;
           document.getElementById('txtStartingRow').value=global_ds.Tables[0].Rows[z].starting_row;
           document.getElementById('txtStartingRow').disabled=true;
           document.getElementById('txtStartingCol').value=global_ds.Tables[0].Rows[z].starting_col;
           document.getElementById('txtStartingCol').disabled=true;
           document.getElementById('txtSharepageStatus').value=global_ds.Tables[0].Rows[z].share_page_status;
           document.getElementById('txtSharepageStatus').disabled=true;
           document.getElementById('txtSharePageno').value=global_ds.Tables[0].Rows[z].share_page_no;
           document.getElementById('txtSharePageno').disabled=true;
           document.getElementById('txtValidateDateFrom').value=global_ds.Tables[0].Rows[z].valid_date_from;
           document.getElementById('txtValidateDateFrom').disabled=true;
           document.getElementById('txtValidateDateTo').value=global_ds.Tables[0].Rows[z].valid_date_to;  
           document.getElementById('txtValidateDateTo').disabled=true; 
           document.getElementById('ddlPremiumRequired').value=global_ds.Tables[0].Rows[z].premium;    
	       document.getElementById('ddlPremiumRequired').disabled=true; 
					
           
           ///////////////////////////////////////////
	}
	        if (z==0)
               {
                document.getElementById('btnfirst').disabled=true;
                document.getElementById('btnprevious').disabled=true;
                }

             if(z==global_ds.Tables[0].Rows.length)
              {
                document.getElementById('btnnext').disabled=true;
	            document.getElementById('btnlast').disabled=true;
              }       
		
setButtonImages();
   return false;
}
    
    

function exitclick()
{
    if(confirm("Do You Want To Skip This Page"))
    {
        window.close();
        return false;
    }
    return false;
}

function ClientisNumber()
{
	if ((event.keyCode>=48 && event.keyCode<=57)||(event.keyCode==9)||(event.keyCode==11))
	{
		
		return true;
	}
	else
	{
		return false;
	}
	
}


function trim(stringToTrim) 
 {
	 return stringToTrim.replace(/^\s+|\s+$/g,"");
 }
 
 function setButtonImages()
{
    if(document.getElementById('btnNew').disabled==true)
        document.getElementById('btnNew').src="btimages/new-off.jpg";
    else
        document.getElementById('btnNew').src="btimages/new.jpg";
        
    if(document.getElementById('btnSave').disabled==true)
        document.getElementById('btnSave').src="btimages/save-off.jpg";
    else
        document.getElementById('btnSave').src="btimages/save.jpg";
        
    if(document.getElementById('btnModify').disabled==true)
        document.getElementById('btnModify').src="btimages/modify-off.jpg";
    else
        document.getElementById('btnModify').src="btimages/modify.jpg";
        
    if(document.getElementById('btnQuery').disabled==true)
        document.getElementById('btnQuery').src="btimages/query-off.jpg";
    else
        document.getElementById('btnQuery').src="btimages/query.jpg";
    
    if(document.getElementById('btnExecute').disabled==true)
        document.getElementById('btnExecute').src="btimages/execute-off.jpg";
    else
        document.getElementById('btnExecute').src="btimages/execute.jpg";
        
    if(document.getElementById('btnCancel').disabled==true)
        document.getElementById('btnCancel').src="btimages/clear-off.jpg";
    else
        document.getElementById('btnCancel').src="btimages/clear.jpg";
        
    if(document.getElementById('btnfirst').disabled==true)
        document.getElementById('btnfirst').src="btimages/first-off.jpg";
    else
        document.getElementById('btnfirst').src="btimages/first.jpg";
        
    if(document.getElementById('btnprevious').disabled==true)
        document.getElementById('btnprevious').src="btimages/previous-off.jpg";
    else
        document.getElementById('btnprevious').src="btimages/previous.jpg";
        
    if(document.getElementById('btnnext').disabled==true)
        document.getElementById('btnnext').src="btimages/next-off.jpg";
    else
        document.getElementById('btnnext').src="btimages/next.jpg";
        
    if(document.getElementById('btnlast').disabled==true)
        document.getElementById('btnlast').src="btimages/last-off.jpg";
    else
        document.getElementById('btnlast').src="btimages/last.jpg";   
        
    if(document.getElementById('btnDelete').disabled==true)
        document.getElementById('btnDelete').src="btimages/delete-off.jpg";
    else
        document.getElementById('btnDelete').src="btimages/delete.jpg";
        
    if(document.getElementById('btnExit').disabled==true)
        document.getElementById('btnExit').src="btimages/exit-off.jpg";
    else
        document.getElementById('btnExit').src="btimages/exit.jpg";
}
//  void CheckChanged(object sender, EventArgs e)
//{

//}
