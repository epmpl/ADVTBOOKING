var str;
var biltovar="";
var varbiltocal="";
//static var z=0;
var show1="0";
var z=0;
var y=0;
var datemonth;
var show="0";
var cityvar;
var regionvar;
var zonevar;
var talukavar;
var hiddentext;
// this variable is used foe storing value of autogenerated for session
var auto="";
var catvar;
var subcat;
var subcat ;
var agcatby;
var cityselected;
var selbitocity="";
///////////////////this we have declare as a dataset globally for f,p,n,l
var dsforexecute;
/////////////////////////////////////////////////////////////////////////
////////////////////////these are the global values which are used at the time of deletion for f,p,n,l
var glagencycode;
var glsubagencycode;
var glalias;
var glagencytype;
var glagenctname;
var glcountry;
var glcity;
var blagsubcat;
var glbranchcode;
var gbillfreq;
var glagcat;
var saurabh="1";
var gdsexecute = null;


var record = "";
var flg_req;
var view_tablename = "";
var view_colname = "";
var view_colvalues = "";
var delcolname = "";
// chk it here
var flag = true;
var viewcolname = "";
var valueType;
var checkflag = "false";
var ds18 = "";
var srt_count_0ther = 1;
var rec_page_val = 5
var tot_page = 4
var rec_shw_oth_val = 10
var rec_shw_oth1 = 10
var next = 0;
var dsexe = "";
var modiflag = 0;
var srt_count = 1
var record_show1 = 1
var record_show = rec_page_val
var record_show1_other1 = rec_shw_oth_val;
var record_show_other = rec_shw_oth_val;
var extra_record_other = 0;
var srt_count_0ther = 1;
var divres = "";
var check = true;


////////////////////////////////drpparent


function fillmrv(event) {
    var key = event.keyCode ? event.keyCode : event.which; 
    if (key == 113 || key == 35) {
        if (document.activeElement.id == "mrvregion") {
            var compcode = document.getElementById('hiddencompcode').value; 
            var agn = document.getElementById('mrvregion').value;
            document.getElementById("divmrv").style.display = "block";
            document.getElementById('divmrv').style.top = 215 + "px"; //314//290
            document.getElementById('divmrv').style.left = 580 + "px"; //395//1004
            document.getElementById('lstmrv').focus();
            Agent_master.fillmrv(compcode, document.getElementById('hiddendateformat').value, document.getElementById('hiddenuserid').value,"","","","","", bindmrv);
        }
    }
    else if (((key == 8) || (key == 46)) || (event.ctrlKey == true && key == 88)) {

        if (document.activeElement.id == "mrvregion") {
            document.getElementById('mrvregion').value = "";
            document.getElementById('hdnmrv').value = "";
            return false;
        }
        return key;
    }
}
function bindmrv(res) {
    var ds_AccName = res.value;

    if (ds_AccName != null && typeof (ds_AccName) == "object" && ds_AccName.Tables[0].Rows.length > 0) {
        var pkgitem = document.getElementById("lstmrv");
        pkgitem.options.length = 0;
        pkgitem.options[0] = new Option("-Select MRV-", "0");
        pkgitem.options.length = 1;
        for (var i = 0; i < ds_AccName.Tables[0].Rows.length; ++i) {
            pkgitem.options[pkgitem.options.length] = new Option(ds_AccName.Tables[0].Rows[i].Zip, ds_AccName.Tables[0].Rows[i].Zip);
            pkgitem.options.length;
        }
    }

    var aTag = eval(document.getElementById('mrvregion'))
    var btag;
    var leftpos = 0;
    var toppos = 0;
    do {
        aTag = eval(aTag.offsetParent);
        leftpos += aTag.offsetLeft;
        toppos += aTag.offsetTop;
        btag = eval(aTag)
    } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
    var tot = document.getElementById('divmrv').scrollLeft;
    var scrolltop = document.getElementById('divmrv').scrollTop;
    document.getElementById('divmrv').style.left = document.getElementById('mrvregion').offsetLeft + leftpos - tot + "px";
    document.getElementById('divmrv').style.top = document.getElementById('mrvregion').offsetTop + toppos - scrolltop + "px"; //"510px";



    document.getElementById("lstmrv").value = "0";
    document.getElementById("divmrv").value = "";
    document.getElementById('lstmrv').focus();

    return false;

}


function clickmrv(event) {
    var key = event.keyCode ? event.keyCode : event.which;
    if (key == 13 || event.type == "click") {
        if (document.activeElement.id == "lstmrv") {
            if (document.getElementById('lstmrv').value == "0") {
                alert("Please select MRV Name");
                return false;
            }

            var page = document.getElementById('lstmrv').value;
            agencycode = page;
            for (var k = 0; k <= document.getElementById('lstmrv').length - 1; k++) {
                if (document.getElementById('lstmrv').options[k].value == page) {
                    if (browser != "Microsoft Internet Explorer") {
                        var abc = document.getElementById('lstmrv').options[k].textContent;
                    }
                    else {
                        var abc = document.getElementById('lstmrv').options[k].innerText;
                    }
                    document.getElementById('mrvregion').value = abc.split('*')[0];
                  //  document.getElementById('hdnmrv').value = abc.split('*')[1];
                    document.getElementById('hdnmrv').value = page;

                    document.getElementById("divmrv").style.display = "none";
                    document.getElementById('mrvregion').focus();
                    return false;

                }
            }
        }
    }
    else if (key == 27) {

        document.getElementById("divmrv").style.display = "none";
        document.getElementById('mrvregion').focus();
    }
}





//function enableddisabled() {

//    if (document.getElementById('drpparent').value == "P") {
//        document.getElementById('txtdesg').disabled = true;
//    }
//   else if (document.getElementById('drpparent').value == "0") {
//        document.getElementById('txtdesg').disabled = true;
//    }
//    
//    else 
//    
//    {

//    document.getElementById('txtdesg').disabled = false;
//    }


//   

//}
function newclick()
{ 
    
//dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 
Agent_master.blankSession();
    var f="0";
    if(browser!="Microsoft Internet Explorer")
    {
        httpRequest= new XMLHttpRequest();
//   
        httpRequest.open("GET","agencynull.aspx?f="+f, false);
        httpRequest.send('');
        
        dl=httpRequest.responseText;
        
    }
    else if(browser=="Microsoft Internet Explorer")
    {
        var xml = new ActiveXObject("Microsoft.XMLHTTP");
        xml.Open( "GET","agencynull.aspx?f="+f, false );
        xml.Send();
        dl=xml.responseText;
    }
    
    // to hide the list box of agency name which comes on pressing the f2 key.
document.getElementById("divagency").style.display='none';
//------------------------------------------------------------------------
  
   
   
    document.getElementById('drpcalc').disabled=false;
    document.getElementById('lbcommdetail').disabled=false;
    document.getElementById('lbbankdetail').disabled=false;
    document.getElementById('lbstatusdetail').disabled=false;
    document.getElementById('lbbankmast').disabled=false;
    document.getElementById('lbpaymode').disabled=false;
    document.getElementById('lbcontactdetails').disabled = false;
    document.getElementById('btnshowremark').disabled = true;
    document.getElementById('drpbilflag').disabled = false;    
    
document.getElementById('hiddensaurabh').value="1";
document.getElementById('hiddenquery').value="0";
saurabh="1";
show="1";
if(document.getElementById('hiddenpermission').value=="zero")
{
alert("You Are Not Authorised To See This Form");
return false;
}




		  
    
/*document.getElementById('txtagencode').disabled=false;
document.getElementById('txtagencode').value="";*/
document.getElementById('hiddentxt').value="";
document.getElementById('btnNew').enabled=false;
document.getElementById('hiddenexecute').value="";

			document.getElementById('txtpincode').value="";
			
			document.getElementById('drpbillf').value="0";

			document.getElementById('fillbill').style.visibility="hidden";
			document.getElementById('txturl').value="";
			document.getElementById('drpparent').value="0";
			
			document.getElementById('txtphone1').value="";
			document.getElementById('txtbill').value="0";
			
			
	        document.getElementById('mrvregion').value="";
				
			
			document.getElementById('txturl').value="";

			document.getElementById('txtagencode').value="";
		
			document.getElementById('txtagenname').value="";
			document.getElementById('hiddenagencyname').value=document.getElementById('txtagenname').value;
			document.getElementById('txtdepocode').value="";
			
			document.getElementById('txtsagencycode').value="";
			
			document.getElementById('drpagecate').value="0";
			//drpregion.SelectedValue="0";
			
			document.getElementById('txtcrlimit').value="";
			
			document.getElementById('txtagencyho').value="";
			
			document.getElementById('drpagetyp').value="0";
			
			document.getElementById('drpagecate').value="0";
			
			document.getElementById('drpagescat').value="0";
			//drpregion.SelectedValue="0";
			
			document.getElementById('txtagencyho').value="";
			
			document.getElementById('txtsugagencyho').value="";
			
			document.getElementById('drprepres').value="0";
			//drpcity.SelectedValue="0";
			
			document.getElementById('txtsugagencyho').value="";

			document.getElementById('txtstatus2').value="";
			
			document.getElementById('txtalias').value="";
			//txtagname.Text="";
			
			document.getElementById('txtalert').value="";

			document.getElementById('txtremarks').value = "";

		//	document.getElementById('drpbilflag').value = "";


		

			document.getElementById('hidkyc').value = "";
			
			document.getElementById('drpbranch').value="0";
			document.getElementById('txtagenname').value="";
			document.getElementById('hiddenagencyname').value=document.getElementById('txtagenname').value;
		//***********************Pankaj******************************	
			document.getElementById('txtadd').value="";
			
			document.getElementById('txtaddress1').value="";
			document.getElementById('txtaddress2').value="";
			
		//***********************************************************	
			document.getElementById('txtstreet').value="";
			
			document.getElementById('txtdistrict').value="";
			
			document.getElementById('txtcountry').value="0";
			document.getElementById('drpzone').value="0";

			document.getElementById('txtphone2').value="";
			
			document.getElementById('drpcurtyp').value="0";

			document.getElementById('txtmail').value = "";
			document.getElementById('txtmailcc').value = "";
			
			document.getElementById('txttan').value="";
			
			document.getElementById('selectagencode').style.visibility="hidden";
			
				document.getElementById('txtpan').value="";
			//			drprepres.disabled=true;
			//			drpstatus.disabled=true;
			
			document.getElementById('txtbill').value="0";
			
			document.getElementById('drpagetyp').disabledd=false;
			//			drpsageo.disabled=true;
			
			document.getElementById('txtpincode').value="";
			
			
			
			
			document.getElementById('txtstate').value="";
			//string zip="246763";
			
			document.getElementById('txtfax').value="";
			document.getElementById('txtfax1').value="";
			document.getElementById('txtenrolldate').value="";
			
			document.getElementById('txtnoofvts').value="";
			
			//document.getElementById('txtstatusdate').value="";
			//			drpcity.disabled=true;
			//string url="www.4cplus.com";
			
			document.getElementById('txtbusineedate').value="";
			document.getElementById('hiddenchk').value="0";
			document.getElementById('txtmryrefno').value="";
			
			document.getElementById('txtcredit').value="";
			
			document.getElementById('txtstacno').value="";
			
			document.getElementById('biltodrp').value = "0";
			document.getElementById('drpgstus').value = "Y";
			document.getElementById('txtgstdt').value = "";
			document.getElementById('txtgstin').value = "";
			document.getElementById('txtgstclty').value = "";
			document.getElementById('drpgstatus').value = "Y";
			document.getElementById('hdngstclty').value = "";
			document.getElementById('txtarno').value = "";
			document.getElementById('txtgstprovid').value = "";

			document.getElementById('getagsubcode').value = "";
			document.getElementById('drpEdition_wise_Billing').value = "N";
			document.getElementById("drpEdition_wise_Billing").disabled = false;
			document.getElementById("chkvat").checked = false;
			document.getElementById("chkcheque").checked = false;
			document.getElementById("chkbondrecvd").checked = false;
			document.getElementById("chkyc").checked = false;
			document.getElementById("chkadproof").checked = false;

			document.getElementById("chkraterevise").checked = false;
			
			document.getElementById('drpgstus').disabled=false;
			document.getElementById('txtgstdt').disabled = false;
			document.getElementById('txtgstin').disabled = false;
			document.getElementById('txtgstclty').disabled = false;
			document.getElementById('drpgstatus').disabled = false;
			document.getElementById('txtarno').disabled = false;
			document.getElementById('txtgstprovid').disabled = false;

			document.getElementById('drpuserid').disabled=false;
			document.getElementById('drpuserid').value="0";
			document.getElementById('drpagecate').disabled=false;
			document.getElementById('drprate').value=document.getElementById('hiddenratecode').value;
			document.getElementById('drprate').disabled=false;
			document.getElementById('txtagenname').disabled=false;
			
			document.getElementById('txtdepocode').disabled=false;
			
			document.getElementById('drpagescat').disabled=false;
			document.getElementById('drpemail').disabled = false;
			document.getElementById('txtstatus2').disabled=false;
			document.getElementById('drpparent').disabled=false;
			document.getElementById('btnagencyname').disabled = false;
			document.getElementById('txtalias').disabled=false;
			document.getElementById('mrvregion').disabled=false;
			document.getElementById('drpbranch').disabled=false;
			document.getElementById('drpregion').disabled=false;
			document.getElementById('drptaluka').disabled=false;
			document.getElementById('drpbillf').disabled=false;
			document.getElementById('txtphone1').disabled = false;
			
			
		
			document.getElementById('txtalert').disabled=false;

			document.getElementById('txtremarks').disabled = false;

			document.getElementById('attachment1').disabled = false;
		
			document.getElementById('txtagenname').disabled=false;
			
			document.getElementById('txtadd').disabled=false;
			
			//**********Pankaj
			document.getElementById('txtaddress1').disabled=false;
			document.getElementById('txtaddress2').disabled=false;
			//**********Pankaj
			document.getElementById('txtstreet').disabled=false;
			
			document.getElementById('txtdistrict').disabled=true;
			
			document.getElementById('txtcountry').disabled=false;
			document.getElementById('drpzone').disabled=false;
			
			document.getElementById('txtphone2').disabled=false;
			
					document.getElementById('txtrecoverylimit').disabled=false;
			document.getElementById('txtcreditlimitdays').disabled=false;
			document.getElementById('txtcrlimitfromdate').disabled=false;
			
			
			
			
			document.getElementById('txtphone2').disabled=false;

			document.getElementById('txtmail').disabled = false;
			document.getElementById('txtmailcc').disabled = false;
			document.getElementById('drpcurtyp').disabled=false;
			document.getElementById('txttan').disabled=false;
			document.getElementById('txtpan').disabled=false;
			
			document.getElementById('drprepres').disabled=false;
			//drpstatus.disabled=true;
			document.getElementById('txtbill').disabled=false;
			
			document.getElementById('drpagetyp').disabled=false;
			//drpsageo.disabled=true;
			document.getElementById('txtpincode').disabled=false;
			document.getElementById('txtstate').disabled=true;
			//string zip="246763";
			document.getElementById('txtfax').disabled=false;
			document.getElementById('txtfax1').disabled=false;
			document.getElementById('txtenrolldate').disabled=false;
			document.getElementById('txtnoofvts').disabled=false;
			document.getElementById('biltodrp').disabled=false;
			
			document.getElementById('drpcity').disabled=false;

			
			document.getElementById('drpcity').value="0";
			var bktyplen=document.getElementById('bktype').options.length;
             for(var t2=0;t2<bktyplen;t2++)
             {
                 document.getElementById('bktype').options[t2].selected=false;
             }
			//string url="www.4cplus.com";
			document.getElementById('bktype').disabled=false;
			
			var exelen=document.getElementById('Libexecutive').options.length;
			for(var t3=0;t3<exelen;t3++)
             {
                 document.getElementById('Libexecutive').options[t3].selected=false;
             }
			document.getElementById('Libexecutive').disabled=false;
			//////////////////anuja/////
			var retiner = document.getElementById('liretainer').options.length;
			for (var t4 = 0; t4 < retiner; t4++) {
			    document.getElementById('liretainer').options[t4].selected = false;
			}
			document.getElementById('liretainer').disabled = false;
			/////////////////////
			document.getElementById('txtbusineedate').disabled=false;
			document.getElementById('txtenrolldate').disabled=false;
			document.getElementById('txtmryrefno').disabled=false;
			document.getElementById('txtcredit').disabled=false;
			document.getElementById('txtstacno').disabled=false;
			document.getElementById('txtsagencycode').disabled=false;
			//alert(document.getElementById('txtsagencycode').disabledd);
			//document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabled);
			document.getElementById('txturl').disabled=false;
			document.getElementById('txturl').disabled=false;
			document.getElementById('txtphone2').disabled=false;
			document.getElementById('txtalias').disabled=false;
			document.getElementById('txtcrlimit').disabled=false;
			document.getElementById('txtagenname').disabled=false;
			document.getElementById('txtagenname').disabled=false;
			document.getElementById('txtalias').disabled=false;
			document.getElementById('txtagencode').disabled=false;
			document.getElementById('txtagencode').disabled=false;
			document.getElementById('chkvat').disabled = false;
			document.getElementById("chkcheque").disabled = false;
			document.getElementById("chkbondrecvd").disabled = false;
			document.getElementById("chkyc").disabled = false;
			document.getElementById("chkadproof").disabled = false;
			document.getElementById('chkraterevise').disabled = false; 
			//string paymode=bank;
			
			document.getElementById('btnSave').disabled=false;
			document.getElementById('txtcrlimit').disabled=false;
			document.getElementById('txtcrlimit').disabled=false;
			
			document.getElementById('txtbill').options.length=0;
			document.getElementById('txtbill').options[0]=new Option("--Select A/C Agency--","0");
			document.getElementById('drpcity').options.length=0;
			document.getElementById('drpcity').options[0]=new Option("--Select City--","0");
			//drpregion.disabled=false;
			
			
			document.getElementById('drpregion').disabled=false;
			//drpcity.SelectedItem.Text="--Select City--";
			//drpregion.disabled=false;
			document.getElementById('txtcountry').disabled=false;
			
			document.getElementById('drpzone').disabled=false;
			document.getElementById('txtagencyho').disabled=false;
			document.getElementById('txtsugagencyho').disabled=false;
			document.getElementById('txtagencyho').disabled=false;
			document.getElementById('txtsugagencyho').disabled=false;
			document.getElementById('txtstatus').style.visibility="hidden";
			document.getElementById('txtstatusdate').style.visibility="hidden";
			document.getElementById('Status').style.visibility="hidden";
			document.getElementById('StatusDate').style.visibility="hidden";
			
			document.getElementById('txtbusineedate').disabled=false;
			document.getElementById('txtenrolldate').disabled=false;
			//document.getElementById('mrvregion').disabled=false;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('txtsagencycode').disabled=true;
			document.getElementById('txtoldagen').disabled = false;
			document.getElementById('txtdesg').disabled = false;

//			if (document.getElementById('drpparent').value = "C") {
//			    document.getElementById('txtdesg').disabled = false;
//			}

//			else {
//			    document.getElementById('txtdesg').disabled = true;
//			}
//			
			//document.getElementById('btnExit').disabled=true;
			
			
			document.getElementById('btnQuery').disabled=true;
			
			document.getElementById('btnNew').disabled=true;
			
			document.getElementById('btnModify').disabled=true;
			
			//document.getElementById('btnDelete').disabled=false;
			
			document.getElementById('btnExecute').disabled=true;
			
			hiddentext="new";
			setButtonImages();
			document.getElementById('drpparent').value="P"
			document.getElementById('drpparent').focus();

			
			

	
			
			
			return false;


}

function cancelclick()
{
    document.getElementById('hidkyc').value = "";

   
    document.getElementById('attachment1').src = "Images/index.jpeg"

// to hide the list box of agency name which comes on pressing the f2 key.
document.getElementById("divagency").style.display='none';

    document.getElementById('drpbilflag').disabled = true;
    document.getElementById('lbcommdetail').disabled=true;
    document.getElementById('lbbankdetail').disabled=true;
    document.getElementById('lbstatusdetail').disabled=true;
    document.getElementById('lbbankmast').disabled=true;
    document.getElementById('lbpaymode').disabled=true;
    document.getElementById('lbcontactdetails').disabled = true;
    document.getElementById('txtdesg').disabled = true;
    document.getElementById('drpbilflag').disabled = true;
     document.getElementById('txtsubsubagcd').disabled = true;
    
if(document.getElementById("div2").style.display=="block")
        {
            document.getElementById("div2").style.display="none"
            //document.getElementById('selectcode').focus();
        }





//------------------------------------------------------------------------

document.getElementById('hiddensaurabh').value="0";
document.getElementById('hiddenquery').value="0";
show="0";
if(document.getElementById('hiddenpermission').value=="zero")
{
alert("You Are Noe Authorised To See This Form");
return false;
}
// ---------------------------------Saurabh Agarwal

var f="0";
    
    var d1="";
    var browser=navigator.appName;
    var  httpRequest =null;
    //alert(browser);
   
   
    if(browser!="Microsoft Internet Explorer")
    {
        httpRequest= new XMLHttpRequest();
//        if (httpRequest.overrideMimeType) {
//        httpRequest.overrideMimeType('text/xml'); 
//        }
       
//   
        httpRequest.open("GET","agencynull.aspx?f="+f, false);
        httpRequest.send('');
        
        dl=httpRequest.responseText;
        
    }
    else if(browser=="Microsoft Internet Explorer")
    {
            var xml = new ActiveXObject("Microsoft.XMLHTTP");
		    xml.Open( "GET","agencynull.aspx?f="+f, false );
		     xml.Send();
		   dl=xml.responseText;

    
    
    
    }



document.getElementById('hiddentxt').value="cancel";

            document.getElementById('hiddenexecute').value="";
           document.getElementById('txtstatus').style.visibility="hidden";
			document.getElementById('txtstatusdate').style.visibility="hidden";
			document.getElementById('Status').style.visibility="hidden";
			document.getElementById('StatusDate').style.visibility="hidden";
			
			document.getElementById('selectagencode').style.visibility="hidden";
			
			document.getElementById('txtpincode').value="";

			document.getElementById('drpbranch').value="0";
			document.getElementById('txturl').value="";
			
			document.getElementById('txtphone1').value="";

document.getElementById('drpregion').value = "0";
document.getElementById('drpzone').value = "0";
			document.getElementById('mrvregion').value = "";


			document.getElementById('txtdesg').value = "";
			
			
			document.getElementById('txtbill').value="0";	
			
			document.getElementById('txturl').value="";

			
			
			document.getElementById('txtagencode').value="";
		
			document.getElementById('txtagenname').value="";
			
			document.getElementById('txtdepocode').value="";
			
			document.getElementById('txtsagencycode').value="";
			
			document.getElementById('drpagecate').value="0";
			//drpregion.SelectedValue="0";
			document.getElementById('drptaluka').value="0";
			document.getElementById('txtcrlimit').value="";
			
			document.getElementById('txtagencyho').value="";
			
			document.getElementById('drpagetyp').value="0";
			
			document.getElementById('drpagecate').value="0";
			
			document.getElementById('drpagescat').value="0";
			//drpregion.SelectedValue="0";
			
			document.getElementById('txtagencyho').value="";
			
			document.getElementById('txtsugagencyho').value="";
			
			document.getElementById('drprepres').value="0";
			//drpcity.SelectedValue="0";
			
			document.getElementById('txtsugagencyho').value="";
            document.getElementById('drpbillf').value="0";
            document.getElementById('biltodrp').value="0";
			document.getElementById('getagsubcode').value="";
			
			
			
			document.getElementById('txtstatus2').value="";
			
			document.getElementById('txtalias').value="";
			//txtagname.Text="";
			
			document.getElementById('txtalert').value="";
			
			document.getElementById('txtremarks').value="";

			document.getElementById('hidkyc').value = "";
			document.getElementById('txtagenname').value="";
			document.getElementById('hiddenagencyname').value=document.getElementById('txtagenname').value;
			document.getElementById('txtadd').value="";
			//********Pankaj
			
			document.getElementById('txtaddress1').value="";
			document.getElementById('txtaddress2').value="";
			
			//*******Pankaj
			
			document.getElementById('txtstreet').value="";
			
			document.getElementById('txtdistrict').value="";
			
			document.getElementById('txtcountry').value="0";
			document.getElementById('drpzone').value="0";
			
			document.getElementById('txtphone2').value="";
			
			document.getElementById('drpcurtyp').value="0";

			document.getElementById('txtmail').value = "";
			document.getElementById('txtmailcc').value = "";
			
			document.getElementById('txtoldagen').value="";
			
			document.getElementById('txttan').value="";
document.getElementById('txtsubsubagcd').value="";
			document.getElementById('txtpan').value = "";
			document.getElementById('drpEdition_wise_Billing').value = "N";
			document.getElementById("drpEdition_wise_Billing").checked = false;

			document.getElementById("chkvat").checked = false;
			document.getElementById("chkcheque").checked = false;
			document.getElementById("chkbondrecvd").checked = false;
			document.getElementById("chkyc").checked = false;
			document.getElementById("chkadproof").checked = false;
				document.getElementById("chkraterevise").checked = false; 
			//			drprepres.biltodrp=true;
			//			drpstatus.disabled=true;
			document.getElementById('txtbill').options.length=0;
			document.getElementById('txtbill').options[0]=new Option("--Select A/C Agency--","0");
			
			document.getElementById('biltodrp').options.length=0;
			document.getElementById('biltodrp').options[0]=new Option("--Select Bill To--","0");
			
			document.getElementById('drpcity').options.length=0;
			document.getElementById('drpcity').options[0]=new Option("--Select City--","0");
			
			
			
			
			//			drpstatus.disabled=true;
			document.getElementById('drpregion').options.length=0;
			document.getElementById('drpregion').options[0]=new Option("--Select Region--","0");
			
			
					document.getElementById('drptaluka').options.length=0;
			document.getElementById('drptaluka').options[0]=new Option("--Select Region--","0");
			
			document.getElementById('drpzone').options.length=0;
			document.getElementById('drpzone').options[0]=new Option("--Select Zone--","0");
			       
			       
			    
                 //   document.getElementById('drpzone').value = "";
			document.getElementById('txtpincode').value="";
			
			document.getElementById('txtstate').value="";
			//string zip="246763";
			
			document.getElementById('txtfax').value="";
			document.getElementById('txtfax1').value="";
			document.getElementById('txtenrolldate').value="";
			
			document.getElementById('txtnoofvts').value="";
			
			//document.getElementById('txtstatusdate').value="";
			//			drpcity.disabled=true;
			//string url="www.4cplus.com";
			document.getElementById('hiddendistcode').value="";
			
			document.getElementById('hiddenstatecode').value="";
			
			document.getElementById('txtbusineedate').value="";
			
			document.getElementById('txtmryrefno').value="";
			
			document.getElementById('txtcredit').value="";
			
			document.getElementById('txtstacno').value="";
			document.getElementById('drpregion').value = "0";
			document.getElementById('drpgstus').value = "0";
			document.getElementById('txtgstdt').value = "";
			document.getElementById('txtgstin').value = "";
			document.getElementById('txtgstclty').value = "";
			document.getElementById('drpgstatus').value = "0";
			document.getElementById('hdngstclty').value = "";
			document.getElementById('txtarno').value = "";
			document.getElementById('txtgstprovid').value = "";
			
			document.getElementById('drpparent').value="0";
			 var bktyplen=document.getElementById('bktype').options.length;
             for(var t2=0;t2<bktyplen;t2++)
             {
                 document.getElementById('bktype').options[t2].selected=false;
             }
			document.getElementById('bktype').disabled=true;
			
			var exelen=document.getElementById('Libexecutive').options.length;
			for(var t3=0;t3<exelen;t3++)
             {
                 document.getElementById('Libexecutive').options[t3].selected=false;
             }
             document.getElementById('Libexecutive').disabled = true;

             var retinr = document.getElementById('liretainer').options.length;
             for (var t4 = 0; t4 < retinr; t4++) {
                 document.getElementById('liretainer').options[t4].selected = false;
             }
             document.getElementById('liretainer').disabled = true;
			
			
			document.getElementById('drpbranch').disabled=true;
			document.getElementById('drpparent').disabled=true;
	
			document.getElementById('drprate').disabled=true;
			document.getElementById('txtsagencycode').disabled=true;
			
			document.getElementById('txtagenname').disabled=true;
			
			document.getElementById('txtdepocode').disabled=true;
			
			
			document.getElementById('drpagescat').disabled=true;
			
			
			document.getElementById('txtstatus2').disabled=true;
			
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtoldagen').disabled=true;
			
			document.getElementById('mrvregion').disabled=true;
			
			document.getElementById('drprate').value=document.getElementById('hiddenratecode').value;
			
			document.getElementById('drpregion').disabled=true;
			
			document.getElementById('drpuserid').disabled=true;
			document.getElementById('drpuserid').value="0";
			document.getElementById('txtphone1').disabled=true;
			document.getElementById('drpbillf').disabled = true;
			document.getElementById('drpgstus').disabled = true;
			document.getElementById('txtgstdt').disabled = true;
			document.getElementById('txtgstin').disabled = true;
			document.getElementById('txtgstclty').disabled = true;
			document.getElementById('drpgstatus').disabled = true;
			document.getElementById('txtarno').disabled = true;
			document.getElementById('txtgstprovid').disabled =true;

//			var len = document.getElementById('drpregion').Option.length
//			for (var i = 0; i < len; i++) {

//			    document.getElementById('drpregion').remove(0);
//			}
//			
			//txtagname.ReadOnly=false;
			
			document.getElementById('txtalert').disabled=true;

			document.getElementById('txtremarks').disabled = true;
			document.getElementById('attachment1').disabled = true;
		    document.getElementById('txturl').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			
			document.getElementById('txtadd').disabled=true;
			//***********Pankaj
			
			document.getElementById('txtaddress1').disabled=true;;
			document.getElementById('txtaddress2').disabled=true;
			
			//**********End
			document.getElementById("Divgrid1").style.display = "none";
			document.getElementById('btnagencyname').disabled = true;
			
			
			document.getElementById('txtstreet').disabled=true;
			
			document.getElementById('txtdistrict').disabled=true;
			
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;

			document.getElementById('txtmail').disabled = true;
			document.getElementById('txtmailcc').disabled = true;
			document.getElementById('drpcurtyp').disabled=true;
			document.getElementById('txttan').disabled=true;
			document.getElementById('txtpan').disabled=true;
			
			document.getElementById('drprepres').disabled=true;
			//drpstatus.disabled=true;
			document.getElementById('txtbill').disabled=true;
			
			document.getElementById('drpagetyp').disabled=true;
			//drpsageo.disabled=true;
			document.getElementById('txtpincode').disabled=true;
			document.getElementById('txtstate').disabled=true;
			//string zip="246763";
			document.getElementById('txtfax').disabled=true;
			document.getElementById('txtfax1').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtnoofvts').disabled=true;
			document.getElementById('biltodrp').disabled=true;
			
			document.getElementById('drpcity').disabled=true;
			
			document.getElementById('drpcity').value="0";
			//string url="www.4cplus.com";
			document.getElementById('txtbusineedate').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtmryrefno').disabled=true;
			document.getElementById('txtcredit').disabled=true;
			document.getElementById('txtstacno').disabled=true;
			document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabledd);
			//document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabled);
			document.getElementById('txturl').disabled=true;
			document.getElementById('txturl').disabled=true;
			document.getElementById('txtphone2').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('btnshowremark').disabled = true;
			//string paymode=bank;
			
			document.getElementById('btnSave').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			
			
			
			
			document.getElementById('drpregion').disabled=true;
			//drpcity.SelectedItem.Text="--Select City--";
			//drpregion.disabled=false;
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			document.getElementById('chkvat').disabled = true;
			document.getElementById("chkcheque").disabled = true;
			document.getElementById("chkbondrecvd").disabled = true;
			document.getElementById("chkyc").disabled = true;
			document.getElementById("chkadproof").disabled = true;
			document.getElementById('chkraterevise').disabled = true; 
			
			
			document.getElementById('hiddentxt').value="cancel";
			
			document.getElementById('btnNew').disabled=false;
			document.getElementById('btnQuery').disabled=false;
			document.getElementById('btnExit').disabled=false;
			
			document.getElementById('btnExit').disabled=false;
			
			document.getElementById('btnSave').disabled=true;
			document.getElementById('btnModify').disabled=true;
			
			document.getElementById('btnfirst').disabled=true;
			
			document.getElementById('btnprevious').disabled=true;
			document.getElementById('btnnext').disabled=true;
			document.getElementById('btnlast').disabled=true;
			
			document.getElementById('drpregion').value=0;
			
			
			document.getElementById('btnNew').disabled=false;
			document.getElementById('btnExecute').disabled=true;
			document.getElementById('btnDelete').disabled=true;
			document.getElementById('btnDelete').disabled=true;
			
			if(document.getElementById('hiddenpermission').value=="4")
			{
			document.getElementById('btnNew').disabled=true;
			document.getElementById('btnDelete').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			if(document.getElementById('hiddenpermission').value=="5")
			{
			document.getElementById('btnNew').disabled=false;
			document.getElementById('btnQuery').disabled=false;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			if(document.getElementById('hiddenpermission').value=="6")
			{
			document.getElementById('btnNew').disabled=true;
			//document.getElementById('btnQuery').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			if(document.getElementById('hiddenpermission').value=="1")
			{
		    	document.getElementById('btnModify').disabled=true;
			document.getElementById('btnDelete').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			if(document.getElementById('hiddenpermission').value=="2")
			{
			
			document.getElementById('btnQuery').disabled=false;
			document.getElementById('btnNew').disabled=true;
			
			}
			else
			{
			
			}
			
			document.getElementById('fillbill').style.visibility="hidden";
			document.getElementById('txtagencode').disabled=true;
			if(document.getElementById('btnNew').disabled==false)
			    document.getElementById('btnNew').focus();
		



//dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 
       
       
       

       
Agent_master.blankSession();
setButtonImages();
			return false;

			////			
			
}


//function saveclick()
//{
////varun
// auto=document.getElementById('hiddenauto').value;
//if(auto==1)
//{
//if(hiddentext=="new")
//			{
//	
//            uppercase3();
//            }
//       return false;
//  }
//  
//if(document.getElementById('drpparent').value=="0")
//{
//alert("Please Enter Type ");
//document.getElementById('drpparent').focus();
//return false;
//}

//else if(document.getElementById('txtagenname').value =="")
//{
//alert("Please Enter the Agency Name");
//document.getElementById('txtagenname').focus();
//return(false);
//}

////else if(document.getElementById('txtagencode').value =="" )
////{
////alert("Please, enter Agency Code ");
////document.getElementById('txtagencode').focus();
////return(false);
////}


////else if(document.getElementById('txtsagencycode').value=="" )
////{
////alert("Please, enter Agency Sub Code ");
////document.getElementById('txtsagencycode').focus();
////return(false);
////}






//else if(document.getElementById('drpagetyp').value == "0")
//{
////alert(document.getElementById('txtenrolldate').value);
//alert("please enter the Agent Type.");
//document.getElementById('drpagetyp').focus();
//return(false);
//}



//else if(document.getElementById('drpagecate').value == "0")
//{
////alert(document.getElementById('txtenrolldate').value);
//alert("please enter the Agent Category.");
//document.getElementById('drpagecate').focus();
//return(false);
//}



//else if(document.getElementById('drpagescat').value == "0")
//{
////alert(document.getElementById('txtenrolldate').value);
//alert("please enter the Agent Sub Category.");
//document.getElementById('drpagescat').focus();
//return(false);
//}


//else if(document.getElementById('txtalias').value =="")

//{
//alert("Please Enter the Alias");
//document.getElementById('txtalias').focus();
//return(false);
//}

//else if(document.getElementById('drpcity').value =="0")

//{
//alert("Please Select The City");
//document.getElementById('drpcity').focus();
//return(false);
//}







//document.getElementById('txtstatus').style.visibility="hidden";
//			document.getElementById('txtstatusdate').style.visibility="hidden";
//			document.getElementById('Status').style.visibility="hidden";
//			document.getElementById('StatusDate').style.visibility="hidden";

//var compcode=document.getElementById('hiddencompcode').value;
//var userid=document.getElementById('hiddenuserid').value;
////varun
//var type=document.getElementById('drpparent').value;
//	
//	if(hiddentext=="modify" )
//			{
//			
//			var txtagencode1=document.getElementById('txtagencode').value;
//			var drpagecate1=document.getElementById('drpagecate').value;
//			
//			
//			var dateformat=document.getElementById('hiddendateformat').value;
//			var txtsagencycode1=document.getElementById('txtsagencycode').value;
//			
//			var txtagenname1=document.getElementById('txtagenname').value;
//			
//			
//			var drpagescat1=document.getElementById('drpagescat').value;
//			
//			
//			var txtstatus21=document.getElementById('txtstatus2').value;
//			
//			var txtalias1=document.getElementById('txtalias').value;
//			
//			
//			var mrvregion1=document.getElementById('mrvregion').value;
//			
//			
//			
//			var drpregion1=document.getElementById('drpregion').value;
//			
//			
//			
//			var txtphone11=document.getElementById('txtphone1').value;
//			
//			
//			//txtagname.ReadOnly=false;
//			
//			var txtalert1=document.getElementById('txtalert').value;
//			
//			var txtremarks1=document.getElementById('txtremarks').value;
//		
//		//********************Pankaj***********************
//					
//			var txtadd1=document.getElementById('txtadd').value;
//			
//			var txtaddress1=document.getElementById('txtaddress1').value;
//			var txtaddress2=document.getElementById('txtaddress2').value;
//			
//			//**********************************
//			
//			var txtstreet1=document.getElementById('txtstreet').value;
//			
//			var txtdistrict1=document.getElementById('txtdistrict').value;
//			
//			var txtcountry1=document.getElementById('txtcountry').value;
//			
//			var txtphone21=document.getElementById('txtphone2').value;
//			
//			
//			
//			var txtmail1=document.getElementById('txtmail').value;
//			
//			var txttan1=document.getElementById('txttan').value;
//			var txtpan1=document.getElementById('txtpan').value;
//			
//			var drpress1=document.getElementById('drprepres').value;
//			//drpstatus.disabled=true;
//			var txtbill1=document.getElementById('txtbill').value;
//			
//			var drpagetype1=document.getElementById('drpagetyp').value;
//			//drpsageo.disabled=true;
//			var txtpincode1=document.getElementById('txtpincode').value;
//			var txtstate1=document.getElementById('txtstate').value;
//			//string zip="246763";
//			var txtfax1=document.getElementById('txtfax').value;
//			
//			//var txtenrolldate1=document.getElementById('txtenrolldate').value;
//			
//			if(dateformat=="dd/mm/yyyy")
//			{
//			if(document.getElementById('txtenrolldate').value!="")
//			{
//			var txt=document.getElementById('txtenrolldate').value;
//			var txt1=txt.split("/");
//			var dd=txt1[0];
//			var mm=txt1[1];
//			var yy=txt1[2];
//			var txtenrolldate1=mm+'/'+dd+'/'+yy;
//			}
//			else
//			{
//			var txtenrolldate1=document.getElementById('txtenrolldate').value;
//			}
//			
//			}
//			if(dateformat=="mm/dd/yyyy")
//			{
//			var txtenrolldate1=document.getElementById('txtenrolldate').value;
//			}
//			if(dateformat=="yyyy/mm/dd")
//			{
//			if(document.getElementById('txtenrolldate').value!="")
//			{
//			var txt=document.getElementById('txtenrolldate').value;
//			var txt1=txt.split("/");
//			var yy=txt1[0];
//			var mm=txt1[1];
//			var dd=txt1[2];
//			var txtenrolldate1=mm+'/'+dd+'/'+yy;
//			}
//			else
//			{
//			var txtenrolldate1=document.getElementById('txtenrolldate').value;
//			}
//			}
//			if(dateformat=="" || dateformat==null || dateformat=="undefined")
//			{
//			var txtenrolldate1=document.getElementById('txtenrolldate').value;
//			}
//			
//			var txtnoofvts1=document.getElementById('txtnoofvts').value;
//			//document.getElementById('txtstatusdate').disabled=false;
//			
//			var drpcity1=document.getElementById('drpcity').value;
//			
//			
//			var txtbussinessdate1=document.getElementById('txtbusineedate').value;
//			
//			
//			if(dateformat=="dd/mm/yyyy")
//			{
//			if(document.getElementById('txtbusineedate').value!="")
//			{
//			var txt1=document.getElementById('txtbusineedate').value;
//			var txt2=txt1.split("/");
//			var dd=txt2[0];
//			var mm=txt2[1];
//			var yy=txt2[2];
//			var txtbussinessdate1=mm+'/'+dd+'/'+yy;
//			}
//			else
//			{
//			var txtbussinessdate1=document.getElementById('txtbusineedate').value;
//			}
//			
//			}
//			if(dateformat=="mm/dd/yyyy")
//			{
//			var txtbussinessdate1=document.getElementById('txtbusineedate').value;
//			}
//			if(dateformat=="yyyy/mm/dd")
//			{
//			if(document.getElementById('txtbusineedate').value!="")
//			{
//			var txt1=document.getElementById('txtbusineedate').value;
//			var txt2=txt1.split("/");
//			var yy=txt2[0];
//			var mm=txt2[1];
//			var dd=txt2[2];
//			var txtbussinessdate1=mm+'/'+dd+'/'+yy;
//			}
//			else
//			{
//			var txtbussinessdate1=document.getElementById('txtbusineedate').value;
//			}
//			}
//			if(dateformat=="" || dateformat==null || dateformat=="undefined")
//			{
//			var txtbussinessdate1=document.getElementById('txtbusineedate').value;
//			}
//			
//			var txtmyrefno1=document.getElementById('txtmryrefno').value;
//			var txtcredit1=document.getElementById('txtcredit').value;
//			var txtsacno1=document.getElementById('txtstacno').value;
//			var txtsagencycod1=document.getElementById('txtsagencycode').value;
//			
//			var txturl1=document.getElementById('txturl').value;
//			
//			
//			
//			var txtcrlimit1=document.getElementById('txtcrlimit').value;
//			var txtagenname1=document.getElementById('txtagenname').value;
//			var txtstatus=document.getElementById('txtstatus').value;
//			var txtstatusdate=document.getElementById('txtstatusdate').value;
//		
//			
//			var txtagenho1=document.getElementById('txtagencyho').value;
//			var txtsubagenho1=document.getElementById('txtsugagencyho').value;
//			var zone=document.getElementById('drpzone').value;
//			var paymode="0";
//			//varun
//			
//			Agent_master.modify(compcode,drpagecate1,txtagencode1,txtsagencycode1,txtagenname1,drpagescat1,txtstatus21,txtalias1,mrvregion1,drpregion1,txtphone11,txtalert1,txtremarks1,txtadd1,txtstreet1,txtdistrict1,txtcountry1,txtphone21,txtmail1,txttan1,txtpan1,drpress1,txtbill1,drpagetype1,txtpincode1,txtstate1,txtfax1,txtenrolldate1,txtnoofvts1,drpcity1,txtbussinessdate1,txtmyrefno1,txtcredit1,txtsacno1,txtsagencycod1,txturl1,txtcrlimit1,txtagenho1,txtsubagenho1,userid,txtstatus,txtsubagenho1,paymode,txtpincode1,txtsacno1,type,zone,txtaddress1,txtaddress2);			
//			alert("Data Modify");
//			
//			document.getElementById('drpagecate').disabled=true;
//			
//			document.getElementById('txtagencode').disabled=true;
//			
//			
//			document.getElementById('txtsagencycode').disabled=true;
//			
//			document.getElementById('txtagenname').disabled=true;
//			
//			
//			document.getElementById('drpagescat').disabled=true;
//			
//			
//			document.getElementById('drpagecate').disabled=true;
//			
//			document.getElementById('txtagencode').disabled=true;
//			
//			
//			document.getElementById('txtsagencycode').disabled=true;
//			
//			document.getElementById('txtagenname').disabled=true;
//			
//			
//			document.getElementById('drpagescat').disabled=true;
//			
//			
//			document.getElementById('txtstatus2').disabled=true;
//			
//			document.getElementById('txtalias').disabled=true;
//			
//			
//			document.getElementById('mrvregion').disabled=true;
//			
//			
//			
//			document.getElementById('drpregion').disabled=true;
//			
//			
//			
//			document.getElementById('txtphone1').disabled=true;
//			
//			
//			//txtagname.ReadOnly=false;
//			
//			document.getElementById('txtalert').disabled=true;
//			
//			document.getElementById('txtremarks').disabled=true;
//		
//			document.getElementById('txtagenname').disabled=true;
//			
//			document.getElementById('txtadd').disabled=true;
//			
//			document.getElementById('txtaddress1').disabled=true;
//			document.getElementById('txtaddress2').disabled=true;
//			
//			
//			
//			
//			document.getElementById('txtstreet').disabled=true;
//			
//			document.getElementById('txtdistrict').disabled=true;
//			
//			document.getElementById('txtcountry').disabled=true;
//			document.getElementById('drpzone').disabled=true;
//			
//			document.getElementById('txtphone2').disabled=true;
//			
//			document.getElementById('txtphone2').disabled=true;
//			
//			document.getElementById('txtmail').disabled=true;
//			
//			document.getElementById('txttan').disabled=true;
//			document.getElementById('txtpan').disabled=true;
//			
//			document.getElementById('drprepres').disabled=true;
//			//drpstatus.disabled=true;
//			document.getElementById('txtbill').disabled=true;
//			
//			document.getElementById('drpagetyp').disabled=true;
//			//drpsageo.disabled=true;
//			document.getElementById('txtpincode').disabled=true;
//			document.getElementById('txtstate').disabled=true;
//			//string zip="246763";
//			document.getElementById('txtfax').disabled=true;
//			document.getElementById('txtenrolldate').disabled=true;
//			document.getElementById('txtnoofvts').disabled=true;
//			//document.getElementById('txtstatusdate').disabled=false;
//			
//			document.getElementById('drpcity').disabled=true;
//			
//			
//			//string url="www.4cplus.com";
//			document.getElementById('txtbusineedate').disabled=true;
//			document.getElementById('txtenrolldate').disabled=true;
//			document.getElementById('txtmryrefno').disabled=true;
//			document.getElementById('txtcredit').disabled=true;
//			document.getElementById('txtstacno').disabled=true;
//			document.getElementById('txtsagencycode').disabled=true;
//			//alert(document.getElementById('txtsagencycode').disabledd);
//			//document.getElementById('txtsagencycode').disabled=true;
//			//alert(document.getElementById('txtsagencycode').disabled);
//			document.getElementById('txturl').disabled=true;
//			document.getElementById('txturl').disabled=true;
//			document.getElementById('txtphone2').disabled=true;
//			document.getElementById('txtalias').disabled=true;
//			document.getElementById('txtcrlimit').disabled=true;
//			document.getElementById('txtagenname').disabled=true;
//			document.getElementById('txtagenname').disabled=true;
//			document.getElementById('txtalias').disabled=true;
//			document.getElementById('txtagencode').disabled=true;
//			document.getElementById('txtagencode').disabled=true;
//			//string paymode=bank;
//			
//			document.getElementById('btnSave').disabled=true;
//			document.getElementById('txtcrlimit').disabled=true;
//			document.getElementById('txtcrlimit').disabled=true;
//			
//			
//			
//			
//			document.getElementById('drpregion').disabled=true;
//			//drpcity.SelectedItem.Text="--Select City--";
//			//drpregion.disabled=false;
//			document.getElementById('txtcountry').disabled=true;
//			document.getElementById('drpzone').disabled=true;
//			
//			document.getElementById('txtagencyho').disabled=true;
//			document.getElementById('txtsugagencyho').disabled=true;
//			document.getElementById('txtagencyho').disabled=true;
//			document.getElementById('txtsugagencyho').disabled=true;
//			
//			
//			
//			
//			document.getElementById('txtalias').disabled=true;
//			document.getElementById('drpagetyp').disabled=true;
//			document.getElementById('drpcity').disabled=true;
//			document.getElementById('txtstatus').disabled=true;
//			document.getElementById('txtstatusdate').disabled=true;
//			
//			document.getElementById('btnSave').disabled=true;
//			
//			document.getElementById('btnExit').disabled=false;
//			
//			document.getElementById('btnQuery').disabled=false;
//			
//			document.getElementById('btnfirst').disabled=false;
//			
//			document.getElementById('btnprevious').disabled=false;
//			
//			document.getElementById('btnnext').disabled=false;
//			
//			document.getElementById('btnlast').disabled=false;
//			
//			document.getElementById('btnExecute').disabled=true;
//			
//			document.getElementById('btnModify').disabled=false;
//			document.getElementById('btnNew').disabled=true;
//			document.getElementById('btnDelete').disabled=false;
//			if(document.getElementById('hiddenpermission').value=="2")
//			{
//			
//			document.getElementById('btnDelete').disabled=true;
//			
//			}
//			else
//			{
//			
//			}
//			
//			if(document.getElementById('hiddenpermission').value=="3")
//			{
//			
//			document.getElementById('btnDelete').disabled=true;
//			
//			}
//			else
//			{
//			
//			}
//			
//			
//			
//			
//			return false;
//			
//			
//			}
//			else
//			{
//			//save//
//			
//			var txtagencode=document.getElementById('txtagencode').value;
//			var drpagecate=document.getElementById('drpagecate').value;
//			
//			
//			var txtsagencycode=document.getElementById('txtsagencycode').value;
//			
//			var txtagenname=document.getElementById('txtagenname').value;
//			
//			
//			var drpagescat=document.getElementById('drpagescat').value;
//			
//			
//			var txtstatus2=document.getElementById('txtstatus2').value;
//			
//			var txtalias=document.getElementById('txtalias').value;
//			
//			
//			var mrvregion=document.getElementById('mrvregion').value;
//			
//			
//			
//			var drpregion=document.getElementById('drpregion').value;
//			
//			
//			
//			var txtphone1=document.getElementById('txtphone1').value;
//			
//			
//			//txtagname.ReadOnly=false;
//			
//			var txtalert=document.getElementById('txtalert').value;
//			
//			var txtremarks=document.getElementById('txtremarks').value;
//		
//		
//			
//			var txtadd=document.getElementById('txtadd').value;
//			//***************************Pankaj********
//			var txtaddress1=document.getElementById('txtaddress1').value;
//			var txtaddress2=document.getElementById('txtaddress2').value;
//			
//			//****************end********************
//			
//			var txtstreet=document.getElementById('txtstreet').value;
//			
//			var txtdistrict=document.getElementById('txtdistrict').value;
//			
//			var txtcountry=document.getElementById('txtcountry').value;
//			
//			var txtphone2=document.getElementById('txtphone2').value;
//			
//			
//			
//			var txtmail=document.getElementById('txtmail').value;
//			
//			var txttan=document.getElementById('txttan').value;
//			var txtpan=document.getElementById('txtpan').value;
//			
//			var drpress=document.getElementById('drprepres').value;
//			//drpstatus.disabled=true;
//			var txtbill=document.getElementById('txtbill').value;
//			var dateformat=document.getElementById('hiddendateformat').value;
//			var drpagetype=document.getElementById('drpagetyp').value;
//			//drpsageo.disabled=true;
//			var txtpincode=document.getElementById('txtpincode').value;
//			var txtstate=document.getElementById('txtstate').value;
//			//string zip="246763";
//			var txtfax=document.getElementById('txtfax').value;
////			var txtenrolldate=document.getElementById('txtenrolldate').value;
//			if(dateformat=="mm/dd/yyyy")
//			{
//			var txtenrolldate=document.getElementById('txtenrolldate').value;
//			}
//			if(dateformat=="dd/mm/yyyy")
//			{
//			var txt=document.getElementById('txtenrolldate').value;
//			var txt1=txt.split("/");
//			var dd=txt1[0];
//			var mm=txt1[1];
//			var yy=txt1[2];
//			var txtenrolldate=mm+'/'+dd+'/'+yy;
//			}
//			if(dateformat=="yyyy/mm/dd")
//			{
//			var txt=document.getElementById('txtenrolldate').value;
//			var txt1=txt.split("/");
//			var yy=txt1[0];
//			var mm=txt1[1];
//			var dd=txt1[2];
//			var txtenrolldate=mm+'/'+dd+'/'+yy;
//			}
//			if(dateformat==null || dateformat=="" || dateformat=="undefined")
//			{
//			var txtenrolldate=document.getElementById('txtenrolldate').value;
//			}
//			var txtnoofvts=document.getElementById('txtnoofvts').value;
//			//document.getElementById('txtstatusdate').disabled=false;
//			
//			var drpcity=document.getElementById('drpcity').value;
//			
//			
//			//var txtbussinessdate=document.getElementById('txtbusineedate').value;
//			if(dateformat=="mm/dd/yyyy")
//			{
//			var txtbussinessdate=document.getElementById('txtbusineedate').value;
//			}
//			if(dateformat=="dd/mm/yyyy")
//			{
//			var txt=document.getElementById('txtbusineedate').value;
//			var txt1=txt.split("/");
//			var dd=txt1[0];
//			var mm=txt1[1];
//			var yy=txt1[2];
//			var txtbussinessdate=mm+'/'+dd+'/'+yy;
//			}
//			if(dateformat=="yyyy/mm/dd")
//			{
//			var txt=document.getElementById('txtbusineedate').value;
//			var txt1=txt.split("/");
//			var yy=txt1[0];
//			var mm=txt1[1];
//			var dd=txt1[2];
//			var txtbussinessdate=mm+'/'+dd+'/'+yy;
//			}
//			if(dateformat==null || dateformat=="" || dateformat=="undefined")
//			{
//			var txtbussinessdate=document.getElementById('txtbusineedate').value;
//			}
//			var txtmyrefno=document.getElementById('txtmryrefno').value;
//			var txtcredit=document.getElementById('txtcredit').value;
//			var txtsacno=document.getElementById('txtstacno').value;
//			var txtsagencycod=document.getElementById('txtsagencycode').value;
//			
//			var txturl=document.getElementById('txturl').value;
//			
//			
//			
//			var txtcrlimit=document.getElementById('txtcrlimit').value;
//			var txtagenname=document.getElementById('txtagenname').value;
//		
//			
//			var txtagenho=document.getElementById('txtagencyho').value;
//			var txtsubagenho=document.getElementById('txtsugagencyho').value;
//			var type=document.getElementById('drpparent').value;
//			var subcode=document.getElementById('txtsagencycode').value;
//			var paymode1="0";
//			
//			if(txtagencode != "")
//			{
//			
//			//Agent_master.checkcode(txtagencode,compcode,userid,type,subcode,checkcode_callBack);
//			
//  
//  userdefine();
//  
//  
//			document.getElementById('btnSave').disabled=false;
//			
//			
//			//Agent_master.commcheck(txtagencode,compcode,userid,commchk);
////			Agent_master.statuscheck(txtagencode,compcode,userid,statuschk);
//			//Agent_master.paycheck1(txtagencode,compcode,userid,paychk);
//			}
//			else
//			{
//			alert("Please Enter The Agency Code");
//			return false;
//			}
//			
//			if(document.getElementById('hiddenpermission').value=="5")
//			{
//			document.getElementById('btnQuery').disabled=true;
//			document.getElementById('btnDelete').disabled=false;
//			}
//			else
//			{
//			//document.getElementById('btnModify').disabled=false;
//			}
//			
//			if(document.getElementById('hiddenpermission').value=="1")
//			{
//			document.getElementById('btnQuery').disabled=true;
//			//document.getElementById('btnQuery').disabled=true;
//			
//			}
//			else
//			{
//			//document.getElementById('btnModify').disabled=false;
//			}
//			
//			document.getElementById('btnDelete').disabled=true;
//			if(document.getElementById('hiddenpermission').value=="2")
//			{
//			
//			document.getElementById('btnDelete').disabled=true;
//			
//			}
//			else
//			{
//			
//			}
//			
//			return false;
//			
//			
//			
//			
//			//Agent_master.save(compcode,drpagecate,txtagencode,txtsagencycode,txtagenname,drpagescat,txtstatus2,txtalias,mrvregion,drpregion,txtphone1,txtalert,txtremarks,txtadd,txtstreet,txtdistrict,txtcountry,txtphone2,txtmail,txttan,txtpan,drpress,txtbill,drpagetype,txtpincode,txtstate,txtfax,txtenrolldate,txtnoofvts,drpcity,txtbussinessdate,txtmyrefno,txtcredit,txtsacno,txtsagencycod,txturl,txtcrlimit,txtagenho,txtsubagenho,userid,paymode1);
//			
//			
//			
//			}
//			
//			

//}







//function checkcode_callBack(response)

//{

//var txtagencode=document.getElementById('txtagencode').value;

//var compcode=document.getElementById('hiddencompcode').value;

//var userid=document.getElementById('hiddenuserid').value;

//                   var ds=response.value;
//                  
//                   if(ds=="y")
//                   {
//                   alert("This Value Already Exists In The Database");
//                   return false;
//                   }
//                   else
//                   {
//                  
//                   Agent_master.commcheck(txtagencode,compcode,userid,commchk);
//                   
//                   }


//}














//function commchk(response)
//{




//var txtagencode=document.getElementById('txtagencode').value;

//var compcode=document.getElementById('hiddencompcode').value;


//var userid=document.getElementById('hiddenuserid').value;

//var ds=response.value;
//if(ds=="n")
//  {
//alert("You Have Not Entered The Commission Detail Please Enter!!!");
//return false;
//  }
//  else
//  {
//  
//  
//  Agent_master.statuscheck(txtagencode,compcode,userid,statuschk);
//  
//  
//  }
//}

//function paychk(response)
//{

//var txtagencode=document.getElementById('txtagencode').value;

//var compcode=document.getElementById('hiddencompcode').value;

//var userid=document.getElementById('hiddenuserid').value;

// var ds=response.value;
//                   if(ds=="n")
//  {
//alert("You Have Not Entered The Pay Mode Detail Please Enter!!!");
//return false;
//  }
//  else
//  {
//  
//  saveanother();
//  
//  
//  }
//  
//  

//}



//function statuschk(response)
//{

//var txtagencode=document.getElementById('txtagencode').value;

//var compcode=document.getElementById('hiddencompcode').value;

//var userid=document.getElementById('hiddenuserid').value;

// var ds=response.value;
//if(ds=="n")
//  {
//alert("You Have Not Entered The Status Detail Please Enter!!!");
//return false;
//  }
//  else
//  {
// 
//    
//  Agent_master.paycheck1(txtagencode,compcode,userid,paychk);
//  
//  }

//}


// function for modify//


function modifyclick()
{
fillcreditdays();

 var type = document.getElementById('drpparent').value;
		    if (type == "P") {
		        document.getElementById('txtdesg').disabled = true;
		       
		    }

		    else {
		        document.getElementById('txtdesg').disabled = false;
		       
		    }






		    document.getElementById('drpbilflag').disabled = false;	    
  document.getElementById('lbcommdetail').disabled=false;
    document.getElementById('lbbankdetail').disabled=false;
    document.getElementById('lbstatusdetail').disabled=false;
    document.getElementById('lbbankmast').disabled=false;
    document.getElementById('lbpaymode').disabled=false;
    document.getElementById('lbcontactdetails').disabled=false;



    document.getElementById('hdnremarkmod').value = document.getElementById('txtalert').value;

document.getElementById('hiddensaurabh').value="modify";
document.getElementById('hiddenquery').value="0";
document.getElementById('hiddenbhanu').value="1";
show="2";
saurabh="0";
modify="1";
document.getElementById('hiddentxt').value="modify";
document.getElementById('hiddenchk').value="1";
hiddentext = document.getElementById('hiddentxt').value;



document.getElementById('drpgstus').disabled = false;
document.getElementById('txtgstdt').disabled = false;
document.getElementById('txtgstin').disabled = false;
document.getElementById('txtgstclty').disabled = false;
document.getElementById('drpgstatus').disabled = false;
document.getElementById('txtarno').disabled = false;
document.getElementById('txtgstprovid').disabled = false;
		
			document.getElementById('drpagetyp').disabledd=false;
			//			drpsageo.disabled=true;
			
			
			
			document.getElementById('drpcalc').disabled=false;
			
			document.getElementById('bktype').disabled=false;
			document.getElementById('Libexecutive').disabled = false;
			document.getElementById('liretainer').disabled = false;
			document.getElementById('drprate').disabled=false;
			document.getElementById('drpagecate').disabled=false;
			
			document.getElementById('txtagencode').disabled=true;
			
			
			document.getElementById('txtsagencycode').disabled=true;
			
			document.getElementById('txtagenname').disabled=false;
			
			document.getElementById('txtdepocode').disabled=false;
			
			
			document.getElementById('drpagescat').disabled=false;
			
			
			document.getElementById('txtstatus2').disabled=false;
			
			document.getElementById('txtalias').disabled=false;
			
			document.getElementById('drpbillf').disabled=false;
			
				document.getElementById('txtrecoverylimit').disabled=false;
			
			document.getElementById('txtcreditlimitdays').disabled=false;
			
			document.getElementById('txtcrlimitfromdate').disabled=false;
			
			document.getElementById('drpregion').disabled=false;
			
			
			
			document.getElementById('txtphone1').disabled=false;
			
			
			
		
			
			document.getElementById('txtalert').disabled=false;

			document.getElementById('txtremarks').disabled = false;
			document.getElementById('attachment1').disabled = false;
		
			document.getElementById('txtagenname').disabled=false;
			
			document.getElementById('txtadd').disabled=false;
			//**********Pankaj
			document.getElementById('txtaddress1').disabled=false;
			document.getElementById('txtaddress2').disabled=false;
			//***********Pankaj**********
			
			document.getElementById('biltodrp').disabled=false;
			//document.getElementById('txtadd2').disabled=false;





			document.getElementById('txtstreet').disabled = false;
			document.getElementById('drpemail').disabled = false;
			
			document.getElementById('txtdistrict').disabled=true;
			document.getElementById('drptaluka').disabled=false;
			document.getElementById('txtcountry').disabled=false;
			document.getElementById('drpzone').disabled=false;
			
			document.getElementById('txtphone2').disabled=false;



			document.getElementById('txtmail').disabled = false;
			document.getElementById('txtmailcc').disabled = false;
			
			document.getElementById('drpcurtyp').disabled=false;
			document.getElementById('txttan').disabled=false;
			document.getElementById('txtpan').disabled=false;
			
			document.getElementById('drprepres').disabled=false;
			//drpstatus.disabled=true;
			document.getElementById('txtbill').disabled=false;
			
			document.getElementById('drpagetyp').disabled=false;
			//drpsageo.disabled=true;
			document.getElementById('txtpincode').disabled=false;
			document.getElementById('txtstate').disabled=true;
			//string zip="246763";
			document.getElementById('txtfax').disabled=false;
			document.getElementById('txtfax1').disabled=false;
			document.getElementById('txtenrolldate').disabled=false;
			document.getElementById('txtnoofvts').disabled=false;
			//document.getElementById('txtstatusdate').disabled=false;
			
			document.getElementById('drpcity').disabled=false;
			
			document.getElementById('txtbusineedate').disabled=false;
			document.getElementById('txtenrolldate').disabled=false;
			
			
			document.getElementById('txtbusineedate').disabled=false;
			document.getElementById('txtenrolldate').disabled=false;
			document.getElementById('txtmryrefno').disabled=false;
			document.getElementById('txtcredit').disabled=false;
			document.getElementById('txtstacno').disabled=false;
			document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabledd);
			//document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabled);
			document.getElementById('txturl').disabled=false;
			
			document.getElementById('txtphone2').disabled=false;
			document.getElementById('txtalias').disabled=false;
			document.getElementById('txtcrlimit').disabled=false;
			document.getElementById('txtagenname').disabled=false;
			document.getElementById('txtoldagen').disabled=false;
			
			document.getElementById('drpuserid').disabled=false;
			//string paymode=bank;
			
			
			document.getElementById('txtcrlimit').disabled=false;


			document.getElementById('drpbilflag').disabled = false;


			document.getElementById('drpregion').disabled = false;
			document.getElementById('drpEdition_wise_Billing').disabled = false;
			//drpcity.SelectedItem.Text="--Select City--";
			//drpregion.disabled=false;
			document.getElementById('txtagencyho').disabled=false;
			document.getElementById('txtsugagencyho').disabled=false;
			document.getElementById('drpbranch').disabled=false;
			document.getElementById('chkvat').disabled = false;
			document.getElementById("chkcheque").disabled = false;
			document.getElementById("chkbondrecvd").disabled = false;
			document.getElementById("chkyc").disabled = false;
			document.getElementById("chkadproof").disabled = false;
			document.getElementById('chkraterevise').disabled = false;
			
			document.getElementById('btnSave').disabled=false;
			
			//document.getElementById('btnExit').disabled=false;
			
			document.getElementById('btnQuery').disabled=true;
			
			document.getElementById('btnfirst').disabled=true;
			
			document.getElementById('btnprevious').disabled=true;
			
			document.getElementById('btnnext').disabled=true;
			
			document.getElementById('btnlast').disabled=true;
			
			document.getElementById('btnExecute').disabled=true;
			
			document.getElementById('btnModify').disabled=true;
			
			document.getElementById('btnDelete').disabled=true;
			document.getElementById('mrvregion').disabled=false;
			setButtonImages();
			return false;
			
			
			
			

}

function queryclick()
{

//dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 

Agent_master.blankSession();
  document.getElementById('lbcommdetail').disabled=true;
    document.getElementById('lbbankdetail').disabled=true;
    document.getElementById('lbstatusdetail').disabled=true;
    document.getElementById('lbbankmast').disabled=true;
    document.getElementById('lbpaymode').disabled=true;
    document.getElementById('lbcontactdetails').disabled = true;

    document.getElementById('txtdesg').value = "";




document.getElementById('hiddensaurabh').value="0";
document.getElementById('hiddenquery').value="query";
saurabh="2";
show="0";
if(document.getElementById('hiddenpermission').value=="zero")
{
alert("You Are Noe Authorised To See This Form");
return false;
}


    var f="0";

    var d1="";
    var browser=navigator.appName;
    var  httpRequest =null;
    //alert(browser);
   
   
    if(browser!="Microsoft Internet Explorer")
    {
    
        httpRequest= new XMLHttpRequest();
        httpRequest.open("GET","agencynull.aspx?f="+f, false);
        httpRequest.send('');        
        dl=httpRequest.responseText;     
    
    
    
    }
    else if(browser="Microsoft Internet Explorer")
    {
      
             var xml = new ActiveXObject("Microsoft.XMLHTTP");
		     xml.Open( "GET","agencynull.aspx?f="+f, false );
		     xml.Send();
		     dl=xml.responseText;
    
    
    }



		    
		    
		    
		    
		    

hiddentext="query";
z=0;
document.getElementById('txtstatus').style.visibility="hidden";
			document.getElementById('txtstatusdate').style.visibility="hidden";
			document.getElementById('Status').style.visibility="hidden";
			document.getElementById('StatusDate').style.visibility="hidden";

document.getElementById('hiddenstatuslabel').value="show";
document.getElementById('txtpincode').value="";

			
			document.getElementById('txturl').value="";
			document.getElementById('drpbranch').value="0";
			document.getElementById('txtphone1').value="";
			
			
			
	        document.getElementById('mrvregion').value="";
	        document.getElementById('drpbillf').value="0";
				
			
			document.getElementById('txturl').value="";

			document.getElementById('txtbill').value="0";
			
			document.getElementById('txtagencode').value="";
		
			document.getElementById('txtagenname').value="";
			document.getElementById('hiddenagencyname').value=document.getElementById('txtagenname').value;
			document.getElementById('txtsagencycode').value="";
			
			document.getElementById('drpagecate').value="0";
			//drpregion.SelectedValue="0";
			
			document.getElementById('txtcrlimit').value="";
			
			document.getElementById('txtagencyho').value="";
			
			document.getElementById('drpagetyp').value="0";
			
			document.getElementById('drpagecate').value="0";
			document.getElementById('drpparent').value="0";
			document.getElementById('drpagescat').value="0";
	
			document.getElementById('txtagencyho').value="";
			
			document.getElementById('txtsugagencyho').value="";
			
			document.getElementById('drprepres').value="0";
			
			document.getElementById('txtsugagencyho').value="";


			document.getElementById('biltodrp').value="0";
			document.getElementById('getagsubcode').value="";
			
			
			document.getElementById('txtstatus2').value="";
			
			document.getElementById('txtalias').value="";
			//txtagname.Text="";
			
			document.getElementById('txtalert').value="";
			document.getElementById('drptaluka').value="0";
			document.getElementById('txtremarks').value = "";
			document.getElementById('hidkyc').value = "";
			
			
			document.getElementById('txtagenname').value="";
			document.getElementById('hiddenagencyname').value=document.getElementById('txtagenname').value;
			document.getElementById('txtadd').value="";
			
			//**********************Pankaj
			
			document.getElementById('txtaddress1').value="";
			document.getElementById('txtaddress2').value="";
			//********pankaj
			
			document.getElementById('txtstreet').value="";
			
			document.getElementById('txtdistrict').value="";
			
			document.getElementById('txtcountry').value="0";
			document.getElementById('drpzone').value="0";
			
			document.getElementById('txtphone2').value="";
			
			document.getElementById('drpcurtyp').value="0";

			document.getElementById('txtmail').value = "";
			document.getElementById('txtmailcc').value = "";
			
			document.getElementById('txttan').value="";
			
				document.getElementById('txtpan').value="";
			//			drprepres.disabled=true;
			//			drpstatus.disabled=true;
			
			document.getElementById('txtbill').value="0";
			
			
			//			drpsageo.disabled=true;
			
			document.getElementById('txtpincode').value="";
			
			document.getElementById('txtstate').value="";
			//string zip="246763";
			
			document.getElementById('txtfax').value="";
			document.getElementById('txtfax1').value="";
			document.getElementById('txtenrolldate').value="";
			
			document.getElementById('txtnoofvts').value="";
			
			//document.getElementById('txtstatusdate').value="";
			//			drpcity.disabled=true;
			//string url="www.4cplus.com";
			
			document.getElementById('txtbusineedate').value="";
			
			document.getElementById('txtmryrefno').value="";
			
			document.getElementById('txtcredit').value="";
			
			document.getElementById('txtstacno').value="";
			document.getElementById('drpregion').value=="0";
			document.getElementById('drpregion').value="0";
			document.getElementById('drpuserid').value="0";
			document.getElementById('txtoldagen').value = "";
			document.getElementById('drpEdition_wise_Billing').value = "N";
			document.getElementById('drpgstus').value = "Y";
			document.getElementById('txtgstdt').value = "";
			document.getElementById('txtgstin').value = "";
			document.getElementById('txtgstclty').value = "";
			document.getElementById('drpgstatus').value = "Y";
			document.getElementById('hdngstclty').value = "";
			document.getElementById('txtarno').value = "";
			document.getElementById('txtgstprovid').value = "";

			document.getElementById('drpgstus').disabled = true;
			document.getElementById('txtgstdt').disabled = true;
			document.getElementById('txtgstin').disabled = true;
			document.getElementById('txtgstclty').disabled = true;
			document.getElementById('drpgstatus').disabled = true;
			document.getElementById('txtarno').disabled = true;
			document.getElementById('txtgstprovid').disabled = true;
			document.getElementById('drpEdition_wise_Billing').disabled = true;
			document.getElementById("chkvat").checked = false;
			document.getElementById("chkcheque").checked = false;
			document.getElementById("chkbondrecvd").checked = false;
			document.getElementById("chkyc").checked = false;
			document.getElementById("chkadproof").checked = false;
			document.getElementById('chkraterevise').checked = false;
			var bktyplen=document.getElementById('bktype').options.length;
             for(var t2=0;t2<bktyplen;t2++)
             {
                 document.getElementById('bktype').options[t2].selected=false;
             }
			document.getElementById('bktype').disabled=true;
			
			var exelen=document.getElementById('Libexecutive').options.length;
			for(var t3=0;t3<exelen;t3++)
             {
                 document.getElementById('Libexecutive').options[t3].selected=false;
             }
			document.getElementById('Libexecutive').disabled=true;
			var ret = document.getElementById('liretainer').options.length;
			for (var t4 = 0; t4 < ret; t4++) {
			    document.getElementById('liretainer').options[t4].selected = false;
			}
			document.getElementById('liretainer').disabled = true;
			
			
document.getElementById('drpuserid').disabled=true;
	document.getElementById('drprate').disabled=true;
			document.getElementById('drpagecate').disabled=false;
			
			document.getElementById('txtagencode').disabled=false;
			
			
			document.getElementById('txtsagencycode').disabled=false;
			
			document.getElementById('txtagenname').disabled=false;
			
			
			document.getElementById('drpagescat').disabled=false;
			
			
			document.getElementById('txtstatus2').disabled=true;
			
			document.getElementById('txtalias').disabled=false;
			document.getElementById('drpbillf').disabled=false;
			
			document.getElementById('mrvregion').disabled=true;
			document.getElementById('txtoldagen').disabled=true;
			
			
			document.getElementById('drpregion').disabled=true;


			document.getElementById("Divgrid1").style.display = "none";
			document.getElementById('btnagencyname').disabled = true;
			
			document.getElementById('txtphone1').disabled=true;
			
			
			//txtagname.ReadOnly=false;
			
			document.getElementById('txtalert').disabled=true;

			document.getElementById('txtremarks').disabled = true;
			document.getElementById('attachment1').disabled = true;
		
			
			
			document.getElementById('txtadd').disabled=true;
			//**************Pankaj
			document.getElementById('txtaddress1').disabled=true;
			document.getElementById('txtaddress2').disabled=true;
			//********Pankaj
			
			
			document.getElementById('txtstreet').disabled=true;
			
			document.getElementById('txtdistrict').disabled=true;
			
			
			document.getElementById('drpzone').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;



			document.getElementById('txtmail').disabled = true;
			document.getElementById('txtmailcc').disabled = true;
			document.getElementById('drpcurtyp').disabled=true;
			document.getElementById('txttan').disabled=true;
			document.getElementById('txtpan').disabled=true;
			
			document.getElementById('drprepres').disabled=true;
			//drpstatus.disabled=true;
			document.getElementById('txtbill').disabled=true;
			
			document.getElementById('drpagetyp').disabled=false;
			//drpsageo.disabled=true;
			document.getElementById('txtpincode').disabled=true;
			document.getElementById('txtstate').disabled=true;
			//string zip="246763";
			document.getElementById('txtfax').disabled=true;
			document.getElementById('txtfax1').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtnoofvts').disabled=true;
			//document.getElementById('biltodrp').disabled=false;
			document.getElementById('drpbranch').disabled=false;
			document.getElementById('drpcity').disabled=false;
			
			document.getElementById('drpcity').value="0";
			//string url="www.4cplus.com";
			document.getElementById('txtbusineedate').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtmryrefno').disabled=true;
			document.getElementById('txtcredit').disabled=true;
			document.getElementById('txtstacno').disabled=true;
			
			
			document.getElementById('txturl').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;
			document.getElementById('txtalias').disabled=false;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('chkvat').disabled = true;
			document.getElementById("chkcheque").disabled = true;
			document.getElementById("chkbondrecvd").disabled = true;
			document.getElementById("chkyc").disabled = true;
			document.getElementById("chkadproof").disabled = true;
			document.getElementById('chkraterevise').disabled = true; 
			
			//string paymode=bank;
			
			document.getElementById('btnSave').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			
			
			
			
			
			document.getElementById('drpregion').disabled=true;
			//drpcity.SelectedItem.Text="--Select City--";
			//drpregion.disabled=false;
			document.getElementById('txtcountry').disabled=false;
			document.getElementById('drpzone').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			document.getElementById('btnshowremark').disabled = true;
				
			
			document.getElementById('hiddentxt').value="cancel";
			
			document.getElementById('btnNew').disabled=true;
			document.getElementById('btnQuery').disabled=true;
			document.getElementById('btnExit').disabled=false;
			
			document.getElementById('btnExit').disabled=false;
			
			document.getElementById('btnSave').disabled=true;
			document.getElementById('btnModify').disabled=true;
			
			document.getElementById('btnfirst').disabled=true;
			
			document.getElementById('btnprevious').disabled=true;
			document.getElementById('btnnext').disabled=true;
			document.getElementById('btnlast').disabled = true; 



			document.getElementById('btnExecute').disabled = false;
			document.getElementById('drpparent').disabled = false;
			setButtonImages();
			return false;


}




/*function firstclick()
{
z=0;
document.getElementById('txtstatus').style.visibility="visible";
			document.getElementById('txtstatusdate').style.visibility="visible";
			document.getElementById('Status').style.visibility="visible";
			document.getElementById('StatusDate').style.visibility="visible";

			
var compcode=document.getElementById('hiddencompcode').value;
var userid=document.getElementById('hiddenuserid').value;
var txtagencycode=document.getElementById('txtagencode').value;


//dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 
Agent_master.first(compcode,userid,txtagencycode,fillfirst);

if(document.getElementById('hiddenpermission').value=="4")
			{
			document.getElementById('btnModify').disabled=true;
			//document.getElementById('btnQuery').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}

return false;

}*/

/*function fillfirst(response)

{
var ds=response.value;
document.getElementById('txtpincode').value=ds.Tables[0].Rows[0].pin_code;

			ds.Tables[0].Rows[0].state_name
			
			if(ds.Tables[0].Rows[0].URL != "" && ds.Tables[0].Rows[0].URL != null)
			{
			document.getElementById('txturl').value=ds.Tables[0].Rows[0].URL;
			}
			else
			{
			document.getElementById('txturl').value="";
			}
			
			if(ds.Tables[0].Rows[0].CREDIT_TYPE != "" && ds.Tables[0].Rows[0].CREDIT_TYPE != null)
			{
			document.getElementById('drpcurtyp').value=ds.Tables[0].Rows[0].CREDIT_TYPE;
			}
			else
			{
			document.getElementById('drpcurtyp').value="0"
			}
			
			
			
			if(ds.Tables[0].Rows[0].Zip != "" && ds.Tables[0].Rows[0].Zip != null)
			{
	        document.getElementById('mrvregion').value=ds.Tables[0].Rows[0].Zip;
	        }
	        else
	        {
	        document.getElementById('mrvregion').value=""
	        }
	        
	        document.getElementById('txtphone1').value=ds.Tables[0].Rows[0].CODE;
				
			

			
			
			document.getElementById('txtagencode').value=ds.Tables[0].Rows[0].Agency_Code;
		
			document.getElementById('txtagenname').value=ds.Tables[0].Rows[0].Agency_Name;
			
			document.getElementById('txtsagencycode').value=ds.Tables[0].Rows[0].SUB_Agency_Code;
			document.getElementById('drpzone').value=ds.Tables[0].Rows[0].zone_code;
			document.getElementById('drpagecate').value=ds.Tables[0].Rows[0].Agency_Cat_Code;
			//drpregion.SelectedValue="0";
			
			//document.getElementById('txtcrlimit').value=ds.Tables[0].Rows[0].Agency_Cat_Code;
			
			document.getElementById('txtagencyho').value=ds.Tables[0].Rows[0].Agency_HO;
			
			document.getElementById('drpagetyp').value=ds.Tables[0].Rows[0].Agency_Type_Code;
			
			
			
			//document.getElementById('drpagescat').value=ds.Tables[0].Rows[0].Agency_SubCat_Code;
			//drpregion.SelectedValue="0";
			
			addsubcategory(ds.Tables[0].Rows[0].Agency_Cat_Code);
           catvar=ds.Tables[0].Rows[0].Agency_SubCat_Code;
			
			document.getElementById('txtsugagencyho').value=ds.Tables[0].Rows[0].SUB_Agency_HO;
			
			document.getElementById('drprepres').value=ds.Tables[0].Rows[0].representative_code;
			//drpcity.SelectedValue="0";
			
			

//document.getElementById('getagcode').value=document.getElementById('txtagencode').value;
document.getElementById('getagsubcode').value=document.getElementById('txtsagencycode').value;
			
			
			
			document.getElementById('txtstatus2').value=ds.Tables[0].Rows[0].Status_Reason;
			
			document.getElementById('txtalias').value=ds.Tables[0].Rows[0].Agency_Alias;
			//txtagname.Text="";
			
			document.getElementById('txtalert').value=ds.Tables[0].Rows[0].ALERT;
			
			document.getElementById('txtremarks').value=ds.Tables[0].Rows[0].Remarks;
			
			
			//***************************Pankaj
			
			document.getElementById('txtadd').value=ds.Tables[0].Rows[0].Add1;
			
			document.getElementById('txtaddress1').value=ds.Tables[0].Rows[0].Add2;
			document.getElementById('txtaddress21').value=ds.Tables[0].Rows[0].Add3;
			//**************************Pankaj
			
			
			document.getElementById('txtstreet').value=ds.Tables[0].Rows[0].Street;
			
			document.getElementById('txtdistrict').value=ds.Tables[0].Rows[0].Dist_Code;
			
			document.getElementById('txtcountry').value=ds.Tables[0].Rows[0].Country_Code;
			cityvar=ds.Tables[0].Rows[0].City_Code;
			addcount(ds.Tables[0].Rows[0].Country_Code);
			document.getElementById('txtphone2').value=ds.Tables[0].Rows[0].Phone;
			
			
			
			document.getElementById('txtmail').value=ds.Tables[0].Rows[0].EmailID;
			
			document.getElementById('txttan').value=ds.Tables[0].Rows[0].TAN_No;
			
				document.getElementById('txtpan').value=ds.Tables[0].Rows[0].PAN_No;
			//			drprepres.disabled=true;
			//			drpstatus.disabled=true;
			var compcode=document.getElementById('hiddencompcode').value;
            var userid=document.getElementById('hiddenuserid').value;
            Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,call_billto);
            Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,billtodrpcall);
            //document.getElementById('txtbill').value=ds.Tables[0].Rows[0].BILL_TO;
			//document.getElementById('txtbill').value=ds.Tables[0].Rows[0].BILL_TO;
			
			varbiltocal=ds.Tables[0].Rows[0].acagency;
			biltovar=ds.Tables[0].Rows[0].BILL_TO;
			
			//			drpsageo.disabled=true;
			
			document.getElementById('txtpincode').value=ds.Tables[0].Rows[0].pin_code;
			
			document.getElementById('txtstate').value=ds.Tables[0].Rows[0].State_Code;
			//string zip="246763";
			
			document.getElementById('txtfax').value=ds.Tables[0].Rows[0].Fax;
			document.getElementById('txtfax1').value=ds.Tables[0].Rows[0].fax1;
			var dateformat=document.getElementById('hiddendateformat').value;
			
			if(ds.Tables[0].Rows[0].Enroll_Date != null && ds.Tables[0].Rows[0].Enroll_Date != "")
			{
			var enrolldate=ds.Tables[0].Rows[0].Enroll_Date;
			var dd=enrolldate.getDate();
			var mm=enrolldate.getMonth() + 1;
			var yyyy=enrolldate.getFullYear();
			
			var enrolldate1=mm+'/'+dd+'/'+yyyy;
			var enrolldate1day=dd+'/'+mm+'/'+yyyy;
			var enrollyear=yyyy+'/'+mm+'/'+dd;
			
			
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtenrolldate').value=enrolldate1;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtenrolldate').value=enrollyear;
			}
			
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtenrolldate').value=enrolldate1day;
			}
			if(dateformat==null || dateformat=="")
			{
			document.getElementById('txtenrolldate').value=enrolldate1;
			}
			
			
			
			}
			else
			{
			
//			document.getElementById('txtenrolldate').value=ds.Tables[0].Rows[0].Enroll_Date;
			document.getElementById('txtenrolldate').value=="";
			}
			
			document.getElementById('txtnoofvts').value=ds.Tables[0].Rows[0].No_of_VTS;
			
			document.getElementById('drpcity').value==ds.Tables[0].Rows[0].City_Code;
			document.getElementById('drpregion').value=ds.Tables[0].Rows[0].region;
			
			//document.getElementById('Status').visible=true;
			
			//document.getElementById('StatusDate').styles.display="none";
			//StatusDate.style.display="visible";
			
			
			var todate=ds.Tables[0].Rows[0].to_date;
			var currdate=ds.Tables[0].Rows[0].current_Datetime;
			var tdate=new Date(todate);
			var cdate=new Date(currdate);
			
			var dd=currdate.getDate();
			var mm=currdate.getMonth() + 1;
			var yyyy=currdate.getFullYear();
			
			var currdate1=mm+'/'+dd+'/'+yyyy;
			var currda=dd+'/'+mm+'/'+yyyy;
			var curryear=yyyy+'/'+mm+'/'+dd;
			
		
			if(cdate > tdate && todate!= null )
			{
			document.getElementById('txtstatus').value="Banned";
			}
			else if(todate == null && ds.Tables[0].Rows[0].status_name==null)
			{
			document.getElementById('txtstatus').value="Active";
			}
			else
			{
			
			document.getElementById('txtstatus').value=ds.Tables[0].Rows[0].status_name;
			}
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtstatusdate').value=currdate1;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtstatusdate').value=currda;
			}
			if(dateformat=="yyyy/mm/dd")
			{document.getElementById('txtstatusdate').value=curryear;
			}
			if(dateformat==null || dateformat=="" || dateformat=="undefined")
			{document.getElementById('txtstatusdate').value=currdate1;
			}
			//document.getElementById('txtstatus').value=ds.Tables[0].Rows[0].current_Datetime;
			
			if(ds.Tables[0].Rows[0].Buss_Start_Date != null && ds.Tables[0].Rows[0].Buss_Start_Date != "")
			{
			var bussdate=ds.Tables[0].Rows[0].Buss_Start_Date;
			var dd=bussdate.getDate();
			var mm=bussdate.getMonth() + 1;
			var yyyy=bussdate.getFullYear();
			
			var bussdate1=mm+'/'+dd+'/'+yyyy;
			var bussdate1day=dd+'/'+mm+'/'+yyyy;
			var bussyear=yyyy+'/'+mm+'/'+dd;
			
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtbusineedate').value=bussdate1;
			
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtbusineedate').value=bussyear;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			
			document.getElementById('txtbusineedate').value=bussdate1day;
			}
			if(dateformat==null || dateformat=="")
			{
			document.getElementById('txtbusineedate').value=bussdate1;
			
			}
			
			
			
			
			
			}
			else
			{
			
			//document.getElementById('txtbusineedate').value=ds.Tables[0].Rows[0].Buss_Start_Date;
			document.getElementById('txtbusineedate').value="";
			}
			
			document.getElementById('txtmryrefno').value=ds.Tables[0].Rows[0].MRV_Ref_No;
			
			document.getElementById('txtcredit').value=ds.Tables[0].Rows[0].Credit_Days;
			
			document.getElementById('txtstacno').value=ds.Tables[0].Rows[0].ST_ACC_No;
			document.getElementById('txtcrlimit').value=ds.Tables[0].Rows[0].CREDIT_LIMIT;
			
			document.getElementById('drpagecate').disabled=true;
			
			document.getElementById('txtagencode').disabled=true;
			
			
			document.getElementById('txtsagencycode').disabled=true;
			
			document.getElementById('txtagenname').disabled=true;
			
			
			document.getElementById('drpagescat').disabled=true;
			
			
			document.getElementById('drpagecate').disabled=true;
			
			document.getElementById('txtagencode').disabled=true;
			
			
			document.getElementById('txtsagencycode').disabled=true;
			
			document.getElementById('txtagenname').disabled=true;
			
			
			document.getElementById('drpagescat').disabled=true;
			
			
			document.getElementById('txtstatus2').disabled=true;
			
			document.getElementById('txtalias').disabled=true;
			
			
			document.getElementById('mrvregion').disabled=true;
			
			
			
			document.getElementById('drpregion').disabled=true;
			
			
			
			document.getElementById('txtphone1').disabled=true;
			
			
			//txtagname.ReadOnly=false;
			
			document.getElementById('txtalert').disabled=true;
			
			document.getElementById('txtremarks').disabled=true;
		
			document.getElementById('txtagenname').disabled=true;
			
			document.getElementById('txtadd').disabled=true;
			//************************Pankaj
			document.getElementById('txtaddress1').disabled=true;
			document.getElementById('txtaddress2').disabled=true;
			
			
			
			document.getElementById('txtstreet').disabled=true;
			
			document.getElementById('txtdistrict').disabled=true;
			
			ocument.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			
			
			document.getElementById('txtbusineedate').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			
			
			
			document.getElementById('txtphone2').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;
			
			document.getElementById('txtmail').disabled=true;
			document.getElementById('drpcurtyp').disabled=true;
			document.getElementById('txttan').disabled=true;
			document.getElementById('txtpan').disabled=true;
			
			document.getElementById('drprepres').disabled=true;
			//drpstatus.disabled=true;
			document.getElementById('txtbill').disabled=true;
			
			document.getElementById('drpagetyp').disabled=true;
			//drpsageo.disabled=true;
			document.getElementById('txtpincode').disabled=true;
			document.getElementById('txtstate').disabled=true;
			//string zip="246763";
			document.getElementById('txtfax').disabled=true;
			document.getElementById('txtfax1').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtnoofvts').disabled=true;
			//document.getElementById('txtstatusdate').disabled=false;
			
			document.getElementById('drpcity').disabled=true;
			
			
			//string url="www.4cplus.com";
			document.getElementById('txtbusineedate').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtmryrefno').disabled=true;
			document.getElementById('txtcredit').disabled=true;
			document.getElementById('txtstacno').disabled=true;
			document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabledd);
			//document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabled);
			document.getElementById('txturl').disabled=true;
			document.getElementById('txturl').disabled=true;
			document.getElementById('txtphone2').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			//string paymode=bank;
			
			document.getElementById('btnSave').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			
			
			
			
			document.getElementById('drpregion').disabled=true;
			//drpcity.SelectedItem.Text="--Select City--";
			//drpregion.disabled=false;
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			
			
			
			
			document.getElementById('txtalias').disabled=true;
			document.getElementById('drpagetyp').disabled=true;
			document.getElementById('drpcity').disabled=true;
			document.getElementById('txtstatus').disabled=true;
			document.getElementById('txtstatusdate').disabled=true;
			
			document.getElementById('btnModify').disabled=false;
			document.getElementById('btnQuery').disabled=false;
			document.getElementById('btnfirst').disabled=true;
			document.getElementById('btnprevious').disabled=true;
			document.getElementById('btnnext').disabled=false;
			document.getElementById('btnlast').disabled=false;
			document.getElementById('btnCancel').disabled=false;
			document.getElementById('btnNew').disabled=true;
			document.getElementById('btnSave').disabled=true;
			document.getElementById('btnExecute').disabled=true;
			
			
			if(document.getElementById('hiddenpermission').value=="4")
			{
			document.getElementById('btnModify').disabled=true;
			//document.getElementById('btnQuery').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			
			
			if(document.getElementById('hiddenpermission').value=="5")
			{
			document.getElementById('btnModify').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			
			return false;



}*/

/*function lastclick()

{
document.getElementById('txtstatus').style.visibility="visible";
			document.getElementById('txtstatusdate').style.visibility="visible";
			document.getElementById('Status').style.visibility="visible";
			document.getElementById('StatusDate').style.visibility="visible";

var compcode=document.getElementById('hiddencompcode').value;
var userid=document.getElementById('hiddenuserid').value;
var txtagencycode=document.getElementById('txtagencode').value;


//dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 
Agent_master.last(compcode,userid,txtagencycode,filllast);
return false;


}*/

/*function filllast(response)
{
var ds=response.value;

var y=ds.Tables[0].Rows.length;
z=y-1;
y=y-1;

document.getElementById('txtpincode').value=ds.Tables[0].Rows[y].pin_code;

			ds.Tables[0].Rows[0].state_name
			
			
			document.getElementById('txtphone1').value=ds.Tables[0].Rows[y].CODE;
			
			
			
	        if(ds.Tables[0].Rows[y].URL != "" && ds.Tables[0].Rows[y].URL != null)
			{
			document.getElementById('txturl').value=ds.Tables[0].Rows[y].URL;
			}
			else
			{
			document.getElementById('txturl').value="";
			}
			
			if(ds.Tables[0].Rows[y].CREDIT_TYPE != "" && ds.Tables[0].Rows[y].CREDIT_TYPE != null)
			{
			document.getElementById('drpcurtyp').value=ds.Tables[0].Rows[y].CREDIT_TYPE;
			}
			else
			{
			document.getElementById('drpcurtyp').value="0"
			}
			
			
			
			if(ds.Tables[0].Rows[y].Zip != "" && ds.Tables[0].Rows[y].Zip != null)
			{
	        document.getElementById('mrvregion').value=ds.Tables[0].Rows[y].Zip;
	        }
	        else
	        {
	        document.getElementById('mrvregion').value="";
	        }
				
			
			

			
			
			document.getElementById('txtagencode').value=ds.Tables[0].Rows[y].Agency_Code;
		
			document.getElementById('txtagenname').value=ds.Tables[0].Rows[y].Agency_Name;
			
			document.getElementById('txtsagencycode').value=ds.Tables[0].Rows[y].SUB_Agency_Code;
			document.getElementById('drpzone').value=ds.Tables[0].Rows[y].zone_code;
			document.getElementById('drpagecate').value=ds.Tables[0].Rows[y].Agency_Cat_Code;
			//drpregion.SelectedValue="0";
			
			//document.getElementById('txtcrlimit').value=ds.Tables[0].Rows[y].Agency_Cat_Code;
			
			document.getElementById('txtagencyho').value=ds.Tables[0].Rows[y].Agency_HO;
			
			document.getElementById('drpagetyp').value=ds.Tables[0].Rows[y].Agency_Type_Code;
			
			
			
			//document.getElementById('drpagescat').value=ds.Tables[0].Rows[y].Agency_SubCat_Code;
			//drpregion.SelectedValue="0";
//			addcategory(ds.Tables[0].Rows[y].Agency_Type_Code);
//			catvar=ds.Tables[0].Rows[y].Agency_Cat_Code;
			addsubcategory(ds.Tables[0].Rows[y].Agency_Cat_Code);
           catvar=ds.Tables[0].Rows[y].Agency_SubCat_Code;
			
			
			document.getElementById('txtsugagencyho').value=ds.Tables[0].Rows[y].SUB_Agency_HO;
			
			document.getElementById('drprepres').value=ds.Tables[0].Rows[y].representative_code;
			//drpcity.SelectedValue="0";
			
			


			
			
			
			document.getElementById('txtstatus2').value=ds.Tables[0].Rows[y].Status_Reason;
			
			document.getElementById('txtalias').value=ds.Tables[0].Rows[y].Agency_Alias;
			//txtagname.Text="";
			
			document.getElementById('txtalert').value=ds.Tables[0].Rows[y].ALERT;
			
			document.getElementById('txtremarks').value=ds.Tables[0].Rows[y].Remarks;
			
			
			
			//**********pankaj
			document.getElementById('txtadd').value=ds.Tables[0].Rows[y].Add1;
			document.getElementById('txtaddress1').value=ds.Tables[0].Rows[y].Add2;
			document.getElementById('txtaddress2').value=ds.Tables[0].Rows[y].Add2;
			//**************************Pankaj
			
			
			
			
			document.getElementById('txtstreet').value=ds.Tables[0].Rows[y].Street;
			
			document.getElementById('txtdistrict').value=ds.Tables[0].Rows[y].Dist_Code;
			
			document.getElementById('txtcountry').value=ds.Tables[0].Rows[y].Country_Code;
			cityvar=ds.Tables[0].Rows[y].City_Code;
			addcount(ds.Tables[0].Rows[y].Country_Code);
			document.getElementById('txtphone2').value=ds.Tables[0].Rows[y].Phone;
			//document.getElementById('getagcode').value=document.getElementById('txtagencode').value;
document.getElementById('getagsubcode').value=document.getElementById('txtsagencycode').value;
			
			
			document.getElementById('txtmail').value=ds.Tables[0].Rows[y].EmailID;
			
			document.getElementById('txttan').value=ds.Tables[0].Rows[y].TAN_No;
			
				document.getElementById('txtpan').value=ds.Tables[0].Rows[y].PAN_No;
			//			drprepres.disabled=true;
			//			drpstatus.disabled=true;
			var compcode=document.getElementById('hiddencompcode').value;
            var userid=document.getElementById('hiddenuserid').value;
            Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,call_billto);
             Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,billtodrpcall);
            //document.getElementById('txtbill').value=ds.Tables[0].Rows[y].BILL_TO;
			//document.getElementById('txtbill').value=ds.Tables[0].Rows[y].BILL_TO;
			biltovar=ds.Tables[0].Rows[y].BILL_TO;
			varbiltocal=ds.Tables[0].Rows[y].acagency;
			
			//			drpsageo.disabled=true;
			
			document.getElementById('txtpincode').value=ds.Tables[0].Rows[y].pin_code;
			
			document.getElementById('txtstate').value=ds.Tables[0].Rows[y].State_Code;
			//string zip="246763";
			
			document.getElementById('txtfax').value=ds.Tables[0].Rows[y].Fax;
			document.getElementById('txtfax1').value=ds.Tables[0].Rows[y].fax1;
			var dateformat=document.getElementById('hiddendateformat').value;
			
			if(ds.Tables[0].Rows[y].Enroll_Date != null && ds.Tables[0].Rows[y].Enroll_Date != "")
			{
			var enrolldate=ds.Tables[0].Rows[y].Enroll_Date;
			var dd=enrolldate.getDate();
			var mm=enrolldate.getMonth() + 1;
			var yyyy=enrolldate.getFullYear();
			
			var enrolldate1=mm+'/'+dd+'/'+yyyy;
			var enrolldate1day=dd+'/'+mm+'/'+yyyy;
			var enrollyear=yyyy+'/'+mm+'/'+dd;
			
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtenrolldate').value=enrolldate1;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtenrolldate').value=enrollyear;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtenrolldate').value=enrolldate1day;
			}
			if(dateformat==null || dateformat=="")
			{
			document.getElementById('txtenrolldate').value=enrolldate1;
			}
			
			
			}
			else
			{
			
			//document.getElementById('txtenrolldate').value=ds.Tables[0].Rows[y].Enroll_Date;
			document.getElementById('txtenrolldate').value="";
			}
			
			document.getElementById('txtnoofvts').value=ds.Tables[0].Rows[y].No_of_VTS;
			
			document.getElementById('drpcity').value=ds.Tables[0].Rows[y].City_Code;
			document.getElementById('drpregion').value=ds.Tables[0].Rows[y].region;
			document.getElementById('txtcrlimit').value=ds.Tables[0].Rows[y].CREDIT_LIMIT;
			
			//document.getElementById('Status').visible=true;
			
			//document.getElementById('StatusDate').styles.display="none";
			//StatusDate.style.display="visible";
			
			
			var todate=ds.Tables[0].Rows[y].to_date;
			var currdate=ds.Tables[0].Rows[y].current_Datetime;
			var tdate=new Date(todate);
			var cdate=new Date(currdate);
			
			var dd=currdate.getDate();
			var mm=currdate.getMonth() + 1;
			var yyyy=currdate.getFullYear();
			
			var currdate1=mm+'/'+dd+'/'+yyyy;
			var currda=dd+'/'+mm+'/'+yyyy;
			var curryear=yyyy+'/'+mm+'/'+dd;
			
		
			if(cdate > tdate && todate!= null )
			{
			document.getElementById('txtstatus').value="Banned";
			}
			else if(todate == null && ds.Tables[0].Rows[y].status_name==null)
			{
			document.getElementById('txtstatus').value="Active";
			}
			else
			{
			
			document.getElementById('txtstatus').value=ds.Tables[0].Rows[y].status_name;
			}
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtstatusdate').value=currdate1;
			}
			if(dateformat=="dd/mm/yyyy")
			{document.getElementById('txtstatusdate').value=currda;
			}
			if(dateformat=="yyyy/mm/dd")
			{document.getElementById('txtstatusdate').value=curryear;
			}
			if(dateformat== null || dateformat=="" || dateformat=="undefined")
			{document.getElementById('txtstatusdate').value=currdate1;
			}
			//document.getElementById('txtstatus').value=ds.Tables[0].Rows[0].current_Datetime;
			
			if(ds.Tables[0].Rows[y].Buss_Start_Date != null && ds.Tables[0].Rows[y].Buss_Start_Date != "")
			{
			var bussdate=ds.Tables[0].Rows[y].Buss_Start_Date;
			var dd=bussdate.getDate();
			var mm=bussdate.getMonth() + 1;
			var yyyy=bussdate.getFullYear();
			
			var bussdate1=mm+'/'+dd+'/'+yyyy;
			var bussdate1day=dd+'/'+mm+'/'+yyyy;
			var bussyear=yyyy+'/'+mm+'/'+dd;
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtbusineedate').value=bussdate1;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtbusineedate').value=bussyear;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtbusineedate').value=bussdate1day;
			}
			if(dateformat==null || dateformat=="")
			{
			document.getElementById('txtbusineedate').value=bussdate1;
			}
			
			}
			else
			{
			
			//document.getElementById('txtbusineedate').value=ds.Tables[0].Rows[y].Buss_Start_Date;
			document.getElementById('txtbusineedate').value="";
			}
			
			document.getElementById('txtmryrefno').value=ds.Tables[0].Rows[y].MRV_Ref_No;
			
			document.getElementById('txtcredit').value=ds.Tables[0].Rows[y].Credit_Days;
			
			document.getElementById('txtstacno').value=ds.Tables[0].Rows[y].ST_ACC_No;
			
			document.getElementById('drpagecate').disabled=true;
			
			document.getElementById('txtagencode').disabled=true;
			
			
			document.getElementById('txtsagencycode').disabled=true;
			
			document.getElementById('txtagenname').disabled=true;
			
			
			document.getElementById('drpagescat').disabled=true;
			
			
			document.getElementById('drpagecate').disabled=true;
			
			document.getElementById('txtagencode').disabled=true;
			
			
			document.getElementById('txtsagencycode').disabled=true;
			
			document.getElementById('txtagenname').disabled=true;
			
			
			document.getElementById('drpagescat').disabled=true;
			
			
			document.getElementById('txtstatus2').disabled=true;
			
			document.getElementById('txtalias').disabled=true;
			
			
			document.getElementById('mrvregion').disabled=true;
			
			
			
			document.getElementById('drpregion').disabled=true;
			
			
			
			document.getElementById('txtphone1').disabled=true;
			
			
			//txtagname.ReadOnly=false;
			
			document.getElementById('txtalert').disabled=true;
			
			document.getElementById('txtremarks').disabled=true;
		
			document.getElementById('txtagenname').disabled=true;
			
			//******************Pankaj
			document.getElementById('txtadd').disabled=true;
			
			document.getElementById('txtaddress1').disabled=true;
			document.getElementById('txtaddress2').disabled=true;
			//*******************pankaj
			
			document.getElementById('txtstreet').disabled=true;
			
			document.getElementById('txtdistrict').disabled=true;
			
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;
			
			document.getElementById('txtmail').disabled=true;
			document.getElementById('drpcurtyp').disabled=true;
			document.getElementById('txttan').disabled=true;
			document.getElementById('txtpan').disabled=true;
			
			document.getElementById('drprepres').disabled=true;
			//drpstatus.disabled=true;
			document.getElementById('txtbill').disabled=true;
			
			document.getElementById('drpagetyp').disabled=true;
			//drpsageo.disabled=true;
			document.getElementById('txtpincode').disabled=true;
			document.getElementById('txtstate').disabled=true;
			//string zip="246763";
			document.getElementById('txtfax').disabled=true;
			document.getElementById('txtfax1').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtnoofvts').disabled=true;
			//document.getElementById('txtstatusdate').disabled=false;
			
			document.getElementById('drpcity').disabled=true;
			
			
			document.getElementById('txtbusineedate').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtmryrefno').disabled=true;
			document.getElementById('txtcredit').disabled=true;
			document.getElementById('txtstacno').disabled=true;
			document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabledd);
			//document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabled);
			document.getElementById('txturl').disabled=true;
			document.getElementById('txturl').disabled=true;
			document.getElementById('txtphone2').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			//string paymode=bank;
			
			document.getElementById('btnSave').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			
			
			
			
			document.getElementById('drpregion').disabled=true;
			//drpcity.SelectedItem.Text="--Select City--";
			//drpregion.disabled=false;
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			
			document.getElementById('txtalias').disabled=true;
			document.getElementById('drpagetyp').disabled=true;
			document.getElementById('drpcity').disabled=true;
			document.getElementById('txtstatus').disabled=true;
			document.getElementById('txtstatusdate').disabled=true;
			
			document.getElementById('btnModify').disabled=false;
			document.getElementById('btnQuery').disabled=false;
			document.getElementById('btnfirst').disabled=false;
			document.getElementById('btnprevious').disabled=false;
			document.getElementById('btnnext').disabled=true;
			document.getElementById('btnlast').disabled=true;
			document.getElementById('btnCancel').disabled=false;
			document.getElementById('btnNew').disabled=true;
			document.getElementById('btnSave').disabled=true;
			document.getElementById('btnExecute').disabled=true;
			if(document.getElementById('hiddenpermission').value=="4")
			{
			document.getElementById('btnModify').disabled=true;
			//document.getElementById('btnQuery').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			
			if(document.getElementById('hiddenpermission').value=="5")
			{
			document.getElementById('btnModify').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			
			return false;

}*/

/*function nextclick()
{

document.getElementById('txtstatus').style.visibility="visible";
			document.getElementById('txtstatusdate').style.visibility="visible";
			document.getElementById('Status').style.visibility="visible";
			document.getElementById('StatusDate').style.visibility="visible";

var compcode=document.getElementById('hiddencompcode').value;
var userid=document.getElementById('hiddenuserid').value;
var txtagencycode=document.getElementById('txtagencode').value;


document.getElementById('drpagecate').disabled=true;
			
			document.getElementById('txtagencode').disabled=true;
			
			
			document.getElementById('txtsagencycode').disabled=true;
			
			document.getElementById('txtagenname').disabled=true;
			
			
			document.getElementById('drpagescat').disabled=true;
			
			
			document.getElementById('txtstatus2').disabled=true;
			
			document.getElementById('txtalias').disabled=true;
			
			
			document.getElementById('mrvregion').disabled=true;
			
			
			
			document.getElementById('drpregion').disabled=true;
			
			
			
			document.getElementById('txtphone1').disabled=true;
			
			
			//txtagname.ReadOnly=false;
			
			document.getElementById('txtalert').disabled=true;
			
			document.getElementById('txtremarks').disabled=true;
		
			document.getElementById('txtagenname').disabled=true;
			
			document.getElementById('txtadd').disabled=true;
			//******************Pankaj
			document.getElementById('txtaddress1').disabled=true;
			document.getElementById('txtaddress2').disabled=true;
			//**************************^^^^^^^^^^^^^^^^^^^^^^
			
			document.getElementById('txtstreet').disabled=true;
			
			document.getElementById('txtdistrict').disabled=true;
			
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;
			
			document.getElementById('txtmail').disabled=true;
			document.getElementById('drpcurtyp').disabled=true;
			document.getElementById('txttan').disabled=true;
			document.getElementById('txtpan').disabled=true;
			
			document.getElementById('drprepres').disabled=true;
			//drpstatus.disabled=true;
			document.getElementById('txtbill').disabled=true;
			
			document.getElementById('drpagetyp').disabled=true;
			//drpsageo.disabled=true;
			document.getElementById('txtpincode').disabled=true;
			document.getElementById('txtstate').disabled=true;
			//string zip="246763";
			document.getElementById('txtfax').disabled=true;
			document.getElementById('txtfax1').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtnoofvts').disabled=true;
			//document.getElementById('txtstatusdate').disabled=false;
			
			document.getElementById('drpcity').disabled=true;
			
			
			//string url="www.4cplus.com";
			document.getElementById('txtbusineedate').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtmryrefno').disabled=true;
			document.getElementById('txtcredit').disabled=true;
			document.getElementById('txtstacno').disabled=true;
			document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabledd);
			//document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabled);
			document.getElementById('txturl').disabled=true;
			document.getElementById('txturl').disabled=true;
			document.getElementById('txtphone2').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			//string paymode=bank;
			
			document.getElementById('btnSave').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			
			
			
			
			document.getElementById('drpregion').disabled=true;
			//drpcity.SelectedItem.Text="--Select City--";
			//drpregion.disabled=false;
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;


//dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 
Agent_master.next(compcode,userid,txtagencycode,fillnext);

if(document.getElementById('hiddenpermission').value=="4")
			{
			document.getElementById('btnModify').disabled=true;
			//document.getElementById('btnQuery').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			if(document.getElementById('hiddenpermission').value=="5")
			{
			document.getElementById('btnModify').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}

return false;


}*/

/*function fillnext(response)

{
//var z=0;
var ds=response.value;

var y=ds.Tables[0].Rows.length;
z++;

if(z <= y && z !=-1 )

	{
		if(ds.Tables[0].Rows.length != z && z >= 0)
		
		{
		document.getElementById('txtpincode').value=ds.Tables[0].Rows[z].pin_code;

			ds.Tables[0].Rows[0].state_name
			
			
			document.getElementById('txtphone1').value=ds.Tables[0].Rows[z].CODE;
			
			
			
	       if(ds.Tables[0].Rows[z].URL != "" && ds.Tables[0].Rows[z].URL != null)
			{
			document.getElementById('txturl').value=ds.Tables[0].Rows[z].URL;
			}
			else
			{
			document.getElementById('txturl').value="";
			}
			
			
			if(ds.Tables[0].Rows[z].CREDIT_TYPE != "" && ds.Tables[0].Rows[z].CREDIT_TYPE != null)
			{
			document.getElementById('drpcurtyp').value=ds.Tables[0].Rows[z].CREDIT_TYPE;
			}
			else
			{
			document.getElementById('drpcurtyp').value="0"
			}
			
			
			if(ds.Tables[0].Rows[z].Zip != "" && ds.Tables[0].Rows[z].Zip != null)
			{
	        document.getElementById('mrvregion').value=ds.Tables[0].Rows[z].Zip;
	        }
	        else
	        {
	        document.getElementById('mrvregion').value="";
	        }
				
			
			

			
			
			document.getElementById('txtagencode').value=ds.Tables[0].Rows[z].Agency_Code;
		
			document.getElementById('txtagenname').value=ds.Tables[0].Rows[z].Agency_Name;
			
			document.getElementById('txtsagencycode').value=ds.Tables[0].Rows[z].SUB_Agency_Code;
			document.getElementById('drpzone').value=ds.Tables[0].Rows[z].zone_code;
			document.getElementById('drpagecate').value=ds.Tables[0].Rows[z].Agency_Cat_Code;
			//drpregion.SelectedValue="0";
			
			//document.getElementById('txtcrlimit').value=ds.Tables[0].Rows[z].Agency_Cat_Code;
			
			document.getElementById('txtagencyho').value=ds.Tables[0].Rows[z].Agency_HO;
			
			document.getElementById('drpagetyp').value=ds.Tables[0].Rows[z].Agency_Type_Code;
			
			
			
			//document.getElementById('drpagescat').value=ds.Tables[0].Rows[z].Agency_SubCat_Code;
			//drpregion.SelectedValue="0";
//			addcategory(ds.Tables[0].Rows[z].Agency_Type_Code);
//			catvar=ds.Tables[0].Rows[z].Agency_Cat_Code;
			addsubcategory(ds.Tables[0].Rows[z].Agency_Cat_Code);
           catvar=ds.Tables[0].Rows[z].Agency_SubCat_Code;
//			
			
			document.getElementById('txtsugagencyho').value=ds.Tables[0].Rows[z].SUB_Agency_HO;
			
			document.getElementById('drprepres').value=ds.Tables[0].Rows[z].representative_code;
			//drpcity.SelectedValue="0";
			
			


			
			
			
			document.getElementById('txtstatus2').value=ds.Tables[0].Rows[z].Status_Reason;
			
			document.getElementById('txtalias').value=ds.Tables[0].Rows[z].Agency_Alias;
			//txtagname.Text="";
			
			document.getElementById('txtalert').value=ds.Tables[0].Rows[z].ALERT;
			
			document.getElementById('txtremarks').value=ds.Tables[0].Rows[z].Remarks;
			
			
			
			
			document.getElementById('txtadd').value=ds.Tables[0].Rows[z].Add1;
			document.getElementById('txtaddress1').value=ds.Tables[0].Rows[z].Add2;
			document.getElementById('txtaddress2').value=ds.Tables[0].Rows[z].Add3;
			
			
			//document.getElementById('getagcode').value=document.getElementById('txtagencode').value;
document.getElementById('getagsubcode').value=document.getElementById('txtsagencycode').value;
			
			
			document.getElementById('txtstreet').value=ds.Tables[0].Rows[z].Street;
			
			document.getElementById('txtdistrict').value=ds.Tables[0].Rows[z].Dist_Code;
			
			document.getElementById('txtcountry').value=ds.Tables[0].Rows[z].Country_Code;
			cityvar=ds.Tables[0].Rows[z].City_Code;
			addcount(ds.Tables[0].Rows[z].Country_Code);
			document.getElementById('txtphone2').value=ds.Tables[0].Rows[z].Phone;
			
			
			
			document.getElementById('txtmail').value=ds.Tables[0].Rows[z].EmailID;
			
			document.getElementById('txttan').value=ds.Tables[0].Rows[z].TAN_No;
			
				document.getElementById('txtpan').value=ds.Tables[0].Rows[z].PAN_No;
			//			drprepres.disabled=true;
			//			drpstatus.disabled=true;
			var compcode=document.getElementById('hiddencompcode').value;
            var userid=document.getElementById('hiddenuserid').value;
            Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,call_billto);
             Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,billtodrpcall);
            //document.getElementById('txtbill').value=ds.Tables[0].Rows[z].BILL_TO;
//			document.getElementById('txtbill').value=ds.Tables[0].Rows[z].BILL_TO;
//			document.getElementById('txtbill').value=ds.Tables[0].Rows[z].BILL_TO;
			
			//			drpsageo.disabled=true;
			
			document.getElementById('txtpincode').value=ds.Tables[0].Rows[z].pin_code;
			
			document.getElementById('txtstate').value=ds.Tables[0].Rows[z].State_Code;
			//string zip="246763";
			
			document.getElementById('txtfax').value=ds.Tables[0].Rows[z].Fax;
			document.getElementById('txtfax1').value=ds.Tables[0].Rows[z].fax1;
			var dateformat=document.getElementById('hiddendateformat').value;
			
			if(ds.Tables[0].Rows[z].Enroll_Date != null && ds.Tables[0].Rows[z].Enroll_Date != "")
			{
			var enrolldate=ds.Tables[0].Rows[z].Enroll_Date;
			var dd=enrolldate.getDate();
			var mm=enrolldate.getMonth() + 1;
			var yyyy=enrolldate.getFullYear();
			
			var enrolldate1=mm+'/'+dd+'/'+yyyy;
			var enrolldate1day=dd+'/'+mm+'/'+yyyy;
			var enrollyear=yyyy+'/'+mm+'/'+dd;
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtenrolldate').value=enrolldate1;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtenrolldate').value=enrollyear;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtenrolldate').value=enrolldate1day;
			}
			if(dateformat==null || dateformat=="")
			{
			document.getElementById('txtenrolldate').value=enrolldate1;
			}
			
			}
			else
			{
			
			//document.getElementById('txtenrolldate').value=ds.Tables[0].Rows[z].Enroll_Date;
			document.getElementById('txtenrolldate').value="";
			}
			
			document.getElementById('txtnoofvts').value=ds.Tables[0].Rows[z].No_of_VTS;
			
			document.getElementById('drpcity').value=ds.Tables[0].Rows[z].City_Code;
			
			
			document.getElementById('drpregion').value=ds.Tables[0].Rows[z].region;
			//document.getElementById('drpregion').value="991";
			document.getElementById('txtcrlimit').value=ds.Tables[0].Rows[z].CREDIT_LIMIT;
			
			//document.getElementById('Status').visible=true;
			
			//document.getElementById('StatusDate').styles.display="none";
			//StatusDate.style.display="visible";
			
			
			var todate=ds.Tables[0].Rows[z].to_date;
			var currdate=ds.Tables[0].Rows[z].current_Datetime;
			var tdate=new Date(todate);
			var cdate=new Date(currdate);
			
			var dd=currdate.getDate();
			var mm=currdate.getMonth() + 1;
			var yyyy=currdate.getFullYear();
			
			var currdate1=mm+'/'+dd+'/'+yyyy;
			var currda=dd+'/'+mm+'/'+yyyy;
			var curryear=yyyy+'/'+mm+'/'+dd;
			
			
			
		
			if(cdate > tdate && todate!= null )
			{
			document.getElementById('txtstatus').value="Banned";
			}
			else if(todate == null && ds.Tables[0].Rows[z].status_name==null)
			{
			document.getElementById('txtstatus').value="Active";
			}
			else
			{
			
			document.getElementById('txtstatus').value=ds.Tables[0].Rows[z].status_name;
			}
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtstatusdate').value=currdate1;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtstatusdate').value=currda;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtstatusdate').value=curryear;
			}
			if(dateformat==null || dateformat=="" || dateformat=="undefined")
			{
			document.getElementById('txtstatusdate').value=currdate1;
			}
			//document.getElementById('txtstatus').value=ds.Tables[0].Rows[0].current_Datetime;
			
			if(ds.Tables[0].Rows[z].Buss_Start_Date != null && ds.Tables[0].Rows[z].Buss_Start_Date != "")
			{
			var bussdate=ds.Tables[0].Rows[z].Buss_Start_Date;
			var dd=bussdate.getDate();
			var mm=bussdate.getMonth() + 1;
			var yyyy=bussdate.getFullYear();
			
			var bussdate1=mm+'/'+dd+'/'+yyyy;
			var bussdate1day=dd+'/'+mm+'/'+yyyy;
			var bussyear=yyyy+'/'+mm+'/'+dd;
			
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtbusineedate').value=bussdate1;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtbusineedate').value=bussyear;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtbusineedate').value=bussdate1day;
			
			
			}
			if(dateformat==null || dateformat=="")
			{
			document.getElementById('txtbusineedate').value=bussdate1;
			}
			}
			else
			{
			
			//document.getElementById('txtbusineedate').value=ds.Tables[0].Rows[z].Buss_Start_Date;
			document.getElementById('txtbusineedate').value="";
			}
			
			document.getElementById('txtmryrefno').value=ds.Tables[0].Rows[z].MRV_Ref_No;
			
			document.getElementById('txtcredit').value=ds.Tables[0].Rows[z].Credit_Days;
			
			document.getElementById('txtstacno').value=ds.Tables[0].Rows[z].ST_ACC_No;
			
			document.getElementById('drpagecate').disabled=true;
			
			document.getElementById('txtagencode').disabled=true;
			
			
			document.getElementById('txtsagencycode').disabled=true;
			
			document.getElementById('txtagenname').disabled=true;
			
			
			document.getElementById('drpagescat').disabled=true;
			
			
			document.getElementById('drpagecate').disabled=true;
			
			document.getElementById('txtagencode').disabled=true;
			
			
			document.getElementById('txtsagencycode').disabled=true;
			
			document.getElementById('txtagenname').disabled=true;
			
			
			document.getElementById('drpagescat').disabled=true;
			
			
			document.getElementById('txtstatus2').disabled=true;
			
			document.getElementById('txtalias').disabled=true;
			
			
			document.getElementById('mrvregion').disabled=true;
			
			
			
			document.getElementById('drpregion').disabled=true;
			
			
			
			document.getElementById('txtphone1').disabled=true;
			
			
			//txtagname.ReadOnly=false;
			
			document.getElementById('txtalert').disabled=true;
			
			document.getElementById('txtremarks').disabled=true;
		
			document.getElementById('txtagenname').disabled=true;
			
			
			//*********************Pankaj
			
			document.getElementById('txtadd').disabled=true;
			document.getElementById('txtaddress1').disabled=true;
			document.getElementById('txtaddress2').disabled=true;
			//^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
			
			
			
			document.getElementById('txtstreet').disabled=true;
			
			document.getElementById('txtdistrict').disabled=true;
			
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;
			
			document.getElementById('txtmail').disabled=true;
			document.getElementById('drpcurtyp').disabled=true;
			document.getElementById('txttan').disabled=true;
			document.getElementById('txtpan').disabled=true;
			
			document.getElementById('drprepres').disabled=true;
			//drpstatus.disabled=true;
			document.getElementById('txtbill').disabled=true;
			
			document.getElementById('drpagetyp').disabled=true;
			//drpsageo.disabled=true;
			document.getElementById('txtpincode').disabled=true;
			document.getElementById('txtstate').disabled=true;
			//string zip="246763";
			document.getElementById('txtfax').disabled=true;
			document.getElementById('txtfax1').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtnoofvts').disabled=true;
			//document.getElementById('txtstatusdate').disabled=false;
			
			document.getElementById('drpcity').disabled=true;
			
			
			document.getElementById('txtbusineedate').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtmryrefno').disabled=true;
			document.getElementById('txtcredit').disabled=true;
			document.getElementById('txtstacno').disabled=true;
			document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabledd);
			//document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabled);
			document.getElementById('txturl').disabled=true;
			document.getElementById('txturl').disabled=true;
			document.getElementById('txtphone2').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			//string paymode=bank;
			
			document.getElementById('btnSave').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			
			
			
			
			document.getElementById('drpregion').disabled=true;
			//drpcity.SelectedItem.Text="--Select City--";
			//drpregion.disabled=false;
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			
			document.getElementById('txtalias').disabled=true;
			document.getElementById('drpagetyp').disabled=true;
			document.getElementById('drpcity').disabled=true;
			document.getElementById('txtstatus').disabled=true;
			document.getElementById('txtstatusdate').disabled=true;
			
			document.getElementById('btnModify').disabled=false;
			document.getElementById('btnQuery').disabled=false;
			document.getElementById('btnfirst').disabled=false;
			document.getElementById('btnprevious').disabled=false;
			document.getElementById('btnnext').disabled=false;
			document.getElementById('btnlast').disabled=false;
			document.getElementById('btnCancel').disabled=false;
			document.getElementById('btnNew').disabled=true;
			document.getElementById('btnSave').disabled=true;
			document.getElementById('btnExecute').disabled=true;
			
			if(document.getElementById('hiddenpermission').value=="4")
			{
			document.getElementById('btnModify').disabled=true;
			//document.getElementById('btnQuery').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			if(document.getElementById('hiddenpermission').value=="5")
			{
			document.getElementById('btnModify').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			
			
			
			
		
		}
		else
		{
		//z=0;
		//z=z+1;
		    document.getElementById('btnnext').disabled=true;
			document.getElementById('btnlast').disabled=true;
			document.getElementById('btnfirst').disabled=false;
			document.getElementById('btnprevious').disabled=false;
			return false;
		
		}
	}
	else
	{
	document.getElementById('btnnext').disabled=true;
			document.getElementById('btnlast').disabled=true;
			document.getElementById('btnfirst').disabled=false;
			document.getElementById('btnprevious').disabled=false;
			return false;
	}
	if(z==y-1)
	{
	        document.getElementById('btnnext').disabled=true;
			document.getElementById('btnlast').disabled=true;
			document.getElementById('btnfirst').disabled=false;
			document.getElementById('btnprevious').disabled=false;
			return false;
	
	}
	
	if(document.getElementById('hiddenpermission').value=="4")
			{
			document.getElementById('btnModify').disabled=true;
			//document.getElementById('btnQuery').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			if(document.getElementById('hiddenpermission').value=="5")
			{
			document.getElementById('btnModify').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
	

}*/

/*function previousclick()

{
document.getElementById('txtstatus').style.visibility="visible";
			document.getElementById('txtstatusdate').style.visibility="visible";
			document.getElementById('Status').style.visibility="visible";
			document.getElementById('StatusDate').style.visibility="visible";


var compcode=document.getElementById('hiddencompcode').value;
var userid=document.getElementById('hiddenuserid').value;
var txtagencycode=document.getElementById('txtagencode').value;


//dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 
Agent_master.previous(compcode,userid,txtagencycode,fillprevious);
return false;


}*/

function fillexecute11()
{
    show = "0";

            document.getElementById('btnshowremark').disabled = false;
            document.getElementById('lbcommdetail').disabled=false;
            document.getElementById('lbbankdetail').disabled=false;
            document.getElementById('lbstatusdetail').disabled=false;
            document.getElementById('lbbankmast').disabled=false;
            document.getElementById('lbpaymode').disabled=false;
            document.getElementById('lbcontactdetails').disabled=false;
            document.getElementById('hiddensaurabh').value="0";
            document.getElementById('hiddenquery').value="0";
	        document.getElementById('txtstatus').style.visibility="visible";
	        document.getElementById('txtstatusdate').style.visibility="visible";
	        document.getElementById('Status').style.visibility="visible";                        
            document.getElementById('StatusDate').style.visibility="visible";
            document.getElementById('btnagencyname').disabled = true;
			
			document.getElementById('hiddenexecute').value="execute";
			var drpagecate=document.getElementById('drpagecate').value;
			glagcat=drpagecate;
			var txtagencode=document.getElementById('txtagencode').value;
			glagencycode=txtagencode;
			
			
			var txtsagencycode=document.getElementById('txtsagencycode').value;
			glsubagencycode=txtsagencycode;
			var txtagenname=document.getElementById('txtagenname').value;
			
			if(txtagenname.indexOf("'")>=0)
			    {
			   txtagenname=txtagenname.replace("'","''");
			    }
			
			glagenctname=txtagenname;
			var alias=document.getElementById('txtalias').value;
			
			if(alias.indexOf("'")>=0)
			    {
			   alias=alias.replace("'","''");
			    }
			glalias=alias
			var drpagetyp=document.getElementById('drpagetyp').value;
			glagencytype=drpagetyp;
			var drpagescat=document.getElementById('drpagescat').value;
			blagsubcat=drpagescat;
			var compcode=document.getElementById('hiddencompcode').value;
			var userid=document.getElementById('hiddenuserid').value;
			var city=document.getElementById('drpcity').value;
			glcity=city;
			var count=document.getElementById('txtcountry').value;
			glcountry=count;
			var branchcode=document.getElementById('drpbranch').value;
			glbranchcode=branchcode;
			var billfreq=document.getElementById('drpbillf').value;
			gbillfreq=billfreq;
			//dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 
Agent_master.executeagency(drpagecate,txtagencode,txtsagencycode,txtagenname,alias,drpagescat,compcode,userid,city,drpagetyp,count,branchcode,billfreq,fillexecute);
			
			
			if(document.getElementById('hiddenpermission').value=="4")
			{
			document.getElementById('btnModify').disabled=true;
			document.getElementById('btnDelete').disabled=false;
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			if(document.getElementById('hiddenpermission').value=="6")
			{
			
			document.getElementById('btnDelete').disabled=false;
			
			}
			else
			{
			
			}
			if(document.getElementById('hiddenpermission').value=="2")
			{
			
			document.getElementById('btnDelete').disabled=true;
			
			}
			else
			{
			
			}
			if(document.getElementById('hiddenpermission').value=="3")
			{
			
			document.getElementById('btnDelete').disabled=true;
			
			}
			else
			{
			
			}
			
			
			
			return false;

}

function fillexecute(response)
{
 dsforexecute=response.value;
show1="5";
if(dsforexecute==null)
{
    alert(response.error.description);
    return false;
}
if(dsforexecute.Tables[0].Rows.length ==0)
{
alert("Your criteria does not exist");
cancelclick();
return false;
}
//a.Comp_Code,a.Agency_Type_Code,a.Agency_Cat_Code,a.Agency_SubCat_Code,a.Agency_Code,a.Agency_Name,a.Agency_Alias,a.Agency_HO,a.Add1,a.Street,a.City_Code,a.Zip,a.Dist_Code,a.State_Code,a.Country_Code,a.Phone,a.Fax,a.EmailID,a.URL,a.Buss_Start_Date,a.Enroll_Date,a.MRV_Ref_No,a.No_of_VTS,a.Credit_Days ,a.PAN_No,a.TAN_No,a.ST_ACC_No,a.Pay_Mode_Code,status_detail.status_name,a.Status_Reason,a.Remarks,a.UserID,getdate(),a.userid,a.SUB_Agency_HO,a.SUB_Agency_Code,a.BILL_TO,a.ALERT,a.CREDIT_LIMIT,a.CODE,a.representative_code,a.pin_code,a.region ,status_detail.to_date from Agency_mast a,status_detail 
             //----------------------------------------------------//
        
          var bktyplen=document.getElementById('bktype').options.length;
         for(var t2=0;t2<bktyplen;t2++)
         {
             document.getElementById('bktype').options[t2].selected=false;
         }
        if(dsforexecute.Tables[0].Rows[0].BOOKING_TYPE !=null && dsforexecute.Tables[0].Rows[0].BOOKING_TYPE !="")
        {
            var bktype=dsforexecute.Tables[0].Rows[0].BOOKING_TYPE;            
           var  len1=bktype.split(",");
            for(var a1=0; a1<len1.length; a1++)
            {
                for(var j=0; j<bktyplen; j++)
                {
                    if(document.getElementById('bktype').options[j].value==len1[a1])
                    {
                       document.getElementById('bktype').options[j].selected = true;
                    }
                }
            }

        }
        
        
        var exelen=document.getElementById('Libexecutive').options.length;
			for(var t3=0;t3<exelen;t3++)
             {
                 document.getElementById('Libexecutive').options[t3].selected=false;
             }
		
        
        if(dsforexecute.Tables[0].Rows[0].EXECUTIVE  !=null && dsforexecute.Tables[0].Rows[0].EXECUTIVE  !="")
        {
            var exec=dsforexecute.Tables[0].Rows[0].EXECUTIVE ;            
           var  len2=exec.split(",");
            for(var a2=0; a2<len2.length; a2++)
            {
                for(var j=0; j<exelen; j++)
                {
                    if(document.getElementById('Libexecutive').options[j].value==len2[a2])
                    {
                       document.getElementById('Libexecutive').options[j].selected = true;
                    }
                }
            }

        }

       /////////////////////
       var retiner = document.getElementById('liretainer').options.length;
       for (var t4 = 0; t4 < retiner; t4++) {
           document.getElementById('liretainer').options[t4].selected = false;
       }


       if (dsforexecute.Tables[0].Rows[0].RETAINER != null && dsforexecute.Tables[0].Rows[0].RETAINER != "") {
           var ret = dsforexecute.Tables[0].Rows[0].RETAINER;
           var len21 = ret.split(",");
           for (var a21 = 0; a21 < len21.length; a21++) {
               for (var j1 = 0; j1 < retiner; j1++) {
                   if (document.getElementById('liretainer').options[j1].value == len21[a21]) {
                       document.getElementById('liretainer').options[j1].selected = true;
                   }
               }
           }

       }
        
        //----------------------------------------------------------//
            if(dsforexecute.Tables[0].Rows[0].Branch_code != null)
			{
             document.getElementById('drpbranch').value=dsforexecute.Tables[0].Rows[0].Branch_code;
			}
			else
			{
			document.getElementById('drpbranch').value="0";
			}




 if(dsforexecute.Tables[0].Rows[0].CREDITDAYS != null)
			{
             document.getElementById('txtcreditlimitdays').value=dsforexecute.Tables[0].Rows[0].CREDITDAYS;
			}
			else
			{
			document.getElementById('txtcreditlimitdays').value="";
			}
			
			
			
			
			if(dsforexecute.Tables[0].Rows[0].CREDITLIMITDAYS != null && dsforexecute.Tables[0].Rows[0].CREDITLIMITDAYS != "")
			{
			var enrolldate=dsforexecute.Tables[0].Rows[0].CREDITLIMITDAYS;
			var dd=enrolldate.getDate();
			var mm=enrolldate.getMonth() + 1;
			var yyyy=enrolldate.getFullYear();
			
			var enrolldate1=mm+'/'+dd+'/'+yyyy;
			var enrolldateday=dd+'/'+mm+'/'+yyyy;
			var enrollyear=yyyy+'/'+mm+'/'+dd;
			
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtcrlimitfromdate').value=enrolldate1;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtcrlimitfromdate').value=enrollyear;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtcrlimitfromdate').value=enrolldateday;
			}
			if(dateformat==null || dateformat=="")
			{
			document.getElementById('txtcrlimitfromdate').value=enrolldateday;
			}
			
			
			}
			else
			{
			
			document.getElementById('txtcrlimitfromdate').value="";
			}
			
			
			
			
			
			
			
			
			 if(dsforexecute.Tables[0].Rows[0].RECOVERYLIMIT != null)
			{
             document.getElementById('txtrecoverylimit').value=dsforexecute.Tables[0].Rows[0].RECOVERYLIMIT;
			}
			else
			{
			document.getElementById('txtrecoverylimit').value="";
			}
			
			
			
			


			if (dsforexecute.Tables[0].Rows[0].BILL_EMAIL != null) {
			    document.getElementById('drpemail').value = dsforexecute.Tables[0].Rows[0].BILL_EMAIL;
			}
			else {
			    document.getElementById('drpemail').value = "";
			}

			if (dsforexecute.Tables[0].Rows[0].AGENCY_DESIGNATION != null) {
			    document.getElementById('txtdesg').value = dsforexecute.Tables[0].Rows[0].AGENCY_DESIGNATION;
			}
			else {
			    document.getElementById('txtdesg').value = "";
			}



            if(dsforexecute.Tables[0].Rows[0].pin_code != "" && dsforexecute.Tables[0].Rows[0].pin_code != null)
			{
             document.getElementById('txtpincode').value=dsforexecute.Tables[0].Rows[0].pin_code;
			}
			else
			{
			document.getElementById('txtpincode').value="";
			}
            
            if(dsforexecute.Tables[0].Rows[0].BILL_FREQUENCY != "" && dsforexecute.Tables[0].Rows[0].BILL_FREQUENCY != null)
			{
             document.getElementById('drpbillf').value=dsforexecute.Tables[0].Rows[0].BILL_FREQUENCY;
			}
			else
			{
			document.getElementById('drpbillf').value="0";
			}
			if(dsforexecute.Tables[0].Rows[0].OLD_AGENCY != "" && dsforexecute.Tables[0].Rows[0].OLD_AGENCY != null)
			{
             document.getElementById('txtoldagen').value=dsforexecute.Tables[0].Rows[0].OLD_AGENCY;
			}
			else
			{
			document.getElementById('txtoldagen').value="";
			}
			//dsforexecute.Tables[0].Rows[0].state_name
			
			if(dsforexecute.Tables[0].Rows[0].CODE!=null)
			{
			document.getElementById('txtphone1').value=dsforexecute.Tables[0].Rows[0].CODE;
			}
			else
			{
			document.getElementById('txtphone1').value="";
			}
			
			if(dsforexecute.Tables[0].Rows[0].SUB_SUB_AG_CODE!=null)
			{
			document.getElementById('txtsubsubagcd').value=dsforexecute.Tables[0].Rows[0].SUB_SUB_AG_CODE;
			}
			else
			{
			document.getElementById('txtsubsubagcd').value="";
			}
			
			document.getElementById('drpparent').value=dsforexecute.Tables[0].Rows[0].Type;
			if(dsforexecute.Tables[0].Rows[0].CREDIT_TYPE != "" && dsforexecute.Tables[0].Rows[0].CREDIT_TYPE != null)
			{
			document.getElementById('drpcurtyp').value=dsforexecute.Tables[0].Rows[0].CREDIT_TYPE;
			}
			else
			{
			document.getElementById('drpcurtyp').value="0"
			}
			
			
	        if(dsforexecute.Tables[0].Rows[0].URL != "" && dsforexecute.Tables[0].Rows[0].URL != null)
			{
			document.getElementById('txturl').value=dsforexecute.Tables[0].Rows[0].URL;
			}
			else
			{
			document.getElementById('txturl').value="";
			}
			
			if(dsforexecute.Tables[0].Rows[0].CREDIT_TYPE != "" && dsforexecute.Tables[0].Rows[0].CREDIT_TYPE != null)
			{
			document.getElementById('drpcurtyp').value=dsforexecute.Tables[0].Rows[0].CREDIT_TYPE;
			}
			else
			{
			document.getElementById('drpcurtyp').value="0"
			}
			
			
			
			if(dsforexecute.Tables[0].Rows[0].Zip != "" && dsforexecute.Tables[0].Rows[0].Zip != null)
			{
	          document.getElementById('mrvregion').value=dsforexecute.Tables[0].Rows[0].Zip;
	        }
	        else
	        {
	        document.getElementById('mrvregion').value="";
	        }
				
			document.getElementById('txtagencode').value=dsforexecute.Tables[0].Rows[0].Agency_Code;
			
			document.getElementById('drprate').value=dsforexecute.Tables[0].Rows[0].Rate_Group;
		
			
			document.getElementById('getagsubcode').value=dsforexecute.Tables[0].Rows[0].SUB_Agency_Code;
			
			document.getElementById('txtagenname').value=dsforexecute.Tables[0].Rows[0].Agency_Name;
			document.getElementById('hiddenagencyname').value=document.getElementById('txtagenname').value;
			
		    document.getElementById('txtsagencycode').value=dsforexecute.Tables[0].Rows[0].SUB_Agency_Code;
			
			//document.getElementById('drpzone').value=dsforexecute.Tables[0].Rows[0].zone_code;

		    document.getElementById('drpcalc').value = dsforexecute.Tables[0].Rows[0].INTEREST_CAL_FLAG;

		    document.getElementById('drpbilflag').value = dsforexecute.Tables[0].Rows[0].BILL_PRINTFLAG;
		
			document.getElementById('drpagetyp').value=dsforexecute.Tables[0].Rows[0].Agency_Type_Code;
			
			if(dsforexecute.Tables[0].Rows[0].Agency_HO!=null)
			{
			document.getElementById('txtagencyho').value=dsforexecute.Tables[0].Rows[0].Agency_HO;
			}
			else
			{
			document.getElementById('txtagencyho').value="";
			}
			
			//document.getElementById('drpagetyp').value=dsforexecute.Tables[0].Rows[0].Agency_Type_Code;
		
			addsubcategory(dsforexecute.Tables[0].Rows[0].Agency_Cat_Code);
		
            //catvar=dsforexecute.Tables[0].Rows[0].Agency_SubCat_Code;
             catvar=dsforexecute.Tables[0].Rows[0].Agency_Cat_Code;
             addcategory(dsforexecute.Tables[0].Rows[0].Agency_Cat_Code);
			document.getElementById('drpagecate').value=dsforexecute.Tables[0].Rows[0].Agency_Cat_Code;
		document.getElementById('drpagetyp').value=dsforexecute.Tables[0].Rows[0].Agency_Type_Code;
           
			if(dsforexecute.Tables[0].Rows[0].SUB_Agency_HO != "" && dsforexecute.Tables[0].Rows[0].SUB_Agency_HO!=null )
			{
			document.getElementById('txtsugagencyho').value=dsforexecute.Tables[0].Rows[0].SUB_Agency_HO;
			}
			else
			{
			document.getElementById('txtsugagencyho').value="";
			}
			
			document.getElementById('drprepres').value=dsforexecute.Tables[0].Rows[0].representative_code;	
			

                if(dsforexecute.Tables[0].Rows[0].qbc_userid != "" && dsforexecute.Tables[0].Rows[0].qbc_userid != null)
				{
		        	document.getElementById('drpuserid').value=dsforexecute.Tables[0].Rows[0].qbc_userid;
			    }
			    else
			    {
			        document.getElementById('drpuserid').value="0";
			    }
			
			
			if(dsforexecute.Tables[0].Rows[0].Status_Reason!=null)
			{
			document.getElementById('txtstatus2').value=dsforexecute.Tables[0].Rows[0].Status_Reason;
			}
			else
			{
			document.getElementById('txtstatus2').value="";
			}
			
			document.getElementById('txtalias').value=dsforexecute.Tables[0].Rows[0].Agency_Alias;
			//txtagname.Text="";
			if(dsforexecute.Tables[0].Rows[0].ALERT!=null)
			{
			document.getElementById('txtalert').value=dsforexecute.Tables[0].Rows[0].ALERT;
			}
			else
			{
			document.getElementById('txtalert').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].Remarks!=null)
			{
			document.getElementById('txtremarks').value=dsforexecute.Tables[0].Rows[0].Remarks;
			}
			else
			{
			document.getElementById('txtremarks').value="";
			}



			if (dsforexecute.Tables[0].Rows[0].KYC_ATTACH != null) {
			    document.getElementById('hidkyc').value = dsforexecute.Tables[0].Rows[0].KYC_ATTACH;

			    document.getElementById('attachment1').src = "Images/indexred.jpg";
			}
			else {
			    document.getElementById('hidkyc').value = "";

			    document.getElementById('attachment1').src = "Images/index.jpeg"
			}
			
			//*************************Pankaj
			if(dsforexecute.Tables[0].Rows[0].Add1!=null)
			{
			document.getElementById('txtadd').value=dsforexecute.Tables[0].Rows[0].Add1;
			}
			else
			{
			document.getElementById('txtadd').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].Add2!=null)
			{
			document.getElementById('txtaddress1').value=dsforexecute.Tables[0].Rows[0].Add2;
			}
			else
			{
				document.getElementById('txtaddress1').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].Add3!=null)
			{
			document.getElementById('txtaddress2').value=dsforexecute.Tables[0].Rows[0].Add3;
			}
			else
			{
			document.getElementById('txtaddress2').value="";
			}
			//^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
			
			if(dsforexecute.Tables[0].Rows[0].Street!=null)
			{
			document.getElementById('txtstreet').value=dsforexecute.Tables[0].Rows[0].Street;
			}
			else
			{
			document.getElementById('txtstreet').value="";
			}
			//----------------------------------------------bind city------------------------------//
			document.getElementById('txtcountry').value=dsforexecute.Tables[0].Rows[0].Country_Code;
			cityvar=dsforexecute.Tables[0].Rows[0].City_Code;
			regionvar=dsforexecute.Tables[0].Rows[0].region;
			zonevar=dsforexecute.Tables[0].Rows[0].zone_code;
			talukavar=dsforexecute.Tables[0].Rows[0].TALUKA;
			addcount(dsforexecute.Tables[0].Rows[0].Country_Code);
			//document.getElementById('drpcity').value=dsforexecute.Tables[0].Rows[0].City_Code;
			
			//addregcity();
			if(dsforexecute.Tables[0].Rows[0].DISTRICT!=null && dsforexecute.Tables[0].Rows[0].DISTRICT != "")
			{
			document.getElementById('hiddendistcode').value=dsforexecute.Tables[0].Rows[0].DISTRICT;
			}
			else
			{
			document.getElementById('hiddendistcode').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].STATE!=null && dsforexecute.Tables[0].Rows[0].STATE != "")
			{
			document.getElementById('hiddenstatecode').value=dsforexecute.Tables[0].Rows[0].STATE;
			}
			else
			{
			document.getElementById('hiddenstatecode').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].Dist_Code!=null)
			{
			document.getElementById('txtdistrict').value=dsforexecute.Tables[0].Rows[0].Dist_Code;
			}
			else
			{
			document.getElementById('txtdistrict').value="";			
			}
			if (dsforexecute.Tables[0].Rows[0].GST_REGISTRATION != null) {
			    document.getElementById('drpgstus').value = dsforexecute.Tables[0].Rows[0].GST_REGISTRATION;
			}
			else {
			    document.getElementById('drpgstus').value = "";
			}
			if (dsforexecute.Tables[0].Rows[0].GST_REGISTRATION_DATE != null) {
			    document.getElementById('txtgstdt').value = dsforexecute.Tables[0].Rows[0].GST_REGISTRATION_DATE;
			}
			else {
			    document.getElementById('txtgstdt').value = "";
			}
			if (dsforexecute.Tables[0].Rows[0].GSTIN != null) {
			    document.getElementById('txtgstin').value = dsforexecute.Tables[0].Rows[0].GSTIN;
			}
			else {
			    document.getElementById('txtgstin').value = "";
			}

			if (dsforexecute.Tables[0].Rows[0].GST_STATUS != null) {
			    document.getElementById('drpgstatus').value = dsforexecute.Tables[0].Rows[0].GST_STATUS;
			}
			else {
			    document.getElementById('drpgstatus').value = "";
			}

			if (dsforexecute.Tables[0].Rows[0].GST_CLIENT_TYPE_CD != null) {
			    document.getElementById('txtgstclty').value = dsforexecute.Tables[0].Rows[0].GST_CLIENT_TYPE_CD;
			    document.getElementById('hdngstclty').value = dsforexecute.Tables[0].Rows[0].GST_CLIENT_TYPE_CODE;			 
			}
			else {
			    document.getElementById('txtgstclty').value = "";
			}

			if (dsforexecute.Tables[0].Rows[0].GST_ARN_NO != null) {
			    document.getElementById('txtarno').value = dsforexecute.Tables[0].Rows[0].GST_ARN_NO;
			}
			else {
			    document.getElementById('txtarno').value = "";
			}

			if (dsforexecute.Tables[0].Rows[0].GST_PROVISINAL_ID != null) {
			    document.getElementById('txtgstprovid').value = dsforexecute.Tables[0].Rows[0].GST_PROVISINAL_ID;
			}
			else {
			    document.getElementById('txtgstprovid').value = "";
			}

//			}
//			if(dsforexecute.Tables[0].Rows[0].STATE!=null)
//			{
//			document.getElementById('txtstate').value=dsforexecute.Tables[0].Rows[0].STATE;
//			}
//			else
//			{
			if(dsforexecute.Tables[0].Rows[0].State_Code!=null)
		    {
			document.getElementById('txtstate').value=dsforexecute.Tables[0].Rows[0].State_Code;
			}
			else
			{
			document.getElementById('txtstate').value="";
			}
//			}
			
			
//////			document.getElementById('drpregion').value=dsforexecute.Tables[0].Rows[0].region;
//////			document.getElementById('drpzone').value=dsforexecute.Tables[0].Rows[0].zone_code;
			
			//--------------------------------------------------------------------------------------------//  

			if(dsforexecute.Tables[0].Rows[0].Phone!=null)
			{
			document.getElementById('txtphone2').value=dsforexecute.Tables[0].Rows[0].Phone;
            }
            else
            {
            document.getElementById('txtphone2').value="";
            }
            
            if(dsforexecute.Tables[0].Rows[0].DEPOCODE!=null)
			{
			    document.getElementById('txtdepocode').value=dsforexecute.Tables[0].Rows[0].DEPOCODE;
            }
            else
            {
                document.getElementById('txtdepocode').value="";
            }

            if(dsforexecute.Tables[0].Rows[0].VAT ==0 || dsforexecute.Tables[0].Rows[0].VAT =="0" || dsforexecute.Tables[0].Rows[0].VAT =="" || dsforexecute.Tables[0].Rows[0].VAT ==null)
			{
			 document.getElementById("chkvat").checked=false;
			}
			else
			{
			document.getElementById("chkvat").checked=true;

}

if (dsforexecute.Tables[0].Rows[0].BLANKCHEQUE == 0 || dsforexecute.Tables[0].Rows[0].BLANKCHEQUE == "0" || dsforexecute.Tables[0].Rows[0].BLANKCHEQUE == "" || dsforexecute.Tables[0].Rows[0].BLANKCHEQUE == null) {
    document.getElementById("chkcheque").checked = false;
}
else {
    document.getElementById("chkcheque").checked = true;

}
if (dsforexecute.Tables[0].Rows[0].SECURITYBOND == 0 || dsforexecute.Tables[0].Rows[0].SECURITYBOND == "0" || dsforexecute.Tables[0].Rows[0].SECURITYBOND == "" || dsforexecute.Tables[0].Rows[0].SECURITYBOND == null) {
    document.getElementById("chkbondrecvd").checked = false;
}
else {
    document.getElementById("chkbondrecvd").checked = true;

}
if (dsforexecute.Tables[0].Rows[0].KYCAPP == 0 || dsforexecute.Tables[0].Rows[0].KYCAPP == "0" || dsforexecute.Tables[0].Rows[0].KYCAPP == "" || dsforexecute.Tables[0].Rows[0].KYCAPP == null) {
    document.getElementById("chkyc").checked = false;
}
else {
    document.getElementById("chkyc").checked = true;

}
if (dsforexecute.Tables[0].Rows[0].ADDRESSPROOF == 0 || dsforexecute.Tables[0].Rows[0].ADDRESSPROOF == "0" || dsforexecute.Tables[0].Rows[0].ADDRESSPROOF == "" || dsforexecute.Tables[0].Rows[0].ADDRESSPROOF == null) {
    document.getElementById("chkadproof").checked = false;
}
else {
    document.getElementById("chkadproof").checked = true;

}

            if (dsforexecute.Tables[0].Rows[0].RATE_REVISE == 0 || dsforexecute.Tables[0].Rows[0].RATE_REVISE == "0" || dsforexecute.Tables[0].Rows[0].RATE_REVISE == "" || dsforexecute.Tables[0].Rows[0].RATE_REVISE == null) {
                document.getElementById("chkraterevise").checked = false;
            }
            else {
                document.getElementById("chkraterevise").checked = true;
            }
			

			var compcode=document.getElementById('hiddencompcode').value;
            var userid=document.getElementById('hiddenuserid').value;
            
            Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,call_billto);
             Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,billtodrpcall);
             
          //  document.getElementById('txtbill').value=ds.Tables[0].Rows[0].BILL_TO;
         //   document.getElementById('txtbill').value=ds.Tables[0].Rows[0].BILL_TO;
            biltovar=dsforexecute.Tables[0].Rows[0].BILL_TO;
            varbiltocal=dsforexecute.Tables[0].Rows[0].acagency;

			if(dsforexecute.Tables[0].Rows[0].EmailID!=null)
			{
			document.getElementById('txtmail').value=dsforexecute.Tables[0].Rows[0].EmailID;
			}
			else
			{
			document.getElementById('txtmail').value="";


}
if (dsforexecute.Tables[0].Rows[0].EMAILID_CC != null) {
    document.getElementById('txtmailcc').value = dsforexecute.Tables[0].Rows[0].EMAILID_CC;
}
else {
    document.getElementById('txtmailcc').value = "";
}


if (dsforexecute.Tables[0].Rows[0].EMAILID_CC != null) {
    document.getElementById('txtmailcc').value = dsforexecute.Tables[0].Rows[0].EMAILID_CC;
}
else {
    document.getElementById('txtmailcc').value = "";
}
			
			
			
			
			
			if(dsforexecute.Tables[0].Rows[0].TAN_No!=null)
			{
			document.getElementById('txttan').value=dsforexecute.Tables[0].Rows[0].TAN_No;
			}
			else
			{
			document.getElementById('txttan').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].PAN_No!=null)
			{
				document.getElementById('txtpan').value=dsforexecute.Tables[0].Rows[0].PAN_No;
				}
				else
				{
				document.getElementById('txtpan').value="";
				}
			//			drprepres.disabled=true;
			//			drpstatus.disabled=true;
			
			//document.getElementById('txtbill').value=ds.Tables[0].Rows[0].BILL_TO;
			biltovar=dsforexecute.Tables[0].Rows[0].BILL_TO;
			varbiltocal=dsforexecute.Tables[0].Rows[0].acagency;
			
			//			drpsageo.disabled=true;
			
			//document.getElementById('txtpincode').value=ds.Tables[0].Rows[0].pin_code;
			
			//string zip="246763";
			if(dsforexecute.Tables[0].Rows[0].Fax!=null)
			{
			document.getElementById('txtfax').value=dsforexecute.Tables[0].Rows[0].Fax;
			}
			else
			{
			document.getElementById('txtfax').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].fax1!=null)
			{
			document.getElementById('txtfax1').value=dsforexecute.Tables[0].Rows[0].fax1;
			}
			else
			{
			document.getElementById('txtfax1').value="";
			}
			var dateformat=document.getElementById('hiddendateformat').value;
			
			if(dsforexecute.Tables[0].Rows[0].Enroll_Date != null && dsforexecute.Tables[0].Rows[0].Enroll_Date != "")
			{
			var enrolldate=dsforexecute.Tables[0].Rows[0].Enroll_Date;
			var dd=enrolldate.getDate();
			var mm=enrolldate.getMonth() + 1;
			var yyyy=enrolldate.getFullYear();
			
			var enrolldate1=mm+'/'+dd+'/'+yyyy;
			var enrolldateday=dd+'/'+mm+'/'+yyyy;
			var enrollyear=yyyy+'/'+mm+'/'+dd;
			
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtenrolldate').value=enrolldate1;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtenrolldate').value=enrollyear;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtenrolldate').value=enrolldateday;
			}
			if(dateformat==null || dateformat=="")
			{
			document.getElementById('txtenrolldate').value=enrolldate1;
			}
			
			
			}
			else
			{
			//document.getElementById('txtenrolldate').value=ds.Tables[0].Rows[0].Enroll_Date;
			document.getElementById('txtenrolldate').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].No_of_VTS!=null)
			{
			document.getElementById('txtnoofvts').value=dsforexecute.Tables[0].Rows[0].No_of_VTS;
			}
			else
			{
			document.getElementById('txtnoofvts').value="";
			}
			var talukabind = dsforexecute.Tables[0].Rows[0].Dist_Code;
			if(talukabind!=null)
			    bindtalu(talukabind);
			//document.getElementById('drpcity').value=ds.Tables[0].Rows[0].City_Code;
			
			
			

           
//           if(dsforexecute.Tables[0].Rows[0].TALUKA!=null)
//			{
//			document.getElementById('drptaluka').value=dsforexecute.Tables[0].Rows[0].TALUKA;
//			}
//			else
//			{
//			document.getElementById('drptaluka').value="";
//			}
            
			
	       
			//bindtalu(talukabind);
			var todate=dsforexecute.Tables[0].Rows[0].to_date;
			var from_date=dsforexecute.Tables[0].Rows[0].FROM_DATE;
			
			var currdate=dsforexecute.Tables[0].Rows[0].current_Datetime;
			var tdate=new Date(todate);
			var cdate=new Date(currdate);
			
			var dd=currdate.getDate();
			var mm=currdate.getMonth() + 1;
			var yyyy=currdate.getFullYear();
			
			var currdate1=mm+'/'+dd+'/'+yyyy;
			var currda=dd+'/'+mm+'/'+yyyy;
			var curryear=yyyy+'/'+mm+'/'+dd;
			
	
		

    /* previous code for status changed by saurabh Agarwal---------------------------------------		
		
			if(cdate > tdate && todate!= null )
			{
			document.getElementById('txtstatus').value="Banned";
			}
			else if(todate == null && dsforexecute.Tables[0].Rows[0].status_name==null)
			{
			document.getElementById('txtstatus').value="Active";
			}
			else
			{
			
			document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[0].status_name;
			}
	*///---------------------------------------------------------------------------------------------
	
	
		//------------------------saurabh code for status---------------------
		
		var cur=new Date();
		
		if((dsforexecute.Tables[0].Rows[0].status_name!=null)||(dsforexecute.Tables[0].Rows[0].status_name!=""))
		{
		    if( cur<=todate)
		    {
			    //document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[0].status_name;
			    if(dsforexecute.Tables[0].Rows[0].status_name=="IN0")
			    document.getElementById('txtstatus').value="INACTIVE";
			    else 
			    document.getElementById('txtstatus').value="Active";
			}
			else
			{
			    document.getElementById('txtstatus').value="Active";
			}
			
		}
		else
		{
		    document.getElementById('txtstatus').value="Active";
		}
	
//		if(dsforexecute.Tables[0].Rows[0].FROM_DATE=="" || dsforexecute.Tables[0].Rows[0].FROM_DATE==null || dsforexecute.Tables[0].Rows[0].to_date=="" || dsforexecute.Tables[0].Rows[0].to_date==null)
//		{
//		    document.getElementById('txtstatus').value="Active";
//		}
		//-----------------------------------------------------------------------
	
	
		
		if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtstatusdate').value=currdate1;
			}
			if(dateformat=="dd/mm/yyyy")
			{document.getElementById('txtstatusdate').value=currda;
			}
			if(dateformat=="yyyy/mm/dd")
			{document.getElementById('txtstatusdate').value=curryear;
			}
			if(dateformat== null || dateformat=="" || dateformat=="undefined")
			{document.getElementById('txtstatusdate').value=currdate1;
			}
			
			//document.getElementById('txtstatus').value=ds.Tables[0].Rows[0].current_Datetime;
			
			if(dsforexecute.Tables[0].Rows[0].Buss_Start_Date != null && dsforexecute.Tables[0].Rows[0].Buss_Start_Date != "")
			{
			var bussdate=dsforexecute.Tables[0].Rows[0].Buss_Start_Date;
			var dd=bussdate.getDate();
			var mm=bussdate.getMonth() + 1;
			var yyyy=bussdate.getFullYear();
			
			var bussdate1=mm+'/'+dd+'/'+yyyy;
			var bussdateday=dd+'/'+mm+'/'+yyyy;
			var bussyear=yyyy+'/'+mm+'/'+dd;
			
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtbusineedate').value=bussdate1;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtbusineedate').value=bussyear;
			
			}
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtbusineedate').value=bussdateday;
			}
			if(dateformat==null || dateformat=="")
			{
			document.getElementById('txtbusineedate').value=bussdate1;
			}
			
			
			
			
			}
			else
			{
			
			//document.getElementById('txtbusineedate').value=ds.Tables[0].Rows[0].Buss_Start_Date;
			document.getElementById('txtbusineedate').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].MRV_Ref_No!=null)
			{
			document.getElementById('txtmryrefno').value=dsforexecute.Tables[0].Rows[0].MRV_Ref_No;
			}
			else
			{
			document.getElementById('txtmryrefno').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].Credit_Days!=null)
			{
			document.getElementById('txtcredit').value=dsforexecute.Tables[0].Rows[0].Credit_Days;
			}
			else
			{
			document.getElementById('txtcredit').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].ST_ACC_No!=null)
			{
			document.getElementById('txtstacno').value=dsforexecute.Tables[0].Rows[0].ST_ACC_No;
			}
			else
			{
			document.getElementById('txtstacno').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].CREDIT_LIMIT!=null)
			{
			document.getElementById('txtcrlimit').value=dsforexecute.Tables[0].Rows[0].CREDIT_LIMIT;
			}
			else
			{
			document.getElementById('txtcrlimit').value="";

}

if (dsforexecute.Tables[0].Rows[0].EDTN_WISE_BILL_REQ != null) {
    document.getElementById('drpEdition_wise_Billing').value = dsforexecute.Tables[0].Rows[0].EDTN_WISE_BILL_REQ;
            }
        else {
            document.getElementById('drpEdition_wise_Billing').value = "N";
                }
			document.getElementById('drpagecate').disabled=true;

			document.getElementById('txtagencode').disabled = true;
			document.getElementById('drpemail').disabled = true;
			document.getElementById('txtdesg').disabled = true;
			
			
			document.getElementById('txtbusineedate').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			
			document.getElementById('txtsagencycode').disabled=true;
			
			document.getElementById('txtagenname').disabled=true;
			
			
			document.getElementById('drpagescat').disabled=true;
			
			document.getElementById('drpagecate').disabled=true;
			
			document.getElementById('txtagencode').disabled=true;
			
			
			document.getElementById('txtsagencycode').disabled=true;
			
			document.getElementById('txtagenname').disabled=true;
			
			document.getElementById('drpparent').disabled=true;
			
			
			document.getElementById('drpagescat').disabled=true;
			
			
			document.getElementById('txtstatus2').disabled=true;
			
			document.getElementById('txtalias').disabled=true;
			
			
			document.getElementById('mrvregion').disabled=true;
			
			
			
			document.getElementById('drpregion').disabled=true;
			
			
			
			document.getElementById('txtphone1').disabled=true;
			
			
			//txtagname.ReadOnly=false;
			
			document.getElementById('txtalert').disabled=true;

			document.getElementById('txtremarks').disabled = true;


			document.getElementById('attachment1').disabled = true;
		
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('drpbillf').disabled=true;
			
			//**************Pankaj
			document.getElementById('bktype').disabled=true;
			document.getElementById('txtadd').disabled=true;
			document.getElementById('txtaddress1').disabled=true;
			document.getElementById('txtaddress2').disabled=true;
			//^^^^&^&^^&^^&^&^&^&^&^&^&^&^&^&^&^&^&^&^&^&^&^
			
			
			
			
			document.getElementById('txtstreet').disabled=true;
			document.getElementById('drpbranch').disabled=true;
			document.getElementById('txtdistrict').disabled=true;
			
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;

			document.getElementById('txtmail').disabled = true;

			document.getElementById('txtmailcc').disabled = true;
			document.getElementById('drpcurtyp').disabled=true;
			document.getElementById('txttan').disabled=true;
			document.getElementById('txtpan').disabled=true;
			
			document.getElementById('drprepres').disabled=true;
			//drpstatus.disabled=true;
			document.getElementById('txtbill').disabled=true;
			
			document.getElementById('drpagetyp').disabled=true;
			//drpsageo.disabled=true;
			document.getElementById('txtpincode').disabled=true;
			document.getElementById('txtstate').disabled=true;
			//string zip="246763";
			document.getElementById('txtfax').disabled=true;
			document.getElementById('txtfax1').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtnoofvts').disabled=true;
			document.getElementById('biltodrp').disabled=false;
			
			document.getElementById('drpcity').disabled=true;
			
			
			document.getElementById('txtbusineedate').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtmryrefno').disabled=true;
			document.getElementById('txtcredit').disabled=true;
			document.getElementById('txtstacno').disabled=true;
			document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabledd);
			//document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabled);
			document.getElementById('txturl').disabled=true;
			document.getElementById('txturl').disabled=true;
			document.getElementById('txtphone2').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			//string paymode=bank;
			
			document.getElementById('btnSave').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			
			
			
			
			document.getElementById('drpregion').disabled=true;
			//drpcity.SelectedItem.Text="--Select City--";
			//drpregion.disabled=false;
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			document.getElementById('drptaluka').disabled=true;
			
			document.getElementById('txtalias').disabled=true;
			document.getElementById('drpagetyp').disabled=true;
			document.getElementById('drpcity').disabled=true;
			document.getElementById('txtstatus').disabled=true;
			document.getElementById('txtstatusdate').disabled=true;
			document.getElementById('chkvat').disabled = true;
			document.getElementById('chkcheque').disabled = true;
			document.getElementById('chkbondrecvd').disabled = true;
			document.getElementById('chkyc').disabled = true;
			document.getElementById('chkadproof').disabled = true;
			document.getElementById('chkraterevise').disabled = true;
			
			document.getElementById('btnModify').disabled=false;
			document.getElementById('btnQuery').disabled=false;
			document.getElementById('btnCancel').disabled=false;
			document.getElementById('btnNew').disabled=true;
			document.getElementById('btnSave').disabled=true;
			document.getElementById('btnExecute').disabled=true;
			document.getElementById('btnDelete').disabled=false;
			if(document.getElementById('hiddenpermission').value=="4")
			{
			document.getElementById('btnModify').disabled=true;
			document.getElementById('btnDelete').disabled=false;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			if(document.getElementById('hiddenpermission').value=="5")
			{
			document.getElementById('btnModify').disabled=true;
			document.getElementById('btnDelete').disabled=false;
			
			}
			else
			{
			
			}
			if(document.getElementById('hiddenpermission').value=="6")
			{
			
			document.getElementById('btnDelete').disabled=false;
			
			}
			else
			{
			
			}
			
			if(document.getElementById('hiddenpermission').value=="2")
			{
			
			document.getElementById('btnDelete').disabled=true;
			
			}
			else
			{
			
			}
			if(document.getElementById('hiddenpermission').value=="3")
			{
			
			document.getElementById('btnDelete').disabled=true;
			
			}
			else
			{
			
			}
			if(document.getElementById('hiddenpermission').value=="1")
			{
				document.getElementById('btnModify').disabled=true;
			    document.getElementById('btnDelete').disabled=true;
			}
			
			if(dsforexecute.Tables[0].Rows.length==1)
			{
			document.getElementById('btnfirst').disabled=true;
			document.getElementById('btnprevious').disabled=true;
			document.getElementById('btnnext').disabled=true;
			document.getElementById('btnlast').disabled=true;
			
			}
			else
			{
			document.getElementById('btnfirst').disabled=true;
			document.getElementById('btnprevious').disabled=true;
			document.getElementById('btnnext').disabled=false;
			document.getElementById('btnlast').disabled=false;
			
			}
			document.getElementById('biltodrp').disabled=true;
			setButtonImages();
			return false;

}

/*
function firstclick()
{
z=0;
            document.getElementById('txtstatus').style.visibility="visible";
			document.getElementById('txtstatusdate').style.visibility="visible";
			document.getElementById('Status').style.visibility="visible";
			document.getElementById('StatusDate').style.visibility="visible";

			
        var compcode=document.getElementById('hiddencompcode').value;
        var userid=document.getElementById('hiddenuserid').value;
        var txtagencycode=document.getElementById('txtagencode').value;


//dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 
Agent_master.first(compcode,userid,txtagencycode,fillfirst);

if(document.getElementById('hiddenpermission').value=="4")
			{
			document.getElementById('btnModify').disabled=true;
			//document.getElementById('btnQuery').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}

return false;

}*/

function firstclick()
{

//dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 

            Agent_master.blankSession();
            z=0;
            show1="5";
///Dist_code
             //----------------------------------------------------//
        
          var bktyplen=document.getElementById('bktype').options.length;
         for(var t2=0;t2<bktyplen;t2++)
         {
             document.getElementById('bktype').options[t2].selected=false;
         }
        if(dsforexecute.Tables[0].Rows[0].BOOKING_TYPE !=null && dsforexecute.Tables[0].Rows[0].BOOKING_TYPE !="")
        {
            var bktype=dsforexecute.Tables[0].Rows[0].BOOKING_TYPE;            
           var  len1=bktype.split(",");
            for(var a1=0; a1<len1.length; a1++)
            {
                for(var j=0; j<bktyplen; j++)
                {
                    if(document.getElementById('bktype').options[j].value==len1[a1])
                    {
                       document.getElementById('bktype').options[j].selected = true;
                    }
                }
            }

        }
        
        //----------------------------------------------------------//
            if(dsforexecute.Tables[0].Rows[0].DISTRICT!=null && dsforexecute.Tables[0].Rows[0].DISTRICT != "")
			{
			document.getElementById('hiddendistcode').value=dsforexecute.Tables[0].Rows[0].DISTRICT;
			}
			else
			{
			document.getElementById('hiddendistcode').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].STATE!=null && dsforexecute.Tables[0].Rows[0].STATE != "")
			{
			document.getElementById('hiddenstatecode').value=dsforexecute.Tables[0].Rows[0].STATE;
			}
			else
			{
			document.getElementById('hiddenstatecode').value="";
			}
            document.getElementById('txtpincode').value=dsforexecute.Tables[0].Rows[0].pin_code;

			//dsforexecute.Tables[0].Rows[0].state_name
			
			 if( dsforexecute.Tables[0].Rows[0].Branch_code != null)
			{
             document.getElementById('drpbranch').value=dsforexecute.Tables[0].Rows[0].Branch_code;
			}
			else
			{
			document.getElementById('drpbranch').value="0";
			}
			
			 if( dsforexecute.Tables[0].Rows[0].INTEREST_CAL_FLAG != null)
			{
             document.getElementById('drpcalc').value=dsforexecute.Tables[0].Rows[0].INTEREST_CAL_FLAG;
			}
			else
			{
			document.getElementById('drpcalc').value="0";

}

if (dsforexecute.Tables[0].Rows[0].BILL_PRINTFLAG != null) {
    document.getElementById('drpbilflag').value = dsforexecute.Tables[0].Rows[0].BILL_PRINTFLAG;
}
else {
    document.getElementById('drpbilflag').value = "0";
}			
			
			if(dsforexecute.Tables[0].Rows[0].BILL_FREQUENCY != "" && dsforexecute.Tables[0].Rows[0].BILL_FREQUENCY != null)
			{
             document.getElementById('drpbillf').value=dsforexecute.Tables[0].Rows[0].BILL_FREQUENCY;
			}
			else
			{
			document.getElementById('drpbillf').value="0";
			}
			
			if(dsforexecute.Tables[0].Rows[0].OLD_AGENCY != "" && dsforexecute.Tables[0].Rows[0].OLD_AGENCY != null)
			{
             document.getElementById('txtoldagen').value=dsforexecute.Tables[0].Rows[0].OLD_AGENCY;
			}
			else
			{
			document.getElementById('txtoldagen').value="";
			}
			
			if(dsforexecute.Tables[0].Rows[0].URL != "" && dsforexecute.Tables[0].Rows[0].URL != null)
			{
			document.getElementById('txturl').value=dsforexecute.Tables[0].Rows[0].URL;
			}
			else
			{
			document.getElementById('txturl').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].CREDIT_TYPE != "" && dsforexecute.Tables[0].Rows[0].CREDIT_TYPE != null)
			{
			document.getElementById('drpcurtyp').value=dsforexecute.Tables[0].Rows[0].CREDIT_TYPE;
			}
			else
			{
			document.getElementById('drpcurtyp').value="0"
			}

			if (dsforexecute.Tables[0].Rows[0].BILL_EMAIL != null) {
			    document.getElementById('drpemail').value = dsforexecute.Tables[0].Rows[0].BILL_EMAIL;
			}
			else {
			    document.getElementById('drpemail').value = "";
			}
			
			
			
			//alert(ds.Tables[0].Rows[0].URL);
			
			
			if(dsforexecute.Tables[0].Rows[0].Zip != "" && dsforexecute.Tables[0].Rows[0].Zip != null)
			{
	        document.getElementById('mrvregion').value=dsforexecute.Tables[0].Rows[0].Zip;
	        }
	        else
	        {
	        document.getElementById('mrvregion').value=""
	        }
	        if(dsforexecute.Tables[0].Rows[0].CODE!=null)
	        {
	        document.getElementById('txtphone1').value=dsforexecute.Tables[0].Rows[0].CODE;
			}
			else
			{
			  document.getElementById('txtphone1').value="";
			}	
			document.getElementById('txtagencode').value=dsforexecute.Tables[0].Rows[0].Agency_Code;
			
		    document.getElementById('drprate').value=dsforexecute.Tables[0].Rows[0].Rate_Group;
		    
		    if(dsforexecute.Tables[0].Rows[0].qbc_userid != "" && dsforexecute.Tables[0].Rows[0].qbc_userid != null)
				{
		        	document.getElementById('drpuserid').value=dsforexecute.Tables[0].Rows[0].qbc_userid;
			    }
			    else
			    {
			        document.getElementById('drpuserid').value="0";
			    }
		
			document.getElementById('txtagenname').value=dsforexecute.Tables[0].Rows[0].Agency_Name;
			document.getElementById('hiddenagencyname').value=document.getElementById('txtagenname').value;
			document.getElementById('drpparent').value=dsforexecute.Tables[0].Rows[0].Type;
			
			document.getElementById('txtsagencycode').value=dsforexecute.Tables[0].Rows[0].SUB_Agency_Code;
			
			document.getElementById('drpzone').value=dsforexecute.Tables[0].Rows[0].zone_code;

			document.getElementById('drpagecate').value = dsforexecute.Tables[0].Rows[0].Agency_Cat_Code;
			if (dsforexecute.Tables[0].Rows[0].AGENCY_DESIGNATION != null) {
			    document.getElementById('txtdesg').value = dsforexecute.Tables[0].Rows[0].AGENCY_DESIGNATION;
			}
			//drpregion.SelectedValue="0";
			
			//document.getElementById('txtcrlimit').value=ds.Tables[0].Rows[0].Agency_Cat_Code;
			if(dsforexecute.Tables[0].Rows[0].Agency_HO!=null)
			{
			document.getElementById('txtagencyho').value=dsforexecute.Tables[0].Rows[0].Agency_HO;
			}
			else
			{
				document.getElementById('txtagencyho').value="";
			}
			
			if(dsforexecute.Tables[0].Rows[0].SUB_SUB_AG_CODE!=null)
			{
			document.getElementById('txtsubsubagcd').value=dsforexecute.Tables[0].Rows[0].SUB_SUB_AG_CODE;
			}
			else
			{
			document.getElementById('txtsubsubagcd').value="";
			}
			//document.getElementById('drpagetyp').value=dsforexecute.Tables[0].Rows[0].Agency_Type_Code;
			
			
			
			//document.getElementById('drpagescat').value=ds.Tables[0].Rows[0].Agency_SubCat_Code;
			//drpregion.SelectedValue="0";
			
//			addcategory(ds.Tables[0].Rows[0].Agency_Type_Code);
//			catvar=ds.Tables[0].Rows[0].Agency_Cat_Code;
			addsubcategory(dsforexecute.Tables[0].Rows[0].Agency_Cat_Code);
			
            //catvar=dsforexecute.Tables[0].Rows[0].Agency_SubCat_Code;
             catvar=dsforexecute.Tables[0].Rows[0].Agency_Cat_Code;
           addcategory(dsforexecute.Tables[0].Rows[0].Agency_Cat_Code);
			document.getElementById('drpagecate').value=dsforexecute.Tables[0].Rows[0].Agency_Cat_Code;
		document.getElementById('drpagetyp').value=dsforexecute.Tables[0].Rows[0].Agency_Type_Code;
            catvar=dsforexecute.Tables[0].Rows[0].Agency_SubCat_Code;
			if(dsforexecute.Tables[0].Rows[0].SUB_Agency_HO!=null)
			{
			document.getElementById('txtsugagencyho').value=dsforexecute.Tables[0].Rows[0].SUB_Agency_HO;
			}
			else
			{
				document.getElementById('txtsugagencyho').value="";
			}
			document.getElementById('drprepres').value=dsforexecute.Tables[0].Rows[0].representative_code;
			//drpcity.SelectedValue="0";
			
			
                //document.getElementById('getagcode').value=document.getElementById('txtagencode').value;
            document.getElementById('getagsubcode').value=document.getElementById('txtsagencycode').value;

			
			
			if(dsforexecute.Tables[0].Rows[0].Status_Reason!=null)
			{
			document.getElementById('txtstatus2').value=dsforexecute.Tables[0].Rows[0].Status_Reason;
			}
			else
			{
			document.getElementById('txtstatus2').value="";
			}
			document.getElementById('txtalias').value=dsforexecute.Tables[0].Rows[0].Agency_Alias;
			//txtagname.Text="";
			if(dsforexecute.Tables[0].Rows[0].ALERT!=null)
			{
			document.getElementById('txtalert').value=dsforexecute.Tables[0].Rows[0].ALERT;
			}
			else
			{
				document.getElementById('txtalert').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].Remarks!=null)
			{
			document.getElementById('txtremarks').value=dsforexecute.Tables[0].Rows[0].Remarks;
			}
			else
			{
				document.getElementById('txtremarks').value="";
}


if (dsforexecute.Tables[0].Rows[0].KYC_ATTACH != null) {
    document.getElementById('hidkyc').value = dsforexecute.Tables[0].Rows[0].KYC_ATTACH;

    document.getElementById('attachment1').src = "Images/indexred.jpg";
}
else {
    document.getElementById('hidkyc').value = "";

    document.getElementById('attachment1').src = "Images/index.jpeg"
}
			

if (dsforexecute.Tables[0].Rows[0].GST_REGISTRATION != null) {
    document.getElementById('drpgstus').value = dsforexecute.Tables[0].Rows[0].GST_REGISTRATION;
}
else {
    document.getElementById('drpgstus').value = "";
}
if (dsforexecute.Tables[0].Rows[0].GST_REGISTRATION_DATE != null) {
    document.getElementById('txtgstdt').value = dsforexecute.Tables[0].Rows[0].GST_REGISTRATION_DATE;
}
else {
    document.getElementById('txtgstdt').value = "";
}
if (dsforexecute.Tables[0].Rows[0].GSTIN != null) {
    document.getElementById('txtgstin').value = dsforexecute.Tables[0].Rows[0].GSTIN;
}
else {
    document.getElementById('txtgstin').value = "";
}


if (dsforexecute.Tables[0].Rows[0].GST_STATUS != null) {
    document.getElementById('drpgstatus').value = dsforexecute.Tables[0].Rows[0].GST_STATUS;
}
else {
    document.getElementById('drpgstatus').value = "";
}

if (dsforexecute.Tables[0].Rows[0].GST_CLIENT_TYPE_CD != null) {
    document.getElementById('txtgstclty').value = dsforexecute.Tables[0].Rows[0].GST_CLIENT_TYPE_CD;
}
else {
    document.getElementById('txtgstclty').value = "";
}

if (dsforexecute.Tables[0].Rows[0].GST_ARN_NO != null) {
    document.getElementById('txtarno').value = dsforexecute.Tables[0].Rows[0].GST_ARN_NO;
}
else {
    document.getElementById('txtarno').value = "";
}

if (dsforexecute.Tables[0].Rows[0].GST_PROVISINAL_ID != null) {
    document.getElementById('txtgstprovid').value = dsforexecute.Tables[0].Rows[0].GST_PROVISINAL_ID;
}
else {
    document.getElementById('txtgstprovid').value = "";
}

			
			//*****************************************Pankaj
			if(dsforexecute.Tables[0].Rows[0].Add1!=null)
			{
			document.getElementById('txtadd').value=dsforexecute.Tables[0].Rows[0].Add1;
			}
			else
			{
				document.getElementById('txtadd').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].Add2!=null)
			{
			document.getElementById('txtaddress1').value=dsforexecute.Tables[0].Rows[0].Add2;
			}
			else
			{
				document.getElementById('txtaddress1').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].Add3!=null)
			{
			document.getElementById('txtaddress2').value=dsforexecute.Tables[0].Rows[0].Add3;
			}
			else
			{
				document.getElementById('txtaddress2').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].Street!=null)
			{
			document.getElementById('txtstreet').value=dsforexecute.Tables[0].Rows[0].Street;
			}
			else
			{
			document.getElementById('txtstreet').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].Dist_Code!=null)
			{
			document.getElementById('txtdistrict').value=dsforexecute.Tables[0].Rows[0].Dist_Code;
			}
			else
			{
			document.getElementById('txtdistrict').value="";
			}
			document.getElementById('txtcountry').value=dsforexecute.Tables[0].Rows[0].Country_Code;
			
			cityvar=dsforexecute.Tables[0].Rows[0].City_Code;
				regionvar=dsforexecute.Tables[0].Rows[0].region;
			zonevar=dsforexecute.Tables[0].Rows[0].zone_code;
			talukavar=dsforexecute.Tables[0].Rows[0].TALUKA;
			addcount(dsforexecute.Tables[0].Rows[0].Country_Code);
			
				if(dsforexecute.Tables[0].Rows[0].Dist_Code!=null)
			{
			document.getElementById('txtdistrict').value=dsforexecute.Tables[0].Rows[0].Dist_Code;
			}
			else
			{
			document.getElementById('txtdistrict').value="";			
			}
			
			if(dsforexecute.Tables[0].Rows[0].State_Code!=null)
		    {
			document.getElementById('txtstate').value=dsforexecute.Tables[0].Rows[0].State_Code;
			}
			else
			{
			document.getElementById('txtstate').value="";
			}
			
//////			document.getElementById('drpregion').value=dsforexecute.Tables[0].Rows[0].region;
//////			document.getElementById('drpzone').value=dsforexecute.Tables[0].Rows[0].zone_code;
			
			if(dsforexecute.Tables[0].Rows[0].Phone!=null)
			{
			document.getElementById('txtphone2').value=dsforexecute.Tables[0].Rows[0].Phone;			
			}
			else
			{
				document.getElementById('txtphone2').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].EmailID!=null)
			{
			document.getElementById('txtmail').value=dsforexecute.Tables[0].Rows[0].EmailID;
			}
			else
			{
			document.getElementById('txtmail').value="";

}

if (dsforexecute.Tables[0].Rows[0].EMAILID_CC != null) {
    document.getElementById('txtmailcc').value = dsforexecute.Tables[0].Rows[0].EMAILID_CC;
}
else {
    document.getElementById('txtmailcc').value = "";
}

			if(dsforexecute.Tables[0].Rows[0].TAN_No!=null)
			{
			document.getElementById('txttan').value=dsforexecute.Tables[0].Rows[0].TAN_No;
			}
			else
			{
			document.getElementById('txttan').value="";
			}
			
			if(dsforexecute.Tables[0].Rows[0].Dist_Code !=null)
			{
			  var talukabind = dsforexecute.Tables[0].Rows[0].Dist_Code;
              bindtalu(talukabind);
            }
			if(dsforexecute.Tables[0].Rows[0].PAN_No!=null)
			{
				document.getElementById('txtpan').value=dsforexecute.Tables[0].Rows[0].PAN_No;
				}
				else
				{
				document.getElementById('txtpan').value="";
				}
				
				 if(dsforexecute.Tables[0].Rows[0].VAT ==0 || dsforexecute.Tables[0].Rows[0].VAT =="0" || dsforexecute.Tables[0].Rows[0].VAT ==""|| dsforexecute.Tables[0].Rows[0].VAT ==null)
			{
			 document.getElementById("chkvat").checked=false;
			}
			else
			{
			document.getElementById("chkvat").checked=true;
}

if (dsforexecute.Tables[0].Rows[0].BLANKCHEQUE == 0 || dsforexecute.Tables[0].Rows[0].BLANKCHEQUE == "0" || dsforexecute.Tables[0].Rows[0].BLANKCHEQUE == "" || dsforexecute.Tables[0].Rows[0].BLANKCHEQUE == null) {
    document.getElementById("chkcheque").checked = false;
}
else {
    document.getElementById("chkcheque").checked = true;

}
if (dsforexecute.Tables[0].Rows[0].SECURITYBOND == 0 || dsforexecute.Tables[0].Rows[0].SECURITYBOND == "0" || dsforexecute.Tables[0].Rows[0].SECURITYBOND == "" || dsforexecute.Tables[0].Rows[0].SECURITYBOND == null) {
    document.getElementById("chkbondrecvd").checked = false;
}
else {
    document.getElementById("chkbondrecvd").checked = true;

}
if (dsforexecute.Tables[0].Rows[0].KYCAPP == 0 || dsforexecute.Tables[0].Rows[0].KYCAPP == "0" || dsforexecute.Tables[0].Rows[0].KYCAPP == "" || dsforexecute.Tables[0].Rows[0].KYCAPP == null) {
    document.getElementById("chkyc").checked = false;
}
else {
    document.getElementById("chkyc").checked = true;

}
if (dsforexecute.Tables[0].Rows[0].ADDRESSPROOF == 0 || dsforexecute.Tables[0].Rows[0].ADDRESSPROOF == "0" || dsforexecute.Tables[0].Rows[0].ADDRESSPROOF == "" || dsforexecute.Tables[0].Rows[0].ADDRESSPROOF == null) {
    document.getElementById("chkadproof").checked = false;
}
else {
    document.getElementById("chkadproof").checked = true;

}
			if (dsforexecute.Tables[0].Rows[0].RATE_REVISE == 0 || dsforexecute.Tables[0].Rows[0].RATE_REVISE == "0" || dsforexecute.Tables[0].Rows[0].RATE_REVISE == "" || dsforexecute.Tables[0].Rows[0].RATE_REVISE == null) {
			    document.getElementById("chkraterevise").checked = false;
			}
			else {
			    document.getElementById("chkraterevise").checked = true;
			}
			

			//			drprepres.disabled=true;
			//			drpstatus.disabled=true;
			var compcode=document.getElementById('hiddencompcode').value;
			
            var userid=document.getElementById('hiddenuserid').value;
            
            Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,call_billto);
            
             Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,billtodrpcall);
             
            //document.getElementById('txtbill').value=dsforexecute.Tables[0].Rows[0].BILL_TO;
			//document.getElementById('txtbill').value=dsforexecute.Tables[0].Rows[0].BILL_TO;
			biltovar=dsforexecute.Tables[0].Rows[0].BILL_TO;
			
			varbiltocal=dsforexecute.Tables[0].Rows[0].acagency;
			
			//			drpsageo.disabled=true;
			if(dsforexecute.Tables[0].Rows[0].pin_code!=null)
			{
			document.getElementById('txtpincode').value=dsforexecute.Tables[0].Rows[0].pin_code;
			}
			else
			{
			document.getElementById('txtpincode').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].State_Code!=null)
			{
			document.getElementById('txtstate').value=dsforexecute.Tables[0].Rows[0].State_Code;
			}
			else
			{
			document.getElementById('txtstate').value="";
			}
			
			//if(dsforexecute.Tables[1].Rows.length>0)
//{	
//    for(var i=0;i<dsforexecute.Tables[1].Rows.length;++i) 
//    {
//	    document.getElementById("drptaluka").options[i]=new Option(dsforexecute.Tables[1].Rows[i].TALU_NAME,dsforexecute.Tables[1].Rows[i].TALU_CODE);
//    }	
//}
//if(dsforexecute.Tables[0].Rows[0].TALUKA!=null)
//			{
//			document.getElementById('drptaluka').value=dsforexecute.Tables[0].Rows[0].TALUKA;
//			}
//			else
//			{
//			document.getElementById('drptaluka').value="";
//			}

			//string zip="246763";
			if(dsforexecute.Tables[0].Rows[0].Fax!=null)
			{
			document.getElementById('txtfax').value=dsforexecute.Tables[0].Rows[0].Fax;
			}
			else
			{
			document.getElementById('txtfax').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].fax1!=null)
			{
			document.getElementById('txtfax1').value=dsforexecute.Tables[0].Rows[0].fax1;
			}
			else
			{
			document.getElementById('txtfax1').value="";
			}
			var dateformat=document.getElementById('hiddendateformat').value;
			
			if(dsforexecute.Tables[0].Rows[0].Enroll_Date != null && dsforexecute.Tables[0].Rows[0].Enroll_Date != "")
			{
			var enrolldate=dsforexecute.Tables[0].Rows[0].Enroll_Date;
			var dd=enrolldate.getDate();
			var mm=enrolldate.getMonth() + 1;
			var yyyy=enrolldate.getFullYear();
			
			var enrolldate1=mm+'/'+dd+'/'+yyyy;
			var enrolldate1day=dd+'/'+mm+'/'+yyyy;
			var enrollyear=yyyy+'/'+mm+'/'+dd;
			
			
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtenrolldate').value=enrolldate1;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtenrolldate').value=enrollyear;
			}
			
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtenrolldate').value=enrolldate1day;
			}
			if(dateformat==null || dateformat=="")
			{
			document.getElementById('txtenrolldate').value=enrolldate1;
			}
			
			
			
			}
			else
			{
			
//			document.getElementById('txtenrolldate').value=dsforexecute.Tables[0].Rows[0].Enroll_Date;
			document.getElementById('txtenrolldate').value=="";
			}
			if(dsforexecute.Tables[0].Rows[0].No_of_VTS!=null)
			{
			document.getElementById('txtnoofvts').value=dsforexecute.Tables[0].Rows[0].No_of_VTS;
			}
			else
			{
				document.getElementById('txtnoofvts').value="";
			}
			//document.getElementById('drpcity').value==dsforexecute.Tables[0].Rows[0].City_Code;
			document.getElementById('drpregion').value=dsforexecute.Tables[0].Rows[0].region;
			
			if(dsforexecute.Tables[0].Rows[0].qbc_userid != "" && dsforexecute.Tables[0].Rows[0].qbc_userid != null)
				{
		        	document.getElementById('drpuserid').value=dsforexecute.Tables[0].Rows[0].qbc_userid;
			    }
			    else
			    {
			        document.getElementById('drpuserid').value="0";
			    }
			    
//			    if(dsforexecute.Tables[1].Rows.length>0)
//{	
//    for(var i=0;i<dsforexecute.Tables[1].Rows.length;++i) 
//    {
//	    document.getElementById("drptaluka").options[i]=new Option(dsforexecute.Tables[1].Rows[i].TALU_NAME,dsforexecute.Tables[1].Rows[i].TALU_CODE);
//    }	
//}
//document.getElementById('drptaluka').value=dsforexecute.Tables[0].Rows[0].TALUKA;
			    
			if(dsforexecute.Tables[0].Rows[0].DEPOCODE!=null)
			{
			    document.getElementById('txtdepocode').value=dsforexecute.Tables[0].Rows[0].DEPOCODE;
            }
            else
            {
                document.getElementById('txtdepocode').value="";
            }
			//document.getElementById('Status').visible=true;
			
			//document.getElementById('StatusDate').styles.display="none";
			//StatusDate.style.display="visible";
			
			
//			var todate=dsforexecute.Tables[0].Rows[0].to_date;
//			var currdate=dsforexecute.Tables[0].Rows[0].current_Datetime;
//			var tdate=new Date(todate);
//			var cdate=new Date(currdate);
//			
//			var dd=currdate.getDate();
//			var mm=currdate.getMonth() + 1;
//			var yyyy=currdate.getFullYear();
//			
//			var currdate1=mm+'/'+dd+'/'+yyyy;
//			var currda=dd+'/'+mm+'/'+yyyy;
//			var curryear=yyyy+'/'+mm+'/'+dd;
//			
//		
//			if(cdate > tdate && todate!= null )
//			{
//			document.getElementById('txtstatus').value="Banned";
//			}
//			else if(todate == null && dsforexecute.Tables[0].Rows[0].status_name==null)
//			{
//			document.getElementById('txtstatus').value="Active";
//			}
//			else
//			{
//				document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[0].status_name;
//			}


            var todate=dsforexecute.Tables[0].Rows[0].to_date;
			var from_date=dsforexecute.Tables[0].Rows[0].FROM_DATE;
			
			var currdate=dsforexecute.Tables[0].Rows[0].current_Datetime;
			var tdate=new Date(todate);
			var cdate=new Date(currdate);
			
			var dd=currdate.getDate();
			var mm=currdate.getMonth() + 1;
			var yyyy=currdate.getFullYear();
			
			var currdate1=mm+'/'+dd+'/'+yyyy;
			var currda=dd+'/'+mm+'/'+yyyy;
			var curryear=yyyy+'/'+mm+'/'+dd;
			
	
		

    /* previous code for status changed by saurabh Agarwal---------------------------------------		
		
			if(cdate > tdate && todate!= null )
			{
			document.getElementById('txtstatus').value="Banned";
			}
			else if(todate == null && dsforexecute.Tables[0].Rows[0].status_name==null)
			{
			document.getElementById('txtstatus').value="Active";
			}
			else
			{
			
			document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[0].status_name;
			}
	*///---------------------------------------------------------------------------------------------
	
	
		//------------------------saurabh code for status---------------------
		
		var cur=new Date();
		
		if((dsforexecute.Tables[0].Rows[0].status_name!=null)||(dsforexecute.Tables[0].Rows[0].status_name!=""))
		{
		    if(cur>=from_date && cur<=todate)
		    {
			    document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[0].status_name;
			}
			else
			{
			    document.getElementById('txtstatus').value="Active";
			}
			
		}
		else
		{
		    document.getElementById('txtstatus').value="Active";
		}
		
		if(dsforexecute.Tables[0].Rows[0].from_date=="" || dsforexecute.Tables[0].Rows[0].from_date==null || dsforexecute.Tables[0].Rows[0].to_date=="" || dsforexecute.Tables[0].Rows[0].to_date==null)
		{
		    document.getElementById('txtstatus').value="Active";
		}
		//-----------------------------------------------------------------------
	
	

			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtstatusdate').value=currdate1;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtstatusdate').value=currda;
			}
			if(dateformat=="yyyy/mm/dd")
			{document.getElementById('txtstatusdate').value=curryear;
			}
			if(dateformat==null || dateformat=="" || dateformat=="undefined")
			{document.getElementById('txtstatusdate').value=currdate1;
			}
			//document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[0].current_Datetime;
			
			if(dsforexecute.Tables[0].Rows[0].Buss_Start_Date != null && dsforexecute.Tables[0].Rows[0].Buss_Start_Date != "")
			{
			var bussdate=dsforexecute.Tables[0].Rows[0].Buss_Start_Date;
			var dd=bussdate.getDate();
			var mm=bussdate.getMonth() + 1;
			var yyyy=bussdate.getFullYear();
			
			var bussdate1=mm+'/'+dd+'/'+yyyy;
			var bussdate1day=dd+'/'+mm+'/'+yyyy;
			var bussyear=yyyy+'/'+mm+'/'+dd;
			
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtbusineedate').value=bussdate1;
			
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtbusineedate').value=bussyear;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			
			document.getElementById('txtbusineedate').value=bussdate1day;
			}
			if(dateformat==null || dateformat=="")
			{
			document.getElementById('txtbusineedate').value=bussdate1;
			
			}
			
			
			
			
			
			}
			else
			{
			
			//document.getElementById('txtbusineedate').value=dsforexecute.Tables[0].Rows[0].Buss_Start_Date;
			document.getElementById('txtbusineedate').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].MRV_Ref_No!=null)
			{
			document.getElementById('txtmryrefno').value=dsforexecute.Tables[0].Rows[0].MRV_Ref_No;
			}
			else
			{
			document.getElementById('txtmryrefno').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].Credit_Days!=null)
			{
			document.getElementById('txtcredit').value=dsforexecute.Tables[0].Rows[0].Credit_Days;
			}
			else
			{
			document.getElementById('txtcredit').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].ST_ACC_No!=null)
			{
			document.getElementById('txtstacno').value=dsforexecute.Tables[0].Rows[0].ST_ACC_No;
			}
			else
			{
			document.getElementById('txtstacno').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].CREDIT_LIMIT!=null)
			{
			document.getElementById('txtcrlimit').value=dsforexecute.Tables[0].Rows[0].CREDIT_LIMIT;
		}
		else
		{
		document.getElementById('txtcrlimit').value="";
}
if (dsforexecute.Tables[0].Rows[0].EDTN_WISE_BILL_REQ != null) {
    document.getElementById('drpEdition_wise_Billing').value = dsforexecute.Tables[0].Rows[0].EDTN_WISE_BILL_REQ;
}
else {
    document.getElementById('drpEdition_wise_Billing').value = "N";
}
			document.getElementById('drpagecate').disabled=true;
			
			document.getElementById('txtagencode').disabled=true;
			
			
			document.getElementById('txtsagencycode').disabled=true;
			
			document.getElementById('txtagenname').disabled=true;
			
			
			document.getElementById('drpagescat').disabled=true;
			
			
			document.getElementById('drpagecate').disabled=true;
			
			document.getElementById('txtagencode').disabled=true;
			
			
			document.getElementById('txtsagencycode').disabled=true;
			
			document.getElementById('txtagenname').disabled=true;
			
			
			document.getElementById('drpagescat').disabled=true;
			
			
			document.getElementById('txtstatus2').disabled=true;
			
			document.getElementById('txtalias').disabled=true;
			
			
			document.getElementById('mrvregion').disabled=true;
			
			
			
			document.getElementById('drpregion').disabled=true;
			
			
			
			document.getElementById('txtphone1').disabled=true;
			
			
			//txtagname.ReadOnly=false;
			
			document.getElementById('txtalert').disabled=true;

			document.getElementById('txtremarks').disabled = true;

			document.getElementById('attachment1').disabled = true;
		
			document.getElementById('txtagenname').disabled=true;
			
			
			//*****Pankaj
			document.getElementById('txtadd').disabled=true;
			document.getElementById('txtaddress1').disabled=true;
			document.getElementById('txtaddress2').disabled=true;
			//************************************
			
			document.getElementById('txtstreet').disabled=true;
			
			document.getElementById('txtdistrict').disabled=true;
			
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			
			
			document.getElementById('txtbusineedate').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			
			
			
			document.getElementById('txtphone2').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;

			document.getElementById('txtmail').disabled = true;
			document.getElementById('txtmailcc').disabled = true;
			document.getElementById('drpcurtyp').disabled=true;
			document.getElementById('txttan').disabled=true;
			document.getElementById('txtpan').disabled=true;
			
			document.getElementById('drprepres').disabled=true;
			//drpstatus.disabled=true;
			document.getElementById('txtbill').disabled=true;
			
			document.getElementById('drpagetyp').disabled=true;
			//drpsageo.disabled=true;
			document.getElementById('txtpincode').disabled=true;
			document.getElementById('txtstate').disabled=true;
			//string zip="246763";
			document.getElementById('txtfax').disabled=true;
			document.getElementById('txtfax1').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtnoofvts').disabled=true;
			//document.getElementById('txtstatusdate').disabled=false;
			
			document.getElementById('drpcity').disabled=true;
			
			
			//string url="www.4cplus.com";
			document.getElementById('txtbusineedate').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtmryrefno').disabled=true;
			document.getElementById('txtcredit').disabled=true;
			document.getElementById('txtstacno').disabled=true;
			document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabledd);
			//document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabled);
			document.getElementById('txturl').disabled=true;
			document.getElementById('txturl').disabled=true;
			document.getElementById('txtphone2').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('chkvat').disabled = true;
			document.getElementById('chkcheque').disabled = true;
			document.getElementById('chkbondrecvd').disabled = true;
			document.getElementById('chkyc').disabled = true;
			document.getElementById('chkadproof').disabled = true;
			document.getElementById('chkraterevise').disabled = true;
			//string paymode=bank;
			
			document.getElementById('btnSave').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			
			
			
			
			document.getElementById('drpregion').disabled=true;
			//drpcity.SelectedItem.Text="--Select City--";
			//drpregion.disabled=false;
			document.getElementById('bktype').disabled=true;
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			
			
			
			document.getElementById('drpbranch').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('drpagetyp').disabled=true;
//			document.getElementById('drpcity').disabled=true;
			document.getElementById('txtstatus').disabled=true;
			document.getElementById('txtstatusdate').disabled=true;
			document.getElementById('drpbillf').disabled=true;
			
			document.getElementById('btnModify').disabled=false;
			document.getElementById('btnQuery').disabled=false;
			document.getElementById('btnfirst').disabled=true;
			document.getElementById('btnprevious').disabled=true;
			document.getElementById('btnnext').disabled=false;
			document.getElementById('btnlast').disabled=false;
			document.getElementById('btnCancel').disabled=false;
			document.getElementById('btnNew').disabled=true;
			document.getElementById('btnSave').disabled=true;
			document.getElementById('btnExecute').disabled=true;
			
			if(document.getElementById('hiddenpermission').value=="1")
			{
				document.getElementById('btnModify').disabled=true;
			    document.getElementById('btnDelete').disabled=true;
			}
			if(document.getElementById('hiddenpermission').value=="4")
			{
			document.getElementById('btnModify').disabled=true;
			//document.getElementById('btnQuery').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			
			
			if(document.getElementById('hiddenpermission').value=="5")
			{
			document.getElementById('btnModify').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			setButtonImages();
			return false;



}
/*
function lastclick()

{
document.getElementById('txtstatus').style.visibility="visible";
			document.getElementById('txtstatusdate').style.visibility="visible";
			document.getElementById('Status').style.visibility="visible";
			document.getElementById('StatusDate').style.visibility="visible";

var compcode=document.getElementById('hiddencompcode').value;
var userid=document.getElementById('hiddenuserid').value;
var txtagencycode=document.getElementById('txtagencode').value;


//dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 
Agent_master.last(compcode,userid,txtagencycode,filllast);
return false;


}*/

function  lastclick()
{
//dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 

Agent_master.blankSession();
 y=dsforexecute.Tables[0].Rows.length;
z=y-1;
y=y-1;
show1="7";
document.getElementById('txtpincode').value=dsforexecute.Tables[0].Rows[y].pin_code;
 //----------------------------------------------------//
        
          var bktyplen=document.getElementById('bktype').options.length;
         for(var t2=0;t2<bktyplen;t2++)
         {
             document.getElementById('bktype').options[t2].selected=false;
         }
        if(dsforexecute.Tables[0].Rows[y].BOOKING_TYPE !=null && dsforexecute.Tables[0].Rows[y].BOOKING_TYPE !="")
        {
            var bktype=dsforexecute.Tables[0].Rows[y].BOOKING_TYPE;            
           var  len1=bktype.split(",");
            for(var a1=0; a1<len1.length; a1++)
            {
                for(var j=0; j<bktyplen; j++)
                {
                    if(document.getElementById('bktype').options[j].value==len1[a1])
                    {
                       document.getElementById('bktype').options[j].selected = true;
                    }
                }
            }

        }
        
        //----------------------------------------------------------//
			//dsforexecute.Tables[0].Rows[0].state_name


        if (dsforexecute.Tables[0].Rows[y].BILL_EMAIL != null) {
            document.getElementById('drpemail').value = dsforexecute.Tables[0].Rows[y].BILL_EMAIL;
        }
        else {
            document.getElementById('drpemail').value = "";
        }
			//intrest bill
			
			
				 if(dsforexecute.Tables[0].Rows[y].INTEREST_CAL_FLAG != null)
			{
             document.getElementById('drpcalc').value=dsforexecute.Tables[0].Rows[y].INTEREST_CAL_FLAG;
			}
			else
			{
			document.getElementById('drpcalc').value="0";
			}
			///////////////////
			
			
			 if(dsforexecute.Tables[0].Rows[y].Branch_code != null)
			{
             document.getElementById('drpbranch').value=dsforexecute.Tables[0].Rows[y].Branch_code;
			}
			else
			{
			document.getElementById('drpbranch').value="0";
			}
//Dist_code

            if(dsforexecute.Tables[0].Rows[y].DISTRICT!=null && dsforexecute.Tables[0].Rows[y].DISTRICT != "")
			{
			document.getElementById('hiddendistcode').value=dsforexecute.Tables[0].Rows[y].DISTRICT;
			}
			else
			{
			document.getElementById('hiddendistcode').value="";
			}
			if(dsforexecute.Tables[0].Rows[y].STATE!=null && dsforexecute.Tables[0].Rows[y].STATE != "")
			{
			document.getElementById('hiddenstatecode').value=dsforexecute.Tables[0].Rows[y].STATE;
			}	
			else
			{
			document.getElementById('hiddenstatecode').value="";
			}		
			if(dsforexecute.Tables[0].Rows[y].BILL_FREQUENCY != "" && dsforexecute.Tables[0].Rows[y].BILL_FREQUENCY != null)
			{
             document.getElementById('drpbillf').value=dsforexecute.Tables[0].Rows[y].BILL_FREQUENCY;
			}
			else
			{
			document.getElementById('drpbillf').value="0";
			}
			
			
			if(dsforexecute.Tables[0].Rows[y].OLD_AGENCY != "" && dsforexecute.Tables[0].Rows[y].OLD_AGENCY != null)
			{
             document.getElementById('txtoldagen').value=dsforexecute.Tables[0].Rows[y].OLD_AGENCY;
			}
			else
			{
			document.getElementById('txtoldagen').value="";
			}
			
			if(dsforexecute.Tables[0].Rows[y].CODE!=null)
			{
			document.getElementById('txtphone1').value=dsforexecute.Tables[0].Rows[y].CODE;
			}
			else
			{
			document.getElementById('txtphone1').value="";
			}
			
			
	        if(dsforexecute.Tables[0].Rows[y].URL != "" && dsforexecute.Tables[0].Rows[y].URL != null)
			{
			document.getElementById('txturl').value=dsforexecute.Tables[0].Rows[y].URL;
			}
			else
			{
			document.getElementById('txturl').value="";
			}
			
			if(dsforexecute.Tables[0].Rows[y].CREDIT_TYPE != "" && dsforexecute.Tables[0].Rows[y].CREDIT_TYPE != null)
			{
			document.getElementById('drpcurtyp').value=dsforexecute.Tables[0].Rows[y].CREDIT_TYPE;
			}
			else
			{
			document.getElementById('drpcurtyp').value="0"
			}
			
			
			
			if(dsforexecute.Tables[0].Rows[y].Zip != "" && dsforexecute.Tables[0].Rows[y].Zip != null)
			{
	        document.getElementById('mrvregion').value=dsforexecute.Tables[0].Rows[y].Zip;
	        }
	        else
	        {
	        document.getElementById('mrvregion').value="";
	    }

	    if (dsforexecute.Tables[0].Rows[y].BILL_PRINTFLAG != null) {
	        document.getElementById('drpbilflag').value = dsforexecute.Tables[0].Rows[y].BILL_PRINTFLAG;
	    }
	    else {
	        document.getElementById('drpbilflag').value = "0";
	    }  
	        									
if(dsforexecute.Tables[0].Rows[y].SUB_SUB_AG_CODE!=null)
			{
			document.getElementById('txtsubsubagcd').value=dsforexecute.Tables[0].Rows[y].SUB_SUB_AG_CODE;
			}
			else
			{
			document.getElementById('txtsubsubagcd').value="";
			}
			
			
			document.getElementById('txtagencode').value=dsforexecute.Tables[0].Rows[y].Agency_Code;
		document.getElementById('drprate').value=dsforexecute.Tables[0].Rows[y].Rate_Group;
			document.getElementById('txtagenname').value=dsforexecute.Tables[0].Rows[y].Agency_Name;
			document.getElementById('hiddenagencyname').value=document.getElementById('txtagenname').value;
			document.getElementById('drpparent').value=dsforexecute.Tables[0].Rows[y].Type;
			document.getElementById('txtsagencycode').value=dsforexecute.Tables[0].Rows[y].SUB_Agency_Code;
			document.getElementById('drpzone').value=dsforexecute.Tables[0].Rows[y].zone_code;
			document.getElementById('drpagecate').value = dsforexecute.Tables[0].Rows[y].Agency_Cat_Code;
			if (dsforexecute.Tables[0].Rows[y].AGENCY_DESIGNATION != null) {
			    document.getElementById('txtdesg').value = dsforexecute.Tables[0].Rows[y].AGENCY_DESIGNATION;
			}
			
			
			//drpregion.SelectedValue="0";
			
			//document.getElementById('txtcrlimit').value=dsforexecute.Tables[0].Rows[y].Agency_Cat_Code;
			if(dsforexecute.Tables[0].Rows[y].Agency_HO!=null)
			{
			document.getElementById('txtagencyho').value=dsforexecute.Tables[0].Rows[y].Agency_HO;
			}
			else
			{
				document.getElementById('txtagencyho').value="";
}
if (dsforexecute.Tables[0].Rows[y].EDTN_WISE_BILL_REQ != null) {
    document.getElementById('drpEdition_wise_Billing').value = dsforexecute.Tables[0].Rows[y].EDTN_WISE_BILL_REQ;
}
else {
    document.getElementById('drpEdition_wise_Billing').value = "N";
}
			//document.getElementById('drpagetyp').value=dsforexecute.Tables[0].Rows[y].Agency_Type_Code;
			
			
			
			//document.getElementById('drpagescat').value=dsforexecute.Tables[0].Rows[y].Agency_SubCat_Code;
			//drpregion.SelectedValue="0";
			
//			addcategory(dsforexecute.Tables[0].Rows[y].Agency_Type_Code);
//			catvar=dsforexecute.Tables[0].Rows[y].Agency_Cat_Code;
			addsubcategory(dsforexecute.Tables[0].Rows[y].Agency_Cat_Code);
           //catvar=dsforexecute.Tables[0].Rows[y].Agency_SubCat_Code;
            catvar=dsforexecute.Tables[0].Rows[y].Agency_Cat_Code;
               addcategory(dsforexecute.Tables[0].Rows[y].Agency_Cat_Code);
          document.getElementById('drpagecate').value=dsforexecute.Tables[0].Rows[y].Agency_Cat_Code;
		document.getElementById('drpagetyp').value=dsforexecute.Tables[0].Rows[y].Agency_Type_Code;
			if(dsforexecute.Tables[0].Rows[y].SUB_Agency_HO!=null)
			{
			document.getElementById('txtsugagencyho').value=dsforexecute.Tables[0].Rows[y].SUB_Agency_HO;
			}
			else
			{
			document.getElementById('txtsugagencyho').value="";
			}
			document.getElementById('drprepres').value=dsforexecute.Tables[0].Rows[y].representative_code;
			//drpcity.SelectedValue="0";	
			if(	dsforexecute.Tables[0].Rows[y].Status_Reason!=null)
			{
			document.getElementById('txtstatus2').value=dsforexecute.Tables[0].Rows[y].Status_Reason;
			}
			else
			{
				document.getElementById('txtstatus2').value="";
			}
			document.getElementById('txtalias').value=dsforexecute.Tables[0].Rows[y].Agency_Alias;
			//txtagname.Text="";
			if(dsforexecute.Tables[0].Rows[y].ALERT!=null)
			{
			document.getElementById('txtalert').value=dsforexecute.Tables[0].Rows[y].ALERT;
			}
			else
			{
			document.getElementById('txtalert').value="";
			}
			if(dsforexecute.Tables[0].Rows[y].Remarks!=null)
			{
			document.getElementById('txtremarks').value=dsforexecute.Tables[0].Rows[y].Remarks;
			}
			else
			{
			document.getElementById('txtremarks').value="";

}


if (dsforexecute.Tables[0].Rows[y].KYC_ATTACH != null) {
    document.getElementById('hidkyc').value = dsforexecute.Tables[0].Rows[y].KYC_ATTACH;
}
else {
    document.getElementById('hidkyc').value = "";
}
			
			
			//*************************Pankaj***************
//			document.getElementById('txtadd').value=dsforexecute.Tables[0].Rows[y].Add1;
//			document.getElementById('txtaddress1').value=dsforexecute.Tables[0].Rows[y].Add2;
//			document.getElementById('txtaddress2').value=dsforexecute.Tables[0].Rows[y].Add3;
			if(dsforexecute.Tables[0].Rows[y].Add1!=null)
			{
			document.getElementById('txtadd').value=dsforexecute.Tables[0].Rows[y].Add1;
			}
			else
			{
				document.getElementById('txtadd').value="";
			}
			if(dsforexecute.Tables[0].Rows[y].Add2!=null)
			{
			document.getElementById('txtaddress1').value=dsforexecute.Tables[0].Rows[y].Add2;
			}
			else
			{
			document.getElementById('txtaddress1').value="";
			}
			if(dsforexecute.Tables[0].Rows[y].Add3!=null)
			{
			document.getElementById('txtaddress2').value=dsforexecute.Tables[0].Rows[y].Add3;
			}
			else
			{
				document.getElementById('txtaddress2').value="";
			}
			if(dsforexecute.Tables[0].Rows[y].qbc_userid != "" && dsforexecute.Tables[0].Rows[y].qbc_userid != null)
				{
		        	document.getElementById('drpuserid').value=dsforexecute.Tables[0].Rows[y].qbc_userid;
			    }
			    else
			    {
			        document.getElementById('drpuserid').value="0";
			    }
			

			if (dsforexecute.Tables[0].Rows[y].GST_REGISTRATION != null) {
			    document.getElementById('drpgstus').value = dsforexecute.Tables[0].Rows[y].GST_REGISTRATION;
			}
			else {
			    document.getElementById('drpgstus').value = "";
			}
			if (dsforexecute.Tables[0].Rows[y].GST_REGISTRATION_DATE != null) {
			    document.getElementById('txtgstdt').value = dsforexecute.Tables[0].Rows[y].GST_REGISTRATION_DATE;
			}
			else {
			    document.getElementById('txtgstdt').value = "";
			}
			if (dsforexecute.Tables[0].Rows[y].GSTIN != null) {
			    document.getElementById('txtgstin').value = dsforexecute.Tables[0].Rows[y].GSTIN;
			}
			else {
			    document.getElementById('txtgstin').value = "";
			}

			if (dsforexecute.Tables[0].Rows[y].GST_STATUS != null) {
			    document.getElementById('drpgstatus').value = dsforexecute.Tables[0].Rows[y].GST_STATUS;
			}
			else {
			    document.getElementById('drpgstatus').value = "";
			}

			if (dsforexecute.Tables[0].Rows[y].GST_CLIENT_TYPE_CD != null) {
			    document.getElementById('txtgstclty').value = dsforexecute.Tables[0].Rows[y].GST_CLIENT_TYPE_CD;
			}
			else {
			    document.getElementById('txtgstclty').value = "";
			}

			if (dsforexecute.Tables[0].Rows[y].GST_ARN_NO != null) {
			    document.getElementById('txtarno').value = dsforexecute.Tables[0].Rows[y].GST_ARN_NO;
			}
			else {
			    document.getElementById('txtarno').value = "";
			}

			if (dsforexecute.Tables[0].Rows[y].GST_PROVISINAL_ID != null) {
			    document.getElementById('txtgstprovid').value = dsforexecute.Tables[0].Rows[y].GST_PROVISINAL_ID;
			}
			else {
			    document.getElementById('txtgstprovid').value = "";
			}


			//__________________________
			if(dsforexecute.Tables[0].Rows[y].Street!=null)
			{
			document.getElementById('txtstreet').value=dsforexecute.Tables[0].Rows[y].Street;
			}
			else
			{
				document.getElementById('txtstreet').value="";
			}
			if(dsforexecute.Tables[0].Rows[y].Dist_Code!=null)
			{
			document.getElementById('txtdistrict').value=dsforexecute.Tables[0].Rows[y].Dist_Code;
			}
			else
			{
			document.getElementById('txtdistrict').value="";
			}
			document.getElementById('txtcountry').value=dsforexecute.Tables[0].Rows[y].Country_Code;
			
			 if(dsforexecute.Tables[0].Rows[y].VAT ==0 || dsforexecute.Tables[0].Rows[y].VAT =="0" || dsforexecute.Tables[0].Rows[y].VAT ==""|| dsforexecute.Tables[0].Rows[y].VAT ==null)
			{
			 document.getElementById("chkvat").checked=false;
			}
			else
			{
			document.getElementById("chkvat").checked=true;
}

if (dsforexecute.Tables[0].Rows[y].BLANKCHEQUE == 0 || dsforexecute.Tables[0].Rows[y].BLANKCHEQUE == "0" || dsforexecute.Tables[0].Rows[y].BLANKCHEQUE == "" || dsforexecute.Tables[0].Rows[y].BLANKCHEQUE == null) {
    document.getElementById("chkcheque").checked = false;
}
else {
    document.getElementById("chkcheque").checked = true;

}
if (dsforexecute.Tables[0].Rows[y].SECURITYBOND == 0 || dsforexecute.Tables[0].Rows[y].SECURITYBOND == "0" || dsforexecute.Tables[0].Rows[y].SECURITYBOND == "" || dsforexecute.Tables[0].Rows[y].SECURITYBOND == null) {
    document.getElementById("chkbondrecvd").checked = false;
}
else {
    document.getElementById("chkbondrecvd").checked = true;

}
if (dsforexecute.Tables[0].Rows[y].KYCAPP == 0 || dsforexecute.Tables[0].Rows[y].KYCAPP == "0" || dsforexecute.Tables[0].Rows[y].KYCAPP == "" || dsforexecute.Tables[0].Rows[y].KYCAPP == null) {
    document.getElementById("chkyc").checked = false;
}
else {
    document.getElementById("chkyc").checked = true;

}
if (dsforexecute.Tables[0].Rows[y].ADDRESSPROOF == 0 || dsforexecute.Tables[0].Rows[y].ADDRESSPROOF == "0" || dsforexecute.Tables[0].Rows[y].ADDRESSPROOF == "" || dsforexecute.Tables[0].Rows[y].ADDRESSPROOF == null) {
    document.getElementById("chkadproof").checked = false;
}
else {
    document.getElementById("chkadproof").checked = true;

}
			if (dsforexecute.Tables[0].Rows[y].RATE_REVISE == 0 || dsforexecute.Tables[0].Rows[y].RATE_REVISE == "0" || dsforexecute.Tables[0].Rows[y].RATE_REVISE == "" || dsforexecute.Tables[0].Rows[y].RATE_REVISE == null) {
			    document.getElementById("chkraterevise").checked = false;
			}
			else {
			    document.getElementById("chkraterevise").checked = true;
			}
			
			cityvar=dsforexecute.Tables[0].Rows[y].City_Code;
				regionvar=dsforexecute.Tables[0].Rows[y].region;
			zonevar=dsforexecute.Tables[0].Rows[y].zone_code;
			talukavar=dsforexecute.Tables[0].Rows[y].TALUKA;
			addcount(dsforexecute.Tables[0].Rows[y].Country_Code);
			
				if(dsforexecute.Tables[0].Rows[y].Dist_Code!=null)
			{
			document.getElementById('txtdistrict').value=dsforexecute.Tables[0].Rows[y].Dist_Code;
			}
			else
			{
			document.getElementById('txtdistrict').value="";			
			}
			
			if(dsforexecute.Tables[0].Rows[y].State_Code!=null)
		    {
			document.getElementById('txtstate').value=dsforexecute.Tables[0].Rows[y].State_Code;
			}
			else
			{
			document.getElementById('txtstate').value="";
			}
			
//			document.getElementById('drpregion').value=dsforexecute.Tables[0].Rows[y].region;
//			document.getElementById('drpzone').value=dsforexecute.Tables[0].Rows[y].zone_code;
			
			
			if(dsforexecute.Tables[0].Rows[y].Phone!=null)
			{
			document.getElementById('txtphone2').value=dsforexecute.Tables[0].Rows[y].Phone;
			}
			else
			{
				document.getElementById('txtphone2').value="";
			}
			
			if(dsforexecute.Tables[0].Rows[y].EmailID!=null)
			{
			document.getElementById('txtmail').value=dsforexecute.Tables[0].Rows[y].EmailID;
			}
			else
			{
			document.getElementById('txtmail').value="";

}

if (dsforexecute.Tables[0].Rows[y].EMAILID_CC != null) {
    document.getElementById('txtmailcc').value = dsforexecute.Tables[0].Rows[y].EMAILID_CC;
}
else {
    document.getElementById('txtmailcc').value = "";
}
			
			
			
			if(dsforexecute.Tables[0].Rows[y].TAN_No!=null)
			{
			document.getElementById('txttan').value=dsforexecute.Tables[0].Rows[y].TAN_No;
			}
			else
			{
			document.getElementById('txttan').value="";
			}
			if(dsforexecute.Tables[0].Rows[y].Dist_Code !=null)
			{
			  var talukabind = dsforexecute.Tables[0].Rows[y].Dist_Code;
               bindtalu(talukabind);
            }
			if(dsforexecute.Tables[0].Rows[y].PAN_No!=null)
			{
				document.getElementById('txtpan').value=dsforexecute.Tables[0].Rows[y].PAN_No;
				}
				else
				{
				document.getElementById('txtpan').value="";
				}
			//			drprepres.disabled=true;
			//			drpstatus.disabled=true;
			var compcode=document.getElementById('hiddencompcode').value;
            var userid=document.getElementById('hiddenuserid').value;
            Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,call_billto);
             Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,billtodrpcall);
            //document.getElementById('txtbill').value=dsforexecute.Tables[0].Rows[y].BILL_TO;
			//document.getElementById('txtbill').value=dsforexecute.Tables[0].Rows[y].BILL_TO;
			biltovar=dsforexecute.Tables[0].Rows[y].BILL_TO;
			varbiltocal=dsforexecute.Tables[0].Rows[y].acagency;
			
			//document.getElementById('getagcode').value=document.getElementById('txtagencode').value;
document.getElementById('getagsubcode').value=document.getElementById('txtsagencycode').value;
			//			drpsageo.disabled=true;
			if(dsforexecute.Tables[0].Rows[y].pin_code!=null)
			{
			document.getElementById('txtpincode').value=dsforexecute.Tables[0].Rows[y].pin_code;
			}
			else
			{
				document.getElementById('txtpincode').value="";
			}
			if(dsforexecute.Tables[0].Rows[y].State_Code!=null)
			{
			document.getElementById('txtstate').value=dsforexecute.Tables[0].Rows[y].State_Code;
			}
			else
			{
			document.getElementById('txtstate').value="";
			}
			//string zip="246763";
			if(dsforexecute.Tables[0].Rows[y].Fax!=null)
			{
			document.getElementById('txtfax').value=dsforexecute.Tables[0].Rows[y].Fax;
			}
			else
			{
				document.getElementById('txtfax').value="";
			}
			if(dsforexecute.Tables[0].Rows[y].fax1!=null)
			{
			document.getElementById('txtfax1').value=dsforexecute.Tables[0].Rows[y].fax1;
			}
			else
			{
			document.getElementById('txtfax1').value="";
			}
			
			  if(dsforexecute.Tables[0].Rows[y].TALUKA!=null)
			{
			document.getElementById('drptaluka').value=dsforexecute.Tables[0].Rows[y].TALUKA;
			}
			else
			{
			document.getElementById('drptaluka').value="0";
			}
			var dateformat=document.getElementById('hiddendateformat').value;
			
			if(dsforexecute.Tables[0].Rows[y].Enroll_Date != null && dsforexecute.Tables[0].Rows[y].Enroll_Date != "")
			{
			var enrolldate=dsforexecute.Tables[0].Rows[y].Enroll_Date;
			var dd=enrolldate.getDate();
			var mm=enrolldate.getMonth() + 1;
			var yyyy=enrolldate.getFullYear();
			
			var enrolldate1=mm+'/'+dd+'/'+yyyy;
			var enrolldate1day=dd+'/'+mm+'/'+yyyy;
			var enrollyear=yyyy+'/'+mm+'/'+dd;
			
//          if(dsforexecute.Tables[0].Rows[y].TALUKA!=null)
//			{
//			document.getElementById('drptaluka').value=dsforexecute.Tables[0].Rows[y].TALUKA;
//			}
//			else
//			{
//			document.getElementById('drptaluka').value="0";
//			}

			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtenrolldate').value=enrolldate1;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtenrolldate').value=enrollyear;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtenrolldate').value=enrolldate1day;
			}
			if(dateformat==null || dateformat=="")
			{
			document.getElementById('txtenrolldate').value=enrolldate1;
			}
			
			
			}
			else
			{
			
			//document.getElementById('txtenrolldate').value=dsforexecute.Tables[0].Rows[y].Enroll_Date;
			document.getElementById('txtenrolldate').value="";
			}
			if(dsforexecute.Tables[0].Rows[y].No_of_VTS!=null)
			{
			document.getElementById('txtnoofvts').value=dsforexecute.Tables[0].Rows[y].No_of_VTS;
			}
			else
			{
			document.getElementById('txtnoofvts').value="";
			}
//			if(dsforexecute.Tables[0].Rows[y].City_Code!=null)
//			{
//			document.getElementById('drpcity').value=dsforexecute.Tables[0].Rows[y].City_Code;
//			}
//			else
//			{
//			document.getElementById('drpcity').value="";
//			}
			if(dsforexecute.Tables[0].Rows[y].region!=null)
			{
			document.getElementById('drpregion').value=dsforexecute.Tables[0].Rows[y].region;
			}
			else
			{
				document.getElementById('drpregion').value="";
			}
			if(dsforexecute.Tables[0].Rows[y].CREDIT_LIMIT!=null)
			{
			document.getElementById('txtcrlimit').value=dsforexecute.Tables[0].Rows[y].CREDIT_LIMIT;
			}
			else
			{
			document.getElementById('txtcrlimit').value="";
			}
			
			
			if(dsforexecute.Tables[0].Rows[y].DEPOCODE!=null)
			{
			    document.getElementById('txtdepocode').value=dsforexecute.Tables[0].Rows[y].DEPOCODE;
            }
            else
            {
                document.getElementById('txtdepocode').value="";
            }
			//document.getElementById('Status').visible=true;
			
			//document.getElementById('StatusDate').styles.display="none";
			//StatusDate.style.display="visible";
			
			
//			var todate=dsforexecute.Tables[0].Rows[y].to_date;
//			var currdate=dsforexecute.Tables[0].Rows[y].current_Datetime;
//			var tdate=new Date(todate);
//			var cdate=new Date(currdate);
//			
//			var dd=currdate.getDate();
//			var mm=currdate.getMonth() + 1;
//			var yyyy=currdate.getFullYear();
//			
//			var currdate1=mm+'/'+dd+'/'+yyyy;
//			var currda=dd+'/'+mm+'/'+yyyy;
//			var curryear=yyyy+'/'+mm+'/'+dd;
//			
//		
//			if(cdate > tdate && todate!= null )
//			{
//			document.getElementById('txtstatus').value="Banned";
//			}
//			else if(todate == null && dsforexecute.Tables[0].Rows[y].status_name==null)
//			{
//			document.getElementById('txtstatus').value="Active";
//			}
//			else
//			{
//			
//			document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[y].status_name;
//			}
			
			var todate=dsforexecute.Tables[0].Rows[y].to_date;
			var from_date=dsforexecute.Tables[0].Rows[y].FROM_DATE;
			
			var currdate=dsforexecute.Tables[0].Rows[y].current_Datetime;
			var tdate=new Date(todate);
			var cdate=new Date(currdate);
			
			var dd=currdate.getDate();
			var mm=currdate.getMonth() + 1;
			var yyyy=currdate.getFullYear();
			
			var currdate1=mm+'/'+dd+'/'+yyyy;
			var currda=dd+'/'+mm+'/'+yyyy;
			var curryear=yyyy+'/'+mm+'/'+dd;
			
	
		

    /* previous code for status changed by saurabh Agarwal---------------------------------------		
		
			if(cdate > tdate && todate!= null )
			{
			document.getElementById('txtstatus').value="Banned";
			}
			else if(todate == null && dsforexecute.Tables[0].Rows[0].status_name==null)
			{
			document.getElementById('txtstatus').value="Active";
			}
			else
			{
			
			document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[0].status_name;
			}
	*///---------------------------------------------------------------------------------------------
	
	
		//------------------------saurabh code for status---------------------
		
		var cur=new Date();
		
		if((dsforexecute.Tables[0].Rows[y].status_name!=null)||(dsforexecute.Tables[0].Rows[y].status_name!=""))
		{
		    if(cur>=from_date && cur<=todate)
		    {
			    document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[y].status_name;
			}
			else
			{
			    document.getElementById('txtstatus').value="Active";
			}
			
		}
		else
		{
		    document.getElementById('txtstatus').value="Active";
		}
		
		if(dsforexecute.Tables[0].Rows[y].from_date=="" || dsforexecute.Tables[0].Rows[y].from_date==null || dsforexecute.Tables[0].Rows[y].to_date=="" || dsforexecute.Tables[0].Rows[y].to_date==null)
		{
		    document.getElementById('txtstatus').value="Active";
		}
		//-----------------------------------------------------------------------
	
	
			
			
	
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtstatusdate').value=currdate1;
			}
			if(dateformat=="dd/mm/yyyy")
			{document.getElementById('txtstatusdate').value=currda;
			}
			if(dateformat=="yyyy/mm/dd")
			{document.getElementById('txtstatusdate').value=curryear;
			}
			if(dateformat== null || dateformat=="" || dateformat=="undefined")
			{document.getElementById('txtstatusdate').value=currdate1;
			}
			//document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[0].current_Datetime;
			
			if(dsforexecute.Tables[0].Rows[y].Buss_Start_Date != null && dsforexecute.Tables[0].Rows[y].Buss_Start_Date != "")
			{
			var bussdate=dsforexecute.Tables[0].Rows[y].Buss_Start_Date;
			var dd=bussdate.getDate();
			var mm=bussdate.getMonth() + 1;
			var yyyy=bussdate.getFullYear();
			
			var bussdate1=mm+'/'+dd+'/'+yyyy;
			var bussdate1day=dd+'/'+mm+'/'+yyyy;
			var bussyear=yyyy+'/'+mm+'/'+dd;
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtbusineedate').value=bussdate1;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtbusineedate').value=bussyear;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtbusineedate').value=bussdate1day;
			}
			if(dateformat==null || dateformat=="")
			{
			document.getElementById('txtbusineedate').value=bussdate1;
			}
			
			}
			else
			{
			
			//document.getElementById('txtbusineedate').value=dsforexecute.Tables[0].Rows[y].Buss_Start_Date;
			document.getElementById('txtbusineedate').value="";
			}
			if(dsforexecute.Tables[0].Rows[y].MRV_Ref_No!=null)
			{
			document.getElementById('txtmryrefno').value=dsforexecute.Tables[0].Rows[y].MRV_Ref_No;
			}
			else
			{
			document.getElementById('txtmryrefno').value="";
			}
			if(dsforexecute.Tables[0].Rows[y].Credit_Days!=null)
			{
			document.getElementById('txtcredit').value=dsforexecute.Tables[0].Rows[y].Credit_Days;
			}
			else
			{
			document.getElementById('txtcredit').value="";
			}
			if(dsforexecute.Tables[0].Rows[y].ST_ACC_No!=null)
			{
			document.getElementById('txtstacno').value=dsforexecute.Tables[0].Rows[y].ST_ACC_No;
			}
			else
			{
				document.getElementById('txtstacno').value="";
			}
			//document.getElementById('txtbill').value=dsforexecute.Tables[0].Rows[y].BILL_TO;
			biltovar=dsforexecute.Tables[0].Rows[y].BILL_TO;
			varbiltocal=dsforexecute.Tables[0].Rows[y].acagency;
			document.getElementById('drpagecate').disabled=true;
			
			document.getElementById('txtagencode').disabled=true;
			
			
			document.getElementById('txtsagencycode').disabled=true;
			
			document.getElementById('txtagenname').disabled=true;
			
			
			document.getElementById('drpagescat').disabled=true;
			
			
			document.getElementById('drpagecate').disabled=true;
			
			document.getElementById('txtagencode').disabled=true;
			
			
			document.getElementById('txtsagencycode').disabled=true;
			
			document.getElementById('txtagenname').disabled=true;
			
			
			document.getElementById('drpagescat').disabled=true;
			
			
			document.getElementById('txtstatus2').disabled=true;
			
			document.getElementById('txtalias').disabled=true;
			
			
			document.getElementById('mrvregion').disabled=true;
			
			
			
			document.getElementById('drpregion').disabled=true;
			
			
			
			document.getElementById('txtphone1').disabled=true;
			
			
			//txtagname.ReadOnly=false;
			
			document.getElementById('txtalert').disabled=true;

			document.getElementById('txtremarks').disabled = true;
			document.getElementById('attachment1').disabled = true;
		
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('drpbillf').disabled=true;
			
			//**************Pankaj
			document.getElementById('txtadd').disabled=true;
			document.getElementById('txtaddress1').disabled=true;
			document.getElementById('txtaddress2').disabled=true;
			//**************
			
			document.getElementById('txtstreet').disabled=true;
			
			document.getElementById('txtdistrict').disabled=true;
			
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;

			document.getElementById('txtmail').disabled = true;
			document.getElementById('txtmailcc').disabled = true;
			document.getElementById('drpcurtyp').disabled=true;
			document.getElementById('txttan').disabled=true;
			document.getElementById('txtpan').disabled=true;
			
			document.getElementById('drprepres').disabled=true;
			//drpstatus.disabled=true;
			document.getElementById('txtbill').disabled=true;
			
			document.getElementById('drpagetyp').disabled=true;
			//drpsageo.disabled=true;
			document.getElementById('txtpincode').disabled=true;
			document.getElementById('txtstate').disabled=true;
			//string zip="246763";
			document.getElementById('txtfax').disabled=true;
			document.getElementById('txtfax1').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtnoofvts').disabled=true;
			//document.getElementById('txtstatusdate').disabled=false;
			
			document.getElementById('drpcity').disabled=true;
			
			
			document.getElementById('txtbusineedate').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtmryrefno').disabled=true;
			document.getElementById('txtcredit').disabled=true;
			document.getElementById('txtstacno').disabled=true;
			document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabledd);
			//document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabled);
			document.getElementById('txturl').disabled=true;
			document.getElementById('txturl').disabled=true;
			document.getElementById('txtphone2').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('drpbranch').disabled=true;
			//string paymode=bank;
			
			document.getElementById('btnSave').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;



			document.getElementById('drpemail').disabled = true;
			document.getElementById('drpregion').disabled=true;
			//drpcity.SelectedItem.Text="--Select City--";
			//drpregion.disabled=false;
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			
			document.getElementById('txtalias').disabled=true;
			document.getElementById('drpagetyp').disabled=true;
//			document.getElementById('drpcity').disabled=true;
			document.getElementById('txtstatus').disabled=true;
			document.getElementById('txtstatusdate').disabled=true;
			document.getElementById('chkvat').disabled = true;
			document.getElementById('chkcheque').disabled = true;
			document.getElementById('chkbondrecvd').disabled = true;
			document.getElementById('chkyc').disabled = true;
			document.getElementById('chkadproof').disabled = true;

			document.getElementById('chkraterevise').disabled = true;
			
			document.getElementById('btnModify').disabled=false;
			document.getElementById('btnQuery').disabled=false;
			document.getElementById('btnfirst').disabled=false;
			document.getElementById('btnprevious').disabled=false;
			document.getElementById('btnnext').disabled=true;
			document.getElementById('btnlast').disabled=true;
			document.getElementById('btnCancel').disabled=false;
			document.getElementById('btnNew').disabled=true;
			document.getElementById('btnSave').disabled=true;
			document.getElementById('btnExecute').disabled=true;
			if(document.getElementById('hiddenpermission').value=="1")
			{
				document.getElementById('btnModify').disabled=true;
			    document.getElementById('btnDelete').disabled=true;
			}
			if(document.getElementById('hiddenpermission').value=="4")
			{
			document.getElementById('btnModify').disabled=true;
			//document.getElementById('btnQuery').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			
			if(document.getElementById('hiddenpermission').value=="5")
			{
			document.getElementById('btnModify').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			setButtonImages();
			return false;

}
/*
function nextclick()
{

            document.getElementById('txtstatus').style.visibility="visible";
			document.getElementById('txtstatusdate').style.visibility="visible";
			document.getElementById('Status').style.visibility="visible";
			document.getElementById('StatusDate').style.visibility="visible";

var compcode=document.getElementById('hiddencompcode').value;
var userid=document.getElementById('hiddenuserid').value;
var txtagencycode=document.getElementById('txtagencode').value;


document.getElementById('drpagecate').disabled=true;
			
			document.getElementById('txtagencode').disabled=true;
			
			
			document.getElementById('txtsagencycode').disabled=true;
			
			document.getElementById('txtagenname').disabled=true;
			
			
			document.getElementById('drpagescat').disabled=true;
			
			
			document.getElementById('txtstatus2').disabled=true;
			
			document.getElementById('txtalias').disabled=true;
			
			
			document.getElementById('mrvregion').disabled=true;
			
			
			
			document.getElementById('drpregion').disabled=true;
			
			
			
			document.getElementById('txtphone1').disabled=true;
			
			
			//txtagname.ReadOnly=false;
			
			document.getElementById('txtalert').disabled=true;
			
			document.getElementById('txtremarks').disabled=true;
		
			document.getElementById('txtagenname').disabled=true;
			
			//***************************Pankaj
			
			document.getElementById('txtadd').disabled=true;
			document.getElementById('txtaddress1').disabled=true;
			document.getElementById('txtaddress2').disabled=true;
			
			document.getElementById('txtstreet').disabled=true;
			
			document.getElementById('txtdistrict').disabled=true;
			
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;
			
			document.getElementById('txtmail').disabled=true;
			document.getElementById('drpcurtyp').disabled=true;
			document.getElementById('txttan').disabled=true;
			document.getElementById('txtpan').disabled=true;
			
			document.getElementById('drprepres').disabled=true;
			//drpstatus.disabled=true;
			document.getElementById('txtbill').disabled=true;
			
			document.getElementById('drpagetyp').disabled=true;
			//drpsageo.disabled=true;
			document.getElementById('txtpincode').disabled=true;
			document.getElementById('txtstate').disabled=true;
			//string zip="246763";
			document.getElementById('txtfax').disabled=true;
			document.getElementById('txtfax1').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtnoofvts').disabled=true;
			//document.getElementById('txtstatusdate').disabled=false;
			
			document.getElementById('drpcity').disabled=true;
			
			
			//string url="www.4cplus.com";
			document.getElementById('txtbusineedate').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtmryrefno').disabled=true;
			document.getElementById('txtcredit').disabled=true;
			document.getElementById('txtstacno').disabled=true;
			document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabledd);
			//document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabled);
			document.getElementById('txturl').disabled=true;
			document.getElementById('txturl').disabled=true;
			document.getElementById('txtphone2').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			//string paymode=bank;
			
			document.getElementById('btnSave').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			
			
			
			
			document.getElementById('drpregion').disabled=true;
			//drpcity.SelectedItem.Text="--Select City--";
			//drpregion.disabled=false;
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;


//dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 
Agent_master.next(compcode,userid,txtagencycode,fillnext);

if(document.getElementById('hiddenpermission').value=="4")
			{
			document.getElementById('btnModify').disabled=true;
			//document.getElementById('btnQuery').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			if(document.getElementById('hiddenpermission').value=="5")
			{
			document.getElementById('btnModify').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}

return false;


}*/

function  nextclick()
{
//dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 

Agent_master.blankSession();
var y=dsforexecute.Tables[0].Rows.length;
z++;
show1="6";
if(z <= y && z !=-1 )

	{
		if(dsforexecute.Tables[0].Rows.length != z && z >= 0)
		
		{
		 //----------------------------------------------------//
        
          var bktyplen=document.getElementById('bktype').options.length;
         for(var t2=0;t2<bktyplen;t2++)
         {
             document.getElementById('bktype').options[t2].selected=false;
         }
        if(dsforexecute.Tables[0].Rows[z].BOOKING_TYPE !=null && dsforexecute.Tables[0].Rows[z].BOOKING_TYPE !="")
        {
            var bktype=dsforexecute.Tables[0].Rows[z].BOOKING_TYPE;            
           var  len1=bktype.split(",");
            for(var a1=0; a1<len1.length; a1++)
            {
                for(var j=0; j<bktyplen; j++)
                {
                    if(document.getElementById('bktype').options[j].value==len1[a1])
                    {
                       document.getElementById('bktype').options[j].selected = true;
                    }
                }
            }

        }
        
        //----------------------------------------------------------//
		    document.getElementById('txtpincode').value=dsforexecute.Tables[0].Rows[z].pin_code;

		    //dsforexecute.Tables[0].Rows[0].state_name

		    if (dsforexecute.Tables[0].Rows[z].BILL_EMAIL != null) {
		        document.getElementById('drpemail').value = dsforexecute.Tables[0].Rows[z].BILL_EMAIL;
		    }
		    else {
		        document.getElementById('drpemail').value = "";
		    }
		    /////// bill calculation
		    
		     if (dsforexecute.Tables[0].Rows[z].INTEREST_CAL_FLAG != null) {
		        document.getElementById('drpcalc').value = dsforexecute.Tables[0].Rows[z].INTEREST_CAL_FLAG;
		    }
		    else {
		        document.getElementById('drpcalc').value = "";
		    }
		    
		    
		    
		    
			
			 if(dsforexecute.Tables[0].Rows[z].Branch_code != null)
			{
             document.getElementById('drpbranch').value=dsforexecute.Tables[0].Rows[z].Branch_code;
			}
			else
			{
			document.getElementById('drpbranch').value="0";
			}
//dist_code
            if(dsforexecute.Tables[0].Rows[z].DISTRICT!=null && dsforexecute.Tables[0].Rows[z].DISTRICT != "")
			{
			document.getElementById('hiddendistcode').value=dsforexecute.Tables[0].Rows[z].DISTRICT;
			}
			else
			{
			document.getElementById('hiddendistcode').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].STATE!=null && dsforexecute.Tables[0].Rows[z].STATE != "")
			{
			document.getElementById('hiddenstatecode').value=dsforexecute.Tables[0].Rows[z].STATE;
			}
			else
			{
			document.getElementById('hiddenstatecode').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].CODE!=null)
			{
			document.getElementById('txtphone1').value=dsforexecute.Tables[0].Rows[z].CODE;
			}
			else
			{
			document.getElementById('txtphone1').value="";
			}
						
			if(dsforexecute.Tables[0].Rows[z].BILL_FREQUENCY != "" && dsforexecute.Tables[0].Rows[z].BILL_FREQUENCY != null)
			{
             document.getElementById('drpbillf').value=dsforexecute.Tables[0].Rows[z].BILL_FREQUENCY;
			}
			else
			{
			document.getElementById('drpbillf').value="0";
			}
			
			if(dsforexecute.Tables[0].Rows[z].OLD_AGENCY != "" && dsforexecute.Tables[0].Rows[z].OLD_AGENCY != null)
			{
             document.getElementById('txtoldagen').value=dsforexecute.Tables[0].Rows[z].OLD_AGENCY;
			}
			else
			{
			document.getElementById('txtoldagen').value="";
			}
			
	       if(dsforexecute.Tables[0].Rows[z].URL != "" && dsforexecute.Tables[0].Rows[z].URL != null)
			{
			document.getElementById('txturl').value=dsforexecute.Tables[0].Rows[z].URL;
			}
			else
			{
			document.getElementById('txturl').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].CREDIT_TYPE != "" && dsforexecute.Tables[0].Rows[z].CREDIT_TYPE != null)
			{
			document.getElementById('drpcurtyp').value=dsforexecute.Tables[0].Rows[z].CREDIT_TYPE;
			}
			else
			{
			document.getElementById('drpcurtyp').value="0"
			}
			
			if(dsforexecute.Tables[0].Rows[z].Zip != "" && dsforexecute.Tables[0].Rows[z].Zip != null)
			{
	        document.getElementById('mrvregion').value=dsforexecute.Tables[0].Rows[z].Zip;
	        }
	        else
	        {
	        document.getElementById('mrvregion').value="";
	    }


	    if (dsforexecute.Tables[0].Rows[z].BILL_PRINTFLAG != null) {
	        document.getElementById('drpbilflag').value = dsforexecute.Tables[0].Rows[z].BILL_PRINTFLAG;
	    }
	    else {
	        document.getElementById('drpbilflag').value = "0";
	    }
	        
	        if(dsforexecute.Tables[0].Rows[z].SUB_SUB_AG_CODE!=null)
			{
			document.getElementById('txtsubsubagcd').value=dsforexecute.Tables[0].Rows[z].SUB_SUB_AG_CODE;
			}
			else
			{
			document.getElementById('txtsubsubagcd').value="";
			}
			
			document.getElementById('txtagencode').value=dsforexecute.Tables[0].Rows[z].Agency_Code;
		document.getElementById('drprate').value=dsforexecute.Tables[0].Rows[z].Rate_Group;
			document.getElementById('txtagenname').value=dsforexecute.Tables[0].Rows[z].Agency_Name;
			document.getElementById('hiddenagencyname').value=document.getElementById('txtagenname').value;
			document.getElementById('txtsagencycode').value=dsforexecute.Tables[0].Rows[z].SUB_Agency_Code;
			document.getElementById('drpzone').value=dsforexecute.Tables[0].Rows[z].zone_code;
			document.getElementById('drpagecate').value = dsforexecute.Tables[0].Rows[z].Agency_Cat_Code;

			if (dsforexecute.Tables[0].Rows[z].AGENCY_DESIGNATION != null) {
			    document.getElementById('txtdesg').value = dsforexecute.Tables[0].Rows[z].AGENCY_DESIGNATION;
			}
			

			document.getElementById('drpparent').value=dsforexecute.Tables[0].Rows[z].Type;
			if(dsforexecute.Tables[0].Rows[z].Agency_HO!=null)
			{
			document.getElementById('txtagencyho').value=dsforexecute.Tables[0].Rows[z].Agency_HO;
			}
			else
			{
			document.getElementById('txtagencyho').value="";
			}
			//document.getElementById('drpagetyp').value=dsforexecute.Tables[0].Rows[z].Agency_Type_Code;

			addsubcategory(dsforexecute.Tables[0].Rows[z].Agency_Cat_Code);
           //catvar=dsforexecute.Tables[0].Rows[z].Agency_SubCat_Code;
            catvar=dsforexecute.Tables[0].Rows[z].Agency_Cat_Code;
				addcategory(dsforexecute.Tables[0].Rows[z].Agency_Cat_Code);
			document.getElementById('drpagecate').value=dsforexecute.Tables[0].Rows[z].Agency_Cat_Code;
		document.getElementById('drpagetyp').value=dsforexecute.Tables[0].Rows[z].Agency_Type_Code;
			if(dsforexecute.Tables[0].Rows[z].SUB_Agency_HO!=null)
			{
			document.getElementById('txtsugagencyho').value=dsforexecute.Tables[0].Rows[z].SUB_Agency_HO;
			}
			else
			{
			document.getElementById('txtsugagencyho').value="";
			}
			document.getElementById('drprepres').value=dsforexecute.Tables[0].Rows[z].representative_code;

                if(dsforexecute.Tables[0].Rows[z].qbc_userid != "" && dsforexecute.Tables[0].Rows[z].qbc_userid != null)
				{
		        	document.getElementById('drpuserid').value=dsforexecute.Tables[0].Rows[z].qbc_userid;
			    }
			    else
			    {
			        document.getElementById('drpuserid').value="0";
			    }
			
			
			if(dsforexecute.Tables[0].Rows[z].Status_Reason!=null)
			{
			document.getElementById('txtstatus2').value=dsforexecute.Tables[0].Rows[z].Status_Reason;
			}
			else
			{
			document.getElementById('txtstatus2').value="";
			}
			document.getElementById('txtalias').value=dsforexecute.Tables[0].Rows[z].Agency_Alias;

			if(dsforexecute.Tables[0].Rows[z].ALERT!=null)
			{
			document.getElementById('txtalert').value=dsforexecute.Tables[0].Rows[z].ALERT;
			}
			else
			{
			document.getElementById('txtalert').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].Remarks!=null)
			{
			document.getElementById('txtremarks').value=dsforexecute.Tables[0].Rows[z].Remarks;
			}
			else
			{
			document.getElementById('txtremarks').value="";

}


if (dsforexecute.Tables[0].Rows[z].KYC_ATTACH != null) {
    document.getElementById('hidkyc').value = dsforexecute.Tables[0].Rows[z].KYC_ATTACH;

    document.getElementById('attachment1').src = "Images/indexred.jpg";
}
else {
    document.getElementById('hidkyc').value = "";


    document.getElementById('attachment1').src = "Images/index.jpeg"
}
			
			
			
			
			
			  if(dsforexecute.Tables[0].Rows[z].TALUKA!=null)
			{
			document.getElementById('drptaluka').value=dsforexecute.Tables[0].Rows[z].TALUKA;
			}
			else
			{
			document.getElementById('drptaluka').value="0";
			}
			
			if(dsforexecute.Tables[0].Rows[z].Add1!=null)
			{
			document.getElementById('txtadd').value=dsforexecute.Tables[0].Rows[z].Add1;
			}
			else
			{
			document.getElementById('txtadd').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].Add2!=null)
			{
			document.getElementById('txtaddress1').value=dsforexecute.Tables[0].Rows[z].Add2;
			}
			else
			{
			document.getElementById('txtaddress1').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].Add3!=null)
			{
			document.getElementById('txtaddress2').value=dsforexecute.Tables[0].Rows[z].Add3;
			}
			else
			{
			document.getElementById('txtaddress2').value="";
			}
			

document.getElementById('getagsubcode').value=document.getElementById('txtsagencycode').value;
			
			if(dsforexecute.Tables[0].Rows[z].Street!=null)
			{
			document.getElementById('txtstreet').value=dsforexecute.Tables[0].Rows[z].Street;
			}
			else
			{
			document.getElementById('txtstreet').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].Dist_Code!=null)
			{
			document.getElementById('txtdistrict').value=dsforexecute.Tables[0].Rows[z].Dist_Code;
			}
			else
			{
			document.getElementById('txtdistrict').value="";
			}
			document.getElementById('txtcountry').value=dsforexecute.Tables[0].Rows[z].Country_Code;
			cityvar=dsforexecute.Tables[0].Rows[z].City_Code;
				regionvar=dsforexecute.Tables[0].Rows[z].region;
			zonevar=dsforexecute.Tables[0].Rows[z].zone_code;
			talukavar=dsforexecute.Tables[0].Rows[z].TALUKA;
			addcount(dsforexecute.Tables[0].Rows[z].Country_Code);
			if(dsforexecute.Tables[0].Rows[z].Dist_Code!=null)
			{
			document.getElementById('txtdistrict').value=dsforexecute.Tables[0].Rows[z].Dist_Code;
			}
			else
			{
			document.getElementById('txtdistrict').value="";			
			}
			
			if(dsforexecute.Tables[0].Rows[z].State_Code!=null)
		    {
			document.getElementById('txtstate').value=dsforexecute.Tables[0].Rows[z].State_Code;
			}
			else
			{
			document.getElementById('txtstate').value="";
			}
			
//			document.getElementById('drpregion').value=dsforexecute.Tables[0].Rows[z].region;
//			document.getElementById('drpzone').value=dsforexecute.Tables[0].Rows[z].zone_code;
			
			if(dsforexecute.Tables[0].Rows[z].Phone!=null)
			{
			document.getElementById('txtphone2').value=dsforexecute.Tables[0].Rows[z].Phone;
			}
			else
			{
			document.getElementById('txtphone2').value="";
			}
			
			if(dsforexecute.Tables[0].Rows[z].EmailID!=null)
			{
			document.getElementById('txtmail').value=dsforexecute.Tables[0].Rows[z].EmailID;
			}
			else
			{
			document.getElementById('txtmail').value="";

}

if (dsforexecute.Tables[0].Rows[z].EMAILID_CC != null) {
    document.getElementById('txtmailcc').value = dsforexecute.Tables[0].Rows[z].EMAILID_CC;
}
else {
    document.getElementById('txtmailcc').value = "";
}
			if(dsforexecute.Tables[0].Rows[z].Dist_Code !=null)
			{
			    var talukabind = dsforexecute.Tables[0].Rows[z].Dist_Code;
                bindtalu(talukabind);
            }
			if(dsforexecute.Tables[0].Rows[z].TAN_No!=null)
			{
			document.getElementById('txttan').value=dsforexecute.Tables[0].Rows[z].TAN_No;
			}
			else
			{
			document.getElementById('txttan').value="";
			}
			
			if(dsforexecute.Tables[0].Rows[z].PAN_No!=null)
			{
			document.getElementById('txtpan').value=dsforexecute.Tables[0].Rows[z].PAN_No;
			}
			else
			{
			document.getElementById('txtpan').value="";
			}
			
			 if(dsforexecute.Tables[0].Rows[z].VAT ==0 || dsforexecute.Tables[0].Rows[z].VAT =="0" || dsforexecute.Tables[0].Rows[z].VAT =="" || dsforexecute.Tables[0].Rows[z].VAT ==null)
			{
			 document.getElementById("chkvat").checked=false;
			}
			else
			{
			document.getElementById("chkvat").checked=true;

}

if (dsforexecute.Tables[0].Rows[z].BLANKCHEQUE == 0 || dsforexecute.Tables[0].Rows[z].BLANKCHEQUE == "0" || dsforexecute.Tables[0].Rows[z].BLANKCHEQUE == "" || dsforexecute.Tables[0].Rows[z].BLANKCHEQUE == null) {
    document.getElementById("chkcheque").checked = false;
}
else {
    document.getElementById("chkcheque").checked = true;

}
if (dsforexecute.Tables[0].Rows[z].SECURITYBOND == 0 || dsforexecute.Tables[0].Rows[z].SECURITYBOND == "0" || dsforexecute.Tables[0].Rows[z].SECURITYBOND == "" || dsforexecute.Tables[0].Rows[z].SECURITYBOND == null) {
    document.getElementById("chkbondrecvd").checked = false;
}
else {
    document.getElementById("chkbondrecvd").checked = true;

}
if (dsforexecute.Tables[0].Rows[z].KYCAPP == 0 || dsforexecute.Tables[0].Rows[z].KYCAPP == "0" || dsforexecute.Tables[0].Rows[z].KYCAPP == "" || dsforexecute.Tables[0].Rows[z].KYCAPP == null) {
    document.getElementById("chkyc").checked = false;
}
else {
    document.getElementById("chkyc").checked = true;

}
if (dsforexecute.Tables[0].Rows[z].ADDRESSPROOF == 0 || dsforexecute.Tables[0].Rows[z].ADDRESSPROOF == "0" || dsforexecute.Tables[0].Rows[z].ADDRESSPROOF == "" || dsforexecute.Tables[0].Rows[z].ADDRESSPROOF == null) {
    document.getElementById("chkadproof").checked = false;
}
else {
    document.getElementById("chkadproof").checked = true;

}
            if (dsforexecute.Tables[0].Rows[z].RATE_REVISE == 0 || dsforexecute.Tables[0].Rows[z].RATE_REVISE == "0" || dsforexecute.Tables[0].Rows[z].RATE_REVISE == "" || dsforexecute.Tables[0].Rows[z].RATE_REVISE == null) {
                document.getElementById("chkraterevise").checked = false;
            }
            else {
                document.getElementById("chkraterevise").checked = true;
            }
//           if(dsforexecute.Tables[0].Rows[z].TALUKA!=null)
//			{
//			document.getElementById('drptaluka').value=dsforexecute.Tables[0].Rows[z].TALUKA;
//			}
//			else
//			{
//			document.getElementById('drptaluka').value="";
//			}
              //document.getElementById("drptaluka").value=dsforexecute.Tables[0].Rows[z].TALUKA;
			var compcode=document.getElementById('hiddencompcode').value;
            var userid=document.getElementById('hiddenuserid').value;
            Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,call_billto);
             Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,billtodrpcall);

            biltovar=dsforexecute.Tables[0].Rows[z].BILL_TO;
            varbiltocal=dsforexecute.Tables[0].Rows[z].acagency;
			if(dsforexecute.Tables[0].Rows[z].pin_code!=null)
			{
			document.getElementById('txtpincode').value=dsforexecute.Tables[0].Rows[z].pin_code;
			}
			else
			{
			document.getElementById('txtpincode').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].State_Code!=null)
			{
			document.getElementById('txtstate').value=dsforexecute.Tables[0].Rows[z].State_Code;
            }
            else
            {
            	document.getElementById('txtstate').value="";
            }
			if(dsforexecute.Tables[0].Rows[z].Fax!=null)
			{
			document.getElementById('txtfax').value=dsforexecute.Tables[0].Rows[z].Fax;
			}
			else
			{
			document.getElementById('txtfax').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].fax1!=null)
			{
			document.getElementById('txtfax1').value=dsforexecute.Tables[0].Rows[z].fax1;
			}
			else
			{
			document.getElementById('txtfax1').value="";
			}
			var dateformat=document.getElementById('hiddendateformat').value;
			
			if(dsforexecute.Tables[0].Rows[z].Enroll_Date != null && dsforexecute.Tables[0].Rows[z].Enroll_Date != "")
			{
			var enrolldate=dsforexecute.Tables[0].Rows[z].Enroll_Date;
			var dd=enrolldate.getDate();
			var mm=enrolldate.getMonth() + 1;
			var yyyy=enrolldate.getFullYear();
			
			var enrolldate1=mm+'/'+dd+'/'+yyyy;
			var enrolldate1day=dd+'/'+mm+'/'+yyyy;
			var enrollyear=yyyy+'/'+mm+'/'+dd;
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtenrolldate').value=enrolldate1;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtenrolldate').value=enrollyear;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtenrolldate').value=enrolldate1day;
			}
			if(dateformat==null || dateformat=="")
			{
			document.getElementById('txtenrolldate').value=enrolldate1;
			}
			
			}
			else
			{
			
			document.getElementById('txtenrolldate').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].No_of_VTS!=null)
			{
			document.getElementById('txtnoofvts').value=dsforexecute.Tables[0].Rows[z].No_of_VTS;
			}
			else
			{
			document.getElementById('txtnoofvts').value="";
			}
			//document.getElementById('drpcity').value=dsforexecute.Tables[0].Rows[z].City_Code;
			
			if(dsforexecute.Tables[0].Rows[z].region!=null)
			{
			document.getElementById('drpregion').value=dsforexecute.Tables[0].Rows[z].region;
			}
			else
			{
			document.getElementById('drpregion').value="";
			}
			//document.getElementById('drpregion').value="991";
			if(dsforexecute.Tables[0].Rows[z].CREDIT_LIMIT!=null)
			{
			document.getElementById('txtcrlimit').value=dsforexecute.Tables[0].Rows[z].CREDIT_LIMIT;
			}
			else
			{
			document.getElementById('txtcrlimit').value="";
			}
			if (dsforexecute.Tables[0].Rows[z].EDTN_WISE_BILL_REQ != null) {
			    document.getElementById('drpEdition_wise_Billing').value = dsforexecute.Tables[0].Rows[z].EDTN_WISE_BILL_REQ;
			}
			else {
			    document.getElementById('drpEdition_wise_Billing').value = "N";
			}

			if (dsforexecute.Tables[0].Rows[z].GST_REGISTRATION != null) {
			    document.getElementById('drpgstus').value = dsforexecute.Tables[0].Rows[z].GST_REGISTRATION;
			}
			else {
			    document.getElementById('drpgstus').value = "";
			}
			if (dsforexecute.Tables[0].Rows[z].GST_REGISTRATION_DATE != null) {
			    document.getElementById('txtgstdt').value = dsforexecute.Tables[0].Rows[z].GST_REGISTRATION_DATE;
			}
			else {
			    document.getElementById('txtgstdt').value = "";
			}
			if (dsforexecute.Tables[0].Rows[z].GSTIN != null) {
			    document.getElementById('txtgstin').value = dsforexecute.Tables[0].Rows[z].GSTIN;
			}
			else {
			    document.getElementById('txtgstin').value = "";
			}

			if (dsforexecute.Tables[0].Rows[z].GST_STATUS != null) {
			    document.getElementById('drpgstatus').value = dsforexecute.Tables[0].Rows[z].GST_STATUS;
			}
			else {
			    document.getElementById('drpgstatus').value = "";
			}

			if (dsforexecute.Tables[0].Rows[z].GST_CLIENT_TYPE_CD != null) {
			    document.getElementById('txtgstclty').value = dsforexecute.Tables[0].Rows[z].GST_CLIENT_TYPE_CD;
			}
			else {
			    document.getElementById('txtgstclty').value = "";
			}

			if (dsforexecute.Tables[0].Rows[z].GST_ARN_NO != null) {
			    document.getElementById('txtarno').value = dsforexecute.Tables[0].Rows[z].GST_ARN_NO;
			}
			else {
			    document.getElementById('txtarno').value = "";
			}

			if (dsforexecute.Tables[0].Rows[z].GST_PROVISINAL_ID != null) {
			    document.getElementById('txtgstprovid').value = dsforexecute.Tables[0].Rows[z].GST_PROVISINAL_ID;
			}
			else {
			    document.getElementById('txtgstprovid').value = "";
			}

            var todate=dsforexecute.Tables[0].Rows[z].to_date;
			var from_date=dsforexecute.Tables[0].Rows[z].FROM_DARE;
			
			var currdate=dsforexecute.Tables[0].Rows[z].current_Datetime;
			var tdate=new Date(todate);
			var cdate=new Date(currdate);
			
			var dd=currdate.getDate();
			var mm=currdate.getMonth() + 1;
			var yyyy=currdate.getFullYear();
			
			var currdate1=mm+'/'+dd+'/'+yyyy;
			var currda=dd+'/'+mm+'/'+yyyy;
			var curryear=yyyy+'/'+mm+'/'+dd;

		var cur=new Date();
		
		if((dsforexecute.Tables[0].Rows[z].status_name!=null)||(dsforexecute.Tables[0].Rows[z].status_name!=""))
		{
		    if(cur>=from_date && cur<=todate)
		    {
			    document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[z].status_name;
			}
			else
			{
			    document.getElementById('txtstatus').value="Active";
			}
			
		}
		else
		{
		    document.getElementById('txtstatus').value="Active";
		}
		
		if(dsforexecute.Tables[0].Rows[z].from_date=="" || dsforexecute.Tables[0].Rows[z].from_date==null || dsforexecute.Tables[0].Rows[z].to_date=="" || dsforexecute.Tables[0].Rows[z].to_date==null)
		{
		    document.getElementById('txtstatus').value="Active";
		}
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtstatusdate').value=currdate1;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtstatusdate').value=currda;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtstatusdate').value=curryear;
			}
			if(dateformat==null || dateformat=="" || dateformat=="undefined")
			{
			document.getElementById('txtstatusdate').value=currdate1;
			}
			
			if(dsforexecute.Tables[0].Rows[z].Buss_Start_Date != null && dsforexecute.Tables[0].Rows[z].Buss_Start_Date != "")
			{
			var bussdate=dsforexecute.Tables[0].Rows[z].Buss_Start_Date;
			var dd=bussdate.getDate();
			var mm=bussdate.getMonth() + 1;
			var yyyy=bussdate.getFullYear();
			
			var bussdate1=mm+'/'+dd+'/'+yyyy;
			var bussdate1day=dd+'/'+mm+'/'+yyyy;
			var bussyear=yyyy+'/'+mm+'/'+dd;
			
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtbusineedate').value=bussdate1;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtbusineedate').value=bussyear;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtbusineedate').value=bussdate1day;
			
			
			}
			if(dateformat==null || dateformat=="")
			{
			document.getElementById('txtbusineedate').value=bussdate1;
			}
			}
			else
			{
			
			//document.getElementById('txtbusineedate').value=dsforexecute.Tables[0].Rows[z].Buss_Start_Date;
			document.getElementById('txtbusineedate').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].MRV_Ref_No!=null)
			{
			document.getElementById('txtmryrefno').value=dsforexecute.Tables[0].Rows[z].MRV_Ref_No;
			}
			else
			{
			document.getElementById('txtmryrefno').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].Credit_Days!=null)
			{
			document.getElementById('txtcredit').value=dsforexecute.Tables[0].Rows[z].Credit_Days;
			}
			else
			{
			document.getElementById('txtcredit').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].ST_ACC_No!=null)
			{
			document.getElementById('txtstacno').value=dsforexecute.Tables[0].Rows[z].ST_ACC_No;
			}
			else
			{
			document.getElementById('txtstacno').value="";
			}
			
			if(dsforexecute.Tables[0].Rows[z].DEPOCODE!=null)
			{
			    document.getElementById('txtdepocode').value=dsforexecute.Tables[0].Rows[z].DEPOCODE;
            }
            else
            {
                document.getElementById('txtdepocode').value="";
            }
			
			document.getElementById('drpagecate').disabled=true;
			
			document.getElementById('txtagencode').disabled=true;
			
			
			document.getElementById('txtsagencycode').disabled=true;
			
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('bktype').disabled=true;
			
			
			document.getElementById('drpagescat').disabled=true;
			
			
			document.getElementById('drpagecate').disabled=true;
			
			document.getElementById('txtagencode').disabled=true;
			
			
			document.getElementById('txtsagencycode').disabled=true;
			
			document.getElementById('txtagenname').disabled=true;
			
			
			document.getElementById('drpagescat').disabled=true;
			
			
			document.getElementById('txtstatus2').disabled=true;
			
			document.getElementById('txtalias').disabled=true;
			
			
			document.getElementById('mrvregion').disabled=true;
			
			
			
			document.getElementById('drpregion').disabled=true;
			
			
			
			document.getElementById('txtphone1').disabled=true;
			
			
			//txtagname.ReadOnly=false;
			
			document.getElementById('txtalert').disabled=true;

			document.getElementById('txtremarks').disabled = true;

			document.getElementById('attachment1').disabled = true;
		
			document.getElementById('txtagenname').disabled=true;
			
			
			//******************Pankaj
			document.getElementById('txtadd').disabled=true;
			document.getElementById('txtaddress1').disabled=true;
			document.getElementById('txtaddress2').disabled=true;
			
			
			document.getElementById('txtstreet').disabled=true;
			
			document.getElementById('txtdistrict').disabled=true;
			
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;

			document.getElementById('txtmail').disabled = true;

			document.getElementById('txtmailcc').disabled = true;
			document.getElementById('drpcurtyp').disabled=true;
			document.getElementById('txttan').disabled=true;
			document.getElementById('txtpan').disabled=true;
			
			document.getElementById('drprepres').disabled=true;
			//drpstatus.disabled=true;
			document.getElementById('txtbill').disabled=true;
			
			document.getElementById('drpagetyp').disabled=true;
			//drpsageo.disabled=true;
			document.getElementById('txtpincode').disabled=true;
			document.getElementById('txtstate').disabled=true;
			//string zip="246763";
			document.getElementById('txtfax').disabled=true;
			document.getElementById('txtfax1').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtnoofvts').disabled=true;
			//document.getElementById('txtstatusdate').disabled=false;
			
			document.getElementById('drpcity').disabled=true;
			
			
			document.getElementById('txtbusineedate').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtmryrefno').disabled=true;
			document.getElementById('txtcredit').disabled=true;
			document.getElementById('txtstacno').disabled=true;
			document.getElementById('txtsagencycode').disabled=true;
			document.getElementById('chkvat').disabled = true;
			document.getElementById('chkcheque').disabled = true;
			document.getElementById('chkbondrecvd').disabled = true;
			document.getElementById('chkyc').disabled = true;
			document.getElementById('chkadproof').disabled = true;
			document.getElementById('chkraterevise').disabled = true;
			//alert(document.getElementById('txtsagencycode').disabledd);
			//document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabled);
			document.getElementById('txturl').disabled=true;
			document.getElementById('txturl').disabled=true;
			document.getElementById('txtphone2').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			//string paymode=bank;
			
			document.getElementById('btnSave').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			
			
			
			
			document.getElementById('drpregion').disabled=true;
			//drpcity.SelectedItem.Text="--Select City--";
			//drpregion.disabled=false;
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			document.getElementById('drpbranch').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('drpagetyp').disabled=true;
			document.getElementById('drpcity').disabled=true;
			document.getElementById('txtstatus').disabled=true;
			document.getElementById('txtstatusdate').disabled=true;
			document.getElementById('drpbillf').disabled=true;
			
			document.getElementById('btnModify').disabled=false;
			document.getElementById('btnQuery').disabled=false;
			document.getElementById('btnfirst').disabled=false;
			document.getElementById('btnprevious').disabled=false;
			document.getElementById('btnnext').disabled=false;
			document.getElementById('btnlast').disabled=false;
			document.getElementById('btnCancel').disabled=false;
			document.getElementById('btnNew').disabled=true;
			document.getElementById('btnSave').disabled=true;
			document.getElementById('btnExecute').disabled=true;
			
			if(document.getElementById('hiddenpermission').value=="4")
			{
			document.getElementById('btnModify').disabled=true;
			//document.getElementById('btnQuery').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			if(document.getElementById('hiddenpermission').value=="5")
			{
			document.getElementById('btnModify').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			
			if(document.getElementById('hiddenpermission').value=="1")
			{
				document.getElementById('btnModify').disabled=true;
			    document.getElementById('btnDelete').disabled=true;
			}
			
			
			
		
		}
		else
		{
		//z=0;
		//z=z+1;
		    document.getElementById('btnnext').disabled=true;
			document.getElementById('btnlast').disabled=true;
			document.getElementById('btnfirst').disabled=false;
			document.getElementById('btnprevious').disabled=false;
			setButtonImages();
			return false;
		
		}
	}
	else
	{
	document.getElementById('btnnext').disabled=true;
			document.getElementById('btnlast').disabled=true;
			document.getElementById('btnfirst').disabled=false;
			document.getElementById('btnprevious').disabled=false;
			setButtonImages();
			
			return false;
	}
	if(z==y-1)
	{
	        document.getElementById('btnnext').disabled=true;
			document.getElementById('btnlast').disabled=true;
			document.getElementById('btnfirst').disabled=false;
			document.getElementById('btnprevious').disabled=false;
			setButtonImages();			
			return false;
	
	}
	
	        if(document.getElementById('hiddenpermission').value=="4")
			{
			document.getElementById('btnModify').disabled=true;
			//document.getElementById('btnQuery').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			if(document.getElementById('hiddenpermission').value=="5")
			{
			document.getElementById('btnModify').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			setButtonImages();
			return false;
	

}
/*
function previousclick()

{
document.getElementById('txtstatus').style.visibility="visible";
			document.getElementById('txtstatusdate').style.visibility="visible";
			document.getElementById('Status').style.visibility="visible";
			document.getElementById('StatusDate').style.visibility="visible";


var compcode=document.getElementById('hiddencompcode').value;
var userid=document.getElementById('hiddenuserid').value;
var txtagencycode=document.getElementById('txtagencode').value;


//dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 
Agent_master.previous(compcode,userid,txtagencycode,fillprevious);
return false;


}*/

function previousclick()
{
//dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 

Agent_master.blankSession();
z=z-1;

var y=dsforexecute.Tables[0].Rows.length;
if(z > y)
{
document.getElementById('btnnext').disabled=false;
			document.getElementById('btnlast').disabled=false;
			document.getElementById('btnfirst').disabled=true;
			document.getElementById('btnprevious').disabled=true;
			return false;

}



if(z != -1 && z >= 0 )
	{
		if(dsforexecute.Tables[0].Rows.length != z)
	     {
	              //----------------------------------------------------//
                
                  var bktyplen=document.getElementById('bktype').options.length;
                 for(var t2=0;t2<bktyplen;t2++)
                 {
                     document.getElementById('bktype').options[t2].selected=false;
                 }
                if(dsforexecute.Tables[0].Rows[z].BOOKING_TYPE !=null && dsforexecute.Tables[0].Rows[z].BOOKING_TYPE !="")
                {
                    var bktype=dsforexecute.Tables[0].Rows[z].BOOKING_TYPE;            
                   var  len1=bktype.split(",");
                    for(var a1=0; a1<len1.length; a1++)
                    {
                        for(var j=0; j<bktyplen; j++)
                        {
                            if(document.getElementById('bktype').options[j].value==len1[a1])
                            {
                               document.getElementById('bktype').options[j].selected = true;
                            }
                        }
                    }

                }

                //----------------------------------------------------------//

                if (dsforexecute.Tables[0].Rows[z].BILL_EMAIL != null) {
                    document.getElementById('drpemail').value = dsforexecute.Tables[0].Rows[z].BILL_EMAIL;
                }
                else {
                    document.getElementById('drpemail').value = "";
                }
                
                  if (dsforexecute.Tables[0].Rows[z].INTEREST_CAL_FLAG != null) {
                    document.getElementById('drpcalc').value = dsforexecute.Tables[0].Rows[z].INTEREST_CAL_FLAG;
                }
                else {
                    document.getElementById('drpcalc').value = "";
                }
                
                
                
                
                
	            if(dsforexecute.Tables[0].Rows[z].Branch_code != null)
			    {
                 document.getElementById('drpbranch').value=dsforexecute.Tables[0].Rows[z].Branch_code;
			    }
			    else
			    {
			    document.getElementById('drpbranch').value="0";
			    }
			    
				if(dsforexecute.Tables[0].Rows[z].pin_code!=null)
				{
				document.getElementById('txtpincode').value=dsforexecute.Tables[0].Rows[z].pin_code;
				}
				else
				{
				document.getElementById('txtpincode').value="";
				}
//Dist_code
                if(dsforexecute.Tables[0].Rows[z].DISTRICT!=null && dsforexecute.Tables[0].Rows[z].DISTRICT != "")
		        {
		        document.getElementById('hiddendistcode').value=dsforexecute.Tables[0].Rows[z].DISTRICT;
		        }
		        else
		        {
		        document.getElementById('hiddendistcode').value="";
		        }
		        if(dsforexecute.Tables[0].Rows[z].STATE!=null && dsforexecute.Tables[0].Rows[z].STATE != "")
		        {
		        document.getElementById('hiddenstatecode').value=dsforexecute.Tables[0].Rows[z].STATE;
		        }
		        else
		        {
		        document.getElementById('hiddenstatecode').value="";
		        }
				if(dsforexecute.Tables[0].Rows[z].BILL_FREQUENCY != "" && dsforexecute.Tables[0].Rows[z].BILL_FREQUENCY != null)
			    {
                 document.getElementById('drpbillf').value=dsforexecute.Tables[0].Rows[z].BILL_FREQUENCY;
			    }
			    else
			    {
			    document.getElementById('drpbillf').value="0";
			    }
			    
			    if(dsforexecute.Tables[0].Rows[z].OLD_AGENCY != "" && dsforexecute.Tables[0].Rows[z].OLD_AGENCY != null)
			    {
                 document.getElementById('txtoldagen').value=dsforexecute.Tables[0].Rows[z].OLD_AGENCY;
			    }
			    else
			    {
			    document.getElementById('txtoldagen').value="";
			    }
			
			dsforexecute.Tables[0].Rows[0].state_name
			
			if(dsforexecute.Tables[0].Rows[z].CODE!=null)
			{
			document.getElementById('txtphone1').value=dsforexecute.Tables[0].Rows[z].CODE;
			}
			else
			{
			document.getElementById('txtphone1').value="";
			}
			
			
	        if(dsforexecute.Tables[0].Rows[z].URL != "" && dsforexecute.Tables[0].Rows[z].URL != null)
			{
			document.getElementById('txturl').value=dsforexecute.Tables[0].Rows[0].URL;
			}
			else
			{
			document.getElementById('txturl').value="";
			}
			
			if(dsforexecute.Tables[0].Rows[z].CREDIT_TYPE != "" && dsforexecute.Tables[0].Rows[z].CREDIT_TYPE != null)
			{
			document.getElementById('drpcurtyp').value=dsforexecute.Tables[0].Rows[z].CREDIT_TYPE;
			}
			else
			{
			document.getElementById('drpcurtyp').value="0"
			}
			
			
			
			if(dsforexecute.Tables[0].Rows[z].Zip != "" && dsforexecute.Tables[0].Rows[z].Zip != null)
			{
	        document.getElementById('mrvregion').value=dsforexecute.Tables[0].Rows[z].Zip;
	        }
	        else
	        {
	        document.getElementById('mrvregion').value="";
	        }
				
			
			if(dsforexecute.Tables[0].Rows[z].DEPOCODE!=null)
			{
			    document.getElementById('txtdepocode').value=dsforexecute.Tables[0].Rows[z].DEPOCODE;
            }
            else
            {
                document.getElementById('txtdepocode').value="";
            }

			  if(dsforexecute.Tables[0].Rows[z].TALUKA!=null)
			{
			document.getElementById('drptaluka').value=dsforexecute.Tables[0].Rows[z].TALUKA;
			}
			else
			{
			document.getElementById('drptaluka').value="0";

}

if (dsforexecute.Tables[0].Rows[z].BILL_PRINTFLAG != null) {
    document.getElementById('drpbilflag').value = dsforexecute.Tables[0].Rows[z].BILL_PRINTFLAG;
}
else {
    document.getElementById('drpbilflag').value = "0";
}
			
	if(dsforexecute.Tables[0].Rows[z].SUB_SUB_AG_CODE!=null)
			{
			document.getElementById('txtsubsubagcd').value=dsforexecute.Tables[0].Rows[z].SUB_SUB_AG_CODE;
			}
			else
			{
			document.getElementById('txtsubsubagcd').value="";
			}
			
			document.getElementById('txtagencode').value=dsforexecute.Tables[0].Rows[z].Agency_Code;
		document.getElementById('drprate').value=dsforexecute.Tables[0].Rows[z].Rate_Group;
			document.getElementById('txtagenname').value=dsforexecute.Tables[0].Rows[z].Agency_Name;
			document.getElementById('hiddenagencyname').value=document.getElementById('txtagenname').value;
			document.getElementById('txtsagencycode').value=dsforexecute.Tables[0].Rows[z].SUB_Agency_Code;
			document.getElementById('drpzone').value=dsforexecute.Tables[0].Rows[z].zone_code;
			document.getElementById('drpagecate').value = dsforexecute.Tables[0].Rows[z].Agency_Cat_Code;

			if (dsforexecute.Tables[0].Rows[z].AGENCY_DESIGNATION != null) {
			    document.getElementById('txtdesg').value = dsforexecute.Tables[0].Rows[z].AGENCY_DESIGNATION;
			}
			//drpregion.SelectedValue="0";
			
			//document.getElementById('txtcrlimit').value=dsforexecute.Tables[0].Rows[z].Agency_Cat_Code;
			if(dsforexecute.Tables[0].Rows[z].Agency_HO!=null)
			{
			document.getElementById('txtagencyho').value=dsforexecute.Tables[0].Rows[z].Agency_HO;
			}
			else
			{
			document.getElementById('txtagencyho').value="";
			}
			document.getElementById('drpagetyp').value=dsforexecute.Tables[0].Rows[z].Agency_Type_Code;
			document.getElementById('drpparent').value=dsforexecute.Tables[0].Rows[z].Type;
				if(dsforexecute.Tables[0].Rows[z].qbc_userid != "" && dsforexecute.Tables[0].Rows[z].qbc_userid != null)
				{
		        	document.getElementById('drpuserid').value=dsforexecute.Tables[0].Rows[z].qbc_userid;
			    }
			    else
			    {
			        document.getElementById('drpuserid').value="0";
			    }
			//document.getElementById('drpagescat').value=dsforexecute.Tables[0].Rows[z].Agency_SubCat_Code;
			//drpregion.SelectedValue="0";
			
//			addcategory(dsforexecute.Tables[0].Rows[z].Agency_Type_Code);
//			catvar=dsforexecute.Tables[0].Rows[z].Agency_Cat_Code;
			addsubcategory(dsforexecute.Tables[0].Rows[z].Agency_Cat_Code);
           //catvar=dsforexecute.Tables[0].Rows[z].Agency_SubCat_Code;
            catvar=dsforexecute.Tables[0].Rows[z].Agency_Cat_Code;
              addcategory(dsforexecute.Tables[0].Rows[z].Agency_Cat_Code);
          document.getElementById('drpagecate').value=dsforexecute.Tables[0].Rows[z].Agency_Cat_Code;
		document.getElementById('drpagetyp').value=dsforexecute.Tables[0].Rows[z].Agency_Type_Code;
			if(dsforexecute.Tables[0].Rows[z].SUB_Agency_HO!=null)
			{
			document.getElementById('txtsugagencyho').value=dsforexecute.Tables[0].Rows[z].SUB_Agency_HO;
			}
			else
			{
			document.getElementById('txtsugagencyho').value="";
			}
			document.getElementById('drprepres').value=dsforexecute.Tables[0].Rows[z].representative_code;
			//drpcity.SelectedValue="0";
			
			


			
			
			if(dsforexecute.Tables[0].Rows[z].Status_Reason!=null)
			{
			document.getElementById('txtstatus2').value=dsforexecute.Tables[0].Rows[z].Status_Reason;
			}
			else
			{
				document.getElementById('txtstatus2').value="";
			}
			document.getElementById('txtalias').value=dsforexecute.Tables[0].Rows[z].Agency_Alias;
			//txtagname.Text="";
			if(dsforexecute.Tables[0].Rows[z].ALERT!=null)
			{
			document.getElementById('txtalert').value=dsforexecute.Tables[0].Rows[z].ALERT;
			}
			else
			{
			document.getElementById('txtalert').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].Remarks!=null)
			{
			document.getElementById('txtremarks').value=dsforexecute.Tables[0].Rows[z].Remarks;
			}
			else
			{
			document.getElementById('txtremarks').value="";

}



if (dsforexecute.Tables[0].Rows[z].KYC_ATTACH != null) {
    document.getElementById('hidkyc').value = dsforexecute.Tables[0].Rows[z].KYC_ATTACH;

    document.getElementById('attachment1').src = "Images/indexred.jpg";
}
else {
    document.getElementById('hidkyc').value = "";
    document.getElementById('attachment1').src = "Images/index.jpeg"
}
			
				if(dsforexecute.Tables[0].Rows[z].Add1!=null)
			{
			document.getElementById('txtadd').value=dsforexecute.Tables[0].Rows[z].Add1;
			}
			else
			{
			document.getElementById('txtadd').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].Add2!=null)
			{
			document.getElementById('txtaddress1').value=dsforexecute.Tables[0].Rows[z].Add2;
			}
			else
			{
			document.getElementById('txtaddress1').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].Add3!=null)
			{
			document.getElementById('txtaddress2').value=dsforexecute.Tables[0].Rows[z].Add3;
			}
			else
			{
			document.getElementById('txtaddress2').value="";
			}

		
			if (dsforexecute.Tables[0].Rows[z].GST_REGISTRATION != null) {
			    document.getElementById('drpgstus').value = dsforexecute.Tables[0].Rows[z].GST_REGISTRATION;
			}
			else {
			    document.getElementById('drpgstus').value = "";
			}
			if (dsforexecute.Tables[0].Rows[z].GST_REGISTRATION_DATE != null) {
			    document.getElementById('txtgstdt').value = dsforexecute.Tables[0].Rows[z].GST_REGISTRATION_DATE;
			}
			else {
			    document.getElementById('txtgstdt').value = "";
			}
			if (dsforexecute.Tables[0].Rows[z].GSTIN != null) {
			    document.getElementById('txtgstin').value = dsforexecute.Tables[0].Rows[z].GSTIN;
			}
			else {
			    document.getElementById('txtgstin').value = "";
			}

			if (dsforexecute.Tables[0].Rows[z].GST_STATUS != null) {
			    document.getElementById('drpgstatus').value = dsforexecute.Tables[0].Rows[z].GST_STATUS;
			}
			else {
			    document.getElementById('drpgstatus').value = "";
			}

			if (dsforexecute.Tables[0].Rows[z].GST_CLIENT_TYPE_CD != null) {
			    document.getElementById('txtgstclty').value = dsforexecute.Tables[0].Rows[z].GST_CLIENT_TYPE_CD;
			}
			else {
			    document.getElementById('txtgstclty').value = "";
			}

			if (dsforexecute.Tables[0].Rows[z].GST_ARN_NO != null) {
			    document.getElementById('txtarno').value = dsforexecute.Tables[0].Rows[z].GST_ARN_NO;
			}
			else {
			    document.getElementById('txtarno').value = "";
			}

			if (dsforexecute.Tables[0].Rows[z].GST_PROVISINAL_ID != null) {
			    document.getElementById('txtgstprovid').value = dsforexecute.Tables[0].Rows[z].GST_PROVISINAL_ID;
			}
			else {
			    document.getElementById('txtgstprovid').value = "";
			}


			//***********************
			if(dsforexecute.Tables[0].Rows[z].Street!=null)
			{
			document.getElementById('txtstreet').value=dsforexecute.Tables[0].Rows[z].Street;
			}
			else
			{
			document.getElementById('txtstreet').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].Dist_Code!=null)
			{
			document.getElementById('txtdistrict').value=dsforexecute.Tables[0].Rows[z].Dist_Code;
			}
			else
			{
			document.getElementById('txtdistrict').value="";
			}
			
			document.getElementById('txtcountry').value=dsforexecute.Tables[0].Rows[z].Country_Code;
			cityvar=dsforexecute.Tables[0].Rows[z].City_Code;
				regionvar=dsforexecute.Tables[0].Rows[z].region;
			zonevar=dsforexecute.Tables[0].Rows[z].zone_code;
			talukavar=dsforexecute.Tables[0].Rows[z].TALUKA;
			addcount(dsforexecute.Tables[0].Rows[z].Country_Code);
			
				if(dsforexecute.Tables[0].Rows[z].Dist_Code!=null)
			{
			document.getElementById('txtdistrict').value=dsforexecute.Tables[0].Rows[z].Dist_Code;
			}
			else
			{
			document.getElementById('txtdistrict').value="";			
			}
			
			if(dsforexecute.Tables[0].Rows[z].State_Code!=null)
		    {
			document.getElementById('txtstate').value=dsforexecute.Tables[0].Rows[z].State_Code;
			}
			else
			{
			document.getElementById('txtstate').value="";
			}
			
//////			document.getElementById('drpregion').value=dsforexecute.Tables[0].Rows[z].region;
//////			document.getElementById('drpzone').value=dsforexecute.Tables[0].Rows[z].zone_code;
			
			if(dsforexecute.Tables[0].Rows[z].Phone!=null)
			{
			document.getElementById('txtphone2').value=dsforexecute.Tables[0].Rows[z].Phone;
			}
			else
			{
			document.getElementById('txtphone2').value="";
			}
			//document.getElementById('getagcode').value=document.getElementById('txtagencode').value;
            document.getElementById('getagsubcode').value=document.getElementById('txtsagencycode').value;
            show1="6";
			if(dsforexecute.Tables[0].Rows[z].Dist_Code !=null)
			{
			   var talukabind = dsforexecute.Tables[0].Rows[z].Dist_Code;
               bindtalu(talukabind);
            }
 
			if(dsforexecute.Tables[0].Rows[z].EmailID!=null)
			{
			document.getElementById('txtmail').value=dsforexecute.Tables[0].Rows[z].EmailID;
			}
			else
			{
			document.getElementById('txtmail').value="";

}

if (dsforexecute.Tables[0].Rows[z].EMAILID_CC != null) {
    document.getElementById('txtmailcc').value = dsforexecute.Tables[0].Rows[z].EMAILID_CC;
}
else {
    document.getElementById('txtmailcc').value = "";
}

			if(dsforexecute.Tables[0].Rows[z].TAN_No!=null)
			{
			document.getElementById('txttan').value=dsforexecute.Tables[0].Rows[z].TAN_No;
			}
			else
			{
				document.getElementById('txttan').value="";
			}
			
//			if(dsforexecute.Tables[0].Rows[z].TALUKA!=null)
//			{
//			document.getElementById('drptaluka').value=dsforexecute.Tables[0].Rows[z].TALUKA;
//			}
//			else
//			{
//			document.getElementById('drptaluka').value="";
//			}
			if(dsforexecute.Tables[0].Rows[z].PAN_No!=null)
			{
				document.getElementById('txtpan').value=dsforexecute.Tables[0].Rows[z].PAN_No;
				}
				else
				{
				document.getElementById('txtpan').value="";
				}
				
	        if(dsforexecute.Tables[0].Rows[z].VAT ==0 || dsforexecute.Tables[0].Rows[z].VAT =="0" || dsforexecute.Tables[0].Rows[z].VAT =="" || dsforexecute.Tables[0].Rows[z].VAT ==null)
			{
			 document.getElementById("chkvat").checked=false;
			}
			else
			{
			document.getElementById("chkvat").checked=true;

}

if (dsforexecute.Tables[0].Rows[z].BLANKCHEQUE == 0 || dsforexecute.Tables[0].Rows[z].BLANKCHEQUE == "0" || dsforexecute.Tables[0].Rows[z].BLANKCHEQUE == "" || dsforexecute.Tables[0].Rows[z].BLANKCHEQUE == null) {
    document.getElementById("chkcheque").checked = false;
}
else {
    document.getElementById("chkcheque").checked = true;

}
if (dsforexecute.Tables[0].Rows[z].SECURITYBOND == 0 || dsforexecute.Tables[0].Rows[z].SECURITYBOND == "0" || dsforexecute.Tables[0].Rows[z].SECURITYBOND == "" || dsforexecute.Tables[0].Rows[z].SECURITYBOND == null) {
    document.getElementById("chkbondrecvd").checked = false;
}
else {
    document.getElementById("chkbondrecvd").checked = true;

}
if (dsforexecute.Tables[0].Rows[z].KYCAPP == 0 || dsforexecute.Tables[0].Rows[z].KYCAPP == "0" || dsforexecute.Tables[0].Rows[z].KYCAPP == "" || dsforexecute.Tables[0].Rows[z].KYCAPP == null) {
    document.getElementById("chkyc").checked = false;
}
else {
    document.getElementById("chkyc").checked = true;

}
if (dsforexecute.Tables[0].Rows[z].ADDRESSPROOF == 0 || dsforexecute.Tables[0].Rows[z].ADDRESSPROOF == "0" || dsforexecute.Tables[0].Rows[z].ADDRESSPROOF == "" || dsforexecute.Tables[0].Rows[z].ADDRESSPROOF == null) {
    document.getElementById("chkadproof").checked = false;
}
else {
    document.getElementById("chkadproof").checked = true;

}
            if (dsforexecute.Tables[0].Rows[z].RATE_REVISE == 0 || dsforexecute.Tables[0].Rows[z].RATE_REVISE == "0" || dsforexecute.Tables[0].Rows[z].RATE_REVISE == "" || dsforexecute.Tables[0].Rows[z].RATE_REVISE == null) {
                document.getElementById("chkraterevise").checked = false;
            }
            else {
                document.getElementById("chkraterevise").checked = true;
            }
			//			drprepres.disabled=true;
			//			drpstatus.disabled=true;
			var compcode=document.getElementById('hiddencompcode').value;
            var userid=document.getElementById('hiddenuserid').value;
            Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,call_billto);
             Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,billtodrpcall);
           //document.getElementById('txtbill').value=dsforexecute.Tables[0].Rows[z].BILL_TO;
            biltovar=dsforexecute.Tables[0].Rows[z].BILL_TO;
            varbiltocal=dsforexecute.Tables[0].Rows[z].acagency;
//			document.getElementById('txtbill').value=dsforexecute.Tables[0].Rows[z].BILL_TO;
//			document.getElementById('txtbill').value=dsforexecute.Tables[0].Rows[z].BILL_TO;
			
			//			drpsageo.disabled=true;
			if(dsforexecute.Tables[0].Rows[z].pin_code!=null)
			{
			document.getElementById('txtpincode').value=dsforexecute.Tables[0].Rows[z].pin_code;
			}
			else
			{
			document.getElementById('txtpincode').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].State_Code!=null)
			{
			document.getElementById('txtstate').value=dsforexecute.Tables[0].Rows[z].State_Code;
			}
			else
			{
			document.getElementById('txtstate').value="";
			}
			//string zip="246763";
			
			if(dsforexecute.Tables[0].Rows[z].Fax!=null)
			{
			document.getElementById('txtfax').value=dsforexecute.Tables[0].Rows[z].Fax;
			}
			else
			{
				document.getElementById('txtfax').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].fax1!=null)
			{
			document.getElementById('txtfax1').value=dsforexecute.Tables[0].Rows[z].fax1;
			}
			else
			{
			document.getElementById('txtfax1').value="";
			}
			var dateformat=document.getElementById('hiddendateformat').value;
			 datemonth=document.getElementById('hiddendateformat').value;
			
			if(dsforexecute.Tables[0].Rows[z].Enroll_Date != null && dsforexecute.Tables[0].Rows[z].Enroll_Date != "")
			{
			var enrolldate=dsforexecute.Tables[0].Rows[z].Enroll_Date;
			var dd=enrolldate.getDate();
			var mm=enrolldate.getMonth() + 1;
			var yyyy=enrolldate.getFullYear();
			
			var enrolldate1=mm+'/'+dd+'/'+yyyy;
			var enrolldate1day=dd+'/'+mm+'/'+yyyy;
			var enrollyear=yyyy+'/'+mm+'/'+dd;
			
			
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtenrolldate').value=enrolldate1;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtenrolldate').value=enrollyear;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtenrolldate').value=enrolldate1day;
			}
			if(dateformat==null || dateformat=="")
			{
			document.getElementById('txtenrolldate').value=enrolldate1;
			}
			
			
			}
			else
			{
			
			//document.getElementById('txtenrolldate').value=dsforexecute.Tables[0].Rows[z].Enroll_Date;
			document.getElementById('txtenrolldate').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].No_of_VTS!=null)
			{
			document.getElementById('txtnoofvts').value=dsforexecute.Tables[0].Rows[z].No_of_VTS;
			}
			else
			{
			document.getElementById('txtnoofvts').value="";
			}
//			if(dsforexecute.Tables[1].Rows.length>0)
//{	
//    for(var i=0;i<dsforexecute.Tables[1].Rows.length;++i) 
//    {
//	    document.getElementById("drptaluka").options[i]=new Option(dsforexecute.Tables[1].Rows[i].TALU_NAME,dsforexecute.Tables[1].Rows[i].TALU_CODE);
//    }	
//}
               
			//document.getElementById('drpcity').value=dsforexecute.Tables[0].Rows[z].City_Code;
			document.getElementById('drpregion').value=dsforexecute.Tables[0].Rows[z].region;
			if(dsforexecute.Tables[0].Rows[z].CREDIT_LIMIT!=null)
			{
			document.getElementById('txtcrlimit').value=dsforexecute.Tables[0].Rows[z].CREDIT_LIMIT;
			}
			else
			{
				document.getElementById('txtcrlimit').value="";
            }

if (dsforexecute.Tables[0].Rows[z].EDTN_WISE_BILL_REQ != null) {
    document.getElementById('drpEdition_wise_Billing').value = dsforexecute.Tables[0].Rows[z].EDTN_WISE_BILL_REQ;
}
else {
    document.getElementById('drpEdition_wise_Billing').value = "N";
}
			//document.getElementById('Status').visible=true;
			
			//document.getElementById('StatusDate').styles.display="none";
			//StatusDate.style.display="visible";
			
//			
//			var todate=dsforexecute.Tables[0].Rows[z].to_date;
//			var currdate=dsforexecute.Tables[0].Rows[z].current_Datetime;
//			var tdate=new Date(todate);
//			var cdate=new Date(currdate);
//			
//			var dd=currdate.getDate();
//			var mm=currdate.getMonth() + 1;
//			var yyyy=currdate.getFullYear();
//			
//			var currdate1=mm+'/'+dd+'/'+yyyy;
//			var currda=dd+'/'+mm+'/'+yyyy;
//			var curryear=yyyy+'/'+mm+'/'+dd;
//			
//		
//			if(cdate > tdate && todate!= null )
//			{
//			document.getElementById('txtstatus').value="Banned";
//			}
//			else if(todate == null && dsforexecute.Tables[0].Rows[z].status_name==null)
//			{
//			document.getElementById('txtstatus').value="Active";
//			}
//			else
//			{
//			
//			document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[z].status_name;
//			}
//			


                 
            var todate=dsforexecute.Tables[0].Rows[z].to_date;
			var from_date=dsforexecute.Tables[0].Rows[z].FROM_DATE
			
			var currdate=dsforexecute.Tables[0].Rows[z].current_Datetime;
			var tdate=new Date(todate);
			var cdate=new Date(currdate);
			
			var dd=currdate.getDate();
			var mm=currdate.getMonth() + 1;
			var yyyy=currdate.getFullYear();
			
			var currdate1=mm+'/'+dd+'/'+yyyy;
			var currda=dd+'/'+mm+'/'+yyyy;
			var curryear=yyyy+'/'+mm+'/'+dd;
			
	
		

    /* previous code for status changed by saurabh Agarwal---------------------------------------		
		
			if(cdate > tdate && todate!= null )
			{
			document.getElementById('txtstatus').value="Banned";
			}
			else if(todate == null && dsforexecute.Tables[0].Rows[0].status_name==null)
			{
			document.getElementById('txtstatus').value="Active";
			}
			else
			{
			
			document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[0].status_name;
			}
	*///---------------------------------------------------------------------------------------------
	
	
		//------------------------saurabh code for status---------------------
		
		var cur=new Date();
		
		if((dsforexecute.Tables[0].Rows[z].status_name!=null)||(dsforexecute.Tables[0].Rows[z].status_name!=""))
		{
		    if(cur>=from_date && cur<=todate)
		    {
			    document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[z].status_name;
			}
			else
			{
			    document.getElementById('txtstatus').value="Active";
			}
			
		}
		else
		{
		    document.getElementById('txtstatus').value="Active";
		}
		
		if(dsforexecute.Tables[0].Rows[z].from_date=="" || dsforexecute.Tables[0].Rows[z].from_date==null || dsforexecute.Tables[0].Rows[z].to_date=="" || dsforexecute.Tables[0].Rows[z].to_date==null)
		{
		    document.getElementById('txtstatus').value="Active";
		}
		//-----------------------------------------------------------------------





	if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtstatusdate').value=currdate1;
			}
			if(dateformat=="dd/mm/yyyy")
			{document.getElementById('txtstatusdate').value=currda;
			}
			if(dateformat=="yyyy/mm/dd")
			{document.getElementById('txtstatusdate').value=curryear;
			}
			if(dateformat== null || dateformat=="" || dateformat=="undefined")
			{document.getElementById('txtstatusdate').value=currdate1;
			}
			//document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[0].current_Datetime;
			
			if(dsforexecute.Tables[0].Rows[z].Buss_Start_Date != null && dsforexecute.Tables[0].Rows[z].Buss_Start_Date != "")
			{
			var bussdate=dsforexecute.Tables[0].Rows[z].Buss_Start_Date;
			var dd=bussdate.getDate();
			var mm=bussdate.getMonth() + 1;
			var yyyy=bussdate.getFullYear();
			
			var bussdate1=mm+'/'+dd+'/'+yyyy;
			var bussdate1day=dd+'/'+mm+'/'+yyyy;
			var bussyear=yyyy+'/'+mm+'/'+dd;
			
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtbusineedate').value=bussdate1;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtbusineedate').value=bussyear;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtbusineedate').value=bussdate1day;
			}
			if(dateformat==null || dateformat=="")
			{
			document.getElementById('txtbusineedate').value=bussdate1;
			}
			
			}
			else
			{
			
			//document.getElementById('txtbusineedate').value=dsforexecute.Tables[0].Rows[z].Buss_Start_Date;
			document.getElementById('txtbusineedate').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].MRV_Ref_No!=null)
			{
			document.getElementById('txtmryrefno').value=dsforexecute.Tables[0].Rows[z].MRV_Ref_No;
			}
			else
			{
			document.getElementById('txtmryrefno').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].Credit_Days!=null)
			{
			document.getElementById('txtcredit').value=dsforexecute.Tables[0].Rows[z].Credit_Days;
			}
			else
			{
			document.getElementById('txtcredit').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].ST_ACC_No!=null)
			{
			document.getElementById('txtstacno').value=dsforexecute.Tables[0].Rows[z].ST_ACC_No;
			}
			else
			{
			document.getElementById('txtstacno').value="";
			}
			document.getElementById('drpagecate').disabled=true;
			
			document.getElementById('txtagencode').disabled=true;
			
			
			document.getElementById('txtsagencycode').disabled=true;
			
			document.getElementById('txtagenname').disabled=true;
			
			
			document.getElementById('drpagescat').disabled=true;
			
			
			
			document.getElementById('drpbranch').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('drpagetyp').disabled=true;
			document.getElementById('drpcity').disabled=true;
			document.getElementById('txtstatus').disabled=true;
			document.getElementById('txtstatusdate').disabled=true;
			document.getElementById('drpbillf').disabled=true;
			
			document.getElementById('btnModify').disabled=false;
			document.getElementById('btnQuery').disabled=false;
			document.getElementById('btnfirst').disabled=false;
			document.getElementById('btnprevious').disabled=false;
			document.getElementById('btnnext').disabled=false;
			document.getElementById('btnlast').disabled=false;
			document.getElementById('btnCancel').disabled=false;
			document.getElementById('btnNew').disabled=true;
			document.getElementById('btnSave').disabled=true;
			document.getElementById('btnExecute').disabled=true;
			if(document.getElementById('hiddenpermission').value=="1")
			{
				document.getElementById('btnModify').disabled=true;
			    document.getElementById('btnDelete').disabled=true;
			}
			if(document.getElementById('hiddenpermission').value=="4")
			{
			document.getElementById('btnModify').disabled=true;
			//document.getElementById('btnQuery').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}	
			if(document.getElementById('hiddenpermission').value=="5")
			{
			document.getElementById('btnModify').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}
			
			
			
				
	}
	else
	{
	
	document.getElementById('btnnext').disabled=false;
			document.getElementById('btnlast').disabled=false;
			document.getElementById('btnfirst').disabled=true;
			document.getElementById('btnprevious').disabled=true;
			setButtonImages();
			return false;
	
	
	}	
	}	
	
	else
	{
	
	document.getElementById('btnnext').disabled=false;
			document.getElementById('btnlast').disabled=false;
			document.getElementById('btnfirst').disabled=true;
			document.getElementById('btnprevious').disabled=true;
			setButtonImages();
			return false;
	
	
	}	
	if(z <= 0)
{
document.getElementById('btnnext').disabled=false;
			document.getElementById('btnlast').disabled=false;
			document.getElementById('btnfirst').disabled=true;
			document.getElementById('btnprevious').disabled=true;
			setButtonImages();
			return false;

}
	document.getElementById('drpagecate').disabled=true;
			
			document.getElementById('txtagencode').disabled=true;
			
			
			document.getElementById('txtsagencycode').disabled=true;

			document.getElementById('txtagenname').disabled = true;
			document.getElementById('drpemail').disabled = true;
			
			document.getElementById('drpagescat').disabled=true;
			
			
			document.getElementById('txtstatus2').disabled=true;
			
			document.getElementById('txtalias').disabled=true;
			
			
			document.getElementById('mrvregion').disabled=true;
			
			
			
			document.getElementById('drpregion').disabled=true;
			document.getElementById('drpbillf').disabled=true;
			
			
			document.getElementById('txtphone1').disabled=true;
			
			
			//txtagname.ReadOnly=false;
			
			document.getElementById('txtalert').disabled=true;

			document.getElementById('txtremarks').disabled = true;
			document.getElementById('attachment1').disabled = true;
		
			document.getElementById('txtagenname').disabled=true;
			
			
			//*******pankaj
			document.getElementById('txtadd').disabled=true;
			document.getElementById('txtaddress1').disabled=true;
			document.getElementById('txtaddress2').disabled=true;
			//*******************
			document.getElementById('txtstreet').disabled=true;
			
			document.getElementById('txtdistrict').disabled=true;
			
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;
			
			document.getElementById('txtphone2').disabled=true;

			document.getElementById('txtmail').disabled = true;
			document.getElementById('txtmailcc').disabled = true;
			document.getElementById('drpcurtyp').disabled=true;
			document.getElementById('txttan').disabled=true;
			document.getElementById('txtpan').disabled=true;
			
			document.getElementById('drprepres').disabled=true;
			//drpstatus.disabled=true;
			document.getElementById('txtbill').disabled=true;
			
			document.getElementById('drpagetyp').disabled=true;
			//drpsageo.disabled=true;
			document.getElementById('txtpincode').disabled=true;
			document.getElementById('txtstate').disabled=true;
			//string zip="246763";
			document.getElementById('txtfax').disabled=true;
			document.getElementById('txtfax1').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtnoofvts').disabled=true;
			//document.getElementById('txtstatusdate').disabled=false;
			
			document.getElementById('drpcity').disabled=true;
			
			
			//string url="www.4cplus.com";
			document.getElementById('txtbusineedate').disabled=true;
			document.getElementById('txtenrolldate').disabled=true;
			document.getElementById('txtmryrefno').disabled=true;
			document.getElementById('txtcredit').disabled=true;
			document.getElementById('txtstacno').disabled=true;
			document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabledd);
			//document.getElementById('txtsagencycode').disabled=true;
			//alert(document.getElementById('txtsagencycode').disabled);
			document.getElementById('txturl').disabled=true;
			document.getElementById('txturl').disabled=true;
			document.getElementById('txtphone2').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtagenname').disabled=true;
			document.getElementById('txtalias').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('txtagencode').disabled=true;
			document.getElementById('chkvat').disabled = true;
			document.getElementById('chkcheque').disabled = true;
			document.getElementById('chkbondrecvd').disabled = true;
			document.getElementById('chkyc').disabled = true;
			document.getElementById('chkadproof').disabled = true;

			document.getElementById('chkraterevise').disabled = true;
			//string paymode=bank;
			
			document.getElementById('btnSave').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			document.getElementById('txtcrlimit').disabled=true;
			
			
			
			
			document.getElementById('drpregion').disabled=true;
			
			document.getElementById('txtcountry').disabled=true;
			document.getElementById('drpzone').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			document.getElementById('txtagencyho').disabled=true;
			document.getElementById('txtsugagencyho').disabled=true;
			
			
			if(document.getElementById('hiddenpermission').value=="4")
			{
			document.getElementById('btnModify').disabled=true;
			//document.getElementById('btnQuery').disabled=true;
			
			}
			else
			{
			//document.getElementById('btnModify').disabled=false;
			}	
			setButtonImages();
return false;
}




function deleteagency()
{
var txtagencode=document.getElementById('txtagencode').value;
var compcode=document.getElementById('hiddencompcode').value;
var userid=document.getElementById('hiddenuserid').value;
var subagency=document.getElementById('txtsagencycode').value;
var codsubcode=document.getElementById('txtagencode').value+document.getElementById('txtsagencycode').value;
if(confirm("Are you aure you want to delete this record."))
{

//dan
 var strtextd="";
  var  httpRequest =null;
     httpRequest= new XMLHttpRequest();
     if (httpRequest.overrideMimeType) {
          httpRequest.overrideMimeType('text/xml'); 
          }
          //httpRequest.onreadystatechange = function() {alertContents(httpRequest) };
 
            httpRequest.open( "GET","checksessiondan.aspx", false );
            httpRequest.send('');
            //alert(httpRequest.readyState);
            if (httpRequest.readyState == 4) 
            {
                //alert(httpRequest.status);
                if (httpRequest.status == 200) 
                {
                    strtextd=httpRequest.responseText;
                }
                else 
                {
                    //alert('There was a problem with the request.');
                    if(browser!="Microsoft Internet Explorer")
                    {
                        //alert(xmlObjMessage.childNodes[1].childNodes[21].childNodes[0].nodeValue);
                    }
                }
            }
              if(strtextd!="sess")
       {
       alert('session expired');
           window.location.href="Default.aspx";
           return false;
       } 
Agent_master.deleteagency(compcode,userid,txtagencode,subagency,codsubcode,document.getElementById('ip1').value);
//dsforexecute.Tables[0].Rows[z]=null;
alert("Data Deleted Successfully");

//Agent_master.previous(compcode,userid,txtagencode,call_deleteagency);

Agent_master.executeagency(glagcat,glagencycode,glsubagencycode,glagenctname,glalias,blagsubcat,compcode,userid,glcity,glagencytype,glcountry,glbranchcode,gbillfreq,call_deleteagency);


}
else
{
return false;
}

        var bktyplen=document.getElementById('bktype').options.length;
         for(var t2=0;t2<bktyplen;t2++)
         {
             document.getElementById('bktype').options[t2].selected=false;
         }
document.getElementById('txtpincode').value="";

			
			document.getElementById('txturl').value="";
			
			document.getElementById('txtphone1').value="";
			
			
			
	        document.getElementById('mrvregion').value="";
				
			
			document.getElementById('txturl').value="";

			
			
			document.getElementById('txtagencode').value="";
		
			document.getElementById('txtagenname').value="";
			
			document.getElementById('txtsagencycode').value="";
			
			document.getElementById('drpagecate').value="0";
			//drpregion.SelectedValue="0";
			
			document.getElementById('txtcrlimit').value="";
			
			document.getElementById('txtagencyho').value="";
			
			document.getElementById('drpagetyp').value="0";
			
			document.getElementById('drpagecate').value="0";
			
			document.getElementById('drpagescat').value="0";
			//drpregion.SelectedValue="0";
			
			document.getElementById('txtagencyho').value="";
			
			document.getElementById('txtsugagencyho').value="";
			
			document.getElementById('drprepres').value="0";
			//drpcity.SelectedValue="0";
			
			document.getElementById('txtsugagencyho').value="";


			
			
			
			document.getElementById('txtstatus2').value="";
			
			document.getElementById('txtalias').value="";
			//txtagname.Text="";
			
			document.getElementById('txtalert').value="";

			document.getElementById('txtremarks').value = "";
			document.getElementById('hidkyc').value = "";
			
			
			document.getElementById('txtagenname').value="";
			
			document.getElementById('txtadd').value="";
			
			document.getElementById('txtstreet').value="";
			
			document.getElementById('txtdistrict').value="";
			
			document.getElementById('txtcountry').value="0";
			document.getElementById('drpzone').value="0";
			
			document.getElementById('txtphone2').value="";
			
			document.getElementById('drpcurtyp').value="0";

			document.getElementById('txtmail').value = "";

			document.getElementById('txtmailcc').value = "";
			
			document.getElementById('txttan').value="";
			
				document.getElementById('txtpan').value="";
			//			drprepres.disabled=true;
			//			drpstatus.disabled=true;
			
			document.getElementById('txtbill').value="0";
			
			
			//			drpsageo.disabled=true;
			
			document.getElementById('txtpincode').value="";
			
			document.getElementById('txtstate').value="";
			//string zip="246763";
			
			document.getElementById('txtfax').value="";
			document.getElementById('txtfax1').value="";
			
			document.getElementById('txtenrolldate').value="";
			
			document.getElementById('txtnoofvts').value="";
			
			//document.getElementById('txtstatusdate').value="";
			//			drpcity.disabled=true;
			//string url="www.4cplus.com";
			document.getElementById('txtstatus').value="";
			document.getElementById('txtstatusdate').value="";
			
			document.getElementById('txtbusineedate').value="";
			
			document.getElementById('txtmryrefno').value="";
			
			document.getElementById('txtcredit').value="";
			
			document.getElementById('txtstacno').value="";
			document.getElementById('drpcity').value="0";
			document.getElementById('drpregion').value="0";
			document.getElementById("chkvat").checked = false;
			document.getElementById("chkcheque").checked = false;
			document.getElementById("chkbondrecvd").checked = false;
			document.getElementById("chkyc").checked = false;
			document.getElementById("chkadproof").checked = false;


return false;



}

function call_deleteagency(response)
{
show1="5";
 dsforexecute=response.value;
	var a=dsforexecute.Tables[0].Rows.length;
	var y=a-1;
	
	if( a ==0 )
	{
	        alert("There is no record in the database!!!");

	        document.getElementById('txtpincode').value = "";
	        document.getElementById('txtdesg').value = "";
            document.getElementById('txturl').value="";
			document.getElementById('drpbranch').value="0";
			document.getElementById('txtphone1').value="";
		    document.getElementById('mrvregion').value="";
			document.getElementById('drpbillf').value="0";	
			
			document.getElementById('txturl').value="";

			
			
			document.getElementById('txtagencode').value="";
		
			document.getElementById('txtagenname').value="";
			
			document.getElementById('txtsagencycode').value="";
			
			document.getElementById('drpagecate').value="0";
			//drpregion.SelectedValue="0";
			
			document.getElementById('txtcrlimit').value="";
			
			document.getElementById('txtagencyho').value="";
			
			document.getElementById('drpagetyp').value="0";
			
			document.getElementById('drpagecate').value="0";
			
			document.getElementById('drpagescat').value="0";
			//drpregion.SelectedValue="0";
			
			document.getElementById('txtagencyho').value="";
			
			document.getElementById('txtsugagencyho').value="";
			
			document.getElementById('drprepres').value="0";
			//drpcity.SelectedValue="0";
			
			document.getElementById('txtsugagencyho').value="";


			
			
			
			document.getElementById('txtstatus2').value="";
			
			document.getElementById('txtalias').value="";
			//txtagname.Text="";
			
			document.getElementById('txtalert').value="";

			document.getElementById('txtremarks').value = "";

			document.getElementById('hidkyc').value = "";
			
			
			document.getElementById('txtagenname').value="";
			
			document.getElementById('txtadd').value="";
			
			document.getElementById('txtstreet').value="";
			
			document.getElementById('txtdistrict').value="";
			
			document.getElementById('txtcountry').value="0";
			document.getElementById('drpzone').value="0";
			
			document.getElementById('txtphone2').value="";
			
			document.getElementById('drpcurtyp').value="0";

			document.getElementById('txtmail').value = "";

			document.getElementById('txtmailcc').value = "";
			
			document.getElementById('txttan').value="";
			
				document.getElementById('txtpan').value="";
			//			drprepres.disabled=true;
			//			drpstatus.disabled=true;
			
			document.getElementById('txtbill').value="0";
			
			document.getElementById('drpagetyp').disabled=false;
			//			drpsageo.disabled=true;
			
			document.getElementById('txtpincode').value="";
			
			document.getElementById('txtstate').value="";
			//string zip="246763";
			
			document.getElementById('txtfax').value="";
			document.getElementById('txtfax1').value="";
			
			document.getElementById('txtenrolldate').value="";
			
			document.getElementById('txtnoofvts').value="";
			
			//document.getElementById('txtstatusdate').value="";
			//			drpcity.disabled=true;
			//string url="www.4cplus.com";
			
			document.getElementById('txtbusineedate').value="";
			
			document.getElementById('txtmryrefno').value="";
			
			document.getElementById('txtcredit').value="";
			
			document.getElementById('txtstacno').value="";
			document.getElementById('drpcity').value="0";
			document.getElementById("chkvat").checked = false;
			document.getElementById("chkcheque").checked = false;
			document.getElementById("chkbondrecvd").checked = false;
			document.getElementById("chkyc").checked = false;
			document.getElementById("chkadproof").checked = false;

			 var bktyplen=document.getElementById('bktype').options.length;
             for(var t2=0;t2<bktyplen;t2++)
             {
                 document.getElementById('bktype').options[t2].selected=false;
             }
			
			cancelclick();
		}
		else if(z==-1 ||z>=a)
		{
		         //----------------------------------------------------//
                
                  var bktyplen=document.getElementById('bktype').options.length;
                 for(var t2=0;t2<bktyplen;t2++)
                 {
                     document.getElementById('bktype').options[t2].selected=false;
                 }
                if(dsforexecute.Tables[0].Rows[0].BOOKING_TYPE !=null && dsforexecute.Tables[0].Rows[0].BOOKING_TYPE !="")
                {
                    var bktype=dsforexecute.Tables[0].Rows[0].BOOKING_TYPE;            
                   var  len1=bktype.split(",");
                    for(var a1=0; a1<len1.length; a1++)
                    {
                        for(var j=0; j<bktyplen; j++)
                        {
                            if(document.getElementById('bktype').options[j].value==len1[a1])
                            {
                               document.getElementById('bktype').options[j].selected = true;
                            }
                        }
                    }

                }
                
                //----------------------------------------------------------//
			
			document.getElementById('txtpincode').value=dsforexecute.Tables[0].Rows[0].pin_code;

			dsforexecute.Tables[0].Rows[0].state_name
			if(dsforexecute.Tables[0].Rows[0].Branch_code != "" && dsforexecute.Tables[0].Rows[0].Branch_code != null)
			{
			document.getElementById('drpbranch').value=dsforexecute.Tables[0].Rows[0].Branch_code;
			}
			else
			{
			document.getElementById('drpbranch').value="0";
			}
			
			if(dsforexecute.Tables[0].Rows[0].URL != "" && dsforexecute.Tables[0].Rows[0].URL != null)
			{
			document.getElementById('txturl').value=dsforexecute.Tables[0].Rows[0].URL;
			}
			else
			{
			document.getElementById('txturl').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].CREDIT_TYPE != "" && dsforexecute.Tables[0].Rows[0].CREDIT_TYPE != null)
			{
			document.getElementById('drpcurtyp').value=dsforexecute.Tables[0].Rows[0].CREDIT_TYPE;
			}
			else
			{
			document.getElementById('drpcurtyp').value="0"
			}
			if(dsforexecute.Tables[0].Rows[0].OLD_AGENCY != "" && dsforexecute.Tables[0].Rows[0].OLD_AGENCY != null)
			{
			document.getElementById('txtoldagen').value=dsforexecute.Tables[0].Rows[0].OLD_AGENCY;
			}
			else
			{
			document.getElementById('txtoldagen').value=""
			}
			//alert(ds.Tables[0].Rows[0].URL);
			
			
			if(dsforexecute.Tables[0].Rows[0].Zip != "" && dsforexecute.Tables[0].Rows[0].Zip != null)
			{
	        document.getElementById('mrvregion').value=dsforexecute.Tables[0].Rows[0].Zip;
	        }
	        else
	        {
	        document.getElementById('mrvregion').value=""
	        }
	        if(dsforexecute.Tables[0].Rows[0].CODE!=null)
	        {
	        document.getElementById('txtphone1').value=dsforexecute.Tables[0].Rows[0].CODE;
			}
			else
			{
			   document.getElementById('txtphone1').value="";
			}	
			
			

			
			
			document.getElementById('txtagencode').value=dsforexecute.Tables[0].Rows[0].Agency_Code;
		document.getElementById('drprate').value=dsforexecute.Tables[0].Rows[0].Rate_Group;
			document.getElementById('txtagenname').value=dsforexecute.Tables[0].Rows[0].Agency_Name;
			document.getElementById('hiddenagencyname').value=document.getElementById('txtagenname').value;
			document.getElementById('drpparent').value=dsforexecute.Tables[0].Rows[0].Type;
			document.getElementById('txtsagencycode').value=dsforexecute.Tables[0].Rows[0].SUB_Agency_Code;
			document.getElementById('drpzone').value=dsforexecute.Tables[0].Rows[0].zone_code;
			document.getElementById('drpagecate').value = dsforexecute.Tables[0].Rows[0].Agency_Cat_Code;

			if (dsforexecute.Tables[0].Rows[0].AGENCY_DESIGNATION != null) {
			    document.getElementById('txtdesg').value = dsforexecute.Tables[0].Rows[0].AGENCY_DESIGNATION;
			}
			//drpregion.SelectedValue="0";
			
			//document.getElementById('txtcrlimit').value=ds.Tables[0].Rows[0].Agency_Cat_Code;
			if(dsforexecute.Tables[0].Rows[0].Agency_HO!=null)
			{
			document.getElementById('txtagencyho').value=dsforexecute.Tables[0].Rows[0].Agency_HO;
			}
			else
			{
				document.getElementById('txtagencyho').value="";
			}
			//document.getElementById('drpagetyp').value=dsforexecute.Tables[0].Rows[0].Agency_Type_Code;
			
			
			
			//document.getElementById('drpagescat').value=ds.Tables[0].Rows[0].Agency_SubCat_Code;
			//drpregion.SelectedValue="0";
			
//			addcategory(ds.Tables[0].Rows[0].Agency_Type_Code);
//			catvar=ds.Tables[0].Rows[0].Agency_Cat_Code;
			addsubcategory(dsforexecute.Tables[0].Rows[0].Agency_Cat_Code);
           //catvar=dsforexecute.Tables[0].Rows[0].Agency_SubCat_Code;
            catvar=dsforexecute.Tables[0].Rows[0].Agency_Cat_Code;
              addcategory(dsforexecute.Tables[0].Rows[0].Agency_Cat_Code);
           document.getElementById('drpagecate').value=dsforexecute.Tables[0].Rows[0].Agency_Cat_Code;
		document.getElementById('drpagetyp').value=dsforexecute.Tables[0].Rows[0].Agency_Type_Code;
			if(dsforexecute.Tables[0].Rows[0].SUB_Agency_HO!=null)
			{
			document.getElementById('txtsugagencyho').value=dsforexecute.Tables[0].Rows[0].SUB_Agency_HO;
			}
			else
			{
			document.getElementById('txtsugagencyho').value="";
			}
			
			document.getElementById('drprepres').value=dsforexecute.Tables[0].Rows[0].representative_code;
			//drpcity.SelectedValue="0";
			
			
//document.getElementById('getagcode').value=document.getElementById('txtagencode').value;
document.getElementById('getagsubcode').value=document.getElementById('txtsagencycode').value;

			
			
			if(dsforexecute.Tables[0].Rows[0].Status_Reason!=null)
			{
			document.getElementById('txtstatus2').value=dsforexecute.Tables[0].Rows[0].Status_Reason;
			}
			else
			{
			document.getElementById('txtstatus2').value="";
			}
			document.getElementById('txtalias').value=dsforexecute.Tables[0].Rows[0].Agency_Alias;
			//txtagname.Text="";
			if(dsforexecute.Tables[0].Rows[0].ALERT!=null)
			{
			document.getElementById('txtalert').value=dsforexecute.Tables[0].Rows[0].ALERT;
			}
			else
			{
			document.getElementById('txtalert').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].Remarks!=null)
			{
			document.getElementById('txtremarks').value=dsforexecute.Tables[0].Rows[0].Remarks;
			}
			else
			{
			document.getElementById('txtremarks').value="";

}



            if (dsforexecute.Tables[0].Rows[0].KYC_ATTACH != null) {
                document.getElementById('hidkyc').value = dsforexecute.Tables[0].Rows[0].KYC_ATTACH;

                document.getElementById('attachment1').src = "Images/indexred.jpg";
            }
            else {
                document.getElementById('hidkyc').value = "";

                document.getElementById('attachment1').src = "Images/index.jpg";
            }
			
			//*****************************************Pankaj
			if(dsforexecute.Tables[0].Rows[0].Add1!=null)
			{
			document.getElementById('txtadd').value=dsforexecute.Tables[0].Rows[0].Add1;
			}
			else
			{
			document.getElementById('txtadd').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].Add2!=null)
			{
			document.getElementById('txtaddress1').value=dsforexecute.Tables[0].Rows[0].Add2;
			}
			else
			{
			document.getElementById('txtaddress1').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].Add3!=null)
			{
			document.getElementById('txtaddress2').value=dsforexecute.Tables[0].Rows[0].Add3;
			}
			else
			{
			document.getElementById('txtaddress2').value="";
			}
			
			
			
			
			if(dsforexecute.Tables[0].Rows[0].Street!=null)
			{
			document.getElementById('txtstreet').value=dsforexecute.Tables[0].Rows[0].Street;
			}
			else
			{
			document.getElementById('txtstreet').value="";
			}
			document.getElementById('txtdistrict').value=dsforexecute.Tables[0].Rows[0].Dist_Code;
			
			document.getElementById('txtcountry').value=dsforexecute.Tables[0].Rows[0].Country_Code;
			cityvar=dsforexecute.Tables[0].Rows[0].City_Code;
				regionvar=dsforexecute.Tables[0].Rows[0].region;
			zonevar=dsforexecute.Tables[0].Rows[0].zone_code;
			talukavar=dsforexecute.Tables[0].Rows[0].TALUKA;
			addcount(dsforexecute.Tables[0].Rows[0].Country_Code);
			if(dsforexecute.Tables[0].Rows[0].Phone!=null)
			{
			document.getElementById('txtphone2').value=dsforexecute.Tables[0].Rows[0].Phone;
			}
			else
			{
				document.getElementById('txtphone2').value="";
			}
			
			if(dsforexecute.Tables[0].Rows[0].EmailID!=null)
			{
			document.getElementById('txtmail').value=dsforexecute.Tables[0].Rows[0].EmailID;
			}
			else
			{
			document.getElementById('txtmail').value="";

}

if (dsforexecute.Tables[0].Rows[0].EMAILID_CC != null) {
    document.getElementById('txtmailcc').value = dsforexecute.Tables[0].Rows[0].EMAILID_CC;
}
else {
    document.getElementById('txtmailcc').value = "";
}
			if(dsforexecute.Tables[0].Rows[0].TAN_No!=null)
			{
			document.getElementById('txttan').value=dsforexecute.Tables[0].Rows[0].TAN_No;
			}
			else
			{
			document.getElementById('txttan').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].PAN_No!=null)
			{
				document.getElementById('txtpan').value=dsforexecute.Tables[0].Rows[0].PAN_No;
				}
				else
				{
				document.getElementById('txtpan').value="";
				}
				
				if(dsforexecute.Tables[0].Rows[0].VAT ==0 || dsforexecute.Tables[0].Rows[0].VAT =="0" || dsforexecute.Tables[0].Rows[0].VAT ==""|| dsforexecute.Tables[0].Rows[0].VAT ==null)
			{
			 document.getElementById("chkvat").checked=false;
			}
			else
			{
			document.getElementById("chkvat").checked=true;
			}
			if (dsforexecute.Tables[0].Rows[0].RATE_REVISE == 0 || dsforexecute.Tables[0].Rows[0].RATE_REVISE == "0" || dsforexecute.Tables[0].Rows[0].RATE_REVISE == "" || dsforexecute.Tables[0].Rows[0].RATE_REVISE == null) {
			    document.getElementById("chkraterevise").checked = false;
			}
			else {
			    document.getElementById("chkraterevise").checked = true;
			}

			if (dsforexecute.Tables[0].Rows[0].BLANKCHEQUE == 0 || dsforexecute.Tables[0].Rows[0].BLANKCHEQUE == "0" || dsforexecute.Tables[0].Rows[0].BLANKCHEQUE == "" || dsforexecute.Tables[0].Rows[0].BLANKCHEQUE == null) {
			    document.getElementById("chkcheque").checked = false;
			}
			else {
			    document.getElementById("chkcheque").checked = true;

			}
			if (dsforexecute.Tables[0].Rows[0].SECURITYBOND == 0 || dsforexecute.Tables[0].Rows[0].SECURITYBOND == "0" || dsforexecute.Tables[0].Rows[0].SECURITYBOND == "" || dsforexecute.Tables[0].Rows[0].SECURITYBOND == null) {
			    document.getElementById("chkbondrecvd").checked = false;
			}
			else {
			    document.getElementById("chkbondrecvd").checked = true;

			}
			if (dsforexecute.Tables[0].Rows[0].KYCAPP == 0 || dsforexecute.Tables[0].Rows[0].KYCAPP == "0" || dsforexecute.Tables[0].Rows[0].KYCAPP == "" || dsforexecute.Tables[0].Rows[0].KYCAPP == null) {
			    document.getElementById("chkyc").checked = false;
			}
			else {
			    document.getElementById("chkyc").checked = true;

			}
			if (dsforexecute.Tables[0].Rows[0].ADDRESSPROOF == 0 || dsforexecute.Tables[0].Rows[0].ADDRESSPROOF == "0" || dsforexecute.Tables[0].Rows[0].ADDRESSPROOF == "" || dsforexecute.Tables[0].Rows[0].ADDRESSPROOF == null) {
			    document.getElementById("chkadproof").checked = false;
			}
			else {
			    document.getElementById("chkadproof").checked = true;

			}
				var talukabind = dsforexecute.Tables[0].Rows[0].Dist_Code;
bindtalu(talukabind);
			//			drprepres.disabled=true;
			//			drpstatus.disabled=true;
			var compcode=document.getElementById('hiddencompcode').value;
            var userid=document.getElementById('hiddenuserid').value;
            Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,call_billto);
             Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,billtodrpcall);
            //document.getElementById('txtbill').value=dsforexecute.Tables[0].Rows[0].BILL_TO;
			//document.getElementById('txtbill').value=dsforexecute.Tables[0].Rows[0].BILL_TO;
			biltovar=dsforexecute.Tables[0].Rows[0].BILL_TO;
			varbiltocal=dsforexecute.Tables[0].Rows[0].acagency;
			
			//			drpsageo.disabled=true;
			if(dsforexecute.Tables[0].Rows[0].pin_code!=null)
			{
			document.getElementById('txtpincode').value=dsforexecute.Tables[0].Rows[0].pin_code;
			}
			else
			{
			document.getElementById('txtpincode').value="";
			}
			document.getElementById('txtstate').value=dsforexecute.Tables[0].Rows[0].State_Code;
			//string zip="246763";
			if(dsforexecute.Tables[0].Rows[0].Fax!=null)
			{
			document.getElementById('txtfax').value=dsforexecute.Tables[0].Rows[0].Fax;
			}
			else
			{
			document.getElementById('txtfax').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].fax1!=null)
			{
			document.getElementById('txtfax1').value=dsforexecute.Tables[0].Rows[0].fax1;
			}
			else
			{
			document.getElementById('txtfax1').value="";
			}
			
//			if(dsforexecute.Tables[0].Rows[0].TALUKA!=null)
//			{
//			document.getElementById('drptaluka').value=dsforexecute.Tables[0].Rows[0].TALUKA;
//			}
//			else
//			{
//			document.getElementById('drptaluka').value="";
//			}
//document.getElementById('drptaluka').value=dsforexecute.Tables[0].Rows[0].TALUKA;
			var dateformat=document.getElementById('hiddendateformat').value;
			
			if(dsforexecute.Tables[0].Rows[0].Enroll_Date != null && dsforexecute.Tables[0].Rows[0].Enroll_Date != "")
			{
			var enrolldate=dsforexecute.Tables[0].Rows[0].Enroll_Date;
			var dd=enrolldate.getDate();
			var mm=enrolldate.getMonth() + 1;
			var yyyy=enrolldate.getFullYear();
			
			var enrolldate1=mm+'/'+dd+'/'+yyyy;
			var enrolldate1day=dd+'/'+mm+'/'+yyyy;
			var enrollyear=yyyy+'/'+mm+'/'+dd;
			
			
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtenrolldate').value=enrolldate1;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtenrolldate').value=enrollyear;
			}
			
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtenrolldate').value=enrolldate1day;
			}
			if(dateformat==null || dateformat=="")
			{
			document.getElementById('txtenrolldate').value=enrolldate1;
			}
			
			
			
			}
			else
			{
			
//			document.getElementById('txtenrolldate').value=dsforexecute.Tables[0].Rows[0].Enroll_Date;
			document.getElementById('txtenrolldate').value=="";
			}
			if(dsforexecute.Tables[0].Rows[0].No_of_VTS!=null)
			{
			document.getElementById('txtnoofvts').value=dsforexecute.Tables[0].Rows[0].No_of_VTS;
			}
			else
			{
			document.getElementById('txtnoofvts').value="";
			}
			document.getElementById('drpcity').value==dsforexecute.Tables[0].Rows[0].City_Code;
			document.getElementById('drpregion').value=dsforexecute.Tables[0].Rows[0].region;
			
			//document.getElementById('Status').visible=true;
			
			//document.getElementById('StatusDate').styles.display="none";
			//StatusDate.style.display="visible";
			
//			
//			var todate=dsforexecute.Tables[0].Rows[0].to_date;
//			var currdate=dsforexecute.Tables[0].Rows[0].current_Datetime;
//			var tdate=new Date(todate);
//			var cdate=new Date(currdate);
//			
//			var dd=currdate.getDate();
//			var mm=currdate.getMonth() + 1;
//			var yyyy=currdate.getFullYear();
//			
//			var currdate1=mm+'/'+dd+'/'+yyyy;
//			var currda=dd+'/'+mm+'/'+yyyy;
//			var curryear=yyyy+'/'+mm+'/'+dd;
//			
//		
//			if(cdate > tdate && todate!= null )
//			{
//			document.getElementById('txtstatus').value="Banned";
//			}
//			else if(todate == null && dsforexecute.Tables[0].Rows[0].status_name==null)
//			{
//			document.getElementById('txtstatus').value="Active";
//			}
//			else
//			{
//				document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[0].status_name;
//			}


        
            

                 
            var todate=dsforexecute.Tables[0].Rows[0].to_date;
			var from_date=dsforexecute.Tables[0].Rows[0].FROM_DATE;
			
			var currdate=dsforexecute.Tables[0].Rows[0].current_Datetime;
			var tdate=new Date(todate);
			var cdate=new Date(currdate);
			
			var dd=currdate.getDate();
			var mm=currdate.getMonth() + 1;
			var yyyy=currdate.getFullYear();
			
			var currdate1=mm+'/'+dd+'/'+yyyy;
			var currda=dd+'/'+mm+'/'+yyyy;
			var curryear=yyyy+'/'+mm+'/'+dd;
			
	
		

    /* previous code for status changed by saurabh Agarwal---------------------------------------		
		
			if(cdate > tdate && todate!= null )
			{
			document.getElementById('txtstatus').value="Banned";
			}
			else if(todate == null && dsforexecute.Tables[0].Rows[0].status_name==null)
			{
			document.getElementById('txtstatus').value="Active";
			}
			else
			{
			
			document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[0].status_name;
			}
	*///---------------------------------------------------------------------------------------------
	
	
		//------------------------saurabh code for status---------------------
		
		var cur=new Date();
		
		if((dsforexecute.Tables[0].Rows[0].status_name!=null)||(dsforexecute.Tables[0].Rows[0].status_name!=""))
		{
		    if(cur>=from_date && cur<=todate)
		    {
			    document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[0].status_name;
			}
			else
			{
			    document.getElementById('txtstatus').value="Active";
			}
			
		}
		else
		{
		    document.getElementById('txtstatus').value="Active";
		}
		
		if(dsforexecute.Tables[0].Rows[0].from_date=="" || dsforexecute.Tables[0].Rows[0].from_date==null || dsforexecute.Tables[0].Rows[0].to_date=="" || dsforexecute.Tables[0].Rows[0].to_date==null)
		{
		    document.getElementById('txtstatus').value="Active";
		}
		//-----------------------------------------------------------------------
		
		





			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtstatusdate').value=currdate1;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtstatusdate').value=currda;
			}
			if(dateformat=="yyyy/mm/dd")
			{document.getElementById('txtstatusdate').value=curryear;
			}
			if(dateformat==null || dateformat=="" || dateformat=="undefined")
			{document.getElementById('txtstatusdate').value=currdate1;
			}
			//document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[0].current_Datetime;
			
			if(dsforexecute.Tables[0].Rows[0].Buss_Start_Date != null && dsforexecute.Tables[0].Rows[0].Buss_Start_Date != "")
			{
			var bussdate=dsforexecute.Tables[0].Rows[0].Buss_Start_Date;
			var dd=bussdate.getDate();
			var mm=bussdate.getMonth() + 1;
			var yyyy=bussdate.getFullYear();
			
			var bussdate1=mm+'/'+dd+'/'+yyyy;
			var bussdate1day=dd+'/'+mm+'/'+yyyy;
			var bussyear=yyyy+'/'+mm+'/'+dd;
			
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtbusineedate').value=bussdate1;
			
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtbusineedate').value=bussyear;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			
			document.getElementById('txtbusineedate').value=bussdate1day;
			}
			if(dateformat==null || dateformat=="")
			{
			document.getElementById('txtbusineedate').value=bussdate1;
			
			}
			
			
			
			
			
			}
			else
			{
			
			//document.getElementById('txtbusineedate').value=dsforexecute.Tables[0].Rows[0].Buss_Start_Date;
			document.getElementById('txtbusineedate').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].MRV_Ref_No!=null)
			{
			document.getElementById('txtmryrefno').value=dsforexecute.Tables[0].Rows[0].MRV_Ref_No;
			}
			else
			{
			document.getElementById('txtmryrefno').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].Credit_Days!=null)
			{
			document.getElementById('txtcredit').value=dsforexecute.Tables[0].Rows[0].Credit_Days;
			}
			else
			{
			document.getElementById('txtcredit').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].ST_ACC_No!=null)
			{
			document.getElementById('txtstacno').value=dsforexecute.Tables[0].Rows[0].ST_ACC_No;
			}
			else
			{
			document.getElementById('txtstacno').value="";
			}
			if(dsforexecute.Tables[0].Rows[0].CREDIT_LIMIT!=null)
			{
			document.getElementById('txtcrlimit').value=dsforexecute.Tables[0].Rows[0].CREDIT_LIMIT;
			}
			else
			{
			document.getElementById('txtcrlimit').value="";
			}
			}


else
{
             //----------------------------------------------------//
            
              var bktyplen=document.getElementById('bktype').options.length;
             for(var t2=0;t2<bktyplen;t2++)
             {
                 document.getElementById('bktype').options[t2].selected=false;
             }
            if(dsforexecute.Tables[0].Rows[z].BOOKING_TYPE !=null && dsforexecute.Tables[0].Rows[z].BOOKING_TYPE !="")
            {
                var bktype=dsforexecute.Tables[0].Rows[z].BOOKING_TYPE;            
               var  len1=bktype.split(",");
                for(var a1=0; a1<len1.length; a1++)
                {
                    for(var j=0; j<bktyplen; j++)
                    {
                        if(document.getElementById('bktype').options[j].value==len1[a1])
                        {
                           document.getElementById('bktype').options[j].selected = true;
                        }
                    }
                }

            }
            
            //----------------------------------------------------------//
           document.getElementById('txtpincode').value=dsforexecute.Tables[0].Rows[z].pin_code;

			dsforexecute.Tables[0].Rows[0].state_name
			
			if(dsforexecute.Tables[0].Rows[z].Branch_code != null)
			{
			document.getElementById('drpbranch').value=dsforexecute.Tables[0].Rows[z].Branch_code;
			}
			else
			{
			document.getElementById('drpbranch').value="0";
			}
			
			if(dsforexecute.Tables[0].Rows[z].CODE!=null)
			{
			document.getElementById('txtphone1').value=dsforexecute.Tables[0].Rows[z].CODE;
			}
			else
			{
			document.getElementById('txtphone1').value="";
			}
			
			
	       if(dsforexecute.Tables[0].Rows[z].URL != "" && dsforexecute.Tables[0].Rows[z].URL != null)
			{
			document.getElementById('txturl').value=dsforexecute.Tables[0].Rows[z].URL;
			}
			else
			{
			document.getElementById('txturl').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].CREDIT_TYPE != "" && dsforexecute.Tables[0].Rows[z].CREDIT_TYPE != null)
			{
			document.getElementById('drpcurtyp').value=dsforexecute.Tables[0].Rows[z].CREDIT_TYPE;
			}
			else
			{
			document.getElementById('drpcurtyp').value="0"
			}
			
			
			
			
			if(dsforexecute.Tables[0].Rows[z].Zip != "" && dsforexecute.Tables[0].Rows[z].Zip != null)
			{
	        document.getElementById('mrvregion').value=dsforexecute.Tables[0].Rows[z].Zip;
	        }
	        else
	        {
	        document.getElementById('mrvregion').value="";
	        }
				
			
			

			
			
			document.getElementById('txtagencode').value=dsforexecute.Tables[0].Rows[z].Agency_Code;
		document.getElementById('drprate').value=dsforexecute.Tables[0].Rows[z].Rate_Group;
			document.getElementById('txtagenname').value=dsforexecute.Tables[0].Rows[z].Agency_Name;
			document.getElementById('hiddenagencyname').value=document.getElementById('txtagenname').value;
			document.getElementById('txtsagencycode').value=dsforexecute.Tables[0].Rows[z].SUB_Agency_Code;
			document.getElementById('drpzone').value=dsforexecute.Tables[0].Rows[z].zone_code;
			document.getElementById('drpagecate').value=dsforexecute.Tables[0].Rows[z].Agency_Cat_Code;
			//drpregion.SelectedValue="0";
			
			//document.getElementById('txtcrlimit').value=dsforexecute.Tables[0].Rows[z].Agency_Cat_Code;
			document.getElementById('drpparent').value=dsforexecute.Tables[0].Rows[z].Type;
			if(dsforexecute.Tables[0].Rows[z].Agency_HO!=null)
			{
			document.getElementById('txtagencyho').value=dsforexecute.Tables[0].Rows[z].Agency_HO;
			}
			else
			{
			document.getElementById('txtagencyho').value="";
			}
			//document.getElementById('drpagetyp').value=dsforexecute.Tables[0].Rows[z].Agency_Type_Code;
			
			
			
			//document.getElementById('drpagescat').value=dsforexecute.Tables[0].Rows[z].Agency_SubCat_Code;
			//drpregion.SelectedValue="0";
//			addcategory(dsforexecute.Tables[0].Rows[z].Agency_Type_Code);
//			catvar=dsforexecute.Tables[0].Rows[z].Agency_Cat_Code;
			addsubcategory(dsforexecute.Tables[0].Rows[z].Agency_Cat_Code);
            // catvar=dsforexecute.Tables[0].Rows[z].Agency_SubCat_Code;
            catvar=dsforexecute.Tables[0].Rows[0].Agency_Cat_Code;
			 addcategory(dsforexecute.Tables[0].Rows[z].Agency_Cat_Code);
           document.getElementById('drpagecate').value=dsforexecute.Tables[0].Rows[z].Agency_Cat_Code;
		document.getElementById('drpagetyp').value=dsforexecute.Tables[0].Rows[z].Agency_Type_Code;
			if(dsforexecute.Tables[0].Rows[z].SUB_Agency_HO!=null)
			{
			document.getElementById('txtsugagencyho').value=dsforexecute.Tables[0].Rows[z].SUB_Agency_HO;
			}
			else
			{
			document.getElementById('txtsugagencyho').value="";
			}
			document.getElementById('drprepres').value=dsforexecute.Tables[0].Rows[z].representative_code;
			//drpcity.SelectedValue="0";
			
			


			
			
			if(dsforexecute.Tables[0].Rows[z].Status_Reason!=null)
			{
			document.getElementById('txtstatus2').value=dsforexecute.Tables[0].Rows[z].Status_Reason;
			}
			else
			{
			document.getElementById('txtstatus2').value="";
			}
			document.getElementById('txtalias').value=dsforexecute.Tables[0].Rows[z].Agency_Alias;
			//txtagname.Text="";
			if(dsforexecute.Tables[0].Rows[z].ALERT!=null)
			{
			document.getElementById('txtalert').value=dsforexecute.Tables[0].Rows[z].ALERT;
			}
			else
			{
			document.getElementById('txtalert').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].Remarks!=null)
			{
			document.getElementById('txtremarks').value=dsforexecute.Tables[0].Rows[z].Remarks;
			}
			else
			{
			document.getElementById('txtremarks').value="";

}


if (dsforexecute.Tables[0].Rows[z].KYC_ATTACH != null) {
    document.getElementById('hidkyc').value = dsforexecute.Tables[0].Rows[z].KYC_ATTACH;

    document.getElementById('attachment1').src = "Images/indexred.jpg";
}
else {
    document.getElementById('hidkyc').value = "";

    document.getElementById('attachment1').src = "Images/index.jpg";
}
			
			
			
			if(dsforexecute.Tables[0].Rows[z].Add1!=null)
			{
			document.getElementById('txtadd').value=dsforexecute.Tables[0].Rows[z].Add1;
			}
			else
			{
			document.getElementById('txtadd').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].Add2!=null)
			{
			document.getElementById('txtaddress1').value=dsforexecute.Tables[0].Rows[z].Add2;
			}
			else
			{
			document.getElementById('txtaddress1').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].Add3!=null)
			{
			document.getElementById('txtaddress2').value=dsforexecute.Tables[0].Rows[z].Add3;
			}
			else
			{
			document.getElementById('txtaddress2').value="";
			}
			//document.getElementById('getagcode').value=document.getElementById('txtagencode').value;
document.getElementById('getagsubcode').value=document.getElementById('txtsagencycode').value;
			if(dsforexecute.Tables[0].Rows[z].Street!=null)
			{
			document.getElementById('txtstreet').value=dsforexecute.Tables[0].Rows[z].Street;
			}
			else
			{
			document.getElementById('txtstreet').value="";
			}
			document.getElementById('txtdistrict').value=dsforexecute.Tables[0].Rows[z].Dist_Code;
			
			document.getElementById('txtcountry').value=dsforexecute.Tables[0].Rows[z].Country_Code;
			cityvar=dsforexecute.Tables[0].Rows[z].City_Code;
				regionvar=dsforexecute.Tables[0].Rows[0].region;
			zonevar=dsforexecute.Tables[0].Rows[0].zone_code;
			talukavar=dsforexecute.Tables[0].Rows[0].TALUKA;
			addcount(dsforexecute.Tables[0].Rows[z].Country_Code);
			if(dsforexecute.Tables[0].Rows[z].Phone!=null)
			{
			document.getElementById('txtphone2').value=dsforexecute.Tables[0].Rows[z].Phone;
			}
			else
			{
			document.getElementById('txtphone2').value="";
			}
			
			if(dsforexecute.Tables[0].Rows[z].EmailID!=null)
			{
			document.getElementById('txtmail').value=dsforexecute.Tables[0].Rows[z].EmailID;
			}
			else
			{
			document.getElementById('txtmail').value="";

}

if (dsforexecute.Tables[0].Rows[z].EMAILID_CC != null) {
    document.getElementById('txtmailcc').value = dsforexecute.Tables[0].Rows[z].EMAILID_CC;
}
else {
    document.getElementById('txtmailcc').value = "";
}	
			
			
			
			if(dsforexecute.Tables[0].Rows[z].TAN_No!=null)
			{
			document.getElementById('txttan').value=dsforexecute.Tables[0].Rows[z].TAN_No;
			}
			else
			{
			document.getElementById('txttan').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].PAN_No!=null)
			{
				document.getElementById('txtpan').value=dsforexecute.Tables[0].Rows[z].PAN_No;
				}
				else
				{
				document.getElementById('txtpan').value="";
				}
				
				if(dsforexecute.Tables[0].Rows[z].VAT ==0 || dsforexecute.Tables[0].Rows[z].VAT =="0" || dsforexecute.Tables[0].Rows[z].VAT ==""|| dsforexecute.Tables[0].Rows[z].VAT ==null)
			{
			 document.getElementById("chkvat").checked=false;
			}
			else
			{
			document.getElementById("chkvat").checked=true;

}

if (dsforexecute.Tables[0].Rows[z].BLANKCHEQUE == 0 || dsforexecute.Tables[0].Rows[z].BLANKCHEQUE == "0" || dsforexecute.Tables[0].Rows[z].BLANKCHEQUE == "" || dsforexecute.Tables[0].Rows[z].BLANKCHEQUE == null) {
    document.getElementById("chkcheque").checked = false;
}
else {
    document.getElementById("chkcheque").checked = true;

}
if (dsforexecute.Tables[0].Rows[z].SECURITYBOND == 0 || dsforexecute.Tables[0].Rows[z].SECURITYBOND == "0" || dsforexecute.Tables[0].Rows[z].SECURITYBOND == "" || dsforexecute.Tables[0].Rows[z].SECURITYBOND == null) {
    document.getElementById("chkbondrecvd").checked = false;
}
else {
    document.getElementById("chkbondrecvd").checked = true;

}
if (dsforexecute.Tables[0].Rows[z].KYCAPP == 0 || dsforexecute.Tables[0].Rows[0].KYCAPP == "0" || dsforexecute.Tables[z].Rows[z].KYCAPP == "" || dsforexecute.Tables[0].Rows[z].KYCAPP == null) {
    document.getElementById("chkyc").checked = false;
}
else {
    document.getElementById("chkyc").checked = true;

}
if (dsforexecute.Tables[0].Rows[z].ADDRESSPROOF == 0 || dsforexecute.Tables[0].Rows[z].ADDRESSPROOF == "0" || dsforexecute.Tables[0].Rows[z].ADDRESSPROOF == "" || dsforexecute.Tables[0].Rows[z].ADDRESSPROOF == null) {
    document.getElementById("chkadproof").checked = false;
}
else {
    document.getElementById("chkadproof").checked = true;

}
            if (dsforexecute.Tables[0].Rows[z].RATE_REVISE == 0 || dsforexecute.Tables[0].Rows[z].RATE_REVISE == "0" || dsforexecute.Tables[0].Rows[z].RATE_REVISE == "" || dsforexecute.Tables[0].Rows[z].RATE_REVISE == null) {
                document.getElementById("chkraterevise").checked = false;
            }
            else {
                document.getElementById("chkraterevise").checked = true;
            }
				
			//			drprepres.disabled=true;
			//			drpstatus.disabled=true;
			var compcode=document.getElementById('hiddencompcode').value;
            var userid=document.getElementById('hiddenuserid').value;
            Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,call_billto);
             Agent_master.bindbillto(document.getElementById('txtagencode').value,compcode,userid,billtodrpcall);
           // document.getElementById('txtbill').value=dsforexecute.Tables[0].Rows[z].BILL_TO;
            biltovar=dsforexecute.Tables[0].Rows[z].BILL_TO;
            varbiltocal=dsforexecute.Tables[0].Rows[z].acagency;
//			document.getElementById('txtbill').value=dsforexecute.Tables[0].Rows[z].BILL_TO;
//			document.getElementById('txtbill').value=dsforexecute.Tables[0].Rows[z].BILL_TO;
			
			//			drpsageo.disabled=true;
			if(dsforexecute.Tables[0].Rows[z].pin_code!=null)
			{
			document.getElementById('txtpincode').value=dsforexecute.Tables[0].Rows[z].pin_code;
			}
			else
			{
			document.getElementById('txtpincode').value="";
			}
			document.getElementById('txtstate').value=dsforexecute.Tables[0].Rows[z].State_Code;
			//string zip="246763";
			if(dsforexecute.Tables[0].Rows[z].Fax!=null)
			{
			document.getElementById('txtfax').value=dsforexecute.Tables[0].Rows[z].Fax;
			}
			else
			{
			document.getElementById('txtfax').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].fax1!=null)
			{
			document.getElementById('txtfax1').value=dsforexecute.Tables[0].Rows[z].fax1;
			}
			else
			{
			document.getElementById('txtfax1').value="";
			}
			var dateformat=document.getElementById('hiddendateformat').value;
			
			if(dsforexecute.Tables[0].Rows[z].Enroll_Date != null && dsforexecute.Tables[0].Rows[z].Enroll_Date != "")
			{
			var enrolldate=dsforexecute.Tables[0].Rows[z].Enroll_Date;
			var dd=enrolldate.getDate();
			var mm=enrolldate.getMonth() + 1;
			var yyyy=enrolldate.getFullYear();
			
			var enrolldate1=mm+'/'+dd+'/'+yyyy;
			var enrolldate1day=dd+'/'+mm+'/'+yyyy;
			var enrollyear=yyyy+'/'+mm+'/'+dd;
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtenrolldate').value=enrolldate1;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtenrolldate').value=enrollyear;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtenrolldate').value=enrolldate1day;
			}
			if(dateformat==null || dateformat=="")
			{
			document.getElementById('txtenrolldate').value=enrolldate1;
			}
			
			}
			else
			{
			
			//document.getElementById('txtenrolldate').value=dsforexecute.Tables[0].Rows[z].Enroll_Date;
			document.getElementById('txtenrolldate').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].No_of_VTS!=null)
			{
			document.getElementById('txtnoofvts').value=dsforexecute.Tables[0].Rows[z].No_of_VTS;
			}
			else
			{
			document.getElementById('txtnoofvts').value="";
			}
			document.getElementById('drpcity').value=dsforexecute.Tables[0].Rows[z].City_Code;
			
//			if(dsforexecute.Tables[1].Rows.length>0)
//{	
//    for(var i=0;i<dsforexecute.Tables[1].Rows.length;++i) 
//    {
//	    document.getElementById("drptaluka").options[i]=new Option(dsforexecute.Tables[1].Rows[i].TALU_NAME,dsforexecute.Tables[1].Rows[i].TALU_CODE);
//    }	
//}
show1="6";
 var talukabind = dsforexecute.Tables[0].Rows[z].Dist_Code;
bindtalu(talukabind);
//document.getElementById("drptaluka").value=dsforexecute.Tables[0].Rows[z].TALUKA;
			document.getElementById('drpregion').value=dsforexecute.Tables[0].Rows[z].region;
			//document.getElementById('drpregion').value="991";
			if(dsforexecute.Tables[0].Rows[z].CREDIT_LIMIT!=null)
			{
			document.getElementById('txtcrlimit').value=dsforexecute.Tables[0].Rows[z].CREDIT_LIMIT;
			}
			else
			{
			document.getElementById('txtcrlimit').value="";
			}
//			if(dsforexecute.Tables[0].Rows[z].TALUKA!=null)
//			{
//			document.getElementById('drptaluka').value=dsforexecute.Tables[0].Rows[z].TALUKA;
//			}
//			else
//			{
//			document.getElementById('drptaluka').value="";
//			}
			//document.getElementById('Status').visible=true;
			
			//document.getElementById('StatusDate').styles.display="none";
			//StatusDate.style.display="visible";
			
			
//			var todate=dsforexecute.Tables[0].Rows[z].to_date;
//			var currdate=dsforexecute.Tables[0].Rows[z].current_Datetime;
//			var tdate=new Date(todate);
//			var cdate=new Date(currdate);
//			
//			var dd=currdate.getDate();
//			var mm=currdate.getMonth() + 1;
//			var yyyy=currdate.getFullYear();
//			
//			var currdate1=mm+'/'+dd+'/'+yyyy;
//			var currda=dd+'/'+mm+'/'+yyyy;
//			var curryear=yyyy+'/'+mm+'/'+dd;
//			
//			
//			
//		
//			if(cdate > tdate && todate!= null )
//			{
//			document.getElementById('txtstatus').value="Banned";
//			}
//			else if(todate == null && dsforexecute.Tables[0].Rows[z].status_name==null)
//			{
//			document.getElementById('txtstatus').value="Active";
//			}
//			else
//			{
//			
//			document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[z].status_name;
//			}




                    
            var todate=dsforexecute.Tables[0].Rows[z].to_date;
			var from_date=dsforexecute.Tables[0].Rows[z].FROM_DATE;
			
			var currdate=dsforexecute.Tables[0].Rows[z].current_Datetime;
			var tdate=new Date(todate);
			var cdate=new Date(currdate);
			
			var dd=currdate.getDate();
			var mm=currdate.getMonth() + 1;
			var yyyy=currdate.getFullYear();
			
			var currdate1=mm+'/'+dd+'/'+yyyy;
			var currda=dd+'/'+mm+'/'+yyyy;
			var curryear=yyyy+'/'+mm+'/'+dd;
			
	
		

    /* previous code for status changed by saurabh Agarwal---------------------------------------		
		
			if(cdate > tdate && todate!= null )
			{
			document.getElementById('txtstatus').value="Banned";
			}
			else if(todate == null && dsforexecute.Tables[0].Rows[0].status_name==null)
			{
			document.getElementById('txtstatus').value="Active";
			}
			else
			{
			
			document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[0].status_name;
			}
	*///---------------------------------------------------------------------------------------------
	
	
		//------------------------saurabh code for status---------------------
		
		var cur=new Date();
		
		if((dsforexecute.Tables[0].Rows[z].status_name!=null)||(dsforexecute.Tables[0].Rows[z].status_name!=""))
		{
		    if(cur>=from_date && cur<=todate)
		    {
			    document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[z].status_name;
			}
			else
			{
			    document.getElementById('txtstatus').value="Active";
			}
			
		}
		else
		{
		    document.getElementById('txtstatus').value="Active";
		}
		
		if(dsforexecute.Tables[0].Rows[z].from_date=="" || dsforexecute.Tables[0].Rows[z].from_date==null || dsforexecute.Tables[0].Rows[z].to_date=="" || dsforexecute.Tables[0].Rows[z].to_date==null)
		{
		    document.getElementById('txtstatus').value="Active";
		}
		//-----------------------------------------------------------------------
		
		
		
		

			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtstatusdate').value=currdate1;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtstatusdate').value=currda;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtstatusdate').value=curryear;
			}
			if(dateformat==null || dateformat=="" || dateformat=="undefined")
			{
			document.getElementById('txtstatusdate').value=currdate1;
			}
			//document.getElementById('txtstatus').value=dsforexecute.Tables[0].Rows[0].current_Datetime;
			
			if(dsforexecute.Tables[0].Rows[z].Buss_Start_Date != null && dsforexecute.Tables[0].Rows[z].Buss_Start_Date != "")
			{
			var bussdate=dsforexecute.Tables[0].Rows[z].Buss_Start_Date;
			var dd=bussdate.getDate();
			var mm=bussdate.getMonth() + 1;
			var yyyy=bussdate.getFullYear();
			
			var bussdate1=mm+'/'+dd+'/'+yyyy;
			var bussdate1day=dd+'/'+mm+'/'+yyyy;
			var bussyear=yyyy+'/'+mm+'/'+dd;
			
			
			if(dateformat=="mm/dd/yyyy")
			{
			document.getElementById('txtbusineedate').value=bussdate1;
			}
			if(dateformat=="yyyy/mm/dd")
			{
			document.getElementById('txtbusineedate').value=bussyear;
			}
			if(dateformat=="dd/mm/yyyy")
			{
			document.getElementById('txtbusineedate').value=bussdate1day;
			
			
			}
			if(dateformat==null || dateformat=="")
			{
			document.getElementById('txtbusineedate').value=bussdate1;
			}
			}
			else
			{
			
			//document.getElementById('txtbusineedate').value=dsforexecute.Tables[0].Rows[z].Buss_Start_Date;
			document.getElementById('txtbusineedate').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].MRV_Ref_No!=null)
			{
			document.getElementById('txtmryrefno').value=dsforexecute.Tables[0].Rows[z].MRV_Ref_No;
			}
			else
			{
			document.getElementById('txtmryrefno').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].Credit_Days!=null)
			{
			document.getElementById('txtcredit').value=dsforexecute.Tables[0].Rows[z].Credit_Days;
			}
			else
			{
			document.getElementById('txtcredit').value="";
			}
			if(dsforexecute.Tables[0].Rows[z].ST_ACC_No!=null)
			{
			document.getElementById('txtstacno').value=dsforexecute.Tables[0].Rows[z].ST_ACC_No;
			}
			else
			{
				document.getElementById('txtstacno').value="";
			}
}


setButtonImages();

return false;
}



var popUpWin=null;
function contact()
{ 
// if(document.getElementById('lbcontactdetails').value==false)
// {
  
  var agecode=document.getElementById('txtagencode').value;
	var hidden=document.getElementById('hiddentxt').value;
	var agencysubcode=document.getElementById('txtsagencycode').value;


    if(popUpWin && !popUpWin.closed)
    {
    popUpWin.focus();
    return false;
    }

else
{
	if(document.getElementById('hiddencompcode').value != null && document.getElementById('hiddencompcode').value != "")
	{
	if(agecode=="")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtagencode').focus();
	return false;
	}
	else if(agencysubcode=="")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtsagencycode').focus();
	return false;
	}
	else if(document.getElementById('txtagenname').value=="")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtagenname').focus();
	return false;
	}
	else if(document.getElementById('drpagetyp').value==""  || document.getElementById('drpagetyp').value=="0")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('drpagetyp').focus();
	return false;
	}
	else if(document.getElementById('txtcountry').value=="0")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtcountry').focus();
	return false;
	}
	
    popUpWin 
     = window.open('contact_detail.aspx?agencysubcode='+agencysubcode+'&show='+show+'&agecode='+agecode,'Ankur','resizable=0,toolbar=0,top=244,left=210,scrollbars=yes,width=780px,height=415px'); 
     

     //alert(popUpWin.value);
    popUpWin.focus();
    }
    else
    {
    alert("Your Session has been expired.");
    return false;
    }
}
     return false;
  
//}
} 

var popUpWin1=null;


function commission()
{ 

  
  
 var drpagetyp=document.getElementById('drpagetyp').value;;
  var agecode=document.getElementById('txtagencode').value;
	var hidden=document.getElementById('hiddentxt').value;
	var agencysubcode=document.getElementById('txtsagencycode').value;
	if(popUpWin1 && !popUpWin1.closed)
	{
	 popUpWin1.focus();
	return false;
	}
	else
	{
	
	if(agecode=="")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtagencode').focus();
	return false;
	}
	else if(agencysubcode=="")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtsagencycode').focus();
	return false;
	}
	else if(document.getElementById('txtagenname').value=="")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtagenname').focus();
	return false;
	}
	else if(document.getElementById('drpagetyp').value=="" || document.getElementById('drpagetyp').value=="0")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('drpagetyp').focus();
	return false;
	}
	else if(document.getElementById('txtcountry').value=="0")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtcountry').focus();
	return false;
	}
	
	
	
    popUpWin1 
     = window.open('Comm_detail.aspx?show='+show+'&drpagetyp='+drpagetyp+'&agencysubcode='+agencysubcode+'&agecode='+agecode,'Ankur1', 'toolbar=0,resizable=0,top=244,left=210,scrollbars=yes,width=780px,height=415px'); 
  popUpWin1.focus();
  }
     return false;
  

} 

var popUpWin2=null;
function  bank()
{ 

  
 
  var agecode=document.getElementById('txtagencode').value;
	var agencysubcode=document.getElementById('txtsagencycode').value;
	if(popUpWin2 && !popUpWin2.closed)
	{
	popUpWin2.focus();
	return false;
	}
	else
	{
	
	if(agecode=="")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtagencode').focus();
	return false;
	}
	else if(agencysubcode=="")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtsagencycode').focus();
	return false;
	}
	else if(document.getElementById('txtagenname').value=="")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtagenname').focus();
	return false;
	}
	else if(document.getElementById('drpagetyp').value==""  || document.getElementById('drpagetyp').value=="0")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('drpagetyp').focus();
	return false;
	}
	else if(document.getElementById('txtcountry').value=="0")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtcountry').focus();
	return false;
	}
	
	
    popUpWin2  = window.open('bank_detail.aspx?agencysubcode='+agencysubcode+'&show='+show+'&agecode='+agecode,'Ankur2', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=244,left=210,width=780px,height=415px'); 
  popUpWin2.focus();
  }
     return false;
 

} 


var popUpWin3=null;
function  status123()
{ 

  
 var drpagetyp=document.getElementById('drpagetyp').value;
var agecode=document.getElementById('txtagencode').value;
var agencysubcode=document.getElementById('txtsagencycode').value;
if(popUpWin3 && !popUpWin3.closed)
{
popUpWin3.focus();
return false;
}
else
{

if(agecode=="")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtagencode').focus();
	return false;
	}
	else if(agencysubcode=="")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtsagencycode').focus();
	return false;
	}
	else if(document.getElementById('txtagenname').value=="")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtagenname').focus();
	return false;
	}
	else if(document.getElementById('drpagetyp').value==""  || document.getElementById('drpagetyp').value=="0")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('drpagetyp').focus();
	return false;
	}
	else if(document.getElementById('txtcountry').value=="0")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtcountry').focus();
	return false;
	}


    popUpWin3=window.open('status_detail.aspx?agencysubcode='+agencysubcode+'&show='+show+'&drpagetyp='+drpagetyp+'&agecode='+agecode,'Ankur3', 'status=0,toolbar=0,resizable=0,top=244,left=210,scrollbars=yes,width=780px,height=415px'); 
    popUpWin3.focus();
}
     return false;
 

} 

var popUpWin4=null;
function  paymode()
{ 

  
 
var agecode=document.getElementById('txtagencode').value;
var agencysubcode=document.getElementById('txtsagencycode').value;
var akhil=document.getElementById('hiddenexecute').value;
if(popUpWin4 && !popUpWin4.closed)
{

popUpWin4.focus();
return false;
}
else
{

    if(agecode=="")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtagencode').focus();
	return false;
	}
	else if(agencysubcode=="")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtsagencycode').focus();
	return false;
	}
	else if(document.getElementById('txtagenname').value=="")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtagenname').focus();
	return false;
	}
	else if(document.getElementById('drpagetyp').value==""  || document.getElementById('drpagetyp').value=="0")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('drpagetyp').focus();
	return false;
	}
	else if(document.getElementById('txtcountry').value=="0")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtcountry').focus();
	return false;
	}

//    if(document.getElementById('hiddenbhanu').value=="0")
//     saurabh="2";

    popUpWin4  = window.open('agentpaymode.aspx?agencysubcode='+agencysubcode+'&akhil='+akhil+'&show='+show+'&saurabh='+saurabh+'&agecode='+agecode,'Ankur4', 'status=0,toolbar=0,resizable=0,top=244,left=210,scrollbars=yes,width=780px,height=415px'); 
    popUpWin4.focus();
    document.getElementById('hiddenbhanu').value="1";
}

return false;
  

} 



function exitclick()
{
if(confirm("Do You Want To Skip This Page"))
{


		if(popUpWin && !popUpWin.closed)
		{
		
		popUpWin.close();
		}
		if(popUpWin1 && !popUpWin1.closed)
		{
		popUpWin1.close();
		}
		if(popUpWin2 && !popUpWin2.closed)
		{
		popUpWin2.close();
		}
		if(popUpWin3 && !popUpWin3.closed)
		{
		popUpWin3.close();
		}
		if(popUpWin4 && !popUpWin4.closed)
		{
		popUpWin4.close();
		}
		if(popUpWinbank && !popUpWinbank.closed)
		{
		popUpWinbank.close();
		}

//window.location.href='EnterPage.aspx';
window.close();

return false;
}
return false;
}

function addcount(cou)
{
    document.getElementById('txtdistrict').value="";
    document.getElementById('txtstate').value="";
    document.getElementById('drpregion').value="0";
    document.getElementById('drpzone').value="0";
    document.getElementById('drptaluka').value="0";
if(typeof(cou)=="object")
{
var country=cou.value;
}
else
{
var country=cou;
}
//var country=document.getElementById('txtcountry').value;
if(country!="0")
{
Agent_master.addcou(country,callcount);
}
else
{
document.getElementById("drpcity").options.length = 1;
}
return false;
}

function callcount(res)
{

var ds=res.value;
var pkgitem = document.getElementById("drpcity");
if(ds!= null && typeof(ds) == "object" && ds.Tables[0].Rows.length > 0) 
{
     if(document.getElementById('hiddensaurabh').value=="1")
        {
        document.getElementById('drpcity').disabled=false;
        }

//alert(pkgitem);
    pkgitem.options.length = 1; 
    pkgitem.options[0]=new Option("--Select City--","0");
    //alert(pkgitem.options.length);
    for (var i = 0  ; i < res.value.Tables[0].Rows.length; ++i)
    {
        pkgitem.options[pkgitem.options.length] = new Option(res.value.Tables[0].Rows[i].City_Name,res.value.Tables[0].Rows[i].City_Code);
        
       pkgitem.options.length;
       
    }
    //alert(cityvar);
 if(cityvar == undefined || cityvar=="")
 {
  document.getElementById('drpcity').value="0";
 
 }
 else
 {
  document.getElementById('drpcity').value=cityvar;
  addregcity();
  cityvar="";
  } 
}
else
{


pkgitem.options[0]=new Option("--Select City--","0");

if(document.getElementById('txtcountry').disabled==false)
{
alert("There is no matching value(s) found");
}
pkgitem.options.length=1;
pkgitem.options[0]=new Option("--Select City--","0");
addregcity();
document.getElementById('drpcity').value="0";
document.getElementById('drpregion').value="0";
document.getElementById('drpzone').value="0";
document.getElementById('txtdistrict').value="";
//document.getElementById('Statecode12').value="";
document.getElementById('txtstate').value="";
return false;

}

return false;
}




function addregcity()
{
    document.getElementById('txtdistrict').value="";
    document.getElementById('txtstate').value="";
    document.getElementById('drpregion').value="0";
    document.getElementById('drpzone').value="0";
    document.getElementById('drptaluka').value="0";
    document.getElementById('hiddenstatecode').value="";
    document.getElementById('hiddendistcode').value="";
	if(document.getElementById("drpcity").value!="0" ||document.getElementById("drpcity").value!="")		
	{
      Agent_master.addreg(document.getElementById("drpcity").value,FillDropDownList_CallBackMaindoc);
    }
			
			return false;
}





			
			function FillDropDownList_CallBackMaindoc(response) 
			{
			
				var ds = response.value;
				
				var cou="INDIA";	
				//alert(response);	
				var region=document.getElementById('drpregion');
				var taluka=document.getElementById('drptaluka');
					
				var zone=document.getElementById('drpzone');
			
//----------------------------------Previous Code Changed By saurabh Agarwal------------------------			
			/*
				
			if(ds!= null && typeof(ds) == "object" && ds.Tables!= null) 
			{			
				region.options.length=1;
				region.options[0]=new Option("--Select Region","0");
				//region.options.length=ds.Tables[2].Rows.length;
				//alert((document.getElementById("drpregion").options.length));	
				//alert(ds.Tables[0].Rows.length);
				for(var i=0;i<ds.Tables[2].Rows.length;++i) 
				{
					region.options[region.options.length]=new Option(ds.Tables[2].Rows[i].region_name,ds.Tables[2].Rows[i].region_code);
					region.value=ds.Tables[3].Rows[0].region_code;
				}	
					//alert(ds.Tables[].Rows[i].region_code);
				//	txtagencyho
					//txtsugagencyho
				
					document.getElementById("hiddenregion").value=document.getElementById("drpregion").value;
					//alert(document.getElementById("hiddenregion").value);
					document.getElementById('txtstate').value=ds.Tables[0].Rows[0].state_name;
					//alert(ds.Tables[3].Rows[i].Country_Name);
					//document.getElementById('txtcountry').value=ds.Tables[3].Rows[i].Country_Name;
					document.getElementById('txtdistrict').value=ds.Tables[1].Rows[0].dist_name;
					
					
					
					
					//document.getElementById('txtagencyho').value=ds.Tables[4].Rows[0].city_name;
					if(document.getElementById('drpparent').value=="P")
					{
					document.getElementById('txtagencyho').value=ds.Tables[4].Rows[0].city_name;
					
					}
					cityselected=ds.Tables[4].Rows[0].city_name;
					if(selbitocity=="" && hiddentext=="new")
					{
					
					document.getElementById('txtsugagencyho').value=ds.Tables[4].Rows[0].city_name;
					}
					if(ds.Tables[5].Rows[0].zone_code!=null || ds.Tables[5].Rows[0].zone_code!="")
					{
						document.getElementById('drpzone').value=ds.Tables[5].Rows[0].zone_code;
					}	
					
				
			}
			*/
//------------------------------------------------------Change Over---------------------------------------			
			
			
//----------------------------------New Code Added By saurabh Agarwal------------------------						

if(document.getElementById('drpcity').value!="0" && document.getElementById('drpcity').value!="")
{
	if(ds!= null && typeof(ds) == "object" && ds.Tables!= null) 
		{	
//			if(ds.Tables.length>4)		
//			{
				document.getElementById("drpzone").options[0]=new Option("------Select Zone------","0");
				document.getElementById("drpregion").options[0]=new Option("-----Select Region-----","0");
				document.getElementById("drptaluka").options[0]=new Option("-----Select taluka-----","0");
				document.getElementById("drpregion").options.length=0;		
				document.getElementById("drpregion").options.length=ds.Tables[2].Rows.length;
				
				document.getElementById("drpzone").options.length=0;		
				document.getElementById("drpzone").options.length=ds.Tables[3].Rows.length;
				
				document.getElementById("drptaluka").options.length=0;		
				document.getElementById("drptaluka").options.length=ds.Tables[7].Rows.length;
				
				
				
				//alert((document.getElementById("drpregion").options.length));	
				//alert(ds.Tables[0].Rows.length);
    		        if(ds.Tables[3].Rows.length>0)
    		        {	
    				for(var i=0;i<ds.Tables[2].Rows.length;++i) 
	    			{
    					document.getElementById("drpregion").options[i]=new Option(ds.Tables[2].Rows[i].region_name,ds.Tables[2].Rows[i].region_code);
	    			}	
	    			    if(regionvar!="" && regionvar!=undefined)
	    			    document.getElementById('drpregion').value=regionvar;
	    			    else
	    			    document.getElementById('drpregion').value=ds.Tables[3].Rows[0].region_code;
	    			    regionvar="";
	        	    }
        		    else
                    {
                       if(document.getElementById('drpcity').disabled==false)
                       {
                           // alert("There is no matching value(s) found for region");
                       }
                       //document.getElementById('drpregion').disabled=true;
                       region.options.length=0;
                       regionvar="";
                       //return false;

                    }	
				
					//document.getElementById("hiddenregion").value=document.getElementById("drpregion").value;
			
			
					if(ds.Tables[0].Rows.length>0)
					{
					document.getElementById('txtstate').value=ds.Tables[0].Rows[0].state_name;
					if(document.getElementById('txtstate').value!="")
					document.getElementById('hiddenstatecode').value=ds.Tables[0].Rows[0].state_code;
					else
					document.getElementById('hiddenstatecode').value="";
					}
					else
				    {
				    if(document.getElementById('drpcity').disabled==false)
                    {
				        //alert("There is no matching value for state");
				    }
				   document.getElementById('txtstate').value="";
				    //document.getElementById('txtstate').disabled=true;
				    
				    }
					
				
				
					if(ds.Tables[4].Rows.length>0)
					{
					 //alert(ds.Tables[1].Rows[0].dist_name);
					    if(ds.Tables[1].Rows.length>0)
					        document.getElementById('txtdistrict').value=ds.Tables[1].Rows[0].dist_name;
					        if(document.getElementById('txtdistrict').value!="")
					        document.getElementById('hiddendistcode').value=ds.Tables[1].Rows[0].dist_code;
					        else
					        document.getElementById('hiddendistcode').value="";
					}
					else
				    {
				    if(document.getElementById('drpcity').disabled==false)
                    {
				        //alert("There is no matching value for district");
				    }
				    document.getElementById('txtdistrict').value="";
			
				    }
					
				if(ds.Tables[7].Rows.length>0)
    		        {	
    				for(var i=0;i<ds.Tables[7].Rows.length;++i) 
	    			{
    					document.getElementById("drptaluka").options[i]=new Option(ds.Tables[7].Rows[i].talu_name,ds.Tables[7].Rows[i].talu_code);
	    			}	
	    			 if(talukavar!="" && talukavar!=undefined)
	    			 document.getElementById('drptaluka').value=talukavar;
	    			 else
	    			document.getElementById('drptaluka').value=ds.Tables[7].Rows[0].talu_code;
	    			
	        	    }
        		    else
                    {
                       if(document.getElementById('drpcity').disabled==false)
                       {
                            //alert("There is no matching value(s) found for region");change due to no region in city master
                       }
                       //document.getElementById('drpregion').disabled=true;
                       taluka.options.length=0;
                       //return false;

                    }
				
				//	PubCatMast.addzone();
				
		//		if(ds.Tables[2].Rows.length>0)
		//		{
		//		    for(var j=0;j<ds.Tables[5].Rows.length;++j) 
		//		    {
		//	    		document.forms[0].item("drpregion").options[j]=new Option(ds.Tables[2].Rows[j].region_name,ds.Tables[2].Rows[j].region_code);
		//		    }
		//		    document.getElementById('drpregion').value=ds.Tables[3].Rows[0].region_code;
		//		}
//				else
//                {
//                    alert("There is no matching value(s) found for region");
//                    region.options.length=0;
//                    return false;

//                }
				
				
				
//				if(ds.Tables[5].Rows.length>0)
//				{
////					document.getElementById('drpzone').value=ds.Tables[5].Rows[0].zone_code;
//				}
//				else
//                {
//                    alert("There is no matching value(s) found for Zone");
//                    zone.options.length=0;
//                    return false;

//                }	
					
					// saurabh Change
					
					if(ds.Tables[5].Rows.length>0)
    		        {	
    				for(var i=0;i<ds.Tables[4].Rows.length;++i) 
	    			{
    					document.getElementById("drpzone").options[i]=new Option(ds.Tables[4].Rows[i].zone_name,ds.Tables[4].Rows[i].zone_code);
	    			}	
	    			    if(zonevar!="" && zonevar!=undefined)
	    			    document.getElementById('drpzone').value=zonevar;
	    			    else
	    			    document.getElementById('drpzone').value=ds.Tables[5].Rows[0].zone_code;
	    			    zonevar="";
	        	    }
        		    else
                    {
                    if(document.getElementById('drpcity').disabled==false)
                    {
                       //alert("There is no matching value(s) found for Zone");
                    }
                       zone.options.length=0;
                       zonevar="";
                    //   document.getElementById('drpzone').disabled=true;
                       return false;
                    }
										
					if(document.getElementById('hiddensaurabh').value=="1")
                    {
                        document.getElementById('drpregion').disabled=false;
                        document.getElementById('drpzone').disabled=false;
                    }
					
//				}	
				
			}
					
				
		}	
		//document.getElementById('txtdistrict').value="";

//-------------------------------------------Addition Over--------------------------------------------------			
			
			return false;			
			}
			
			
			
			
var popUpWinbank=null;		
function bankmast()
{ 
 
  
  var agecode=document.getElementById('txtagencode').value;
	var hidden=document.getElementById('hiddentxt').value;
	var agencysubcode=document.getElementById('txtsagencycode').value;
	if(popUpWinbank && !popUpWinbank.closed)
	{
	 popUpWinbank.focus();
	return false;
	}
else
{
	if(document.getElementById('hiddencompcode').value != null && document.getElementById('hiddencompcode').value != "")
	{
	
	if(agecode=="")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtagencode').focus();
	return false;
	}
	else if(agencysubcode=="")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtsagencycode').focus();
	return false;
	}
	else if(document.getElementById('txtagenname').value=="")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtagenname').focus();
	return false;
	}
	else if(document.getElementById('drpagetyp').value==""  || document.getElementById('drpagetyp').value=="0")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('drpagetyp').focus();
	return false;
	}
	else if(document.getElementById('txtcountry').value=="0")
	{
	alert("Please Fill All Mandatory Fields");
	//document.getElementById('txtcountry').focus();
	return false;
	}
	
	
	
    popUpWinbank 
     = window.open('bank_master.aspx?agencysubcode='+agencysubcode+'&show='+show+'&agecode='+agecode,'Ankur5','resizable=1,toolbar=0,top=244,left=210,scrollbars=yes,width=780px,height=415px'); 
    popUpWinbank.focus();
    }
    else
    {
    alert("Your session has been expired.");
    return false;
    }
}    
  
return false;
} 





//function call_billto(response)
//{
//var ds=response.value;

//var bill = document.getElementById("txtbill");
//bill.options.length = 0; 
//if(ds.Tables[0].Rows.length <= 0)
//{
//bill.options[bill.options.length] = new Option(document.getElementById('txtagenname').value,document.getElementById('txtagenname').value);
//bill.options.length;
//return false;

//}
//else
//{
//    
//    //alert(pkgitem.options.length);
//    for (var i = 0  ; i < ds.Tables[0].Rows.length; ++i)
//    {
//        bill.options[bill.options.length] = new Option(ds.Tables[0].Rows[i].Agency_Name,ds.Tables[0].Rows[i].Agency_Name);
//        
//       bill.options.length;
//       
//    }

//}

//return false;
//}


function addcategory(agentype)
{
var agencytype=agentype;
Agent_master.category(agencytype,fillcategory)
return false;
}
function fillcategory(res)
{

var ds=res.value;

if(ds!= null && typeof(ds) == "object" && ds.Tables[0].Rows.length > 0) 
{

agcatby = document.getElementById("drpagecate");
//alert(pkgitem);
    agcatby.options.length = 1; 
    agcatby.options[0]=new Option("--Select Category--","0");
    //alert(pkgitem.options.length);
    for (var i = 0  ; i < res.value.Tables[0].Rows.length; ++i)
    {
        agcatby.options[agcatby.options.length] = new Option(res.value.Tables[0].Rows[i].Agency_Cat_Name,res.value.Tables[0].Rows[i].Agency_Cat_Code);
        
       agcatby.options.length;
       
    }
    //alert(cityvar);
         if(catvar == undefined || catvar=="")
         {
          document.getElementById('drpagecate').value="0";
         
         }
         else
         {
          document.getElementById('drpagecate').value=catvar;
          catvar="";
          } 
}
else
{
//alert("There is No Matching value Found");


return false;

}

//addsubcategory(subcat);
return false;
}


function addsubcategory(agencat)
{
 if(agencat==null || agencat=='null')
 {
    agencat="";
 }
if(typeof(agencat)=="object")
{
var subagencytype=agencat.value;
}
else
{
var subagencytype=agencat;
}
Agent_master.subcat(subagencytype,fillsubcategory)

return false;
}


function fillsubcategory(res)
{
var ds=res.value;

if(ds!= null && typeof(ds) == "object" && ds.Tables[0].Rows.length > 0) 
{

 subcat = document.getElementById("drpagescat");
//alert(pkgitem);
    subcat.options.length = 1; 
    subcat.options[0]=new Option("--Select Sub Category--","0");
    //alert(pkgitem.options.length);
    for (var i = 0  ; i < res.value.Tables[0].Rows.length; ++i)
    {
        subcat.options[subcat.options.length] = new Option(res.value.Tables[0].Rows[i].Agency_SubCat_Name,res.value.Tables[0].Rows[i].Agency_SubCat_Code);
        
       subcat.options.length;
       
    }
    document.getElementById('txtcredit').value=ds.Tables[1].Rows[0].creditdays;
    //alert(cityvar);
         if(catvar == undefined || catvar=="")
         {
          document.getElementById('drpagescat').value="0";
         
         }
         else
         {
          document.getElementById('drpagescat').value=catvar;
          catvar="";
          } 
}
else
{
//alert("There is No Matching value Found");
return false;

}
return false;
}




function fillcreditdays()
{
   if(hiddentext=="new"|| hiddentext=="query")
    {
        //alert(document.getElementById('drpagetyp').value);
        var agtype=document.getElementById('drpagetyp').value;
        if(document.getElementById('drpagetyp').value!="0")
        {
            Agent_master.credday(agtype,fillcredit)
            Agent_master.addagencycategorybind(agtype,bincat_callback)
        }
         else
    
    {
      var agtype=document.getElementById('drpagetyp').value;
        if(document.getElementById('drpagetyp').value!="0")
        {
           
            Agent_master.addagencycategorybind(agtype,bincat_callback)
        }

    
    }
    }
    else
    
    {
      var agtype=document.getElementById('drpagetyp').value;
        if(document.getElementById('drpagetyp').value!="0")
        {
           
            Agent_master.addagencycategorybind(agtype,bincat_callback)
        }

    
    }
    
    
    
    
    return false;
}

function bincat_callback(res) {
    ds=res.value;  
    var drcat=document.getElementById("drpagecate");  
 drcat.options.length=0;
    drcat.options[0]=new Option("--Select Category--","0");
    if(ds!=null&&ds!="")
    {
    if(ds.Tables[0].Rows.length>0)
        {
            for (var i = 0  ; i < ds.Tables[0].Rows.length; ++i)
            {
                drcat.options[drcat.options.length] = new Option(ds.Tables[0].Rows[i].Agency_Cat_Name,ds.Tables[0].Rows[i].Agency_Cat_Code);
                drcat.options.length;   
            }
        }
    }
       return false;
}


function fillcredit(res)
{
    var ds= res.value;

    document.getElementById('txtcredit').value=ds.Tables[0].Rows[0].Creditdays;
    
     document.getElementById('hiddenmrv').value=ds.Tables[0].Rows[0].MRVREF;

    return false;
}





///////////////sorting of a drop down

function keySort(dropdownlist,caseSensitive) {
  // check the keypressBuffer attribute is defined on the dropdownlist 
  var undefined; 
  if (dropdownlist.keypressBuffer == undefined) { 
    dropdownlist.keypressBuffer = ''; 
  } 
  // get the key that was pressed 
  var key = String.fromCharCode(window.event.keyCode); 
  dropdownlist.keypressBuffer += key;
  if (!caseSensitive) {
    // convert buffer to lowercase
    dropdownlist.keypressBuffer = dropdownlist.keypressBuffer.toLowerCase();
  }
  // find if it is the start of any of the options 
  var optionsLength = dropdownlist.options.length; 
  for (var n=0; n<optionsLength; n++) { 
    var optionText = dropdownlist.options[n].text; 
    if (!caseSensitive) {
      optionText = optionText.toLowerCase();
    }
    if (optionText.indexOf(dropdownlist.keypressBuffer,0) == 0) { 
      dropdownlist.selectedIndex = n; 
      return false; // cancel the default behavior since 
                    // we have selected our own value 
    } 
  } 
  // reset initial key to be inline with default behavior 
  dropdownlist.keypressBuffer = key; 
  return true; // give default behavior 
} 
/////////////////////////////////////////////////////////////////////////////


	function agencyclientdate(event)
		{
		if(browser!="Microsoft Internet Explorer")
 {
  if ((event.which>=48 && event.which<=57)||(event.which==47)||(event.which==11) || (event.which==8)||(event.which==9))
     {

       return true;
     }
    else
     {
       return false;
     }
 }
 else
 {
   if ((event.keyCode>=48 && event.keyCode<=57)||(event.keyCode==47)||(event.keyCode==11))
   {

       return true;
   }
   else
   {
       return false;
   }
  }
}
	
	
	//-----------------------------------------------------------------------------------
	
	//                          Saurabh Code for Payment Mode Pop Up
	
	//------------------------------------------------------------------------------------
	
	function paymodesubmit()
    {
	var chkList234= document.getElementById("rdolistsubmit");
	var count_chk=0;
	
	var str;

	var arrayOfCheckBoxes= chkList234.getElementsByTagName("input");
		

	for(var j=0;j<arrayOfCheckBoxes.length;j++)
	{
		if(arrayOfCheckBoxes[j].checked==true)
			{
			count_chk=1;
			break;
			}
			else
			{
			count_chk=0;
			}
	}
	if(count_chk==0)
	{
		alert('Please Check One Mode of Payment');
		return false;
	}
	else
	{
	
		var compcode=document.getElementById('hiddencomcode').value;
		//var custcode=document.getElementById('hiddenclientcode').value; 
		var userid = document.getElementById('hiddenuserid').value; 
		
		for(var i=0;i<arrayOfCheckBoxes.length;i++)
		{
			if(arrayOfCheckBoxes[i].checked==true)
			{
				
				str=arrayOfCheckBoxes[i].value;
		
			}
		}
		return;
		document.getElementById("rdolistsubmit").disabled=true;
		document.getElementById("btnSubmit").disabled=true;
		
	}

	return false;
}


//Client Refereshed Data

function ClientPayModeUpdatedData()
{
	
	var chkListSubmit= document.getElementById("rdolistsubmit");
	var arrayOfCheckBoxesSubmit= chkListSubmit.getElementsByTagName("input");
	
	var chklstUpdate= document.getElementById("rdolistupdate");
	var arrayOfCheckBoxesUpdate= chklstUpdate.getElementsByTagName("input");
	
	var compcode=document.getElementById('hiddencomcode').value;
	//var custcode=document.getElementById('hiddenclientcode').value; 
	var userid = document.getElementById('hiddenuserid').value; 
		
	for(var i =0;i<=arrayOfCheckBoxesSubmit.length-1;i++)
	{
		if(arrayOfCheckBoxesSubmit[i].checked==true)
		{
			arrayOfCheckBoxesUpdate[i].checked=true;
		}
	}
	
	document.getElementById("rdolistupdate").disabled=false;
	document.getElementById("btnUpdate").disabled=false;
	return false;
}


//Updating Values 


function paymodeupdate()
{
	var chkList234= document.getElementById("rdolistupdate");
	var count_chk=0;

	var str;

	var arrayOfCheckBoxes= chkList234.getElementsByTagName("input");
		

	for(var j=0;j<arrayOfCheckBoxes.length;j++)
	{
		if(arrayOfCheckBoxes[j].checked==true)
			{
			count_chk=1;
			break;
			}
			else
			{
			count_chk=0;
			}
	}
	if(count_chk==0)
	{
		alert('Please Check One Mode of Payment');
		return false;
	}
	else
	{
	
		var compcode=document.getElementById('hiddencomcode').value;
	
		var agecode=document.getElementById('txtagencode').value;
	
	    var agencysubcode=document.getElementById('txtsagencycode').value;
	    
		var userid = document.getElementById('hiddenuserid').value; 
		
		for(var i=0;i<arrayOfCheckBoxes.length;i++)
		{
			if(arrayOfCheckBoxes[i].checked==true)
			{
				
				str=arrayOfCheckBoxes[i].value;
		
			}
		}
		
		ClientPaymode.AgencyPayModeInsert(compcode,agecode,agencysubcode,userid,str);
	
	}
	return false;
}

function keySort(dropdownlist,caseSensitive) {
  // check the keypressBuffer attribute is defined on the dropdownlist 
  var undefined; 
  if (dropdownlist.keypressBuffer == undefined) { 
    dropdownlist.keypressBuffer = ''; 
  } 
  // get the key that was pressed 
  var key = String.fromCharCode(window.event.keyCode); 
  dropdownlist.keypressBuffer += key;
  if (!caseSensitive) {
    // convert buffer to lowercase
    dropdownlist.keypressBuffer = dropdownlist.keypressBuffer.toLowerCase();
  }
  // find if it is the start of any of the options 
  var optionsLength = dropdownlist.options.length; 
  for (var n=0; n<optionsLength; n++) { 
    var optionText = dropdownlist.options[n].text; 
    if (!caseSensitive) {
      optionText = optionText.toLowerCase();
    }
    if (optionText.indexOf(dropdownlist.keypressBuffer,0) == 0) { 
      dropdownlist.selectedIndex = n; 
      return false; // cancel the default behavior since 
                    // we have selected our own value 
    } 
  } 
  // reset initial key to be inline with default behavior 
  dropdownlist.keypressBuffer = key; 
  return true; // give default behavior 
} 	

//function insertagency(event) {
//    var browser = navigator.appName;
//    
//   var key = event.keyCode ? event.keyCode : event.which; 
//    if (key == 13 || event.type == "click") 
//    {
//        if (document.activeElement.id == "lstagency") 
//        {
//            if (document.getElementById('lstagency').value == "0")
//             {
//                alert("Please select the Main Asset Cat");
//                return false;
//            }
//            document.getElementById("divagency").style.display = "none";
//            var page = document.getElementById('lstagency').value;
//            agencycodeglo = page;
//            for (var k = 0; k <= document.getElementById("lstagency").length - 1; k++) {

//                if (document.getElementById('lstagency').options[k].value == page) {
//                    var abc;
//                    if (browser != "Microsoft Internet Explorer") {
//                        abc = document.getElementById('lstagency').options[k].textContent;
//                    }
//                    else {
//                        abc = document.getElementById('lstagency').options[k].innerText;
//                    }

//                   document.getElementById('txtsagencycode').value = agencycodeglo;
//                    var splitpub = abc;
//                    var str = splitpub.split("+");
//                    var ab = str[1];
//                    var ab1= str[0];
//                    
//                     var nameagen=str[0];
//         var code=str[3];
//         var agenadd1=str[1];
//         var agenadd2=str[3];
//         var agenadd3=str[2];
//         var subcode=str[4];
//         
//        
//        document.getElementById('txtagenname').value=nameagen;
//        document.getElementById('txtadd').value=agenadd1;
//        //document.getElementById('txtaddress1').value=agenadd2;
//        //document.getElementById('txtaddress2').value=agenadd3;
//        document.getElementById('drpagetyp').focus();
//           document.getElementById('txtagencode').value=code;
//        document.getElementById('txtsagencycode').value=subcode;
//        if(document.getElementById('drpparent').value=="E")
//        {
//         document.getElementById('txtsubsubagcd').value=agenadd3;
//        }
//        else
//        {
//        document.getElementById('txtsubsubagcd').value="";
//        }
//        document.getElementById("divagency").style.display='none';
//        
//        return false;


//                    document.getElementById('hiddenagency').value = ab1;
//                    document.getElementById('txtagenname').value = ab;
//                    //document.getElementById("txtagenname").focus();
//                    return false;

//                }


//            }

//        }
//    }

//    else if (event.keyCode == 27) {
//    document.getElementById("divagency").style.display = 'none';
//    document.getElementById("txtagenname").focus();

//    }
//}	
function insertagency(event)
{
var browser=navigator.appName;
if(document.activeElement.id=="lstagency1")
    {
    if(document.getElementById('lstagency1').value=="0")// || document.getElementById('hiddensavemod').value=="01")
    {
        alert("Please select the agency code");
        return false;
    }
        document.getElementById("div2").style.display="none";
        var datetime="";
        
        
        var page=document.getElementById('lstagency1').value;
        document.getElementById('hiddenagency').value=page;
        agencycodeglo=page;
        

         var value="";
        var res=Agent_master.addclientname(page,datetime,value);
         var id=res.value;
         var split=id.split("+");
         var nameagen=split[0];
         var agenadd=split[2];
         var subcode=split[1];
                
        document.getElementById('selectcode').value=nameagen;
        
        if(document.getElementById('drpparent').value=="E")
        {
         document.getElementById('txtsubsubagcd').value=subcode;
        }
        else
        {
        document.getElementById('txtsubsubagcd').value="";
        }
        
     
        document.getElementById('selectcode').focus();
        setcode();
        return false;
    }


if(document.getElementById('hiddenquery').value=="query")
{
    if(document.activeElement.id=="lstagency")
    {
    if(document.getElementById('lstagency').value=="0")
        {
        alert("Please select the agency");
        return false;
        }
        document.getElementById("div1").style.display="none";
        
        //alert(document.getElementById('lstagency').value);
       //alert(document.getElementById('lstagency').value);
           
        var page=document.getElementById('lstagency').value;
        agencycodeglo=page;
        
        var browser=navigator.appName;
        var  httpRequest =null;
       // alert(browser);
       
        var id="";
       
        if(browser!="Microsoft Internet Explorer")
        {
            httpRequest= new XMLHttpRequest();
            if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml'); 
            }
            
             httpRequest.onreadystatechange = function() {alertContents_name(httpRequest) };
        
          
            httpRequest.open('GET', "AgencyNameList.aspx?page="+page+"&value=0", false);
            httpRequest.send('');
            id=httpRequest.responseText;
          
            

        }
        else if(browser=="Microsoft Internet Explorer")
        {
         
         var xml = new ActiveXObject("Microsoft.XMLHTTP");
         xml.Open( "GET","AgencyNameList.aspx?page="+page+"&value=0", false );
         xml.Send();
         id=xml.responseText;       
         
        
        }
       
                  
         var split=id.split("+");
         var nameagen=split[0];
         var code=split[1];
         var agenadd1=split[2];
         var agenadd2=split[3];
         var agenadd3=split[4];
         var subcode=split[5];
         
        
        document.getElementById('txtagenname').value=nameagen;
        document.getElementById('txtadd').value=agenadd1;
        document.getElementById('txtaddress1').value=agenadd2;
        document.getElementById('txtaddress2').value=agenadd3;
        document.getElementById('drpagetyp').focus();
           document.getElementById('txtagencode').value=code;
        document.getElementById('txtsagencycode').value=subcode;
        document.getElementById("divagency").style.display='none';
        
        return false;
    }
}

}	


function alertContents_name(httpRequest) {    
    
    if (httpRequest.readyState == 4) 
    {
        //alert(httpRequest.status);
        if (httpRequest.status == 200) 
        {
             //alert('hi..');
          var str=httpRequest.responseText;
            
       
        }
        else 
        {
            alert('There was a problem with the request.');
        }
    }

}






//function focussau()
//{
//    document.getElementById('btnNew').focus();
//}

function check_dat()
{
    var dateformat=document.getElementById('hiddendateformat').value;
    var enrol=document.getElementById('txtenrolldate').value;
    var bus=document.getElementById('txtbusineedate').value;
    
    if(dateformat=="dd/mm/yyyy")
        {
            if(bus != "")
            {
                var txt=bus;
                 var txt1;
                if(txt.indexOf("-")>=0)
                {
                     txt1=txt.split("-");
                }
                else{
                    txt1=txt.split("/");
                }
               
                var dd=txt1[0];
                var mm1=txt1[1];
                var mm;
                 if(txt.indexOf("-")>=0)
                 {
                     mm = getMonthNo(mm1);
                }
                else
                {
                    mm=mm1;
                }
                var yy=txt1[2];
                bus=mm+'/'+dd+'/'+yy;
            }
            else
            {
                bus=bus;
            }

        }
        
        if(dateformat=="yyyy/mm/dd")
        {
            if(bus!="")
            {
                var txt=bus;
                var txt1=txt.split("/");
                var yy=txt1[0];
                var mm=txt1[1];
                var dd=txt1[2];
                bus=mm+'/'+dd+'/'+yy;
            }
            else
            {
                bus=bus;
            }
        }
        
        if(dateformat=="mm/dd/yyyy")
        {
            bus=bus;
        }
        if(dateformat=="dd/mm/yyyy")
        {
            if(enrol != "")
            {
                var txt=enrol;
                var txt1=txt.split("/");
                var dd=txt1[0];
                var mm=txt1[1];
                var yy=txt1[2];
                enrol=mm+'/'+dd+'/'+yy;
            }
            else
            {
                enrol=enrol;
            }

        }
        
        if(dateformat=="yyyy/mm/dd")
        {
            if(enrol!="")
            {
                var txt=enrol;
                var txt1=txt.split("/");
                var yy=txt1[0];
                var mm=txt1[1];
                var dd=txt1[2];
                enrol=mm+'/'+dd+'/'+yy;
            }
            else
            {
                enrol=enrol;
            }
        }
        
        if(dateformat=="mm/dd/yyyy")
        {
            enrol=enrol;
        }
        var enrol2=new Date(enrol);
        var bus2=new Date(bus);
    if(enrol2!="" && bus2!="")
    {
    if(enrol2>=bus2)
    {
    
        alert('Enrolment Date should be less than Bussiness Start Date');
        document.getElementById('txtenrolldate').value="";
        document.getElementById('txtenrolldate').focus();
    }
    }
    
    
}

function bindtalu(talukabind)
{

 Agent_master.talubibd3(talukabind,fill_talu);
 

 
}

function fill_talu(ds)
{
if(ds.value==null)
{
 alert(ds.error.description);
 return false;
}
if(ds.value.Tables[0].Rows.length>0)
{	
    for(var i=0;i<ds.value.Tables[0].Rows.length;++i) 
    {
	    document.getElementById("drptaluka").options[i]=new Option(ds.value.Tables[0].Rows[i].TALU_NAME,ds.value.Tables[0].Rows[i].TALU_CODE);
    }
    document.getElementById('drptaluka').value=ds.value.Tables[0].Rows[0].TALUKA;
    
    
                     if(show1=="5")
	    			document.getElementById('drptaluka').value=dsforexecute.Tables[0].Rows[0].TALUKA;
	        	    
	        	     if(show1=="6")
	        	    {
	        	    document.getElementById('drptaluka').value=dsforexecute.Tables[0].Rows[z].TALUKA;
	        	    }
	        	    
	        	    if(show1=="7")
	        	    {
	        	    document.getElementById('drptaluka').value=dsforexecute.Tables[0].Rows[y].TALUKA;
	        	    }
	        	    show1="0";
	        	    
}

}

function notchar1(event)
{
var browser=navigator.appName;
 if(browser!="Microsoft Internet Explorer")
 {
        if((event.which>=48 && event.which<=57)||(event.which==127)||(event.which>=97 && event.which<=122)||(event.which>=65 && event.which<=90)||(event.which==9) || (event.which==0) || (event.which==8))
        {
        return true;
        }
        else
        {
        return false;
        }
  }
  else
  {
         if((event.keyCode>=48 && event.keyCode<=57)||(event.keyCode==127)||(event.keyCode>=97 && event.keyCode<=122)||(event.keyCode>=65 && event.keyCode<=90)||(event.keyCode==9))
        {
        return true;
        }
        else
        {
        return false;
        }
  }      
}
//function notchar_b(event) {


//var browser=navigator.appName;
// if(browser!="Microsoft Internet Explorer") {


//     if ((event.shiftKey == true && (event.which == 41 || event.which == 40 || event.which == 33)) || (event.which == 44)) {

//         alert("This Charecter Is not Allowed In This Text Box");
//         return false;
//     }
//        if((event.which>=48 && event.which<=57)||(event.which==127)||(event.which>=97 && event.which<=122)||(event.which>=65 && event.which<=90)||(event.which==9) || (event.which==0) || (event.which==8) || (event.which=45))
//        {
//        return true;
//        }
//        else
//        {
//        return false;
//        }
//  }
//  else {


//      if ((window.event.shiftKey == true && (event.keyCode == 41 || event.keyCode == 40 || event.keyCode == 33)) || (event.keyCode == 44)) {

//          alert("This Charecter Is not Allowed In This Text Box");
//          return false;
//      }
//         if((event.keyCode==127)||(event.keyCode==9) || (event.keyCode==38)||(event.keyCode==95)||(event.keyCode==44)||(event.keyCode==46)||(event.keyCode==40)||(event.keyCode==41)||(event.keyCode>=48 && event.keyCode<=57)||(event.keyCode>=97 && event.keyCode<=122)||(event.keyCode>=65 && event.keyCode<=90)||(event.keyCode==32)||(event.keyCode==45))
//        {
//        return true;
//        }
//        else
//        {
//        return false;
//        }
//  }
//}




function notchar_b123(event) {


    var browser = navigator.appName;
    if (browser != "Microsoft Internet Explorer") {


        if ((event.shiftKey == true && ( event.which == 33)) ) {

            alert("This Charecter Is not Allowed In This Text Box");
            return false;
        }
        if ( (event.which == 44)  ||event.which == 40 || event.which == 41 || (event.which >= 48 && event.which <= 57) || (event.which == 127) || (event.which >= 97 && event.which <= 122) || (event.which >= 65 && event.which <= 90) || (event.which == 9) || (event.which == 0) || (event.which == 8) || (event.which = 45)) {
            return true;
        }
        else {
            return false;
        }
    }
    else {


        if ((window.event.shiftKey == true && ( event.keyCode == 33)) || (event.keyCode == 44)) {

            alert("This Charecter Is not Allowed In This Text Box");
            return false;
        }
        if (event.keyCode == 40 || event.keyCode == 41||(event.keyCode == 127) || (event.keyCode == 9) || (event.keyCode == 38) || (event.keyCode == 95) || (event.keyCode == 44) || (event.keyCode == 46) || (event.keyCode == 40) || (event.keyCode == 41) || (event.keyCode >= 48 && event.keyCode <= 57) || (event.keyCode >= 97 && event.keyCode <= 122) || (event.keyCode >= 65 && event.keyCode <= 90) || (event.keyCode == 32) || (event.keyCode == 45)) {
            return true;
        }
        else {
            return false;
        }
    }
}



function notchar_b(event) {


    var browser = navigator.appName;
    if (browser != "Microsoft Internet Explorer") {


        if ((event.shiftKey == true && (event.which == 41 || event.which == 40 || event.which == 33)) || (event.which == 44)) {

            alert("This Charecter Is not Allowed In This Text Box");
            return false;
        }
        if ((event.which >= 48 && event.which <= 57) || (event.which == 127) || (event.which >= 97 && event.which <= 122) || (event.which >= 65 && event.which <= 90) || (event.which == 9) || (event.which == 0) || (event.which == 8) || (event.which = 45)) {
            return true;
        }
        else {
            return false;
        }
    }
    else {


        if ((window.event.shiftKey == true && (event.keyCode == 41 || event.keyCode == 40 || event.keyCode == 33)) || (event.keyCode == 44)) {

            alert("This Charecter Is not Allowed In This Text Box");
            return false;
        }
        if ((event.keyCode == 127) || (event.keyCode == 9) || (event.keyCode == 38) || (event.keyCode == 95) || (event.keyCode == 44) || (event.keyCode == 46) || (event.keyCode == 40) || (event.keyCode == 41) || (event.keyCode >= 48 && event.keyCode <= 57) || (event.keyCode >= 97 && event.keyCode <= 122) || (event.keyCode >= 65 && event.keyCode <= 90) || (event.keyCode == 32) || (event.keyCode == 45)) {
            return true;
        }
        else {
            return false;
        }
    }
}



function changacagency()
{
//var bill1="";
//var bill2=document.getElementById('biltodrp').value;
//    if(bill2.indexOf("(")>=0)
//        {
//            bill2=bill2.split("(");
//            bill1=bill2[1];
//            bill2=bill1;
//            document.getElementById('txtbill').value=bill2;
//        }
//        else
        document.getElementById('txtbill').value=document.getElementById('biltodrp').value;
    }
function openremarkpopup() {
    var agencode1 = document.getElementById('txtagencode').value;
    var subagencode1 = document.getElementById('txtsagencycode').value;
    var type1 = "A";
    window.open('AgencyClientRemark.aspx?agencode=' + agencode1 + '&subagencode=' + subagencode1 + '&type=' + type1, 'bhati', 'resizable=1,left=0,top=0,scrollbars=yes,width=' + screen.availWidth + ',height=' + screen.availHeight + '');
    return false
}
function setButtonImages()
{
    if(document.getElementById('btnNew').disabled==true)
        document.getElementById('btnNew').src="btimages/new-off.jpg";
    else
        document.getElementById('btnNew').src="btimages/new.jpg";
        
    if(document.getElementById('btnSave').disabled==true)
        document.getElementById('btnSave').src="btimages/save-off.jpg";
    else
        document.getElementById('btnSave').src="btimages/save.jpg";
        
    if(document.getElementById('btnModify').disabled==true)
        document.getElementById('btnModify').src="btimages/modify-off.jpg";
    else
        document.getElementById('btnModify').src="btimages/modify.jpg";
        
    if(document.getElementById('btnQuery').disabled==true)
        document.getElementById('btnQuery').src="btimages/query-off.jpg";
    else
        document.getElementById('btnQuery').src="btimages/query.jpg";
    
    if(document.getElementById('btnExecute').disabled==true)
        document.getElementById('btnExecute').src="btimages/execute-off.jpg";
    else
        document.getElementById('btnExecute').src="btimages/execute.jpg";
        
    if(document.getElementById('btnCancel').disabled==true)
        document.getElementById('btnCancel').src="btimages/clear-off.jpg";
    else
        document.getElementById('btnCancel').src="btimages/clear.jpg";
        
    if(document.getElementById('btnfirst').disabled==true)
        document.getElementById('btnfirst').src="btimages/first-off.jpg";
    else
        document.getElementById('btnfirst').src="btimages/first.jpg";
        
    if(document.getElementById('btnprevious').disabled==true)
        document.getElementById('btnprevious').src="btimages/previous-off.jpg";
    else
        document.getElementById('btnprevious').src="btimages/previous.jpg";
        
    if(document.getElementById('btnnext').disabled==true)
        document.getElementById('btnnext').src="btimages/next-off.jpg";
    else
        document.getElementById('btnnext').src="btimages/next.jpg";
        
    if(document.getElementById('btnlast').disabled==true)
        document.getElementById('btnlast').src="btimages/last-off.jpg";
    else
        document.getElementById('btnlast').src="btimages/last.jpg";   
        
    if(document.getElementById('btnDelete').disabled==true)
        document.getElementById('btnDelete').src="btimages/delete-off.jpg";
    else
        document.getElementById('btnDelete').src="btimages/delete.jpg";
        
    if(document.getElementById('btnExit').disabled==true)
        document.getElementById('btnExit').src="btimages/exit-off.jpg";
    else
        document.getElementById('btnExit').src="btimages/exit.jpg";
}

function blankagency()
{
givebuttonpermission('Agent_master');
cancelclick();


}



function agencyname() {
    if (document.getElementById("txtagenname").value.length <= 2) {
        alert("Please Enter Minimum Three Characters");
        return false;
    }
    document.getElementById('view19').innerHTML = "";
    document.getElementById("Divgrid1").style.display = "block";
    // $('tdback').style.display="block";
    var activeid = "txtagenname";

    var divid = "Divgrid1";
   var id = activeid;
    aTag = eval(document.getElementById(activeid))
    var btag;
    var leftpos = 0;
    var toppos = 0;
    do {
        aTag = eval(aTag.offsetParent);
        leftpos += aTag.offsetLeft;
        toppos += aTag.offsetTop;
        btag = eval(aTag)
    } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");


    document.getElementById(divid).style.display = "block";
    document.getElementById(divid).style.top = document.getElementById(id).offsetHeight + toppos + "px";
    document.getElementById(divid).style.left = document.getElementById(id).offsetLeft + leftpos + "px";
    
//    document.getElementById('Divgrid1').style.top = 250 + "px";
//    document.getElementById('Divgrid1').style.left = 330 + "px";
//    document.getElementById('Divgrid1').style.BackColor = "Ivory";

    Agent_master.btnagencyname_Click(document.getElementById("hiddencompcode").value, document.getElementById("txtagenname").value.toUpperCase(), document.getElementById("hiddenuserid").value, document.getElementById("hiddendateformat").value, callback_allview)
    return false;
}


function close1() {

    document.getElementById("Divgrid1").style.display = "none";
    document.getElementById('view19').innerHTML = "";
    return false;
}



function callback_allview(res) {

    viewcolname = "";
    valueType;
    //    checkflag = "false";
    srt_count_0ther = 1;
    next = 0;
    dsexe = "";
    modiflag = 0;
    srt_count = 1
    record_show1 = 1
    record_show = rec_page_val
    record_show1_other1 = rec_shw_oth_val;
    record_show_other = rec_shw_oth_val;
    extra_record_other = 0;
    srt_count_0ther = 1;
    divres = "";

    if (res.error != null && res.error != undefined) {
        catch_error(1, 2)
        return false;
    }

    if (check == true) {
        var srt_count = 0
        if (res.value != undefined) {
            ds18 = res.value;
            dsexe = res.value;
        }
        else {
            ds18 = res;
            dsexe = res
        }
        check = false;

    }
    else {
        var srt_count = 0
        ds18 = "";

        if (res.value != undefined) {
            ds18 = res.value;
            dsexe = res.value;
        }
        else {
            ds18 = res;
            dsexe = res
        }
    }
    if (ds18 == null || ds18 == undefined || ds18.Tables[0] == null || ds18.Tables[0] == undefined) {
        catch_error(1, 2)
        return false;
    }
    row_count = ds18.Tables[0].Rows.length;
    var valnextval = 2
    pagenext(valnextval);

    var hdsview = "";
    var j = 1;
    var i = 0;

    if (ds18 != null && ds18.Tables[0].Rows.length > 0) {
        try {
            hdsview += "<table Width='435px' style='border:1px solid #7DAAE3;margin-top:0px;margin-bottom:1px;' cellpadding='0' cellspacing='0'>"
            hdsview += "<tr style='background-color:#7DAAE3'><td class='tabsHeaders1' >SNo</td>";
            hdsview += "<td id='view11' class='tabsHeaders1'  >Agency Name</td>";
            hdsview += "<td id='view12' class='tabsHeaders1'  >Address</td>";
            hdsview += "<td id='view12' class='tabsHeaders1' >City</td></tr>";

            for (srt_count; srt_count < rec_shw_oth_val; srt_count++) {
                hdsview += "<tr>"
                hdsview += "<td width='30px' align='right' style='border:1px solid #7DAAE3;padding-right:3px;'>"
                hdsview += "<font style='font-size:10px;vertical-align:middle;padding-top:4px;padding-right:3px;padding-bottom:2px;text-align:left' >" + j; "</font>"
                hdsview += "</td>"

                var ds_view_code = ds18.Tables[0].Rows[srt_count].agency_name
                if (ds_view_code != null) {
                    hdsview += "<td  id=td_cost_code" + j + " align='center' width='135px'style='border:1px solid #7DAAE3;padding-right:1px;' >"
                    hdsview += "<font width='135px'class='gridview'>" + ds18.Tables[0].Rows[srt_count].agency_name.substring(0, 20) + "</font>"
                    hdsview += "</td>"
                }
                else {
                    hdsview += "<td width='135px' align='right' style='border:1px solid #7DAAE3;padding-right:1px;'>&nbsp;"
                    hdsview += "</td>"
                }

                var ds_views_str = ds18.Tables[0].Rows[srt_count].Add1
                var lmdesc = fndnull(ds18.Tables[0].Rows[srt_count].Add1)
                if ((lmdesc != null) && (lmdesc != "")) {
                    var aa11 = "\"" + repalcestr2quote(lmdesc) + "\"";
                    hdsview += "<td width='135px' style='border:1px solid #7DAAE3;text-align:left;padding-left:2px;'>"
                    hdsview += "<font width='135px' class='gridview' title=" + aa11 + ">" + repalcestr2quote(lmdesc).substring(0, 20) + "</font>"
                    hdsview += "</td>"
                }
                else {
                    hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                    hdsview += "</td>"
                }


                var ds_views_str = ds18.Tables[0].Rows[srt_count].CITYNAME
                var lmdesc = fndnull(ds18.Tables[0].Rows[srt_count].CITYNAME)
                if ((lmdesc != null) && (lmdesc != "")) {
                    var aa11 = "\"" + repalcestr2quote(lmdesc) + "\"";
                    hdsview += "<td width='135px' style='border:1px solid #7DAAE3;text-align:left;padding-left:2px;'>"
                    hdsview += "<font width='135px' class='gridview' title=" + aa11 + ">" + repalcestr2quote(lmdesc).substring(0, 20) + "</font>"
                    hdsview += "</td>"
                }
                else {
                    hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                    hdsview += "</td>"
                }
                hdsview += "</tr>"
                document.getElementById('view19').innerHTML = hdsview;
                j++
            }
            hdsview += "</table>"

        }
        catch (er)
                 { }
        finally { }
    }
    else {

        hdsview += "<table width='300px;'>"
        hdsview += "<tr>"
        hdsview += "<td width='250px'>"
        hdsview += "<font Style='font-family:arial;font-weight:bold;font-size:18px;'>You have no detail </font></strong>"
        hdsview += "</td>"
        hdsview += "</tr>"
        hdsview += "</table>"
        hdsview = hdsview + "<BR>"
        document.getElementById('view19').innerHTML = hdsview;
        flg_req = "no"
        return false;
    }
    document.getElementById('view19').style.display = 'block';
    document.getElementById('pagingtab').style.display = 'block';
    //    document.getElementById('nextpage').style.display = 'block';
    //    document.getElementById('next1').style.display = 'block';
    flg_req = "no"
    return false;
}




function repalcesinglequote(val) {
    if (val.indexOf("'") >= 0) {
        while (val.indexOf("'") >= 0) {
            val = val.replace("'", "^");
        }
    }
    return val;
}



function repalcestr2quote(val) {
    if (val.indexOf("^") >= 0) {
        while (val.indexOf("^") >= 0) {
            val = val.replace("^", "'");
        }
    }
    return val;
}

function fndnull(myval) {
    if (myval == "undefined") {
        myval = "";
    }
    else if (myval == null) {
        myval = "";
    }
    return myval
}

function pageprev(valpre) {
    var bb = "";
    var hdspage;
    var dfg = "0"
    var End_pnt = "0"
    if (preval <= tot_page) {
        dfg = 1
        End_pnt = tot_page
    }
    else {
        dfg = preval - tot_page;
        End_pnt = dfg + tot_page;
    }
    if (preval <= tot_page) {
        return false;
    }
    else {
        document.getElementById('next1').innerHTML = "";
        if (End_pnt < 1 || dfg < 1) {
            var res = catch_error(dfg, End_pnt);
            return false;
        }
        document.getElementById('next1').innerHTML = "";
        for (srt_count = dfg; srt_count < End_pnt; srt_count++) {
            if (srt_count != 0) {
                if (srt_count != End_pnt - 1) {
                    document.getElementById('next1').innerHTML += "<span onclick=pagenumber(" + srt_count + ",this.id) class='paggingColor' id=nextnumber_" + srt_count + " runat='server'>" + srt_count + "</span>";
                    bb = "bb";
                }
                else {
                    document.getElementById('next1').innerHTML += "<span onclick=pagenumber(" + srt_count + ",this.id) class='paggingColorChange' id=nextnumber_" + srt_count + " runat='server'>" + srt_count + "</span>";
                    bb = "bb";
                    pagenumber(srt_count, this.id)
                }
            }
            else {
                bb = "";
                break;
            }
        }
        if (bb != "") {
            record_show = record_show1
            record_show1 = record_show - tot_page
        }
        preval = preval - tot_page
    }
    var page_html = document.getElementById("next1").innerHTML;
    if (page_html.indexOf("onclick=pagenumber") < 0) {
        //    alert(page_html);
        //var res = catch_error(dfg, End_pnt);
        return false;
    }
    return false;
}


function pagenext(valnext) {
    var nextPageNumberColor = true
    divres = row_count / rec_shw_oth_val;
    if (divres.valueOf(".") >= "0") {
        divres = divres + 1;
    }
    else {
        divres;
    }
    var hdspage;
    var aa = "";
    if ((parseInt(record_show1) * rec_shw_oth_val) - rec_shw_oth_val >= row_count) {
        return false;
    }
    else {
        document.getElementById('next1').innerHTML = "";
        if (record_show < 1 || record_show1 < 1) {
            var res = catch_error(record_show, record_show1);
            return false;
        }
        document.getElementById('next1').innerHTML = "";
        for (srt_count = record_show1; srt_count < record_show; srt_count++) {
            if (srt_count < divres) {

                if (srt_count == 1 || nextPageNumberColor == true) {
                    document.getElementById('next1').innerHTML += "<span onclick=pagenumber(" + srt_count + ",this.id) class='paggingColorChange'  id=nextnumber_" + srt_count + " runat='server'>" + srt_count + "</span>"
                    nextPageNumberColor = false;
                    pagenumber(srt_count, this.id)
                }
                else {
                    document.getElementById('next1').innerHTML += "<span onclick=pagenumber(" + srt_count + ",this.id) class='paggingColor'  id=nextnumber_" + srt_count + " runat='server'>" + srt_count + "</span>"

                }
                aa = "aa";
            }
            else {
                aa = "";
            }
        }
        if (aa != "") {
            record_show1 = record_show;
            preval = record_show1 - tot_page
            record_show = record_show1 + tot_page;
            nextPageNumberColor = true;
        }
        else {
            record_show1 = record_show;
            preval = record_show1 - tot_page
            record_show = record_show1 + tot_page;
        }
    }

    var page_html = document.getElementById("next1").innerHTML;
    if (page_html.indexOf("onclick=pagenumber") < 0) {
        //    alert(page_html);
        //var res = catch_error(dfg, End_pnt);
        return false;
    }
    return false;
}

function pagenumber(valnextvalue, hdsg) {

    if (ds18 == null || ds18 == undefined || ds18.Tables[0] == null || ds18.Tables[0] == undefined) {
        catch_error(1, 2)
        return false;
    }
    hdsharma = hdsg
    if (hdsg != undefined) {
        while (document.getElementById('next1').innerHTML.indexOf('paggingColorChange') > 0) {
            document.getElementById('next1').innerHTML = document.getElementById('next1').innerHTML.replace('paggingColorChange', 'paggingColor');
        }
        document.getElementById(hdsg).className = 'paggingColorChange';
    }
    var flag = "IN";
    var flags = "pre";
    forlen_other = valnextvalue;
    extra_record_other = row_count % rec_shw_oth_val;
    var finalval = (forlen_other * record_show_other) - extra_record_other;
    hdsview = "";
    if (finalval != row_count && extra_record_other != 0 && extra_record_other != 1) {
        hdsview += "<table Width='435px' style='border:1px solid #7DAAE3;margin-top:0px;margin-bottom:1px;' cellpadding='0' cellspacing='0'>"
        hdsview += "<tr style='background-color:#7DAAE3'><td class='tabsHeaders2' >SNo</td>";
        hdsview += "<td id='view11' class='tabsHeaders1'  >Agency Name</td>";
        hdsview += "<td id='view12' class='tabsHeaders1'  >Address</td>";
        hdsview += "<td id='view12' class='tabsHeaders1' >City</td></tr>";

        for (srt_count_0ther = (forlen_other * record_show_other) - record_show_other; srt_count_0ther < (forlen_other * record_show_other); srt_count_0ther++) {
            if (row_count > srt_count_0ther) {
                hdsview += "<tr>"
                var srt_count_0ther_sr = parseInt(srt_count_0ther) + 1

                hdsview += "<td width='30px' align='right' style='border:1px solid #7DAAE3;'>"
                hdsview += "<font style='font-size:10px;vertical-align:middle;padding-top:4px;padding-right:3px;padding-bottom:2px;text-align:left' >" + srt_count_0ther_sr; "</font>"
                hdsview += "</td>"

                var ds_view_code = ds18.Tables[0].Rows[srt_count_0ther].agency_name
                if (ds_view_code != null) {
                    hdsview += "<td  id=td_cost_code" + srt_count_0ther_sr + " align='center' width='135px'style='border:1px solid #7DAAE3;padding-right:1px;' >"
                    hdsview += "<font width='135px'class='gridview'>" + ds18.Tables[0].Rows[srt_count_0ther].agency_name.substring(0, 20) + "</font>"
                    hdsview += "</td>"
                }
                else {
                    hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                    hdsview += "</td>"
                }

                var ds_views_str = ds18.Tables[0].Rows[srt_count_0ther].Add1
                var lmndesc = fndnull(ds18.Tables[0].Rows[srt_count_0ther].Add1)
                if ((lmndesc != null) && (lmndesc != "")) {

                    var aa11 = "\"" + repalcestr2quote(lmndesc) + "\"";
                    hdsview += "<td width='135px' style='border:1px solid #7DAAE3;text-align:left;padding-left:2px;'>"
                    hdsview += "<font width='135px'  class='gridview' title=" + aa11 + ">" + repalcestr2quote(lmndesc).substring(0, 20) + "</font>"
                    hdsview += "</td>"

                }
                else {
                    hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                    hdsview += "</td>"
                }
                var ds_views_str = ds18.Tables[0].Rows[srt_count_0ther].CITYNAME
                var lmndesc = fndnull(ds18.Tables[0].Rows[srt_count_0ther].CITYNAME)
                if ((lmndesc != null) && (lmndesc != "")) {

                    var aa11 = "\"" + repalcestr2quote(lmndesc) + "\"";
                    hdsview += "<td width='135px' style='border:1px solid #7DAAE3;text-align:left;padding-left:2px;'>"
                    hdsview += "<font width='135px'  class='gridview' title=" + aa11 + ">" + repalcestr2quote(lmndesc).substring(0, 20) + "</font>"
                    hdsview += "</td>"

                }
                else {
                    hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                    hdsview += "</td>"
                }
                hdsview += "</tr>"
                document.getElementById('view19').innerHTML = hdsview;
                srt_count_0ther_sr++
            }
        }
    }
    else if (finalval == row_count) {
        hdsview += "<table document.getElementById style='border:1px solid #7DAAE3;margin-top:0px;margin-bottom:1px;margin-left:4px;' cellpadding='0' cellspacing='0' Width='435px'>"
        hdsview += "<tr style='background-color:#7DAAE3'><td class='tabsHeaders2' >SNo</td>";
        hdsview += "<td id='view11' class='tabsHeaders1'  >Agency Name</td>";
        hdsview += "<td id='view12' class='tabsHeaders1'  >Address</td>";
        hdsview += "<td id='view12' class='tabsHeaders1' >City</td></tr>";

        for (srt = (forlen_other * record_show_other) - record_show_other; srt < row_count; srt++) {
            var srt_count_0ther_sr = parseInt(srt) + 1
            hdsview += "<tr>"
            hdsview += "<td width='30px' style='border:1px solid #7DAAE3; padding-right:3px;' align='right'>"
            hdsview += "<font style='font-size:10px;font-weight:bold;vertical-align:middle;' align='right'>" + srt_count_0ther_sr + "</font>"
            hdsview += "</td>"

            var ds_view_code = ds18.Tables[0].Rows[srt].agency_name
            if (ds_view_code != null) {
                hdsview += "<td id=td_cost_code" + srt + " align='center'width='135px' style='border:1px solid #7DAAE3;padding-right:1px;'  >"
                hdsview += "<font width='135px' class='gridview'>" + ds18.Tables[0].Rows[srt].agency_name.substring(0, 20) + "</font>"
                hdsview += "</td>"
            }
            else {
                hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                hdsview += "</td>"
            }
            var ds_views_str = ds18.Tables[0].Rows[srt].Add1
            var nrtndesc = fndnull(ds18.Tables[0].Rows[srt].Add1)
            if ((nrtndesc != null) && (nrtndesc != "")) {
                var aa11 = "\"" + repalcestr2quote(nrtndesc) + "\"";
                hdsview += "<td width='135px' style='border:1px solid #7DAAE3;text-align:left;padding-left:2px;'>"
                hdsview += "<font width='135px'class='gridview' title=" + aa11 + ">" + repalcestr2quote(nrtndesc).substring(0, 20) + "</font>"
                hdsview += "</td>"
            }
            else {
                hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                hdsview += "</td>"
            }

            var ds_views_str = ds18.Tables[0].Rows[srt].CITYNAME
            var nrtndesc = fndnull(ds18.Tables[0].Rows[srt].CITYNAME)
            if ((nrtndesc != null) && (nrtndesc != "")) {
                var aa11 = "\"" + repalcestr2quote(nrtndesc) + "\"";
                hdsview += "<td width='135px' style='border:1px solid #7DAAE3;text-align:left;padding-left:2px;'>"
                hdsview += "<font width='135px'class='gridview' title=" + aa11 + ">" + repalcestr2quote(nrtndesc).substring(0, 20) + "</font>"
                hdsview += "</td>"
            }
            else {
                hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                hdsview += "</td>"
            }
            hdsview += "</tr>"
            document.getElementById('view19').innerHTML = hdsview;
            srt_count_0ther_sr++
        }
        hdsview += "</table>"

    }
    else {
        var finalval_other = finalval - extra_record_other;
        if (flag == "IN") {
            hdsview += "<table Width='435px' style='border:1px solid #7DAAE3;margin-top:0px;margin-bottom:1px;' cellpadding='0' cellspacing='0'>"
            hdsview += "<tr style='background-color:#7DAAE3'><td class='tabsHeaders2' >SNo</td>";
            hdsview += "<td id='view11' class='tabsHeaders1'  >Agency Name</td>";
            hdsview += "<td id='view12' class='tabsHeaders1'  >Address</td>";
            hdsview += "<td id='view12' class='tabsHeaders1' >City</td></tr>";

            for (srt = (forlen_other * record_show_other) - record_show_other; srt < (forlen_other * record_show_other); srt++) {
                if (srt != row_count) {
                    if (srt > row_count) {
                        return false;
                    }
                    hdsview += "<tr>"
                    var srt_count_0ther_sr = parseInt(srt) + 1
                    hdsview += "<td width='30px' style='border:1px solid #7DAAE3; padding-right:3px;' align='right'>"
                    hdsview += "<font style='font-size:10px;font-weight:bold;vertical-align:middle;' align='right'>" + srt_count_0ther_sr + "</font>"
                    hdsview += "</td>"
                    var ds_view_code = ds18.Tables[0].Rows[srt].agency_name
                    if (ds_view_code != null) {
                        hdsview += "<td id=td_cost_code" + srt + " align='center'width='135px' style='border:1px solid #7DAAE3;padding-right:1px;' >"
                        hdsview += "<font width='135px' class='gridview'>" + ds18.Tables[0].Rows[srt].agency_name.substring(0, 20) + "</font>"
                        hdsview += "</td>"
                    }
                    else {
                        hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                        hdsview += "</td>"
                    }
                    var ds_views_str = ds18.Tables[0].Rows[srt].Add1
                    var nrtndesc = fndnull(ds18.Tables[0].Rows[srt].Add1)
                    if ((nrtndesc != null) && (nrtndesc != "")) {
                        var aa11 = "\"" + repalcestr2quote(nrtndesc) + "\"";
                        hdsview += "<td width='135px' style='border:1px solid #7DAAE3;text-align:left;padding-left:5px;'>"
                        hdsview += "<font width='135px'  class='gridview' title=" + aa11 + ">" + repalcestr2quote(nrtndesc).substring(0, 20) + "</font>"
                        hdsview += "</td>"
                    }
                    else {
                        hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                        hdsview += "</td>"
                    }

                    var ds_views_str = ds18.Tables[0].Rows[srt].CITYNAME
                    var nrtndesc = fndnull(ds18.Tables[0].Rows[srt].CITYNAME)
                    if ((nrtndesc != null) && (nrtndesc != "")) {
                        var aa11 = "\"" + repalcestr2quote(nrtndesc) + "\"";
                        hdsview += "<td width='135px' style='border:1px solid #7DAAE3;text-align:left;padding-left:5px;'>"
                        hdsview += "<font width='135px'  class='gridview' title=" + aa11 + ">" + repalcestr2quote(nrtndesc).substring(0, 20) + "</font>"
                        hdsview += "</td>"
                    }
                    else {
                        hdsview += "<td width='135px' style='border:1px solid #7DAAE3;padding-left:2px;'>&nbsp;"
                        hdsview += "</td>"
                    }
                    hdsview += "</tr>"
                    document.getElementById('view19').innerHTML = hdsview;
                    srt_count_0ther_sr++
                }
            }
            hdsview += "</table>"
        }
        flag = "OUT";
    }

    return false;
}


function checkduplicacy() {
    if (document.getElementById("txtagenname").value == "") {
        alert("Please Enter The Agency Name")
        document.getElementById("txtagenname").focus();
        return false;

    }
    var branchcode = document.getElementById("drpbranch").value
    var Agencyname = document.getElementById("txtagenname").value.toUpperCase()
    var panno = document.getElementById("txtpan").value.toUpperCase()
    var res = Agent_master.Checkduplicay1(document.getElementById("hiddencompcode").value, branchcode, Agencyname, panno)

    var ds = res.value;
    if (ds.Tables[0].Rows.length > 0) {
        alert("Duplicate Data Is Not Allowed")
        //document.getElementById("txtpan").value = "";
        //return false;
    }
}


  function openadvpopup() {
        if (document.getElementById("div3").style.display == "none" && document.getElementById("txtagenname").disabled == false&&document.getElementById('hiddenquery').value=="query") {
            document.getElementById("div3").style.display = "block";
            aTag = eval(document.getElementById("txtagenname"))
            var btag;
            var leftpos = 0;
            var toppos = 0;
            do {
                aTag = eval(aTag.offsetParent);
                leftpos += aTag.offsetLeft;
                toppos += aTag.offsetTop;
                btag = eval(aTag)
            } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
            document.getElementById('div3').style.top = document.getElementById("txtagenname").offsetTop + toppos - 13 + "px";
            document.getElementById('div3').style.left = document.getElementById("txtagenname").offsetLeft + leftpos + 140 + "px";
        }
        else {
            document.getElementById("div3").style.display = "none";
        }
    }
    
     function searchagency() {
        document.getElementById("divagency").style.display = "block";
        aTag = eval(document.getElementById("txtagenname"))
        var btag;
        var leftpos = 0;
        var toppos = 0;
        do {
            aTag = eval(aTag.offsetParent);
            leftpos += aTag.offsetLeft;
            toppos += aTag.offsetTop;
            btag = eval(aTag)
        } while (aTag.tagName != "BODY" && aTag.tagName != "HTML");
        document.getElementById('divagency').style.top = document.getElementById("AgencyName").offsetTop + toppos + "px";
        document.getElementById('divagency').style.left = document.getElementById("AgencyName").offsetLeft + leftpos + "px";

        Agent_master.bindagencynamefromadd(document.getElementById('hiddencompcode').value, document.getElementById('hiddenuserid').value, document.getElementById('txtagenname').value.toUpperCase(), document.getElementById('txtagaddf2').value, bindagencyname_callback2);
    }
    
    
    function bindagencyname_callback2(response)
{        closediv();
    ds=response.value;
    if(ds==null)
    {
        alert(response.error.description);
        return false;
    }
    
//    document.getElementById('drpretainer').value="";
    var pkgitem = document.getElementById("lstagency");
    pkgitem.options.length = 0; 
    pkgitem.options[0]=new Option("-Select Agency-","0");
    if(ds!= null && typeof(ds) == "object" && ds.Tables[0].Rows.length > 0) 
    {
        pkgitem.options.length = 1; 
        //alert(pkgitem.options.length);
        for (var i = 0  ; i < ds.Tables[0].Rows.length; ++i)
        {
            pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].agency_name +'+'+ds.Tables[0].Rows[i].CITYNAME+'+'+ds.Tables[0].Rows[i].code_subcode,ds.Tables[0].Rows[i].code_subcode);        
            pkgitem.options.length;       
        }
    }
//    if(agnf2!="Y")
// {
//    document.getElementById('txtagency').value="";
//    
//    document.getElementById("lstagency1").focus();
//  }
   document.getElementById("lstagency").value="0";
  document.getElementById("lstagency").focus();
    return false;
}

function closediv() {
    document.getElementById("txtagaddf2").value = "";
    document.getElementById("div3").style.display = "none";

}



function notchar8(event) {
    var browser = navigator.appName;
    if (browser != "Microsoft Internet Explorer") {
        if ((event.which == 8) || (event.which == 0) || (event.which == 189) || (event.which >= 97 && event.which <= 122) || (event.which == 9 || event.which == 32) || (event.which >= 65 && event.which <= 90) || (event.which == 39)) {
            return true;
        }
        else {
            return false;
        }
    }
    else {
        if ((event.keyCode == 8) || (event.keyCode == 0) || (event.keyCode == 189) || (event.keyCode >= 97 && event.keyCode <= 122) || (event.keyCode == 9 || event.keyCode == 32) || (event.keyCode >= 65 && event.keyCode <= 90) || (event.keyCode == 39)) {
            return true;
        }
        else {
            return false;
        }
    }
}



function numeric(event) {



    var charCode = (event.which) ? event.which : event.keyCode
    if ((charCode == 32 || charCode == 8 || charCode == 43 || charCode == 9) || (charCode >= 48 && charCode <= 57))
        return true;
    else
        return false;
    return false;
}






function mobileno(id) {
   // if (document.getElementById('hdnmobiledetail').value == "Nambibia") {

        var aa = document.getElementById(id).value;
        if (aa.length == 14 || aa.length == 18) {



            var MyNumbers = ("" + aa).split("");


            var p = 0;
            for (var i = 0; i < aa.length; i++) {

                if (MyNumbers[i] == "+") {

                    p++;
                }



            }

            if (p > 1) {

                alert('Please Enter Correct no ');
                document.getElementById(id).value = "";
                return false;
            }

            
            

            if (MyNumbers[0] == "+") {


            }
            else {
                alert("Please Fill Correct No")
                document.getElementById(id).focus();
                return false;
            }

            if (MyNumbers[4] == " ") {


            }
            else {
                alert("Please Fill Correct No");
                document.getElementById(id).focus();
                return false;
            }

            if (MyNumbers[7] == " ") {


            }
            else {
                alert("Please Fill Correct No");
                document.getElementById(id).focus();
                return false;
            }





            //}
        }
        else {
            alert("Please Fill Correct No");
            document.getElementById(id).focus();
            return false;
        }

    }
//    else {
//        var aa = document.getElementById(id).value;
//        if (aa.length == 10) {
//        }
////        else {

////            alert("Please Enter Correct Mobile No")
////            return false;
////        }


//////    }
//}
    //}


    function openkyc() {
        //if(document.getElementById('LinkButton1').disabled==false)


        var popUpWin2 = "";
        popUpWin2 = window.open('kyc.aspx?filename=' + document.getElementById('hidkyc').value, 'Ankur12', 'status=0,toolbar=0,resizable=0,scrollbars=yes,top=144,left=210,width=350px,height=300px')
        popUpWin2.focus();
        return false;

    }



    function fillgstclient(event) {
        var keycode = event.keyCode ? event.keyCode : event.which;
        if (keycode == 8) {
            if (document.activeElement.id == "txtgstclty") {
                document.getElementById('txtgstclty').value = "";
                document.getElementById('hdngstclty').value = "";
            }

        }
        if (event.keyCode == 113) {
            if (document.activeElement.id == "txtgstclty") {
                var aTag = eval(document.getElementById('txtgstclty'))
                var btag;
                var leftpos = 0;
                var toppos = 0;
                do {
                    aTag = eval(aTag.offsetParent);
                    leftpos += aTag.offsetLeft;
                    toppos += aTag.offsetTop;
                    btag = eval(aTag)
                }
                while (aTag.tagName != "BODY" && aTag.tagName != "HTML");

                var tot = document.getElementById('divgstclty').scrollLeft;
                var scrolltop = document.getElementById('divgstclty').scrollTop;
                document.getElementById('divgstclty').style.display = "block";
                document.getElementById('divgstclty').style.left = document.getElementById('hdngstclty').offsetLeft + leftpos - tot + "px";
                document.getElementById('divgstclty').style.top = document.getElementById('hdngstclty').offsetTop + toppos - scrolltop + "px";
                document.getElementById('lstgstclty').focus();
                var compcode = document.getElementById('hiddencompcode').value;
                var extra1 = "";
                var extra2 = "";
                var chargetypecode = document.getElementById('txtgstclty').value.toUpperCase();
                var dateformat = document.getElementById('hiddendateformat').value;
                Agent_master.fill_gst(compcode, chargetypecode, bindgstc_callback);
            }

            return event.keyCode;
        }


    }

    function bindgstc_callback(response) {

        var ds = response.value;
        var pkgitem = document.getElementById("lstgstclty");
        if (ds == null) {
            pkgitem.style.width = "254px"
            pkgitem.options.length = 0;
        }
        if (ds != null && typeof (ds) == "object" && ds.Tables[0].Rows.length > 0) {


            pkgitem.style.width = "254px"
            pkgitem.options.length = 0;
            pkgitem.options[0] = new Option("-Asset cat Name-", "0");
            pkgitem.options.length = 1;

            for (var i = 0; i < ds.Tables[0].Rows.length; ++i) {
                pkgitem.options[pkgitem.options.length] = new Option(ds.Tables[0].Rows[i].CLIENT_TYPE_NAME + "~" + ds.Tables[0].Rows[i].CLIENT_TYPE_CD, ds.Tables[0].Rows[i].CLIENT_TYPE_CD);
                pkgitem.options.length;

            }

        }
        document.getElementById('hdngstclty').value = "";
        document.getElementById('txtgstclty').value = "";
        document.getElementById("lstgstclty").value = "0";
        document.getElementById("lstgstclty").focus();
        return false;
    }

    function clearlst() {

        document.getElementById("lstgstclty").length = 0;

    }


    function fillgst(event) {
        var browser = navigator.appName;
        var key = event.keyCode ? event.keyCode : event.which;
        if (key == 13 || event.type == "click") {
            if (document.activeElement.id == "lstgstclty") {
                if (document.getElementById('lstgstclty').value == "0") {
                    alert("Please select the Asset Cat");
                    return false;
                }
                document.getElementById("divgstclty").style.display = "none";
                var page = document.getElementById('lstgstclty').value;
                agencycodeglo = page;
                for (var k = 0; k <= document.getElementById("lstgstclty").length - 1; k++) {
                    if (document.getElementById('lstgstclty').options[k].value == page) {
                        var abc;
                        if (browser != "Microsoft Internet Explorer") {
                            abc = document.getElementById('lstgstclty').options[k].textContent;
                        }
                        else {
                            abc = document.getElementById('lstgstclty').options[k].innerText;
                        }
                        var splitpub = abc;
                        var str = splitpub.split("~");
                        var ab = str[0];
                        var ab1 = str[1];


                        document.getElementById('hdngstclty').value = ab1;
                        document.getElementById('txtgstclty').value = ab;
                        document.getElementById("txtgstclty").focus();
                        
                        return false;

                    }


                }

            }
        }

        else if (event.keyCode == 27) {
            document.getElementById("divgstclty").style.display = 'none';
            document.getElementById("txtgstclty").focus();

        }
    }

    function checkmandatory_2() {
        var status = document.getElementById('drpgstatus').value;
        if (status == "N") {
            var chmandat1 = "";
            if (browser != "Microsoft Internet Explorer") {
                chmandat1 = document.getElementById('lblgstclty').textContent;
            }
            else {
                chmandat1 = document.getElementById('lblgstclty').innerText;
            }
            if (chmandat1.indexOf('*') >= 0) {
                if (browser != "Microsoft Internet Explorer") {
                    document.getElementById('lblgstclty').textContent = chmandat1.replace('*', '');
                }
                else {
                    document.getElementById('lblgstclty').innerText = chmandat1.replace('*', '');
                }

            }


            var chmandat1 = "";
            if (browser != "Microsoft Internet Explorer") {
                chmandat1 = document.getElementById('lblgstus').textContent;
            }
            else {
                chmandat1 = document.getElementById('lblgstus').innerText;
            }
            if (chmandat1.indexOf('*') >= 0) {

                if (browser != "Microsoft Internet Explorer") {
                    document.getElementById('lblgstus').textContent = chmandat1.replace('*', '');
                }
                else {
                    document.getElementById('lblgstus').innerText = chmandat1.replace('*', '');
                }


            }


            var chmandat1 = "";
            if (browser != "Microsoft Internet Explorer") {
                chmandat1 = document.getElementById('lblgstdt').textContent;
            }
            else {
                chmandat1 = document.getElementById('lblgstdt').innerText;
            }
            if (chmandat1.indexOf('*') >= 0) {

                if (browser != "Microsoft Internet Explorer") {
                    document.getElementById('lblgstdt').textContent = chmandat1.replace('*', '');
                }
                else {
                    document.getElementById('lblgstdt').innerText = chmandat1.replace('*', '');
                }

            }



            var chmandat1 = "";
            if (browser != "Microsoft Internet Explorer") {
                chmandat1 = document.getElementById('lblgst').textContent;
            }
            else {
                chmandat1 = document.getElementById('lblgst').innerText;
            }
            if (chmandat1.indexOf('*') >= 0) {
                if (browser != "Microsoft Internet Explorer") {
                    document.getElementById('lblgst').textContent = chmandat1.replace('*', '');
                }
                else {
                    document.getElementById('lblgst').innerText = chmandat1.replace('*', '');
                }

            }
        }
        else {
            var chmandat1 = "";
            if (browser != "Microsoft Internet Explorer") {
                chmandat1 = document.getElementById('lblgstclty').textContent;
            }
            else {
                chmandat1 = document.getElementById('lblgstclty').innerText;
            }
           
                if (browser != "Microsoft Internet Explorer") {
                    document.getElementById('lblgstclty').innerHTML = chmandat1 + '*'.fontcolor("red");
                }
                else {
                    document.getElementById('lblgstclty').innerHTML = chmandat1 + '*'.fontcolor("red");
                }

           


            var chmandat1 = "";
            if (browser != "Microsoft Internet Explorer") {
                chmandat1 = document.getElementById('lblgstus').textContent;
            }
            else {
                chmandat1 = document.getElementById('lblgstus').innerText;
            }
            

                if (browser != "Microsoft Internet Explorer") {
                    document.getElementById('lblgstus').innerHTML = chmandat1 + '*'.fontcolor("red");
                }
                else {
                    document.getElementById('lblgstus').innerHTML = chmandat1 + '*'.fontcolor("red");
                }


            

            var chmandat1 = "";
            if (browser != "Microsoft Internet Explorer") {
                chmandat1 = document.getElementById('lblgstdt').textContent;
            }
            else {
                chmandat1 = document.getElementById('lblgstdt').innerText;
            }
          

                if (browser != "Microsoft Internet Explorer") {
                    document.getElementById('lblgstdt').innerHTML = chmandat1 + '*'.fontcolor("red");
                }
                else {
                    document.getElementById('lblgstdt').innerHTML = chmandat1 + '*'.fontcolor("red");
                }

            



            var chmandat1 = "";
            if (browser != "Microsoft Internet Explorer") {
                chmandat1 = document.getElementById('lblgst').textContent;
            }
            else {
                chmandat1 = document.getElementById('lblgst').innerText;
            }
            
            
                if (browser != "Microsoft Internet Explorer") {
                    document.getElementById('lblgst').innerHTML = chmandat1 + '*'.fontcolor("red");
                }
                else {
                    document.getElementById('lblgst').innerHTML = chmandat1 + '*'.fontcolor("red");
                }

            
        }
        return false;

    }



    function checkmandatory() {
        var status = document.getElementById('drpgstatus').value;
        if (status == "N") {
            var chmandat1 = "";
            if (browser != "Microsoft Internet Explorer") {
                chmandat1 = document.getElementById('lblgstclty').textContent;
            }
            else {
                chmandat1 = document.getElementById('lblgstclty').innerText;
            }
            if (chmandat1.indexOf('*') >= 0) {
                if (browser != "Microsoft Internet Explorer") {
                    document.getElementById('lblgstclty').textContent = chmandat1.replace('*', '');
                }
                else {
                    document.getElementById('lblgstclty').innerText = chmandat1.replace('*', '');
                }

            }


            var chmandat1 = "";
            if (browser != "Microsoft Internet Explorer") {
                chmandat1 = document.getElementById('lblgstus').textContent;
            }
            else {
                chmandat1 = document.getElementById('lblgstus').innerText;
            }
            if (chmandat1.indexOf('*') >= 0) {

                if (browser != "Microsoft Internet Explorer") {
                    document.getElementById('lblgstus').textContent = chmandat1.replace('*', '');
                }
                else {
                    document.getElementById('lblgstus').innerText = chmandat1.replace('*', '');
                }
            }


            var chmandat1 = "";
            if (browser != "Microsoft Internet Explorer") {
                chmandat1 = document.getElementById('lblgstdt').textContent;
            }
            else {
                chmandat1 = document.getElementById('lblgstdt').innerText;
            }
            if (chmandat1.indexOf('*') >= 0) {

                if (browser != "Microsoft Internet Explorer") {
                    document.getElementById('lblgstdt').textContent = chmandat1.replace('*', '');
                }
                else {
                    document.getElementById('lblgstdt').innerText = chmandat1.replace('*', '');
                }
            }

            var chmandat1 = "";
            if (browser != "Microsoft Internet Explorer") {
                chmandat1 = document.getElementById('lblgst').textContent;
            }
            else {
                chmandat1 = document.getElementById('lblgst').innerText;
            }
            if (chmandat1.indexOf('*') >= 0) {
                if (browser != "Microsoft Internet Explorer") {
                    document.getElementById('lblgst').textContent = chmandat1.replace('*', '');
                }
                else {
                    document.getElementById('lblgst').innerText = chmandat1.replace('*', '');
                }

            }
        }
        else {
            var chmandat1 = "";
            if (browser != "Microsoft Internet Explorer") {
                chmandat1 = document.getElementById('lblgstclty').textContent;
            }
            else {
                chmandat1 = document.getElementById('lblgstclty').innerText;
            }
          //  chmandat1 = chmandat1.replace("*", "");
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById('lblgstclty').innerHTML = chmandat1 + '*'.fontcolor("red");
            }
            else {
                document.getElementById('lblgstclty').innerHTML = chmandat1 + '*'.fontcolor("red");
            }

            var chmandat1 = "";
            if (browser != "Microsoft Internet Explorer") {
                chmandat1 = document.getElementById('lblgstus').textContent;
            }
            else {
                chmandat1 = document.getElementById('lblgstus').innerText;
            }

            chmandat1 = chmandat1.replace("*", "");
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById('lblgstus').innerHTML = chmandat1 + '*'.fontcolor("red");
            }
            else {
                document.getElementById('lblgstus').innerHTML = chmandat1 + '*'.fontcolor("red");
            }

            var chmandat1 = "";
            if (browser != "Microsoft Internet Explorer") {
                chmandat1 = document.getElementById('lblgstdt').textContent;
            }
            else {
                chmandat1 = document.getElementById('lblgstdt').innerText;
            }

            chmandat1 = chmandat1.replace("*", "");
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById('lblgstdt').innerHTML = chmandat1 + '*'.fontcolor("red");
            }
            else {
                document.getElementById('lblgstdt').innerHTML = chmandat1 + '*'.fontcolor("red");
            }

            var chmandat1 = "";
            if (browser != "Microsoft Internet Explorer") {
                chmandat1 = document.getElementById('lblgst').textContent;
            }
            else {
                chmandat1 = document.getElementById('lblgst').innerText;
            }

            chmandat1 = chmandat1.replace("*", "");
            if (browser != "Microsoft Internet Explorer") {
                document.getElementById('lblgst').innerHTML = chmandat1 + '*'.fontcolor("red");
            }
            else {
                document.getElementById('lblgst').innerHTML = chmandat1 + '*'.fontcolor("red");
            }
        }
        return false;
    }


    function chkgstno() {
        if (document.getElementById('drpgstatus').value == "N") {
            document.getElementById('txtgstin').disabled = true;
            return false;
        }
        else {
            var comp_code = document.getElementById('hiddencompcode').value;
            var unit_code = document.getElementById('hiddencenter').value;
            var gstin = document.getElementById('txtgstin').value;
            var state_code = document.getElementById('hiddenstatecode').value;
            var pan_no = document.getElementById('txtpan').value;
            var type = "AGENCY_MAST";  // do not remove or comment because this is check form name
            var extra1 = "";
            var extra2 = "";
            var extra3 = "";
            var extra4 = "";
            var extra5 = "";
            var response = Agent_master.chkgstno(comp_code, unit_code, gstin, state_code, pan_no, type, extra1, extra2, extra3, extra4, extra5);
            dskan = response.value;
            if (dskan.Tables[0].Rows[0].MESSAGE == "T") {
            }
            else {
                alert(dskan.Tables[0].Rows[0].MESSAGE);
                document.getElementById('txtgstin').value = "";
                alert("Please Fill Valid GST NO");
                document.getElementById('txtgstin').focus();
                return false;
            }
        }
        return false;
    }


