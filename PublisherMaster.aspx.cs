using System;
using System.Data;
using System.Configuration;
using System.Collections;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;
//using System.Windows.Forms;

public partial class PublisherMaster : System.Web.UI.Page
{
    static DataSet executept = new DataSet();
    string formname = "PublisherMaster";
    static int FlagStatus, fpnl, flag;
    static string saveormodify;
    string message;
    int saurabh;
    string compcode, userid;
    static string exepubcode, exepubname, exepubalias;
    static string exeaddress, execountry,exezone,exepubtype;
    static string exestate,execity,exedistrict,exeregion,exesharing;
    static int saurabh_agarwal;
        
    
    
    protected void Page_Load(object sender, EventArgs e)
    {
        Response.Expires = -1;
        Response.Buffer = true;
        Response.ExpiresAbsolute = DateTime.Now.AddDays(-1d);
        Response.Expires = -1500;
        Response.CacheControl = "no-cache";
        if (Session["compcode"] != null)
        {
            hiddencompcode.Value = Session["compcode"].ToString();
            hiddenuserid.Value = Session["userid"].ToString();
            hiddenauto.Value = Session["autogenerated"].ToString();
            compcode = hiddencompcode.Value;
            userid = hiddenuserid.Value;
        }
        else
        {
            //Response.Redirect("login.aspx");
            d1.Text = "<script>alert('session Expired');window.close();</script>";
            return;
        }

        saurabh = 0;

        string formname = "PublisherMaster";
        DataSet ds = new DataSet();
        ds.ReadXml(Server.MapPath("XML/button.xml"));
        btnNew.ImageUrl = ds.Tables[0].Rows[0].ItemArray[0].ToString();
        btnSave.ImageUrl = ds.Tables[0].Rows[0].ItemArray[1].ToString();
        btnModify.ImageUrl = ds.Tables[0].Rows[0].ItemArray[2].ToString();
        btnQuery.ImageUrl = ds.Tables[0].Rows[0].ItemArray[3].ToString();
        btnExecute.ImageUrl = ds.Tables[0].Rows[0].ItemArray[4].ToString();
        btnCancel.ImageUrl = ds.Tables[0].Rows[0].ItemArray[5].ToString();
        btnfirst.ImageUrl = ds.Tables[0].Rows[0].ItemArray[6].ToString();
        btnprevious.ImageUrl = ds.Tables[0].Rows[0].ItemArray[7].ToString();
        btnnext.ImageUrl = ds.Tables[0].Rows[0].ItemArray[8].ToString();
        btnlast.ImageUrl = ds.Tables[0].Rows[0].ItemArray[9].ToString();
        btnDelete.ImageUrl = ds.Tables[0].Rows[0].ItemArray[10].ToString();
        btnExit.ImageUrl = ds.Tables[0].Rows[0].ItemArray[11].ToString();

        DataSet ds1 = new DataSet();
        ds1.ReadXml(Server.MapPath("XML/PublisherMaster.xml"));
        //lblpublication.Text = ds1.Tables[0].Rows[0].ItemArray[0].ToString();
        lblpubcode.Text = ds1.Tables[0].Rows[0].ItemArray[0].ToString();
        lblpubname.Text = ds1.Tables[0].Rows[0].ItemArray[1].ToString();
        lblpubalias.Text = ds1.Tables[0].Rows[0].ItemArray[2].ToString();
        lbladdress.Text = ds1.Tables[0].Rows[0].ItemArray[3].ToString();
        lblcountry.Text = ds1.Tables[0].Rows[0].ItemArray[4].ToString();
        lblstate.Text = ds1.Tables[0].Rows[0].ItemArray[5].ToString();
        lblcity.Text = ds1.Tables[0].Rows[0].ItemArray[6].ToString();
        lbldistrict.Text = ds1.Tables[0].Rows[0].ItemArray[7].ToString();
        lblzone.Text = ds1.Tables[0].Rows[0].ItemArray[8].ToString();
        lblregion.Text = ds1.Tables[0].Rows[0].ItemArray[9].ToString();
        lblpubtype.Text = ds1.Tables[0].Rows[0].ItemArray[10].ToString();
        lblsharing.Text = ds1.Tables[0].Rows[0].ItemArray[11].ToString();



      

        mandatory();


        hiddenauto.Value = Session["autogenerated"].ToString();

       

        if (Session["autogenerated"].ToString() == "1")
        {

            txtpubcode.Enabled = false;

        }

        Ajax.Utility.RegisterTypeForAjax(typeof(PublisherMaster));

        hiddenusername.Value = Session["Username"].ToString();


        ScriptManager1.SetFocus(btnNew);
        if (!Page.IsPostBack)
        {
            txtpubcode.Enabled = false;
            txtpubname.Enabled = false;
            txtpubalias.Enabled = false;
            txtaddress.Enabled = false;
            drpcountry.Enabled = false;
            txtstate.Enabled = false;
            drpcity.Enabled = false;
            txtdistrict.Enabled = false;
            drpzone.Enabled = false;
            drpregion.Enabled = false;
            drppubtype.Enabled = false;
            txtsharing.Enabled = false;
            
            bindcountry();
            //bindcity();
            //bindregion();
            //bindzone();
          


            getbuttoncheck(formname);      //temp
            txtpubalias.Attributes.Add("OnBlur", "javascript:return uppercaseAlias();");
            btnExit.Attributes.Add("OnClick", "javascript:return exitclick();");
            txtpubname.Attributes.Add("onchange", "javascript:return autoornot();");
            btnQuery.Attributes.Add("OnClick", "javascript:return chkquery();");
            btnDelete.Attributes.Add("onclick", "return confirm ('Are you sure you wish to delete this?')");
            txtsharing.Attributes.Add("onchange", "javascript:return chksharing();");
            txtaddress.Attributes.Add("OnChange", "javascript:return uppercase1();");
            txtpubcode.Attributes.Add("OnBlur", "javascript:return upperCode();");
           


        }
        if (btnNew.Enabled == false)
            btnNew.ImageUrl = ds.Tables[1].Rows[0].ItemArray[0].ToString();
        if (btnSave.Enabled == false)
            btnSave.ImageUrl = ds.Tables[1].Rows[0].ItemArray[1].ToString();
        if (btnModify.Enabled == false)
            btnModify.ImageUrl = ds.Tables[1].Rows[0].ItemArray[2].ToString();
        if (btnQuery.Enabled == false)
            btnQuery.ImageUrl = ds.Tables[1].Rows[0].ItemArray[3].ToString();
        if (btnExecute.Enabled == false)
            btnExecute.ImageUrl = ds.Tables[1].Rows[0].ItemArray[4].ToString();
        if (btnCancel.Enabled == false)
            btnCancel.ImageUrl = ds.Tables[1].Rows[0].ItemArray[5].ToString();
        if (btnfirst.Enabled == false)
            btnfirst.ImageUrl = ds.Tables[1].Rows[0].ItemArray[6].ToString();
        if (btnprevious.Enabled == false)
            btnprevious.ImageUrl = ds.Tables[1].Rows[0].ItemArray[7].ToString();
        if (btnnext.Enabled == false)
            btnnext.ImageUrl = ds.Tables[1].Rows[0].ItemArray[8].ToString();
        if (btnlast.Enabled == false)
            btnlast.ImageUrl = ds.Tables[1].Rows[0].ItemArray[9].ToString();
        if (btnDelete.Enabled == false)
            btnDelete.ImageUrl = ds.Tables[1].Rows[0].ItemArray[10].ToString();
        if (btnExit.Enabled == false)
            btnExit.ImageUrl = ds.Tables[1].Rows[0].ItemArray[11].ToString();
    }

    public void bindcountry()
    {
        drpcountry.Items.Clear();
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() =="sql")
        {
            NewAdbooking.Classes.PublisherMaster bind = new NewAdbooking.Classes.PublisherMaster();

            ds = bind.pagedes(hiddencompcode.Value);
        }

            else
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
            {
                NewAdbooking.classesoracle.PublisherMaster bind = new NewAdbooking.classesoracle.PublisherMaster();

                ds = bind.pagedes(hiddencompcode.Value);
            }
            else
            {
                NewAdbooking.classmysql.PublisherMaster bind = new NewAdbooking.classmysql.PublisherMaster();

                ds = bind.pagedes(hiddencompcode.Value);
            }
        ListItem li = new ListItem();
        li.Text = "---Select Country---";
        li.Value = "0";
        li.Selected = true;
        drpcountry.Items.Add(li);

        int x;

        for (x = 0; x < ds.Tables[0].Rows.Count; x++)
        {
            ListItem li1 = new ListItem();
            li1.Text = ds.Tables[0].Rows[x].ItemArray[1].ToString();
            li1.Value = ds.Tables[0].Rows[x].ItemArray[0].ToString();
            drpcountry.Items.Add(li1);

        }

    }



    [Ajax.AjaxMethod]
    public DataSet checkdupCode(string str)
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {
            NewAdbooking.Classes.PublisherMaster auto = new NewAdbooking.Classes.PublisherMaster();
            ds = auto.autocodeDUP(str);
           
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.PublisherMaster auto = new NewAdbooking.classesoracle.PublisherMaster();
            ds = auto.autocodeDUP(str);
        }
        else
        {
            NewAdbooking.classmysql.PublisherMaster auto = new NewAdbooking.classmysql.PublisherMaster();
            ds = auto.autocodeDUP(str);
        }
        return ds;
      //  else
            //if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
            //{
            //    NewAdbooking.classesoracle.PublisherMaster auto = new NewAdbooking.classesoracle.PublisherMaster();
            //    ds = auto.autocode(str);
            //    return ds;
            //}
            //else
            //{
            //    NewAdbooking.classmysql.PublisherMaster auto = new NewAdbooking.classmysql.PublisherMaster();
            //    ds = auto.autocode(str);
            //    return ds;
            //}


    }

    [Ajax.AjaxMethod]

    public DataSet adchkadvcode(string str)
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {
            NewAdbooking.Classes.PublisherMaster auto = new NewAdbooking.Classes.PublisherMaster();
            ds = auto.autocode(str);
            return ds;
        }
        else
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
            {
                NewAdbooking.classesoracle.PublisherMaster auto = new NewAdbooking.classesoracle.PublisherMaster();
                ds = auto.autocode(str);
                return ds;
            }
        else
        {
            NewAdbooking.classmysql.PublisherMaster auto = new NewAdbooking.classmysql.PublisherMaster();
            ds = auto.autocode(str);
            return ds;
        }


    }



    protected void btnNew_Click1(object sender, EventArgs e)
    {
        pnew.Value = "1";
        saurabh_agarwal = 1;
        hiddensaurabh.Value = "1";
       
        drpcountry.SelectedValue = "0";
        drpcity.SelectedValue = "0";
        drpregion.SelectedValue = "0";
        drpzone.SelectedValue = "0";
        drppubtype.SelectedValue="0";
        
        txtaddress.Text = "";
        txtdistrict.Text = "";
        txtpubalias.Text = "";
        txtpubcode.Text = "";
        txtpubname.Text = "";
        txtsharing.Text = "";
        txtstate.Text = "";

        saurabh = 0;
        // hiddenauto.Value = "1";

        saveormodify = "0";

        if (hiddenauto.Value == "1")
        {
            txtpubcode.Enabled = false;

        }
        else
        {
            txtpubcode.Enabled = true;
        }


        drpcountry.Enabled = true;
     //   drpcity.Enabled = true;
     //   drpregion.Enabled = true;
      //  drpzone.Enabled = true;
        drppubtype.Enabled = true;

        txtaddress.Enabled = true;
       // txtdistrict.Enabled = true;
        txtpubalias.Enabled = true;
       // txtpubcode.Enabled = true;
        txtpubname.Enabled = true;
        txtsharing.Enabled = true;
        //txtstate.Enabled = true;

       
        //ScriptManager.RegisterClientScriptBlock(this, typeof(PublisherMaster), "ss", "focus()", true);

        
        //drppublication.Focus();

        ScriptManager1.SetFocus(txtpubname);
       // txtpubname.Focus();

        chkstatus(FlagStatus);          // temp
        btnSave.Enabled = true;
        btnNew.Enabled = false;
        btnQuery.Enabled = false;
        btnimage();

    }
    protected void btnSave_Click(object sender, EventArgs e)
    {
        ///////////statrt here----------
        try
        {
            string sess = Session["compcode"].ToString();
        }
        catch (Exception ex)
        {
            ScriptManager.RegisterClientScriptBlock(this, typeof(PublisherMaster), "abc", "alert('session Expired');window.close();", true);
            return;
        }
        pnew.Value = "0";
        string pubcode = txtpubcode.Text;
        string pubname = txtpubname.Text;
        string pubalias = txtpubalias.Text;
        string address = txtaddress.Text;
        string country = drpcountry.Text;
        string state = txtstate.Text;
        string city = drpcity.SelectedValue;
        string district = txtdistrict.Text; 
        string zone = drpzone.SelectedValue;         
        string region = drpregion.SelectedValue;                                 
        string pubtype = drppubtype.SelectedValue; 
        string sharing = txtsharing.Text;
if(hiddenauto.Value=="0")
        if (txtpubcode.Text.Trim() == "")
        {
            pnew.Value = "1";
            message = "Please Enter Publisher Code ";
            AspNetMessageBox(message);

            //  txtpubname.Enabled = true;
            //txtpubname.Focus();
            ScriptManager1.SetFocus(txtpubcode);
            return;
        }

        if (txtpubname.Text.Trim() == "")
        {
            pnew.Value = "1";
            message = "Please Enter Publisher Name ";
            AspNetMessageBox(message);
            
          //  txtpubname.Enabled = true;
            //txtpubname.Focus();
            ScriptManager1.SetFocus(txtpubname);
            return;
        }

        if (txtpubalias.Text.Trim() == "")
        {
            pnew.Value = "1";
            message = "Please Enter Publisher Alias ";
            AspNetMessageBox(message);
        //    txtpubalias.Enabled = true;
            //txtpubname.Focus();
            ScriptManager1.SetFocus(txtpubalias);
            return;
        }

        if (drppubtype.SelectedIndex <= 0)
        {
            pnew.Value = "1";
            message = "Please Enter Publisher Type";
            AspNetMessageBox(message);
          //  drppubtype.Enabled = true;
            //drppubtype.Focus();
         //   ScriptManager1.SetFocus(drppubtype);
            return;
        }
        if (txtsharing.Text == "")
        {
            pnew.Value = "1";
            message = "Please Enter Sharing (%) ";
            //message = "This Publication Name Has Already Assigned";
            AspNetMessageBox(message);
        //    txtsharing.Enabled = true;
            //txtsharing.Focus();
            ScriptManager1.SetFocus(txtsharing);
            return;
        }
       
        
         
        if (saveormodify == "0")
        {
            DataSet ds = new DataSet();
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
            {
                NewAdbooking.Classes.PublisherMaster getcode = new NewAdbooking.Classes.PublisherMaster();

                ds = getcode.chkcode(pubcode,pubname, Session["compcode"].ToString());
            }

            else
                if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
                {
                    NewAdbooking.classesoracle.PublisherMaster getcode = new NewAdbooking.classesoracle.PublisherMaster();

                    ds = getcode.chkcode(pubcode, pubname, Session["compcode"].ToString());

                }
            else
            {
                NewAdbooking.classmysql.PublisherMaster getcode = new NewAdbooking.classmysql.PublisherMaster();
                ds = getcode.chkcode(pubcode, pubname, Session["compcode"].ToString());
            }
            if (ds.Tables[0].Rows.Count > 0)
            {
                message = "Publisher Code already Exist";
                AspNetMessageBox(message);
                return;
            }
            else
            {
                DataSet di = new DataSet();
                if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
                {
                    NewAdbooking.Classes.PublisherMaster insertthe = new NewAdbooking.Classes.PublisherMaster();
                    di = insertthe.insertedvalue(pubcode, pubname, pubalias, address, country, state, city, district, zone, region, pubtype, sharing, Session["userid"].ToString(), Session["compcode"].ToString());
                }

                else
                    if(ConfigurationSettings .AppSettings ["ConnectionType"].ToString ()=="orcl")
                    {
                        NewAdbooking.classesoracle.PublisherMaster insertthe = new NewAdbooking.classesoracle.PublisherMaster();
                        di = insertthe.insertedvalue(pubcode, pubname, pubalias, address, country, state, city, district, zone, region, pubtype, sharing, Session["userid"].ToString(), Session["compcode"].ToString());
 
                    }
                else
                { 
                    NewAdbooking.classmysql.PublisherMaster insertthe = new NewAdbooking.classmysql.PublisherMaster();
                    di = insertthe.insertedvalue(pubcode, pubname, pubalias, address, country, state, city, district, zone, region, pubtype, sharing, Session["userid"].ToString(), Session["compcode"].ToString());
                 }
                getbuttoncheck(formname);
                
                DataSet ds1 = new DataSet();
                ds1.ReadXml(Server.MapPath("XML/errorMessage.xml"));
                message = ds1.Tables[0].Rows[0].ItemArray[0].ToString();
                AspNetMessageBox(message);

                drpcountry.SelectedValue = "0";
                drpcity.SelectedValue = "0";
                drpregion.SelectedValue = "0";
                drpzone.SelectedValue = "0";
                drppubtype.SelectedValue = "0";

                txtaddress.Text = "";
                txtdistrict.Text = "";
                txtpubalias.Text = "";
                txtpubcode.Text = "";
                txtpubname.Text = "";
                txtsharing.Text = "";
                txtstate.Text = "";

               

                drpcountry.Enabled = false;
                drpcity.Enabled = false;
                drpregion.Enabled = false;
                drpzone.Enabled = false;
                drppubtype.Enabled = false;

                txtaddress.Enabled = false;
                txtdistrict.Enabled = false;
                txtpubalias.Enabled = false;
                txtpubcode.Enabled = false;
                txtpubname.Enabled = false;
                txtsharing.Enabled = false;
                txtstate.Enabled = false;
                btnimage();
                return;


            }

        }
        //for modify

            /// START HERE-------------

        else 
            
        if (hidden_b.Value != txtpubname.Text)
        {
            DataSet ds = new DataSet();
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
            {
                NewAdbooking.Classes.PublisherMaster getcode = new NewAdbooking.Classes.PublisherMaster();

                ds = getcode.chkcode(pubcode, pubname, Session["compcode"].ToString());
            }

            else
                if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
                {
                    NewAdbooking.classesoracle.PublisherMaster getcode = new NewAdbooking.classesoracle.PublisherMaster();

                    ds = getcode.chkcode(pubcode,pubname, Session["compcode"].ToString());

                }
                else
                {
                    NewAdbooking.classmysql.PublisherMaster getcode = new NewAdbooking.classmysql.PublisherMaster();
                    ds = getcode.chkcode(pubcode,pubname, Session["compcode"].ToString());
                }
            if (ds.Tables[1].Rows.Count > 0)
            {
                message = "Publisher Name already Exist";
                AspNetMessageBox(message);
                return;
            }
            else
            {
                DataSet du = new DataSet();
                if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
                {
                    NewAdbooking.Classes.PublisherMaster upadte1 = new NewAdbooking.Classes.PublisherMaster();
                    du = upadte1.pmupdate(pubcode, pubname, pubalias, address, country, state, city, district, zone, region, pubtype, sharing, Session["compcode"].ToString());
                }
                else
                    if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
                    {
                        NewAdbooking.classesoracle.PublisherMaster upadte1 = new NewAdbooking.classesoracle.PublisherMaster();
                        du = upadte1.pmupdate(pubcode, pubname, pubalias, address, country, state, city, district, zone, region, pubtype, sharing, Session["compcode"].ToString());

                    }
                    else
                    {
                        NewAdbooking.classmysql.PublisherMaster upadte1 = new NewAdbooking.classmysql.PublisherMaster();
                        du = upadte1.pmupdate(pubcode, pubname, pubalias, address, country, state, city, district, zone, region, pubtype, sharing, Session["compcode"].ToString());
                    }

                //txtpheight.Enabled = false;
                drpcountry.Enabled = false;
                drpcity.Enabled = false;
                drpregion.Enabled = false;
                drpzone.Enabled = false;
                drppubtype.Enabled = false;

                txtaddress.Enabled = false;
                txtdistrict.Enabled = false;
                txtpubalias.Enabled = false;
                txtpubcode.Enabled = false;
                txtpubname.Enabled = false;
                txtsharing.Enabled = false;
                txtstate.Enabled = false;


                executept.Tables[0].Rows[fpnl].ItemArray[0] = txtpubcode.Text;
                executept.Tables[0].Rows[fpnl].ItemArray[1] = txtpubname.Text;
                executept.Tables[0].Rows[fpnl].ItemArray[2] = txtpubalias.Text;
                executept.Tables[0].Rows[fpnl].ItemArray[3] = txtaddress.Text;
                executept.Tables[0].Rows[fpnl].ItemArray[4] = drpcountry.SelectedValue;
                executept.Tables[0].Rows[fpnl].ItemArray[5] = txtstate.Text;
                executept.Tables[0].Rows[fpnl].ItemArray[6] = drpcity.SelectedValue;
                executept.Tables[0].Rows[fpnl].ItemArray[7] = txtdistrict.Text;
                executept.Tables[0].Rows[fpnl].ItemArray[8] = drpzone.SelectedValue;
                executept.Tables[0].Rows[fpnl].ItemArray[9] = drpregion.SelectedValue;
                executept.Tables[0].Rows[fpnl].ItemArray[10] = drppubtype.SelectedValue;
                executept.Tables[0].Rows[fpnl].ItemArray[11] = txtsharing.Text;

                DataSet ds3 = new DataSet();
                ds3 = executept;
                if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
                {
                    NewAdbooking.Classes.PublisherMaster execute = new NewAdbooking.Classes.PublisherMaster();
                    executept = execute.pmexecute(exepubcode, exepubname, exepubalias, exeaddress, execountry, exestate, execity, exedistrict, exezone, exeregion, exepubtype, exesharing, Session["compcode"].ToString());
                }

                else
                    if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
                    {
                        NewAdbooking.classesoracle.PublisherMaster execute = new NewAdbooking.classesoracle.PublisherMaster();
                        executept = execute.pmexecute(exepubcode, exepubname, exepubalias, exeaddress, execountry, exestate, execity, exedistrict, exezone, exeregion, exepubtype, exesharing, Session["compcode"].ToString());

                    }
                    else
                    {
                        NewAdbooking.classmysql.PublisherMaster execute = new NewAdbooking.classmysql.PublisherMaster();
                        executept = execute.pmexecute(exepubcode, exepubname, exepubalias, exeaddress, execountry, exestate, execity, exedistrict, exezone, exeregion, exepubtype, exesharing, Session["compcode"].ToString());
                    }





                updateStatus();

                ScriptManager1.SetFocus(btnModify);

                DataSet ds2 = new DataSet();
                ds2.ReadXml(Server.MapPath("XML/errorMessage.xml"));
                message = ds2.Tables[0].Rows[0].ItemArray[1].ToString();
                AspNetMessageBox(message);

                if (fpnl == 0)
                {
                    btnfirst.Enabled = false;
                    btnprevious.Enabled = false;
                }
                if (fpnl == executept.Tables[0].Rows.Count - 1)
                {
                    btnlast.Enabled = false;
                    btnnext.Enabled = false;
                }



                btnimage();
                return;


            }

        }
        else
        {
            DataSet du = new DataSet();
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
            {
                NewAdbooking.Classes.PublisherMaster upadte1 = new NewAdbooking.Classes.PublisherMaster();
                du = upadte1.pmupdate(pubcode, pubname, pubalias, address, country, state, city, district, zone, region, pubtype, sharing, Session["compcode"].ToString());
            }
            else
                if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
                {
                    NewAdbooking.classesoracle.PublisherMaster upadte1 = new NewAdbooking.classesoracle.PublisherMaster();
                    du = upadte1.pmupdate(pubcode, pubname, pubalias, address, country, state, city, district, zone, region, pubtype, sharing, Session["compcode"].ToString());

                }
                else
                {
                    NewAdbooking.classmysql.PublisherMaster upadte1 = new NewAdbooking.classmysql.PublisherMaster();
                    du = upadte1.pmupdate(pubcode, pubname, pubalias, address, country, state, city, district, zone, region, pubtype, sharing, Session["compcode"].ToString());
                }

            //txtpheight.Enabled = false;
            drpcountry.Enabled = false;
            drpcity.Enabled = false;
            drpregion.Enabled = false;
            drpzone.Enabled = false;
            drppubtype.Enabled = false;

            txtaddress.Enabled = false;
            txtdistrict.Enabled = false;
            txtpubalias.Enabled = false;
            txtpubcode.Enabled = false;
            txtpubname.Enabled = false;
            txtsharing.Enabled = false;
            txtstate.Enabled = false;


            executept.Tables[0].Rows[fpnl].ItemArray[0] = txtpubcode.Text;
            executept.Tables[0].Rows[fpnl].ItemArray[1] = txtpubname.Text;
            executept.Tables[0].Rows[fpnl].ItemArray[2] = txtpubalias.Text;
            executept.Tables[0].Rows[fpnl].ItemArray[3] = txtaddress.Text;
            executept.Tables[0].Rows[fpnl].ItemArray[4] = drpcountry.SelectedValue;
            executept.Tables[0].Rows[fpnl].ItemArray[5] = txtstate.Text;
            executept.Tables[0].Rows[fpnl].ItemArray[6] = drpcity.SelectedValue;
            executept.Tables[0].Rows[fpnl].ItemArray[7] = txtdistrict.Text;
            executept.Tables[0].Rows[fpnl].ItemArray[8] = drpzone.SelectedValue;
            executept.Tables[0].Rows[fpnl].ItemArray[9] = drpregion.SelectedValue;
            executept.Tables[0].Rows[fpnl].ItemArray[10] = drppubtype.SelectedValue;
            executept.Tables[0].Rows[fpnl].ItemArray[11] = txtsharing.Text;

            DataSet ds3 = new DataSet();
            ds3 = executept;
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
            {
                NewAdbooking.Classes.PublisherMaster execute = new NewAdbooking.Classes.PublisherMaster();
                executept = execute.pmexecute(exepubcode, exepubname, exepubalias, exeaddress, execountry, exestate, execity, exedistrict, exezone, exeregion, exepubtype, exesharing, Session["compcode"].ToString());
            }

            else
                if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
                {
                    NewAdbooking.classesoracle.PublisherMaster execute = new NewAdbooking.classesoracle.PublisherMaster();
                    executept = execute.pmexecute(exepubcode, exepubname, exepubalias, exeaddress, execountry, exestate, execity, exedistrict, exezone, exeregion, exepubtype, exesharing, Session["compcode"].ToString());

                }
                else
                {
                    NewAdbooking.classmysql.PublisherMaster execute = new NewAdbooking.classmysql.PublisherMaster();
                    executept = execute.pmexecute(exepubcode, exepubname, exepubalias, exeaddress, execountry, exestate, execity, exedistrict, exezone, exeregion, exepubtype, exesharing, Session["compcode"].ToString());
                }





            updateStatus();

            ScriptManager1.SetFocus(btnModify);

            DataSet ds2 = new DataSet();
            ds2.ReadXml(Server.MapPath("XML/errorMessage.xml"));
            message = ds2.Tables[0].Rows[0].ItemArray[1].ToString();
            AspNetMessageBox(message);

            if (fpnl == 0)
            {
                btnfirst.Enabled = false;
                btnprevious.Enabled = false;
            }
            if (fpnl == executept.Tables[0].Rows.Count - 1)
            {
                btnlast.Enabled = false;
                btnnext.Enabled = false;
            }



            btnimage();
            return;

        }

        

        saurabh_agarwal = 0;

    }
    protected void btnModify_Click(object sender, EventArgs e)
    {
        pnew.Value = "0";
        saurabh = 1;
        hiddensaurabh.Value = "1";
        txtpubcode.Enabled = false;
        drpcountry.Enabled = true;
        drpcity.Enabled = true;
        drpregion.Enabled = false;
        drpzone.Enabled = false;
        drppubtype.Enabled = true;
        hidden_b.Value = txtpubname.Text;
        txtaddress.Enabled = true;
        txtdistrict.Enabled = false;
        txtpubalias.Enabled = true;
        txtpubname.Enabled = true;
        txtsharing.Enabled = true;
        txtstate.Enabled = false;

        saveormodify = "1";
        chkstatus(FlagStatus);
        btnSave.Enabled = true;
        btnQuery.Enabled = false;
        btnimage();
        ScriptManager1.SetFocus(btnSave);
    }
    protected void btnQuery_Click1(object sender, EventArgs e)
    {
        pnew.Value = "0";
        fpnl = 0;
        
        saurabh_agarwal = 0;
        hiddensaurabh.Value = "0";

        drpcountry.SelectedValue = "0";
        drpcity.SelectedValue = "0";
        drpregion.SelectedValue = "0";
        drpzone.SelectedValue = "0";
        drppubtype.SelectedValue = "0";

        txtaddress.Text = "";
        txtdistrict.Text = "";
        txtpubalias.Text = "";
        txtpubcode.Text = "";
        txtpubname.Text = "";
        txtsharing.Text = "";
        txtstate.Text = "";

        

        drpcountry.Enabled = true;
        drpcity.Enabled = true;
        drpregion.Enabled = true;
        drpzone.Enabled = true;
        drppubtype.Enabled = true;

        txtaddress.Enabled = true;
        txtdistrict.Enabled = true;
        txtpubalias.Enabled = true;
        txtpubcode.Enabled = true;
        txtpubname.Enabled = true;
        txtsharing.Enabled = true;
        txtstate.Enabled = true;


        chkstatus(FlagStatus);
        

        btnQuery.Enabled = false;
        btnExecute.Enabled = true;
        btnSave.Enabled = false;
        btnimage();
        ScriptManager1.SetFocus(btnExecute);

    }
    protected void btnExecute_Click(object sender, EventArgs e)
    {

        try
        {
            string sess = Session["compcode"].ToString();
        }
        catch (Exception ex)
        {
            ScriptManager.RegisterClientScriptBlock(this, typeof(PublisherMaster), "abc", "alert('session Expired');window.close();", true);
            return;
        }
        pnew.Value = "0";
        string ptpubcode = txtpubcode.Text;
        exepubcode = ptpubcode;
        string ptpubname = txtpubname.Text;
        exepubname = ptpubname;
        string ptpubalias = txtpubalias.Text;
        exepubalias = ptpubalias;

        string ptaddress = txtaddress.Text;
        exeaddress = ptaddress;
        string ptcountry = drpcountry.SelectedValue;
        execountry = ptcountry;

        string ptstate = txtstate.Text;
        exestate = ptstate;
        
       
        

        string ptcity = drpcity.SelectedValue;
        execity = ptcity;

        string ptdistrict = txtdistrict.Text;
        exedistrict = ptdistrict;

        string ptzone = drpzone.SelectedValue;
        exezone = ptzone;

        string ptregion = drpregion.SelectedValue;
        exeregion = ptregion;

        string ptpubtype = drppubtype.SelectedValue;
        exepubtype = ptpubtype;

        string ptsharing = txtsharing.Text;
        exesharing = ptsharing;

        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString()=="sql")
        {
            NewAdbooking.Classes.PublisherMaster execute = new NewAdbooking.Classes.PublisherMaster();
            executept = execute.pmexecute(exepubcode, exepubname, exepubalias, exeaddress, execountry, exestate, execity, exedistrict, exezone, exeregion, exepubtype, exesharing, Session["compcode"].ToString());
        }
        else
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
            {
                NewAdbooking.classesoracle.PublisherMaster execute = new NewAdbooking.classesoracle.PublisherMaster();
                executept = execute.pmexecute(exepubcode, exepubname, exepubalias, exeaddress, execountry, exestate, execity, exedistrict, exezone, exeregion, exepubtype, exesharing, Session["compcode"].ToString());

            }
        else
        {
            NewAdbooking.classmysql.PublisherMaster execute = new NewAdbooking.classmysql.PublisherMaster();
            executept = execute.pmexecute(exepubcode, exepubname, exepubalias, exeaddress, execountry, exestate, execity, exedistrict, exezone, exeregion, exepubtype, exesharing, Session["compcode"].ToString());
        }
        if (executept.Tables[0].Rows.Count == 0)
        {
            message = "Your Search Criteria Does Not Exist";
            AspNetMessageBox(message);

            updateStatus();
            getbuttoncheck(formname);

            drpcountry.SelectedValue = "0";
            drpcity.SelectedValue = "0";
            drpregion.SelectedValue = "0";
            drpzone.SelectedValue = "0";
            drppubtype.SelectedValue = "0";

            txtaddress.Text = "";
            txtdistrict.Text = "";
            txtpubalias.Text = "";
            txtpubcode.Text = "";
            txtpubname.Text = "";
            txtsharing.Text = "";
            txtstate.Text = "";

            txtpubcode.Enabled = false;
            txtpubname.Enabled = false;
            txtpubalias.Enabled = false;
            txtaddress.Enabled = false;
            drpcountry.Enabled = false;
            txtstate.Enabled = false;
            drpcity.Enabled = false;
            txtdistrict.Enabled = false;
            drpzone.Enabled = false;
            drpregion.Enabled = false;
            drppubtype.Enabled = false;
            txtsharing.Enabled = false;
            btnimage();

            return;

           

        }

        else
        {

            txtpubcode.Text = executept.Tables[0].Rows[0].ItemArray[0].ToString();
            txtpubname.Text = executept.Tables[0].Rows[0].ItemArray[1].ToString();
            txtpubalias.Text = executept.Tables[0].Rows[0].ItemArray[2].ToString();
            txtaddress.Text = executept.Tables[0].Rows[0].ItemArray[3].ToString();

            drpcountry.SelectedValue = executept.Tables[0].Rows[0].ItemArray[4].ToString();
           
            bindcity();
            if (drpcity.Items.FindByValue(executept.Tables[0].Rows[0].ItemArray[6].ToString()) != null)
                drpcity.SelectedValue = executept.Tables[0].Rows[0].ItemArray[6].ToString();
            else
                drpcity.SelectedValue = "0";
            txtstate.Text = executept.Tables[0].Rows[0].ItemArray[5].ToString();
            txtdistrict.Text = executept.Tables[0].Rows[0].ItemArray[7].ToString();

            bindzone();
            if (drpzone.Items.FindByValue(executept.Tables[0].Rows[0].ItemArray[8].ToString()) != null)
                drpzone.SelectedValue = executept.Tables[0].Rows[0].ItemArray[8].ToString();
            else
                drpzone.SelectedValue = "0";


            bindregion();
            if (drpregion.Items.FindByValue(executept.Tables[0].Rows[0].ItemArray[9].ToString()) != null)
            {
                drpregion.SelectedValue = executept.Tables[0].Rows[0].ItemArray[9].ToString();
            }
            else
            {
                drpregion.SelectedValue = "0";
            }

            drppubtype.SelectedValue = executept.Tables[0].Rows[0].ItemArray[10].ToString();
            txtsharing.Text = executept.Tables[0].Rows[0].ItemArray[11].ToString();

            txtpubcode.Enabled = false;
            txtpubname.Enabled = false;
            txtpubalias.Enabled = false;
            txtaddress.Enabled = false;
            drpcountry.Enabled = false;
            txtstate.Enabled = false;
            drpcity.Enabled = false;
            txtdistrict.Enabled = false;
            drpzone.Enabled = false;
            drpregion.Enabled = false;
            drppubtype.Enabled = false;
            txtsharing.Enabled = false;

        }

        updateStatus();
        getbuttoncheck(formname);
        btnfirst.Enabled = false;
        btnprevious.Enabled = false;
        btnnext.Enabled = true;
        btnlast.Enabled = true;
        btnNew.Enabled = false;
        if (FlagStatus == 2 || FlagStatus == 6 || FlagStatus == 3 || FlagStatus == 7)
            btnModify.Enabled = true;
        if (FlagStatus == 6 || FlagStatus == 4 || FlagStatus == 5 || FlagStatus == 7)
            btnDelete.Enabled = true;

        if (executept.Tables[0].Rows.Count == 1)
        {
            btnfirst.Enabled = false;
            btnlast.Enabled = false;
            btnprevious.Enabled = false;
            btnnext.Enabled = false;
        }
        btnimage();
        ScriptManager1.SetFocus(btnModify);

      
    }
    protected void btnCancel_Click1(object sender, EventArgs e)
    {
        drpcountry.SelectedValue = "0";
        drpcity.SelectedValue = "0";
        drpregion.SelectedValue = "0";
        drpzone.SelectedValue = "0";
        drppubtype.SelectedValue = "0";

        saurabh = 0;

        txtaddress.Text = "";
        txtdistrict.Text = "";
        txtpubalias.Text = "";
        txtpubcode.Text = "";
        txtpubname.Text = "";
        txtsharing.Text = "";
        txtstate.Text = "";

        chkstatus(FlagStatus);

        getbuttoncheck(formname);

        btnSave.Enabled = false;

        drpcountry.Enabled = false;
        drpcity.Enabled = false;
        drpregion.Enabled = false;
        drpzone.Enabled = false;
        drppubtype.Enabled = false;

        txtaddress.Enabled = false;
        txtdistrict.Enabled = false;
        txtpubalias.Enabled = false;
        txtpubcode.Enabled = false;
        txtpubname.Enabled = false;
        txtsharing.Enabled = false;
        txtstate.Enabled = false;
        //btnNew.Focus();

        // ScriptManager.RegisterClientScriptBlock(this, typeof(PageType), "dd", "document.getElementById('btnNew').focus();", true);
        //the above statement was creating some problem while executing so try avoiding this statement and use below statement for focus----
        btnimage();
        ScriptManager1.SetFocus(btnNew);
        
    }
    protected void btnfirst_Click(object sender, EventArgs e)
    {
        fpnl = 0;

        DataSet ds = new DataSet();
        ds = executept;

        //drppublication.SelectedValue = ds.Tables[0].Rows[0].ItemArray[0].ToString();
        txtpubcode.Text = ds.Tables[0].Rows[0].ItemArray[0].ToString();
        txtpubname.Text = ds.Tables[0].Rows[0].ItemArray[1].ToString();
        //txtpubname.Text = ds.Tables[0].Rows[0].ItemArray[2].ToString();
        txtpubalias.Text = ds.Tables[0].Rows[0].ItemArray[2].ToString();
        txtaddress.Text = ds.Tables[0].Rows[0].ItemArray[3].ToString();
        
        drpcountry.SelectedValue = ds.Tables[0].Rows[0].ItemArray[4].ToString();
       
        bindcity();
        if (drpcity.Items.FindByValue(executept.Tables[0].Rows[0].ItemArray[6].ToString()) != null)
            drpcity.SelectedValue = ds.Tables[0].Rows[0].ItemArray[6].ToString();
        else
            drpcity.SelectedValue = "0";
        txtstate.Text = ds.Tables[0].Rows[0].ItemArray[5].ToString();
        txtdistrict.Text = ds.Tables[0].Rows[0].ItemArray[7].ToString();
        bindzone();
        if (drpzone.Items.FindByValue(executept.Tables[0].Rows[0].ItemArray[8].ToString()) != null)
            drpzone.SelectedValue = ds.Tables[0].Rows[0].ItemArray[8].ToString();
        else
            drpzone.SelectedValue = "0";
        bindregion();
        if (drpregion.Items.FindByValue(ds.Tables[0].Rows[0].ItemArray[9].ToString()) != null)
            drpregion.SelectedValue = ds.Tables[0].Rows[0].ItemArray[9].ToString();
        else
            drpregion.SelectedValue = "0";
        drppubtype.SelectedValue = ds.Tables[0].Rows[0].ItemArray[10].ToString();
        txtsharing.Text = ds.Tables[0].Rows[0].ItemArray[11].ToString();
        
        //updateStatus();
        //getbuttoncheck(formname);
        btnfirst.Enabled = false;
        btnprevious.Enabled = false;
        btnnext.Enabled = true;
        btnlast.Enabled = true;
        btnNew.Enabled = false;
        drpregion.Enabled = false;
        drpzone.Enabled = false;
        btnimage();
    }
    protected void btnprevious_Click(object sender, EventArgs e)
    {
        DataSet ds = new DataSet();
        ds = executept;

        // fpnl--;
        int count = ds.Tables[0].Rows.Count - 1;

        fpnl--;

        if (fpnl != -1)
        {
            if (fpnl >= 0 || fpnl <= count)
            {

                txtpubcode.Text = ds.Tables[0].Rows[fpnl].ItemArray[0].ToString();
                txtpubname.Text = ds.Tables[0].Rows[fpnl].ItemArray[1].ToString();
                //txtpubname.Text = ds.Tables[0].Rows[fpnl].ItemArray[2].ToString();
                txtpubalias.Text = ds.Tables[0].Rows[fpnl].ItemArray[2].ToString();
                txtaddress.Text = ds.Tables[0].Rows[fpnl].ItemArray[3].ToString();

                drpcountry.SelectedValue = ds.Tables[0].Rows[fpnl].ItemArray[4].ToString();
                
                bindcity();
                if (drpcity.Items.FindByValue(ds.Tables[0].Rows[fpnl].ItemArray[6].ToString()) != null)
                    drpcity.SelectedValue = ds.Tables[0].Rows[fpnl].ItemArray[6].ToString();
                else
                    drpcity.SelectedValue = "0";
              
                txtstate.Text = ds.Tables[0].Rows[fpnl].ItemArray[5].ToString();
                txtdistrict.Text = ds.Tables[0].Rows[fpnl].ItemArray[7].ToString();
                bindregion();
                bindzone();
                if (drpzone.Items.FindByValue(ds.Tables[0].Rows[fpnl].ItemArray[8].ToString()) != null)
                    drpzone.SelectedValue = ds.Tables[0].Rows[fpnl].ItemArray[8].ToString();

                if (drpregion.Items.FindByValue(ds.Tables[0].Rows[fpnl].ItemArray[9].ToString()) != null)
                    drpregion.SelectedValue = ds.Tables[0].Rows[fpnl].ItemArray[9].ToString();
                

                drppubtype.SelectedValue = ds.Tables[0].Rows[fpnl].ItemArray[10].ToString();
                txtsharing.Text = ds.Tables[0].Rows[fpnl].ItemArray[11].ToString();

                //updateStatus();
                //getbuttoncheck(formname);
                btnfirst.Enabled = true;
                btnlast.Enabled = true;
                btnprevious.Enabled = true;
                btnnext.Enabled = true;
            }
            else
            {
                btnnext.Enabled = true;
                btnlast.Enabled = true;
                btnfirst.Enabled = false;
                btnprevious.Enabled = false;

            }
        }
        else
        {
            btnnext.Enabled = true;
            btnlast.Enabled = true;
            btnfirst.Enabled = false;
            btnprevious.Enabled = false;

        }
        if (fpnl == 0)
        {
            btnfirst.Enabled = false;
            btnprevious.Enabled = false;
            btnnext.Enabled = true;
            btnlast.Enabled = true;

        }
        btnNew.Enabled = false;
        drpregion.Enabled = false;
        drpzone.Enabled = false;
        btnimage();

    }
    protected void btnnext_Click(object sender, EventArgs e)
    {
        DataSet ds = new DataSet();
        ds = executept;
        int count = ds.Tables[0].Rows.Count - 1;
        fpnl++;


        if (fpnl != -1 && fpnl >= 0)
        {
            if (fpnl <= count)
            {
                txtpubcode.Text = ds.Tables[0].Rows[fpnl].ItemArray[0].ToString();
                txtpubname.Text = ds.Tables[0].Rows[fpnl].ItemArray[1].ToString();
                //txtpubname.Text = ds.Tables[0].Rows[fpnl].ItemArray[2].ToString();
                txtpubalias.Text = ds.Tables[0].Rows[fpnl].ItemArray[2].ToString();
                txtaddress.Text = ds.Tables[0].Rows[fpnl].ItemArray[3].ToString();

                drpcountry.SelectedValue = ds.Tables[0].Rows[fpnl].ItemArray[4].ToString();
             
                bindcity();
                if (drpcity.Items.FindByValue(ds.Tables[0].Rows[fpnl].ItemArray[6].ToString()) != null)
                    drpcity.SelectedValue = ds.Tables[0].Rows[fpnl].ItemArray[6].ToString();
                else
                    drpcity.SelectedValue = "0";
                txtstate.Text = ds.Tables[0].Rows[fpnl].ItemArray[5].ToString();
                txtdistrict.Text = ds.Tables[0].Rows[fpnl].ItemArray[7].ToString();
                //if (fpnl == -1 || fpnl <= 0)
                //{
                    bindzone();
                    bindregion();
               // }*/
                if (drpzone.Items.FindByValue(ds.Tables[0].Rows[fpnl].ItemArray[8].ToString()) !=null)
                       drpzone.SelectedValue = ds.Tables[0].Rows[fpnl].ItemArray[8].ToString();
                 
                if (drpregion.Items.FindByValue(ds.Tables[0].Rows[fpnl].ItemArray[9].ToString()) != null)
                       drpregion.SelectedValue = ds.Tables[0].Rows[fpnl].ItemArray[9].ToString();

                drppubtype.SelectedValue = ds.Tables[0].Rows[fpnl].ItemArray[10].ToString();
                txtsharing.Text = ds.Tables[0].Rows[fpnl].ItemArray[11].ToString();

                btnfirst.Enabled = true;
                btnprevious.Enabled = true;

            }

            else
            {
                btnnext.Enabled = false;
                btnlast.Enabled = false;
                btnfirst.Enabled = true;
                btnprevious.Enabled = true;

            }
        }
        else
        {
            btnnext.Enabled = false;
            btnlast.Enabled = false;
            btnfirst.Enabled = true;
            btnprevious.Enabled = true;

        }
        if (fpnl == count)
        {
            btnnext.Enabled = false;
            btnlast.Enabled = false;
            btnfirst.Enabled = true;
            btnprevious.Enabled = true;

        }
        btnNew.Enabled = false;
        drpregion.Enabled = false;
        drpzone.Enabled = false;
        btnimage();
    }
    protected void btnlast_Click(object sender, EventArgs e)
    {
        DataSet ds = new DataSet();
        ds = executept;
        int count = ds.Tables[0].Rows.Count;
        fpnl = count - 1;


        txtpubcode.Text = ds.Tables[0].Rows[fpnl].ItemArray[0].ToString();
        txtpubname.Text = ds.Tables[0].Rows[fpnl].ItemArray[1].ToString();
        //txtpubname.Text = ds.Tables[0].Rows[fpnl].ItemArray[2].ToString();
        txtpubalias.Text = ds.Tables[0].Rows[fpnl].ItemArray[2].ToString();
        txtaddress.Text = ds.Tables[0].Rows[fpnl].ItemArray[3].ToString();

        drpcountry.SelectedValue = ds.Tables[0].Rows[fpnl].ItemArray[4].ToString();
      
        bindcity();
        if (drpzone.Items.FindByValue(executept.Tables[0].Rows[fpnl].ItemArray[6].ToString()) != null)
            drpcity.SelectedValue = ds.Tables[0].Rows[fpnl].ItemArray[6].ToString();
        else
            drpcity.SelectedValue = "0";
        txtstate.Text = ds.Tables[0].Rows[fpnl].ItemArray[5].ToString();
        txtdistrict.Text = ds.Tables[0].Rows[fpnl].ItemArray[7].ToString();
        bindzone();
        bindregion();
        if (drpzone.Items.FindByValue(executept.Tables[0].Rows[fpnl].ItemArray[8].ToString()) != null)
            drpzone.SelectedValue = ds.Tables[0].Rows[fpnl].ItemArray[8].ToString();
        else
            drpzone.SelectedValue = "0";
        if (drpregion.Items.FindByValue(ds.Tables[0].Rows[fpnl].ItemArray[9].ToString()) != null)
            drpregion.SelectedValue = ds.Tables[0].Rows[fpnl].ItemArray[9].ToString();
        else
            drpregion.SelectedValue = "0";

        drppubtype.SelectedValue = ds.Tables[0].Rows[fpnl].ItemArray[10].ToString();
        txtsharing.Text = ds.Tables[0].Rows[fpnl].ItemArray[11].ToString();

        //updateStatus();
        //getbuttoncheck(formname);
        btnfirst.Enabled = true;
        btnprevious.Enabled = true;
        btnlast.Enabled = false;
        btnnext.Enabled = false;
        btnNew.Enabled = false;
        drpregion.Enabled = false;
        drpzone.Enabled = false;
        btnimage();
    }
    protected void btnDelete_Click(object sender, EventArgs e)
    {
        try
        {
            string sess = Session["compcode"].ToString();
        }
        catch (Exception ex)
        {
            ScriptManager.RegisterClientScriptBlock(this, typeof(PublisherMaster), "abc", "alert('session Expired');window.close();", true);
            return;
        }
        string pubcode = txtpubcode.Text;
        DataSet ds1 = new DataSet();
        if (ConfigurationSettings.AppSettings["Connectiontype"].ToString()=="sql")
        {
            NewAdbooking.Classes.PublisherMaster del = new NewAdbooking.Classes.PublisherMaster();
            ds1 = del.pmdelete(pubcode, Session["compcode"].ToString());
        }
        else
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
            {
                NewAdbooking.classesoracle.PublisherMaster del = new NewAdbooking.classesoracle.PublisherMaster();
                ds1 = del.pmdelete(pubcode, Session["compcode"].ToString());

            }
        else
        {
            NewAdbooking.classmysql.PublisherMaster del = new NewAdbooking.classmysql.PublisherMaster();
            ds1 = del.pmdelete(pubcode, Session["compcode"].ToString());
        }
        if (ConfigurationSettings.AppSettings["Connectiontype"].ToString()=="sql")
        {
            NewAdbooking.Classes.PublisherMaster execute = new NewAdbooking.Classes.PublisherMaster();
            executept = execute.pmexecute(exepubcode, exepubname, exepubalias, exeaddress, execountry, exestate, execity, exedistrict, exezone, exeregion, exepubtype, exesharing, Session["compcode"].ToString());
        }
        else
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
            {
                NewAdbooking.classesoracle.PublisherMaster execute = new NewAdbooking.classesoracle.PublisherMaster();
                executept = execute.pmexecute(exepubcode, exepubname, exepubalias, exeaddress, execountry, exestate, execity, exedistrict, exezone, exeregion, exepubtype, exesharing, Session["compcode"].ToString());

            }
        else
        {
            NewAdbooking.classmysql.PublisherMaster execute = new NewAdbooking.classmysql.PublisherMaster();
            executept = execute.pmexecute(exepubcode, exepubname, exepubalias, exeaddress, execountry, exestate, execity, exedistrict, exezone, exeregion, exepubtype, exesharing, Session["compcode"].ToString());
        }

         int a = executept.Tables[0].Rows.Count;
         if (a == 1)
         {
             btnnext.Enabled = false;
             btnlast.Enabled = false;
             btnfirst.Enabled = false;
             btnprevious.Enabled = false;
         }
         if (a <= 0)
         {
             btnfirst.Enabled = false;
             btnprevious.Enabled = false;
         }
         if (a <= 0)
         {
             DataSet ds5 = new DataSet();
             ds5.ReadXml(Server.MapPath("XML/errorMessage.xml"));
             message = ds5.Tables[0].Rows[0].ItemArray[2].ToString();
             AspNetMessageBox(message);
             updateStatus();
             getbuttoncheck(formname);
             drpcountry.SelectedValue = "0";
             drpcity.SelectedValue = "0";
             drpregion.SelectedValue = "0";
             drpzone.SelectedValue = "0";
             drppubtype.SelectedValue = "0";

             txtaddress.Text = "";
             txtdistrict.Text = "";
             txtpubalias.Text = "";
             txtpubcode.Text = "";
             txtpubname.Text = "";
             txtsharing.Text = "";
             txtstate.Text = "";
             drpzone.Enabled = false;
             drpregion.Enabled = false;
             btnimage();
             return;

         }
         else if (fpnl == -1 || fpnl >= a)
         {
             DataSet ds = new DataSet();

             ds = executept;
             txtpubcode.Text = ds.Tables[0].Rows[0].ItemArray[0].ToString();
             txtpubname.Text = ds.Tables[0].Rows[0].ItemArray[1].ToString();
             txtpubalias.Text = ds.Tables[0].Rows[0].ItemArray[2].ToString();
             txtaddress.Text = ds.Tables[0].Rows[0].ItemArray[3].ToString();

             drpcountry.SelectedValue = ds.Tables[0].Rows[0].ItemArray[4].ToString();
             txtstate.Text = ds.Tables[0].Rows[0].ItemArray[5].ToString();
             bindcity();
             drpcity.SelectedValue = ds.Tables[0].Rows[0].ItemArray[6].ToString();
             txtdistrict.Text = ds.Tables[0].Rows[0].ItemArray[7].ToString();
             bindzone();
             bindregion();
             if (drpzone.Items.FindByValue(executept.Tables[0].Rows[0].ItemArray[8].ToString()) != null)
                 drpzone.SelectedValue = ds.Tables[0].Rows[0].ItemArray[8].ToString();
             else
                 drpzone.SelectedValue = "0";
             if (drpregion.Items.FindByValue(ds.Tables[0].Rows[0].ItemArray[9].ToString()) != null)
                 drpregion.SelectedValue = ds.Tables[0].Rows[0].ItemArray[9].ToString();
             else
                 drpregion.SelectedValue = "0";
             //drpzone.SelectedValue = ds.Tables[0].Rows[0].ItemArray[8].ToString();
             //drpregion.SelectedValue = ds.Tables[0].Rows[0].ItemArray[9].ToString();

             drppubtype.SelectedValue = ds.Tables[0].Rows[0].ItemArray[10].ToString();
             txtsharing.Text = ds.Tables[0].Rows[0].ItemArray[11].ToString();

         }

         else
         {
             DataSet ds = new DataSet();
             ds = executept;
             txtpubcode.Text = ds.Tables[0].Rows[0].ItemArray[0].ToString();
             txtpubname.Text = ds.Tables[0].Rows[0].ItemArray[1].ToString();
             //txtpubname.Text = ds.Tables[0].Rows[0].ItemArray[2].ToString();
             txtpubalias.Text = ds.Tables[0].Rows[0].ItemArray[2].ToString();
             txtaddress.Text = ds.Tables[0].Rows[0].ItemArray[3].ToString();

             drpcountry.SelectedValue = ds.Tables[0].Rows[0].ItemArray[4].ToString();
             bindcity();
             txtstate.Text = ds.Tables[0].Rows[0].ItemArray[5].ToString();
             drpcity.SelectedValue = ds.Tables[0].Rows[0].ItemArray[6].ToString();
             txtdistrict.Text = ds.Tables[0].Rows[0].ItemArray[7].ToString();
             bindregion();
             bindzone();
             drpzone.SelectedValue = ds.Tables[0].Rows[0].ItemArray[8].ToString();
             drpregion.SelectedValue = ds.Tables[0].Rows[0].ItemArray[9].ToString();

             drppubtype.SelectedValue = ds.Tables[0].Rows[0].ItemArray[10].ToString();
             txtsharing.Text = ds.Tables[0].Rows[0].ItemArray[11].ToString();
         }

         drpzone.Enabled = false;
         drpregion.Enabled = false;

             DataSet ds3 = new DataSet();
             ds3.ReadXml(Server.MapPath("XML/errorMessage.xml"));
             message = ds3.Tables[0].Rows[0].ItemArray[2].ToString();
             AspNetMessageBox(message);
             btnimage();
    }
    protected void btnExit_Click(object sender, EventArgs e)
    {

    }
    protected void drpcountry_SelectedIndexChanged(object sender, EventArgs e)
    {
        drpcity.Enabled = true;
        bindcity();
       // ScriptManager1.SetFocus(drpcountry);
       

        
    }

    
    

    protected void AspNetMessageBox(string strMessage)
    {
        string strAlert = "";
        strAlert = "alert('" + strMessage + "')";
        ScriptManager.RegisterClientScriptBlock(this, typeof(PublisherMaster), "ShowAlert", strAlert, true);
    }

    public void bindzone()
    {
        drpzone.Items.Clear();
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {
            NewAdbooking.Classes.PublisherMaster bind = new NewAdbooking.Classes.PublisherMaster();
            string city = drpcity.SelectedValue;
            ds = bind.pubzone(city);
        }
        else
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
            {
                NewAdbooking.classesoracle.PublisherMaster bind = new NewAdbooking.classesoracle.PublisherMaster();
                string city = drpcity.SelectedValue;
                ds = bind.pubzone(city);
            }
        else
        {
          NewAdbooking.classmysql.PublisherMaster bind = new NewAdbooking.classmysql.PublisherMaster();
            string city = drpcity.SelectedValue;
            ds = bind.pubzone(city);
        }
      
        ListItem li1;
        li1 = new ListItem();
        li1.Text = "---Select Zone---";
        li1.Value = "0";//objDataSet.Tables[0].Rows[i].ItemArray[0].ToString();
        li1.Selected = true;
        drpzone.Items.Add(li1);
        
        if (ds.Tables[0].Rows.Count > 0)
        {
            drpzone.Enabled = true;
            int i;
            for (i = 0; i < ds.Tables[0].Rows.Count; i++)
            {
                ListItem li;
                li = new ListItem();
                li.Text = ds.Tables[0].Rows[i].ItemArray[1].ToString();
                li.Value = ds.Tables[0].Rows[i].ItemArray[0].ToString();
                drpzone.Items.Add(li);
                drpzone.SelectedValue = li.Value;

            }

        }
        //else
        //{
        //    if (saurabh_agarwal == 1)
        //    {
        //        message = "There is no matching value for Zone";
        //        AspNetMessageBox(message);
               
        //        drpzone.Enabled = false;
             
        //        return;
        //    }
        //}
        drpzone.Enabled = false;
    }

    public void bindregion()
    {
        drpregion.Items.Clear();
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {
            NewAdbooking.Classes.PublisherMaster bind = new NewAdbooking.Classes.PublisherMaster();
            string city = drpcity.SelectedValue;
            ds = bind.pubregion(city);
        }
        else
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
            {
                NewAdbooking.classesoracle.PublisherMaster bind = new NewAdbooking.classesoracle.PublisherMaster();
                string city = drpcity.SelectedValue;
                ds = bind.pubregion(city);
            }
        else
        {
            NewAdbooking.classmysql.PublisherMaster bind = new NewAdbooking.classmysql.PublisherMaster();
            string city = drpcity.SelectedValue;
            ds = bind.pubregion(city);
        }
        ListItem li1;
        li1 = new ListItem();
        li1.Text = "---Select Region---";
        li1.Value = "0";//objDataSet.Tables[0].Rows[i].ItemArray[0].ToString();
        li1.Selected = true;
        drpregion.Items.Add(li1);
        if (ds.Tables[0].Rows.Count > 0)
        {
            drpregion.Enabled = true;
            int i;
            for (i = 0; i < ds.Tables[0].Rows.Count; i++)
            {
                ListItem li = new ListItem();
                li.Text = ds.Tables[0].Rows[i].ItemArray[1].ToString();
                li.Value = ds.Tables[0].Rows[i].ItemArray[0].ToString();
                drpregion.Items.Add(li);
                drpregion.SelectedValue = li.Value;


            }
            
        }
        //else
        //{
        //    if (saurabh_agarwal == 1)
        //    {
        //        message = "There is no matching value for Region";
        //        AspNetMessageBox(message);
        //        drpregion.Enabled = false;
        //        return;
        //    }
        //}

        drpregion.Enabled = false;
    }

    public void bindcity()
    {
        drpcity.Items.Clear();
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {
            NewAdbooking.Classes.PublisherMaster bind = new NewAdbooking.Classes.PublisherMaster();
            string country = drpcountry.SelectedValue;
            ds = bind.pubcity(country);
        }
        else
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
            {
                NewAdbooking.classesoracle.PublisherMaster bind = new NewAdbooking.classesoracle.PublisherMaster();
                string country = drpcountry.SelectedValue;
                ds = bind.pubcity(country);
            }
        else
        {
            NewAdbooking.classmysql.PublisherMaster bind = new NewAdbooking.classmysql.PublisherMaster();
            string country = drpcountry.SelectedValue;
            ds = bind.pubcity(country);
        }
        ListItem li = new ListItem();
        li.Text = "----Select City----";
        li.Value = "0";
        li.Selected = true;
        drpcity.Items.Add(li);
        if (ds.Tables[0].Rows.Count > 0)
        {
           // drpcity.Enabled = true;
            int x;
            for (x = 0; x < ds.Tables[0].Rows.Count; x++)
            {
                ListItem li1 = new ListItem();
                li1.Text = ds.Tables[0].Rows[x].ItemArray[1].ToString();
                li1.Value = ds.Tables[0].Rows[x].ItemArray[0].ToString();
                drpcity.Items.Add(li1);

            }
        }   
        //else
        //{
        //    if (saurabh_agarwal == 1)
        //    {
        //        message = "There is no matching value for City";
        //        AspNetMessageBox(message);
        //        //drpcity.Enabled = true;
        //        //drpregion.Enabled = false;
        //        //drpzone.Enabled = false;
        //        //txtdistrict.Enabled = false;
        //        //txtstate.Enabled = false;
        //       // drpcity.Focus();

                
        //        //return;
        //    }
        //    drpcity.Enabled = true;
        //   // drpcity.Focus();
        //}
        drpregion.Items.Clear();
        drpzone.Items.Clear();
        txtdistrict.Text = "";
        txtstate.Text = "";
        drpregion.Enabled = false;
        drpzone.Enabled = false;
        txtdistrict.Enabled = false;
        txtstate.Enabled = false;
    }


    protected void drpcity_SelectedIndexChanged(object sender, EventArgs e)
    {
        txtstate.Text = "";
        txtdistrict.Text = "";
        fillstate();
        bindregion();
        bindzone();

        ScriptManager1.SetFocus(drpcity);

      
       
    }
    public void fillstate()
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {
            NewAdbooking.Classes.PublisherMaster bind = new NewAdbooking.Classes.PublisherMaster();
            string city = drpcity.SelectedValue;
            ds = bind.pubstate(city);
        }
        else
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
            {
                NewAdbooking.classesoracle.PublisherMaster bind = new NewAdbooking.classesoracle.PublisherMaster();
                string city = drpcity.SelectedValue;
                ds = bind.pubstate(city);
            }
        else
        {
            NewAdbooking.classmysql.PublisherMaster bind = new NewAdbooking.classmysql.PublisherMaster();
            string city = drpcity.SelectedValue;
            ds = bind.pubstate(city);
        }
        
        if (ds.Tables[0].Rows.Count > 0)
        {
            txtstate.Text = ds.Tables[0].Rows[0].ItemArray[0].ToString();
            if (ds.Tables[1].Rows.Count != 0)
                txtdistrict.Text = ds.Tables[1].Rows[0].ItemArray[0].ToString();
            else
                txtdistrict.Text = "";
            
        }
        //else
        //{
        //    if (saurabh_agarwal == 1)
        //    {
        //        if (txtstate.Text == "")
        //        {
        //            message = "There is no matching value for State";
        //            AspNetMessageBox(message);
        //        }
        //        if (txtdistrict.Text == "")
        //        {
        //            message = "There is no matching value for district";
        //            AspNetMessageBox(message);
        //        }
        //    }
        //}
    


    }







    private void mandatory()
    {
        if (lblpubcode.Text.IndexOf("*") >= 0)
        {
            hiddenpubcode.Value = "1";
        }
        else
        {
            hiddenpubcode.Value = "0";
        }


        if (lblpubname.Text.IndexOf("*") >= 0)
        {
            hiddenpubname.Value = "1";
        }
        else
        {
            hiddenpubname.Value = "0";
        }


        
        if (lblpubalias.Text.IndexOf("*") >= 0)
        {
            hiddenpubalias.Value = "1";
        }
        else
        {
            hiddenpubalias.Value = "0";
        }


        if (lblpubtype.Text.IndexOf("*") >= 0)
        {
            hiddenpubtype.Value = "1";
        }
        else
        {
            hiddenpubtype.Value = "0";
        }


        if (lblsharing.Text.IndexOf("*") >= 0)
        {
            hiddensharing.Value = "1";
        }
        else
        {
            hiddensharing.Value = "0";
        }

    }

    public void getbuttoncheck(string formname)
    {
          DataSet butt = new DataSet();
          if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
          {
              NewAdbooking.Classes.classlibraryforbutton getpermission = new NewAdbooking.Classes.classlibraryforbutton();
              butt = getpermission.getbuttonpermission(Session["compcode"].ToString(), Session["userid"].ToString(), formname);
          }
          else
              if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
              {
                  NewAdbooking.classesoracle.classlibraryforbutton getpermission = new NewAdbooking.classesoracle.classlibraryforbutton();
                  butt = getpermission.getbuttonpermission(Session["compcode"].ToString(), Session["userid"].ToString(), formname);

              }
          else
          {
              NewAdbooking.classmysql.classlibraryforbutton getpermission = new NewAdbooking.classmysql.classlibraryforbutton();
              butt = getpermission.getbuttonpermission(Session["compcode"].ToString(), Session["userid"].ToString(), formname);
          }
          
        string id = butt.Tables[0].Rows[0].ItemArray[0].ToString();// Tables[0].Rows[0].ItemArray[0].ToString();


        if (id != "0")
        {
            //var id = ds.Tables[0].Rows[0].button_id;



            if (id == "0" || id == "8")
            {

                FlagStatus = 0;

                btnNew.Enabled = false;
                btnQuery.Enabled = false;
                btnExecute.Enabled = false;
                btnCancel.Enabled = false;
                btnExit.Enabled = false;
                btnDelete.Enabled = false;
                btnModify.Enabled = false;

                btnSave.Enabled = false;
                btnModify.Enabled = false;
                btnfirst.Enabled = false;
                btnnext.Enabled = false;
                btnprevious.Enabled = false;
                btnlast.Enabled = false;



             


            }
            if (id == "1" || id == "9")
            {
                btnNew.Enabled = true;
                btnQuery.Enabled = true;
                btnCancel.Enabled = true;
                btnExit.Enabled = true;
                btnDelete.Enabled = false;
                btnExecute.Enabled = false;

                btnSave.Enabled = false;
                btnModify.Enabled = false;
                btnfirst.Enabled = false;
                btnnext.Enabled = false;
                btnprevious.Enabled = false;
                btnlast.Enabled = false;
                FlagStatus = 1;

            }
            if (id == "2" || id == "10")
            {

                btnNew.Enabled = false;
                btnExecute.Enabled = false;
                btnQuery.Enabled = true;
                btnCancel.Enabled = true;
                btnExit.Enabled = true;
                btnDelete.Enabled = false;
                //a//btnModify.Enabled = true;
                btnModify.Enabled = false;

                btnSave.Enabled = false;
                //a// btnfirst.Enabled = true;
                btnfirst.Enabled = false;
                btnnext.Enabled = false;
                btnprevious.Enabled = false;
                btnlast.Enabled = false;
                btnExit.Enabled = true;
                FlagStatus = 2;


            }
            if (id == "3" || id == "11")
            {
                btnNew.Enabled = true;
                btnQuery.Enabled = true;
                btnExecute.Enabled = false;
                btnDelete.Enabled = false;
                btnModify.Enabled = false;
                btnCancel.Enabled = true;
                btnExit.Enabled = true;
                btnDelete.Enabled = false;


                btnSave.Enabled = false;
                btnfirst.Enabled = false;
                btnnext.Enabled = false;
                btnprevious.Enabled = false;
                btnlast.Enabled = false;

                FlagStatus = 3;



            }
            if (id == "4" || id == "12")
            {
                btnNew.Enabled = false;
                btnQuery.Enabled = true;
                btnCancel.Enabled = true;
                btnExit.Enabled = true;
                btnDelete.Enabled = false;
                btnfirst.Enabled = false;
                btnnext.Enabled = false;
                btnprevious.Enabled = false;
                btnlast.Enabled = false;
                btnExecute.Enabled = false;

                btnNew.Enabled = false;
                btnExecute.Enabled = false;
                btnDelete.Enabled = false;
                btnCancel.Enabled = true;
                btnExit.Enabled = true;


                btnModify.Enabled = false;

                btnSave.Enabled = false;
                btnfirst.Enabled = false;
                btnnext.Enabled = false;
                btnprevious.Enabled = false;
                btnlast.Enabled = false;
                FlagStatus = 4;



            }
            if (id == "5" || id == "13")
            {
                btnNew.Enabled = true;
                btnSave.Enabled = false;
                btnQuery.Enabled = true;
                btnCancel.Enabled = true;
                btnExit.Enabled = true;
                btnDelete.Enabled = false;
                btnfirst.Enabled = false;
                btnnext.Enabled = false;
                btnprevious.Enabled = false;
                btnlast.Enabled = false;
                btnExecute.Enabled = false;
                btnModify.Enabled = false;
                FlagStatus = 5;


            }
            if (id == "6" || id == "14")
            {
                btnNew.Enabled = false;
                btnSave.Enabled = false;
                btnQuery.Enabled = true;
                btnModify.Enabled = false;
                btnCancel.Enabled = true;
                btnExit.Enabled = true;
                btnDelete.Enabled = false;
                btnfirst.Enabled = false;
                btnnext.Enabled = false;
                btnprevious.Enabled = false;
                btnlast.Enabled = false;
                btnExecute.Enabled = false;

                FlagStatus = 6;
            }
            if (id == "7" || id == "15")
            {
                btnNew.Enabled = true;
                btnSave.Enabled = false;
                btnQuery.Enabled = true;
                btnModify.Enabled = false;
                btnCancel.Enabled = true;
                btnExit.Enabled = true;
                btnDelete.Enabled = false;
                btnfirst.Enabled = false;
                btnnext.Enabled = false;
                btnprevious.Enabled = false;
                btnlast.Enabled = false;
                btnExecute.Enabled = false;
                FlagStatus = 7;

            }
        }
    }
    public void chkstatus(int FlagStatus)
    {
        if (FlagStatus == 0 || FlagStatus == 8)
        {
            btnNew.Enabled = false;
            btnQuery.Enabled = false;
            btnDelete.Enabled = false;
            btnSave.Enabled = false;
            btnExecute.Enabled = false;
            btnCancel.Enabled = false;
            btnModify.Enabled = false;

            btnfirst.Enabled = false;
            btnnext.Enabled = false;
            btnprevious.Enabled = false;
            btnlast.Enabled = false;
            btnExit.Enabled = false;



        }
        if (FlagStatus == 1 || FlagStatus == 9)
        {
            btnNew.Enabled = false;
            btnQuery.Enabled = false;
            btnDelete.Enabled = false;
            btnSave.Enabled = false;
            btnExecute.Enabled = false;
            btnCancel.Enabled = true;
            btnModify.Enabled = false;

            btnfirst.Enabled = false;
            btnnext.Enabled = false;
            btnprevious.Enabled = false;
            btnlast.Enabled = false;
            btnExit.Enabled = true;

        }
        if (FlagStatus == 2 || FlagStatus == 10)
        {
            btnExecute.Enabled = true;
            btnQuery.Enabled = false;
            btnDelete.Enabled = false;
            btnNew.Enabled = false;
            btnCancel.Enabled = true;
            btnExecute.Enabled = false;
            btnModify.Enabled = false;
            btnExit.Enabled = true;

            btnSave.Enabled = false;
            btnfirst.Enabled = false;
            btnnext.Enabled = false;
            btnprevious.Enabled = false;
            btnlast.Enabled = false;
            btnExit.Enabled = true;


        }

        if (FlagStatus == 3 || FlagStatus == 11)
        {
            btnNew.Enabled = false;
            btnQuery.Enabled = false;
            btnExecute.Enabled = false;
            btnDelete.Enabled = false;
            btnCancel.Enabled = true;
            btnExit.Enabled = true;


            btnModify.Enabled = false;

            btnSave.Enabled = true;
            btnfirst.Enabled = false;
            btnnext.Enabled = false;
            btnprevious.Enabled = false;
            btnlast.Enabled = false;
        }

        if (FlagStatus == 4 || FlagStatus == 12)
        {
            btnNew.Enabled = false;
            btnExecute.Enabled = false;
            btnDelete.Enabled = false;
            btnCancel.Enabled = true;
            btnExit.Enabled = true;


            btnModify.Enabled = false;

            btnSave.Enabled = false;
            btnfirst.Enabled = false;
            btnnext.Enabled = false;
            btnprevious.Enabled = false;
            btnlast.Enabled = false;
        }
        if (FlagStatus == 5 || FlagStatus == 13)
        {
            btnNew.Enabled = false;
            btnExecute.Enabled = false;
            btnDelete.Enabled = false;
            btnCancel.Enabled = true;
            btnExit.Enabled = true;


            btnModify.Enabled = false;

            btnSave.Enabled = false;
            btnfirst.Enabled = false;
            btnnext.Enabled = false;
            btnprevious.Enabled = false;
            btnlast.Enabled = false;
        }
        if (FlagStatus == 6 || FlagStatus == 14)
        {
            btnNew.Enabled = false;
            btnExecute.Enabled = false;
            btnDelete.Enabled = false;
            btnCancel.Enabled = true;
            btnExit.Enabled = true;


            btnModify.Enabled = false;

            btnSave.Enabled = false;
            btnfirst.Enabled = false;
            btnnext.Enabled = false;
            btnprevious.Enabled = false;
            btnlast.Enabled = false;
        }
        if (FlagStatus == 7 || FlagStatus == 15)
        {
            btnNew.Enabled = false;
            btnExecute.Enabled = false;
            btnDelete.Enabled = false;
            btnCancel.Enabled = true;
            btnExit.Enabled = true;


            btnModify.Enabled = false;

            btnSave.Enabled = true;
            btnfirst.Enabled = false;
            btnnext.Enabled = false;
            btnprevious.Enabled = false;
            btnlast.Enabled = false;
        }


    }

    public void updateStatus()
    {
        chkstatus(FlagStatus);
        if (FlagStatus == 2 || FlagStatus == 3)
        {
            btnQuery.Enabled = true;
            btnExecute.Enabled = false;
            btnSave.Enabled = false;
            btnModify.Enabled = true;
            btnfirst.Enabled = true;
            btnnext.Enabled = true;
            btnprevious.Enabled = true;
            btnlast.Enabled = true;
            btnDelete.Enabled = false;
        }
        if (FlagStatus == 4)
        {
            btnDelete.Enabled = true;
            btnExecute.Enabled = false;
            btnSave.Enabled = false;
            btnQuery.Enabled = true;
            btnModify.Enabled = false;
            btnfirst.Enabled = true;
            btnnext.Enabled = true;
            btnprevious.Enabled = true;
            btnlast.Enabled = true;

        }
        if (FlagStatus == 5)
        {
            btnDelete.Enabled = true;
            btnExecute.Enabled = false;
            btnSave.Enabled = false;
            btnQuery.Enabled = true;
            btnModify.Enabled = false;
            btnfirst.Enabled = true;
            btnnext.Enabled = true;
            btnprevious.Enabled = true;
            btnlast.Enabled = true;

        }
        if (FlagStatus == 6 || FlagStatus == 7)
        {
            btnDelete.Enabled = true;
            btnExecute.Enabled = false;
            btnSave.Enabled = false;
            btnQuery.Enabled = true;
            btnModify.Enabled = true;
            btnfirst.Enabled = true;
            btnnext.Enabled = true;
            btnprevious.Enabled = true;
            btnlast.Enabled = true;

        }
    }
    public void btnimage()
    {
        DataSet ds = new DataSet();
        ds.ReadXml(Server.MapPath("XML/button.xml"));
        if (btnNew.Enabled == false)
            btnNew.ImageUrl = ds.Tables[1].Rows[0].ItemArray[0].ToString();
        else
            btnNew.ImageUrl = ds.Tables[0].Rows[0].ItemArray[0].ToString();
        if (btnSave.Enabled == false)
            btnSave.ImageUrl = ds.Tables[1].Rows[0].ItemArray[1].ToString();
        else
            btnSave.ImageUrl = ds.Tables[0].Rows[0].ItemArray[1].ToString();
        if (btnModify.Enabled == false)
            btnModify.ImageUrl = ds.Tables[1].Rows[0].ItemArray[2].ToString();
        else
            btnModify.ImageUrl = ds.Tables[0].Rows[0].ItemArray[2].ToString();
        if (btnQuery.Enabled == false)
            btnQuery.ImageUrl = ds.Tables[1].Rows[0].ItemArray[3].ToString();
        else
            btnQuery.ImageUrl = ds.Tables[0].Rows[0].ItemArray[3].ToString();
        if (btnExecute.Enabled == false)
            btnExecute.ImageUrl = ds.Tables[1].Rows[0].ItemArray[4].ToString();
        else
            btnExecute.ImageUrl = ds.Tables[0].Rows[0].ItemArray[4].ToString();
        if (btnCancel.Enabled == false)
            btnCancel.ImageUrl = ds.Tables[1].Rows[0].ItemArray[5].ToString();
        else
            btnCancel.ImageUrl = ds.Tables[0].Rows[0].ItemArray[5].ToString();
        if (btnfirst.Enabled == false)
            btnfirst.ImageUrl = ds.Tables[1].Rows[0].ItemArray[6].ToString();
        else
            btnfirst.ImageUrl = ds.Tables[0].Rows[0].ItemArray[6].ToString();
        if (btnprevious.Enabled == false)
            btnprevious.ImageUrl = ds.Tables[1].Rows[0].ItemArray[7].ToString();
        else
            btnprevious.ImageUrl = ds.Tables[0].Rows[0].ItemArray[7].ToString();
        if (btnnext.Enabled == false)
            btnnext.ImageUrl = ds.Tables[1].Rows[0].ItemArray[8].ToString();
        else
            btnnext.ImageUrl = ds.Tables[0].Rows[0].ItemArray[8].ToString();
        if (btnlast.Enabled == false)
            btnlast.ImageUrl = ds.Tables[1].Rows[0].ItemArray[9].ToString();
        else
            btnlast.ImageUrl = ds.Tables[0].Rows[0].ItemArray[9].ToString();
        if (btnDelete.Enabled == false)
            btnDelete.ImageUrl = ds.Tables[1].Rows[0].ItemArray[10].ToString();
        else
            btnDelete.ImageUrl = ds.Tables[0].Rows[0].ItemArray[10].ToString();
        if (btnExit.Enabled == false)
            btnExit.ImageUrl = ds.Tables[1].Rows[0].ItemArray[11].ToString();
        else
            btnExit.ImageUrl = ds.Tables[0].Rows[0].ItemArray[11].ToString();
    }

    
}
