using System;
using System.Data;
using System.Configuration;
using System.Collections;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;

public partial class deletion : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {

        Response.Expires = -1;
       
       if (Session["compcode"] == null)
        {
            //Response.Redirect("login.aspx");
            Response.Write("<script>window.parent.location=\"login.aspx\";</script>");
            return;
        }
        else
        {
            hiddencompcode.Value = Session["compcode"].ToString();
            hiddenuserid.Value = Session["userid"].ToString();
            //hiddenauto.Value = Session["autogenerated"].ToString();
        }

        Session["dateformat"] = "mm/dd/yyyy";
        Ajax.Utility.RegisterTypeForAjax(typeof(deletion));
        hiddendateformat.Value = Session["dateformat"].ToString();
        DataSet ds = new DataSet();
        ds.ReadXml(Server.MapPath("xml/delition.xml"));

        lblfromdate.Text = ds.Tables[0].Rows[0].ItemArray[0].ToString();
        lbltodate.Text = ds.Tables[0].Rows[0].ItemArray[1].ToString();
        drpname.Text = ds.Tables[0].Rows[0].ItemArray[2].ToString();
        Btndelete.Text = ds.Tables[0].Rows[0].ItemArray[3].ToString();
        lblmsg.Text = ds.Tables[0].Rows[0].ItemArray[4].ToString();
        status();
        if (!Page.IsPostBack)
        {
            Btndelete.Attributes.Add("onclick", "javascript:return deletedata();");
            txtFromDate.Attributes.Add("Onblur", "javascript:return Checkdate(this);");
            txtToDate.Attributes.Add("Onblur", "javascript:return Checkdate(this);");
           
        }
        
    }

    public void status()
    {
               
            DataSet ds = new DataSet();
            ds.ReadXml(Server.MapPath("XML/delition.xml"));
            drpdelition .Items.Clear();
            int i;
            ListItem li1;
            li1 = new ListItem();
            li1.Text = "---Select Status---";
            li1.Value = "0";
            li1.Selected = true;
            drpdelition.Items.Add(li1);

            for (i = 0; i < ds.Tables[1].Columns.Count; i++)
            {
                ListItem li;
                li = new ListItem();
                li.Text = ds.Tables[1].Rows[0].ItemArray[i].ToString();

                li.Value = ds.Tables[1].Rows[0].ItemArray[i].ToString();
                drpdelition.Items.Add(li);

            }
       
       
        
    }
    [Ajax.AjaxMethod]
    public void statusdelete(string txtformdate,string txttodate ,string status)
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {
           // NewAdbooking.Classes.deletion del = new NewAdbooking.Classes.deletion();
            //ds = del.statusdelete(txtformdate, txttodate, status);
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.reportconfirm per = new NewAdbooking.classesoracle.reportconfirm();
            ds = per.deletestatus(txtformdate, txttodate, status);

        }
        else
        {
            
                NewAdbooking.classmysql.delition obj = new NewAdbooking.classmysql.delition();
                ds = obj.statusdelete(txtformdate, txttodate, status);
            //return ds;
        }
           
           

        }

    [Ajax.AjaxMethod]
    public DataSet chkdate(string fromdate, string todate)
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {
           // NewAdbooking.Classes.deletion chk = new NewAdbooking.Classes.deletion();
            //ds = chk.chkdate1(fromdate, todate);
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.reportconfirm per = new NewAdbooking.classesoracle.reportconfirm();
            ds = per.chkdate(fromdate, todate);
            return ds;
        }
        else
        {
            NewAdbooking.classmysql.delition chk = new NewAdbooking.classmysql.delition();
            ds = chk.chkdate1(fromdate, todate);
           
        }
        return ds;
    }

    [Ajax.AjaxMethod]
    public DataSet givepermision(string userid, string compcode, string formname)
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {
          //  NewAdbooking.Classes.Master per = new NewAdbooking.Classes.Master();
           // ds = per.givepermission(userid, compcode, formname);
           // return ds;
        }
        else
        {
            NewAdbooking.classmysql.Master per = new NewAdbooking.classmysql.Master();
            ds = per.givepermission(userid, compcode, formname);
            
        }
        return ds;
    }



    protected void Btndelete_Click(object sender, EventArgs e)
    {

    }
}
