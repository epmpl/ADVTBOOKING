using System;
using System.Data;
using System.Configuration;
using System.Collections;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;

public partial class All_module_master : System.Web.UI.Page
{
   protected void Page_Load(object sender, System.EventArgs e)
    {

        Response.Expires = -1;
        if (Session["compcode"] == null)
        //if  ;
        {


            //Response.Redirect("login.aspx");
            Response.Write("<script>window.parent.location=\"login.aspx\";</script>");
            return;
        }

        hiddencomcode.Value = Session["compcode"].ToString();
        hiddencompcode.Value = Session["compcode"].ToString();
        hiddenuserid.Value = Session["userid"].ToString();
        hiddenDateFormat.Value = Session["dateformat"].ToString();

        hiddenauto.Value = Session["autogenerated"].ToString();

        /*========*/
        //hiddendesigncode.Value = drpdesignation.SelectedValue.ToString();

        hiddenusername.Value = Session["Username"].ToString();
        
      /*  NewAdbooking.Classes.Master checkform = new NewAdbooking.Classes.Master();
        DataSet dz = new DataSet();
        dz = checkform.formpermission(hiddencomcode.Value, hiddenuserid.Value, "All_module_master");

        if (dz.Tables[0].Rows[0].ItemArray[0].ToString() == "0" || dz.Tables[0].Rows[0].ItemArray[0].ToString() == "8")
        {
            Response.Write("<script>alert('You Are Not Authorised To See This Form');</script>");
            Server.Transfer("EnterPage.aspx");
        }
        else
        {*/
        /*    string id = dz.Tables[0].Rows[0].ItemArray[0].ToString();
            if (id == "1" || id == "9")
            {

                btnNew.Enabled = true;
                btnQuery.Enabled = false;
                btnDelete.Enabled = false;
                btnSave.Enabled = false;
                btnExecute.Enabled = false;
                btnCancel.Enabled = true;
                btnModify.Enabled = false;

                btnfirst.Enabled = false;
                btnnext.Enabled = false;
                btnprevious.Enabled = false;
                btnlast.Enabled = false;
                btnExit.Enabled = true;


            }
            if (id == "2" || id == "10")
            {

                btnNew.Enabled = false;
                btnQuery.Enabled = true;
                btnDelete.Enabled = false;
                btnSave.Enabled = false;
                btnExecute.Enabled = false;
                btnCancel.Enabled = true;
                btnModify.Enabled = false;

                btnfirst.Enabled = false;
                btnnext.Enabled = false;
                btnprevious.Enabled = false;
                btnlast.Enabled = false;
                btnExit.Enabled = true;


            }
            if (id == "3" || id == "11")
            {

                btnNew.Enabled = true;
                btnQuery.Enabled = true;
                btnDelete.Enabled = false;
                btnSave.Enabled = false;
                btnExecute.Enabled = false;
                btnCancel.Enabled = true;
                btnModify.Enabled = false;

                btnfirst.Enabled = false;
                btnnext.Enabled = false;
                btnprevious.Enabled = false;
                btnlast.Enabled = false;
                btnExit.Enabled = true;

            }
            if (id == "4" || id == "12")
            {

                btnNew.Enabled = false;
                btnQuery.Enabled = true;
                btnDelete.Enabled = false;
                btnSave.Enabled = false;
                btnExecute.Enabled = false;
                btnCancel.Enabled = true;
                btnModify.Enabled = false;

                btnfirst.Enabled = false;
                btnnext.Enabled = false;
                btnprevious.Enabled = false;
                btnlast.Enabled = false;
                btnExit.Enabled = true;


            }
            if (id == "5" || id == "13")
            {
                btnNew.Enabled = true;
                btnQuery.Enabled = true;
                btnDelete.Enabled = false;
                btnSave.Enabled = false;
                btnExecute.Enabled = false;
                btnCancel.Enabled = true;
                btnModify.Enabled = false;

                btnfirst.Enabled = false;
                btnnext.Enabled = false;
                btnprevious.Enabled = false;
                btnlast.Enabled = false;
                btnExit.Enabled = true;

            }
            if (id == "6" || id == "14")
            {
                btnNew.Enabled = false;
                btnQuery.Enabled = true;
                btnDelete.Enabled = false;
                btnSave.Enabled = false;
                btnExecute.Enabled = false;
                btnCancel.Enabled = true;
                btnModify.Enabled = false;

                btnfirst.Enabled = false;
                btnnext.Enabled = false;
                btnprevious.Enabled = false;
                btnlast.Enabled = false;
                btnExit.Enabled = true;

            }
            if (id == "7" || id == "15")
            {
                btnNew.Enabled = true;
                btnQuery.Enabled = true;
                btnDelete.Enabled = false;
                btnSave.Enabled = false;
                btnExecute.Enabled = false;
                btnCancel.Enabled = true;
                btnModify.Enabled = false;

                btnfirst.Enabled = false;
                btnnext.Enabled = false;
                btnprevious.Enabled = false;
                btnlast.Enabled = false;
                btnExit.Enabled = true;

            }

    //    }*/





        Ajax.Utility.RegisterTypeForAjax(typeof(All_module_master));



        //////////////////////
        DataSet ds = new DataSet();
        // Read in the XML file
        ds.ReadXml(Server.MapPath("XML/button.xml"));
        btnNew.ImageUrl = ds.Tables[0].Rows[0].ItemArray[0].ToString();
        btnSave.ImageUrl = ds.Tables[0].Rows[0].ItemArray[1].ToString();
        btnModify.ImageUrl = ds.Tables[0].Rows[0].ItemArray[2].ToString();
        btnQuery.ImageUrl = ds.Tables[0].Rows[0].ItemArray[3].ToString();
        btnExecute.ImageUrl = ds.Tables[0].Rows[0].ItemArray[4].ToString();
        btnCancel.ImageUrl = ds.Tables[0].Rows[0].ItemArray[5].ToString();
        btnfirst.ImageUrl = ds.Tables[0].Rows[0].ItemArray[6].ToString();
        btnprevious.ImageUrl = ds.Tables[0].Rows[0].ItemArray[7].ToString();
        btnnext.ImageUrl = ds.Tables[0].Rows[0].ItemArray[8].ToString();
        btnlast.ImageUrl = ds.Tables[0].Rows[0].ItemArray[9].ToString();
        btnDelete.ImageUrl = ds.Tables[0].Rows[0].ItemArray[10].ToString();
        btnExit.ImageUrl = ds.Tables[0].Rows[0].ItemArray[11].ToString();



        DataSet ds1 = new DataSet();
        // Read in the XML file
        ds1.ReadXml(Server.MapPath("XML/All_Module_master.xml"));

        code.Text = ds1.Tables[0].Rows[0].ItemArray[0].ToString();
        designation.Text = ds1.Tables[0].Rows[0].ItemArray[1].ToString();
        status.Text = ds1.Tables[0].Rows[0].ItemArray[2].ToString();
        Name.Text = ds1.Tables[0].Rows[0].ItemArray[3].ToString();
        level.Text = ds1.Tables[0].Rows[0].ItemArray[4].ToString();
        mail_id.Text = ds1.Tables[0].Rows[0].ItemArray[5].ToString();

        discountallow.Text = ds1.Tables[0].Rows[0].ItemArray[6].ToString();





        bindstatus();
        designationbind();
        pagedef();

       // category();

        if (!Page.IsPostBack)
        {
            btnNew.Attributes.Add("OnClick", "javascript:return newall();");
            btnSave.Attributes.Add("OnClick", "javascript:return saveall();");
            btnModify.Attributes.Add("OnClick", "javascript:return modify();");
            btnQuery.Attributes.Add("OnClick", "javascript:return query();");
            btnExecute.Attributes.Add("OnClick", "javascript:return execute();");
            btnCancel.Attributes.Add("OnClick", "javascript:return cancel('All_module_master');");

            //drpadvcatcode.Attributes.Add("onBlur","javascript:return codecat();");

            btnDelete.Attributes.Add("OnClick", "javascript:return deleteall();");
            btnfirst.Attributes.Add("OnClick", "javascript:return first();");
            btnprevious.Attributes.Add("OnClick", "javascript:return previous();");
            btnnext.Attributes.Add("OnClick", "javascript:return next();");
            btnlast.Attributes.Add("OnClick", "javascript:return last();");
            btnExit.Attributes.Add("OnClick", "javascript:return exitall();");

            txtcode.Attributes.Add("OnBlur", "javascript:return UpperCase('txtcode')");
            txtdiscount.Attributes.Add("onchange", "javascript:return Discount();");
           // txtalias.Attributes.Add("OnBlur", "javascript:return UpperCase('txtalias')");
            txtname.Attributes.Add("OnBlur", "javascript:return UpperCase('txtname')");
           txtmailid.Attributes.Add("OnBlur", "javascript:return checkEmail();");
            //txteditionname.Attributes.Add("OnBlur","javascript:return UpperCase('txteditionname')");
              txtname.Attributes.Add("OnBlur", "javascript:return autoornot();");
         

        }

        if (btnNew.Enabled == false)
            btnNew.ImageUrl = ds.Tables[1].Rows[0].ItemArray[0].ToString();
        if (btnSave.Enabled == false)
            btnSave.ImageUrl = ds.Tables[1].Rows[0].ItemArray[1].ToString();
        if (btnModify.Enabled == false)
            btnModify.ImageUrl = ds.Tables[1].Rows[0].ItemArray[2].ToString();
        if (btnQuery.Enabled == false)
            btnQuery.ImageUrl = ds.Tables[1].Rows[0].ItemArray[3].ToString();
        if (btnExecute.Enabled == false)
            btnExecute.ImageUrl = ds.Tables[1].Rows[0].ItemArray[4].ToString();
        if (btnCancel.Enabled == false)
            btnCancel.ImageUrl = ds.Tables[1].Rows[0].ItemArray[5].ToString();
        if (btnfirst.Enabled == false)
            btnfirst.ImageUrl = ds.Tables[1].Rows[0].ItemArray[6].ToString();
        if (btnprevious.Enabled == false)
            btnprevious.ImageUrl = ds.Tables[1].Rows[0].ItemArray[7].ToString();
        if (btnnext.Enabled == false)
            btnnext.ImageUrl = ds.Tables[1].Rows[0].ItemArray[8].ToString();
        if (btnlast.Enabled == false)
            btnlast.ImageUrl = ds.Tables[1].Rows[0].ItemArray[9].ToString();
        if (btnDelete.Enabled == false)
            btnDelete.ImageUrl = ds.Tables[1].Rows[0].ItemArray[10].ToString();
        if (btnExit.Enabled == false)
            btnExit.ImageUrl = ds.Tables[1].Rows[0].ItemArray[11].ToString();

        // Put user code to initialize the page here
    }

    #region Web Form Designer generated code
    override protected void OnInit(EventArgs e)
    {
        //
        // CODEGEN: This call is required by the ASP.NET Web Form Designer.
        //
        InitializeComponent();
        base.OnInit(e);
    }

    /// <summary>
    /// Required method for Designer support - do not modify
    /// the contents of this method with the code editor.
    /// </summary>
    private void InitializeComponent()
    {

    }
    #endregion


    public void pagedef()
    {
        btnNew.Enabled = true;
        btnSave.Enabled = false;
        btnModify.Enabled = false;
        btnDelete.Enabled = false;
        btnQuery.Enabled = true;
        btnExecute.Enabled = false;
        btnCancel.Enabled = true;
        btnfirst.Enabled = false;
        btnprevious.Enabled = false;
        btnnext.Enabled = false;
        btnlast.Enabled = false;
        btnExit.Enabled = true;
        txtdiscount.Enabled = false;
        txtcode.Enabled = false;
        txtname.Enabled = false;
        txtlevel.Enabled = false;
        txtmailid.Enabled = false;
        drpdesignation.Enabled = false;
        ScriptManager1.SetFocus(btnNew);
    }
   
    public void designationbind()
    {
        DataSet ds = new DataSet();
        if(ConfigurationSettings.AppSettings ["ConnectionType"].ToString ()=="sql")
        {

        NewAdbooking.Classes.All_Module_master des = new NewAdbooking.Classes.All_Module_master();
       
        ds = des.adddesignation();
        }

        else
            if(ConfigurationSettings.AppSettings ["ConnectionType"].ToString ()=="orcl")
            {
                NewAdbooking.classesoracle.All_Module_master des = new NewAdbooking.classesoracle.All_Module_master();

                ds = des.adddesignation();
            }
        else
        {
            //NewAdbooking.Classes.All_Module_master des = new NewAdbooking.Classes.All_Module_master();
            //ds = des.adddesignation();

            string procedureName = "bind_designation_bind_designation_p";
            string[] parameterValueArray = {};
            NewAdbooking.classmysql.CommonClass obj = new NewAdbooking.classmysql.CommonClass();
            ds = obj.DynamicBindProcedure(procedureName, parameterValueArray);
            //return ds;

        }

        ListItem li1;
        li1 = new ListItem();
        li1.Text = "-Select Designation-";
        li1.Value = "0";
        li1.Selected = true;
        drpdesignation.Items.Add(li1);

        int i;
        for (i = 0; i < ds.Tables[0].Rows.Count; i++)
        {
            //drpregion.SelectedValue=ds.Tables[0].Rows[i].ItemArray[1].ToString();
            //drpregion.SelectedItem.Text=ds.Tables[0].Rows[i].ItemArray[1].ToString();
            ListItem li;
            li = new ListItem();
            li.Text = ds.Tables[0].Rows[i].ItemArray[1].ToString();
            li.Value = ds.Tables[0].Rows[i].ItemArray[0].ToString();
            drpdesignation.Items.Add(li);


        }



    }

    /*[Ajax.AjaxMethod]
    public DataSet catcod(string catname)
    {
        NewAdbooking.Classes.All_Module_master code=new NewAdbooking.Classes.All_Module_master();
        DataSet ds=new DataSet();
        ds= code.getcode(catname);
        return ds;
		
    }*/


//save
    [Ajax.AjaxMethod]

    public void all_modsave(string compcode, string catcode, string code, string name, string level, string mailid, string desc, string userid, string status)
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {

            NewAdbooking.Classes.All_Module_master save = new NewAdbooking.Classes.All_Module_master();

            ds = save.all_modsave1(compcode, catcode, code, name, level, mailid, desc, userid, status);
        }
        else
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
            {
                NewAdbooking.classesoracle.All_Module_master save = new NewAdbooking.classesoracle.All_Module_master();

                ds = save.all_modsave1(compcode, catcode, code, name, level, mailid, desc, userid, status);

            }
        else
        {
            NewAdbooking.classmysql.All_Module_master save = new NewAdbooking.classmysql.All_Module_master();

            ds = save.all_modsave1(compcode, catcode, code, name, level, mailid, desc, userid, status);

        }



    }


    [Ajax.AjaxMethod]

    public DataSet allmodexecute(string compcode, string catcode, string code, string name, string level, string mailid, string desc, string userid)
    {

        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {

           
            NewAdbooking.Classes.All_Module_master exe = new NewAdbooking.Classes.All_Module_master();

            ds = exe.allmodexecute1(compcode, catcode, code, name, level, mailid, desc, userid);
            return ds;
        }
        else
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
            {
                NewAdbooking.classesoracle.All_Module_master exe = new NewAdbooking.classesoracle.All_Module_master();

                ds = exe.allmodexecute1(compcode, catcode, code, name, level, mailid, desc, userid);
                return ds;
            }
        else
        {
            NewAdbooking.classmysql.All_Module_master exe = new NewAdbooking.classmysql.All_Module_master();

            ds = exe.allmodexecute1(compcode, catcode, code, name, level, mailid, desc, userid);
            return ds;

        }

    }





    [Ajax.AjaxMethod]

    public void allmodupdate(string compcode, string catcode, string code, string name, string level, string mailid, string desc, string userid, string status)
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {

            NewAdbooking.Classes.All_Module_master update = new NewAdbooking.Classes.All_Module_master();
            
            ds = update.allmodupdate1(compcode, catcode, code, name, level, mailid, desc, userid, status);
        }
        else
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
            {
                NewAdbooking.classesoracle.All_Module_master update = new NewAdbooking.classesoracle.All_Module_master();

                ds = update.allmodupdate1(compcode, catcode, code, name, level, mailid, desc, userid, status);

            }
        else
        {
            NewAdbooking.classmysql.All_Module_master update = new NewAdbooking.classmysql.All_Module_master();

            ds = update.allmodupdate1(compcode, catcode, code, name, level, mailid, desc, userid, status);

        }



    }


  /*  [Ajax.AjaxMethod]

    public DataSet allmodfirst(string compcode,string code, string userid)
    {
        NewAdbooking.Classes.All_Module_master first = new NewAdbooking.Classes.All_Module_master();
        DataSet ds = new DataSet();
        ds = first.allmodfirst1(compcode, code, userid);
        return ds;


    }*/
    //code check....
    [Ajax.AjaxMethod]
    public DataSet codechk(string compcode, string code, string userid)
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {

            NewAdbooking.Classes.All_Module_master first = new NewAdbooking.Classes.All_Module_master();
          
            ds = first.codechk1(compcode, code, userid);
            return ds;
        }
        else
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
            {
                NewAdbooking.classesoracle.All_Module_master first = new NewAdbooking.classesoracle.All_Module_master();

                ds = first.codechk1(compcode, code, userid);
                return ds;
            }
        else
        {
            NewAdbooking.classmysql.All_Module_master first = new NewAdbooking.classmysql.All_Module_master();

            ds = first.codechk1(compcode, code, userid);
            return ds;

        }


    }



 /*   [Ajax.AjaxMethod]

    public DataSet allmodpre(string compcode, string code, string userid)
    {
        NewAdbooking.Classes.All_Module_master pre = new NewAdbooking.Classes.All_Module_master();
        DataSet ds = new DataSet();
        ds = pre.allmodpre1(compcode, catcode, userid);
        return ds;


    }*/



   /* [Ajax.AjaxMethod]

    public DataSet subcatnext(string compcode, string catcode, string userid)
    {
        NewAdbooking.Classes.All_Module_master next = new NewAdbooking.Classes.All_Module_master();
        DataSet ds = new DataSet();
        ds = next.nextsubcat(compcode, catcode, userid);
        return ds;


    }*/



   /* [Ajax.AjaxMethod]

    public DataSet subcatlast(string compcode, string catcode, string userid)
    {
        NewAdbooking.Classes.All_Module_master last = new NewAdbooking.Classes.All_Module_master();
        DataSet ds = new DataSet();
        ds = last.lastsubcat(compcode, catcode, userid);
        return ds;


    }*/


    [Ajax.AjaxMethod]

    public void allmoddel(string compcode, string code, string userid)
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {

            NewAdbooking.Classes.All_Module_master delete = new NewAdbooking.Classes.All_Module_master();
            
            ds = delete.allmoddel1(compcode, code, userid);
        }
        else
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
            {
                NewAdbooking.classesoracle.All_Module_master delete = new NewAdbooking.classesoracle.All_Module_master();

                ds = delete.allmoddel1(compcode, code, userid);
            }

        else
        {
            NewAdbooking.classmysql.All_Module_master delete = new NewAdbooking.classmysql.All_Module_master();

            ds = delete.allmoddel1(compcode, code, userid);

        }
        //return ds;


    }



     [Ajax.AjaxMethod]
    public DataSet chksallmodcode(string str)
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {

            NewAdbooking.Classes.All_Module_master chk = new NewAdbooking.Classes.All_Module_master();
            
            ds = chk.chksallmodcode1(str);
            return ds;
        }
        else
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
            {
                NewAdbooking.classesoracle.All_Module_master chk = new NewAdbooking.classesoracle.All_Module_master();

                ds = chk.chksallmodcode1(str);
                return ds;
            }
        else
        {
            NewAdbooking.classmysql.All_Module_master chk = new NewAdbooking.classmysql.All_Module_master();

            ds = chk.chksallmodcode1(str);
            return ds;

        }

    }



     public void bindstatus()
     {
         DataSet ds = new DataSet();
         if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
         {

             NewAdbooking.Classes.ClientMasterpopup name = new NewAdbooking.Classes.ClientMasterpopup();
             ds = name.addstatusname(Session["compcode"].ToString());
         }

         else
             if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
             {
                 NewAdbooking.classesoracle.ClientMasterpopup name = new NewAdbooking.classesoracle.ClientMasterpopup();
                 ds = name.addstatusname(Session["compcode"].ToString());
             }
             else
             {
                 NewAdbooking.classmysql.ClientMasterpopup name = new NewAdbooking.classmysql.ClientMasterpopup();
                 ds = name.addstatusname(Session["compcode"].ToString());

             }

         ListItem li1;
         li1 = new ListItem();
         li1.Text = "-Select Status-";
         li1.Value = "0";
         li1.Selected = true;
         drpstatus.Items.Add(li1);

         int i;
         for (i = 0; i < ds.Tables[0].Rows.Count; i++)
         {
             //drpregion.SelectedValue=ds.Tables[0].Rows[i].ItemArray[1].ToString();
             //drpregion.SelectedItem.Text=ds.Tables[0].Rows[i].ItemArray[1].ToString();
             ListItem li;
             li = new ListItem();
             li.Text = ds.Tables[0].Rows[i].ItemArray[0].ToString();
             li.Value = ds.Tables[0].Rows[i].ItemArray[1].ToString();
             drpstatus.Items.Add(li);


         }



     }



    protected void hiddencompcode_ServerChange(object sender, System.EventArgs e)
    {

    }

    protected void hiddenusername_ServerChange(object sender, System.EventArgs e)
    {

    }
}