using System;
using System.Data;
using System.Configuration;
using System.Collections;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;

public partial class AdvExecMaster : System.Web.UI.Page
{
    static int z = 0;
    string message;

    protected void Page_Load(object sender, System.EventArgs e)
    {



        Response.Expires = -1;
        Response.Buffer = true;
        Response.ExpiresAbsolute = DateTime.Now.AddDays(-1d);
        Response.Expires = -1500;
        Response.CacheControl = "no-cache";

        if (Session["compcode"] != null)
        {
            hiddencompcode.Value = Session["compcode"].ToString();
            hiddenuserid.Value = Session["userid"].ToString();
            hiddenauto.Value = Session["autogenerated"].ToString();
        }
        else
        {
            Response.Write("<script>window.parent.location=\"login.aspx\";</script>");
            return;
        }
        DataSet objDataSet = new DataSet();



        DataSet objDataSetbu = new DataSet();
        objDataSetbu.ReadXml(Server.MapPath("XML/button.xml"));
        btnNew.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[0].ToString();
        btnSave.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[1].ToString();
        btnModify.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[2].ToString();
        btnQuery.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[3].ToString();
        btnExecute.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[4].ToString();
        btnCancel.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[5].ToString();
        btnfirst.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[6].ToString();
        btnprevious.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[7].ToString();
        btnnext.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[8].ToString();
        btnlast.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[9].ToString();
        btnDelete.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[10].ToString();
        btnExit.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[11].ToString();
      
        objDataSet.ReadXml(Server.MapPath("XML/executivemaster.xml"));
        teamcode.Text = objDataSet.Tables[0].Rows[0].ItemArray[0].ToString();
        teamname.Text = objDataSet.Tables[0].Rows[0].ItemArray[1].ToString();
        Alias.Text = objDataSet.Tables[0].Rows[0].ItemArray[2].ToString();
        adcategory.Text = objDataSet.Tables[0].Rows[0].ItemArray[3].ToString();
        zone.Text = objDataSet.Tables[0].Rows[0].ItemArray[3].ToString();
        LinkButton1.Text = objDataSet.Tables[0].Rows[0].ItemArray[23].ToString();
        lblattachment.Text = objDataSet.Tables[0].Rows[0].ItemArray[26].ToString();


        
        btnNew.Enabled = true;
        btnSave.Enabled = false;
        btnModify.Enabled = false;
        btnDelete.Enabled = false;
        btnQuery.Enabled = true;
        btnExecute.Enabled = false;
        btnCancel.Enabled = true;
        btnfirst.Enabled = false;
        btnprevious.Enabled = false;
        btnnext.Enabled = false;
        btnlast.Enabled = false;
        btnExit.Enabled = true;
        txtsign.Enabled = false;
       // LinkButton1.Enabled = false;
        if (btnNew.Enabled == false)
            btnNew.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[0].ToString();
        if (btnSave.Enabled == false)
            btnSave.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[1].ToString();
        if (btnModify.Enabled == false)
            btnModify.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[2].ToString();
        if (btnQuery.Enabled == false)
            btnQuery.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[3].ToString();
        if (btnExecute.Enabled == false)
            btnExecute.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[4].ToString();
        if (btnCancel.Enabled == false)
            btnCancel.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[5].ToString();
        if (btnfirst.Enabled == false)
            btnfirst.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[6].ToString();
        if (btnprevious.Enabled == false)
            btnprevious.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[7].ToString();
        if (btnnext.Enabled == false)
            btnnext.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[8].ToString();
        if (btnlast.Enabled == false)
            btnlast.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[9].ToString();
        if (btnDelete.Enabled == false)
            btnDelete.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[10].ToString();
        if (btnExit.Enabled == false)
            btnExit.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[11].ToString();
        btnNew.Focus();
        hiddenusername.Value = Session["username"].ToString();
        Ajax.Utility.RegisterTypeForAjax(typeof(AdvExecMaster));
        txtteamcode.Enabled = false;
        txteamname.Enabled = false;
        drpzone.Enabled = false;
        lbexecutive.Enabled = false;
        attachment1.Enabled = false;
       
        if (!Page.IsPostBack)        
        {
            addregion();
           
            lbexecutive.Attributes.Add("OnClick", "javascript:return executivecontactdetails();");
            btnNew.Attributes.Add("OnClick", "javascript:return AdvExecNew('AdvExecMaster');");
            btnSave.Attributes.Add("OnClick", "javascript:return AdvExecSave();");
            btnCancel.Attributes.Add("OnClick", "javascript:return AdvExecCancel('AdvExecMaster');");
            btnModify.Attributes.Add("OnClick", "javascript:return AdvExecModify('AdvExecMaster');");
            btnQuery.Attributes.Add("OnClick", "javascript:return AdvExecQuery('AdvExecMaster');");
            btnExecute.Attributes.Add("OnClick", "javascript:return AdvExecExecute('AdvExecMaster');");
            btnDelete.Attributes.Add("OnClick", "javascript:return AdvExecDelete();");
            btnfirst.Attributes.Add("OnClick", "javascript:return AdvExecFirst();");
            btnnext.Attributes.Add("OnClick", "javascript:return AdvExecNext();");
            btnprevious.Attributes.Add("OnClick", "javascript:return AdvExecPrevious();");
            btnlast.Attributes.Add("OnClick", "javascript:return AdvExecLast();");
            btnExit.Attributes.Add("OnClick", "javascript:return AdvExecexit();");
          //  drpzone.Attributes.Add("OnChange", "javascript:return autoornot();");
            txteamname.Attributes.Add("OnChange", "javascript:return autoornot();");
           drpzone.Attributes.Add("onkeypress", "return keySort(this);");
           drpzone.Attributes.Add("OnBlur", "return setF();");
           LinkButton1.Attributes.Add("OnClick", "javascript:return signuploadclick();");

           attachment1.Attributes.Add("OnClick", "javascript:return openattach1();");

        }
    }

    #region Web Form Designer generated code
    override protected void OnInit(EventArgs e)
    {
        //
        // CODEGEN: This call is required by the ASP.NET Web Form Designer.
        //
        InitializeComponent();
        base.OnInit(e);
    }

    /// <summary>
    /// Required method for Designer support - do not modify
    /// the contents of this method with the code editor.
    /// </summary>
    private void InitializeComponent()
    {

    }
    #endregion


    //Ajax Method
    /*
     * Flag List 
     * 0:select data
     * 1:insert Data
     * 2.update Data
     * 3.Delete Data
     * 4.Execute Data
     * */

    public void addregion()
    {
        drpzone.Items.Clear();
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {

            NewAdbooking.Classes.AdvertisementMaster name = new NewAdbooking.Classes.AdvertisementMaster();
            
            ds = name.adzone(Session["userid"].ToString(), Session["compcode"].ToString());
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdvertisementMaster name = new NewAdbooking.classesoracle.AdvertisementMaster();
            ds = name.adzone(Session["userid"].ToString(), Session["compcode"].ToString());
        }
        else
        {
            NewAdbooking.classmysql.AdvertisementMaster name = new NewAdbooking.classmysql.AdvertisementMaster();

            ds = name.adzone(Session["userid"].ToString(), Session["compcode"].ToString());

        }

        ListItem li1;
        li1 = new ListItem();
        li1.Text = "-----Select Branch-----";
        li1.Value = "0";
        li1.Selected = true;
        drpzone.Items.Add(li1);

        int i;
        for (i = 0; i < ds.Tables[0].Rows.Count; i++)
        {
            ListItem li;
            li = new ListItem();
            li.Text = ds.Tables[0].Rows[i].ItemArray[1].ToString();
            li.Value = ds.Tables[0].Rows[i].ItemArray[0].ToString();
            drpzone.Items.Add(li);
        }
    }

    public void bindteam()
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {


            NewAdbooking.Classes.AdvertisementMaster category = new NewAdbooking.Classes.AdvertisementMaster();
            
            ds = category.bindteam1();
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdvertisementMaster category = new NewAdbooking.classesoracle.AdvertisementMaster();
            ds = category.bindteam1();
        }
        else
        {
            NewAdbooking.classmysql.AdvertisementMaster category = new NewAdbooking.classmysql.AdvertisementMaster();

            ds = category.bindteam1();

        }

        ListItem li1;
        li1 = new ListItem();
        li1.Text = "-Select Team Name-";
        li1.Value = "0";
        li1.Selected = true;

        int i;
        for (i = 0; i < ds.Tables[0].Rows.Count; i++)
        {
            ListItem li;
            li = new ListItem();
            li.Text = ds.Tables[0].Rows[i].ItemArray[1].ToString();
            li.Value = ds.Tables[0].Rows[i].ItemArray[0].ToString();

        }



    }



    public void addcategory()
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {


            NewAdbooking.Classes.AdvertisementMaster category = new NewAdbooking.Classes.AdvertisementMaster();
            
            ds = category.addesignation(Session["compcode"].ToString());
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdvertisementMaster category = new NewAdbooking.classesoracle.AdvertisementMaster();
            ds = category.addesignation(Session["compcode"].ToString());
        }
        else
        {
            NewAdbooking.classmysql.AdvertisementMaster category = new NewAdbooking.classmysql.AdvertisementMaster();

            ds = category.addesignation(Session["compcode"].ToString());

        }

        ListItem li1;
        li1 = new ListItem();
        li1.Text = "-Select Designation-";
        li1.Value = "0";
        li1.Selected = true;
        drpadcat.Items.Add(li1);

        int i;
        for (i = 0; i < ds.Tables[0].Rows.Count; i++)
        {
            ListItem li;
            li = new ListItem();
            li.Text = ds.Tables[0].Rows[i].ItemArray[1].ToString();
            li.Value = ds.Tables[0].Rows[i].ItemArray[0].ToString();
            drpadcat.Items.Add(li);


        }



    }


    [Ajax.AjaxMethod]
    public DataSet AdvExec(string Comp_Code, string Team_Code, string Team_Name, string zone, int Flag, string userid, string signature, string attachment)
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {

            NewAdbooking.Classes.AdvertisementMaster AdvExec = new NewAdbooking.Classes.AdvertisementMaster();

            ds = AdvExec.AdvExecDetail(Comp_Code, Team_Code, Team_Name, zone, Flag, userid, signature, attachment);
            return ds;
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdvertisementMaster AdvExec = new NewAdbooking.classesoracle.AdvertisementMaster();
            ds = AdvExec.AdvExecDetail(Comp_Code, Team_Code, Team_Name, zone, Flag, userid, signature,attachment);
            return ds;
        }
        else if (ConfigurationManager.AppSettings["ConnectionType"].ToString() == "mysql")
        {
            string procedureName = "ADVTEAMDETAIL_ADVTEAMDETAIL_P1";
            string[] parameterValueArray = { Comp_Code,Team_Code,Team_Name,userid ,zone,Flag.ToString(),attachment,signature };
            NewAdbooking.classmysql.CommonClass obj = new NewAdbooking.classmysql.CommonClass();
            ds = obj.DynamicBindProcedure(procedureName, parameterValueArray);
            return ds;
        }
        return ds;
        ////else
        ////{//
        ////    NewAdbooking.classmysql.AdvertisementMaster AdvExec = new NewAdbooking.classmysql.AdvertisementMaster();

        ////    ds = AdvExec.AdvExecDetail(Comp_Code, Team_Code, Team_Name, zone, Flag, userid);
        ////    return ds;

        ////}

    }

    [Ajax.AjaxMethod]
    public DataSet AdvFirst(string Comp_Code, string Team_Code, string Team_Name, string zone, int Flag, string userid )
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {

            NewAdbooking.Classes.AdvertisementMaster AdvExec = new NewAdbooking.Classes.AdvertisementMaster();

            ds = AdvExec.AdvExecDetail(Comp_Code, Team_Code, Team_Name, zone, Flag, userid,"","");
            z = 0;
            return ds;
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdvertisementMaster AdvExec = new NewAdbooking.classesoracle.AdvertisementMaster();
            ds = AdvExec.AdvExecDetail(Comp_Code, Team_Code, Team_Name, zone, Flag, userid, "","");
            z = 0;
            return ds;
        }
        else
        {
            NewAdbooking.classmysql.AdvertisementMaster AdvExec = new NewAdbooking.classmysql.AdvertisementMaster();

            ds = AdvExec.AdvExecDetail(Comp_Code, Team_Code, Team_Name, zone, Flag, userid);
            z = 0;
            return ds;
        }
    }

    [Ajax.AjaxMethod]
    public DataSet AdvNext(string Comp_Code, string Team_Code, string Team_Name, string zone, int Flag, string userid  )
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {

            NewAdbooking.Classes.AdvertisementMaster AdvExec = new NewAdbooking.Classes.AdvertisementMaster();
            
            ds = AdvExec.AdvExecDetail(Comp_Code, Team_Code, Team_Name, zone, Flag, userid,"","");
            z = 0;
            return ds;
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdvertisementMaster AdvExec = new NewAdbooking.classesoracle.AdvertisementMaster();
            ds = AdvExec.AdvExecDetail(Comp_Code, Team_Code, Team_Name, zone, Flag, userid,"","");
            z = 0;
            return ds;
        }
        else
        {
            NewAdbooking.classmysql.AdvertisementMaster AdvExec = new NewAdbooking.classmysql.AdvertisementMaster();

            ds = AdvExec.AdvExecDetail(Comp_Code, Team_Code, Team_Name, zone, Flag, userid);
            z = 0;
            return ds;
        }
    }

    [Ajax.AjaxMethod]
    public DataSet AdvPrevious(string Comp_Code, string Team_Code, string Team_Name, string zone, int Flag, string userid )
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {

            NewAdbooking.Classes.AdvertisementMaster AdvExec = new NewAdbooking.Classes.AdvertisementMaster();
            
            ds = AdvExec.AdvExecDetail(Comp_Code, Team_Code, Team_Name, zone, Flag, userid,"", "");
            z = 0;
            return ds;
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdvertisementMaster AdvExec = new NewAdbooking.classesoracle.AdvertisementMaster();
            ds = AdvExec.AdvExecDetail(Comp_Code, Team_Code, Team_Name, zone, Flag, userid,"","");
            z = 0;
            return ds;
        }
        else
        {
            NewAdbooking.classmysql.AdvertisementMaster AdvExec = new NewAdbooking.classmysql.AdvertisementMaster();

            ds = AdvExec.AdvExecDetail(Comp_Code, Team_Code, Team_Name, zone, Flag, userid);
            z = 0;
            return ds;
        }
    }

    [Ajax.AjaxMethod]
    public DataSet AdvLast(string Comp_Code, string Team_Code, string Team_Name, string zone, int Flag, string userid )
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {

            NewAdbooking.Classes.AdvertisementMaster AdvExec = new NewAdbooking.Classes.AdvertisementMaster();
            
            ds = AdvExec.AdvExecDetail(Comp_Code, Team_Code, Team_Name, zone, Flag, userid,"","");
            z = 0;
            return ds;
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdvertisementMaster AdvExec = new NewAdbooking.classesoracle.AdvertisementMaster();
            ds = AdvExec.AdvExecDetail(Comp_Code, Team_Code, Team_Name, zone, Flag, userid,"","");
            z = 0;
            return ds;
        }
        else
        {
            NewAdbooking.classmysql.AdvertisementMaster AdvExec = new NewAdbooking.classmysql.AdvertisementMaster();

            ds = AdvExec.AdvExecDetail(Comp_Code, Team_Code, Team_Name, zone, Flag, userid);
            z = 0;
            return ds;

        }
    }

    [Ajax.AjaxMethod]
    public DataSet chkadv(string Comp_Code, string Team_Code, string userid, string tname, string bname)
    {
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {

            NewAdbooking.Classes.AdvertisementMaster AdvExec = new NewAdbooking.Classes.AdvertisementMaster();
            DataSet ds = new DataSet();
            ds = AdvExec.chkAdv(Comp_Code, Team_Code, userid,tname,bname);
            return ds;
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdvertisementMaster AdvExec = new NewAdbooking.classesoracle.AdvertisementMaster();
            DataSet ds = new DataSet();
            ds = AdvExec.chkAdv(Comp_Code, Team_Code, userid,tname,bname);
            return ds;
        }
        else
        {
            NewAdbooking.classmysql.AdvertisementMaster AdvExec = new NewAdbooking.classmysql.AdvertisementMaster();
            DataSet ds = new DataSet();
            ds = AdvExec.chkAdv(Comp_Code, Team_Code, userid, tname, bname);
            return ds;

        }
        //z=0;

        /*string abc;
        NewAdbooking.Classes.AdvertisementMaster Advetam = new  NewAdbooking.Classes.AdvertisementMaster();
        DataSet dl = new DataSet();
        dl = Advetam.chkpopup(Team_Code ,Comp_Code ,userid);
        if(ds.Tables[0].Rows.Count > 0)
        {
            abc="1";
        }
        else
        {
            abc="0";
        }*/
       
    }

    [Ajax.AjaxMethod]
    public DataSet submitpermission(string hiddencompcode, string hiddenuserid, string formname)
    {
        DataSet dz = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {

            NewAdbooking.Classes.Master checkform = new NewAdbooking.Classes.Master();
            
            dz = checkform.formpermission(hiddencompcode, hiddenuserid, formname);
            return dz;
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.Master checkform = new NewAdbooking.classesoracle.Master();
            dz = checkform.formpermission(hiddencompcode, hiddenuserid, formname);
            return dz;
        }
        else
        {
            NewAdbooking.classmysql.Master checkform = new NewAdbooking.classmysql.Master();

            dz = checkform.formpermission(hiddencompcode, hiddenuserid, formname);
            return dz;
        }
    }

    [Ajax.AjaxMethod]
    public string chkteamcode(string teamcode, string compcode, string userid)
    {
        string abc;
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {

            NewAdbooking.Classes.AdvertisementMaster Advetam = new NewAdbooking.Classes.AdvertisementMaster();
        
            ds = Advetam.chkpopup(teamcode, compcode, userid);
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdvertisementMaster Advetam = new NewAdbooking.classesoracle.AdvertisementMaster();
            ds = Advetam.chkpopup(teamcode, compcode, userid);
        }
        else
        {
            NewAdbooking.classmysql.AdvertisementMaster Advetam = new NewAdbooking.classmysql.AdvertisementMaster();

            ds = Advetam.chkpopup(teamcode, compcode, userid);
        }
        if (ds.Tables[0].Rows.Count > 0)
        {
            abc = "1";
        }
        else
        {
            abc = "0";
        }

        return abc;
    }



    [Ajax.AjaxMethod]
    public DataSet chkexeccode(string str, string region)
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {

            NewAdbooking.Classes.AdvertisementMaster chk = new NewAdbooking.Classes.AdvertisementMaster();
            
            ds = chk.chkexeccode1(str,region);
            return ds;
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdvertisementMaster chk = new NewAdbooking.classesoracle.AdvertisementMaster();
            ds = chk.chkexeccode1(str,region);
            return ds;
        }
        else
        {
            NewAdbooking.classmysql.AdvertisementMaster chk = new NewAdbooking.classmysql.AdvertisementMaster();

            ds = chk.chkexeccode1(str,region);
            return ds;
        }

    }


    //
    [Ajax.AjaxMethod]
    public DataSet addzone1(string pub)
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {

            NewAdbooking.Classes.AdvertisementMaster first = new NewAdbooking.Classes.AdvertisementMaster();
            
            ds = first.countczone(pub);
            return ds;
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdvertisementMaster first = new NewAdbooking.classesoracle.AdvertisementMaster();
            ds = first.countczone(pub);
            return ds;
        }
        else
        {
            NewAdbooking.classmysql.AdvertisementMaster first = new NewAdbooking.classmysql.AdvertisementMaster();

            ds = first.countczone(pub);
            return ds;
        }
    }










    protected void hiddenusername_ServerChange(object sender, System.EventArgs e)
    {

    }

    protected void hiddenuserid_ServerChange(object sender, System.EventArgs e)
    {

    }
    protected void btnSave_Click(object sender, EventArgs e)
    {
        string compcode = Session["compcode"].ToString();
        string userid = Session["userid"].ToString();
        string TeamCode = (TextBox3.Text).Trim();
        string TeamName = (txteamname.Text).Trim();
        string zone = TextBox1.Text;
        string signature = txtsign.Text;
        string attachment = hidattachment.Value;
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {


            NewAdbooking.Classes.AdvertisementMaster AdvExec = new NewAdbooking.Classes.AdvertisementMaster();

            ds = AdvExec.AdvTeamDetailSave(compcode, TeamCode, TeamName, zone, userid, signature,attachment);

        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdvertisementMaster AdvExec = new NewAdbooking.classesoracle.AdvertisementMaster();
            ds = AdvExec.AdvTeamDetailSave(compcode, TeamCode, TeamName, zone, userid, signature, attachment);
        }
        else
        {
            NewAdbooking.classmysql.AdvertisementMaster AdvExec = new NewAdbooking.classmysql.AdvertisementMaster();

            ds = AdvExec.AdvTeamDetailSave(compcode, TeamCode, TeamName, zone, userid);

        }

        DataSet db = (DataSet)Session["exesave"];
        int er = db.Tables[0].Rows.Count;
        int gf = db.Tables.Count;
        for (int b = 0; b <= gf - 1; b++)
        {
            string exename = (db.Tables[b].Rows[0].ItemArray[0].ToString()).Trim();
            string designation = db.Tables[b].Rows[0].ItemArray[1].ToString();
            string address = (db.Tables[b].Rows[0].ItemArray[2].ToString()).Trim();
            string street = (db.Tables[b].Rows[0].ItemArray[3].ToString()).Trim();
            string city = db.Tables[b].Rows[0].ItemArray[11].ToString();
            string district = db.Tables[b].Rows[0].ItemArray[4].ToString();
            string state = db.Tables[b].Rows[0].ItemArray[5].ToString();
            string country = db.Tables[b].Rows[0].ItemArray[6].ToString();
            string pin = (db.Tables[b].Rows[0].ItemArray[7].ToString()).Trim();
            string phone = (db.Tables[b].Rows[0].ItemArray[8].ToString()).Trim();
            string status = db.Tables[b].Rows[0].ItemArray[9].ToString();
            string report = db.Tables[b].Rows[0].ItemArray[13].ToString();
            string taluka = db.Tables[b].Rows[0].ItemArray[14].ToString();
            string repname = db.Tables[b].Rows[0].ItemArray[15].ToString();
            string adcat = db.Tables[b].Rows[0].ItemArray[17].ToString();
            string adtype = db.Tables[b].Rows[0].ItemArray[18].ToString();
            string craditlimit = db.Tables[b].Rows[0].ItemArray[19].ToString();
            string email = (db.Tables[b].Rows[0].ItemArray[20].ToString()).Trim();
            string mobile = (db.Tables[b].Rows[0].ItemArray[21].ToString()).Trim();
            string empcode = (db.Tables[b].Rows[0].ItemArray[22].ToString()).Trim();
            string mailto = (db.Tables[b].Rows[0].ItemArray[23].ToString()).Trim();
            string ATTACHMENT = (db.Tables[b].Rows[0].ItemArray[24].ToString()).Trim();
            string PAYMENTMODE = (db.Tables[b].Rows[0].ItemArray[25].ToString()).Trim();

            DataSet ds3 = new DataSet();
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
            {


                NewAdbooking.Classes.AdvertisementMaster inserted = new NewAdbooking.Classes.AdvertisementMaster();

                ds3 = inserted.detailinserted(exename, designation, address, street, city, district, state, country, pin, phone, status, compcode, userid, TeamCode, report, taluka, repname, adtype, zone, craditlimit, email, mobile, empcode, mailto, ATTACHMENT, PAYMENTMODE);
            }
            else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
            {
                NewAdbooking.classesoracle.AdvertisementMaster inserted = new NewAdbooking.classesoracle.AdvertisementMaster();
                ds3 = inserted.detailinserted(exename, designation, address, street, city, district, state, country, pin, phone, status, compcode, userid, TeamCode, report, taluka, repname, adtype, zone, craditlimit, email, mobile, empcode, mailto, ATTACHMENT);
            }
            else if (ConfigurationManager.AppSettings["ConnectionType"].ToString() == "mysql")
            {
                string procedureName = "execcontactinsert_execcontactinsert_p";
                string[] parameterValueArray = { exename, TeamCode, designation, address, street, city, district, state, country, pin, phone, status, compcode, userid, report, taluka, repname, adtype, zone, craditlimit, mobile, email, mailto, empcode, attachment };
                NewAdbooking.classmysql.CommonClass obj = new NewAdbooking.classmysql.CommonClass();
                ds3 = obj.DynamicBindProcedure(procedureName, parameterValueArray);
            }
            //else
            //{
            //    NewAdbooking.classmysql.AdvertisementMaster inserted = new NewAdbooking.classmysql.AdvertisementMaster();

            //    ds3 = inserted.detailinserted(exename, designation, address, street, city, district, state, country, pin, phone, status, compcode, userid, TeamCode, report, taluka, repname, adtype, zone);

            //}
            string execcode = "";
            if (ds3.Tables[0].Rows.Count > 0)
            {
                execcode = ds3.Tables[0].Rows[0].ItemArray[0].ToString();
            }
            string []arradcat = adcat.Split(",".ToCharArray());
            for (int li1 = 0; li1 < arradcat.Length; li1++)
            {
               // DataSet dsadcat = new DataSet();
                if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
                {
                    NewAdbooking.classesoracle.AdvertisementMaster inserted = new NewAdbooking.classesoracle.AdvertisementMaster();
                    inserted.insertedExecAdetail(compcode, userid, TeamCode, arradcat[li1], "1", execcode);
                    // return dsadcat;
                }
                else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
                {
                    NewAdbooking.Classes.AdvertisementMaster inserted = new NewAdbooking.Classes.AdvertisementMaster();
                    inserted.insertedExecAdetail(compcode, userid, TeamCode, arradcat[li1], "1", execcode);
                    // return dsadcat;
                }
                else
                {
                    NewAdbooking.classmysql.AdvertisementMaster inserted = new NewAdbooking.classmysql.AdvertisementMaster();
                    inserted.insertedExecAdetail(compcode, userid, TeamCode, arradcat[li1], "1", execcode);
                }
            }

            if ((Session["retainer_comm_structure"] == "") || (Session["retainer_comm_structure"] == null))
            {
            }
            else
            {

                //saurabh code------------------------------------------------


                //string status1 = Request.QueryString["status"].ToString();
                //string fromdate1 = Request.QueryString["fromdate"].ToString();
                //string todate1 = Request.QueryString["todate"].ToString();
                //string circular1 = Request.QueryString["circular"].ToString();
                //string centercode = Request.QueryString["centercode"].ToString();


                //---------------------------end--------------------------------
                var execode="exe"+(b+2);
                DataSet db1 = (DataSet)Session["retainer_comm_structure"];
                int er1 = db1.Tables[0].Rows.Count;
                int gf1 = db1.Tables.Count;
               
                    for (int f = 0; f <= gf1 - 1; f++)
                    {
                        if (db1.Tables[f].Rows[0]["TEMPEXECODE"].ToString() == execode)
                        {
                            string enln = db1.Tables[f].Rows[0].ItemArray[0].ToString();
                            string PTEAM_CODE = db1.Tables[f].Rows[0].ItemArray[1].ToString();
                            string PADCTG_CODE = db1.Tables[f].Rows[0].ItemArray[4].ToString();
                            string PFROM_TGT = db1.Tables[f].Rows[0].ItemArray[2].ToString();
                            string PTO_TGT = db1.Tables[f].Rows[0].ItemArray[3].ToString();
                            string PCUST_TYPE = db1.Tables[f].Rows[0].ItemArray[5].ToString();
                            string PAD_TYPE = db1.Tables[f].Rows[0].ItemArray[6].ToString();
                            string PPUB_TYPE = db1.Tables[f].Rows[0].ItemArray[7].ToString();
                            string PPUBL_CODE = db1.Tables[f].Rows[0].ItemArray[8].ToString();
                            string retcode = execcode;
                            // string PCOMM_TARGET_ID = db1.Tables[b].Rows[0].ItemArray[0].ToString();
                            // string PCREATED_BY = db1.Tables[b].Rows[0].ItemArray[1].ToString();


                            DataSet ds1 = new DataSet();
                            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
                            {
                                NewAdbooking.Classes.AdvertisementMaster insert = new NewAdbooking.Classes.AdvertisementMaster();

                                ds1 = insert.insertretcommstructure(compcode, userid, retcode, PTEAM_CODE, PADCTG_CODE, PFROM_TGT, PTO_TGT, PCUST_TYPE, PAD_TYPE, PPUB_TYPE, PPUBL_CODE, enln);
                            }
                            else
                                if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
                                {
                                    NewAdbooking.classesoracle.AdvertisementMaster insert = new NewAdbooking.classesoracle.AdvertisementMaster();

                                    ds1 = insert.insertretcommstructure(compcode, userid, retcode, PTEAM_CODE, PADCTG_CODE, PFROM_TGT, PTO_TGT, PCUST_TYPE, PAD_TYPE, PPUB_TYPE, PPUBL_CODE, enln);

                                }
                                else if (ConfigurationManager.AppSettings["ConnectionType"].ToString() == "mysql")
                                {
                                    string procedureName = "AD_execu_COMM_TARGET_INS";
                                    string[] parameterValueArray = { compcode, retcode, PTEAM_CODE, PADCTG_CODE, PFROM_TGT, PTO_TGT, PCUST_TYPE, PAD_TYPE, PPUB_TYPE, PPUBL_CODE, userid, null, null, null, enln, "I" };
                                    NewAdbooking.classmysql.Master obj = new NewAdbooking.classmysql.Master();
                                    ds = obj.BindCommanFunction(procedureName, parameterValueArray);
                                }
                            //else
                            //{
                            //    NewAdbooking.classmysql.RetainerMaster insert = new NewAdbooking.classmysql.RetainerMaster();

                            //    ds1 = insert.insertretstatus(compcode, userid, retcode, status, fromdate, todate, circular);

                            //}
                        }
                    }
                }


            if ((Session["retainer_slab"] == "") || (Session["retainer_slab"] == null))
            {
            }
            else
            {

                //saurabh code------------------------------------------------


                //string status1 = Request.QueryString["status"].ToString();
                //string fromdate1 = Request.QueryString["fromdate"].ToString();
                //string todate1 = Request.QueryString["todate"].ToString();
                //string circular1 = Request.QueryString["circular"].ToString();
                //string centercode = Request.QueryString["centercode"].ToString();


                //---------------------------end--------------------------------
                var execode = "exe" + (b + 2);
                DataSet db2 = (DataSet)Session["retainer_slab"];
                int er2 = db2.Tables[0].Rows.Count;
                int gf2 = db2.Tables.Count;
                for (int g = 0; g <= gf2 - 1; g++)
                {
                    if (db2.Tables[g].Rows[0]["TEMPEXECODE"].ToString() == execode)
                    { // string enln = db1.Tables[b].Rows[0].ItemArray[0].ToString();
                        string fromdays = db2.Tables[g].Rows[0].ItemArray[1].ToString();
                        string todays = db2.Tables[g].Rows[0].ItemArray[2].ToString();
                        string drpcommon = db2.Tables[g].Rows[0].ItemArray[3].ToString();
                        string commrate = db2.Tables[g].Rows[0].ItemArray[4].ToString();
                        string commid = db2.Tables[g].Rows[0].ItemArray[5].ToString();
                        string retcode = execcode;
                        DataSet ds1 = new DataSet();
                        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
                        {
                            NewAdbooking.Classes.AdvertisementMaster insert = new NewAdbooking.Classes.AdvertisementMaster();

                            ds1 = insert.insertretstatus_slab(compcode, userid, retcode, fromdays, todays, drpcommon, commrate, commid);
                        }
                        else
                            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
                            {
                                NewAdbooking.classesoracle.AdvertisementMaster insert = new NewAdbooking.classesoracle.AdvertisementMaster();

                                ds1 = insert.insertretstatus_slab(compcode, userid, retcode, fromdays, todays, drpcommon, commrate, commid);

                            }
                            else if (ConfigurationManager.AppSettings["ConnectionType"].ToString() == "mysql")
                            {
                                string procedureName = "insertexestatus_slab";
                                string[] parameterValueArray = { compcode, userid, retcode, fromdays, todays, drpcommon, commid, commrate };
                                NewAdbooking.classmysql.Master obj = new NewAdbooking.classmysql.Master();
                                ds = obj.BindCommanFunction(procedureName, parameterValueArray);
                            }
                        //else
                        //{
                        //    NewAdbooking.classmysql.RetainerMaster insert = new NewAdbooking.classmysql.RetainerMaster();

                        //    ds1 = insert.insertretstatus(compcode, userid, retcode, status, fromdate, todate, circular);

                        //}
                    }

                }
            }

            if ((Session["retaineraddtionalcomm_slab"] == "") || (Session["retaineraddtionalcomm_slab"] == null))
            {
            }
            else
            {

                var execode = "exe" + (b + 2);
                DataSet db3 = (DataSet)Session["retaineraddtionalcomm_slab"];
                int er3 = db3.Tables[0].Rows.Count;
                int gf3 = db3.Tables.Count;
                for (int m = 0; m <= gf3 - 1; m++)
                {
                    if (db3.Tables[m].Rows[0]["TEMPEXECODE"].ToString() == execode)
                    { // string enln = db1.Tables[b].Rows[0].ItemArray[0].ToString();
                        string lstpub = db3.Tables[m].Rows[0].ItemArray[0].ToString();
                        string minpub = db3.Tables[m].Rows[0].ItemArray[1].ToString();
                        string publication = db3.Tables[m].Rows[0].ItemArray[2].ToString();
                        string commid = db3.Tables[m].Rows[0].ItemArray[3].ToString();
                        string retcode = execcode;
                        DataSet ds1 = new DataSet();
                        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
                        {
                            NewAdbooking.Classes.AdvertisementMaster insert = new NewAdbooking.Classes.AdvertisementMaster();

                            ds1 = insert.insertretaddcomm(compcode, userid, retcode, lstpub, minpub, publication, commid);
                        }
                        else
                            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
                            {
                                NewAdbooking.classesoracle.AdvertisementMaster insert = new NewAdbooking.classesoracle.AdvertisementMaster();

                                ds1 = insert.insertretaddcomm(compcode, userid, retcode, lstpub, minpub, publication, commid);

                            }
                            else if (ConfigurationManager.AppSettings["ConnectionType"].ToString() == "mysql")
                            {
                                string procedureName = "ad_execu_add_comm_target_ins";
                                string[] parameterValueArray = { compcode, retcode, lstpub, minpub, publication, null, userid, null, null, null, commid, "1", "I" };
                                NewAdbooking.classmysql.Master obj = new NewAdbooking.classmysql.Master();
                                ds = obj.BindCommanFunction(procedureName, parameterValueArray);
                            }
                        //else
                        //{
                        //    NewAdbooking.classmysql.RetainerMaster insert = new NewAdbooking.classmysql.RetainerMaster();

                        //    ds1 = insert.insertretstatus(compcode, userid, retcode, status, fromdate, todate, circular);

                        //}
                    }

                }
            }
        }

        
        Session["exesave"] = null;
        Session["retainer_comm_structure"] = null;
        Session["retainer_slab"] = null;
        Session["retaineraddtionalcomm_slab"] = null;
        ScriptManager.RegisterClientScriptBlock(this, typeof(AdvExecMaster), "zz1", "clearfields();", true);
        

    }

    protected void AspNetMessageBox(string strMessage)
    {
        string strAlert = "";
        strAlert = "alert('" + strMessage + "')";
        ScriptManager.RegisterClientScriptBlock(this, typeof(AdvExecMaster), "ShowAlert", strAlert, true);
    }
    //[Ajax.AjaxMethod]
    //public DataSet empcodebind(string empname)
    //{
    //    drpemcode.Items.Clear();
    //    DataSet ds = new DataSet();
    //    if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
    //    {

    //        NewAdbooking.Classes.AdvertisementMaster name = new NewAdbooking.Classes.AdvertisementMaster();

    //        ds = name.bindempcode(Session["compcode"].ToString(), empname);
    //    }
    //    else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
    //    {
    //        NewAdbooking.classesoracle.AdvertisementMaster name = new NewAdbooking.classesoracle.AdvertisementMaster();
    //        ds = name.bindempcode(Session["compcode"].ToString(), empname);
    //    }
       
    //    //ListItem li1;
    //    //li1 = new ListItem();
    //    //li1.Text = "-----Select Employe-----";
    //    //li1.Value = "0";
    //    //li1.Selected = true;
    //    //drpemcode.Items.Add(li1);

    //    //int i;
    //    //for (i = 0; i < ds.Tables[0].Rows.Count; i++)
    //    //{
    //    //    ListItem li;
    //    //    li = new ListItem();
    //    //    li.Text = ds.Tables[0].Rows[i].ItemArray[1].ToString();
    //    //    li.Value = ds.Tables[0].Rows[i].ItemArray[0].ToString();
    //    //    drpemcode.Items.Add(li);
    //    //}
    //}
    protected void txteamname_TextChanged(object sender, EventArgs e)
    {

    }
}



    
   
