using System;
using System.Data;
using System.Configuration;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;
using System.Data.OracleClient;
namespace NewAdbooking.classesoracle
{
    /// <summary>
    /// Summary description for BookingMaster
    /// </summary>
    public class BookingMaster : orclconnection
    {
        public BookingMaster()
        {
            //
            // TODO: Add constructor logic here
            //
        }

        public DataSet bindfmgpermission(string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("fmgbind", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pComp_code", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);



                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;




                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                objOracleConnection.Close();
            }
        }


        public DataSet ratebindcenterwise(string adcat, string compcode, string branch)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("bindratecodecenterwise", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;



                OracleParameter prm2 = new OracleParameter("pcompcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("padcat", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = adcat;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm31 = new OracleParameter("pbranch", OracleType.VarChar);
                prm31.Direction = ParameterDirection.Input;
                prm31.Value = branch;
                objOraclecommand.Parameters.Add(prm31);

                OracleParameter prm31a = new OracleParameter("pextra1", OracleType.VarChar);
                prm31a.Direction = ParameterDirection.Input;
                prm31a.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm31a);

                OracleParameter prm31c = new OracleParameter("pextra2", OracleType.VarChar);
                prm31c.Direction = ParameterDirection.Input;
                prm31c.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm31c);


                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);

                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet chkdiscountpremedit_per(string userid, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("chkdiscountpremedit_per", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("userid1", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = userid;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts2"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts3", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts3"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                objOracleConnection.Close();
            }
        }
        public DataSet getResourceNo(string name_p)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getResourceNo", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("name_p", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = name_p;
                objOraclecommand.Parameters.Add(prm1);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getSectionCode(string name_p)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getSectionCode", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("name_p", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = name_p;
                objOraclecommand.Parameters.Add(prm1);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet bindreferenceID(string compcode, string agency, string client)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("bindreferenceID_TV", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode_p", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("agency_p", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = agency;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm2a = new OracleParameter("client_p", OracleType.VarChar);
                prm2a.Direction = ParameterDirection.Input;
                prm2a.Value = client;
                objOraclecommand.Parameters.Add(prm2a);



                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet fetchPassword(string compcode, string userid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("fetchPassword", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode_p", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("userid_p", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = userid;
                objOraclecommand.Parameters.Add(prm2);



                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getDetailforProof(string cioid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getdetailforproofpreview", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("cioid", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = cioid;
                objOraclecommand.Parameters.Add(prm1);




                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public void updateMatterDetail(string plainmatter, string rtfformat, string xtgmatter, string filename, string cioid, string userid, int rwcount, string pubcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("updateMatterDetail", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("plainmatter", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = plainmatter;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("rtfformat", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = rtfformat;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("xtgmatter", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = xtgmatter;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm5 = new OracleParameter("filename", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = filename;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("cioid", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = cioid;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("userid", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = userid;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm71 = new OracleParameter("rwcount", OracleType.Int32);
                prm71.Direction = ParameterDirection.Input;
                prm71.Value = rwcount;
                objOraclecommand.Parameters.Add(prm71);

                OracleParameter prm8 = new OracleParameter("pubcode", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = pubcode;
                objOraclecommand.Parameters.Add(prm8);

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                //return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet bindAdOnPackage(string compcode, string adtype)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("bindpackage_Adon", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("adtype", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = adtype;
                objOraclecommand.Parameters.Add(prm2);



                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet CONVERTTOLOCAL_CURRENCY(string p_Comp_code, string p_Curr_Code, string p_amount, string p_amount1, string p_date, string dateformat, string convertcurrency)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("tv_convert_to_local", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("p_Comp_code", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = p_Comp_code;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("p_Curr_Code", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = p_Curr_Code;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("p_amount", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                if (p_amount == "")
                    prm3.Value = System.DBNull.Value;
                else
                    prm3.Value = p_amount;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm3a = new OracleParameter("p_amount1", OracleType.VarChar);
                prm3a.Direction = ParameterDirection.Input;
                if (p_amount1 == "")
                    prm3a.Value = System.DBNull.Value;
                else
                    prm3a.Value = p_amount1;
                objOraclecommand.Parameters.Add(prm3a);


                OracleParameter prm4 = new OracleParameter("p_date", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                if (p_date != "")
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = p_date.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        p_date = mm + "/" + dd + "/" + yy;


                    }

                    prm4.Value = Convert.ToDateTime(p_date).ToString("dd-MMMM-yyyy");
                }
                else
                {
                    prm4.Value = System.DBNull.Value;
                }
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm2a = new OracleParameter("convertcurrency", OracleType.VarChar);
                prm2a.Direction = ParameterDirection.Input;
                prm2a.Value = convertcurrency;
                objOraclecommand.Parameters.Add(prm2a);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet GETCASH_PAY(string compcode, string paymode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("GETCASH_PAY", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("paymode_p", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("compcode_p", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = paymode;
                objOraclecommand.Parameters.Add(prm2);



                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public void SAVELOGIN_DJ(string cioid, string pub, string center_p, string branch_p, string login)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("SAVELOGIN_DJ", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("cioid", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = cioid;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("pub", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = pub;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("center_p", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = center_p;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("branch_p", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = branch_p;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("login", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = login;
                objOraclecommand.Parameters.Add(prm5);


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);


            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet bindAdTypeAgencyWise(string agencycode, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getAgencyBookingType", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("agencycode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = agencycode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);



                objOraclecommand.Parameters.Add("get_district", OracleType.Cursor);
                objOraclecommand.Parameters["get_district"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getVTSRate(string pubcode, string edition, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getVTSRate", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode_p", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("pubcode_p", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = pubcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("edition_p", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = edition;
                objOraclecommand.Parameters.Add(prm3);


                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }


        public DataSet getbranchpermissionchk(string compcode, string branch, string userid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("multi_branch_rights_chk", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pcomp_code", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("puserid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = userid;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("pbranch", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = branch;
                objOraclecommand.Parameters.Add(prm3);



                OracleParameter prm4 = new OracleParameter("pextra2", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm4);





                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }




        public DataSet getPackageConsumption(string pkgcode, string pfdate, string pldate, string dateformat)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getPackageConsumption", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pkgcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = pkgcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("pfdate", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                if (dateformat == "dd/mm/yyyy")
                {
                    string[] arr = pfdate.Split('/');
                    string dd = arr[0];
                    string mm = arr[1];
                    string yy = arr[2];
                    pfdate = mm + "/" + dd + "/" + yy;


                }

                prm2.Value = Convert.ToDateTime(pfdate).ToString("dd-MMMM-yyyy");

                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("pldate", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                if (dateformat == "dd/mm/yyyy")
                {
                    string[] arr = pldate.Split('/');
                    string dd = arr[0];
                    string mm = arr[1];
                    string yy = arr[2];
                    pldate = mm + "/" + dd + "/" + yy;


                }

                prm3.Value = Convert.ToDateTime(pldate).ToString("dd-MMMM-yyyy");
                objOraclecommand.Parameters.Add(prm3);



                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getDealAmt(string conttype, string dealagency, string dealclient, string compcode, string contcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getDealAmt", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("conttype", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = conttype;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("contagency", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = dealagency;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("contclient", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = dealclient;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("contcode", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = contcode;
                objOraclecommand.Parameters.Add(prm5);


                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getDealP(string compcode, string contcode, string type, int counter)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("booking_getdealag", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("contcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = contcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm2a = new OracleParameter("type_p", OracleType.VarChar);
                prm2a.Direction = ParameterDirection.Input;
                prm2a.Value = type;
                objOraclecommand.Parameters.Add(prm2a);

                OracleParameter prm2z = new OracleParameter("counter_p", OracleType.VarChar);
                prm2z.Direction = ParameterDirection.Input;
                prm2z.Value = counter;
                objOraclecommand.Parameters.Add(prm2z);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getpubcount(string compcode, string noofinsert, string packagecode, string cioid_v)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getpubcount", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("noofinsert", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = noofinsert;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("packagecode", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = packagecode;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("cioid_v", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = cioid_v;
                objOraclecommand.Parameters.Add(prm4);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet fetchFMGrefID(string cioid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("fetchFMGrefID", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("cioid_p", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = cioid;
                objOraclecommand.Parameters.Add(prm1);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getPubSharing(string packagecode, string compcode, string cioid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getPubBooking", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("packagecode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = packagecode;
                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("cioid_v", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = cioid;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getDiscPremVal(string compcode, string drpdiscprem)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getDiscPremVal", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode_p", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("drpdiscprem_p", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = drpdiscprem;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet bindDiscPrem(string compcode, string adtype)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("bindDiscPrem", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode_p", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("adtype_p", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = adtype;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public void updateData(string srno, string insertid, string height, string width, string totarea, string dateI, string cioid, string receiptno)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("updateInsertSplitData", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("srno_p", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = srno;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("insertid_p", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = insertid;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("height_p", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = height;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("width_p", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = width;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("totarea_p", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = totarea;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("dateI_p", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = dateI;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("cioidm", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = cioid;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("receiptnom", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = receiptno;
                objOraclecommand.Parameters.Add(prm8);


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);


            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public void deleteRecord(string srno, string insertid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("deleteSplitSizeRecord", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("srno_p", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = srno;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("insertid_p", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = insertid;
                objOraclecommand.Parameters.Add(prm2);


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);


            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getInsertSplitData(string mainid, string dateformat)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getInsertSplitData", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("idmain", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = mainid;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("dateformat", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = dateformat;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getpaymentdetail(string receipt)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getpaymentdetail", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("receipt", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = receipt;
                objOraclecommand.Parameters.Add(prm1);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet insertpaymentdetail(string receiptno, string chqno, string chqdate, string amount, string chqmode, string bankname, string bankbranch, string filename, string dateformat)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("insertpaymentdetail", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("receiptno_m", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = receiptno;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("chqno_m", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = chqno;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("chqdate_m", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                if (chqdate == "")
                    prm3.Value = System.DBNull.Value;
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = chqdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        chqdate = mm + "/" + dd + "/" + yy;


                    }

                    prm3.Value = Convert.ToDateTime(chqdate).ToString("dd-MMMM-yyyy");

                }
                objOraclecommand.Parameters.Add(prm3);
                OracleParameter prm4 = new OracleParameter("amount_m", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = amount;
                objOraclecommand.Parameters.Add(prm4);


                OracleParameter prm5 = new OracleParameter("chqmode_m", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = chqmode;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("bankname_m", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = bankname;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("bankbranch_m", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = bankbranch;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("filename_m", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = filename;
                objOraclecommand.Parameters.Add(prm8);

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getPaymentFlag(string agencycode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getPaymentFlag", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("agencycode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = agencycode;
                objOraclecommand.Parameters.Add(prm1);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public void insertionCount(string cioid, int count)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("insertionCount", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;
                OracleParameter prm1 = new OracleParameter("totalcount", OracleType.Int32);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = count;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("cioidM", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = cioid;
                objOraclecommand.Parameters.Add(prm2);

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objOraclecommand.ExecuteNonQuery();


            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public string commitT(int count, string cioid, string pcompcode, string pcentname, string puserid, string pbkid_gentype, string pbk_type, string quotation)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            objOracleConnection = GetConnection();
            DataSet objDataSet = new DataSet();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("committransaction", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("totalcount", OracleType.Int32);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = count;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("pcioid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = cioid;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("pcompcode", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = pcompcode;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("pcentname", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = pcentname;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("puserid", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = puserid;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("pbkid_gentype", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = pbkid_gentype;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("pbk_type", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = pbk_type;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("pquotation", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = quotation;
                objOraclecommand.Parameters.Add(prm8);

                objOraclecommand.Parameters.Add("p_error", OracleType.VarChar, 200);
                objOraclecommand.Parameters["p_error"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_new_cioid", OracleType.VarChar, 200);
                objOraclecommand.Parameters["p_new_cioid"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                //objOraclecommand.ExecuteNonQuery();
                string output = objOraclecommand.Parameters["p_error"].Value.ToString() + "$~$" + objOraclecommand.Parameters["p_new_cioid"].Value.ToString();


                return output;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public void rollbackT(string cioid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("rollbacktransaction", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;
                OracleParameter prm2 = new OracleParameter("cioid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = cioid;
                objOraclecommand.Parameters.Add(prm2);
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objOraclecommand.ExecuteNonQuery();


            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getEditionCount_bullet(string compcode, string pkgcode, string edition)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getEditionCount_bullet", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pkgcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = pkgcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("edition", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = edition;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet fetchqbcdetail(string compcode, string cioid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("fetchqbcdetail", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("cioid", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = cioid;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);
                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getstatuspaymodeAgency(string agency, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getstatuspaymodeAgency", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("agencycode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = agency;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);
                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getBarterBookingAmt(string bartertype, string cioid, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getBarterBookingAmt", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("bartertype", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = bartertype;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("cioid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = cioid;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("compcode", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = compcode;
                objOraclecommand.Parameters.Add(prm3);


                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet bindcirRate(string compcode, string center)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("cir_get_rates.cir_get_rates_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pcomp_code", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("punit_code", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = center;
                objOraclecommand.Parameters.Add(prm2);


                objOraclecommand.Parameters.Add("paccounts", OracleType.Cursor);
                objOraclecommand.Parameters["paccounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet bindciragency(string compcode, string branch, string ciragency)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("cir_agency_bind.cir_agency_bind_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pcompcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("punit", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = branch;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("pdateformat", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("pextra1", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = ciragency;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("pextra2", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm5);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getIssuedate_Bhaskar(string compcode, string combincode, string fromdate, string todate)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getissuedate_bhaskar", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("combincode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = combincode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("fromdate", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = Convert.ToDateTime(fromdate).ToString("dd-MMMM-yyyy");
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("todate", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = Convert.ToDateTime(todate).ToString("dd-MMMM-yyyy");
                objOraclecommand.Parameters.Add(prm4);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getmaincode(string name, string code, string compname)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getmaincodeChk", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("name", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = name;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("code1", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = code;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("company", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = compname;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("p_getref", OracleType.Cursor);
                objOraclecommand.Parameters["p_getref"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet checkPrevId(string cioid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("checkID_matter", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("cioid1", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = cioid;
                objOraclecommand.Parameters.Add(prm1);



                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getAmount(string cioid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getCioAmount", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("cioid", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = cioid;
                objOraclecommand.Parameters.Add(prm1);



                objOraclecommand.Parameters.Add("p_getref", OracleType.Cursor);
                objOraclecommand.Parameters["p_getref"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getBAlias(string branch, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getBAlias", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("branch", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                if (branch == "")
                    prm2.Value = System.DBNull.Value;
                else
                    prm2.Value = branch;
                objOraclecommand.Parameters.Add(prm2);



                objOraclecommand.Parameters.Add("p_getref", OracleType.Cursor);
                objOraclecommand.Parameters["p_getref"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getIP(string compcode, string center)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_getIP", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("center", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                if (center == "")
                    prm2.Value = System.DBNull.Value;
                else
                    prm2.Value = center;
                objOraclecommand.Parameters.Add(prm2);



                objOraclecommand.Parameters.Add("p_getref", OracleType.Cursor);
                objOraclecommand.Parameters["p_getref"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet clsIssuePageDetails(string pdate, string pubcode, string centercode, string editioncode, string suppcode, string ppageno, string dateformat)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("Websp_Issuepagedetails_P.Websp_Issuepagedetails", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm2 = new OracleParameter("pubcode", OracleType.VarChar, 50);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = pubcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("centercode", OracleType.VarChar, 50);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = centercode;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("editioncode", OracleType.VarChar, 50);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = editioncode;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("suppcode", OracleType.VarChar, 50);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = suppcode;
                objOraclecommand.Parameters.Add(prm5);


                OracleParameter prm6 = new OracleParameter("pdate", OracleType.VarChar, 50);
                prm6.Direction = ParameterDirection.Input;
                if (pdate == "" || pdate == null)
                {
                    prm6.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = pdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        pdate = mm + "/" + dd + "/" + yy;


                    }

                    prm6.Value = Convert.ToDateTime(pdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("ppageno", OracleType.VarChar, 50);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = ppageno;
                objOraclecommand.Parameters.Add(prm7);

                objOraclecommand.Parameters.Add("t_pagedetails", OracleType.Cursor);
                objOraclecommand.Parameters["t_pagedetails"].Direction = ParameterDirection.Output;




                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getRepressentative(string compcode, string executive, string retainer)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getRepresenttaive", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("executive", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = executive;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("retainer", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = retainer;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getAgencyBalance(string compcode, string agencyname)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("GETAGENCYBALANCE", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("COMPCODE", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("AGENCYCODE", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = agencyname;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("Adcat", OracleType.Cursor);
                objOraclecommand.Parameters["Adcat"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getOurBank(string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getOurBank", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);



                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getRegisterClientCheck(string compcode, string ADCAT)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getRegisterClientCheck", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("adcat", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = ADCAT;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet clsGetEditionName_DJ(string compcode, string buttonText, string p_pub, string p_bkfor)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_GetEditionName.websp_GetEditionName_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("buttonText", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = buttonText;
                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("p_pub", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = p_pub;
                objOraclecommand.Parameters.Add(prm3);
                OracleParameter prm4 = new OracleParameter("p_bkfor", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = p_bkfor;
                objOraclecommand.Parameters.Add(prm4);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet clsGetEditionName(string compcode, string buttonText)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_GetEditionName.websp_GetEditionName_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("buttonText", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = buttonText;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getTemplate(string category)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getTemplateCategoryWise", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm2 = new OracleParameter("adcat", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = category;
                objOraclecommand.Parameters.Add(prm2);


                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet clsShow_NoAd()
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_tempdata.websp_tempdata_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }

        public DataSet bindrevenue(string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("bindrevenue.bindrevenue_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getAgencyCode(string compcode, string codesubcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getAgencyCode1", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("codesubcode", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = codesubcode;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("ht_rep", OracleType.Cursor);
                objOraclecommand.Parameters["ht_rep"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet schemebind(string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("bindscheme.bindscheme_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getAgencyStatus(string compcode, string codesubcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getAgencyStatus", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("codesubcode", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = codesubcode;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("ht_rep", OracleType.Cursor);
                objOraclecommand.Parameters["ht_rep"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("ht_rep1", OracleType.Cursor);
                objOraclecommand.Parameters["ht_rep1"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet prevbooking(string compcode, string userid, string formname)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("gettheprevbooking.gettheprevbooking_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("vuserid", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = userid;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("formname", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = formname;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts2"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts3", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts3"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts4", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts4"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("P_Accounts5", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts5"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("P_Accounts6", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts6"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts7", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts7"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                //if (objDataSet.Tables[0].Rows.Count > 0)
                //{
                //    zonename = objDataSet.Tables[0].Rows[0].ItemArray[0].ToString();
                //}
                return objDataSet;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }


        //===============================================================================================


        public DataSet getStatus()
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {

                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_getStatus.websp_getStatus_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getBillStatus()
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_getBillStatus.websp_getBillStatus_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getExecZoneName(string execcode, string compcode)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_getExecZoneName.websp_getExecZoneName_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm1 = new OracleParameter("exexcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = execcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;
                //if (objDataSet.Tables[0].Rows.Count > 0)
                //{
                //    zonename = objDataSet.Tables[0].Rows[0].ItemArray[0].ToString();
                //}
                return objDataSet;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet packagebindActive_DJ(string compcode, string adtype, string userid, string branch, string center, string loginth, string publication)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("bindpackageActive_DJ", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar, 50);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("userid", OracleType.VarChar, 50);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = userid;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("branch", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = branch;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("center", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = center;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("loginth", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = loginth;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("publication", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = publication;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("ad_type", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = adtype;
                objOraclecommand.Parameters.Add(prm7);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;





                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);

                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getClientName_DJ(string compcode, string client, string branch, string center, string loginth, string publication, string ad_userid)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();

            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_getclientName_DJ", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("client", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = client;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("branch", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = branch;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("center", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = center;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("loginth", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = loginth;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("publication", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = publication;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("AD_USERID", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = ad_userid;
                objOraclecommand.Parameters.Add(prm7);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet getClientName(string compcode, string client, string center)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();

            try
            {

                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_getclientName.websp_getclientName_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);



                OracleParameter prm2 = new OracleParameter("client", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = client;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("center", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = center;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }

        public DataSet bindBrand(string compcode, string procat)
        {

            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {

                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_getBrand.websp_getBrand_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("procat", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = procat;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet getInsertion(string package, string noofinsertion, string insertiondate, string startdate, string dateformat, string compcode, string adcategory, string adsubcat, string color, string adtype, string currency, string ratecode, string clickdate, string flag, string code, string @pck, string uom, string dealrate, string checkforor, string premium, string clientname)
        {

            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {



                objOracleConnection.Open();
                objOraclecommand = GetCommand("bindBookingInsertion.bindBookingInsertion_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("package1", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = package;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("noofinsertion", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = noofinsertion;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("insertiondate", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = insertiondate;
                //prm3.Value = Convert.ToDateTime(insertiondate).ToString("dd-MMMM-yyyy");
                objOraclecommand.Parameters.Add(prm3);

                //OracleParameter prm3 = new OracleParameter("insertiondate", OracleType.VarChar);
                //prm3.Direction = ParameterDirection.Input;
                //if (insertiondate == "")
                //{
                //    prm3.Value = System.DBNull.Value;
                //}
                //else
                //{
                //    prm3.Value = Convert.ToDateTime(insertiondate).ToString("dd-MMMM-yyyy");
                //}
                //objOraclecommand.Parameters.Add(prm3);

                //OracleParameter prm4 = new OracleParameter("startdate", OracleType.VarChar);
                //prm4.Direction = ParameterDirection.Input;
                //prm4.Value = Convert.ToDateTime(startdate).ToString("dd-MMMM-yyyy");
                //objOraclecommand.Parameters.Add(prm4);


                OracleParameter prm4 = new OracleParameter("startdate", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                if (dateformat == "dd/mm/yyyy" && startdate != "" && startdate != null)
                {
                    string[] arr = startdate.Split('/');
                    string dd = arr[0];
                    string mm = arr[1];
                    string yy = arr[2];
                    startdate = mm + "/" + dd + "/" + yy;
                }
                if (startdate == "")
                {
                    prm4.Value = "";
                    // System.DBNull.Value;
                }
                else
                {

                    prm4.Value = Convert.ToDateTime(startdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("DATEFORMAT", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = dateformat;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("compcode", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = compcode;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm16 = new OracleParameter("pck", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = pck;
                objOraclecommand.Parameters.Add(prm16);

                //OracleParameter prm16 = new OracleParameter("pck", OracleType.VarChar);
                //prm16.Direction = ParameterDirection.Input;
                //if (pck == "" || pck == null)
                //{
                //    prm16.Value = System.DBNull.Value;
                //}
                //else
                //{
                //    prm16.Value = Convert.ToDecimal(pck);
                //}
                //objOraclecommand.Parameters.Add(prm16);

                OracleParameter prm17 = new OracleParameter("uom", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = uom;
                objOraclecommand.Parameters.Add(prm17);

                OracleParameter prm18 = new OracleParameter("dealrate", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;
                if (dealrate == "" || dealrate == null)
                {
                    prm18.Value = System.DBNull.Value;
                }
                else
                {
                    prm18.Value = Convert.ToDecimal(dealrate);
                }
                objOraclecommand.Parameters.Add(prm18);

                OracleParameter prm7 = new OracleParameter("adcategory", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = adcategory;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("Adsubcat", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = adsubcat;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("color", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = color;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("Adtype", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = adtype;
                objOraclecommand.Parameters.Add(prm10);



                OracleParameter prm11 = new OracleParameter("currency", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = currency;
                objOraclecommand.Parameters.Add(prm11);


                OracleParameter prm12 = new OracleParameter("RATE_CODE", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = ratecode;
                objOraclecommand.Parameters.Add(prm12);

                OracleParameter prm13 = new OracleParameter("clickdate", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;

                if (dateformat == "dd/mm/yyyy" && clickdate != "" && clickdate != null)
                {
                    string[] arr = clickdate.Split('/');
                    string dd = arr[0];
                    string mm = arr[1];
                    string yy = arr[2];
                    clickdate = mm + "/" + dd + "/" + yy;
                }
                if (clickdate == "")
                {
                    prm13.Value = "";
                    // System.DBNull.Value;
                }
                else
                {

                    prm13.Value = Convert.ToDateTime(clickdate).ToString("dd-MMMM-yyyy");
                }

                objOraclecommand.Parameters.Add(prm13);


                OracleParameter prm14 = new OracleParameter("flag", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                if (flag == "" || flag == null)
                {
                    prm14.Value = System.DBNull.Value;
                }
                else
                {
                    prm14.Value = Convert.ToInt32(flag);
                }
                objOraclecommand.Parameters.Add(prm14);

                OracleParameter prm15 = new OracleParameter("code", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = code;
                objOraclecommand.Parameters.Add(prm15);

                OracleParameter prm19 = new OracleParameter("checkforor", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                prm19.Value = checkforor;
                objOraclecommand.Parameters.Add(prm19);

                OracleParameter prm20 = new OracleParameter("premium", OracleType.VarChar);
                prm20.Direction = ParameterDirection.Input;
                prm20.Value = premium;
                objOraclecommand.Parameters.Add(prm20);

                OracleParameter prm21 = new OracleParameter("clientname", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = clientname;
                objOraclecommand.Parameters.Add(prm21);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts2"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts3", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts3"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts4", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts4"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts5", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts5"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts6", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts6"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts7", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts7"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts8", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts8"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts9", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts9"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts10", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts10"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts11", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts11"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }



        /*********************************************************/

        public DataSet bindProduct(string compcode, string product, string value)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_getProduct.websp_getProduct_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("product", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = product;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("value", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = value;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;




                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet bindPagePosition(string compcode, string bookingdate, string dateformat, string adtype)
        {

            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("WEBSP_GETPAGEPOSITION_DATEWISE", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm4 = new OracleParameter("bookingdate", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                if (bookingdate == "")
                {
                    prm4.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = bookingdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        bookingdate = mm + "/" + dd + "/" + yy;
                    }
                    prm4.Value = Convert.ToDateTime(bookingdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm11 = new OracleParameter("adtype_p", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = adtype;
                objOraclecommand.Parameters.Add(prm11);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet bindAdSizeType(string compcode)
        {

            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_getadsize.websp_getadsize_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getCustomer(string compcode)
        {

            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_getCustomerName.websp_getCustomerName_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getExec(string compcode, string execname, string value, string center)
        {

            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_getExec.websp_getExec_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("execname", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = execname;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("value", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = value;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("center", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = center;
                objOraclecommand.Parameters.Add(prm4);



                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                //objOraclecommand.Parameters.Add("P_Accounts1", OracleType.Cursor);
                //objOraclecommand.Parameters["P_Accounts1"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet autogenrated(string compcode, string auto, string no)
        {

            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getautocodebooking.getautocodebooking_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("auto1", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = auto;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("no1", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = no;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet clsEdiRights(string compcode, string pkgName, string userid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("Websp_edirights_P.Websp_edirights", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("pkgName", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = pkgName;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("userid", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = userid;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("t_editionname", OracleType.Cursor);
                objOraclecommand.Parameters["t_editionname"].Direction = ParameterDirection.Output;




                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet bookidchk(string compcode, string ciobookid, string agency, string agencycode, string rono, string saveormod, string keyno)
        {

            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("chkciobookid.chkciobookid_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("ciobookid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = ciobookid;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("agency", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = agency;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("agencycode", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = agencycode;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("rono", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = rono;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("saveormod", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = saveormod;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("keyno", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = keyno;
                objOraclecommand.Parameters.Add(prm7);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts2"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }


        public string insertbooking(string adsizetype, string branch, string booked_by, string prevbook, string date_time, string ciobookid, string approvedby, string audit, string rono, string rodate, string caption, string billstatus, string rostatus, string agency, string client, string agencyaddress, string clientaddresses, string agencycode, string dockitno, string execname, string execzone, string product, string brand, string keyno, string billremark, string printremark, string package, string insertion, string startdate, string repeatdate, string adtype, string adcategory, string subcategory, string color, string uom, string pageposition, string pagetype, string pageno, string adsizheight, string adsizwidth, string ratecode, string scheme, string currency, string agreedrate, string agreedamt, string spedisc, string spacedisx, string compcode, string userid, string specialcharges, string agencytype, string agencystatus, string paymode, string agencredit, string cardrate, string cardamount, string discount, string discountper, string billaddress, string totarea, string billcycle, string revenuecenter, string billpay, string billheight, string billwidth, string billto, string invoices, string vts, string tradedisc, string agencyout, string boxcode, string boxno, string boxaddress, string boxagency, string boxclient, string bookingtype, string tfn, string coupan, string campaign, string bill_amt, string pageprem, string pageamt, string premper, string grossamt, string adsizcolumn, string billcolumn, Decimal billarea, string specdiscper, string spacediscper, string paidins, string dealrate, string deviation, string varient, string contractname, string dealtype, string cardname, string cardtype, string cardmonth, string cardyear, string cardno, string receiptno, string adscat3, string adscat4, string adscat5, string bgcolor, string bulletcode, string bulletprm, string material, string receiptdate, string prevcioid, string prevreceipt, Decimal prev_ga, string region, string varient_name, string coltype, string logo_h, string logo_w, string logo_col, string logo_uom, string dateformat, string retainer, string addagencyrate, string mobileno, string addlamt, string retamt, string retper, string cashrecieved, string ciragency, string cirrate, string ciredition, string cirpublication, string ciragencysubcode, string bartertype, string attach1, string attach2, string cashdiscount, string cashdiscountper, string drpdiscprem, string doctype, string chktradeval, string sharepub, string fmginsert, string chkno, string chkdate, string chkamt, string chkbankname, string ourbank, string dealerpanel, string dealerh, string dealerw, string dealertype, string multiselect, string agreedrate_active, string agreedamt_active, string grossamtlocal_p, string billamtlocal_p, string chkadon, string refid, string rcpt_currency, string cur_convrate, string revisedate, string clienttype, string translation, string translationcharge, string fmgreasons, string canclecharge, string transdisc, string pospremdisc, string billhold)
        {

            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();

            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                // IDbTransaction trans = objOracleConnection.BeginTransaction(); // Turn off AUTOCOMMIT
                objOraclecommand = GetCommand("insertintobooking.insertintobooking_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("date_time", OracleType.DateTime);
                prm1.Direction = ParameterDirection.Input;
                if (date_time == "" || date_time == null)
                {
                    prm1.Value = System.DBNull.Value;

                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = date_time.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        date_time = mm + "/" + dd + "/" + yy;


                    }
                    prm1.Value = Convert.ToDateTime(date_time).ToString("dd-MMMM-yyyy");
                }

                objOraclecommand.Parameters.Add(prm1);


                OracleParameter prm2 = new OracleParameter("adsizetype", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = adsizetype;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("branch", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = branch;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("booked_by", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = booked_by;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("prevbook", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = prevbook;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("approvedby", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = approvedby;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("ciobookid", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = ciobookid;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("audit1", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = audit;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("rono", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = rono;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("rodate", OracleType.DateTime);
                prm10.Direction = ParameterDirection.Input;

                if (rodate == "" || rodate == null)
                {
                    prm10.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = rodate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        rodate = mm + "/" + dd + "/" + yy;


                    }
                    prm10.Value = Convert.ToDateTime(rodate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm10);




                OracleParameter prm11 = new OracleParameter("caption", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = caption;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm12 = new OracleParameter("billstatus", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = billstatus;
                objOraclecommand.Parameters.Add(prm12);

                OracleParameter prm13 = new OracleParameter("rostatus", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = rostatus;
                objOraclecommand.Parameters.Add(prm13);

                OracleParameter prm14 = new OracleParameter("agency", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = agency;
                objOraclecommand.Parameters.Add(prm14);

                OracleParameter prm15 = new OracleParameter("client", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = client;
                objOraclecommand.Parameters.Add(prm15);

                OracleParameter prm16 = new OracleParameter("agencyaddress", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = agencyaddress;
                objOraclecommand.Parameters.Add(prm16);

                OracleParameter prm17 = new OracleParameter("clientaddresses", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = clientaddresses;
                objOraclecommand.Parameters.Add(prm17);


                OracleParameter prm18 = new OracleParameter("agencycode", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;
                prm18.Value = agencycode;
                objOraclecommand.Parameters.Add(prm18);

                OracleParameter prm19 = new OracleParameter("dockitno", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                prm19.Value = dockitno;
                objOraclecommand.Parameters.Add(prm19);

                OracleParameter prm20 = new OracleParameter("execname", OracleType.VarChar);
                prm20.Direction = ParameterDirection.Input;
                prm20.Value = execname;
                objOraclecommand.Parameters.Add(prm20);

                OracleParameter prm21 = new OracleParameter("execzone", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = execzone;
                objOraclecommand.Parameters.Add(prm21);

                OracleParameter prm22 = new OracleParameter("product", OracleType.VarChar);
                prm22.Direction = ParameterDirection.Input;
                prm22.Value = product;
                objOraclecommand.Parameters.Add(prm22);



                OracleParameter prm23 = new OracleParameter("brand", OracleType.VarChar);
                prm23.Direction = ParameterDirection.Input;
                prm23.Value = brand;
                objOraclecommand.Parameters.Add(prm23);

                OracleParameter prm24 = new OracleParameter("keyno", OracleType.VarChar);
                prm24.Direction = ParameterDirection.Input;
                prm24.Value = keyno;
                objOraclecommand.Parameters.Add(prm24);

                OracleParameter prm25 = new OracleParameter("billremark", OracleType.VarChar);
                prm25.Direction = ParameterDirection.Input;
                prm25.Value = billremark;
                objOraclecommand.Parameters.Add(prm25);

                OracleParameter prm26 = new OracleParameter("printremark", OracleType.VarChar);
                prm26.Direction = ParameterDirection.Input;
                prm26.Value = printremark;
                objOraclecommand.Parameters.Add(prm26);

                OracleParameter prm27 = new OracleParameter("package1", OracleType.VarChar);
                prm27.Direction = ParameterDirection.Input;
                prm27.Value = package;
                objOraclecommand.Parameters.Add(prm27);

                OracleParameter prm28 = new OracleParameter("insertion", OracleType.VarChar);
                prm28.Direction = ParameterDirection.Input;
                prm28.Value = insertion;
                objOraclecommand.Parameters.Add(prm28);


                OracleParameter prm29 = new OracleParameter("startdate", OracleType.DateTime);
                prm29.Direction = ParameterDirection.Input;

                if (startdate == "" || startdate == null)
                {
                    prm29.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = startdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        startdate = mm + "/" + dd + "/" + yy;
                    }
                    prm29.Value = Convert.ToDateTime(startdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm29);

                OracleParameter prm30 = new OracleParameter("repeatdate", OracleType.VarChar);
                prm30.Direction = ParameterDirection.Input;
                prm30.Value = repeatdate;
                objOraclecommand.Parameters.Add(prm30);

                OracleParameter prm31 = new OracleParameter("adtype1", OracleType.VarChar);
                prm31.Direction = ParameterDirection.Input;
                prm31.Value = adtype;
                objOraclecommand.Parameters.Add(prm31);

                OracleParameter prm32 = new OracleParameter("adcategory", OracleType.VarChar);
                prm32.Direction = ParameterDirection.Input;
                prm32.Value = adcategory;
                objOraclecommand.Parameters.Add(prm32);

                OracleParameter prm33 = new OracleParameter("subcategory", OracleType.VarChar);
                prm33.Direction = ParameterDirection.Input;
                prm33.Value = subcategory;
                objOraclecommand.Parameters.Add(prm33);

                OracleParameter prm34 = new OracleParameter("color", OracleType.VarChar);
                prm34.Direction = ParameterDirection.Input;
                prm34.Value = color;
                objOraclecommand.Parameters.Add(prm34);

                OracleParameter prm35 = new OracleParameter("uom", OracleType.VarChar);
                prm35.Direction = ParameterDirection.Input;
                prm35.Value = uom;
                objOraclecommand.Parameters.Add(prm35);

                OracleParameter prm36 = new OracleParameter("pageposition", OracleType.VarChar);
                prm36.Direction = ParameterDirection.Input;
                prm36.Value = pageposition;
                objOraclecommand.Parameters.Add(prm36);

                OracleParameter prm37 = new OracleParameter("pagetype1", OracleType.VarChar);
                prm37.Direction = ParameterDirection.Input;
                prm37.Value = pagetype;
                objOraclecommand.Parameters.Add(prm37);

                OracleParameter prm38 = new OracleParameter("pageno", OracleType.VarChar);
                prm38.Direction = ParameterDirection.Input;
                prm38.Value = pageno;
                objOraclecommand.Parameters.Add(prm38);



                OracleParameter prm39 = new OracleParameter("adsizheight", OracleType.VarChar);
                prm39.Direction = ParameterDirection.Input;
                if (adsizheight == "" || adsizheight == null)
                {
                    prm39.Value = System.DBNull.Value;
                }
                else
                {
                    prm39.Value = Convert.ToDecimal(adsizheight);
                }
                objOraclecommand.Parameters.Add(prm39);


                OracleParameter prm40 = new OracleParameter("adsizwidth", OracleType.VarChar);
                prm40.Direction = ParameterDirection.Input;
                if (adsizwidth == "" || adsizwidth == null)
                {
                    prm40.Value = System.DBNull.Value;
                }
                else
                {
                    prm40.Value = Convert.ToDecimal(adsizwidth);
                }
                objOraclecommand.Parameters.Add(prm40);


                OracleParameter prm41 = new OracleParameter("scheme1", OracleType.VarChar);
                prm41.Direction = ParameterDirection.Input;
                prm41.Value = scheme;
                objOraclecommand.Parameters.Add(prm41);

                OracleParameter prm42 = new OracleParameter("currency", OracleType.VarChar);
                prm42.Direction = ParameterDirection.Input;
                prm42.Value = currency;
                objOraclecommand.Parameters.Add(prm42);

                OracleParameter prm43 = new OracleParameter("ratecode11", OracleType.VarChar);
                prm43.Direction = ParameterDirection.Input;
                prm43.Value = ratecode;
                objOraclecommand.Parameters.Add(prm43);

                OracleParameter prm44 = new OracleParameter("agreedrate", OracleType.VarChar);
                prm44.Direction = ParameterDirection.Input;
                if (agreedrate == "" || agreedrate == null)
                {
                    prm44.Value = System.DBNull.Value;
                }
                else
                {
                    prm44.Value = Convert.ToDecimal(agreedrate);
                }
                objOraclecommand.Parameters.Add(prm44);


                OracleParameter prm45 = new OracleParameter("agreedamt", OracleType.VarChar);
                prm45.Direction = ParameterDirection.Input;
                if (agreedamt == "" || agreedamt == null)
                {
                    prm45.Value = System.DBNull.Value;
                }
                else
                {
                    prm45.Value = Convert.ToDecimal(agreedamt);
                }
                objOraclecommand.Parameters.Add(prm45);


                OracleParameter prm46 = new OracleParameter("spedisc", OracleType.VarChar);
                prm46.Direction = ParameterDirection.Input;
                if (spedisc == "" || spedisc == null)
                {
                    prm46.Value = System.DBNull.Value;
                }
                else
                {
                    prm46.Value = Convert.ToDecimal(spedisc);
                }
                objOraclecommand.Parameters.Add(prm46);

                OracleParameter prm47 = new OracleParameter("compcode", OracleType.VarChar);
                prm47.Direction = ParameterDirection.Input;
                prm47.Value = compcode;
                objOraclecommand.Parameters.Add(prm47);

                OracleParameter prm48 = new OracleParameter("spacedisx", OracleType.VarChar);
                prm48.Direction = ParameterDirection.Input;
                if (spacedisx == "" || spacedisx == null)
                {
                    prm48.Value = System.DBNull.Value;
                }
                else
                {
                    prm48.Value = Convert.ToDecimal(spacedisx);
                }
                objOraclecommand.Parameters.Add(prm48);


                OracleParameter prm49 = new OracleParameter("specialcharges", OracleType.VarChar);
                prm49.Direction = ParameterDirection.Input;
                if (specialcharges == "" || specialcharges == null)
                {
                    prm49.Value = System.DBNull.Value;
                }
                else
                {
                    prm49.Value = Convert.ToDecimal(specialcharges);
                }
                objOraclecommand.Parameters.Add(prm49);


                OracleParameter prm50 = new OracleParameter("userid", OracleType.VarChar);
                prm50.Direction = ParameterDirection.Input;
                prm50.Value = userid;
                objOraclecommand.Parameters.Add(prm50);

                OracleParameter prm51 = new OracleParameter("agencytype", OracleType.VarChar);
                prm51.Direction = ParameterDirection.Input;
                prm51.Value = agencytype;
                objOraclecommand.Parameters.Add(prm51);

                OracleParameter prm52 = new OracleParameter("agencystatus", OracleType.VarChar);
                prm52.Direction = ParameterDirection.Input;
                prm52.Value = agencystatus;
                objOraclecommand.Parameters.Add(prm52);

                OracleParameter prm53 = new OracleParameter("paymode", OracleType.VarChar);
                prm53.Direction = ParameterDirection.Input;
                prm53.Value = paymode;
                objOraclecommand.Parameters.Add(prm53);

                OracleParameter prm54 = new OracleParameter("agenccredit", OracleType.VarChar);
                prm54.Direction = ParameterDirection.Input;
                if (agencredit == "" || agencredit == null)
                {
                    prm54.Value = System.DBNull.Value;
                }
                else
                {
                    prm54.Value = Convert.ToInt32(agencredit);
                }
                objOraclecommand.Parameters.Add(prm54);


                OracleParameter prm55 = new OracleParameter("cardrate", OracleType.VarChar);
                prm55.Direction = ParameterDirection.Input;
                if (cardrate == "" || cardrate == null)
                {
                    prm55.Value = System.DBNull.Value;
                }
                else
                {
                    prm55.Value = Convert.ToDecimal(cardrate);
                }
                objOraclecommand.Parameters.Add(prm55);


                OracleParameter prm56 = new OracleParameter("cardamount", OracleType.VarChar);
                prm56.Direction = ParameterDirection.Input;
                if (cardamount == "" || cardamount == null)
                {
                    prm56.Value = System.DBNull.Value;
                }
                else
                {
                    prm56.Value = Convert.ToDecimal(cardamount);
                }
                objOraclecommand.Parameters.Add(prm56);

                OracleParameter prm57 = new OracleParameter("discount", OracleType.VarChar);
                prm57.Direction = ParameterDirection.Input;
                if (discount == "" || discount == null)
                {
                    prm57.Value = System.DBNull.Value;
                }
                else
                {
                    prm57.Value = Convert.ToDecimal(discount);
                }
                objOraclecommand.Parameters.Add(prm57);


                OracleParameter prm58 = new OracleParameter("discountper", OracleType.VarChar);
                prm58.Direction = ParameterDirection.Input;
                if (discountper == "" || discountper == null)
                {
                    prm58.Value = System.DBNull.Value;
                }
                else
                {
                    prm58.Value = Convert.ToDecimal(discountper);
                }
                objOraclecommand.Parameters.Add(prm58);


                OracleParameter prm59 = new OracleParameter("billaddress", OracleType.VarChar);
                prm59.Direction = ParameterDirection.Input;
                prm59.Value = billaddress;
                objOraclecommand.Parameters.Add(prm59);

                OracleParameter prm60 = new OracleParameter("totarea", OracleType.VarChar);
                prm60.Direction = ParameterDirection.Input;
                if (totarea == "" || totarea == null)
                {
                    prm60.Value = System.DBNull.Value;
                }
                else
                {
                    prm60.Value = Convert.ToDecimal(totarea);
                }
                objOraclecommand.Parameters.Add(prm60);


                OracleParameter prm61 = new OracleParameter("billcycle", OracleType.VarChar);
                prm61.Direction = ParameterDirection.Input;
                prm61.Value = billcycle;
                objOraclecommand.Parameters.Add(prm61);

                OracleParameter prm62 = new OracleParameter("billpay", OracleType.VarChar);
                prm62.Direction = ParameterDirection.Input;
                prm62.Value = billpay;
                objOraclecommand.Parameters.Add(prm62);

                OracleParameter prm63 = new OracleParameter("revenuecenter", OracleType.VarChar);
                prm63.Direction = ParameterDirection.Input;
                prm63.Value = revenuecenter;
                objOraclecommand.Parameters.Add(prm63);

                OracleParameter prm64 = new OracleParameter("billheight", OracleType.VarChar);
                prm64.Direction = ParameterDirection.Input;
                if (billheight == "" || billheight == null)
                {
                    prm64.Value = System.DBNull.Value;
                }
                else
                {
                    prm64.Value = Convert.ToDecimal(billheight);
                }
                objOraclecommand.Parameters.Add(prm64);


                OracleParameter prm65 = new OracleParameter("billwidth", OracleType.VarChar);
                prm65.Direction = ParameterDirection.Input;
                if (billwidth == "" || billwidth == null)
                {
                    prm65.Value = System.DBNull.Value;
                }
                else
                {
                    prm65.Value = Convert.ToDecimal(billwidth);
                }
                objOraclecommand.Parameters.Add(prm65);


                OracleParameter prm66 = new OracleParameter("billto", OracleType.VarChar);
                prm66.Direction = ParameterDirection.Input;
                prm66.Value = billto;
                objOraclecommand.Parameters.Add(prm66);

                OracleParameter prm67 = new OracleParameter("invoices", OracleType.VarChar);
                prm67.Direction = ParameterDirection.Input;
                if (invoices == "" || invoices == null)
                {
                    prm67.Value = System.DBNull.Value;
                }
                else
                {
                    prm67.Value = Convert.ToDecimal(invoices);
                }
                objOraclecommand.Parameters.Add(prm67);


                OracleParameter prm68 = new OracleParameter("vts", OracleType.VarChar);
                prm68.Direction = ParameterDirection.Input;
                if (vts == "" || vts == null || vts == "null")
                {
                    prm68.Value = System.DBNull.Value;
                }
                else
                {
                    prm68.Value = Convert.ToDecimal(vts);
                }
                objOraclecommand.Parameters.Add(prm68);



                OracleParameter prm69 = new OracleParameter("tradedisc", OracleType.VarChar);
                prm69.Direction = ParameterDirection.Input;
                if (tradedisc == "" || tradedisc == null)
                {
                    prm69.Value = System.DBNull.Value;
                }

                else
                {
                    prm69.Value = Convert.ToDecimal(tradedisc);
                }
                objOraclecommand.Parameters.Add(prm69);

                OracleParameter prm70 = new OracleParameter("agencyout", OracleType.VarChar);
                prm70.Direction = ParameterDirection.Input;
                prm70.Value = agencyout;
                objOraclecommand.Parameters.Add(prm70);

                OracleParameter prm71 = new OracleParameter("boxcode", OracleType.VarChar);
                prm71.Direction = ParameterDirection.Input;
                prm71.Value = boxcode;
                objOraclecommand.Parameters.Add(prm71);

                OracleParameter prm72 = new OracleParameter("boxno", OracleType.VarChar);
                prm72.Direction = ParameterDirection.Input;
                prm72.Value = boxno;
                objOraclecommand.Parameters.Add(prm72);

                OracleParameter prm73 = new OracleParameter("boxagency", OracleType.VarChar);
                prm73.Direction = ParameterDirection.Input;
                prm73.Value = boxagency;
                objOraclecommand.Parameters.Add(prm73);

                OracleParameter prm74 = new OracleParameter("boxaddress", OracleType.VarChar);
                prm74.Direction = ParameterDirection.Input;
                prm74.Value = boxaddress;
                objOraclecommand.Parameters.Add(prm74);

                OracleParameter prm75 = new OracleParameter("boxclient", OracleType.VarChar);
                prm75.Direction = ParameterDirection.Input;
                prm75.Value = boxclient;
                objOraclecommand.Parameters.Add(prm75);

                OracleParameter prm76 = new OracleParameter("coupan", OracleType.VarChar);
                prm76.Direction = ParameterDirection.Input;
                prm76.Value = coupan;
                objOraclecommand.Parameters.Add(prm76);

                OracleParameter prm77 = new OracleParameter("bookingtype", OracleType.VarChar);
                prm77.Direction = ParameterDirection.Input;
                prm77.Value = bookingtype;
                objOraclecommand.Parameters.Add(prm77);

                OracleParameter prm78 = new OracleParameter("tfn", OracleType.VarChar);
                prm78.Direction = ParameterDirection.Input;
                prm78.Value = tfn;
                objOraclecommand.Parameters.Add(prm78);

                OracleParameter prm79 = new OracleParameter("campaign", OracleType.VarChar);
                prm79.Direction = ParameterDirection.Input;
                prm79.Value = campaign;
                objOraclecommand.Parameters.Add(prm79);


                OracleParameter prm80 = new OracleParameter("bill_amt", OracleType.VarChar);
                prm80.Direction = ParameterDirection.Input;
                if (bill_amt == "" || bill_amt == null)
                {
                    prm80.Value = System.DBNull.Value;
                }
                else
                {
                    prm80.Value = Convert.ToDecimal(bill_amt);
                }
                objOraclecommand.Parameters.Add(prm80);


                OracleParameter prm81 = new OracleParameter("pageprem", OracleType.VarChar);
                prm81.Direction = ParameterDirection.Input;
                prm81.Value = pageprem;
                objOraclecommand.Parameters.Add(prm81);

                OracleParameter prm82 = new OracleParameter("pageamt", OracleType.VarChar);
                prm82.Direction = ParameterDirection.Input;
                if (pageamt == "" || pageamt == null)
                {
                    prm82.Value = System.DBNull.Value;
                }
                else
                {
                    prm82.Value = Convert.ToDecimal(pageamt);
                }
                objOraclecommand.Parameters.Add(prm82);


                OracleParameter prm83 = new OracleParameter("premper", OracleType.VarChar);
                prm83.Direction = ParameterDirection.Input;
                if (premper == "" || premper == null)
                {
                    prm83.Value = System.DBNull.Value;
                }
                else
                {
                    prm83.Value = Convert.ToDecimal(premper);
                }
                objOraclecommand.Parameters.Add(prm83);


                OracleParameter prm84 = new OracleParameter("grossamt", OracleType.VarChar);
                prm84.Direction = ParameterDirection.Input;
                if (grossamt == "" || grossamt == null)
                {
                    prm84.Value = System.DBNull.Value;
                }
                else
                {
                    prm84.Value = Convert.ToDecimal(grossamt);
                }
                objOraclecommand.Parameters.Add(prm84);



                OracleParameter prm85 = new OracleParameter("adsizcolumn", OracleType.VarChar);
                prm85.Direction = ParameterDirection.Input;
                if (adsizcolumn == "" || adsizcolumn == null)
                {
                    prm85.Value = System.DBNull.Value;
                }
                else
                {
                    prm85.Value = Convert.ToDecimal(adsizcolumn);
                }
                objOraclecommand.Parameters.Add(prm85);

                OracleParameter prm86 = new OracleParameter("billcolumn", OracleType.VarChar);
                prm86.Direction = ParameterDirection.Input;
                if (billcolumn == "" || billcolumn == null)
                {
                    prm86.Value = System.DBNull.Value;
                }
                else
                {
                    prm86.Value = Convert.ToDecimal(billcolumn);
                }
                objOraclecommand.Parameters.Add(prm86);




                OracleParameter prm87 = new OracleParameter("specdiscper", OracleType.VarChar);
                prm87.Direction = ParameterDirection.Input;
                if (specdiscper == "" || specdiscper == null)
                {
                    prm87.Value = System.DBNull.Value;
                }
                else
                {
                    prm87.Value = Convert.ToDecimal(specdiscper);
                }
                objOraclecommand.Parameters.Add(prm87);


                OracleParameter prm88 = new OracleParameter("spacediscper", OracleType.VarChar);
                prm88.Direction = ParameterDirection.Input;
                if (spacediscper == "" || spacediscper == null)
                {
                    prm88.Value = System.DBNull.Value;
                }
                else
                {
                    prm88.Value = Convert.ToDecimal(spacediscper);
                }
                objOraclecommand.Parameters.Add(prm88);

                OracleParameter prm89 = new OracleParameter("billarea", OracleType.VarChar);
                prm89.Direction = ParameterDirection.Input;
                prm89.Value = Convert.ToDecimal(billarea);
                objOraclecommand.Parameters.Add(prm89);


                OracleParameter prm90 = new OracleParameter("paidins", OracleType.VarChar);
                prm90.Direction = ParameterDirection.Input;
                if (paidins == "" || paidins == null)
                {
                    prm90.Value = System.DBNull.Value;
                }
                else
                {
                    prm90.Value = Convert.ToDecimal(paidins);
                }
                objOraclecommand.Parameters.Add(prm90);

                OracleParameter prm91 = new OracleParameter("dealrate", OracleType.VarChar);
                prm91.Direction = ParameterDirection.Input;
                if (dealrate == "" || dealrate == null)
                {
                    prm91.Value = System.DBNull.Value;
                }
                else
                {
                    prm91.Value = Convert.ToDecimal(dealrate);
                }
                prm91.Value = dealrate;
                objOraclecommand.Parameters.Add(prm91);

                OracleParameter prm92 = new OracleParameter("deviation", OracleType.VarChar);
                prm92.Direction = ParameterDirection.Input;
                if (deviation == "" || deviation == null)
                {
                    prm92.Value = System.DBNull.Value;
                }
                else
                {
                    prm92.Value = Convert.ToDecimal(deviation);
                }
                objOraclecommand.Parameters.Add(prm92);

                OracleParameter prm93 = new OracleParameter("varient", OracleType.VarChar);
                prm93.Direction = ParameterDirection.Input;
                prm93.Value = varient;
                objOraclecommand.Parameters.Add(prm93);

                OracleParameter prm94 = new OracleParameter("contractname", OracleType.VarChar);
                prm94.Direction = ParameterDirection.Input;
                prm94.Value = contractname;
                objOraclecommand.Parameters.Add(prm94);

                OracleParameter prm95 = new OracleParameter("dealtype", OracleType.VarChar);
                prm95.Direction = ParameterDirection.Input;
                prm95.Value = dealtype;
                objOraclecommand.Parameters.Add(prm95);

                OracleParameter prm96 = new OracleParameter("cardname", OracleType.VarChar);
                prm96.Direction = ParameterDirection.Input;
                prm96.Value = cardname;
                objOraclecommand.Parameters.Add(prm96);

                OracleParameter prm97 = new OracleParameter("cardtype", OracleType.VarChar);
                prm97.Direction = ParameterDirection.Input;
                prm97.Value = cardtype;
                objOraclecommand.Parameters.Add(prm97);

                OracleParameter prm98 = new OracleParameter("cardmonth", OracleType.VarChar);
                prm98.Direction = ParameterDirection.Input;
                prm98.Value = cardmonth;
                objOraclecommand.Parameters.Add(prm98);

                OracleParameter prm99 = new OracleParameter("cardyear", OracleType.VarChar);
                prm99.Direction = ParameterDirection.Input;
                prm99.Value = cardyear;
                objOraclecommand.Parameters.Add(prm99);

                OracleParameter prm100 = new OracleParameter("cardno", OracleType.VarChar);
                prm100.Direction = ParameterDirection.Input;
                prm100.Value = cardno;
                objOraclecommand.Parameters.Add(prm100);



                OracleParameter prm101 = new OracleParameter("receiptno", OracleType.VarChar);
                prm101.Direction = ParameterDirection.Input;
                prm101.Value = receiptno;
                objOraclecommand.Parameters.Add(prm101);


                OracleParameter prm102 = new OracleParameter("adscat3", OracleType.VarChar);
                prm102.Direction = ParameterDirection.Input;
                prm102.Value = adscat3;
                objOraclecommand.Parameters.Add(prm102);


                OracleParameter prm103 = new OracleParameter("adscat4", OracleType.VarChar);
                prm103.Direction = ParameterDirection.Input;
                prm103.Value = adscat4;
                objOraclecommand.Parameters.Add(prm103);


                OracleParameter prm104 = new OracleParameter("adscat5", OracleType.VarChar);
                prm104.Direction = ParameterDirection.Input;
                prm104.Value = adscat5;
                objOraclecommand.Parameters.Add(prm104);


                OracleParameter prm105 = new OracleParameter("bgcolor", OracleType.VarChar);
                prm105.Direction = ParameterDirection.Input;
                prm105.Value = bgcolor;
                objOraclecommand.Parameters.Add(prm105);


                OracleParameter prm106 = new OracleParameter("bulletcode", OracleType.VarChar);
                prm106.Direction = ParameterDirection.Input;
                prm106.Value = bulletcode;
                objOraclecommand.Parameters.Add(prm106);


                OracleParameter prm107 = new OracleParameter("bulletprm", OracleType.Number);
                prm107.Direction = ParameterDirection.Input;
                if (bulletprm == "" || bulletprm == null)
                {
                    prm107.Value = System.DBNull.Value;
                }
                else
                {
                    bulletprm = bulletprm.Replace("%", "");
                    prm107.Value = Convert.ToDecimal(bulletprm);
                }
                objOraclecommand.Parameters.Add(prm107);


                OracleParameter prm108 = new OracleParameter("material", OracleType.VarChar);
                prm108.Direction = ParameterDirection.Input;
                prm108.Value = material;
                objOraclecommand.Parameters.Add(prm108);


                OracleParameter prm109 = new OracleParameter("receiptdate", OracleType.DateTime);
                prm109.Direction = ParameterDirection.Input;
                if (receiptdate == "" || receiptdate == null)
                {
                    //prm109.Value = System.DBNull.Value;
                    if (date_time == "" || date_time == null)
                    {
                        prm109.Value = System.DBNull.Value;
                    }
                    else
                    {
                        prm109.Value = Convert.ToDateTime(date_time).ToString("dd-MMMM-yyyy");
                    }
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = date_time.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        receiptdate = mm + "/" + dd + "/" + yy;


                    }
                    prm109.Value = Convert.ToDateTime(receiptdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm109);


                OracleParameter prm110 = new OracleParameter("prevcioid", OracleType.VarChar);
                prm110.Direction = ParameterDirection.Input;
                prm110.Value = prevcioid;
                objOraclecommand.Parameters.Add(prm110);


                OracleParameter prm111 = new OracleParameter("prevreceipt", OracleType.VarChar);
                prm111.Direction = ParameterDirection.Input;
                prm111.Value = prevreceipt;
                objOraclecommand.Parameters.Add(prm111);


                OracleParameter prm112 = new OracleParameter("prev_ga", OracleType.Number);
                prm112.Direction = ParameterDirection.Input;
                prm112.Value = Convert.ToDecimal(prev_ga);
                objOraclecommand.Parameters.Add(prm112);


                OracleParameter prm113 = new OracleParameter("varient_name", OracleType.VarChar);
                prm113.Direction = ParameterDirection.Input;
                prm113.Value = varient_name;
                objOraclecommand.Parameters.Add(prm113);


                OracleParameter prm114 = new OracleParameter("region1", OracleType.VarChar);
                prm114.Direction = ParameterDirection.Input;
                prm114.Value = region;
                objOraclecommand.Parameters.Add(prm114);
                /*new change ankur 9 feb*/

                OracleParameter prm115 = new OracleParameter("coltype", OracleType.VarChar);
                prm115.Direction = ParameterDirection.Input;
                prm115.Value = coltype;
                objOraclecommand.Parameters.Add(prm115);

                OracleParameter prm116 = new OracleParameter("logo_h", OracleType.VarChar);
                prm116.Direction = ParameterDirection.Input;
                prm116.Value = logo_h;
                objOraclecommand.Parameters.Add(prm116);

                OracleParameter prm117 = new OracleParameter("logo_w", OracleType.VarChar);
                prm117.Direction = ParameterDirection.Input;
                prm117.Value = logo_w;
                objOraclecommand.Parameters.Add(prm117);

                OracleParameter prm118 = new OracleParameter("logo_col", OracleType.VarChar);
                prm118.Direction = ParameterDirection.Input;
                prm118.Value = logo_col;
                objOraclecommand.Parameters.Add(prm118);

                OracleParameter prm119 = new OracleParameter("logo_uom", OracleType.VarChar);
                prm119.Direction = ParameterDirection.Input;
                prm119.Value = logo_uom;
                objOraclecommand.Parameters.Add(prm119);

                OracleParameter prm120 = new OracleParameter("retainer1", OracleType.VarChar);
                prm120.Direction = ParameterDirection.Input;
                if (retainer.LastIndexOf("(") >= 0)
                {
                    retainer = retainer.Substring(retainer.LastIndexOf("(") + 1, retainer.Length - retainer.LastIndexOf("(") - 2);
                }
                prm120.Value = retainer;
                objOraclecommand.Parameters.Add(prm120);

                OracleParameter prm121 = new OracleParameter("addagencyrate", OracleType.VarChar);
                prm121.Direction = ParameterDirection.Input;
                prm121.Value = addagencyrate;
                objOraclecommand.Parameters.Add(prm121);

                OracleParameter prm122 = new OracleParameter("mobileno", OracleType.VarChar);
                prm122.Direction = ParameterDirection.Input;
                prm122.Value = mobileno;
                objOraclecommand.Parameters.Add(prm122);

                OracleParameter prm123 = new OracleParameter("addlamt", OracleType.VarChar);
                prm123.Direction = ParameterDirection.Input;
                prm123.Value = addlamt;
                objOraclecommand.Parameters.Add(prm123);

                OracleParameter prm124 = new OracleParameter("retamt", OracleType.VarChar);
                prm124.Direction = ParameterDirection.Input;
                prm124.Value = retamt;
                objOraclecommand.Parameters.Add(prm124);

                OracleParameter prm125 = new OracleParameter("retper", OracleType.VarChar);
                prm125.Direction = ParameterDirection.Input;
                prm125.Value = retper;
                objOraclecommand.Parameters.Add(prm125);


                OracleParameter prm126 = new OracleParameter("cashrecieved", OracleType.VarChar);
                prm126.Direction = ParameterDirection.Input;
                if (cashrecieved == "" || cashrecieved == null)
                {
                    prm126.Value = System.DBNull.Value;
                }
                else
                {
                    prm126.Value = Convert.ToDecimal(cashrecieved);
                }
                objOraclecommand.Parameters.Add(prm126);

                OracleParameter prm127 = new OracleParameter("CIRAGENCY_V", OracleType.VarChar);
                prm127.Direction = ParameterDirection.Input;
                prm127.Value = ciragency;
                objOraclecommand.Parameters.Add(prm127);

                OracleParameter prm128 = new OracleParameter("CIRRATE_V", OracleType.VarChar);
                prm128.Direction = ParameterDirection.Input;
                prm128.Value = cirrate;
                objOraclecommand.Parameters.Add(prm128);

                OracleParameter prm129 = new OracleParameter("CIREDITION_V", OracleType.VarChar);
                prm129.Direction = ParameterDirection.Input;
                prm129.Value = ciredition;
                objOraclecommand.Parameters.Add(prm129);

                OracleParameter prm130 = new OracleParameter("CIRPUBLICATION_V", OracleType.VarChar);
                prm130.Direction = ParameterDirection.Input;
                prm130.Value = cirpublication;
                objOraclecommand.Parameters.Add(prm130);

                OracleParameter prm131 = new OracleParameter("CIRAGENCYSUBCODE_V", OracleType.VarChar);
                prm131.Direction = ParameterDirection.Input;
                prm131.Value = ciragencysubcode;
                objOraclecommand.Parameters.Add(prm131);

                OracleParameter prm132 = new OracleParameter("BARTERTYPE", OracleType.VarChar);
                prm132.Direction = ParameterDirection.Input;
                prm132.Value = bartertype;
                objOraclecommand.Parameters.Add(prm132);

                OracleParameter prm133 = new OracleParameter("CASHDISCOUNT_V", OracleType.VarChar);
                prm133.Direction = ParameterDirection.Input;
                if (cashdiscount == "")
                    prm133.Value = System.DBNull.Value;
                else
                    prm133.Value = cashdiscount;
                objOraclecommand.Parameters.Add(prm133);

                OracleParameter prm134 = new OracleParameter("CASHDISCOUNTPER_V", OracleType.VarChar);
                prm134.Direction = ParameterDirection.Input;
                prm134.Value = cashdiscountper;
                objOraclecommand.Parameters.Add(prm134);

                OracleParameter prm135 = new OracleParameter("attach1", OracleType.VarChar);
                prm135.Direction = ParameterDirection.Input;
                prm135.Value = attach1;
                objOraclecommand.Parameters.Add(prm135);

                OracleParameter prm136 = new OracleParameter("attach2", OracleType.VarChar);
                prm136.Direction = ParameterDirection.Input;
                prm136.Value = attach2;
                objOraclecommand.Parameters.Add(prm136);

                OracleParameter prm137 = new OracleParameter("drpdiscprem", OracleType.VarChar);
                prm137.Direction = ParameterDirection.Input;
                prm137.Value = drpdiscprem;
                objOraclecommand.Parameters.Add(prm137);

                OracleParameter prm138 = new OracleParameter("doctype_v", OracleType.VarChar);
                prm138.Direction = ParameterDirection.Input;
                prm138.Value = doctype;
                objOraclecommand.Parameters.Add(prm138);

                OracleParameter prm139 = new OracleParameter("CHKTRADE", OracleType.VarChar);
                prm139.Direction = ParameterDirection.Input;
                prm139.Value = chktradeval;
                objOraclecommand.Parameters.Add(prm139);
                OracleParameter prm140 = new OracleParameter("sharepub_p", OracleType.VarChar);
                prm140.Direction = ParameterDirection.Input;
                prm140.Value = sharepub;
                objOraclecommand.Parameters.Add(prm140);

                OracleParameter prm141 = new OracleParameter("fmginsert", OracleType.VarChar);
                prm141.Direction = ParameterDirection.Input;
                prm141.Value = fmginsert;
                objOraclecommand.Parameters.Add(prm141);

                OracleParameter prm142 = new OracleParameter("chkno", OracleType.VarChar);
                prm142.Direction = ParameterDirection.Input;
                prm142.Value = chkno;
                objOraclecommand.Parameters.Add(prm142);

                OracleParameter prm143 = new OracleParameter("chkdate", OracleType.DateTime);
                prm143.Direction = ParameterDirection.Input;
                if (chkdate == "" || chkdate == null)
                {
                    prm143.Value = System.DBNull.Value;

                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = chkdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        chkdate = mm + "/" + dd + "/" + yy;


                    }
                    prm143.Value = Convert.ToDateTime(chkdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm143);

                OracleParameter prm144 = new OracleParameter("chkamt", OracleType.VarChar);
                prm144.Direction = ParameterDirection.Input;
                prm144.Value = chkamt;
                objOraclecommand.Parameters.Add(prm144);
                OracleParameter prm145 = new OracleParameter("chkbankname", OracleType.VarChar);
                prm145.Direction = ParameterDirection.Input;
                prm145.Value = chkbankname;
                objOraclecommand.Parameters.Add(prm145);

                OracleParameter prm146 = new OracleParameter("ourbank", OracleType.VarChar);
                prm146.Direction = ParameterDirection.Input;
                prm146.Value = ourbank;
                objOraclecommand.Parameters.Add(prm146);

                OracleParameter prm147 = new OracleParameter("DEALERPANEL_P", OracleType.VarChar);
                prm147.Direction = ParameterDirection.Input;
                if (dealerpanel == "")
                    prm147.Value = System.DBNull.Value;
                else
                    prm147.Value = dealerpanel;
                objOraclecommand.Parameters.Add(prm147);

                OracleParameter prm148 = new OracleParameter("DEALERH_P", OracleType.VarChar);
                prm148.Direction = ParameterDirection.Input;
                if (dealerh == "")
                    prm148.Value = System.DBNull.Value;
                else
                    prm148.Value = dealerh;
                objOraclecommand.Parameters.Add(prm148);

                OracleParameter prm149 = new OracleParameter("DEALERW_P", OracleType.VarChar);
                prm149.Direction = ParameterDirection.Input;
                if (dealerw == "")
                    prm149.Value = System.DBNull.Value;
                else
                    prm149.Value = dealerw;
                objOraclecommand.Parameters.Add(prm149);

                OracleParameter prm150 = new OracleParameter("DEALERTYPE_P", OracleType.VarChar);
                prm150.Direction = ParameterDirection.Input;
                if (dealertype == "")
                    prm150.Value = System.DBNull.Value;
                else
                    prm150.Value = dealertype;
                objOraclecommand.Parameters.Add(prm150);

                OracleParameter prm151 = new OracleParameter("multiselect", OracleType.VarChar);
                prm151.Direction = ParameterDirection.Input;
                if (multiselect == "")
                    prm151.Value = System.DBNull.Value;
                else
                    prm151.Value = multiselect;

                objOraclecommand.Parameters.Add(prm151);

                OracleParameter prm152 = new OracleParameter("AGREEDRATE_ACTIVE", OracleType.VarChar);
                prm152.Direction = ParameterDirection.Input;
                if (agreedrate_active == "")
                    prm152.Value = System.DBNull.Value;
                else
                    prm152.Value = agreedrate_active;

                objOraclecommand.Parameters.Add(prm152);

                OracleParameter prm153 = new OracleParameter("AGREEDAMT_ACTIVE", OracleType.VarChar);
                prm153.Direction = ParameterDirection.Input;
                if (agreedamt_active == "")
                    prm153.Value = System.DBNull.Value;
                else
                    prm153.Value = agreedamt_active;

                objOraclecommand.Parameters.Add(prm153);

                OracleParameter prm154 = new OracleParameter("grossamtlocal_p", OracleType.VarChar);
                prm154.Direction = ParameterDirection.Input;
                if (grossamtlocal_p == "")
                    prm154.Value = System.DBNull.Value;
                else
                    prm154.Value = grossamtlocal_p;

                objOraclecommand.Parameters.Add(prm154);

                OracleParameter prm153a = new OracleParameter("billamtlocal_p", OracleType.VarChar);
                prm153a.Direction = ParameterDirection.Input;
                if (billamtlocal_p == "")
                    prm153a.Value = System.DBNull.Value;
                else
                    prm153a.Value = billamtlocal_p;

                objOraclecommand.Parameters.Add(prm153a);



                OracleParameter prm145a = new OracleParameter("chkadon_p", OracleType.VarChar);
                prm145a.Direction = ParameterDirection.Input;
                prm145a.Value = chkadon;
                objOraclecommand.Parameters.Add(prm145a);

                OracleParameter prm145b = new OracleParameter("refid_p", OracleType.VarChar);
                prm145b.Direction = ParameterDirection.Input;
                prm145b.Value = refid;
                objOraclecommand.Parameters.Add(prm145b);

                OracleParameter prm145c = new OracleParameter("rcpt_currency", OracleType.VarChar);
                prm145c.Direction = ParameterDirection.Input;
                prm145c.Value = rcpt_currency;
                objOraclecommand.Parameters.Add(prm145c);

                OracleParameter prm145d = new OracleParameter("cur_convrate", OracleType.VarChar);
                prm145d.Direction = ParameterDirection.Input;
                prm145d.Value = cur_convrate;
                objOraclecommand.Parameters.Add(prm145d);

                OracleParameter prm145e = new OracleParameter("p_revisedate", OracleType.VarChar);
                prm145e.Direction = ParameterDirection.Input;
                if (revisedate == "" || revisedate == null)
                {
                    prm145e.Value = System.DBNull.Value;

                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = revisedate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        revisedate = mm + "/" + dd + "/" + yy;


                    }
                    prm145e.Value = Convert.ToDateTime(revisedate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm145e);

                OracleParameter prm153d = new OracleParameter("clienttype", OracleType.VarChar);
                prm153d.Direction = ParameterDirection.Input;
                if (clienttype == "0")
                    prm153d.Value = System.DBNull.Value;
                else
                    prm153d.Value = clienttype;
                objOraclecommand.Parameters.Add(prm153d);

                OracleParameter prm153e = new OracleParameter("translation", OracleType.VarChar);
                prm153e.Direction = ParameterDirection.Input;
                if (translation == "0")
                    prm153e.Value = System.DBNull.Value;
                else
                    prm153e.Value = translation;
                objOraclecommand.Parameters.Add(prm153e);


                OracleParameter prm107a = new OracleParameter("translationcharge", OracleType.Number);
                prm107a.Direction = ParameterDirection.Input;
                if (translationcharge == "" || translationcharge == null)
                {
                    prm107a.Value = System.DBNull.Value;
                }
                else
                {
                    translationcharge = translationcharge.Replace("%", "");
                    prm107a.Value = Convert.ToDecimal(translationcharge);
                }
                objOraclecommand.Parameters.Add(prm107a);

                OracleParameter prm141a = new OracleParameter("fmgreasons", OracleType.VarChar);
                prm141a.Direction = ParameterDirection.Input;
                prm141a.Value = fmgreasons;
                objOraclecommand.Parameters.Add(prm141a);

                OracleParameter prm141b = new OracleParameter("canclecharge", OracleType.VarChar);
                prm141b.Direction = ParameterDirection.Input;
                prm141b.Value = canclecharge;
                objOraclecommand.Parameters.Add(prm141b);

                OracleParameter prm161bt = new OracleParameter("transdisc_p", OracleType.VarChar);
                prm161bt.Direction = ParameterDirection.Input;
                prm161bt.Value = transdisc;
                objOraclecommand.Parameters.Add(prm161bt);

                OracleParameter prm161bs = new OracleParameter("pospremdisc_p", OracleType.VarChar);
                prm161bs.Direction = ParameterDirection.Input;
                prm161bs.Value = pospremdisc;
                objOraclecommand.Parameters.Add(prm161bs);

                OracleParameter prm161b1 = new OracleParameter("billhold", OracleType.VarChar);
                prm161b1.Direction = ParameterDirection.Input;
                prm161b1.Value = billhold;
                objOraclecommand.Parameters.Add(prm161b1);


                objOraclecommand.Parameters.Add("p_error", OracleType.VarChar, 200);
                objOraclecommand.Parameters["p_error"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                //objOraclecommand.ExecuteNonQuery();
                string output = objOraclecommand.Parameters["p_error"].Value.ToString();

                return output;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        /****************************************************************************************************************/

        public DataSet insertCashReceived(string ciobookid, string receiptno, string drpcashrecieved)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("insertintocashreceiveddetail", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm2 = new OracleParameter("ciobookid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = ciobookid;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("receiptno", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = receiptno;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("drpcashrecieved", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                if (drpcashrecieved == "" || drpcashrecieved == null)
                {
                    prm4.Value = System.DBNull.Value;
                }
                else
                {
                    prm4.Value = Convert.ToDecimal(drpcashrecieved);
                }
                objOraclecommand.Parameters.Add(prm4);

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        /**************************************************************************************/

        public DataSet updatebooking(string adsizetype, string branch, string booked_by, string prevbook, string date_time, string ciobookid, string approvedby, string audit, string rono, string rodate, string caption, string billstatus, string rostatus, string agency, string client, string agencyaddress, string clientaddresses, string agencycode, string dockitno, string execname, string execzone, string product, string brand, string keyno, string billremark, string printremark, string package, string insertion, string startdate, string repeatdate, string adtype, string adcategory, string subcategory, string color, string uom, string pageposition, string pagetype, string pageno, string adsizheight, string adsizwidth, string ratecode, string scheme, string currency, string agreedrate, string agreedamt, string spedisc, string spacedisx, string compcode, string userid, string specialcharges, string agencytype, string agencystatus, string paymode, string agencredit, string cardrate, string cardamount, string discount, string discountper, string billaddress, string totarea, string billcycle, string revenuecenter, string billpay, string billheight, string billwidth, string billto, string invoices, string vts, string tradedisc, string agencyout, string boxcode, string boxno, string boxaddress, string boxagency, string boxclient, string bookingtype, string tfn, string coupan, string campaign, string bill_amt, string pageprem, string pageamt, string premper, string grossamt, string adsizcolumn, string billcolumn, Decimal billarea, string specdiscper, string spacediscper, string paidins, string dealrate, string deviation, string varient, string contractname, string dealtype, string cardname, string cardtype, string cardmonth, string cardyear, string cardno, string receiptno, string adscat3, string adscat4, string adscat5, string bgcolor, string bulletcode, string bulletprm, string material, string region, string varient_name, string coltype, string logo_h, string logo_w, string logo_col, string logo_uom, string status, string dateformat, string retainer, string addagencyrate, string mobileno, string addlamt, string retamt, string retper, string cashrecieved, string doctype, string chktradeval, string sharepub, string fmginsert, string chkno, string chkdate, string chkamt, string chkbankname, string ourbank, string dealerpanel, string dealerh, string dealerw, string dealertype, string multicode, string agreedrate_active, string agreedamt_active, string grossamtlocal_p, string billamtlocal_p, string attach1, string fmgreasons, string canclecharge, string modifyrateaudit, string ip, string transdisc, string pospremdisc, string billhold, string designbox, string logoprem, string online_ad, string style, string cou_code, string cou_name, string state, string clientcatdisc, string clientcatamt, string clientcatdistype, string flatfreqdisc, string flatfreqamt, string flatfreqdisctype, string catdisc, string catamt, string catdisctype, string cashdiscount, string cashdiscountper)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("updatebooking.updatebooking_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;
                OracleParameter prm6 = new OracleParameter("approvedby", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = approvedby;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm8 = new OracleParameter("audit1", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = audit;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("rono", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = rono;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("rodate", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;

                if (rodate == "" || rodate == null)
                {
                    prm10.Value = System.DBNull.Value;
                }
                else
                {


                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = rodate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        rodate = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = rodate.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        rodate = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = rodate.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            rodate = mm + "/" + dd + "/" + yy;
                    //        }
                    prm10.Value = Convert.ToDateTime(rodate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("caption", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = caption;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm12 = new OracleParameter("billstatus", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = billstatus;
                objOraclecommand.Parameters.Add(prm12);

                OracleParameter prm13 = new OracleParameter("rostatus", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = rostatus;
                objOraclecommand.Parameters.Add(prm13);

                OracleParameter prm14 = new OracleParameter("agency", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = agency;
                objOraclecommand.Parameters.Add(prm14);

                OracleParameter prm15 = new OracleParameter("client", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = client;
                objOraclecommand.Parameters.Add(prm15);

                OracleParameter prm16 = new OracleParameter("agencyaddress", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = agencyaddress;
                objOraclecommand.Parameters.Add(prm16);

                OracleParameter prm17 = new OracleParameter("clientaddresses", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = clientaddresses;
                objOraclecommand.Parameters.Add(prm17);


                OracleParameter prm18 = new OracleParameter("agencycode", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;
                prm18.Value = agencycode;
                objOraclecommand.Parameters.Add(prm18);

                OracleParameter prm19 = new OracleParameter("dockitno", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                prm19.Value = dockitno;
                objOraclecommand.Parameters.Add(prm19);

                OracleParameter prm20 = new OracleParameter("execname", OracleType.VarChar);
                prm20.Direction = ParameterDirection.Input;
                prm20.Value = execname;
                objOraclecommand.Parameters.Add(prm20);

                OracleParameter prm21 = new OracleParameter("execzone", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = execzone;
                objOraclecommand.Parameters.Add(prm21);

                OracleParameter prm22 = new OracleParameter("product", OracleType.VarChar);
                prm22.Direction = ParameterDirection.Input;
                prm22.Value = product;
                objOraclecommand.Parameters.Add(prm22);



                OracleParameter prm23 = new OracleParameter("brand", OracleType.VarChar);
                prm23.Direction = ParameterDirection.Input;
                prm23.Value = brand;
                objOraclecommand.Parameters.Add(prm23);

                OracleParameter prm24 = new OracleParameter("keyno", OracleType.VarChar);
                prm24.Direction = ParameterDirection.Input;
                prm24.Value = keyno;
                objOraclecommand.Parameters.Add(prm24);

                OracleParameter prm25 = new OracleParameter("billremark", OracleType.VarChar);
                prm25.Direction = ParameterDirection.Input;
                prm25.Value = billremark;
                objOraclecommand.Parameters.Add(prm25);

                OracleParameter prm26 = new OracleParameter("printremark", OracleType.VarChar);
                prm26.Direction = ParameterDirection.Input;
                prm26.Value = printremark;
                objOraclecommand.Parameters.Add(prm26);

                OracleParameter prm27 = new OracleParameter("package1", OracleType.VarChar);
                prm27.Direction = ParameterDirection.Input;
                prm27.Value = package;
                objOraclecommand.Parameters.Add(prm27);

                OracleParameter prm28 = new OracleParameter("insertion", OracleType.VarChar);
                prm28.Direction = ParameterDirection.Input;
                if (insertion == "")
                {
                    prm28.Value = System.DBNull.Value;
                }
                else
                {
                    prm28.Value = Convert.ToDecimal(insertion);
                }
                objOraclecommand.Parameters.Add(prm28);


                OracleParameter prm29 = new OracleParameter("startdate", OracleType.VarChar);
                prm29.Direction = ParameterDirection.Input;

                if (startdate == "" || startdate == null)
                {
                    prm29.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = startdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        startdate = mm + "/" + dd + "/" + yy;
                    }

                    prm29.Value = Convert.ToDateTime(startdate).ToString("dd-MMMM-yyyy");
                }
                //if (dateformat == "dd/mm/yyyy")
                //{
                //    string[] arr = startdate.Split('/');
                //    string dd = arr[0];
                //    string mm = arr[1];
                //    string yy = arr[2];
                //    startdate = mm + "/" + dd + "/" + yy;


                //}
                //else
                //    if (dateformat == "mm/dd/yyyy")
                //    {
                //        string[] arr = startdate.Split('/');
                //        string dd = arr[1];
                //        string mm = arr[0];
                //        string yy = arr[2];
                //        startdate = mm + "/" + dd + "/" + yy;

                //    }

                //    else
                //        if (dateformat == "yyyy/mm/dd")
                //        {
                //            string[] arr = startdate.Split('/');
                //            string dd = arr[2];
                //            string mm = arr[1];
                //            string yy = arr[0];
                //            startdate = mm + "/" + dd + "/" + yy;
                //        }

                objOraclecommand.Parameters.Add(prm29);

                OracleParameter prm30 = new OracleParameter("repeatdate", OracleType.VarChar);
                prm30.Direction = ParameterDirection.Input;
                prm30.Value = repeatdate;
                objOraclecommand.Parameters.Add(prm30);

                OracleParameter prm31 = new OracleParameter("adtype1", OracleType.VarChar);
                prm31.Direction = ParameterDirection.Input;
                prm31.Value = adtype;
                objOraclecommand.Parameters.Add(prm31);

                OracleParameter prm32 = new OracleParameter("adcategory", OracleType.VarChar);
                prm32.Direction = ParameterDirection.Input;
                prm32.Value = adcategory;
                objOraclecommand.Parameters.Add(prm32);

                OracleParameter prm33 = new OracleParameter("subcategory", OracleType.VarChar);
                prm33.Direction = ParameterDirection.Input;
                prm33.Value = subcategory;
                objOraclecommand.Parameters.Add(prm33);

                OracleParameter prm34 = new OracleParameter("color", OracleType.VarChar);
                prm34.Direction = ParameterDirection.Input;
                prm34.Value = color;
                objOraclecommand.Parameters.Add(prm34);

                OracleParameter prm35 = new OracleParameter("uom", OracleType.VarChar);
                prm35.Direction = ParameterDirection.Input;
                prm35.Value = uom;
                objOraclecommand.Parameters.Add(prm35);

                OracleParameter prm36 = new OracleParameter("pageposition", OracleType.VarChar);
                prm36.Direction = ParameterDirection.Input;
                prm36.Value = pageposition;
                objOraclecommand.Parameters.Add(prm36);

                OracleParameter prm37 = new OracleParameter("pagetype1", OracleType.VarChar);
                prm37.Direction = ParameterDirection.Input;
                prm37.Value = pagetype;
                objOraclecommand.Parameters.Add(prm37);

                OracleParameter prm38 = new OracleParameter("pageno", OracleType.VarChar);
                prm38.Direction = ParameterDirection.Input;
                if (pageno == "" || pageno == null)
                {
                    prm38.Value = System.DBNull.Value;

                }
                else
                {
                    prm38.Value = Convert.ToDecimal(pageno);
                }
                objOraclecommand.Parameters.Add(prm38);



                OracleParameter prm39 = new OracleParameter("adsizheight", OracleType.VarChar);
                prm39.Direction = ParameterDirection.Input;
                if (adsizheight == "" || adsizheight == null)
                {
                    prm39.Value = System.DBNull.Value;
                }
                else
                {
                    prm39.Value = Convert.ToDecimal(adsizheight);
                }
                objOraclecommand.Parameters.Add(prm39);


                OracleParameter prm40 = new OracleParameter("adsizwidth", OracleType.VarChar);
                prm40.Direction = ParameterDirection.Input;
                if (adsizwidth == "" || adsizwidth == null)
                {
                    prm40.Value = System.DBNull.Value;
                }
                else
                {
                    prm40.Value = Convert.ToDecimal(adsizwidth);
                }
                objOraclecommand.Parameters.Add(prm40);

                OracleParameter prm43 = new OracleParameter("ratecode11", OracleType.VarChar);
                prm43.Direction = ParameterDirection.Input;
                prm43.Value = ratecode;
                objOraclecommand.Parameters.Add(prm43);

                OracleParameter prm41 = new OracleParameter("scheme1", OracleType.VarChar);
                prm41.Direction = ParameterDirection.Input;
                prm41.Value = scheme;
                objOraclecommand.Parameters.Add(prm41);

                OracleParameter prm42 = new OracleParameter("currency", OracleType.VarChar);
                prm42.Direction = ParameterDirection.Input;
                prm42.Value = currency;
                objOraclecommand.Parameters.Add(prm42);



                OracleParameter prm44 = new OracleParameter("agreedrate", OracleType.VarChar);
                prm44.Direction = ParameterDirection.Input;
                if (agreedrate == "" || agreedrate == null)
                {
                    prm44.Value = System.DBNull.Value;
                }
                else
                {
                    prm44.Value = Convert.ToDecimal(agreedrate);
                }
                objOraclecommand.Parameters.Add(prm44);


                OracleParameter prm45 = new OracleParameter("agreedamt", OracleType.VarChar);
                prm45.Direction = ParameterDirection.Input;
                if (agreedamt == "" || agreedamt == null)
                {
                    prm45.Value = System.DBNull.Value;
                }
                else
                {
                    prm45.Value = Convert.ToDecimal(agreedamt);
                }
                objOraclecommand.Parameters.Add(prm45);


                OracleParameter prm46 = new OracleParameter("spedisc", OracleType.VarChar);
                prm46.Direction = ParameterDirection.Input;
                if (spedisc == "" || spedisc == null)
                {
                    prm46.Value = System.DBNull.Value;
                }
                else
                {
                    prm46.Value = Convert.ToDecimal(spedisc);
                }
                objOraclecommand.Parameters.Add(prm46);
                OracleParameter prm48 = new OracleParameter("spacedisx", OracleType.VarChar);
                prm48.Direction = ParameterDirection.Input;
                if (spacedisx == "" || spacedisx == null)
                {
                    prm48.Value = System.DBNull.Value;
                }
                else
                {
                    prm48.Value = Convert.ToDecimal(spacedisx);
                }
                objOraclecommand.Parameters.Add(prm48);

                OracleParameter prm47 = new OracleParameter("compcode", OracleType.VarChar);
                prm47.Direction = ParameterDirection.Input;
                prm47.Value = compcode;
                objOraclecommand.Parameters.Add(prm47);
                OracleParameter prm50 = new OracleParameter("userid", OracleType.VarChar);
                prm50.Direction = ParameterDirection.Input;
                prm50.Value = userid;
                objOraclecommand.Parameters.Add(prm50);


                OracleParameter prm7 = new OracleParameter("ciobookid", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = ciobookid;
                objOraclecommand.Parameters.Add(prm7);


                OracleParameter prm1 = new OracleParameter("date_time", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                if (date_time == "" || date_time == null)
                {
                    prm1.Value = System.DBNull.Value;


                }

                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = date_time.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        date_time = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = date_time.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        date_time = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = date_time.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            date_time = mm + "/" + dd + "/" + yy;
                    //        }
                    //if (dateformat == "dd/mm/yyyy")
                    //{
                    //    prm1.Value = date_time;
                    //}
                    //else
                    //{
                    prm1.Value = Convert.ToDateTime(date_time).ToString("dd-MMMM-yyyy");
                    // }
                }
                objOraclecommand.Parameters.Add(prm1);



                OracleParameter prm3 = new OracleParameter("branch", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = branch;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("booked_by", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = booked_by;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("prevbook", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = prevbook;
                objOraclecommand.Parameters.Add(prm5);



                OracleParameter prm2 = new OracleParameter("adsizetype", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = adsizetype;
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm49 = new OracleParameter("specialcharges", OracleType.VarChar);
                prm49.Direction = ParameterDirection.Input;
                if (specialcharges == "" || specialcharges == null)
                {
                    prm49.Value = System.DBNull.Value;
                }
                else
                {
                    prm49.Value = Convert.ToDecimal(specialcharges);
                }
                objOraclecommand.Parameters.Add(prm49);




                OracleParameter prm51 = new OracleParameter("agencytype", OracleType.VarChar);
                prm51.Direction = ParameterDirection.Input;
                prm51.Value = agencytype;
                objOraclecommand.Parameters.Add(prm51);

                OracleParameter prm52 = new OracleParameter("agencystatus", OracleType.VarChar);
                prm52.Direction = ParameterDirection.Input;
                prm52.Value = agencystatus;
                objOraclecommand.Parameters.Add(prm52);

                OracleParameter prm53 = new OracleParameter("paymode", OracleType.VarChar);
                prm53.Direction = ParameterDirection.Input;
                prm53.Value = paymode;
                objOraclecommand.Parameters.Add(prm53);

                OracleParameter prm54 = new OracleParameter("agencredit", OracleType.VarChar);
                prm54.Direction = ParameterDirection.Input;
                if (agencredit == "" || agencredit == null)
                {
                    prm54.Value = System.DBNull.Value;
                }
                else
                {
                    prm54.Value = Convert.ToInt32(agencredit);
                }
                objOraclecommand.Parameters.Add(prm54);


                OracleParameter prm55 = new OracleParameter("cardrate", OracleType.VarChar);
                prm55.Direction = ParameterDirection.Input;
                if (cardrate == "" || cardrate == null)
                {
                    prm55.Value = System.DBNull.Value;
                }
                else
                {
                    prm55.Value = Convert.ToDecimal(cardrate);
                }
                objOraclecommand.Parameters.Add(prm55);


                OracleParameter prm56 = new OracleParameter("cardamount", OracleType.VarChar);
                prm56.Direction = ParameterDirection.Input;
                if (cardamount == "" || cardamount == null)
                {
                    prm56.Value = System.DBNull.Value;
                }
                else
                {
                    prm56.Value = Convert.ToDecimal(cardamount);
                }
                objOraclecommand.Parameters.Add(prm56);

                OracleParameter prm57 = new OracleParameter("discount", OracleType.VarChar);
                prm57.Direction = ParameterDirection.Input;
                if (discount == "" || discount == null)
                {
                    prm57.Value = System.DBNull.Value;
                }
                else
                {
                    prm57.Value = Convert.ToDecimal(discount);
                }
                objOraclecommand.Parameters.Add(prm57);


                OracleParameter prm58 = new OracleParameter("discountper", OracleType.VarChar);
                prm58.Direction = ParameterDirection.Input;
                if (discountper == "" || discountper == null)
                {
                    prm58.Value = System.DBNull.Value;
                }
                else
                {
                    prm58.Value = Convert.ToDecimal(discountper);
                }
                objOraclecommand.Parameters.Add(prm58);


                OracleParameter prm59 = new OracleParameter("billaddress", OracleType.VarChar);
                prm59.Direction = ParameterDirection.Input;
                prm59.Value = billaddress;
                objOraclecommand.Parameters.Add(prm59);

                OracleParameter prm60 = new OracleParameter("totarea", OracleType.VarChar);
                prm60.Direction = ParameterDirection.Input;
                if (totarea == "" || totarea == null)
                {
                    prm60.Value = System.DBNull.Value;
                }
                else
                {
                    prm60.Value = Convert.ToDecimal(totarea);
                }
                objOraclecommand.Parameters.Add(prm60);


                OracleParameter prm61 = new OracleParameter("billcycle", OracleType.VarChar);
                prm61.Direction = ParameterDirection.Input;
                prm61.Value = billcycle;
                objOraclecommand.Parameters.Add(prm61);

                OracleParameter prm63 = new OracleParameter("revenuecenter", OracleType.VarChar);
                prm63.Direction = ParameterDirection.Input;
                prm63.Value = revenuecenter;
                objOraclecommand.Parameters.Add(prm63);

                OracleParameter prm62 = new OracleParameter("billpay", OracleType.VarChar);
                prm62.Direction = ParameterDirection.Input;
                prm62.Value = billpay;
                objOraclecommand.Parameters.Add(prm62);



                OracleParameter prm64 = new OracleParameter("billheight", OracleType.VarChar);
                prm64.Direction = ParameterDirection.Input;
                if (billheight == "" || billheight == null)
                {
                    prm64.Value = System.DBNull.Value;
                }
                else
                {
                    prm64.Value = Convert.ToDecimal(billheight);
                }
                objOraclecommand.Parameters.Add(prm64);


                OracleParameter prm65 = new OracleParameter("billwidth", OracleType.VarChar);
                prm65.Direction = ParameterDirection.Input;
                if (billwidth == "" || billwidth == null)
                {
                    prm65.Value = System.DBNull.Value;
                }
                else
                {
                    prm65.Value = Convert.ToDecimal(billwidth);
                }
                objOraclecommand.Parameters.Add(prm65);


                OracleParameter prm66 = new OracleParameter("billto", OracleType.VarChar);
                prm66.Direction = ParameterDirection.Input;
                prm66.Value = billto;
                objOraclecommand.Parameters.Add(prm66);

                OracleParameter prm67 = new OracleParameter("invoices", OracleType.VarChar);
                prm67.Direction = ParameterDirection.Input;
                if (invoices == "" || invoices == null)
                {
                    prm67.Value = System.DBNull.Value;
                }
                else
                {
                    prm67.Value = Convert.ToDecimal(invoices);
                }
                objOraclecommand.Parameters.Add(prm67);


                OracleParameter prm68 = new OracleParameter("vts", OracleType.VarChar);
                prm68.Direction = ParameterDirection.Input;
                if (vts == "" || vts == null || vts == "null")
                {
                    prm68.Value = System.DBNull.Value;
                }
                else
                {
                    prm68.Value = Convert.ToDecimal(vts);
                }
                objOraclecommand.Parameters.Add(prm68);



                OracleParameter prm69 = new OracleParameter("tradedisc", OracleType.VarChar);
                prm69.Direction = ParameterDirection.Input;
                if (tradedisc == "" || tradedisc == null)
                    prm69.Value = System.DBNull.Value;
                else
                    prm69.Value = Convert.ToDecimal(tradedisc);
                objOraclecommand.Parameters.Add(prm69);

                OracleParameter prm70 = new OracleParameter("agencyout", OracleType.VarChar);
                prm70.Direction = ParameterDirection.Input;
                prm70.Value = agencyout;
                objOraclecommand.Parameters.Add(prm70);

                OracleParameter prm71 = new OracleParameter("boxcode", OracleType.VarChar);
                prm71.Direction = ParameterDirection.Input;
                prm71.Value = boxcode;
                objOraclecommand.Parameters.Add(prm71);

                OracleParameter prm72 = new OracleParameter("boxno", OracleType.VarChar);
                prm72.Direction = ParameterDirection.Input;
                prm72.Value = boxno;
                objOraclecommand.Parameters.Add(prm72);


                OracleParameter prm74 = new OracleParameter("boxaddress", OracleType.VarChar);
                prm74.Direction = ParameterDirection.Input;
                prm74.Value = boxaddress;
                objOraclecommand.Parameters.Add(prm74);

                OracleParameter prm73 = new OracleParameter("boxagency", OracleType.VarChar);
                prm73.Direction = ParameterDirection.Input;
                prm73.Value = boxagency;
                objOraclecommand.Parameters.Add(prm73);


                OracleParameter prm75 = new OracleParameter("boxclient", OracleType.VarChar);
                prm75.Direction = ParameterDirection.Input;
                prm75.Value = boxclient;
                objOraclecommand.Parameters.Add(prm75);

                OracleParameter prm77 = new OracleParameter("bookingtype", OracleType.VarChar);
                prm77.Direction = ParameterDirection.Input;
                prm77.Value = bookingtype;
                objOraclecommand.Parameters.Add(prm77);

                OracleParameter prm78 = new OracleParameter("tfn", OracleType.VarChar);
                prm78.Direction = ParameterDirection.Input;
                prm78.Value = tfn;
                objOraclecommand.Parameters.Add(prm78);


                OracleParameter prm76 = new OracleParameter("coupan", OracleType.VarChar);
                prm76.Direction = ParameterDirection.Input;
                prm76.Value = coupan;
                objOraclecommand.Parameters.Add(prm76);




                OracleParameter prm79 = new OracleParameter("campaign", OracleType.VarChar);
                prm79.Direction = ParameterDirection.Input;
                prm79.Value = campaign;
                objOraclecommand.Parameters.Add(prm79);


                OracleParameter prm80 = new OracleParameter("bill_amt", OracleType.VarChar);
                prm80.Direction = ParameterDirection.Input;
                if (bill_amt == "" || bill_amt == null)
                {
                    prm80.Value = System.DBNull.Value;
                }
                else
                {
                    prm80.Value = Convert.ToDecimal(bill_amt);
                }
                objOraclecommand.Parameters.Add(prm80);


                OracleParameter prm81 = new OracleParameter("pageprem", OracleType.VarChar);
                prm81.Direction = ParameterDirection.Input;
                prm81.Value = pageprem;
                objOraclecommand.Parameters.Add(prm81);

                OracleParameter prm82 = new OracleParameter("pageamt", OracleType.VarChar);
                prm82.Direction = ParameterDirection.Input;
                if (pageamt == "" || pageamt == null)
                {
                    prm82.Value = System.DBNull.Value;
                }
                else
                {
                    prm82.Value = Convert.ToDecimal(pageamt);
                }
                objOraclecommand.Parameters.Add(prm82);


                OracleParameter prm83 = new OracleParameter("premper", OracleType.VarChar);
                prm83.Direction = ParameterDirection.Input;
                if (premper == "" || premper == null)
                {
                    prm83.Value = System.DBNull.Value;
                }
                else
                {
                    prm83.Value = Convert.ToDecimal(premper);
                }
                objOraclecommand.Parameters.Add(prm83);


                OracleParameter prm84 = new OracleParameter("grossamt", OracleType.VarChar);
                prm84.Direction = ParameterDirection.Input;
                if (grossamt == "" || grossamt == null)
                {
                    prm84.Value = System.DBNull.Value;
                }
                else
                {
                    prm84.Value = Convert.ToDecimal(grossamt);
                }
                objOraclecommand.Parameters.Add(prm84);



                OracleParameter prm85 = new OracleParameter("adsizcolumn", OracleType.VarChar);
                prm85.Direction = ParameterDirection.Input;
                if (adsizcolumn == "" || adsizcolumn == null)
                {
                    prm85.Value = System.DBNull.Value;
                }
                else
                {
                    prm85.Value = Convert.ToDecimal(adsizcolumn);
                }
                objOraclecommand.Parameters.Add(prm85);

                OracleParameter prm89 = new OracleParameter("billarea", OracleType.VarChar);
                prm89.Direction = ParameterDirection.Input;
                if (billarea == 0)
                {
                    prm89.Value = System.DBNull.Value;
                }
                else
                {
                    prm89.Value = Convert.ToDecimal(billarea);
                }
                objOraclecommand.Parameters.Add(prm89);


                OracleParameter prm86 = new OracleParameter("billcolumn", OracleType.VarChar);
                prm86.Direction = ParameterDirection.Input;
                if (billcolumn == "" || billcolumn == null)
                {
                    prm86.Value = System.DBNull.Value;
                }
                else
                {
                    prm86.Value = Convert.ToDecimal(billcolumn);
                }
                objOraclecommand.Parameters.Add(prm86);


                OracleParameter prm88 = new OracleParameter("spacediscper", OracleType.VarChar);
                prm88.Direction = ParameterDirection.Input;
                if (spacediscper == "" || spacediscper == null)
                {
                    prm88.Value = System.DBNull.Value;
                }
                else
                {
                    prm88.Value = Convert.ToDecimal(spacediscper);
                }
                objOraclecommand.Parameters.Add(prm88);

                OracleParameter prm87 = new OracleParameter("specdiscper", OracleType.VarChar);
                prm87.Direction = ParameterDirection.Input;
                if (specdiscper == "" || specdiscper == null)
                {
                    prm87.Value = System.DBNull.Value;
                }
                else
                {
                    prm87.Value = Convert.ToDecimal(specdiscper);
                }
                objOraclecommand.Parameters.Add(prm87);






                OracleParameter prm90 = new OracleParameter("paidins", OracleType.VarChar);
                prm90.Direction = ParameterDirection.Input;
                if (paidins == "" || paidins == null)
                {
                    prm90.Value = System.DBNull.Value;
                }
                else
                {
                    prm90.Value = Convert.ToDecimal(paidins);
                }
                objOraclecommand.Parameters.Add(prm90);
                OracleParameter prm91 = new OracleParameter("dealrate", OracleType.VarChar);
                prm91.Direction = ParameterDirection.Input;
                if (dealrate == "" || dealrate == null)
                {
                    prm91.Value = System.DBNull.Value;
                }
                else
                {
                    prm91.Value = Convert.ToDecimal(dealrate);
                }

                objOraclecommand.Parameters.Add(prm91);


                OracleParameter prm92 = new OracleParameter("deviation", OracleType.VarChar);
                prm92.Direction = ParameterDirection.Input;
                if (deviation == "" || deviation == null)
                {
                    prm92.Value = System.DBNull.Value;
                }
                else
                {
                    prm92.Value = Convert.ToDecimal(deviation);
                }
                objOraclecommand.Parameters.Add(prm92);




                OracleParameter prm93 = new OracleParameter("varient", OracleType.VarChar);
                prm93.Direction = ParameterDirection.Input;
                prm93.Value = varient;
                objOraclecommand.Parameters.Add(prm93);



                OracleParameter prm95 = new OracleParameter("dealtype", OracleType.VarChar);
                prm95.Direction = ParameterDirection.Input;
                prm95.Value = dealtype;
                objOraclecommand.Parameters.Add(prm95);

                OracleParameter prm94 = new OracleParameter("contractname", OracleType.VarChar);
                prm94.Direction = ParameterDirection.Input;
                prm94.Value = contractname;
                objOraclecommand.Parameters.Add(prm94);

                OracleParameter prm96 = new OracleParameter("cardname", OracleType.VarChar);
                prm96.Direction = ParameterDirection.Input;
                prm96.Value = cardname;
                objOraclecommand.Parameters.Add(prm96);

                OracleParameter prm97 = new OracleParameter("cardtype", OracleType.VarChar);
                prm97.Direction = ParameterDirection.Input;
                prm97.Value = cardtype;
                objOraclecommand.Parameters.Add(prm97);

                OracleParameter prm98 = new OracleParameter("cardmonth", OracleType.VarChar);
                prm98.Direction = ParameterDirection.Input;
                prm98.Value = cardmonth;
                objOraclecommand.Parameters.Add(prm98);

                OracleParameter prm99 = new OracleParameter("cardyear", OracleType.VarChar);
                prm99.Direction = ParameterDirection.Input;
                prm99.Value = cardyear;
                objOraclecommand.Parameters.Add(prm99);

                OracleParameter prm100 = new OracleParameter("cardno", OracleType.VarChar);
                prm100.Direction = ParameterDirection.Input;
                prm100.Value = cardno;
                objOraclecommand.Parameters.Add(prm100);






                OracleParameter prm101 = new OracleParameter("receiptno", OracleType.VarChar);
                prm101.Direction = ParameterDirection.Input;
                prm101.Value = receiptno;
                objOraclecommand.Parameters.Add(prm101);


                OracleParameter prm102 = new OracleParameter("adscat3", OracleType.VarChar);
                prm102.Direction = ParameterDirection.Input;
                prm102.Value = adscat3;
                objOraclecommand.Parameters.Add(prm102);


                OracleParameter prm103 = new OracleParameter("adscat4", OracleType.VarChar);
                prm103.Direction = ParameterDirection.Input;
                prm103.Value = adscat4;
                objOraclecommand.Parameters.Add(prm103);


                OracleParameter prm104 = new OracleParameter("adscat5", OracleType.VarChar);
                prm104.Direction = ParameterDirection.Input;
                prm104.Value = adscat5;
                objOraclecommand.Parameters.Add(prm104);


                OracleParameter prm105 = new OracleParameter("bgcolor", OracleType.VarChar);
                prm105.Direction = ParameterDirection.Input;
                prm105.Value = bgcolor;
                objOraclecommand.Parameters.Add(prm105);


                OracleParameter prm106 = new OracleParameter("bulletcode", OracleType.VarChar);
                prm106.Direction = ParameterDirection.Input;
                prm106.Value = bulletcode;
                objOraclecommand.Parameters.Add(prm106);


                OracleParameter prm107 = new OracleParameter("bulletprm", OracleType.VarChar);
                prm107.Direction = ParameterDirection.Input;
                if (bulletprm == "" || bulletprm == null)
                {
                    prm107.Value = System.DBNull.Value;
                }
                else
                {
                    bulletprm = bulletprm.Replace("%", "");
                    prm107.Value = Convert.ToDecimal(bulletprm);
                }
                objOraclecommand.Parameters.Add(prm107);


                OracleParameter prm108 = new OracleParameter("material", OracleType.VarChar);
                prm108.Direction = ParameterDirection.Input;
                prm108.Value = material;
                objOraclecommand.Parameters.Add(prm108);








                OracleParameter prm114 = new OracleParameter("region1", OracleType.VarChar);
                prm114.Direction = ParameterDirection.Input;
                prm114.Value = region;
                objOraclecommand.Parameters.Add(prm114);



                OracleParameter prm113 = new OracleParameter("varient_name", OracleType.VarChar);
                prm113.Direction = ParameterDirection.Input;
                prm113.Value = varient_name;
                objOraclecommand.Parameters.Add(prm113);



                /*new change ankur 9 feb*/

                OracleParameter prm115 = new OracleParameter("coltype", OracleType.VarChar);
                prm115.Direction = ParameterDirection.Input;
                prm115.Value = coltype;
                objOraclecommand.Parameters.Add(prm115);

                OracleParameter prm116 = new OracleParameter("logo_h", OracleType.VarChar);
                prm116.Direction = ParameterDirection.Input;
                prm116.Value = logo_h;
                objOraclecommand.Parameters.Add(prm116);

                OracleParameter prm117 = new OracleParameter("logo_w", OracleType.VarChar);
                prm117.Direction = ParameterDirection.Input;
                prm117.Value = logo_w;
                objOraclecommand.Parameters.Add(prm117);

                OracleParameter prm118 = new OracleParameter("logo_col", OracleType.VarChar);
                prm118.Direction = ParameterDirection.Input;
                prm118.Value = logo_col;
                objOraclecommand.Parameters.Add(prm118);

                OracleParameter prm119 = new OracleParameter("logo_uom", OracleType.VarChar);
                prm119.Direction = ParameterDirection.Input;
                prm119.Value = logo_uom;
                objOraclecommand.Parameters.Add(prm119);


                OracleParameter prm120 = new OracleParameter("retainer1", OracleType.VarChar);
                prm120.Direction = ParameterDirection.Input;
                if (retainer.LastIndexOf("(") >= 0)
                {
                    retainer = retainer.Substring(retainer.LastIndexOf("(") + 1, retainer.Length - retainer.LastIndexOf("(") - 2);
                }
                prm120.Value = retainer;
                objOraclecommand.Parameters.Add(prm120);

                OracleParameter prm121 = new OracleParameter("addagencyrate", OracleType.VarChar);
                prm121.Direction = ParameterDirection.Input;
                prm121.Value = addagencyrate;
                objOraclecommand.Parameters.Add(prm121);

                OracleParameter prm122 = new OracleParameter("mobileno", OracleType.VarChar);
                prm122.Direction = ParameterDirection.Input;
                prm122.Value = mobileno;
                objOraclecommand.Parameters.Add(prm122);

                OracleParameter prm123 = new OracleParameter("addlamt", OracleType.VarChar);
                prm123.Direction = ParameterDirection.Input;
                prm123.Value = addlamt;
                objOraclecommand.Parameters.Add(prm123);

                OracleParameter prm124 = new OracleParameter("retamt", OracleType.VarChar);
                prm124.Direction = ParameterDirection.Input;
                prm124.Value = retamt;
                objOraclecommand.Parameters.Add(prm124);

                OracleParameter prm125 = new OracleParameter("retper", OracleType.VarChar);
                prm125.Direction = ParameterDirection.Input;
                prm125.Value = retper;
                objOraclecommand.Parameters.Add(prm125);

                OracleParameter prm126 = new OracleParameter("cashrecieved", OracleType.VarChar);
                prm126.Direction = ParameterDirection.Input;
                if (cashrecieved == "" || cashrecieved == null)
                {
                    prm126.Value = System.DBNull.Value;
                }
                else
                {
                    prm126.Value = Convert.ToDecimal(cashrecieved);
                }
                objOraclecommand.Parameters.Add(prm126);

                OracleParameter prm127 = new OracleParameter("CIRAGENCY_V", OracleType.VarChar);
                prm127.Direction = ParameterDirection.Input;
                prm127.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm127);

                OracleParameter prm128 = new OracleParameter("CIRRATE_V", OracleType.VarChar);
                prm128.Direction = ParameterDirection.Input;
                prm128.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm128);

                OracleParameter prm129 = new OracleParameter("CIREDITION_V", OracleType.VarChar);
                prm129.Direction = ParameterDirection.Input;
                prm129.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm129);

                OracleParameter prm130 = new OracleParameter("CIRPUBLICATION_V", OracleType.VarChar);
                prm130.Direction = ParameterDirection.Input;
                prm130.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm130);

                OracleParameter prm131 = new OracleParameter("CIRAGENCYSUBCODE_V", OracleType.VarChar);
                prm131.Direction = ParameterDirection.Input;
                prm131.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm131);

                OracleParameter prm132 = new OracleParameter("BARTERTYPE", OracleType.VarChar);
                prm132.Direction = ParameterDirection.Input;
                prm132.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm132);

                OracleParameter prm133 = new OracleParameter("CASHDISCOUNT_V", OracleType.VarChar);
                prm133.Direction = ParameterDirection.Input;
                prm133.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm133);

                OracleParameter prm134 = new OracleParameter("CASHDISCOUNTPER_V", OracleType.VarChar);
                prm134.Direction = ParameterDirection.Input;
                prm134.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm134);

                OracleParameter prm135 = new OracleParameter("attach1", OracleType.VarChar);
                prm135.Direction = ParameterDirection.Input;
                prm135.Value = attach1;
                objOraclecommand.Parameters.Add(prm135);

                OracleParameter prm136 = new OracleParameter("attach2", OracleType.VarChar);
                prm136.Direction = ParameterDirection.Input;
                prm136.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm136);
                OracleParameter prm137 = new OracleParameter("drpdiscprem", OracleType.VarChar);
                prm137.Direction = ParameterDirection.Input;
                prm137.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm137);

                OracleParameter prm138 = new OracleParameter("doctype_v", OracleType.VarChar);
                prm138.Direction = ParameterDirection.Input;
                prm138.Value = doctype;
                objOraclecommand.Parameters.Add(prm138);
                OracleParameter prm139 = new OracleParameter("CHKTRADE", OracleType.VarChar);
                prm139.Direction = ParameterDirection.Input;
                prm139.Value = chktradeval;
                objOraclecommand.Parameters.Add(prm139);

                OracleParameter prm140 = new OracleParameter("sharepub_p", OracleType.VarChar);
                prm140.Direction = ParameterDirection.Input;
                prm140.Value = sharepub;
                objOraclecommand.Parameters.Add(prm140);

                OracleParameter prm141 = new OracleParameter("fmginsert", OracleType.VarChar);
                prm141.Direction = ParameterDirection.Input;
                prm141.Value = fmginsert;
                objOraclecommand.Parameters.Add(prm141);

                OracleParameter prm142 = new OracleParameter("chkno", OracleType.VarChar);
                prm142.Direction = ParameterDirection.Input;
                prm142.Value = chkno;
                objOraclecommand.Parameters.Add(prm142);

                OracleParameter prm143 = new OracleParameter("chkdate", OracleType.DateTime);
                prm143.Direction = ParameterDirection.Input;
                if (chkdate == "")
                {
                    prm143.Value = System.DBNull.Value;
                }
                else
                {
                    prm143.Value = chkdate;
                }

                objOraclecommand.Parameters.Add(prm143);

                OracleParameter prm144 = new OracleParameter("chkamt", OracleType.VarChar);
                prm144.Direction = ParameterDirection.Input;
                prm144.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm144);
                OracleParameter prm145 = new OracleParameter("chkbankname", OracleType.VarChar);
                prm145.Direction = ParameterDirection.Input;
                prm145.Value = chkbankname;
                objOraclecommand.Parameters.Add(prm145);

                OracleParameter prm146 = new OracleParameter("ourbank", OracleType.VarChar);
                prm146.Direction = ParameterDirection.Input;
                prm146.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm146);

                OracleParameter prm147 = new OracleParameter("DEALERPANEL_P", OracleType.VarChar);
                prm147.Direction = ParameterDirection.Input;
                if (dealerpanel == "")
                    prm147.Value = System.DBNull.Value;
                else
                    prm147.Value = dealerpanel;
                objOraclecommand.Parameters.Add(prm147);

                OracleParameter prm148 = new OracleParameter("DEALERH_P", OracleType.VarChar);
                prm148.Direction = ParameterDirection.Input;
                if (dealerh == "")
                    prm148.Value = System.DBNull.Value;
                else
                    prm148.Value = dealerh;
                objOraclecommand.Parameters.Add(prm148);

                OracleParameter prm149 = new OracleParameter("DEALERW_P", OracleType.VarChar);
                prm149.Direction = ParameterDirection.Input;
                if (dealerw == "")
                    prm149.Value = System.DBNull.Value;
                else
                    prm149.Value = dealerw;
                objOraclecommand.Parameters.Add(prm149);

                OracleParameter prm150 = new OracleParameter("DEALERTYPE_P", OracleType.VarChar);
                prm150.Direction = ParameterDirection.Input;
                if (dealertype == "")
                    prm150.Value = System.DBNull.Value;
                else
                    prm150.Value = dealertype;
                objOraclecommand.Parameters.Add(prm150);

                OracleParameter prm151 = new OracleParameter("multiselect", OracleType.VarChar);
                prm151.Direction = ParameterDirection.Input;
                if (multicode == "")
                    prm151.Value = System.DBNull.Value;
                else
                    prm151.Value = multicode;
                objOraclecommand.Parameters.Add(prm151);

                OracleParameter prm152 = new OracleParameter("AGREEDRATE_ACTIVE", OracleType.VarChar);
                prm152.Direction = ParameterDirection.Input;
                if (agreedrate_active == "")
                    prm152.Value = System.DBNull.Value;
                else
                    prm152.Value = agreedrate_active;

                objOraclecommand.Parameters.Add(prm152);

                OracleParameter prm153 = new OracleParameter("AGREEDAMT_ACTIVE", OracleType.VarChar);
                prm153.Direction = ParameterDirection.Input;
                if (agreedamt_active == "")
                    prm153.Value = System.DBNull.Value;
                else
                    prm153.Value = agreedamt_active;

                objOraclecommand.Parameters.Add(prm153);


                OracleParameter prm154 = new OracleParameter("grossamtlocal_p", OracleType.VarChar);
                prm154.Direction = ParameterDirection.Input;
                if (grossamt == "")
                    prm154.Value = System.DBNull.Value;
                else
                    prm154.Value = grossamtlocal_p;

                objOraclecommand.Parameters.Add(prm154);

                OracleParameter prm155 = new OracleParameter("billamtlocal_p", OracleType.VarChar);
                prm155.Direction = ParameterDirection.Input;
                if (bill_amt == "")
                    prm155.Value = System.DBNull.Value;
                else
                    prm155.Value = billamtlocal_p;

                objOraclecommand.Parameters.Add(prm155);

                OracleParameter prm145a = new OracleParameter("chkadon_p", OracleType.VarChar);
                prm145a.Direction = ParameterDirection.Input;
                prm145a.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm145a);

                OracleParameter prm145b = new OracleParameter("refid_p", OracleType.VarChar);
                prm145b.Direction = ParameterDirection.Input;
                prm145b.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm145b);

                OracleParameter prm145c = new OracleParameter("rcpt_currency", OracleType.VarChar);
                prm145c.Direction = ParameterDirection.Input;
                prm145c.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm145c);

                OracleParameter prm145d = new OracleParameter("cur_convrate", OracleType.VarChar);
                prm145d.Direction = ParameterDirection.Input;
                prm145d.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm145d);

                OracleParameter prm145e = new OracleParameter("p_revisedate", OracleType.VarChar);
                prm145e.Direction = ParameterDirection.Input;
                prm145e.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm145e);

                OracleParameter prm155a = new OracleParameter("clienttype", OracleType.VarChar);
                prm155a.Direction = ParameterDirection.Input;
                prm155a.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm155a);

                OracleParameter prm153e = new OracleParameter("translation", OracleType.VarChar);
                prm153e.Direction = ParameterDirection.Input;
                //if (translation == "0")
                prm153e.Value = System.DBNull.Value;
                //else
                //    prm153e.Value = translation;
                objOraclecommand.Parameters.Add(prm153e);

                OracleParameter prm107a = new OracleParameter("translationcharge", OracleType.Number);
                prm107a.Direction = ParameterDirection.Input;
                //if (translationcharge == "" || translationcharge == null)
                //{
                prm107a.Value = System.DBNull.Value;
                //}
                //else
                //{
                //    translationcharge = translationcharge.Replace("%", "");
                //    prm107a.Value = Convert.ToDecimal(translationcharge);
                //}
                objOraclecommand.Parameters.Add(prm107a);

                OracleParameter prm141a = new OracleParameter("fmgreasons", OracleType.VarChar);
                prm141a.Direction = ParameterDirection.Input;
                prm141a.Value = fmgreasons;
                objOraclecommand.Parameters.Add(prm141a);

                OracleParameter prm141b = new OracleParameter("canclecharge", OracleType.VarChar);
                prm141b.Direction = ParameterDirection.Input;
                prm141b.Value = canclecharge;
                objOraclecommand.Parameters.Add(prm141b);

                OracleParameter prm151b = new OracleParameter("P_ip", OracleType.VarChar);
                prm151b.Direction = ParameterDirection.Input;
                prm151b.Value = ip;
                objOraclecommand.Parameters.Add(prm151b);

                OracleParameter prm161b = new OracleParameter("P_RATE_AUDIT_FLAG", OracleType.VarChar);
                prm161b.Direction = ParameterDirection.Input;
                prm161b.Value = modifyrateaudit;
                objOraclecommand.Parameters.Add(prm161b);

                OracleParameter prm161bt = new OracleParameter("transdisc_p", OracleType.VarChar);
                prm161bt.Direction = ParameterDirection.Input;
                prm161bt.Value = transdisc;
                objOraclecommand.Parameters.Add(prm161bt);

                OracleParameter prm161bs = new OracleParameter("pospremdisc_p", OracleType.VarChar);
                prm161bs.Direction = ParameterDirection.Input;
                prm161bs.Value = pospremdisc;
                objOraclecommand.Parameters.Add(prm161bs);

                OracleParameter prm161b1 = new OracleParameter("billhold", OracleType.VarChar);
                prm161b1.Direction = ParameterDirection.Input;
                prm161b1.Value = billhold;
                objOraclecommand.Parameters.Add(prm161b1);

                OracleParameter prm161b1x = new OracleParameter("designbox", OracleType.VarChar);
                prm161b1x.Direction = ParameterDirection.Input;
                prm161b1x.Value = designbox;
                objOraclecommand.Parameters.Add(prm161b1x);

                OracleParameter prm161b1z = new OracleParameter("logoprem", OracleType.VarChar);
                prm161b1z.Direction = ParameterDirection.Input;
                prm161b1z.Value = logoprem;
                objOraclecommand.Parameters.Add(prm161b1z);

                OracleParameter prm161b1az = new OracleParameter("online_ad_p", OracleType.VarChar);
                prm161b1az.Direction = ParameterDirection.Input;
                prm161b1az.Value = online_ad;
                objOraclecommand.Parameters.Add(prm161b1az);

                OracleParameter prm161b1azx = new OracleParameter("pstyle", OracleType.VarChar);
                prm161b1azx.Direction = ParameterDirection.Input;
                prm161b1azx.Value = style;
                objOraclecommand.Parameters.Add(prm161b1azx);


                OracleParameter prm161b1azxA = new OracleParameter("CPN_CODE_P", OracleType.VarChar);
                prm161b1azxA.Direction = ParameterDirection.Input;
                prm161b1azxA.Value = cou_code;
                objOraclecommand.Parameters.Add(prm161b1azxA);

                OracleParameter prm161b1azAx = new OracleParameter("CPN_NAME_P", OracleType.VarChar);
                prm161b1azAx.Direction = ParameterDirection.Input;
                prm161b1azAx.Value = cou_name;
                objOraclecommand.Parameters.Add(prm161b1azAx);

                OracleParameter prm161b1az14A = new OracleParameter("STATE_P", OracleType.VarChar);
                prm161b1az14A.Direction = ParameterDirection.Input;
                prm161b1az14A.Value = state;
                objOraclecommand.Parameters.Add(prm161b1az14A);

                OracleParameter prm161z = new OracleParameter("clientcatdisc", OracleType.Number);
                prm161z.Direction = ParameterDirection.Input;
                if (clientcatdisc == "" || clientcatdisc == "0" || clientcatdisc == "null")
                {
                    prm161z.Value = System.DBNull.Value;
                }
                else
                {
                    prm161z.Value = clientcatdisc;
                }
                objOraclecommand.Parameters.Add(prm161z);

                OracleParameter prm161z1 = new OracleParameter("clientcatamt", OracleType.Number);
                prm161z1.Direction = ParameterDirection.Input;
                if (clientcatamt == "" || clientcatamt == "0" || clientcatamt == "null")
                {
                    prm161z1.Value = System.DBNull.Value;
                }
                else
                {
                    prm161z1.Value = clientcatamt;
                }
                objOraclecommand.Parameters.Add(prm161z1);

                OracleParameter prm161z2 = new OracleParameter("clientcatdistype", OracleType.VarChar);
                prm161z2.Direction = ParameterDirection.Input;
                prm161z2.Value = clientcatdistype;
                objOraclecommand.Parameters.Add(prm161z2);


                OracleParameter prm161z3 = new OracleParameter("flatfreqdisc", OracleType.Number);
                prm161z3.Direction = ParameterDirection.Input;
                if (flatfreqdisc == "" || flatfreqdisc == "0" || flatfreqdisc == "null")
                {
                    prm161z3.Value = System.DBNull.Value;
                }
                else
                {
                    prm161z3.Value = flatfreqdisc;
                }
                objOraclecommand.Parameters.Add(prm161z3);



                OracleParameter prm161z4 = new OracleParameter("flatfreqamt", OracleType.Number);
                prm161z4.Direction = ParameterDirection.Input;
                if (flatfreqamt == "" || flatfreqamt == "0" || flatfreqamt == "null")
                {
                    prm161z4.Value = System.DBNull.Value;
                }
                else
                {
                    prm161z4.Value = flatfreqamt;
                }
                objOraclecommand.Parameters.Add(prm161z4);




                OracleParameter prm161z5 = new OracleParameter("flatfreqdisctype", OracleType.VarChar);
                prm161z5.Direction = ParameterDirection.Input;
                prm161z5.Value = flatfreqdisctype;
                objOraclecommand.Parameters.Add(prm161z5);

                OracleParameter prm161z6 = new OracleParameter("catdisc", OracleType.Number);
                prm161z6.Direction = ParameterDirection.Input;
                if (catdisc == "" || catdisc == "0" || catdisc == "null")
                {
                    prm161z6.Value = System.DBNull.Value;
                }
                else
                {
                    prm161z6.Value = catdisc;
                }
                objOraclecommand.Parameters.Add(prm161z6);

                OracleParameter prm161z7 = new OracleParameter("catamt", OracleType.Number);
                prm161z7.Direction = ParameterDirection.Input;
                if (catamt == "" || catamt == "0" || catamt == "null")
                {
                    prm161z7.Value = System.DBNull.Value;
                }
                else
                {
                    prm161z7.Value = catamt;
                }
                objOraclecommand.Parameters.Add(prm161z7);

                OracleParameter prm161z8 = new OracleParameter("catdisctype", OracleType.VarChar);
                prm161z8.Direction = ParameterDirection.Input;
                prm161z8.Value = catdisctype;
                objOraclecommand.Parameters.Add(prm161z8);

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet executebooking(string compcode, string ciobookid, string docno, string keyno, string rono, string agencycode, string client, string booking, string dateformat, string revenue)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {

                objOracleConnection.Open();
                objOraclecommand = GetCommand("executebookingdisp.executebookingdisp_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("ciobookid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = ciobookid;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("docno", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = docno;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm6 = new OracleParameter("keyno", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = keyno;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm5 = new OracleParameter("rono", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = rono;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm4 = new OracleParameter("agencycode", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = agencycode;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm7 = new OracleParameter("client", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = client;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("booking", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = booking;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("dateformat", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = dateformat;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("revenue", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = revenue;
                objOraclecommand.Parameters.Add(prm10);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("p_accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts2"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("P_Accounts3", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts3"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }


        public DataSet executebooking_bill(string compcode, string ciobookid, string docno, string keyno, string rono, string agencycode, string client, string booking, string dateformat, string revenue)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {

                objOracleConnection.Open();
                objOraclecommand = GetCommand("executebookingdispbill.executebookingdispbill_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("ciobookid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = ciobookid;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("docno", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = docno;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm6 = new OracleParameter("keyno", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = keyno;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm5 = new OracleParameter("rono", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = rono;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm4 = new OracleParameter("agencycode", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = agencycode;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm7 = new OracleParameter("client", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = client;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("booking", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = booking;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("dateformat", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = dateformat;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("revenue", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = revenue;
                objOraclecommand.Parameters.Add(prm10);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("p_accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts2"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("P_Accounts3", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts3"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }


        public DataSet executebookingqbc(string compcode, string ciobookid, string docno, string keyno, string rono, string agencycode, string client, string booking, string dateformat, string revenue)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("executebooking.executebooking_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;



                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("ciobookid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = ciobookid;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("docno", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = docno;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("agencycode", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = agencycode;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("rono", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = rono;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("keyno", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = keyno;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("client", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = client;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("booking", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                if (booking == "" || booking == "0")
                    prm8.Value = System.DBNull.Value;
                else
                    prm8.Value = booking;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("dateformat", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = dateformat;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("revenue", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = revenue;
                objOraclecommand.Parameters.Add(prm10);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("P_Accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts1"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("P_Accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts2"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts3", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts3"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet bindpaymode(string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("bindpaymode.bindpaymode_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        /*    public DataSet bindrevenue(string compcode)
            {
                OracleConnection objOracleConnection;
                OracleCommand objOraclecommand;
                DataSet objDataSet = new DataSet();
                objOracleConnection = GetConnection();
                OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
                try
                {


                    objOracleConnection.Open();
                    objOraclecommand = GetCommand("bindrevenue.bindrevenue_p", ref objOracleConnection);
                    objOraclecommand.CommandType = CommandType.StoredProcedure;


                    OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                    prm1.Direction = ParameterDirection.Input;
                    prm1.Value = compcode;
                    objOraclecommand.Parameters.Add(prm1);


                    objorclDataAdapter.SelectCommand = objOraclecommand;
                    objorclDataAdapter.Fill(objDataSet);
                    return objDataSet;

                }
                catch (Exception ex)
                {
                    throw (ex);
                }
                finally
                {
                    CloseConnection(ref objOracleConnection);
                }
            }*/

        public DataSet getstatuspaymode(string agency, string agencysubcode, string compcode, string datecheck, string dateformat, string adtype)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getstatuspaymode.getstatuspaymode_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("agencysubcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = agencysubcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("datecheck", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                if (datecheck == "" || datecheck == null)
                {
                    prm3.Value = System.DBNull.Value;
                }

                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {

                        if (datecheck.IndexOf('-') < 0)
                        {
                            string[] arr = datecheck.Split('/');
                            string dd = arr[0];
                            string mm = arr[1];
                            string yy = arr[2];
                            datecheck = mm + "/" + dd + "/" + yy;

                        }

                    }
                    if (datecheck.IndexOf('-') < 0)
                    {
                        prm3.Value = Convert.ToDateTime(datecheck).ToString("dd-MMMM-yyyy");
                    }
                    else
                    {
                        prm3.Value = datecheck;
                    }
                }
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("agency", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = agency;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("adtype1", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = adtype;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("dateformat", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = dateformat;
                objOraclecommand.Parameters.Add(prm6);

                //objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                //objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts1"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("P_Accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts2"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("P_Accounts3", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts3"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("P_Accounts4", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts4"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("P_Accounts5", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts5"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts6", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts6"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts7", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts7"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts8", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts8"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }

            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }



        public DataSet getthedatabook(string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getuomforbook.getuomforbook_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet getpercentage(string premium, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getpremiumforbook.getpremiumforbook_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("premium", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = premium;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }

        public DataSet ratebind(string adcat, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("bindratecode.bindratecode_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;



                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("adcat1", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = adcat;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_Accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts1"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);

                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet getrate(string adtype, string color, string adcat, string adsucat, string currency, string ratecode, string package, string selecdate, string compcode, string uom, string premium, string clientcode, string noof_ins, string adcat3, string adcat4, string adcat5)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getratecode.getratecode_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm6 = new OracleParameter("Compcode", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = compcode;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm10 = new OracleParameter("Adtype", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = adtype;
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm9 = new OracleParameter("Color", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = color;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm12 = new OracleParameter("Adcat", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = adcat;
                objOraclecommand.Parameters.Add(prm12);

                OracleParameter prm8 = new OracleParameter("Adsucat", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = adsucat;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm11 = new OracleParameter("Currency", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = currency;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm1 = new OracleParameter("RATECODE", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = ratecode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm13 = new OracleParameter("Package1", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = package;
                objOraclecommand.Parameters.Add(prm13);

                OracleParameter prm5 = new OracleParameter("Selecdate2", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                if (selecdate == "")
                {
                    prm5.Value = System.DBNull.Value;
                }
                else
                {
                    prm5.Value = Convert.ToDateTime(selecdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm2 = new OracleParameter("Uom", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = uom;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("Clientcode", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = clientcode;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("Premium", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = premium;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm7 = new OracleParameter("Noof_Ins", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = noof_ins;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm14 = new OracleParameter("adsubcat3", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = adcat3;
                objOraclecommand.Parameters.Add(prm14);

                OracleParameter prm15 = new OracleParameter("adsubcat4", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = adcat4;
                objOraclecommand.Parameters.Add(prm15);

                OracleParameter prm16 = new OracleParameter("adsubcat5", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = adcat5;
                objOraclecommand.Parameters.Add(prm16);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts1"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts2"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts3", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts3"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet class_getrate(string adtype, string color, string adcat, string adsucat, string currency, string ratecode, string package, string selecdate, string compcode, string uom, string insert, string lines, string prem, string adcat3, string adcat4, string adcat5, string clientname, string noof_ins, string dateformat)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {

                objOracleConnection.Open();
                objOraclecommand = GetCommand("Class_Getratecode.class_getratecode_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm1 = new OracleParameter("package1", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = package;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("noof_ins", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = noof_ins;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("insert1", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = insert;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("selecdate", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                if (selecdate == "" || selecdate == null)
                {
                    prm4.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = selecdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        selecdate = mm + "/" + dd + "/" + yy;
                    }
                    prm4.Value = Convert.ToDateTime(selecdate).ToString("dd-MMMM-yyyy");
                }

                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("lines", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = lines;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("compcode", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = compcode;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("adcat3", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = adcat3;
                objOraclecommand.Parameters.Add(prm7);
                /*if (adcat3 == "")
                {
                    objOraclecommand.Parameters["@adcat3"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat3"].Value = adcat3;
                }*/

                OracleParameter prm8 = new OracleParameter("adsucat", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = adsucat;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("color", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = color;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("adcat1", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = adcat;
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("currency", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = currency;
                objOraclecommand.Parameters.Add(prm11);


                OracleParameter prm12 = new OracleParameter("vratecode", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = ratecode;
                objOraclecommand.Parameters.Add(prm12);

                OracleParameter prm13 = new OracleParameter("adcat4", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = adcat4;
                objOraclecommand.Parameters.Add(prm13);
                /*if (adcat4 == "")
                {
                    objOraclecommand.Parameters["@adcat4"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat4"].Value = adcat4;
                }*/




                OracleParameter prm14 = new OracleParameter("adcat5", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = adcat5;
                objOraclecommand.Parameters.Add(prm14);
                /*  if (adcat5 == "")
                {
                    objOraclecommand.Parameters["@adcat5"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat5"].Value = adcat5;
                }
*/

                OracleParameter prm15 = new OracleParameter("adtype1", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = adtype;
                objOraclecommand.Parameters.Add(prm15);
                OracleParameter prm16 = new OracleParameter("prem", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = prem;
                objOraclecommand.Parameters.Add(prm16);


                OracleParameter prm17 = new OracleParameter("uom", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = uom;
                objOraclecommand.Parameters.Add(prm17);

                OracleParameter prm18 = new OracleParameter("clientname", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;
                prm18.Value = clientname;
                objOraclecommand.Parameters.Add(prm18);


                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts1"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts2"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts3", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts3"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts4", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts4"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet class_getrate_qbc(string adtype, string color, string adcat, string adsucat, string currency, string ratecode, string package, string selecdate, string compcode, string uom, string insert, string lines, string prem, string adcat3, string adcat4, string adcat5, string clientname, string noof_ins, string uomdesc, string dateformat)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                // for checking the color rate percentage appled on extra rate or not
                string openreferExtra = ConfigurationSettings.AppSettings["openreferExtra"];
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getpackgaerate1.getpackgaerate1_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("package1", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = package;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("noof_ins", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = noof_ins;
                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("insert1", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = insert;
                objOraclecommand.Parameters.Add(prm3);
                OracleParameter prm4 = new OracleParameter("selecdate", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;

                if (selecdate == "" || selecdate == null)
                {
                    prm4.Value = System.DBNull.Value;
                }
                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = selecdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        selecdate = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = selecdate.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        selecdate = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = selecdate.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            selecdate = mm + "/" + dd + "/" + yy;
                    //        }

                    prm4.Value = Convert.ToDateTime(selecdate).ToString("dd-MMMM-yyyy");
                }
                //}

                objOraclecommand.Parameters.Add(prm4);
                OracleParameter prm5 = new OracleParameter("lines", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = lines;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("compcode", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = compcode;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("adcat3", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = adcat3;
                objOraclecommand.Parameters.Add(prm7);
                /*if (adcat3 == "")
                 {
                     objOraclecommand.Parameters["@adcat3"].Value = "0";
                 }
                 else
                 {
                     objOraclecommand.Parameters["@adcat3"].Value = adcat3;
                 }
                 */

                OracleParameter prm8 = new OracleParameter("adsucat", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = adsucat;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("color", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = color;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("adcat1", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = adcat;
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("currency", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = currency;
                objOraclecommand.Parameters.Add(prm11);


                OracleParameter prm12 = new OracleParameter("ratecode", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = ratecode;
                objOraclecommand.Parameters.Add(prm12);

                OracleParameter prm13 = new OracleParameter("adcat4", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = adcat4;
                objOraclecommand.Parameters.Add(prm13);
                /* if (adcat4 == "")
                {
                    objOraclecommand.Parameters["@adcat4"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat4"].Value = adcat4;
                }*/




                OracleParameter prm14 = new OracleParameter("adcat5", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = adcat5;
                objOraclecommand.Parameters.Add(prm14);
                /*   if (adcat5 == "")
                {
                    objOraclecommand.Parameters["@adcat5"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat5"].Value = adcat5;
                }
*/

                OracleParameter prm15 = new OracleParameter("adtype1", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = adtype;
                objOraclecommand.Parameters.Add(prm15);
                OracleParameter prm16 = new OracleParameter("prem", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = prem;
                objOraclecommand.Parameters.Add(prm16);


                OracleParameter prm17 = new OracleParameter("uom", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = uom;
                objOraclecommand.Parameters.Add(prm17);

                OracleParameter prm18 = new OracleParameter("clientname", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;
                prm18.Value = clientname;
                objOraclecommand.Parameters.Add(prm18);
                OracleParameter prm19 = new OracleParameter("uomdesc", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                prm19.Value = uomdesc;
                objOraclecommand.Parameters.Add(prm19);

                OracleParameter prm20 = new OracleParameter("openreferExtra", OracleType.VarChar);
                prm20.Direction = ParameterDirection.Input;
                prm20.Value = openreferExtra;
                objOraclecommand.Parameters.Add(prm20);


                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("p_accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts2"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts3", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts3"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts4", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts4"].Direction = ParameterDirection.Output;




                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }



        public DataSet boxbind(string compcode, string center)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("boxbind.boxbind_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("center", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = center;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }

        public DataSet bindagency(string compcode, string userid, string agency, string center)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("bindagencyforbooking.bindagencyforbooking_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("userid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = userid;
                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("agency", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = agency;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("pubcenter", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = center;
                objOraclecommand.Parameters.Add(prm4);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet bindagency_DJ(string compcode, string userid, string agency, string pubcenter, string branch, string center, string loginth, string publication)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("bindagencyforbooking_DJ", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("userid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = userid;
                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("agency", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = agency;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("pubcenter", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = pubcenter;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm31 = new OracleParameter("branch", OracleType.VarChar);
                prm31.Direction = ParameterDirection.Input;
                prm31.Value = branch;
                objOraclecommand.Parameters.Add(prm31);

                OracleParameter prm41 = new OracleParameter("center", OracleType.VarChar);
                prm41.Direction = ParameterDirection.Input;
                prm41.Value = center;
                objOraclecommand.Parameters.Add(prm41);

                OracleParameter prm5 = new OracleParameter("loginth", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = loginth;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("publication", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = publication;
                objOraclecommand.Parameters.Add(prm6);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        /*+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/

        public DataSet bind10agency_new(string compcode, string userid, string agency, string center)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("bind10agencyforbooking_new", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("userid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = userid;
                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("agency", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = agency;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("pubcenter", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = center;
                objOraclecommand.Parameters.Add(prm4);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }




        public DataSet bindagency_new(string compcode, string userid, string agency, string center)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("bindagencyforbooking_new.bindagencyforbooking_new_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("userid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = userid;
                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("agency", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = agency;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("pubcenter", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = center;
                objOraclecommand.Parameters.Add(prm4);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }


        public DataSet getClientNameadd(string client, string compcode, string value, string datecheck)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getclientnameadd.getclientnameadd_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("client", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = client;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("value", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = value;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("datecheck", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = datecheck;
                objOraclecommand.Parameters.Add(prm4);

                objOraclecommand.Parameters.Add("p_account", OracleType.Cursor);
                objOraclecommand.Parameters["p_account"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }


        }


        public DataSet chkrategroup(string color, string adcat, string adsucat, string package, string ratecode, string selecdate, string currency, string adtype, string compcode, string agency, string client, string dateformat)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("chkrategroupcode.chkrategroupcode_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("package1", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = package;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("agency", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = agency;
                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("ratecode11", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = ratecode;
                objOraclecommand.Parameters.Add(prm3);
                OracleParameter prm4 = new OracleParameter("selecdate", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                if (selecdate == "" || selecdate == null)
                {
                    prm4.Value = System.DBNull.Value;

                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = selecdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        selecdate = mm + "/" + dd + "/" + yy;
                    }
                    prm4.Value = Convert.ToDateTime(selecdate).ToString("dd-MMMM-yyyy");
                }

                //  prm4.Value = selecdate;

                objOraclecommand.Parameters.Add(prm4);
                OracleParameter prm5 = new OracleParameter("adtype1", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = adtype;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("compcode", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = compcode;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("client", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = client;
                objOraclecommand.Parameters.Add(prm7);


                OracleParameter prm8 = new OracleParameter("adsucat", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = adsucat;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("color", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = color;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("adcat1", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = adcat;
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("currency", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = currency;
                objOraclecommand.Parameters.Add(prm11);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("p_accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts2"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("p_accounts3", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts3"].Direction = ParameterDirection.Output;





                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }




        /*********************************************************/
        /********************/

        public DataSet insertbook_ins_Bill(string insertdate, string edition, string premium1, string premium2, string premallow, string adcategory, string latestdate, string material, string cardrate, string matfilename, string discrate, string insertstatus, string billstatus, string adsubcat, string compcode, string userid, string cioid, string height, string width, string totalsize, string pagepost, string premper1, string premper2, string colid, string repeat, string insertno, string paid, string agrrate, string solorate, string grossrate, string insert_pageno, string insert_remarks, string page_code, string page_per, string noofcol, string billamt, string billrate, string logo_h, string logo_w, string logo_name, string dateformat, string adcat3, string adcat4, string adcat5, string pkgcode, string gridins, string pkgalias, string oldbillno, string oldbilldate)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("insertintobookchild.insertintobookchild_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm2 = new OracleParameter("insertdate", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;

                if (insertdate == "" || insertdate == null)
                {
                    prm2.Value = System.DBNull.Value;
                }
                else
                {



                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = insertdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        insertdate = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = insertdate.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        insertdate = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = insertdate.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            insertdate = mm + "/" + dd + "/" + yy;
                    //        }
                    prm2.Value = Convert.ToDateTime(insertdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm3 = new OracleParameter("edition", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = edition;
                objOraclecommand.Parameters.Add(prm3);






                OracleParameter prm4 = new OracleParameter("premium1", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = premium1;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("premium2", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = premium2;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("premallow", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = premallow;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("adcategory", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = adcategory;
                objOraclecommand.Parameters.Add(prm7);


                OracleParameter prm8 = new OracleParameter("latestdate", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;


                if (latestdate == "" || latestdate == null)
                {
                    prm8.Value = System.DBNull.Value;
                }
                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = latestdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        latestdate = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = latestdate.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        latestdate = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = latestdate.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            latestdate = mm + "/" + dd + "/" + yy;
                    //        }
                    prm8.Value = Convert.ToDateTime(latestdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("material", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = material;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("cardrate", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;


                if (cardrate == "" || cardrate == null)
                {
                    prm10.Value = System.DBNull.Value;
                }
                else
                {
                    prm10.Value = Convert.ToDecimal(cardrate);
                }
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("matfilename", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = matfilename;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm12 = new OracleParameter("discrate", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;


                if (discrate == "" || discrate == null || discrate == "null")
                {
                    prm12.Value = System.DBNull.Value;
                }
                else
                {
                    prm12.Value = Convert.ToDecimal(discrate);
                }
                objOraclecommand.Parameters.Add(prm12);
                /*==========================================================================================*/

                OracleParameter prm13 = new OracleParameter("insertstatus", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = insertstatus;
                objOraclecommand.Parameters.Add(prm13);

                OracleParameter prm14 = new OracleParameter("billstatus", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = billstatus;
                objOraclecommand.Parameters.Add(prm14);

                OracleParameter prm15 = new OracleParameter("adsubcat1", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = adsubcat;
                objOraclecommand.Parameters.Add(prm15);

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);




                OracleParameter prm16 = new OracleParameter("userid", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = userid;
                objOraclecommand.Parameters.Add(prm16);

                OracleParameter prm17 = new OracleParameter("cioid", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = cioid;
                objOraclecommand.Parameters.Add(prm17);


                OracleParameter prm18 = new OracleParameter("height", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;


                if (height == "" || height == null)
                {
                    prm18.Value = System.DBNull.Value;
                }
                else
                {
                    prm18.Value = Convert.ToDecimal(height);
                }
                objOraclecommand.Parameters.Add(prm18);

                OracleParameter prm19 = new OracleParameter("width", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                if (width == "" || width == null)
                {
                    prm19.Value = System.DBNull.Value;
                }
                else
                {
                    prm19.Value = Convert.ToDecimal(width);
                }
                objOraclecommand.Parameters.Add(prm19);


                OracleParameter prm20 = new OracleParameter("totalsize", OracleType.VarChar);
                prm20.Direction = ParameterDirection.Input;
                if (totalsize == "" || totalsize == null)
                {
                    prm20.Value = System.DBNull.Value;
                }
                else
                {
                    prm20.Value = Convert.ToDecimal(totalsize);
                }
                objOraclecommand.Parameters.Add(prm20);


                OracleParameter prm21 = new OracleParameter("pagepost", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = pagepost;
                objOraclecommand.Parameters.Add(prm21);

                OracleParameter prm22 = new OracleParameter("premper1", OracleType.VarChar);
                prm22.Direction = ParameterDirection.Input;
                if (premper1 == "" || premper1 == null || premper1 == "null")
                {
                    prm22.Value = System.DBNull.Value;
                }
                else
                {
                    prm22.Value = Convert.ToDecimal(premper1);
                }
                objOraclecommand.Parameters.Add(prm22);




                OracleParameter prm23 = new OracleParameter("premper2", OracleType.VarChar);
                prm23.Direction = ParameterDirection.Input;
                if (premper2 == "" || premper2 == null)
                {
                    prm23.Value = System.DBNull.Value;
                }
                else
                {
                    prm23.Value = Convert.ToDecimal(premper2);
                }
                objOraclecommand.Parameters.Add(prm23);


                OracleParameter prm24 = new OracleParameter("colid", OracleType.VarChar);
                prm24.Direction = ParameterDirection.Input;
                prm24.Value = colid;
                objOraclecommand.Parameters.Add(prm24);

                OracleParameter prm25 = new OracleParameter("repeat", OracleType.VarChar);
                prm25.Direction = ParameterDirection.Input;
                if (repeat == "" || repeat == null)
                {
                    prm25.Value = System.DBNull.Value;
                }
                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = repeat.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        repeat = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = repeat.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        repeat = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = repeat.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            repeat = mm + "/" + dd + "/" + yy;
                    //        }
                    prm25.Value = Convert.ToDateTime(repeat).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm25);


                OracleParameter prm26 = new OracleParameter("insertno", OracleType.VarChar);
                prm26.Direction = ParameterDirection.Input;
                if (insertno == "" || insertno == null)
                {
                    prm26.Value = System.DBNull.Value;
                }
                else
                {
                    prm26.Value = Convert.ToInt32(insertno);
                }
                objOraclecommand.Parameters.Add(prm26);


                OracleParameter prm27 = new OracleParameter("paid", OracleType.VarChar);
                prm27.Direction = ParameterDirection.Input;
                prm27.Value = paid;
                objOraclecommand.Parameters.Add(prm27);

                OracleParameter prm28 = new OracleParameter("agrrate", OracleType.VarChar);
                prm28.Direction = ParameterDirection.Input;
                if (agrrate == "" || agrrate == null || agrrate == "null")
                {
                    prm28.Value = System.DBNull.Value;
                }
                else
                {
                    prm28.Value = Convert.ToDecimal(agrrate);
                }

                objOraclecommand.Parameters.Add(prm28);






                OracleParameter prm29 = new OracleParameter("solorate", OracleType.VarChar);
                prm29.Direction = ParameterDirection.Input;
                if (solorate == "" || solorate == null || solorate == "null")
                {
                    prm29.Value = System.DBNull.Value;
                }
                else
                {
                    prm29.Value = Convert.ToDecimal(solorate);
                }

                objOraclecommand.Parameters.Add(prm29);


                OracleParameter prm30 = new OracleParameter("grossrate", OracleType.VarChar);
                prm30.Direction = ParameterDirection.Input;
                if (grossrate == "" || grossrate == null)
                {
                    prm30.Value = System.DBNull.Value;
                }
                else
                {
                    prm30.Value = Convert.ToDecimal(grossrate);
                }
                objOraclecommand.Parameters.Add(prm30);

                OracleParameter prm31 = new OracleParameter("insert_pageno", OracleType.VarChar);
                prm31.Direction = ParameterDirection.Input;
                if (insert_pageno == "" || insert_pageno == null)
                {
                    prm31.Value = Convert.ToInt32("0");
                }
                else
                {
                    prm31.Value = Convert.ToInt32(insert_pageno);
                }
                objOraclecommand.Parameters.Add(prm31);


                OracleParameter prm32 = new OracleParameter("insert_remarks", OracleType.VarChar);
                prm32.Direction = ParameterDirection.Input;
                prm32.Value = insert_remarks;
                objOraclecommand.Parameters.Add(prm32);

                OracleParameter prm34 = new OracleParameter("page_code", OracleType.VarChar);
                prm34.Direction = ParameterDirection.Input;
                prm34.Value = page_code;
                objOraclecommand.Parameters.Add(prm34);

                OracleParameter prm33 = new OracleParameter("page_per", OracleType.VarChar);
                prm33.Direction = ParameterDirection.Input;
                if (page_per == "" || page_per == null || page_per == "null")
                {
                    prm33.Value = System.DBNull.Value;
                }
                else
                {
                    prm33.Value = Convert.ToDecimal(page_per);
                }
                objOraclecommand.Parameters.Add(prm33);

                OracleParameter prm35 = new OracleParameter("noofcol", OracleType.VarChar);
                prm35.Direction = ParameterDirection.Input;
                if (noofcol == "" || noofcol == null)
                {
                    prm35.Value = System.DBNull.Value;
                }
                else
                {
                    prm35.Value = Convert.ToDecimal(noofcol);
                }
                objOraclecommand.Parameters.Add(prm35);

                OracleParameter prm36 = new OracleParameter("billamt", OracleType.VarChar);
                prm36.Direction = ParameterDirection.Input;
                if (billamt == "" || billamt == null)
                {
                    prm36.Value = System.DBNull.Value;
                }
                else
                {
                    prm36.Value = Convert.ToDecimal(billamt);
                }
                objOraclecommand.Parameters.Add(prm36);

                OracleParameter prm37 = new OracleParameter("billrate", OracleType.VarChar);
                prm37.Direction = ParameterDirection.Input;
                if (billrate == "" || billrate == null)
                {
                    prm37.Value = System.DBNull.Value;
                }
                else
                {
                    prm37.Value = Convert.ToDecimal(billrate);
                }
                objOraclecommand.Parameters.Add(prm37);

                OracleParameter prm40 = new OracleParameter("logo_h", OracleType.VarChar);
                prm40.Direction = ParameterDirection.Input;
                prm40.Value = logo_h;
                objOraclecommand.Parameters.Add(prm40);

                OracleParameter prm38 = new OracleParameter("logo_w", OracleType.VarChar);
                prm38.Direction = ParameterDirection.Input;
                prm38.Value = logo_w;
                objOraclecommand.Parameters.Add(prm38);

                OracleParameter prm39 = new OracleParameter("logo_name", OracleType.VarChar);
                prm39.Direction = ParameterDirection.Input;
                prm39.Value = logo_name;
                objOraclecommand.Parameters.Add(prm39);

                OracleParameter prm43 = new OracleParameter("ad_cat_3", OracleType.VarChar);
                prm43.Direction = ParameterDirection.Input;
                prm43.Value = adcat3;
                objOraclecommand.Parameters.Add(prm43);

                OracleParameter prm41 = new OracleParameter("ad_cat_4", OracleType.VarChar);
                prm41.Direction = ParameterDirection.Input;
                prm41.Value = adcat4;
                objOraclecommand.Parameters.Add(prm41);

                OracleParameter prm42 = new OracleParameter("ad_cat_5", OracleType.VarChar);
                prm42.Direction = ParameterDirection.Input;
                prm42.Value = adcat5;
                objOraclecommand.Parameters.Add(prm42);
                //objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                //objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                OracleParameter prm44 = new OracleParameter("pkgcode", OracleType.VarChar);
                prm44.Direction = ParameterDirection.Input;
                prm44.Value = pkgcode;
                objOraclecommand.Parameters.Add(prm44);

                OracleParameter prm45 = new OracleParameter("gridins", OracleType.Number);
                prm45.Direction = ParameterDirection.Input;
                if (gridins == "")
                {
                    gridins = "1";
                }
                prm45.Value = gridins;
                objOraclecommand.Parameters.Add(prm45);

                OracleParameter prm46 = new OracleParameter("pkgalias", OracleType.VarChar);
                prm46.Direction = ParameterDirection.Input;
                prm46.Value = pkgalias;
                objOraclecommand.Parameters.Add(prm46);

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }

        public DataSet insertbook_ins_display(string insertdate, string edition, string premium1, string premium2, string premallow, string adcategory, string latestdate, string material, string cardrate, string matfilename, string discrate, string insertstatus, string billstatus, string adsubcat, string compcode, string userid, string cioid, string height, string width, string totalsize, string pagepost, string premper1, string premper2, string colid, string repeat, string insertno, string paid, string agrrate, string solorate, string grossrate, string insert_pageno, string insert_remarks, string page_code, string page_per, string noofcol, string billamt, string billrate, string logo_h, string logo_w, string logo_name, string dateformat, string adcat3, string adcat4, string adcat5, string pkgcode, string gridins, string pkgalias, string insertid, string cirvts, string cirpub, string ciredi, string cirrate, string cirdate, string ciragency, string ciragencysubcode, string center, string branch, string vatrate, string boxcharge, string vat_inc_p, string grossamtlocal_p, string billamtlocal_p, string sectioncode_p, string resourceno_p, string caption_inserts, string dealerheight, string dealerwidth, string subedidata, string disc_, string modifyrateaudit, string ip)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("insertintobookchild_display.insertintobookchild_display_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm2 = new OracleParameter("insertdate", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;

                if (insertdate == "" || insertdate == null)
                {
                    prm2.Value = System.DBNull.Value;
                }
                else
                {



                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = insertdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        insertdate = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = insertdate.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        insertdate = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = insertdate.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            insertdate = mm + "/" + dd + "/" + yy;
                    //        }
                    prm2.Value = Convert.ToDateTime(insertdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm3 = new OracleParameter("edition", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = edition;
                objOraclecommand.Parameters.Add(prm3);






                OracleParameter prm4 = new OracleParameter("premium1", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = premium1;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("premium2", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = premium2;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("premallow", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = premallow;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("adcategory", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = adcategory;
                objOraclecommand.Parameters.Add(prm7);


                OracleParameter prm8 = new OracleParameter("latestdate", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;


                if (latestdate == "" || latestdate == null)
                {
                    prm8.Value = System.DBNull.Value;
                }
                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = latestdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        latestdate = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = latestdate.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        latestdate = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = latestdate.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            latestdate = mm + "/" + dd + "/" + yy;
                    //        }
                    prm8.Value = Convert.ToDateTime(latestdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("material", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = material;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("cardrate", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;


                if (cardrate == "" || cardrate == null)
                {
                    prm10.Value = System.DBNull.Value;
                }
                else
                {
                    prm10.Value = Convert.ToDecimal(cardrate);
                }
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("matfilename", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = matfilename;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm12 = new OracleParameter("discrate", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;


                if (discrate == "" || discrate == null || discrate == "null")
                {
                    prm12.Value = System.DBNull.Value;
                }
                else
                {
                    prm12.Value = Convert.ToDecimal(discrate);
                }
                objOraclecommand.Parameters.Add(prm12);
                /*==========================================================================================*/

                OracleParameter prm13 = new OracleParameter("insertstatus", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = insertstatus;
                objOraclecommand.Parameters.Add(prm13);

                OracleParameter prm14 = new OracleParameter("billstatus", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = billstatus;
                objOraclecommand.Parameters.Add(prm14);

                OracleParameter prm15 = new OracleParameter("adsubcat1", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = adsubcat;
                objOraclecommand.Parameters.Add(prm15);

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);




                OracleParameter prm16 = new OracleParameter("userid", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = userid;
                objOraclecommand.Parameters.Add(prm16);

                OracleParameter prm17 = new OracleParameter("cioid", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = cioid;
                objOraclecommand.Parameters.Add(prm17);


                OracleParameter prm18 = new OracleParameter("height", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;


                if (height == "" || height == null)
                {
                    prm18.Value = System.DBNull.Value;
                }
                else
                {
                    prm18.Value = Convert.ToDecimal(height);
                }
                objOraclecommand.Parameters.Add(prm18);

                OracleParameter prm19 = new OracleParameter("width", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                if (width == "" || width == null)
                {
                    prm19.Value = System.DBNull.Value;
                }
                else
                {
                    prm19.Value = Convert.ToDecimal(width);
                }
                objOraclecommand.Parameters.Add(prm19);


                OracleParameter prm20 = new OracleParameter("totalsize", OracleType.VarChar);
                prm20.Direction = ParameterDirection.Input;
                if (totalsize == "" || totalsize == null)
                {
                    prm20.Value = System.DBNull.Value;
                }
                else
                {
                    prm20.Value = Convert.ToDecimal(totalsize);
                }
                objOraclecommand.Parameters.Add(prm20);


                OracleParameter prm21 = new OracleParameter("pagepost", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = pagepost;
                objOraclecommand.Parameters.Add(prm21);

                OracleParameter prm22 = new OracleParameter("premper1", OracleType.VarChar);
                prm22.Direction = ParameterDirection.Input;
                if (premper1 == "" || premper1 == null || premper1 == "null")
                {
                    prm22.Value = System.DBNull.Value;
                }
                else
                {
                    prm22.Value = Convert.ToDecimal(premper1);
                }
                objOraclecommand.Parameters.Add(prm22);




                OracleParameter prm23 = new OracleParameter("premper2", OracleType.VarChar);
                prm23.Direction = ParameterDirection.Input;
                if (premper2 == "" || premper2 == null || premper2 == "null")
                {
                    prm23.Value = System.DBNull.Value;
                }
                else
                {
                    prm23.Value = Convert.ToDecimal(premper2);
                }
                objOraclecommand.Parameters.Add(prm23);


                OracleParameter prm24 = new OracleParameter("colid", OracleType.VarChar);
                prm24.Direction = ParameterDirection.Input;
                prm24.Value = colid;
                objOraclecommand.Parameters.Add(prm24);

                OracleParameter prm25 = new OracleParameter("repeat", OracleType.VarChar);
                prm25.Direction = ParameterDirection.Input;
                if (repeat == "" || repeat == null)
                {
                    prm25.Value = System.DBNull.Value;
                }
                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = repeat.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        repeat = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = repeat.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        repeat = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = repeat.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            repeat = mm + "/" + dd + "/" + yy;
                    //        }
                    prm25.Value = Convert.ToDateTime(repeat).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm25);


                OracleParameter prm26 = new OracleParameter("insertno", OracleType.VarChar);
                prm26.Direction = ParameterDirection.Input;
                if (insertno == "" || insertno == null)
                {
                    prm26.Value = System.DBNull.Value;
                }
                else
                {
                    prm26.Value = Convert.ToInt32(insertno);
                }
                objOraclecommand.Parameters.Add(prm26);


                OracleParameter prm27 = new OracleParameter("paid", OracleType.VarChar);
                prm27.Direction = ParameterDirection.Input;
                prm27.Value = paid;
                objOraclecommand.Parameters.Add(prm27);

                OracleParameter prm28 = new OracleParameter("agrrate", OracleType.VarChar);
                prm28.Direction = ParameterDirection.Input;
                if (agrrate == "" || agrrate == null || agrrate == "null")
                {
                    prm28.Value = System.DBNull.Value;
                }
                else
                {
                    prm28.Value = Convert.ToDecimal(agrrate);
                }

                objOraclecommand.Parameters.Add(prm28);






                OracleParameter prm29 = new OracleParameter("solorate", OracleType.VarChar);
                prm29.Direction = ParameterDirection.Input;
                if (solorate == "" || solorate == null || solorate == "null")
                {
                    prm29.Value = System.DBNull.Value;
                }
                else
                {
                    prm29.Value = Convert.ToDecimal(solorate);
                }

                objOraclecommand.Parameters.Add(prm29);


                OracleParameter prm30 = new OracleParameter("grossrate", OracleType.VarChar);
                prm30.Direction = ParameterDirection.Input;
                if (grossrate == "" || grossrate == null)
                {
                    prm30.Value = System.DBNull.Value;
                }
                else
                {
                    prm30.Value = Convert.ToDecimal(grossrate);
                }
                objOraclecommand.Parameters.Add(prm30);

                OracleParameter prm31 = new OracleParameter("insert_pageno", OracleType.VarChar);
                prm31.Direction = ParameterDirection.Input;
                if (insert_pageno == "" || insert_pageno == null)
                {
                    prm31.Value = Convert.ToInt32("0");
                }
                else
                {
                    prm31.Value = Convert.ToInt32(insert_pageno);
                }
                objOraclecommand.Parameters.Add(prm31);


                OracleParameter prm32 = new OracleParameter("insert_remarks", OracleType.VarChar);
                prm32.Direction = ParameterDirection.Input;
                prm32.Value = insert_remarks;
                objOraclecommand.Parameters.Add(prm32);

                OracleParameter prm34 = new OracleParameter("page_code", OracleType.VarChar);
                prm34.Direction = ParameterDirection.Input;
                prm34.Value = page_code;
                objOraclecommand.Parameters.Add(prm34);

                OracleParameter prm33 = new OracleParameter("page_per", OracleType.VarChar);
                prm33.Direction = ParameterDirection.Input;
                if (page_per == "" || page_per == null || page_per == "null")
                {
                    prm33.Value = System.DBNull.Value;
                }
                else
                {
                    prm33.Value = Convert.ToDecimal(page_per);
                }
                objOraclecommand.Parameters.Add(prm33);

                OracleParameter prm35 = new OracleParameter("noofcol", OracleType.VarChar);
                prm35.Direction = ParameterDirection.Input;
                if (noofcol == "" || noofcol == null)
                {
                    prm35.Value = System.DBNull.Value;
                }
                else
                {
                    prm35.Value = Convert.ToDecimal(noofcol);
                }
                objOraclecommand.Parameters.Add(prm35);

                OracleParameter prm36 = new OracleParameter("billamt", OracleType.VarChar);
                prm36.Direction = ParameterDirection.Input;
                if (billamt == "" || billamt == null)
                {
                    prm36.Value = System.DBNull.Value;
                }
                else
                {
                    prm36.Value = Convert.ToDecimal(billamt);
                }
                objOraclecommand.Parameters.Add(prm36);

                OracleParameter prm37 = new OracleParameter("billrate", OracleType.VarChar);
                prm37.Direction = ParameterDirection.Input;
                if (billrate == "" || billrate == null)
                {
                    prm37.Value = System.DBNull.Value;
                }
                else
                {
                    prm37.Value = Convert.ToDecimal(billrate);
                }
                objOraclecommand.Parameters.Add(prm37);

                OracleParameter prm40 = new OracleParameter("logo_h", OracleType.VarChar);
                prm40.Direction = ParameterDirection.Input;
                prm40.Value = logo_h;
                objOraclecommand.Parameters.Add(prm40);

                OracleParameter prm38 = new OracleParameter("logo_w", OracleType.VarChar);
                prm38.Direction = ParameterDirection.Input;
                prm38.Value = logo_w;
                objOraclecommand.Parameters.Add(prm38);

                OracleParameter prm39 = new OracleParameter("logo_name", OracleType.VarChar);
                prm39.Direction = ParameterDirection.Input;
                prm39.Value = logo_name;
                objOraclecommand.Parameters.Add(prm39);

                OracleParameter prm43 = new OracleParameter("ad_cat_3", OracleType.VarChar);
                prm43.Direction = ParameterDirection.Input;
                prm43.Value = adcat3;
                objOraclecommand.Parameters.Add(prm43);

                OracleParameter prm41 = new OracleParameter("ad_cat_4", OracleType.VarChar);
                prm41.Direction = ParameterDirection.Input;
                prm41.Value = adcat4;
                objOraclecommand.Parameters.Add(prm41);

                OracleParameter prm42 = new OracleParameter("ad_cat_5", OracleType.VarChar);
                prm42.Direction = ParameterDirection.Input;
                prm42.Value = adcat5;
                objOraclecommand.Parameters.Add(prm42);
                //objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                //objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                OracleParameter prm44 = new OracleParameter("pkgcode", OracleType.VarChar);
                prm44.Direction = ParameterDirection.Input;
                prm44.Value = pkgcode;
                objOraclecommand.Parameters.Add(prm44);

                OracleParameter prm45 = new OracleParameter("gridins", OracleType.Number);
                prm45.Direction = ParameterDirection.Input;
                if (gridins == "")
                {
                    gridins = "1";
                }
                prm45.Value = gridins;
                objOraclecommand.Parameters.Add(prm45);

                OracleParameter prm46 = new OracleParameter("pkgalias", OracleType.VarChar);
                prm46.Direction = ParameterDirection.Input;
                prm46.Value = pkgalias;
                objOraclecommand.Parameters.Add(prm46);

                OracleParameter prm47 = new OracleParameter("insertid1", OracleType.VarChar);
                prm47.Direction = ParameterDirection.Input;
                if (insertid == "")
                    insertid = "0";
                prm47.Value = insertid;
                objOraclecommand.Parameters.Add(prm47);

                OracleParameter prm51 = new OracleParameter("cirvts", OracleType.VarChar);
                prm51.Direction = ParameterDirection.Input;
                if (cirvts == "null" || cirvts == null)
                    prm51.Value = System.DBNull.Value;
                else
                    prm51.Value = cirvts;
                objOraclecommand.Parameters.Add(prm51);

                OracleParameter prm48 = new OracleParameter("cirpub", OracleType.VarChar);
                prm48.Direction = ParameterDirection.Input;
                if (cirpub == "null" || cirpub == null)
                    prm48.Value = System.DBNull.Value;
                else
                    prm48.Value = cirpub;
                objOraclecommand.Parameters.Add(prm48);

                OracleParameter prm49 = new OracleParameter("ciredi", OracleType.VarChar);
                prm49.Direction = ParameterDirection.Input;
                if (cirpub == "null" || cirpub == null)
                    prm49.Value = System.DBNull.Value;
                else
                    prm49.Value = ciredi;
                objOraclecommand.Parameters.Add(prm49);

                OracleParameter prm50 = new OracleParameter("cirrate", OracleType.VarChar);
                prm50.Direction = ParameterDirection.Input;
                if (cirrate == "null" && cirrate == null)
                    prm50.Value = System.DBNull.Value;
                else
                    prm50.Value = cirrate;
                objOraclecommand.Parameters.Add(prm50);


                OracleParameter prm59 = new OracleParameter("cirdate_v", OracleType.VarChar);
                prm59.Direction = ParameterDirection.Input;
                if (cirdate == "" || cirdate == null)
                {
                    prm59.Value = System.DBNull.Value;
                }
                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = cirdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        cirdate = mm + "/" + dd + "/" + yy;


                    }
                    prm59.Value = Convert.ToDateTime(cirdate).ToString("dd-MMMM-yyyy");
                }

                objOraclecommand.Parameters.Add(prm59);

                OracleParameter prm52 = new OracleParameter("ciragency_v", OracleType.VarChar);
                prm52.Direction = ParameterDirection.Input;
                prm52.Value = ciragency;
                objOraclecommand.Parameters.Add(prm52);

                OracleParameter prm53 = new OracleParameter("ciragencysubcode_v", OracleType.VarChar);
                prm53.Direction = ParameterDirection.Input;
                prm53.Value = ciragencysubcode;
                objOraclecommand.Parameters.Add(prm53);

                OracleParameter prm54 = new OracleParameter("center_v", OracleType.VarChar);
                prm54.Direction = ParameterDirection.Input;
                prm54.Value = center;
                objOraclecommand.Parameters.Add(prm54);

                OracleParameter prm55 = new OracleParameter("branch_v", OracleType.VarChar);
                prm55.Direction = ParameterDirection.Input;
                prm55.Value = branch;
                objOraclecommand.Parameters.Add(prm55);


                OracleParameter prm60 = new OracleParameter("boxcharge_p", OracleType.Float);
                prm60.Direction = ParameterDirection.Input;
                if (boxcharge == "" || boxcharge == "null" || boxcharge == null || boxcharge == "0")
                    prm60.Value = System.DBNull.Value;
                else
                    prm60.Value = Convert.ToDecimal(boxcharge);
                objOraclecommand.Parameters.Add(prm60);

                OracleParameter prm61 = new OracleParameter("vat_inc_p", OracleType.Float);
                prm61.Direction = ParameterDirection.Input;
                if (vat_inc_p == "" || vat_inc_p == "null" || vat_inc_p == null || vat_inc_p == "undefined")
                    prm61.Value = System.DBNull.Value;
                else
                    prm61.Value = vat_inc_p;
                objOraclecommand.Parameters.Add(prm61);
                //OracleParameter prm58 = new OracleParameter("splboldsizevalue", OracleType.VarChar);
                //prm58.Direction = ParameterDirection.Input;
                //prm58.Value = System.DBNull.Value;
                //objOraclecommand.Parameters.Add(prm58);

                OracleParameter prm59a = new OracleParameter("vatrate_p", OracleType.Float);
                prm59a.Direction = ParameterDirection.Input;
                if (vatrate == "" || vatrate == "null" || vatrate == null || vatrate == "undefined")
                    prm59a.Value = System.DBNull.Value;
                else
                    prm59a.Value = Convert.ToDecimal(vatrate);
                objOraclecommand.Parameters.Add(prm59a);

                OracleParameter prm61a = new OracleParameter("grossamtlocal_p", OracleType.VarChar);
                prm61a.Direction = ParameterDirection.Input;
                if (grossamtlocal_p == "" || grossamtlocal_p == "null" || grossamtlocal_p == null)
                    prm61a.Value = System.DBNull.Value;
                else
                    prm61a.Value = grossamtlocal_p;
                objOraclecommand.Parameters.Add(prm61a);

                OracleParameter prm61b = new OracleParameter("billamtlocal_p", OracleType.VarChar);
                prm61b.Direction = ParameterDirection.Input;
                if (billamtlocal_p == "" || billamtlocal_p == "null" || billamtlocal_p == null)
                    prm61b.Value = System.DBNull.Value;
                else
                    prm61b.Value = billamtlocal_p;
                objOraclecommand.Parameters.Add(prm61b);

                OracleParameter prm61b1 = new OracleParameter("sectioncode_p", OracleType.VarChar);
                prm61b1.Direction = ParameterDirection.Input;
                if (sectioncode_p == "" || sectioncode_p == "null" || sectioncode_p == null)
                    prm61b1.Value = System.DBNull.Value;
                else
                    prm61b1.Value = sectioncode_p;
                objOraclecommand.Parameters.Add(prm61b1);


                OracleParameter prm61b11 = new OracleParameter("resourceno_p", OracleType.VarChar);
                prm61b11.Direction = ParameterDirection.Input;
                if (resourceno_p == "" || resourceno_p == "null" || resourceno_p == null)
                    prm61b11.Value = System.DBNull.Value;
                else
                    prm61b11.Value = resourceno_p;
                objOraclecommand.Parameters.Add(prm61b11);

                OracleParameter prm61b112 = new OracleParameter("caption_inserts_p", OracleType.VarChar);
                prm61b112.Direction = ParameterDirection.Input;
                if (caption_inserts == "" || caption_inserts == "null" || caption_inserts == null)
                    prm61b112.Value = System.DBNull.Value;
                else
                    prm61b112.Value = caption_inserts;
                objOraclecommand.Parameters.Add(prm61b112);

                OracleParameter prm61b13 = new OracleParameter("dealerheight", OracleType.VarChar);
                prm61b13.Direction = ParameterDirection.Input;
                if (dealerheight == "" || dealerheight == "null" || dealerheight == null)
                    prm61b13.Value = System.DBNull.Value;
                else
                    prm61b13.Value = dealerheight;
                objOraclecommand.Parameters.Add(prm61b13);

                OracleParameter prm61b14 = new OracleParameter("dealerwidth", OracleType.VarChar);
                prm61b14.Direction = ParameterDirection.Input;
                if (dealerwidth == "" || dealerwidth == "null" || dealerwidth == null)
                    prm61b14.Value = System.DBNull.Value;
                else
                    prm61b14.Value = dealerwidth;
                objOraclecommand.Parameters.Add(prm61b14);

                OracleParameter prm63 = new OracleParameter("subedidata", OracleType.VarChar);
                prm63.Direction = ParameterDirection.Input;
                prm63.Value = subedidata;
                objOraclecommand.Parameters.Add(prm63);

                OracleParameter prm61bx = new OracleParameter("disc_p", OracleType.VarChar);
                prm61bx.Direction = ParameterDirection.Input;
                if (disc_ == "" || disc_ == "null" || disc_ == null)
                    prm61bx.Value = System.DBNull.Value;
                else
                    prm61bx.Value = disc_;
                objOraclecommand.Parameters.Add(prm61bx);

                OracleParameter prm151b = new OracleParameter("P_ip", OracleType.VarChar);
                prm151b.Direction = ParameterDirection.Input;
                prm151b.Value = ip;
                objOraclecommand.Parameters.Add(prm151b);

                OracleParameter prm161b = new OracleParameter("P_RATE_AUDIT_FLAG", OracleType.VarChar);
                prm161b.Direction = ParameterDirection.Input;
                prm161b.Value = modifyrateaudit;
                objOraclecommand.Parameters.Add(prm161b);

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }


        public DataSet forwalkclient(string client, string compcode)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("chkforwalkinnclient.chkforwalkinnclient_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);


                OracleParameter prm2 = new OracleParameter("client", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = client;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }


        }


        public DataSet fetchdataforexeBill(string ciobid, string compcode)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getdataforexecuteBill.getdataforexecuteBill_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);


                OracleParameter prm2 = new OracleParameter("ciobid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = ciobid;
                objOraclecommand.Parameters.Add(prm2);
                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts2"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_accounts3", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts3"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_accounts4", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts4"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_accounts5", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts5"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_accounts6", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts6"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_accounts7", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts7"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_accounts8", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts8"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts9", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts9"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_accounts10", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts10"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts11", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts11"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_accounts12", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts12"].Direction = ParameterDirection.Output;


                //if (objDataSet.Tables[0].Rows.Count > 0)
                //{
                //    zonename = objDataSet.Tables[0].Rows[0].ItemArray[0].ToString();
                //}

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }


        }
        public DataSet fetchdataforexe(string ciobid, string compcode)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getdataforexecute.getdataforexecute_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);


                OracleParameter prm2 = new OracleParameter("ciobid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = ciobid;
                objOraclecommand.Parameters.Add(prm2);
                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts2"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_accounts3", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts3"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_accounts4", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts4"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_accounts5", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts5"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_accounts6", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts6"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_accounts7", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts7"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_accounts8", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts8"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts9", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts9"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_accounts10", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts10"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts11", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts11"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_accounts12", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts12"].Direction = ParameterDirection.Output;


                //if (objDataSet.Tables[0].Rows.Count > 0)
                //{
                //    zonename = objDataSet.Tables[0].Rows[0].ItemArray[0].ToString();
                //}

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }


        }
        public DataSet getagencyname(string agency, string compcode, string product, string execname)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("chkagen_prod_exec.chkagen_prod_exec_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;
                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);


                OracleParameter prm2 = new OracleParameter("agency", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = agency;
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm3 = new OracleParameter("product", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = product;
                objOraclecommand.Parameters.Add(prm3);
                OracleParameter prm4 = new OracleParameter("execname", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = execname;
                objOraclecommand.Parameters.Add(prm4);


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }

        public DataSet getpageamt(string pagecode, string compcode)//, string bookingdate, string dateformat)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getpageamount.getpageamount_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);


                OracleParameter prm2 = new OracleParameter("pagecode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = pagecode;
                objOraclecommand.Parameters.Add(prm2);

                /*  OracleParameter prm4 = new OracleParameter("bookingdate", OracleType.VarChar);
                  prm4.Direction = ParameterDirection.Input;
                  if (bookingdate == "")
                  {
                      prm4.Value = System.DBNull.Value;
                  }
                  else
                  {
                      if (dateformat == "dd/mm/yyyy")
                      {
                          string[] arr = bookingdate.Split('/');
                          string dd = arr[0];
                          string mm = arr[1];
                          string yy = arr[2];
                          bookingdate = mm + "/" + dd + "/" + yy;
                      }
                      prm4.Value = Convert.ToDateTime(bookingdate).ToString("dd-MMMM-yyyy");
                  }
                  objOraclecommand.Parameters.Add(prm4);
                  */
                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }

        public DataSet packagebindforexebook(string compcode, string pckcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getpckexebook.getpckexebook_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);


                OracleParameter prm2 = new OracleParameter("pckcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = pckcode;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }


        public DataSet getdealvalue(string compcode, string agencysplit, string subagencycode, string bookingdate, string color, string curr, string adcat, string clientsplit, string prod, string col, string code, string rate_cod, string adtype, string dateformat, string totalarea, string dealtype)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("booking_getdeal_dummy.booking_getdeal_dummy_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);


                OracleParameter prm2 = new OracleParameter("agencysplit", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = agencysplit;
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm3 = new OracleParameter("subagencycode", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = subagencycode;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("bookingdate", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                if (bookingdate == "")
                {
                    prm4.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = bookingdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        bookingdate = mm + "/" + dd + "/" + yy;
                    }
                    prm4.Value = Convert.ToDateTime(bookingdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm4);
                OracleParameter prm5 = new OracleParameter("color", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = color;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("curr", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = curr;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("adcat1", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = adcat;
                objOraclecommand.Parameters.Add(prm7);


                OracleParameter prm8 = new OracleParameter("clientsplit", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = clientsplit;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("prod", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = prod;
                objOraclecommand.Parameters.Add(prm9);

                //OracleParameter prm10 = new OracleParameter("client", OracleType.VarChar);
                //prm10.Direction = ParameterDirection.Input;
                //prm10.Value = client;
                //objOraclecommand.Parameters.Add(prm10);


                OracleParameter prm11 = new OracleParameter("code", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = code;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm12 = new OracleParameter("rate_cod", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                if (rate_cod == "0" || rate_cod == "")
                    prm12.Value = System.DBNull.Value;
                else
                    prm12.Value = rate_cod;
                objOraclecommand.Parameters.Add(prm12);




                OracleParameter prm13 = new OracleParameter("adtype1", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = adtype;
                objOraclecommand.Parameters.Add(prm13);

                OracleParameter prm13a = new OracleParameter("totalarea", OracleType.VarChar);
                prm13a.Direction = ParameterDirection.Input;
                if (totalarea == "")
                    prm13a.Value = System.DBNull.Value;
                else
                    prm13a.Value = totalarea;
                objOraclecommand.Parameters.Add(prm13a);

                OracleParameter prm13b = new OracleParameter("dealtype", OracleType.VarChar);
                prm13b.Direction = ParameterDirection.Input;
                if (dealtype == "")
                    prm13b.Value = System.DBNull.Value;
                else
                    prm13b.Value = dealtype;
                objOraclecommand.Parameters.Add(prm13b);


                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;




                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }

        public DataSet booking_getdealdisc(string dealcode, string compcode, string agencysplit, string subagency, string clientsplit, string insertion, string contracttype)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("booking_getdeealdisc.booking_getdeealdisc_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);


                OracleParameter prm2 = new OracleParameter("agencysplit", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = agencysplit;
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm3 = new OracleParameter("subagency", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = subagency;
                objOraclecommand.Parameters.Add(prm3);
                OracleParameter prm4 = new OracleParameter("dealcode", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = dealcode;
                objOraclecommand.Parameters.Add(prm4);
                OracleParameter prm5 = new OracleParameter("clientsplit", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = clientsplit;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("insertion_p", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = insertion;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm61 = new OracleParameter("contracttype_p", OracleType.VarChar);
                prm61.Direction = ParameterDirection.Input;
                prm61.Value = contracttype;
                objOraclecommand.Parameters.Add(prm61);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }

        public DataSet schemebind(string adcat, string uom, string pkg, string color, string bookingdate)
        {

            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();

            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("bind_scheme", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm2 = new OracleParameter("pcategory", OracleType.VarChar, 50);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = adcat;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("puom", OracleType.VarChar, 50);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = uom;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("ppackage", OracleType.VarChar, 50);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = pkg;
                objOraclecommand.Parameters.Add(prm4);


                OracleParameter prm5 = new OracleParameter("pcolor", OracleType.VarChar, 50);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = color;
                objOraclecommand.Parameters.Add(prm5);


                OracleParameter prm6 = new OracleParameter("pbookingdate", OracleType.VarChar, 50);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = bookingdate;
                objOraclecommand.Parameters.Add(prm6);


                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);

                return objDataSet;

            }

            catch (Exception ex)
            {
                throw (ex);


            }

            finally
            {
                CloseConnection(ref objOracleConnection);

            }
        }

        public DataSet getschemedisc(string schemcode, string compcode, string noofinsert)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("booking_getschdisc.booking_getschdisc_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;
                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("noofinsert", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = noofinsert;
                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("schemcode", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = schemcode;
                objOraclecommand.Parameters.Add(prm3);

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet deleteid(string ciobookid, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("deletecioid.deletecioid_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("ciobookid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = ciobookid;
                objOraclecommand.Parameters.Add(prm2);

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public void clsInsertintoTemp(string ciobookid, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            //  DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            //  OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_InsertintoTemp", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("ciobookid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = ciobookid;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.ExecuteNonQuery();
                //objorclDataAdapter.SelectCommand = objOraclecommand;
                //objorclDataAdapter.Fill(objDataSet);
                //return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public void clsdeletefromtemp(string ciobookid, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            //  DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            //  OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_deletefromtemp", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("ciobookid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = ciobookid;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.ExecuteNonQuery();
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet bindvarient(string brand, string Compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("AN_BRANDVARIENT.AN_BRANDVARIENT_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;
                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = Compcode;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("brand", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = brand;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet bindsubagency(string agency, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("book_bindsubagency.book_bindsubagency_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("agency", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = agency;
                objOraclecommand.Parameters.Add(prm2);


                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }

        public DataSet getbillval(string agency, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();

                objOraclecommand = GetCommand("book_bindbillto.book_bindbillto_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("agency", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = agency;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }



        public DataSet chkclient(string client, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("book_chkcasualclient.book_chkcasualclient_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("client", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = client;
                objOraclecommand.Parameters.Add(prm2);


                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }

        public DataSet getinsertsche(string schemecode, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("book_getinsertscheme.book_getinsertscheme_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("schemecode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = schemecode;
                objOraclecommand.Parameters.Add(prm2);






                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet book_packagename(string value, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("book_packagename.book_packagename_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("value", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = value;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getCombinDesc(string pkgid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getCombinDesc", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pkgcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = pkgid;
                objOraclecommand.Parameters.Add(prm1);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet book_chkpublishday(string value, string compcode, string pkgname, string dateday, string dateformat, string adcat, string adtype1, string center, string pkgid, string pkgalias)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("book_chkpublishday.book_chkpublishday_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("value", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = value;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("pkgname", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = pkgname;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("dateday", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                if (dateday == "" || dateday == null || dateday == "null")
                {
                    prm4.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = dateday.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        dateday = mm + "/" + dd + "/" + yy;
                    }
                    prm4.Value = Convert.ToDateTime(dateday).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm4);

                //Convert.ToDateTime(todate).ToString("dd-MMMM-yyyy");


                OracleParameter prm5 = new OracleParameter("adcat", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = adcat;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("adtype1", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = adtype1;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("center", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = center;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("pkgid", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = pkgid;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("pkgalias", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                if (pkgalias == "")
                {
                    prm9.Value = System.DBNull.Value;
                }
                else
                {
                    prm9.Value = pkgalias;
                }
                objOraclecommand.Parameters.Add(prm9);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("P_Accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts1"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts2"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet getname(string curr, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("book_getcurrname.book_getcurrname_P", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("curr", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = curr;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        ///////////////these are the class file used in classified booking form]

        public DataSet getvalfromadcat3(string adcat, string compcode, string value)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("class_bindadcat3.class_bindadcat3_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("value", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = value;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("adcat1", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = adcat;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }

        public DataSet bgcolorbind(string compcode, string value, string date)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("class_bindbgcolor.class_bindbgcolor_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("value", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = value;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("date1", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                if (date == "" || date == null || date == "null")
                {
                    prm3.Value = System.DBNull.Value;
                }
                else
                {

                    string[] arr = date.Split('/');
                    string dd = arr[0];
                    string mm = arr[1];
                    string yy = arr[2];
                    date = mm + "/" + dd + "/" + yy;
                    prm3.Value = Convert.ToDateTime(date).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet bindpackage_category(string compcode, string adtype, string category)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {

                objOracleConnection.Open();
                objOraclecommand = GetCommand("bindpackageCategoryWise", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar, 50);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("adtype", OracleType.VarChar, 50);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = adtype;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("category", OracleType.VarChar, 50);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = category;
                objOraclecommand.Parameters.Add(prm4);



                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;




                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);

                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet bindpackage_category_DJ(string compcode, string adtype, string category, string branch, string center, string loginth, string publication)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {

                objOracleConnection.Open();
                objOraclecommand = GetCommand("bindpackageCategoryWise_DJ", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar, 50);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("adtype", OracleType.VarChar, 50);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = adtype;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("category", OracleType.VarChar, 50);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = category;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm31 = new OracleParameter("branch", OracleType.VarChar);
                prm31.Direction = ParameterDirection.Input;
                prm31.Value = branch;
                objOraclecommand.Parameters.Add(prm31);

                OracleParameter prm41 = new OracleParameter("center", OracleType.VarChar);
                prm41.Direction = ParameterDirection.Input;
                prm41.Value = center;
                objOraclecommand.Parameters.Add(prm41);

                OracleParameter prm5 = new OracleParameter("loginth", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = loginth;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("publication", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = publication;
                objOraclecommand.Parameters.Add(prm6);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;




                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);

                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet advdatacategory(string compcode, string booking)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {

                objOracleConnection.Open();


                if (booking == "adtype")
                {
                    objOraclecommand = GetCommand("book_advcategory1.book_advcategory1_p", ref objOracleConnection);
                    objOraclecommand.CommandType = CommandType.StoredProcedure;

                    OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar, 50);
                    prm2.Direction = ParameterDirection.Input;
                    prm2.Value = compcode;
                    objOraclecommand.Parameters.Add(prm2);

                    OracleParameter prm3 = new OracleParameter("booking", OracleType.VarChar, 50);
                    prm3.Direction = ParameterDirection.Input;
                    prm3.Value = booking;
                    objOraclecommand.Parameters.Add(prm3);

                    objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                    objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;
                }
                else
                {
                    objOraclecommand = GetCommand("book_advcategory.book_advcategory_p", ref objOracleConnection);
                    objOraclecommand.CommandType = CommandType.StoredProcedure;

                    OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar, 50);
                    prm2.Direction = ParameterDirection.Input;
                    prm2.Value = compcode;
                    objOraclecommand.Parameters.Add(prm2);

                    OracleParameter prm3 = new OracleParameter("booking", OracleType.VarChar, 50);
                    prm3.Direction = ParameterDirection.Input;
                    prm3.Value = booking;
                    objOraclecommand.Parameters.Add(prm3);

                    objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                    objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;

                    objOraclecommand.Parameters.Add("p_Accounts1", OracleType.Cursor);
                    objOraclecommand.Parameters["p_Accounts1"].Direction = ParameterDirection.Output;

                    objOraclecommand.Parameters.Add("p_Accounts2", OracleType.Cursor);
                    objOraclecommand.Parameters["p_Accounts2"].Direction = ParameterDirection.Output;
                }


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);

                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }


        }


        public DataSet chkfilename(string cioid, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("book_getfilename.book_getfilename_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("cioid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = cioid;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;





                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet getPkgDetail(string pkgname)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getPackageName.getPackageName_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;



                OracleParameter prm1 = new OracleParameter("pkgname", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = pkgname;
                objOraclecommand.Parameters.Add(prm1);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;




                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }


        }

        public DataSet getrotime(string Rohours, string Romin, string compcode, string publishdate, string packagename, string dateformat)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("book_chkrotime.book_chkrotime_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);


                OracleParameter prm2 = new OracleParameter("Rohours", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = Rohours;
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm3 = new OracleParameter("Romin", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = Romin;
                objOraclecommand.Parameters.Add(prm3);
                OracleParameter prm4 = new OracleParameter("publishdate", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                if (publishdate == "" || publishdate == null)
                {
                    prm4.Value = publishdate;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = publishdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        publishdate = mm + "/" + dd + "/" + yy;


                    }
                    prm4.Value = Convert.ToDateTime(publishdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm4);
                OracleParameter prm5 = new OracleParameter("packagename", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = packagename;
                objOraclecommand.Parameters.Add(prm5);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;




                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet book_bindpagetyp(string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("book_bindpagetyp.book_bindpagetyp_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet chkforspace(string page_no, string edit_name, string edit_date, string compcode, string nopag)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("book_chkspace.book_chkspace_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;
                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);


                OracleParameter prm2 = new OracleParameter("page_no", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = page_no;
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm3 = new OracleParameter("edit_name", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = edit_name;
                objOraclecommand.Parameters.Add(prm3);
                OracleParameter prm4 = new OracleParameter("edit_date", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = edit_date;
                objOraclecommand.Parameters.Add(prm4);
                OracleParameter prm5 = new OracleParameter("nopag", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = nopag;
                objOraclecommand.Parameters.Add(prm5);


                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;




                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);


            }

        }
        public DataSet advdatasubcatcat(string compcode, string catcode, string agencytype)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("book_advsubcattyp.book_advsubcattyp_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);


                OracleParameter prm2 = new OracleParameter("agencytype", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                if (agencytype == "")
                {
                    prm2.Value = System.DBNull.Value;
                }
                else
                {
                    prm2.Value = agencytype;
                }
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm3 = new OracleParameter("catcode", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = catcode;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts1"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }


        }

        public DataSet getInsertion_classified(string package, string noofinsertion, string insertiondate, string startdate, string dateformat, string compcode, string adcategory, string adsubcat, string color, string adtype, string currency, string ratecode, string clickdate, string flag, string code, string @pck, string uom, string dealrate, string checkforor, string classinserts, string lines, string adcat3, string adcat4, string adcat5, string clientcode)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {

                objOracleConnection.Open();
                objOraclecommand = GetCommand("bindClassifiedInsertion.bindClassifiedInsertion_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("package1", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = package;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("noofinsertion", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = noofinsertion;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("insertiondate", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = insertiondate;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("startdate", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = startdate;
                if (startdate == "" || startdate == null)
                {
                    prm4.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = startdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        startdate = mm + "/" + dd + "/" + yy;
                    }
                    prm4.Value = Convert.ToDateTime(startdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("dateformat", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = dateformat;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("compcode", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = compcode;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("adcategory", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = adcategory;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("adsubcat1", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = adsubcat;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("color", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = color;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("adtype1", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = adtype;
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("currency", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = currency;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm12 = new OracleParameter("ratecode11", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = ratecode;
                objOraclecommand.Parameters.Add(prm12);

                OracleParameter prm13 = new OracleParameter("clickdate", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = clickdate;
                if (clickdate == "" || clickdate == null)
                {
                    prm13.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = clickdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        clickdate = mm + "/" + dd + "/" + yy;
                    }
                    prm13.Value = Convert.ToDateTime(clickdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm13);

                OracleParameter prm14 = new OracleParameter("flag", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = flag;
                objOraclecommand.Parameters.Add(prm14);
                /*  if (flag == "" || flag == null)
                {
                    objOraclecommand.Parameters["@flag"].Value = System.DBNull.Value;
                }
                else
                {
                    objOraclecommand.Parameters["@flag"].Value = Convert.ToInt32(flag);
                }*/

                OracleParameter prm15 = new OracleParameter("code", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = code;
                objOraclecommand.Parameters.Add(prm15);

                OracleParameter prm16 = new OracleParameter("pck", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = pck;
                objOraclecommand.Parameters.Add(prm16);
                /*  if (pck == "" || pck == null)
                {
                    objOraclecommand.Parameters["@pck"].Value = System.DBNull.Value;
                }
                else
                {
                    objOraclecommand.Parameters["@pck"].Value = Convert.ToDecimal(pck);
                }
*/

                OracleParameter prm17 = new OracleParameter("uom", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = uom;
                objOraclecommand.Parameters.Add(prm17);

                OracleParameter prm18 = new OracleParameter("dealrate", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;
                prm18.Value = dealrate;
                objOraclecommand.Parameters.Add(prm18);
                /* if (dealrate == "" || dealrate == null)
                {
                    objOraclecommand.Parameters["@dealrate"].Value = System.DBNull.Value;
                }
                else
                {
                    objOraclecommand.Parameters["@dealrate"].Value = Convert.ToDecimal(dealrate);
                }*/

                OracleParameter prm19 = new OracleParameter("checkforor", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                prm19.Value = checkforor;
                objOraclecommand.Parameters.Add(prm19);

                OracleParameter prm20 = new OracleParameter("clientcode", OracleType.VarChar);
                prm20.Direction = ParameterDirection.Input;
                prm20.Value = clientcode;
                objOraclecommand.Parameters.Add(prm20);

                OracleParameter prm21 = new OracleParameter("classinserts", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = classinserts;
                objOraclecommand.Parameters.Add(prm21);


                OracleParameter prm22 = new OracleParameter("lines", OracleType.VarChar);
                prm22.Direction = ParameterDirection.Input;
                prm22.Value = lines;
                objOraclecommand.Parameters.Add(prm22);

                OracleParameter prm23 = new OracleParameter("adcat3", OracleType.VarChar);
                prm23.Direction = ParameterDirection.Input;
                prm23.Value = adcat3;
                objOraclecommand.Parameters.Add(prm23);
                /*if (adcat3 == "")
                {
                    objOraclecommand.Parameters["@adcat3"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat3"].Value = adcat3;
                }*/

                OracleParameter prm24 = new OracleParameter("adcat4", OracleType.VarChar);
                prm24.Direction = ParameterDirection.Input;
                prm24.Value = adcat4;
                objOraclecommand.Parameters.Add(prm24);
                /* if (adcat4 == "")
                {
                    objOraclecommand.Parameters["@adcat4"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat4"].Value = adcat4;
                }*/
                OracleParameter prm25 = new OracleParameter("adcat5", OracleType.VarChar);
                prm25.Direction = ParameterDirection.Input;
                prm25.Value = adcat5;
                objOraclecommand.Parameters.Add(prm25);
                /*if (adcat5 == "")
                {

                    objOraclecommand.Parameters["@adcat5"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat5"].Value = adcat5;
                 }
                 */

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts1"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts2"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts3", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts3"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts4", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts4"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts5", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts5"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts6", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts6"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts7", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts7"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts8", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts8"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts9", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts9"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts10", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts10"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts11", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts11"].Direction = ParameterDirection.Output;

                //objOraclecommand.Parameters.Add("P_Accounts12", OracleType.Cursor);
                //objOraclecommand.Parameters["P_Accounts12"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }


        public DataSet getInsertion_qbc(string package, string noofinsertion, string insertiondate, string startdate, string dateformat, string compcode, string adcategory, string adsubcat, string color, string adtype, string currency, string ratecode, string clickdate, string flag, string code, string pck, string uom, string dealrate, string checkforor, string classinserts, string lines, string adcat3, string adcat4, string adcat5, string clientcode, string uomdesc, string agencycode)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("qbc_insertsrate.qbc_insertsrate_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;
                string openreferExtra = ConfigurationSettings.AppSettings["openreferExtra"];


                OracleParameter prm1 = new OracleParameter("package1", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = package;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("noofinsertion", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = noofinsertion;
                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("insertiondate", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;

                /*change for oracle*/

                //////////////////////////////////////////




                ////////////////////////////////////////////

                prm3.Value = insertiondate;


                objOraclecommand.Parameters.Add(prm3);
                OracleParameter prm4 = new OracleParameter("startdate", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;

                if (dateformat == "dd/mm/yyyy" && startdate != "" && startdate != null)
                {
                    string[] arr = startdate.Split('/');
                    string dd = arr[0];
                    string mm = arr[1];
                    string yy = arr[2];
                    startdate = mm + "/" + dd + "/" + yy;
                }

                prm4.Value = Convert.ToDateTime(startdate).ToString("dd-MMMM-yyyy");
                objOraclecommand.Parameters.Add(prm4);


                OracleParameter prm5 = new OracleParameter("dateformat", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = dateformat;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("compcode", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = compcode;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("adcategory", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = adcategory;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("adsubcat", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = adsubcat;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("color", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = color;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("adtype", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = adtype;
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("currency", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = currency;
                objOraclecommand.Parameters.Add(prm11);


                OracleParameter prm12 = new OracleParameter("ratecode", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = ratecode;
                objOraclecommand.Parameters.Add(prm12);

                OracleParameter prm13 = new OracleParameter("clickdate", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                /*change for oracle*/
                if (dateformat == "dd/mm/yyyy" && clickdate != "" && clickdate != null)
                {
                    string[] arr = clickdate.Split('/');
                    string dd = arr[0];
                    string mm = arr[1];
                    string yy = arr[2];
                    clickdate = mm + "/" + dd + "/" + yy;

                }
                /*change for oracle*/
                if (clickdate == "")
                {
                    prm13.Value = System.DBNull.Value;

                }
                else
                {
                    prm13.Value = Convert.ToDateTime(clickdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm13);




                OracleParameter prm14 = new OracleParameter("flag", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = flag;
                objOraclecommand.Parameters.Add(prm14);
                /*  if (flag == "" || flag == null)
                {
                    objOraclecommand.Parameters["@flag"].Value = System.DBNull.Value;
                }
                else
                {
                    objOraclecommand.Parameters["@flag"].Value = Convert.ToInt32(flag);
                }*/

                OracleParameter prm15 = new OracleParameter("code", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = code;
                objOraclecommand.Parameters.Add(prm15);
                OracleParameter prm16 = new OracleParameter("pck", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = pck;
                objOraclecommand.Parameters.Add(prm16);
                /*  if (pck == "" || pck == null)
                {
                    objOraclecommand.Parameters["@pck"].Value = System.DBNull.Value;
                }
                else
                {
                    objOraclecommand.Parameters["@pck"].Value = Convert.ToDecimal(pck);
                }
*/

                OracleParameter prm17 = new OracleParameter("uom", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = uom;
                objOraclecommand.Parameters.Add(prm17);

                OracleParameter prm18 = new OracleParameter("dealrate", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;
                prm18.Value = dealrate;
                objOraclecommand.Parameters.Add(prm18);
                /* if (dealrate == "" || dealrate == null)
                {
                    objOraclecommand.Parameters["@dealrate"].Value = System.DBNull.Value;
                }
                else
                {
                    objOraclecommand.Parameters["@dealrate"].Value = Convert.ToDecimal(dealrate);
                }*/

                OracleParameter prm19 = new OracleParameter("checkforor", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                prm19.Value = checkforor;
                objOraclecommand.Parameters.Add(prm19);

                OracleParameter prm20 = new OracleParameter("clientcode", OracleType.VarChar);
                prm20.Direction = ParameterDirection.Input;
                prm20.Value = clientcode;
                objOraclecommand.Parameters.Add(prm20);

                OracleParameter prm21 = new OracleParameter("classinserts", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = classinserts;
                objOraclecommand.Parameters.Add(prm21);


                OracleParameter prm22 = new OracleParameter("lines", OracleType.VarChar);
                prm22.Direction = ParameterDirection.Input;
                prm22.Value = lines;
                objOraclecommand.Parameters.Add(prm22);

                OracleParameter prm23 = new OracleParameter("adcat3", OracleType.VarChar);
                prm23.Direction = ParameterDirection.Input;
                prm23.Value = adcat3;
                objOraclecommand.Parameters.Add(prm23);
                /*if (adcat3 == "")
                {
                    objOraclecommand.Parameters["@adcat3"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat3"].Value = adcat3;
                }*/

                OracleParameter prm24 = new OracleParameter("adcat4", OracleType.VarChar);
                prm24.Direction = ParameterDirection.Input;
                prm24.Value = adcat4;
                objOraclecommand.Parameters.Add(prm24);
                /* if (adcat4 == "")
                {
                    objOraclecommand.Parameters["@adcat4"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat4"].Value = adcat4;
                }*/
                OracleParameter prm25 = new OracleParameter("adcat5", OracleType.VarChar);
                prm25.Direction = ParameterDirection.Input;
                prm25.Value = adcat5;
                objOraclecommand.Parameters.Add(prm25);
                /*if (adcat5 == "")
                {

                    objOraclecommand.Parameters["@adcat5"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat5"].Value = adcat5;
                 }
                 */

                OracleParameter prm26 = new OracleParameter("uomdesc", OracleType.VarChar);
                prm26.Direction = ParameterDirection.Input;
                prm26.Value = uomdesc;
                objOraclecommand.Parameters.Add(prm26);

                OracleParameter prm27 = new OracleParameter("openreferExtra", OracleType.VarChar);
                prm27.Direction = ParameterDirection.Input;
                prm27.Value = openreferExtra;
                objOraclecommand.Parameters.Add(prm27);

                OracleParameter prm28 = new OracleParameter("agencycode", OracleType.VarChar);
                prm28.Direction = ParameterDirection.Input;
                prm28.Value = agencycode;
                objOraclecommand.Parameters.Add(prm28);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts1"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts2"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts3", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts3"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts4", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts4"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts5", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts5"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts6", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts6"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("P_Accounts7", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts7"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts8", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts8"].Direction = ParameterDirection.Output;








                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }



        public DataSet qbc_getInsertion(string package, string noofinsertion, string insertiondate, string startdate, string dateformat, string compcode, string adcategory, string adsubcat, string color, string adtype, string currency, string ratecode, string clickdate, string flag, string code, string pck, string uom, string dealrate, string checkforor, string classinserts, string lines, string adcat3, string adcat4, string adcat5, string clientcode, string userid, string center)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                string client = ConfigurationManager.AppSettings["CLIENTNAME"].ToString();
                if (client == "BHASKAR")
                    objOraclecommand = GetCommand("qbc_getInsertion_jabalpur.qbc_getInsertion_jabalpur_p", ref objOracleConnection);
                else
                    objOraclecommand = GetCommand("qbc_getInsertion.qbc_getInsertion_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;



                OracleParameter prm1 = new OracleParameter("package1", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = package;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("noofinsertion", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = noofinsertion;
                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("insertiondate", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = insertiondate;
                objOraclecommand.Parameters.Add(prm3); ;
                OracleParameter prm4 = new OracleParameter("startdate", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;

                /*change for oracle*/
                if (dateformat == "dd/mm/yyyy" && startdate != "" && startdate != null)
                {
                    string[] arr = startdate.Split('/');
                    string dd = arr[0];
                    string mm = arr[1];
                    string yy = arr[2];
                    startdate = mm + "/" + dd + "/" + yy;
                }
                ///////////////////////////

                if (startdate == "" || startdate == null)
                {
                    prm4.Value = startdate;
                }
                else
                {

                    prm4.Value = Convert.ToDateTime(startdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm4);

                //objOraclecommand.Parameters.Add(prm4);
                OracleParameter prm5 = new OracleParameter("dateformat", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = dateformat;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("compcode", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = compcode;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("adcategory", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = adcategory;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("adsubcat1", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = adsubcat;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("color", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = color;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("adtype1", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = adtype;
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("currency", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = currency;
                objOraclecommand.Parameters.Add(prm11);


                OracleParameter prm12 = new OracleParameter("ratecode11", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = ratecode;
                objOraclecommand.Parameters.Add(prm12);

                OracleParameter prm13 = new OracleParameter("clickdate", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;

                if (dateformat == "dd/mm/yyyy" && clickdate != "" && clickdate != null && clickdate != "undefined")
                {
                    string[] arr = clickdate.Split('/');
                    string dd = arr[0];
                    string mm = arr[1];
                    string yy = arr[2];
                    clickdate = mm + "/" + dd + "/" + yy;
                }
                ///////////////////////////

                if (clickdate == "" || clickdate == null)
                {
                    prm13.Value = clickdate;
                }
                else
                {

                    prm13.Value = Convert.ToDateTime(clickdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm13);








                OracleParameter prm14 = new OracleParameter("flag", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                if (flag == "")
                {
                    prm14.Value = "0".ToString();
                }
                else
                {
                    prm14.Value = flag;
                }

                objOraclecommand.Parameters.Add(prm14);
                /*  if (flag == "" || flag == null)
                {
                    objOraclecommand.Parameters["@flag"].Value = System.DBNull.Value;
                }
                else
                {
                    objOraclecommand.Parameters["@flag"].Value = Convert.ToInt32(flag);
                }*/

                OracleParameter prm15 = new OracleParameter("code", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = code;
                objOraclecommand.Parameters.Add(prm15);
                OracleParameter prm16 = new OracleParameter("pck", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = pck;
                objOraclecommand.Parameters.Add(prm16);
                /*  if (pck == "" || pck == null)
                {
                    objOraclecommand.Parameters["@pck"].Value = System.DBNull.Value;
                }
                else
                {
                    objOraclecommand.Parameters["@pck"].Value = Convert.ToDecimal(pck);
                }
*/

                OracleParameter prm17 = new OracleParameter("uom", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = uom;
                objOraclecommand.Parameters.Add(prm17);

                OracleParameter prm18 = new OracleParameter("dealrate", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;
                prm18.Value = dealrate;
                objOraclecommand.Parameters.Add(prm18);
                /* if (dealrate == "" || dealrate == null)
                {
                    objOraclecommand.Parameters["@dealrate"].Value = System.DBNull.Value;
                }
                else
                {
                    objOraclecommand.Parameters["@dealrate"].Value = Convert.ToDecimal(dealrate);
                }*/

                OracleParameter prm19 = new OracleParameter("checkforor", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                prm19.Value = checkforor;
                objOraclecommand.Parameters.Add(prm19);

                //OracleParameter prm20 = new OracleParameter("clientcode", OracleType.VarChar);
                //prm20.Direction = ParameterDirection.Input;
                //prm20.Value = clientcode;
                //objOraclecommand.Parameters.Add(prm20);

                OracleParameter prm21 = new OracleParameter("classinserts", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = classinserts;
                objOraclecommand.Parameters.Add(prm21);


                OracleParameter prm22 = new OracleParameter("lines", OracleType.VarChar);
                prm22.Direction = ParameterDirection.Input;
                prm22.Value = lines;
                objOraclecommand.Parameters.Add(prm22);

                OracleParameter prm23 = new OracleParameter("adcat3", OracleType.VarChar);
                prm23.Direction = ParameterDirection.Input;
                prm23.Value = adcat3;
                objOraclecommand.Parameters.Add(prm23);
                /*if (adcat3 == "")
                {
                    objOraclecommand.Parameters["@adcat3"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat3"].Value = adcat3;
                }*/

                OracleParameter prm24 = new OracleParameter("adcat4", OracleType.VarChar);
                prm24.Direction = ParameterDirection.Input;
                prm24.Value = adcat4;
                objOraclecommand.Parameters.Add(prm24);
                /* if (adcat4 == "")
                {
                    objOraclecommand.Parameters["@adcat4"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat4"].Value = adcat4;
                }*/
                OracleParameter prm25 = new OracleParameter("adcat5", OracleType.VarChar);
                prm25.Direction = ParameterDirection.Input;
                prm25.Value = adcat5;
                objOraclecommand.Parameters.Add(prm25);
                /*if (adcat5 == "")
                {

                    objOraclecommand.Parameters["@adcat5"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat5"].Value = adcat5;
                 }
                 */


                OracleParameter prm26 = new OracleParameter("clientcode", OracleType.VarChar);
                prm26.Direction = ParameterDirection.Input;
                prm26.Value = clientcode;
                objOraclecommand.Parameters.Add(prm26);

                OracleParameter prm27 = new OracleParameter("user_id", OracleType.VarChar);
                prm27.Direction = ParameterDirection.Input;
                prm27.Value = userid;
                objOraclecommand.Parameters.Add(prm27);

                OracleParameter prm28 = new OracleParameter("center", OracleType.VarChar);
                prm28.Direction = ParameterDirection.Input;
                prm28.Value = center;
                objOraclecommand.Parameters.Add(prm28);


                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts1"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts2"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts3", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts3"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts4", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts4"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts5", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts5"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts6", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts6"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts7", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts7"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts8", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts8"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts9", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts9"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts10", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts10"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts11", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts11"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts12", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts12"].Direction = ParameterDirection.Output;





                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }


        public DataSet getInsertion_classified_fillgrid(string package, string noofinsertion, string insertiondate, string startdate, string dateformat, string compcode, string adcategory, string adsubcat, string color, string adtype, string currency, string ratecode, string clickdate, string flag, string code, string @pck, string uom, string dealrate, string checkforor, string classinserts, string lines, string adcat3, string adcat4, string adcat5, string clientcode)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("bindClassifiedInsertion_temp.bindClassifiedInsertion_temp_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;



                OracleParameter prm1 = new OracleParameter("package", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = package;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("noofinsertion", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = noofinsertion;
                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("insertiondate", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = insertiondate;
                objOraclecommand.Parameters.Add(prm3);
                OracleParameter prm4 = new OracleParameter("startdate", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = startdate;
                objOraclecommand.Parameters.Add(prm4);
                OracleParameter prm5 = new OracleParameter("dateformat", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = dateformat;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("compcode", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = compcode;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("adcategory", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = adcategory;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("adsubcat", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = adsubcat;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("color", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = color;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("adtype", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = adtype;
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("currency", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = currency;
                objOraclecommand.Parameters.Add(prm11);


                OracleParameter prm12 = new OracleParameter("ratecode", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = ratecode;
                objOraclecommand.Parameters.Add(prm12);

                OracleParameter prm13 = new OracleParameter("clickdate", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = clickdate;
                objOraclecommand.Parameters.Add(prm13);




                OracleParameter prm14 = new OracleParameter("flag", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = flag;
                objOraclecommand.Parameters.Add(prm14);
                /*  if (flag == "" || flag == null)
                {
                    objOraclecommand.Parameters["@flag"].Value = System.DBNull.Value;
                }
                else
                {
                    objOraclecommand.Parameters["@flag"].Value = Convert.ToInt32(flag);
                }*/

                OracleParameter prm15 = new OracleParameter("code", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = code;
                objOraclecommand.Parameters.Add(prm15);
                OracleParameter prm16 = new OracleParameter("pck", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = pck;
                objOraclecommand.Parameters.Add(prm16);
                /*  if (pck == "" || pck == null)
                {
                    objOraclecommand.Parameters["@pck"].Value = System.DBNull.Value;
                }
                else
                {
                    objOraclecommand.Parameters["@pck"].Value = Convert.ToDecimal(pck);
                }
*/

                OracleParameter prm17 = new OracleParameter("uom", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = uom;
                objOraclecommand.Parameters.Add(prm17);

                OracleParameter prm18 = new OracleParameter("dealrate", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;
                prm18.Value = flag;
                objOraclecommand.Parameters.Add(prm18);
                /* if (dealrate == "" || dealrate == null)
                {
                    objOraclecommand.Parameters["@dealrate"].Value = System.DBNull.Value;
                }
                else
                {
                    objOraclecommand.Parameters["@dealrate"].Value = Convert.ToDecimal(dealrate);
                }*/

                OracleParameter prm19 = new OracleParameter("checkforor", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                prm19.Value = checkforor;
                objOraclecommand.Parameters.Add(prm19);

                OracleParameter prm20 = new OracleParameter("clientcode", OracleType.VarChar);
                prm20.Direction = ParameterDirection.Input;
                prm20.Value = clientcode;
                objOraclecommand.Parameters.Add(prm20);

                OracleParameter prm21 = new OracleParameter("classinserts", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = classinserts;
                objOraclecommand.Parameters.Add(prm21);


                OracleParameter prm22 = new OracleParameter("lines", OracleType.VarChar);
                prm22.Direction = ParameterDirection.Input;
                prm22.Value = lines;
                objOraclecommand.Parameters.Add(prm22);

                OracleParameter prm23 = new OracleParameter("adcat3", OracleType.VarChar);
                prm23.Direction = ParameterDirection.Input;
                prm23.Value = adcat3;
                objOraclecommand.Parameters.Add(prm23);
                /*if (adcat3 == "")
                {
                    objOraclecommand.Parameters["@adcat3"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat3"].Value = adcat3;
                }*/

                OracleParameter prm24 = new OracleParameter("adcat4", OracleType.VarChar);
                prm24.Direction = ParameterDirection.Input;
                prm24.Value = adcat4;
                objOraclecommand.Parameters.Add(prm24);
                /* if (adcat4 == "")
                {
                    objOraclecommand.Parameters["@adcat4"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat4"].Value = adcat4;
                }*/
                OracleParameter prm25 = new OracleParameter("adcat5", OracleType.VarChar);
                prm25.Direction = ParameterDirection.Input;
                prm25.Value = adcat5;
                objOraclecommand.Parameters.Add(prm25);
                /*if (adcat5 == "")
                {

                    objOraclecommand.Parameters["@adcat5"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat5"].Value = adcat5;
                 }
                 */

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }





        public DataSet getrateforprmpkg(string adtype, string color, string adcat, string adsucat, string currency, string ratecode, string package, string compcode, string uom, string premium)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getrate_forprempkg.getrate_forprempkg_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm1 = new OracleParameter("package1", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = package;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("uom", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = uom;
                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("premium", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = premium;
                objOraclecommand.Parameters.Add(prm3);
                OracleParameter prm4 = new OracleParameter("ratecode", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = ratecode;
                objOraclecommand.Parameters.Add(prm4);
                OracleParameter prm5 = new OracleParameter("currency", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = currency;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("compcode", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = compcode;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("adcat", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = adcat;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("adsucat", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = adsucat;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("color", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = color;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("adtype", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = adtype;
                objOraclecommand.Parameters.Add(prm10);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }



        public DataSet getvatamt(string grossamt, string compcode)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getthevatrate", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm6 = new OracleParameter("compcode", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = compcode;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("grossamt", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = grossamt;
                objOraclecommand.Parameters.Add(prm7);


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet class_chklinerate(string adtype, string color, string adcat, string adsucat, string currency, string ratecode, string package, string selecdate, string compcode, string uom, string insert, string lines, string prem, string adcat3, string adcat4, string adcat5, string clientname, string editionsolo)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("class_chklinerate.class_chklinerate_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("package", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = package;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("adcat5", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = adcat5;
                objOraclecommand.Parameters.Add(prm2);
                /*if (adcat5 == "")
                {
                    objOraclecommand.Parameters["@adcat5"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat5"].Value = adcat5;
                }*/

                OracleParameter prm3 = new OracleParameter("insert", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = insert;
                objOraclecommand.Parameters.Add(prm3);
                OracleParameter prm4 = new OracleParameter("selecdate", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = selecdate;
                objOraclecommand.Parameters.Add(prm4);
                OracleParameter prm5 = new OracleParameter("lines", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = lines;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("compcode", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = compcode;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("adcat", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = adcat;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("adsucat", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = adsucat;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("color", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = color;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("adtype", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = adtype;
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("currency", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = currency;
                objOraclecommand.Parameters.Add(prm11);


                OracleParameter prm12 = new OracleParameter("ratecode", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = ratecode;
                objOraclecommand.Parameters.Add(prm12);

                OracleParameter prm13 = new OracleParameter("adcat4", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = adcat4;
                objOraclecommand.Parameters.Add(prm13);
                /*if (adcat4 == "")
                {
                    objOraclecommand.Parameters["@adcat4"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat4"].Value = adcat4;
                }*/



                OracleParameter prm14 = new OracleParameter("adcat3", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = adcat3;
                objOraclecommand.Parameters.Add(prm14);
                /*  if (adcat3 == "")
                {
                    objOraclecommand.Parameters["@adcat3"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat3"].Value = adcat3;
                }*/

                OracleParameter prm15 = new OracleParameter("clientname", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = clientname;
                objOraclecommand.Parameters.Add(prm15);
                OracleParameter prm16 = new OracleParameter("prem", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = prem;
                objOraclecommand.Parameters.Add(prm16);


                OracleParameter prm17 = new OracleParameter("uom", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = uom;
                objOraclecommand.Parameters.Add(prm17);

                OracleParameter prm18 = new OracleParameter("editionsolo", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;
                prm18.Value = editionsolo;
                objOraclecommand.Parameters.Add(prm18);


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }



        public DataSet updatebookstatus(string cioid, string compcode, string userid)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("updatebookstatus_qbc.updatebookstatus_qbc_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("cioid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = cioid;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("userid", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = userid;
                objOraclecommand.Parameters.Add(prm3);

                //if (objDataSet.Tables[0].Rows.Count > 0)
                //{
                //    zonename = objDataSet.Tables[0].Rows[0].ItemArray[0].ToString();
                //}

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }

        public DataSet book_getcyoppkg(string code, string compcode, string adtype)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("book_getcyoppkg.book_getcyoppkg_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;



                OracleParameter prm1 = new OracleParameter("code", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = code;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("adtype1", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = adtype;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;


                //if (objDataSet.Tables[0].Rows.Count > 0)
                //{
                //    zonename = objDataSet.Tables[0].Rows[0].ItemArray[0].ToString();
                //}

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        /*change*/
        public DataSet getwidthforcollumn_qbc(string desc, string collumn, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("book_getwidthforcollumn_qbc.book_getwidthforcollumn_qbc_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;
                OracleParameter prm1 = new OracleParameter("collumn", OracleType.Number);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = collumn;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("desc1", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = desc;
                objOraclecommand.Parameters.Add(prm3);



                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("P_Accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts1"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }


        /*change*/
        public DataSet getwidth_qbc(string edition, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getwidth_qbc.getwidth_qbc_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("edition", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = edition;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("P_Accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts1"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts2"].Direction = ParameterDirection.Output;





                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }


        public DataSet getwidthforcollumn(string desc, string collumn, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("book_getwidthforcollumn.book_getwidthforcollumn_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("collumn", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = collumn;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("desces", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = desc;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts1"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        //*****************************By Manish Verma*************************************
        public DataSet fetchStyleSheetName(string uom)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getStyleSheet.getStyleSheet_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("uom", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = uom;
                objOraclecommand.Parameters.Add(prm1);


                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;








                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }


        public DataSet saveMatter(string cioid, string matterFName, string RTFformat, string XTGformat, string matter, string receiptno, string lang, string userid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_insertMatter.websp_insertMatter_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("matter", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = matter;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("XTGformat", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = XTGformat;
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm3 = new OracleParameter("RTFformat", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = RTFformat;
                objOraclecommand.Parameters.Add(prm3);
                OracleParameter prm4 = new OracleParameter("matter_filename", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = matterFName;
                objOraclecommand.Parameters.Add(prm4);
                OracleParameter prm5 = new OracleParameter("cioid", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = cioid;
                objOraclecommand.Parameters.Add(prm5);


                OracleParameter prm6 = new OracleParameter("receiptno", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = receiptno;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("p_lang", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = lang;
                objOraclecommand.Parameters.Add(prm7);


                OracleParameter prm8 = new OracleParameter("p_userid", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = userid;
                objOraclecommand.Parameters.Add(prm8);


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet getMatter(string cioid, string matterFName)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_getMatter.websp_getMatter_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;
                OracleParameter prm4 = new OracleParameter("matter_filename", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = matterFName;
                objOraclecommand.Parameters.Add(prm4);
                OracleParameter prm5 = new OracleParameter("cioid", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = cioid;
                objOraclecommand.Parameters.Add(prm5);


                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts1"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet modifyMatter(string cioid, string matterFName, string RTFformat, string XTGformat, string matter, string flag, string receipt, string lang, string userid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_modifyMatter.websp_modifyMatter_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm1 = new OracleParameter("matter", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = matter;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("XTGformat", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = XTGformat;
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm3 = new OracleParameter("RTFformat", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = RTFformat;
                objOraclecommand.Parameters.Add(prm3);
                OracleParameter prm4 = new OracleParameter("matter_filename", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = matterFName;
                objOraclecommand.Parameters.Add(prm4);
                OracleParameter prm5 = new OracleParameter("cioid", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = cioid;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("flag", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = flag;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("receiptnumber", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = receipt;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("p_lang", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = lang;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("p_userid", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = userid;
                objOraclecommand.Parameters.Add(prm9);



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet cancelbooking(string prevbookingid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();

            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("cancelbooking.cancelbooking_P", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm6 = new OracleParameter("prevbook", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = prevbookingid;
                objOraclecommand.Parameters.Add(prm6);

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);

                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet fetchbookingdata(string edition, string date)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_getbookingdetail.websp_getbookingdetail_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm6 = new OracleParameter("edition", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = edition;
                objOraclecommand.Parameters.Add(prm6);
                OracleParameter prm7 = new OracleParameter("date", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = date;
                objOraclecommand.Parameters.Add(prm7);








                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;
            }
            catch (OracleException objException)
            {
                throw (objException);
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        /*new change ankur 24 feb*/
        public DataSet getvaliddate_qbc(string dateformat, string datetoadd, string pkgname, string adcat)
        {

            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("get_validdate.get_validdate_P", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;
                OracleParameter prm1 = new OracleParameter("DATEFORMAT", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = dateformat;
                objOraclecommand.Parameters.Add(prm1);


                OracleParameter prm6 = new OracleParameter("datetoadd", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;

                if (dateformat == "dd/mm/yyyy" && datetoadd != "" && datetoadd != null)
                {
                    string[] arr = datetoadd.Split('/');
                    string dd = arr[0];
                    string mm = arr[1];
                    string yy = arr[2];
                    datetoadd = mm + "/" + dd + "/" + yy;

                }

                if (datetoadd == "" || datetoadd == null)
                {
                    prm6.Value = System.DBNull.Value;
                }
                else
                {
                    prm6.Value = Convert.ToDateTime(datetoadd).ToString("dd-MMMM-yyyy"); ;
                }


                objOraclecommand.Parameters.Add(prm6);
                OracleParameter prm2 = new OracleParameter("pkgname", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = pkgname;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("adcat1", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = adcat;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;









                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);

                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        /*new change ankur 9 feb*/
        public DataSet bingbgcolor_drp(string category, string coltype)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_bingbgcolor", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("category", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = category;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("coltype", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = coltype;
                objOraclecommand.Parameters.Add(prm2);





                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);

                return objDataSet;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }


        public DataSet binduomforedit(string adtype, string desc, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("qbc_binduomedition.qbc_binduomedition_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;






                OracleParameter prm1 = new OracleParameter("adtype1", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = adtype;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("desc1", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = desc;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("compcode", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = compcode;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;







                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;



            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        /*new change ankur 15 feb*/

        public DataSet bindbgandfont(string cat, string cat2, string cat3, string cat4, string cat5, string desc)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {

                objOracleConnection.Open();
                objOraclecommand = GetCommand("book_bindbgandfont.book_bindbgandfont_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;



                OracleParameter prm1 = new OracleParameter("CAT1", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = cat;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("CAT2", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = cat2;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("CAT3", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = cat3;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("CAT4", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = cat4;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("CAT5", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = cat5;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("DESC1", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = desc;
                objOraclecommand.Parameters.Add(prm6);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts2"].Direction = ParameterDirection.Output;






                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);

                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }


        }

        /*new changes ankur*/
        public DataSet variable_name(string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();

            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("bindvariable.bindvariable_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;



                OracleParameter prm3 = new OracleParameter("compcode", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = compcode;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                //if (objDataSet.Tables[0].Rows.Count > 0)
                //{
                //    zonename = objDataSet.Tables[0].Rows[0].ItemArray[0].ToString();
                //}
                return objDataSet;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }

        public string insertbookingqbc(string adsizetype, string branch, string booked_by, string prevbook, string date_time, string ciobookid, string approvedby, string audit, string rono, string rodate, string caption, string billstatus, string rostatus, string agency, string client, string agencyaddress, string clientaddresses, string agencycode, string dockitno, string execname, string execzone, string product, string brand, string keyno, string billremark, string printremark, string package, string insertion, string startdate, string repeatdate, string adtype, string adcategory, string subcategory, string color, string uom, string pageposition, string pagetype, string pageno, string adsizheight, string adsizwidth, string ratecode, string scheme, string currency, string agreedrate, string agreedamt, string spedisc, string spacedisx, string compcode, string userid, string specialcharges, string agencytype, string agencystatus, string paymode, string agencredit, string cardrate, string cardamount, string discount, string discountper, string billaddress, string totarea, string billcycle, string revenuecenter, string billpay, string billheight, string billwidth, string billto, string invoices, string vts, string tradedisc, string agencyout, string boxcode, string boxno, string boxaddress, string boxagency, string boxclient, string bookingtype, string tfn, string coupan, string campaign, string bill_amt, string pageprem, string pageamt, string premper, string grossamt, string adsizcolumn, string billcolumn, Decimal billarea, string specdiscper, string spacediscper, string paidins, string dealrate, string deviation, string varient, string contractname, string dealtype, string cardname, string cardtype, string cardmonth, string cardyear, string cardno, string receiptno, string adscat3, string adscat4, string adscat5, string bgcolor, string bulletcode, string bulletprm, string material, string receiptdate, string prevcioid, string prevreceipt, Decimal prev_ga, string region, string varient_name, string coltype, string logo_h, string logo_w, string logo_col, string logo_uom, string dateformat, string retainer, string addagencyrate, string mobileno, string addlamt, string retamt, string retper, string cashrecieved, string drpdiscprem, string doctype, string chktradeval, string sharepub, string fmginsert, string chkno, string chkdate, string chkamt, string chkbankname, string ourbank, string dealerpanel, string dealerh, string dealerw, string dealertype, string multicode, string agreedrate_active, string agreedamt_active, string grossamtlocal_p, string billamtlocal_p, string attach1, string fmgreasons, string canclecharge, string transdisc, string pospremdisc, string billhold, string designbox, string logoprem, string online_ad, string style, string cou_code, string cou_name, string state, string clientcatdisc, string clientcatamt, string clientcatdistype, string flatfreqdisc, string flatfreqamt, string flatfreqdisctype, string catdisc, string catamt, string catdisctype, string cashdiscount, string cashdiscountper)
        {

            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("insertintobooking.insertintobooking_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm6 = new OracleParameter("approvedby", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = approvedby;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm8 = new OracleParameter("audit1", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = audit;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("rono", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = rono;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("rodate", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;






                if (rodate == "" || rodate == null)
                {
                    prm10.Value = System.DBNull.Value;
                }
                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = rodate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        rodate = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = rodate.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        rodate = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = rodate.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            rodate = mm + "/" + dd + "/" + yy;
                    //        }
                    prm10.Value = Convert.ToDateTime(rodate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("caption", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = caption;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm12 = new OracleParameter("billstatus", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = billstatus;
                objOraclecommand.Parameters.Add(prm12);

                OracleParameter prm13 = new OracleParameter("rostatus", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = rostatus;
                objOraclecommand.Parameters.Add(prm13);

                OracleParameter prm14 = new OracleParameter("agency", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = agency;
                objOraclecommand.Parameters.Add(prm14);

                OracleParameter prm15 = new OracleParameter("client", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = client;
                objOraclecommand.Parameters.Add(prm15);

                OracleParameter prm16 = new OracleParameter("agencyaddress", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = agencyaddress;
                objOraclecommand.Parameters.Add(prm16);

                OracleParameter prm17 = new OracleParameter("clientaddresses", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = clientaddresses;
                objOraclecommand.Parameters.Add(prm17);


                OracleParameter prm18 = new OracleParameter("agencycode", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;
                prm18.Value = agencycode;
                objOraclecommand.Parameters.Add(prm18);

                OracleParameter prm19 = new OracleParameter("dockitno", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                prm19.Value = dockitno;
                objOraclecommand.Parameters.Add(prm19);

                OracleParameter prm20 = new OracleParameter("execname", OracleType.VarChar);
                prm20.Direction = ParameterDirection.Input;
                prm20.Value = execname;
                objOraclecommand.Parameters.Add(prm20);

                OracleParameter prm21 = new OracleParameter("execzone", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = execzone;
                objOraclecommand.Parameters.Add(prm21);

                OracleParameter prm22 = new OracleParameter("product", OracleType.VarChar);
                prm22.Direction = ParameterDirection.Input;
                prm22.Value = product;
                objOraclecommand.Parameters.Add(prm22);



                OracleParameter prm23 = new OracleParameter("brand", OracleType.VarChar);
                prm23.Direction = ParameterDirection.Input;
                prm23.Value = brand;
                objOraclecommand.Parameters.Add(prm23);

                OracleParameter prm24 = new OracleParameter("keyno", OracleType.VarChar);
                prm24.Direction = ParameterDirection.Input;
                prm24.Value = keyno;
                objOraclecommand.Parameters.Add(prm24);

                OracleParameter prm25 = new OracleParameter("billremark", OracleType.VarChar);
                prm25.Direction = ParameterDirection.Input;
                prm25.Value = billremark;
                objOraclecommand.Parameters.Add(prm25);

                OracleParameter prm26 = new OracleParameter("printremark", OracleType.VarChar);
                prm26.Direction = ParameterDirection.Input;
                prm26.Value = printremark;
                objOraclecommand.Parameters.Add(prm26);

                OracleParameter prm27 = new OracleParameter("package1", OracleType.VarChar);
                prm27.Direction = ParameterDirection.Input;
                prm27.Value = package;
                objOraclecommand.Parameters.Add(prm27);

                OracleParameter prm28 = new OracleParameter("insertion", OracleType.VarChar);
                prm28.Direction = ParameterDirection.Input;
                if (insertion == "")
                {
                    prm28.Value = System.DBNull.Value;
                }
                else
                {
                    prm28.Value = Convert.ToDecimal(insertion);
                }
                objOraclecommand.Parameters.Add(prm28);


                OracleParameter prm29 = new OracleParameter("startdate", OracleType.VarChar);
                prm29.Direction = ParameterDirection.Input;

                if (startdate == "" || startdate == null)
                {
                    prm29.Value = System.DBNull.Value;
                }
                else
                {



                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = startdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        startdate = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = startdate.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        startdate = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = startdate.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            startdate = mm + "/" + dd + "/" + yy;
                    //        }
                    prm29.Value = Convert.ToDateTime(startdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm29);

                OracleParameter prm30 = new OracleParameter("repeatdate", OracleType.VarChar);
                prm30.Direction = ParameterDirection.Input;
                prm30.Value = repeatdate;
                objOraclecommand.Parameters.Add(prm30);

                OracleParameter prm31 = new OracleParameter("adtype1", OracleType.VarChar);
                prm31.Direction = ParameterDirection.Input;
                prm31.Value = adtype;
                objOraclecommand.Parameters.Add(prm31);

                OracleParameter prm32 = new OracleParameter("adcategory", OracleType.VarChar);
                prm32.Direction = ParameterDirection.Input;
                prm32.Value = adcategory;
                objOraclecommand.Parameters.Add(prm32);

                OracleParameter prm33 = new OracleParameter("subcategory", OracleType.VarChar);
                prm33.Direction = ParameterDirection.Input;
                prm33.Value = subcategory;
                objOraclecommand.Parameters.Add(prm33);

                OracleParameter prm34 = new OracleParameter("color", OracleType.VarChar);
                prm34.Direction = ParameterDirection.Input;
                prm34.Value = color;
                objOraclecommand.Parameters.Add(prm34);

                OracleParameter prm35 = new OracleParameter("uom", OracleType.VarChar);
                prm35.Direction = ParameterDirection.Input;
                prm35.Value = uom;
                objOraclecommand.Parameters.Add(prm35);

                OracleParameter prm36 = new OracleParameter("pageposition", OracleType.VarChar);
                prm36.Direction = ParameterDirection.Input;
                prm36.Value = pageposition;
                objOraclecommand.Parameters.Add(prm36);

                OracleParameter prm37 = new OracleParameter("pagetype1", OracleType.VarChar);
                prm37.Direction = ParameterDirection.Input;
                prm37.Value = pagetype;
                objOraclecommand.Parameters.Add(prm37);

                OracleParameter prm38 = new OracleParameter("pageno", OracleType.VarChar);
                prm38.Direction = ParameterDirection.Input;
                if (pageno == "" || pageno == null)
                {
                    prm38.Value = System.DBNull.Value;

                }
                else
                {
                    prm38.Value = Convert.ToDecimal(pageno);
                }
                objOraclecommand.Parameters.Add(prm38);



                OracleParameter prm39 = new OracleParameter("adsizheight", OracleType.VarChar);
                prm39.Direction = ParameterDirection.Input;
                if (adsizheight == "" || adsizheight == null)
                {
                    prm39.Value = System.DBNull.Value;
                }
                else
                {
                    prm39.Value = Convert.ToDecimal(adsizheight);
                }
                objOraclecommand.Parameters.Add(prm39);


                OracleParameter prm40 = new OracleParameter("adsizwidth", OracleType.VarChar);
                prm40.Direction = ParameterDirection.Input;
                if (adsizwidth == "" || adsizwidth == null)
                {
                    prm40.Value = System.DBNull.Value;
                }
                else
                {
                    prm40.Value = Convert.ToDecimal(adsizwidth);
                }
                objOraclecommand.Parameters.Add(prm40);

                OracleParameter prm43 = new OracleParameter("ratecode11", OracleType.VarChar);
                prm43.Direction = ParameterDirection.Input;
                prm43.Value = ratecode;
                objOraclecommand.Parameters.Add(prm43);

                OracleParameter prm41 = new OracleParameter("scheme1", OracleType.VarChar);
                prm41.Direction = ParameterDirection.Input;
                prm41.Value = scheme;
                objOraclecommand.Parameters.Add(prm41);

                OracleParameter prm42 = new OracleParameter("currency", OracleType.VarChar);
                prm42.Direction = ParameterDirection.Input;
                prm42.Value = currency;
                objOraclecommand.Parameters.Add(prm42);



                OracleParameter prm44 = new OracleParameter("agreedrate", OracleType.VarChar);
                prm44.Direction = ParameterDirection.Input;
                if (agreedrate == "" || agreedrate == null)
                {
                    prm44.Value = System.DBNull.Value;
                }
                else
                {
                    prm44.Value = Convert.ToDecimal(agreedrate);
                }
                objOraclecommand.Parameters.Add(prm44);


                OracleParameter prm45 = new OracleParameter("agreedamt", OracleType.VarChar);
                prm45.Direction = ParameterDirection.Input;
                if (agreedamt == "" || agreedamt == null)
                {
                    prm45.Value = System.DBNull.Value;
                }
                else
                {
                    prm45.Value = Convert.ToDecimal(agreedamt);
                }
                objOraclecommand.Parameters.Add(prm45);


                OracleParameter prm46 = new OracleParameter("spedisc", OracleType.VarChar);
                prm46.Direction = ParameterDirection.Input;
                if (spedisc == "" || spedisc == null)
                {
                    prm46.Value = System.DBNull.Value;
                }
                else
                {
                    prm46.Value = Convert.ToDecimal(spedisc);
                }
                objOraclecommand.Parameters.Add(prm46);
                OracleParameter prm48 = new OracleParameter("spacedisx", OracleType.VarChar);
                prm48.Direction = ParameterDirection.Input;
                if (spacedisx == "" || spacedisx == null)
                {
                    prm48.Value = System.DBNull.Value;
                }
                else
                {
                    prm48.Value = Convert.ToDecimal(spacedisx);
                }
                objOraclecommand.Parameters.Add(prm48);

                OracleParameter prm47 = new OracleParameter("compcode", OracleType.VarChar);
                prm47.Direction = ParameterDirection.Input;
                prm47.Value = compcode;
                objOraclecommand.Parameters.Add(prm47);
                OracleParameter prm50 = new OracleParameter("userid", OracleType.VarChar);
                prm50.Direction = ParameterDirection.Input;
                prm50.Value = userid;
                objOraclecommand.Parameters.Add(prm50);


                OracleParameter prm7 = new OracleParameter("ciobookid", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = ciobookid;
                objOraclecommand.Parameters.Add(prm7);


                OracleParameter prm1 = new OracleParameter("date_time", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                if (date_time == "" || date_time == null)
                {
                    prm1.Value = System.DBNull.Value;


                }

                else
                {


                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = date_time.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        date_time = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = date_time.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        date_time = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = date_time.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            date_time = mm + "/" + dd + "/" + yy;
                    //        }
                    //if (dateformat == "dd/mm/yyyy")
                    //{
                    //    prm1.Value = date_time;
                    //}
                    //else
                    //{
                    prm1.Value = Convert.ToDateTime(date_time).ToString("dd-MMMM-yyyy");
                    // }
                }
                objOraclecommand.Parameters.Add(prm1);



                OracleParameter prm3 = new OracleParameter("branch", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = branch;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("booked_by", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = booked_by;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("prevbook", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = prevbook;
                objOraclecommand.Parameters.Add(prm5);



                OracleParameter prm2 = new OracleParameter("adsizetype", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = adsizetype;
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm49 = new OracleParameter("specialcharges", OracleType.VarChar);
                prm49.Direction = ParameterDirection.Input;
                if (specialcharges == "" || specialcharges == null)
                {
                    prm49.Value = System.DBNull.Value;
                }
                else
                {
                    prm49.Value = Convert.ToDecimal(specialcharges);
                }
                objOraclecommand.Parameters.Add(prm49);




                OracleParameter prm51 = new OracleParameter("agencytype", OracleType.VarChar);
                prm51.Direction = ParameterDirection.Input;
                prm51.Value = agencytype;
                objOraclecommand.Parameters.Add(prm51);

                OracleParameter prm52 = new OracleParameter("agencystatus", OracleType.VarChar);
                prm52.Direction = ParameterDirection.Input;
                prm52.Value = agencystatus;
                objOraclecommand.Parameters.Add(prm52);

                OracleParameter prm53 = new OracleParameter("paymode", OracleType.VarChar);
                prm53.Direction = ParameterDirection.Input;
                prm53.Value = paymode;
                objOraclecommand.Parameters.Add(prm53);

                OracleParameter prm54 = new OracleParameter("agenccredit", OracleType.VarChar);
                prm54.Direction = ParameterDirection.Input;
                if (agencredit == "" || agencredit == null)
                {
                    prm54.Value = System.DBNull.Value;
                }
                else
                {
                    prm54.Value = Convert.ToInt32(agencredit);
                }
                objOraclecommand.Parameters.Add(prm54);


                OracleParameter prm55 = new OracleParameter("cardrate", OracleType.VarChar);
                prm55.Direction = ParameterDirection.Input;
                if (cardrate == "" || cardrate == null)
                {
                    prm55.Value = System.DBNull.Value;
                }
                else
                {
                    prm55.Value = Convert.ToDecimal(cardrate);
                }
                objOraclecommand.Parameters.Add(prm55);


                OracleParameter prm56 = new OracleParameter("cardamount", OracleType.VarChar);
                prm56.Direction = ParameterDirection.Input;
                if (cardamount == "" || cardamount == null)
                {
                    prm56.Value = System.DBNull.Value;
                }
                else
                {
                    prm56.Value = Convert.ToDecimal(cardamount);
                }
                objOraclecommand.Parameters.Add(prm56);

                OracleParameter prm57 = new OracleParameter("discount", OracleType.VarChar);
                prm57.Direction = ParameterDirection.Input;
                if (discount == "" || discount == null)
                {
                    prm57.Value = System.DBNull.Value;
                }
                else
                {
                    prm57.Value = Convert.ToDecimal(discount);
                }
                objOraclecommand.Parameters.Add(prm57);


                OracleParameter prm58 = new OracleParameter("discountper", OracleType.VarChar);
                prm58.Direction = ParameterDirection.Input;
                if (discountper == "" || discountper == null)
                {
                    prm58.Value = System.DBNull.Value;
                }
                else
                {
                    prm58.Value = Convert.ToDecimal(discountper);
                }
                objOraclecommand.Parameters.Add(prm58);


                OracleParameter prm59 = new OracleParameter("billaddress", OracleType.VarChar);
                prm59.Direction = ParameterDirection.Input;
                prm59.Value = billaddress;
                objOraclecommand.Parameters.Add(prm59);

                OracleParameter prm60 = new OracleParameter("totarea", OracleType.VarChar);
                prm60.Direction = ParameterDirection.Input;
                if (totarea == "" || totarea == null)
                {
                    prm60.Value = System.DBNull.Value;
                }
                else
                {
                    prm60.Value = Convert.ToDecimal(totarea);
                }
                objOraclecommand.Parameters.Add(prm60);


                OracleParameter prm61 = new OracleParameter("billcycle", OracleType.VarChar);
                prm61.Direction = ParameterDirection.Input;
                prm61.Value = billcycle;
                objOraclecommand.Parameters.Add(prm61);

                OracleParameter prm63 = new OracleParameter("revenuecenter", OracleType.VarChar);
                prm63.Direction = ParameterDirection.Input;
                prm63.Value = revenuecenter;
                objOraclecommand.Parameters.Add(prm63);

                OracleParameter prm62 = new OracleParameter("billpay", OracleType.VarChar);
                prm62.Direction = ParameterDirection.Input;
                prm62.Value = billpay;
                objOraclecommand.Parameters.Add(prm62);



                OracleParameter prm64 = new OracleParameter("billheight", OracleType.VarChar);
                prm64.Direction = ParameterDirection.Input;
                if (billheight == "" || billheight == null)
                {
                    prm64.Value = System.DBNull.Value;
                }
                else
                {
                    prm64.Value = Convert.ToDecimal(billheight);
                }
                objOraclecommand.Parameters.Add(prm64);


                OracleParameter prm65 = new OracleParameter("billwidth", OracleType.VarChar);
                prm65.Direction = ParameterDirection.Input;
                if (billwidth == "" || billwidth == null)
                {
                    prm65.Value = System.DBNull.Value;
                }
                else
                {
                    prm65.Value = Convert.ToDecimal(billwidth);
                }
                objOraclecommand.Parameters.Add(prm65);


                OracleParameter prm66 = new OracleParameter("billto", OracleType.VarChar);
                prm66.Direction = ParameterDirection.Input;
                prm66.Value = billto;
                objOraclecommand.Parameters.Add(prm66);

                OracleParameter prm67 = new OracleParameter("invoices", OracleType.VarChar);
                prm67.Direction = ParameterDirection.Input;
                if (invoices == "" || invoices == null)
                {
                    prm67.Value = System.DBNull.Value;
                }
                else
                {
                    prm67.Value = Convert.ToDecimal(invoices);
                }
                objOraclecommand.Parameters.Add(prm67);


                OracleParameter prm68 = new OracleParameter("vts", OracleType.VarChar);
                prm68.Direction = ParameterDirection.Input;
                if (vts == "" || vts == null || vts == "null")
                {
                    prm68.Value = System.DBNull.Value;
                }
                else
                {
                    prm68.Value = Convert.ToDecimal(vts);
                }
                objOraclecommand.Parameters.Add(prm68);



                OracleParameter prm69 = new OracleParameter("tradedisc", OracleType.VarChar);
                prm69.Direction = ParameterDirection.Input;
                if (tradedisc == "" || tradedisc == null)
                    prm69.Value = System.DBNull.Value;
                else
                    prm69.Value = Convert.ToDecimal(tradedisc);
                objOraclecommand.Parameters.Add(prm69);

                OracleParameter prm70 = new OracleParameter("agencyout", OracleType.VarChar);
                prm70.Direction = ParameterDirection.Input;
                prm70.Value = agencyout;
                objOraclecommand.Parameters.Add(prm70);

                OracleParameter prm71 = new OracleParameter("boxcode", OracleType.VarChar);
                prm71.Direction = ParameterDirection.Input;
                prm71.Value = boxcode;
                objOraclecommand.Parameters.Add(prm71);

                OracleParameter prm72 = new OracleParameter("boxno", OracleType.VarChar);
                prm72.Direction = ParameterDirection.Input;
                prm72.Value = boxno;
                objOraclecommand.Parameters.Add(prm72);


                OracleParameter prm74 = new OracleParameter("boxaddress", OracleType.VarChar);
                prm74.Direction = ParameterDirection.Input;
                prm74.Value = boxaddress;
                objOraclecommand.Parameters.Add(prm74);

                OracleParameter prm73 = new OracleParameter("boxagency", OracleType.VarChar);
                prm73.Direction = ParameterDirection.Input;
                prm73.Value = boxagency;
                objOraclecommand.Parameters.Add(prm73);


                OracleParameter prm75 = new OracleParameter("boxclient", OracleType.VarChar);
                prm75.Direction = ParameterDirection.Input;
                prm75.Value = boxclient;
                objOraclecommand.Parameters.Add(prm75);

                OracleParameter prm77 = new OracleParameter("bookingtype", OracleType.VarChar);
                prm77.Direction = ParameterDirection.Input;
                prm77.Value = bookingtype;
                objOraclecommand.Parameters.Add(prm77);

                OracleParameter prm78 = new OracleParameter("tfn", OracleType.VarChar);
                prm78.Direction = ParameterDirection.Input;
                prm78.Value = tfn;
                objOraclecommand.Parameters.Add(prm78);


                OracleParameter prm76 = new OracleParameter("coupan", OracleType.VarChar);
                prm76.Direction = ParameterDirection.Input;
                prm76.Value = coupan;
                objOraclecommand.Parameters.Add(prm76);




                OracleParameter prm79 = new OracleParameter("campaign", OracleType.VarChar);
                prm79.Direction = ParameterDirection.Input;
                prm79.Value = campaign;
                objOraclecommand.Parameters.Add(prm79);


                OracleParameter prm80 = new OracleParameter("bill_amt", OracleType.VarChar);
                prm80.Direction = ParameterDirection.Input;
                if (bill_amt == "" || bill_amt == null)
                {
                    prm80.Value = System.DBNull.Value;
                }
                else
                {
                    prm80.Value = Convert.ToDecimal(bill_amt);
                }
                objOraclecommand.Parameters.Add(prm80);


                OracleParameter prm81 = new OracleParameter("pageprem", OracleType.VarChar);
                prm81.Direction = ParameterDirection.Input;
                prm81.Value = pageprem;
                objOraclecommand.Parameters.Add(prm81);

                OracleParameter prm82 = new OracleParameter("pageamt", OracleType.VarChar);
                prm82.Direction = ParameterDirection.Input;
                if (pageamt == "" || pageamt == null)
                {
                    prm82.Value = System.DBNull.Value;
                }
                else
                {
                    prm82.Value = Convert.ToDecimal(pageamt);
                }
                objOraclecommand.Parameters.Add(prm82);


                OracleParameter prm83 = new OracleParameter("premper", OracleType.VarChar);
                prm83.Direction = ParameterDirection.Input;
                if (premper == "" || premper == null)
                {
                    prm83.Value = System.DBNull.Value;
                }
                else
                {
                    prm83.Value = Convert.ToDecimal(premper);
                }
                objOraclecommand.Parameters.Add(prm83);


                OracleParameter prm84 = new OracleParameter("grossamt", OracleType.VarChar);
                prm84.Direction = ParameterDirection.Input;
                if (grossamt == "" || grossamt == null)
                {
                    prm84.Value = System.DBNull.Value;
                }
                else
                {
                    prm84.Value = Convert.ToDecimal(grossamt);
                }
                objOraclecommand.Parameters.Add(prm84);



                OracleParameter prm85 = new OracleParameter("adsizcolumn", OracleType.VarChar);
                prm85.Direction = ParameterDirection.Input;
                if (adsizcolumn == "" || adsizcolumn == null)
                {
                    prm85.Value = System.DBNull.Value;
                }
                else
                {
                    prm85.Value = Convert.ToDecimal(adsizcolumn);
                }
                objOraclecommand.Parameters.Add(prm85);

                OracleParameter prm89 = new OracleParameter("billarea", OracleType.VarChar);
                prm89.Direction = ParameterDirection.Input;
                if (billarea == 0)
                {
                    prm89.Value = System.DBNull.Value;
                }
                else
                {
                    prm89.Value = Convert.ToDecimal(billarea);
                }
                objOraclecommand.Parameters.Add(prm89);


                OracleParameter prm86 = new OracleParameter("billcolumn", OracleType.VarChar);
                prm86.Direction = ParameterDirection.Input;
                if (billcolumn == "" || billcolumn == null)
                {
                    prm86.Value = System.DBNull.Value;
                }
                else
                {
                    prm86.Value = Convert.ToDecimal(billcolumn);
                }
                objOraclecommand.Parameters.Add(prm86);


                OracleParameter prm88 = new OracleParameter("spacediscper", OracleType.VarChar);
                prm88.Direction = ParameterDirection.Input;
                if (spacediscper == "" || spacediscper == null)
                {
                    prm88.Value = System.DBNull.Value;
                }
                else
                {
                    prm88.Value = Convert.ToDecimal(spacediscper);
                }
                objOraclecommand.Parameters.Add(prm88);

                OracleParameter prm87 = new OracleParameter("specdiscper", OracleType.VarChar);
                prm87.Direction = ParameterDirection.Input;
                if (specdiscper == "" || specdiscper == null)
                {
                    prm87.Value = System.DBNull.Value;
                }
                else
                {
                    prm87.Value = Convert.ToDecimal(specdiscper);
                }
                objOraclecommand.Parameters.Add(prm87);






                OracleParameter prm90 = new OracleParameter("paidins", OracleType.VarChar);
                prm90.Direction = ParameterDirection.Input;
                if (paidins == "" || paidins == null)
                {
                    prm90.Value = System.DBNull.Value;
                }
                else
                {
                    prm90.Value = Convert.ToDecimal(paidins);
                }
                objOraclecommand.Parameters.Add(prm90);

                OracleParameter prm92 = new OracleParameter("deviation", OracleType.VarChar);
                prm92.Direction = ParameterDirection.Input;
                if (deviation == "" || deviation == null)
                {
                    prm92.Value = System.DBNull.Value;
                }
                else
                {
                    prm92.Value = Convert.ToDecimal(deviation);
                }
                objOraclecommand.Parameters.Add(prm92);

                OracleParameter prm91 = new OracleParameter("dealrate", OracleType.VarChar);
                prm91.Direction = ParameterDirection.Input;
                if (dealrate == "" || dealrate == null)
                {
                    prm91.Value = System.DBNull.Value;
                }
                else
                {
                    prm91.Value = Convert.ToDecimal(dealrate);
                }

                objOraclecommand.Parameters.Add(prm91);



                OracleParameter prm93 = new OracleParameter("varient", OracleType.VarChar);
                prm93.Direction = ParameterDirection.Input;
                prm93.Value = varient;
                objOraclecommand.Parameters.Add(prm93);



                OracleParameter prm95 = new OracleParameter("dealtype", OracleType.VarChar);
                prm95.Direction = ParameterDirection.Input;
                prm95.Value = dealtype;
                objOraclecommand.Parameters.Add(prm95);

                OracleParameter prm94 = new OracleParameter("contractname", OracleType.VarChar);
                prm94.Direction = ParameterDirection.Input;
                prm94.Value = contractname;
                objOraclecommand.Parameters.Add(prm94);

                OracleParameter prm96 = new OracleParameter("cardname", OracleType.VarChar);
                prm96.Direction = ParameterDirection.Input;
                prm96.Value = cardname;
                objOraclecommand.Parameters.Add(prm96);

                OracleParameter prm97 = new OracleParameter("cardtype", OracleType.VarChar);
                prm97.Direction = ParameterDirection.Input;
                prm97.Value = cardtype;
                objOraclecommand.Parameters.Add(prm97);

                OracleParameter prm98 = new OracleParameter("cardmonth", OracleType.VarChar);
                prm98.Direction = ParameterDirection.Input;
                prm98.Value = cardmonth;
                objOraclecommand.Parameters.Add(prm98);

                OracleParameter prm99 = new OracleParameter("cardyear", OracleType.VarChar);
                prm99.Direction = ParameterDirection.Input;
                prm99.Value = cardyear;
                objOraclecommand.Parameters.Add(prm99);

                OracleParameter prm100 = new OracleParameter("cardno", OracleType.VarChar);
                prm100.Direction = ParameterDirection.Input;
                prm100.Value = cardno;
                objOraclecommand.Parameters.Add(prm100);






                OracleParameter prm101 = new OracleParameter("receiptno", OracleType.VarChar);
                prm101.Direction = ParameterDirection.Input;
                prm101.Value = receiptno;
                objOraclecommand.Parameters.Add(prm101);


                OracleParameter prm102 = new OracleParameter("adscat3", OracleType.VarChar);
                prm102.Direction = ParameterDirection.Input;
                prm102.Value = adscat3;
                objOraclecommand.Parameters.Add(prm102);


                OracleParameter prm103 = new OracleParameter("adscat4", OracleType.VarChar);
                prm103.Direction = ParameterDirection.Input;
                prm103.Value = adscat4;
                objOraclecommand.Parameters.Add(prm103);


                OracleParameter prm104 = new OracleParameter("adscat5", OracleType.VarChar);
                prm104.Direction = ParameterDirection.Input;
                prm104.Value = adscat5;
                objOraclecommand.Parameters.Add(prm104);


                OracleParameter prm105 = new OracleParameter("bgcolor", OracleType.VarChar);
                prm105.Direction = ParameterDirection.Input;
                prm105.Value = bgcolor;
                objOraclecommand.Parameters.Add(prm105);


                OracleParameter prm106 = new OracleParameter("bulletcode", OracleType.VarChar);
                prm106.Direction = ParameterDirection.Input;
                prm106.Value = bulletcode;
                objOraclecommand.Parameters.Add(prm106);


                OracleParameter prm107 = new OracleParameter("bulletprm", OracleType.VarChar);
                prm107.Direction = ParameterDirection.Input;
                if (bulletprm == "" || bulletprm == null)
                {
                    prm107.Value = System.DBNull.Value;
                }
                else
                {
                    bulletprm = bulletprm.Replace("%", "");
                    prm107.Value = Convert.ToDecimal(bulletprm);
                }
                objOraclecommand.Parameters.Add(prm107);


                OracleParameter prm108 = new OracleParameter("material", OracleType.VarChar);
                prm108.Direction = ParameterDirection.Input;
                prm108.Value = material;
                objOraclecommand.Parameters.Add(prm108);


                OracleParameter prm109 = new OracleParameter("receiptdate", OracleType.VarChar);
                prm109.Direction = ParameterDirection.Input;
                if (receiptdate == "" || receiptdate == null)
                {
                    prm109.Value = System.DBNull.Value;
                }
                else
                {



                    if (receiptdate.IndexOf("-") < 0)
                    {
                        if (dateformat == "dd/mm/yyyy")
                        {
                            string[] arr = receiptdate.Split('/');
                            string dd = arr[0];
                            string mm = arr[1];
                            string yy = arr[2];
                            receiptdate = mm + "/" + dd + "/" + yy;


                        }
                        else
                            if (dateformat == "mm/dd/yyyy")
                            {
                                string[] arr = receiptdate.Split('/');
                                string dd = arr[1];
                                string mm = arr[0];
                                string yy = arr[2];
                                receiptdate = mm + "/" + dd + "/" + yy;

                            }

                            else
                                if (dateformat == "yyyy/mm/dd")
                                {
                                    string[] arr = receiptdate.Split('/');
                                    string dd = arr[2];
                                    string mm = arr[1];
                                    string yy = arr[0];
                                    receiptdate = mm + "/" + dd + "/" + yy;
                                }
                    }

                    if (dateformat == "dd/mm/yyyy")
                    {
                        if (receiptdate.IndexOf("-") < 0)
                        {
                            prm109.Value = Convert.ToDateTime(receiptdate).ToString("dd-MMMM-yyyy");
                        }
                        else
                        {
                            prm109.Value = receiptdate;
                        }
                    }
                    else
                    {
                        prm109.Value = Convert.ToDateTime(receiptdate).ToString("dd-MMMM-yyyy");
                    }
                }
                objOraclecommand.Parameters.Add(prm109);


                OracleParameter prm110 = new OracleParameter("prevcioid", OracleType.VarChar);
                prm110.Direction = ParameterDirection.Input;
                prm110.Value = prevcioid;
                objOraclecommand.Parameters.Add(prm110);


                OracleParameter prm111 = new OracleParameter("prevreceipt", OracleType.VarChar);
                prm111.Direction = ParameterDirection.Input;
                prm111.Value = prevreceipt;
                objOraclecommand.Parameters.Add(prm111);


                OracleParameter prm112 = new OracleParameter("prev_ga", OracleType.VarChar);
                prm112.Direction = ParameterDirection.Input;
                if (prev_ga == 0)
                {
                    prm112.Value = System.DBNull.Value;
                }
                else
                {
                    prm112.Value = Convert.ToDecimal(prev_ga);
                }
                objOraclecommand.Parameters.Add(prm112);


                OracleParameter prm113 = new OracleParameter("varient_name", OracleType.VarChar);
                prm113.Direction = ParameterDirection.Input;
                prm113.Value = varient_name;
                objOraclecommand.Parameters.Add(prm113);


                OracleParameter prm114 = new OracleParameter("region1", OracleType.VarChar);
                prm114.Direction = ParameterDirection.Input;
                prm114.Value = region;
                objOraclecommand.Parameters.Add(prm114);
                /*new change ankur 9 feb*/

                OracleParameter prm115 = new OracleParameter("coltype", OracleType.VarChar);
                prm115.Direction = ParameterDirection.Input;
                prm115.Value = coltype;
                objOraclecommand.Parameters.Add(prm115);

                OracleParameter prm116 = new OracleParameter("logo_h", OracleType.VarChar);
                prm116.Direction = ParameterDirection.Input;
                prm116.Value = logo_h;
                objOraclecommand.Parameters.Add(prm116);

                OracleParameter prm117 = new OracleParameter("logo_w", OracleType.VarChar);
                prm117.Direction = ParameterDirection.Input;
                prm117.Value = logo_w;
                objOraclecommand.Parameters.Add(prm117);

                OracleParameter prm118 = new OracleParameter("logo_col", OracleType.VarChar);
                prm118.Direction = ParameterDirection.Input;
                prm118.Value = logo_col;
                objOraclecommand.Parameters.Add(prm118);

                OracleParameter prm119 = new OracleParameter("logo_uom", OracleType.VarChar);
                prm119.Direction = ParameterDirection.Input;
                prm119.Value = logo_uom;
                objOraclecommand.Parameters.Add(prm119);


                OracleParameter prm120 = new OracleParameter("retainer1", OracleType.VarChar);
                prm120.Direction = ParameterDirection.Input;
                prm120.Value = "";
                objOraclecommand.Parameters.Add(prm120);


                OracleParameter prm121 = new OracleParameter("addagencyrate", OracleType.VarChar);
                prm121.Direction = ParameterDirection.Input;
                prm121.Value = addagencyrate;
                objOraclecommand.Parameters.Add(prm121);

                OracleParameter prm122 = new OracleParameter("mobileno", OracleType.VarChar);
                prm122.Direction = ParameterDirection.Input;
                prm122.Value = mobileno;
                objOraclecommand.Parameters.Add(prm122);

                OracleParameter prm123 = new OracleParameter("addlamt", OracleType.VarChar);
                prm123.Direction = ParameterDirection.Input;
                prm123.Value = addlamt;
                objOraclecommand.Parameters.Add(prm123);

                OracleParameter prm124 = new OracleParameter("retamt", OracleType.VarChar);
                prm124.Direction = ParameterDirection.Input;
                prm124.Value = retamt;
                objOraclecommand.Parameters.Add(prm124);

                OracleParameter prm125 = new OracleParameter("retper", OracleType.VarChar);
                prm125.Direction = ParameterDirection.Input;
                prm125.Value = retper;
                objOraclecommand.Parameters.Add(prm125);

                OracleParameter prm126 = new OracleParameter("cashrecieved", OracleType.VarChar);
                prm126.Direction = ParameterDirection.Input;
                if (cashrecieved == "" || cashrecieved == null)
                {
                    prm126.Value = System.DBNull.Value;
                }
                else
                {
                    prm126.Value = Convert.ToDecimal(cashrecieved);
                }
                objOraclecommand.Parameters.Add(prm126);

                OracleParameter prm127 = new OracleParameter("CIRAGENCY_V", OracleType.VarChar);
                prm127.Direction = ParameterDirection.Input;
                prm127.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm127);

                OracleParameter prm128 = new OracleParameter("CIRRATE_V", OracleType.VarChar);
                prm128.Direction = ParameterDirection.Input;
                prm128.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm128);

                OracleParameter prm129 = new OracleParameter("CIREDITION_V", OracleType.VarChar);
                prm129.Direction = ParameterDirection.Input;
                prm129.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm129);

                OracleParameter prm130 = new OracleParameter("CIRPUBLICATION_V", OracleType.VarChar);
                prm130.Direction = ParameterDirection.Input;
                prm130.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm130);

                OracleParameter prm131 = new OracleParameter("CIRAGENCYSUBCODE_V", OracleType.VarChar);
                prm131.Direction = ParameterDirection.Input;
                prm131.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm131);

                OracleParameter prm132 = new OracleParameter("BARTERTYPE", OracleType.VarChar);
                prm132.Direction = ParameterDirection.Input;
                prm132.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm132);

                OracleParameter prm133 = new OracleParameter("CASHDISCOUNT_V", OracleType.VarChar);
                prm133.Direction = ParameterDirection.Input;
                if (cashdiscount == "")
                    prm133.Value = System.DBNull.Value;
                else
                    prm133.Value = cashdiscount;
                objOraclecommand.Parameters.Add(prm133);

                OracleParameter prm134 = new OracleParameter("CASHDISCOUNTPER_V", OracleType.VarChar);
                prm134.Direction = ParameterDirection.Input;
                if (cashdiscountper == "")
                    prm134.Value = System.DBNull.Value;
                else
                    prm134.Value = cashdiscountper;
                objOraclecommand.Parameters.Add(prm134);

                OracleParameter prm135 = new OracleParameter("attach1", OracleType.VarChar);
                prm135.Direction = ParameterDirection.Input;
                prm135.Value = attach1;
                objOraclecommand.Parameters.Add(prm135);

                OracleParameter prm136 = new OracleParameter("attach2", OracleType.VarChar);
                prm136.Direction = ParameterDirection.Input;
                prm136.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm136);

                OracleParameter prm137 = new OracleParameter("drpdiscprem", OracleType.VarChar);
                prm137.Direction = ParameterDirection.Input;
                prm137.Value = drpdiscprem;
                objOraclecommand.Parameters.Add(prm137);

                OracleParameter prm138 = new OracleParameter("doctype_v", OracleType.VarChar);
                prm138.Direction = ParameterDirection.Input;
                prm138.Value = doctype;
                objOraclecommand.Parameters.Add(prm138);

                OracleParameter prm139 = new OracleParameter("CHKTRADE", OracleType.VarChar);
                prm139.Direction = ParameterDirection.Input;
                prm139.Value = chktradeval;
                objOraclecommand.Parameters.Add(prm139);

                OracleParameter prm140 = new OracleParameter("sharepub_p", OracleType.VarChar);
                prm140.Direction = ParameterDirection.Input;
                prm140.Value = sharepub;
                objOraclecommand.Parameters.Add(prm140);
                OracleParameter prm141 = new OracleParameter("fmginsert", OracleType.VarChar);
                prm141.Direction = ParameterDirection.Input;
                prm141.Value = fmginsert;
                objOraclecommand.Parameters.Add(prm141);


                OracleParameter prm142 = new OracleParameter("chkno", OracleType.VarChar);
                prm142.Direction = ParameterDirection.Input;
                prm142.Value = chkno;
                objOraclecommand.Parameters.Add(prm142);

                OracleParameter prm143 = new OracleParameter("chkdate", OracleType.DateTime);
                prm143.Direction = ParameterDirection.Input;
                if (chkdate == "")
                {
                    prm143.Value = System.DBNull.Value;
                }
                else
                {
                    prm143.Value = chkdate;
                }

                objOraclecommand.Parameters.Add(prm143);

                OracleParameter prm144 = new OracleParameter("chkamt", OracleType.VarChar);
                prm144.Direction = ParameterDirection.Input;
                prm144.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm144);
                OracleParameter prm145 = new OracleParameter("chkbankname", OracleType.VarChar);
                prm145.Direction = ParameterDirection.Input;
                prm145.Value = chkbankname;
                objOraclecommand.Parameters.Add(prm145);

                OracleParameter prm146 = new OracleParameter("ourbank", OracleType.VarChar);
                prm146.Direction = ParameterDirection.Input;
                prm146.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm146);

                OracleParameter prm147 = new OracleParameter("DEALERPANEL_P", OracleType.VarChar);
                prm147.Direction = ParameterDirection.Input;
                if (dealerpanel == "")
                    prm147.Value = System.DBNull.Value;
                else
                    prm147.Value = dealerpanel;
                objOraclecommand.Parameters.Add(prm147);

                OracleParameter prm148 = new OracleParameter("DEALERH_P", OracleType.VarChar);
                prm148.Direction = ParameterDirection.Input;
                if (dealerh == "")
                    prm148.Value = System.DBNull.Value;
                else
                    prm148.Value = dealerh;
                objOraclecommand.Parameters.Add(prm148);

                OracleParameter prm149 = new OracleParameter("DEALERW_P", OracleType.VarChar);
                prm149.Direction = ParameterDirection.Input;
                if (dealerw == "")
                    prm149.Value = System.DBNull.Value;
                else
                    prm149.Value = dealerw;
                objOraclecommand.Parameters.Add(prm149);

                OracleParameter prm150 = new OracleParameter("DEALERTYPE_P", OracleType.VarChar);
                prm150.Direction = ParameterDirection.Input;
                if (dealertype == "")
                    prm150.Value = System.DBNull.Value;
                else
                    prm150.Value = dealertype;
                objOraclecommand.Parameters.Add(prm150);

                OracleParameter prm151 = new OracleParameter("multiselect", OracleType.VarChar);
                prm151.Direction = ParameterDirection.Input;
                if (multicode == "")
                    prm151.Value = System.DBNull.Value;
                else
                    prm151.Value = multicode;
                objOraclecommand.Parameters.Add(prm151);

                OracleParameter prm152 = new OracleParameter("AGREEDRATE_ACTIVE", OracleType.VarChar);
                prm152.Direction = ParameterDirection.Input;
                if (agreedrate_active == "")
                    prm152.Value = System.DBNull.Value;
                else
                    prm152.Value = agreedrate_active;

                objOraclecommand.Parameters.Add(prm152);

                OracleParameter prm153 = new OracleParameter("AGREEDAMT_ACTIVE", OracleType.VarChar);
                prm153.Direction = ParameterDirection.Input;
                if (agreedamt_active == "")
                    prm153.Value = System.DBNull.Value;
                else
                    prm153.Value = agreedamt_active;

                objOraclecommand.Parameters.Add(prm153);

                OracleParameter prm153a = new OracleParameter("grossamtlocal_p", OracleType.VarChar);
                prm153a.Direction = ParameterDirection.Input;
                if (grossamtlocal_p == "")
                    prm153a.Value = System.DBNull.Value;
                else
                    prm153a.Value = grossamtlocal_p;

                objOraclecommand.Parameters.Add(prm153a);

                OracleParameter prm153b = new OracleParameter("billamtlocal_p", OracleType.VarChar);
                prm153b.Direction = ParameterDirection.Input;
                if (billamtlocal_p == "")
                    prm153b.Value = System.DBNull.Value;
                else
                    prm153b.Value = billamtlocal_p;

                objOraclecommand.Parameters.Add(prm153b);


                OracleParameter prm145a = new OracleParameter("chkadon_p", OracleType.VarChar);
                prm145a.Direction = ParameterDirection.Input;
                prm145a.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm145a);

                OracleParameter prm145b = new OracleParameter("refid_p", OracleType.VarChar);
                prm145b.Direction = ParameterDirection.Input;
                prm145b.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm145b);

                OracleParameter prm145c = new OracleParameter("rcpt_currency", OracleType.VarChar);
                prm145c.Direction = ParameterDirection.Input;
                prm145c.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm145c);

                OracleParameter prm145d = new OracleParameter("cur_convrate", OracleType.VarChar);
                prm145d.Direction = ParameterDirection.Input;
                prm145d.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm145d);

                OracleParameter prm145e = new OracleParameter("p_revisedate", OracleType.VarChar);
                prm145e.Direction = ParameterDirection.Input;
                prm145e.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm145e);

                OracleParameter prm153d = new OracleParameter("clienttype", OracleType.VarChar);
                prm153d.Direction = ParameterDirection.Input;
                prm153d.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm153d);

                OracleParameter prm153e = new OracleParameter("translation", OracleType.VarChar);
                prm153e.Direction = ParameterDirection.Input;
                //if (translation == "0")
                prm153e.Value = System.DBNull.Value;
                //else
                //    prm153e.Value = translation;
                objOraclecommand.Parameters.Add(prm153e);


                OracleParameter prm107a = new OracleParameter("translationcharge", OracleType.Number);
                prm107a.Direction = ParameterDirection.Input;
                //if (translationcharge == "" || translationcharge == null)
                //{
                prm107a.Value = System.DBNull.Value;
                //}
                //else
                //{
                //    translationcharge = translationcharge.Replace("%", "");
                //    prm107a.Value = Convert.ToDecimal(translationcharge);
                //}
                objOraclecommand.Parameters.Add(prm107a);

                OracleParameter prm141a = new OracleParameter("fmgreasons", OracleType.VarChar);
                prm141a.Direction = ParameterDirection.Input;
                prm141a.Value = fmgreasons;
                objOraclecommand.Parameters.Add(prm141a);

                OracleParameter prm141b = new OracleParameter("canclecharge", OracleType.VarChar);
                prm141b.Direction = ParameterDirection.Input;
                prm141b.Value = canclecharge;
                objOraclecommand.Parameters.Add(prm141b);



                OracleParameter prm161bt = new OracleParameter("transdisc_p", OracleType.VarChar);
                prm161bt.Direction = ParameterDirection.Input;
                prm161bt.Value = transdisc;
                objOraclecommand.Parameters.Add(prm161bt);

                OracleParameter prm161bs = new OracleParameter("pospremdisc_p", OracleType.VarChar);
                prm161bs.Direction = ParameterDirection.Input;
                prm161bs.Value = pospremdisc;
                objOraclecommand.Parameters.Add(prm161bs);

                OracleParameter prm161b1 = new OracleParameter("billhold", OracleType.VarChar);
                prm161b1.Direction = ParameterDirection.Input;
                prm161b1.Value = billhold;
                objOraclecommand.Parameters.Add(prm161b1);

                OracleParameter prm161b1c = new OracleParameter("designbox", OracleType.VarChar);
                prm161b1c.Direction = ParameterDirection.Input;
                prm161b1c.Value = designbox;
                objOraclecommand.Parameters.Add(prm161b1c);

                OracleParameter prm161b1a = new OracleParameter("logoprem", OracleType.VarChar);
                prm161b1a.Direction = ParameterDirection.Input;
                prm161b1a.Value = logoprem;
                objOraclecommand.Parameters.Add(prm161b1a);

                OracleParameter prm161b1az = new OracleParameter("online_ad_p", OracleType.VarChar);
                prm161b1az.Direction = ParameterDirection.Input;
                prm161b1az.Value = online_ad;
                objOraclecommand.Parameters.Add(prm161b1az);



                OracleParameter prm161b1azx = new OracleParameter("pstyle", OracleType.VarChar);
                prm161b1azx.Direction = ParameterDirection.Input;
                prm161b1azx.Value = style;
                objOraclecommand.Parameters.Add(prm161b1azx);

                OracleParameter prm161b1az1 = new OracleParameter("pfixed_booking", OracleType.VarChar);
                prm161b1az1.Direction = ParameterDirection.Input;
                prm161b1az1.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm161b1az1);


                OracleParameter prm161b1az12 = new OracleParameter("pvat_code", OracleType.VarChar);
                prm161b1az12.Direction = ParameterDirection.Input;
                prm161b1az12.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm161b1az12);


                OracleParameter prm161b1az13 = new OracleParameter("CPN_CODE_P", OracleType.VarChar);
                prm161b1az13.Direction = ParameterDirection.Input;
                prm161b1az13.Value = cou_code;
                objOraclecommand.Parameters.Add(prm161b1az13);

                OracleParameter prm161b1az14 = new OracleParameter("CPN_NAME_P", OracleType.VarChar);
                prm161b1az14.Direction = ParameterDirection.Input;
                prm161b1az14.Value = cou_name;
                objOraclecommand.Parameters.Add(prm161b1az14);

                OracleParameter prm161b1az14A = new OracleParameter("STATE_P", OracleType.VarChar);
                prm161b1az14A.Direction = ParameterDirection.Input;
                prm161b1az14A.Value = state;
                objOraclecommand.Parameters.Add(prm161b1az14A);

                OracleParameter prm161z = new OracleParameter("clientcatdisc", OracleType.Number);
                prm161z.Direction = ParameterDirection.Input;
                if (clientcatdisc == "" || clientcatdisc == "0" || clientcatdisc == "null")
                {
                    prm161z.Value = System.DBNull.Value;
                }
                else
                {
                    prm161z.Value = clientcatdisc;
                }
                objOraclecommand.Parameters.Add(prm161z);

                OracleParameter prm161z1 = new OracleParameter("clientcatamt", OracleType.Number);
                prm161z1.Direction = ParameterDirection.Input;
                if (clientcatamt == "" || clientcatamt == "0" || clientcatamt == "null")
                {
                    prm161z1.Value = System.DBNull.Value;
                }
                else
                {
                    prm161z1.Value = clientcatamt;
                }
                objOraclecommand.Parameters.Add(prm161z1);

                OracleParameter prm161z2 = new OracleParameter("clientcatdistype", OracleType.VarChar);
                prm161z2.Direction = ParameterDirection.Input;
                prm161z2.Value = clientcatdistype;
                objOraclecommand.Parameters.Add(prm161z2);


                OracleParameter prm161z3 = new OracleParameter("flatfreqdisc", OracleType.Number);
                prm161z3.Direction = ParameterDirection.Input;
                if (flatfreqdisc == "" || flatfreqdisc == "0" || flatfreqdisc == "null")
                {
                    prm161z3.Value = System.DBNull.Value;
                }
                else
                {
                    prm161z3.Value = flatfreqdisc;
                }
                objOraclecommand.Parameters.Add(prm161z3);



                OracleParameter prm161z4 = new OracleParameter("flatfreqamt", OracleType.Number);
                prm161z4.Direction = ParameterDirection.Input;
                if (flatfreqamt == "" || flatfreqamt == "0" || flatfreqamt == "null")
                {
                    prm161z4.Value = System.DBNull.Value;
                }
                else
                {
                    prm161z4.Value = flatfreqamt;
                }
                objOraclecommand.Parameters.Add(prm161z4);




                OracleParameter prm161z5 = new OracleParameter("flatfreqdisctype", OracleType.VarChar);
                prm161z5.Direction = ParameterDirection.Input;
                prm161z5.Value = flatfreqdisctype;
                objOraclecommand.Parameters.Add(prm161z5);

                OracleParameter prm161z6 = new OracleParameter("catdisc", OracleType.Number);
                prm161z6.Direction = ParameterDirection.Input;
                if (catdisc == "" || catdisc == "0" || catdisc == "null")
                {
                    prm161z6.Value = System.DBNull.Value;
                }
                else
                {
                    prm161z6.Value = catdisc;
                }
                objOraclecommand.Parameters.Add(prm161z6);

                OracleParameter prm161z7 = new OracleParameter("catamt", OracleType.Number);
                prm161z7.Direction = ParameterDirection.Input;
                if (catamt == "" || catamt == "0" || catamt == "null")
                {
                    prm161z7.Value = System.DBNull.Value;
                }
                else
                {
                    prm161z7.Value = catamt;
                }
                objOraclecommand.Parameters.Add(prm161z7);

                OracleParameter prm161z8 = new OracleParameter("catdisctype", OracleType.VarChar);
                prm161z8.Direction = ParameterDirection.Input;
                prm161z8.Value = catdisctype;
                objOraclecommand.Parameters.Add(prm161z8);

                objOraclecommand.Parameters.Add("p_error", OracleType.VarChar, 200);
                objOraclecommand.Parameters["p_error"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                //objOraclecommand.ExecuteNonQuery();
                string output = objOraclecommand.Parameters["p_error"].Value.ToString();


                return output;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }


        //public DataSet class_getrate_qbcagency(string adtype, string color, string adcat, string adsucat, string currency, string ratecode, string package, string selecdate, string compcode, string uom, string insert, string lines, string prem, string adcat3, string adcat4, string adcat5, string clientname, string noof_ins, string uomdesc, string agencycode)
        //{
        //    OracleConnection objOracleConnection;
        //    OracleCommand objOraclecommand;
        //    DataSet objDataSet = new DataSet();
        //    objOracleConnection = GetConnection();
        //    OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
        //    try
        //    {
        //        objOracleConnection.Open();
        //        objOraclecommand = GetCommand("getpackgaerate_agency", ref objOracleConnection);
        //        objOraclecommand.CommandType = CommandType.StoredProcedure;

        //        objOraclecommand.Parameters.Add("@compcode", SqlDbType.VarChar);
        //        objOraclecommand.Parameters["@compcode"].Value = compcode;

        //        objOraclecommand.Parameters.Add("@adtype", SqlDbType.VarChar);
        //        objOraclecommand.Parameters["@adtype"].Value = adtype;

        //        objOraclecommand.Parameters.Add("@color", SqlDbType.VarChar);
        //        objOraclecommand.Parameters["@color"].Value = color;

        //        objOraclecommand.Parameters.Add("@adcat", SqlDbType.VarChar);
        //        objOraclecommand.Parameters["@adcat"].Value = adcat;

        //        objOraclecommand.Parameters.Add("@adsucat", SqlDbType.VarChar);
        //        objOraclecommand.Parameters["@adsucat"].Value = adsucat;

        //        objOraclecommand.Parameters.Add("@currency", SqlDbType.VarChar);
        //        objOraclecommand.Parameters["@currency"].Value = currency;

        //        objOraclecommand.Parameters.Add("@ratecode", SqlDbType.VarChar);
        //        objOraclecommand.Parameters["@ratecode"].Value = ratecode;

        //        objOraclecommand.Parameters.Add("@package", SqlDbType.VarChar);
        //        objOraclecommand.Parameters["@package"].Value = package;

        //        objOraclecommand.Parameters.Add("@selecdate", SqlDbType.VarChar);
        //        objOraclecommand.Parameters["@selecdate"].Value = selecdate;

        //        objOraclecommand.Parameters.Add("@uom", SqlDbType.VarChar);
        //        objOraclecommand.Parameters["@uom"].Value = uom;


        //        objOraclecommand.Parameters.Add("@insert", SqlDbType.VarChar);
        //        objOraclecommand.Parameters["@insert"].Value = insert;

        //        objOraclecommand.Parameters.Add("@lines", SqlDbType.VarChar);
        //        objOraclecommand.Parameters["@lines"].Value = lines;


        //        objOraclecommand.Parameters.Add("@prem", SqlDbType.VarChar);
        //        objOraclecommand.Parameters["@prem"].Value = prem;

        //        objOraclecommand.Parameters.Add("@adcat3", SqlDbType.VarChar);
        //        if (adcat3 == "")
        //        {
        //            objOraclecommand.Parameters["@adcat3"].Value = "0";
        //        }
        //        else
        //        {
        //            objOraclecommand.Parameters["@adcat3"].Value = adcat3;
        //        }

        //        objOraclecommand.Parameters.Add("@adcat4", SqlDbType.VarChar);
        //        if (adcat4 == "")
        //        {
        //            objOraclecommand.Parameters["@adcat4"].Value = "0";
        //        }
        //        else
        //        {
        //            objOraclecommand.Parameters["@adcat4"].Value = adcat4;
        //        }
        //        objOraclecommand.Parameters.Add("@adcat5", SqlDbType.VarChar);
        //        if (adcat5 == "")
        //        {
        //            objOraclecommand.Parameters["@adcat5"].Value = "0";
        //        }
        //        else
        //        {
        //            objOraclecommand.Parameters["@adcat5"].Value = adcat5;
        //        }

        //        objOraclecommand.Parameters.Add("@clientname", SqlDbType.VarChar);
        //        objOraclecommand.Parameters["@clientname"].Value = clientname;

        //        objOraclecommand.Parameters.Add("@noof_ins", SqlDbType.VarChar);
        //        objOraclecommand.Parameters["@noof_ins"].Value = noof_ins;


        //        /*new change ankur 17 feb*/
        //        objOraclecommand.Parameters.Add("@uomdesc", SqlDbType.VarChar);
        //        objOraclecommand.Parameters["@uomdesc"].Value = uomdesc;

        //        objOraclecommand.Parameters.Add("@agencycode", SqlDbType.VarChar);
        //        objOraclecommand.Parameters["@agencycode"].Value = agencycode;



        //        objorclDataAdapter.SelectCommand = objOraclecommand;
        //        objorclDataAdapter.Fill(objDataSet);

        //        return objDataSet;

        //    }
        //    catch (Exception ex)
        //    {
        //        throw (ex);
        //    }
        //    finally
        //    {
        //        CloseConnection(ref objOracleConnection);
        //    }
        //}


        public DataSet getinserts_combin(string compcode, string code, string desc, string agencytype)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("gettheinserts_combin.gettheinserts_combin_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("code", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = code;
                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("agencytype", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = agencytype;
                objOraclecommand.Parameters.Add(prm3);


                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;






                objorclDataAdapter.SelectCommand = objOraclecommand;

                objorclDataAdapter.Fill(objDataSet);

                return objDataSet;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }




        public DataSet class_getrate_qbcagency(string adtype, string color, string adcat, string adsucat, string currency, string ratecode, string package, string selecdate, string compcode, string uom, string insert, string lines, string prem, string adcat3, string adcat4, string adcat5, string clientname, string noof_ins, string uomdesc, string agencycode, string dateformat)
        {




            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getpackgaerate_agency.getpackgaerate_agency_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm1 = new OracleParameter("package1", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = package;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("selecdate", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;

                if (selecdate == "" || selecdate == null)
                {
                    prm2.Value = System.DBNull.Value;
                }
                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = selecdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        selecdate = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = selecdate.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        selecdate = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = selecdate.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            selecdate = mm + "/" + dd + "/" + yy;
                    //        }

                }


                ////


                prm2.Value = Convert.ToDateTime(selecdate).ToString("dd-MMMM-yyyy");


                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("compcode", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = compcode;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("uom", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = uom;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("adcat1", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = adcat;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("adsucat", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = adsucat;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("color", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = color;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("adtype1", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = adtype;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("currency", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = currency;
                objOraclecommand.Parameters.Add(prm9);



                OracleParameter prm10 = new OracleParameter("ratecode", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = ratecode;
                objOraclecommand.Parameters.Add(prm10);


                OracleParameter prm11 = new OracleParameter("insert1", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = insert;
                objOraclecommand.Parameters.Add(prm11);



                OracleParameter prm12 = new OracleParameter("lines", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = lines;
                objOraclecommand.Parameters.Add(prm12);

                OracleParameter prm13 = new OracleParameter("adcat3", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                if (adcat3 == "")
                {

                    prm13.Value = "0";
                }
                else
                {
                    prm13.Value = adcat3;
                }
                objOraclecommand.Parameters.Add(prm13);




                OracleParameter prm14 = new OracleParameter("adcat4", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                if (adcat4 == "")
                {
                    prm14.Value = "0";
                }
                else
                {
                    prm14.Value = adcat4;
                }
                objOraclecommand.Parameters.Add(prm14);




                OracleParameter prm15 = new OracleParameter("adcat5", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                if (adcat5 == "")
                {
                    prm15.Value = "0";

                }
                else
                {
                    prm15.Value = adcat5;
                }
                objOraclecommand.Parameters.Add(prm15);

                OracleParameter prm16 = new OracleParameter("clientname", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = clientname;
                objOraclecommand.Parameters.Add(prm16);


                OracleParameter prm17 = new OracleParameter("prem", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = prem;
                objOraclecommand.Parameters.Add(prm17);

                OracleParameter prm18 = new OracleParameter("noof_ins", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;
                prm18.Value = noof_ins;
                objOraclecommand.Parameters.Add(prm18);



                OracleParameter prm19 = new OracleParameter("uomdesc", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                prm19.Value = uomdesc;
                objOraclecommand.Parameters.Add(prm19);


                OracleParameter prm20 = new OracleParameter("agencycode", OracleType.VarChar);
                prm20.Direction = ParameterDirection.Input;
                prm20.Value = agencycode;
                objOraclecommand.Parameters.Add(prm20);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts2"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts3", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts3"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_ACCOUNTS4", OracleType.Cursor);
                objOraclecommand.Parameters["P_ACCOUNTS4"].Direction = ParameterDirection.Output;




                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }


        }

        public DataSet getInsertion_qbc_agency(string package, string noofinsertion, string insertiondate, string startdate, string dateformat, string compcode, string adcategory, string adsubcat, string color, string adtype, string currency, string ratecode, string clickdate, string flag, string code, string @pck, string uom, string dealrate, string checkforor, string classinserts, string lines, string adcat3, string adcat4, string adcat5, string clientcode, string uomdesc, string agencycode)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("qbc_insertsrate_agency.qbc_insertsrate_agency_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm1 = new OracleParameter("package1", OracleType.VarChar, 50);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = package;
                objOraclecommand.Parameters.Add(prm1);




                OracleParameter prm2 = new OracleParameter("noofinsertion", OracleType.VarChar, 50);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = noofinsertion;
                objOraclecommand.Parameters.Add(prm2);







                OracleParameter prm3 = new OracleParameter("insertiondate", OracleType.VarChar, 50);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = insertiondate;
                objOraclecommand.Parameters.Add(prm3);





                OracleParameter prm4 = new OracleParameter("startdate", OracleType.VarChar, 50);
                prm4.Direction = ParameterDirection.Input;

                /*change for oracle*/
                if (dateformat == "dd/mm/yyyy" && startdate != "" && startdate != null)
                {
                    string[] arr = startdate.Split('/');
                    string dd = arr[0];
                    string mm = arr[1];
                    string yy = arr[2];
                    startdate = mm + "/" + dd + "/" + yy;

                }

                if (startdate == "" || startdate == null)
                {
                    prm4.Value = System.DBNull.Value;
                }
                else
                {
                    prm4.Value = Convert.ToDateTime(startdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm4);




                OracleParameter prm5 = new OracleParameter("dateformat", OracleType.VarChar, 50);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = dateformat;
                objOraclecommand.Parameters.Add(prm5);





                OracleParameter prm6 = new OracleParameter("compcode", OracleType.VarChar, 50);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = compcode;
                objOraclecommand.Parameters.Add(prm6);


                OracleParameter prm16 = new OracleParameter("pck", OracleType.VarChar, 50);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = uomdesc;
                if (pck == "" || pck == null)
                {
                    prm16.Value = System.DBNull.Value;
                }
                else
                {
                    prm16.Value = Convert.ToDecimal(pck);
                }
                objOraclecommand.Parameters.Add(prm16);

                OracleParameter prm17 = new OracleParameter("uom", OracleType.VarChar, 50);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = uom;
                objOraclecommand.Parameters.Add(prm17);

                OracleParameter prm18 = new OracleParameter("dealrate", OracleType.VarChar, 50);
                prm18.Direction = ParameterDirection.Input;

                if (dealrate == "" || dealrate == null)
                {
                    prm18.Value = System.DBNull.Value;
                }
                else
                {
                    prm18.Value = Convert.ToDecimal(dealrate);
                }
                objOraclecommand.Parameters.Add(prm18);






                OracleParameter prm7 = new OracleParameter("adcategory", OracleType.VarChar, 50);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = adcategory;
                objOraclecommand.Parameters.Add(prm7);



                OracleParameter prm8 = new OracleParameter("adsubcat", OracleType.VarChar, 50);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = adsubcat;
                objOraclecommand.Parameters.Add(prm8);



                OracleParameter prm9 = new OracleParameter("color", OracleType.VarChar, 50);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = color;
                objOraclecommand.Parameters.Add(prm9);





                OracleParameter prm10 = new OracleParameter("adtype", OracleType.VarChar, 50);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = adtype;
                objOraclecommand.Parameters.Add(prm10);



                OracleParameter prm11 = new OracleParameter("currency", OracleType.VarChar, 50);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = currency;
                objOraclecommand.Parameters.Add(prm11);



                OracleParameter prm12 = new OracleParameter("ratecode", OracleType.VarChar, 50);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = ratecode;
                objOraclecommand.Parameters.Add(prm12);




                OracleParameter prm13 = new OracleParameter("clickdate", OracleType.VarChar, 50);
                prm13.Direction = ParameterDirection.Input;

                if (dateformat == "dd/mm/yyyy" && clickdate != "" && clickdate != null)
                {
                    string[] arr = clickdate.Split('/');
                    string dd = arr[0];
                    string mm = arr[1];
                    string yy = arr[2];
                    clickdate = mm + "/" + dd + "/" + yy;

                }

                if (clickdate == "" || clickdate == null)
                {
                    prm13.Value = System.DBNull.Value;
                }
                else
                {

                    prm13.Value = Convert.ToDateTime(clickdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm13);














                /*new change ankur 11 feb*/





                OracleParameter prm14 = new OracleParameter("flag", OracleType.VarChar, 50);
                prm14.Direction = ParameterDirection.Input;
                if (flag == "" || flag == null)
                {
                    prm14.Value = System.DBNull.Value;
                }
                else
                {
                    prm14.Value = Convert.ToDecimal(flag);
                }

                objOraclecommand.Parameters.Add(prm14);

                OracleParameter prm15 = new OracleParameter("code", OracleType.VarChar, 50);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = code;
                objOraclecommand.Parameters.Add(prm15);
                OracleParameter prm19 = new OracleParameter("checkforor", OracleType.VarChar, 50);
                prm19.Direction = ParameterDirection.Input;
                prm19.Value = checkforor;
                objOraclecommand.Parameters.Add(prm19);




                OracleParameter prm20 = new OracleParameter("classinserts", OracleType.VarChar, 50);
                prm20.Direction = ParameterDirection.Input;
                prm20.Value = classinserts;
                objOraclecommand.Parameters.Add(prm20);



                OracleParameter prm21 = new OracleParameter("lines", OracleType.VarChar, 50);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = lines;
                objOraclecommand.Parameters.Add(prm21);




                OracleParameter prm22 = new OracleParameter("adcat3", OracleType.VarChar, 50);
                prm22.Direction = ParameterDirection.Input;

                if (adcat3 == "")
                {
                    prm22.Value = "0";
                }
                else
                {
                    prm22.Value = adcat3;
                }
                objOraclecommand.Parameters.Add(prm22);






                OracleParameter prm23 = new OracleParameter("adcat4", OracleType.VarChar, 50);
                prm23.Direction = ParameterDirection.Input;

                if (adcat4 == "")
                {
                    prm23.Value = "0";
                }
                else
                {
                    prm23.Value = adcat4;
                }

                objOraclecommand.Parameters.Add(prm23);






                OracleParameter prm24 = new OracleParameter("adcat5", OracleType.VarChar, 50);
                prm24.Direction = ParameterDirection.Input;

                if (adcat5 == "")
                {

                    prm24.Value = "0";
                }
                else
                {
                    prm24.Value = adcat5;
                }

                objOraclecommand.Parameters.Add(prm24);






                OracleParameter prm26 = new OracleParameter("clientcode", OracleType.VarChar, 50);
                prm26.Direction = ParameterDirection.Input;
                prm26.Value = clientcode;
                objOraclecommand.Parameters.Add(prm26);




                OracleParameter prm27 = new OracleParameter("uomdesc", OracleType.VarChar, 50);
                prm27.Direction = ParameterDirection.Input;
                prm27.Value = uomdesc;
                objOraclecommand.Parameters.Add(prm27);






                OracleParameter prm29 = new OracleParameter("agencycode", OracleType.VarChar, 50);
                prm29.Direction = ParameterDirection.Input;
                prm29.Value = agencycode;
                objOraclecommand.Parameters.Add(prm29);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("P_Accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts1"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts2"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts3", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts3"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts4", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts4"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("P_Accounts5", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts5"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts6", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts6"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("P_Accounts7", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts7"].Direction = ParameterDirection.Output;








                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }

        /////////////////////////////



        public DataSet getmaxline(string adtype, string color, string adcat, string adsucat, string currency, string ratecode, string package, string selecdate, string compcode, string uom, string noof_insert, string lines, string adcat3, string adcat4, string adcat5, string clientname, string noof_line, string dateformat, string uomdesc)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getmaxlines.getmaxlines_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("package1", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = package;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("noof_ins", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = noof_insert;
                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("insert1", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = noof_insert;
                objOraclecommand.Parameters.Add(prm3);
                OracleParameter prm4 = new OracleParameter("selecdate", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;

                if (selecdate == "" || selecdate == null)
                {
                    prm4.Value = System.DBNull.Value;
                }
                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = selecdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        selecdate = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = selecdate.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        selecdate = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = selecdate.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            selecdate = mm + "/" + dd + "/" + yy;
                    //        }

                    prm4.Value = Convert.ToDateTime(selecdate).ToString("dd-MMMM-yyyy");
                }
                //}

                objOraclecommand.Parameters.Add(prm4);
                OracleParameter prm5 = new OracleParameter("lines", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = lines;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("compcode", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = compcode;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("adcat3", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = adcat3;
                objOraclecommand.Parameters.Add(prm7);
                /*if (adcat3 == "")
                 {
                     objOraclecommand.Parameters["@adcat3"].Value = "0";
                 }
                 else
                 {
                     objOraclecommand.Parameters["@adcat3"].Value = adcat3;
                 }
                 */

                OracleParameter prm8 = new OracleParameter("adsucat", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = adsucat;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("color", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = color;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("adcat1", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = adcat;
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("currency", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = currency;
                objOraclecommand.Parameters.Add(prm11);


                OracleParameter prm12 = new OracleParameter("ratecode", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = ratecode;
                objOraclecommand.Parameters.Add(prm12);

                OracleParameter prm13 = new OracleParameter("adcat4", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = adcat4;
                objOraclecommand.Parameters.Add(prm13);
                /* if (adcat4 == "")
                {
                    objOraclecommand.Parameters["@adcat4"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat4"].Value = adcat4;
                }*/




                OracleParameter prm14 = new OracleParameter("adcat5", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = adcat5;
                objOraclecommand.Parameters.Add(prm14);
                /*   if (adcat5 == "")
                {
                    objOraclecommand.Parameters["@adcat5"].Value = "0";
                }
                else
                {
                    objOraclecommand.Parameters["@adcat5"].Value = adcat5;
                }
*/

                OracleParameter prm15 = new OracleParameter("adtype1", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = adtype;
                objOraclecommand.Parameters.Add(prm15);



                OracleParameter prm17 = new OracleParameter("uom", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = uom;
                objOraclecommand.Parameters.Add(prm17);

                OracleParameter prm18 = new OracleParameter("clientname", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;
                prm18.Value = clientname;
                objOraclecommand.Parameters.Add(prm18);
                OracleParameter prm19 = new OracleParameter("uomdesc", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                prm19.Value = uomdesc;
                objOraclecommand.Parameters.Add(prm19);
                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;





                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public void clsUpdatePage_Booking(string ciobookid, string iRowid, string ppageno)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOracleCommand;
            objOracleConnection = GetConnection();
            try
            {
                objOracleConnection.Open();
                objOracleCommand = GetCommand("websp_UpdatePage_Booking", ref objOracleConnection);
                objOracleCommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("ciobookid", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = ciobookid;
                objOracleCommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("iRowid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = iRowid;
                objOracleCommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("ppageno", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = ppageno;
                objOracleCommand.Parameters.Add(prm3);

                objOracleCommand.ExecuteNonQuery();

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet clsgetCurrentBooking(string ciobookid, string iRowid, string ins_id)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOracleCommand;
            objOracleConnection = GetConnection();
            OracleDataAdapter objOracleDataAdapter = new OracleDataAdapter();
            DataSet objDataSet = new DataSet();
            try
            {
                objOracleConnection.Open();
                objOracleCommand = GetCommand("websp_getCurrentBooking_P.websp_getCurrentBooking", ref objOracleConnection);
                objOracleCommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("ciobookid", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = ciobookid;
                objOracleCommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("iRowid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = iRowid;
                objOracleCommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("ins_id", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = ins_id;
                objOracleCommand.Parameters.Add(prm3);

                objOracleCommand.Parameters.Add("t_currentbooking", OracleType.Cursor);
                objOracleCommand.Parameters["t_currentbooking"].Direction = ParameterDirection.Output;


                objOracleDataAdapter.SelectCommand = objOracleCommand;
                objOracleDataAdapter.Fill(objDataSet);

                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public void clsUpdateBooking_AdDummy(string ciobookid, string iRowid, string ins_id, string pdate, string ppub, string pbkfor, string pedition, string psecpub, string pcolour, string psplpage, string padtype, string ppageno, string adstatus, string adfilename, double adheight, double adwidth, string dateformat)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOracleCommand;
            objOracleConnection = GetConnection();
            try
            {
                objOracleConnection.Open();
                objOracleCommand = GetCommand("websp_UpdateBooking_AdDummy", ref objOracleConnection);
                objOracleCommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("ciobookid", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = ciobookid;
                objOracleCommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("iRowid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = iRowid;
                objOracleCommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("ins_id", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = ins_id;
                objOracleCommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("pdate", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                //if (pdate == "" || pdate == null)
                //{
                //    prm4.Value = System.DBNull.Value;
                //}
                //else
                //{
                //    if (dateformat == "dd/mm/yyyy")
                //    {
                //        string[] arr = pdate.Split('/');
                //        string dd = arr[0];
                //        string mm = arr[1];
                //        string yy = arr[2];
                //        pdate = mm + "/" + dd + "/" + yy;


                //    }

                prm4.Value = Convert.ToDateTime(pdate).ToString("dd-MMMM-yyyy");
                //  }
                //prm4.Value = pdate;
                objOracleCommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("ppub", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = ppub;
                objOracleCommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("pbkfor", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = pbkfor;
                objOracleCommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("pedition", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = pedition;
                objOracleCommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("psecpub", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = psecpub;
                objOracleCommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("pcolour", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = pcolour;
                objOracleCommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("psplpage", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = psplpage;
                objOracleCommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("padtype", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = padtype;
                objOracleCommand.Parameters.Add(prm11);

                OracleParameter prm12 = new OracleParameter("ppageno", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = ppageno;
                objOracleCommand.Parameters.Add(prm12);

                OracleParameter prm13 = new OracleParameter("adstatus", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = adstatus;
                objOracleCommand.Parameters.Add(prm13);

                OracleParameter prm14 = new OracleParameter("adfilename", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = adfilename;
                objOracleCommand.Parameters.Add(prm14);

                OracleParameter prm15 = new OracleParameter("adheight", OracleType.Double);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = adheight;
                objOracleCommand.Parameters.Add(prm15);

                OracleParameter prm16 = new OracleParameter("adwidth", OracleType.Double);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = adwidth;
                objOracleCommand.Parameters.Add(prm16);

                objOracleCommand.ExecuteNonQuery();

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }


        public DataSet autogenratedbox(string compcode, string auto, string no, string center1, string agncodesubcode, string branch, string autono)
        {

            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getautocodebox.getautocodebox_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("auto1", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = auto;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("no1", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = no;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("center1", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                if (center1 == "0")
                {
                    prm4.Value = System.DBNull.Value;
                }
                else
                {
                    prm4.Value = center1;
                }
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("agency_codescode", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = agncodesubcode;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("branch", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = branch;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("save_val", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = autono;
                objOraclecommand.Parameters.Add(prm7);



                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts2"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getboxmatter(string retcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getboxmatter.getboxmatter_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("retcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = retcode;
                objOraclecommand.Parameters.Add(prm1);


                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;








                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet clsSpaceAvailability(string compcode, string pubdate, string pubcode, string centercode, string editioncode, string suppcode, string dateformat)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_spaceAvailability.websp_spaceAvailability_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar, 50);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("pubcode", OracleType.VarChar, 50);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = pubcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("centercode", OracleType.VarChar, 50);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = centercode;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("editioncode", OracleType.VarChar, 50);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = editioncode;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("suppcode", OracleType.VarChar, 50);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = suppcode;
                objOraclecommand.Parameters.Add(prm5);


                OracleParameter prm6 = new OracleParameter("pubdate", OracleType.VarChar, 50);
                prm6.Direction = ParameterDirection.Input;
                if (pubdate == "" || pubdate == null)
                {
                    prm6.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = pubdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        pubdate = mm + "/" + dd + "/" + yy;


                    }

                    prm6.Value = Convert.ToDateTime(pubdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm6);


                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet clsPagesBookedVol(string compcode, string pubdate, string pubcode, string centercode, string editioncode, string suppcode, int pgno, string spl_page, string dateformat)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_getPagesBookedVol.websp_getPagesBookedVol_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar, 50);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("pubcode", OracleType.VarChar, 50);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = pubcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("centercode", OracleType.VarChar, 50);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = centercode;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("editioncode", OracleType.VarChar, 50);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = editioncode;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("suppcode", OracleType.VarChar, 50);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = suppcode;
                objOraclecommand.Parameters.Add(prm5);


                OracleParameter prm6 = new OracleParameter("pubdate", OracleType.VarChar, 50);
                prm6.Direction = ParameterDirection.Input;
                if (pubdate == "" || pubdate == null)
                {
                    prm6.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = pubdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        pubdate = mm + "/" + dd + "/" + yy;


                    }

                    prm6.Value = Convert.ToDateTime(pubdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("pgno", OracleType.VarChar, 50);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = pgno;
                objOraclecommand.Parameters.Add(prm7);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet getReciptNo(string agencycode)
        {

            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getReceiptNo.getReceiptNo_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("agencycode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = agencycode;
                objOraclecommand.Parameters.Add(prm1);


                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                //objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                //objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet getbgcolcode(string bgcolname)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getbgcolorcode.getbgcolorcode_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("bgcolorname", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = bgcolname;
                objOraclecommand.Parameters.Add(prm1);


                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;








                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet getuom_desc(string compcode, string value)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getuomdesc.getuomdesc_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm3 = new OracleParameter("compcode", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = compcode;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("value", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = value;
                objOraclecommand.Parameters.Add(prm4);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);



                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet getAgencyBillName(string compcode, string code)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("GetAgency_agencybill.GetAgency_agencybill_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("client", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = code;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("value", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = "0";
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;





                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                //if (objDataSet.Tables[0].Rows.Count > 0)
                //{
                //    zonename = objDataSet.Tables[0].Rows[0].ItemArray[0].ToString();
                //}
                return objDataSet;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }

        public DataSet getretainer(string compcode, string center, string centermain)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("GETRETAINER.GETRETAINER_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("COMPCODE1", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("PUBCENTER", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = center;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("center", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = centermain;
                objOraclecommand.Parameters.Add(prm3);


                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getretainerDJ(string compcode, string center, string centermain, string branch, string centerdj, string loginth, string publication, string userid, string agcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("GETRETAINER_DJ", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("COMPCODE1", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("PUBCENTER", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = center;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("center", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = centermain;
                objOraclecommand.Parameters.Add(prm3);


                OracleParameter prm31 = new OracleParameter("branch", OracleType.VarChar);
                prm31.Direction = ParameterDirection.Input;
                prm31.Value = branch;
                objOraclecommand.Parameters.Add(prm31);

                OracleParameter prm4 = new OracleParameter("centerdj", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = centerdj;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("loginth", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = loginth;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("publication", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = publication;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("v_userid", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = userid;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("agcode", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = agcode;
                objOraclecommand.Parameters.Add(prm8);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet updatebookingdisp(string adsizetype, string branch, string booked_by, string prevbook, string date_time, string ciobookid, string approvedby, string audit, string rono, string rodate, string caption, string billstatus, string rostatus, string agency, string client, string agencyaddress, string clientaddresses, string agencycode, string dockitno, string execname, string execzone, string product, string brand, string keyno, string billremark, string printremark, string package, string insertion, string startdate, string repeatdate, string adtype, string adcategory, string subcategory, string color, string uom, string pageposition, string pagetype, string pageno, string adsizheight, string adsizwidth, string ratecode, string scheme, string currency, string agreedrate, string agreedamt, string spedisc, string spacedisx, string compcode, string userid, string specialcharges, string agencytype, string agencystatus, string paymode, string agencredit, string cardrate, string cardamount, string discount, string discountper, string billaddress, string totarea, string billcycle, string revenuecenter, string billpay, string billheight, string billwidth, string billto, string invoices, string vts, string tradedisc, string agencyout, string boxcode, string boxno, string boxaddress, string boxagency, string boxclient, string bookingtype, string tfn, string coupan, string campaign, string bill_amt, string pageprem, string pageamt, string premper, string grossamt, string adsizcolumn, string billcolumn, Decimal billarea, string specdiscper, string spacediscper, string paidins, string dealrate, string deviation, string varient, string contractname, string dealtype, string cardname, string cardtype, string cardmonth, string cardyear, string cardno, string receiptno, string adscat3, string adscat4, string adscat5, string bgcolor, string bulletcode, string bulletprm, string material, string region, string varient_name, string coltype, string logo_h, string logo_w, string logo_col, string logo_uom, string status, string dateformat, string retainer, string addagencyrate, string mobileno, string addlamt, string retamt, string retper, string cashrecieved, string ciragency, string cirrate, string ciredition, string cirpublication, string ciragencysubcode, string bartertype, string attach1, string attach2, string cashdiscount, string cashdiscountper, string drpdiscprem, string doctype, string chktradeval, string sharepub, string fmginsert, string chkno, string chkdate, string chkamt, string chkbankname, string ourbank, string dealerpanel, string dealerh, string dealerw, string dealertype, string multicode, string agreedrate_active, string agreedamt_active, string grossamtlocal_p, string billamtlocal_p, string chkadon, string refid, string rcpt_currency, string cur_convrate, string revisedate, string clienttype, string translation, string translationcharge, string fmgreasons, string canclecharge, string modifyrateaudit, string ip, string transdisc, string pospremdisc, string billhold)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("updatebooking.updatebooking_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;
                OracleParameter prm6 = new OracleParameter("approvedby", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = approvedby;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm8 = new OracleParameter("audit1", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = audit;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("rono", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = rono;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("rodate", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;

                if (rodate == "" || rodate == null)
                {
                    prm10.Value = System.DBNull.Value;
                }
                else
                {


                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = rodate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        rodate = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = rodate.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        rodate = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = rodate.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            rodate = mm + "/" + dd + "/" + yy;
                    //        }
                    prm10.Value = Convert.ToDateTime(rodate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("caption", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = caption;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm12 = new OracleParameter("billstatus", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = billstatus;
                objOraclecommand.Parameters.Add(prm12);

                OracleParameter prm13 = new OracleParameter("rostatus", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = rostatus;
                objOraclecommand.Parameters.Add(prm13);

                OracleParameter prm14 = new OracleParameter("agency", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = agency;
                objOraclecommand.Parameters.Add(prm14);

                OracleParameter prm15 = new OracleParameter("client", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = client;
                objOraclecommand.Parameters.Add(prm15);

                OracleParameter prm16 = new OracleParameter("agencyaddress", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = agencyaddress;
                objOraclecommand.Parameters.Add(prm16);

                OracleParameter prm17 = new OracleParameter("clientaddresses", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = clientaddresses;
                objOraclecommand.Parameters.Add(prm17);


                OracleParameter prm18 = new OracleParameter("agencycode", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;
                prm18.Value = agencycode;
                objOraclecommand.Parameters.Add(prm18);

                OracleParameter prm19 = new OracleParameter("dockitno", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                prm19.Value = dockitno;
                objOraclecommand.Parameters.Add(prm19);

                OracleParameter prm20 = new OracleParameter("execname", OracleType.VarChar);
                prm20.Direction = ParameterDirection.Input;
                prm20.Value = execname;
                objOraclecommand.Parameters.Add(prm20);

                OracleParameter prm21 = new OracleParameter("execzone", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = execzone;
                objOraclecommand.Parameters.Add(prm21);

                OracleParameter prm22 = new OracleParameter("product", OracleType.VarChar);
                prm22.Direction = ParameterDirection.Input;
                prm22.Value = product;
                objOraclecommand.Parameters.Add(prm22);



                OracleParameter prm23 = new OracleParameter("brand", OracleType.VarChar);
                prm23.Direction = ParameterDirection.Input;
                prm23.Value = brand;
                objOraclecommand.Parameters.Add(prm23);

                OracleParameter prm24 = new OracleParameter("keyno", OracleType.VarChar);
                prm24.Direction = ParameterDirection.Input;
                prm24.Value = keyno;
                objOraclecommand.Parameters.Add(prm24);

                OracleParameter prm25 = new OracleParameter("billremark", OracleType.VarChar);
                prm25.Direction = ParameterDirection.Input;
                prm25.Value = billremark;
                objOraclecommand.Parameters.Add(prm25);

                OracleParameter prm26 = new OracleParameter("printremark", OracleType.VarChar);
                prm26.Direction = ParameterDirection.Input;
                prm26.Value = printremark;
                objOraclecommand.Parameters.Add(prm26);

                OracleParameter prm27 = new OracleParameter("package1", OracleType.VarChar);
                prm27.Direction = ParameterDirection.Input;
                prm27.Value = package;
                objOraclecommand.Parameters.Add(prm27);

                OracleParameter prm28 = new OracleParameter("insertion", OracleType.VarChar);
                prm28.Direction = ParameterDirection.Input;
                if (insertion == "")
                {
                    prm28.Value = System.DBNull.Value;
                }
                else
                {
                    prm28.Value = Convert.ToDecimal(insertion);
                }
                objOraclecommand.Parameters.Add(prm28);


                OracleParameter prm29 = new OracleParameter("startdate", OracleType.VarChar);
                prm29.Direction = ParameterDirection.Input;

                if (startdate == "" || startdate == null)
                {
                    prm29.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = startdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        startdate = mm + "/" + dd + "/" + yy;
                    }

                    prm29.Value = Convert.ToDateTime(startdate).ToString("dd-MMMM-yyyy");
                }
                //if (dateformat == "dd/mm/yyyy")
                //{
                //    string[] arr = startdate.Split('/');
                //    string dd = arr[0];
                //    string mm = arr[1];
                //    string yy = arr[2];
                //    startdate = mm + "/" + dd + "/" + yy;


                //}
                //else
                //    if (dateformat == "mm/dd/yyyy")
                //    {
                //        string[] arr = startdate.Split('/');
                //        string dd = arr[1];
                //        string mm = arr[0];
                //        string yy = arr[2];
                //        startdate = mm + "/" + dd + "/" + yy;

                //    }

                //    else
                //        if (dateformat == "yyyy/mm/dd")
                //        {
                //            string[] arr = startdate.Split('/');
                //            string dd = arr[2];
                //            string mm = arr[1];
                //            string yy = arr[0];
                //            startdate = mm + "/" + dd + "/" + yy;
                //        }

                objOraclecommand.Parameters.Add(prm29);

                OracleParameter prm30 = new OracleParameter("repeatdate", OracleType.VarChar);
                prm30.Direction = ParameterDirection.Input;
                prm30.Value = repeatdate;
                objOraclecommand.Parameters.Add(prm30);

                OracleParameter prm31 = new OracleParameter("adtype1", OracleType.VarChar);
                prm31.Direction = ParameterDirection.Input;
                prm31.Value = adtype;
                objOraclecommand.Parameters.Add(prm31);

                OracleParameter prm32 = new OracleParameter("adcategory", OracleType.VarChar);
                prm32.Direction = ParameterDirection.Input;
                prm32.Value = adcategory;
                objOraclecommand.Parameters.Add(prm32);

                OracleParameter prm33 = new OracleParameter("subcategory", OracleType.VarChar);
                prm33.Direction = ParameterDirection.Input;
                prm33.Value = subcategory;
                objOraclecommand.Parameters.Add(prm33);

                OracleParameter prm34 = new OracleParameter("color", OracleType.VarChar);
                prm34.Direction = ParameterDirection.Input;
                prm34.Value = color;
                objOraclecommand.Parameters.Add(prm34);

                OracleParameter prm35 = new OracleParameter("uom", OracleType.VarChar);
                prm35.Direction = ParameterDirection.Input;
                prm35.Value = uom;
                objOraclecommand.Parameters.Add(prm35);

                OracleParameter prm36 = new OracleParameter("pageposition", OracleType.VarChar);
                prm36.Direction = ParameterDirection.Input;
                prm36.Value = pageposition;
                objOraclecommand.Parameters.Add(prm36);

                OracleParameter prm37 = new OracleParameter("pagetype1", OracleType.VarChar);
                prm37.Direction = ParameterDirection.Input;
                prm37.Value = pagetype;
                objOraclecommand.Parameters.Add(prm37);

                OracleParameter prm38 = new OracleParameter("pageno", OracleType.VarChar);
                prm38.Direction = ParameterDirection.Input;
                if (pageno == "" || pageno == null)
                {
                    prm38.Value = System.DBNull.Value;

                }
                else
                {
                    prm38.Value = Convert.ToDecimal(pageno);
                }
                objOraclecommand.Parameters.Add(prm38);



                OracleParameter prm39 = new OracleParameter("adsizheight", OracleType.VarChar);
                prm39.Direction = ParameterDirection.Input;
                if (adsizheight == "" || adsizheight == null)
                {
                    prm39.Value = System.DBNull.Value;
                }
                else
                {
                    prm39.Value = Convert.ToDecimal(adsizheight);
                }
                objOraclecommand.Parameters.Add(prm39);


                OracleParameter prm40 = new OracleParameter("adsizwidth", OracleType.VarChar);
                prm40.Direction = ParameterDirection.Input;
                if (adsizwidth == "" || adsizwidth == null)
                {
                    prm40.Value = System.DBNull.Value;
                }
                else
                {
                    prm40.Value = Convert.ToDecimal(adsizwidth);
                }
                objOraclecommand.Parameters.Add(prm40);

                OracleParameter prm43 = new OracleParameter("ratecode11", OracleType.VarChar);
                prm43.Direction = ParameterDirection.Input;
                prm43.Value = ratecode;
                objOraclecommand.Parameters.Add(prm43);

                OracleParameter prm41 = new OracleParameter("scheme1", OracleType.VarChar);
                prm41.Direction = ParameterDirection.Input;
                prm41.Value = scheme;
                objOraclecommand.Parameters.Add(prm41);

                OracleParameter prm42 = new OracleParameter("currency", OracleType.VarChar);
                prm42.Direction = ParameterDirection.Input;
                prm42.Value = currency;
                objOraclecommand.Parameters.Add(prm42);



                OracleParameter prm44 = new OracleParameter("agreedrate", OracleType.VarChar);
                prm44.Direction = ParameterDirection.Input;
                if (agreedrate == "" || agreedrate == null)
                {
                    prm44.Value = System.DBNull.Value;
                }
                else
                {
                    prm44.Value = Convert.ToDecimal(agreedrate);
                }
                objOraclecommand.Parameters.Add(prm44);


                OracleParameter prm45 = new OracleParameter("agreedamt", OracleType.VarChar);
                prm45.Direction = ParameterDirection.Input;
                if (agreedamt == "" || agreedamt == null)
                {
                    prm45.Value = System.DBNull.Value;
                }
                else
                {
                    prm45.Value = Convert.ToDecimal(agreedamt);
                }
                objOraclecommand.Parameters.Add(prm45);


                OracleParameter prm46 = new OracleParameter("spedisc", OracleType.VarChar);
                prm46.Direction = ParameterDirection.Input;
                if (spedisc == "" || spedisc == null)
                {
                    prm46.Value = System.DBNull.Value;
                }
                else
                {
                    prm46.Value = Convert.ToDecimal(spedisc);
                }
                objOraclecommand.Parameters.Add(prm46);
                OracleParameter prm48 = new OracleParameter("spacedisx", OracleType.VarChar);
                prm48.Direction = ParameterDirection.Input;
                if (spacedisx == "" || spacedisx == null)
                {
                    prm48.Value = System.DBNull.Value;
                }
                else
                {
                    prm48.Value = Convert.ToDecimal(spacedisx);
                }
                objOraclecommand.Parameters.Add(prm48);

                OracleParameter prm47 = new OracleParameter("compcode", OracleType.VarChar);
                prm47.Direction = ParameterDirection.Input;
                prm47.Value = compcode;
                objOraclecommand.Parameters.Add(prm47);
                OracleParameter prm50 = new OracleParameter("userid", OracleType.VarChar);
                prm50.Direction = ParameterDirection.Input;
                prm50.Value = userid;
                objOraclecommand.Parameters.Add(prm50);


                OracleParameter prm7 = new OracleParameter("ciobookid", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = ciobookid;
                objOraclecommand.Parameters.Add(prm7);


                OracleParameter prm1 = new OracleParameter("date_time", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                if (date_time == "" || date_time == null)
                {
                    prm1.Value = System.DBNull.Value;


                }

                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = date_time.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        date_time = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = date_time.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        date_time = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = date_time.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            date_time = mm + "/" + dd + "/" + yy;
                    //        }


                    prm1.Value = Convert.ToDateTime(date_time).ToString("dd-MMMM-yyyy");

                }
                objOraclecommand.Parameters.Add(prm1);



                OracleParameter prm3 = new OracleParameter("branch", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = branch;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("booked_by", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = booked_by;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("prevbook", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = prevbook;
                objOraclecommand.Parameters.Add(prm5);



                OracleParameter prm2 = new OracleParameter("adsizetype", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = adsizetype;
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm49 = new OracleParameter("specialcharges", OracleType.VarChar);
                prm49.Direction = ParameterDirection.Input;
                if (specialcharges == "" || specialcharges == null)
                {
                    prm49.Value = System.DBNull.Value;
                }
                else
                {
                    prm49.Value = Convert.ToDecimal(specialcharges);
                }
                objOraclecommand.Parameters.Add(prm49);




                OracleParameter prm51 = new OracleParameter("agencytype", OracleType.VarChar);
                prm51.Direction = ParameterDirection.Input;
                prm51.Value = agencytype;
                objOraclecommand.Parameters.Add(prm51);

                OracleParameter prm52 = new OracleParameter("agencystatus", OracleType.VarChar);
                prm52.Direction = ParameterDirection.Input;
                prm52.Value = agencystatus;
                objOraclecommand.Parameters.Add(prm52);

                OracleParameter prm53 = new OracleParameter("paymode", OracleType.VarChar);
                prm53.Direction = ParameterDirection.Input;
                prm53.Value = paymode;
                objOraclecommand.Parameters.Add(prm53);

                OracleParameter prm54 = new OracleParameter("agencredit", OracleType.VarChar);
                prm54.Direction = ParameterDirection.Input;
                if (agencredit == "" || agencredit == null)
                {
                    prm54.Value = System.DBNull.Value;
                }
                else
                {
                    prm54.Value = Convert.ToInt32(agencredit);
                }
                objOraclecommand.Parameters.Add(prm54);


                OracleParameter prm55 = new OracleParameter("cardrate", OracleType.VarChar);
                prm55.Direction = ParameterDirection.Input;
                if (cardrate == "" || cardrate == null)
                {
                    prm55.Value = System.DBNull.Value;
                }
                else
                {
                    prm55.Value = Convert.ToDecimal(cardrate);
                }
                objOraclecommand.Parameters.Add(prm55);


                OracleParameter prm56 = new OracleParameter("cardamount", OracleType.VarChar);
                prm56.Direction = ParameterDirection.Input;
                if (cardamount == "" || cardamount == null)
                {
                    prm56.Value = System.DBNull.Value;
                }
                else
                {
                    prm56.Value = Convert.ToDecimal(cardamount);
                }
                objOraclecommand.Parameters.Add(prm56);

                OracleParameter prm57 = new OracleParameter("discount", OracleType.VarChar);
                prm57.Direction = ParameterDirection.Input;
                if (discount == "" || discount == null)
                {
                    prm57.Value = System.DBNull.Value;
                }
                else
                {
                    prm57.Value = Convert.ToDecimal(discount);
                }
                objOraclecommand.Parameters.Add(prm57);


                OracleParameter prm58 = new OracleParameter("discountper", OracleType.VarChar);
                prm58.Direction = ParameterDirection.Input;
                if (discountper == "" || discountper == null)
                {
                    prm58.Value = System.DBNull.Value;
                }
                else
                {
                    prm58.Value = Convert.ToDecimal(discountper);
                }
                objOraclecommand.Parameters.Add(prm58);


                OracleParameter prm59 = new OracleParameter("billaddress", OracleType.VarChar);
                prm59.Direction = ParameterDirection.Input;
                prm59.Value = billaddress;
                objOraclecommand.Parameters.Add(prm59);

                OracleParameter prm60 = new OracleParameter("totarea", OracleType.VarChar);
                prm60.Direction = ParameterDirection.Input;
                if (totarea == "" || totarea == null)
                {
                    prm60.Value = System.DBNull.Value;
                }
                else
                {
                    prm60.Value = Convert.ToDecimal(totarea);
                }
                objOraclecommand.Parameters.Add(prm60);


                OracleParameter prm61 = new OracleParameter("billcycle", OracleType.VarChar);
                prm61.Direction = ParameterDirection.Input;
                prm61.Value = billcycle;
                objOraclecommand.Parameters.Add(prm61);

                OracleParameter prm63 = new OracleParameter("revenuecenter", OracleType.VarChar);
                prm63.Direction = ParameterDirection.Input;
                prm63.Value = revenuecenter;
                objOraclecommand.Parameters.Add(prm63);

                OracleParameter prm62 = new OracleParameter("billpay", OracleType.VarChar);
                prm62.Direction = ParameterDirection.Input;
                prm62.Value = billpay;
                objOraclecommand.Parameters.Add(prm62);



                OracleParameter prm64 = new OracleParameter("billheight", OracleType.VarChar);
                prm64.Direction = ParameterDirection.Input;
                if (billheight == "" || billheight == null)
                {
                    prm64.Value = System.DBNull.Value;
                }
                else
                {
                    prm64.Value = Convert.ToDecimal(billheight);
                }
                objOraclecommand.Parameters.Add(prm64);


                OracleParameter prm65 = new OracleParameter("billwidth", OracleType.VarChar);
                prm65.Direction = ParameterDirection.Input;
                if (billwidth == "" || billwidth == null)
                {
                    prm65.Value = System.DBNull.Value;
                }
                else
                {
                    prm65.Value = Convert.ToDecimal(billwidth);
                }
                objOraclecommand.Parameters.Add(prm65);


                OracleParameter prm66 = new OracleParameter("billto", OracleType.VarChar);
                prm66.Direction = ParameterDirection.Input;
                prm66.Value = billto;
                objOraclecommand.Parameters.Add(prm66);

                OracleParameter prm67 = new OracleParameter("invoices", OracleType.VarChar);
                prm67.Direction = ParameterDirection.Input;
                if (invoices == "" || invoices == null)
                {
                    prm67.Value = System.DBNull.Value;
                }
                else
                {
                    prm67.Value = Convert.ToDecimal(invoices);
                }
                objOraclecommand.Parameters.Add(prm67);


                OracleParameter prm68 = new OracleParameter("vts", OracleType.VarChar);
                prm68.Direction = ParameterDirection.Input;
                if (vts == "" || vts == null || vts == "null")
                {
                    prm68.Value = System.DBNull.Value;
                }
                else
                {
                    prm68.Value = Convert.ToDecimal(vts);
                }
                objOraclecommand.Parameters.Add(prm68);



                OracleParameter prm69 = new OracleParameter("tradedisc", OracleType.VarChar);
                prm69.Direction = ParameterDirection.Input;
                if (tradedisc == "" || tradedisc == null || tradedisc == "undefined" || tradedisc == "0")
                    prm69.Value = System.DBNull.Value;
                else
                    prm69.Value = Convert.ToDecimal(tradedisc);
                objOraclecommand.Parameters.Add(prm69);

                OracleParameter prm70 = new OracleParameter("agencyout", OracleType.VarChar);
                prm70.Direction = ParameterDirection.Input;
                prm70.Value = agencyout;
                objOraclecommand.Parameters.Add(prm70);

                OracleParameter prm71 = new OracleParameter("boxcode", OracleType.VarChar);
                prm71.Direction = ParameterDirection.Input;
                prm71.Value = boxcode;
                objOraclecommand.Parameters.Add(prm71);

                OracleParameter prm72 = new OracleParameter("boxno", OracleType.VarChar);
                prm72.Direction = ParameterDirection.Input;
                prm72.Value = boxno;
                objOraclecommand.Parameters.Add(prm72);


                OracleParameter prm74 = new OracleParameter("boxaddress", OracleType.VarChar);
                prm74.Direction = ParameterDirection.Input;
                prm74.Value = boxaddress;
                objOraclecommand.Parameters.Add(prm74);

                OracleParameter prm73 = new OracleParameter("boxagency", OracleType.VarChar);
                prm73.Direction = ParameterDirection.Input;
                prm73.Value = boxagency;
                objOraclecommand.Parameters.Add(prm73);


                OracleParameter prm75 = new OracleParameter("boxclient", OracleType.VarChar);
                prm75.Direction = ParameterDirection.Input;
                prm75.Value = boxclient;
                objOraclecommand.Parameters.Add(prm75);

                OracleParameter prm77 = new OracleParameter("bookingtype", OracleType.VarChar);
                prm77.Direction = ParameterDirection.Input;
                prm77.Value = bookingtype;
                objOraclecommand.Parameters.Add(prm77);

                OracleParameter prm78 = new OracleParameter("tfn", OracleType.VarChar);
                prm78.Direction = ParameterDirection.Input;
                prm78.Value = tfn;
                objOraclecommand.Parameters.Add(prm78);


                OracleParameter prm76 = new OracleParameter("coupan", OracleType.VarChar);
                prm76.Direction = ParameterDirection.Input;
                prm76.Value = coupan;
                objOraclecommand.Parameters.Add(prm76);




                OracleParameter prm79 = new OracleParameter("campaign", OracleType.VarChar);
                prm79.Direction = ParameterDirection.Input;
                prm79.Value = campaign;
                objOraclecommand.Parameters.Add(prm79);


                OracleParameter prm80 = new OracleParameter("bill_amt", OracleType.VarChar);
                prm80.Direction = ParameterDirection.Input;
                if (bill_amt == "" || bill_amt == null)
                {
                    prm80.Value = System.DBNull.Value;
                }
                else
                {
                    prm80.Value = Convert.ToDecimal(bill_amt);
                }
                objOraclecommand.Parameters.Add(prm80);


                OracleParameter prm81 = new OracleParameter("pageprem", OracleType.VarChar);
                prm81.Direction = ParameterDirection.Input;
                prm81.Value = pageprem;
                objOraclecommand.Parameters.Add(prm81);

                OracleParameter prm82 = new OracleParameter("pageamt", OracleType.VarChar);
                prm82.Direction = ParameterDirection.Input;
                if (pageamt == "" || pageamt == null)
                {
                    prm82.Value = System.DBNull.Value;
                }
                else
                {
                    prm82.Value = Convert.ToDecimal(pageamt);
                }
                objOraclecommand.Parameters.Add(prm82);


                OracleParameter prm83 = new OracleParameter("premper", OracleType.VarChar);
                prm83.Direction = ParameterDirection.Input;
                if (premper == "" || premper == null)
                {
                    prm83.Value = System.DBNull.Value;
                }
                else
                {
                    prm83.Value = Convert.ToDecimal(premper);
                }
                objOraclecommand.Parameters.Add(prm83);


                OracleParameter prm84 = new OracleParameter("grossamt", OracleType.VarChar);
                prm84.Direction = ParameterDirection.Input;
                if (grossamt == "" || grossamt == null)
                {
                    prm84.Value = System.DBNull.Value;
                }
                else
                {
                    prm84.Value = Convert.ToDecimal(grossamt);
                }
                objOraclecommand.Parameters.Add(prm84);



                OracleParameter prm85 = new OracleParameter("adsizcolumn", OracleType.VarChar);
                prm85.Direction = ParameterDirection.Input;
                if (adsizcolumn == "" || adsizcolumn == null)
                {
                    prm85.Value = System.DBNull.Value;
                }
                else
                {
                    prm85.Value = Convert.ToDecimal(adsizcolumn);
                }
                objOraclecommand.Parameters.Add(prm85);

                OracleParameter prm89 = new OracleParameter("billarea", OracleType.VarChar);
                prm89.Direction = ParameterDirection.Input;
                if (billarea == 0)
                {
                    prm89.Value = System.DBNull.Value;
                }
                else
                {
                    prm89.Value = Convert.ToDecimal(billarea);
                }
                objOraclecommand.Parameters.Add(prm89);


                OracleParameter prm86 = new OracleParameter("billcolumn", OracleType.VarChar);
                prm86.Direction = ParameterDirection.Input;
                if (billcolumn == "" || billcolumn == null)
                {
                    prm86.Value = System.DBNull.Value;
                }
                else
                {
                    prm86.Value = Convert.ToDecimal(billcolumn);
                }
                objOraclecommand.Parameters.Add(prm86);


                OracleParameter prm88 = new OracleParameter("spacediscper", OracleType.VarChar);
                prm88.Direction = ParameterDirection.Input;
                if (spacediscper == "" || spacediscper == null)
                {
                    prm88.Value = System.DBNull.Value;
                }
                else
                {
                    prm88.Value = Convert.ToDecimal(spacediscper);
                }
                objOraclecommand.Parameters.Add(prm88);

                OracleParameter prm87 = new OracleParameter("specdiscper", OracleType.VarChar);
                prm87.Direction = ParameterDirection.Input;
                if (specdiscper == "" || specdiscper == null)
                {
                    prm87.Value = System.DBNull.Value;
                }
                else
                {
                    prm87.Value = Convert.ToDecimal(specdiscper);
                }
                objOraclecommand.Parameters.Add(prm87);






                OracleParameter prm90 = new OracleParameter("paidins", OracleType.VarChar);
                prm90.Direction = ParameterDirection.Input;
                if (paidins == "" || paidins == null)
                {
                    prm90.Value = System.DBNull.Value;
                }
                else
                {
                    prm90.Value = Convert.ToDecimal(paidins);
                }
                objOraclecommand.Parameters.Add(prm90);
                OracleParameter prm91 = new OracleParameter("dealrate", OracleType.VarChar);
                prm91.Direction = ParameterDirection.Input;
                if (dealrate == "" || dealrate == null)
                {
                    prm91.Value = System.DBNull.Value;
                }
                else
                {
                    prm91.Value = Convert.ToDecimal(dealrate);
                }

                objOraclecommand.Parameters.Add(prm91);


                OracleParameter prm92 = new OracleParameter("deviation", OracleType.VarChar);
                prm92.Direction = ParameterDirection.Input;
                if (deviation == "" || deviation == null)
                {
                    prm92.Value = System.DBNull.Value;
                }
                else
                {
                    prm92.Value = Convert.ToDecimal(deviation);
                }
                objOraclecommand.Parameters.Add(prm92);




                OracleParameter prm93 = new OracleParameter("varient", OracleType.VarChar);
                prm93.Direction = ParameterDirection.Input;
                prm93.Value = varient;
                objOraclecommand.Parameters.Add(prm93);



                OracleParameter prm95 = new OracleParameter("dealtype", OracleType.VarChar);
                prm95.Direction = ParameterDirection.Input;
                prm95.Value = dealtype;
                objOraclecommand.Parameters.Add(prm95);

                OracleParameter prm94 = new OracleParameter("contractname", OracleType.VarChar);
                prm94.Direction = ParameterDirection.Input;
                prm94.Value = contractname;
                objOraclecommand.Parameters.Add(prm94);

                OracleParameter prm96 = new OracleParameter("cardname", OracleType.VarChar);
                prm96.Direction = ParameterDirection.Input;
                prm96.Value = cardname;
                objOraclecommand.Parameters.Add(prm96);

                OracleParameter prm97 = new OracleParameter("cardtype", OracleType.VarChar);
                prm97.Direction = ParameterDirection.Input;
                prm97.Value = cardtype;
                objOraclecommand.Parameters.Add(prm97);

                OracleParameter prm98 = new OracleParameter("cardmonth", OracleType.VarChar);
                prm98.Direction = ParameterDirection.Input;
                prm98.Value = cardmonth;
                objOraclecommand.Parameters.Add(prm98);

                OracleParameter prm99 = new OracleParameter("cardyear", OracleType.VarChar);
                prm99.Direction = ParameterDirection.Input;
                prm99.Value = cardyear;
                objOraclecommand.Parameters.Add(prm99);

                OracleParameter prm100 = new OracleParameter("cardno", OracleType.VarChar);
                prm100.Direction = ParameterDirection.Input;
                prm100.Value = cardno;
                objOraclecommand.Parameters.Add(prm100);






                OracleParameter prm101 = new OracleParameter("receiptno", OracleType.VarChar);
                prm101.Direction = ParameterDirection.Input;
                prm101.Value = receiptno;
                objOraclecommand.Parameters.Add(prm101);


                OracleParameter prm102 = new OracleParameter("adscat3", OracleType.VarChar);
                prm102.Direction = ParameterDirection.Input;
                prm102.Value = adscat3;
                objOraclecommand.Parameters.Add(prm102);


                OracleParameter prm103 = new OracleParameter("adscat4", OracleType.VarChar);
                prm103.Direction = ParameterDirection.Input;
                prm103.Value = adscat4;
                objOraclecommand.Parameters.Add(prm103);


                OracleParameter prm104 = new OracleParameter("adscat5", OracleType.VarChar);
                prm104.Direction = ParameterDirection.Input;
                prm104.Value = adscat5;
                objOraclecommand.Parameters.Add(prm104);


                OracleParameter prm105 = new OracleParameter("bgcolor", OracleType.VarChar);
                prm105.Direction = ParameterDirection.Input;
                prm105.Value = bgcolor;
                objOraclecommand.Parameters.Add(prm105);


                OracleParameter prm106 = new OracleParameter("bulletcode", OracleType.VarChar);
                prm106.Direction = ParameterDirection.Input;
                prm106.Value = bulletcode;
                objOraclecommand.Parameters.Add(prm106);


                OracleParameter prm107 = new OracleParameter("bulletprm", OracleType.VarChar);
                prm107.Direction = ParameterDirection.Input;
                if (bulletprm == "" || bulletprm == null)
                {
                    prm107.Value = System.DBNull.Value;
                }
                else
                {
                    bulletprm = bulletprm.Replace("%", "");
                    prm107.Value = Convert.ToDecimal(bulletprm);
                }
                objOraclecommand.Parameters.Add(prm107);


                OracleParameter prm108 = new OracleParameter("material", OracleType.VarChar);
                prm108.Direction = ParameterDirection.Input;
                prm108.Value = material;
                objOraclecommand.Parameters.Add(prm108);








                OracleParameter prm114 = new OracleParameter("region1", OracleType.VarChar);
                prm114.Direction = ParameterDirection.Input;
                prm114.Value = region;
                objOraclecommand.Parameters.Add(prm114);



                OracleParameter prm113 = new OracleParameter("varient_name", OracleType.VarChar);
                prm113.Direction = ParameterDirection.Input;
                prm113.Value = varient_name;
                objOraclecommand.Parameters.Add(prm113);



                /*new change ankur 9 feb*/

                OracleParameter prm115 = new OracleParameter("coltype", OracleType.VarChar);
                prm115.Direction = ParameterDirection.Input;
                prm115.Value = coltype;
                objOraclecommand.Parameters.Add(prm115);

                OracleParameter prm116 = new OracleParameter("logo_h", OracleType.VarChar);
                prm116.Direction = ParameterDirection.Input;
                prm116.Value = logo_h;
                objOraclecommand.Parameters.Add(prm116);

                OracleParameter prm117 = new OracleParameter("logo_w", OracleType.VarChar);
                prm117.Direction = ParameterDirection.Input;
                prm117.Value = logo_w;
                objOraclecommand.Parameters.Add(prm117);

                OracleParameter prm118 = new OracleParameter("logo_col", OracleType.VarChar);
                prm118.Direction = ParameterDirection.Input;
                prm118.Value = logo_col;
                objOraclecommand.Parameters.Add(prm118);

                OracleParameter prm119 = new OracleParameter("logo_uom", OracleType.VarChar);
                prm119.Direction = ParameterDirection.Input;
                prm119.Value = logo_uom;
                objOraclecommand.Parameters.Add(prm119);


                OracleParameter prm120 = new OracleParameter("retainer1", OracleType.VarChar);
                prm120.Direction = ParameterDirection.Input;
                if (retainer.LastIndexOf("(") >= 0)
                {
                    retainer = retainer.Substring(retainer.LastIndexOf("(") + 1, retainer.Length - retainer.LastIndexOf("(") - 2);
                }
                prm120.Value = retainer;
                objOraclecommand.Parameters.Add(prm120);

                OracleParameter prm121 = new OracleParameter("addagencyrate", OracleType.VarChar);
                prm121.Direction = ParameterDirection.Input;
                prm121.Value = addagencyrate;
                objOraclecommand.Parameters.Add(prm121);

                OracleParameter prm122 = new OracleParameter("mobileno", OracleType.VarChar);
                prm122.Direction = ParameterDirection.Input;
                prm122.Value = mobileno;
                objOraclecommand.Parameters.Add(prm122);

                OracleParameter prm123 = new OracleParameter("addlamt", OracleType.VarChar);
                prm123.Direction = ParameterDirection.Input;
                prm123.Value = addlamt;
                objOraclecommand.Parameters.Add(prm123);

                OracleParameter prm124 = new OracleParameter("retamt", OracleType.VarChar);
                prm124.Direction = ParameterDirection.Input;
                prm124.Value = retamt;
                objOraclecommand.Parameters.Add(prm124);

                OracleParameter prm125 = new OracleParameter("retper", OracleType.VarChar);
                prm125.Direction = ParameterDirection.Input;
                prm125.Value = retper;
                objOraclecommand.Parameters.Add(prm125);


                OracleParameter prm126 = new OracleParameter("cashrecieved", OracleType.VarChar);
                prm126.Direction = ParameterDirection.Input;
                if (cashrecieved == "" || cashrecieved == null)
                {
                    prm126.Value = System.DBNull.Value;
                }
                else
                {
                    prm126.Value = Convert.ToDecimal(cashrecieved);
                }
                objOraclecommand.Parameters.Add(prm126);

                OracleParameter prm127 = new OracleParameter("CIRAGENCY_V", OracleType.VarChar);
                prm127.Direction = ParameterDirection.Input;
                prm127.Value = ciragency;
                objOraclecommand.Parameters.Add(prm127);

                OracleParameter prm128 = new OracleParameter("CIRRATE_V", OracleType.VarChar);
                prm128.Direction = ParameterDirection.Input;
                prm128.Value = cirrate;
                objOraclecommand.Parameters.Add(prm128);

                OracleParameter prm129 = new OracleParameter("CIREDITION_V", OracleType.VarChar);
                prm129.Direction = ParameterDirection.Input;
                prm129.Value = ciredition;
                objOraclecommand.Parameters.Add(prm129);

                OracleParameter prm130 = new OracleParameter("CIRPUBLICATION_V", OracleType.VarChar);
                prm130.Direction = ParameterDirection.Input;
                prm130.Value = cirpublication;
                objOraclecommand.Parameters.Add(prm130);

                OracleParameter prm131 = new OracleParameter("CIRAGENCYSUBCODE_V", OracleType.VarChar);
                prm131.Direction = ParameterDirection.Input;
                prm131.Value = ciragencysubcode;
                objOraclecommand.Parameters.Add(prm131);

                OracleParameter prm132 = new OracleParameter("BARTERTYPE", OracleType.VarChar);
                prm132.Direction = ParameterDirection.Input;
                prm132.Value = bartertype;
                objOraclecommand.Parameters.Add(prm132);

                OracleParameter prm133 = new OracleParameter("CASHDISCOUNT_V", OracleType.VarChar);
                prm133.Direction = ParameterDirection.Input;
                if (cashdiscount == "")
                    prm133.Value = System.DBNull.Value;
                else
                    prm133.Value = cashdiscount;
                objOraclecommand.Parameters.Add(prm133);

                OracleParameter prm134 = new OracleParameter("CASHDISCOUNTPER_V", OracleType.VarChar);
                prm134.Direction = ParameterDirection.Input;
                prm134.Value = cashdiscountper;
                objOraclecommand.Parameters.Add(prm134);

                OracleParameter prm135 = new OracleParameter("attach1", OracleType.VarChar);
                prm135.Direction = ParameterDirection.Input;
                prm135.Value = attach1;
                objOraclecommand.Parameters.Add(prm135);

                OracleParameter prm136 = new OracleParameter("attach2", OracleType.VarChar);
                prm136.Direction = ParameterDirection.Input;
                prm136.Value = attach2;
                objOraclecommand.Parameters.Add(prm136);

                OracleParameter prm137 = new OracleParameter("drpdiscprem", OracleType.VarChar);
                prm137.Direction = ParameterDirection.Input;
                prm137.Value = drpdiscprem;
                objOraclecommand.Parameters.Add(prm137);

                OracleParameter prm138 = new OracleParameter("doctype_v", OracleType.VarChar);
                prm138.Direction = ParameterDirection.Input;
                prm138.Value = doctype;
                objOraclecommand.Parameters.Add(prm138);

                OracleParameter prm139 = new OracleParameter("CHKTRADE", OracleType.VarChar);
                prm139.Direction = ParameterDirection.Input;
                prm139.Value = chktradeval;
                objOraclecommand.Parameters.Add(prm139);

                OracleParameter prm140 = new OracleParameter("sharepub_p", OracleType.VarChar);
                prm140.Direction = ParameterDirection.Input;
                prm140.Value = sharepub;
                objOraclecommand.Parameters.Add(prm140);
                OracleParameter prm141 = new OracleParameter("fmginsert", OracleType.VarChar);
                prm141.Direction = ParameterDirection.Input;
                prm141.Value = fmginsert;
                objOraclecommand.Parameters.Add(prm141);


                OracleParameter prm142 = new OracleParameter("chkno", OracleType.VarChar);
                prm142.Direction = ParameterDirection.Input;
                prm142.Value = chkno;
                objOraclecommand.Parameters.Add(prm142);

                OracleParameter prm143 = new OracleParameter("chkdate", OracleType.DateTime);
                prm143.Direction = ParameterDirection.Input;
                if (chkdate == "" || chkdate == null)
                {
                    prm143.Value = System.DBNull.Value;

                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = chkdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        chkdate = mm + "/" + dd + "/" + yy;


                    }
                    prm143.Value = Convert.ToDateTime(chkdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm143);

                OracleParameter prm144 = new OracleParameter("chkamt", OracleType.VarChar);
                prm144.Direction = ParameterDirection.Input;
                prm144.Value = chkamt;
                objOraclecommand.Parameters.Add(prm144);
                OracleParameter prm145 = new OracleParameter("chkbankname", OracleType.VarChar);
                prm145.Direction = ParameterDirection.Input;
                prm145.Value = chkbankname;
                objOraclecommand.Parameters.Add(prm145);

                OracleParameter prm146 = new OracleParameter("ourbank", OracleType.VarChar);
                prm146.Direction = ParameterDirection.Input;
                prm146.Value = ourbank;
                objOraclecommand.Parameters.Add(prm146);

                OracleParameter prm147 = new OracleParameter("DEALERPANEL_P", OracleType.VarChar);
                prm147.Direction = ParameterDirection.Input;
                if (dealerpanel == "")
                    prm147.Value = System.DBNull.Value;
                else
                    prm147.Value = dealerpanel;
                objOraclecommand.Parameters.Add(prm147);

                OracleParameter prm148 = new OracleParameter("DEALERH_P", OracleType.VarChar);
                prm148.Direction = ParameterDirection.Input;
                if (dealerh == "")
                    prm148.Value = System.DBNull.Value;
                else
                    prm148.Value = dealerh;
                objOraclecommand.Parameters.Add(prm148);

                OracleParameter prm149 = new OracleParameter("DEALERW_P", OracleType.VarChar);
                prm149.Direction = ParameterDirection.Input;
                if (dealerw == "")
                    prm149.Value = System.DBNull.Value;
                else
                    prm149.Value = dealerw;
                objOraclecommand.Parameters.Add(prm149);

                OracleParameter prm150 = new OracleParameter("DEALERTYPE_P", OracleType.VarChar);
                prm150.Direction = ParameterDirection.Input;
                if (dealertype == "")
                    prm150.Value = System.DBNull.Value;
                else
                    prm150.Value = dealertype;
                objOraclecommand.Parameters.Add(prm150);

                OracleParameter prm151 = new OracleParameter("multiselect", OracleType.VarChar);
                prm151.Direction = ParameterDirection.Input;
                if (multicode == "")
                    prm151.Value = System.DBNull.Value;
                else
                    prm151.Value = multicode;
                objOraclecommand.Parameters.Add(prm151);

                OracleParameter prm152 = new OracleParameter("AGREEDRATE_ACTIVE", OracleType.VarChar);
                prm152.Direction = ParameterDirection.Input;
                if (agreedrate_active == "")
                    prm152.Value = System.DBNull.Value;
                else
                    prm152.Value = agreedrate_active;

                objOraclecommand.Parameters.Add(prm152);

                OracleParameter prm153 = new OracleParameter("AGREEDAMT_ACTIVE", OracleType.VarChar);
                prm153.Direction = ParameterDirection.Input;
                if (agreedamt_active == "")
                    prm153.Value = System.DBNull.Value;
                else
                    prm153.Value = agreedamt_active;

                objOraclecommand.Parameters.Add(prm153);

                OracleParameter prm154 = new OracleParameter("grossamtlocal_p", OracleType.VarChar);
                prm154.Direction = ParameterDirection.Input;
                if (grossamtlocal_p == "")
                    prm154.Value = System.DBNull.Value;
                else
                    prm154.Value = grossamtlocal_p;

                objOraclecommand.Parameters.Add(prm154);

                OracleParameter prm155 = new OracleParameter("billamtlocal_p", OracleType.VarChar);
                prm155.Direction = ParameterDirection.Input;
                if (billamtlocal_p == "")
                    prm155.Value = System.DBNull.Value;
                else
                    prm155.Value = billamtlocal_p;

                objOraclecommand.Parameters.Add(prm155);


                OracleParameter prm145a = new OracleParameter("chkadon_p", OracleType.VarChar);
                prm145a.Direction = ParameterDirection.Input;
                prm145a.Value = chkadon;
                objOraclecommand.Parameters.Add(prm145a);

                OracleParameter prm145b = new OracleParameter("refid_p", OracleType.VarChar);
                prm145b.Direction = ParameterDirection.Input;
                prm145b.Value = refid;
                objOraclecommand.Parameters.Add(prm145b);


                OracleParameter prm145c = new OracleParameter("rcpt_currency", OracleType.VarChar);
                prm145c.Direction = ParameterDirection.Input;
                prm145c.Value = rcpt_currency;
                objOraclecommand.Parameters.Add(prm145c);

                OracleParameter prm145d = new OracleParameter("cur_convrate", OracleType.VarChar);
                prm145d.Direction = ParameterDirection.Input;
                prm145d.Value = cur_convrate;
                objOraclecommand.Parameters.Add(prm145d);

                OracleParameter prm145e = new OracleParameter("p_revisedate", OracleType.VarChar);
                prm145e.Direction = ParameterDirection.Input;
                if (revisedate == "" || revisedate == null)
                {
                    prm145e.Value = System.DBNull.Value;

                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = revisedate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        revisedate = mm + "/" + dd + "/" + yy;


                    }
                    prm145e.Value = Convert.ToDateTime(revisedate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm145e);

                OracleParameter prm155a = new OracleParameter("clienttype", OracleType.VarChar);
                prm155a.Direction = ParameterDirection.Input;
                if (clienttype == "0")
                    prm155a.Value = System.DBNull.Value;
                else
                    prm155a.Value = clienttype;
                objOraclecommand.Parameters.Add(prm155a);

                OracleParameter prm153e = new OracleParameter("translation", OracleType.VarChar);
                prm153e.Direction = ParameterDirection.Input;
                if (translation == "0")
                    prm153e.Value = System.DBNull.Value;
                else
                    prm153e.Value = translation;
                objOraclecommand.Parameters.Add(prm153e);

                OracleParameter prm107a = new OracleParameter("translationcharge", OracleType.Number);
                prm107a.Direction = ParameterDirection.Input;
                if (translationcharge == "" || translationcharge == null)
                {
                    prm107a.Value = System.DBNull.Value;
                }
                else
                {
                    translationcharge = translationcharge.Replace("%", "");
                    prm107a.Value = Convert.ToDecimal(translationcharge);
                }
                objOraclecommand.Parameters.Add(prm107a);

                OracleParameter prm141a = new OracleParameter("fmgreasons", OracleType.VarChar);
                prm141a.Direction = ParameterDirection.Input;
                prm141a.Value = fmgreasons;
                objOraclecommand.Parameters.Add(prm141a);

                OracleParameter prm141b = new OracleParameter("canclecharge", OracleType.VarChar);
                prm141b.Direction = ParameterDirection.Input;
                prm141b.Value = canclecharge;
                objOraclecommand.Parameters.Add(prm141b);

                OracleParameter prm151b = new OracleParameter("P_ip", OracleType.VarChar);
                prm151b.Direction = ParameterDirection.Input;
                prm151b.Value = ip;
                objOraclecommand.Parameters.Add(prm151b);

                OracleParameter prm161b = new OracleParameter("P_RATE_AUDIT_FLAG", OracleType.VarChar);
                prm161b.Direction = ParameterDirection.Input;
                prm161b.Value = modifyrateaudit;
                objOraclecommand.Parameters.Add(prm161b);

                OracleParameter prm161bt = new OracleParameter("transdisc_p", OracleType.VarChar);
                prm161bt.Direction = ParameterDirection.Input;
                prm161bt.Value = transdisc;
                objOraclecommand.Parameters.Add(prm161bt);

                OracleParameter prm161bs = new OracleParameter("pospremdisc_p", OracleType.VarChar);
                prm161bs.Direction = ParameterDirection.Input;
                prm161bs.Value = pospremdisc;
                objOraclecommand.Parameters.Add(prm161bs);

                OracleParameter prm161b1 = new OracleParameter("billhold", OracleType.VarChar);
                prm161b1.Direction = ParameterDirection.Input;
                prm161b1.Value = billhold;
                objOraclecommand.Parameters.Add(prm161b1);


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);


                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getRetainerComm(string retainercode, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("GETRETAINERCOMM.GETRETAINERCOMM_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("COMPCODE", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("RETAINERCODE", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = retainercode;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet get_paystatus(string receipt_no)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("GETPAYSTATUS.GETPAYSTATUS_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("receiptno", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = receipt_no;
                objOraclecommand.Parameters.Add(prm1);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet boxbind_qbc(string compcode, string userid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("boxbindqbc.boxbindqbc_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("userid1", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = userid;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }

        public DataSet bgcolorbind_qbc(string compcode, string value, string userid1)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("class_bindbgcolorqbc.class_bindbgcolorqbc_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("value", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = value;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("userid1", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = userid1;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet getPremPage(string premcode, string id)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {

                objOracleConnection.Open();
                objOraclecommand = GetCommand("getPremium_PageNo.getPremium_PageNo_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("id", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = id;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("premcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = premcode;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet clsgetSupplementName(string compcode, string buttonText)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {

                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_GetSupplementName", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm1 = new OracleParameter("buttonText", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = buttonText;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet clsGetCityCode(string compcode, string editioncode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {

                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_GetCityCode", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm1 = new OracleParameter("editioncode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = editioncode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet clsExistingBookingVolume(string compcode, string currdate, string edition_Text, string premium, string adpage)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {

                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_ExistingBookingVolume", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm1 = new OracleParameter("currdate", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = currdate;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("edition_Text", OracleType.VarChar, 50);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = edition_Text;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("premium", OracleType.VarChar, 50);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = premium;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("adpage", OracleType.VarChar, 50);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = adpage;
                objOraclecommand.Parameters.Add(prm5);

                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet clsPremiumCode(string compcode, string pubcode, string editioncode, string adPremium)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {

                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_PremiumCode", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pubcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = pubcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("editioncode", OracleType.VarChar, 50);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = editioncode;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("adPremium", OracleType.VarChar, 50);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = adPremium;
                objOraclecommand.Parameters.Add(prm4);

                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet clsExistingBookingSize(string compcode, string currdate, string pubcode, string centercode, string editioncode, string suppcode, string premium, string adpage)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {

                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_ExistingBookingSize", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("currdate", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = Convert.ToDateTime(currdate).ToString("dd-MMM-yyyy");
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("pubcode", OracleType.VarChar, 50);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = pubcode;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("centercode", OracleType.VarChar, 50);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = centercode;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("editioncode", OracleType.VarChar, 50);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = editioncode;
                objOraclecommand.Parameters.Add(prm5);


                OracleParameter prm6 = new OracleParameter("suppcode", OracleType.VarChar, 50);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = suppcode;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("premium", OracleType.VarChar, 50);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = premium;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("adpage", OracleType.VarChar, 50);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = adpage;
                objOraclecommand.Parameters.Add(prm8);

                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("p_Accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts1"].Direction = ParameterDirection.Output;
                objOraclecommand.Parameters.Add("p_Accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts2"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet clsBookingEditionCode(string compcode, string editionText)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {

                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_BookingEditionCode", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("editionText", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = editionText;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        //*25Aug************

        public DataSet clsClientInfo(string compcode, string clientname)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_ClientInfo", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("clientname", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = clientname;
                objOraclecommand.Parameters.Add(prm2);


                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        //*********************
        public DataSet get_rate_qbc(string noofinsertion, string dateformat, string compcode, string uom, string adtype, string currency, string ratecode, string clientcode, string uomdesc, string agencycode, string newcode, string center, string ratepremtype, string premium, string schemetype, string fdate, string ldate, int currentcounter, string chkadon_var, string discprem, string spediscper, string pospremdisc)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("rate_qbc.rate_qbc_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                // for checking the color rate percentage appled on extra rate or not
                string openreferExtra = ConfigurationSettings.AppSettings["openreferExtra"];

                OracleParameter prm1 = new OracleParameter("noofinsertion", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = noofinsertion;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("dateformat", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = dateformat;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("compcode", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = compcode;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("uom", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = uom;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("adtype", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = adtype;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("currency", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = currency;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("ratecode", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = ratecode;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("clientcode", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = clientcode;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("uomdesc", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = uomdesc;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("openreferExtra", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = openreferExtra;
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("agencycode", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = agencycode;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm12 = new OracleParameter("newcode", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = newcode;
                objOraclecommand.Parameters.Add(prm12);

                OracleParameter prm13 = new OracleParameter("center", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = center;
                objOraclecommand.Parameters.Add(prm13);

                OracleParameter prm14 = new OracleParameter("ratepremtype", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = ratepremtype;
                objOraclecommand.Parameters.Add(prm14);

                OracleParameter prm15 = new OracleParameter("premiumval", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = premium;
                objOraclecommand.Parameters.Add(prm15);

                OracleParameter prm16 = new OracleParameter("schemetype", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = schemetype;
                objOraclecommand.Parameters.Add(prm16);

                OracleParameter prm17 = new OracleParameter("fDate", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                if (fdate == "")
                    prm17.Value = System.DBNull.Value;
                else
                    prm17.Value = fdate;
                objOraclecommand.Parameters.Add(prm17);

                OracleParameter prm18 = new OracleParameter("lDate", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;
                if (ldate == "")
                    prm18.Value = System.DBNull.Value;
                else
                    prm18.Value = ldate;
                objOraclecommand.Parameters.Add(prm18);

                OracleParameter prm19 = new OracleParameter("counter", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                prm19.Value = currentcounter;
                objOraclecommand.Parameters.Add(prm19);

                OracleParameter prm20 = new OracleParameter("rateflag", OracleType.VarChar);
                prm20.Direction = ParameterDirection.Input;
                prm20.Value = ConfigurationManager.AppSettings["FETCHMINSIZEPACKAGERATE"].ToString();
                objOraclecommand.Parameters.Add(prm20);

                OracleParameter prm19a = new OracleParameter("chkadon_p", OracleType.VarChar);
                prm19a.Direction = ParameterDirection.Input;
                if (chkadon_var == "")
                    prm19a.Value = "N";
                else
                    prm19a.Value = chkadon_var;
                objOraclecommand.Parameters.Add(prm19a);


                OracleParameter prm201 = new OracleParameter("discprem_p", OracleType.VarChar);
                prm201.Direction = ParameterDirection.Input;
                if (discprem == "" || discprem == "0")
                    prm201.Value = "";
                else
                    prm201.Value = discprem;
                objOraclecommand.Parameters.Add(prm201);

                OracleParameter prm2011 = new OracleParameter("spediscper_p", OracleType.VarChar);
                prm2011.Direction = ParameterDirection.Input;
                if (spediscper == "" || spediscper == "0")
                    prm2011.Value = "";
                else
                    prm2011.Value = spediscper;
                objOraclecommand.Parameters.Add(prm2011);

                OracleParameter prm2011q = new OracleParameter("pospremdisc_p", OracleType.VarChar);
                prm2011q.Direction = ParameterDirection.Input;
                if (pospremdisc == "" || pospremdisc == "0")
                    prm2011q.Value = "";
                else
                    prm2011q.Value = pospremdisc;
                objOraclecommand.Parameters.Add(prm2011q);



                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts1"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts2", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts2"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts3", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts3"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet clsBranchAlias(string compcode, string branchcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_BranchAlias.websp_BranchAlias_P", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("branchcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = branchcode;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }


        //*********************12-sep-09 ****************************        
        public DataSet clsMaxReceipt(string bookingid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_MaxReceipt.websp_MaxReceipt_P", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("bookingid", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = bookingid;
                objOraclecommand.Parameters.Add(prm1);

                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getvaliddate_qbc_New(string dateformat, string datetoadd, string pkgname, string adcat, string center, string adtype, string pkgid, string pkgalias)
        {

            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("get_validdate_qbc.get_validdate_qbc_P", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;
                OracleParameter prm1 = new OracleParameter("DATEFORMAT", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = dateformat;
                objOraclecommand.Parameters.Add(prm1);


                OracleParameter prm6 = new OracleParameter("datetoadd", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;

                if (dateformat == "dd/mm/yyyy" && datetoadd != "" && datetoadd != null)
                {
                    string[] arr = datetoadd.Split('/');
                    string dd = arr[0];
                    string mm = arr[1];
                    string yy = arr[2];
                    datetoadd = mm + "/" + dd + "/" + yy;

                }

                if (datetoadd == "" || datetoadd == null)
                {
                    prm6.Value = System.DBNull.Value;
                }
                else
                {
                    prm6.Value = Convert.ToDateTime(datetoadd).ToString("dd-MMMM-yyyy"); ;
                }


                objOraclecommand.Parameters.Add(prm6);
                OracleParameter prm2 = new OracleParameter("pkgname", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = pkgname;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("adcat1", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = adcat;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("center", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = center;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("adtype1", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = adtype;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm7 = new OracleParameter("pkgid", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                pkgid = pkgid.Replace("^", "+");
                prm7.Value = pkgid;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("pkgalias", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                if (pkgalias == "")
                {
                    prm8.Value = System.DBNull.Value;
                }
                else
                {
                    prm8.Value = pkgalias.Trim();
                }
                objOraclecommand.Parameters.Add(prm8);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);

                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet getPackageInsert(string pckcode, string cioid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getPackageInsert.getPackageInsert_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm2 = new OracleParameter("packagecode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = pckcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("cioid", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = cioid;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getPackageInsertBILL(string pckcode, string cioid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("Getpackageinsert_BILL.Getpackageinsert_BILL_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm2 = new OracleParameter("packagecode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = pckcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("cioid", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = cioid;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public void deleteBooking(string cioid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("deleteBooking.deleteBooking_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm2 = new OracleParameter("cioid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = cioid;
                objOraclecommand.Parameters.Add(prm2);

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objOraclecommand.ExecuteNonQuery();

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        //get Cheque Info
        public DataSet clsChequeInfo(string compcode, string receipt)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOracleCommand;
            objOracleConnection = GetConnection();
            OracleDataAdapter objOracleDataAdapter = new OracleDataAdapter();
            DataSet objDataSet = new DataSet();
            try
            {
                objOracleConnection.Open();
                objOracleCommand = GetCommand("websp_ChequeInfo.websp_ChequeInfo_P", ref objOracleConnection);
                objOracleCommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOracleCommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("receipt", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = receipt;
                objOracleCommand.Parameters.Add(prm2);

                objOracleCommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOracleCommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objOracleDataAdapter.SelectCommand = objOracleCommand;
                objOracleDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public void clsupdate_chqinfo(string compcode, string rcptno, string chqno, string chqdate, string chqamt, string bankname, string ag_codesubcode, string ag_code, string ag_subcode, string ppaymodres, string ptype, string rcptdate, string dateformat, string remarks, string ourbank, string repcode, string unit, string userid, string cioid, string execname, string retainer, string prevcioid, string grossamt)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            objOracleConnection = GetConnection();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("Websp_Update_Chqinfo.Websp_Update_Chqinfo_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pcompcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("precpt", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = rcptno;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("pchno", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = chqno;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("pchedate", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                //prm15.Value = chqdate;                
                if (chqdate == "" || chqdate == null)
                {
                    prm4.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = chqdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        chqdate = mm + "/" + dd + "/" + yy;
                    }
                    prm4.Value = Convert.ToDateTime(chqdate).ToString("dd-MMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("pamount", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                //prm10.Value = chqamt;                
                if (chqamt == "" || chqamt == null)
                {
                    prm5.Value = System.DBNull.Value;
                }
                else
                {
                    prm5.Value = chqamt;
                }
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("pbank", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = bankname;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("pagency", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = ag_codesubcode;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("pag_main_code", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = ag_code;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("pag_sub_code", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = ag_subcode;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("ppaymodres", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = ppaymodres;
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("ptype", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = ptype;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm12 = new OracleParameter("prdate", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                if (rcptdate == "" || rcptdate == null)
                {
                    prm12.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = rcptdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        rcptdate = mm + "/" + dd + "/" + yy;
                    }
                    prm12.Value = Convert.ToDateTime(rcptdate).ToString("dd-MMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm12);

                OracleParameter prm13 = new OracleParameter("remarks", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = remarks;
                objOraclecommand.Parameters.Add(prm13);

                OracleParameter prm14 = new OracleParameter("ourbank", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = ourbank;
                objOraclecommand.Parameters.Add(prm14);

                OracleParameter prm15 = new OracleParameter("rep_code", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                if (repcode == "0")
                    prm15.Value = System.DBNull.Value;
                else
                    prm15.Value = repcode;
                objOraclecommand.Parameters.Add(prm15);

                OracleParameter prm16 = new OracleParameter("punit", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = unit;
                objOraclecommand.Parameters.Add(prm16);

                OracleParameter prm17 = new OracleParameter("puser", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = userid;
                objOraclecommand.Parameters.Add(prm17);

                OracleParameter prm18 = new OracleParameter("cioid", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;
                prm18.Value = cioid;
                objOraclecommand.Parameters.Add(prm18);

                OracleParameter prm19 = new OracleParameter("execname", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                prm19.Value = execname;
                objOraclecommand.Parameters.Add(prm19);

                OracleParameter prm20 = new OracleParameter("retainer", OracleType.VarChar);
                prm20.Direction = ParameterDirection.Input;
                if (retainer.LastIndexOf("(") >= 0)
                {
                    retainer = retainer.Substring(retainer.LastIndexOf("(") + 1, retainer.Length - retainer.LastIndexOf("(") - 2);
                }
                prm20.Value = retainer;
                objOraclecommand.Parameters.Add(prm20);

                OracleParameter prm21 = new OracleParameter("prevcioid", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = prevcioid;
                objOraclecommand.Parameters.Add(prm21);

                OracleParameter prm22 = new OracleParameter("grossamt", OracleType.VarChar);
                prm22.Direction = ParameterDirection.Input;
                prm22.Value = grossamt;
                objOraclecommand.Parameters.Add(prm22);

                objOraclecommand.ExecuteNonQuery();

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public string clsInsert_rcpthdr(string compcode, string userid, string punit, string doctype, string rcptno, string rcptdate, string ptype, string preceivedreg, string pvouno, string chqamt, string ag_codesubcode, string pothercd, string chqno, string chqdate, string bankname, string premarks, string prep, string pvdate, string ag_code, string ag_subcode, string dateformat, string ourbank, string cioid, string execname, string retainer, string prevcioid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            objOracleConnection = GetConnection();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("Receiptsave_booking.Receiptsave_booking_P", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pcompcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("puserid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = userid;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("punit", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = punit;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("ptype", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = doctype;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("precpt", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = rcptno;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("prdate", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                //prm6.Value = rcptdate;               
                if (rcptdate == "" || rcptdate == null)
                {
                    prm6.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = rcptdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        rcptdate = mm + "/" + dd + "/" + yy;
                    }
                    prm6.Value = Convert.ToDateTime(rcptdate).ToString("dd-MMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("ppaymodres", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = ptype;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("preceivedreg", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = preceivedreg;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("pvouno", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = pvouno;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("pamount", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                //prm10.Value = chqamt;                
                if (chqamt == "" || chqamt == null)
                {
                    prm10.Value = System.DBNull.Value;
                }
                else
                {
                    prm10.Value = chqamt;
                }
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("pagency", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = ag_codesubcode;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm12 = new OracleParameter("pothercd", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = pothercd;
                objOraclecommand.Parameters.Add(prm12);

                OracleParameter prm13 = new OracleParameter("pchno", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = chqno;
                objOraclecommand.Parameters.Add(prm13);

                OracleParameter prm14 = new OracleParameter("pchedate", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                //prm15.Value = chqdate;                
                if (chqdate == "" || chqdate == null)
                {
                    prm14.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = chqdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        chqdate = mm + "/" + dd + "/" + yy;
                    }
                    prm14.Value = Convert.ToDateTime(chqdate).ToString("dd-MMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm14);

                OracleParameter prm15 = new OracleParameter("pbank", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = bankname;
                objOraclecommand.Parameters.Add(prm15);

                OracleParameter prm16 = new OracleParameter("pnarration", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = premarks;
                objOraclecommand.Parameters.Add(prm16);

                OracleParameter prm17 = new OracleParameter("prep", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = prep;
                objOraclecommand.Parameters.Add(prm17);

                OracleParameter prm18 = new OracleParameter("pvdate", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;
                //prm18.Value = pvdate;                
                if (pvdate == "" || pvdate == null)
                {
                    prm18.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = pvdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        pvdate = mm + "/" + dd + "/" + yy;
                    }
                    prm18.Value = Convert.ToDateTime(pvdate).ToString("dd-MMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm18);

                OracleParameter prm19 = new OracleParameter("pag_main_code", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                prm19.Value = ag_code;
                objOraclecommand.Parameters.Add(prm19);

                OracleParameter prm20 = new OracleParameter("pag_sub_code", OracleType.VarChar);
                prm20.Direction = ParameterDirection.Input;
                prm20.Value = ag_subcode;
                objOraclecommand.Parameters.Add(prm20);

                OracleParameter prm21 = new OracleParameter("ourbank", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = ourbank;
                objOraclecommand.Parameters.Add(prm21);

                OracleParameter prm22 = new OracleParameter("cioid", OracleType.VarChar);
                prm22.Direction = ParameterDirection.Input;
                prm22.Value = cioid;
                objOraclecommand.Parameters.Add(prm22);

                OracleParameter prm23 = new OracleParameter("execname", OracleType.VarChar);
                prm23.Direction = ParameterDirection.Input;
                prm23.Value = execname;
                objOraclecommand.Parameters.Add(prm23);

                OracleParameter prm24 = new OracleParameter("retainer", OracleType.VarChar);
                prm24.Direction = ParameterDirection.Input;
                if (retainer.LastIndexOf("(") >= 0)
                {
                    retainer = retainer.Substring(retainer.LastIndexOf("(") + 1, retainer.Length - retainer.LastIndexOf("(") - 2);
                }
                prm24.Value = retainer;
                objOraclecommand.Parameters.Add(prm24);

                OracleParameter prm25 = new OracleParameter("prevcioid", OracleType.VarChar);
                prm25.Direction = ParameterDirection.Input;
                prm25.Value = prevcioid;
                objOraclecommand.Parameters.Add(prm25);


                objOraclecommand.Parameters.Add("p_error", OracleType.VarChar, 2000);
                objOraclecommand.Parameters["p_error"].Direction = ParameterDirection.Output;
                string output = "";
                objOraclecommand.ExecuteNonQuery();
                output = objOraclecommand.Parameters["p_error"].Value.ToString();
                return output;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public void clsInsert_rcptdet(string compcode, string userid, string punit, string doctype, string rcptno, string rcptdate, string ptype, string preceivedreg, string pvouno, string chqamt, string ag_codesubcode, string chqno, string chqdate, string bankname, string pvdate, string ag_code, string ag_subcode, string dateformat, string remarks, string cioid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            objOracleConnection = GetConnection();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("Receiptsave1_booking.Receiptsave1_booking_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pcompcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("puserid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = userid;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("punit", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = punit;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("ptype", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = doctype;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("precpt", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = rcptno;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("prdate", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                //prm6.Value = rcptdate;               
                if (rcptdate == "" || rcptdate == null)
                {
                    prm6.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = rcptdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        rcptdate = mm + "/" + dd + "/" + yy;
                    }
                    prm6.Value = Convert.ToDateTime(rcptdate).ToString("dd-MMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("ppaymodres", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = ptype;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("preceivedreg", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = preceivedreg;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("pvouno", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = pvouno;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("pamount", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                //prm10.Value = chqamt;                
                if (chqamt == "" || chqamt == null)
                {
                    prm10.Value = System.DBNull.Value;
                }
                else
                {
                    prm10.Value = chqamt;
                }
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("pagency", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = ag_codesubcode;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm12 = new OracleParameter("pchno", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = chqno;
                objOraclecommand.Parameters.Add(prm12);

                OracleParameter prm13 = new OracleParameter("pchedate", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                //prm15.Value = chqdate;                
                if (chqdate == "" || chqdate == null)
                {
                    prm13.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = chqdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        chqdate = mm + "/" + dd + "/" + yy;
                    }
                    prm13.Value = Convert.ToDateTime(chqdate).ToString("dd-MMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm13);

                OracleParameter prm14 = new OracleParameter("pbank", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = bankname;
                objOraclecommand.Parameters.Add(prm14);

                OracleParameter prm15 = new OracleParameter("pvdate", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                //prm18.Value = pvdate;                
                if (pvdate == "" || pvdate == null)
                {
                    prm15.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = pvdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        pvdate = mm + "/" + dd + "/" + yy;
                    }
                    prm15.Value = Convert.ToDateTime(pvdate).ToString("dd-MMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm15);

                OracleParameter prm16 = new OracleParameter("pag_main_code", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = ag_code;
                objOraclecommand.Parameters.Add(prm16);

                OracleParameter prm17 = new OracleParameter("pag_sub_code", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = ag_subcode;
                objOraclecommand.Parameters.Add(prm17);

                OracleParameter prm18 = new OracleParameter("remarks", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;
                prm18.Value = remarks;
                objOraclecommand.Parameters.Add(prm18);

                OracleParameter prm19 = new OracleParameter("cioid", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                prm19.Value = cioid;
                objOraclecommand.Parameters.Add(prm19);

                objOraclecommand.ExecuteNonQuery();

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public void clsInsert_outstand(string compcode, string userid, string punit, string doctype, string rcptno, string rcptdate, string ptype, string preceivedreg, string pvouno, string chqamt, string ag_codesubcode, string pvdate, string ag_code, string ag_subcode, string dateformat)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            objOracleConnection = GetConnection();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("receiptsave2_booking.receiptsave2_booking_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pcompcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("puserid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = userid;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("punit", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = punit;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("ptype", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = doctype;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("precpt", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = rcptno;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("prdate", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                //prm6.Value = rcptdate;               
                if (rcptdate == "" || rcptdate == null)
                {
                    prm6.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = rcptdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        rcptdate = mm + "/" + dd + "/" + yy;
                    }
                    prm6.Value = Convert.ToDateTime(rcptdate).ToString("dd-MMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("ppaymodres", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = ptype;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("preceivedreg", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = preceivedreg;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("pvouno", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = pvouno;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("pamount", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                //prm10.Value = chqamt;                
                if (chqamt == "" || chqamt == null)
                {
                    prm10.Value = System.DBNull.Value;
                }
                else
                {
                    prm10.Value = chqamt;
                }
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("pagency", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = ag_codesubcode;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm12 = new OracleParameter("pvdate", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                //prm18.Value = pvdate;                
                if (pvdate == "" || pvdate == null)
                {
                    prm12.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = pvdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        pvdate = mm + "/" + dd + "/" + yy;
                    }
                    prm12.Value = Convert.ToDateTime(pvdate).ToString("dd-MMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm12);

                OracleParameter prm13 = new OracleParameter("pag_main_code", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = ag_code;
                objOraclecommand.Parameters.Add(prm13);

                OracleParameter prm14 = new OracleParameter("pag_sub_code", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = ag_subcode;
                objOraclecommand.Parameters.Add(prm14);

                objOraclecommand.ExecuteNonQuery();

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        // CHECK PREVIOUS ID REFERENCE
        public DataSet checkCIOIDReference(string compcode, string cioid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOracleCommand;
            objOracleConnection = GetConnection();
            OracleDataAdapter objOracleDataAdapter = new OracleDataAdapter();
            DataSet objDataSet = new DataSet();
            try
            {
                objOracleConnection.Open();
                objOracleCommand = GetCommand("checkCioidRef", ref objOracleConnection);
                objOracleCommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOracleCommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("cioid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = cioid;
                objOracleCommand.Parameters.Add(prm2);

                objOracleCommand.Parameters.Add("ht_rep", OracleType.Cursor);
                objOracleCommand.Parameters["ht_rep"].Direction = ParameterDirection.Output;

                objOracleDataAdapter.SelectCommand = objOracleCommand;
                objOracleDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getPkgEdition_P(string compcode, string combincode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getPkgEdition_P", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("combincode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = combincode;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getCurrdate()
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getCurrDate", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet updatebookingdisp_bill(string adsizetype, string branch, string booked_by, string prevbook, string date_time, string ciobookid, string approvedby, string audit, string rono, string rodate, string caption, string billstatus, string rostatus, string agency, string client, string agencyaddress, string clientaddresses, string agencycode, string dockitno, string execname, string execzone, string product, string brand, string keyno, string billremark, string printremark, string package, string insertion, string startdate, string repeatdate, string adtype, string adcategory, string subcategory, string color, string uom, string pageposition, string pagetype, string pageno, string adsizheight, string adsizwidth, string ratecode, string scheme, string currency, string agreedrate, string agreedamt, string spedisc, string spacedisx, string compcode, string userid, string specialcharges, string agencytype, string agencystatus, string paymode, string agencredit, string cardrate, string cardamount, string discount, string discountper, string billaddress, string totarea, string billcycle, string revenuecenter, string billpay, string billheight, string billwidth, string billto, string invoices, string vts, string tradedisc, string agencyout, string boxcode, string boxno, string boxaddress, string boxagency, string boxclient, string bookingtype, string tfn, string coupan, string campaign, string bill_amt, string pageprem, string pageamt, string premper, string grossamt, string adsizcolumn, string billcolumn, Decimal billarea, string specdiscper, string spacediscper, string paidins, string dealrate, string deviation, string varient, string contractname, string dealtype, string cardname, string cardtype, string cardmonth, string cardyear, string cardno, string receiptno, string adscat3, string adscat4, string adscat5, string bgcolor, string bulletcode, string bulletprm, string material, string region, string varient_name, string coltype, string logo_h, string logo_w, string logo_col, string logo_uom, string status, string dateformat, string retainer, string addagencyrate, string mobileno, string addlamt, string retamt, string retper, string cashrecieved, string ciragency, string cirrate, string ciredition, string cirpublication, string ciragencysubcode, string bartertype, string attach1, string attach2, string cashdiscount, string cashdiscountper, string drpdiscprem, string doctype, string chktradeval, string sharepub, string fmginsert, string chkno, string chkdate, string chkamt, string chkbankname, string ourbank, string dealerpanel, string dealerh, string dealerw, string dealertype, string multicode, string agreedrate_active, string agreedamt_active, string grossamtlocal_p, string billamtlocal_p, string chkadon, string refid, string rcpt_currency, string cur_convrate, string revisedate, string clienttype, string translation, string translationcharge, string fmgreasons, string canclecharge)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("updatebooking_bill.updatebooking_bill_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;
                OracleParameter prm6 = new OracleParameter("approvedby", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = approvedby;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm8 = new OracleParameter("audit1", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = audit;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("rono", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = rono;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("rodate", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;

                if (rodate == "" || rodate == null)
                {
                    prm10.Value = System.DBNull.Value;
                }
                else
                {


                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = rodate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        rodate = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = rodate.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        rodate = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = rodate.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            rodate = mm + "/" + dd + "/" + yy;
                    //        }
                    prm10.Value = Convert.ToDateTime(rodate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("caption", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = caption;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm12 = new OracleParameter("billstatus", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = billstatus;
                objOraclecommand.Parameters.Add(prm12);

                OracleParameter prm13 = new OracleParameter("rostatus", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = rostatus;
                objOraclecommand.Parameters.Add(prm13);

                OracleParameter prm14 = new OracleParameter("agency", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = agency;
                objOraclecommand.Parameters.Add(prm14);

                OracleParameter prm15 = new OracleParameter("client", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = client;
                objOraclecommand.Parameters.Add(prm15);

                OracleParameter prm16 = new OracleParameter("agencyaddress", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = agencyaddress;
                objOraclecommand.Parameters.Add(prm16);

                OracleParameter prm17 = new OracleParameter("clientaddresses", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = clientaddresses;
                objOraclecommand.Parameters.Add(prm17);


                OracleParameter prm18 = new OracleParameter("agencycode", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;
                prm18.Value = agencycode;
                objOraclecommand.Parameters.Add(prm18);

                OracleParameter prm19 = new OracleParameter("dockitno", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                prm19.Value = dockitno;
                objOraclecommand.Parameters.Add(prm19);

                OracleParameter prm20 = new OracleParameter("execname", OracleType.VarChar);
                prm20.Direction = ParameterDirection.Input;
                prm20.Value = execname;
                objOraclecommand.Parameters.Add(prm20);

                OracleParameter prm21 = new OracleParameter("execzone", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = execzone;
                objOraclecommand.Parameters.Add(prm21);

                OracleParameter prm22 = new OracleParameter("product", OracleType.VarChar);
                prm22.Direction = ParameterDirection.Input;
                prm22.Value = product;
                objOraclecommand.Parameters.Add(prm22);



                OracleParameter prm23 = new OracleParameter("brand", OracleType.VarChar);
                prm23.Direction = ParameterDirection.Input;
                prm23.Value = brand;
                objOraclecommand.Parameters.Add(prm23);

                OracleParameter prm24 = new OracleParameter("keyno", OracleType.VarChar);
                prm24.Direction = ParameterDirection.Input;
                prm24.Value = keyno;
                objOraclecommand.Parameters.Add(prm24);

                OracleParameter prm25 = new OracleParameter("billremark", OracleType.VarChar);
                prm25.Direction = ParameterDirection.Input;
                prm25.Value = billremark;
                objOraclecommand.Parameters.Add(prm25);

                OracleParameter prm26 = new OracleParameter("printremark", OracleType.VarChar);
                prm26.Direction = ParameterDirection.Input;
                prm26.Value = printremark;
                objOraclecommand.Parameters.Add(prm26);

                OracleParameter prm27 = new OracleParameter("package1", OracleType.VarChar);
                prm27.Direction = ParameterDirection.Input;
                prm27.Value = package;
                objOraclecommand.Parameters.Add(prm27);

                OracleParameter prm28 = new OracleParameter("insertion", OracleType.VarChar);
                prm28.Direction = ParameterDirection.Input;
                if (insertion == "")
                {
                    prm28.Value = System.DBNull.Value;
                }
                else
                {
                    prm28.Value = Convert.ToDecimal(insertion);
                }
                objOraclecommand.Parameters.Add(prm28);


                OracleParameter prm29 = new OracleParameter("startdate", OracleType.VarChar);
                prm29.Direction = ParameterDirection.Input;

                if (startdate == "" || startdate == null)
                {
                    prm29.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = startdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        startdate = mm + "/" + dd + "/" + yy;
                    }

                    prm29.Value = Convert.ToDateTime(startdate).ToString("dd-MMMM-yyyy");
                }
                //if (dateformat == "dd/mm/yyyy")
                //{
                //    string[] arr = startdate.Split('/');
                //    string dd = arr[0];
                //    string mm = arr[1];
                //    string yy = arr[2];
                //    startdate = mm + "/" + dd + "/" + yy;


                //}
                //else
                //    if (dateformat == "mm/dd/yyyy")
                //    {
                //        string[] arr = startdate.Split('/');
                //        string dd = arr[1];
                //        string mm = arr[0];
                //        string yy = arr[2];
                //        startdate = mm + "/" + dd + "/" + yy;

                //    }

                //    else
                //        if (dateformat == "yyyy/mm/dd")
                //        {
                //            string[] arr = startdate.Split('/');
                //            string dd = arr[2];
                //            string mm = arr[1];
                //            string yy = arr[0];
                //            startdate = mm + "/" + dd + "/" + yy;
                //        }

                objOraclecommand.Parameters.Add(prm29);

                OracleParameter prm30 = new OracleParameter("repeatdate", OracleType.VarChar);
                prm30.Direction = ParameterDirection.Input;
                prm30.Value = repeatdate;
                objOraclecommand.Parameters.Add(prm30);

                OracleParameter prm31 = new OracleParameter("adtype1", OracleType.VarChar);
                prm31.Direction = ParameterDirection.Input;
                prm31.Value = adtype;
                objOraclecommand.Parameters.Add(prm31);

                OracleParameter prm32 = new OracleParameter("adcategory", OracleType.VarChar);
                prm32.Direction = ParameterDirection.Input;
                prm32.Value = adcategory;
                objOraclecommand.Parameters.Add(prm32);

                OracleParameter prm33 = new OracleParameter("subcategory", OracleType.VarChar);
                prm33.Direction = ParameterDirection.Input;
                prm33.Value = subcategory;
                objOraclecommand.Parameters.Add(prm33);

                OracleParameter prm34 = new OracleParameter("color", OracleType.VarChar);
                prm34.Direction = ParameterDirection.Input;
                prm34.Value = color;
                objOraclecommand.Parameters.Add(prm34);

                OracleParameter prm35 = new OracleParameter("uom", OracleType.VarChar);
                prm35.Direction = ParameterDirection.Input;
                prm35.Value = uom;
                objOraclecommand.Parameters.Add(prm35);

                OracleParameter prm36 = new OracleParameter("pageposition", OracleType.VarChar);
                prm36.Direction = ParameterDirection.Input;
                prm36.Value = pageposition;
                objOraclecommand.Parameters.Add(prm36);

                OracleParameter prm37 = new OracleParameter("pagetype1", OracleType.VarChar);
                prm37.Direction = ParameterDirection.Input;
                prm37.Value = pagetype;
                objOraclecommand.Parameters.Add(prm37);

                OracleParameter prm38 = new OracleParameter("pageno", OracleType.VarChar);
                prm38.Direction = ParameterDirection.Input;
                if (pageno == "" || pageno == null)
                {
                    prm38.Value = System.DBNull.Value;

                }
                else
                {
                    prm38.Value = Convert.ToDecimal(pageno);
                }
                objOraclecommand.Parameters.Add(prm38);



                OracleParameter prm39 = new OracleParameter("adsizheight", OracleType.VarChar);
                prm39.Direction = ParameterDirection.Input;
                if (adsizheight == "" || adsizheight == null)
                {
                    prm39.Value = System.DBNull.Value;
                }
                else
                {
                    prm39.Value = Convert.ToDecimal(adsizheight);
                }
                objOraclecommand.Parameters.Add(prm39);


                OracleParameter prm40 = new OracleParameter("adsizwidth", OracleType.VarChar);
                prm40.Direction = ParameterDirection.Input;
                if (adsizwidth == "" || adsizwidth == null)
                {
                    prm40.Value = System.DBNull.Value;
                }
                else
                {
                    prm40.Value = Convert.ToDecimal(adsizwidth);
                }
                objOraclecommand.Parameters.Add(prm40);

                OracleParameter prm43 = new OracleParameter("ratecode11", OracleType.VarChar);
                prm43.Direction = ParameterDirection.Input;
                prm43.Value = ratecode;
                objOraclecommand.Parameters.Add(prm43);

                OracleParameter prm41 = new OracleParameter("scheme1", OracleType.VarChar);
                prm41.Direction = ParameterDirection.Input;
                prm41.Value = scheme;
                objOraclecommand.Parameters.Add(prm41);

                OracleParameter prm42 = new OracleParameter("currency", OracleType.VarChar);
                prm42.Direction = ParameterDirection.Input;
                prm42.Value = currency;
                objOraclecommand.Parameters.Add(prm42);



                OracleParameter prm44 = new OracleParameter("agreedrate", OracleType.VarChar);
                prm44.Direction = ParameterDirection.Input;
                if (agreedrate == "" || agreedrate == null)
                {
                    prm44.Value = System.DBNull.Value;
                }
                else
                {
                    prm44.Value = Convert.ToDecimal(agreedrate);
                }
                objOraclecommand.Parameters.Add(prm44);


                OracleParameter prm45 = new OracleParameter("agreedamt", OracleType.VarChar);
                prm45.Direction = ParameterDirection.Input;
                if (agreedamt == "" || agreedamt == null)
                {
                    prm45.Value = System.DBNull.Value;
                }
                else
                {
                    prm45.Value = Convert.ToDecimal(agreedamt);
                }
                objOraclecommand.Parameters.Add(prm45);


                OracleParameter prm46 = new OracleParameter("spedisc", OracleType.VarChar);
                prm46.Direction = ParameterDirection.Input;
                if (spedisc == "" || spedisc == null)
                {
                    prm46.Value = System.DBNull.Value;
                }
                else
                {
                    prm46.Value = Convert.ToDecimal(spedisc);
                }
                objOraclecommand.Parameters.Add(prm46);
                OracleParameter prm48 = new OracleParameter("spacedisx", OracleType.VarChar);
                prm48.Direction = ParameterDirection.Input;
                if (spacedisx == "" || spacedisx == null)
                {
                    prm48.Value = System.DBNull.Value;
                }
                else
                {
                    prm48.Value = Convert.ToDecimal(spacedisx);
                }
                objOraclecommand.Parameters.Add(prm48);

                OracleParameter prm47 = new OracleParameter("compcode", OracleType.VarChar);
                prm47.Direction = ParameterDirection.Input;
                prm47.Value = compcode;
                objOraclecommand.Parameters.Add(prm47);
                OracleParameter prm50 = new OracleParameter("userid", OracleType.VarChar);
                prm50.Direction = ParameterDirection.Input;
                prm50.Value = userid;
                objOraclecommand.Parameters.Add(prm50);


                OracleParameter prm7 = new OracleParameter("ciobookid", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = ciobookid;
                objOraclecommand.Parameters.Add(prm7);


                OracleParameter prm1 = new OracleParameter("date_time", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                if (date_time == "" || date_time == null)
                {
                    prm1.Value = System.DBNull.Value;


                }

                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = date_time.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        date_time = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = date_time.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        date_time = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = date_time.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            date_time = mm + "/" + dd + "/" + yy;
                    //        }


                    prm1.Value = Convert.ToDateTime(date_time).ToString("dd-MMMM-yyyy");

                }
                objOraclecommand.Parameters.Add(prm1);



                OracleParameter prm3 = new OracleParameter("branch", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = branch;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("booked_by", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = booked_by;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("prevbook", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = prevbook;
                objOraclecommand.Parameters.Add(prm5);



                OracleParameter prm2 = new OracleParameter("adsizetype", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = adsizetype;
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm49 = new OracleParameter("specialcharges", OracleType.VarChar);
                prm49.Direction = ParameterDirection.Input;
                if (specialcharges == "" || specialcharges == null)
                {
                    prm49.Value = System.DBNull.Value;
                }
                else
                {
                    prm49.Value = Convert.ToDecimal(specialcharges);
                }
                objOraclecommand.Parameters.Add(prm49);




                OracleParameter prm51 = new OracleParameter("agencytype", OracleType.VarChar);
                prm51.Direction = ParameterDirection.Input;
                prm51.Value = agencytype;
                objOraclecommand.Parameters.Add(prm51);

                OracleParameter prm52 = new OracleParameter("agencystatus", OracleType.VarChar);
                prm52.Direction = ParameterDirection.Input;
                prm52.Value = agencystatus;
                objOraclecommand.Parameters.Add(prm52);

                OracleParameter prm53 = new OracleParameter("paymode", OracleType.VarChar);
                prm53.Direction = ParameterDirection.Input;
                prm53.Value = paymode;
                objOraclecommand.Parameters.Add(prm53);

                OracleParameter prm54 = new OracleParameter("agencredit", OracleType.VarChar);
                prm54.Direction = ParameterDirection.Input;
                if (agencredit == "" || agencredit == null)
                {
                    prm54.Value = System.DBNull.Value;
                }
                else
                {
                    prm54.Value = Convert.ToInt32(agencredit);
                }
                objOraclecommand.Parameters.Add(prm54);


                OracleParameter prm55 = new OracleParameter("cardrate", OracleType.VarChar);
                prm55.Direction = ParameterDirection.Input;
                if (cardrate == "" || cardrate == null)
                {
                    prm55.Value = System.DBNull.Value;
                }
                else
                {
                    prm55.Value = Convert.ToDecimal(cardrate);
                }
                objOraclecommand.Parameters.Add(prm55);


                OracleParameter prm56 = new OracleParameter("cardamount", OracleType.VarChar);
                prm56.Direction = ParameterDirection.Input;
                if (cardamount == "" || cardamount == null)
                {
                    prm56.Value = System.DBNull.Value;
                }
                else
                {
                    prm56.Value = Convert.ToDecimal(cardamount);
                }
                objOraclecommand.Parameters.Add(prm56);

                OracleParameter prm57 = new OracleParameter("discount", OracleType.VarChar);
                prm57.Direction = ParameterDirection.Input;
                if (discount == "" || discount == null)
                {
                    prm57.Value = System.DBNull.Value;
                }
                else
                {
                    prm57.Value = Convert.ToDecimal(discount);
                }
                objOraclecommand.Parameters.Add(prm57);


                OracleParameter prm58 = new OracleParameter("discountper", OracleType.VarChar);
                prm58.Direction = ParameterDirection.Input;
                if (discountper == "" || discountper == null)
                {
                    prm58.Value = System.DBNull.Value;
                }
                else
                {
                    prm58.Value = Convert.ToDecimal(discountper);
                }
                objOraclecommand.Parameters.Add(prm58);


                OracleParameter prm59 = new OracleParameter("billaddress", OracleType.VarChar);
                prm59.Direction = ParameterDirection.Input;
                prm59.Value = billaddress;
                objOraclecommand.Parameters.Add(prm59);

                OracleParameter prm60 = new OracleParameter("totarea", OracleType.VarChar);
                prm60.Direction = ParameterDirection.Input;
                if (totarea == "" || totarea == null)
                {
                    prm60.Value = System.DBNull.Value;
                }
                else
                {
                    prm60.Value = Convert.ToDecimal(totarea);
                }
                objOraclecommand.Parameters.Add(prm60);


                OracleParameter prm61 = new OracleParameter("billcycle", OracleType.VarChar);
                prm61.Direction = ParameterDirection.Input;
                prm61.Value = billcycle;
                objOraclecommand.Parameters.Add(prm61);

                OracleParameter prm63 = new OracleParameter("revenuecenter", OracleType.VarChar);
                prm63.Direction = ParameterDirection.Input;
                prm63.Value = revenuecenter;
                objOraclecommand.Parameters.Add(prm63);

                OracleParameter prm62 = new OracleParameter("billpay", OracleType.VarChar);
                prm62.Direction = ParameterDirection.Input;
                prm62.Value = billpay;
                objOraclecommand.Parameters.Add(prm62);



                OracleParameter prm64 = new OracleParameter("billheight", OracleType.VarChar);
                prm64.Direction = ParameterDirection.Input;
                if (billheight == "" || billheight == null)
                {
                    prm64.Value = System.DBNull.Value;
                }
                else
                {
                    prm64.Value = Convert.ToDecimal(billheight);
                }
                objOraclecommand.Parameters.Add(prm64);


                OracleParameter prm65 = new OracleParameter("billwidth", OracleType.VarChar);
                prm65.Direction = ParameterDirection.Input;
                if (billwidth == "" || billwidth == null)
                {
                    prm65.Value = System.DBNull.Value;
                }
                else
                {
                    prm65.Value = Convert.ToDecimal(billwidth);
                }
                objOraclecommand.Parameters.Add(prm65);


                OracleParameter prm66 = new OracleParameter("billto", OracleType.VarChar);
                prm66.Direction = ParameterDirection.Input;
                prm66.Value = billto;
                objOraclecommand.Parameters.Add(prm66);

                OracleParameter prm67 = new OracleParameter("invoices", OracleType.VarChar);
                prm67.Direction = ParameterDirection.Input;
                if (invoices == "" || invoices == null)
                {
                    prm67.Value = System.DBNull.Value;
                }
                else
                {
                    prm67.Value = Convert.ToDecimal(invoices);
                }
                objOraclecommand.Parameters.Add(prm67);


                OracleParameter prm68 = new OracleParameter("vts", OracleType.VarChar);
                prm68.Direction = ParameterDirection.Input;
                if (vts == "" || vts == null || vts == "null")
                {
                    prm68.Value = System.DBNull.Value;
                }
                else
                {
                    prm68.Value = Convert.ToDecimal(vts);
                }
                objOraclecommand.Parameters.Add(prm68);



                OracleParameter prm69 = new OracleParameter("tradedisc", OracleType.VarChar);
                prm69.Direction = ParameterDirection.Input;
                if (tradedisc == "" || tradedisc == null || tradedisc == "undefined" || tradedisc == "0")
                    prm69.Value = System.DBNull.Value;
                else
                    prm69.Value = Convert.ToDecimal(tradedisc);
                objOraclecommand.Parameters.Add(prm69);

                OracleParameter prm70 = new OracleParameter("agencyout", OracleType.VarChar);
                prm70.Direction = ParameterDirection.Input;
                prm70.Value = agencyout;
                objOraclecommand.Parameters.Add(prm70);

                OracleParameter prm71 = new OracleParameter("boxcode", OracleType.VarChar);
                prm71.Direction = ParameterDirection.Input;
                prm71.Value = boxcode;
                objOraclecommand.Parameters.Add(prm71);

                OracleParameter prm72 = new OracleParameter("boxno", OracleType.VarChar);
                prm72.Direction = ParameterDirection.Input;
                prm72.Value = boxno;
                objOraclecommand.Parameters.Add(prm72);


                OracleParameter prm74 = new OracleParameter("boxaddress", OracleType.VarChar);
                prm74.Direction = ParameterDirection.Input;
                prm74.Value = boxaddress;
                objOraclecommand.Parameters.Add(prm74);

                OracleParameter prm73 = new OracleParameter("boxagency", OracleType.VarChar);
                prm73.Direction = ParameterDirection.Input;
                prm73.Value = boxagency;
                objOraclecommand.Parameters.Add(prm73);


                OracleParameter prm75 = new OracleParameter("boxclient", OracleType.VarChar);
                prm75.Direction = ParameterDirection.Input;
                prm75.Value = boxclient;
                objOraclecommand.Parameters.Add(prm75);

                OracleParameter prm77 = new OracleParameter("bookingtype", OracleType.VarChar);
                prm77.Direction = ParameterDirection.Input;
                prm77.Value = bookingtype;
                objOraclecommand.Parameters.Add(prm77);

                OracleParameter prm78 = new OracleParameter("tfn", OracleType.VarChar);
                prm78.Direction = ParameterDirection.Input;
                prm78.Value = tfn;
                objOraclecommand.Parameters.Add(prm78);


                OracleParameter prm76 = new OracleParameter("coupan", OracleType.VarChar);
                prm76.Direction = ParameterDirection.Input;
                prm76.Value = coupan;
                objOraclecommand.Parameters.Add(prm76);




                OracleParameter prm79 = new OracleParameter("campaign", OracleType.VarChar);
                prm79.Direction = ParameterDirection.Input;
                prm79.Value = campaign;
                objOraclecommand.Parameters.Add(prm79);


                OracleParameter prm80 = new OracleParameter("bill_amt", OracleType.VarChar);
                prm80.Direction = ParameterDirection.Input;
                if (bill_amt == "" || bill_amt == null)
                {
                    prm80.Value = System.DBNull.Value;
                }
                else
                {
                    prm80.Value = Convert.ToDecimal(bill_amt);
                }
                objOraclecommand.Parameters.Add(prm80);


                OracleParameter prm81 = new OracleParameter("pageprem", OracleType.VarChar);
                prm81.Direction = ParameterDirection.Input;
                prm81.Value = pageprem;
                objOraclecommand.Parameters.Add(prm81);

                OracleParameter prm82 = new OracleParameter("pageamt", OracleType.VarChar);
                prm82.Direction = ParameterDirection.Input;
                if (pageamt == "" || pageamt == null)
                {
                    prm82.Value = System.DBNull.Value;
                }
                else
                {
                    prm82.Value = Convert.ToDecimal(pageamt);
                }
                objOraclecommand.Parameters.Add(prm82);


                OracleParameter prm83 = new OracleParameter("premper", OracleType.VarChar);
                prm83.Direction = ParameterDirection.Input;
                if (premper == "" || premper == null)
                {
                    prm83.Value = System.DBNull.Value;
                }
                else
                {
                    prm83.Value = Convert.ToDecimal(premper);
                }
                objOraclecommand.Parameters.Add(prm83);


                OracleParameter prm84 = new OracleParameter("grossamt", OracleType.VarChar);
                prm84.Direction = ParameterDirection.Input;
                if (grossamt == "" || grossamt == null)
                {
                    prm84.Value = System.DBNull.Value;
                }
                else
                {
                    prm84.Value = Convert.ToDecimal(grossamt);
                }
                objOraclecommand.Parameters.Add(prm84);



                OracleParameter prm85 = new OracleParameter("adsizcolumn", OracleType.VarChar);
                prm85.Direction = ParameterDirection.Input;
                if (adsizcolumn == "" || adsizcolumn == null)
                {
                    prm85.Value = System.DBNull.Value;
                }
                else
                {
                    prm85.Value = Convert.ToDecimal(adsizcolumn);
                }
                objOraclecommand.Parameters.Add(prm85);

                OracleParameter prm89 = new OracleParameter("billarea", OracleType.VarChar);
                prm89.Direction = ParameterDirection.Input;
                if (billarea == 0)
                {
                    prm89.Value = System.DBNull.Value;
                }
                else
                {
                    prm89.Value = Convert.ToDecimal(billarea);
                }
                objOraclecommand.Parameters.Add(prm89);


                OracleParameter prm86 = new OracleParameter("billcolumn", OracleType.VarChar);
                prm86.Direction = ParameterDirection.Input;
                if (billcolumn == "" || billcolumn == null)
                {
                    prm86.Value = System.DBNull.Value;
                }
                else
                {
                    prm86.Value = Convert.ToDecimal(billcolumn);
                }
                objOraclecommand.Parameters.Add(prm86);


                OracleParameter prm88 = new OracleParameter("spacediscper", OracleType.VarChar);
                prm88.Direction = ParameterDirection.Input;
                if (spacediscper == "" || spacediscper == null)
                {
                    prm88.Value = System.DBNull.Value;
                }
                else
                {
                    prm88.Value = Convert.ToDecimal(spacediscper);
                }
                objOraclecommand.Parameters.Add(prm88);

                OracleParameter prm87 = new OracleParameter("specdiscper", OracleType.VarChar);
                prm87.Direction = ParameterDirection.Input;
                if (specdiscper == "" || specdiscper == null)
                {
                    prm87.Value = System.DBNull.Value;
                }
                else
                {
                    prm87.Value = Convert.ToDecimal(specdiscper);
                }
                objOraclecommand.Parameters.Add(prm87);






                OracleParameter prm90 = new OracleParameter("paidins", OracleType.VarChar);
                prm90.Direction = ParameterDirection.Input;
                if (paidins == "" || paidins == null || paidins == "NaN")
                {
                    prm90.Value = System.DBNull.Value;
                }
                else
                {
                    prm90.Value = Convert.ToDecimal(paidins);
                }
                objOraclecommand.Parameters.Add(prm90);
                OracleParameter prm91 = new OracleParameter("dealrate", OracleType.VarChar);
                prm91.Direction = ParameterDirection.Input;
                if (dealrate == "" || dealrate == null)
                {
                    prm91.Value = System.DBNull.Value;
                }
                else
                {
                    prm91.Value = Convert.ToDecimal(dealrate);
                }

                objOraclecommand.Parameters.Add(prm91);


                OracleParameter prm92 = new OracleParameter("deviation", OracleType.VarChar);
                prm92.Direction = ParameterDirection.Input;
                if (deviation == "" || deviation == null)
                {
                    prm92.Value = System.DBNull.Value;
                }
                else
                {
                    prm92.Value = Convert.ToDecimal(deviation);
                }
                objOraclecommand.Parameters.Add(prm92);




                OracleParameter prm93 = new OracleParameter("varient", OracleType.VarChar);
                prm93.Direction = ParameterDirection.Input;
                prm93.Value = varient;
                objOraclecommand.Parameters.Add(prm93);



                OracleParameter prm95 = new OracleParameter("dealtype", OracleType.VarChar);
                prm95.Direction = ParameterDirection.Input;
                prm95.Value = dealtype;
                objOraclecommand.Parameters.Add(prm95);

                OracleParameter prm94 = new OracleParameter("contractname", OracleType.VarChar);
                prm94.Direction = ParameterDirection.Input;
                prm94.Value = contractname;
                objOraclecommand.Parameters.Add(prm94);

                OracleParameter prm96 = new OracleParameter("cardname", OracleType.VarChar);
                prm96.Direction = ParameterDirection.Input;
                prm96.Value = cardname;
                objOraclecommand.Parameters.Add(prm96);

                OracleParameter prm97 = new OracleParameter("cardtype", OracleType.VarChar);
                prm97.Direction = ParameterDirection.Input;
                prm97.Value = cardtype;
                objOraclecommand.Parameters.Add(prm97);

                OracleParameter prm98 = new OracleParameter("cardmonth", OracleType.VarChar);
                prm98.Direction = ParameterDirection.Input;
                prm98.Value = cardmonth;
                objOraclecommand.Parameters.Add(prm98);

                OracleParameter prm99 = new OracleParameter("cardyear", OracleType.VarChar);
                prm99.Direction = ParameterDirection.Input;
                prm99.Value = cardyear;
                objOraclecommand.Parameters.Add(prm99);

                OracleParameter prm100 = new OracleParameter("cardno", OracleType.VarChar);
                prm100.Direction = ParameterDirection.Input;
                prm100.Value = cardno;
                objOraclecommand.Parameters.Add(prm100);






                OracleParameter prm101 = new OracleParameter("receiptno", OracleType.VarChar);
                prm101.Direction = ParameterDirection.Input;
                prm101.Value = receiptno;
                objOraclecommand.Parameters.Add(prm101);


                OracleParameter prm102 = new OracleParameter("adscat3", OracleType.VarChar);
                prm102.Direction = ParameterDirection.Input;
                prm102.Value = adscat3;
                objOraclecommand.Parameters.Add(prm102);


                OracleParameter prm103 = new OracleParameter("adscat4", OracleType.VarChar);
                prm103.Direction = ParameterDirection.Input;
                prm103.Value = adscat4;
                objOraclecommand.Parameters.Add(prm103);


                OracleParameter prm104 = new OracleParameter("adscat5", OracleType.VarChar);
                prm104.Direction = ParameterDirection.Input;
                prm104.Value = adscat5;
                objOraclecommand.Parameters.Add(prm104);


                OracleParameter prm105 = new OracleParameter("bgcolor", OracleType.VarChar);
                prm105.Direction = ParameterDirection.Input;
                prm105.Value = bgcolor;
                objOraclecommand.Parameters.Add(prm105);


                OracleParameter prm106 = new OracleParameter("bulletcode", OracleType.VarChar);
                prm106.Direction = ParameterDirection.Input;
                prm106.Value = bulletcode;
                objOraclecommand.Parameters.Add(prm106);


                OracleParameter prm107 = new OracleParameter("bulletprm", OracleType.VarChar);
                prm107.Direction = ParameterDirection.Input;
                if (bulletprm == "" || bulletprm == null)
                {
                    prm107.Value = System.DBNull.Value;
                }
                else
                {
                    bulletprm = bulletprm.Replace("%", "");
                    prm107.Value = Convert.ToDecimal(bulletprm);
                }
                objOraclecommand.Parameters.Add(prm107);


                OracleParameter prm108 = new OracleParameter("material", OracleType.VarChar);
                prm108.Direction = ParameterDirection.Input;
                prm108.Value = material;
                objOraclecommand.Parameters.Add(prm108);








                OracleParameter prm114 = new OracleParameter("region1", OracleType.VarChar);
                prm114.Direction = ParameterDirection.Input;
                prm114.Value = region;
                objOraclecommand.Parameters.Add(prm114);



                OracleParameter prm113 = new OracleParameter("varient_name", OracleType.VarChar);
                prm113.Direction = ParameterDirection.Input;
                prm113.Value = varient_name;
                objOraclecommand.Parameters.Add(prm113);



                /*new change ankur 9 feb*/

                OracleParameter prm115 = new OracleParameter("coltype", OracleType.VarChar);
                prm115.Direction = ParameterDirection.Input;
                prm115.Value = coltype;
                objOraclecommand.Parameters.Add(prm115);

                OracleParameter prm116 = new OracleParameter("logo_h", OracleType.VarChar);
                prm116.Direction = ParameterDirection.Input;
                prm116.Value = logo_h;
                objOraclecommand.Parameters.Add(prm116);

                OracleParameter prm117 = new OracleParameter("logo_w", OracleType.VarChar);
                prm117.Direction = ParameterDirection.Input;
                prm117.Value = logo_w;
                objOraclecommand.Parameters.Add(prm117);

                OracleParameter prm118 = new OracleParameter("logo_col", OracleType.VarChar);
                prm118.Direction = ParameterDirection.Input;
                prm118.Value = logo_col;
                objOraclecommand.Parameters.Add(prm118);

                OracleParameter prm119 = new OracleParameter("logo_uom", OracleType.VarChar);
                prm119.Direction = ParameterDirection.Input;
                prm119.Value = logo_uom;
                objOraclecommand.Parameters.Add(prm119);


                OracleParameter prm120 = new OracleParameter("retainer1", OracleType.VarChar);
                prm120.Direction = ParameterDirection.Input;
                if (retainer.LastIndexOf("(") >= 0)
                {
                    retainer = retainer.Substring(retainer.LastIndexOf("(") + 1, retainer.Length - retainer.LastIndexOf("(") - 2);
                }
                prm120.Value = retainer;
                objOraclecommand.Parameters.Add(prm120);

                OracleParameter prm121 = new OracleParameter("addagencyrate", OracleType.VarChar);
                prm121.Direction = ParameterDirection.Input;
                prm121.Value = addagencyrate;
                objOraclecommand.Parameters.Add(prm121);

                OracleParameter prm122 = new OracleParameter("mobileno", OracleType.VarChar);
                prm122.Direction = ParameterDirection.Input;
                prm122.Value = mobileno;
                objOraclecommand.Parameters.Add(prm122);

                OracleParameter prm123 = new OracleParameter("addlamt", OracleType.VarChar);
                prm123.Direction = ParameterDirection.Input;
                prm123.Value = addlamt;
                objOraclecommand.Parameters.Add(prm123);

                OracleParameter prm124 = new OracleParameter("retamt", OracleType.VarChar);
                prm124.Direction = ParameterDirection.Input;
                prm124.Value = retamt;
                objOraclecommand.Parameters.Add(prm124);

                OracleParameter prm125 = new OracleParameter("retper", OracleType.VarChar);
                prm125.Direction = ParameterDirection.Input;
                prm125.Value = retper;
                objOraclecommand.Parameters.Add(prm125);

                OracleParameter prm126 = new OracleParameter("cashrecieved", OracleType.VarChar);
                prm126.Direction = ParameterDirection.Input;
                if (cashrecieved == "" || cashrecieved == null)
                {
                    prm126.Value = System.DBNull.Value;
                }
                else
                {
                    prm126.Value = Convert.ToDecimal(cashrecieved);
                }
                objOraclecommand.Parameters.Add(prm126);

                OracleParameter prm127 = new OracleParameter("CIRAGENCY_V", OracleType.VarChar);
                prm127.Direction = ParameterDirection.Input;
                prm127.Value = ciragency;
                objOraclecommand.Parameters.Add(prm127);

                OracleParameter prm128 = new OracleParameter("CIRRATE_V", OracleType.VarChar);
                prm128.Direction = ParameterDirection.Input;
                prm128.Value = cirrate;
                objOraclecommand.Parameters.Add(prm128);

                OracleParameter prm129 = new OracleParameter("CIREDITION_V", OracleType.VarChar);
                prm129.Direction = ParameterDirection.Input;
                prm129.Value = ciredition;
                objOraclecommand.Parameters.Add(prm129);

                OracleParameter prm130 = new OracleParameter("CIRPUBLICATION_V", OracleType.VarChar);
                prm130.Direction = ParameterDirection.Input;
                prm130.Value = cirpublication;
                objOraclecommand.Parameters.Add(prm130);

                OracleParameter prm131 = new OracleParameter("CIRAGENCYSUBCODE_V", OracleType.VarChar);
                prm131.Direction = ParameterDirection.Input;
                prm131.Value = ciragencysubcode;
                objOraclecommand.Parameters.Add(prm131);

                OracleParameter prm132 = new OracleParameter("BARTERTYPE", OracleType.VarChar);
                prm132.Direction = ParameterDirection.Input;
                prm132.Value = bartertype;
                objOraclecommand.Parameters.Add(prm132);

                OracleParameter prm133 = new OracleParameter("CASHDISCOUNT_V", OracleType.VarChar);
                prm133.Direction = ParameterDirection.Input;
                if (cashdiscount == "")
                    prm133.Value = System.DBNull.Value;
                else
                    prm133.Value = cashdiscount;
                objOraclecommand.Parameters.Add(prm133);

                OracleParameter prm134 = new OracleParameter("CASHDISCOUNTPER_V", OracleType.VarChar);
                prm134.Direction = ParameterDirection.Input;
                prm134.Value = cashdiscountper;
                objOraclecommand.Parameters.Add(prm134);

                OracleParameter prm135 = new OracleParameter("attach1", OracleType.VarChar);
                prm135.Direction = ParameterDirection.Input;
                prm135.Value = attach1;
                objOraclecommand.Parameters.Add(prm135);

                OracleParameter prm136 = new OracleParameter("attach2", OracleType.VarChar);
                prm136.Direction = ParameterDirection.Input;
                prm136.Value = attach2;
                objOraclecommand.Parameters.Add(prm136);

                OracleParameter prm137 = new OracleParameter("drpdiscprem", OracleType.VarChar);
                prm137.Direction = ParameterDirection.Input;
                prm137.Value = drpdiscprem;
                objOraclecommand.Parameters.Add(prm137);

                OracleParameter prm138 = new OracleParameter("doctype_v", OracleType.VarChar);
                prm138.Direction = ParameterDirection.Input;
                prm138.Value = doctype;
                objOraclecommand.Parameters.Add(prm138);

                OracleParameter prm139 = new OracleParameter("CHKTRADE", OracleType.VarChar);
                prm139.Direction = ParameterDirection.Input;
                prm139.Value = chktradeval;
                objOraclecommand.Parameters.Add(prm139);

                OracleParameter prm140 = new OracleParameter("sharepub_p", OracleType.VarChar);
                prm140.Direction = ParameterDirection.Input;
                prm140.Value = sharepub;
                objOraclecommand.Parameters.Add(prm140);
                OracleParameter prm141 = new OracleParameter("fmginsert", OracleType.VarChar);
                prm141.Direction = ParameterDirection.Input;
                prm141.Value = fmginsert;
                objOraclecommand.Parameters.Add(prm141);


                OracleParameter prm142 = new OracleParameter("chkno", OracleType.VarChar);
                prm142.Direction = ParameterDirection.Input;
                prm142.Value = chkno;
                objOraclecommand.Parameters.Add(prm142);

                OracleParameter prm143 = new OracleParameter("chkdate", OracleType.DateTime);
                prm143.Direction = ParameterDirection.Input;
                if (chkdate == "" || chkdate == null)
                {
                    prm143.Value = System.DBNull.Value;

                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = chkdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        chkdate = mm + "/" + dd + "/" + yy;


                    }
                    prm143.Value = Convert.ToDateTime(chkdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm143);

                OracleParameter prm144 = new OracleParameter("chkamt", OracleType.VarChar);
                prm144.Direction = ParameterDirection.Input;
                prm144.Value = chkamt;
                objOraclecommand.Parameters.Add(prm144);
                OracleParameter prm145 = new OracleParameter("chkbankname", OracleType.VarChar);
                prm145.Direction = ParameterDirection.Input;
                prm145.Value = chkbankname;
                objOraclecommand.Parameters.Add(prm145);

                OracleParameter prm146 = new OracleParameter("ourbank", OracleType.VarChar);
                prm146.Direction = ParameterDirection.Input;
                prm146.Value = ourbank;
                objOraclecommand.Parameters.Add(prm146);

                OracleParameter prm147 = new OracleParameter("DEALERPANEL_P", OracleType.VarChar);
                prm147.Direction = ParameterDirection.Input;
                if (dealerpanel == "")
                    prm147.Value = System.DBNull.Value;
                else
                    prm147.Value = dealerpanel;
                objOraclecommand.Parameters.Add(prm147);

                OracleParameter prm148 = new OracleParameter("DEALERH_P", OracleType.VarChar);
                prm148.Direction = ParameterDirection.Input;
                if (dealerh == "")
                    prm148.Value = System.DBNull.Value;
                else
                    prm148.Value = dealerh;
                objOraclecommand.Parameters.Add(prm148);

                OracleParameter prm149 = new OracleParameter("DEALERW_P", OracleType.VarChar);
                prm149.Direction = ParameterDirection.Input;
                if (dealerw == "")
                    prm149.Value = System.DBNull.Value;
                else
                    prm149.Value = dealerw;
                objOraclecommand.Parameters.Add(prm149);

                OracleParameter prm150 = new OracleParameter("DEALERTYPE_P", OracleType.VarChar);
                prm150.Direction = ParameterDirection.Input;
                if (dealertype == "")
                    prm150.Value = System.DBNull.Value;
                else
                    prm150.Value = dealertype;
                objOraclecommand.Parameters.Add(prm150);

                OracleParameter prm151 = new OracleParameter("multiselect", OracleType.VarChar);
                prm151.Direction = ParameterDirection.Input;
                if (multicode == "")
                    prm151.Value = System.DBNull.Value;
                else
                    prm151.Value = multicode;
                objOraclecommand.Parameters.Add(prm151);

                OracleParameter prm152 = new OracleParameter("AGREEDRATE_ACTIVE", OracleType.VarChar);
                prm152.Direction = ParameterDirection.Input;
                if (agreedrate_active == "")
                    prm152.Value = System.DBNull.Value;
                else
                    prm152.Value = agreedrate_active;

                objOraclecommand.Parameters.Add(prm152);

                OracleParameter prm153 = new OracleParameter("AGREEDAMT_ACTIVE", OracleType.VarChar);
                prm153.Direction = ParameterDirection.Input;
                if (agreedamt_active == "")
                    prm153.Value = System.DBNull.Value;
                else
                    prm153.Value = agreedamt_active;

                objOraclecommand.Parameters.Add(prm153);

                OracleParameter prm154 = new OracleParameter("grossamtlocal_p", OracleType.VarChar);
                prm154.Direction = ParameterDirection.Input;
                if (grossamtlocal_p == "")
                    prm154.Value = System.DBNull.Value;
                else
                    prm154.Value = grossamtlocal_p;

                objOraclecommand.Parameters.Add(prm154);

                OracleParameter prm155 = new OracleParameter("billamtlocal_p", OracleType.VarChar);
                prm155.Direction = ParameterDirection.Input;
                if (billamtlocal_p == "")
                    prm155.Value = System.DBNull.Value;
                else
                    prm155.Value = billamtlocal_p;

                objOraclecommand.Parameters.Add(prm155);


                OracleParameter prm145a = new OracleParameter("chkadon_p", OracleType.VarChar);
                prm145a.Direction = ParameterDirection.Input;
                prm145a.Value = chkadon;
                objOraclecommand.Parameters.Add(prm145a);

                OracleParameter prm145b = new OracleParameter("refid_p", OracleType.VarChar);
                prm145b.Direction = ParameterDirection.Input;
                prm145b.Value = refid;
                objOraclecommand.Parameters.Add(prm145b);


                OracleParameter prm145c = new OracleParameter("rcpt_currency", OracleType.VarChar);
                prm145c.Direction = ParameterDirection.Input;
                prm145c.Value = rcpt_currency;
                objOraclecommand.Parameters.Add(prm145c);

                OracleParameter prm145d = new OracleParameter("cur_convrate", OracleType.VarChar);
                prm145d.Direction = ParameterDirection.Input;
                prm145d.Value = cur_convrate;
                objOraclecommand.Parameters.Add(prm145d);

                OracleParameter prm145e = new OracleParameter("p_revisedate", OracleType.VarChar);
                prm145e.Direction = ParameterDirection.Input;
                if (revisedate == "" || revisedate == null)
                {
                    prm145e.Value = System.DBNull.Value;

                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = revisedate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        revisedate = mm + "/" + dd + "/" + yy;


                    }
                    prm145e.Value = Convert.ToDateTime(revisedate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm145e);

                OracleParameter prm155a = new OracleParameter("clienttype", OracleType.VarChar);
                prm155a.Direction = ParameterDirection.Input;
                if (clienttype == "0")
                    prm155a.Value = System.DBNull.Value;
                else
                    prm155a.Value = clienttype;
                objOraclecommand.Parameters.Add(prm155a);

                OracleParameter prm153e = new OracleParameter("translation", OracleType.VarChar);
                prm153e.Direction = ParameterDirection.Input;
                if (translation == "0")
                    prm153e.Value = System.DBNull.Value;
                else
                    prm153e.Value = translation;
                objOraclecommand.Parameters.Add(prm153e);

                OracleParameter prm107a = new OracleParameter("translationcharge", OracleType.Number);
                prm107a.Direction = ParameterDirection.Input;
                if (translationcharge == "" || translationcharge == null)
                {
                    prm107a.Value = System.DBNull.Value;
                }
                else
                {
                    translationcharge = translationcharge.Replace("%", "");
                    prm107a.Value = Convert.ToDecimal(translationcharge);
                }
                objOraclecommand.Parameters.Add(prm107a);

                OracleParameter prm141a = new OracleParameter("fmgreasons", OracleType.VarChar);
                prm141a.Direction = ParameterDirection.Input;
                prm141a.Value = fmgreasons;
                objOraclecommand.Parameters.Add(prm141a);

                OracleParameter prm141b = new OracleParameter("canclecharge", OracleType.VarChar);
                prm141b.Direction = ParameterDirection.Input;
                prm141b.Value = canclecharge;
                objOraclecommand.Parameters.Add(prm141b);



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public string insertbook_ins(string insertdate, string edition, string premium1, string premium2, string premallow, string adcategory, string latestdate, string material, string cardrate, string matfilename, string discrate, string insertstatus, string billstatus, string adsubcat, string compcode, string userid, string cioid, string height, string width, string totalsize, string pagepost, string premper1, string premper2, string colid, string repeat, string insertno, string paid, string agrrate, string solorate, string grossrate, string insert_pageno, string insert_remarks, string page_code, string page_per, string noofcol, string billamt, string billrate, string logo_h, string logo_w, string logo_name, string dateformat, string adcat3, string adcat4, string adcat5, string pkgcode, string gridins, string pkgalias, string cirvts, string cirpub, string ciredi, string cirrate, string cirdate, string ciragency, string ciragencysubcode, string center, string branch, string splitdata, string subedidata, string splboldsizevalue, string vatrate, string boxcharge, string vat_inc_p, string grossamtlocal_p, string billamtlocal_p, string sectioncode_p, string resourceno_p, string caption_inserts, string dealerheight, string dealerwidth, string disc_, string agncyamnt, string adlgncyamnt, string spldisc, string cashdisc, string roundoffamt, string pdfheight, string cpnamt, string clientcatamt, string flatfreqamt, string catamt, string extrarate, string eyecather, string daywiseprem, string gstamount, string gstgrid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            string output = "";
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("insertintobookchild.insertintobookchild_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm2 = new OracleParameter("insertdate", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;

                if (insertdate == "" || insertdate == null)
                {
                    prm2.Value = System.DBNull.Value;
                }
                else
                {



                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = insertdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        insertdate = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = insertdate.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        insertdate = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = insertdate.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            insertdate = mm + "/" + dd + "/" + yy;
                    //        }
                    prm2.Value = Convert.ToDateTime(insertdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm3 = new OracleParameter("edition", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = edition;
                objOraclecommand.Parameters.Add(prm3);






                OracleParameter prm4 = new OracleParameter("premium1", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = premium1;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("premium2", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = premium2;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("premallow", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = premallow;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("adcategory", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = adcategory;
                objOraclecommand.Parameters.Add(prm7);


                OracleParameter prm8 = new OracleParameter("latestdate", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;


                if (latestdate == "" || latestdate == null)
                {
                    prm8.Value = System.DBNull.Value;
                }
                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = latestdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        latestdate = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = latestdate.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        latestdate = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = latestdate.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            latestdate = mm + "/" + dd + "/" + yy;
                    //        }
                    prm8.Value = Convert.ToDateTime(latestdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("material", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = material;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("cardrate", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;


                if (cardrate == "" || cardrate == null)
                {
                    prm10.Value = System.DBNull.Value;
                }
                else
                {
                    prm10.Value = Convert.ToDecimal(cardrate);
                }
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("matfilename", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = matfilename;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm12 = new OracleParameter("discrate", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;


                if (discrate == "" || discrate == null || discrate == "null")
                {
                    prm12.Value = System.DBNull.Value;
                }
                else
                {
                    prm12.Value = Convert.ToDecimal(discrate);
                }
                objOraclecommand.Parameters.Add(prm12);
                /*==========================================================================================*/

                OracleParameter prm13 = new OracleParameter("insertstatus", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = insertstatus;
                objOraclecommand.Parameters.Add(prm13);

                OracleParameter prm14 = new OracleParameter("billstatus", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = billstatus;
                objOraclecommand.Parameters.Add(prm14);

                OracleParameter prm15 = new OracleParameter("adsubcat1", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = adsubcat;
                objOraclecommand.Parameters.Add(prm15);

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);




                OracleParameter prm16 = new OracleParameter("userid", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = userid;
                objOraclecommand.Parameters.Add(prm16);

                OracleParameter prm17 = new OracleParameter("cioid", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = cioid;
                objOraclecommand.Parameters.Add(prm17);


                OracleParameter prm18 = new OracleParameter("height", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;


                if (height == "" || height == null)
                {
                    prm18.Value = System.DBNull.Value;
                }
                else
                {
                    prm18.Value = Convert.ToDecimal(height);
                }
                objOraclecommand.Parameters.Add(prm18);

                OracleParameter prm19 = new OracleParameter("width", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                if (width == "" || width == null)
                {
                    prm19.Value = System.DBNull.Value;
                }
                else
                {
                    prm19.Value = Convert.ToDecimal(width);
                }
                objOraclecommand.Parameters.Add(prm19);


                OracleParameter prm20 = new OracleParameter("totalsize", OracleType.VarChar);
                prm20.Direction = ParameterDirection.Input;
                if (totalsize == "" || totalsize == null)
                {
                    prm20.Value = System.DBNull.Value;
                }
                else
                {
                    prm20.Value = Convert.ToDecimal(totalsize);
                }
                objOraclecommand.Parameters.Add(prm20);


                OracleParameter prm21 = new OracleParameter("pagepost", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = pagepost;
                objOraclecommand.Parameters.Add(prm21);

                OracleParameter prm22 = new OracleParameter("premper1", OracleType.VarChar);
                prm22.Direction = ParameterDirection.Input;
                if (premper1 == "" || premper1 == null || premper1 == "null")
                {
                    prm22.Value = System.DBNull.Value;
                }
                else
                {
                    prm22.Value = Convert.ToDecimal(premper1);
                }
                objOraclecommand.Parameters.Add(prm22);




                OracleParameter prm23 = new OracleParameter("premper2", OracleType.VarChar);
                prm23.Direction = ParameterDirection.Input;
                if (premper2 == "" || premper2 == null)
                {
                    prm23.Value = System.DBNull.Value;
                }
                else
                {
                    prm23.Value = Convert.ToDecimal(premper2);
                }
                objOraclecommand.Parameters.Add(prm23);


                OracleParameter prm24 = new OracleParameter("colid", OracleType.VarChar);
                prm24.Direction = ParameterDirection.Input;
                prm24.Value = colid;
                objOraclecommand.Parameters.Add(prm24);

                OracleParameter prm25 = new OracleParameter("repeat", OracleType.VarChar);
                prm25.Direction = ParameterDirection.Input;
                if (repeat == "" || repeat == null)
                {
                    prm25.Value = System.DBNull.Value;
                }
                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = repeat.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        repeat = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = repeat.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        repeat = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = repeat.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            repeat = mm + "/" + dd + "/" + yy;
                    //        }
                    prm25.Value = Convert.ToDateTime(repeat).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm25);


                OracleParameter prm26 = new OracleParameter("insertno", OracleType.VarChar);
                prm26.Direction = ParameterDirection.Input;
                if (insertno == "" || insertno == null)
                {
                    prm26.Value = System.DBNull.Value;
                }
                else
                {
                    prm26.Value = Convert.ToInt32(insertno);
                }
                objOraclecommand.Parameters.Add(prm26);


                OracleParameter prm27 = new OracleParameter("paid", OracleType.VarChar);
                prm27.Direction = ParameterDirection.Input;
                prm27.Value = paid;
                objOraclecommand.Parameters.Add(prm27);

                OracleParameter prm28 = new OracleParameter("agrrate", OracleType.VarChar);
                prm28.Direction = ParameterDirection.Input;
                if (agrrate == "" || agrrate == null || agrrate == "null")
                {
                    prm28.Value = System.DBNull.Value;
                }
                else
                {
                    prm28.Value = Convert.ToDecimal(agrrate);
                }

                objOraclecommand.Parameters.Add(prm28);






                OracleParameter prm29 = new OracleParameter("solorate", OracleType.VarChar);
                prm29.Direction = ParameterDirection.Input;
                if (solorate == "" || solorate == null || solorate == "null")
                {
                    prm29.Value = System.DBNull.Value;
                }
                else
                {
                    prm29.Value = Convert.ToDecimal(solorate);
                }

                objOraclecommand.Parameters.Add(prm29);


                OracleParameter prm30 = new OracleParameter("grossrate", OracleType.VarChar);
                prm30.Direction = ParameterDirection.Input;
                if (grossrate == "" || grossrate == null)
                {
                    prm30.Value = System.DBNull.Value;
                }
                else
                {
                    prm30.Value = Convert.ToDecimal(grossrate);
                }
                objOraclecommand.Parameters.Add(prm30);

                OracleParameter prm31 = new OracleParameter("insert_pageno", OracleType.VarChar);
                prm31.Direction = ParameterDirection.Input;
                if (insert_pageno == "" || insert_pageno == null)
                {
                    prm31.Value = Convert.ToInt32("0");
                }
                else
                {
                    prm31.Value = Convert.ToInt32(insert_pageno);
                }
                objOraclecommand.Parameters.Add(prm31);


                OracleParameter prm32 = new OracleParameter("insert_remarks", OracleType.VarChar);
                prm32.Direction = ParameterDirection.Input;
                prm32.Value = insert_remarks;
                objOraclecommand.Parameters.Add(prm32);

                OracleParameter prm34 = new OracleParameter("page_code", OracleType.VarChar);
                prm34.Direction = ParameterDirection.Input;
                prm34.Value = page_code;
                objOraclecommand.Parameters.Add(prm34);

                OracleParameter prm33 = new OracleParameter("page_per", OracleType.VarChar);
                prm33.Direction = ParameterDirection.Input;
                if (page_per == "" || page_per == null || page_per == "null")
                {
                    prm33.Value = System.DBNull.Value;
                }
                else
                {
                    prm33.Value = Convert.ToDecimal(page_per);
                }
                objOraclecommand.Parameters.Add(prm33);

                OracleParameter prm35 = new OracleParameter("noofcol", OracleType.VarChar);
                prm35.Direction = ParameterDirection.Input;
                if (noofcol == "" || noofcol == null)
                {
                    prm35.Value = System.DBNull.Value;
                }
                else
                {
                    prm35.Value = Convert.ToDecimal(noofcol);
                }
                objOraclecommand.Parameters.Add(prm35);

                OracleParameter prm36 = new OracleParameter("billamt", OracleType.VarChar);
                prm36.Direction = ParameterDirection.Input;
                if (billamt == "" || billamt == null)
                {
                    prm36.Value = System.DBNull.Value;
                }
                else
                {
                    prm36.Value = Convert.ToDecimal(billamt);
                }
                objOraclecommand.Parameters.Add(prm36);

                OracleParameter prm37 = new OracleParameter("billrate", OracleType.VarChar);
                prm37.Direction = ParameterDirection.Input;
                if (billrate == "" || billrate == null)
                {
                    prm37.Value = System.DBNull.Value;
                }
                else
                {
                    prm37.Value = Convert.ToDecimal(billrate);
                }
                objOraclecommand.Parameters.Add(prm37);

                OracleParameter prm40 = new OracleParameter("logo_h", OracleType.VarChar);
                prm40.Direction = ParameterDirection.Input;
                prm40.Value = logo_h;
                objOraclecommand.Parameters.Add(prm40);

                OracleParameter prm38 = new OracleParameter("logo_w", OracleType.VarChar);
                prm38.Direction = ParameterDirection.Input;
                prm38.Value = logo_w;
                objOraclecommand.Parameters.Add(prm38);

                OracleParameter prm39 = new OracleParameter("logo_name", OracleType.VarChar);
                prm39.Direction = ParameterDirection.Input;
                prm39.Value = logo_name;
                objOraclecommand.Parameters.Add(prm39);

                OracleParameter prm43 = new OracleParameter("ad_cat_3", OracleType.VarChar);
                prm43.Direction = ParameterDirection.Input;
                prm43.Value = adcat3;
                objOraclecommand.Parameters.Add(prm43);

                OracleParameter prm41 = new OracleParameter("ad_cat_4", OracleType.VarChar);
                prm41.Direction = ParameterDirection.Input;
                prm41.Value = adcat4;
                objOraclecommand.Parameters.Add(prm41);

                OracleParameter prm42 = new OracleParameter("ad_cat_5", OracleType.VarChar);
                prm42.Direction = ParameterDirection.Input;
                prm42.Value = adcat5;
                objOraclecommand.Parameters.Add(prm42);
                //objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                //objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                OracleParameter prm44 = new OracleParameter("pkgcode", OracleType.VarChar);
                prm44.Direction = ParameterDirection.Input;
                prm44.Value = pkgcode;
                objOraclecommand.Parameters.Add(prm44);

                OracleParameter prm45 = new OracleParameter("gridins", OracleType.Number);
                prm45.Direction = ParameterDirection.Input;
                if (gridins == "")
                {
                    gridins = "1";
                }
                prm45.Value = gridins;
                objOraclecommand.Parameters.Add(prm45);

                OracleParameter prm46 = new OracleParameter("pkgalias", OracleType.VarChar);
                prm46.Direction = ParameterDirection.Input;
                prm46.Value = pkgalias;
                objOraclecommand.Parameters.Add(prm46);

                OracleParameter prm47 = new OracleParameter("cirvts", OracleType.VarChar);
                prm47.Direction = ParameterDirection.Input;
                prm47.Value = cirvts;
                objOraclecommand.Parameters.Add(prm47);

                OracleParameter prm48 = new OracleParameter("cirpub", OracleType.VarChar);
                prm48.Direction = ParameterDirection.Input;
                prm48.Value = cirpub;
                objOraclecommand.Parameters.Add(prm48);

                OracleParameter prm49 = new OracleParameter("ciredi", OracleType.VarChar);
                prm49.Direction = ParameterDirection.Input;
                prm49.Value = ciredi;
                objOraclecommand.Parameters.Add(prm49);

                OracleParameter prm50 = new OracleParameter("cirrate", OracleType.VarChar);
                prm50.Direction = ParameterDirection.Input;
                prm50.Value = cirrate;
                objOraclecommand.Parameters.Add(prm50);


                OracleParameter prm51 = new OracleParameter("cirdate_v", OracleType.VarChar);
                prm51.Direction = ParameterDirection.Input;
                if (cirdate == "" || cirdate == null)
                {
                    prm51.Value = System.DBNull.Value;
                }
                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = cirdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        cirdate = mm + "/" + dd + "/" + yy;


                    }
                    prm51.Value = Convert.ToDateTime(cirdate).ToString("dd-MMMM-yyyy");
                }

                objOraclecommand.Parameters.Add(prm51);

                OracleParameter prm52 = new OracleParameter("ciragency_v", OracleType.VarChar);
                prm52.Direction = ParameterDirection.Input;
                prm52.Value = ciragency;
                objOraclecommand.Parameters.Add(prm52);

                OracleParameter prm53 = new OracleParameter("ciragencysubcode_v", OracleType.VarChar);
                prm53.Direction = ParameterDirection.Input;
                prm53.Value = ciragencysubcode;
                objOraclecommand.Parameters.Add(prm53);

                OracleParameter prm54 = new OracleParameter("center_v", OracleType.VarChar);
                prm54.Direction = ParameterDirection.Input;
                prm54.Value = center;
                objOraclecommand.Parameters.Add(prm54);

                OracleParameter prm55 = new OracleParameter("branch_v", OracleType.VarChar);
                prm55.Direction = ParameterDirection.Input;
                prm55.Value = branch;
                objOraclecommand.Parameters.Add(prm55);

                OracleParameter prm56 = new OracleParameter("splitdata_v", OracleType.VarChar);
                prm56.Direction = ParameterDirection.Input;
                prm56.Value = splitdata;
                objOraclecommand.Parameters.Add(prm56);

                OracleParameter prm57 = new OracleParameter("subedidata", OracleType.VarChar);
                prm57.Direction = ParameterDirection.Input;
                prm57.Value = subedidata;
                objOraclecommand.Parameters.Add(prm57);

                OracleParameter prm58 = new OracleParameter("splboldsizevalue", OracleType.VarChar);
                prm58.Direction = ParameterDirection.Input;
                prm58.Value = splboldsizevalue;
                objOraclecommand.Parameters.Add(prm58);

                OracleParameter prm59 = new OracleParameter("vatrate_p", OracleType.Float);
                prm59.Direction = ParameterDirection.Input;
                if (vatrate == "" || vatrate == "null" || vatrate == null || vatrate == "undefined")
                    prm59.Value = System.DBNull.Value;
                else
                    prm59.Value = Convert.ToDecimal(vatrate);
                objOraclecommand.Parameters.Add(prm59);

                OracleParameter prm60 = new OracleParameter("boxcharge_p", OracleType.Float);
                prm60.Direction = ParameterDirection.Input;
                if (boxcharge == "" || boxcharge == "null" || boxcharge == null || boxcharge == "0")
                    prm60.Value = System.DBNull.Value;
                else
                    prm60.Value = Convert.ToDecimal(boxcharge);
                objOraclecommand.Parameters.Add(prm60);

                OracleParameter prm61 = new OracleParameter("vat_inc_p", OracleType.Float);
                prm61.Direction = ParameterDirection.Input;
                if (vat_inc_p == "" || vat_inc_p == "null" || vat_inc_p == null || vat_inc_p == "undefined")
                    prm61.Value = System.DBNull.Value;
                else
                    prm61.Value = vat_inc_p;
                objOraclecommand.Parameters.Add(prm61);

                OracleParameter prm61a = new OracleParameter("grossamtlocal_p", OracleType.VarChar);
                prm61a.Direction = ParameterDirection.Input;
                if (grossamtlocal_p == "" || grossamtlocal_p == "null" || grossamtlocal_p == null)
                    prm61a.Value = System.DBNull.Value;
                else
                    prm61a.Value = grossamtlocal_p;
                objOraclecommand.Parameters.Add(prm61a);

                OracleParameter prm61b = new OracleParameter("billamtlocal_p", OracleType.VarChar);
                prm61b.Direction = ParameterDirection.Input;
                if (billamtlocal_p == "" || billamtlocal_p == "null" || billamtlocal_p == null)
                    prm61b.Value = System.DBNull.Value;
                else
                    prm61b.Value = billamtlocal_p;
                objOraclecommand.Parameters.Add(prm61b);

                OracleParameter prm61b1 = new OracleParameter("sectioncode_p", OracleType.VarChar);
                prm61b1.Direction = ParameterDirection.Input;
                if (sectioncode_p == "" || sectioncode_p == "null" || sectioncode_p == null)
                    prm61b1.Value = System.DBNull.Value;
                else
                    prm61b1.Value = sectioncode_p;
                objOraclecommand.Parameters.Add(prm61b1);

                OracleParameter prm61b11 = new OracleParameter("resourceno_p", OracleType.VarChar);
                prm61b11.Direction = ParameterDirection.Input;
                if (resourceno_p == "" || resourceno_p == "null" || resourceno_p == null)
                    prm61b11.Value = System.DBNull.Value;
                else
                    prm61b11.Value = resourceno_p;
                objOraclecommand.Parameters.Add(prm61b11);

                OracleParameter prm61b12 = new OracleParameter("caption_inserts_p", OracleType.VarChar);
                prm61b12.Direction = ParameterDirection.Input;
                if (caption_inserts == "" || caption_inserts == "null" || caption_inserts == null)
                    prm61b12.Value = System.DBNull.Value;
                else
                    prm61b12.Value = caption_inserts;
                objOraclecommand.Parameters.Add(prm61b12);

                OracleParameter prm61b13 = new OracleParameter("dealerheight", OracleType.VarChar);
                prm61b13.Direction = ParameterDirection.Input;
                if (dealerheight == "" || dealerheight == "null" || dealerheight == null)
                    prm61b13.Value = System.DBNull.Value;
                else
                    prm61b13.Value = dealerheight;
                objOraclecommand.Parameters.Add(prm61b13);

                OracleParameter prm61b14 = new OracleParameter("dealerwidth", OracleType.VarChar);
                prm61b14.Direction = ParameterDirection.Input;
                if (dealerwidth == "" || dealerwidth == "null" || dealerwidth == null)
                    prm61b14.Value = System.DBNull.Value;
                else
                    prm61b14.Value = dealerwidth;
                objOraclecommand.Parameters.Add(prm61b14);


                OracleParameter prm61bx = new OracleParameter("disc_p", OracleType.VarChar);
                prm61bx.Direction = ParameterDirection.Input;
                if (disc_ == "" || disc_ == "null" || disc_ == null)
                    prm61bx.Value = System.DBNull.Value;
                else
                    prm61bx.Value = disc_;
                objOraclecommand.Parameters.Add(prm61bx);


                OracleParameter prm62bx = new OracleParameter("agncyamnt", OracleType.VarChar);
                prm62bx.Direction = ParameterDirection.Input;
                if (agncyamnt == "" || agncyamnt == "null" || agncyamnt == null)
                    prm62bx.Value = System.DBNull.Value;
                else
                    prm62bx.Value = agncyamnt;
                objOraclecommand.Parameters.Add(prm62bx);

                OracleParameter prm63bx = new OracleParameter("adlgncyamnt", OracleType.VarChar);
                prm63bx.Direction = ParameterDirection.Input;
                if (adlgncyamnt == "" || adlgncyamnt == "null" || adlgncyamnt == null)
                    prm63bx.Value = System.DBNull.Value;
                else
                    prm63bx.Value = adlgncyamnt;
                objOraclecommand.Parameters.Add(prm63bx);

                OracleParameter prm64bx = new OracleParameter("spldiscamt", OracleType.VarChar);
                prm64bx.Direction = ParameterDirection.Input;
                if (spldisc == "" || spldisc == "null" || spldisc == null)
                    prm64bx.Value = System.DBNull.Value;
                else
                    prm64bx.Value = spldisc;
                objOraclecommand.Parameters.Add(prm64bx);


                OracleParameter prm65bx = new OracleParameter("cashdamnt", OracleType.VarChar);
                prm65bx.Direction = ParameterDirection.Input;
                if (cashdisc == "" || cashdisc == "null" || cashdisc == null)
                    prm65bx.Value = System.DBNull.Value;
                else
                    prm65bx.Value = cashdisc;
                objOraclecommand.Parameters.Add(prm65bx);

                OracleParameter prm65bt = new OracleParameter("ROUNDOFF", OracleType.VarChar);
                prm65bt.Direction = ParameterDirection.Input;
                if (roundoffamt == "" || roundoffamt == "null" || roundoffamt == null)
                    prm65bt.Value = System.DBNull.Value;
                else
                    prm65bt.Value = roundoffamt;
                objOraclecommand.Parameters.Add(prm65bt);

                OracleParameter prm65ct = new OracleParameter("PDFHEIGHT", OracleType.VarChar);
                prm65ct.Direction = ParameterDirection.Input;
                if (pdfheight == "" || pdfheight == "null" || pdfheight == null)
                    prm65ct.Value = System.DBNull.Value;
                else
                    prm65ct.Value = pdfheight;
                objOraclecommand.Parameters.Add(prm65ct);

                OracleParameter prm65cb = new OracleParameter("CPNAMT", OracleType.VarChar);
                prm65cb.Direction = ParameterDirection.Input;
                if (cpnamt == "" || cpnamt == "null" || cpnamt == null)
                    prm65cb.Value = System.DBNull.Value;
                else
                    prm65cb.Value = cpnamt;
                objOraclecommand.Parameters.Add(prm65cb);

                OracleParameter prm161z1 = new OracleParameter("clientcatamt", OracleType.Number);
                prm161z1.Direction = ParameterDirection.Input;
                if (clientcatamt == "" || clientcatamt == "0" || clientcatamt == "null")
                {
                    prm161z1.Value = System.DBNull.Value;
                }
                else
                {
                    prm161z1.Value = clientcatamt;
                }
                objOraclecommand.Parameters.Add(prm161z1);



                OracleParameter prm161z4 = new OracleParameter("flatfreqamt", OracleType.Number);
                prm161z4.Direction = ParameterDirection.Input;
                if (flatfreqamt == "" || flatfreqamt == "0" || flatfreqamt == "null")
                {
                    prm161z4.Value = System.DBNull.Value;
                }
                else
                {
                    prm161z4.Value = flatfreqamt;
                }
                objOraclecommand.Parameters.Add(prm161z4);


                OracleParameter prm161z7 = new OracleParameter("catamt", OracleType.Number);
                prm161z7.Direction = ParameterDirection.Input;
                if (catamt == "" || catamt == "0" || catamt == "null")
                {
                    prm161z7.Value = System.DBNull.Value;
                }
                else
                {
                    prm161z7.Value = catamt;
                }
                objOraclecommand.Parameters.Add(prm161z7);

                OracleParameter prm161z71 = new OracleParameter("extrarate", OracleType.Number);
                prm161z7.Direction = ParameterDirection.Input;
                if (extrarate == "" || extrarate == "0" || extrarate == "null")
                {
                    prm161z71.Value = System.DBNull.Value;
                }
                else
                {
                    prm161z71.Value = extrarate;
                }
                objOraclecommand.Parameters.Add(prm161z71);


                OracleParameter prm2w11 = new OracleParameter("peyecather", OracleType.Number);
                prm2w11.Direction = ParameterDirection.Input;
                if (eyecather == "" || eyecather == "0" || eyecather == "null")
                {
                    prm2w11.Value = System.DBNull.Value;
                }
                else
                {
                    prm2w11.Value = eyecather;
                }
                objOraclecommand.Parameters.Add(prm2w11);

                OracleParameter prm2w112 = new OracleParameter("pdaywisepr", OracleType.Number);
                prm2w112.Direction = ParameterDirection.Input;
                if (daywiseprem == "" || daywiseprem == "0" || daywiseprem == "null")
                {
                    prm2w112.Value = System.DBNull.Value;
                }
                else
                {
                    prm2w112.Value = daywiseprem;
                }
                objOraclecommand.Parameters.Add(prm2w112);

                OracleParameter prmt = new OracleParameter("pgstamt", OracleType.Number);
                prmt.Direction = ParameterDirection.Input;
                if (gstamount == "" || gstamount == "0" || gstamount == "null")
                {
                    prmt.Value = System.DBNull.Value;
                }
                else
                {
                    prmt.Value = gstamount;
                }
                objOraclecommand.Parameters.Add(prmt);

                OracleParameter prmd = new OracleParameter("pgstgd", OracleType.VarChar);
                prmd.Direction = ParameterDirection.Input;
                if (gstgrid == "" || gstgrid == "0" || gstgrid == "null")
                {
                    prmd.Value = System.DBNull.Value;
                }
                else
                {
                    prmd.Value = gstgrid;
                }
                objOraclecommand.Parameters.Add(prmd);

                objOraclecommand.Parameters.Add("p_error", OracleType.VarChar, 200);
                objOraclecommand.Parameters["p_error"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                //  objOraclecommand.ExecuteNonQuery();
                output = objOraclecommand.Parameters["p_error"].Value.ToString();



            }
            catch (Exception ex)
            {
                //output = ex.Message;
                throw (ex);

            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
            return output;
        }
        public DataSet insertbook_ins_update(string insertdate, string edition, string premium1, string premium2, string premallow, string adcategory, string latestdate, string material, string cardrate, string matfilename, string discrate, string insertstatus, string billstatus, string adsubcat, string compcode, string userid, string cioid, string height, string width, string totalsize, string pagepost, string premper1, string premper2, string colid, string repeat, string insertno, string paid, string agrrate, string solorate, string grossrate, string insert_pageno, string insert_remarks, string page_code, string page_per, string noofcol, string billamt, string billrate, string logo_h, string logo_w, string logo_name, string dateformat, string adcat3, string adcat4, string adcat5, string pkgcode, string gridins, string pkgalias, string insertid, string cirvts, string cirpub, string ciredi, string cirrate, string cirdate, string ciragency, string ciragencysubcode, string center, string branch, string splboldsizevalue, string vatrate, string boxcharge, string vat_inc_p, string grossamtlocal_p, string billamtlocal_p, string sectioncode_p, string resourceno_p, string insert_caption, string subedidata, string disc_, string modifyrateaudit, string ip, string agncyamnt, string adlgncyamnt, string spldisc, string cashdisc, string roundoffamt, string pdfheight, string cpnamt, string clientcatamt, string flatfreqamt, string catamt, string eyecather, string dayprim, string gstamount, string gstgrid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("insertintobookchild_update.insertintobookchild_update_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm2 = new OracleParameter("insertdate", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;

                if (insertdate == "" || insertdate == null)
                {
                    prm2.Value = System.DBNull.Value;
                }
                else
                {



                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = insertdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        insertdate = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = insertdate.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        insertdate = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = insertdate.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            insertdate = mm + "/" + dd + "/" + yy;
                    //        }
                    prm2.Value = Convert.ToDateTime(insertdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm3 = new OracleParameter("edition", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = edition;
                objOraclecommand.Parameters.Add(prm3);






                OracleParameter prm4 = new OracleParameter("premium1", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = premium1;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("premium2", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = premium2;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("premallow", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = premallow;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("adcategory", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = adcategory;
                objOraclecommand.Parameters.Add(prm7);


                OracleParameter prm8 = new OracleParameter("latestdate", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;


                if (latestdate == "" || latestdate == null)
                {
                    prm8.Value = System.DBNull.Value;
                }
                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = latestdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        latestdate = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = latestdate.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        latestdate = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = latestdate.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            latestdate = mm + "/" + dd + "/" + yy;
                    //        }
                    prm8.Value = Convert.ToDateTime(latestdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("material", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = material;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("cardrate", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;


                if (cardrate == "" || cardrate == null)
                {
                    prm10.Value = System.DBNull.Value;
                }
                else
                {
                    prm10.Value = Convert.ToDecimal(cardrate);
                }
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("matfilename", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = matfilename;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm12 = new OracleParameter("discrate", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;


                if (discrate == "" || discrate == null || discrate == "null")
                {
                    prm12.Value = System.DBNull.Value;
                }
                else
                {
                    prm12.Value = Convert.ToDecimal(discrate);
                }
                objOraclecommand.Parameters.Add(prm12);
                /*==========================================================================================*/

                OracleParameter prm13 = new OracleParameter("insertstatus", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = insertstatus;
                objOraclecommand.Parameters.Add(prm13);

                OracleParameter prm14 = new OracleParameter("billstatus", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = billstatus;
                objOraclecommand.Parameters.Add(prm14);

                OracleParameter prm15 = new OracleParameter("adsubcat1", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = adsubcat;
                objOraclecommand.Parameters.Add(prm15);

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);




                OracleParameter prm16 = new OracleParameter("userid", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = userid;
                objOraclecommand.Parameters.Add(prm16);

                OracleParameter prm17 = new OracleParameter("cioid", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = cioid;
                objOraclecommand.Parameters.Add(prm17);


                OracleParameter prm18 = new OracleParameter("height", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;


                if (height == "" || height == null)
                {
                    prm18.Value = System.DBNull.Value;
                }
                else
                {
                    prm18.Value = Convert.ToDecimal(height);
                }
                objOraclecommand.Parameters.Add(prm18);

                OracleParameter prm19 = new OracleParameter("width", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                if (width == "" || width == null)
                {
                    prm19.Value = System.DBNull.Value;
                }
                else
                {
                    prm19.Value = Convert.ToDecimal(width);
                }
                objOraclecommand.Parameters.Add(prm19);


                OracleParameter prm20 = new OracleParameter("totalsize", OracleType.VarChar);
                prm20.Direction = ParameterDirection.Input;
                if (totalsize == "" || totalsize == null)
                {
                    prm20.Value = System.DBNull.Value;
                }
                else
                {
                    prm20.Value = Convert.ToDecimal(totalsize);
                }
                objOraclecommand.Parameters.Add(prm20);


                OracleParameter prm21 = new OracleParameter("pagepost", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = pagepost;
                objOraclecommand.Parameters.Add(prm21);

                OracleParameter prm22 = new OracleParameter("premper1", OracleType.VarChar);
                prm22.Direction = ParameterDirection.Input;
                if (premper1 == "" || premper1 == null || premper1 == "null")
                {
                    prm22.Value = System.DBNull.Value;
                }
                else
                {
                    prm22.Value = Convert.ToDecimal(premper1);
                }
                objOraclecommand.Parameters.Add(prm22);




                OracleParameter prm23 = new OracleParameter("premper2", OracleType.VarChar);
                prm23.Direction = ParameterDirection.Input;
                if (premper2 == "" || premper2 == null)
                {
                    prm23.Value = System.DBNull.Value;
                }
                else
                {
                    prm23.Value = Convert.ToDecimal(premper2);
                }
                objOraclecommand.Parameters.Add(prm23);


                OracleParameter prm24 = new OracleParameter("colid", OracleType.VarChar);
                prm24.Direction = ParameterDirection.Input;
                prm24.Value = colid;
                objOraclecommand.Parameters.Add(prm24);

                OracleParameter prm25 = new OracleParameter("repeat", OracleType.VarChar);
                prm25.Direction = ParameterDirection.Input;
                if (repeat == "" || repeat == null)
                {
                    prm25.Value = System.DBNull.Value;
                }
                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = repeat.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        repeat = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = repeat.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        repeat = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = repeat.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            repeat = mm + "/" + dd + "/" + yy;
                    //        }
                    prm25.Value = Convert.ToDateTime(repeat).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm25);


                OracleParameter prm26 = new OracleParameter("insertno", OracleType.VarChar);
                prm26.Direction = ParameterDirection.Input;
                if (insertno == "" || insertno == null)
                {
                    prm26.Value = System.DBNull.Value;
                }
                else
                {
                    prm26.Value = Convert.ToInt32(insertno);
                }
                objOraclecommand.Parameters.Add(prm26);


                OracleParameter prm27 = new OracleParameter("paid", OracleType.VarChar);
                prm27.Direction = ParameterDirection.Input;
                prm27.Value = paid;
                objOraclecommand.Parameters.Add(prm27);

                OracleParameter prm28 = new OracleParameter("agrrate", OracleType.VarChar);
                prm28.Direction = ParameterDirection.Input;
                if (agrrate == "" || agrrate == null || agrrate == "null")
                {
                    prm28.Value = System.DBNull.Value;
                }
                else
                {
                    prm28.Value = Convert.ToDecimal(agrrate);
                }

                objOraclecommand.Parameters.Add(prm28);






                OracleParameter prm29 = new OracleParameter("solorate", OracleType.VarChar);
                prm29.Direction = ParameterDirection.Input;
                if (solorate == "" || solorate == null || solorate == "null")
                {
                    prm29.Value = System.DBNull.Value;
                }
                else
                {
                    prm29.Value = Convert.ToDecimal(solorate);
                }

                objOraclecommand.Parameters.Add(prm29);


                OracleParameter prm30 = new OracleParameter("grossrate", OracleType.VarChar);
                prm30.Direction = ParameterDirection.Input;
                if (grossrate == "" || grossrate == null)
                {
                    prm30.Value = System.DBNull.Value;
                }
                else
                {
                    prm30.Value = Convert.ToDecimal(grossrate);
                }
                objOraclecommand.Parameters.Add(prm30);

                OracleParameter prm31 = new OracleParameter("insert_pageno", OracleType.VarChar);
                prm31.Direction = ParameterDirection.Input;
                if (insert_pageno == "" || insert_pageno == null)
                {
                    prm31.Value = Convert.ToInt32("0");
                }
                else
                {
                    prm31.Value = Convert.ToInt32(insert_pageno);
                }
                objOraclecommand.Parameters.Add(prm31);


                OracleParameter prm32 = new OracleParameter("insert_remarks", OracleType.VarChar);
                prm32.Direction = ParameterDirection.Input;
                prm32.Value = insert_remarks;
                objOraclecommand.Parameters.Add(prm32);

                OracleParameter prm34 = new OracleParameter("page_code", OracleType.VarChar);
                prm34.Direction = ParameterDirection.Input;
                prm34.Value = page_code;
                objOraclecommand.Parameters.Add(prm34);

                OracleParameter prm33 = new OracleParameter("page_per", OracleType.VarChar);
                prm33.Direction = ParameterDirection.Input;
                if (page_per == "" || page_per == null || page_per == "null")
                {
                    prm33.Value = System.DBNull.Value;
                }
                else
                {
                    prm33.Value = Convert.ToDecimal(page_per);
                }
                objOraclecommand.Parameters.Add(prm33);

                OracleParameter prm35 = new OracleParameter("noofcol", OracleType.VarChar);
                prm35.Direction = ParameterDirection.Input;
                if (noofcol == "" || noofcol == null)
                {
                    prm35.Value = System.DBNull.Value;
                }
                else
                {
                    prm35.Value = Convert.ToDecimal(noofcol);
                }
                objOraclecommand.Parameters.Add(prm35);

                OracleParameter prm36 = new OracleParameter("billamt", OracleType.VarChar);
                prm36.Direction = ParameterDirection.Input;
                if (billamt == "" || billamt == null)
                {
                    prm36.Value = System.DBNull.Value;
                }
                else
                {
                    prm36.Value = Convert.ToDecimal(billamt);
                }
                objOraclecommand.Parameters.Add(prm36);

                OracleParameter prm37 = new OracleParameter("billrate", OracleType.VarChar);
                prm37.Direction = ParameterDirection.Input;
                if (billrate == "" || billrate == null)
                {
                    prm37.Value = System.DBNull.Value;
                }
                else
                {
                    prm37.Value = Convert.ToDecimal(billrate);
                }
                objOraclecommand.Parameters.Add(prm37);

                OracleParameter prm40 = new OracleParameter("logo_h", OracleType.VarChar);
                prm40.Direction = ParameterDirection.Input;
                prm40.Value = logo_h;
                objOraclecommand.Parameters.Add(prm40);

                OracleParameter prm38 = new OracleParameter("logo_w", OracleType.VarChar);
                prm38.Direction = ParameterDirection.Input;
                prm38.Value = logo_w;
                objOraclecommand.Parameters.Add(prm38);

                OracleParameter prm39 = new OracleParameter("logo_name", OracleType.VarChar);
                prm39.Direction = ParameterDirection.Input;
                prm39.Value = logo_name;
                objOraclecommand.Parameters.Add(prm39);

                OracleParameter prm43 = new OracleParameter("ad_cat_3", OracleType.VarChar);
                prm43.Direction = ParameterDirection.Input;
                prm43.Value = adcat3;
                objOraclecommand.Parameters.Add(prm43);

                OracleParameter prm41 = new OracleParameter("ad_cat_4", OracleType.VarChar);
                prm41.Direction = ParameterDirection.Input;
                prm41.Value = adcat4;
                objOraclecommand.Parameters.Add(prm41);

                OracleParameter prm42 = new OracleParameter("ad_cat_5", OracleType.VarChar);
                prm42.Direction = ParameterDirection.Input;
                prm42.Value = adcat5;
                objOraclecommand.Parameters.Add(prm42);
                //objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                //objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                OracleParameter prm44 = new OracleParameter("pkgcode", OracleType.VarChar);
                prm44.Direction = ParameterDirection.Input;
                prm44.Value = pkgcode;
                objOraclecommand.Parameters.Add(prm44);

                OracleParameter prm45 = new OracleParameter("gridins", OracleType.Number);
                prm45.Direction = ParameterDirection.Input;
                if (gridins == "")
                {
                    gridins = "1";
                }
                prm45.Value = gridins;
                objOraclecommand.Parameters.Add(prm45);

                OracleParameter prm46 = new OracleParameter("pkgalias", OracleType.VarChar);
                prm46.Direction = ParameterDirection.Input;
                prm46.Value = pkgalias;
                objOraclecommand.Parameters.Add(prm46);

                OracleParameter prm47 = new OracleParameter("insertid1", OracleType.VarChar);
                prm47.Direction = ParameterDirection.Input;
                prm47.Value = insertid;
                objOraclecommand.Parameters.Add(prm47);

                OracleParameter prm51 = new OracleParameter("cirvts", OracleType.VarChar);
                prm51.Direction = ParameterDirection.Input;
                if (cirvts == "null" || cirvts == null)
                    prm51.Value = System.DBNull.Value;
                else
                    prm51.Value = cirvts;
                objOraclecommand.Parameters.Add(prm51);

                OracleParameter prm48 = new OracleParameter("cirpub", OracleType.VarChar);
                prm48.Direction = ParameterDirection.Input;
                if (cirpub == "null" || cirpub == null)
                    prm48.Value = System.DBNull.Value;
                else
                    prm48.Value = cirpub;
                objOraclecommand.Parameters.Add(prm48);

                OracleParameter prm49 = new OracleParameter("ciredi", OracleType.VarChar);
                prm49.Direction = ParameterDirection.Input;
                if (cirpub == "null" || cirpub == null)
                    prm49.Value = System.DBNull.Value;
                else
                    prm49.Value = ciredi;
                objOraclecommand.Parameters.Add(prm49);

                OracleParameter prm50 = new OracleParameter("cirrate", OracleType.VarChar);
                prm50.Direction = ParameterDirection.Input;
                if (cirrate == "null" && cirrate == null)
                    prm50.Value = System.DBNull.Value;
                else
                    prm50.Value = cirrate;
                objOraclecommand.Parameters.Add(prm50);


                OracleParameter prm59 = new OracleParameter("cirdate_v", OracleType.VarChar);
                prm59.Direction = ParameterDirection.Input;
                if (cirdate == "" || cirdate == null)
                {
                    prm59.Value = System.DBNull.Value;
                }
                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = cirdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        cirdate = mm + "/" + dd + "/" + yy;


                    }
                    prm59.Value = Convert.ToDateTime(cirdate).ToString("dd-MMMM-yyyy");
                }

                objOraclecommand.Parameters.Add(prm59);

                OracleParameter prm52 = new OracleParameter("ciragency_v", OracleType.VarChar);
                prm52.Direction = ParameterDirection.Input;
                prm52.Value = ciragency;
                objOraclecommand.Parameters.Add(prm52);

                OracleParameter prm53 = new OracleParameter("ciragencysubcode_v", OracleType.VarChar);
                prm53.Direction = ParameterDirection.Input;
                prm53.Value = ciragencysubcode;
                objOraclecommand.Parameters.Add(prm53);

                OracleParameter prm54 = new OracleParameter("center_v", OracleType.VarChar);
                prm54.Direction = ParameterDirection.Input;
                prm54.Value = center;
                objOraclecommand.Parameters.Add(prm54);

                OracleParameter prm55 = new OracleParameter("branch_v", OracleType.VarChar);
                prm55.Direction = ParameterDirection.Input;
                prm55.Value = branch;
                objOraclecommand.Parameters.Add(prm55);

                OracleParameter prm58 = new OracleParameter("splboldsizevalue", OracleType.VarChar);
                prm58.Direction = ParameterDirection.Input;
                prm58.Value = splboldsizevalue;
                objOraclecommand.Parameters.Add(prm58);

                OracleParameter prm59a = new OracleParameter("vatrate_p", OracleType.Float);
                prm59a.Direction = ParameterDirection.Input;
                if (vatrate == "" || vatrate == "null" || vatrate == null || vatrate == "undefined")
                    prm59a.Value = System.DBNull.Value;
                else
                    prm59a.Value = Convert.ToDecimal(vatrate);
                objOraclecommand.Parameters.Add(prm59a);

                OracleParameter prm60 = new OracleParameter("boxcharge_p", OracleType.Float);
                prm60.Direction = ParameterDirection.Input;
                if (boxcharge == "" || boxcharge == "null" || boxcharge == null)
                    prm60.Value = System.DBNull.Value;
                else
                    prm60.Value = Convert.ToDecimal(boxcharge);
                objOraclecommand.Parameters.Add(prm60);

                OracleParameter prm61 = new OracleParameter("vat_inc_p", OracleType.Float);
                prm61.Direction = ParameterDirection.Input;
                if (vat_inc_p == "" || vat_inc_p == "null" || vat_inc_p == null || vat_inc_p == "undefined")
                    prm61.Value = System.DBNull.Value;
                else
                    prm61.Value = vat_inc_p;
                objOraclecommand.Parameters.Add(prm61);


                OracleParameter prm61a = new OracleParameter("grossamtlocal_p", OracleType.VarChar);
                prm61a.Direction = ParameterDirection.Input;
                if (grossamtlocal_p == "" || grossamtlocal_p == "null" || grossamtlocal_p == null)
                    prm61a.Value = System.DBNull.Value;
                else
                    prm61a.Value = grossamtlocal_p;
                objOraclecommand.Parameters.Add(prm61a);


                OracleParameter prm61b = new OracleParameter("billamtlocal_p", OracleType.VarChar);
                prm61b.Direction = ParameterDirection.Input;
                if (billamtlocal_p == "" || billamtlocal_p == "null" || billamtlocal_p == null)
                    prm61b.Value = System.DBNull.Value;
                else
                    prm61b.Value = billamtlocal_p;
                objOraclecommand.Parameters.Add(prm61b);

                OracleParameter prm61b1 = new OracleParameter("sectioncode_p", OracleType.VarChar);
                prm61b1.Direction = ParameterDirection.Input;
                if (sectioncode_p == "" || sectioncode_p == "null" || sectioncode_p == null)
                    prm61b1.Value = System.DBNull.Value;
                else
                    prm61b1.Value = sectioncode_p;
                objOraclecommand.Parameters.Add(prm61b1);

                OracleParameter prm61b11 = new OracleParameter("resourceno_p", OracleType.VarChar);
                prm61b11.Direction = ParameterDirection.Input;
                if (resourceno_p == "" || resourceno_p == "null" || resourceno_p == null)
                    prm61b11.Value = System.DBNull.Value;
                else
                    prm61b11.Value = resourceno_p;
                objOraclecommand.Parameters.Add(prm61b11);

                OracleParameter prm61b112 = new OracleParameter("caption_inserts_p", OracleType.VarChar);
                prm61b112.Direction = ParameterDirection.Input;
                if (insert_caption == "" || insert_caption == "null" || insert_caption == null)
                    prm61b112.Value = System.DBNull.Value;
                else
                    prm61b112.Value = insert_caption;
                objOraclecommand.Parameters.Add(prm61b112);

                OracleParameter prm63 = new OracleParameter("subedidata", OracleType.VarChar);
                prm63.Direction = ParameterDirection.Input;
                prm63.Value = subedidata;
                objOraclecommand.Parameters.Add(prm63);

                OracleParameter prm61bx = new OracleParameter("disc_p", OracleType.VarChar);
                prm61bx.Direction = ParameterDirection.Input;
                if (disc_ == "" || disc_ == "null" || disc_ == null)
                    prm61bx.Value = System.DBNull.Value;
                else
                    prm61bx.Value = disc_;
                objOraclecommand.Parameters.Add(prm61bx);

                OracleParameter prm151b = new OracleParameter("P_ip", OracleType.VarChar);
                prm151b.Direction = ParameterDirection.Input;
                prm151b.Value = ip;
                objOraclecommand.Parameters.Add(prm151b);

                OracleParameter prm161b = new OracleParameter("P_RATE_AUDIT_FLAG", OracleType.VarChar);
                prm161b.Direction = ParameterDirection.Input;
                prm161b.Value = modifyrateaudit;
                objOraclecommand.Parameters.Add(prm161b);

                OracleParameter prmkv2 = new OracleParameter("agncyamnt", OracleType.VarChar);
                prmkv2.Direction = ParameterDirection.Input;
                prmkv2.Value = agncyamnt;
                objOraclecommand.Parameters.Add(prmkv2);

                OracleParameter prmkvg = new OracleParameter("adlgncyamnt", OracleType.VarChar);
                prmkvg.Direction = ParameterDirection.Input;
                prmkvg.Value = adlgncyamnt;
                objOraclecommand.Parameters.Add(prmkvg);

                OracleParameter prmkv = new OracleParameter("spldiscamt", OracleType.VarChar);
                prmkv.Direction = ParameterDirection.Input;
                prmkv.Value = spldisc;
                objOraclecommand.Parameters.Add(prmkv);

                OracleParameter prmky = new OracleParameter("cashdamnt", OracleType.VarChar);
                prmky.Direction = ParameterDirection.Input;
                prmky.Value = cashdisc;
                objOraclecommand.Parameters.Add(prmky);

                OracleParameter prmk8 = new OracleParameter("ROUNDOFF", OracleType.VarChar);
                prmk8.Direction = ParameterDirection.Input;
                prmk8.Value = roundoffamt;
                objOraclecommand.Parameters.Add(prmk8);

                OracleParameter prmk2 = new OracleParameter("PDFHEIGHT", OracleType.VarChar);
                prmk2.Direction = ParameterDirection.Input;
                prmk2.Value = pdfheight;
                objOraclecommand.Parameters.Add(prmk2);

                OracleParameter prmk1 = new OracleParameter("CPNAMT", OracleType.VarChar);
                prmk1.Direction = ParameterDirection.Input;
                prmk1.Value = cpnamt;
                objOraclecommand.Parameters.Add(prmk1);

                OracleParameter prmk = new OracleParameter("clientcatamt", OracleType.VarChar);
                prmk.Direction = ParameterDirection.Input;
                prmk.Value = clientcatamt;
                objOraclecommand.Parameters.Add(prmk);

                OracleParameter prml = new OracleParameter("flatfreqamt", OracleType.VarChar);
                prml.Direction = ParameterDirection.Input;
                prml.Value = flatfreqamt;
                objOraclecommand.Parameters.Add(prml);

                OracleParameter prmp = new OracleParameter("catamt", OracleType.VarChar);
                prmp.Direction = ParameterDirection.Input;
                prmp.Value = catamt;
                objOraclecommand.Parameters.Add(prmp);

                OracleParameter prmo = new OracleParameter("extrarate", OracleType.VarChar);
                prmo.Direction = ParameterDirection.Input;
                prmo.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prmo);

                OracleParameter prmr = new OracleParameter("premamtval", OracleType.VarChar);
                prmr.Direction = ParameterDirection.Input;
                prmr.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prmr);

                OracleParameter prmrz = new OracleParameter("peyecather", OracleType.Number);
                prmrz.Direction = ParameterDirection.Input;
                if (eyecather == "" || eyecather == "0" || eyecather == "null")
                {
                    prmrz.Value = System.DBNull.Value;
                }
                else
                {
                    prmrz.Value = eyecather;
                }
                objOraclecommand.Parameters.Add(prmrz);

                OracleParameter prmrzbn = new OracleParameter("pdaywisepr", OracleType.Number);
                prmrzbn.Direction = ParameterDirection.Input;
                if (dayprim == "" || dayprim == "0" || dayprim == "null")
                {
                    prmrzbn.Value = System.DBNull.Value;
                }
                else
                {
                    prmrzbn.Value = dayprim;
                }
                objOraclecommand.Parameters.Add(prmrzbn);

                OracleParameter prmt = new OracleParameter("pgstamt", OracleType.Number);
                prmt.Direction = ParameterDirection.Input;
                if (gstamount == "" || gstamount == "0" || gstamount == "null")
                {
                    prmt.Value = System.DBNull.Value;
                }
                else
                {
                    prmt.Value = gstamount;
                }
                objOraclecommand.Parameters.Add(prmt);

                OracleParameter prmd = new OracleParameter("pgstgd", OracleType.VarChar);
                prmd.Direction = ParameterDirection.Input;
                if (gstgrid == "" || gstgrid == "0" || gstgrid == "null")
                {
                    prmd.Value = System.DBNull.Value;
                }
                else
                {
                    prmd.Value = gstgrid;
                }
                objOraclecommand.Parameters.Add(prmd);

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet insertbook_ins_display_bill(string insertdate, string edition, string premium1, string premium2, string premallow, string adcategory, string latestdate, string material, string cardrate, string matfilename, string discrate, string insertstatus, string billstatus, string adsubcat, string compcode, string userid, string cioid, string height, string width, string totalsize, string pagepost, string premper1, string premper2, string colid, string repeat, string insertno, string paid, string agrrate, string solorate, string grossrate, string insert_pageno, string insert_remarks, string page_code, string page_per, string noofcol, string billamt, string billrate, string logo_h, string logo_w, string logo_name, string dateformat, string adcat3, string adcat4, string adcat5, string pkgcode, string gridins, string pkgalias, string insertid, string oldbillno, string oldbilldate)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("insertintobookchild_disp_b.insertintobookchild_disp_b_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm2 = new OracleParameter("insertdate", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;

                if (insertdate == "" || insertdate == null)
                {
                    prm2.Value = System.DBNull.Value;
                }
                else
                {



                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = insertdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        insertdate = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = insertdate.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        insertdate = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = insertdate.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            insertdate = mm + "/" + dd + "/" + yy;
                    //        }
                    prm2.Value = Convert.ToDateTime(insertdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm3 = new OracleParameter("edition", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = edition;
                objOraclecommand.Parameters.Add(prm3);






                OracleParameter prm4 = new OracleParameter("premium1", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = premium1;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("premium2", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = premium2;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("premallow", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = premallow;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("adcategory", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = adcategory;
                objOraclecommand.Parameters.Add(prm7);


                OracleParameter prm8 = new OracleParameter("latestdate", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;


                if (latestdate == "" || latestdate == null)
                {
                    prm8.Value = System.DBNull.Value;
                }
                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = latestdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        latestdate = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = latestdate.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        latestdate = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = latestdate.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            latestdate = mm + "/" + dd + "/" + yy;
                    //        }
                    prm8.Value = Convert.ToDateTime(latestdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("material", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = material;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("cardrate", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;


                if (cardrate == "" || cardrate == null)
                {
                    prm10.Value = System.DBNull.Value;
                }
                else
                {
                    prm10.Value = Convert.ToDecimal(cardrate);
                }
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("matfilename", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = matfilename;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm12 = new OracleParameter("discrate", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;


                if (discrate == "" || discrate == null || discrate == "null")
                {
                    prm12.Value = System.DBNull.Value;
                }
                else
                {
                    prm12.Value = Convert.ToDecimal(discrate);
                }
                objOraclecommand.Parameters.Add(prm12);
                /*==========================================================================================*/

                OracleParameter prm13 = new OracleParameter("insertstatus", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = insertstatus;
                objOraclecommand.Parameters.Add(prm13);

                OracleParameter prm14 = new OracleParameter("billstatus", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = billstatus;
                objOraclecommand.Parameters.Add(prm14);

                OracleParameter prm15 = new OracleParameter("adsubcat1", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = adsubcat;
                objOraclecommand.Parameters.Add(prm15);

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);




                OracleParameter prm16 = new OracleParameter("userid", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = userid;
                objOraclecommand.Parameters.Add(prm16);

                OracleParameter prm17 = new OracleParameter("cioid", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = cioid;
                objOraclecommand.Parameters.Add(prm17);


                OracleParameter prm18 = new OracleParameter("height", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;


                if (height == "" || height == null)
                {
                    prm18.Value = System.DBNull.Value;
                }
                else
                {
                    prm18.Value = Convert.ToDecimal(height);
                }
                objOraclecommand.Parameters.Add(prm18);

                OracleParameter prm19 = new OracleParameter("width", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                if (width == "" || width == null)
                {
                    prm19.Value = System.DBNull.Value;
                }
                else
                {
                    prm19.Value = Convert.ToDecimal(width);
                }
                objOraclecommand.Parameters.Add(prm19);


                OracleParameter prm20 = new OracleParameter("totalsize", OracleType.VarChar);
                prm20.Direction = ParameterDirection.Input;
                if (totalsize == "" || totalsize == null)
                {
                    prm20.Value = System.DBNull.Value;
                }
                else
                {
                    prm20.Value = Convert.ToDecimal(totalsize);
                }
                objOraclecommand.Parameters.Add(prm20);


                OracleParameter prm21 = new OracleParameter("pagepost", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = pagepost;
                objOraclecommand.Parameters.Add(prm21);

                OracleParameter prm22 = new OracleParameter("premper1", OracleType.VarChar);
                prm22.Direction = ParameterDirection.Input;
                if (premper1 == "" || premper1 == null || premper1 == "null")
                {
                    prm22.Value = System.DBNull.Value;
                }
                else
                {
                    prm22.Value = Convert.ToDecimal(premper1);
                }
                objOraclecommand.Parameters.Add(prm22);




                OracleParameter prm23 = new OracleParameter("premper2", OracleType.VarChar);
                prm23.Direction = ParameterDirection.Input;
                if (premper2 == "" || premper2 == null)
                {
                    prm23.Value = System.DBNull.Value;
                }
                else
                {
                    prm23.Value = Convert.ToDecimal(premper2);
                }
                objOraclecommand.Parameters.Add(prm23);


                OracleParameter prm24 = new OracleParameter("colid", OracleType.VarChar);
                prm24.Direction = ParameterDirection.Input;
                prm24.Value = colid;
                objOraclecommand.Parameters.Add(prm24);

                OracleParameter prm25 = new OracleParameter("repeat", OracleType.VarChar);
                prm25.Direction = ParameterDirection.Input;
                if (repeat == "" || repeat == null)
                {
                    prm25.Value = System.DBNull.Value;
                }
                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = repeat.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        repeat = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = repeat.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        repeat = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = repeat.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            repeat = mm + "/" + dd + "/" + yy;
                    //        }
                    prm25.Value = Convert.ToDateTime(repeat).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm25);


                OracleParameter prm26 = new OracleParameter("insertno", OracleType.VarChar);
                prm26.Direction = ParameterDirection.Input;
                if (insertno == "" || insertno == null)
                {
                    prm26.Value = System.DBNull.Value;
                }
                else
                {
                    prm26.Value = Convert.ToInt32(insertno);
                }
                objOraclecommand.Parameters.Add(prm26);


                OracleParameter prm27 = new OracleParameter("paid", OracleType.VarChar);
                prm27.Direction = ParameterDirection.Input;
                prm27.Value = paid;
                objOraclecommand.Parameters.Add(prm27);

                OracleParameter prm28 = new OracleParameter("agrrate", OracleType.VarChar);
                prm28.Direction = ParameterDirection.Input;
                if (agrrate == "" || agrrate == null || agrrate == "null")
                {
                    prm28.Value = System.DBNull.Value;
                }
                else
                {
                    prm28.Value = Convert.ToDecimal(agrrate);
                }

                objOraclecommand.Parameters.Add(prm28);






                OracleParameter prm29 = new OracleParameter("solorate", OracleType.VarChar);
                prm29.Direction = ParameterDirection.Input;
                if (solorate == "" || solorate == null || solorate == "null")
                {
                    prm29.Value = System.DBNull.Value;
                }
                else
                {
                    prm29.Value = Convert.ToDecimal(solorate);
                }

                objOraclecommand.Parameters.Add(prm29);


                OracleParameter prm30 = new OracleParameter("grossrate", OracleType.VarChar);
                prm30.Direction = ParameterDirection.Input;
                if (grossrate == "" || grossrate == null)
                {
                    prm30.Value = System.DBNull.Value;
                }
                else
                {
                    prm30.Value = Convert.ToDecimal(grossrate);
                }
                objOraclecommand.Parameters.Add(prm30);

                OracleParameter prm31 = new OracleParameter("insert_pageno", OracleType.VarChar);
                prm31.Direction = ParameterDirection.Input;
                if (insert_pageno == "" || insert_pageno == null)
                {
                    prm31.Value = Convert.ToInt32("0");
                }
                else
                {
                    prm31.Value = Convert.ToInt32(insert_pageno);
                }
                objOraclecommand.Parameters.Add(prm31);


                OracleParameter prm32 = new OracleParameter("insert_remarks", OracleType.VarChar);
                prm32.Direction = ParameterDirection.Input;
                prm32.Value = insert_remarks;
                objOraclecommand.Parameters.Add(prm32);

                OracleParameter prm34 = new OracleParameter("page_code", OracleType.VarChar);
                prm34.Direction = ParameterDirection.Input;
                prm34.Value = page_code;
                objOraclecommand.Parameters.Add(prm34);

                OracleParameter prm33 = new OracleParameter("page_per", OracleType.VarChar);
                prm33.Direction = ParameterDirection.Input;
                if (page_per == "" || page_per == null || page_per == "null")
                {
                    prm33.Value = System.DBNull.Value;
                }
                else
                {
                    prm33.Value = Convert.ToDecimal(page_per);
                }
                objOraclecommand.Parameters.Add(prm33);

                OracleParameter prm35 = new OracleParameter("noofcol", OracleType.VarChar);
                prm35.Direction = ParameterDirection.Input;
                if (noofcol == "" || noofcol == null)
                {
                    prm35.Value = System.DBNull.Value;
                }
                else
                {
                    prm35.Value = Convert.ToDecimal(noofcol);
                }
                objOraclecommand.Parameters.Add(prm35);

                OracleParameter prm36 = new OracleParameter("billamt", OracleType.VarChar);
                prm36.Direction = ParameterDirection.Input;
                if (billamt == "" || billamt == null)
                {
                    prm36.Value = System.DBNull.Value;
                }
                else
                {
                    prm36.Value = Convert.ToDecimal(billamt);
                }
                objOraclecommand.Parameters.Add(prm36);

                OracleParameter prm37 = new OracleParameter("billrate", OracleType.VarChar);
                prm37.Direction = ParameterDirection.Input;
                if (billrate == "" || billrate == null)
                {
                    prm37.Value = System.DBNull.Value;
                }
                else
                {
                    prm37.Value = Convert.ToDecimal(billrate);
                }
                objOraclecommand.Parameters.Add(prm37);

                OracleParameter prm40 = new OracleParameter("logo_h", OracleType.VarChar);
                prm40.Direction = ParameterDirection.Input;
                prm40.Value = logo_h;
                objOraclecommand.Parameters.Add(prm40);

                OracleParameter prm38 = new OracleParameter("logo_w", OracleType.VarChar);
                prm38.Direction = ParameterDirection.Input;
                prm38.Value = logo_w;
                objOraclecommand.Parameters.Add(prm38);

                OracleParameter prm39 = new OracleParameter("logo_name", OracleType.VarChar);
                prm39.Direction = ParameterDirection.Input;
                prm39.Value = logo_name;
                objOraclecommand.Parameters.Add(prm39);

                OracleParameter prm43 = new OracleParameter("ad_cat_3", OracleType.VarChar);
                prm43.Direction = ParameterDirection.Input;
                prm43.Value = adcat3;
                objOraclecommand.Parameters.Add(prm43);

                OracleParameter prm41 = new OracleParameter("ad_cat_4", OracleType.VarChar);
                prm41.Direction = ParameterDirection.Input;
                prm41.Value = adcat4;
                objOraclecommand.Parameters.Add(prm41);

                OracleParameter prm42 = new OracleParameter("ad_cat_5", OracleType.VarChar);
                prm42.Direction = ParameterDirection.Input;
                prm42.Value = adcat5;
                objOraclecommand.Parameters.Add(prm42);
                //objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                //objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                OracleParameter prm44 = new OracleParameter("pkgcode", OracleType.VarChar);
                prm44.Direction = ParameterDirection.Input;
                prm44.Value = pkgcode;
                objOraclecommand.Parameters.Add(prm44);

                OracleParameter prm45 = new OracleParameter("gridins", OracleType.Number);
                prm45.Direction = ParameterDirection.Input;
                if (gridins == "")
                {
                    gridins = "1";
                }
                prm45.Value = gridins;
                objOraclecommand.Parameters.Add(prm45);

                OracleParameter prm46 = new OracleParameter("pkgalias", OracleType.VarChar);
                prm46.Direction = ParameterDirection.Input;
                prm46.Value = pkgalias;
                objOraclecommand.Parameters.Add(prm46);

                OracleParameter prm47 = new OracleParameter("insertid", OracleType.VarChar);
                prm47.Direction = ParameterDirection.Input;
                if (insertid == "")
                    insertid = "0";
                prm47.Value = insertid;
                objOraclecommand.Parameters.Add(prm47);

                OracleParameter prm48 = new OracleParameter("oldbillno", OracleType.VarChar);
                prm48.Direction = ParameterDirection.Input;
                prm48.Value = oldbillno;
                objOraclecommand.Parameters.Add(prm48);

                OracleParameter prm49 = new OracleParameter("oldbilldate", OracleType.VarChar);
                prm49.Direction = ParameterDirection.Input;
                if (oldbilldate == "")
                    prm49.Value = System.DBNull.Value;
                else
                    prm49.Value = oldbilldate;
                objOraclecommand.Parameters.Add(prm49);


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet insertbook_ins_Bill_Classified(string insertdate, string edition, string premium1, string premium2, string premallow, string adcategory, string latestdate, string material, string cardrate, string matfilename, string discrate, string insertstatus, string billstatus, string adsubcat, string compcode, string userid, string cioid, string height, string width, string totalsize, string pagepost, string premper1, string premper2, string colid, string repeat, string insertno, string paid, string agrrate, string solorate, string grossrate, string insert_pageno, string insert_remarks, string page_code, string page_per, string noofcol, string billamt, string billrate, string logo_h, string logo_w, string logo_name, string dateformat, string adcat3, string adcat4, string adcat5, string pkgcode, string gridins, string pkgalias, string insertid, string oldbillno, string oldbilldate, string cirvts, string cirpub, string ciredi, string cirrate, string cirdate, string ciragency, string ciragencysubcode, string center, string branch, string splboldsizevalue, string vatrate, string boxcharge, string vat_inc_p, string grossamtlocal_p, string billamtlocal_p, string sectioncode_p, string resourceno_p, string caption_inserts, string dealerheight, string dealerwidth, string subedidata)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("insertintobookchild_Bill.insertintobookchild_Bill_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm2 = new OracleParameter("insertdate", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;

                if (insertdate == "" || insertdate == null)
                {
                    prm2.Value = System.DBNull.Value;
                }
                else
                {



                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = insertdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        insertdate = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = insertdate.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        insertdate = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = insertdate.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            insertdate = mm + "/" + dd + "/" + yy;
                    //        }
                    prm2.Value = Convert.ToDateTime(insertdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm3 = new OracleParameter("edition", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = edition;
                objOraclecommand.Parameters.Add(prm3);






                OracleParameter prm4 = new OracleParameter("premium1", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = premium1;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("premium2", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = premium2;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("premallow", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = premallow;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("adcategory", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = adcategory;
                objOraclecommand.Parameters.Add(prm7);


                OracleParameter prm8 = new OracleParameter("latestdate", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;


                if (latestdate == "" || latestdate == null)
                {
                    prm8.Value = System.DBNull.Value;
                }
                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = latestdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        latestdate = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = latestdate.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        latestdate = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = latestdate.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            latestdate = mm + "/" + dd + "/" + yy;
                    //        }
                    prm8.Value = Convert.ToDateTime(latestdate).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("material", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = material;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("cardrate", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;


                if (cardrate == "" || cardrate == null)
                {
                    prm10.Value = System.DBNull.Value;
                }
                else
                {
                    prm10.Value = Convert.ToDecimal(cardrate);
                }
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("matfilename", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = matfilename;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm12 = new OracleParameter("discrate", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;


                if (discrate == "" || discrate == null || discrate == "null")
                {
                    prm12.Value = System.DBNull.Value;
                }
                else
                {
                    prm12.Value = Convert.ToDecimal(discrate);
                }
                objOraclecommand.Parameters.Add(prm12);
                /*==========================================================================================*/

                OracleParameter prm13 = new OracleParameter("insertstatus", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = insertstatus;
                objOraclecommand.Parameters.Add(prm13);

                OracleParameter prm14 = new OracleParameter("billstatus", OracleType.VarChar);
                prm14.Direction = ParameterDirection.Input;
                prm14.Value = billstatus;
                objOraclecommand.Parameters.Add(prm14);

                OracleParameter prm15 = new OracleParameter("adsubcat1", OracleType.VarChar);
                prm15.Direction = ParameterDirection.Input;
                prm15.Value = adsubcat;
                objOraclecommand.Parameters.Add(prm15);

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);




                OracleParameter prm16 = new OracleParameter("userid", OracleType.VarChar);
                prm16.Direction = ParameterDirection.Input;
                prm16.Value = userid;
                objOraclecommand.Parameters.Add(prm16);

                OracleParameter prm17 = new OracleParameter("cioid", OracleType.VarChar);
                prm17.Direction = ParameterDirection.Input;
                prm17.Value = cioid;
                objOraclecommand.Parameters.Add(prm17);


                OracleParameter prm18 = new OracleParameter("height", OracleType.VarChar);
                prm18.Direction = ParameterDirection.Input;


                if (height == "" || height == null)
                {
                    prm18.Value = System.DBNull.Value;
                }
                else
                {
                    prm18.Value = Convert.ToDecimal(height);
                }
                objOraclecommand.Parameters.Add(prm18);

                OracleParameter prm19 = new OracleParameter("width", OracleType.VarChar);
                prm19.Direction = ParameterDirection.Input;
                if (width == "" || width == null)
                {
                    prm19.Value = System.DBNull.Value;
                }
                else
                {
                    prm19.Value = Convert.ToDecimal(width);
                }
                objOraclecommand.Parameters.Add(prm19);


                OracleParameter prm20 = new OracleParameter("totalsize", OracleType.VarChar);
                prm20.Direction = ParameterDirection.Input;
                if (totalsize == "" || totalsize == null)
                {
                    prm20.Value = System.DBNull.Value;
                }
                else
                {
                    prm20.Value = Convert.ToDecimal(totalsize);
                }
                objOraclecommand.Parameters.Add(prm20);


                OracleParameter prm21 = new OracleParameter("pagepost", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = pagepost;
                objOraclecommand.Parameters.Add(prm21);

                OracleParameter prm22 = new OracleParameter("premper1", OracleType.VarChar);
                prm22.Direction = ParameterDirection.Input;
                if (premper1 == "" || premper1 == null || premper1 == "null")
                {
                    prm22.Value = System.DBNull.Value;
                }
                else
                {
                    prm22.Value = Convert.ToDecimal(premper1);
                }
                objOraclecommand.Parameters.Add(prm22);




                OracleParameter prm23 = new OracleParameter("premper2", OracleType.VarChar);
                prm23.Direction = ParameterDirection.Input;
                if (premper2 == "" || premper2 == null)
                {
                    prm23.Value = System.DBNull.Value;
                }
                else
                {
                    prm23.Value = Convert.ToDecimal(premper2);
                }
                objOraclecommand.Parameters.Add(prm23);


                OracleParameter prm24 = new OracleParameter("colid", OracleType.VarChar);
                prm24.Direction = ParameterDirection.Input;
                prm24.Value = colid;
                objOraclecommand.Parameters.Add(prm24);

                OracleParameter prm25 = new OracleParameter("repeat", OracleType.VarChar);
                prm25.Direction = ParameterDirection.Input;
                if (repeat == "" || repeat == null)
                {
                    prm25.Value = System.DBNull.Value;
                }
                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = repeat.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        repeat = mm + "/" + dd + "/" + yy;


                    }
                    //else
                    //    if (dateformat == "mm/dd/yyyy")
                    //    {
                    //        string[] arr = repeat.Split('/');
                    //        string dd = arr[1];
                    //        string mm = arr[0];
                    //        string yy = arr[2];
                    //        repeat = mm + "/" + dd + "/" + yy;

                    //    }

                    //    else
                    //        if (dateformat == "yyyy/mm/dd")
                    //        {
                    //            string[] arr = repeat.Split('/');
                    //            string dd = arr[2];
                    //            string mm = arr[1];
                    //            string yy = arr[0];
                    //            repeat = mm + "/" + dd + "/" + yy;
                    //        }
                    prm25.Value = Convert.ToDateTime(repeat).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm25);


                OracleParameter prm26 = new OracleParameter("insertno", OracleType.VarChar);
                prm26.Direction = ParameterDirection.Input;
                if (insertno == "" || insertno == null)
                {
                    prm26.Value = System.DBNull.Value;
                }
                else
                {
                    prm26.Value = Convert.ToInt32(insertno);
                }
                objOraclecommand.Parameters.Add(prm26);


                OracleParameter prm27 = new OracleParameter("paid", OracleType.VarChar);
                prm27.Direction = ParameterDirection.Input;
                prm27.Value = paid;
                objOraclecommand.Parameters.Add(prm27);

                OracleParameter prm28 = new OracleParameter("agrrate", OracleType.VarChar);
                prm28.Direction = ParameterDirection.Input;
                if (agrrate == "" || agrrate == null || agrrate == "null")
                {
                    prm28.Value = System.DBNull.Value;
                }
                else
                {
                    prm28.Value = Convert.ToDecimal(agrrate);
                }

                objOraclecommand.Parameters.Add(prm28);






                OracleParameter prm29 = new OracleParameter("solorate", OracleType.VarChar);
                prm29.Direction = ParameterDirection.Input;
                if (solorate == "" || solorate == null || solorate == "null")
                {
                    prm29.Value = System.DBNull.Value;
                }
                else
                {
                    prm29.Value = Convert.ToDecimal(solorate);
                }

                objOraclecommand.Parameters.Add(prm29);


                OracleParameter prm30 = new OracleParameter("grossrate", OracleType.VarChar);
                prm30.Direction = ParameterDirection.Input;
                if (grossrate == "" || grossrate == null)
                {
                    prm30.Value = System.DBNull.Value;
                }
                else
                {
                    prm30.Value = Convert.ToDecimal(grossrate);
                }
                objOraclecommand.Parameters.Add(prm30);

                OracleParameter prm31 = new OracleParameter("insert_pageno", OracleType.VarChar);
                prm31.Direction = ParameterDirection.Input;
                if (insert_pageno == "" || insert_pageno == null)
                {
                    prm31.Value = Convert.ToInt32("0");
                }
                else
                {
                    prm31.Value = Convert.ToInt32(insert_pageno);
                }
                objOraclecommand.Parameters.Add(prm31);


                OracleParameter prm32 = new OracleParameter("insert_remarks", OracleType.VarChar);
                prm32.Direction = ParameterDirection.Input;
                prm32.Value = insert_remarks;
                objOraclecommand.Parameters.Add(prm32);

                OracleParameter prm34 = new OracleParameter("page_code", OracleType.VarChar);
                prm34.Direction = ParameterDirection.Input;
                prm34.Value = page_code;
                objOraclecommand.Parameters.Add(prm34);

                OracleParameter prm33 = new OracleParameter("page_per", OracleType.VarChar);
                prm33.Direction = ParameterDirection.Input;
                if (page_per == "" || page_per == null || page_per == "null")
                {
                    prm33.Value = System.DBNull.Value;
                }
                else
                {
                    prm33.Value = Convert.ToDecimal(page_per);
                }
                objOraclecommand.Parameters.Add(prm33);

                OracleParameter prm35 = new OracleParameter("noofcol", OracleType.VarChar);
                prm35.Direction = ParameterDirection.Input;
                if (noofcol == "" || noofcol == null)
                {
                    prm35.Value = System.DBNull.Value;
                }
                else
                {
                    prm35.Value = Convert.ToDecimal(noofcol);
                }
                objOraclecommand.Parameters.Add(prm35);

                OracleParameter prm36 = new OracleParameter("billamt", OracleType.VarChar);
                prm36.Direction = ParameterDirection.Input;
                if (billamt == "" || billamt == null)
                {
                    prm36.Value = System.DBNull.Value;
                }
                else
                {
                    prm36.Value = Convert.ToDecimal(billamt);
                }
                objOraclecommand.Parameters.Add(prm36);

                OracleParameter prm37 = new OracleParameter("billrate", OracleType.VarChar);
                prm37.Direction = ParameterDirection.Input;
                if (billrate == "" || billrate == null)
                {
                    prm37.Value = System.DBNull.Value;
                }
                else
                {
                    prm37.Value = Convert.ToDecimal(billrate);
                }
                objOraclecommand.Parameters.Add(prm37);

                OracleParameter prm40 = new OracleParameter("logo_h", OracleType.VarChar);
                prm40.Direction = ParameterDirection.Input;
                prm40.Value = logo_h;
                objOraclecommand.Parameters.Add(prm40);

                OracleParameter prm38 = new OracleParameter("logo_w", OracleType.VarChar);
                prm38.Direction = ParameterDirection.Input;
                prm38.Value = logo_w;
                objOraclecommand.Parameters.Add(prm38);

                OracleParameter prm39 = new OracleParameter("logo_name", OracleType.VarChar);
                prm39.Direction = ParameterDirection.Input;
                prm39.Value = logo_name;
                objOraclecommand.Parameters.Add(prm39);

                OracleParameter prm43 = new OracleParameter("ad_cat_3", OracleType.VarChar);
                prm43.Direction = ParameterDirection.Input;
                prm43.Value = adcat3;
                objOraclecommand.Parameters.Add(prm43);

                OracleParameter prm41 = new OracleParameter("ad_cat_4", OracleType.VarChar);
                prm41.Direction = ParameterDirection.Input;
                prm41.Value = adcat4;
                objOraclecommand.Parameters.Add(prm41);

                OracleParameter prm42 = new OracleParameter("ad_cat_5", OracleType.VarChar);
                prm42.Direction = ParameterDirection.Input;
                prm42.Value = adcat5;
                objOraclecommand.Parameters.Add(prm42);
                //objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                //objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                OracleParameter prm44 = new OracleParameter("pkgcode", OracleType.VarChar);
                prm44.Direction = ParameterDirection.Input;
                prm44.Value = pkgcode;
                objOraclecommand.Parameters.Add(prm44);

                OracleParameter prm45 = new OracleParameter("gridins", OracleType.Number);
                prm45.Direction = ParameterDirection.Input;
                if (gridins == "")
                {
                    gridins = "1";
                }
                prm45.Value = gridins;
                objOraclecommand.Parameters.Add(prm45);

                OracleParameter prm46 = new OracleParameter("pkgalias", OracleType.VarChar);
                prm46.Direction = ParameterDirection.Input;
                prm46.Value = pkgalias;
                objOraclecommand.Parameters.Add(prm46);


                OracleParameter prm47 = new OracleParameter("oldbillno", OracleType.VarChar);
                prm47.Direction = ParameterDirection.Input;
                prm47.Value = oldbillno;
                objOraclecommand.Parameters.Add(prm47);

                OracleParameter prm48 = new OracleParameter("oldbilldate", OracleType.VarChar);
                prm48.Direction = ParameterDirection.Input;
                prm48.Value = oldbilldate;
                objOraclecommand.Parameters.Add(prm48);

                OracleParameter prm49 = new OracleParameter("insertid", OracleType.VarChar);
                prm49.Direction = ParameterDirection.Input;
                prm49.Value = insertid;
                objOraclecommand.Parameters.Add(prm49);

                OracleParameter prm51 = new OracleParameter("cirvts", OracleType.VarChar);
                prm51.Direction = ParameterDirection.Input;
                if (cirvts == "null" || cirvts == null)
                    prm51.Value = System.DBNull.Value;
                else
                    prm51.Value = cirvts;
                objOraclecommand.Parameters.Add(prm51);

                OracleParameter prm52 = new OracleParameter("cirpub", OracleType.VarChar);
                prm52.Direction = ParameterDirection.Input;
                if (cirpub == "null" || cirpub == null)
                    prm52.Value = System.DBNull.Value;
                else
                    prm52.Value = cirpub;
                objOraclecommand.Parameters.Add(prm52);

                OracleParameter prm53 = new OracleParameter("ciredi", OracleType.VarChar);
                prm53.Direction = ParameterDirection.Input;
                if (ciredi == "null" || ciredi == null)
                    prm53.Value = System.DBNull.Value;
                else
                    prm53.Value = ciredi;
                objOraclecommand.Parameters.Add(prm53);

                OracleParameter prm54 = new OracleParameter("cirrate", OracleType.VarChar);
                prm54.Direction = ParameterDirection.Input;
                if (cirrate == "null" && cirrate == null)
                    prm54.Value = System.DBNull.Value;
                else
                    prm54.Value = cirrate;
                objOraclecommand.Parameters.Add(prm54);


                OracleParameter prm59 = new OracleParameter("cirdate_v", OracleType.VarChar);
                prm59.Direction = ParameterDirection.Input;
                if (cirdate == "" || cirdate == null)
                {
                    prm59.Value = System.DBNull.Value;
                }
                else
                {

                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = cirdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        cirdate = mm + "/" + dd + "/" + yy;


                    }
                    prm59.Value = Convert.ToDateTime(cirdate).ToString("dd-MMMM-yyyy");
                }

                objOraclecommand.Parameters.Add(prm59);

                OracleParameter prm60 = new OracleParameter("ciragency_v", OracleType.VarChar);
                prm60.Direction = ParameterDirection.Input;
                prm60.Value = ciragency;
                objOraclecommand.Parameters.Add(prm60);

                OracleParameter prm61 = new OracleParameter("ciragencysubcode_v", OracleType.VarChar);
                prm61.Direction = ParameterDirection.Input;
                prm61.Value = ciragencysubcode;
                objOraclecommand.Parameters.Add(prm61);

                OracleParameter prm63 = new OracleParameter("center_v", OracleType.VarChar);
                prm63.Direction = ParameterDirection.Input;
                prm63.Value = center;
                objOraclecommand.Parameters.Add(prm63);

                OracleParameter prm55 = new OracleParameter("branch_v", OracleType.VarChar);
                prm55.Direction = ParameterDirection.Input;
                prm55.Value = branch;
                objOraclecommand.Parameters.Add(prm55);

                //OracleParameter prm64 = new OracleParameter("splitdata_v", OracleType.VarChar);
                //prm64.Direction = ParameterDirection.Input;
                //prm64.Value = splitdata;
                //objOraclecommand.Parameters.Add(prm64);

                //OracleParameter prm65 = new OracleParameter("subedidata", OracleType.VarChar);
                //prm65.Direction = ParameterDirection.Input;
                //prm65.Value = subedidata;
                //objOraclecommand.Parameters.Add(prm65);

                OracleParameter prm66 = new OracleParameter("splboldsizevalue", OracleType.VarChar);
                prm66.Direction = ParameterDirection.Input;
                prm66.Value = splboldsizevalue;
                objOraclecommand.Parameters.Add(prm66);

                OracleParameter prm67 = new OracleParameter("vatrate_p", OracleType.Float);
                prm67.Direction = ParameterDirection.Input;
                if (vatrate == "" || vatrate == "undefined" || vatrate == "null" || vatrate == null)
                    prm67.Value = System.DBNull.Value;
                else
                    prm67.Value = Convert.ToDecimal(vatrate);
                objOraclecommand.Parameters.Add(prm67);



                OracleParameter prm61a = new OracleParameter("grossamtlocal_p", OracleType.VarChar);
                prm61a.Direction = ParameterDirection.Input;
                if (grossamtlocal_p == "" || grossamtlocal_p == "null" || grossamtlocal_p == null)
                    prm61a.Value = System.DBNull.Value;
                else
                    prm61a.Value = grossamtlocal_p;
                objOraclecommand.Parameters.Add(prm61a);

                OracleParameter prm61b = new OracleParameter("billamtlocal_p", OracleType.VarChar);
                prm61b.Direction = ParameterDirection.Input;
                if (billamtlocal_p == "" || billamtlocal_p == "null" || billamtlocal_p == null)
                    prm61b.Value = System.DBNull.Value;
                else
                    prm61b.Value = billamtlocal_p;
                objOraclecommand.Parameters.Add(prm61b);

                OracleParameter prm61b1 = new OracleParameter("sectioncode_p", OracleType.VarChar);
                prm61b1.Direction = ParameterDirection.Input;
                if (sectioncode_p == "" || sectioncode_p == "null" || sectioncode_p == null)
                    prm61b1.Value = System.DBNull.Value;
                else
                    prm61b1.Value = sectioncode_p;
                objOraclecommand.Parameters.Add(prm61b1);


                OracleParameter prm61b11 = new OracleParameter("resourceno_p", OracleType.VarChar);
                prm61b11.Direction = ParameterDirection.Input;
                if (resourceno_p == "" || resourceno_p == "null" || resourceno_p == null)
                    prm61b11.Value = System.DBNull.Value;
                else
                    prm61b11.Value = resourceno_p;
                objOraclecommand.Parameters.Add(prm61b11);

                OracleParameter prm61b112 = new OracleParameter("caption_inserts_p", OracleType.VarChar);
                prm61b112.Direction = ParameterDirection.Input;
                if (caption_inserts == "" || caption_inserts == "null" || caption_inserts == null)
                    prm61b112.Value = System.DBNull.Value;
                else
                    prm61b112.Value = caption_inserts;
                objOraclecommand.Parameters.Add(prm61b112);

                OracleParameter prm61b13 = new OracleParameter("dealerheight", OracleType.VarChar);
                prm61b13.Direction = ParameterDirection.Input;
                if (dealerheight == "" || dealerheight == "null" || dealerheight == null)
                    prm61b13.Value = System.DBNull.Value;
                else
                    prm61b13.Value = dealerheight;
                objOraclecommand.Parameters.Add(prm61b13);

                OracleParameter prm61b14 = new OracleParameter("dealerwidth", OracleType.VarChar);
                prm61b14.Direction = ParameterDirection.Input;
                if (dealerwidth == "" || dealerwidth == "null" || dealerwidth == null)
                    prm61b14.Value = System.DBNull.Value;
                else
                    prm61b14.Value = dealerwidth;
                objOraclecommand.Parameters.Add(prm61b14);

                OracleParameter prm63g = new OracleParameter("subedidata", OracleType.VarChar);
                prm63g.Direction = ParameterDirection.Input;
                prm63g.Value = subedidata;
                objOraclecommand.Parameters.Add(prm63g);


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet getAdSizeHeightWidth(string adtype, string adcategory, string col, string edi, string compcode, string code, string uom)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getAdSizeHeightWidth", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("adtype", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = adtype;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("adcategory", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = adcategory;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("col", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = col;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("code", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = code;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("edi", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = edi;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("compcode", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = compcode;
                objOraclecommand.Parameters.Add(prm6);
                OracleParameter prm7 = new OracleParameter("uomcode", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = uom;
                objOraclecommand.Parameters.Add(prm7);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet getClientName_b(string compcode, string client, string center, string agencycode)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();

            try
            {

                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_getclientName_b.websp_getclientName_b_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);



                OracleParameter prm2 = new OracleParameter("client", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = client;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("center", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = center;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("agencycode", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = agencycode;
                objOraclecommand.Parameters.Add(prm4);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet clsCioId(string s_agencycode, string filename)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();

            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_cioid.websp_cioid_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("s_agencycode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = s_agencycode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("filename", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = filename;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("t_cioid", OracleType.Cursor);
                objOraclecommand.Parameters["t_cioid"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet clsOldMatter(string rcpt_no)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();

            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_oldMatter.websp_oldMatter_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("rcpt_no", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = rcpt_no;
                objOraclecommand.Parameters.Add(prm1);

                objOraclecommand.Parameters.Add("t_cioid", OracleType.Cursor);
                objOraclecommand.Parameters["t_cioid"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getciragency(string compcode, string branch, string ciragency, string ciragencysubcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = new OracleCommand();
                objOraclecommand.Connection = objOracleConnection;
                objOraclecommand.CommandType = CommandType.Text;
                string query = " select cir_get_name.cir_agname_branch('" + compcode + "','','" + ciragency + "','" + ciragencysubcode + "','1','','','','" + branch + "') as AGENCYNAME from dual";
                objOraclecommand.CommandText = query;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getciredition(string compcode, string editioncode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = new OracleCommand();
                objOraclecommand.Connection = objOracleConnection;
                objOraclecommand.CommandType = CommandType.Text;
                string query = " select cir_get_name.cir_edtn('" + compcode + "','','" + editioncode + "','1','','','') as EDITIONNAME from dual";
                objOraclecommand.CommandText = query;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getCurTime(string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();

            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("GETCURTIME", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);


                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getBarter(string compcode, string center, string branch, string agency, string client)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();

            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getBarter", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("company_code", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("center", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = center;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("branch", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = branch;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("agency", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = agency;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("client", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = client;
                objOraclecommand.Parameters.Add(prm5);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        ///////////////////bhanu

        public DataSet backdate_validate(string pcompcode, string pformname, string puserid, string pentrydate, string pdateformat, string pextra1, string pextra2)
        {
            OracleConnection con;
            OracleCommand cmd = new OracleCommand();
            con = GetConnection();
            DataSet ds = new DataSet();
            OracleDataAdapter da = new OracleDataAdapter();
            try
            {
                con.Open();
                string query = "select ad_get_backdays_validate('" + pcompcode + "','" + pformname + "','" + puserid + "','" + pentrydate + "','" + pdateformat + "','" + pextra1 + "','" + pextra2 + "') from dual";
                cmd.CommandText = query;
                cmd.Connection = con;
                cmd.ExecuteNonQuery();

                da.SelectCommand = cmd;
                da.Fill(ds);
                return ds;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref con);
            }
        }


        //////////////////////////////

        public DataSet clsFillGrid(string pubdate, string pubcode, string centercode, string editioncode, string suppcode, string dateformat)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOracleCommand;
            objOracleConnection = GetConnection();
            OracleDataAdapter objOracleDataAdapter = new OracleDataAdapter();
            DataSet objDataSet = new DataSet();

            try
            {
                objOracleConnection.Open();
                objOracleCommand = GetCommand("websp_getPageVolume", ref objOracleConnection);
                objOracleCommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm8 = new OracleParameter("pubdate", OracleType.VarChar, 50);
                prm8.Direction = ParameterDirection.Input;

                if (pubdate == "" || pubdate == null)
                {
                    prm8.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = pubdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        pubdate = mm + "/" + dd + "/" + yy;
                    }
                    prm8.Value = Convert.ToDateTime(pubdate).ToString("dd-MMMM-yyyy");
                }
                objOracleCommand.Parameters.Add(prm8);

                OracleParameter prm4 = new OracleParameter("pubcode", OracleType.VarChar, 50);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = pubcode;
                objOracleCommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("centercode", OracleType.VarChar, 50);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = centercode;
                objOracleCommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("editioncode", OracleType.VarChar, 50);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = editioncode;
                objOracleCommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("suppcode", OracleType.VarChar, 50);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = suppcode;
                objOracleCommand.Parameters.Add(prm7);

                objOracleCommand.Parameters.Add("p_Getsupplement", OracleType.Cursor);
                objOracleCommand.Parameters["p_Getsupplement"].Direction = ParameterDirection.Output;

                objOracleDataAdapter.SelectCommand = objOracleCommand;
                objOracleDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }


        public DataSet clsPlacedAds_Page(string pubdate, string pubcode, string centercode, string editioncode, string suppcode, string pageno, string dateformat)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOracleCommand;
            objOracleConnection = GetConnection();
            OracleDataAdapter objOracleDataAdapter = new OracleDataAdapter();
            DataSet objDataSet = new DataSet();

            try
            {
                objOracleConnection.Open();
                objOracleCommand = GetCommand("websp_getAdsPlacedonPage", ref objOracleConnection);
                objOracleCommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm2 = new OracleParameter("pageno", OracleType.VarChar, 50);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = pageno;
                objOracleCommand.Parameters.Add(prm2);

                OracleParameter prm4 = new OracleParameter("pubcode", OracleType.VarChar, 50);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = pubcode;
                objOracleCommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("centercode", OracleType.VarChar, 50);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = centercode;
                objOracleCommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("editioncode", OracleType.VarChar, 50);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = editioncode;
                objOracleCommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("suppcode", OracleType.VarChar, 50);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = suppcode;
                objOracleCommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("pubdate", OracleType.VarChar, 50);
                prm8.Direction = ParameterDirection.Input;
                if (pubdate == "" || pubdate == null)
                {
                    prm8.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = pubdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        pubdate = mm + "/" + dd + "/" + yy;
                    }
                    prm8.Value = Convert.ToDateTime(pubdate).ToString("dd-MMMM-yyyy");
                }

                objOracleCommand.Parameters.Add(prm8);

                objOracleCommand.Parameters.Add("p_get_place", OracleType.Cursor);
                objOracleCommand.Parameters["p_get_place"].Direction = ParameterDirection.Output;

                objOracleDataAdapter.SelectCommand = objOracleCommand;
                objOracleDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }


        public DataSet clsFillGridAdVolume(string pubdate, string pubcode, string centercode, string editioncode, string suppcode, int i, string dateformat)
        {

            OracleConnection objOracleConnection;
            OracleCommand objOracleCommand;
            objOracleConnection = GetConnection();
            OracleDataAdapter objOracleDataAdapter = new OracleDataAdapter();
            DataSet objDataSet = new DataSet();

            try
            {
                objOracleConnection.Open();
                objOracleCommand = GetCommand("websp_getPlacedAdsVolume.websp_getPlacedAdsVolume_P", ref objOracleConnection);
                objOracleCommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm8 = new OracleParameter("pubdate", OracleType.VarChar, 50);
                prm8.Direction = ParameterDirection.Input;
                if (pubdate == "" || pubdate == null)
                {
                    prm8.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = pubdate.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        pubdate = mm + "/" + dd + "/" + yy;
                    }
                    prm8.Value = Convert.ToDateTime(pubdate).ToString("dd-MMMM-yyyy");
                }
                objOracleCommand.Parameters.Add(prm8);


                OracleParameter prm4 = new OracleParameter("pubcode", OracleType.VarChar, 50);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = pubcode;
                objOracleCommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("centercode", OracleType.VarChar, 50);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = centercode;
                objOracleCommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("editioncode", OracleType.VarChar, 50);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = editioncode;
                objOracleCommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("suppcode", OracleType.VarChar, 50);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = suppcode;
                objOracleCommand.Parameters.Add(prm7);



                OracleParameter prm1 = new OracleParameter("i", OracleType.VarChar, 50);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = i;
                objOracleCommand.Parameters.Add(prm1);


                objOracleCommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOracleCommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;


                objOracleDataAdapter.SelectCommand = objOracleCommand;
                objOracleDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet clsGetBookingID(string recptno)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("GetBookingID", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("receipt_no", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = recptno;
                objOraclecommand.Parameters.Add(prm1);



                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }




        public DataSet getbengali()
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getbengalichar", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts1"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet bind10agency(string compcode, string userid, string agency, string center)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("bind10agencyforbooking", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("userid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = userid;
                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("agency", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = agency;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("pubcenter", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = center;
                objOraclecommand.Parameters.Add(prm4);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }

        /////////6 june bhanu
        public DataSet fetchmultiexe(string cioid, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("fetchmultiexe", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("cioid_p", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = cioid;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public void deleteexe(string compcode, string cioid, string code)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("deleteexe", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("cioid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = cioid;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("code", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = code;
                objOraclecommand.Parameters.Add(prm3);


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objOraclecommand.ExecuteNonQuery();

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet book_chkpublishday_n(string compcode, string pkgname, string dateday, string dateformat)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("getperiodDate_Edition", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("Compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);



                OracleParameter prm3 = new OracleParameter("pkgname", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = pkgname;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("dateday", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                if (dateday == "" || dateday == null || dateday == "null")
                {
                    prm4.Value = System.DBNull.Value;
                }
                else
                {
                    if (dateformat == "dd/mm/yyyy")
                    {
                        string[] arr = dateday.Split('/');
                        string dd = arr[0];
                        string mm = arr[1];
                        string yy = arr[2];
                        dateday = mm + "/" + dd + "/" + yy;
                    }
                    prm4.Value = Convert.ToDateTime(dateday).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm4);






                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet getQBC_n(string pubcode, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();

            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_QBC_n", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pubcode", OracleType.VarChar, 50);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = pubcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar, 50);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);
                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;
            }
            catch (Exception objException)
            {
                throw (objException);
            }
            finally
            {
                objOracleConnection.Close();

            }
        }
        public DataSet chkuomfval(string compcode, string uomcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {

                objOracleConnection.Open();
                objOraclecommand = GetCommand("ad_getuomfvalue", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("p_compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm3 = new OracleParameter("p_uomcode", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = uomcode;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        ///////this code is to show the user's Branch Name
        public DataSet getbranchname(string compcode, string p_branchcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("AD_GET_BRANCH_NAME", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("branch_code", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = p_branchcode;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        //================================= To Get Data From  permission Master===========================//
        public DataSet fetchpermisiondata(string compcode, string userid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("ADB_FETCHPERMISSION", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("p_compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("p_userid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = userid;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("extra1", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("extra2", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm4);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet chkagencyforrevise(string compcode, string agcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("ADB_CHKAG_RATEREVISE", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("p_compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("p_agcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = agcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("extra1", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("extra2", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm4);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        //==========================================  Generate temp Booking Id at time of New ===========================//
        public DataSet autogenratedtempidnam(string compcode, string auto, string nam, string quotation, string adtype, string systemdate, string savedata, string dateformate, string extra1, string extra2, string extra3, string extra4, string extra5)
        {

            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("GETAUTOCODEBOOKING_PRE_SAVE.GETAUTOCODEBOOKING_PRE_SAVE_nb", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("auto1", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = "0";
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("no1", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = "0";
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet ratebindforreviserate(string adcat, string compcode, string revisedate)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("bindratecodeforrevisedate", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("adcat1", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = adcat;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("previsedate", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                if (revisedate == "" || revisedate == null || revisedate == "null")
                {
                    prm4.Value = System.DBNull.Value;
                }
                else
                    prm4.Value = Convert.ToDateTime(revisedate).ToString("dd-MMMM-yyyy");
                objOraclecommand.Parameters.Add(prm4);

                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;


                objOraclecommand.Parameters.Add("p_Accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts1"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);

                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet bindagencyfromadd(string compcode, string userid, string agency, string center, string agencyaddress)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("bindnew_agencyfromadd", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("userid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = userid;
                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("agency", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = agency;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("pubcenter", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = center;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("p_agencyaddress", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = agencyaddress;
                objOraclecommand.Parameters.Add(prm5);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet bindgencyRemark(string compcode, string bookingid, string agency, string client, string type1)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("ADB_GETAGENCY_ADD", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("p_compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("p_bookingid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = bookingid;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("p_agency", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = agency;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("p_client", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = client;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("extra1", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = type1;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("extra2", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = type1;
                objOraclecommand.Parameters.Add(prm6);

                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet getbillnobilldate1(string bookingid, string insertno, string compcode, string dateformat)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("ADB_GETBILLNOBILLDAET", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("p_compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("p_cioid", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = bookingid;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("p_insertno", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = insertno;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("p_dateformat", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = dateformat;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("extra1", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("extra2", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("extra3", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm7);


                objOraclecommand.Parameters.Add("p_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_Accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        //===============******** This is to Bind Caption Master **********=============//
        public DataSet bindcaptionname(string compcode, string userid, string caption)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("AD_BINDCAPTION", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm2 = new OracleParameter("PCOMPCODE", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);
                OracleParameter prm3 = new OracleParameter("PUSERID", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = userid;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("PCAPTION", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = caption;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm31 = new OracleParameter("PEXTRA", OracleType.VarChar);
                prm31.Direction = ParameterDirection.Input;
                prm31.Value = System.DBNull.Value;
                objOraclecommand.Parameters.Add(prm31);

                objOraclecommand.Parameters.Add("P_ACCOUNTS", OracleType.Cursor);
                objOraclecommand.Parameters["P_ACCOUNTS"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }

        public DataSet getExecbooking(string compcode, string execname, string value, string center, string adtype)
        {

            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_getExecbooking.websp_getExecbooking_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("execname", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = execname;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("value", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = value;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("center", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = center;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("padtype", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = adtype;
                objOraclecommand.Parameters.Add(prm5);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                //objOraclecommand.Parameters.Add("P_Accounts1", OracleType.Cursor);
                //objOraclecommand.Parameters["P_Accounts1"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet getagreedamtchk(string compcode, string client, string pack_age, string adtype, string adcategory, string color, string page_prem, string userid)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("Agrredratechk", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("client", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = client;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("pack_age", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = pack_age;
                objOraclecommand.Parameters.Add(prm3);



                OracleParameter prm9 = new OracleParameter("page_prem", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = page_prem;
                objOraclecommand.Parameters.Add(prm9);


                OracleParameter prm10 = new OracleParameter("ad_cat_code", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = adcategory;
                objOraclecommand.Parameters.Add(prm10);

                OracleParameter prm11 = new OracleParameter("ad_type", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = adtype;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm12 = new OracleParameter("color", OracleType.VarChar);
                prm12.Direction = ParameterDirection.Input;
                prm12.Value = color;
                objOraclecommand.Parameters.Add(prm12);


                OracleParameter prm13 = new OracleParameter("Vuserid", OracleType.VarChar);
                prm13.Direction = ParameterDirection.Input;
                prm13.Value = userid;
                objOraclecommand.Parameters.Add(prm13);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet getpublication(string CompCode, string packcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("fn_pub_combin_code", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pcompcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = CompCode;

                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("pcombincode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = packcode;
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("paccounts", OracleType.Cursor);
                objOraclecommand.Parameters["paccounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet ReturnpubName(string CompCode, string pucode)
        {
            OracleConnection con;
            OracleCommand cmd = new OracleCommand();
            con = GetConnection();
            DataSet ds = new DataSet();
            OracleDataAdapter da = new OracleDataAdapter();
            try
            {
                con.Open();
                string query = "select FA_GET_PUB_NAME('" + CompCode + "','" + pucode + "') from dual";
                cmd.CommandText = query;
                cmd.Connection = con;
                cmd.ExecuteNonQuery();

                da.SelectCommand = cmd;
                da.Fill(ds);
                return ds;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref con);
            }
        }
        public DataSet getpublicationlanguage(string CompCode, string pubcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("pubnamelanguage", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pcompcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = CompCode;

                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("ppubcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = pubcode.Trim();
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("paccounts", OracleType.Cursor);
                objOraclecommand.Parameters["paccounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet getpubcodeedit(string CompCode, string edicode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("qbc_getpubforedition", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pcompcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = CompCode;

                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("pedition_alias", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = edicode.Trim();
                objOraclecommand.Parameters.Add(prm2);

                objOraclecommand.Parameters.Add("p_newsprint", OracleType.Cursor);
                objOraclecommand.Parameters["p_newsprint"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet pudetail(string comcode, string bookind, string rono)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();

            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("pubdetail.pubd", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("comcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = comcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm11 = new OracleParameter("bokkid", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = bookind;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm111 = new OracleParameter("rono", OracleType.VarChar);
                prm111.Direction = ParameterDirection.Input;
                prm111.Value = rono;
                objOraclecommand.Parameters.Add(prm111);

                objOraclecommand.Parameters.Add("t_cioid", OracleType.Cursor);
                objOraclecommand.Parameters["t_cioid"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet clsCioId_qbc(string s_agencycode, string filename, string reciept)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();

            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("WEBSP_CIOID_QBC.websp_cioid_P_qbc", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("s_agencycode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = s_agencycode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("filename", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = filename;
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm21 = new OracleParameter("reciept", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = reciept;
                objOraclecommand.Parameters.Add(prm21);

                objOraclecommand.Parameters.Add("t_cioid", OracleType.Cursor);
                objOraclecommand.Parameters["t_cioid"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet getwords12(string bookingcode)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();

            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("GET_WORDS", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pcioid", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = bookingcode;
                objOraclecommand.Parameters.Add(prm1);



                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet clsCioId_qbc11(string s_agencycode, string filename, string reciept)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();

            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("WEBSP_CIOID_QBCRONO.websp_cioid_P_qbc", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("s_agencycode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = s_agencycode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("filename", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = filename;
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm21 = new OracleParameter("reciept", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = reciept;
                objOraclecommand.Parameters.Add(prm21);

                objOraclecommand.Parameters.Add("t_cioid", OracleType.Cursor);
                objOraclecommand.Parameters["t_cioid"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet binddata(string compcode, string firstinsert, string repatingdate, string dayflag, string pkgname, string EXT1, string EXT2, string EXT3, string EXT4, string EXT5)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();

            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("AD_INSERTDATE_REPATING", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pcompcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("pfirstinsert", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = firstinsert;
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm3 = new OracleParameter("prepatingdate", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = repatingdate;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("dayflag", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = dayflag;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("peditionalias", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = pkgname;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("pextra1", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = EXT1;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("pextra2", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = EXT2;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("pextra3", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = EXT3;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("pextra4", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = EXT4;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("pextra5", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = EXT5;
                objOraclecommand.Parameters.Add(prm10);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }

        public DataSet getpubcountdiscount(string compcode, string packagecode, string adcategory, string adsubcategory)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();

            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getpubcountwithdiscount", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pcompcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("packagecode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = packagecode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("padcategory", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = adcategory;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm31 = new OracleParameter("padsubcat", OracleType.VarChar);
                prm31.Direction = ParameterDirection.Input;
                prm31.Value = adsubcategory;
                objOraclecommand.Parameters.Add(prm31);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet updategetway(string comcode, string rono)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("MODIFY_PAYMENTGETWAY", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pcompcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = comcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("rono", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = rono;
                objOraclecommand.Parameters.Add(prm2);
                //objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                //objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet saveonlinepaymentdetail(string compcode, string rscode, string msg, string date, string payid, string rono, string amt, string mode, string billname, string billadd, string billcity, string billstate, string billpin, string billcountry, string billphone, string billemail, string deliverybame, string deladd, string delcity, string delstate, string delpincode, string delcountry, string delphone, string desc, string flag, string transacid, string paymethod, string reqid, string securehash)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();

            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("SAVE_ONLINEPAYMENT", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("PCOM_CODE", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("PRESP_CODE", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = rscode;
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm3 = new OracleParameter("PRESP_MSG", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = msg;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("PCREATED_DATE", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                if (date == "" || date == null || date == "null")
                {
                    prm4.Value = System.DBNull.Value;
                }
                else
                {
                    prm4.Value = Convert.ToDateTime(date).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("PPAYMENT_ID", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = payid;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("PMERCHT_REFNO", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = rono;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("PAMOUNT", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = amt;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("PPAYMENT_MODE", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = mode;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("PBILLING_NAME", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = billname;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("PBILLING_ADD", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = billadd;
                objOraclecommand.Parameters.Add(prm10);


                OracleParameter prm11 = new OracleParameter("PBILLING_CITY", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = billcity;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm21 = new OracleParameter("PBILLING_STATE", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = billstate;
                objOraclecommand.Parameters.Add(prm21);


                OracleParameter prm212 = new OracleParameter("PBILLING_PINCODE", OracleType.VarChar);
                prm212.Direction = ParameterDirection.Input;
                prm212.Value = billpin;
                objOraclecommand.Parameters.Add(prm212);


                OracleParameter prm100 = new OracleParameter("PBILLING_COUNTRY", OracleType.VarChar);
                prm100.Direction = ParameterDirection.Input;
                prm100.Value = billcountry;
                objOraclecommand.Parameters.Add(prm100);


                OracleParameter prm110 = new OracleParameter("PBILLING_PHONE", OracleType.VarChar);
                prm110.Direction = ParameterDirection.Input;
                prm110.Value = billphone;
                objOraclecommand.Parameters.Add(prm110);

                OracleParameter prm210 = new OracleParameter("PBILLING_EMAIL", OracleType.VarChar);
                prm210.Direction = ParameterDirection.Input;
                prm210.Value = billemail;
                objOraclecommand.Parameters.Add(prm210);


                OracleParameter prm2120 = new OracleParameter("PDELIVERY_NAME", OracleType.VarChar);
                prm2120.Direction = ParameterDirection.Input;
                prm2120.Value = deliverybame;
                objOraclecommand.Parameters.Add(prm2120);

                OracleParameter prm213 = new OracleParameter("PDELIVERY_ADD", OracleType.VarChar);
                prm213.Direction = ParameterDirection.Input;
                prm213.Value = deladd;
                objOraclecommand.Parameters.Add(prm213);

                OracleParameter prm2128 = new OracleParameter("PDELIVERY_CITY", OracleType.VarChar);
                prm2128.Direction = ParameterDirection.Input;
                prm2128.Value = delcity;
                objOraclecommand.Parameters.Add(prm2128);

                OracleParameter prm2126 = new OracleParameter("PDELIVERY_STATE", OracleType.VarChar);
                prm2126.Direction = ParameterDirection.Input;
                prm2126.Value = delstate;
                objOraclecommand.Parameters.Add(prm2126);

                OracleParameter prm2125 = new OracleParameter("PDELIVERY_PINCODE", OracleType.VarChar);
                prm2125.Direction = ParameterDirection.Input;
                prm2125.Value = delpincode;
                objOraclecommand.Parameters.Add(prm2125);

                OracleParameter prm2124 = new OracleParameter("PDELIVERY_COUNTRY", OracleType.VarChar);
                prm2124.Direction = ParameterDirection.Input;
                prm2124.Value = delcountry;
                objOraclecommand.Parameters.Add(prm2124);

                OracleParameter prm2123 = new OracleParameter("PDELIVERY_PHONE", OracleType.VarChar);
                prm2123.Direction = ParameterDirection.Input;
                prm2123.Value = delphone;
                objOraclecommand.Parameters.Add(prm2123);

                OracleParameter prm2122 = new OracleParameter("PDESCRIPTION", OracleType.VarChar);
                prm2122.Direction = ParameterDirection.Input;
                prm2122.Value = desc;
                objOraclecommand.Parameters.Add(prm2122);

                OracleParameter prm212n = new OracleParameter("PISFLAG", OracleType.VarChar);
                prm212n.Direction = ParameterDirection.Input;
                prm212n.Value = flag;
                objOraclecommand.Parameters.Add(prm212n);

                OracleParameter prmrr = new OracleParameter("PTRANSACTIONID", OracleType.VarChar);
                prmrr.Direction = ParameterDirection.Input;
                prmrr.Value = transacid;
                objOraclecommand.Parameters.Add(prmrr);

                OracleParameter prm212r = new OracleParameter("PPAYMENT_METHOD", OracleType.VarChar);
                prm212r.Direction = ParameterDirection.Input;
                prm212r.Value = paymethod;
                objOraclecommand.Parameters.Add(prm212r);

                OracleParameter prm212y = new OracleParameter("PREQUEST_ID", OracleType.VarChar);
                prm212y.Direction = ParameterDirection.Input;
                prm212y.Value = reqid;
                objOraclecommand.Parameters.Add(prm212y);

                OracleParameter prm212j = new OracleParameter("PSECURE_HASH", OracleType.VarChar);
                prm212j.Direction = ParameterDirection.Input;
                prm212j.Value = securehash;
                objOraclecommand.Parameters.Add(prm212j);



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getstatuspaymodeAgency_e(string agency, string compcode)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("getstatuspaymodeAgency_e", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("agencycode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = agency;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);
                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public string updatepayment(string comcode, string booking)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            string error = "";
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("inuppaymentgateway", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("comcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = comcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("booking", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = booking;
                objOraclecommand.Parameters.Add(prm2);


                objOraclecommand.Parameters.Add("p_error", OracleType.VarChar, 200);
                objOraclecommand.Parameters["p_error"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                string output = objOraclecommand.Parameters["p_error"].Value.ToString();

                return output;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet saveonlinepaymenttem(string compcode, string rscode, string msg, string date, string payid, string rono, string amt, string mode, string billname, string billadd, string billcity, string billstate, string billpin, string billcountry, string billphone, string billemail, string deliverybame, string deladd, string delcity, string delstate, string delpincode, string delcountry, string delphone, string desc, string flag, string transacid, string paymethod, string reqid, string securehash)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();

            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("SAVE_TEMPONLINEPAYMENT", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("PCOM_CODE", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("PRESP_CODE", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = rscode;
                objOraclecommand.Parameters.Add(prm2);


                OracleParameter prm3 = new OracleParameter("PRESP_MSG", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = msg;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm4 = new OracleParameter("PCREATED_DATE", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                if (date == "" || date == null || date == "null")
                {
                    prm4.Value = System.DBNull.Value;
                }
                else
                {
                    prm4.Value = Convert.ToDateTime(date).ToString("dd-MMMM-yyyy");
                }
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm5 = new OracleParameter("PPAYMENT_ID", OracleType.VarChar);
                prm5.Direction = ParameterDirection.Input;
                prm5.Value = payid;
                objOraclecommand.Parameters.Add(prm5);

                OracleParameter prm6 = new OracleParameter("PMERCHT_REFNO", OracleType.VarChar);
                prm6.Direction = ParameterDirection.Input;
                prm6.Value = rono;
                objOraclecommand.Parameters.Add(prm6);

                OracleParameter prm7 = new OracleParameter("PAMOUNT", OracleType.VarChar);
                prm7.Direction = ParameterDirection.Input;
                prm7.Value = amt;
                objOraclecommand.Parameters.Add(prm7);

                OracleParameter prm8 = new OracleParameter("PPAYMENT_MODE", OracleType.VarChar);
                prm8.Direction = ParameterDirection.Input;
                prm8.Value = mode;
                objOraclecommand.Parameters.Add(prm8);

                OracleParameter prm9 = new OracleParameter("PBILLING_NAME", OracleType.VarChar);
                prm9.Direction = ParameterDirection.Input;
                prm9.Value = billname;
                objOraclecommand.Parameters.Add(prm9);

                OracleParameter prm10 = new OracleParameter("PBILLING_ADD", OracleType.VarChar);
                prm10.Direction = ParameterDirection.Input;
                prm10.Value = billadd;
                objOraclecommand.Parameters.Add(prm10);


                OracleParameter prm11 = new OracleParameter("PBILLING_CITY", OracleType.VarChar);
                prm11.Direction = ParameterDirection.Input;
                prm11.Value = billcity;
                objOraclecommand.Parameters.Add(prm11);

                OracleParameter prm21 = new OracleParameter("PBILLING_STATE", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = billstate;
                objOraclecommand.Parameters.Add(prm21);


                OracleParameter prm212 = new OracleParameter("PBILLING_PINCODE", OracleType.VarChar);
                prm212.Direction = ParameterDirection.Input;
                prm212.Value = billpin;
                objOraclecommand.Parameters.Add(prm212);


                OracleParameter prm100 = new OracleParameter("PBILLING_COUNTRY", OracleType.VarChar);
                prm100.Direction = ParameterDirection.Input;
                prm100.Value = billcountry;
                objOraclecommand.Parameters.Add(prm100);


                OracleParameter prm110 = new OracleParameter("PBILLING_PHONE", OracleType.VarChar);
                prm110.Direction = ParameterDirection.Input;
                prm110.Value = billphone;
                objOraclecommand.Parameters.Add(prm110);

                OracleParameter prm210 = new OracleParameter("PBILLING_EMAIL", OracleType.VarChar);
                prm210.Direction = ParameterDirection.Input;
                prm210.Value = billemail;
                objOraclecommand.Parameters.Add(prm210);


                OracleParameter prm2120 = new OracleParameter("PDELIVERY_NAME", OracleType.VarChar);
                prm2120.Direction = ParameterDirection.Input;
                prm2120.Value = deliverybame;
                objOraclecommand.Parameters.Add(prm2120);

                OracleParameter prm213 = new OracleParameter("PDELIVERY_ADD", OracleType.VarChar);
                prm213.Direction = ParameterDirection.Input;
                prm213.Value = deladd;
                objOraclecommand.Parameters.Add(prm213);

                OracleParameter prm2128 = new OracleParameter("PDELIVERY_CITY", OracleType.VarChar);
                prm2128.Direction = ParameterDirection.Input;
                prm2128.Value = delcity;
                objOraclecommand.Parameters.Add(prm2128);

                OracleParameter prm2126 = new OracleParameter("PDELIVERY_STATE", OracleType.VarChar);
                prm2126.Direction = ParameterDirection.Input;
                prm2126.Value = delstate;
                objOraclecommand.Parameters.Add(prm2126);

                OracleParameter prm2125 = new OracleParameter("PDELIVERY_PINCODE", OracleType.VarChar);
                prm2125.Direction = ParameterDirection.Input;
                prm2125.Value = delpincode;
                objOraclecommand.Parameters.Add(prm2125);

                OracleParameter prm2124 = new OracleParameter("PDELIVERY_COUNTRY", OracleType.VarChar);
                prm2124.Direction = ParameterDirection.Input;
                prm2124.Value = delcountry;
                objOraclecommand.Parameters.Add(prm2124);

                OracleParameter prm2123 = new OracleParameter("PDELIVERY_PHONE", OracleType.VarChar);
                prm2123.Direction = ParameterDirection.Input;
                prm2123.Value = delphone;
                objOraclecommand.Parameters.Add(prm2123);

                OracleParameter prm2122 = new OracleParameter("PDESCRIPTION", OracleType.VarChar);
                prm2122.Direction = ParameterDirection.Input;
                prm2122.Value = desc;
                objOraclecommand.Parameters.Add(prm2122);

                OracleParameter prm212n = new OracleParameter("PISFLAG", OracleType.VarChar);
                prm212n.Direction = ParameterDirection.Input;
                prm212n.Value = flag;
                objOraclecommand.Parameters.Add(prm212n);

                OracleParameter prmrr = new OracleParameter("PTRANSACTIONID", OracleType.VarChar);
                prmrr.Direction = ParameterDirection.Input;
                prmrr.Value = transacid;
                objOraclecommand.Parameters.Add(prmrr);

                OracleParameter prm212r = new OracleParameter("PPAYMENT_METHOD", OracleType.VarChar);
                prm212r.Direction = ParameterDirection.Input;
                prm212r.Value = paymethod;
                objOraclecommand.Parameters.Add(prm212r);

                OracleParameter prm212y = new OracleParameter("PREQUEST_ID", OracleType.VarChar);
                prm212y.Direction = ParameterDirection.Input;
                prm212y.Value = reqid;
                objOraclecommand.Parameters.Add(prm212y);

                OracleParameter prm212j = new OracleParameter("PSECURE_HASH", OracleType.VarChar);
                prm212j.Direction = ParameterDirection.Input;
                prm212j.Value = securehash;
                objOraclecommand.Parameters.Add(prm212j);


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        ////anuja///////////////////
        public DataSet bindindus(string compcode, string induscode, string indusname)
        {

            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {

                objOracleConnection.Open();
                objOraclecommand = GetCommand("ADPRODUCTMAINCAT_P", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pcompcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("ppro_cat_code", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = induscode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm21 = new OracleParameter("pexename", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = indusname;
                objOraclecommand.Parameters.Add(prm21);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet bindprocat(string comcode, string indscode, string procatname)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("ADPRODUCTSUBCAT_P", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;
                OracleParameter prm1 = new OracleParameter("pcompcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = comcode;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("ppro_cat_code", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = indscode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm21 = new OracleParameter("pexename", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = procatname;
                objOraclecommand.Parameters.Add(prm21);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet procatsub(string compcode, string induscode, string procat)
        {

            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {

                objOracleConnection.Open();
                objOraclecommand = GetCommand("ad_product_third_p", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pcompcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("pindustry", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = induscode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm21 = new OracleParameter("prodcatcode", OracleType.VarChar);
                prm21.Direction = ParameterDirection.Input;
                prm21.Value = procat;
                objOraclecommand.Parameters.Add(prm21);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;


                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet getretaineragechek(string retainercode, string compcode, string agencycodesubcode)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("websp_retaineragencycheck", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm1 = new OracleParameter("retainercode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = retainercode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("pagency", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = agencycodesubcode;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts1"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;
                //if (objDataSet.Tables[0].Rows.Count > 0)
                //{
                //    zonename = objDataSet.Tables[0].Rows[0].ItemArray[0].ToString();
                //}
                return objDataSet;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        public DataSet getExecZoneName34(string execcode, string compcode, string agcode)
        {
            string zonename = "";
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                // objOraclecommand = GetCommand("websp_getExecZoneName.websp_getExecZoneName_p", ref objOracleConnection);
                objOraclecommand = GetCommand("websp_getExecZoneNamebooking", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;


                OracleParameter prm1 = new OracleParameter("exexcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = execcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("compcode", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = compcode;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("pagency", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = agcode;
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("P_Accounts", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("P_Accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["P_Accounts1"].Direction = ParameterDirection.Output;

                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;
                //if (objDataSet.Tables[0].Rows.Count > 0)
                //{
                //    zonename = objDataSet.Tables[0].Rows[0].ItemArray[0].ToString();
                //}
                return objDataSet;
            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }

        }
        //==========================================  Generate temp Booking Id at time of New ===========================//
        public DataSet autogenratedtempid(string compcode)
        {

            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {


                objOracleConnection.Open();
                objOraclecommand = GetCommand("GETAUTOCODEBOOKING_PRE_SAVE.GETAUTOCODEBOOKING_PRE_SAVE_P", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("compcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);
                OracleParameter prm2 = new OracleParameter("auto1", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = "0";
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("no1", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = "0";
                objOraclecommand.Parameters.Add(prm3);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;

                objOraclecommand.Parameters.Add("p_accounts1", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts1"].Direction = ParameterDirection.Output;



                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
        public DataSet getExecbooking_agency(string compcode, string adtype, string agmaincode, string agsubcode, string code_subcode, string execname, string extra1, string extra2, string extra3, string extra4, string extra5, string extra6, string extra7, string extra8, string extra9, string extra10)
        {
            OracleConnection objOracleConnection;
            OracleCommand objOraclecommand;
            DataSet objDataSet = new DataSet();
            objOracleConnection = GetConnection();
            OracleDataAdapter objorclDataAdapter = new OracleDataAdapter();
            try
            {
                objOracleConnection.Open();
                objOraclecommand = GetCommand("adv_get_executive", ref objOracleConnection);
                objOraclecommand.CommandType = CommandType.StoredProcedure;

                OracleParameter prm1 = new OracleParameter("pcompcode", OracleType.VarChar);
                prm1.Direction = ParameterDirection.Input;
                prm1.Value = compcode;
                objOraclecommand.Parameters.Add(prm1);

                OracleParameter prm2 = new OracleParameter("padtype", OracleType.VarChar);
                prm2.Direction = ParameterDirection.Input;
                prm2.Value = adtype;
                objOraclecommand.Parameters.Add(prm2);

                OracleParameter prm3 = new OracleParameter("pagency_main_code", OracleType.VarChar);
                prm3.Direction = ParameterDirection.Input;
                prm3.Value = agmaincode;
                objOraclecommand.Parameters.Add(prm3);

                OracleParameter prm3a = new OracleParameter("pagency_sub_code", OracleType.VarChar);
                prm3a.Direction = ParameterDirection.Input;
                prm3a.Value = agsubcode;
                objOraclecommand.Parameters.Add(prm3a);


                OracleParameter prm4 = new OracleParameter("pagency_code", OracleType.VarChar);
                prm4.Direction = ParameterDirection.Input;
                prm4.Value = code_subcode;
                objOraclecommand.Parameters.Add(prm4);

                OracleParameter prm2a = new OracleParameter("pexecname", OracleType.VarChar);
                prm2a.Direction = ParameterDirection.Input;
                prm2a.Value = execname;
                objOraclecommand.Parameters.Add(prm2a);

                OracleParameter prm2a1 = new OracleParameter("pextra1", OracleType.VarChar);
                prm2a1.Direction = ParameterDirection.Input;
                prm2a1.Value = extra1;
                objOraclecommand.Parameters.Add(prm2a1);
                OracleParameter prm2a2 = new OracleParameter("pextra2", OracleType.VarChar);
                prm2a2.Direction = ParameterDirection.Input;
                prm2a2.Value = extra2;
                objOraclecommand.Parameters.Add(prm2a2);

                OracleParameter prm2a11 = new OracleParameter("pextra3", OracleType.VarChar);
                prm2a11.Direction = ParameterDirection.Input;
                prm2a11.Value = extra3;
                objOraclecommand.Parameters.Add(prm2a11);
                OracleParameter prm2a21 = new OracleParameter("pextra4", OracleType.VarChar);
                prm2a21.Direction = ParameterDirection.Input;
                prm2a21.Value = extra4;
                objOraclecommand.Parameters.Add(prm2a21);

                OracleParameter prm2a12 = new OracleParameter("pextra5", OracleType.VarChar);
                prm2a12.Direction = ParameterDirection.Input;
                prm2a12.Value = extra5;
                objOraclecommand.Parameters.Add(prm2a12);
                OracleParameter prm2a23 = new OracleParameter("pextra6", OracleType.VarChar);
                prm2a23.Direction = ParameterDirection.Input;
                prm2a23.Value = extra6;
                objOraclecommand.Parameters.Add(prm2a23);

                OracleParameter prm2a14 = new OracleParameter("pextra7", OracleType.VarChar);
                prm2a14.Direction = ParameterDirection.Input;
                prm2a14.Value = extra7;
                objOraclecommand.Parameters.Add(prm2a14);
                OracleParameter prm2a25 = new OracleParameter("pextra8", OracleType.VarChar);
                prm2a25.Direction = ParameterDirection.Input;
                prm2a25.Value = extra8;
                objOraclecommand.Parameters.Add(prm2a25);

                OracleParameter prm2a16 = new OracleParameter("pextra9", OracleType.VarChar);
                prm2a16.Direction = ParameterDirection.Input;
                prm2a16.Value = extra9;
                objOraclecommand.Parameters.Add(prm2a16);
                OracleParameter prm2a27 = new OracleParameter("pextra10", OracleType.VarChar);
                prm2a27.Direction = ParameterDirection.Input;
                prm2a27.Value = extra10;
                objOraclecommand.Parameters.Add(prm2a27);

                objOraclecommand.Parameters.Add("p_accounts", OracleType.Cursor);
                objOraclecommand.Parameters["p_accounts"].Direction = ParameterDirection.Output;
                objorclDataAdapter.SelectCommand = objOraclecommand;
                objorclDataAdapter.Fill(objDataSet);
                return objDataSet;

            }
            catch (Exception ex)
            {
                throw (ex);
            }
            finally
            {
                CloseConnection(ref objOracleConnection);
            }
        }
    }
}
