using System;
using System.Data;
using System.Configuration;
using System.Collections;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;
using System.Data.SqlClient;

public partial class AdCat4 : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
                 Response.Expires = -1;

                 if (Session["compcode"] == null)
                       {
                          Response.Redirect("login.aspx");
                           Response.Write("<script>window.parent.location=\"login.aspx\";</script>");
                           return;
                       }
                       ip1.Value = Request.ServerVariables["REMOTE_ADDR"];
                       hiddencomcode.Value = Session["compcode"].ToString();
                       hiddencompcode.Value = Session["compcode"].ToString();
                       hiddenuserid.Value = Session["userid"].ToString();
                       hiddenDateFormat.Value = Session["DateFormat"].ToString();
                       hiddenusername.Value = Session["Username"].ToString();
                       hiddenauto.Value = Session["autogenerated"].ToString();

        Ajax.Utility.RegisterTypeForAjax(typeof(AdCat4));

      

        
        DataSet objDataSetbu = new DataSet();
        //***********************************************************************//
        //*****************Code For Read the data from xml File******************//
        //*******************************For The Button**************************//
        //***********************************************************************/
        objDataSetbu.ReadXml(Server.MapPath("XML/button.xml"));
        btnNew.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[0].ToString();
        btnSave.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[1].ToString();
        btnModify.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[2].ToString();
        btnQuery.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[3].ToString();
        btnExecute.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[4].ToString();
        btnCancel.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[5].ToString();
        btnfirst.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[6].ToString();
        btnprevious.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[7].ToString();
        btnnext.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[8].ToString();
        btnlast.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[9].ToString();
        btnDelete.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[10].ToString();
        btnExit.ImageUrl = objDataSetbu.Tables[0].Rows[0].ItemArray[11].ToString();



        //********************************For Label****************************************/
        DataSet ds = new DataSet();
        ds.ReadXml(Server.MapPath("XML/Adcat4.xml"));
        adcat1.Text=ds.Tables[0].Rows[0].ItemArray[0].ToString();
        lbPublicationCenter.Text = ds.Tables[0].Rows[0].ItemArray[6].ToString();
        adcat2.Text = ds.Tables[0].Rows[0].ItemArray[1].ToString();
        AdCategoryName.Text=ds.Tables[0].Rows[0].ItemArray[2].ToString();
        AdCatName.Text = ds.Tables[0].Rows[0].ItemArray[3].ToString();
        AdCatCode.Text = ds.Tables[0].Rows[0].ItemArray[4].ToString();
        Alias.Text = ds.Tables[0].Rows[0].ItemArray[5].ToString();



        btnNew.Enabled = true;
        btnNew.Focus();
        btnSave.Enabled = false;
        btnModify.Enabled = false;
        btnDelete.Enabled = false;
        btnQuery.Enabled = true;
        btnExecute.Enabled = false;
        btnCancel.Enabled = true;
        btnfirst.Enabled = false;
        btnprevious.Enabled = false;
        btnnext.Enabled = false;
        btnlast.Enabled = false;
        btnExit.Enabled = true;

        txtalias.Enabled = false;
        txtadcatname.Enabled = false;
       txtadcatcode.Enabled = false;
        drpadvcatcode.Enabled = false;
        drpadcategory.Enabled = false;
        drpadsubcategory.Enabled = false;
        if (!IsPostBack)
        {
            
            txtalias.Attributes.Add("OnBlur", "javascript:return uppercase1('txtalias');");
            txtadcatcode.Attributes.Add("OnBlur", "javascript:return uppercase1('txtadcatcode');");

            btnNew.Attributes.Add("OnClick", "javascript:return catnewclick();");
            btnSave.Attributes.Add("OnClick", "javascript:return catsaveclick();");
            txtadcatname.Attributes.Add("OnChange", "javascript:return autoornot();");
            btnModify.Attributes.Add("OnClick", "javascript:return catmodifyclick();");
            btnQuery.Attributes.Add("OnClick", "javascript:return catqueryclick();");
            btnExecute.Attributes.Add("OnClick", "javascript:return catexecuteclick();");
            btnfirst.Attributes.Add("OnClick", "javascript:return firstcall();");
            btnprevious.Attributes.Add("OnClick", "javascript:return previouscall();");
            btnnext.Attributes.Add("OnClick", "javascript:return catnextclick();");
            btnlast.Attributes.Add("OnClick", "javascript:return lastcall();");
            btnExit.Attributes.Add("OnClick", "javascript:return catexitclick();");
            btnDelete.Attributes.Add("OnClick", "javascript:return catdeleteclick();");
            btnCancel.Attributes.Add("OnClick", "javascript:return catcancelclick('AdCat4');");
            drpadcategory.Attributes.Add("OnChange", "javascript:return fillAdCat2();");
            drpadsubcategory.Attributes.Add("OnChange", "javascript:return fillAdCat3();");
            
           // category(Session["compcode"].ToString());
            category1("");
            publicationbind();
        }
        if (btnNew.Enabled == false)
            btnNew.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[0].ToString();
        if (btnSave.Enabled == false)
            btnSave.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[1].ToString();
        if (btnModify.Enabled == false)
            btnModify.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[2].ToString();
        if (btnQuery.Enabled == false)
            btnQuery.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[3].ToString();
        if (btnExecute.Enabled == false)
            btnExecute.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[4].ToString();
        if (btnCancel.Enabled == false)
            btnCancel.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[5].ToString();
        if (btnfirst.Enabled == false)
            btnfirst.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[6].ToString();
        if (btnprevious.Enabled == false)
            btnprevious.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[7].ToString();
        if (btnnext.Enabled == false)
            btnnext.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[8].ToString();
        if (btnlast.Enabled == false)
            btnlast.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[9].ToString();
        if (btnDelete.Enabled == false)
            btnDelete.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[10].ToString();
        if (btnExit.Enabled == false)
            btnExit.ImageUrl = objDataSetbu.Tables[1].Rows[0].ItemArray[11].ToString();
    }
    
    public void category1(string adtype)
    {
        DataSet ds = new DataSet();

        //adtype = "CL0".ToString();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {

            NewAdbooking.Classes.AdCat4 category = new NewAdbooking.Classes.AdCat4();

            ds = category.addcategoryname1("",Session["compcode"].ToString());
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdCat4 category = new NewAdbooking.classesoracle.AdCat4();

            ds = category.addcategoryname1("", Session["compcode"].ToString());
        }
        else
        {
            NewAdbooking.classmysql.AdCat4 category = new NewAdbooking.classmysql.AdCat4();
            ds = category.addcategoryname1("", Session["compcode"].ToString());
        }
        ListItem li1;
        li1 = new ListItem();
        li1.Text = "-Select Ad Sub Category3-";
        li1.Value = "0";
        li1.Selected = true;
        drpadcategory.Items.Add(li1);

        int i;
        for (i = 0; i < ds.Tables[0].Rows.Count; i++)
        {
            ListItem li;
            li = new ListItem();
            li.Text = ds.Tables[0].Rows[i].ItemArray[1].ToString();
            li.Value = ds.Tables[0].Rows[i].ItemArray[0].ToString();
            drpadcategory.Items.Add(li);


        }



    }
    [Ajax.AjaxMethod]
    public DataSet fillCat1(string cat3)
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {
            NewAdbooking.Classes.AdCat4 category = new NewAdbooking.Classes.AdCat4();
            ds = category.addcategorynameALL("", cat3);
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdCat4 category = new NewAdbooking.classesoracle.AdCat4();
            ds = category.addcategorynameALL("", cat3);
        }
        else
        {
            NewAdbooking.classmysql.AdCat4 category = new NewAdbooking.classmysql.AdCat4();
            ds = category.addcategorynameALL("", cat3);
        }
      

        return ds;



    }
    [Ajax.AjaxMethod]
    public DataSet fillCat3(string cat1)
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {
            NewAdbooking.Classes.AdCat4 category = new NewAdbooking.Classes.AdCat4();

            ds = category.addcategoryname3(cat1);
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdCat4 category = new NewAdbooking.classesoracle.AdCat4();

            ds = category.addcategoryname3(cat1);
        }
        else
        {
            NewAdbooking.classmysql.AdCat4 category = new NewAdbooking.classmysql.AdCat4();

            ds = category.addcategoryname3(cat1);
        }
        return ds;



    }
    [Ajax.AjaxMethod(Ajax.HttpSessionStateRequirement.Read)]

    public DataSet fillCat2(string cat1, string st)
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {
            NewAdbooking.Classes.AdCat4 category = new NewAdbooking.Classes.AdCat4();

            ds = category.addcategoryname2(cat1,Session["compcode"].ToString());

        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdCat4 category = new NewAdbooking.classesoracle.AdCat4();

            ds = category.addcategoryname2(cat1, Session["compcode"].ToString());
        }
        else
        {
            string procedureName = "advsubcategory1_advsubcategory_p1";
            string[] parameterValueArray = { cat1, "0", Session["compcode"].ToString() };  
            NewAdbooking.classmysql.CommonClass obj = new NewAdbooking.classmysql.CommonClass();
            ds = obj.DynamicBindProcedure(procedureName, parameterValueArray);
        }
        
        //{
        //    NewAdbooking.classmysql.AdCat4 category = new NewAdbooking.classmysql.AdCat4();

        //    ds = category.addcategoryname2(cat1, Session["compcode"].ToString());
        //}
        return ds;

       

    }

    public void category(string compcode)
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {
            NewAdbooking.Classes.AdCat4 category = new NewAdbooking.Classes.AdCat4();
            ds = category.addcategoryname(compcode);
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdCat4 category = new NewAdbooking.classesoracle.AdCat4();
            ds = category.addcategoryname(compcode);
        }
        else
        {
            NewAdbooking.classmysql.AdCat4 category = new NewAdbooking.classmysql.AdCat4();
            ds = category.addcategoryname(compcode);
        }
            ListItem li1;
            li1 = new ListItem();
            li1.Text = "-Select Add Category-";
            li1.Value = "0";
            li1.Selected = true;
            drpadvcatcode.Items.Add(li1);

            int i;
            for (i = 0; i < ds.Tables[0].Rows.Count; i++)
            {
                ListItem li;
                li = new ListItem();
                li.Value = ds.Tables[0].Rows[i].ItemArray[0].ToString();
                li.Text = ds.Tables[0].Rows[i].ItemArray[1].ToString();
                drpadvcatcode.Items.Add(li);


            }
        }
       
   
    [Ajax.AjaxMethod(Ajax .HttpSessionStateRequirement.Read)]
    public DataSet savecat4(string compcode, string subcatname, string catname, string catalias, string catcode, string userid, string ppubcenter, string ip, string sapcode)
    {
        DataSet ds = new DataSet();
        string err = "";
        try
        {
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
            {
                NewAdbooking.Classes.AdCat4 save = new NewAdbooking.Classes.AdCat4();

                ds = save.savecat4(compcode, subcatname, catname, catcode, catalias, userid, ppubcenter, sapcode);
                //   return ds;
            }
            else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
            {
                NewAdbooking.classesoracle.AdCat4 save = new NewAdbooking.classesoracle.AdCat4();
                ds = save.savecat4(compcode, subcatname, catname, catcode, catalias, userid, ppubcenter, sapcode);
                // return ds;
            }

            else if (ConfigurationManager.AppSettings["ConnectionType"].ToString() == "mysql")
            {
                string procedureName = "CAT4_SAVE_CAT4_SAVE_P";
                string[] parameterValueArray = { compcode, subcatname, catname, catcode, catalias, userid, ppubcenter, sapcode, "" };
                NewAdbooking.classmysql.CommonClass obj = new NewAdbooking.classmysql.CommonClass();
                ds = obj.DynamicBindProcedure(procedureName, parameterValueArray);
            }
            //else
            //{
            //    NewAdbooking.classmysql.AdCat4 save = new NewAdbooking.classmysql.AdCat4();

            //    ds = save.savecat4(compcode, subcatname, catname, catcode, catalias, userid);
            //    //return ds;
            //}
        }
        catch (Exception e)
        {
            err = e.Message;
        }
        string catcode1 = "Inserted Ad Sub Category4 " + catcode;
        clsconnection dconnect = new clsconnection();
        string sqldd = "insert into log_new (DATE1,USERID,PROCESSNAME,ERR_DESCRIPTION,OBJECT_PROCESS_ID,DESCRIPTION,IP) values($date,'" + HttpContext.Current.Session["UserId"] + "','Ad Sub Category4 ','" + err.Replace("'", "''") + "','Ad Sub Category4 Created','" + catcode1;
        sqldd = sqldd + "',";
        sqldd = sqldd + "'" + ip + "')";
        dconnect.executenonquery1(sqldd);
        return ds;

    }
    [Ajax.AjaxMethod(Ajax.HttpSessionStateRequirement.Read)]
    public DataSet catmodify(string compcode, string subcatname, string catname, string catcode, string catalias, string userid, string ip, string pub, string sapcode)
    {
        DataSet ds = new DataSet();
        string err = "";
        try
        {

            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
            {
                NewAdbooking.Classes.AdCat4 catmod = new NewAdbooking.Classes.AdCat4();

                ds = catmod.catmodify(compcode, subcatname, catname, catcode, catalias, userid, pub, sapcode);
                //return ds;
            }
            else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
            {
                NewAdbooking.classesoracle.AdCat4 catmod = new NewAdbooking.classesoracle.AdCat4();
                ds = catmod.catmodify(compcode, subcatname, catname, catcode, catalias, userid, pub, sapcode);
                //return ds;
            }
            else
            {
                NewAdbooking.classmysql.AdCat4 catmod = new NewAdbooking.classmysql.AdCat4();
                ds = catmod.catmodify(compcode, subcatname, catname, catcode, catalias, userid);
                //return ds;
            }
        }
        catch (Exception e)
        {
            err = e.Message;
        }
        string catcode2 = "Modified Ad Sub Category4 " + catcode;
        clsconnection dconnect = new clsconnection();
        string sqldd = "insert into log_new (DATE1,USERID,PROCESSNAME,ERR_DESCRIPTION,OBJECT_PROCESS_ID,DESCRIPTION,IP) values($date,'" + HttpContext.Current.Session["UserId"] + "','Ad Sub Category4 ','" + err.Replace("'", "''") + "','Ad Sub Category4 Updated','" + catcode2;
        sqldd = sqldd + "',";
        sqldd = sqldd + "'" + ip + "')";
        dconnect.executenonquery1(sqldd);
        return ds;
    }
    [Ajax.AjaxMethod]
    public DataSet catexecute1(string compcode, string subcatname, string catname, string catcode, string catalias, string userid)
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {
            NewAdbooking.Classes.AdCat4 catexe = new NewAdbooking.Classes.AdCat4();

            ds = catexe.catexecute1(compcode, subcatname, catname, catcode, catalias, userid);
            return ds;
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdCat4 catexe = new NewAdbooking.classesoracle.AdCat4();
            ds = catexe.catexecute1(compcode, subcatname, catname, catcode, catalias, userid);
            return ds;
        }
        else if (ConfigurationManager.AppSettings["ConnectionType"].ToString() == "mysql")
        {
            string procedureName = "CAT4_EXE1";
            string[] parameterValueArray = { compcode, subcatname, catname, catcode, catalias, userid };
            NewAdbooking.classmysql.CommonClass obj = new NewAdbooking.classmysql.CommonClass();
            ds = obj.DynamicBindProcedure(procedureName, parameterValueArray);
        }
        return ds;
        //}
        //else
        //{
        //    NewAdbooking.classmysql.AdCat4 catexe = new NewAdbooking.classmysql.AdCat4();
        //    ds = catexe.catexecute1(compcode, subcatname, catname, catcode, catalias, userid);
        //    return ds;
        //}
    }

    [Ajax.AjaxMethod]
    public DataSet catfpnl()
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {
            NewAdbooking.Classes.AdCat4 first = new NewAdbooking.Classes.AdCat4();

            ds = first.catfpnl();
            return ds;
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdCat4 first = new NewAdbooking.classesoracle.AdCat4();
            ds = first.catfpnl();
            return ds;
        }
        else
        {
            NewAdbooking.classmysql.AdCat4 first = new NewAdbooking.classmysql.AdCat4();
            ds = first.catfpnl();
            return ds;
        }
    }
    [Ajax.AjaxMethod(Ajax.HttpSessionStateRequirement.Read)]
    public void catdelete(string catcode, string ip)
    {
        DataSet ds = new DataSet();
        string err = "";
        try
        {
            if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
            {
                NewAdbooking.Classes.AdCat4 catdel = new NewAdbooking.Classes.AdCat4();

                ds = catdel.catdelete(catcode);
            }
            else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
            {
                NewAdbooking.classesoracle.AdCat4 catdel = new NewAdbooking.classesoracle.AdCat4();
                ds = catdel.catdelete(catcode);
            }
            else
            {
                NewAdbooking.classmysql.AdCat4 catdel = new NewAdbooking.classmysql.AdCat4();
                ds = catdel.catdelete(catcode);
            }
        }
        catch (Exception e)
        {
            err = e.Message;
        }
        string catcode3 = "Deleted Ad Sub Category4 " + catcode;
        clsconnection dconnect = new clsconnection();
        string sqldd = "insert into log_new (DATE1,USERID,PROCESSNAME,ERR_DESCRIPTION,OBJECT_PROCESS_ID,DESCRIPTION,IP) values($date,'" + HttpContext.Current.Session["UserId"] + "','Ad Sub Category4 ','" + err.Replace("'", "''") + "','Ad Sub Category4 Deleted','" + catcode3;
        sqldd = sqldd + "',";
        sqldd = sqldd + "'" + ip + "')";
        dconnect.executenonquery1(sqldd);

    }
    [Ajax.AjaxMethod]

    public DataSet chkcatcod(string catcode, string catname ,string subcatname)
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {
            NewAdbooking.Classes.AdCat4 Chkcatcod = new NewAdbooking.Classes.AdCat4();

            ds = Chkcatcod.chkcatcod(catcode, catname,subcatname);
            return ds;
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdCat4 Chkcatcod = new NewAdbooking.classesoracle.AdCat4();
            ds = Chkcatcod.chkcatcod(catcode);
            return ds;
        }
        else
        {
            NewAdbooking.classmysql.AdCat4 Chkcatcod = new NewAdbooking.classmysql.AdCat4();
            ds = Chkcatcod.chkcatcod(catcode);
            return ds;
        }
    }
    [Ajax.AjaxMethod]
    public DataSet catdauto(string str, string cat3code)
    {
        DataSet ds = new DataSet();
        if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "sql")
        {
            NewAdbooking.Classes.AdCat4 chk = new NewAdbooking.Classes.AdCat4();

            ds = chk.catdauto(str, cat3code);
            return ds;
        }
        else if (ConfigurationSettings.AppSettings["ConnectionType"].ToString() == "orcl")
        {
            NewAdbooking.classesoracle.AdCat4 chk = new NewAdbooking.classesoracle.AdCat4();
            ds = chk.catdauto(str, cat3code);
            return ds;
        }
        else
        {
            NewAdbooking.classmysql.AdCat4 chk = new NewAdbooking.classmysql.AdCat4();
            ds = chk.catdauto(str, cat3code);
            return ds;
        }
    }
    public void publicationbind()
    {
         DataSet ds = new DataSet();
          string[] parameterValueArray = new string[] { Session["compcode"].ToString(), Session["userid"].ToString(), "" };
         if (ConfigurationManager.AppSettings["ConnectionType"].ToString() == "sql")
         {
             string procedureName = "pubcent_proc";
             NewAdbooking.Classes.CommonClass obj = new NewAdbooking.Classes.CommonClass();
             ds = obj.DynamicBindProcedure(procedureName, parameterValueArray);
         }
         else if (ConfigurationManager.AppSettings["ConnectionType"].ToString() == "orcl")
         {
             string procedureName = "pubcent_proc.pubcent_proc_p";
             NewAdbooking.classesoracle.CommonClass obj = new NewAdbooking.classesoracle.CommonClass();
             ds = obj.DynamicBindProcedure(procedureName, parameterValueArray);
         }
         else
         {
             string procedureName = "pubcent_proc_pubcent_proc_p";
             NewAdbooking.classmysql.CommonClass obj = new NewAdbooking.classmysql.CommonClass();
             ds = obj.DynamicBindProcedure(procedureName, parameterValueArray);
         }

       
        int i;
        ListItem li;
        li = new ListItem();
        dppubcent.Items.Clear();

     
        //li.Text = ds1.Tables[0].Rows[0].ItemArray[6].ToString();
        li.Value = "0";
        li.Text = "--Select Publication Center";
        li.Selected = true;
        dppubcent.Items.Add(li);


        if (ds.Tables.Count > 0)
        {
            for (i = 0; i < ds.Tables[0].Rows.Count; i++)
            {
                ListItem li1;
                li1 = new ListItem();
                li1.Value = ds.Tables[0].Rows[i].ItemArray[0].ToString();
                li1.Text = ds.Tables[0].Rows[i].ItemArray[1].ToString();
                dppubcent.Items.Add(li1);

            }
        }
      

    }

  
}


